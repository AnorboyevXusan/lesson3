'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[3],{1075:function(D,I,c){function l(S,N=self){N.addEventListener("message",function V(W){if(W&&W.data){var {id:Q,type:Y,path:ba}=Object.assign({path:[]},W.data),Z=(W.data.Ivh||[]).map(m);try{const ha=ba.slice(0,-1).reduce((ua,sa)=>ua[sa],S),ka=ba.reduce((ua,sa)=>ua[sa],S);switch(Y){case "GET":var ea=ka;break;case "SET":ha[ba.slice(-1)[0]]=m(W.data.value);ea=!0;break;case "APPLY":ea=ka.apply(ha,Z);break;case "CONSTRUCT":const ua=
new ka(...Z);ea=Object.assign(ua,{[v]:!0});break;case "ENDPOINT":const {port1:sa,port2:Da}=new MessageChannel;l(S,Da);ea=x(sa,[sa]);break;case "RELEASE":ea=void 0;break;default:return}}catch(ha){ea={value:ha,[G]:0}}Promise.resolve(ea).catch(ha=>({value:ha,[G]:0})).then(ha=>{const [ka,ua]=y(ha);N.postMessage(Object.assign(Object.assign({},ka),{id:Q}),ua);"RELEASE"===Y&&(N.removeEventListener("message",V),"MessagePort"===N.constructor.name&&N.close())})}});N.start&&N.start()}function e(S){if(S)throw Error("Proxy has been released and is not useable");
}function a(S,N=[],O=function(){}){let W=!1;const V=new Proxy(O,{get(Q,Y){e(W);if(Y===F)return()=>t(S,{type:"RELEASE",path:N.map(ba=>ba.toString())}).then(()=>{"MessagePort"===S.constructor.name&&S.close();W=!0});if("then"===Y){if(0===N.length)return{then:()=>V};Q=t(S,{type:"GET",path:N.map(ba=>ba.toString())}).then(m);return Q.then.bind(Q)}return a(S,[...N,Y])},set(Q,Y,ba){e(W);const [Z,ea]=y(ba);return t(S,{type:"SET",path:[...N,Y].map(ha=>ha.toString()),value:Z},ea).then(m)},apply(Q,Y,ba){e(W);
Q=N[N.length-1];if(Q===H)return t(S,{type:"ENDPOINT"}).then(m);if("bind"===Q)return a(S,N.slice(0,-1));const [Z,ea]=k(ba);return t(S,{type:"APPLY",path:N.map(ha=>ha.toString()),Ivh:Z},ea).then(m)},construct(Q,Y){e(W);const [ba,Z]=k(Y);return t(S,{type:"CONSTRUCT",path:N.map(ea=>ea.toString()),Ivh:ba},Z).then(m)}});return V}function k(S){S=S.map(y);return[S.map(N=>N[0]),Array.prototype.concat.apply([],S.map(N=>N[1]))]}function x(S,N){L.set(S,N);return S}function y(S){for(const [N,O]of K)if(O.HBh(S)){const [W,
V]=O.serialize(S);return[{type:"HANDLER",name:N,value:W},V]}return[{type:"RAW",value:S},L.get(S)||[]]}function m(S){switch(S.type){case "HANDLER":return K.get(S.name).deserialize(S.value);case "RAW":return S.value}}function t(S,N,O){return new Promise(W=>{const V=z();S.addEventListener("message",function ba(Y){Y.data&&Y.data.id&&Y.data.id===V&&(S.removeEventListener("message",ba),W(Y.data))});S.start&&S.start();S.postMessage(Object.assign({id:V},N),O)})}function z(){return Array(4).fill(0).map(()=>
Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}D=c(0);const v=Symbol("Comlink.proxy"),H=Symbol("Comlink.endpoint"),F=Symbol("Comlink.releaseProxy"),G=Symbol("Comlink.thrown"),M=S=>"object"===typeof S&&null!==S||"function"===typeof S,K=new Map([["proxy",{HBh:S=>M(S)&&S[v],serialize(S){const {port1:N,port2:O}=new MessageChannel;l(S,N);return[O,[O]]},deserialize(S){S.start();return a(S,[],void 0)}}],["throw",{HBh:S=>M(S)&&G in S,serialize({value:S}){return[S instanceof Error?
{kRa:!0,value:{message:S.message,name:S.name,stack:S.stack}}:{kRa:!1,value:S},[]]},deserialize(S){if(S.kRa)throw Object.assign(Error(S.value.message),S.value);throw S.value;}}]]),L=new WeakMap;c.d(I,"a",function(){return R});class R{static bUj(S){R.Xab=S;R.rpk=a(S,[],void 0)}static get Endpoint(){return R.Xab}static get cUj(){return R.rpk}}Object(D.a)(R,"WorkerUtils",null,[])},1092:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}Object(D.a)(l,"WaterlineOverrideSettings",null,[])},
1093:function(D,I,c){D=c(0);var l=c(415),e=c(527),a=c(578),k=c(233),x=c(530);class y extends k.a{constructor(){super();this.LowWaterline=this.HighWaterline=this.FileId=null}nl(){return x.a.getActivities}static Vba(F,G,M){const K=new y;K.FileId=F;K.HighWaterline=G;K.LowWaterline=M;return K}}Object(D.a)(y,"GetActivitiesRequest",k.a,[]);class m extends k.a{constructor(F,G,M){super();this.Settings=this.Waterline=this.FileId=null;this.FileId=F;this.Waterline=G;this.Settings=M}nl(){return x.a.getRelevantActivities}static Vba(F,
G,M){return new m(F,G,M)}}Object(D.a)(m,"GetRelevantActivitiesRequest",k.a,[]);class t extends k.a{constructor(F,G){super();this.WaterlineOverrideSettings=this.FileId=null;this.FileId=F;this.WaterlineOverrideSettings=G}nl(){return x.a.getWywaActivities}static Vba(F,G){return new t(F,G)}}Object(D.a)(t,"GetWywaActivitiesRequest",k.a,[]);class z{}Object(D.a)(z,"RelevantActivitiesSettings",null,[]);class v extends k.a{constructor(){super();this.FileId=null}nl(){return x.a.updateWaterline}static Vba(F){const G=
new v;G.FileId=F;return G}}Object(D.a)(v,"UpdateWaterlineRequest",k.a,[]);c.d(I,"a",function(){return H});class H{constructor(F,G,M,K,L){this.Nbk=F;this.awd=G;this.zQe=M;this.$qc=K;this.sOg=L}requestWYWAActivities(F){F=t.Vba(this.awd(),F);return l.a.then(this.J8(F,"wywa"),G=>G)}requestActivities(F,G){F=y.Vba(this.awd(),F,G);return l.a.then(this.J8(F,"activities"),M=>M)}K5n(){const F=v.Vba(this.awd());return l.a.then(this.J8(F,"waterline"),G=>G)}requestRelevantActivities(F,G){G=Object.assign(new z,
{FirstDocumentOpen:G,MockDataEnabled:!1});F=m.Vba(this.awd(),F,G);return l.a.then(this.J8(F,"relevant"),M=>M)}updateActivityState(F){return l.a.Tbd(this.sOg,G=>G.PTo(F.itemIds,F.activityStatesToSet,F.activityStatesToReset,F.resetUnseenCount))}requestActivityFeed(){return l.a.Tbd(this.sOg,F=>F.getActivityFeed(null))}J8(F,G){const M={"Content-Type":"application/json; charset=utf-8"};return l.a.then(l.a.Tbd(this.Nbk,K=>K.Xv(this.zQe,M,e.a.zIh(F,this.$qc),G)),K=>{if(!(K&&K.args&&K.args.data&&K.args.data.se))return null;
({group:K}=a.a.d2(K.args.data.se));return K&&K.Responses&&K.Responses.length?K.Responses[0]:null})}}Object(D.a)(H,"SharedActivityRepository",null,[])},1429:function(D,I,c){c.d(I,"a",function(){return e});var l;(function(a){a[a.Unknown=0]="Unknown";a[a.Gap=1]="Inference"})(l||(l={}));var e;(function(a){a[a.Unknown=0]="Unknown";a[a.udp=1]="VoiceDictationBadge";a[a.vdp=2]="VoiceDictationPhrase"})(e||(e={}))},1538:function(D,I,c){c.r(I);c.d(I,"Box4PasteSteward",function(){return ea});D=c(0);var l=c(22),
e=c(2),a=c(19),k=c(126),x=c(55),y=c(2060),m=c(2061),t=c(6),z=c(7),v=c(35),H=c(75),F=c(10),G=c(90),M=c(101),K=c(8),L=c(3),R=c(88),S=c(5),N=c(136),O=c(36),W=c(84),V=c(40),Q=c(59),Y=c(26),ba=c(447),Z=c(1788);class ea extends Z.a{constructor(ha,ka,ua,sa,Da,Pa,Ra,Ga=null,ta=null){super(ha,Ra,Ga,ta);this._formatting=null;this.FLa=!1;this.Ivb=null;this.KXb=-1;this.oxb=0;this.$Dc=new H.a;this.mbn=4294967295;v.a(4223754,307,V.OutlineElementReader.Eh(ha));this.Ovb=ka;this.Ovb.H3b(this);this.oM=ua;this.oM.H3b(this);
this.qq=sa;this.Qn=Da;this.jOe=G.ListItemReader.lg(this.zc);ea.NBm();ea.zBm();ea.jCm()}get xxa(){return null!=this.iDg?this.iDg:this.iDg=l.a.instance.Oa("Box4.IInternalLinkManager")}get ZJd(){return this._formatting}get E5b(){return this.jOe&&!this.oM.sEa}get HDb(){return 0<this.oxb}reset(){super.reset();this._formatting=this.Zpf(!1)}a2e(ha){var ka;v.a(4223762,307,V.OutlineElementReader.Eh(this.zc)||W.OutlineReader.mx(this.zc));this.ggc(!1);var ua=new S.GraphIterator;ua.kd(this.zc);ha=Z.a.Pf.NH(this.zc,
this.kRc(ha));this.uDd(ua,!1);v.a(4223763,307,ha===this.zc.currentNode);v.a(4223764,307,K.ParagraphReader.Xb(ha));-1!==this._formatting.yw&&ea.Tk.oE(ha,this._formatting.yw);if(ea.Tk.qq&&!this.FZ.wrj&&this._formatting.textIndent&&({unit:Da,returnValue:sa}=ea.s$d(this._formatting.textIndent),ua=!1,sa)){if(0>sa){ua=!0;var sa=-1*sa}var Da=ea.maf(sa,Da);ua?ea.Tk.qq.Tpb(ha,Da):ea.Tk.qq.jea(ha,Da)}(ea.Qd.xg||R.a.instance.J(1)&&F.App.Hv.uSb)&&ha.setValue(t.a.zRa,!0);this._formatting.lineSpacing&&ea.Tk.mD(ha,
this._formatting.lineSpacing);e.AFrameworkApplication.oe("702j5362;7g13g664");this._formatting.fS&&(null===(ka=e.AFrameworkApplication.K)||void 0===ka?0:ka.getBooleanFeatureGate("Microsoft.Office.WordOnline.isParagraphSpacingFixInPasteEnabled",!1))&&(z.ULS.sendTraceTag(509092556,307,50,"Setting before and after Spacing from margin top and bottom which we got from pasted HTML"),ea.Tk.Npb(ha,this._formatting.fS.afterSpacing),ea.Tk.Opb(ha,this._formatting.fS.beforeSpacing));if(this._formatting.Tmc){ka=
[];ua=[];Da=[];sa=this._formatting.Tmc.split(" ");let Ra=1,Ga=0;for(let ta=0;ta<sa.length;ta++){var Pa=ea.E7k(sa[ta]);const va=ea.D7k(sa[ta]);if(-1!==Pa)Ra=Pa;else if(-1!==va)Ga=va;else{const {unit:ia,returnValue:qa}=ea.s$d(sa[ta]);Pa=ea.maf(qa,ia);if(0<=Pa&&Pa<=this.mbn)ka.push(Pa),ua.push(Ra),Da.push(Ga);else{v.b(555103310,307,15,"Invalid custom tab value. tabStops: "+this._formatting.Tmc+" index: "+ta);break}Ra=1;Ga=0}}0<ka.length&&ea.Tk.lsk(ha,ka,ua,Da)}this._formatting.paragraph=ha;this.FLa=
!0}uDd(ha,ka){v.a(8128518,307,!ka);this.mV&&(0<this.mV&&this.qq.ILc(ha,this.mV),0>this.mV&&this.qq.oTa(ha,this.mV,0));ha&&this.Qn.lhe(ha,this.HDb);this.mV=0}Acd(ha){this.$Dc.add(ha)}l8e(){this.mV=0}Jda(ha,ka=null){v.a(4223772,307,K.ParagraphReader.oh(this.zc));const ua=this.zc.currentNode;this._formatting.Tng(ua);if(!this.FZ.bog(this.zc,ka,!1)){var sa=ua.qa.last,Da=Y.a.tw(ua);this.FLa&&(sa.formatting=this._formatting.nR.vf(sa),ua.Wl(),this.FLa=!1);ha=this.FZ.uyf(ha,ka);this.FZ.K$(this.zc.currentNode,
this._formatting.Qda,ka);this.jg.Ge(Da,ha,void 0,void 0,L.a.paste)}}Ida(ha){this.FZ.o0d&&this.FZ.g_d(ha)?(this.AF(),this.jE(ha)):(v.a(4223773,307,K.ParagraphReader.oh(this.zc)),ha=Y.a.tw(this.zc.currentNode),this.jg.hia(ha,ka=>new ba.a(ka)))}Xnb(){this.FZ.Ayf(this.zc)}xya(ha){if(ea.Asl(ha)){const ka=this.zc.currentNode;K.ParagraphReader.Xb(ka)&&(ka.$hc=ha.ckf)}else this.Ovb.xya(ha)}BHa(ha){this._formatting=ha;this.FLa=!0}MSa(ha){v.a(4223774,307,K.ParagraphReader.oh(this.zc));v.a(4223775,307,!this.Ivb);
v.a(4223776,307,0>this.KXb);this.Ivb=ha;this.KXb=K.ParagraphReader.textLength(this.zc.currentNode)}LSa(){v.a(4223777,307,K.ParagraphReader.oh(this.zc));v.a(4223778,307,!!this.Ivb);v.a(4223779,307,0<=this.KXb);let ha=Y.a.createTextRange(this.zc.currentNode,this.KXb,K.ParagraphReader.textLength(this.zc.currentNode)),ka="",ua="";this.xxa&&({z7f:ka,wFb:ua}=this.xxa.Vng(M.a.GFa(this.Ivb))).returnValue&&(this.Ivb=ka,ua&&(this.jg.Ge(ha,ua),ha=Y.a.createTextRange(this.zc.currentNode,this.KXb,K.ParagraphReader.textLength(this.zc.currentNode))));
ea.hp.fF(ha,this.Ivb,!1);this.FLa=!0;this.Ivb=null;this.KXb=-1}jE(ha){this.a2e(ha);this._formatting.gne(this.zc.currentNode);this.FZ.K$(this.zc.currentNode,this._formatting.Qda,ha,this._formatting.marginLeft,this._formatting.textIndent)}AF(){v.a(4223808,307,K.ParagraphReader.oh(this.zc));ea.hp.$wl(this.zc.currentNode);O.OutlineElementNavigator.Yd(this.zc)}Snb(){}Rnb(){}RSa(){}i6a(){}Bya(){v.a(4223809,307,V.OutlineElementReader.Eh(this.zc)||W.OutlineReader.mx(this.zc));let ha=!1;this.HDb||(ha=this.E5b||
!0);ha||(this.mV+=1);this.oxb++}zya(){this.oxb--;let ha=!1;this.HDb||(ha=this.E5b||!0,this.Qn.Gaj(this.$Dc));ha||--this.mV}FHa(ha){v.a(4223810,307,V.OutlineElementReader.Eh(this.zc)||W.OutlineReader.mx(this.zc));v.a(4223811,307,!!ha.listStyleType);this.Qn.khe(this.B1m(ha))}Aya(){v.a(4223813,307,V.OutlineElementReader.Eh(this.zc))}k6a(ha){this.Ovb.k6a(ha)}b$(ha){this.oM.b$(ha)}Z9(){this.oM.Z9()}u5(ha){this.oM.u5(ha)}a$(){this.oM.a$()}Y9(ha){this.oM.Y9(ha)}X9(){this.oM.X9()}static get Tk(){return null!=
ea.TFg?ea.TFg:ea.TFg=l.a.instance.resolve("Box4.IParagraphEditor")}static get hp(){return null!=ea.kBg?ea.kBg:ea.kBg=l.a.instance.resolve("Box4.IHyperlinkEditor")}static get Qd(){return null!=ea.bJg?ea.bJg:ea.bJg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get AKj(){return null!=ea.RJg?ea.RJg:ea.RJg=l.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get Nmc(){return ea.IUe}static set Nmc(ha){ea.IUe=ha}static get tq(){return N.a.getInstance()}static NBm(){ea.w6a[y.a.heading1]=
Q.StyleReader.wordStyleIdHeading1;ea.w6a[y.a.heading2]=Q.StyleReader.wordStyleIdHeading2;ea.w6a[y.a.heading3]=Q.StyleReader.wordStyleIdHeading3;ea.w6a[y.a.heading4]=Q.StyleReader.HTb;ea.w6a[y.a.heading5]=Q.StyleReader.ITb;ea.w6a[y.a.heading6]=Q.StyleReader.JTb;ea.w6a[y.a.citation]=null}static zBm(){ea.bya[m.a[m.a.unspecified]]=0;ea.bya[m.a[m.a.defaultUnordered]]=1;ea.bya[m.a[m.a.defaultOrdered]]=1;ea.bya[m.a[m.a.none]]=0;ea.bya[m.a[m.a.disc]]=1;ea.bya[m.a[m.a.circle]]=2;ea.bya[m.a[m.a.square]]=3;
ea.bya[m.a[m.a.decimal]]=1;ea.bya[m.a[m.a.lowerAlpha]]=2;ea.bya[m.a[m.a.lowerRoman]]=3;ea.bya[m.a[m.a.upperAlpha]]=4;ea.bya[m.a[m.a.upperRoman]]=5}static jCm(){ea.IUe=ea.AKj.Cr()}static E7k(ha){let ka=-1;if(!ha)return ka;ha=ha.toLowerCase();switch(ha){case "left":ka=1;break;case "center":ka=3;break;case "right":ka=4;break;case "decimal":ka=6;break;case "bar":ka=7}return ka}static D7k(ha){let ka=-1;if(!ha)return ka;ha=ha.toLowerCase();switch(ha){case "blank":ka=0;break;case "dotted":ka=1;break;case "dashed":ka=
2;break;case "lined":ka=3}return ka}static UCb(ha){const ka=a.a.substring(ha,0,2),ua=a.a.substring(ha,2,4);return a.a.substring(ha,4,6)+ua+ka}static s$d(ha){let ka=0;const ua=ha.length;var sa=a.a.substring(ha,0,ua-2);sa=parseFloat(sa);ha=a.a.substr(ha,ua-2,2);switch(ha){case "in":ka=3;break;case "px":ka=7;break;case "cm":ka=1;break;case "pt":ka=5;break;default:z.ULS.sendTraceTag(8208450,307,50,"Pasted DOM with unrecognized css length unit {0}, will default to UnitType.None and value 0",ha),sa=0}return{returnValue:sa,
unit:ka}}static maf(ha,ka){let ua=0;switch(ka){case 3:ua=k.a.Nv(ha);break;case 7:ua=x.a.Wy(ha,0);break;case 1:ua=k.a.p7e(ha);break;case 5:ua=k.a.Nv(k.a.o1f(ha));break;default:z.ULS.sendTraceTag(8208451,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",ha,ka)}return ua}static Asl(ha){return!!ha&&!!ha.ckf&&""!==ha.ckf}}ea.w6a=Array(y.a.maxParagraphStyle+1);ea.bya={};ea.IUe=null;Object(D.a)(ea,"Box4PasteSteward",Z.a,[])},1573:function(D,I,c){D=c(0);var l=
c(2),e;(function(y){y[y.chrome=0]="chrome";y[y.edge=1]="edge";y[y.firefox=2]="firefox";y[y.IE=3]="IE";y[y.safari=4]="safari";y[y.others=5]="others";y[y.unknown=6]="unknown";y[y.electron=7]="electron";y[y.chromiumEdge=8]="chromiumEdge";y[y.teamsElectron=9]="teamsElectron"})(e||(e={}));Object(D.b)("BrowserCode",e);var a=c(7);const k=(y,m)=>{const t={};let z=null;switch(y){case 0:z="HtmlProcessor";var v=m.a;null!=v&&(t.SessionID=v);var H=m.b.toString();null!=H&&(t.Elements=H);var F=m.c.toString();null!=
F&&(t.PrunedElements=F);var G=m.d.toString();null!=G&&(t.TransparentElements=G);var M=m.e.toString();null!=M&&(t.VoidElements=M);var K=m.f.toString();null!=K&&(t.UnknownElements=K);break;case 1:z="WordConverter";var L=m.a;null!=L&&(t.SessionID=L);var R=m.b.toString();null!=R&&(t.BulletsConverted=R);var S=m.c.toString();null!=S&&(t.NumberedConverted=S);break;case 2:z="FormattingSteward";var N=m.a;null!=N&&(t.SourceApp=N);var O=m.b;null!=O&&(t.Browser=O);var W=m.c;null!=W&&(t.OperationId=W);var V=m.d.toString();
null!=V&&(t.Lang=V);var Q=m.e.toString();null!=Q&&(t.TextDir=Q);var Y=m.f.toString();null!=Y&&(t.Bold=Y);var ba=m.g.toString();null!=ba&&(t.Math=ba);var Z=m.h.toString();null!=Z&&(t.Italics=Z);var ea=m.i.toString();null!=ea&&(t.Underline=ea);var ha=m.j.toString();null!=ha&&(t.Strikethrough=ha);var ka=m.k.toString();null!=ka&&(t.Subscript=ka);var ua=m.l.toString();null!=ua&&(t.Superscript=ua);var sa=m.m.toString();null!=sa&&(t.Fontsize=sa);var Da=m.n.toString();null!=Da&&(t.Fontface=Da);var Pa=m.o.toString();
null!=Pa&&(t.GrowFontsize=Pa);var Ra=m.p.toString();null!=Ra&&(t.ShrinkFontsize=Ra);var Ga=m.q.toString();null!=Ga&&(t.FontColor=Ga);var ta=m.r.toString();null!=ta&&(t.FontHighlight=ta);var va=m.s.toString();null!=va&&(t.ParagraphStyle=va);var ia=m.t.toString();null!=ia&&(t.TextAlign=ia);var qa=m.u.toString();null!=qa&&(t.TextIndent=qa);var pa=m.v.toString();null!=pa&&(t.MarginLeft=pa);var Fa=m.w.toString();null!=Fa&&(t.ParagraphSpaceBefore=Fa);var za=m.x.toString();null!=za&&(t.ParagraphSpaceAfter=
za);var Oa=m.y.toString();null!=Oa&&(t.LineSpace=Oa);var xa=m.z.toString();null!=xa&&(t.CellShadingColor=xa);var fa=m.ba.toString();null!=fa&&(t.StyleDefinition=fa);var Ka=m.bb.toString();null!=Ka&&(t.TabStops=Ka);break;case 3:z="SemanticEvents";var lb=m.a;null!=lb&&(t.SessionID=lb);var Xa=m.b.toString();null!=Xa&&(t.Text=Xa);var kb=m.c.toString();null!=kb&&(t.LineBreak=kb);var Bb=m.d.toString();null!=Bb&&(t.Image=Bb);var Ja=m.e.toString();null!=Ja&&(t.File=Ja);var Ma=m.f.toString();null!=Ma&&(t.FormattingChange=
Ma);var fb=m.g.toString();null!=fb&&(t.Anchor=fb);var hc=m.h.toString();null!=hc&&(t.Paragraph=hc);var cc=m.i.toString();null!=cc&&(t.Math=cc);var mb=m.j.toString();null!=mb&&(t.List=mb);var Hb=m.k.toString();null!=Hb&&(t.ListItem=Hb);var Ua=m.l.toString();null!=Ua&&(t.RenderAugmentation=Ua);var Ya=m.m.toString();null!=Ya&&(t.Span=Ya);break;case 4:z="SemanticTableEvents";var Fb=m.a;null!=Fb&&(t.SessionID=Fb);var Wa=m.b.toString();null!=Wa&&(t.Tables=Wa);var yb=m.c.toString();null!=yb&&(t.TableRow=
yb);var Yb=m.d.toString();null!=Yb&&(t.TableCell=Yb);var qc=m.e.toString();null!=qc&&(t.TablePart=qc);break;case 5:z="HtmlEvents";var Hc=m.a;null!=Hc&&(t.OperationId=Hc);var $b=m.b;null!=$b&&(t.SourceApp=$b);var Ub=m.c;null!=Ub&&(t.Browser=Ub);var mc=null==m.d?null:m.d.toString();null!=mc&&(t.Text=mc);var ic=null==m.e?null:m.e.toString();null!=ic&&(t.A=ic);var ab=null==m.f?null:m.f.toString();null!=ab&&(t.Abbr=ab);var bb=null==m.g?null:m.g.toString();null!=bb&&(t.Acronym=bb);var Jb=null==m.h?null:
m.h.toString();null!=Jb&&(t.Address=Jb);var Eb=null==m.i?null:m.i.toString();null!=Eb&&(t.Applet=Eb);var hb=null==m.j?null:m.j.toString();null!=hb&&(t.Area=hb);var ob=null==m.k?null:m.k.toString();null!=ob&&(t.B=ob);var Va=null==m.l?null:m.l.toString();null!=Va&&(t.Base=Va);var Qb=null==m.m?null:m.m.toString();null!=Qb&&(t.Basefont=Qb);var Vb=null==m.n?null:m.n.toString();null!=Vb&&(t.Bdo=Vb);var Sb=null==m.o?null:m.o.toString();null!=Sb&&(t.Big=Sb);var nb=null==m.p?null:m.p.toString();null!=nb&&
(t.Blockquote=nb);var ac=null==m.q?null:m.q.toString();null!=ac&&(t.Body=ac);var zc=null==m.r?null:m.r.toString();null!=zc&&(t.Br=zc);var Ib=null==m.s?null:m.s.toString();null!=Ib&&(t.Button=Ib);var ya=null==m.t?null:m.t.toString();null!=ya&&(t.Caption=ya);var ib=null==m.u?null:m.u.toString();null!=ib&&(t.Center=ib);var wb=null==m.v?null:m.v.toString();null!=wb&&(t.Cite=wb);var bc=null==m.w?null:m.w.toString();null!=bc&&(t.Code=bc);var lc=null==m.x?null:m.x.toString();null!=lc&&(t.Col=lc);var Kb=
null==m.y?null:m.y.toString();null!=Kb&&(t.Colgroup=Kb);var Bc=null==m.z?null:m.z.toString();null!=Bc&&(t.Dd=Bc);var Xc=null==m.ba?null:m.ba.toString();null!=Xc&&(t.Del=Xc);var vd=null==m.bb?null:m.bb.toString();null!=vd&&(t.Dfn=vd);var vc=null==m.bc?null:m.bc.toString();null!=vc&&(t.Dir=vc);var bd=null==m.bd?null:m.bd.toString();null!=bd&&(t.Div=bd);var Sd=null==m.be?null:m.be.toString();null!=Sd&&(t.Dl=Sd);var pd=null==m.bf?null:m.bf.toString();null!=pd&&(t.Dt=pd);var Tc=null==m.bg?null:m.bg.toString();
null!=Tc&&(t.Em=Tc);var Wc=null==m.bh?null:m.bh.toString();null!=Wc&&(t.Fieldset=Wc);var Pc=null==m.bi?null:m.bi.toString();null!=Pc&&(t.Font=Pc);var Xd=null==m.bj?null:m.bj.toString();null!=Xd&&(t.Form=Xd);var Dd=null==m.bk?null:m.bk.toString();null!=Dd&&(t.Frame=Dd);var $e=null==m.bl?null:m.bl.toString();null!=$e&&(t.Frameset=$e);var se=null==m.bm?null:m.bm.toString();null!=se&&(t.H=se);var wc=null==m.bn?null:m.bn.toString();null!=wc&&(t.Head=wc);var cd=null==m.bo?null:m.bo.toString();null!=cd&&
(t.Hr=cd);var Jd=null==m.bp?null:m.bp.toString();null!=Jd&&(t.Html=Jd);var Qd=null==m.bq?null:m.bq.toString();null!=Qd&&(t.I=Qd);var yd=null==m.br?null:m.br.toString();null!=yd&&(t.Iframe=yd);var Le=null==m.bs?null:m.bs.toString();null!=Le&&(t.Img=Le);var gf=null==m.bt?null:m.bt.toString();null!=gf&&(t.Input=gf);var xh=null==m.bu?null:m.bu.toString();null!=xh&&(t.Ins=xh);var Qg=null==m.bv?null:m.bv.toString();null!=Qg&&(t.Isindex=Qg);var Ng=null==m.bw?null:m.bw.toString();null!=Ng&&(t.Kbd=Ng);var zg=
null==m.bx?null:m.bx.toString();null!=zg&&(t.Label=zg);var Jf=null==m.by?null:m.by.toString();null!=Jf&&(t.Legend=Jf);var fc=null==m.bz?null:m.bz.toString();null!=fc&&(t.Li=fc);var Fc=null==m.ca?null:m.ca.toString();null!=Fc&&(t.Link=Fc);var id=null==m.cb?null:m.cb.toString();null!=id&&(t.Map=id);var ld=null==m.cc?null:m.cc.toString();null!=ld&&(t.Math=ld);var hd=null==m.cd?null:m.cd.toString();null!=hd&&(t.Menu=hd);var Be=null==m.ce?null:m.ce.toString();null!=Be&&(t.Meta=Be);var Ke=null==m.cf?null:
m.cf.toString();null!=Ke&&(t.Noframes=Ke);var Me=null==m.cg?null:m.cg.toString();null!=Me&&(t.Noscript=Me);var jf=null==m.ch?null:m.ch.toString();null!=jf&&(t.Object=jf);var kg=null==m.ci?null:m.ci.toString();null!=kg&&(t.Ol=kg);var sf=null==m.cj?null:m.cj.toString();null!=sf&&(t.Optgroup=sf);var Wg=null==m.ck?null:m.ck.toString();null!=Wg&&(t.Option=Wg);var Db=null==m.cl?null:m.cl.toString();null!=Db&&(t.P=Db);var Gb=null==m.cm?null:m.cm.toString();null!=Gb&&(t.Param=Gb);var $c=null==m.cn?null:m.cn.toString();
null!=$c&&(t.Pre=$c);var Bd=null==m.co?null:m.co.toString();null!=Bd&&(t.Q=Bd);var we=null==m.cp?null:m.cp.toString();null!=we&&(t.S=we);var He=null==m.cq?null:m.cq.toString();null!=He&&(t.Samp=He);var Se=null==m.cr?null:m.cr.toString();null!=Se&&(t.Script=Se);var jg=null==m.cs?null:m.cs.toString();null!=jg&&(t.Select=jg);var Hi=null==m.ct?null:m.ct.toString();null!=Hi&&(t.Small=Hi);var ii=null==m.cu?null:m.cu.toString();null!=ii&&(t.Span=ii);var Zh=null==m.cv?null:m.cv.toString();null!=Zh&&(t.Strike=
Zh);var vg=null==m.cw?null:m.cw.toString();null!=vg&&(t.Strong=vg);var vf=null==m.cx?null:m.cx.toString();null!=vf&&(t.Style=vf);var Lf=null==m.cy?null:m.cy.toString();null!=Lf&&(t.Sub=Lf);var Cg=null==m.cz?null:m.cz.toString();null!=Cg&&(t.Sup=Cg);var bg=null==m.da?null:m.da.toString();null!=bg&&(t.Tables=bg);var eg=null==m.db?null:m.db.toString();null!=eg&&(t.Tbody=eg);var sh=null==m.dc?null:m.dc.toString();null!=sh&&(t.Td=sh);var nh=null==m.dd?null:m.dd.toString();null!=nh&&(t.Textarea=nh);var Sh=
null==m.de?null:m.de.toString();null!=Sh&&(t.Tfoot=Sh);var Xk=null==m.df?null:m.df.toString();null!=Xk&&(t.Th=Xk);var rl=null==m.dg?null:m.dg.toString();null!=rl&&(t.Thead=rl);var sl=null==m.dh?null:m.dh.toString();null!=sl&&(t.Title=sl);var Xf=null==m.di?null:m.di.toString();null!=Xf&&(t.Tr=Xf);var Dl=null==m.dj?null:m.dj.toString();null!=Dl&&(t.Tt=Dl);var rg=null==m.dk?null:m.dk.toString();null!=rg&&(t.U=rg);var Hm=null==m.dl?null:m.dl.toString();null!=Hm&&(t.Ul=Hm);var pf=null==m.dm?null:m.dm.toString();
null!=pf&&(t.Var=pf);var vh=null==m.dn?null:m.dn.toString();null!=vh&&(t.Unknown=vh);break;case 6:z="List";var ri=m.a;null!=ri&&(t.SessionID=ri);var tl=m.b.toString();null!=tl&&(t.MaxListLevel=tl)}t.Table=z;return Sys.Serialization.JavaScriptSerializer.serialize(t)};c.d(I,"a",function(){return x});class x{static get Cpa(){null==x.kwb&&(x.kwb=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("UsageEditorLoggingIsDisabled"));return x.kwb}static get cAi(){null==x.FGe&&(x.FGe=!!l.AFrameworkApplication.K&&
l.AFrameworkApplication.K.$("WordUsageEditorLoggingIsEnabled"));return x.FGe}static $0(y){a.ULS.sendTraceTag(524038472,307,50,y)}static qai(y){const m={};m.a=y;m.b=0;m.c=0;m.d=0;m.e=0;m.f=0;return m}static P5m(y){x.Cpa||x.$0(k(0,y))}static J6h(y){const m={};m._sessionID=y;return m}static Cki(y){const m={};m.a=y;m.b=0;m.c=0;return m}static G8m(y){x.Cpa||x.$0(k(1,y))}static pai(y,m){const t={};t.c=e[y];t.a=m;return t}static O5m(y,m){x.cAi&&y&&(y.b=m,x.$0(k(5,y)))}static fhi(y){const m={};m.a=y;m.b=
0;m.c=0;m.d=0;m.e=0;m.f=0;m.g=0;m.h=0;m.i=0;m.j=0;m.k=0;m.l=0;m.m=0;return m}static z7m(y){x.Cpa||x.$0(k(3,y))}static ghi(y){const m={};m.a=y;m.b=0;m.c=0;m.d=0;m.e=0;return m}static A7m(y){x.Cpa||x.$0(k(4,y))}static crf(y,m){const t={};t.b=e[y];t.c=m;t.d=0;t.e=0;t.f=0;t.g=0;t.h=0;t.i=0;t.j=0;t.k=0;t.l=0;t.m=0;t.n=0;t.o=0;t.p=0;t.q=0;t.r=0;t.s=0;t.t=0;t.w=0;t.x=0;t.y=0;t.z=0;t.u=0;t.v=0;t.ba=0;t.bb=0;return t}static y5m(y,m){x.cAi&&y&&(y.a=m,x.$0(k(2,y)))}static S3l(y){const m={};m.a=y;m.b=-1;return m}static o6m(y){!x.Cpa&&
y&&0<=y.b&&x.$0(k(6,y))}}x.kwb=null;x.FGe=null;Object(D.a)(x,"UsageEditor",null,[])},1582:function(D,I,c){c.d(I,"a",function(){return a});D=c(0);var l=c(2),e=c(5);class a{static get krb(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordDesignerTelemetryPerConstructIsEnabled")}static Tib(k,x=!1){const y=e.GraphIterator.eb(k);y.qd();return(x?y.Ub(4):y.aia(4))?4:e.GraphIterator.eb(k).zb(36)?16:e.GraphIterator.eb(k).zb(14)?2:e.GraphIterator.eb(k).zb(38)?32:1}}Object(D.a)(a,"ConstructTypeHelper",
null,[])},1603:function(D,I,c){c.d(I,"a",function(){return W});D=c(0);var l=c(75),e=c(192),a=c(22),k=c(173),x=c(2),y=c(243),m=c(6),t=c(82),z=c(61),v=c(10),H=c(43),F=c(445),G=c(214),M=c(237),K=c(8),L=c(253),R=c(18),S=c(12),N=c(283),O=c(3);class W{static get ah(){return G.ContextSetEditor.instance}static get Yf(){return M.a.instance}static get Ic(){return e.a.instance}static ix(){return W.en||(W.en=a.a.instance.Ta("Box4.IExternalSelectionManager"))}static get SA(){return null!=W.VFg?W.VFg:W.VFg=a.a.instance.resolve("Box4.IParagraphIndentationReader")}static him(){this.mO||
(this.mO=new l.a,this.mO.add(O.a.WA),this.mO.add(O.a.font),this.mO.add(O.a.lZ),this.mO.add(O.a.fva),this.mO.add(O.a.bold),this.mO.add(O.a.az),this.mO.add(O.a.superscript),this.mO.add(O.a.subscript),this.mO.add(O.a.l0a),this.mO.add(O.a.cva),this.mO.add(O.a.GDa),this.mO.add(O.a.r7e),this.mO.add(O.a.HDa),this.mO.add(O.a.k0a),this.mO.add(O.a.u0),this.mO.add(O.a.L1),this.mO.add(O.a.LC),this.mO.add(O.a.Zfb),this.mO.add(O.a.LIc));return this.mO}static rcc(V){return W.him().contains(V)?!0:!1}static lw(V,
Q,Y,ba,Z){var ea=!0;if(!Q.view.ue)return 2;var ha=Q.view,ka=ha.mb;ka&&ka.ib.lb||(W.Ic.Yb(t.a.ef,{["Reason"]:z.a.noSelection}),ea=!1);W.ah.ZDa(R.ImageReader.UWc,ha.mb.qg)&&(W.Ic.Yb(t.a.ef,{["Reason"]:z.a.y$e}),ea=!1);if(W.ah.ZDa(R.ImageReader.a4a,ha.mb.qg))return W.Ic.Yb(t.a.ef,{["Reason"]:z.a.IJc}),8;var ua=!W.rcc(V);W.Yf.vcc(ha.mb.qg,ua)&&(W.Ic.Yb(t.a.ef,{["Reason"]:z.a.cF}),ea=!1);W.ah.ZDa(R.ImageReader.c_d,ha.mb.qg)&&(W.Ic.Yb(t.a.ef,{["Reason"]:z.a.t$e}),ea=!1);W.ah.ZDa(N.c,ha.mb.qg)&&(W.Ic.Yb(t.a.ef,
{["Reason"]:z.a.u$e}),ea=!1);W.ah.ZDa(L.a.fFf,ha.mb.qg)&&(W.Ic.Yb(t.a.ef,{["Reason"]:z.a.s$e}),ea=!1);W.ah.xAa(K.ParagraphReader.OU,ha.mb.qg)&&(W.Ic.Yb(t.a.ef,{["Reason"]:z.a.AO}),ea=!1);W.ix()&&W.ix().instance&&W.ix().instance.SU(ha.mb.qg)&&(W.Ic.Yb(t.a.ef,{["Reason"]:z.a.P1a}),ea=!1);var sa=null;ka&&ka.ib.lb&&(sa=ka.ib.lb);if(1===Y||!ea||!sa)return ea?32:8;ea=V===O.a.$ec||V===O.a.E4b||V===O.a.$jc||V===O.a.a9b;ha=V===O.a.dOb||V===O.a.UDb||V===O.a.pjc;ua=V===O.a.xUa||V===O.a.yUa||V===O.a.mD;const Da=
new H.GraphTransaction(15);Da.Db(sa.Pa.node);sa=new l.a;let Pa=!1;if(ea||ha||ua)k.a.mark(7121),Q=W.ah.P3h(Q.ik);else{k.a.mark(7119);Q=F.OutlineElementGeneralizer.Aha(ka.ib,!0);if(!Q)return W.Ic.Yb(t.a.moa,{["Reason"]:z.a.XNd}),Da.dispose(),8;ka=V===O.a.J3a||V===O.a.wkb;Q.jx&&ka&&(Pa=W.Dsm(sa,Q))}(V===O.a.I9||V===O.a.$ec||V===O.a.Lba||V===O.a.E4b||V===O.a.z$||V===O.a.$jc||V===O.a.hFa||V===O.a.a9b)&&Q.jx&&1<Q.length&&W.Esm(Q)&&(Z||(Z={}),Object.getType(Z)===Object&&(Z.InContextSet=!0));x.AFrameworkApplication.va.Nf(Q,
V,Y,!0,ba,Z);Pa&&W.Vhn(sa,Q,Z);Da.dispose();v.App.za.updateCommandUI();ea||ha||ua?k.a.mark(7122):k.a.mark(7120);return 32}static Dsm(V,Q){if(!Q.jx)return!1;let Y=!1,ba=!1;for(let ea=0;ea<Q.length;ea++)if(Q.getContext(ea).el){var Z=Q.getContext(ea).node;Z&&(Z=W.SA.ijb(Z),2===Z.specialIndentType?(Y=!0,V.add(ea)):1!==Z.specialIndentType&&Z.specialIndentType||(ba=!0))}return ba&&Y}static Vhn(V,Q,Y){if(Q.jx)for(let Z=0;Z<V.count;Z++){var ba=Q.getContext(V.J(Z));if(!ba.el)continue;ba=ba.node;const ea=W.SA.ijb(ba);
2!==ea.specialIndentType||y.a.Cxa(Y.value,ea.OB)||ba.setValue(m.a.ee,ea.OB-ea.sea)}}static bgg(V,Q){let Y=!0;Q.contextId!==S.a.paragraph?Y=!1:W.Yf.M4a(Q)?(W.Ic.Yb(t.a.vn,{["Reason"]:z.a.cF}),Y=!1):W.ix()&&W.ix().instance&&W.ix().instance.SU(Q)?(W.Ic.Yb(t.a.vn,{["Reason"]:z.a.P1a}),Y=!1):Q.el&&(Q=Q.node,K.ParagraphReader.Xb(Q)&&Q.ZQ&&(W.Ic.Yb(t.a.vn,{["Reason"]:z.a.AO}),Y=!1));return{returnValue:1!==V&&Y,Ay:Y?32:8}}static Esm(V){if(!V.jx)return!1;let Q=1;for(let ba=0;ba<V.length;ba++){var Y=V.getContext(ba);
if(Y&&Y.el&&Y.contextId===S.a.paragraph&&(Y=Y.node))if(Y=K.ParagraphReader.Lx(Y),!ba)Q=Y;else if(Y!==Q)return!0}return!1}}W.en=null;W.mO=null;Object(D.a)(W,"FormattingActionHelper",null,[])},1606:function(D,I,c){c.d(I,"a",function(){return e});c.d(I,"b",function(){return a});var l=c(2);const e=k=>{switch(k){case 2:return WordEditorIntl.WordEditorStrings.L_ResultTypeHeader;case 4:return WordEditorIntl.WordEditorStrings.L_ResultTypeFooter;case 8:return WordEditorIntl.WordEditorStrings.L_ResultTypeFootnote;
case 16:return WordEditorIntl.WordEditorStrings.L_ResultTypeEndnote;case 32:return WordEditorIntl.WordEditorStrings.L_ResultTypeComment}return""},a=()=>{var k;return null===(k=l.AFrameworkApplication.K)||void 0===k?void 0:k.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}},1619:function(D,I,c){c.r(I);D=c(0);var l=c(2),e=c(129),a=c(22),k=c(55),x=c(358),y=c(43),m=c(5);class t{xef(Vb,Sb,nb){return 1===nb?32:t.$kl(Sb.node)}static $kl(Vb){const Sb=new m.GraphIterator;
Sb.set(Vb);Sb.Ip();Vb=new y.GraphTransaction(7);Vb.St(Sb);Sb.zg();Vb.dispose();return 32}}Object(D.a)(t,"DeleteOutlineLevelContentStrategy",null,[]);var z=c(174),v=c(177),H=c(79),F=c(214),G=c(17),M=c(23),K=c(8),L=c(104),R=c(36),S=c(207),N=c(84),O=c(26);class W{constructor(Vb){this.Qm=null;this.Jma=Vb}get qBb(){return null!=this.xwg?this.xwg:this.xwg=a.a.instance.Oa("Box4.IAutoCorrectRules")}get sX(){return null!=this.zwg?this.zwg:this.zwg=a.a.instance.Oa("Box4.IAutoCorrectScheduler")}get fN(){return null!=
this.zFg?this.zFg:this.zFg=a.a.instance.Oa("Box4.Pages.IPageContentEditor")}get BL(){return null!=this.XEg?this.XEg:this.XEg=a.a.instance.Oa("Box4.IOutlineEditor")}get ug(){return this.Qm||(this.Qm=this.Jma())}XGi(Vb,Sb,nb){if(this.BL&&W.qn){var ac=F.ContextSetEditor.Vrf(Sb);Vb=ac.node;G.SelectionEditor.Lk(ac)&&(ac=O.a.Rc(Vb,K.ParagraphReader.textLength(Vb)));var zc=L.FormattingReader.language(L.FormattingReader.Yr(ac));ac=m.GraphIterator.eb(nb.ed);W.hi.V7c(ac);var Ib=Vb=null;if(ac)for(let ya=ac.Ub(1);ya&&
!Ib;ya=ac.Ti(1))N.OutlineReader.Nxa(ya)&&(Ib=ya);if(ac&&!Ib){if(!this.fN||!this.BL)return;Vb=new y.GraphTransaction(7);Vb.St(ac);Ib=this.fN.zJd(ac);this.BL.a8(ac,!0);zc&&(R.OutlineElementNavigator.Ee(ac),ac=O.a.Rc(ac.currentNode,0),W.qn.ghe(L.FormattingReader.Yr(ac),zc))}zc=M.SelectionFactory.ro(Ib,!0);nb.mb.Ac(zc);G.SelectionEditor.Ze(Sb)&&(nb=m.GraphIterator.eb(Sb.node),nb.Ip(),S.OutlineNavigator.Z$f(nb),this.qBb&&this.sX&&N.OutlineReader.KA(nb,Sb,!0)&&(Sb=this.qBb.Ukf(Sb,-1,!1,H.a.Iw))&&this.sX.Nhj(Sb));
this.ug&&this.ug.tF();Vb&&Vb.dispose()}}static get qn(){return null!=W.CAg?W.CAg:W.CAg=a.a.instance.Oa("Box4.IFormattingEditor")}static get instance(){return null!=W.gDg?W.gDg:W.gDg=W.fm()}static fm(){return new W(()=>a.a.instance.Oa("Box4.IUndoManager"))}static get hi(){return v.PageNavigator.instance}}Object(D.a)(W,"TitleViewEditor",null,[]);var V=c(48),Q=c(471),Y=c(642),ba=c(21),Z=c(12),ea=c(283),ha=c(3);class ka{constructor(){this.H0j=new t;this.xef=(Vb,Sb,nb,ac,zc)=>this.H0j.xef(Vb,Sb,nb,ac,
zc)}Tb(Vb){const Sb=this.NRh.Gef.bind(this.NRh),nb=this.xef,ac=this.CRh.fll.bind(this.CRh);this.T6f(Vb,Sb,nb,ac);Vb.ra(ha.a.backspace,Z.a.Uc,ac);Vb.ra(ha.a.backspace,Z.a.Fd,ac);Vb.ra(ha.a.backspace,Z.a.Vc,e.ActionManager.gR);Vb.ra(ha.a.backspace,Z.a.outline,nb);Vb.ra(ha.a.backspace,Z.a.view,Sb);Vb.Xc(ha.a.backspace,1124);Vb.ra(ha.a.Rva,Z.a.Uc,e.ActionManager.gR);Vb.ra(ha.a.Rva,Z.a.Fd,ac);Vb.ra(ha.a.Rva,Z.a.Vc,e.ActionManager.gR);Vb.ra(ha.a.Rva,Z.a.outline,nb);Vb.ra(ha.a.Rva,Z.a.view,Sb);Vb.fb(ha.a.VJd,
Z.a.view,Sb,1124);Vb.ra(ha.a.PH,Z.a.Uc,ac);Vb.ra(ha.a.PH,Z.a.Fd,ac);Vb.ra(ha.a.PH,Z.a.Vc,e.ActionManager.gR);Vb.ra(ha.a.PH,Z.a.outline,nb);Vb.ra(ha.a.PH,Z.a.view,Sb);Vb.Xc(ha.a.PH,1124);Vb.fb(ha.a.Qcf,Z.a.view,Sb,1124);Vb.fb(ha.a.Qna,Z.a.view,ka.Qna,1028)}T6f(){}static get hi(){return v.PageNavigator.instance}static get Pf(){return null!=ka.$Eg?ka.$Eg:ka.$Eg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get fN(){return null!=ka.wFg?ka.wFg:ka.wFg=a.a.instance.resolve("Box4.Pages.IPageContentEditor")}static get BL(){return null!=
ka.WEg?ka.WEg:ka.WEg=a.a.instance.resolve("Box4.IOutlineEditor")}static get Zb(){return null!=ka.Izg?ka.Izg:ka.Izg=a.a.instance.Oa("Box4.IFeatureHelper")}static Qna(Vb,Sb,nb,ac,zc){ac=Sb.view;if(!ac.mb||!ac.mb.ib.lb||G.SelectionEditor.Pl(ac.mb.ib.lb))return 8;if(1===nb)return 32;nb=ac.mb.ib;const Ib=nb.lb;var ya=Ib.Pa,ib=null,wb=!1;if(nb.LJ){if(ya.contextId===Z.a.outline&&1===nb.length){for(Vb=m.GraphIterator.eb(ya.node);Vb.Rd();)Vb.zg();ka.BL.a8(Vb,!0);R.OutlineElementNavigator.Ee(Vb);Vb=M.SelectionFactory.ne(Vb.currentNode,
0);ac.mb.Ac(Vb);return 32}var bc=ya.node;ib=null;if(ea.c(ya)){var lc=bc.te(ac.$b);lc&&(lc=lc.iqp)&&0<=lc.width&&0<=lc.height&&(ib=new Q.a(k.a.Ql(lc.x,0),k.a.Ql(lc.y,1)));ib||(ib=Y.a(bc))}else ib=Y.a(ya.node);ya=m.GraphIterator.eb(ya.node);ya.Ip();ka.hi.V7c(ya);bc=ka.fN.zJd(ya);Y.b(bc,ib.x,ib.y);ka.BL.a8(ya,!0);ib=M.SelectionFactory.ro(bc,!0)}else if(1===nb.length){wb=nb.last;ya=V.a.kDb(wb);if(ka.Zb&&ka.Zb.isFeatureEnabled(25)&&F.ContextSetEditor.instance.Whg(ya).returnValue)return 2;wb=wb.Tc;wb=!nb.Pv&&
(G.SelectionEditor.Lk(wb)||K.ParagraphReader.vm(wb)||G.SelectionEditor.v9(wb))}wb&&(wb=G.SelectionEditor.Jj(Ib,!1,!1,void 0,!1),ac.mb.Ac(wb),l.AFrameworkApplication.va.Nf(Sb,ha.a.newLine,2,!1,null,zc),ib=ac.mb.ib.lb,ac.mb.Ac(Ib));zc||(zc=new x.DictionaryPropertySet);zc.setValue(z.a.qMc,!0);l.AFrameworkApplication.va.Nf(Sb,ha.a.PH,2,!0,null,zc);if(ib&&ib.Pa.isValid)return ac.mb.Ac(ib),32;nb.LJ&&W.instance.XGi(Vb,Sb.ik,ac);G.SelectionEditor.Pl(ac.mb.ib.lb)||l.AFrameworkApplication.va.Nf(Sb,ha.a.newLine,
2,!1,null,zc);return 32}static Zkl(Vb,Sb){if(1===Sb)return 32;Sb=new y.GraphTransaction(7);Sb.Db(Vb);ka.Pf.kza(Vb);Sb.dispose();return 32}}Object(D.a)(ka,"ADeleteActor",null,[]);var ua=c(10),sa=c(237),Da=c(260),Pa=c(1534),Ra=c(60),Ga=c(19),ta=c(112),va=c(69),ia=c(119),qa=c(700),pa=c(57);class Fa{get Yf(){return sa.a.instance}fll(Vb,Sb,nb,ac,zc){ac=null===zc||void 0===zc?void 0:zc.bed;if(1===nb)return 32;var Ib=Vb===ha.a.backspace;if(this.Yf.jh){if(this.Yf.Oyi(Sb)&&Fa.Sga&&(nb=Sb.clone(),nb.Sb+=1,
--nb.Fb,this.Yf.cec(nb)))return Fa.Sga.w$i([nb]),32;if(this.Yf.mGf(Sb,Ib))return 2}if(Fa.ix()&&Fa.ix().instance&&Fa.ix().instance.SU(Sb))return 4;var ya=Sb.node;let ib=Sb.cpBegin;nb=Sb.cpEnd;let wb=Sb.Fb,bc=Sb.Sb;const lc=K.ParagraphReader.text(ya),Kb=lc.length;let Bc=!1;if(ib===nb){if(Ib&&!ib||!Ib&&ib===Kb)return 2;Ib?({cp:ib,returnValue:Bc}=this.Yf.eQi(ya,ib),Bc||({cp:ib,mna:wb,returnValue:Bc}=this.Yf.dQi(Sb,ib,wb)),Bc||(ib--,Ga.a.Kz(lc,ib)&&ib--),Vb=ha.a.S3e):({cp:nb,returnValue:Bc}=this.Yf.mfn(ya,
nb),Bc||({cp:nb,mna:bc,returnValue:Bc}=this.Yf.lfn(Sb,nb,bc)),Bc||(nb++,Ga.a.Kz(lc,nb)&&nb++),Vb=ha.a.kRh)}Sb=ib===nb?O.a.Rc(ya,ib):O.a.createTextRange(ya,ib,nb);Bc&&this.Yf.jh&&(Ib?Sb.Fb=wb:Sb.Sb=bc);if(!this.Yf.cec(Sb))return 2;this.d2b(ya);Ib=new y.GraphTransaction(15);Ib.Uj=Vb;Ib.Db(ya);ya=Object(ta.a)(qa.a,zc)&&zc.b2a;if(!Fa.Qd.xg||ya||pa.a.xr&&Fa.EDa.N0d(V.a.instance.ib.lb))this.DRh(Sb,ac);else{ya=Fa.Qd.Q_a();try{const Xc=Fa.Gh.Ead(Sb);let vd;if(({type:vd}=Xc.gVd()).returnValue){const vc=Object(va.a)(96,
zc);vc&&vc.ja(ia.a.uEf,!1)||!pa.a.xr&&4===vd?Fa.Qd.C6a=vd:Fa.Qd.Zs(vd)}zc=0;for(let vc=Xc.length-1;0<=vc;--vc){let bd;const Sd=({s1d:bd}=Xc.getContext(vc)).returnValue;bd?(Fa.hp.lnb(Sd,null),zc+=Fa.Ej.iqb(Sd,2),Fa.Ej.ZId=nb+zc):this.DRh(Sd,ac)}}finally{ya&&ya.dispose()}}Ib.dispose();return 32}d2b(){}static get Qd(){return null!=Fa.LIg?Fa.LIg:Fa.LIg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Ej(){return null!=Fa.xIg?Fa.xIg:Fa.xIg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Gh(){return null!=
Fa.fJg?Fa.fJg:Fa.fJg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get hp(){return null!=Fa.lBg?Fa.lBg:Fa.lBg=a.a.instance.resolve("Box4.IHyperlinkEditor")}static ix(){return Fa.en||(Fa.en=a.a.instance.Ta("Box4.IExternalSelectionManager"))}static get Sga(){Fa.lvb||(Fa.lvb=a.a.instance.Ta("Box4.ContentControl.IContentControlOperator"));return Fa.lvb.instance}static get EDa(){return null!=Fa.Owg?Fa.Owg:Fa.Owg=a.a.instance.resolve("Box4.IContentControlViewElementManager")}}
Fa.en=null;Fa.lvb=null;Object(D.a)(Fa,"ADeleteParagraphContentStrategy",null,[]);var za=c(172),Oa=c(818),xa=c(137),fa=c(228),Ka=c(78),lb=c(75),Xa=c(83);class kb extends Fa{constructor(){super()}get jg(){return null!=this.Vwg?this.Vwg:this.Vwg=a.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get Yq(){return null!=this.Lwg?this.Lwg:this.Lwg=a.a.instance.Ta("Box4.ContentControlConfigSettings")}get agc(){return null!=this.JEg?this.JEg:this.JEg=a.a.instance.resolve("Box4.Proofing.IModifiedRangeEditor")}get DX(){return null!=
this.uxg?this.uxg:this.uxg=a.a.instance.resolve("Box4.IContentControlChpHelper")}get pca(){return null!=this.Vzg?this.Vzg:this.Vzg=a.a.instance.resolve("Box4.IFieldEditor")}DRh(Vb,Sb){this.qkl(Vb,Sb)}LAk(Vb,Sb,nb,ac){this.Yq.instance&&this.Yq.instance.jh&&(Vb.cpBegin===Sb.cpBegin?Vb.Fb=Sb.Fb:nb&&(Vb.Fb=nb.Jb&&nb.Jb.length?0:-1),Vb.Sb=ac)}d2b(Vb){const {DeleteActor:Sb}=c(1619);Sb.d2b(Vb)}qkl(Vb,Sb){var nb=Vb.node;const ac=fa.b([new za.a(Vb.cpBegin,Vb.cpEnd)],this.rjm(Vb));var zc=new Xa.a,Ib=[];kb.B0k(nb,
ac,zc,Ib);for(const ya of zc.keys)1<zc.J(ya)&&Oa.a.FTi(Ra.a.If(ya));this.a_n(nb,Ib);this.agc.NIc(nb);nb=Vb.Sb;zc=!!this.Yq.instance&&this.Yq.instance.jh;for(Ib=ac.length-1;0<=Ib;Ib--)nb=this.deleteRange(Vb,ac[Ib],nb,zc,Sb)}rjm(Vb){const Sb=[],nb=Vb.node;var ac=Ka.f(nb,ya=>ya.lna);for(var zc of ac)ac=zc.Lb.cp,Sb.push(new za.a(ac,ac+1));zc=[];xa.a.dL?this.pca&&(zc=this.pca.Iqf(nb,Vb)):zc=K.ParagraphReader.dQa(nb);for(var Ib of zc)this.fRm(Ib,Vb)&&Sb.push(Ib);Ib=!!this.Yq.instance&&this.Yq.instance.wpa;
this.Yq.instance&&this.Yq.instance.jh||!Ib||!nb.Ms||(kb.pJh&&kb.pJh.ZYn(Vb),this.DX&&Sb.push(...this.DX.wpf(nb).toArray()));return fa.a(Sb)}fRm(Vb,Sb){return xa.a.dL?this.pca?!this.pca.dxi(Vb,Sb):!1:!Vb.bL||!kb.$Ef(Vb,Sb)}a_n(Vb,Sb){const nb=new lb.a;for(const ac of Sb)for(Sb=0;Sb<ac.length;){Sb=this.Mai(ac,Sb,0);if(-1===Sb)break;let zc=this.Mai(ac,Sb+1,3);if(-1===zc)break;if(ac.J(Sb).bL)for(;zc>=Sb;){const Ib=ac.J(zc);nb.add(Ib.qe);ac.remove(Ib);zc--}Sb=zc+1}Vb.Zqa(nb)}Mai(Vb,Sb,nb){for(;Sb<Vb.length;Sb++){const ac=
Vb.J(Sb);if(1===ac.ZB&&ac.uf===nb)return Sb}return-1}deleteRange(Vb,Sb,nb,ac,zc){const Ib=Sb.Ec,ya=Sb.end;Sb=null;ac&&(Sb=Vb.node.qa.nh(Ib));Ib<ya&&(ac=O.a.createTextRange(Vb.node,Ib,ya),this.LAk(ac,Vb,Sb,nb),this.jg.Ge(ac,"",void 0,void 0,ha.a.hHc,!1,zc));return nb=Sb&&Sb.Jb&&Sb.Jb.length?Sb.Jb.length:-1}static get pJh(){return null!=kb.Dxg?kb.Dxg:kb.Dxg=a.a.instance.Oa("WordEditor.ContentControl.IContentControlOperator")}static $Ef(Vb,Sb){return Vb.Ec>=Sb.cpBegin&&Vb.end<=Sb.cpEnd}static B0k(Vb,
Sb,nb,ac){let zc=0;Vb=Vb.qa;for(const Ib of Sb)for(;zc<Vb.length;){Sb=Vb.J(zc);if(Sb.cp>=Ib.Ec&&Sb.cp<Ib.end&&(Sb.Hc&&Sb.Hc.o5k&&ac.push(Sb.Hc),Sb.$g))for(let ya=0;ya<Sb.$g.length;ya++){const ib=Sb.$g.J(ya).xn.toString();nb.nb(ib)?nb.Z(ib,nb.J(ib)+1):nb.Z(ib,1)}++zc}}}Object(D.a)(kb,"DeleteParagraphContentStrategy",Fa,[]);class Bb{static get hH(){return Da.a.instance}static Cll(Vb,Sb,nb){if(1===nb)return 32;Vb=Sb.node;return Bb.hH.cFd(Vb)?ka.Zkl(Vb,nb):32}}Object(D.a)(Bb,"DeleteUnsupportedObjectStrategy",
null,[]);var Ja=c(173),Ma=c(311),fb=c(192),hc=c(375),cc=c(7),mb=c(1054),Hb=c(877),Ua=c(40),Ya=c(118),Fb=c(403),Wa=c(534),yb=c(1643),Yb=c(136),qc=c(445),Hc=c(855),$b=c(169),Ub=c(142),mc=c(206),ic=c(509),ab=c(32),bb=c(124);class Jb{constructor(Vb,Sb,nb,ac,zc){this.s3o=Vb;this.x$=nb;this.vd=ac;this.actionId=Sb;this.bed=zc}}Object(D.a)(Jb,"DeleteActionData",null,[]);var Eb=c(1030);class hb{constructor(Vb,Sb,nb,ac,zc,Ib,ya,ib,wb,bc){this.ERh=Vb;this.Yf=Sb;this.hH=nb;this.hp=ac;this.z0=zc;this.ij=Ib;this.I0i=
ya;this.jg=ib;this.Qd=wb;this.EDa=bc}RMo(Vb){return!G.SelectionEditor.vl(Vb)&&!G.SelectionEditor.ada(Vb)}Ydm(Vb,Sb,nb){var ac;let zc,Ib,ya;if(!Sb&&Vb&&Vb.Yw&&(ac=Vb.Pa)&&G.SelectionEditor.Ze(ac)&&this.ij.Xb(ac.node)&&(zc=ac.node.qa.nh(ac.cpBegin))&&zc.Cm&&(Ib=this.zRl(zc))&&Ib.hyperlink.PG&&(ya=this.Mdm(Vb,Ib.cp)))return ya;if(!Vb)return null;if(pa.a.Xj&&(ac=this.LQo(Vb,Sb)))return ac;if(!nb)return Vb;Sb=G.SelectionEditor.ZEa(Vb,!Sb,{UA:!1,Ps:!0,WC:!0,rE:!0});return M.SelectionFactory.Gy(Vb,Sb.Pa,
!1)}zRl(Vb){const Sb=Vb.paragraph.qa;let nb=null;Vb=Vb.cp;for(let ac=0;ac<Sb.length;ac++){const zc=Sb.J(ac);if(zc.cp>=Vb)break;zc.Cm&&(nb=null);zc.hyperlink&&(nb=zc)}return nb}Pdm(Vb,Sb){var nb=Vb.Pa.node;if(Sb){if(Sb=G.SelectionEditor.JUa(Vb.Pa.node,Vb.Pa.cpBegin,!0),Vb=M.SelectionFactory.Gy(Vb,O.a.Rc(Vb.Pa.node,Sb),!1),nb=nb.qa.nh(Sb),nb.K0||nb.PU)Vb.Pa.Fb=0}else if(Sb=G.SelectionEditor.JUa(Vb.Pa.node,Vb.Pa.cpBegin,!1),Vb=M.SelectionFactory.Gy(Vb,O.a.Rc(Vb.Pa.node,Sb),!1),nb=nb.qa.nh(Sb),nb.K0||
nb.PU)Vb.Pa.Fb=nb.Gw+nb.wN;Vb.Tcc=!0;return Vb}LQo(Vb,Sb){var nb=Vb.Pa;let ac=null;if(!Vb.Yw||!nb||!G.SelectionEditor.Ze(nb))return null;if(this.ij.Xb(nb.node)&&(ac=Sb?nb.node.qa.nh(nb.cpBegin):nb.node.qa.bjb(nb.cpBegin-1))&&ac.MR)return this.Pdm(Vb,Sb);nb=m.GraphIterator.eb(Vb.Pa.node);if(!nb.zb(8))return null;R.OutlineElementNavigator.Yd(nb);let zc=!1;const Ib=[];if(Sb?ac&&ac.Ph:0===Vb.Pa.cpBegin){do(Vb=Sb?R.OutlineElementNavigator.ns(nb,!0,!0,!1):R.OutlineElementNavigator.h1(nb,!0,!0,!1))&&(null===
Vb||void 0===Vb?0:Vb.SQa)?(Ib.push(O.a.create(R.OutlineElementNavigator.Ee(nb))),R.OutlineElementNavigator.Yd(nb)):zc=!0;while(!zc);if(0<Ib.length)return Sb=new $b.Selection(Sb?Ib:Ib.reverse(),Sb),Sb.Tcc=!0,Sb}return null}Mdm(Vb,Sb){var nb=G.SelectionEditor.$Ea(Vb,{UA:!1,Ps:!1,WC:!0,rE:!0});if(!nb||!nb.Yw||nb.Pa.node!==Vb.Pa.node)return null;nb=nb.Pa;if(nb.cpBegin!==nb.cpEnd)return null;const ac=this.ij.text(nb.node);for(let zc=nb.cpBegin-1;zc>=Sb;zc--)if(!Ga.a.Qv(ac.charCodeAt(zc)))return M.SelectionFactory.Gy(Vb,
O.a.Rc(nb.node,zc+1),!1);return M.SelectionFactory.Gy(Vb,O.a.Rc(nb.node,Sb),!1)}Gef(Vb,Sb,nb,ac,zc){var Ib,ya;if(1===nb)return 32;(nb=null===(ya=null===(Ib=Sb.view)||void 0===Ib?void 0:Ib.mb)||void 0===ya?void 0:ya.qg)&&F.ContextSetEditor.instance.bQh(nb).filter(K.ParagraphReader.OU).forEach(ib=>{var wb;return null===(wb=K.ParagraphReader.gQa(ib.node))||void 0===wb?void 0:wb.Vhe("delete_selection")});ya=!1;Vb===ha.a.Qcf?(Vb=ha.a.PH,ya=!0):Vb===ha.a.VJd?(Vb=ha.a.backspace,ya=!0):Vb===ha.a.Rva&&(Sb=
new Wa.a(ua.App.za.jb.rc));if(!Sb.view.ue)return 2;Ub.GrippersManager.instance.kC(!1);Ib=Vb===ha.a.PH;nb=mc.a.j$h(Sb);if(ya&&this.Yf.jh&&nb&&G.SelectionEditor.Pl(nb)&&this.Yf.mGf(nb.Pa,!Ib,!0))return 2;ya=this.Ydm(nb,Ib,ya);return this.Ell(Vb,Sb,ac,zc,ya,Ib)}Ell(Vb,Sb,nb,ac,zc,Ib){var ya;const ib=Sb.view,wb=ib.mb;var bc=ac,lc=ac;Vb===ha.a.Rva&&(lc=bc=null,zc=new $b.Selection(ac,!0));if(!zc)return 32;const Kb=this.Uro(bc,Ib);if(this.Yf.jh&&hb.Sga&&1===wb.ib.length&&G.SelectionEditor.Pl(zc)&&zc.Yw&&
hb.Sga.uco(zc.Pa,Ib)||xa.a.dL&&hb.pca&&1===wb.ib.length&&G.SelectionEditor.Pl(zc)&&zc.Yw&&hb.pca.vco(zc.Pa,Ib))return 32;let Bc;Ib?Ja.a.mark(Bc=5009):Ja.a.mark(Bc=5011);bc=new y.GraphTransaction(15);bc.Uj=Vb;bc.Db(ib.ed);let Xc=null,vd=({Yao:Xc}=this.xTl(Vb,ac,wb,zc,Xc)).returnValue;var vc=null;({Cje:vc}=F.ContextSetEditor.instance.Whg(vd)).returnValue&&(vd=vc);if(!vd)return bc.dispose(),32;vc=!1;l.AFrameworkApplication.oe("b1jb9393;09icj321");if(null===(ya=l.AFrameworkApplication.K)||void 0===ya?
0:ya.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",!1))ya=vd.node,vc=null===ya||void 0===ya?void 0:ya.Ms;const bd=new Jb(Sb,Vb,nb,lc,vc);this.Yf.jh&&hb.Sga&&(lc=F.ContextSetEditor.instance.vO(vd),hb.Sga.w$i(lc));this.cBj(vd);const Sd=this.iQd(vd,zc,Ib);let pd=null;Ib?pd=new Hc.a(zc):Sd&&(pd=new Hc.a(Sd));let Tc=!1;lc=hb.Ik;if(G.SelectionEditor.Ze(vd)){const Wc=Eb.a.p$b(ib.ed,Kb);lc.ie(()=>{this.lkl(Sb,nb,ac,vd,Ib,pd,zc,Wc,wb,Kb,bd,Sd)},"DVS:DAIPC")}else!this.Qd.xg||
pa.a.xr&&this.EDa.N0d(zc)?lc.ie(()=>{Tc=this.Z1i(Vb,ib.ed,vd,wb,Kb,bd,pd,Xc)},"DVS:PUD"):(lc.ie(()=>{this.QMo(Vb,ib.ed,vd,Ib,zc,wb,Kb,bd,pd)},"DVS:TCDC"),Tc=!0);this.dGl(wb);this.xej(vd);bc.dispose();Ja.a.mark(Bc+1);return Vb===ha.a.Rva?Tc?32:8:32}Z1i(Vb,Sb,nb,ac,zc,Ib,ya,ib){Sb=Eb.a.p$b(Sb,zc);this.RMo(nb)&&Sb.X8a(nb);Vb=hb.Ic.Fp(Vb);Vb.properties.Z("CountOfParagraphsDeleted",this.ij.zaf(nb).toString());nb=this.Rpl(nb,ac,zc,Sb,Ib,ya,ib);Vb.end();return nb}QMo(Vb,Sb,nb,ac,zc,Ib,ya,ib,wb){var bc=0,
lc=null;const Kb=F.ContextSetEditor.instance.vO(nb),Bc=Kb[Kb.length-1];if(Bc.contextId===Z.a.paragraph||Bc.contextId===Z.a.Vc){var Xc=m.GraphIterator.eb(Bc.node);Xc.qd();R.OutlineElementNavigator.Yd(Xc);R.OutlineElementNavigator.ns(Xc,!0,!1)&&(lc=R.OutlineElementNavigator.Ee(Xc))&&(bc=this.ij.textLength(lc))}else bc=this.ij.textLength(Bc.node)-Bc.cpEnd;Xc=Object(va.a)(96,ib.vd);if(Xc=!!Xc&&Xc.ja(ia.a.uEf,!1))this.X1i(Vb,Sb,nb,Ib,ya,ib,wb,!1,Xc);else{Xc=this.Qd.Q_a();try{this.X1i(Vb,Sb,nb,Ib,ya,ib,
wb,!0)}finally{Xc&&Xc.dispose()}}if(pa.a.Xj&&zc.Tcc)bc=this.iQd(nb,zc,ac),this.ij.Xb(bc.Pa.node)&&V.a.instance.Ac(bc);else{if(ac){if(nb.jx){Vb=Kb.length-1;do zc=Kb[Vb],Vb--;while(!zc.node.isConnected&&0<=Vb)}else zc=nb;if(!this.ij.Xb(zc.node))return;switch(Bc.contextId){case Z.a.paragraph:case Z.a.Vc:bc=lc&&lc.isConnected?0:bc;break;case Z.a.Uc:case Z.a.Fd:break;default:bc=0}bc=M.SelectionFactory.ne(zc.node,this.ij.textLength(zc.node)-bc);zc.Wj===bc.Pa.cpBegin&&(bc.Pa.Fb=zc.Fb)}else{bc=zc.Pa.node;
if(!this.ij.Xb(bc))return;lc=zc.Pa.contextId===Z.a.paragraph?0:zc.Pa.contextId===Z.a.Vc?this.ij.textLength(bc):zc.Pa.cpBegin;bc=M.SelectionFactory.ne(bc,lc)}V.a.instance.Ac(bc)}}X1i(Vb,Sb,nb,ac,zc,Ib,ya,ib,wb=!1){nb=this.AKl(ac,nb);nb=hb.Gh.Ead(nb);({type:lc}=nb.gVd()).returnValue&&(ib&&4!==lc?this.Qd.Zs(lc):pa.a.xr||(this.Qd.C6a=lc));for(ib=nb.length-1;0<=ib;--ib){var bc=void 0;var lc=({s1d:bc}=nb.getContext(ib)).returnValue;bc?(bc=wb&&lc.contextId===Z.a.Vc&&ib===nb.length-1,this.hp.lnb(lc,2),bc||
hb.Ej.iqb(lc,2)):this.Z1i(Vb,Sb,lc,ac,zc,Ib,ya,null)}}AKl(Vb,Sb){if(Object(ta.a)(Fb.a,Sb)){Vb=qc.OutlineElementGeneralizer.Aha(Vb.ib,!0);for(let nb=0;nb<Vb.length;nb++)if(Vb.getContext(nb).contextId===Z.a.table)return Vb}return Sb}xTl(Vb,Sb,nb,ac,zc){Vb===ha.a.Rva?(Vb=Ma.a.kEa(Sb),zc=ic.SelectionReferenceFactory.instance.pDb()):(zc=null,Vb=1===nb.ib.length?V.a.kDb(ac):nb.qg);return{returnValue:Vb,Yao:zc}}MSk(Vb){return!Vb.el||Vb.contextId!==Z.a.paragraph||!this.ij.Xb(Vb.node)||this.Qd.xg||this.Yf.m0d(Vb)?
!1:!0}cBj(Vb){if(Vb.jx)for(let Sb=0;Sb<Vb.length;Sb++)this.cBj(Vb.getContext(Sb));else this.MSk(Vb)&&(Vb.node.dFd=!0)}xej(Vb){if(Vb.jx)for(let Sb=0;Sb<Vb.length;Sb++)this.xej(Vb.getContext(Sb));else Vb.el&&(Vb=Vb.node)&&this.ij.Xb(Vb)&&(Vb.dFd=!1)}iQd(Vb,Sb,nb){if(Vb.el&&G.SelectionEditor.Ze(Vb)&&!nb){const ac=Vb.node;let zc=Vb.cpBegin,Ib=-1;if(({cp:zc}=this.Yf.eQi(ac,zc)).returnValue)return M.SelectionFactory.ne(ac,zc);if(({cp:zc,mna:Ib}=this.Yf.dQi(Vb,zc,Ib)).returnValue)return Sb=M.SelectionFactory.ne(ac,
zc),Sb.Pa.Fb=Ib,Sb.Pa.Sb=Ib,Sb}Sb=pa.a.Xj?G.SelectionEditor.ZEa(Sb,!nb,{UA:!Sb.Tcc||Sb.Yw,Ps:!1,WC:!1,rE:!0,dva:G.SelectionEditor.Pl(Sb)}):G.SelectionEditor.ZEa(Sb,!nb,{UA:!0,Ps:!1,WC:!1,rE:!0});this.Yf.jh&&G.SelectionEditor.vl(Vb)&&(Sb.Pa.Sb=Sb.Pa.Fb=nb?Vb.Sb:Vb.Fb);return Sb}lkl(Vb,Sb,nb,ac,zc,Ib,ya,ib,wb,bc,lc,Kb){const Bc=hb.Ik;!G.SelectionEditor.KA(ac.node,ac,zc)||this.Yf.jh&&this.Yf.Oyi(ac)?Bc.ie(()=>{this.Rkl(ac,zc,Ib,ya,ib,wb,bc,lc)},"DVS:IPM"):Bc.ie(()=>{const {response:Xc,nZ:vd}=this.Qkl(Vb,
Sb,nb,ac,zc,ya,ib,wb,lc,Kb);hb.bSi(ib,32===Xc);vd&&hb.cra(wb,Ib)},"DVS:ISE")}Cpm(Vb,Sb){Yb.a.DY&&(Sb.vd||(Sb.vd=new x.DictionaryPropertySet),Sb.vd.setValue(ia.a.cqa,"delete"),Sb.vd.setValue(ia.a.Jia,"backspace"));var nb=Vb.ND;const ac=hb.Jd.dY(nb),zc=yb.a.o_m;if(null===zc||void 0===zc?0:zc.nTm(nb,ac)){Yb.a.DY&&Sb.vd.setValue(ia.a.Jia,"backspace-autocorrect");nb=zc.MBj+" ";const Ib=O.a.Rc(Vb,0);this.jg.Ge(Ib,nb);Vb=M.SelectionFactory.ne(Vb,nb.length);V.a.instance.Ac(Vb);cc.ULS.sendTraceTag(540386467,
393,50,"Unlisted list with trigger string: {0}",zc.MBj)}return l.AFrameworkApplication.va.Nf(Sb.s3o,ac.Lz?ha.a.LL:ha.a.rD,2,!1,Sb.x$,Sb.vd)}$om(Vb,Sb,nb,ac,zc){let Ib=!1;0<this.I0i.F4(Vb).Wt&&(zc=l.AFrameworkApplication.va.Nf(Sb,ha.a.pjc,2,!1,nb,ac),Ib=!0);return{DU:Ib,response:zc}}gpm(Vb,Sb,nb,ac,zc){let Ib=!1;0<this.I0i.IG(Vb).Wt&&(zc=l.AFrameworkApplication.va.Nf(Sb,ha.a.K6c,2,!1,nb,ac),Ib=!0);return{DU:Ib,response:zc}}nqm(Vb,Sb,nb,ac,zc){let Ib=!1;hb.qq.bCb(Vb)&&(zc=l.AFrameworkApplication.va.Nf(Sb,
ha.a.ZG,2,!1,nb,ac),Ib=!0);return{DU:Ib,response:zc}}Inm(Vb,Sb,nb,ac,zc,Ib,ya,ib,wb,bc){const lc=new Ya.a;lc.kd(Sb);let Kb=!1;if(R.OutlineElementNavigator.oHa(lc,!1,!Vb,!1)){bc=!0;wb=32;Kb=!0;(new m.GraphIterator).kd(lc);R.OutlineElementNavigator.Ee(lc);const Xc=lc.currentNode;K.ParagraphReader.uva(Xc)&&K.ParagraphReader.gQa(Xc).Vhe("delete_ip");var Bc=new m.GraphIterator;Bc.set(ya);(Bc=this.ij.isEmpty(Bc))&&zc&&G.SelectionEditor.v9(zc.Pa)?(nb.X8a(Ib),R.OutlineElementNavigator.Ee(Sb),hb.Pf.kza(Sb.currentNode)):
Xc.JJ?(nb.X8a(Ib),R.OutlineElementNavigator.Yd(lc),lc.zg()):Vb&&Bc?this.Yf.jBi(ya)&&!({nZ:bc}=this.M4i(Vb,ya,Xc,zc,bc)).returnValue&&(nb.X8a(Ib),hb.Qn.Yda(Sb),this.ERh.tGn(ya),Sb.zg()):ab.TableReader.isTable(lc)?(nb.X8a(Ib),Vb&&(ba.moveToFirstRow(lc),ba.moveToFirstColumn(lc),S.OutlineNavigator.S9(lc),R.OutlineElementNavigator.Ee(lc),ib.Ac((new Hc.a(M.SelectionFactory.ne(lc.currentNode,0))).restore())),wb=2,bc=!1):this.ij.Xb(Xc)&&(1==this.ij.textLength(Xc)&&(ib=Ka.e(Xc),1==ib.length&&8==ib[0].vh&&
(ib=O.a.createTextRange(Xc,0,1),this.jg.Ge(ib,"",void 0,void 0,ha.a.hHc))),({nZ:bc}=this.M4i(Vb,ya,Xc,zc,bc)).returnValue||(ac.actionId==ha.a.backspace&&nb.boc(ya),this.ERh.mkl(Vb,nb,Ib,Sb,ya,lc)))}return{DU:Kb,response:wb,nZ:bc}}M4i(Vb,Sb,nb,ac,zc){if(this.Qd.xg){if(hb.wva){const Ib=Object(ta.a)(bb.AParagraphNode,nb)?hb.wva.CXc(nb):!1,ya=Object(ta.a)(bb.AParagraphNode,Sb)?hb.wva.CXc(Sb):!1;if(Ib!==ya)return{returnValue:!1,nZ:zc};if(!pa.a.xr&&ya)return this.Yf.jh&&hb.hHk(Sb,nb,Vb)&&this.Qd.Zs(4),
{returnValue:!1,nZ:zc}}Vb=Vb?Sb:nb;if(!Object(ta.a)(bb.AParagraphNode,Vb))return{returnValue:!1,nZ:zc};Sb=Vb.qa.last;nb=l.AFrameworkApplication.userName;if(!Sb.zi||Sb.zi.authorName!==nb)return hb.Ej.HQb(Vb,2),ac&&(V.a.instance.Ac(ac),zc=!1),{returnValue:!0,nZ:zc}}return{returnValue:!1,nZ:zc}}vpm(Vb,Sb,nb,ac,zc,Ib,ya,ib){Ua.OutlineElementReader.WMm(Sb,Vb)||({response:ya,nZ:ib}=hb.Mql(nb,ac,Vb,Ib,zc,ya,ib));return{DU:!1,response:ya,nZ:ib}}Qkl(Vb,Sb,nb,ac,zc,Ib,ya,ib,wb,bc){let lc=!1,Kb=2;const Bc=ac.node;
let Xc=void 0,vd=!1;const vc=hb.Ik;if(!zc){if(Bc.ND)return vc.ie(()=>{Kb=this.Cpm(Bc,wb)},"DVS:HLOE"),{response:Kb,nZ:lc};vc.ie(()=>{({response:Kb,DU:vd}=this.$om(Bc,Vb,Sb,nb,Kb))},"DVS:HIOD");if(vd)return{response:Kb,nZ:lc};vc.ie(()=>{({response:Kb,DU:vd}=this.gpm(Bc,Vb,Sb,nb,Kb))},"DVS:HWPF");if(vd)return{response:Kb,nZ:lc};Xc=this.sbi(Bc);vc.ie(()=>{({response:Kb,DU:vd}=this.nqm(Xc,Vb,Sb,nb,Kb))},"DVS:HPOB");if(vd)return{response:Kb,nZ:lc}}null!==Xc&&void 0!==Xc?Xc:Xc=this.sbi(Bc);vc.ie(()=>{({response:Kb,
DU:vd,nZ:lc}=this.Inm(zc,Xc,ya,wb,bc,ac,Bc,ib,Kb,lc))},"DVS:HAOE");if(vd)return{response:Kb,nZ:lc};vc.ie(()=>{({response:Kb,DU:vd,nZ:lc}=this.vpm(zc,Xc,Sb,nb,ya,Ib,Kb,lc))},"DVS:HFLOE");return{response:Kb,nZ:lc}}dso(Vb){return G.SelectionEditor.vl(Vb)||this.hH.wEi(Vb)||G.SelectionEditor.ada(Vb)}Uro(Vb,Sb){return Vb&&Vb.hasProperty(z.a.qMc)?!Vb.ja(z.a.qMc,!1):!Sb}static get Jd(){return null!=hb.sEg?hb.sEg:hb.sEg=a.a.instance.resolve("Box4.List.IListReader")}static get Qn(){return null!=hb.jEg?hb.jEg:
hb.jEg=a.a.instance.resolve("Box4.List.IListEditor")}static get Pf(){return null!=hb.hFg?hb.hFg:hb.hFg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get qq(){return mb.a.MGb}static get Ej(){return null!=hb.AIg?hb.AIg:hb.AIg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Gh(){return null!=hb.iJg?hb.iJg:hb.iJg=a.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get Ic(){return fb.a.instance}static get Sga(){hb.lvb||(hb.lvb=
a.a.instance.Ta("Box4.ContentControl.IContentControlOperator"));return hb.lvb.instance}static get pca(){hb.inf||(hb.inf=a.a.instance.Ta("Box4.IFieldEditor"));return hb.inf.instance}static get wva(){return null!=hb.Ixg?hb.Ixg:hb.Ixg=a.a.instance.Oa("Box4.IContentControlReader")}static get Ik(){return hc.a.instance}dGl(Vb){if(1===Vb.ib.length&&(Vb=Vb.ib.J(0),G.SelectionEditor.Pl(Vb))){var Sb=Vb.Pa;Vb=Sb.node;Sb=Sb.cpBegin;var nb=this.ij.text(Vb);Sb<nb.length&&0<Sb&&" "===nb.charAt(Sb-1)&&" "===nb.charAt(Sb)&&
this.jg.Ge(O.a.createTextRange(Vb,Sb-1,Sb),"\u00a0")}}CJk(Vb,Sb){if(!Sb.hyperlink.C4a){const nb=new y.GraphTransaction(15);try{nb.Db(Vb.node),this.z0.iS(Vb,Sb)}finally{nb&&nb.dispose()}Sb.hyperlink.PG&&this.Qd.Zs(2)}}static Mql(Vb,Sb,nb,ac,zc,Ib,ya){if(nb=G.SelectionEditor.ZEa(ac,!nb,{UA:!1,Ps:!1,WC:!1,rE:!0})){ac=M.SelectionFactory.Gy(ac,nb.Pa);Ib=32;for(nb=0;nb<ac.length;++nb){zc.X8a(ac.J(nb));const ib=l.AFrameworkApplication.va.Nf(ac.J(nb),ha.a.PH,2,!0,Vb,Sb);2!==ib&&(Ib=ib)}32===Ib&&(ya=!0)}return{response:Ib,
nZ:ya}}Rpl(Vb,Sb,nb,ac,zc,Ib,ya){let ib=!1;this.eso(Vb)?(ib=hb.Zff(Vb,!0,Sb,nb,ac,zc))&&hb.WJa(Ib,Sb,ya):this.dso(Vb)?(ib=hb.Zff(Vb,!1,Sb,nb,ac,zc))&&hb.WJa(Ib,Sb,ya):(ac.normalize(),hb.WJa(Ib,Sb,ya));return ib}static WJa(Vb,Sb,nb){nb&&nb.cra()||hb.cra(Sb,Vb)}static Zff(Vb,Sb,nb,ac,zc,Ib){var ya;ac||N.OutlineReader.CRa(Vb)||(nb=hb.Ycd(nb))&&zc.qoo(nb);l.AFrameworkApplication.oe("b1jb9393;09icj321");if(null===(ya=l.AFrameworkApplication.K)||void 0===ya?0:ya.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReplaceTextWriterEnabled",
!1))Ib.vd?Ib.vd.bed=Ib.bed:Ib.vd={bed:Ib.bed};ya=Vb instanceof Fb.a?Vb.getContext(0).node:Vb.node;ya=hb.X7l(ya);Vb=32===l.AFrameworkApplication.va.Nf(Vb,Ib.actionId,2,Sb,Ib.x$,Ib.vd);hb.bSi(zc,Vb,ya);return Vb}static get qn(){return null!=hb.FAg?hb.FAg:hb.FAg=a.a.instance.resolve("Box4.IFormattingEditor")}static get UUa(){return null!=hb.sHg?hb.sHg:hb.sHg=a.a.instance.resolve("Box4.Styles.IWACStyleReader")}static X7l(Vb){const Sb=new Hb.a;if(Vb){let nb=null;Vb=M.SelectionFactory.ro(Vb,!0);if(!Vb)cc.ULS.sendTraceTag(509645905,
315,10,"Unexpected null selection.");else for(let ac=0;ac<Vb.length;ac++)if(L.FormattingReader.v$e(Vb.J(ac))){nb=Vb.J(ac);break}nb&&((Vb=L.FormattingReader.Yr(nb))&&Vb.cache&&Vb.cache.UB&&(Vb=Vb.vf(null),hb.qn.F5(Vb)),Vb&&(Sb.formatting=Vb.Yj,Sb.languageId=L.FormattingReader.language(Vb)),Sb.Pka=hb.UUa.So(nb.node))}return Sb}static bSi(Vb,Sb,nb){Sb?Vb.normalize(nb):Vb.cancel()}static cra(Vb,Sb){Sb&&hb.Ik.ie(()=>{const nb=Sb.restore();nb&&Vb.Ac(nb)},"DVS:RS")}Rkl(Vb,Sb,nb,ac,zc,Ib,ya,ib){let wb;!Sb&&
({hyperlink:wb}=this.z0.edc(Vb)).returnValue?(nb=new Hc.a(ac),this.CJk(Vb,wb),zc.normalize(),hb.cra(Ib,nb)):hb.Zff(Vb,!1,Ib,ya,zc,ib)&&(Sb&&this.Qd.xg?(Sb=hb.Ej.ZId)?(Ib.Ac(M.SelectionFactory.ne(Vb.node,Sb)),hb.Ej.ZId=null):hb.cra(Ib,nb):hb.cra(Ib,nb))}static hHk(Vb,Sb,nb){nb?(nb=Vb,Vb=Sb):nb=Sb;Sb=hb.wva.zdc(nb,!1);Vb=hb.wva.zdc(Vb,!0);return!(Sb&&Vb)}eso(Vb){return Vb.jx||N.OutlineReader.CRa(Vb)||this.ij.vm(Vb)}static Ycd(Vb){return(Vb=qc.OutlineElementGeneralizer.Aha(Vb.ib,!0))&&1===Vb.length&&
(Vb=Vb.getContext(0).node,ab.TableReader.KR(Vb))?Vb:null}sbi(Vb){const Sb=new m.GraphIterator;Sb.set(Vb);Sb.qd();R.OutlineElementNavigator.Yd(Sb);return Sb}}hb.lvb=null;hb.inf=null;Object(D.a)(hb,"ADeleteViewStrategy",null,[]);class ob{mkl(Vb,Sb,nb,ac,zc,Ib){const ya=Ib.currentNode;R.OutlineElementNavigator.Yd(Ib);Vb?(Sb.boc(Ib.currentNode),ob.Yf.Yzi(nb,zc,ya,!1)||ob.Pf.merge(ac,Ib,!1,!1)):ob.Yf.Yzi(nb,ya,zc,!0)||ob.Pf.merge(Ib,ac,!1,!1)}tGn(Vb){Vb&&K.ParagraphReader.Xb(Vb)&&(Pa.a.E6c(Vb),ob.Btl.V0e(Vb))}static get Pf(){return null!=
ob.cFg?ob.cFg:ob.cFg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get Btl(){return null!=ob.uyg?ob.uyg:ob.uyg=a.a.instance.resolve("Box4.IDynamicRangeEditor")}static get Yf(){return sa.a.instance}}Object(D.a)(ob,"DeleteParagraphNodeStrategy",null,[364]);class Va extends hb{constructor(Vb,Sb,nb,ac,zc,Ib,ya,ib,wb){super(new ob,Vb,Sb,nb,ac,zc,Ib,ya,ib,wb)}}Object(D.a)(Va,"DeleteViewStrategy",hb,[]);c.d(I,"DeleteActor",function(){return Qb});class Qb extends ka{constructor(Vb,Sb,nb,ac,zc,
Ib,ya,ib,wb,bc,lc,Kb){super();this.deleteParagraph=(Bc,Xc)=>{Bc=Xc.node;Pa.a.E6c(Bc);this.bAe.V0e(Bc);this.An&&this.An.instance&&this.An.instance.bXi(Bc);Bc.Ms&&(this.km.YYn(Bc,!this.jh),this.jh&&this.SWg.instance&&this.SWg.instance.vFj(Bc));return 0};this.PKd=(Bc,Xc,vd)=>{2==vd&&(Bc=l.AFrameworkApplication.breadcrumbFolderUrl,Bc&&0!=Bc.length||(Bc=l.AFrameworkApplication.breadcrumbBrandUrl),ua.App.nFb(Bc));return 32};this.kkl=(Bc,Xc,vd)=>{({DeleteActor:Bc}=c(1619));if(1===vd)return 32;vd=ua.App.za.Lq.Zf("ModelUpdate",
"DeleteAnchoredObject");Xc=Xc.node;const vc=new m.GraphIterator;vc.set(Xc);vc.zb(12);const bd=vc.ko(12);if(sa.a.instance.AXc(bd))return 2;Bc.d2b(bd);Bc=new y.GraphTransaction(7);Bc.Db(Xc);vc.zg();Bc.dispose();vd.stop();return 32};this.I0j=new kb;this.J0j=new Va(sa.a.instance,Da.a.instance,Ib,ya,ib,wb,bc,lc,Kb);this.km=Vb;this.Nvc=Sb;this.SWg=nb;this.bAe=ac;this.An=zc}get jh(){return this.Nvc.instance?this.Nvc.instance.jh:!1}get NRh(){return this.J0j}get CRh(){return this.I0j}T6f(Vb,Sb,nb,ac){const zc=
Bb.Cll,Ib=this.kkl;Vb.ra(ha.a.backspace,Z.a.X7,Ib);Vb.ra(ha.a.backspace,Z.a.unsupportedObject,zc);Vb.ra(ha.a.PH,Z.a.X7,Ib);Vb.ra(ha.a.PH,Z.a.unsupportedObject,zc);Vb.ra(ha.a.backspace,Z.a.paragraph,this.deleteParagraph);Vb.ra(ha.a.PH,Z.a.paragraph,this.deleteParagraph);Vb.ra(ha.a.Rva,Z.a.paragraph,this.deleteParagraph);Vb.ra(ha.a.PKd,Z.a.view,this.PKd);Vb.Xc(ha.a.Rva,64);super.T6f(Vb,Sb,nb,ac)}static d2b(Vb){var Sb;(null===(Sb=ua.App.zd)||void 0===Sb?0:Sb.Uo)&&ua.App.zd.fq.gG(Vb)}}Object(D.a)(Qb,
"DeleteActor",ka,[])},1620:function(D,I,c){c.r(I);D=c(0);var l=c(7),e=c(1463),a=c(1632),k=c(926),x=c(1564);class y{constructor(ta){this.vbk=ta}initialize(){return Promise.resolve(0)}R2d(){return Promise.resolve(0)}OV(){l.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new x.a,{IsSuccess:!0,Token:this.vbk}))}rne(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}Xke(){return!1}VRc(){return"MockAuthTokenStrategy"}}
Object(D.a)(y,"MockAuthTokenStrategy",null,[282]);var m=c(1677);class t{static get(ta,va,ia){if(!ia)return ta;let qa=0;return Promise.race([ta,new Promise(pa=>{qa=window.setTimeout(()=>{pa(va)},ia)})]).then(pa=>{window.clearTimeout(qa);return Promise.resolve(pa)}).catch(()=>{window.clearTimeout(qa);return Promise.resolve(va)})}}Object(D.a)(t,"PromiseWithTimeout",null,[]);var z=c(2),v=c(466);class H{constructor(ta,va,ia,qa,pa){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=
null;this.resource=ta;this.scope=va;this.silentLogin=ia;this.options=qa;this.correlationId=pa}}Object(D.a)(H,"TokenRequestParameters",null,[287]);var F=c(20),G=c(22);class M{constructor(){this.nmh=null;let ta=z.AFrameworkApplication.K.kb(z.AFrameworkApplication.Dka),va=z.AFrameworkApplication.K.kb(z.AFrameworkApplication.Ene);this.L0b=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",ta&&""!==ta?ta:"Unspecified",va&&""!==va?va:"Unspecified")}initialize(){return new Promise(ta=>
{G.a.instance.Ta("Common.App.WopiIdentity.IWopiIdentity").execute(va=>{this.nmh=va;ta(0)})})}fe(ta){const va=["HTTPS:","API:"];let ia=!1;const qa=ta.toLocaleUpperCase();for(const pa of va)if(qa.startsWith(pa)){ia=!0;break}return ia||this.VNm(ta)?ta+"/.default":ta}VNm(ta){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(ta)}R2d(){return Promise.resolve(0)}OV(ta,va,ia,qa,pa,Fa,za){if(F.a.NRa){pa=v.OAuthManagerSettings.T3o;if(!pa)return va=Object.assign(new x.a,
{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(va);if(!Array.contains(pa,ta))return va=Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+ta}),Promise.resolve(va)}ta=this.fe(ia);ia=new H(ia,ta,!qa,null,z.AFrameworkApplication.userSessionId);return this.nmh.getAccessToken(ia,va,za).then(Oa=>Object.assign(new x.a,{IsSuccess:!0,Token:Oa.accessToken}),Oa=>Object.assign(new x.a,{IsSuccess:!1,ErrorCode:Oa}))}rne(){return Promise.resolve(Object.assign(new x.a,
{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}Xke(){return!1}VRc(){return this.L0b}}Object(D.a)(M,"ParentFrameTokenStrategy",null,[282]);var K=c(54),L=c(761),R=c(75);class S{constructor(){this.reject=this.resolve=null;this.startTime=0;this.l5i=this.cxh=null}}Object(D.a)(S,"PromiseWrapper",null,[]);class N{constructor(ta=0){this.my=0;this.cBc=!1;this.vy=new R.a;this._timeout=ta}enqueue(ta){return new Promise((va,
ia)=>{this.vy.add(Object.assign(new S,{l5i:ta,resolve:va,reject:ia}));this.process()})}process(){if(this.cBc||this.my===this.vy.count)return!1;const ta=this.vy.J(this.my++);try{this.cBc=!0,ta.l5i().then(va=>{this.cBc=!1;this.O9e(ta,va,null,!0)}).catch(va=>{this.cBc=!1;this.O9e(ta,null,va,!1)})}catch(va){this.cBc=!1,this.O9e(ta,null,va,!1)}return!0}O9e(ta,va,ia,qa){if(qa){const pa=()=>{ta.resolve(va);this.process()};0<this._timeout?window.setTimeout(()=>{pa()},this._timeout):pa()}else{const pa=()=>
{ta.reject(ia);this.process()};0<this._timeout?window.setTimeout(()=>{pa()},this._timeout):pa()}}}Object(D.a)(N,"PromiseQueue",null,[]);class O{constructor(){this.correlationId=this.resolve=null}}Object(D.a)(O,"ResolveWithCorrelation",null,[]);var W=c(69),V=c(155),Q=c(956),Y=c(87);class ba extends V.a{constructor(ta,va,ia,qa,pa,Fa){super(!1,!1,!0);this.CSg=this.dBa=null;this.$ta=ta;this.Ufk=ia;this.Rq=qa;this.unk=pa;this.bwb=Fa;this.AH=document.createElement("iframe");this.AH.id="SharedAuthInteractiveFrame";
this.AH.setAttribute("name","SharedAuthInteractiveFrame");this.AH.setAttribute("title","SharedAuthInteractiveFrame");this.AH.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.AH.style.border="0";this.AH.style.height="48px";this.AH.style.width="190px";$addHandler(this.AH,"error",Object(K.a)(this,this.xun,"onSharedAuthFrameError"));ta=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.$ta,va,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1",
"&WacUserType=",z.AFrameworkApplication.userType);this.AH.src=ta;this.S0j=new Promise(za=>{this.CSg=za});this.DSg=!1}GUa(){this.dBa={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.Ufk,["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:z.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:Object(K.a)(this,this.Lal,"createFrame"),["resolveDialogStyles"]:this.CSg}};this.Cd=5;this.Uh(CommonUIStrings.l_SignIn,Object(K.a)(this,this.Vqo,"sharedAuthConsentDialogHandler"),
this.dBa)}CHj(ta=!1,va=5){this.dBa&&this.dBa.bodyControls&&(!0!==Object(W.a)(Object,this.dBa.bodyControls).frameLoaded&&(Object(W.a)(Object,this.dBa.bodyControls).frameLoaded=!0),ta!==Object(W.a)(Object,this.dBa.bodyControls).frameLoadSuccess&&(Object(W.a)(Object,this.dBa.bodyControls).frameLoadSuccess=ta),va!==this.dBa.dialogButtonsOption&&(this.dBa.dialogButtonsOption=null,this.Cd=va),this.update(this.dBa))}jyo(ta,va){const ia=new Q.a(Y.a.Zqo);ia.Values={["signInLabel"]:CommonUIStrings.l_SignIn,
["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:z.AFrameworkApplication.isRtl,["messageCorrelationId"]:ta,["dialogStyles"]:va};this.Rq.kUa(ia,this.AH.contentWindow,this.$ta)}N2h(){this.CHj(!1,6)}get tpj(){return this.AH}get Pnl(){return this.S0j.then(ta=>{this.DSg=!0;return ta})}get Qnl(){return this.DSg}xun(){this.N2h()}Lal(){return this.AH}Vqo(ta){0===ta&&(this.unk.reject(Object.assign(new x.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.bwb(null))}}
Object(D.a)(ba,"SharedAuthConsentDialog",V.a,[288]);var Z=c(974),ea=c(86),ha=c(153),ka=c(39),ua=c(139),sa=c(117);class Da{constructor(){this.AH=null;this.ynd=0;this.lZb=this.v1b=this.lue=this.bwb=this.nba=this.lkh=null;this.Rq=new Z.a(null,null);this.L0b="SharedAuthTokenStrategy Unloaded";this.$ta=v.OAuthManagerSettings.Xqo;this.ngh=v.OAuthManagerSettings.Wqo;this.gUg=v.OAuthManagerSettings.enableConsoleLogging;this.b2j=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",
!1);this.Bkk=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.qok=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedWebWorkerEnabled",!1);this.hdb={};this.y7j=new N(1500)}VRc(){return this.L0b}initialize(){var {OAuthManager:ta}=c(1620);if("loadFrame"in this.hdb)return this.hdb.loadFrame.cxh;if(!this.$ta)return ea.Health.instance.recordKpiFailure(ta.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),
l.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);ta=this.Ake("loadFrame");this.ynd=ka.a.$e();var va=this.$ta+this.ngh+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+z.AFrameworkApplication.userSessionId+"&WacUserType="+z.AFrameworkApplication.userType;this.qok&&(va+="&webworker=1");this.AH=document.createElement("iframe");this.GBf(this.AH);this.AH.style.cssText="height:0;width:0;display:none;";this.AH.id=
"SharedAuthFrame";this.AH.setAttribute("name","SharedAuthFrame");this.AH.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.AH.setAttribute("title","SharedAuthFrame");this.AH.src=va;document.body.appendChild(this.AH);va=ka.a.$e()-this.ynd;l.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",va,this.AH.src);return ta}R2d(ta){this.lue=ta;const va=new Q.a(Y.a.wpj);va.Values=this.Jwh(ta);
ta=this.Ake("initFrame");this.Rq.kUa(va,this.AH.contentWindow,this.$ta);l.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return ta}OV(ta,va,ia,qa,pa,Fa){const za=new Q.a(Y.a.$qo),Oa=this.kgi();za.Values=this.LCj(ta,va,ia,qa,pa,Fa,Oa);ta=this.Ake(Oa);qa&&z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",!1)?this.y7j.enqueue(()=>new Promise(xa=>{this.MPo(Fa,za,xa,Oa)})):(this.Rq.kUa(za,this.AH.contentWindow,
this.$ta),l.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",va));return ta}MPo(ta,va,ia,qa){const pa=this.hdb[qa];pa&&(this.v1b=va,this.bwb=Object.assign(new O,{resolve:ia,correlationId:qa}),this.nba=new ba(this.$ta,this.ngh,ta,this.Rq,pa,ia),this.nba.GUa())}kgi(){return ua.a.create().toString()}LCj(ta,va,ia,qa,pa,Fa,za){const Oa={};Oa.appName=ta;Oa.appId=va;Oa.target=ia;Oa.withPopup=qa;Oa.claims=pa;Oa.promptMessage=Fa;Oa.messageCorrelationId=
za;return Oa}GBf(ta){$addHandler(ta,"load",Object(K.a)(this,this.zpn,"onIFrameLoaded"));$addHandler(ta,"error",Object(K.a)(this,this.Hnb,"onIFrameError"));this.Rq.zba(this.$ta);this.Rq.Fv(Y.a.zpj);this.Rq.eC(Y.a.zpj,Object(K.a)(this,this.Xtn,"onScriptLoaded"));this.Rq.Fv(Y.a.ypj);this.Rq.eC(Y.a.ypj,Object(K.a)(this,this.Wtn,"onScriptInitialized"));this.Rq.Fv(Y.a.upj);this.Rq.eC(Y.a.upj,Object(K.a)(this,this.$on,"onGetTokenResponse"));this.Rq.Fv(Y.a.Apj);this.Rq.eC(Y.a.Apj,Object(K.a)(this,this.Iqn,
"onLoginResponse"));this.Rq.Fv(Y.a.xpj);this.Rq.eC(Y.a.xpj,Object(K.a)(this,this.aqn,"onInteractiveFlowReady"));this.Rq.Fv(Y.a.vpj);this.Rq.eC(Y.a.vpj,Object(K.a)(this,this.jpn,"onHideDialog"));this.Rq.Fv(Y.a.spj);this.Rq.eC(Y.a.spj,Object(K.a)(this,this.VVf,"onCloseDialog"))}Ake(ta){const va=new S;va.startTime=ka.a.$e();const ia=new Promise((qa,pa)=>{va.resolve=qa;va.reject=pa});va.cxh=ia;this.hdb[ta]=va;return ia}zpn(){const ta=ka.a.$e()-this.ynd;l.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",
ta)}Hnb(ta){const {OAuthManager:va}=c(1620),ia=ka.a.$e()-this.ynd,qa=Object.assign(new sa.a,{durationMs:ia});ea.Health.instance.recordKpiFailure(va.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,!0,qa);l.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",ia,this.gUg?JSON.stringify(ta):"")}Xtn(ta){const {OAuthManager:va}=c(1620),ia=this.hdb.loadFrame;var qa=ka.a.$e()-ia.startTime,pa=ta.Values.AuthLibrary.toString();ta=ta.Values.Success.toString();l.ULS.sendTraceTag(573112902,
3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",ta,pa,qa);pa&&(this.L0b="SharedAuthTokenStrategy "+pa);pa=Boolean.parse(ta);pa||(ta=ha.a.vG(),void 0!==ta&&null!==ta&&(ta.set("AuthLibrary",this.VRc()),qa=Object.assign(new sa.a,{durationMs:qa,extendedProperties:ta}),ea.Health.instance.recordKpiFailure(va.kpiName,"SharedAuthStrategyInitFailed",!1,!0,qa)));ia.resolve(pa?0:1)}Wtn(ta){if(ta.Values.interactive&&this.v1b&&this.v1b.Values.messageCorrelationId){const ia=
this.v1b.Values.messageCorrelationId.toString();if(ta.Values.interactive&&this.nba){this.nba.Pnl.then(qa=>{this.Rq.kUa(this.v1b,this.nba.tpj.contentWindow,this.$ta);this.nba.jyo(ia,qa);this.nba.CHj(!0);this.v1b=null});return}}ta=this.hdb.initFrame;const va=ka.a.$e()-ta.startTime;l.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",va);ta.resolve(0)}$on(ta){if(ta.Values.messageCorrelationId&&ta.Values.messageCorrelationId.toString()){var va=ta.Values.messageCorrelationId.toString(),
ia=this.hdb[va];if(ia){var qa=ka.a.$e()-ia.startTime;l.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",qa);ta.Values.isSuccess&&ta.Values.isSuccess?ia.resolve(ta.Values.response):ia.reject(ta.Values.response);this.jDj(va)}else l.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else l.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")}aqn(){if(this.nba.Qnl)this.nba.N2h();
else if(this.lue&&this.nba){const ta=new Q.a(Y.a.wpj);ta.Values=this.Jwh(this.lue,!0);this.Rq.kUa(ta,this.nba.tpj.contentWindow,this.$ta)}}jpn(){this.nba&&this.nba.HWd()}VVf(ta){ta.Values.cancelled&&ta.Values.cancelled&&ta.Values.messageCorrelationId&&this.jDj(ta.Values.messageCorrelationId.toString());this.nba&&this.nba.hide()}Jwh(ta,va=!1){const ia={};ia.appIds=this.rOl();ia.upn=ta.loginHint;ia.authority=ta.authority;ia.authorityType=Object(e.a)(k.a,ta.authorityType);ia.tenantId=ta.tenantId;ia.correlationId=
z.AFrameworkApplication.userSessionId;ia.enableConsoleLogging=this.gUg;ia.enablePopupFlash=this.b2j;ia.skipUpnCheck=this.Bkk;ia.interactive=va;return ia}rOl(){const ta=[],va=v.OAuthManagerSettings.Q1e;for(let qa in va){var ia=va[qa];Array.contains(ta,ia)||Array.add(ta,ia)}return ta}rne(ta,va,ia,qa,pa,Fa){const za=new Q.a(Y.a.Yqo),Oa=this.kgi();za.Values=this.LCj(ta,va,ia,qa,pa,Fa,Oa);this.lkh=za;ta=this.Ake(Oa);l.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",
va);this.Pvo();return ta}Xke(){return!0}Pvo(){this.lZb||(this.lZb=new L.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.lZb.id=16,this.lZb.Y_d=!1,this.lZb.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{l.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.Rq.kUa(this.lkh,this.AH.contentWindow,this.$ta)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),z.AFrameworkApplication.ua.Kb.Qma(this.lZb,
!0)||l.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}Iqn(ta){if(ta.Values.messageCorrelationId&&ta.Values.messageCorrelationId.toString()){var va=this.hdb[ta.Values.messageCorrelationId.toString()];if(va){var ia=ka.a.$e()-va.startTime;l.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",ia);ta.Values.isSuccess&&ta.Values.isSuccess?va.resolve(ta.Values.response):va.reject(ta.Values.response)}else l.ULS.sendTraceTag(555049440,
3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else l.ULS.sendTraceTag(555049439,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")}jDj(ta){this.bwb&&this.bwb.correlationId===ta&&(this.bwb.resolve(null),this.bwb=null)}}Object(D.a)(Da,"SharedAuthTokenStrategy",null,[282]);class Pa{constructor(ta){this.F7=ta;this.L0b="UnsupportedAuthTokenStrategy Reason="+a.a[this.F7]}initialize(){return Promise.resolve(0)}R2d(){return Promise.resolve(0)}OV(){return Promise.resolve(Object.assign(new x.a,
{IsSuccess:!1,ErrorCode:a.a[this.F7],ErrorMessage:"Unable to get a token. Reason: ["+a.a[this.F7]+"]"}))}rne(){return Promise.resolve(Object.assign(new x.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}Xke(){return!1}VRc(){return this.L0b}}Object(D.a)(Pa,"UnsupportedAuthTokenStrategy",null,[282]);var Ra=c(1528);c.d(I,"OAuthManager",function(){return Ga});class Ga{constructor(ta=null){this.laa=
0;this.maa=null;this.Nyb=0;this.y2g=!!window.location.search.match(RegExp("wdpa=1","gi"));const va=ka.a.$e();this.e7j=this.Sml(ta).then(ia=>ia?this.hzm():(l.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.iL(),Math.floor(ka.a.$e()-va)),ia=ha.a.vG(),void 0!==ia&&null!==ia&&(ia.set("AuthLibrary",this.iL()),ia=Object.assign(new sa.a,{durationMs:Math.floor(ka.a.$e()-va),extendedProperties:ia}),ea.Health.instance.recordKpiFailure(Ga.kpiName,
"StrategyPickFailed",!1,!0,ia)),Promise.resolve(1))).then(ia=>0!==ia?Promise.resolve(ia):this.f2m())}Tml(){if(this.y2g)this.laa=5,this.maa=new Pa(this.laa);else{var ta=v.OAuthManagerSettings.ren;ta&&0<ta.length?(this.laa=1,this.maa=new y(ta)):z.AFrameworkApplication.K.$("IsO365ConsumerHost")||z.AFrameworkApplication.K.$("IsO365CommercialHost")?z.AFrameworkApplication.K.$("IsAnonymousUser")?(this.laa=2,this.maa=new Pa(this.laa)):(ta=m.a.getAuthContext().loginHint)&&ta.length?v.OAuthManagerSettings.MTc?
(this.laa=1,this.maa=new M):(this.laa=1,this.maa=new Da):(this.laa=3,this.maa=new Pa(this.laa)):(this.laa=4,this.maa=new Pa(this.laa))}}iL(){return this.maa?this.maa.VRc()||"Unknown":"None"}Sml(ta=null){l.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const va=ka.a.$e();return z.AFrameworkApplication.K.MZl().then(ia=>{ia?(this.Tml(),ta&&(this.maa=ta),l.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",
v.OAuthManagerSettings.clientVersion,v.OAuthManagerSettings.appVersion,v.OAuthManagerSettings.Jrl,this.iL(),Math.floor(ka.a.$e()-va))):l.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(ka.a.$e()-va));return Promise.resolve(ia)},()=>{l.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",
Math.floor(ka.a.$e()-va));return Promise.resolve(!1)})}hzm(){l.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.iL());const ta=ka.a.$e();return t.get(this.maa.initialize(),2,v.OAuthManagerSettings.N3f).then(va=>{if(0===va)l.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.iL(),Math.floor(ka.a.$e()-ta));else if(1===va){l.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.iL(),Math.floor(ka.a.$e()-
ta));var ia=ha.a.vG();void 0!==ia&&null!==ia&&(ia.set("AuthLibrary",this.iL()),ia=Object.assign(new sa.a,{durationMs:Math.floor(ka.a.$e()-ta),extendedProperties:ia}),ea.Health.instance.recordKpiFailure(Ga.kpiName,"StrategyInitFailed",!1,!0,ia))}else 2===va&&(l.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.iL(),Math.floor(ka.a.$e()-ta)),ia=ha.a.vG(),void 0!==ia&&null!==ia&&(ia.set("AuthLibrary",this.iL()),ia=Object.assign(new sa.a,
{durationMs:Math.floor(ka.a.$e()-ta),extendedProperties:ia}),ea.Health.instance.recordKpiFailure(Ga.kpiName,"StrategyInitTimedOut",!1,!0,ia)));return Promise.resolve(va)},()=>{l.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.iL(),Math.floor(ka.a.$e()-ta));return Promise.resolve(1)})}f2m(){l.ULS.sendTraceTag(562128581,3E3,50,"Loading {0}",this.iL());const ta=ka.a.$e();return t.get(this.maa.R2d(m.a.getAuthContext()),2,
v.OAuthManagerSettings.N3f).then(va=>{if(0===va)l.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.iL(),Math.floor(ka.a.$e()-ta));else if(1===va){l.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.iL(),Math.floor(ka.a.$e()-ta));var ia=ha.a.vG();void 0!==ia&&null!==ia&&(ia.set("AuthLibrary",this.iL()),ia=Object.assign(new sa.a,{durationMs:Math.floor(ka.a.$e()-ta),extendedProperties:ia}),ea.Health.instance.recordKpiFailure(Ga.kpiName,
"StrategyLoadFailed",!1,!0,ia))}else 2===va&&(l.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.iL(),Math.floor(ka.a.$e()-ta)),ia=ha.a.vG(),void 0!==ia&&null!==ia&&(ia.set("AuthLibrary",this.iL()),ia=Object.assign(new sa.a,{durationMs:Math.floor(ka.a.$e()-ta),extendedProperties:ia}),ea.Health.instance.recordKpiFailure(Ga.kpiName,"StrategyLoadTimedOut",!1,!0,ia)));return Promise.resolve(va)},()=>{l.ULS.sendTraceTag(562128584,
3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.iL(),Math.floor(ka.a.$e()-ta));return Promise.resolve(1)})}OV(ta,va,ia=null){return this.soc(ta,va,!1,null,"",ia)}MCj(ta,va,ia,qa,pa=null){return this.soc(ta,va,!0,ia,qa,pa)}soc(ta,va,ia,qa,pa,Fa,za=0){za+=1;l.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",ta,this.LPb(ta,va),this.iL(),za);var Oa=ha.a.vG();void 0!==Oa&&null!==Oa&&
(Oa.set("AuthLibrary",this.iL()),Oa.set("AppName",ta),Oa.set("Target",this.LPb(ta,va)),ea.Health.instance.recordKpiUsage(Ga.kpiName,0,"WacOAuthFC",Oa));if(!v.OAuthManagerSettings.isEnabled||this.y2g){var xa;return this.eNf((xa=new x.a,xa.IsSuccess=!1,xa.Token=null,xa.ErrorCode="NotEnabled",xa.ErrorMessage="OAuthManager is disabled.",xa),ta)}const fa=v.OAuthManagerSettings.Q1e[ta];if(void 0===fa||null===fa){l.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",
ta);var Ka;return this.eNf((Ka=new x.a,Ka.IsSuccess=!1,Ka.Token=null,Ka.ErrorCode="DisallowedApp",Ka.ErrorMessage="Disallowed appName: "+ta,Ka),ta)}const lb=ka.a.$e();let Xa=lb;const kb=this;Oa=this.e7j.then(fb=>{Xa=ka.a.$e();return kb.lHm(ta,fa,va,ia,qa,pa,Fa,fb)});xa=ia?0:v.OAuthManagerSettings.N3f;let Bb;Ka=(Bb=new x.a,Bb.IsSuccess=!1,Bb.Token=null,Bb.ErrorCode="authTokenStrategy_timeout",Bb.ErrorMessage="Auth Strategy timed out after ["+xa+"] ms when fetching token",Bb);let Ja=this,Ma=this;return t.get(Oa,
Ka,xa).then(fb=>za<=Ga.Ibn&&(fb.ErrorCode===Ga.Mzj||fb.ErrorCode===Ga.BEo)?(l.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",za,Math.floor(ka.a.$e()-lb)),Ja.soc(ta,va,ia,qa,pa,Fa,za)):fb.ErrorCode===Ga.iFi&&!ia&&(l.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",za,Ga.MWh),Ga.tvl&&Ja.maa.Xke()&&Ja.maa.rne(ta,fa,va,ia,qa,pa).then(hc=>Promise.resolve(Ja.B3d(hc,ta,va,fa,lb,Xa))).catch(()=>
{let hc;const cc=(hc=new x.a,hc.IsSuccess=!1,hc.Token=null,hc.ErrorCode="authTokenStrategy_failure",hc.ErrorMessage="LoginPopup failed, GetToken could not be called",hc);return Promise.resolve(Ja.B3d(cc,ta,va,fa,lb,Xa))}),Ga.MWh)?Ja.soc(ta,va,!0,qa,pa,Fa,za):Promise.resolve(Ja.B3d(fb,ta,va,fa,lb,Xa))).catch(()=>{let fb;const hc=(fb=new x.a,fb.IsSuccess=!1,fb.Token=null,fb.ErrorCode="authTokenStrategy_failure",fb.ErrorMessage="Auth Strategy failed with an unknown error",fb);return Promise.resolve(Ma.B3d(hc,
ta,va,fa,lb,Xa))})}lHm(ta,va,ia,qa,pa,Fa,za,Oa){return 1===Oa||2===Oa?this.eNf(Object.assign(new x.a,{IsSuccess:!1,Token:null,ErrorCode:1===Oa?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),ta):this.maa.OV(ta,va,ia,qa,pa,Fa,za).then(xa=>Promise.resolve(this.cSi(xa,!0,ta))).catch(xa=>Promise.resolve(this.cSi(xa,!1,ta)))}B3d(ta,va,ia,qa,pa,Fa){const za={},Oa=ka.a.$e()-Fa;za.IsSuccess=ta.IsSuccess;za.ErrorCode=ta.IsSuccess?"Success":ta.ErrorCode||"";za.ErrorMessage=
ta.IsSuccess?"Success":this.LPb(va,ta.ErrorMessage||"");za.Target=this.LPb(va,ia||"");za.TimeInMS=Math.floor(Oa);za.LoadTimeInMS=Math.floor(Fa-pa);za.AuthLibrary=this.iL();za.AppName=va;za.AuthorityType=Object(e.a)(k.a,m.a.vQd());za.UserType=this.fkm(m.a.getAuthContext());za.IsAuthSupportedInSession=a.a[this.laa];za.RequestCount=++this.Nyb;za.AppId=qa;l.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(za));ta.IsSuccess||(ia=ha.a.vG(),void 0!==ia&&null!==ia&&(ia.set("AppName",va),ia.set("AuthLibrary",
this.iL()),ia.set("ErrorCode",ta.ErrorCode),ia.set("ErrorMessage",this.LPb(va,ta.ErrorMessage)),va=Object.assign(new sa.a,{durationMs:Oa,extendedProperties:ia}),ea.Health.instance.recordKpiFailure(Ga.kpiName,"TryGetTokenFailure",!1,!0,va)));return ta}eNf(ta,va){l.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",va,this.LPb(va,ta.ErrorMessage));const ia=ha.a.vG();void 0!==ia&&null!==ia&&(ia.set("AppName",va),ia.set("AuthLibrary",this.iL()),
ia.set("ErrorCode",ta.ErrorCode),ia.set("ErrorMessage",this.LPb(va,ta.ErrorMessage)),va=Object.assign(new sa.a,{extendedProperties:ia}),ea.Health.instance.recordKpiFailure(Ga.kpiName,"FailureBeforeGetToken",!1,!0,va));return Promise.resolve(ta)}Dyi(ta){return ta===Ra.a.dme}LPb(ta,va){return this.Dyi(ta)&&va?"REDACTED":va}fkm(ta){return z.AFrameworkApplication.K.$("IsAnonymousUser")?"anonymous":!ta.loginHint||1>ta.loginHint.length?"empty":-1<ta.loginHint.indexOf("guest#")?"guest":-1<ta.loginHint.indexOf("ext#")?
"external":0>ta.upn.indexOf("@")?"no-at":"supported"}Dvi(){return 1===this.laa}cSi(ta,va,ia){let qa=null,pa=null,Fa=null,za=null;ta?ta.ErrorCode||ta.ErrorMessage?(pa=ta.ErrorCode?ta.ErrorCode:Ga.JYh,Fa=ta.ErrorMessage?ta.ErrorMessage:"No message"):ta.Token?va?qa=ta.Token:(pa=Ga.PYn,Fa="A rejected promise returned a token."):(pa=Ga.JYh,Fa=JSON.stringify(ta)):(pa=Ga.shn,Fa="No result came from Auth Token Strategy");ta&&ta.Telemetry&&!this.Dyi(ia)&&(za=ta.Telemetry,l.ULS.sendTraceTag(579166408,3E3,50,
JSON.stringify(za)));if(pa===Ga.Men||pa===Ga.QLo)pa=Ga.Mzj,Fa="Auth Library Timed Out";pa===Ga.DIk&&-1<Fa.indexOf(Ga.Bpk)&&(pa=Ga.iFi);if(pa||Fa)qa=null;return Object.assign(new x.a,{IsSuccess:!!qa,Token:qa,ErrorCode:pa,ErrorMessage:Fa,Telemetry:za})}static get MWh(){return z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get tvl(){return z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",
!1)}}Ga.QLo="token_renewal_error";Ga.JYh="Exception";Ga.shn="NoResult";Ga.PYn="RejectToken";Ga.Men="monitor_window_timeout";Ga.Mzj="Timeout";Ga.BEo="authTokenStrategy_timeout";Ga.DIk="login_required";Ga.Bpk="AADSTS50058";Ga.iFi="Cookies Disabled";Ga.kpiName="OAuthManager";Ga.Ibn=2;Object(D.a)(Ga,"OAuthManager",null,[267])},1623:function(D,I,c){D=c(0);var l=c(22),e=c(55),a=c(126),k=c(2),x=c(85),y;(function(va){va[va.unspecified=0]="unspecified";va[va.none=1]="none";va[va.hidden=2]="hidden";va[va.initial=
3]="initial";va[va.dashed=4]="dashed";va[va.dotted=5]="dotted";va[va.double=6]="double";va[va.groove=7]="groove";va[va.inset=8]="inset";va[va.outset=9]="outset";va[va.ridge=10]="ridge";va[va.solid=11]="solid";va[va.ignorable=12]="ignorable"})(y||(y={}));Object(D.b)("TableCellBorderStyleType",y);var m;(function(va){va[va.unspecified=0]="unspecified";va[va.top=1]="top";va[va.center=2]="center";va[va.bottom=3]="bottom"})(m||(m={}));Object(D.b)("TableCellVerticalAlignType",m);var t=c(6),z=c(16),v=c(7),
H=c(112),F=c(69),G=c(720),M=c(191),K=c(32),L=c(5),R=c(207),S=c(84),N=c(27),O=c(77),W=c(21),V=c(338),Q=c(1538),Y=c(214),ba=c(261),Z=c(718),ea=c(12),ha=c(43),ka=c(36),ua=c(118),sa=c(40),Da=c(273),Pa=c(147),Ra=c(571),Ga=c(42);c.d(I,"a",function(){return ta});class ta{static get cwm(){return ta.h6j}static get lwm(){return ta.l6j}static get jwm(){return ta.k6j}static get ah(){return null!=ta.Rxg?ta.Rxg:ta.Rxg=Y.ContextSetEditor.instance}static get Mk(){return null!=ta.THg?ta.THg:ta.THg=l.a.instance.resolve("Box4.ITableEditor")}static get nD(){return null!=
ta.MHg?ta.MHg:ta.MHg=l.a.instance.Oa("Box4.Styles.ITableCellspacingReader")}static gJn(va,ia){const qa=va.currentNode;W.forEachCell(va,ia.rowSpan,ia.colSpan,(pa,Fa,za)=>{const Oa=pa.currentNode;Oa!==qa&&(Oa.hg=!0,ta.lSh(pa),!za&&1<=ia.colSpan&&(Oa.colSpan=ia.colSpan),ta.Ulj(pa,ia.ska,Fa,za,ia.rowSpan,ia.colSpan))})}static QJn(va,ia){W.forEachCell(va,ia.rowSpan,ia.colSpan,qa=>{ta.XFk(qa);ta.lSh(qa)})}static XFk(va){va=va.currentNode;va.hg=!0;va.Z4=!0;va.uqb=!0}static lSh(va){va&&(va.Ub(1),Object(H.a)(G.a,
va.currentNode)&&va.zg())}static NGk(va,ia,qa){0<ia&&(va=Object(F.a)(M.TableCellNode,va.currentNode))&&(va.width=qa?ia:e.a.Ql(ia,0))}static $Ek(va,ia,qa){if(va=Object(F.a)(V.TableNode,va.currentNode))0<ia&&(va.ee=e.a.Wy(ia,0)),0<qa&&(va.vu=e.a.Wy(qa,0))}static LGk(va,ia){void 0!==ia&&null!==ia&&va.currentNode.properties.setValue(t.a.nJa,ta.lwm[ia+""])}static WFk(va,ia){void 0!==ia&&null!==ia&&""!==ia&&(ia=parseInt(Q.Box4PasteSteward.UCb(ia),16),va.currentNode.properties.setValue(z.a.UK,ia))}static wAk(va){if(va){if(v.ULS.sendTraceTag(520890260,
3022,50,"Adjusting column width after paste."),Object(Ga.a)("AdjustingColumnWidthAfterPaste",!0),16==va.type){var ia=new L.GraphIterator;ia.set(va);if(ia.zb(14)){var qa=O.a(ia),pa=N.TableCellReader.eP(va);if(ia.jd(14)){va=ia.currentNode;var Fa=K.TableReader.Hha(ia);if(Fa){var za=Array.clone(Fa);ia=K.TableReader.$Sd(ia);var Oa=0,xa=0;for(var fa=0;fa<Fa.length;fa++)fa>=qa&&fa<qa+pa?ia[fa]>Fa[fa]&&(Oa+=ia[fa]-Fa[fa],za[fa]=ia[fa]):xa+=Fa[fa]>ia[fa]?Fa[fa]-ia[fa]:0;(null==xa||0>=xa||isNaN(xa))&&v.ULS.sendTraceTag(521187336,
3022,50,"spaceAvailableToShrink is invalid");(null==Oa||0>=Oa||isNaN(Oa))&&v.ULS.sendTraceTag(521187335,3022,50,"spaceToShrink is invalid");if(xa<Oa)for(qa=0;qa<Fa.length;qa++)za[qa]=ia[qa];else for(fa=0;fa<Fa.length;fa++)if((fa<qa||fa>=qa+pa)&&Fa[fa]>ia[fa]){const Ka=(Fa[fa]-ia[fa])/xa;za[fa]-=Ka*Oa;(null==za[fa]||0>=za[fa]||isNaN(za[fa]))&&v.ULS.sendTraceTag(521187334,3022,50,"Getting negative column width for scale {0}",Ka)}qa=Pa.a.yea+(ta.nD?ta.nD.Twa(va):0);for(Fa=0;Fa<za.length;Fa++)if(null==
za[Fa]||0>=za[Fa]||isNaN(za[Fa]))v.ULS.sendTraceTag(521187333,3022,50,"Column width can not be negative."),za[Fa]=e.a.Ql(qa,0);va.tG=za}else v.ULS.sendTraceTag(510253120,3022,50,"Column width should not be null")}}}}else v.ULS.sendTraceTag(537997910,3022,15,"Table cell should not be null")}static Njm(va){var ia=new L.GraphIterator;ia.kd(va);if((va=R.OutlineNavigator.Z$f(ia))&&S.OutlineReader.mx(ia)){ia=va.wf(t.a.Ko);const qa=va.wf(t.a.marginLeft);va=va.wf(t.a.marginRight);return ia-qa-va}return 0}static uTm(va){return!(void 0===
va||null===va||va===y.none)}static Vkc(va,ia,qa,pa,Fa){if(void 0===ia||null===ia||""!==ia){switch(ia){case "thin":ia=a.a.aae(.25);break;case "initial":case "medium":ia=a.a.aae(.5);break;case "thick":ia=a.a.aae(1);break;default:ia=ta.ufm(ia,qa,pa)}Fa.currentNode.properties.setValue(va,ia)}}static Ukc(va,ia,qa){void 0!==ia&&null!==ia&&ia&&qa.currentNode.properties.setValue(va,ta.jwm[ia+""])}static Qgo(va,ia,qa){void 0!==ia&&null!==ia&&""!==ia&&(ia=parseInt(Q.Box4PasteSteward.UCb(ia),16),qa.currentNode.properties.setValue(va,
ia))}static ufm(va,ia,qa){let pa=0;const Fa=({unit:va}=Q.Box4PasteSteward.s$d(va)).returnValue;switch(va){case 5:pa=a.a.aae(Fa);break;case 1:pa=a.a.JUk(Fa);break;case 3:pa=a.a.Xqi(Fa);break;case 7:pa=e.a.BDn(Fa,qa)}if(ia===y.double||ia===y.groove||ia===y.ridge)pa/=3;return Math.round(pa)}static vfm(va,ia){let qa=0;const pa=({unit:va}=Q.Box4PasteSteward.s$d(va)).returnValue;switch(va){case 5:qa=a.a.Sya(pa);break;case 1:qa=a.a.o7e(pa);break;case 3:qa=a.a.oxa(pa);break;case 7:qa=e.a.Ql(pa,ia)}return qa}static tge(va,
ia,qa,pa,Fa,za,Oa){if(Fa&&(!Oa||16===Fa.Xe||Oa||14!==Fa.Xe)&&qa!==y.ignorable){if(Oa)switch(pa){case 5:pa=t.a.Wza;var xa=t.a.Ya;var fa=t.a.Xa;var Ka=0;break;case 4:pa=t.a.Vza;xa=t.a.tb;fa=t.a.rb;Ka=1;break;case 0:pa=t.a.Tza;xa=t.a.Wa;fa=t.a.Va;Ka=0;break;case 3:pa=t.a.Uza;xa=t.a.qb;fa=t.a.pb;Ka=1;break;default:return}else switch(pa){case 5:pa=t.a.SRb;xa=t.a.drb;fa=t.a.Zmc;Ka=0;break;case 4:pa=t.a.RRb;xa=t.a.crb;fa=t.a.Ymc;Ka=1;break;case 0:pa=t.a.PRb;xa=t.a.arb;fa=t.a.Wmc;Ka=0;break;case 3:pa=t.a.QRb;
xa=t.a.brb;fa=t.a.Xmc;Ka=1;break;default:return}void 0!==Fa.currentNode&&null!==Fa.currentNode&&(ta.uTm(qa)?(ta.Qgo(pa,va,Fa),ta.Ukc(xa,qa,Fa),ta.Vkc(fa,ia,qa,Ka,Fa)):za||Oa||Fa.currentNode.properties.setValue(xa,"nil"))}}static Ulj(va,ia,qa,pa,Fa,za){pa||(ta.Nuh(ia,va,!1,!1),ta.B2e(ia,va,!0,!1));pa===za-1&&ta.B2e(ia,va,!0,!1);qa||ta.mvh(ia,va,!0,!1);qa===Fa-1&&ta.tuh(ia,va,!0,!1)}static suh(va,ia,qa,pa){va&&(ta.mvh(va,ia,qa,pa),ta.B2e(va,ia,qa,pa),ta.tuh(va,ia,qa,pa),ta.Nuh(va,ia,qa,pa))}static mvh(va,
ia,qa,pa){ta.tge(va.borderTopColor,va.borderTopWidth,va.borderTopStyle,5,ia,qa,pa)}static B2e(va,ia,qa,pa){ta.tge(va.borderRightColor,va.borderRightWidth,va.borderRightStyle,4,ia,qa,pa)}static tuh(va,ia,qa,pa){ta.tge(va.borderBottomColor,va.borderBottomWidth,va.borderBottomStyle,0,ia,qa,pa)}static Nuh(va,ia,qa,pa){ta.tge(va.borderLeftColor,va.borderLeftWidth,va.borderLeftStyle,3,ia,qa,pa)}static uge(va,ia,qa){if(qa&&16===qa.Xe&&""!==va){switch(ia){case 3:ia=t.a.eVa;var pa=0;break;case 2:ia=t.a.IV;
pa=1;break;case 0:ia=t.a.dVa;pa=0;break;case 1:ia=t.a.oS;pa=1;break;default:return}(va=ta.vfm(va,pa))&&qa.currentNode.properties.setValue(ia,va)}}static vEk(va,ia){ia&&(ta.EGk(ia,va),ta.PFk(ia,va),ta.CEk(ia,va),ta.jFk(ia,va))}static EGk(va,ia){ta.uge(va.DUk,3,ia)}static PFk(va,ia){ta.uge(va.CUk,2,ia)}static CEk(va,ia){ta.uge(va.AUk,0,ia)}static jFk(va,ia){ta.uge(va.BUk,1,ia)}static HEk(va,ia,qa,pa){var Fa=0;const za=Array(va.length);var Oa=0;pa&&(Oa=(Oa=a.a.edd(ta.Njm(ia)))?Oa:1);for(pa=0;pa<va.length;pa++)za[pa]=
0<Oa?Oa/100*va[pa]:e.a.Ql(va[pa],0),Fa+=za[pa];va=qa.getValue(z.a.Xz);pa=new L.GraphIterator;pa.kd(ia);ia=0;if(N.TableCellReader.P0(pa)){if(va=W.returnToContainingCell(pa))ia=va.width;Oa=O.a(pa);pa=W.returnToContainingTable(pa);if(-1!==Oa&&Oa<=pa.tG.length){let xa=0;for(let fa=Oa;fa<Oa+va.colSpan&&fa<pa.tG.length;fa++)xa+=pa.tG[fa];ia=Math.min(ia,xa);ia===xa&&(ia-=e.a.Ql(ta.Dgn,0))}}else if(va)for(Oa=0;Oa<va.length;Oa++)ia+=va[Oa];if(0<ia&&Fa>ia&&Fa)for(Fa=ia/Fa,ia=0;ia<za.length;ia++)za[ia]*=Fa;
qa.setValue(z.a.Xz,za)}static QFk(va,ia){va.currentNode.setValue(t.a.S1,e.a.Ql(ia,1))}static Gno(va){var ia,qa;v.ULS.sendTraceTag(520890259,3022,50,"Setting selection info and bound");Object(Ga.a)("SettingTableSelectionBounds",!0);var pa=va.ib,Fa=va.qg;va=ta.ah.pR(Fa,16);if(Fa=ta.ah.WT(Fa,14))if(Fa=Fa.node,!Fa||14!==Fa.type)v.ULS.sendTraceTag(537507990,306,15,"Table node must be present");else if(!va)v.ULS.sendTraceTag(537507991,306,15,"Cell context must be present");else{if(!((null===(qa=null===
(ia=null===pa||void 0===pa?void 0:pa.lb)||void 0===ia?void 0:ia.Ne)||void 0===qa?0:qa.Pa)&&pa.lb.Ne.Pa.contextId===ea.a.Q1&&ba.TableBorderSelectionCache.rQa()&&0<ba.TableBorderSelectionCache.rQa().length)){ba.TableBorderSelectionCache.TUc(Fa);ia=ba.TableBorderSelectionCache.C$;ia.leftMostColumnSelected=Number.MAX_SAFE_INTEGER;ia.rightMostColumnSelected=Number.MIN_SAFE_INTEGER;ia.topMostRowSelected=Number.MAX_SAFE_INTEGER;ia.bottomMostRowSelected=Number.MIN_SAFE_INTEGER;for(qa=0;qa<va.length;qa++){if(va.getContext(qa).contextId!==
ea.a.Hw)return;pa=va.getContext(qa).node;if(!N.TableCellReader.es(pa)){var za=new L.GraphIterator;za.set(pa);if(za.zb(14)&&W.getContainingTable(za)===Fa){za.jd(14);za=N.TableCellReader.mFa(za,pa);if(!za)return;Array.add(ba.TableBorderSelectionCache.rQa(),new Z.a(pa,za.rowIndex,za.Fo,pa.rowSpan,pa.colSpan));ia.leftMostColumnSelected=Math.min(ia.leftMostColumnSelected,za.Fo);ia.rightMostColumnSelected=Math.max(ia.rightMostColumnSelected,za.Fo);ia.topMostRowSelected=Math.min(ia.topMostRowSelected,za.rowIndex);
ia.bottomMostRowSelected=Math.max(ia.bottomMostRowSelected,za.rowIndex)}}}ba.TableBorderSelectionCache.C$=ia}}else v.ULS.sendTraceTag(537145810,306,15,"IP in table should be there")}static Bhj(va){var ia;if(va&&14===va.type){v.ULS.sendTraceTag(520890258,3022,50,"Scaling Column Width");Object(Ga.a)("ScalingColumnWidthForCCP",!0);var qa=new L.GraphIterator;qa.set(va);if(qa.qd()&&K.TableReader.lx(qa)){var pa=va.tG,Fa=K.TableReader.$Sd(qa),za=W.returnToContainingCell(qa),Oa=W.getContainingTable(qa);if(za&&
Oa){var xa=O.a(qa),fa=N.TableCellReader.eP(za);if(qa.jd(14)){var Ka=K.TableReader.Hha(qa);qa=0;for(let lb=xa;lb<xa+fa;lb++)qa+=Ka[lb];xa=Pa.a.OM(za,Oa,t.a.oS,t.a.Aa,0);za=Pa.a.OM(za,Oa,t.a.IV,t.a.Ba,0);qa-=e.a.Ql(xa+za,0);(null==qa||0>=qa||isNaN(qa))&&v.ULS.sendTraceTag(521187332,3022,50,"Containing cell width is invalid for cell margins {0} & {1}",xa,za);za=0;for(Oa=0;Oa<pa.length;Oa++)za+=pa[Oa];Oa=qa/za;(null==Oa||0>=Oa||isNaN(Oa))&&v.ULS.sendTraceTag(521187331,3022,50,"scale is invalid");xa=0;
for(fa=0;fa<pa.length;fa++)Ka=pa[fa],pa[fa]*=Oa,pa[fa]<Fa[fa]&&(pa[fa]=Fa[fa],1>Oa&&(null===(ia=k.AFrameworkApplication.K)||void 0===ia?0:ia.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixTableColumnWidthCalculationInCCP",!1))&&(Oa=(qa-Fa[fa])/(za-Ka))),xa+=pa[fa];xa>qa&&(pa=Array.clone(Fa));ia=Pa.a.yea+(ta.nD?ta.nD.Twa(va):0);for(Fa=0;Fa<pa.length;Fa++)if(null==pa[Fa]||0>=pa[Fa]||isNaN(pa[Fa]))v.ULS.sendTraceTag(521187330,3022,50,"Column width is invalid for inner table"),pa[Fa]=e.a.Ql(ia,
0);ia=new ha.GraphTransaction(4);ia.Db(va);va.tG=pa;ia.dispose()}}}else v.ULS.sendTraceTag(512291460,3022,50,"Table is not a nested table.")}else v.ULS.sendTraceTag(524932511,3022,15,"Table node should not be null")}static u4n(va){if(!va||!K.TableReader.xIf(va)||1!=va.Wp())return v.ULS.sendTraceTag(525361986,3022,50,"Outline iterator should contain a single table"),null;v.ULS.sendTraceTag(525361987,3022,50,"Pasting table over cell selection");Object(Ga.a)("ReplaceTableContentForExternalPaste",!0);
let ia=new L.GraphIterator;ia.set(va.currentNode);ia.zb(14);ka.OutlineElementNavigator.Ee(ia);const qa=new L.GraphIterator;qa.set(va.currentNode);qa.zb(14);if(!qa.jd(14)||!ia||14!=ia.currentNode.type)return null;if(va=W.getContainingTableCell(ia))if(va=N.TableCellReader.mFa(qa,va)){if(ba.TableBorderSelectionCache.rSc())var pa=this.Hdm();else{pa=K.TableReader.gg(ia.currentNode)-(K.TableReader.gg(qa.currentNode)-va.rowIndex);var Fa=K.TableReader.hh(ia.currentNode)-(K.TableReader.hh(qa.currentNode)-
va.Fo);this.Yuk(qa,pa,Fa);pa=new Da.a(va.Fo,K.TableReader.hh(qa.currentNode)-1,va.rowIndex,K.TableReader.gg(qa.currentNode)-1)}if(!pa)return null;Fa=pa.bottomMostRowSelected-pa.topMostRowSelected+1;var za=pa.rightMostColumnSelected-pa.leftMostColumnSelected+1;Fa=Math.min(Fa,K.TableReader.gg(ia.currentNode));za=Math.min(za,K.TableReader.hh(ia.currentNode));for(let Oa=0;Oa<Fa;Oa++){W.moveToCell(qa,Oa+pa.topMostRowSelected,pa.leftMostColumnSelected);W.moveToCell(ia,Oa,0);for(let xa=0;xa<za;xa++)Oa==
va.rowIndex-pa.topMostRowSelected&&xa==va.Fo-pa.leftMostColumnSelected||this.gQi(ia,qa),W.moveToNextColumn(qa),W.moveToNextColumn(ia);qa.rt(14);ia.rt(14)}W.moveToCell(qa,va.rowIndex,va.Fo);va.rowIndex-pa.topMostRowSelected<K.TableReader.gg(ia.currentNode)&&va.Fo-pa.leftMostColumnSelected<K.TableReader.hh(ia.currentNode)?W.moveToCell(ia,va.rowIndex-pa.topMostRowSelected,va.Fo-pa.leftMostColumnSelected):ia=null;this.gQi(ia,qa);qa.rt(14);W.moveToCell(qa,pa.topMostRowSelected,pa.leftMostColumnSelected);
qa.Rd();return qa.currentNode}}static UBn(va){if(va&&K.TableReader.xIf(va)&&1==va.Wp()){v.ULS.sendTraceTag(520890257,3022,50,"Pasting table below table");Object(Ga.a)("PasteTableBelowTable",!0);var ia=new L.GraphIterator;ia.set(va.currentNode);va=ua.a.eb(va.currentNode);ia.Ip()&&va.Ip()&&(ka.OutlineElementNavigator.h1(va,!1,!0),sa.OutlineElementReader.Eh(va)&&1==va.Wp()&&(ka.OutlineElementNavigator.Ee(ia),ka.OutlineElementNavigator.Ee(va),ia&&va&&ia.currentNode!=va.currentNode&&K.TableReader.isTable(ia)&&
K.TableReader.isTable(va)&&this.edn(ia,va)&&(v.ULS.sendTraceTag(525361989,3022,50,"Pasting table below table"),ia.zg(),ia.zg())))}else v.ULS.sendTraceTag(525361988,3022,50,"Outline iterator should contain a single table")}static gQi(va,ia){if(ia&&N.TableCellReader.isTableCell(ia)){var qa=ia.Wp();if(va&&N.TableCellReader.isTableCell(va)&&va.Iz())for(;va.Iz();)va.Rd(),ia.Bf(va.currentNode,va.role),va.zg();else qa--;for(;0<qa--;)ia.Rd(),ia.zg()}}static edn(va,ia){if(!K.TableReader.isTable(va)||!K.TableReader.isTable(ia))return!1;
var qa=K.TableReader.hh(va.currentNode),pa=K.TableReader.hh(ia.currentNode);if(qa!=pa)return v.ULS.sendTraceTag(525361990,3022,50,"Number of columns in source and target table should be same"),!1;qa=K.TableReader.gg(va.currentNode);pa=K.TableReader.gg(ia.currentNode);const Fa=new ha.GraphTransaction(4);Fa.Db(ia.currentNode);ia.currentNode.setValue(z.a.Yza,qa+pa);for(Fa.dispose();va.Iz();){va.Rd();ia.Bf(va.currentNode,1);qa=new L.GraphIterator;qa.set(va.currentNode);va.zg();qa.Rd();do qa.currentNode&&
16==qa.currentNode.type&&(qa.currentNode.bF=ia.currentNode);while(qa.It())}return!0}static Yuk(va,ia,qa){v.ULS.sendTraceTag(512291459,307,50,"Adding rows and columns for content replace in CCP.");Object(Ga.a)("AddRowAndColumnForExternalCCP",!0);ta.zBa=Ra.a.l$b;0<ia&&(W.moveToLastRow(va),v.ULS.sendTraceTag(523896290,307,50,"Begin insert rows: "+ia),this.Mk.insertRows(va,!1,ia,this.zBa),v.ULS.sendTraceTag(523896291,307,50,"Completed inserting rows."),va.jd(14));0<qa&&(v.ULS.sendTraceTag(523896320,307,
50,"Begin insert columns: "+qa),this.Mk.insertColumns(va,K.TableReader.hh(va.currentNode),!1,qa,this.zBa),v.ULS.sendTraceTag(523896321,307,50,"Completed inserting columns."))}static Hdm(){return ba.TableBorderSelectionCache?ba.TableBorderSelectionCache.C$:null}}ta.Dgn=8;ta.Phn="Normal Table";ta.RQh="Table Grid";ta.zBa=null;ta.h6j=x.a.h6("MsoNormalTable","Normal Table","MsoTableGrid",ta.RQh,"MsoTableGridLight","Grid Table Light","MsoTable15Plain1","Plain Table 1","MsoTable15Plain2","Plain Table 2",
"MsoTable15Plain3","Plain Table 3","MsoTable15Plain4","Plain Table 4","MsoTable15Plain5","Plain Table 5","MsoTable15Grid1Light","Grid Table 1 Light","MsoTable15Grid1LightAccent1","Grid Table 1 Light Accent 1","MsoTable15Grid1LightAccent2","Grid Table 1 Light Accent 2","MsoTable15Grid1LightAccent3","Grid Table 1 Light Accent 3","MsoTable15Grid1LightAccent4","Grid Table 1 Light Accent 4","MsoTable15Grid1LightAccent5","Grid Table 1 Light Accent 5","MsoTable15Grid1LightAccent6","Grid Table 1 Light Accent 6",
"MsoTable15Grid2","Grid Table 2","MsoTable15Grid2Accent1","Grid Table 2 Accent 1","MsoTable15Grid2Accent2","Grid Table 2 Accent 2","MsoTable15Grid2Accent3","Grid Table 2 Accent 3","MsoTable15Grid2Accent4","Grid Table 2 Accent 4","MsoTable15Grid2Accent5","Grid Table 2 Accent 5","MsoTable15Grid2Accent6","Grid Table 2 Accent 6","MsoTable15Grid3","Grid Table 3","MsoTable15Grid3Accent1","Grid Table 3 Accent 1","MsoTable15Grid3Accent2","Grid Table 3 Accent 2","MsoTable15Grid3Accent3","Grid Table 3 Accent 3",
"MsoTable15Grid3Accent4","Grid Table 3 Accent 4","MsoTable15Grid3Accent5","Grid Table 3 Accent 5","MsoTable15Grid3Accent6","Grid Table 3 Accent 6","MsoTable15Grid4","Grid Table 4","MsoTable15Grid4Accent1","Grid Table 4 Accent 1","MsoTable15Grid4Accent2","Grid Table 4 Accent 2","MsoTable15Grid4Accent3","Grid Table 4 Accent 3","MsoTable15Grid4Accent4","Grid Table 4 Accent 4","MsoTable15Grid4Accent5","Grid Table 4 Accent 5","MsoTable15Grid4Accent6","Grid Table 4 Accent 6","MsoTable15Grid5Dark","Grid Table 5 Dark",
"MsoTable15Grid5DarkAccent1","Grid Table 5 Dark Accent 1","MsoTable15Grid5DarkAccent2","Grid Table 5 Dark Accent 2","MsoTable15Grid5DarkAccent3","Grid Table 5 Dark Accent 3","MsoTable15Grid5DarkAccent4","Grid Table 5 Dark Accent 4","MsoTable15Grid5DarkAccent5","Grid Table 5 Dark Accent 5","MsoTable15Grid5DarkAccent6","Grid Table 5 Dark Accent 6","MsoTable15Grid6Colorful","Grid Table 6 Colorful","MsoTable15Grid6ColorfulAccent1","Grid Table 6 Colorful Accent 1","MsoTable15Grid6ColorfulAccent2","Grid Table 6 Colorful Accent 2",
"MsoTable15Grid6ColorfulAccent3","Grid Table 6 Colorful Accent 3","MsoTable15Grid6ColorfulAccent4","Grid Table 6 Colorful Accent 4","MsoTable15Grid6ColorfulAccent5","Grid Table 6 Colorful Accent 5","MsoTable15Grid6ColorfulAccent6","Grid Table 6 Colorful Accent 6","MsoTable15Grid7Colorful","Grid Table 7 Colorful","MsoTable15Grid7ColorfulAccent1","Grid Table 7 Colorful Accent 1","MsoTable15Grid7ColorfulAccent2","Grid Table 7 Colorful Accent 2","MsoTable15Grid7ColorfulAccent3","Grid Table 7 Colorful Accent 3",
"MsoTable15Grid7ColorfulAccent4","Grid Table 7 Colorful Accent 4","MsoTable15Grid7ColorfulAccent5","Grid Table 7 Colorful Accent 5","MsoTable15Grid7ColorfulAccent6","Grid Table 7 Colorful Accent 6","MsoTable15List1Light","List Table 1 Light","MsoTable15List1LightAccent1","List Table 1 Light Accent 1","MsoTable15List1LightAccent2","List Table 1 Light Accent 2","MsoTable15List1LightAccent3","List Table 1 Light Accent 3","MsoTable15List1LightAccent4","List Table 1 Light Accent 4","MsoTable15List1LightAccent5",
"List Table 1 Light Accent 5","MsoTable15List1LightAccent6","List Table 1 Light Accent 6","MsoTable15List2","List Table 2","MsoTable15List2Accent1","List Table 2 Accent 1","MsoTable15List2Accent2","List Table 2 Accent 2","MsoTable15List2Accent3","List Table 2 Accent 3","MsoTable15List2Accent4","List Table 2 Accent 4","MsoTable15List2Accent5","List Table 2 Accent 5","MsoTable15List2Accent6","List Table 2 Accent 6","MsoTable15List3","List Table 3","MsoTable15List3Accent1","List Table 3 Accent 1","MsoTable15List3Accent2",
"List Table 3 Accent 2","MsoTable15List3Accent3","List Table 3 Accent 3","MsoTable15List3Accent4","List Table 3 Accent 4","MsoTable15List3Accent5","List Table 3 Accent 5","MsoTable15List3Accent6","List Table 3 Accent 6","MsoTable15List4","List Table 4","MsoTable15List4Accent1","List Table 4 Accent 1","MsoTable15List4Accent2","List Table 4 Accent 2","MsoTable15List4Accent3","List Table 4 Accent 3","MsoTable15List4Accent4","List Table 4 Accent 4","MsoTable15List4Accent5","List Table 4 Accent 5","MsoTable15List4Accent6",
"List Table 4 Accent 6","MsoTable15List5Dark","List Table 5 Dark","MsoTable15List5DarkAccent1","List Table 5 Dark Accent 1","MsoTable15List5DarkAccent2","List Table 5 Dark Accent 2","MsoTable15List5DarkAccent3","List Table 5 Dark Accent 3","MsoTable15List5DarkAccent4","List Table 5 Dark Accent 4","MsoTable15List5DarkAccent5","List Table 5 Dark Accent 5","MsoTable15List5DarkAccent6","List Table 5 Dark Accent 6","MsoTable15List6Colorful","List Table 6 Colorful","MsoTable15List6ColorfulAccent1","List Table 6 Colorful Accent 1",
"MsoTable15List6ColorfulAccent2","List Table 6 Colorful Accent 2","MsoTable15List6ColorfulAccent3","List Table 6 Colorful Accent 3","MsoTable15List6ColorfulAccent4","List Table 6 Colorful Accent 4","MsoTable15List6ColorfulAccent5","List Table 6 Colorful Accent 5","MsoTable15List6ColorfulAccent6","List Table 6 Colorful Accent 6","MsoTable15List7Colorful","List Table 7 Colorful","MsoTable15List7ColorfulAccent1","List Table 7 Colorful Accent 1","MsoTable15List7ColorfulAccent2","List Table 7 Colorful Accent 2",
"MsoTable15List7ColorfulAccent3","List Table 7 Colorful Accent 3","MsoTable15List7ColorfulAccent4","List Table 7 Colorful Accent 4","MsoTable15List7ColorfulAccent5","List Table 7 Colorful Accent 5","MsoTable15List7ColorfulAccent6","List Table 7 Colorful Accent 6");ta.l6j=x.a.h6(m.unspecified+"","center",m.top+"","top",m.center+"","center",m.bottom+"","bottom");ta.k6j=x.a.h6(y.unspecified+"","nil",y.none+"","none",y.hidden+"","nil",y.initial+"","single",y.dotted+"","dotted",y.dashed+"","dashed",y.solid+
"","single",y.double+"","double",y.groove+"","double",y.ridge+"","double",y.inset+"","inset",y.outset+"","outset");Object(D.a)(ta,"Box4TableStewardHelper",null,[])},1624:function(D,I,c){D=c(0);class l{constructor(y,m,t,z){this.E_j=y;this.Jhk=m;this.Hhk=t;this.Khk=z}get qId(){return this.E_j}get Iee(){return this.Jhk}get Gee(){return this.Hhk}get resultType(){return this.Khk}}Object(D.a)(l,"SearchContext",null,[1119]);class e{HJd(y,m,t,z){var v=t-m;let H;if(100<=v)v=m,H=t;else{v=Math.max(0,m+Math.ceil(v/
2)-50);H=Math.min(y.length,v+100);v=Math.max(0,H-100);let G;if(v&&" "!==y.charAt(v-1)){G=Math.min(m,v+10);for(var F=v;F<G;++F)if(" "===y.charAt(F)){v=F+1;break}}if(H!==y.length&&" "!==y.charAt(H))for(G=Math.max(t,H-10),F=H-1;F>=G;--F)if(" "===y.charAt(F)){H=F;break}}y=y.substring(v,H);return new l(y,m-v,t-v,z)}IJd(y){return this.HJd(y.Pdi(),y.Ec,y.end,"")}}Object(D.a)(e,"SearchContextFactory",null,[1089]);var a=c(124),k=c(1606);c.d(I,"a",function(){return x});class x extends e{constructor(){super()}IJd(y){let m=
y.Ec,t=y.end;const z=({Ec:m,end:t}=x.P8l(y,m,t)).returnValue;y=k.a(y.type);return this.HJd(z,m,t,y)}static get instance(){return null!=x.jCg?x.jCg:x.jCg=new x}static P8l(y,m,t){y=y.Pdi();return x.gaj(y,m,t)}static gaj(y,m,t){const z=a.AParagraphNode.UP(y);if(z.length<y.length){y=y.substring(0,m);const v=a.AParagraphNode.UP(y);y=y.length-v.length;m-=y;t-=y}return{returnValue:z,Ec:m,end:t}}}Object(D.a)(x,"EditorSearchContextFactory",e,[])},1626:function(D,I,c){D=c(0);var l=c(2),e=c(22),a=c(333),k=c(725),
x=c(23),y=c(10),m=c(141),t=c(48),z=c(549),v=c(207),H=c(252),F=c(84),G=c(26),M=c(8),K=c(3),L=c(6),R=c(599),S=c(1072);class N{create(){return new S.a}}Object(D.a)(N,"FootnoteEndnoteContainerNodeFactory",null,[404]);var O=c(536);c.d(I,"a",function(){return W});class W{constructor(V,Q,Y,ba,Z,ea,ha,ka,ua){this.Vzd=null;W.ga=V;this.GE=Y;this.KNe=ba;this.f_j=ea;this.Yc=ha;this.hb=Z;this.Ibk=ka;this.t0j=ua;W.Nh=Q}u5d(V,Q){this.Swl(V);V.Ub(7);this.GE.Byi(V,Q)||V.Mf(7)}Swl(V){if(this.KNe.cBi(V)){var Q=!1,Y=
!1;if(V.Ub(7)){do{const ba=V.currentNode;if(37===ba.type)switch(ba.getValue(L.a.y4)){case 0:Y=!0;break;case 1:Q=!0}}while(V.Ti(7))}Y||this.woh(V,0);Q||this.woh(V,1)}}woh(V,Q){const Y=this.f_j.create(1074135124);Y.setValue(L.a.y4,Q);V.Bf(Y,7)}Kco(V){V&&this.Eij(V.roa)}Eij(V){V&&(V=x.SelectionFactory.ne(V.Lb.paragraph,V.Lb.cp+1),this.hb.Ac(V))}rgn(V){let Q=this.Ibk(V);void 0!==Q&&null!==Q?this.GE.xpa(Q)&&(Q=this.GE.pei(Q)):Q=V;return this.t0j(Q)}Nyo(){this.Vzd?W.Nh.notificationBar.removeEntry(this.Vzd):
this.Vzd=W.Nh.notificationBar.Cva(WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingUnsupportedNotification,!1);W.Nh.notificationBar.sA(this.Vzd)}WEk(V,Q){V=this.Yc.Eoa(V,37,37);let Y=!1;if(V.Rd()){do{const ba=V.currentNode;this.GE.nIf(ba)?this.Euh(ba,Q):Y=!0}while(V.Oj())}Y&&this.Nyo()}Euh(V,Q){R.f(V,Y=>{W.jJl(Y,Q);return!0},12)}lsm(V,Q){V=this.GE.BQc(V,Q);return V?(V=this.Yc.Rf(V))?V.Iz():!1:!1}$9h(V,Q){V=this.GE.BQc(V,Q);V=this.Yc.Rf(V);if(V.Rd()){do if(Q=V.currentNode,1===Q.getValue(L.a.soa))return Q;
while(V.Oj())}return null}static CQc(){return new W(l.AFrameworkApplication.va,y.App.za,O.a.instance,m.PageReader.instance,t.a.instance,new N,new z.a,v.OutlineNavigator.mgn,H.WordSectionNavigator.Ydf)}static get instance(){return null!=W.tCg?W.tCg:W.tCg=W.CQc()}static get Tk(){return null!=W.RFg?W.RFg:W.RFg=e.a.instance.resolve("Box4.IParagraphEditor")}static jJl(V,Q){Q.Wjb?W.Tk.qq.jea(V,F.OutlineReader.YX(V)):W.Tk.qq.jea(V,0);V=G.a.createTextRange(V,0,M.ParagraphReader.textLength(V));W.ga.Nf(V,K.a.font,
2,!0,new a.a,new k.a(Q.fontName));W.ga.Nf(V,K.a.WA,2,!0,new a.a,new k.a(Q.fontSize))}}W.ga=null;W.Nh=null;Object(D.a)(W,"FootnoteEndnoteEditor",null,[616])},1632:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);var l;(function(e){e[e.unknown=0]="unknown";e[e.supported=1]="supported";e[e.userUnsupportedAnonymous=2]="userUnsupportedAnonymous";e[e.userUnsupportedNoLoginHint=3]="userUnsupportedNoLoginHint";e[e.hostUnsupported=4]="hostUnsupported";e[e.perfAutomation=5]="perfAutomation"})(l||(l={}));
Object(D.b)("SupportStatus",l)},1642:function(D,I,c){c.d(I,"a",function(){return M});D=c(0);var l=c(358),e=c(60),a=c(22),k=c(174),x=c(7),y=c(112),m=c(69),t=c(12),z=c(104),v=c(534),H=c(124),F=c(101),G=c(8);class M{constructor(K,L,R,S,N,O=null,W="",V=!0,Q=!1){this.WEa=this.mke=this.tpb=this.u5i=this.iee=null;this.WWc=!1;this.gBf=null;this.AUf=0;this.Tle=null;this.context=K;this.ke=K.view;this.Tw=L;this.vd=N;this.cS=R;this.x$=S;this.Wja=this.failed=!1;this.A9d=null;this.o4a=this.vdc=!1;this.Fzo=M.V$e(K);
this.browserName=W;this.XIj=V;this.HYc=Q;this.LVa=!1;this.H5b=0;if(K=Object(y.a)(96,N)?N:null){this.u5i=new l.DictionaryPropertySet;this.u5i.ax(K);R=K.ja(k.a.L3c,e.a.nil);this.XIc=R!=e.a.nil?R.toString():e.a.create().toString();if(K.ja(k.a.E1i,!1)){this.vdc=!0;this.o4a=K.ja(k.a.o4a,!1);this.A9d=O;for(O=this.ke.mb.qg;O.jx;)O=O.getContext(0);if(N=Object(m.a)(H.AParagraphNode,O.node)){R=0;S=G.ParagraphReader.textLength(N);switch(O.contextId){case t.a.Fd:R=O.cpBegin;S=O.cpEnd;break;case t.a.Vc:R=S}this.iee=
z.FormattingReader.SRd(O.node,R,O.Fb);x.ULS.shipAssertTag(6305503,307,!!this.iee);N=F.a.Z9b(N);for(const Y of N)Y.cpEnd<=R||Y.cpBegin>=S||M.hp.iS(O.node,Y.hyperlink)}}this.Wja=K.ja(k.a.Wja,!1);this.LVa=K.ja(k.a.LVa,!1);this.tpb=K.ja(k.a.tpb,null)}else this.XIc=e.a.create().toString();L&64&&(this.Wja=!0)}static get hp(){return null!=M.cBg?M.cBg:M.cBg=a.a.instance.resolve("Box4.IHyperlinkEditor")}static V$e(K){if(K){if(K.jx){for(let L=0;L<K.length;L++)if(M.V$e(K.getContext(L)))return!0;return!1}if(Object(y.a)(v.a,
K))return M.V$e(K.ik);if(G.ParagraphReader.Xb(K.node)&&K.node.BO)return!0}return!1}}Object(D.a)(M,"ClipboardActionArguments",null,[])},1643:function(D,I,c){c.d(I,"a",function(){return k});D=c(0);var l=c(7),e=c(217),a=c(90);class k{static get o_m(){return k.Gqd}static x9k(x,y,m){try{k.Gqd=k.Acl(x,y,m)}catch(t){k.Gqd=null,l.ULS.Vz(539787540,393,10,t,"Error in creating autoTriggerTextContext: {0}",t instanceof Error?t.message:"Unknown Error")}}static uej(){k.Gqd=null}static Acl(x,y,m){if(!a.ListItemReader.lg(y))throw l.ULS.sendTraceTag(539787541,
393,10,"Given iterator should be at a ListOutlineElement"),Error("Given iterator should be at a ListOutlineElement");const t=e.a.C3l(y);if(null===t||void 0===t||!t.id)throw l.ULS.sendTraceTag(539787542,393,10,"No list node with id found under outline element"),Error("No list node with id found under outline element");y=m.vw(y);if(!y)throw l.ULS.sendTraceTag(539787543,393,10,"No listInfo found for given iterator"),Error("No listInfo found for given iterator");return new k(x,t.id,y)}constructor(x,y,
m){this.MBj=x;this.Q1m=y;this.E7f={listType:m.listType,listStyle:m.listStyle,tLf:m.Qu}}nTm(x,y){return y&&x&&this.Q1m===x.id&&y.listType===this.E7f.listType&&y.listStyle===this.E7f.listStyle&&y.Qu===this.E7f.tLf}}k.Gqd=null;Object(D.a)(k,"AutoTriggerTextContext",null,[])},1644:function(D,I,c){c.d(I,"a",function(){return L});D=c(0);var l=c(22),e=c(60),a=c(43),k=c(641),x=c(141),y=c(549),m=c(177),t=c(10),z=c(110),v=c(6),H=c(886),F=c(777),G=c(536),M=c(1567),K=c(1626);class L{constructor(R,S,N,O,W,V){this.GE=
R;this.ELa=N;this.KNe=O;this.wye=W;this.Yc=V}fEm(R,S,N){const O=this.rbi(S,R.node),W=R.node.Mc;if(!W)return null;const V=new a.GraphTransaction(15);V.Db(R.node);V.Uj=N;N=this.gEm(O,S);L.hEm(N,W,R,S);V.dispose();return N}rbi(R,S){const N=this.Yc.Ek();N.set(S);N.zb(7);N.jd(7);this.ELa.u5d(N,R);return N}gEm(R,S){const N=F.a.createNode();N.properties.setValue(v.a.y4,S);R.Bf(N,8);this.wye.I$k(N,S);return N}static get jg(){return null!=L.Uwg?L.Uwg:L.Uwg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get Qea(){return L.hX||
(L.hX=new k.WACStyleSet)}static set Qea(R){L.hX=R}static CQc(){const {FootnoteEndnoteDefaultContentInserter:R}=c(1716);return new L(G.a.instance,M.a.instance,K.a.instance,x.PageReader.instance,R.instance,new y.a)}static get instance(){return null!=L.$Cg?L.$Cg:L.$Cg=L.CQc()}static get hi(){return L.lA||(L.lA=m.PageNavigator.instance)}static set hi(R){L.lA=R}static hEm(R,S,N,O){t.App.zd.Uo&&t.App.zd.fq.gG(N.node);const W=new z.a;W.setValue(v.a.O8b,R.id);W.setValue(v.a.y4,O);const V=S.Uu(W,e.a.create());
L.jg.hia(N,Q=>H.a.getInstance(Q,V,R.id),L.H6h(N.node,O))}static H6h(R,S){let N=null;(R=L.hi.su(R))&&(R=L.Qea.fY(R))&&(N=R.JFa(S?Box4Intl.Box4Strings.L_StyleWordFootnoteReference:Box4Intl.Box4Strings.L_StyleWordEndnoteReference));return N}}L.hX=null;L.lA=null;Object(D.a)(L,"FootnoteEndnoteInserter",null,[650])},1649:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{static Y3n(e,a){l.kNe=e;l.tQe=a}static V3n(e,a){l.rQe=e;l.WZa=a}static jgi(){return l.rQe===l.WZa?String.format(WordEditorIntl.WordEditorStrings.l_ReplacedAllMessage,
l.WZa,l.kNe,l.tQe):String.format(WordEditorIntl.WordEditorStrings.l_ReplacedSomeMessage,l.rQe,l.WZa,l.kNe,l.tQe)}}l.rQe=0;l.WZa=0;l.kNe=null;l.tQe=null;Object(D.a)(l,"ReplaceAllContext",null,[])},1669:function(D,I,c){c.r(I);D=c(0);var l=c(2070),e=c(60),a=c(2),k=c(309),x=c(22),y=c(1987),m=c(10),t=c(7),z=c(249),v=c(2072),H=c(13),F=c(15),G=c(1624);class M{constructor(ic="",ab="",bb=!1,Jb=!1){this.JQm=bb;this.iUm=Jb;this.actionId=ic;this.cJa=ab}}Object(D.a)(M,"SearchEntryPointContext",null,[]);class K{constructor(ic){this.$fa=
null;this.Ws=!1;this.KN=ic}initialize(){this.Q_();this.Qz();this.m8(0)}Qz(){this.$fa.Qz()}dispose(){this.KN=null}ORc(){return!1}get yG(){return this.$fa?this.$fa.yG:0}m8(ic){this.$fa.m8(ic)}get isVisible(){return this.Ws}A_e(ic){this.$fa&&this.$fa.Cep(ic)}ebj(ic){this.$fa&&this.$fa.dqp(ic)}RHj(ic){this.$fa&&this.$fa.Jup(ic)}OEh(){this.$fa&&this.$fa.agp()}Pfe(ic){this.$fa&&this.$fa.Pfe(ic)}}Object(D.a)(K,"FindReplacePane",null,[419,9]);var L=c(67),R=c(1426),S=c(1085),N=c(176),O=c(182),W=c(1073),V=
c(93),Q=c(109),Y=c(86),ba=c(42),Z=c(25),ea=c(400),ha=c(1531),ka=c(335),ua=c(1053),sa=c(709),Da=c(83),Pa=c(1104);class Ra{constructor(ic){this.btk=(ab,bb)=>{this.Wzd.nb(ab)?this.Wzd.Z(ab,bb):this.Wzd.add(ab,bb);(ab=this.aOl(ab))&&this.Nui(bb,ab,this.NJh(ka.a.getTypeName()))};this.Wzd=new Da.a;this.$V=new Da.a;this.annotationType=ha.RoleDetectionAnnotation.getTypeName();ic.QUn(this.btk)}KB(ic,ab){let bb;const Jb=ic.parentPath.substr(ic.parentPath.lastIndexOf("\\")+1),Eb=ic.content;if(!Eb||this.PTm(Eb))""!==
Jb&&({value:bb}=this.Wzd.Fc(Jb,bb)).returnValue&&this.Nui(bb,ic,this.NJh(ab)),ab===ka.a.getTypeName()?(ab=null,({value:ab}=this.$V.Fc(Jb,ab)).returnValue?this.$V.Z(Jb,ic):this.$V.add(Jb,ic)):ab===ua.a.getTypeName()&&this.$V.remove(Jb)}Nui(ic,ab,bb){const Jb=this.O2l(ab);ab=this.bOl(ab);0<ab&&ic(bb,Jb,ab)}bOl(ic){try{return Number.parseInvariant(ic.id.substr(2))}catch(ab){t.ULS.sendTraceTag(554747009,367,10,ab.toString())}return-1}aOl(ic){let ab;return({value:ab}=this.$V.Fc(ic,ab)).returnValue?ab:
null}m4c(ic){if(ic)for(const ab of ic)this.KB(ab,"AugLoop_Core_AddOperation")}O2l(ic){if(ic=ic.content)switch(ic.roleType){case ha.RoleType.Heading1:return 1;case ha.RoleType.Heading2:return 2;case ha.RoleType.Heading3:return 3;case ha.RoleType.Heading4:return 4;case ha.RoleType.Heading5:return 5;case ha.RoleType.Heading6:return 6;case ha.RoleType.Heading7:return 7;case ha.RoleType.Heading8:return 8;case ha.RoleType.Heading9:return 9}return-1}PTm(ic){ic=ic.roleType;return ic===ha.RoleType.Heading1||
ic===ha.RoleType.Heading2||ic===ha.RoleType.Heading3||ic===ha.RoleType.Heading4||ic===ha.RoleType.Heading5||ic===ha.RoleType.Heading6||ic===ha.RoleType.Heading7||ic===ha.RoleType.Heading8||ic===ha.RoleType.Heading9}NJh(ic){if(ic===ka.a.getTypeName()||ic===sa.a.getTypeName())return Pa.a.j_e;if(ic===ua.a.getTypeName())return Pa.a.SKd;throw Error.create("Invalid operation type");}}Object(D.a)(Ra,"RoleDetectionAnnotationHandler",null,[265]);var Ga=c(134),ta=c(62),va=c(1163),ia=c(48),qa=c(75),pa=c(54),
Fa=c(198),za=c(177),Oa=c(656);class xa extends Fa.a{constructor(ic,ab){super(ic,ab,m.App.aaa);this.c2d=null;this.GQa=this.N3b=0;this.headingsReady=!1;this.Yya=this.gOa=0;this.NLi=!1;this.h8g=this.IYg=this.NUg=null}get N1d(){return!0}get oZh(){return this.NUg}get K5d(){return this.h8g}cKj(){this.headingsReady&&(this.IYg.style.display="none",this.GQa||this.N3b?(this.oZh.style.display="none",this.container.style.display="block"):(this.container.style.display="none",this.oZh.style.display="block"))}get p9(){return super.p9|
240}static Zbf(ic,ab,bb){var Jb=m.App.za.jb.Zc;if(Jb&&(Jb=za.PageNavigator.instance.jP(Jb))){const Eb=new xa(new Oa.a,x.a.instance.resolve("Box4.IHtmlViewRootFactory"));Eb.GQa=0;Eb.N3b=0;Eb.c2d=null;Eb.yBb(ic);Eb.NUg=ab;Eb.IYg=bb;Eb.YE(Jb);Eb.headingsReady=!0;Eb.cKj();Eb.h8g=null;return Eb}return null}}Object(D.a)(xa,"WordNavigationPaneHeadingsView",Fa.a,[437,59,60,9]);class fa{constructor(ic){this.$V=new Da.a;this.t9g=ic}KB(ic,ab){ab===ka.a.getTypeName()?(ab=null,({value:ab}=this.$V.Fc(ic.id,ab)).returnValue?
this.$V.Z(ic.id,ic):this.$V.add(ic.id,ic)):ab===ua.a.getTypeName()&&this.$V.remove(ic.id);this.t9g&&this.t9g()}m4c(ic){if(ic)for(const ab of ic)this.KB(ab,ka.a.getTypeName())}k9b(){var ic;const ab=[];if(0<(null===(ic=this.$V)||void 0===ic?void 0:ic.count))for(const bb of this.$V.values)ab.push(bb);return ab}}Object(D.a)(fa,"ContractEntityAnnotationHandler",null,[265]);var Ka=c(3);class lb{constructor(ic){this.ga=ic}smn(){this.cancelSearch()}yon(ic){this.ga.Qb(F.a.wVd,2,ic)}Prn(){this.cancelSearch()}cancelSearch(){this.ga.processAction(Ka.a.s4b,
2)}Ztn(){this.ga.processAction(Ka.a.blf,2)}onSearchQueryChanged(ic){this.ga.Qb(Ka.a.clf,2,ic)}Nvn(){this.ga.processAction(F.a.replace,2)}Ovn(){this.ga.processAction(F.a.replaceAll,2)}Jvn(){this.ga.processAction(H.a.Ykf,2)}Kvn(){this.ga.processAction(H.a.plf,2)}Mvn(){this.ga.processAction(Ka.a.D2f,2)}Lvn(){this.ga.processAction(Ka.a.GTf,2)}Qic(ic){this.ga.Qb(F.a.Qic,2,ic)}}Object(D.a)(lb,"FindReplaceActions",null,[436]);var Xa=c(251);class kb{}kb.ZP=Xa.a.iib;kb.Ghc=0;kb.Pva="FindReplaceTaskPaneData";
kb.pS=WordEditorIntl.WordEditorStrings.L_NavigationPaneTitle;Object(D.a)(kb,"FindReplaceConstants",null,[]);var Bb=c(771);class Ja{FCj(ic){var ab,bb,Jb;return ea.a.ljb(null===(Jb=null===(bb=null===(ab=m.App.za)||void 0===ab?void 0:ab.jb)||void 0===bb?void 0:bb.Zc)||void 0===Jb?void 0:Jb.xd,ic)}clearSelection(){if(this.bJe){const ic=this.FCj(this.bJe);ic&&ic.pna()}this.bJe=this.nfh=null}Bco(ic){this.clearSelection();if(ic){const ab=this.FCj(ic.parentPath);if(ab){const bb=ic.content;bb&&(this.nfh=ic.id,
ab.qUa([new Bb.a(bb.range.start,bb.range.start+bb.range.length)]),ab.NOf(0,1));this.bJe=ic.parentPath}}}}Object(D.a)(Ja,"RangeAnnotationContentSelector",null,[]);var Ma=c(1649);class fb{constructor(ic){this.T$j=ic}get Sj(){return this.T$j.value}z6l(ic){ic=this.Sj.R2a(ic);return this.bNm(ic)?null:ic}bNm(ic){return ic.id===this.Sj.aFa.id}static get instance(){return null!=fb.OBg?fb.OBg:fb.OBg=fb.gF()}static gF(){const ic=new z.a(()=>y.FindManager.instance.Sj);return new fb(ic)}}Object(D.a)(fb,"SearchResultOrder",
null,[]);var hc=c(8),cc=c(206);class mb{constructor(ic){this.yJe=ic}get mI(){return this.yJe.value}getSelectedText(){var ic=this.mI.w4;if(ic){const ab=ic.cpBegin,bb=ic.cpEnd-ab;if(0<bb&&(ic=ic.node,hc.ParagraphReader.Xb(ic)))return ic.characterData.substr(ab,bb)}return null}static getInstance(){return mb.fm()}static fm(){const ic=new z.a(()=>cc.a.instance);return new mb(ic)}}Object(D.a)(mb,"SelectionHelper",null,[]);var Hb=c(31),Ua=c(117),Ya=c(370),Fb=c(869),Wa=c(242),yb=c(371),Yb=c(1883),qc=c(372);
class Hc extends Fa.a{constructor(ic,ab,bb){super(ic,ab,m.App.aaa);this.iIa=bb;this.Dni=!1}get N1d(){return!0}get p9(){return super.p9|248}static Zbf(ic){var ab=m.App.za.jb.Zc;const bb=qc.a.instance.Pc(3);return ab&&(ab=za.PageNavigator.instance.jP(ab))?(ic=new Hc(new Oa.a,x.a.instance.resolve("Box4.IHtmlViewRootFactory"),ic),bb.f$c(ic.$b),ic.YE(ab),bb.dispose(),ic.Dni=!0,ic):null}}Object(D.a)(Hc,"WordNavigationPaneReactHeadingsView",Fa.a,[59,60,9]);class $b extends K{constructor(ic,ab,bb,Jb,Eb,hb,
ob,Va,Qb,Vb,Sb,nb,ac){var zc,Ib,ya;super(ic);this.$ub=kb.ZP;this.gmk="FindReplaceTaskPaneProps";this.Vb=L.FocusManager.instance();this.IWa=this.lNa=this.f_=this.GUe=null;this.PUb=a.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled");this.erc=a.AFrameworkApplication.K.$("AutoDetectedHeadingsIsEnabled");this.Xrd=(null===(zc=a.AFrameworkApplication.K)||void 0===zc?void 0:zc.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactHeadings",!1))||(null===(Ib=a.AFrameworkApplication.K)||void 0===
Ib?void 0:Ib.$("NavPaneReactHeadings"));this.Gbk=null===(ya=a.AFrameworkApplication.K)||void 0===ya?void 0:ya.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneReactEntities",!1);this.BGj=()=>{this.isVisible&&this.aKd===v.a.intelligentPlaceholder&&this.Mm()};this.kB=new R.a;this.AXg=ab;this.$Ka=v.a.headings;this.bFc=l.a.initial;this.$sa=new qa.a;this.tQ="";this.rvc={matchCase:!1,matchWholeWord:!1};this.sQe="";this.hSe=null;this.G3=bb;this.Xgh=!1;this.Jdb=Jb;this.hb=Eb;this.Wbk=hb;this.RCa=
ob;this.LI=Va;this.Psd=!0;this.w7=this.v7=!1;this.Je=Qb;this.vH=Vb;this.Ib=Sb;this.YV=nb;this.rQg=ac;this.eue&&this.RCa.AYn(()=>{this.Mm()})}get oVe(){return 1}get eue(){return this.PUb&&this.erc&&!!this.Je}get fue(){return this.PUb&&this.Gbk&&!!this.Je}get headingsReady(){return this.Xrd?this.vH.headingsReady:this.cnd?this.cnd.headingsReady:!1}set headingsReady(ic){this.Xrd?this.vH.headingsReady=ic:this.cnd&&(this.cnd.headingsReady=ic)}get aKd(){return this.$Ka}tsj(){this.$Ka=v.a.headings;this.Mm()}hwo(){this.$Ka=
v.a.contracts;this.Mm()}ksj(){this.$Ka=v.a.find;ba.a("NavigationPaneFind");this.Mm()}etj(){this.$Ka=v.a.replace;this.Mm()}Fsj(){this.$Ka=v.a.intelligentPlaceholder;this.Mm()}W$c(ic){this.Xgh=ic;this.Mm()}ORc(){return this.aKd===v.a.replace}get yG(){return this.bFc}m8(ic){this.bFc=ic;this.Mm()}A_e(ic){this.evk(ic);this.Mm()}evk(ic){const ab=this.Wbk(ic[ic.length-1]);if(ab){let bb=-1;for(let Jb=0;Jb<this.$sa.count;Jb++)if(ab.id===this.$sa.J(Jb).id){bb=Jb;break}-1===bb?t.ULS.sendTraceTag(40776785,313,
50,"Taskpane AddSearchResult gave illegal -1 index"):this.$sa.aD(bb,this.mKh(ic))}else this.$sa.addRange(this.mKh(ic))}ebj(ic){for(const ab of ic)for(ic=this.$sa.count-1;0<=ic;ic--)if(this.$sa.J(ic).id===ab.id){this.$sa.removeAt(ic);break}this.Mm()}RHj(ic){for(const ab of ic)for(ic=this.$sa.count-1;0<=ic;ic--)if(this.$sa.J(ic).id===ab.id){this.$sa.Z(ic,this.lKh(ab));break}this.Mm()}OEh(){this.$sa.clear();this.hSe=null;this.Mm()}Pfe(ic){this.hSe=ic?ic.id:null;this.Mm()}mKh(ic){if(!ic)return new qa.a;
const ab=new qa.a;for(const bb of ic)ab.add(this.lKh(bb));return ab}lKh(ic){const ab=this.Jdb.IJd(ic);return{id:ic.id,searchBeginIndex:ab.Iee,searchEndIndex:ab.Gee,searchResult:ab.qId}}noe(){}i_o(){var ic={};this.KN.Qic(ic);ic=ic[S.a.Value];this.GUe=Z.c(ic)?"":ic;this.Mm()}cQa(){return this.tQ}YGb(){return this.sQe}vdg(ic){this.tQ=ic;this.Mm()}clearSearch(){}initialize(){this.uxd=window.performance.now();const ic=this.Vb.fe(this.$ub);ic.parent=N.AFrame.Ap;ic.eI=!0;this.Q_();this.m8(l.a.initial)}WP(){this.isVisible?
(t.ULS.sendTraceTag(527237715,312,50,"Navpane is already open, so making it the selected task pane."),O.UISurfaces.Nu().then(ic=>{ic.setSelectedTaskPane(this.$ub,this.oVe);this.G$();this.Psd&&this.Anj(!0);return null}).catch(ic=>{$b.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],ic)})):(this.ead(),this.Psd&&this.Anj(!1))}Anj(ic){const ab=this.AXg();ab?this.tQ=ab:ic&&this.tQ||(this.tQ="");this.KN.onSearchQueryChanged(this.tQ)}$oa(){O.UISurfaces.Nu().then(ic=>{ic.hideTaskPane(this.$ub,
this.oVe);return null}).catch(ic=>{$b.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],ic)})}Q_(){this.G3.UOa();this.f_=this.G3.e6b(this.Vb);this.Osk()}ead(){O.UISurfaces.Nu().then(ic=>{this.uxd=window.performance.now();ic.showTaskPane(this.$ub,this.xA());ic=[Object.assign(new Hb.a,{name:"Tab",string:this.$Ka})];const ab=window.performance.now()-this.uxd;ba.a("NavigationPaneOpen",!0,ab,ic);return null}).catch(ic=>{$b.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],
ic)})}Mm(){O.UISurfaces.Nu().then(ic=>{ic.updateTaskPane(this.$ub,this.xA());return null}).catch(ic=>{$b.recordQosError("NavPaneUpdateActionFailure",["NavPaneInteractionFailed"],ic)})}xA(){const ic={activeTab:v.a.initial};this.kB.$pb(ic);return Object.assign(new W.a,{title:kb.pS,hideHeader:!1,width:320,location:this.oVe,contentProps:ic,onOpen:()=>{this.Ws=!0;this.XXn();this.cVn();this.Psd&&this.G$();m.App.za.updateCommandUI();m.App.za.z_a(this.BGj)},onClose:()=>{try{const ab=window.performance.now();
this.kea();this.Ws=!1;this.xSo();this.aTo();this.KN.Prn();this.GUe="";this.bFc=l.a.initial;m.App.za.wjc(this.BGj);m.App.za.updateCommandUI();const bb=window.performance.now()-ab;ba.a("NavigationPaneClose",!0,bb)}catch(ab){$b.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],ab)}},enableResize:!1,minResizeWidth:280,maxResizeWidth:920,isModernPane:!0})}XXn(){this.eue&&!this.lNa&&ea.a.ml().then(()=>{this.lNa=new Ra(this.RCa);this.Je.ob(this.lNa,this.lNa.annotationType);this.Je.getAnnotationsByType(this.lNa.annotationType).then(ic=>
{this.lNa.m4c(ic)})})}aTo(){this.eue&&this.lNa&&(this.Je.sc(this.lNa,this.lNa.annotationType),this.lNa=null)}ZNo(){if(this.fue){var ic=new Yb.ContractEntitySignal;ic=Object.assign(new Fb.a,{parentPath:["Signal",Wa.a.getTypeNameFor(ic)],items:[Object.assign(new yb.a,{body:ic})]});this.YV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Ya.a,{operation:ic}))}}cVn(){this.fue&&!this.IWa&&ea.a.ml().then(()=>{this.IWa=new fa(this.Mm);this.Je.ob(this.IWa,Yb.ContractEntityAnnotation.getTypeName());
this.ZNo();this.Je.getAnnotationsByType(Yb.ContractEntityAnnotation.getTypeName()).then(ic=>{this.IWa.m4c(ic)})})}xSo(){this.fue&&this.IWa&&(this.Je.sc(this.IWa,Yb.ContractEntityAnnotation.getTypeName()),this.IWa=null)}Osk(){this.kB.FL(this.jYl());this.kB.FL(this.lYl());this.kB.FL(this.M_l());this.kB.FL(this.BTl());this.kB.FL(this.H1l());this.kB.FL(this.wMl());this.kB.FL(this.onLinkExecute());this.kB.FL(this.onPivotTabExecute());this.kB.FL(this.wem());this.kB.FL(this.whm());this.kB.FL(this.m1l());
this.kB.FL(this.kim());this.kB.FL(this.Ibm())}kim(){return ic=>{ic.autoDetectedHeadingsToggleDisabled=this.RCa?!this.RCa.YIk():!0}}whm(){return ic=>{ic.type=this.gmk}}onLinkExecute(){return ic=>{ic.onLinkExecute=()=>{this.KN.Ztn()}}}onPivotTabExecute(){return ic=>{ic.onPivotTabExecute=ab=>{switch(ab){case v.a.headings:this.tsj();break;case v.a.replace:this.etj();break;case v.a.contracts:this.hwo();break;case v.a.intelligentPlaceholder:this.Fsj();break;default:this.ksj()}Z.b(this.tQ)&&(this.tQ=this.AXg(),
this.tQ||(this.tQ=""),Z.b(this.tQ)||(this.KN.onSearchQueryChanged(this.tQ),this.Mm()))}}}wem(){return ic=>{ic.showOutOfSyncNotification=this.Xgh}}lYl(){return ic=>{ic.findSearchBoxContent={onSearchQueryChanged:ab=>{this.tQ=ab;this.Mm();this.KN.onSearchQueryChanged(ab)},findOptions:this.rvc,matchCase:this.v7,matchWholeWord:this.w7,findSearchText:this.tQ,onClearButtonExecute:()=>{void 0!==this.tQ&&null!==this.tQ&&""!==this.tQ&&(this.tQ="",this.hb.Ac(null),this.KN.smn())},onMatchCaseExecute:()=>{this.rvc.matchCase=
!this.rvc.matchCase;this.v7=!this.v7;this.Mm();this.KN.Jvn()},onMatchWholeWordExecute:()=>{this.rvc.matchWholeWord=!this.rvc.matchWholeWord;this.w7=!this.w7;this.Mm();this.KN.Kvn()},onMenuClose:()=>{if(this.f_)this.f_.onMenuClose()},onMenuOpen:()=>{if(this.f_)this.f_.onMenuOpen()}}}}wMl(){return ic=>{ic.activeTab=this.aKd}}m1l(){return ic=>{ic.autoDetectedHeadingsToggleState=this.RCa?this.RCa.I3e:!1;this.vH.NNc=ic.autoDetectedHeadingsToggleState;!ic.autoDetectedHeadingsToggleState&&this.RCa&&this.RCa.Pnc(!1)}}jYl(){return ic=>
{const ab={onReplaceAllExecute:()=>{this.KN.Ovn()},onReplaceExecute:()=>{this.KN.Nvn()},onReplaceQueryChanged:bb=>{this.sQe=bb;this.Mm()},replaceSearchText:this.sQe};ic.findReplaceContent={searchResults:this.$sa.toArray(),replaceSearchBoxContent:ab,onNextSearchResultExecute:()=>{this.KN.Lvn()},onPrevSearchResultExecute:()=>{this.KN.Mvn()},onSearchResultSelected:bb=>{const {FindReplaceUIManager:Jb}=c(1669);this.KN.yon(bb);Jb.wLi(1)},selectedResultId:this.hSe,summaryLabel:this.GUe,explanationText:this.zXl(this.bFc),
haveTooManySearchResults:this.bFc===l.a.tooManyResults}}}zXl(ic){switch(ic){case l.a.initial:return WordEditorIntl.WordEditorStrings.l_LandingMessage;case l.a.noMatchesFound:return WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;case l.a.replaceAllComplete:return Ma.a.jgi();case l.a.tooManyResults:return WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage;default:return""}}Ibm(){return ic=>{ic.replaceFollowUpsWithCommentsIsEnabled=!0}}H1l(){return ic=>{var ab=this.LI.mNl();const bb=[];for(const Jb of ab)ab=
this.LI.lQd(Jb.Mc,Jb.id),bb.push({id:Jb.id.toString(),intelligentPlaceholderAnchorText:ab});ic.intelligentPlaceholderContent={intelligentPlaceholderContentEntry:bb,onIntelligentPlaceholderInputExecute:Jb=>{this.tQ=Jb;this.$Ka=v.a.find;this.Mm();this.KN.onSearchQueryChanged(Jb)},onSearchResultSelected:Jb=>{this.Mm();Jb=e.a.If(Jb);this.LI.Lco(Jb)}}}}M_l(){return ic=>{let ab=()=>{};this.RCa&&(ab=Object(pa.a)(this.RCa,this.RCa.Pnc,"toggleAutoDetectedHeadings"));ic.headingsContent={onHeaderInputExecute:bb=>
{this.tQ=bb;this.$Ka=v.a.find;this.Mm();ba.a("NavigationPaneFind");this.KN.onSearchQueryChanged(bb)},renderHeadingContent:(bb,Jb,Eb)=>{this.Ib.Wb(new V.a(0,1,100,()=>{var hb=window.performance.now()-this.uxd;if(this.Xrd){var ob=this.vH.h$;this.headingsReady=!0;this.Mm();Eb.style.display="none";ob.first&&(bb.style.display="block");this.Ib.Wb(new V.a(1,1,0,()=>{Hc.Zbf(this)}))}else this.cnd=xa.Zbf(bb,Jb,Eb),this.Mm();ob=window.performance.now()-this.uxd;ba.a("NavigationPaneHeadingsLoaded",!0,ob,[Object.assign(new Hb.a,
{name:"NavPaneReactHeadings",bool:this.Xrd})]);hb=[Object.assign(new Hb.a,{name:"HeadingFetchStart",double:hb}),Object.assign(new Hb.a,{name:"HeadingFetchFinished",double:ob})];ba.a("NavigationPaneHeadingsLoadDetails",!0,void 0,hb)}))},autoDetectedHeadingsToggle:ab,onHeadingsUnmounted:()=>{this.headingsReady=!1},headingsReady:this.headingsReady,headingsList:this.vH.h$,onHeadingChevronClick:bb=>{this.vH.Ezl(bb);this.Mm()},onClickHeading:bb=>{if(this.Ib.Rv){t.ULS.sendTraceTag(512328290,312,50,"OnClickHeading: TaskManager isYielding, creating an onclick task for [HeadingParagraphID: {0}]",
bb);const Jb=window.performance.now();this.Ib.Wb(new V.a(0,1,0,()=>{this.vH.onClickHeading(bb);this.Mm();const Eb=window.performance.now()-Jb;ba.a("NavigationPaneAsyncOnClickHeadingItem",!0,Eb)}))}else this.vH.onClickHeading(bb),this.Mm()},onClickBookmark:bb=>{if(this.Ib.Rv){t.ULS.sendTraceTag(512328289,312,50,"OnClickBookmark: TaskManager isYielding, creating an onclick task for [BookmarkName: {0}]",bb);const Jb=window.performance.now();this.Ib.Wb(new V.a(0,1,0,()=>{this.vH.onClickBookmark(bb);this.Mm();
const Eb=window.performance.now()-Jb;ba.a("NavigationPaneAsyncOnClickHeadingItem",!0,Eb)}))}else this.vH.onClickBookmark(bb),this.Mm()},onShareHeadingClick:bb=>{this.vH.onShareHeadingClick(bb)},bookmarkIconUrl:Ga.a.wg("BookmarkDefault.png")}}}ATl(){var ic,ab=null===(ic=this.IWa)||void 0===ic?void 0:ic.k9b();if(ab){ic=Array(ab.length);let bb=0;for(const Jb of ab)(ab=Jb.content)&&(ic[bb++]={id:Jb.id,type:ab.type,value:ab.value});return ic}return null}BTl(){return ic=>{ic.contractsContent={onHeaderInputExecute:ab=>
{this.tQ=ab;this.$Ka=v.a.find;this.Mm();ba.a("NavigationPaneFind");this.KN.onSearchQueryChanged(ab)},contractEntities:this.ATl(),selectedEntityId:this.rQg.nfh,onEntitySelected:ab=>{var bb;const Jb=null===(bb=this.IWa)||void 0===bb?void 0:bb.k9b();if(Jb)for(const Eb of Jb)if(Eb.id===ab){this.rQg.Bco(Eb);break}this.Mm()}}}}Tmj(ic){this.Psd=ic}pYo(ic){this.Ib.Wb(new V.a(0,1,0,()=>{this.vH.Vpg(ic)&&this.Mm()}))}jmi(ic){this.Ib.Wb(new V.a(0,1,0,()=>{const ab=this.vH.gOb;this.vH.Xkl(ic)?this.Mm():0===this.vH.gOb&&
0<ab&&this.Mm()}))}fpg(ic,ab){this.Ib.Wb(new V.a(0,1,0,()=>{const bb=this.vH.gOb;this.vH.fpg(ic,ab)?this.Mm():0<this.vH.gOb&&0===bb&&this.Mm()}))}okl(ic){this.Ib.Wb(new V.a(0,1,0,()=>{const ab=this.vH.gOb;this.vH.pkl(ic)?this.Mm():0===this.vH.gOb&&0<ab&&this.Mm()}))}Ooo(ic){this.vH.tLo(ic);this.Mm()}Fpg(ic){this.vH.Fpg(ic)&&this.Mm()}TKd(ic){this.vH.TKd(ic)&&this.Mm()}oLn(){return 0<this.vH.gOb}G$(){this.Vb.mg(this.$ub);t.ULS.sendTraceTag(40469190,312,50,"Taskpane now visible with focus on SearchBox")}kea(){if(this.X4a()){var ic;
(ic=ta.InteractiveViewManager.instance.yd)?(ic=ic.uJ,t.ULS.sendTraceTag(40469191,312,50,"Taskpane now hidden with focus on previous selection view.")):(ic=this.Vb.gU,t.ULS.sendTraceTag(40469192,312,50,"Taskpane now hidden with focus on default scope."));this.Vb.mg(ic)}}X4a(){return!!this.Vb.currentScope&&this.Vb.currentScope.name===this.$ub}static getInstance(){return $b.fm()}static fm(){return new $b(new lb(a.AFrameworkApplication.va),Object(pa.a)(mb.getInstance(),mb.getInstance().getSelectedText,
"getSelectedText"),va.a.instance,G.a.instance,ia.a.instance,Object(pa.a)(fb.instance,fb.instance.z6l,"getNextSearchResult"),x.a.instance.Oa("Box4.NavigationPaneViewElementManager.INavigationPaneViewElementManager"),x.a.instance.Oa("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),x.a.instance.Oa("Box4.AugmentationLoop.IAnnotationStorage"),x.a.instance.resolve("WordEditor.FindReplace.NavPaneHeadingsManager"),Q.a.instance,x.a.instance.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),
new Ja)}static recordQosError(ic,ab,bb){const Jb=Object.assign(new Ua.a,{extendedProperties:new Map});bb&&Jb.extendedProperties.set("exception",bb);Y.Health.instance.recordQosError(ic,ab,!1,!0,!1,!1,Jb)}}Object(D.a)($b,"ReactFindReplacePane",K,[418,419,9]);var Ub=c(1606);c.d(I,"FindReplaceUIManager",function(){return mc});class mc{constructor(ic,ab,bb=null,Jb=null,Eb=null,hb=null){this.sjd=this.g3=0;this.w7=this.v7=this.Mzb=!1;this.rm=this.H8g=this.Uka=null;this.HGa=this.rHe=!1;this.lj=ic;this.Xo=
bb;this.Jdb=Jb;this.m5g=Eb;this.je=hb;mc.i4b=new M}get EHf(){return this.rHe}set EHf(ic){ic!==this.rHe&&(this.rHe=ic,this.yDh())}Whe(ic){this.g3=ic;this.update();this.g3||this.yG!==l.a.searchComplete&&this.yG!==l.a.tooManyResults?0<this.g3&&this.yG===l.a.noMatchesFound?this.m8(l.a.searchComplete):this.g3>mc.qAj&&this.yG!==l.a.tooManyResults&&(t.ULS.sendTraceTag(4065350,312,50,"Shifting to TooManyResults UI"),this.m8(l.a.tooManyResults)):this.m8(l.a.noMatchesFound)}oge(ic){this.sjd=ic;this.HGa&&this.update();
this.m5g&&!this.m5g.value.j7c&&this.Scg()}reset(){}nlf(){this.je&&(this.rm=this.je.Zf("UserAction","Find"));if(this.HGa||!this.yG)this.HGa=!1,t.ULS.sendTraceTag(4065351,312,50,"FindStarted");this.m8(l.a.searching)}z8b(){var ic;this.HGa=!0;let ab=this.g3?l.a.searchComplete:l.a.noMatchesFound;if(this.yG!==l.a.tooManyResults&&y.FindManager.instance){const bb=y.FindManager.instance.Sj;0<bb.yka&&(bb.yka>mc.qAj?ab=l.a.tooManyResults:this.sZo(bb))}this.m8(ab);this.update();this.rm&&(this.rm.stop(),this.rm=
null);mc.kij=e.a.create().toString();mc.wLi(0,this.v6b,this.cQa().length,this.g3);Object(Ub.b)()&&(null===(ic=this.lj)||void 0===ic?0:ic.isVisible)&&(ic={},a.AFrameworkApplication.va.Qb(H.a.ice,2,ic),ic[k.a.On]&&a.AFrameworkApplication.va.Qb(H.a.KYd,2,{CommandValueId:{query:this.cQa(),matchCase:this.v7,matchWholeWordOnly:this.w7,totalResultLimit:-1}}))}sZo(ic){const ab=ic.aFa;let bb=ab;const Jb=[];do Jb[Jb.length]=bb,bb=ic.R2a(bb);while(ab!==bb);this.lj.A_e(Jb);this.Uka&&this.lj.Pfe(this.Uka)}update(){this.lj&&
this.lj.i_o()}get yG(){return this.lj.yG}get v6b(){return this.lj.aKd}cqb(ic){this.EHf=ic}yDh(){if(this.EHf)switch(this.yG){case l.a.searchComplete:case l.a.noMatchesFound:case l.a.tooManyResults:this.lj.W$c(!0)}else this.lj.W$c(!1)}m8(ic){if(this.lj.isVisible){switch(ic){case l.a.noMatchesFound:case l.a.searchComplete:this.yG===l.a.tooManyResults&&(ic=l.a.tooManyResults)}this.lj&&(this.lj.m8(ic),this.yDh());this.update();this.Scg()}}DPa(ic,ab){const bb=this.HGa&&this.yG!==l.a.tooManyResults;switch(ic){case 0:bb&&
this.lj.A_e(ab);break;case 1:bb&&this.lj.ebj(ab);break;case 4:bb&&this.lj.RHj(ab);break;case 2:this.lj.OEh();break;case 3:this.Uka=ab[0],bb&&0<this.g3&&this.lj.Pfe(this.Uka)}}get matchCase(){return this.v7}set matchCase(ic){this.v7!==ic&&(this.v7=ic,this.$Fj())}get matchWholeWord(){return this.w7}set matchWholeWord(ic){this.w7!==ic&&(this.w7=ic,this.$Fj())}$Fj(){this.lj.noe()}cQa(){return this.lj.cQa()}YGb(){return this.lj.YGb()}vdg(ic){this.lj.vdg(ic)}clearSearch(){this.lj.clearSearch()}get ftj(){return 0<
this.g3&&this.yG!==l.a.replaceAllInProgress&&this.yG!==l.a.replaceAllComplete}Ago(ic){let ab="";ic?ab=0<this.g3?String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplacedAndMoveToNextResult,this.cQa(),this.YGb()):String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplaceWithNoMoreResults,this.cQa(),this.YGb()):ic||0<this.g3&&(ab=WordEditorIntl.WordEditorStrings.l_ReadoutReplaceSkippedAndMoveToNextResult);this.Scg(ab)}dispose(){this.lj.dispose()}ORc(){return this.lj.ORc()}slo(ic,ab=!0){ic!==
this.v6b&&(ic===v.a.headings?(t.ULS.sendTraceTag(9056651,367,50,""),this.lj.tsj()):ic===v.a.find?this.lj.ksj():ic===v.a.replace?this.lj.etj():ic===v.a.intelligentPlaceholder&&(ab||this.lj.Tmj(ab),this.lj.Fsj()))}kC(ic,ab=!0){this.lj.Tmj(ab);ic?(this.Mzb||this.PBf(),this.lj.WP(),this.g3||this.yG===l.a.noMatchesFound?a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("WordEditorFindReplaceCancelButtonFixIsEnabled")&&this.lj.m8(l.a.searchComplete):this.m8(l.a.initial)):this.lj.$oa()}PBf(){this.Mzb||
(this.lj.initialize(),this.Mzb=!0)}Scg(ic=""){var ab=this.Xbm();ab&&(ic=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,ic,ab));this.Jdb&&ab&&this.Uka&&this.yG!==l.a.tooManyResults&&this.yG!==l.a.replaceAllInProgress&&(ab=this.Jdb.IJd(this.Uka),ic=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,ic,ab.qId));(ab=this.yXl())&&(ic=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,
ic,ab));this.Xo&&ic&&this.H8g!==ic&&(this.H8g=ic,this.Xo.sendNotification(ic,!0))}Xbm(){let ic="";switch(this.yG){case l.a.startSearch:ic=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case l.a.searchComplete:ic=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,this.sjd,this.g3);break;case l.a.tooManyResults:this.HGa&&(ic=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,this.sjd,this.g3));break;case l.a.noMatchesFound:ic=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;
break;case l.a.replaceAllInProgress:ic=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgressReadout;break;case l.a.replaceAllComplete:ic=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}return ic}yXl(){let ic="";switch(this.yG){case l.a.initial:ic=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,WordEditorIntl.WordEditorStrings.l_LandingMessage,this.dYl());break;case l.a.noMatchesFound:ic=WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;break;
case l.a.replaceAllComplete:ic=Ma.a.jgi();break;case l.a.tooManyResults:ic=WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage}return ic}dYl(){let ic="";this.v7&&this.w7?ic=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOptions,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):this.v7?ic=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,WordEditorIntl.WordEditorStrings.l_MatchCase):this.w7&&(ic=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,
WordEditorIntl.WordEditorStrings.l_MatchWholeWord));return ic}static getInstance(ic){return mc.fm(ic)}static fm(ic){const ab=$b.getInstance();return new mc(ab,ic,x.a.instance.resolve("Common.Utils.IAriaNotifier"),G.a.instance,new z.a(()=>y.FindManager.instance.fPb),m.App.za.Lq)}static wLi(ic,ab=-1,bb=-1,Jb=-1){t.ULS.sendTraceTag(4065352,312,50,"{0}",{["SearchOp"]:ic,["SearchComplete.ResultsCount"]:Jb,["SearchOpsCorrelation"]:mc.kij,["ActionId"]:mc.i4b.actionId,["SourceControlId"]:mc.i4b.cJa,["IsNavPanOpenedAlready"]:mc.i4b.JQm,
["IsSearchFromNavPane"]:mc.i4b.iUm,["CurrentTab"]:ab,["QueryLength"]:bb})}static AQk(ic,ab,bb){ab=void 0!==ab&&null!==ab?void 0===ab.SourceControlId||null===ab.SourceControlId?"Unknown":ab.SourceControlId:ic===F.a.xqb?"FindKeyboardShorcut":ic===F.a.zqb?"ReplaceKeyboardShorcut":"Unknown";switch(ic){case F.a.Ylc:ic="ShowHeadingsPane";break;case F.a.xqb:ic="ShowFindPane";break;case F.a.zqb:ic="ShowReplacePane";break;case F.a.amc:ic="ShowIntelligentPlaceholderPane";break;case F.a.R8a:ic="ToggleNavigationPane";
break;default:ic="Unknown"}mc.i4b=new M(ic,ab,bb,!0)}}mc.qAj=100;mc.kij=null;mc.i4b=null;Object(D.a)(mc,"FindReplaceUIManager",null,[403,300,9])},1670:function(D,I,c){c.r(I);D=c(0);var l=c(176),e=c(102),a=c(79),k=c(2),x=c(22),y=c(67),m=c(1107),t=c(135),z=c(10),v=c(7),H=c(15),F=c(251),G=c(473),M=c(1567),K=c(1846),L=c(28),R=c(336),S=c(11),N=c(449),O=c(17),W=c(267),V=c(48),Q=c(536),Y=c(1717);class ba{constructor(Ja,Ma,fb,hc,cc,mb,Hb){this.t8g=this.Lbh=this.DWg=this.KI=this.d$a=this.jUb=this.VBe=this.Rxe=
this.yze=this.tW=this.Ffa=this.Qfa=null;this.aoe=()=>{const Ua=this.Rta.S9b(this.KI),Ya=this.Rta.tZl(this.KI);this.Rxe.innerText=Ua.toString();this.VBe.innerText=Ya.toString();K.a.fQb(this.Qfa,1===Ua?!1:!0);K.a.fQb(this.Ffa,Ua===Ya?!1:!0)};this.Qio=()=>{const Ua=this.Vb.getRegion(F.a.$1a);let Ya;if(this.tW&&!this.tW.disabled)Ya=this.tW;else if(this.Qfa.disabled){if(this.Ffa.disabled)return;Ya=this.Ffa}else Ya=this.Qfa;Ya.focus();Ua.hk.gz(Ya)};this.Sqa=(Ua,Ya)=>{(Ua=Ya.yl.lb)&&this.tW&&K.a.fQb(this.tW,
O.SelectionEditor.Pl(Ua)?!0:!1)};this.z8e=()=>{if(!this.Ffa.disabled){const Ua=this.Rta.flb(this.KI)?H.a.G5d:H.a.F5d;this.ga.processAction(Ua,2)}return!0};this.A8e=()=>{if(!this.Qfa.disabled){const Ua=this.Rta.flb(this.KI)?H.a.I5d:H.a.H5d;this.ga.processAction(Ua,2)}return!0};this.y8e=()=>{this.tW&&!this.tW.disabled&&this.ga.processAction(H.a.AGi,2);return!0};this.Vb=Ja;this.ga=hc;this.ig=cc;this.ge=mb;this.hb=Hb;this.Rta=fb;this.w8=document.createElement("div");this.w8.classList.add("FootnoteEndnoteActionBarControl");
this.w8.style.zIndex=String(W.a.oMd);this.w8.style.position="relative";this.quc=document.createElement("div");this.quc.classList.add("FootnoteEndnoteActionBarControlDividerElement");this.w8.appendChild(this.quc);this.a9k();this.w8.appendChild(this.jUb);this.w8.appendChild(this.d$a);this.YZ=e.KeyInputManager.ic(a.a.l2,0);this.gBm();this.fBm()}pha(Ja){v.ULS.shipAssertTag(4520065,308,this.Rta.xpa(Ja));if(this.KI!==Ja){this.KI=Ja;this.aoe();Ja=this.Rta.flb(this.KI);this.Jal(Ja);this.KI.irh(this.aoe);
let Ma="",fb="";const hc=this.Rta.S9b(this.KI);-1!==hc&&(Ma=(hc-1).toString(),fb=(hc+1).toString());Ja?(this.Ffa.title=this.Ffa.disabled?WordEditorIntl.WordEditorStrings.L_NextFootnote:String.format(WordEditorIntl.WordEditorStrings.L_NextFootnoteWithNumber,fb),this.Qfa.title=this.Qfa.disabled?WordEditorIntl.WordEditorStrings.L_PrevFootnote:String.format(WordEditorIntl.WordEditorStrings.L_PrevFootnoteWithNumber,Ma)):(this.Ffa.title=this.Ffa.disabled?WordEditorIntl.WordEditorStrings.L_NextEndnote:String.format(WordEditorIntl.WordEditorStrings.L_NextEndnoteWithNumber,
fb),this.Qfa.title=this.Qfa.disabled?WordEditorIntl.WordEditorStrings.L_PrevEndnote:String.format(WordEditorIntl.WordEditorStrings.L_PrevEndnoteWithNumber,Ma));this.mIa()}}YDb(){this.KI&&(this.tW&&this.tW.parentNode===this.jUb&&this.jUb.removeChild(this.tW),this.Fka(),this.KI.L1n(this.aoe),this.KI=null)}dispose(){this.Vb.fe(F.a.$1a).nr(this.YZ)}Jal(Ja){3===this.ga.mode&&(Ja=Ja?WordEditorIntl.WordEditorStrings.L_FormatFootnotes:WordEditorIntl.WordEditorStrings.L_FormatEndnotes,this.tW=this.Eaf("FootnoteEndnoteFormattingOptionButton",
"FootnoteEndnoteActionBarFormattingButton",Ja,null),L.a.lr(this.tW,L.a.xga,Ja),this.jUb.appendChild(this.tW))}a9k(){this.jUb=document.createElement("div");this.jUb.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarLeftDiv");this.d$a=document.createElement("div");this.d$a.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarRightDiv");this.Qfa=this.Eaf("FootnoteEndnotePreviousButton","FootnoteEndnoteActionBarNavigationButton","","LeftPageArrow_20x20x32");
this.d$a.appendChild(this.Qfa);this.Rxe=N.b("span","FootnoteEndnoteActionBarCurrentCount","FootnoteEndnoteActionBar");this.d$a.appendChild(this.Rxe);this.yze=N.b("span","FootnoteEndnoteActionBarDivider","FootnoteEndnoteActionBar");this.yze.innerText=" / ";this.d$a.appendChild(this.yze);this.VBe=N.b("span","FootnoteEndnoteActionBarTotalCount","FootnoteEndnoteActionBar");this.d$a.appendChild(this.VBe);this.Ffa=this.Eaf("FootnoteEndnoteNextButton","FootnoteEndnoteActionBarNavigationButton","","RightPageArrow_20x20x32");
this.d$a.appendChild(this.Ffa)}Eaf(Ja,Ma,fb,hc){Ja=K.a.M0a(Ja,Ma,fb,hc,void 0===hc||null===hc);Ja.setAttribute(L.a.uh,L.a.X3);return Ja}gBm(){const Ja=this.Vb.fe(F.a.$1a);Ja.parent=t.AppFrame.Ap;Ja.bindAction(this.YZ,H.a.p4);Ja.pga(this.Qio)}fBm(){var Ja=new R.DOMFocusListing(()=>this.w8);Ja.Ija=!1;Ja.Rm(2);Ja.Rm(1);Ja=this.Vb.Gfb(this.w8,this.Vb.fe(F.a.$1a),Ja);Ja.ITa();Ja.BP=!0}mIa(){this.tW&&(this.ig.ob(S.a.click,this.tW,this.y8e),this.DWg=this.ge.Wob(this.tW,this.y8e,a.a.Ss));this.ig.ob(S.a.click,
this.Qfa,this.A8e);this.Lbh=this.ge.Wob(this.Qfa,this.A8e,a.a.Ss);this.ig.ob(S.a.click,this.Ffa,this.z8e);this.t8g=this.ge.Wob(this.Ffa,this.z8e,a.a.Ss);this.hb.Ww(this.Sqa)}Fka(){this.tW&&(this.ig.sc(S.a.click,this.tW,this.y8e),this.ge.Mrb(this.tW,this.DWg));this.ig.sc(S.a.click,this.Qfa,this.A8e);this.ge.Mrb(this.Qfa,this.Lbh);this.ig.sc(S.a.click,this.Ffa,this.z8e);this.ge.Mrb(this.Ffa,this.t8g);this.hb.hZ(this.Sqa)}static oZl(){return ba.pZl()}static pZl(){return new ba(y.FocusManager.instance(),
Y.a.instance,Q.a.instance,k.AFrameworkApplication.va,z.App.za.oD,z.App.za.pD,V.a.instance)}}Object(D.a)(ba,"FootnoteEndnoteActionBarControl",null,[656]);var Z=c(232),ea=c(13),ha=c(1626),ka=c(1808);class ua{constructor(Ja,Ma,fb,hc,cc,mb,Hb,Ua,Ya,Fb,Wa,yb){this.JE=null;this.hT=!1;this.ew=null;this.onClick=()=>{this.dismiss(!1,!0);return!0};this.XZb=Ja;this.v7b=Ma;this.Aqc=fb;this.Adk=hc;this.yMe=cc;this.om=mb;this.sbb=Hb;this.ig=Ua;this.sah=Ya;this.g1j=Wa;this.Nr=this.XZb.ownerDocument.createElement("div");
this.Nr.id="FootnoteEndnoteControlOverlay";this.Nr.className="EditingSurfaceOverlay";this.BI=this.CTl();this.G1(!1);this.XZb.appendChild(this.Nr);this.XZb.appendChild(this.BI);this.v7b.bind();this.ai=null;this.ga=yb;this.ELa=Fb}F6n(){const Ja=this.sah();Ja&&Ja.Zi&&(Ja.Apb=0,Ja.CCd())}XEj(Ja){if(this.fHc){const Ma=this.fHc.roa;Ma&&(Ma.mFf=Ja)}}get aI(){return this.hT}get fHc(){return this.JE}get dialog(){return this.ai}get Ho(){return null!=this.MAg?this.MAg:this.MAg=x.a.instance.Ta("Common.IZoomManager")}gbf(){this.ai=
ka.a.xZl()}D7c(){this.ai=null}show(Ja=!0){this.hT||(this.XEj(!0),this.g1j(),this.G1(!0),this.Qz(),Ja&&this.setFocus())}setFocus(){this.hT&&(this.v7b.setInitialSelection(),this.Adk())}update(){this.hT&&(this.JE.isConnected?this.Aqc.aoe():this.dismiss())}dismiss(Ja=!1,Ma=!1){this.hT&&(this.XEj(!1),this.daa(),this.F6n(),this.G1(!1),this.yMe(Ma),this.ai&&(this.ga.processAction(ea.a.QLc,2),this.ai=null),!Ja&&this.JE&&this.JE.isConnected&&this.ELa.Kco(this.JE),this.YDb())}n5n(Ja){const Ma=null!==this.Ho.instance?
this.Ho.instance.nj:1;this.BI.style.width=Ja.PIh*Ma+"px";this.ew.style.width=Ja.TJc*Ma+"px";this.BI.style.marginLeft=Ja.q5b*Ma+"px";this.om?this.ew.style.marginRight=Ja.R$e*Ma+"px":this.ew.style.marginLeft=Ja.A5b*Ma+"px";if(Ja=this.sah())Ja=Ja.GL,this.BI.style.bottom=Ja.offsetHeight-Ja.clientHeight+"px"}pha(Ja){v.ULS.shipAssertTag(4520073,308,this.sbb.xpa(Ja));this.JE!==Ja&&(this.JE=Ja,this.v7b.pha(Ja),this.Aqc.pha(this.JE))}dispose(){this.dismiss();this.v7b.dispose();this.Aqc.dispose()}Qz(){this.ig&&
this.ig.ob(S.a.click,this.Nr,this.onClick)}daa(){this.ig&&this.ig.sc(S.a.click,this.Nr,this.onClick)}CTl(){let Ja;Ja=document.createElement("div");Ja.classList.add("FootnoteEndnoteControl");this.ew=document.createElement("div");this.ew.classList.add("FootnoteEndnoteContent");this.ew.appendChild(this.v7b.w8);this.ew.appendChild(this.Aqc.w8);Ja.appendChild(this.ew);return Ja}G1(Ja){Ja=(this.hT=Ja)?"":"none";this.Nr.style.display=Ja;this.BI.style.display=Ja}YDb(){this.JE&&(this.v7b.YDb(),this.Aqc.YDb(),
this.JE=null)}static tTd(){const Ja=z.App.za.jb.rc;return Ja&&Ja.Zi?Ja:null}static sZl(Ja,Ma,fb,hc,cc){return new ua(Ja,Ma,fb,hc,cc,k.AFrameworkApplication.isRtl,Q.a.instance,Z.a.instance,ua.tTd,ha.a.instance,ua.Kpl,k.AFrameworkApplication.va)}static Kpl(){k.AFrameworkApplication.va.Qb(ea.a.ckb,2,!0)}}Object(D.a)(ua,"FootnoteEndnoteControl",null,[655]);var sa=c(826),Da=c(5),Pa=c(207),Ra=c(36),Ga=c(8),ta=c(23),va=c(78),ia=c(1716),qa=c(352),pa=c(989),Fa=c(586),za=c(1477),Oa=c(62),xa=c(112);class fa extends qa.a{constructor(Ja,
Ma,fb,hc,cc,mb,Hb,Ua,Ya,Fb,Wa,yb,Yb,qc,Hc,$b,Ub){super(F.a.yha,fb,hc,cc,Hb,Ua,Ya,Fb,Wa,yb,Yb,qc,Hc,$b,Ub);this.uQg=Ja;this.kZa=mb;this.kZa.Dbd=this;Ma(this);this.features.tkg=!0}get Cyi(){return!0}uwf(){const Ja=this.uQg.unf(this);return pa.ViewReference.mF(this,Ja)}Uff(Ja){Object(xa.a)(fa,Ja)||this.uQg.Rff()}RRc(){return Fa.a.DPi}onResize(){super.onResize();this.kZa.VXh()}YE(Ja,Ma=null){super.YE(Ja,Ma);this.kZa.IXh(this.ed.xj)}detach(){this.kZa.UXh();super.detach()}EPd(){this.onResize()}static K0a(){const {FootnoteEndnoteControlManager:Ja}=
c(1670);return new fa(Ja.instance,za.a.d$e,z.App.za.jb,Oa.InteractiveViewManager.instance,()=>x.a.instance.resolve("Box4.IUndoManager"),x.a.instance.resolve("WordEditor.SectionAlignedViewRepositioner"),k.AFrameworkApplication.va,x.a.instance.resolve("Box4.IHtmlViewRootFactory"),x.a.instance.resolve("Box4.IInteractiveEventNotifier"),x.a.instance.Ta("Box4.ITextMetricsAdapter"),x.a.instance.resolve("Box4.IRotatingCoordinateConverter"),x.a.instance.Ta("Common.IZoomManager"),x.a.instance.Oa("Box4.IContentControlViewElementManager"),
x.a.instance.Oa("Box4.CpConversionManagerImpl"),x.a.instance.Oa("Box4.ContentControlConfigSettings"),x.a.instance.Oa("Box4.IContentControlReader"),x.a.instance.Oa("Box4.IContentControlBoundaryNavigator"))}}Object(D.a)(fa,"FootnoteEndnoteEditView",qa.a,[]);class Ka{constructor(Ja,Ma,fb,hc=!1){this.fvb=null;this.fGe=this.kNg=!1;this.wIl=()=>{const cc=String.format("{0} {1}",this.fGe?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,
WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText);this.Gv.sendNotification(cc,!0)};this.Vb=Ja;this.Rta=Ma;this.qfa=fb();this.zod=hc;this.w8=document.createElement("div");this.w8.classList.add("FootnoteEndnoteEditControl");this.quc=document.createElement("div");this.quc.classList.add("FootnoteEndnoteEditControlDividerElement");this.pAb=(new sa.a(this.w8,"WACViewPanel_FootnoteEndnoteEditControl")).uI;this.w8.appendChild(this.quc);this.w8.appendChild(this.pAb)}get Gv(){return null!=
this.qwg?this.qwg:this.qwg=x.a.instance.resolve("Common.Utils.IAriaNotifier")}pha(Ja){v.ULS.shipAssertTag(4520077,308,this.Rta.xpa(Ja));this.fvb!==Ja&&(this.fvb=Ja,this.y3e(this.fvb),this.fGe=this.Rta.flb(this.fvb),this.zod?(this.qfa.jQb(L.a.FDd),this.Vb.fe(F.a.yha).Q3(this.wIl)):this.qfa.ylj(this.fGe?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,L.a.FDd))}YDb(){const Ja=Q.a.instance.flb(this.fvb)?
"Footnote":"Endnote";v.ULS.sendTraceTag(4006494,308,50,"{0}",{["Type"]:Ja,["CalloutHeight"]:this.w8.scrollHeight});this.fhb();this.fvb=null}bind(){this.kNg||(this.qfa.yBb(this.pAb),this.kNg=!0)}setInitialSelection(){const Ja=this.Gdm();Ja?this.qfa.Ac(Ja):this.qfa.R9c()}dispose(){this.fhb()}y3e(Ja){this.fhb();this.qfa.YE(Ja,Ja.xj)}fhb(){this.qfa.detach()}Gdm(){let Ja=0;var Ma=null,fb=Da.GraphIterator.eb(this.fvb);Pa.OutlineNavigator.S9(fb);if((fb=Ra.OutlineElementNavigator.Ee(fb))&&Ga.ParagraphReader.Xb(fb)){if(Ma=
Ka.r2l(fb)){Ja=Ma.Lb.cp+1;Ma=ia.FootnoteEndnoteDefaultContentInserter.PQh;const hc=Ma.length;Ja+hc<=Ga.ParagraphReader.textLength(fb)&&fb.characterData.substr(Ja,hc)===Ma&&(Ja+=hc)}Ma=ta.SelectionFactory.ne(fb,Ja)}return Ma}static uZl(){return Ka.vZl()}static vZl(){return new Ka(y.FocusManager.instance(),Q.a.instance,()=>fa.K0a(),k.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}static r2l(Ja){Ja=va.i(Ja,10);return 0<Ja.length?Ja[Ja.length-1]:null}}Object(D.a)(Ka,"FootnoteEndnoteEditControl",
null,[654]);var lb=c(1197);class Xa{constructor(Ja,Ma){this.nCa=Ja;this.om=Ma}S$b(Ja,Ma){Ja=this.nCa.S$b(Ja);var fb=Ma.clientWidth;const hc=Ma.scrollLeft,cc=Ja.PIh;let mb=Ja.q5b,Hb=Ja.q5b,Ua=Xa.TPf,Ya=Xa.UPf,Fb=cc,Wa=Ja.TJc;this.om?Ya=Ja.R$e-Hb:Ua=Ja.A5b-mb;fb<cc&&(mb=Math.max(mb-hc,0),Fb=fb-mb,this.om?(fb=Ma.scrollWidth-hc-fb,Hb=Ma.scrollWidth-Ja.q5b-cc,Ya=Math.max(Ja.R$e-fb-Hb,Xa.UPf),Wa=Fb-Ya-Xa.TPf):(Ua=Math.max(Ja.A5b-hc-mb,Xa.TPf),Wa=Fb-Ua-Xa.UPf));return new lb.a(mb,Fb,Ua,Ya,Wa)}}Xa.TPf=25;
Xa.UPf=50;Object(D.a)(Xa,"FootnoteEndnoteViewPositionProvider",null,[]);class kb{constructor(Ja,Ma=0,fb=0){this.clientWidth=Ja;this.scrollLeft=Ma;this.scrollWidth=fb?fb:Ja}}Object(D.a)(kb,"PageViewScrollContainerSizeInfo",null,[]);c.d(I,"FootnoteEndnoteControlManager",function(){return Bb});class Bb{constructor(Ja,Ma,fb,hc,cc,mb,Hb,Ua){this.zE=null;this.G$=()=>{this.lp.$I(F.a.yha);this.lp.$I(F.a.$1a);this.lp.fx(l.AFrame.In);this.Vb.zFc(F.a.yha);this.Vb.mg(F.a.yha)};this.Yio=Ya=>{this.lp.fx(F.a.yha);
this.lp.fx(F.a.$1a);this.lp.$I(l.AFrame.In);this.Vb.oLc(F.a.yha);(Ya||this.Vb.currentScope&&(this.Vb.currentScope.name===F.a.yha||this.Vb.currentScope.name===F.a.$1a))&&this.Vb.mg(l.AFrame.In)};this.Vb=Ja;this.lp=Ma;this.s4j=fb;this.t4j=hc;this.r4j=cc;this.nCa=mb;this.cta=Hb;this.i_=Ua;this.YZ=e.KeyInputManager.ic(a.a.l2,0);this.IBf();this.JT()}get control(){return this.zE}get dialog(){return this.control.dialog}get Jwi(){return this.control.aI}gbf(){this.control.gbf()}D7c(){this.control.D7c()}bind(Ja){this.N4k(Ja)}bhg(Ja){if(this.control.fHc!==
Ja.F0a)this.control.dismiss();else if(this.Jwi)return;this.$6b();this.control.pha(Ja.F0a);this.control.show(Ja.mie)}$6b(){if(this.i_){const Ja=new m.a(!0);this.i_.gIa(Ja)}}kZ(){this.control.setFocus()}udd(){this.control.update()}Rff(Ja,Ma=!1){this.$6b();this.control.dismiss(Ja,Ma)}l5n(Ja){const Ma=Bb.tTd().GL;Ja=this.nCa.S$b(Ja,new kb(Ma.clientWidth,Ma.scrollLeft,Ma.scrollWidth));this.control.n5n(Ja)}dispose(){this.control.dispose();this.Vb.fe(F.a.yha).nr(this.YZ)}unf(Ja){v.ULS.shipAssertTag(4520074,
308,!!this.control);v.ULS.shipAssertTag(4520075,308,!!this.control.fHc);return this.vnf(this.control.fHc.id,Ja)}N4k(Ja){const Ma=this.t4j(),fb=this.r4j();this.zE=this.s4j(Ja,Ma,fb,this.G$,this.Yio)}IBf(){const Ja=this.Vb.fe(F.a.yha);Ja.parent=3===k.AFrameworkApplication.va.mode?t.AppFrame.VD:t.AppFrame.cjc;this.Vb.QZe(F.a.yha);Ja.bindAction(this.YZ,H.a.p4)}JT(){this.lp.JT(F.a.yha);this.lp.JT(F.a.$1a)}vnf(Ja,Ma){return()=>{const fb=Bb.tTd().ed.Mc.Eb(Ja);this.cta.Y7b();if(!fb.isConnected)return v.ULS.sendTraceTag(4520076,
308,10,"{0}",{["Error"]:"Unable to restore footnoteEndnote control"}),null;this.bhg(new G.a(fb,!0));return Ma}}static fm(){const Ja=new Xa(x.a.instance.resolve("Box4.SectionAlignedViewPositionProvider"),k.AFrameworkApplication.isRtl);return new Bb(y.FocusManager.instance(),z.App.za.wx,ua.sZl,Ka.uZl,ba.oZl,Ja,M.a.instance,x.a.instance.resolve("Box4.IPasteFloatieEventSource"),x.a.instance.resolve("Common.IAppSettingsManager"))}static tTd(){const Ja=z.App.za.jb.rc;return Ja&&Ja.Zi?Ja:null}static get instance(){return null!=
Bb.RCg?Bb.RCg:Bb.RCg=Bb.fm()}}Object(D.a)(Bb,"FootnoteEndnoteControlManager",null,[617])},1692:function(D,I,c){c.d(I,"a",function(){return z});D=c(0);var l=c(7),e=c(54),a=c(176),k=c(2),x=c(11),y=c(165),m=c(127),t=c(22);class z{constructor(v,H){this.du=null;this.ivd=!1;this.zcb=0;this.X3g="";this.sve={};this.cLe=v;this.Vb=H;this.P9g=Object(e.a)(this,this.FXf,"onModalMouseWheel");this.S2g=!!k.AFrameworkApplication.ua&&k.AFrameworkApplication.ua.Kb.Npa;this.Pw=!!k.AFrameworkApplication.ua&&k.AFrameworkApplication.ua.Kb.tL}onMenuOpen(){0<
this.zcb?this.zcb++:(this.zcb++,k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame",!1)?window.requestAnimationFrame(()=>{window.setTimeout(Object(e.a)(this,this.C5i,"pushTransientFocusScope"),0)}):this.C5i(),this.showModal())}C5i(){this.Vb&&this.Vb.EL(a.AFrame.Vqa,!0)}uQl(){const v=m.f(),H=appChrome.selectors.getShyState();return String.format("{0}{1}",v,this.S2g&&H.isActive&&1===H.state?"_ShyRibbon":"")}yim(v){var H=0;if(this.Pw){if(this.sve[v])return this.sve[v];
(H=document.getElementById("BusinessBar"))||l.ULS.sendTraceTag(524142489,340,10,"Failed to propertly get region composer Business Bar Region for setting up Modal Div");H=H?H.offsetTop:0;this.sve[v]=H}return H}showModal(){if(!this.du)if(this.du=this.createElement("div"),this.du.setAttribute("id","ReactModalDiv"),this.du.style.position="absolute",this.du.style.bottom="0px",this.du.style.left="0px",this.du.style.right="0px",this.du.style.backgroundColor="white",this.du.style.opacity="0.0",this.Pw){var v=
document.getElementById("regionComposerRoot");v&&v.appendChild(this.du)}else this.cLe.appendChild(this.du);v=this.uQl();if(v!==this.X3g){const H=this.yim(v),F=appChrome.selectors.getShyState();this.S2g&&F.isActive&&1===F.state&&m.a("getRibbonHeight")?this.du.style.top=String.format("{0}px",H+appChrome.api.getRibbonHeight(m.f())):this.du.style.top=String.format("{0}px",H);this.X3g=v}this.du.style.display="block";this.du.style.visibility="visible";this.du.style.zIndex="1000";this.ivd||(window.addEventListener("wheel",
this.P9g,!0),this.V_d()?y.a.instance.ob(x.a.jN,this.du,Object(e.a)(this,this.Y7d,"onModalPointerUp")):y.a.instance.ob(x.a.pointerDown,this.du,Object(e.a)(this,this.X7d,"onModalPointerDown")),this.ivd=!0)}onMenuClose(){this.zcb--;0<this.zcb||(0>this.zcb?this.zcb=0:this.Toi())}TVf(){this.zcb=0;this.eMc();this.Toi()}createElement(v){v=document.createElement(v);v.setAttribute("unselectable","on");return v}Soi(){this.Vb&&this.Vb.currentScope&&this.Vb.currentScope.name===a.AFrame.Vqa&&!k.AFrameworkApplication.lc.Rv&&
this.Vb.gS(a.AFrame.Vqa,!1);this.du&&(this.du.style.zIndex="-1",this.du.style.visibility="hidden",this.du.style.display="none");this.ivd&&(window.removeEventListener("wheel",this.P9g,!0),this.V_d()?y.a.instance.sc(x.a.jN,this.du,Object(e.a)(this,this.Y7d,"onModalPointerUp")):y.a.instance.sc(x.a.pointerDown,this.du,Object(e.a)(this,this.X7d,"onModalPointerDown")),this.ivd=!1)}Toi(){this.V_d()?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.Soi()},0)}):this.Soi()}X7d(){this.Z6b();this.wTh();
this.TVf();this.Q7a();return!0}Y7d(){this.Z6b();this.wTh();this.TVf();window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.Q7a()},0)});return!0}Q7a(){4===k.AFrameworkApplication.ua.Kb.yk&&k.AFrameworkApplication.K.$("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?k.AFrameworkApplication.ua.Q7a():this.Vb.mg(a.AFrame.In)}FXf(v){v.stopPropagation()}Z6b(){const v=t.a.instance.Oa("Common.IReactContextualUILauncher");v&&v.Z6b()}eMc(){const v=t.a.instance.Oa("Common.IReactContextualUILauncher");
v&&v.eMc()}wTh(){k.AFrameworkApplication.ua&&k.AFrameworkApplication.ua.Kb.GRa&&(this.V_d()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}V_d(){return k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",!1)}}Object(D.a)(z,"ReactModalDiv",null,[])},1697:function(D,I,c){c.d(I,"a",function(){return e});c.d(I,"b",function(){return a});c.d(I,"c",function(){return k});var l=
c(2);const e=(x,y)=>{const m=RegExp("mailto:(.*)").exec(x.url);y.email=m&&2===m.length?m[1]:x.url;y.resolveState=x.mw.charAt(35)===c(1807).ACommentFormatTranslator.dIk?1:0},a=(x,y)=>{y.contentId=x.mw},k=(x,y,m)=>{y.contentId=x.mw;y.isCurrentUser=m.email===l.AFrameworkApplication.K.kb("UserPrincipalName")}},1698:function(D,I,c){c.d(I,"a",function(){return a});D=c(0);var l=c(1063),e=c(6);class a{constructor(k,x){this.SN=this.gAc=null;this.gb=k;this.U$a=x}get key(){return"COMMENT"}get $w(){return WordEditorIntl.WordEditorStrings.L_Comment}get m4(){return this.SN}reset(k){this.SN=
k.node}GJa(k){let x=null;if(this.gAc&&this.Pwi(k,this.m4,this.gAc))return x=Object.assign(new l.a,{$G:this.key,contentObject:this.gAc}),{returnValue:!0,hG:x};this.gAc=null;const y=this.U$a.Abf(this.m4);if(this.U$a.SDf(y)){let m=y.Rd();for(;m;){if(this.Pwi(k,this.m4,m))return this.gAc=m,x=Object.assign(new l.a,{$G:this.key,contentObject:m,description:this.Vib()}),{returnValue:!0,hG:x};m=y.Oj()}}return{returnValue:!1,hG:x}}Pwi(k,x,y){if(this.trj(y))return!1;const m=this.U$a.W$b(y,!0),t=this.U$a.W$b(y,
!1);return m&&t&&this.gb.BXc(x,m,t)&&(x=this.U$a.Ewa(m,y.id,!0))&&(m!==this.m4||x.Lb.cp<=k)&&(y=this.U$a.Ewa(t,y.id,!1))&&(t!==this.m4||y.Lb.cp>k||y.Lb.cp>=k)?!0:!1}trj(k){return k.ja(e.a.SG,!1)}Vib(){return null}}Object(D.a)(a,"CommentDetailsProvider",null,[414,415])},1705:function(D,I,c){c.d(I,"a",function(){return e});D=c(0);I=c(156);var l=c(103);class e extends I.a{constructor(){super();this.documentTypeConfidences=null;this.H_=Object.assign(new l.a,{T_:e.getTypeName(),B_:e.getBaseTypes()})}static getTypeName(){return"AugLoop_DocumentTypeClassifier_DocumentTypeClassifierAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}
Object(D.a)(e,"DocumentTypeClassifierAnnotation",I.a,[])},1709:function(D,I,c){c.d(I,"a",function(){return z});D=c(0);var l=c(2),e=c(357),a=c(86),k=c(7),x=c(54),y=c(82),m=c(61),t=c(343);class z{constructor(v,H,F,G,M,K){this.dOe=null;this.Ebh=0;this.y3=!1;this.Ad=G;this.Re=H;this.JZ=M;this.bEe=F;this.ksc=l.AFrameworkApplication.Pgg();this.fwe=v.appSettings.ChromeClipboardAccessOperationTimeout;this.EI=0;this.dZj=K;this.C2j=v.$("EnableExternalPasteSupportOnMobileIsEnabled");this.rg=e.a.getInstance(t.a.i0a);
this.y3=v.$("ShouldLogCcpExtendedHealthKpis")}get hTa(){return this.JZ.hTa}process(v,H){if(!this.EI)return this.RBn(H);if(1===this.EI)return this.SNb(v,H);if(2===this.EI)return this.EI=3,this.dOe(v,H);3===this.EI&&this.JZ.Deg(v,H);return!1}RBn(v){let H=!0;this.C2j&&(H=!(v.Tw&1));this.Re.U4&&H||v.Tw&512?(this.dOe=v.Tw&2?Object(x.a)(this.JZ,this.JZ.paste,"paste"):Object(x.a)(this.JZ,this.JZ.o1i,"pasteInternal"),this.EI=2):(this.ksc?(this.EI=1,this.Ebh=Date.now()):this.EI=2,this.dOe=Object(x.a)(this.JZ,
this.JZ.paste,"paste"));t.a.U6m(v);return!0}SNb(v,H){v=!0;if(this.bEe.value.D3i())this.EI=2;else{const F=Date.now()-this.Ebh;F>this.fwe&&(k.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",F),this.Ad.Yb(y.a.moa,{["Reason"]:m.a.h_i}),H.cS&&(H.cS.fail("Prepare for paste timed out",!1),this.y3?this.rg.logKpiFailure({kpiName:t.a.sOa,errorName:"PreparePasteTimedOut",optionalVeto:{name:t.a.uob,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}):a.Health.instance.recordQosError("PreparePasteTimedOut",
[t.a.uob],!1,!0,!0,!1,null)),H.failed=!0,v=!1,this.dZj.W6n())}return v}}Object(D.a)(z,"ClipboardOperationPasteProcessor",null,[713])},1710:function(D,I,c){c.d(I,"a",function(){return V});D=c(0);I=c(297);var l=c(357),e=c(86),a=c(2),k=c(42),x=c(174),y=c(7),m=c(112),t=c(69),z=c(1463),v=c(54),H=c(88),F=c(3),G=c(82),M=c(61),K=c(1109),L=c(17),R=c(48),S=c(1642),N=c(1711),O=c(343),W=c(117);class V extends I.a{constructor(Q,Y,ba,Z,ea,ha,ka,ua,sa,Da,Pa,Ra,Ga,ta,va,ia,qa,pa,Fa,za,Oa,xa,fa,Ka,lb,Xa,kb,Bb=!0){super();
this.ela=this.jw=null;this.YL=this.nz=0;this.geb=this.iSe=this.Uaa=this.qh=null;this.q7=!1;this.tT=!0;this.lYg=!1;this.init(Q);this.Rl("ClipboardOperation");this.zkb(sa,Y,ea,ha,ka);this.Ad=Da;this.Fe=Pa;this.Re=Ra;this.Lc=Ga;this.kPg=ta;this.mPg=va;this.lPg=ia;this.swe=qa;this.sVb=pa;this.twe=Fa;this.ksc=ua;this.Xrc=za;this.xNa=Oa;this.ook=Bb;this.HD=xa;this.Vd=fa;this.Qm=Ka;this.i_=lb;this._context=Z;this.ega=Xa;this.r0b=kb;this.rg=l.a.getInstance(O.a.i0a);ka&&Object(m.a)(96,ka)&&(this.Uaa=Object(t.a)(717,
ka.ja(x.a.jva,null)));this.Uaa||(this.Uaa=this.ega.Qad());this.Lsb=void 0===ba||null===ba?"NotAvailable":Object(z.a)(N.a,ba);this.Uaa.aEk(this.Lsb.split(", "));Q=this._context;if(this.r0b){if(!V.EBh(Q,this.swe,this.Ad,this.Uaa,Bb)){this.ur=8;this.finish();return}this.qh=Q.view;this.q7=3===this.qh.xKb;this.nz=0;this.YL=ba;this.geb=qa.hTa}else{if(!Q.view.ue){this.Ad.Yb(G.a.ef,{["Reason"]:M.a.cMb});this.Uaa.fail("Not in interactive view",!0);this.ur=8;this.finish();return}this.qh=Q.view;if(!this.qh.mb){this.Ad.Yb(G.a.ef,
{["Reason"]:M.a.noSelection});this.Uaa.fail("No selection manager",!0);this.ur=8;this.finish();return}this.q7=3===this.qh.xKb;this.nz=0;this.YL=ba;this.geb=qa.hTa;if(Bb&&!(this.geb&&this.geb.lb&&this.geb.length)){this.Ad.Yb(G.a.ef,{["Reason"]:M.a.noSelection});this.Uaa.fail("No selection when one required",!0);this.ur=8;this.finish();return}}qa=L.SelectionEditor.Pl(this.geb.lb);qa=!(this.YL&16&&qa);qa=Fa.yJm(ba,this.qg)&&qa;1!==this.behavior&&qa||(qa||this.Uaa.fail("Clipboard operation disabled for selection",
!0),this.ur=qa?32:8,this.tra());!this.lYg&&this.Re.vi&&(k.b("IPadCCP"),this.lYg=!0)}get qg(){this.iSe||(this.iSe=R.a.b4b(this.geb));return this.iSe}Xda(){super.Xda();this.geb=null}run(){this.nz||this.setup();1===this.nz&&this.process();2===this.nz&&this.LIo();3===this.nz&&this.IIo();4===this.nz&&this.finish()}setup(){if(this.YL&256&&this.ksc){this.JC||this.sVb.fXk(this,this.YL,this.Lsb);this.JC.run();if(this.JC.inProgress)return;this.tT=this.JC.Bqa;this.mGd();if(!this.tT){this.Uaa.fail("No access to system clipboard",
!0);this.ur=8;this.nz=4;this.j3d();return}}else y.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}; {3}",this.YL,this.Lsb,this.Re.qG,this.actionId);this.YL&32&&!this.Fe.NZd(this.qh.mb.qg)?(y.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this.Ad.Yb(G.a.ef,{["Reason"]:M.a.xdf}),this.Uaa.fail("Cut not allowed",!0),this.Xrc.show(),this.ur=8,this.nz=4):(this.YL&16||this.YL&32)&&H.a.instance.J(1)&&this.HD.O0d(this.qh.mb.ib.lb)?(this.Uaa.fail("Selected content deleted in coauthoring",
!0),this.Vd.hRb(),this.ur=8,this.nz=4):(this.YL&4096&&(this.i_.Zic(Object.assign(new K.a,{DWc:!0,ZY:this.Lsb})),this.Qm.undo()),this.twe.AGn(this.YL),this.qh.ed?(this.jw=this.Lc.Pc(15),this.jw.Uj=this.actionId,this.jw.Db(this.qh.ed),this.nz=1):(this.Uaa.fail("Interactive view has null target node",!0),this.ur=8,this.nz=4))}process(){if(!this.JC){y.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this.YL,this.Lsb,this.Re.qG);y.ULS.shipAssertTag(6305507,307,!this.ela);
this.ela=new S.a(this._context,this.YL,this.Uaa,this.x$,this.XL,void 0,this.Re.qG,this.ook,this.q7);let Q;Q=this.YL&65536?Object(v.a)(this.kPg,this.kPg.process,"process"):this.YL&64?Object(v.a)(this.mPg,this.mPg.process,"process"):this.YL&1?Object(v.a)(this.swe,this.swe.process,"process"):Object(v.a)(this.lPg,this.lPg.process,"process");this.YL&16&&this.qh.mb.cAa.K2h();this.xNa.create(this,Q,this.ela).Rl("ClipboardAction")}y.ULS.shipAssertTag(6305536,307,!!this.JC);this.JC.run();this.JC.inProgress||
(this.mGd(),this.nz=this.Qh?2:3)}LIo(){this.ela.vdc&&(this.jw.Uj=F.a.typing);this.ela.WWc&&this.jw.eHa(this.ela.gBf,this.ela.AUf);this.jw.dispose();this.ur=this.ela.failed?8:32;this.nz=4}IIo(){if(this.JC){if(this.JC.run(),this.JC.inProgress)return}else if(this.ela.vdc&&(this.jw.Uj=F.a.typing),this.jw.HIa(this),this.ela.WWc&&this.jw.eHa(this.ela.gBf,this.ela.AUf),this.jw.dispose(),this.jZe)return;this.ur=this.ela.failed?8:32;this.nz=4}finish(){this.i_.Zic(Object.assign(new K.a,{DWc:!1}));this.tra();
32===this.response?y.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",+this.endTime-+this.startTime,this.YL,this.Lsb,this.Re.qG):y.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",+this.endTime-+this.startTime,this.YL,this.Lsb,this.Re.qG);this.ega.nha(this.Uaa);(V.dRn||V.kgg)&&this.H4m()}j3d(){const Q=!!(this.YL&1),Y=this._context.view;Y&&O.a.j3d(Q,Y.mb,this.Re.qG)}H4m(){if(!(this.YL&4||this.YL&64)){var Q=
new Map;Q.set("isCopy",String.format("{0}",!!(this.YL&16)));Q.set("isIPad",String.format("{0}",this.Re.vi));V.kgg?(Q.set("SkipAria","false"),Q.set("ErrorLevel","info"),this.rg.logKpiUsage({kpiName:O.a.DFd,kpiType:0,optionalProperties:{extendedProperties:Q},blockFutureEmissionDurationInMs:0})):e.Health.instance.recordKpiUsage(O.a.DFd,0,O.a.EFd,Q);this.tT||(V.kgg?(Q.set("SkipAria","false"),Q.set("ErrorLevel","info"),this.rg.logKpiFailure({kpiName:O.a.DFd,errorName:O.a.JCh,optionalProperties:{isIntentional:!0,
isInternal:!0,additionalValues:{extendedProperties:Q}},blockFutureEmissionDurationInMs:0})):(Q=Object.assign(new W.a,{extendedProperties:Q}),e.Health.instance.recordKpiFailure(O.a.DFd,O.a.JCh,!0,!0,Q)))}}static get dRn(){null==V.YPe&&(V.YPe=!!a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("RecordCcpErrorDialogKpiIsEnabled"));return V.YPe}static get kgg(){null==V.y3&&(V.y3=!!a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("ShouldLogCcpExtendedHealthKpis"));return V.y3}static d6f(Q,Y,
ba,Z){Q&&Q.Yb(G.a.ef,{["Reason"]:ba});Y&&Y.fail(Z,!0)}static EBh(Q,Y,ba=null,Z=null,ea=!0){return Q.view.ue?Q.view.mb?!ea||Y.hTa&&Y.hTa.lb&&Y.hTa.length?!0:(V.d6f(ba,Z,M.a.noSelection,"Paste target is invalid"),!1):(V.d6f(ba,Z,M.a.noSelection,"No selection manager"),!1):(V.d6f(ba,Z,M.a.cMb,"Not in interactive view"),!1)}}V.YPe=null;V.y3=null;Object(D.a)(V,"ClipboardOperation",I.a,[])},1711:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);var l;(function(e){e[e.paste=1]="paste";e[e.Gtp=2]="textOnly";
e[e.J_i=4]="overtype";e[e.copy=16]="copy";e[e.lhp=32]="deleteSelection";e[e.move=64]="move";e[e.Mup=256]="useSystemClipboard";e[e.Kjp=512]="forceInternalClipboard";e[e.BTa=4096]="reformatPastedContent";e[e.qpp=8192]="pasteAsPlainText";e[e.cad=65536]="showPlaceholderGlossary";e[e.Zpp=131072]="reformatPastedContentWithDesignerPaste";e[e.Nnp=262144]="noSpacesAdjustment";e[e.MOi=524288]="mergeAfterPaste"})(l||(l={}));Object(D.b)("ClipboardActionFlags",l)},1715:function(D,I,c){var l=this&&this.aB||(Object.create?
function(a,k,x,y){void 0===y&&(y=x);var m=Object.getOwnPropertyDescriptor(k,x);if(!m||("get"in m?!k.hz:m.writable||m.configurable))m={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,m)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(I,"__esModule",{value:!0});e(c(1874),I);e(c(1875),I)},1716:function(D,I,c){c.r(I);c.d(I,"FootnoteEndnoteDefaultContentInserter",
function(){return G});D=c(0);var l=c(22),e=c(60),a=c(2),k=c(36),x=c(549),y=c(26),m=c(6),t=c(16),z=c(54),v=c(1206),H=c(892),F=c(1644);class G{constructor(M,K,L,R,S=null){this.Yc=M;this.VYj=K;this.om=L;G.rh=R;this.UQg=S||G.Gbl}get BL(){return null!=this.TEg?this.TEg:this.TEg=l.a.instance.resolve("Box4.IOutlineEditor")}I$k(M,K){var L=this.Yc.Ek();L.set(M);this.BL.Fkb(L,null,!0);G.rh.xQb(L.currentNode,this.om);M=k.OutlineElementNavigator.Ee(L);G.c6.W9c(K?Box4Intl.Box4Strings.L_StyleWordFootnoteText:Box4Intl.Box4Strings.L_StyleWordEndnoteText,
M);L=this.UQg(L.currentNode);G.jg.Ge(L,G.PQh);this.iEm(M,K)}iEm(M,K){var L=this.VYj(131073);L.setValue(m.a.Qs,1===K?36:35);L.setValue(m.a.lna,!0);L.setValue(t.a.Z$,!0);const R=M.Mc.Uu(L,e.a.create());L=this.UQg(M);G.jg.hia(L,S=>H.a.getInstance(S,R,!0),F.a.H6h(M,K))}static fm(){return new G(new x.a,Object(z.a)(v.a.instance,v.a.instance.createInstance,"createInstance"),a.AFrameworkApplication.isRtl,l.a.instance.resolve("Box4.IOutlineElementEditor"))}static get c6(){return null!=G.mHg?G.mHg:G.mHg=l.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get jg(){return null!=
G.axg?G.axg:G.axg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get instance(){return null!=G.eDg?G.eDg:G.eDg=G.fm()}static Gbl(M){return y.a.Rc(M,0)}}G.PQh=" ";G.rh=null;Object(D.a)(G,"FootnoteEndnoteDefaultContentInserter",null,[668])},1717:function(D,I,c){c.d(I,"a",function(){return x});D=c(0);var l=c(549),e=c(536),a=c(1567),k=c(1644);class x{constructor(y,m){this.cta=m}AVd(y,m,t){return(y=this.cta.Xci(y.node,t?y.cpBegin:y.cpEnd,m))?y.H4():null}Bli(y,m){return(y=this.cta.Y$l(y.node,
y.cpBegin,m))?y.H4():null}static CQc(){return new x(e.a.instance,a.a.instance,new l.a,k.a.instance)}static get instance(){return null!=x.CCg?x.CCg:x.CCg=x.CQc()}}Object(D.a)(x,"FootnoteEndnoteNavigator",null,[649])},1729:function(D,I,c){c.d(I,"a",function(){return x});D=c(0);var l=c(1792),e=c(2),a=c(50),k=c(22);class x{constructor(y,m,t,z,v,H){this.Dta=y;this.Eta=m;this.eEe=t;this.GZ=z;this.bkd=v;this.JUb=H}get usj(){return!this.Eta&&!this.eEe}get aTi(){return 2===this.JUb?CommonUIStrings.l_OICErrorC2ROneNoteOffer:
CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get pYh(){return CommonUIStrings.l_OICErrorMessageNoOffice}get Tpi(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get $jb(){return CommonUIStrings.l_OICErrorHelpLink}get Foi(){return"OICFailure"}get icon(){return 3}get bBd(){return 2===this.JUb?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}SPn(y){this.nTi(y)}P0m(y){this.nTi(y)}nTi(y){let m=
10;1===y?(k.a.instance.resolve("Common.IOfficeTrialExperience").wKf(this.JUb),m=3):2===y&&((!this.eEe||this.eEe(this.GZ))&&this.Eta&&l.a.instance.Wcl(this.Eta,this.Dta,this.GZ),m=5);(0===y||1===y)&&this.Dta&&this.Dta(this.GZ);e.AFrameworkApplication.s7c(a.a.XZi,this.bkd,m);this.dispose()}dispose(){this.GZ=this.Eta=this.Dta=null}}Object(D.a)(x,"AOICErrorDialogWithTrial",null,[9])},1788:function(D,I,c){D=c(0);var l=c(2),e=c(20),a=c(22),k=c(758),x=c(1573),y=c(2061),m;(function(fa){fa[fa.default=0]="default";
fa[fa.numbered=1]="numbered";fa[fa.bullet=2]="bullet";fa[fa.invalid=3]="invalid"})(m||(m={}));Object(D.b)("ListTypeOfMultiLevelList",m);var t=c(35);class z{constructor(fa,Ka=null){this.Xbk=fa;this.K3=Ka||x.a.crf(e.a.IBb,"")}get Ty(){return this.Xbk}get Jc(){return this.K3}Sdg(fa){this.Jc.d++;return this.Ty.Sdg(fa)}tlc(fa){this.Jc.e++;return this.Ty.tlc(fa)}HL(fa){this.Jc.f++;return this.Ty.HL(fa)}Vpb(fa){this.Jc.h++;return this.Ty.Vpb(fa)}Q5(fa){this.Jc.i++;return this.Ty.Q5(fa)}dka(fa){this.Jc.j++;
return this.Ty.dka(fa)}OIa(fa){this.Jc.k++;return this.Ty.OIa(fa)}vra(fa){this.Jc.l++;return this.Ty.vra(fa)}Rge(fa){this.Jc.m++;return this.Ty.Rge(fa)}pUa(fa,Ka=!1){this.Jc.n++;return this.Ty.pUa(fa,Ka)}ayf(){this.Jc.o++;return this.Ty.ayf()}Xhg(){this.Jc.p++;return this.Ty.Xhg()}Yv(fa){this.Jc.q++;return this.Ty.Yv(fa)}Gza(fa){this.Jc.r++;return this.Ty.Gza(fa)}ilc(fa){this.Jc.g++;return this.Ty.ilc(fa)}Y9c(fa){return this.Ty.Y9c(fa)}Zpb(fa){this.Jc.s++;return this.Ty.Zpb(fa)}yhe(fa){this.Jc.s++;
return this.Ty.yhe(fa)}jcf(fa){this.Jc.ba++;return this.Ty.jcf(fa)}wge(fa){this.Jc.s++;return this.Ty.wge(fa)}Xpb(fa){this.Jc.s++;return this.Ty.Xpb(fa)}EQb(fa){this.Jc.t++;return this.Ty.EQb(fa)}Rhe(fa){this.Jc.u++;return this.Ty.Rhe(fa)}aka(fa){this.Jc.v++;return this.Ty.aka(fa)}Leg(fa){this.Jc.bb++;return this.Ty.Leg(fa)}K$(fa){return this.Ty.K$(fa)}F$(fa){this.Jc.z++;return this.Ty.F$(fa)}l$f(){return this.Ty.l$f()}mea(fa,Ka){this.Jc.w++;this.Jc.x++;return this.Ty.mea(fa,Ka)}mD(fa){this.Jc.y++;
return this.Ty.mD(fa)}LC(){return this.Ty.LC()}clone(){return new z(this.Ty.clone(),this.Jc)}}Object(D.a)(z,"FormattingStewardUsageCollector",null,[344]);class v extends z{constructor(fa,Ka=null){super(fa,Ka)}get U9(){return this.Ty}get yw(){return this.U9.yw}set yw(fa){this.U9.yw=fa}get textIndent(){return this.U9.textIndent}get marginLeft(){return this.U9.marginLeft}get Tmc(){return this.U9.Tmc}get fS(){return this.U9.fS}get lineSpacing(){return this.U9.lineSpacing}get X5(){return this.U9.X5}get leftIndent(){return this.U9.leftIndent}get Qda(){return this.U9.Qda}get paragraph(){return this.U9.paragraph}set paragraph(fa){this.U9.paragraph=
fa}get nR(){return this.U9.nR}get cnc(){return this.U9.cnc}gne(fa){return this.U9.gne(fa)}Tng(fa){return this.U9.Tng(fa)}clone(){const fa=this.Ty.clone();return new v(fa,this.Jc)}}Object(D.a)(v,"FormattingStewardUsageCollector",z,[770,344]);var H=c(8),F=c(377),G=c(877),M=c(36),K=c(207),L=c(84),R=c(40),S=c(60),N=c(358),O=c(140),W=c(19),V=c(86),Q=c(55),Y=c(2060),ba=c(16),Z=c(6),ea=c(46),ha=c(117),ka=c(596),ua=c(359),sa=c(145),Da=c(59),Pa=c(98),Ra=c(179),Ga=c(1636),ta=c(151),va=c(26),ia=c(1419),qa=c(891);
class pa{constructor(fa,Ka,lb,Xa,kb,Bb,Ja,Ma,fb,hc,cc=null){var mb;this.xE=this._paragraph=null;this.Dtd=Y.a.none;this.COg=this.Etd=null;this.Raa=0;this.Zxb=this.cnc=this.leftIndent=this.X5=this.Eyc=this.fS=this._tabStops=this._marginLeft=this._textIndent=null;this.paragraph=fa;this.De=Ka;this.$u=lb;this.qz=Xa;this.yK=kb;this.tXb=Bb;this.Fla=Ja;this.cWb=Ma;this.oXa=fb;this.dvb=hc;cc?(t.a(4223818,307,!!cc.xE),this.xE=cc.xE.rna(this.paragraph),this.Dtd=cc.Rhc,this.Etd=cc.S_f,cc.fS&&(this.fS=new ia.a,
this.fS.afterSpacing.value=cc.fS.afterSpacing.value,this.fS.beforeSpacing.value=cc.fS.beforeSpacing.value,null===(mb=l.AFrameworkApplication.K)||void 0===mb?0:mb.getBooleanFeatureGate("Microsoft.Office.WordOnline.isParagraphSpacingFixInPasteEnabled",!1))&&(this.fS.afterSpacing.unit=cc.fS.afterSpacing.unit,this.fS.beforeSpacing.unit=cc.fS.beforeSpacing.unit),cc.lineSpacing&&(this.Eyc=cc.lineSpacing.clone()),this.Raa=cc.Raa,this.cnc=cc.cnc.clone(),this._textIndent=cc.textIndent,this._marginLeft=cc.marginLeft,
this._tabStops=cc.Tmc,this.X5=cc.X5,this.leftIndent=cc.leftIndent,cc.Qda&&(this.Zxb=cc.Qda)):(this.xE=new Ra.a(this.paragraph,0),this.xE.formatting=new ta.a(this.xE,S.a.nil),Ka=va.a.tw(fa),Ka=this.yK.Yr(Ka),this.Uho(Ka),this.tvo(fa)?(this.tXb.ojo(this.xE.formatting,Ka),fa.hasProperty(ba.a.Kh)?this.Raa=fa.getValue(ba.a.Kh):this.Raa=0):this.Raa=-1,this.Dtd=0,this.fS=this.Etd=null,this.dvb&&(this.fS=this.tXb.nQa(fa),this.Eyc=this.tXb.zGb(fa),this.X5=this.tXb.V$b(fa),this.leftIndent=this.tXb.wU(fa)),
this.cnc=new N.DictionaryPropertySet)}get paragraph(){return this._paragraph}set paragraph(fa){t.a(4223816,307,!!fa&&H.ParagraphReader.Xb(fa));this._paragraph=fa}get nR(){return this.xE.formatting}get Rhc(){return this.Dtd}get S_f(){return this.Etd}get qw(){return this.COg}get yw(){return this.Raa}set yw(fa){t.a(4223817,307,1===fa||2===fa||3===fa||6===fa);this.Raa=fa}get textIndent(){return this._textIndent}get marginLeft(){return this._marginLeft}get Tmc(){return this._tabStops}get lineSpacing(){return this.Eyc}get Qda(){return this.Zxb}get qc(){return this.qz}Uho(fa){const Ka=
this.yK.language(fa);Ka&&this.De.Tdg(this.xE.formatting,Ka,0,fa.cache.AJb,!1)}tvo(fa){fa=this.qc.Ag(this.qc.So(fa));return fa===Da.StyleReader.dqe||fa===Da.StyleReader.wordStyleIdNormal||fa===Da.StyleReader.Dpc||fa===Da.StyleReader.styleIdNormal}Sdg(fa){(fa=k.a.tg(fa))&&this.De.ghe(this.xE.formatting,fa.LCID);return!0}tlc(){return!1}HL(fa){this.De.HL(this.xE.formatting,fa);return!0}Vpb(fa){this.De.az(this.xE.formatting,fa);return!0}Q5(fa){this.De.Q5(this.xE.formatting,fa);return!0}dka(fa){this.De.dka(this.xE.formatting,
fa);return!0}OIa(fa){this.De.OIa(this.xE.formatting,fa);return!0}vra(fa){this.De.vra(this.xE.formatting,fa);return!0}Rge(fa){if(0>=fa)return!1;this.De.WA(this.xE.formatting,fa);return!0}pUa(fa,Ka){if(!fa||""===fa)return!1;if(({g2h:lb}=O.FontUtils.rDj(fa)).returnValue)return this.De.$ja(this.xE.formatting,lb.fontName),!0;var lb=!1;const Xa=O.FontUtils.FSa(fa);Ka&&this.Nlb(Xa,this.Fla)&&(this.Fla.Fna(fa),lb=!0);if(this.Nlb(Xa,this.cWb)||this.Nlb(Xa,this.oXa))lb=!0;lb&&this.De.$ja(this.xE.formatting,
Xa);return lb}Nlb(fa,Ka){return!!Ka&&Ka.isEnabled&&Ka.Nlb(fa)}ayf(){this.De.Zli(this.xE.formatting);return!0}Xhg(){this.De.ytj(this.xE.formatting);return!0}Yv(fa){var {Box4PasteSteward:Ka}=c(1538);if(null===fa||""===fa)return!1;fa=Ka.UCb(fa);Ka=null;this.Qda&&this.Qda.hasOwnProperty(Z.a.listLevel.id.toString())&&(Ka=this.Qda[Z.a.listLevel.id.toString()]);this.De.Yv(this.xE.formatting,fa,Ka);return!0}Gza(fa){const {Box4PasteSteward:Ka}=c(1538);if(!fa||""===fa||!pa.nmm().contains(fa))return!1;this.De.Gza(this.xE.formatting,
Ka.UCb(fa));return!0}ilc(fa){this.De.ilc(this.xE.formatting,fa);return!0}Y9c(fa){let Ka=0;switch(W.a.eh(fa)){case "small-caps":Ka=1;break;case "uppercase":Ka=2}this.De.hm(this.xE.formatting,ea.a.capitalization,Ka);return!0}F$(fa){const {Box4PasteSteward:Ka}=c(1538);if(!fa||""===fa)return!1;this.cnc.setValue(ba.a.UK,parseInt(Ka.UCb(fa),16));return!0}Xpb(fa){return 0>=fa?!1:this.yhe(this.qc.Lfm(fa))}Zpb(fa){this.LC();this.Dtd=fa;return!0}jcf(fa){var {Box4PasteSteward:Ka}=c(1538),lb=new Map;lb.set("Source",
"CreateStyleCCP_FormattingSteward");V.Health.instance.recordKpiUsage(sa.a.zLj,0,sa.a.yB,lb);lb=Pa.a.Ifm(fa);fa=[];fa.push(lb);(fa=Pa.a.OFc(fa,this.paragraph))?(Ka.Nmc=this.qc.Cr(),t.b(593078085,3017,50,"Custom style created via paste.")):(Ka=new Map,Ka.set("Source","CreateStyleCCP_FormattingSteward"),Ka.set("IsStyleNull",(!lb).toString()),Ka=Object.assign(new ha.a,{extendedProperties:Ka}),V.Health.instance.recordKpiFailure(sa.a.zLj,"UnableToCreateStyle",!1,!0,Ka));return fa}yhe(fa){const {Box4PasteSteward:Ka}=
c(1538);return fa&&0<fa.length&&Ka.Nmc&&Ka.Nmc.oj(fa)?(this.Etd=fa,!0):!1}wge(fa){const {Box4PasteSteward:Ka}=c(1538);return fa&&0<fa.length&&Ka.Nmc&&Ka.Nmc.oj(fa)?(this.COg=fa,!0):!1}Tng(fa){if(this.qw){fa=this.qc.JB(fa);if(!fa)return t.a(41968715,307,!1),!1;(fa=fa.oj(this.qw))&&this.De.c8a(this.xE.formatting,fa);return!0}return!1}mea(fa,Ka){this.fS=new ia.a;this.fS.beforeSpacing=this.bmo(fa);this.fS.afterSpacing=this.amo(Ka);return!0}bmo(fa){return new qa.a(4,fa)}amo(fa){return new qa.a(4,fa)}mD(fa){if(!fa)return!1;
const Ka=parseFloat(W.a.substring(fa,0,W.a.eh(fa).indexOf("px")));if(!isNaN(Ka))return this.Eyc=new qa.a(3,Q.a.Wy(Ka,1)),!0;fa=parseFloat(W.a.substring(fa,0,W.a.eh(fa).indexOf("%")));return isNaN(fa)?!1:(this.Eyc=new qa.a(2,fa/100),!0)}EQb(fa){let Ka=0;if(!fa||""===fa)return!1;switch(fa){case "left":Ka=1;break;case "center":Ka=2;break;case "right":Ka=3;break;case "justify":Ka=6}if(!Ka)return!1;this.yw=Ka;return!0}Rhe(fa){this._textIndent=fa;return!0}aka(fa){this._marginLeft=fa;return!0}Leg(fa){this._tabStops=
fa;return!0}K$(fa){this.Zxb=JSON.parse(fa);return this.Qda?!0:!1}LC(){this.xE.formatting=new ta.a(this.xE,S.a.nil);return!0}l$f(){this.Raa=0;return!0}gne(fa){var {Box4PasteSteward:Ka}=c(1538);if(this.Rhc>Y.a.none&&Ka.w6a[this.Rhc]){t.a(4223819,307,1<=this.Rhc);t.a(4223820,307,this.Rhc<=Y.a.maxParagraphStyle);Ka=this.qc.JB(fa);if(!Ka)return t.a(4223821,307,!1),!1;Ka=Ka.oj(c(1538).Box4PasteSteward.w6a[this.Rhc]);this.$u.aK(Ka,fa,!1);return!0}if(this.S_f){Ka=this.qc.JB(fa);if(!Ka)return t.a(41968716,
307,!1),!1;Ka=Ka.oj(this.S_f);this.$u.aK(Ka,fa,!1);return!0}return!1}clone(){return new pa(this.paragraph,this.De,this.$u,this.qz,this.yK,this.tXb,this.Fla,this.cWb,this.oXa,this.dvb,this)}static nmm(){pa.x_||(pa.x_=new ka.a(ua.a.ih()),pa.x_.add(Ga.a.yellow),pa.x_.add(Ga.a.Z0m),pa.x_.add(Ga.a.TGk),pa.x_.add(Ga.a.iKl),pa.x_.add(Ga.a.blue),pa.x_.add(Ga.a.red),pa.x_.add(Ga.a.wgn),pa.x_.add(Ga.a.Dyj),pa.x_.add(Ga.a.green),pa.x_.add(Ga.a.purple),pa.x_.add(Ga.a.Ean),pa.x_.add(Ga.a.lkn),pa.x_.add(Ga.a.gray),
pa.x_.add(Ga.a.cAo),pa.x_.add(Ga.a.black));return pa.x_}}pa.x_=null;Object(D.a)(pa,"FormattingSteward",null,[770,344]);class Fa{bog(){return!1}uyf(fa){return fa}Ayf(){}K$(){}khe(){}g_d(){return!1}get o0d(){return!1}mD(){}mea(){}Ihe(){}get wrj(){return!1}}Object(D.a)(Fa,"NoOpPasteStewardBridge",null,[321]);var za=c(75);class Oa{constructor(fa,Ka){this.oin=fa;this.pin=Ka||"Normal"}}Object(D.a)(Oa,"NoteTagInfoBox4",null,[]);c.d(I,"a",function(){return xa});class xa{constructor(fa,Ka,lb=null,Xa=null){this.NHl=
l.AFrameworkApplication.K.$("FollowDestinationFormattingPasteIsEnabled");this.Yah=0;this.zc=fa;this.r7=Ka;this.FZ=Xa||new Fa;this.Jc=lb||x.a.crf(e.a.IBb,"")}get jg(){return null!=this.Twg?this.Twg:this.Twg=a.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get fontService(){return null!=this.dAg?this.dAg:this.dAg=a.a.instance.Oa("Box4.IFontService")}get uEa(){return null!=this.ayg?this.ayg:this.ayg=a.a.instance.Oa("Box4.CustomFontService")}get Sul(){return null!=this.Ayg?this.Ayg:this.Ayg=a.a.instance.Oa("Box4.IEmbeddedFontService")}reset(){}get vLc(){return this.Zpf(!1)}Zpf(fa){t.a(4223770,
307,R.OutlineElementReader.Eh(this.zc));const Ka=M.OutlineElementNavigator.Ee(this.zc);M.OutlineElementNavigator.Yd(this.zc);t.a(4223771,307,!!Ka&&H.ParagraphReader.Xb(Ka));fa=new pa(Ka,xa.qn,xa.uE,xa.qc,xa.X8,xa.yJl,this.fontService,this.uEa,this.Sul,this.NHl,void 0,fa);return new v(fa,this.Jc)}Jda(){}Ida(){}Xnb(){}xya(){}BHa(){}MSa(){}LSa(){}jE(){}AF(){}Snb(){}Rnb(){}RSa(){}i6a(){}Bya(){}zya(){}FHa(){}Aya(){}k6a(){}ggc(fa){R.OutlineElementReader.Eh(this.zc)?(xa.Pf.npa(this.zc,!0),M.OutlineElementNavigator.ns(this.zc,
!1,!1)):L.OutlineReader.mx(this.zc)?K.OutlineNavigator.S9(this.zc)?fa?(this.zc.zg(),xa.BL.a8(this.zc,!1)):xa.Pf.ZOb(this.zc):xa.BL.a8(this.zc,!1):t.a(8128524,307,!1,"Unexpected node type {0} encountered",this.zc.Xe)}kRc(fa){let Ka=null;if(fa&&fa.f$&&fa.cultureName)try{Ka=Object.assign(new G.a,{languageId:k.a.tg(fa.cultureName).LCID})}catch(lb){t.a(8128526,307,!1,"Setting up culture {0} encountered {1}",fa.cultureName,lb)}Ka||null==this.r7||(Ka=Object.assign(new G.a,{languageId:this.r7}));return Ka}get mV(){return this.Yah}set mV(fa){this.Yah=
fa}uDd(){}Acd(){}l8e(){}get E5b(){return!1}get HDb(){return!1}B1m(fa){var Ka=1;if(fa.Rzi){var lb=0;switch(fa.listStyleType){case y.a.none:Ka=0;break;case y.a.decimal:Ka=1;break;case y.a.lowerAlpha:Ka=2;break;case y.a.lowerRoman:Ka=3;break;case y.a.upperAlpha:Ka=4;break;case y.a.upperRoman:Ka=5}}else switch(lb=1,fa.listStyleType){case y.a.none:Ka=0;break;case y.a.disc:Ka=1;break;case y.a.circle:Ka=2;break;case y.a.square:Ka=3}var Xa=F.a,kb=Xa.c0,Bb=fa.Kya;const Ja=new za.a;for(const Ma of Bb)Bb=new Oa(Ma.oin,
Ma.pin),Ja.add(Bb);Xa=kb.call(Xa,lb,Ka,Ja,fa.listId,fa.listLevel,fa.levelText,fa.font);fa.ks!==m.invalid&&(Xa.n6=fa.ks);fa.Rzi&&!fa.Fvi&&(Xa.gC=0<fa.listId&&0<=fa.listLevel&&!fa.Whc?fa.wmc:fa.ihl);!Xa.Lz||3!==Xa.listStyle&&5!==Xa.listStyle||(Xa.yw="right");(fa=fa.oLf)&&Xa.propertySet.ax(fa);Xa.Y8b=!0;this.FZ.khe(this.zc);return Xa}b$(){}Z9(){}u5(){}a$(){}Y9(){}X9(){}static get Pf(){return null!=xa.jFg?xa.jFg:xa.jFg=a.a.instance.resolve("Box4.IOutlineElementEditor")}static get BL(){return null!=xa.ZEg?
xa.ZEg:xa.ZEg=a.a.instance.resolve("Box4.IOutlineEditor")}static get qn(){return null!=xa.EAg?xa.EAg:xa.EAg=a.a.instance.resolve("Box4.IFormattingEditor")}static get uE(){return null!=xa.PJg?xa.PJg:xa.PJg=a.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get qc(){return null!=xa.sKg?xa.sKg:xa.sKg=a.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get X8(){return null!=xa.IAg?xa.IAg:xa.IAg=a.a.instance.resolve("Box4.IFormattingReader")}static get yJl(){return null!=xa.JAg?xa.JAg:xa.JAg=
a.a.instance.resolve("Box4.Actors.IFormattingStewardBridge")}}xa.Hf=null;Object(D.a)(xa,"Box4PasteStewardBase",null,[751,239,240])},1792:function(D,I,c){D=c(0);var l=c(54),e=c(7),a=c(2),k=c(50),x=c(464),y=c(22);class m{constructor(R,S,N,O){this.pKe=null;this.bkd=O;this.Dta=R;this.Eta=S;this.GZ=N;this.Egh=this.vLb.lto;R=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.Kak=R[0];this.Jak=R[1]}get vLb(){return this.pKe||(this.pKe=y.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get $jb(){return CommonUIStrings.l_OICErrorHelpLink}get D$c(){return this.Egh}get eNi(){return this.Kak}get dNi(){return this.Jak}get cNi(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.Egh?
3:2}get DNc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get aId(){return!!this.Eta}get ENc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}K5f(R){this.O1c(R)}bLf(R){this.O1c(R)}O1c(R){let S=10;this.Eta&&1===R&&(this.Eta(this.GZ),S=1);this.Dta&&this.Dta(this.GZ);this.mN(S)}kMb(){x.Redirect.showHelp("OICFailure");this.mN(2)}SUf(){this.vLb.CGi();this.mN(4)}mN(R){e.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",
this.bkd,R);a.AFrameworkApplication.s7c(k.a.VZi,this.bkd,R)}dispose(){this.GZ=this.Dta=this.Eta=null}}Object(D.a)(m,"AOICErrorDialog",null,[9]);var t=c(38),z=c(181);class v extends m{constructor(R,S,N,O){super(R,S,N,O);this.xcb=this.ZF=null;R=document.createElement("span");R.id="errorMessageText";R.innerText=this.errorMessage;R.appendChild(document.createElement("br"));R.appendChild(document.createElement("br"));this.ZF=document.createElement("a");this.ZF.href="#";this.ZF.innerText=this.$jb;R.appendChild(this.ZF);
t.a.addHandler(this.ZF,"click",Object(l.a)(this,this.kMb,"oicErrorHelpLinkHandler"));S=new z.StandardDialog;S.yg=this.id;this.D$c?(N=document.createElement("span"),O=document.createElement("span"),N.innerText=this.eNi,O.innerText=this.dNi,this.xcb=document.createElement("a"),this.xcb.href="#",this.xcb.innerText=this.cNi,R.appendChild(document.createElement("br")),R.appendChild(N),R.appendChild(this.xcb),R.appendChild(O),t.a.addHandler(this.xcb,"click",Object(l.a)(this,this.SUf,"oicErrorMacOfferLinkHandler"))):
this.aId&&(R.appendChild(document.createElement("br")),R.appendChild(document.createElement("br")),N=document.createElement("span"),N.innerText=this.DNc,R.appendChild(N));this.aId?(S.Cd=1,S.ze(1,this.ENc)):S.Cd=0;S.rv(this.dialogTitle,null,this.icon,Object(l.a)(this,this.bLf,"legacyOICErrorDialogHandler"),R);S.L5("errorMessageText")}dispose(){this.ZF&&(t.a.removeHandler(this.ZF,"click",Object(l.a)(this,this.kMb,"oicErrorHelpLinkHandler")),this.ZF=null);this.xcb&&(t.a.removeHandler(this.xcb,"click",
Object(l.a)(this,this.SUf,"oicErrorMacOfferLinkHandler")),this.xcb=null);super.dispose()}}Object(D.a)(v,"OICErrorDialog",m,[]);class H{constructor(R,S,N){this.Dta=S;this.Eta=R;this.GZ=N}get id(){return"OICErrorDialogWithDownload"}get qYh(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get $jb(){return CommonUIStrings.l_OICErrorHelpLink}get DNc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get ENc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get dialogTitle(){return CommonUIStrings.l_DefaultDialogTitle}K5f(R){this.O1c(R)}bLf(R){this.O1c(R)}O1c(R){let S=
10;1===R&&(this.Eta(this.GZ),S=1);this.Dta&&this.Dta(this.GZ);this.mN(S)}kMb(){x.Redirect.showHelp("OICFailure");this.mN(2)}mN(R){a.AFrameworkApplication.s7c(k.a.WZi,3,R)}dispose(){this.GZ=this.Eta=this.Dta=null}}Object(D.a)(H,"AOICErrorDialogWithDownload",null,[9]);class F extends H{constructor(R,S,N){super(R,S,N);this.ZF=null;R=document.createElement("span");R.id="errorMessageText";R.innerText=this.qYh;R.appendChild(document.createElement("br"));R.appendChild(document.createElement("br"));this.ZF=
document.createElement("a");this.ZF.href="#";this.ZF.innerText=this.$jb;R.appendChild(this.ZF);t.a.addHandler(this.ZF,"click",Object(l.a)(this,this.kMb,"oicErrorHelpLinkHandler"));R.appendChild(document.createElement("br"));R.appendChild(document.createElement("br"));S=document.createElement("span");S.innerText=this.DNc;R.appendChild(S);S=new z.StandardDialog;S.yg=this.id;S.Cd=1;S.ze(1,this.ENc);S.rv(this.dialogTitle,null,this.icon,Object(l.a)(this,this.bLf,"legacyOICErrorDialogHandler"),R);S.L5("errorMessageText")}dispose(){this.ZF&&
(t.a.removeHandler(this.ZF,"click",Object(l.a)(this,this.kMb,"oicErrorHelpLinkHandler")),this.ZF=null);super.dispose()}}Object(D.a)(F,"OICErrorDialogWithDownload",H,[]);var G=c(155);class M extends m{constructor(R,S,N,O){super(R,S,N,O);S={["errorMessage"]:this.errorMessage};S.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.$jb,["onExecute"]:W=>{this.kMb(W)}};this.D$c?(S.macOfficePreLinkText=this.eNi,S.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.cNi,
["onExecute"]:W=>{this.SUf(W)}},S.macOfficePostText=this.dNi):this.aId&&(S.errorFileDownloadOffer=this.DNc);R=new G.a(!1,!1,!0);this.aId?(R.Cd=1,R.ze(1,this.ENc)):R.Cd=0;R.yg=this.id;S={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:S};R.Uh(this.dialogTitle,Object(l.a)(this,this.K5f,"reactOICErrorDialogHandler"),S)}}Object(D.a)(M,"ReactOICErrorDialog",m,[]);class K extends H{constructor(R,S,N){super(R,S,N);S={["errorMessage"]:this.qYh,["errorFileDownloadOffer"]:this.DNc};S.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.$jb,["onExecute"]:O=>{this.kMb(O)}};R=new G.a(!1,!1,!0);R.Cd=1;R.ze(1,this.ENc);R.yg=this.id;S={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:S};R.Uh(this.dialogTitle,Object(l.a)(this,this.K5f,"reactOICErrorDialogHandler"),S)}}Object(D.a)(K,"ReactOICErrorDialogWithDownload",H,[]);c.d(I,"a",function(){return L});class L{constructor(){this.iMa=!!a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.Kb.vF}Vcl(R,S,N){this.iMa?new M(R,S,null,N):new v(R,S,null,
N)}Wcl(R,S,N){this.iMa?new K(R,S,N):new F(R,S,N)}Xcl(R,S,N,O,W){const {ReactOICErrorDialogWithTrial:V}=c(1889),{OICErrorDialogWithTrial:Q}=c(1890);this.iMa?new V(R,S,N,null,O,W):new Q(R,S,N,null,O,W)}static get instance(){return L._instance||(L._instance=new L)}}L._instance=null;Object(D.a)(L,"OICErrorDialogFactory",null,[1007])},1793:function(D,I,c){c.r(I);D=c(0);var l=c(309),e=c(1868),a=c(957),k=c(358),x=c(2),y=c(60),m=c(357),t=c(22),z=c(129),v=c(102),H=c(79),F=c(1465),G=c(192),M=c(39),K=c(20),
L=c(270),R=c(174),S=c(7),N=c(249),O=c(112),W=c(69),V=c(306),Q=c(12),Y=c(26),ba=c(3),Z=c(10),ea=c(135),ha=c(534),ka=c(48),ua=c(1710),sa=c(1709),Da=c(343),Pa=c(297);class Ra extends Pa.a{constructor(xa,fa,Ka,lb,Xa,kb){super();this.init(xa);this.Rl("DummyClipboardOperation");this.zkb(x.AFrameworkApplication.va,fa,lb,Xa,kb);this._context=Ka;this.ur=8;this.tra()}run(){this.Ubb=!0;this.r9c(this._context);this.M6a();this.ur=32}}Object(D.a)(Ra,"DummyClipboardOperation",Pa.a,[]);Pa=c(1601);class Ga extends Pa.a{constructor(xa,
fa,Ka,lb,Xa){super(xa,fa,Xa);this.lk=Ka;this.QSe=lb}voc(xa){let fa;if(this.xT&&!xa)return S.ULS.sendTraceTag(594408836,307,10,"No htmlDomContent and htmlClipboardDataContent"),{returnValue:!1,Yva:null};fa=null;if(this.QSe&&!this.xT){const Ka=this.properties.ja(R.a.w1i,"");Ka&&(fa=this.lk.sob(Ka))}fa||(fa=this.lk.sob(xa));return{returnValue:!0,Yva:fa}}}Object(D.a)(Ga,"HtmlStringImportStrategy",Pa.a,[]);var ta=c(1869);class va extends ta.a{constructor(xa,fa,Ka,lb,Xa){super(xa,fa,Ka,lb,Xa)}Kei(){return this.properties.ja(R.a.tNb,
"")}voc(xa){x.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordUseClipboardDataHelperInMultiLineImportSettings");if(this.Rgh){if(this.lk)return xa=this.lk.e0f(xa,!0),{returnValue:!0,Yva:xa};S.ULS.sendTraceTag(592269660,307,10,"_clipboardDataHelper should not be null")}return super.voc(xa)}$Zc(xa){xa=super.$Zc(xa);return xa.length&&" "!==xa?xa:"\u00a0"}}Object(D.a)(va,"MultiLinePlainTextImportStrategy",ta.a,[]);class ia extends Pa.a{constructor(xa,fa,Ka){super(xa,fa,Ka)}voc(xa){({ClipboardActor:fa}=
c(1793));if(this.xT&&!xa)return S.ULS.sendTraceTag(594408834,307,10,"No htmlDomContent"),{returnValue:!1,Yva:null};var fa=fa.SBn;fa.innerText=xa;return{returnValue:!0,Yva:fa}}}Object(D.a)(ia,"PlainTextImportStrategy",Pa.a,[]);var qa=c(82),pa=c(61);class Fa{constructor(xa){this.Y4=this.fHf=!1;this.cga=xa}D3i(){this.fHf||(this.fHf=!0,this.Y4=!1,this.cga.SNb(()=>{this.Y4=!0}));return this.Y4}xCj(){this.fHf=!1;const xa=this.cga.paste();return xa?xa.hasChildNodes()?{returnValue:!0,jId:xa}:(S.ULS.sendTraceTag(7891019,
307,50,"DOM innerText empty."),Fa.Ic.Yb(qa.a.f2,{["Reason"]:pa.a.Sjf}),{returnValue:!1,jId:xa}):(S.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),Fa.Ic.Yb(qa.a.MEb,{["Reason"]:pa.a.Mkg}),{returnValue:!1,jId:xa})}static get Ic(){return G.a.instance}}Object(D.a)(Fa,"SystemClipboardImportStrategy",null,[716]);var za=c(253);c.d(I,"ClipboardActor",function(){return Oa});class Oa{get YFi(){return this.oMa}set YFi(xa){this.oMa=xa}constructor(xa,fa,Ka,lb,Xa,kb,Bb,Ja,Ma,fb,hc,cc,mb,Hb,Ua,
Ya,Fb,Wa){this.Bhd=null;this.oMa=0;this.Mmd=this.QEc=!1;this.mtb=l.a.On;this.bad=()=>{const yb=Array(1);yb.push("PasteRecoveryFloatie");var Yb=this.Yek.eQa();Yb=Object.assign(new e.a,{x:Yb.x,y:Yb.y});this.$L.showFloatie(Yb,yb,1);return 32};this.WHb=()=>{this.$L.M0&&this.$L.dismissFloatie();return 32};this.h6i=(yb,Yb,qc,Hc,$b)=>{if(1===qc)return 32;$b[a.a.On]=!1;return 32};this.itl=(yb,Yb,qc,Hc,$b,Ub)=>{S.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var mc=Ub.DataTransfer;Ub=mc.getData("text/html");
mc=mc.getData("text/plain");let ic=!1;const ab=new k.DictionaryPropertySet;0<Ub.length?(S.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),ab.setValue(R.a.NP,Ub),ic=!0):0<mc.length&&(S.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),ab.setValue(R.a.tNb,mc),ic=!0);if(ic){const bb=this.oy.J(Yb);return this.HGd.create(yb,Yb,bb,new N.a(()=>this.NLc(bb,ab)),qc,Hc,$b,ab)}return null};this.X4f=(yb,Yb,qc,Hc,$b)=>{if(Yb="object"===typeof $b?$b:null)this.s0b?
this.Vgo(yb,this.oMa,Yb):yb===ba.a.Qbe?(yb=this.oMa!==ba.a.BTa&&this.oMa!==ba.a.CTa&&this.oMa!==ba.a.dza,Yb[this.mtb]=this.oMa===ba.a.BTa||yb):yb===ba.a.Rbe?Yb[this.mtb]=this.oMa===ba.a.CTa:yb===ba.a.T4f&&(Yb[this.mtb]=this.oMa===ba.a.dza);return 32};this.zX=(yb,Yb,qc,Hc,$b,Ub)=>{if((x.AFrameworkApplication.cZ||x.AFrameworkApplication.EF)&&!x.AFrameworkApplication.uEb||za.a.sia(qc)&&za.a.Mcc())return new Ra(yb,Yb,qc,Hc,$b,Ub);let mc=this.oy.J(Yb);1!==Hc&&mc&1&&(this.oMa=Yb);if(1!==Hc){var ic=Object(O.a)(96,
Ub)?Ub:null;Ub?(mc&1&&(this.Bhd=ic),ic=ic?ic.ja(R.a.ZY,0):0,Yb===ba.a.paste&&ic===ba.a.f0a?mc=this.oy.J(ba.a.P_):Yb===ba.a.j$&&ic===ba.a.YBb&&(mc=this.oy.J(ba.a.G$d))):!Ub&&mc&4096&&(Ub=this.Bhd,ic=Object(O.a)(96,Ub)?Ub:null)&&(ic=ic.ja(R.a.L3c,y.a.nil),S.ULS.sendTraceTag(575255109,307,50,"Reformatting operation occurred. CorrelationId: {0}",ic))}return this.HGd.create(yb,Yb,mc,new N.a(()=>this.NLc(mc,Ub)),qc,Hc,$b,Ub)};this.BIn=(yb,Yb,qc,Hc,$b)=>this.u6e(yb,Yb,qc,$b);this.AIn=(yb,Yb,qc,Hc,$b)=>this.u6e(yb,
Yb,qc,$b);this.zIn=(yb,Yb,qc,Hc,$b)=>this.u6e(yb,Yb,qc,$b);this.p5d=(yb,Yb,qc,Hc,$b,Ub)=>{Ub=Y.a.Rc(ka.a.instance.ib.lb.Pa.node,Ub);return this.zX(yb,Yb,qc,Hc,$b,Ub)};this.hZj=xa;this.cga=fa;this.Ad=Ka;this.lk=lb;this.ga=kb;this.$hd=fb;this.sVb=hc;this.Ce=cc;this.fg=mb;this.Vb=Ma;this.r0b=Hb;this.s0b=Ua;this.Yek=Ya;this.$L=Fb;this.eHe=Wa;this.rg=m.a.getInstance(Da.a.i0a);Ja&&(this.QEc=Ja.$("UseClipboardDataHelperInMultiLineImportIsEnabled"),this.Mmd=this.s0b&&Ja.$("HandleCtrlShiftVAsPasteTextOnlyIsEnabled"));
this.oy=new V.a;this.oy.Z(ba.a.paste,257);this.oy.Z(ba.a.j$,8449);this.oy.Z(ba.a.P_,1);this.oy.Z(ba.a.P3a,1);this.oy.Z(ba.a.eBb,1);this.oy.Z(ba.a.mDa,1);this.oy.Z(ba.a.yYd,513);this.oy.Z(ba.a.BTa,4097);this.oy.Z(ba.a.CTa,12289);this.oy.Z(ba.a.dza,131073);this.oy.Z(ba.a.j0f,7);this.oy.Z(ba.a.F$d,1);this.oy.Z(ba.a.G$d,8193);this.oy.Z(ba.a.copy,272);this.oy.Z(ba.a.DHc,16);this.oy.Z(ba.a.cut,304);this.oy.Z(ba.a.u5e,48);this.oy.Z(ba.a.o5d,64);this.oy.Z(ba.a.p5d,64);this.oy.Z(ba.a.cad,327680);this.oy.Z(ba.a.Zgf,
1);this.Mmd&&this.oy.Z(ba.a.wob,this.oy.J(ba.a.G$d))}get bVa(){return null!=this.GHg?this.GHg:this.GHg=t.a.instance.Oa("Box4.Clipboard.ISystemClipboardAccessManager")}get telemetry(){return null!=this.$Hg?this.$Hg:this.$Hg=t.a.instance.Oa("Common.Utils.Telemetry.ITelemetry")}get HGd(){return this.hZj.value}get RGo(){return this.cga}Tb(){this.ga.fb(ba.a.fMn,Q.a.application,this.h6i,97);this.ga.fb(ba.a.gMn,Q.a.application,this.h6i,97);this.ga.fb(ba.a.Qbe,Q.a.application,this.X4f,97);this.ga.fb(ba.a.Rbe,
Q.a.application,this.X4f,97);this.ga.fb(ba.a.T4f,Q.a.application,this.X4f,97);this.ga.HT(ba.a.u5e,Q.a.view,this.zX,1028);this.ga.Neb(ba.a.DHc,Q.a.view,this.zX);this.ga.HT(ba.a.Zgf,Q.a.view,this.itl,1028);this.ga.HT(ba.a.P_,Q.a.view,this.zX,1028);this.ga.HT(ba.a.P3a,Q.a.view,this.zX,1028);this.ga.HT(ba.a.eBb,Q.a.view,this.zX,1028);this.ga.HT(ba.a.mDa,Q.a.view,this.zX,1028);this.r0b&&this.ga.fb(ba.a.f0a,Q.a.view,this.zIn,1028);this.s0b&&this.ga.fb(ba.a.YBb,Q.a.view,this.AIn,1028);this.ga.HT(ba.a.paste,
Q.a.view,this.zX,1028);this.ga.HT(ba.a.j$,Q.a.view,this.zX,1028);this.ga.HT(ba.a.G$d,Q.a.view,this.zX,1028);this.ga.HT(ba.a.F$d,Q.a.view,this.zX,1028);this.ga.HT(ba.a.j0f,Q.a.view,this.zX,1028);this.ga.HT(ba.a.BTa,Q.a.view,this.zX,1028);this.ga.HT(ba.a.CTa,Q.a.view,this.zX,1028);this.ga.ra(ba.a.kPb,Q.a.view,z.ActionManager.Of);this.ga.ra(ba.a.D1i,Q.a.view,z.ActionManager.Of);this.ga.ra(ba.a.A1i,Q.a.view,z.ActionManager.Of);this.ga.ra(ba.a.B1i,Q.a.view,z.ActionManager.Of);this.ga.ra(ba.a.C1i,Q.a.view,
z.ActionManager.Of);this.ga.ra(ba.a.z1i,Q.a.view,z.ActionManager.Of);this.ga.Neb(ba.a.o5d,Q.a.view,this.zX);this.ga.Neb(ba.a.p5d,Q.a.view,this.p5d);this.ga.Neb(ba.a.yYd,Q.a.view,this.zX);this.ga.Neb(ba.a.cad,Q.a.view,this.zX);this.Mmd&&(this.ga.fb(ba.a.$Hc,Q.a.view,this.BIn,1028),this.ga.HT(ba.a.wob,Q.a.view,this.zX,1028));this.ga.ra(ba.a.cPh,Q.a.view,z.ActionManager.Of);this.ga.ra(ba.a.GPh,Q.a.view,z.ActionManager.Of);this.eHe&&(this.ga.fb(ba.a.bad,Q.a.view,this.bad,96),this.ga.fb(ba.a.WHb,Q.a.view,
this.WHb,96))}E5(){if(this.Vb){const xa=this.Vb.fe(ea.AppFrame.VD);this.Mmd&&xa.bindAction(v.KeyInputManager.ic(H.a.Gsb,v.KeyInputManager.Rh|4),ba.a.$Hc)}else S.ULS.sendTraceTag(592196489,307,10,"Null focus manager and fail to register clipboard shortcuts.")}Vgo(xa,fa,Ka){switch(fa){case ba.a.CTa:case ba.a.j$:case ba.a.wob:fa=ba.a.Rbe;break;case ba.a.dza:fa=ba.a.T4f;break;default:fa=ba.a.Qbe}Ka[this.mtb]=xa===fa}R9l(){const xa=Object(O.a)(96,this.Bhd)?this.Bhd:null;return xa?xa.ja(R.a.L3c,y.a.nil):
y.a.nil}u6e(xa,fa,Ka,lb){if(1===Ka){if(!Object(O.a)(ha.a,fa)||!this.$hd||za.a.sia(fa)&&za.a.Mcc())return 8;Ka=new N.a(()=>this.NLc(this.oy.J(ba.a.P_),lb));const Xa=this.$hd.create(Ka,Object(W.a)(96,lb));Ka=new sa.a(x.AFrameworkApplication.K,F.a.instance,Ka,G.a.instance,Xa,this.sVb);return ua.a.EBh(fa,Ka)?32:8}if(2===Ka){if(this.oso(Z.App.o_a))return this.f0a(xa);Z.App.ijc(()=>{this.f0a(xa)});return 32}return 2}f0a(xa){if(!this.Ce)return S.ULS.sendTraceTag(592454657,307,10,"No _editingDomManager"),
8;var fa=this.Ce.Zib();if(!fa)return S.ULS.sendTraceTag(592454658,307,10,"No ownerDocument"),8;fa=fa.$n;if(!fa)return S.ULS.sendTraceTag(592454659,307,10,"No document"),8;S.ULS.sendTraceTag(592454660,307,50,"Calling execCommand. Command: {0}",xa);this.rg.logKpiUsage({kpiName:Da.a.sOa});this.fg.jvl(xa);xa=M.a.GEb(fa,"paste");fa=this.fg.Bol();S.ULS.sendTraceTag(573388233,307,50,"PasteEventHandled: {0}",fa);if(xa)return S.ULS.sendTraceTag(592454661,307,50,"execCommand succeeded"),this.rg.logKpiSuccess({kpiName:Da.a.sOa}),
32;this.Tom();S.ULS.sendTraceTag(592454662,307,10,"execCommand failed");this.rg.logKpiFailure({kpiName:Da.a.sOa,errorName:"ExecCommandFailed"});return 8}Tom(){this.bVa&&(this.bVa.iRb(),Da.a.j3d(!0,ka.a.instance,K.a.qG));if(this.telemetry){const xa=this.telemetry.Qad();xa.m3b("CallExecCommandPasteOperation");xa.fail("call to execCommand('paste') failed",!0);this.telemetry.nha(xa)}}oso(xa){let fa=!1;this.Vb?this.Vb.currentScope?fa=!this.Vb.HEf(this.Vb.currentScope.name):S.ULS.sendTraceTag(573388235,
307,10,"No CurrentScope"):S.ULS.sendTraceTag(573388234,307,10,"No _focusManager");if(fa){S.ULS.sendTraceTag(573388236,307,50,"CurrentScope: {0}",this.Vb.currentScope.name);if(1>xa)return S.ULS.sendTraceTag(573388237,307,10,"Action callbacks will not execute"),!0;this.Vb.$lf();return!1}return!0}NLc(xa,fa){return xa&256?new Fa(this.RGo):xa&2?xa&4096?new Ga(fa,this.Ad,this.lk,Z.App.instance.RWc,Z.App.instance.EUa):new ia(fa,this.Ad,Z.App.instance.EUa):fa.hasProperty(R.a.tNb)?new va(fa,this.Ad,this.lk,
this.QEc,Z.App.instance.EUa):new Ga(fa,this.Ad,this.lk,Z.App.instance.RWc,Z.App.instance.EUa)}static get SBn(){return L.a.oUd("Box4PasteScratchPad")}DBh(xa,fa,Ka,lb){return!x.AFrameworkApplication.cZ&&!x.AFrameworkApplication.EF||x.AFrameworkApplication.uEb?(xa=this.zX(null,xa?ba.a.cut:ba.a.copy,fa,1,Ka,lb))?xa.response:8:8}}Object(D.a)(Oa,"ClipboardActor",null,[])},1807:function(D,I,c){c.r(I);D=c(0);var l=c(19),e=c(2063),a=c(1847);class k extends a.a{constructor(){super();this.isCurrentUser=!1}}
Object(D.a)(k,"IsMeAtMentionOptionalAttributes",a.a,[]);var x=c(2064),y=c(1637),m=c(8),t=c(74),z=c(16),v=c(7),H=c(1697);c.d(I,"ACommentFormatTranslator",function(){return F});class F{constructor(G){this.Sg=G}bEk(G,M){const K=m.ParagraphReader.text(M);let L=null,R=null,S=null,N=0;var O=0,W=!1;let V="";for(M.qa||K&&K.length&&"\n"!==K||v.ULS.sendTraceTag(50870150,327,10,"paragraph chps are null and paragraph text is null or empty");N<M.qa.length;){const Y=M.qa.J(N),ba=Y.cp;var Q=Y.formatting?Y.formatting.Jn:
null;V+=l.a.substring(K,W?O+1:O,ba);Y.Cm&&L&&(O=new e.a,O.fullName=V.startsWith("@")?V.substr(1):V,H.a(L,O),W=new k,H.c(L,W,O),G.bCf(V,O,W,!0),V="",L=null);Y.Cm&&R&&(O=S||new x.a,O.link=R.url,G.Ssi(V,O),V="",R=null);L&&R||""===V||(this.Sg.uBb&&S?(G.zCf(V,S),S=null):G.Xca(V),V="");Y.hyperlink&&(Y.hyperlink.mw?L=Y.hyperlink:Y.hyperlink.url&&(R=Y.hyperlink));this.Sg.uBb&&Q&&(S=new x.a,S.weight=Q.ja(z.a.bold,!1)?y.a.R4d:0,S.italic=Q.ja(z.a.italic,!1),S.underline=Q.ja(z.a.underline,!1),S.strikethrough=
Q.ja(z.a.strikethrough,!1),Q.hasProperty(z.a.highlight)&&(O=Q.getValue(z.a.highlight),S.highlight=t.a.eF(O)),Q.hasProperty(z.a.fontColor)&&(Q=Q.getValue(z.a.fontColor),S.color=t.a.eF(Q)));O=ba;W=!!Y.blob;N++}}}F.cIk="_@_";F.dIk="Z";Object(D.a)(F,"ACommentFormatTranslator",null,[429])},1808:function(D,I,c){D=c(0);var l=c(155),e=c(19),a=c(28),k=c(22),x=c(2),y=c(164),m=c(163);class t{static get Vg(){return l.a.Kx(t.Xm,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsFont,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsIndent)}}
t.Xm="<div class='FootnoteEndnoteDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='FontPlaceholder'></div> </div> <div class='FootnoteEndnoteDialogIndentTitle UIFontBold' id='IndentTitle'> <label id='IndentTitleLabel' class='WACDialogLabel' for='IndentControl' >{1}</label> </div> <div class='normal' id='IndentControl'> <div id='IndentPlaceholderStyles' class='FootnoteEndnoteDialogIndentPlaceholder'></div> </div>";
Object(D.a)(t,"FootnoteEndnoteFormattingOptionsDialogHtml",null,[]);var z=c(15),v=c(3);c.d(I,"a",function(){return H});class H extends l.a{constructor(F,G,M){super();this.eYg=!1;this.sW=null;this.tIl=K=>{switch(K){case 1:this.ga.processAction(z.a.t2h,2);break;case 2:this.ga.processAction(z.a.u2h,2);break;case 0:this.ga.processAction(z.a.v2h,2)}};this.Gu=G;this.XS=!1;this.oXb=H.YHl;this.Nh=F;this.ga=M;this.yg="FootnoteEndnoteFormattingOptionsDialog";this.Cd=2;this.Vg=t.Vg;this.ze(1,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyButton);
this.ze(2,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyAllButton);this.Uh(WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogTitle,this.tIl,null);this.Wjb=!1;document.getElementById("FontStyleComboBox").focus()}get fontName(){return this.sW}set fontName(F){this.sW=F;if(F=document.getElementById("FontSizeComboBox"))F.focus(),this.Nh.updateCommandUI()}get fontSize(){return this.oXb}get Wjb(){return this.eYg}set Wjb(F){this.eYg=F;this.WDn()}V9(){this.FEd("FontStyleComboBox",
"FontPlaceholder",z.a.sPd.toString(),z.a.T5i.toString(),z.a.c4c.toString(),WoncaIntl.WoncaStrings.L_FontName,"100px");this.FEd("FontSizeComboBox","FontPlaceholder",z.a.tPd.toString(),v.a.c5c.toString(),z.a.d4c.toString(),WoncaIntl.WoncaStrings.L_FontSize,"32px");const F=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',
e.a.rY(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),""),G=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',e.a.rY(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),"&nbsp;&nbsp;&nbsp;&nbsp;");this.HHc("NoStyle","IndentPlaceholderStyles",
z.a.x2h.toString(),z.a.U5i.toString(),F,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesNoIndentButtonTitle,"Size110by75");this.HHc("FirstLineIndent","IndentPlaceholderStyles",z.a.w2h.toString(),z.a.z4f.toString(),G,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesFirstLineIndentButtonTitle,"Size110by75")}FEd(F,G,M,K,L,R,S){M=y.c(F,M,!0,!0,K,L,e.a.zf(R),!0,S);this.kJd(F,G,M,"Medium")}HHc(F,G,M,K,L,R,S){M=y.f(F,M,K,e.a.zf(L),e.a.zf(R),S);this.kJd(F,G,M,"Large",R)}kJd(F,G,M,K,L=null){G=document.getElementById(G);
this.Gu.t_a(F,M);M=this.Gu.ZFb(F,K);L&&a.a.hDd(M,String.format("{0}Label",F),L);G.appendChild(M);this.Gu.Pqa(F)}WDn(){this.Gu.Pqa("NoStyle");this.Gu.Pqa("FirstLineIndent")}dispose(){this.XS||(this.Gu.gZ("FontStyleComboBox"),this.Gu.gZ("FontSizeComboBox"),this.Gu.gZ("NoStyle"),this.Gu.gZ("FirstLineIndent"),this.XS=!0);this.Nh.updateCommandUI();super.dispose()}static get mVa(){return k.a.instance.resolve("Common.IStandaloneRootController").pea}static yZl(){return new H(m.App.nn,H.mVa,x.AFrameworkApplication.va)}static xZl(){return H.yZl()}}
H.YHl=-1;Object(D.a)(H,"FootnoteEndnoteFormattingOptionsDialog",l.a,[])},1836:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e,a){this.ki=this.Jqd=0;this.BXg=a;this.Ylk=e}dnb(){return this.Jqd-this.ki>=this.Ylk}reset(){this.ki=this.Jqd=this.BXg()}update(){this.Jqd=this.BXg()}}Object(D.a)(l,"TimeBasedTaskYieldStrategy",null,[458])},1847:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.contentId=""}}Object(D.a)(l,"AtMentionOptionalAttributes",
null,[])},1874:function(D,I){Object.defineProperty(I,"__esModule",{value:!0});I.ObjectSchemaType=I.ObjectSemantic=I.SequenceType=I.IntentIds=void 0;(function(c){c.Logging="Logging";c.ZeroTermMenu="ZeroTermMenu";c.Floatie="Floatie"})(I.IntentIds||(I.IntentIds={}));(function(c){c.CommandId="CommandId";c.ControlId="ControlId"})(I.SequenceType||(I.SequenceType={}));(function(c){c.CommandIdHistory="CommandIdHistory";c.ControlIdHistory="ControlIdHistory";c.FilteredCommandIdHistory="FilteredCommandIdHistory";
c.CanvasContext="CanvasContext";c.ApplicationContext="ApplicationContext";c.UserContext="UserContext";c.GenericSuggestions="GenericSuggestions"})(I.ObjectSemantic||(I.ObjectSemantic={}));(function(c){c.CommandExecutionSequence="CommandExecutionSequence";c.WordCanvasContext="WordCanvasContext";c.ApplicationContext="ApplicationContext";c.UserContext="UserContext";c.RankedSuggestion="RankedSuggestion"})(I.ObjectSchemaType||(I.ObjectSchemaType={}))},1875:function(D,I,c){Object.defineProperty(I,"__esModule",
{value:!0});I.SearchSuggestionAnnotation=I.SearchSuggestionSignal=void 0;const l=c(196);class e{constructor(k){l.SchemaObject.assign(e,this,k)}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[e.getTypeName()])}}I.SearchSuggestionSignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=
k}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}I.SearchSuggestionAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1883:function(D,I,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var m=Object.getOwnPropertyDescriptor(k,x);if(!m||("get"in m?!k.hz:m.writable||m.configurable))m={enumerable:!0,
get:function(){return k[x]}};Object.defineProperty(a,y,m)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(I,"__esModule",{value:!0});e(c(1884),I);e(c(1885),I);e(c(1886),I);e(c(1887),I)},1884:function(D,I){Object.defineProperty(I,"__esModule",{value:!0})},1885:function(D,I){Object.defineProperty(I,"__esModule",{value:!0})},1886:function(D,I,c){Object.defineProperty(I,
"__esModule",{value:!0});I.ContractEntityAnnotation=void 0;const l=c(196);class e{constructor(a){l.SchemaObject.assign(e,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntityAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])}}I.ContractEntityAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},
1887:function(D,I,c){Object.defineProperty(I,"__esModule",{value:!0});I.ContractEntitySignal=void 0;const l=c(196);class e{constructor(a){l.SchemaObject.assign(e,this,a)}static getTypeName(){return"AugLoop_ContractsIntelligence_ContractEntitySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])}}I.ContractEntitySignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1889:function(D,I,c){c.r(I);c.d(I,"ReactOICErrorDialogWithTrial",
function(){return k});D=c(0);var l=c(54);I=c(1729);var e=c(464),a=c(155);class k extends I.a{constructor(x,y,m,t,z,v){super(x,y,m,t,z,v);y={["errorMessage"]:this.pYh,["offerString"]:this.aTi};x=new a.a(!1,!1,!0);this.usj?(x.Cd=1,y.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.$jb,["onExecute"]:()=>{e.Redirect.showHelp(this.Foi)}}):(x.Cd=4,x.ze(2,this.Tpi));x.ze(1,this.bBd);x.yg=this.id;y={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:y};x.Uh(this.dialogTitle,Object(l.a)(this,
this.SPn,"reactOICErrorDialogWithTrialHandler"),y)}}Object(D.a)(k,"ReactOICErrorDialogWithTrial",I.a,[])},1890:function(D,I,c){c.r(I);c.d(I,"OICErrorDialogWithTrial",function(){return a});D=c(0);var l=c(54);I=c(1729);var e=c(181);class a extends I.a{constructor(k,x,y,m,t,z){super(k,x,y,m,t,z);k=document.createElement("span");k.innerText=this.pYh;k.appendChild(document.createElement("br"));k.appendChild(document.createElement("br"));x=document.createElement("span");x.innerText=this.aTi;k.appendChild(x);
x=new e.StandardDialog;this.usj?(x.Cd=1,x.VZe(this.$jb,this.Foi)):(x.Cd=4,x.ze(2,this.Tpi));x.ze(1,this.bBd);x.yg=this.id;x.rv(this.dialogTitle,null,this.icon,Object(l.a)(this,this.P0m,"legacyOICErrorDialogWithTrialHandler"),k)}}Object(D.a)(a,"OICErrorDialogWithTrial",I.a,[])},1892:function(D,I,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);Object.defineProperty(a,y,{enumerable:!0,get:function(){return k[x]}})}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||
function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(I,"__esModule",{value:!0});e(c(1893),I);e(c(1894),I)},1893:function(D,I){Object.defineProperty(I,"__esModule",{value:!0})},1894:function(D,I,c){Object.defineProperty(I,"__esModule",{value:!0});I.SearchProviderAnnotation=I.SearchProviderSignal=void 0;const l=c(196);class e{constructor(k){l.SchemaObject.assign(e,this,k)}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,
[e.getTypeName()])}}I.SearchProviderSignal=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}I.SearchProviderAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1983:function(D,
I,c){function l(la){Type.registerNamespace("WordEditor.Comments");Type.registerNamespace("WordEditor.CommentsInteractive");Type.registerNamespace("Common.App.OAuth");la?L.rXn():L.main();ri.main(la);nh.main(la);z.a.instance.Gc(new dn,0,la);z.a.instance.Gc(new kk,0,la);jk(la);Ok(la)}var e=c(0),a=c(7),k=c(1620),x=c(1632),y=c(2),m=c(86),t=c(466),z=c(185),v=c(34),H=c(39),F=c(20),G=c(85),M=c(22),K=c(117);class L{get name(){return"Common.App.OAuth.OAuthPackage"}wc(la){la.register(267,"Common.App.OAuth.IOAuthManager").ha().Ud(()=>
new k.OAuthManager)}init(){const la=M.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.JQo(la)}JQo(la){const cb=y.AFrameworkApplication.K.kb("FileSource");if(y.AFrameworkApplication.K.$("IsO365ConsumerHost")||y.AFrameworkApplication.K.$("IsO365CommercialHost")||"WopiTest"===cb){var vb=t.OAuthManagerSettings.jKc;if(vb&&vb.IsEnabled){var ec=vb.Application,xc=t.OAuthManagerSettings.authority;if(void 0!==ec&&null!==ec&&ec.length&&void 0!==xc&&null!==xc&&xc.length){var ad=x.a[la.laa],Zd=F.a.qG,
pe=la.iL();try{var Td=new Map;void 0!==Td&&null!==Td?(Td.set("SupportStatus",ad),Td.set("Browser",Zd),Td.set("AuthStrategy",pe)):Td=null}catch(We){Td=null}m.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",Td);var Ie=H.a.$e();la.OV("Core",ec).then(We=>{const Vf=Math.floor(H.a.$e()-Ie);ad=x.a[la.laa];Zd=F.a.qG;pe=la.iL();a.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
Vf,We.IsSuccess,ad,We.ErrorCode,cb,Zd,pe);Td&&(Td.set("SupportStatus",ad),Td.set("Browser",Zd),Td.set("AuthStrategy",pe));var tf=Object.assign(new K.a,{durationMs:Vf,extendedProperties:Td});if(We.IsSuccess){if(m.Health.instance.recordKpiSuccess("WacCorePFT",tf),We="Bearer "+We.Token,y.AFrameworkApplication.He.Ged=We,tf=vb.Endpoint){var yf=H.a.$e();y.AFrameworkApplication.He.C2b(tf,1,null,{["Authorization"]:We},"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(lf=>{var Rk=Math.floor(H.a.$e()-
yf),hm=null;lf.Io?lf="Canceled":lf.Gi?lf="Faulted":(hm=lf.result,lf=hm.succeeded?"Completed":"Failed");Rk={["TaskResult"]:lf,["BrowserTokenDurationMS"]:Vf,["BrowserValidationDurationMS"]:Rk};hm&&(Rk.HttpStatus=hm.args.data.Se,hm.succeeded&&(hm=v.a(hm.args.data.se),Rk.ServerValidationDurationMS=hm.ElapsedMilliseconds,Rk.ServerValidationResult=hm.ValidatedToken,Rk.KMSI=hm.KMSI,Rk.Scopes=hm.Scopes,Rk.TokenExpirationS=Math.floor(parseInt(hm.Expiration)-(new Date).getTime()/1E3)));a.ULS.sendTraceTag(520632322,
3E3,"Completed"===lf?50:15,G.a.toJSON(Rk))})}}else m.Health.instance.recordKpiFailure("WacCorePFT",We.ErrorCode,!1,!1,tf)}).catch(We=>{var Vf=Math.floor(H.a.$e()-Ie);Vf=Object.assign(new K.a,{durationMs:Vf,extendedProperties:Td});m.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+We.toString(),!1,!1,Vf)})}}}}dispose(){}static main(){z.a.instance.Gc(new L)}static rXn(){z.a.instance.Gc(new L,0,!0)}}Object(e.a)(L,"OAuthPackage",null,[1,2]);var R=c(375),S=c(367),N=c(19);class O{constructor(){this.twd=
new S.a}vQo(la,cb){if(!la)return a.ULS.sendTraceTag(40478031,306,10,"SDX AssetId is null."),!1;la=N.a.eh(la);if(this.twd.nb(la))return a.ULS.sendTraceTag(40478032,306,10,"ISdxPaneSuppressionHandler already registered for SDX AssetId: {0}.",la),!1;this.twd.Z(la,cb);return!0}J8l(la){if(!la)return a.ULS.sendTraceTag(40478033,306,10,"SDX AssetId is null."),null;la=N.a.eh(la);return this.twd.nb(la)?this.twd.J(la):(a.ULS.sendTraceTag(40478034,306,10,"ISdxPaneSuppressionHandler does not exist for SDX AssetId: {0}.",
la),null)}}Object(e.a)(O,"SdxPaneSuppressionManager",null,[]);var W=c(249),V=c(257),Q=c(10);class Y{constructor(la){this.MLe=0;this.ick=la}dnb(){return this.MLe>=this.ick}reset(){this.MLe=0}update(){this.MLe++}}Object(e.a)(Y,"NodeCountBasedTaskYieldStrategy",null,[458]);var ba=c(1836);class Z{constructor(){this.k9c=new Set}Xob(la){this.k9c.add(la)}PSo(la){this.k9c.delete(la)}mun(){return()=>{this.k9c.forEach(la=>{la.onSessionClose()})}}nun(){return()=>{this.k9c.forEach(la=>{la.onSessionConnect()})}}oun(){return()=>
{this.k9c.forEach(la=>{la.onSessionDisconnect()})}}}Object(e.a)(Z,"AlSessionLifeEventNotifier",null,[338]);var ea=c(1414),ha=c(81),ka=c(93),ua=c(60),sa=c(6),Da=c(1531),Pa=c(156),Ra=c(335),Ga=c(1053),ta=c(709),va=c(242),ia=c(410),qa=c(678),pa=c(418),Fa=c(405);class za{constructor(){this.token=null}}Object(e.a)(za,"ReleaseAnnotationParameters",null,[]);class Oa{constructor(){this.value=this.id=this.parentPath=null}}Object(e.a)(Oa,"SetAnnotationMetadataParameters",null,[]);class xa{constructor(){this.id=
this.parentPath=null;this.value=0}}Object(e.a)(xa,"SetAnnotationStateParameters",null,[]);var fa=c(596),Ka=c(359),lb=c(75),Xa=c(83),kb=c(599),Bb=c(1229),Ja=c(307),Ma=c(759),fb=c(8),hc=c(400);class cc extends Sys.EventArgs{constructor(la,cb){super();this.annotation=la;this.$eb=cb}}Object(e.a)(cc,"AnnotationLocalStateChangedEventArgs",Sys.EventArgs,[]);var mb=c(1021);class Hb{constructor(la){this.N1e=this.annotations=null;if(!la)a.ULS.sendTraceTag(41418884,389,10,"Null operation received!"),this.annotations=
null;else if(la.items&&0<la.items.length){const cb=Hb.DTd(la.parentPath);this.annotations=Array(la.items.length);let vb=0;for(const ec of la.items){const xc=Object.assign(new mb.a,{id:ec.id,parentPath:cb,content:ec.body,annotationType:va.a.getTypeNameFor(ec.body),parentRevId:la.parentRevId});this.annotations[vb++]=xc}this.N1e=va.a.getTypeNameFor(la)}}static DTd(la){return la?la.join("\\"):""}}Object(e.a)(Hb,"AnnotationOperation",null,[]);class Ua extends Sys.EventArgs{constructor(la){super();this.annotationType=
la}}Object(e.a)(Ua,"AnnotationActivationEventArgs",Sys.EventArgs,[]);class Ya extends Sys.EventArgs{constructor(la,cb){super();this.annotation=la;this.opType=cb}}Object(e.a)(Ya,"AnnotationOperationEventArgs",Sys.EventArgs,[]);class Fb{constructor(){this.newState=this.oldState=0;this.handlers=new lb.a}}Object(e.a)(Fb,"AnnotationResultStateUpdateData",null,[]);var Wa=c(612),yb=c(1015);class Yb{constructor(){this.K1e=this.RCk=this.L1e=null}}Object(e.a)(Yb,"AnnotationCallbacks",null,[]);class qc{constructor(la,
cb,vb,ec,xc,ad){this.X1b=null;this.VAc=new S.a(0);this.kFc=new S.a;this.Pgd=new S.a;this.Xtd=new Wa.a;this.bYf=null;this.ti=la;this.eMa=cb;this.$F=vb;this.rC=ec;this.OI=xc;this.rd=ad}q4o(la,cb,vb,ec){this.rC.bcc(la)&&this.ti.ie(()=>{if(!this.X1b){this.X1b=new S.a;var xc=fb.ParagraphReader.xw(hc.a.getRootNode(),!0,!0);for(const ad of xc)ad&&(xc=ad.ja(sa.a.Wc,0))&&(this.X1b.add(xc,ad.id),this.VAc.Z(ad.id.toString(),xc))}this.eMa.aYf(la,(ad,Zd)=>{if(ad){var pe=this.rC.lci(la);ad.contentDescriptor.Sv===
pe&&((pe=this.XZl(ad))?ad.Zeb?(pe=this.Jaf(ad,pe))&&(Zd?vb(Zd,ad.contentDescriptor):cb(pe,ad.contentDescriptor)):ec(ad.contentDescriptor):this.Njl(ad,Object.assign(new Yb,{L1e:cb,RCk:vb,K1e:ec})))}})},"PAS:FEPAOT")}XZl(la){if(3===la.contentDescriptor.Sv){let cb;return({value:cb}=this.X1b.Fc(la.contentDescriptor.paragraphId)).returnValue?cb:null}if(4===la.contentDescriptor.Sv)return ua.a.nil;a.ULS.sendTraceTag(592525442,qc.Ii,15,"GetGraphNodeIdForAnnotationIfConnected: Unsupported content type");return null}RNm(la,
cb){if(3===la.contentDescriptor.Sv)return cb=this.OI.value.Eb(cb).getValue(sa.a.tj),la.contentDescriptor.tj===cb;if(4===la.contentDescriptor.Sv&&cb===ua.a.nil)return!0;a.ULS.sendTraceTag(592525443,qc.Ii,15,"IsGraphNodeValidForAnnotation: Unsupported content type");return!1}Njl(la,cb){if(3===la.contentDescriptor.Sv){const vb=la.contentDescriptor.paragraphId;this.kFc.nb(vb)||this.kFc.add(vb,new lb.a);this.kFc.J(vb).add(ec=>{12===ec.type&&this.X1b.add(vb,ec.id);la.Zeb?(ec=this.Jaf(la,ec.id))&&cb.L1e(ec,
la.contentDescriptor):cb.K1e(la.contentDescriptor)})}else if(4===la.contentDescriptor.Sv)if(la.Zeb){const vb=this.Jaf(la,ua.a.nil);vb&&cb.L1e(vb,la.contentDescriptor)}else cb.K1e(la.contentDescriptor);else a.ULS.sendTraceTag(592525444,qc.Ii,15,"DelayCallbackForAnnotation: Unsupported content type")}Jaf(la,cb){if(this.RNm(la,cb)){if(cb=this.rC.Ghn(la.Zeb,la.contentDescriptor,cb.toString()))return this.Pgd.Z(cb.id,la.e7a),cb}else this.rd.isFeatureEnabled(89)&&this.$F.RFc(la);return null}tHj(la,cb){const vb=
this.rC.bRd(la);vb&&(cb===Ga.a.getTypeName()?this.$Oo(la,vb):this.LOo(la,vb))}$Oo(la,cb){this.rC.bcc(la.annotationType)&&(this.$F.KTa(this.OI.value,cb,la.annotationType),this.Pgd.remove(la.id))}LOo(la,cb){if(this.rC.bcc(la.annotationType)){cb=Object.assign(new yb.a,{Zeb:this.rC.VCk(la),contentDescriptor:cb,annotationType:la.annotationType});cb=this.$F.addAnnotation(this.OI.value,cb);this.Pgd.Z(la.id,cb);const vb=this.rC.Jki(la.annotationType);vb&&this.Xtd.contains(vb)&&(this.ti.ie(()=>{var ec=fb.ParagraphReader.xw(hc.a.getRootNode(),
!0,!0);if(ec&&0<ec.count){const xc=new lb.a;for(const ad of ec)(ec=qc.ATd(ad))&&xc.add(ec);0<xc.count&&this.$F.uph(this.OI.value,vb,xc.toArray())}},"PAS:TAOCPA"),this.Xtd.remove(vb))}}Pnb(la){if(this.X1b)if(la){var cb=la.ja(sa.a.Wc,0);if(cb&&(this.VAc.Z(la.id.toString(),cb),({value:cb}=this.kFc.Fc(cb)).returnValue))for(const vb of cb)vb(la)}else a.ULS.sendTraceTag(592525445,qc.Ii,10,"OnParagraphNodeConnected: Invalid node")}dXi(la,cb){if(la){var vb=la.id.toString();la=la.ja(sa.a.Wc,0);var ec=0;({value:ec}=
this.VAc.Fc(vb)).returnValue&&(3===cb?(this.kFc.remove(ec),this.VAc.remove(vb)):2===cb?this.VAc.Z(vb,la):a.ULS.sendTraceTag(592525447,qc.Ii,15,"OnParagraphNodeModified: Updating persisted annotation not supported for event"))}else a.ULS.sendTraceTag(592525446,qc.Ii,10,"UpdatePersistedAnnotations: Invalid node")}Cbm(la){let cb;return({value:cb}=this.Pgd.Fc(la)).returnValue?cb:ua.a.nil}a0o(la,cb,vb){la?cb?this.eMa.Oei(la,ec=>{if(ec){const Zd=qc.ATd(cb,vb);if(Zd){var xc=Array(ec.length),ad=!1;for(let pe=
0;pe<ec.length;pe++)if(ad||Zd!==ec[pe])xc[pe]=ec[pe];else{const Td=qc.ATd(cb);if(!Td)return;ad=!0;xc[pe]=Td;ec[pe]=Td}ad&&this.$F.uph(this.OI.value,la,xc)}}}):a.ULS.sendTraceTag(588863697,qc.Ii,10,"UpdateWorkflowParagraphVersion: Invalid node"):a.ULS.sendTraceTag(588863696,qc.Ii,10,"UpdateWorkflowParagraphVersion: null workflowType")}kmo(la){la?this.Xtd.add(la):a.ULS.sendTraceTag(588863698,qc.Ii,10,"SetPendingWorkflow: null workflowType")}fZk(la){la?this.Xtd.remove(la):a.ULS.sendTraceTag(588105731,
qc.Ii,10,"ClearPendingWorkflow: null workflowType")}static ATd(la,cb=0){if(!la)return null;cb||(cb=la.ja(sa.a.tj,0));la=fb.ParagraphReader.tR(la);if(cb&&la)return String.format("{0}{1}{2}",la,qc.AAn,cb);a.ULS.sendTraceTag(588091606,qc.Ii,10,"GetParagraphVersion: Node with text id {0} and paragraph id {1}",cb?"valid":"0",la?"valid":"0");return null}}qc.Ii=389;qc.AAn="-";Object(e.a)(qc,"PersistedAnnotationStorage",null,[456]);class Hc{constructor(){this.config=this.token=null}}Object(e.a)(Hc,"UpdateAnnotationConfigParameters",
null,[]);var $b=c(123),Ub=c(1205),mc=c(339),ic=c(1425),ab=c(870),bb=c(206),Jb=c(1111);class Eb{constructor(la,cb,vb,ec,xc,ad,Zd,pe,Td,Ie,We,Vf=null,tf){this.zdb=tf;this.sa=new ha.a;this.JAa=new Xa.a;this.B6=new Xa.a;this.uD=new Xa.a;this.Kte=new Xa.a;this.Stc=new fa.a(Ka.a.ih());this.mNe=new lb.a;this.EUb=new Xa.a;this.Gte=new Xa.a;this.Rgd=new Xa.a;this.FUb=new Xa.a;this.Yqc=new Xa.a;this.Sgd=new Xa.a;this.ijd=new Xa.a;this.gsd=[];this.hsd=[];this.dzc=null;this.jck=new fa.a(Ka.a.ih());this.Ite=new Map;
this.Ptc=new Map;this.msc=null;this.Xka=new Xa.a;this.gLc=null;this.Oah=this.S_g=0;this.tZa=null;this.Ygl=()=>{if(this.gsd.length||this.hsd.length)try{0<this.gsd.length&&this.dan(),0<this.hsd.length&&this.jSo()}finally{this.sZk()}else this.Ib.ff(this.dzc),this.dzc=null};this.oZk=()=>{const yf=new lb.a;for(const lf of this.uD.values)if(yf.add(lf),yf.count===Eb.tck)break;for(const lf of yf)this.h1a(lf),this.YPb(lf,Ga.a.getTypeName());this.uD.count||(this.Ib.ff(this.msc),this.msc=null)};this.h2c=(yf,
lf)=>{for(const Rk of lf.Qj)yf=Rk.intent,!yf.type&&this.Tro(yf.intent,Rk.cpBegin,Rk.cpEnd,Rk.PKb)&&this.h1a(yf.intent)};this.W7j=la.$("AugLoopAnnotationsAttachingIsEnabled");this.Lik=la.DB("SendReleaseMessageAnnotationList")||[];this.rd=Ie;this.tKa=Vf;this.eMa=ad;this.$F=Zd;this.Un=vb;this.rC=pe;this.bba=Td;this.OI=ec;this.ti=cb;this.Ib=xc;M.a.instance.resolve("Box4.ICharacterPropertiesEditor").m0e(this.h2c);this.Zr=We;this.XVj=la.getBooleanFeatureGate("Microsoft.Office.WordOnline.AnnotationProcessingStateIsEnabled",
!1);this.L7j=la.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1);this.y9j=la.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContext",!1);this.Z1g=la.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldSkipAnnotationForInvalidContextLogs",!1);this.zdb&&this.eqm();this.pz=bb.a.instance}get o$i(){return this.FUb}set o$i(la){this.FUb=la}ob(la,cb){a.ULS.sendTraceTag(41521862,Eb.Ii,50,"New registration for annotation type: {0}.",cb);this.addHandler(la,
cb);this.eZe(cb).catch(vb=>{a.ULS.sendTraceTag(594396739,Eb.Ii,10,"Failed to activate annotation type {0}: {1}",cb,vb.toString())})}addHandler(la,cb){if(la&&cb&&""!==cb){var vb=null;({value:vb}=this.FUb.Fc(cb,vb)).returnValue?vb.add(la):(vb=new lb.a,vb.add(la),this.FUb.add(cb,vb))}else a.ULS.sendTraceTag(41521861,Eb.Ii,10,"Invalid registration. Handler == null? {0} or annotationType == null? {1} or annotationType == empty? {2}.",!la,!cb,""===cb)}sc(la,cb){a.ULS.sendTraceTag(41521863,Eb.Ii,50,"Unregister handler for annotation type: {0}.",
cb);let vb=null;({value:vb}=this.FUb.Fc(cb,vb)).returnValue&&(vb.remove(la),vb.count||(a.ULS.sendTraceTag(41521864,Eb.Ii,50,"Unregister all handlers for annotation type: {0}.",cb),this.FUb.remove(cb),this.bln(cb)))}Qnj(la){this.gLc||(this.gLc=this.Zr.Pc(2),this.gLc.Db(la))}sZk(){var la;null===(la=this.gLc)||void 0===la?void 0:la.dispose();this.gLc=null}DLh(){this.dzc||(this.dzc=new ka.a(4,2,100,this.Ygl,141),this.Ib.Wb(this.dzc))}dan(){let la;la=Array.dequeue(this.gsd);const cb=hc.a.HGb(this.OI.value,
la);if(cb)if(cb.xj){this.Qnj(cb);var vb=null;if(({value:vb}=this.Yqc.Fc(la,vb)).returnValue){this.Yqc.remove(la);for(const ec of vb)this.ean(cb,ec)}else a.ULS.sendTraceTag(50663568,Eb.Ii,100,"MarkIntentForAnnotationTask: No annotations for given tile id.")}else this.jck.add(la);else a.ULS.sendTraceTag(50436127,Eb.Ii,15,"MarkIntentForAnnotationTask: Unable to get node from tileId.")}ean(la,cb){var vb=cb.content.range;vb=new Bb.a(0,vb.start,vb.start+vb.length,ua.a.create(),cb,ec=>{this.Kte.Z(cb.id,
ec.toString())});this.Un.fHa(la,vb);this.sa.j9&&this.sa.raiseEvent(Eb.Dgc,new Ya(cb,Ra.a.getTypeName()))}DNi(la){const cb=hc.a.e3a(la.parentPath);let vb=null;({value:vb}=this.Yqc.Fc(cb,vb)).returnValue||(vb=new lb.a,this.Yqc.add(cb,vb),this.gsd.push(cb));vb.add(la);this.DLh()}gan(la,cb){this.ti.ie(()=>{let vb;if(({value:vb}=this.B6.Fc(la,vb)).returnValue){var ec=this.crj(la);for(const xc of vb){let ad;({value:ad}=this.uD.Fc(xc,ad)).returnValue&&cb(ad)&&Eb.NIb(ad)&&(this.DNi(ad),ec&&this.sa.raiseEvent(Eb.Dgc,
new Ya(ad,Ga.a.getTypeName())))}}},"AS:MIFAT")}kSo(la,cb){this.ti.ie(()=>{let vb;if(({value:vb}=this.B6.Fc(la,vb)).returnValue)for(const ec of vb){let xc;({value:xc}=this.uD.Fc(ec,xc)).returnValue&&cb(xc)&&Eb.NIb(xc)&&this.Jog(xc)}},"AS:UIFAT")}iln(la){var cb=hc.a.DJ(la);let vb=null;if(({value:vb}=this.JAa.Fc(cb,vb)).returnValue){cb=0;for(var ec=new lb.a;vb.count>cb;){var xc=vb.J(cb),ad=null;({value:ad}=this.uD.Fc(xc,ad)).returnValue&&Eb.NIb(ad)?this.rC.v$c(la,ad)?this.h1a(ad,!this.rd.isFeatureEnabled(89)):
(xc=ad.content.range,ad=new Bb.a(0,xc.start,xc.start+xc.length,ua.a.create(),ad),ec.add(ad),cb++):cb++}0<ec.count&&this.Un.YOf(la,ec)}}jSo(){let la="";la=Array.dequeue(this.hsd);const cb=hc.a.HGb(this.OI.value,la);if(cb&&12===cb.type){this.Qnj(cb);var vb=null;({value:vb}=this.Sgd.Fc(la,vb)).returnValue?(this.Un.ldd(ec=>vb.contains(ec.intent),cb,0),this.Sgd.remove(la)):a.ULS.sendTraceTag(50663570,Eb.Ii,100,"UnmarkIntentForAnnotationsTask: No annotations for given tileId.")}else a.ULS.sendTraceTag(50436128,
Eb.Ii,15,"UnmarkIntentForAnnotationsTask: Unable to unmark ChPs in node")}Jog(la){let cb;({value:cb}=this.Kte.Fc(la.id,cb)).returnValue||(cb=hc.a.e3a(la.parentPath));this.Kte.remove(la.id);var vb=null;({value:vb}=this.Sgd.Fc(cb,vb)).returnValue||(vb=new lb.a,this.Sgd.add(cb,vb),this.hsd.push(cb));vb.add(la);this.DLh();vb=null;({value:vb}=this.Yqc.Fc(cb,vb)).returnValue&&vb.remove(la)}Ntk(la){const cb=la.id;var vb=la.annotationType;const ec=la.parentPath;if(this.rC.vlb(la)){var xc=hc.a.ljb(this.OI.value,
ec);if(xc&&(xc=xc.ja(sa.a.tj,0).toString(),la.parentRevId&&xc!==la.parentRevId))return!1}xc=null;({value:xc}=this.B6.Fc(vb,xc)).returnValue||(xc=new lb.a,this.B6.add(vb,xc));xc.add(cb);vb=null;({value:vb}=this.JAa.Fc(ec,vb)).returnValue||(vb=new lb.a,this.JAa.add(ec,vb));vb.add(cb);this.uD.add(cb,la);this.p4o(la);return!0}p4o(la){const cb=this.rC.$4h(la);if(0===cb.length)this.CTh(la);else{let vb=!1;this.eMa.bsn(cb,la.annotationType,(ec,xc)=>{this.uD.nb(la.id)?(xc=this.rC.Mlb(la,hc.a.eOl(la)),!ec&&
xc?this.Rpg(la,10,!1):ec&&this.Rpg(la,ec),vb||(this.CTh(la),vb=!0)):xc.FUa=!0})}}CTh(la){const cb=Eb.NIb(la);cb&&this.DNi(la);!cb&&this.sa.j9&&this.sa.raiseEvent(Eb.Dgc,new Ya(la,Ra.a.getTypeName()))}PEj(la,cb,vb,ec){let xc=!0;this.ti.ie(()=>{if(ec.startsWith(hc.a.dEb)){var ad=la.id,Zd=null;if(cb===Ga.a.getTypeName())this.h1a(la);else if(({value:Zd}=this.uD.Fc(ad,Zd)).returnValue)a.ULS.sendTraceTag(41418891,Eb.Ii,50,"UpdateAnnotationsStorage: Updating storage for annotation {0} of type {1}.",ad,la.annotationType),
this.uD.Z(ad,la);else if(!this.Ntk(la)){xc=!1;return}vb&&cb===Ra.a.getTypeName()&&ec!==hc.a.dEb&&this.mNe.add(la.annotationType)}this.YPb(la,cb)},"AS:UAS");return xc}Aho(la){if(la)for(const cb of la)this.YPb(cb,ta.a.getTypeName()),la=cb.content,this.ijd.nb(la.categoryName)?this.ijd.Z(la.categoryName,cb):this.ijd.add(la.categoryName,cb);else a.ULS.sendTraceTag(592802119,Eb.Ii,10,"SetCritiqueCategoryCountAndSendToHandlers: critiqueCategoryCountAnnotations null")}vxk(la){this.sa.addHandler(Eb.Dgc,la)}Tqh(la){this.sa.addHandler(Eb.OTi,
la)}acc(la){return this.EUb.nb(la)}uxk(la){this.sa.addHandler(Eb.I6d,la)}y1n(la){this.sa.removeHandler(Eb.I6d,la)}crj(la){return!hc.a.af(la)&&Ma.a(la)&&this.sa.j9}h1a(la,cb=!0){if(this.uD.nb(la.id)){var vb=this.uD.J(la.id);this.uD.remove(la.id);var ec=null;({value:ec}=this.JAa.Fc(la.parentPath,ec)).returnValue?(ec.remove(la.id),Eb.NIb(vb)&&this.Jog(vb)):a.ULS.sendTraceTag(50734169,Eb.Ii,15,"DeleteAnnotationFromStorage: No annotations in given parent path");ec=null;({value:ec}=this.B6.Fc(la.annotationType,
ec)).returnValue?ec.remove(la.id):a.ULS.sendTraceTag(50734170,Eb.Ii,15,"DeleteAnnotationFromStorage: Annotation of this type does not exist in document");this.crj(la.annotationType)?this.sa.raiseEvent(Eb.Dgc,new Ya(vb,Ga.a.getTypeName())):this.YPb(la,Ga.a.getTypeName());cb&&this.bba.tHj(vb,Ga.a.getTypeName())}}fof(la,cb,vb=!1){const ec=new lb.a;var xc;if(!({value:xc}=this.B6.Fc(la,xc)).returnValue)return ec;for(const ad of xc)this.uD.nb(ad)?(la=this.uD.J(ad),(xc=this.rC.bRd(la))&&(cb.equals(xc)||
vb&&cb.overlaps(xc))&&ec.add(la)):a.ULS.sendTraceTag(577843217,Eb.Ii,50,"GetAnnotationsByDescription: Annotation {0} exists in a cache but not in storage",ad);return ec}LKd(la){let cb=null;if(({value:cb}=this.B6.Fc(la,cb)).returnValue){la=cb.toArray();for(const vb of la){let ec;({value:ec}=this.uD.Fc(vb,ec)).returnValue&&this.h1a(ec)}}}BKm(la){return va.a.getTypeNameFor(la)===mc.a.getTypeName()}Qwi(la){var cb,vb;return(null===(vb=null===(cb=this.zdb)||void 0===cb?void 0:cb.hci)||void 0===vb?void 0:
vb.call(cb))===Ub.a.Zpc&&la&&0===la.priority?this.zdb.Lbd(la.context.substr(la.startInContext,la.range.length)):!1}a5i(la,cb){this.ti.ie(()=>{a.ULS.R$(Eb.Ii,100)&&a.ULS.sendTraceTag(41418894,Eb.Ii,100,"Operation of type {0} with path {1} received",va.a.getTypeNameFor(la),la.parentPath.join("\\"));try{const vb=new Hb(la);for(const ec of vb.annotations)if(ec.annotationType===ab.FlagResultAnnotation.getTypeName()){const xc=ec.content.results.map(ad=>{var Zd;const pe=null===(Zd=ad.M_)||void 0===Zd?void 0:
Zd.seq;Zd=void 0===pe?ec.id:ec.id+"_"+pe;return{id:Zd,body:{...ad,id:Zd},source:"",revId:"",contextId:"",sourceTimestamp:Date.now()}});this.a5i({items:xc,parentPath:la.parentPath,parentRevId:la.parentRevId,H_:la.H_},cb)}else vb.N1e===Ra.a.getTypeName()&&this.Euo(ec)?(y.AFrameworkApplication.oe("g8469255;j5hhe441"),this.Z1g&&(this.tZa||(this.tZa=Jb.a.uQd()),this.S_g++,this.tZa.$nh("AnnotationSkippedDueToInvalidContextCount",this.S_g.toString()))):this.KSc(ec,cb,vb.N1e,!0)}catch(vb){a.ULS.sendTraceTag(41418898,
Eb.Ii,10,"Exception occurred while processing annotations: Error Message {0}, Stack {1}",vb.message,vb.stack)}},"AS:PO")}Euo(la){var cb;y.AFrameworkApplication.oe("01dfc961;05c12706");if(this.y9j&&Ma.a(la.annotationType)){var vb;let xc=vb=null;if(this.pz){vb=this.pz.w4;var ec=null===vb||void 0===vb?void 0:vb.node;vb=hc.a.e3a(la.parentPath);if(hc.a.HGb(this.OI.value,vb)!==ec)return!1;la=la.content;vb=la.context.substring(la.startInContext,la.startInContext+la.range.length);xc=null===(cb=null===ec||
void 0===ec?void 0:ec.characterData)||void 0===cb?void 0:cb.substring(la.range.start,la.range.start+la.range.length);this.Z1g&&la&&0===la.priority&&(cb=0<la.range.start?ec.characterData.charAt(la.range.start-1):null,ec=la.range.start+la.range.length<ec.characterData.length?ec.characterData.charAt(la.range.start+la.range.length):null,"en-us"==la.language.toLocaleLowerCase()&&xc&&vb&&xc===vb&&(cb&&cb.match("[A-Za-z0-9]")||ec&&ec.match("[A-Za-z0-9]"))&&(this.tZa||(this.tZa=Jb.a.uQd()),this.Oah++,this.tZa.$nh("partialWordAnnotationsCount",
this.Oah.toString())))}return xc&&vb&&xc!==vb?!0:!1}return!1}KSc(la,cb,vb,ec){if(this.BKm(la.content)&&this.Qwi(la.content))this.mAa(la,70);else{var xc=la.parentPath;vb!==Ga.a.getTypeName()&&ec||this.aaj(la);ec&&vb===Ra.a.getTypeName()&&Ma.a(la.annotationType)&&la.content.isHotCritique&&this.L7j?this.Ptc.set(la.id,{annotation:la,time:Date.now()}):(ec=la.annotationType,hc.a.af(ec)||ec!==ia.a.getTypeName()?!hc.a.af(ec)&&Ma.a(ec)&&la.content&&0==la.content.priority&&$b.a.X4?(la=hc.a.e3a(xc))&&la==$b.a.vMl()&&
a.ULS.sendTraceTag(539870169,Eb.Ii,10,"Skipping the Spelling Error Annotation as Text Prediction is visible"):vb!==Ga.a.getTypeName()&&this.Stc.contains(xc)?a.ULS.sendTraceTag(41418897,Eb.Ii,50,"ProcessOperation: Parent tile {0} for annotation {1} was deleted.",xc,la.id):this.NEj(la,xc,vb,cb):a.ULS.sendTraceTag(595342670,Eb.Ii,50,"ProcessOperation: Skipping CritiqueCategoryCountAnnotation for Parent tile {0} since the counts are maintained locally.",xc))}}zZn(la){if(la&&la.annotationType&&this.rC.bcc(la.annotationType)){var cb;
if(({value:cb}=this.B6.Fc(la.annotationType,cb)).returnValue&&(la=this.rC.bRd(la)))for(const vb of cb){let ec;({value:ec}=this.uD.Fc(vb,ec)).returnValue&&(cb=this.rC.bRd(ec))&&(la.equals(cb)||la.overlaps(cb))&&this.h1a(ec)}}}YPb(la,cb){this.ti.ie(()=>{let vb=null;if(({value:vb}=this.o$i.Fc(la.annotationType,vb)).returnValue)for(const ec of vb)ec.KB(la,cb)},"AS:SATH")}nZk(){a.ULS.sendTraceTag(50860999,Eb.Ii,50,"ClearStorage: Initiated Clearing Storage");this.msc||(this.msc=new ka.a(4,2,100,this.oZk,
142),this.Ib.Wb(this.msc))}activateAnnotation(la,cb){let vb;if(({value:vb}=this.Rgd.Fc(la,vb)).returnValue){if(vb.contains(cb))return Promise.resolve(null);vb.add(cb)}else{let ec;this.Rgd.add(la,(ec=new lb.a,ec.add(cb),ec))}return this.eZe(la)}eZe(la){a.ULS.sendTraceTag(41521865,Eb.Ii,50,"ActivateAnnotation: Activating annotation type {0}.",la);if(this.EUb.nb(la))return Promise.resolve(null);var cb=null;if(({value:cb}=this.Gte.Fc(la,cb)).returnValue)return cb;this.Cqk(la);cb=null;this.tKa&&(cb=this.tKa());
if(cb){const vb=new Fa.a;vb.annotationType=la;this.XVj&&(this.Xka.nb(la)||this.Xka.Z(la,new Fb),vb.stateUpdateHandler=(ec,xc)=>{this.Xka.J(la).oldState=ec;this.Xka.J(la).newState=xc;for(const ad of this.Xka.J(la).handlers)ad(la,ec,xc)});cb=cb.activateAnnotation(vb);this.Gte.add(la,cb);return cb.then(ec=>{this.Gte.remove(la);this.EUb.add(la,ec.token);this.OEj(ec.token,la);this.sa.raiseEvent(Eb.I6d,new Ua(la,!0));this.cqm(la);return ec})}return Promise.reject(Error.create("Error during annotation activation"))}cqm(la){const cb=
this.rC.Jki(la);cb&&this.eMa.Oei(cb,vb=>{if(this.bba.bYf){var ec=fb.ParagraphReader.xw(hc.a.getRootNode(),!0,!0);if(ec&&0<ec.count){let xc=0;for(const ad of ec){ec=qc.ATd(ad);if(!ec)continue;let Zd=!1;for(;xc<vb.length;){if(ec===vb[xc]){Zd=!0;break}xc++}if(!Zd){this.bba.bYf(cb);break}xc++}}}})}Cqk(la){this.bba.q4o(la,(cb,vb)=>{0<this.fof(la,vb,!0).count||this.PEj(cb,Ra.a.getTypeName(),!0,cb.parentPath)},(cb,vb)=>{if(3!==vb.Sv)a.ULS.sendTraceTag(591541786,Eb.Ii,15,"Annotation moved to unsupported location type: {0}",
vb.Sv);else if(cb.Sv!==vb.Sv)a.ULS.sendTraceTag(591541787,Eb.Ii,15,"Location types are not equal. This is not currently supported. Old: {0} New: {1}",cb.Sv,vb.Sv);else{cb=this.fof(la,cb);for(const xc of cb){const ad=xc.content;cb=hc.a.ljb(this.OI.value,xc.parentPath);if(!cb){a.ULS.sendTraceTag(591541788,Eb.Ii,15,"RegisterHandler.onPersistedAnnotationMoved: Unable to get node from tileId.");break}if(!this.Un.ldd(Zd=>Zd.intent===ad,cb,0))break;var ec=vb.Pua;ec=new Bb.a(0,ec,ec+vb.Oua,null,ad);this.Un.fHa(cb,
ec)}}},cb=>{for(const vb of this.fof(la,cb))this.h1a(vb,!1)})}releaseAnnotation(la,cb){let vb;if(({value:vb}=this.Rgd.Fc(la,vb)).returnValue){vb.contains(cb)&&vb.remove(cb);if(0<vb.count)return Promise.resolve(!1);this.Rgd.remove(la)}a.ULS.sendTraceTag(593790408,Eb.Ii,50,"ReleaseAnnotation: Releasing annotation type {0}.",la);return this.Ljj(la)}bln(la){var cb=null;if(({value:cb}=this.B6.Fc(la,cb)).returnValue){a.ULS.sendTraceTag(41418899,Eb.Ii,50,"OnAllHandlersUnregistered: Purging all storage for annotation type {0}.",
la);for(const vb of cb)if(cb=null,({value:cb}=this.uD.Fc(vb,cb)).returnValue){const ec=cb.parentPath;let xc=null;({value:xc}=this.JAa.Fc(ec,xc)).returnValue&&(xc.remove(vb),xc.count||this.JAa.remove(ec));this.uD.remove(vb);Eb.NIb(cb)&&this.Jog(cb)}this.B6.remove(la)}Array.contains(this.Lik,la)&&this.Ljj(la)}Ljj(la){let cb=null,vb=null;this.tKa&&(vb=this.tKa());if(vb){if(({value:cb}=this.EUb.Fc(la,cb)).returnValue){const ec=new za;ec.token=cb;this.EUb.remove(la);this.sa.raiseEvent(Eb.I6d,new Ua(la,
!1));return vb.releaseAnnotation(ec)}return Promise.resolve(!0)}return Promise.reject(Error.create("Error during annotation release"))}kHi(){this.ti.ie(()=>{if(this.W7j){var la=hc.a.getRootNode();if(la){var cb=new Xa.a;kb.f(la,vb=>{var ec=hc.a.DJ(vb),xc=null;if(({value:xc}=this.JAa.Fc(ec,xc)).returnValue)for(const ad of xc)ec=null,({value:ec}=this.uD.Fc(ad,ec)).returnValue&&(ec.parent=vb,ec.fXc=!0,ec.rNb=2,cb.nb(ec.annotationType)||cb.Z(ec.annotationType,new lb.a),cb.J(ec.annotationType).add(ad),
xc=null,({value:xc}=this.B6.Fc(ec.annotationType,xc)).returnValue&&xc.remove(ec.id));return!0},12);for(const vb of this.B6.keys)if(la=null,({value:la}=this.B6.Fc(vb,la)).returnValue)for(const ec of la)if(la=null,({value:la}=this.uD.Fc(ec,la)).returnValue){let xc=null;la.parentPath===hc.a.dEb?(la.rNb=1,la.parent=null):({value:xc}=this.uD.Fc(la.parentPath,xc)).returnValue?(la.rNb=3,la.parent=xc):(la.rNb=0,la.parent=null,a.ULS.sendTraceTag(41554060,Eb.Ii,15,"LinkAnnotations: Unknown annotation parent for annotation ID: {0}.",
la.id));la.fXc=!0;cb.nb(la.annotationType)||cb.Z(la.annotationType,new lb.a);cb.J(la.annotationType).add(ec)}else a.ULS.sendTraceTag(41997840,Eb.Ii,15,"LinkAnnotations: Annotation object not found for the given annotation ID: {0}.",ec);else a.ULS.sendTraceTag(41997841,Eb.Ii,15,"LinkAnnotations: Annotations not found for the given annotation type: {0}.",vb);this.B6=cb;this.mNe.clear()}else a.ULS.sendTraceTag(41554058,Eb.Ii,10,"LinkAnnotations: There is no root node in the current document.")}else a.ULS.sendTraceTag(41554057,
Eb.Ii,50,"LinkAnnotations: Link annotations called but flags is not set.")},"AS:LA")}UCk(la){this.a5i(la,!0)}pvn(la,cb){this.ti.ie(()=>{const vb=cb?cb+String.format("\\{0}",la.id):hc.a.DJ(la);a.ULS.sendTraceTag(41418900,Eb.Ii,50,"OnTileDeleted: Tile delete event received for tile {0}.",vb);this.Stc.contains(vb)||this.Stc.add(vb);var ec=null;if(({value:ec}=this.JAa.Fc(vb,ec)).returnValue){a.ULS.sendTraceTag(41418901,Eb.Ii,100,"OnTileDeleted: Removing {0} annotations for tile {1} from storage.",ec.count,
vb);for(const xc of ec)ec=null,({value:ec}=this.uD.Fc(xc,ec)).returnValue&&(this.YPb(ec,Ga.a.getTypeName()),this.sa.j9&&this.sa.raiseEvent(Eb.Dgc,new Ya(ec,Ga.a.getTypeName())),this.uD.remove(xc));this.JAa.remove(vb)}},"AS:OTD")}ovn(la){la=hc.a.DJ(la);this.Stc.remove(la)&&a.ULS.sendTraceTag(41418902,Eb.Ii,50,"OnTileAdded: Deleted tile {0} was re-added.",la)}dZo(la){if(la){a.ULS.sendTraceTag(50436131,Eb.Ii,50,"UpdateRangeForAnnotations: Updated ranges for annotations {0}",la.count);var cb=new Xa.a;
for(var vb of la)la=null,({value:la}=cb.Fc(vb.parentPath,la)).returnValue||(la=new Xa.a,cb.add(vb.parentPath,la)),la.Z(vb.id,vb);for(const ec of cb){cb=hc.a.ljb(this.OI.value,ec.key);if(!cb){a.ULS.sendTraceTag(50436160,Eb.Ii,10,"UpdateRangeForAnnotations: Unable to get node for the annotation");break}vb=new Ja.a([0]);for(let xc=0,ad=cb.qa.length;xc<ad;xc++)la=cb.qa.J(xc),la.Qj&&vb.JVa(la.Qj,void 0,(Zd,pe)=>{if(pe){var Td=null,Ie=pe.intent;Ie&&({value:Td}=ec.value.Fc(Ie.id,Td)).returnValue&&(Ie=new qa.a,
Ie.start=pe.Lb.cp,Ie.length=Zd.Lb.cp-Ie.start,Td.content.range=Ie,Td.oqa=!1)}})}}else a.ULS.sendTraceTag(50436130,Eb.Ii,10,"UpdateRangeForAnnotations: annotations list null")}getAnnotationsByType(la){a.ULS.sendTraceTag(593049729,Eb.Ii,50,"GetAnnotationsByType: Method called for type {0}.",la);return this.eZe(la).then(()=>{const cb=new lb.a;this.ti.ie(()=>{if(hc.a.af(la)||la!==ia.a.getTypeName()){this.mNe.contains(la)&&this.kHi();var vb=null;if(({value:vb}=this.B6.Fc(la,vb)).returnValue){a.ULS.sendTraceTag(41418903,
Eb.Ii,50,"GetAnnotationsByType: Enumerating annotations of type {0}.",la);var ec=new lb.a;for(const xc of vb)vb=null,({value:vb}=this.uD.Fc(xc,vb)).returnValue&&(vb.oqa&&ec.add(vb),cb.add(vb));ec&&0<ec.count&&Eb.NIb(ec.J(0))&&this.dZo(ec)}}else for(ec of this.ijd.values)cb.add(ec);cb.count||a.ULS.sendTraceTag(41418904,Eb.Ii,50,"GetAnnotationsByType: No annotations found for type {0}!",la)},"AS:GABT");return cb},cb=>{a.ULS.sendTraceTag(41418905,Eb.Ii,10,"Exception occurred while fetching annotations of type {0}: {1}",
la,cb);return null})}Eha(la){let cb=null;return({value:cb}=this.uD.Fc(la,cb)).returnValue?cb:null}gof(la){let cb=null;if(this.JAa.nb(la))for(const vb of this.JAa.J(la))if(la=this.Eha(vb))cb||(cb=new lb.a),cb.add(la);return cb}UKb(la){return(la=this.Eha(la))?(la.fXc||this.kHi(),la):null}mAa(la,cb){this.doo(la,cb);this.Rpg(la,cb);this.YPb(la,ta.a.getTypeName())}aUo(la,cb){this.WXo(la,cb);this.mlo(la,hc.a.dOl(la));this.YPb(la,ta.a.getTypeName())}bUo(la,cb){la=this.rC.$4h(la);for(const vb of la)this.$F.Epg(this.OI.value,
vb,cb)}doo(la,cb){let vb=null;this.tKa&&(vb=this.tKa());vb&&(la=this.fOl(la,cb))&&vb.setAnnotationState(la)}Rpg(la,cb,vb=!0){if(la&&Eb.Kvi(la)){var ec=this.Eha(la.id);!la.content||ec&&la.content===ec.content||hc.a.setAnnotationState(la,cb);ec&&ec.content&&hc.a.setAnnotationState(ec,cb);vb&&this.sa.j9&&(70===cb||60===cb)&&this.sa.raiseEvent(Eb.OTi,new cc(la,cb))}}fOl(la,cb){let vb=null;la&&(vb=Object.assign(new xa,{id:la.id,value:cb}),hc.a.af(la.parentPath)||(vb.parentPath=la.parentPath.split("\\")));
return vb}mlo(la,cb){const vb=this.tKa?this.tKa():null;vb&&(la=this.cOl(la,cb))&&vb.setAnnotationMetadata(la)}WXo(la,cb){if(la&&Eb.Kvi(la)){var vb=this.Eha(la.id);!la.content||vb&&la.content==vb.content||hc.a.tkj(la,cb);vb&&vb.content&&hc.a.tkj(vb,cb)}}cOl(la,cb){if(!la)return null;const vb=new Oa;vb.id=la.id;vb.value=cb;hc.a.af(la.parentPath)||(vb.parentPath=la.parentPath.split("\\"));return vb}Tro(la,cb,vb,ec){const xc=la.content;if(this.rC.vlb(la)&&xc){const ad=xc.range.start+xc.range.length;if(0<
ec&&ad<=vb||0>ec&&ad<=vb+ec)return!1;if(0<ec&&xc.range.start>=cb||0>ec&&xc.range.start>=vb)return xc.range.start+=ec,!1}return!this.rd.isFeatureEnabled(62)&&xc&&xc.M_?(la=this.rC.Mlb(la,60),!(60===xc.M_.state&&la)):!0}eoh(la,cb){this.Xka.nb(cb)||this.Xka.Z(cb,new Fb);this.Xka.J(cb).handlers.add(la);la(cb,this.Xka.J(cb).oldState,this.Xka.J(cb).newState)}J$i(la,cb){this.Xka.nb(cb)&&this.Xka.J(cb).handlers.contains(la)&&this.Xka.J(cb).handlers.remove(la)}static Kvi(la){la=va.a.getBaseTypesFor(la.content);
return Array.contains(la,Pa.a.getTypeName())}static NIb(la){if(void 0===la.content||null===la.content||""===hc.a.e3a(la.parentPath))return!1;const cb=va.a.getBaseTypesFor(la.content);return Array.contains(cb,pa.a.getTypeName())&&la.annotationType!==Da.RoleDetectionAnnotation.getTypeName()}$To(la){la?(this.Ite.AugLoop_Text_Critique=la,la=this.acc("AugLoop_Text_Critique")?this.EUb.J("AugLoop_Text_Critique"):null,this.OEj(la,"AugLoop_Text_Critique")):a.ULS.sendTraceTag(540615552,Eb.Ii,50,"Annotation configuration could not be updated for annotation type: {0}.",
"AugLoop_Text_Critique")}OEj(la,cb){if(la&&this.Ite[cb]){const vb=new Hc;vb.token=la;vb.config=this.Ite[cb];this.tKa&&(this.tKa().updateAnnotationConfig(vb),a.ULS.sendTraceTag(540615553,Eb.Ii,50,"Annotation configuration has been updated for annotation type: {0}.",cb))}}aaj(la){let cb=null;({value:cb}=this.uD.Fc(la.id,cb)).returnValue&&(la.annotationType=cb.annotationType);this.Ptc.has(la.id)&&this.Ptc.delete(la.id)}NEj(la,cb,vb,ec){this.zZn(la);this.PEj(la,vb,ec,cb)&&this.bba.tHj(la,vb)}KTa(la){const cb=
la.parentPath,vb=Ga.a.getTypeName();this.aaj(la);this.mAa(la,70);this.Stc.contains(cb)||this.NEj(la,cb,vb,!0)}Y3l(la){const cb=new lb.a;la=this.B6.Fc(la).value;if(null===la)return cb;for(const vb of la)la=this.uD.Fc(vb).value,null!==la&&cb.push(la);return cb}async eqm(){await Object(ic.b)();this.V$i()}V$i(){const la=this.Y3l(mc.a.getTypeName());for(const cb of la)this.Qwi(cb.content)&&this.KTa(cb)}}Eb.Ii=389;Eb.Dgc="OnAnnotationOperation";Eb.OTi="OnAnnotationLocalStateChange";Eb.I6d="OnAnnotationActivationChange";
Eb.tck=20;Object(e.a)(Eb,"AnnotationStorage",null,[457]);class hb{constructor(){this.Lfe=null;this.F$c=!1}}Object(e.a)(hb,"AugmentationLoopStateManager",null,[455]);var ob=c(201),Va=c(578),Qb=c(69),Vb=c(105),Sb=c(600),nb=c(530),ac=c(233);class zc extends ac.a{constructor(){super();this.FileId=this.AugLoopSeedUrl=this.Authorization=this.OriginString=this.ExpectedEndRevisionId=null;this.AddSubDocumentKindTypeToPathIsEnabled=this.CheckOnDemandNodeVersionEnabled=this.AddDocumentKindTypeToPathIsEnabled=
this.SeedBatchesInParallelIsEnabled=!1}nl(){return nb.a.seedFullFileAugLoop}static construct(la,cb,vb,ec,xc,ad){const Zd=new zc;Zd.ExpectedEndRevisionId=la;Zd.OriginString=cb;Zd.Authorization=vb;Zd.AugLoopSeedUrl=ec;Zd.FileId=xc;Zd.SeedBatchesInParallelIsEnabled=ad;Zd.AddDocumentKindTypeToPathIsEnabled=!0;Zd.CheckOnDemandNodeVersionEnabled=!0;Zd.AddSubDocumentKindTypeToPathIsEnabled=!0;return Zd}}Object(e.a)(zc,"FullFileAugLoopSeedingRequest",ac.a,[]);class Ib{constructor(){this.authToken=this.url=
this.n_i=null}}Object(e.a)(Ib,"ReseedingTaskInfo",null,[]);class ya{constructor(la,cb,vb,ec,xc,ad){this.vaa=null;this.PWg=!1;this.lWb=null;this.IQe=0;this.G4c=(Zd,pe)=>{Zd=pe.Kba;this.lWb&&Vb.AT(Zd,Td=>Td===this.lWb)&&(pe.httpStatusCode!==ob.a.Zz||pe.gI||2!==pe.Z0f?pe.httpStatusCode!==ob.a.Zz||pe.gI||1!==pe.Z0f?this.ufj(()=>{a.ULS.sendTraceTag(50861003,ya.Ii,10,"ProcessReplicationStatus: ForceInbound or pinning the lastest revision failed. HttpStatusCode: {0}, OperationResult: {1}, PinRevisionForAugLoopResponse: {2}, Correlation: {3}",
pe.httpStatusCode,pe.gI,pe.Z0f,pe.Wr)}):(this.jO.F$c=!1,this.vaa.vjc(this.G4c),this.Je.nZk(),a.ULS.sendTraceTag(50861002,ya.Ii,50,"ProcessReplicationStatus: Initiated Full File Seeding Request"),Zd=Object(Qb.a)(Ib,this.lWb),this.v6i(pe.d9n,Zd.n_i,Zd.url,Zd.authToken)):this.ufj(()=>{a.ULS.sendTraceTag(50861001,ya.Ii,50,"Replication succeeded but failed to pin the latest revision on the server for the user")}))};this.FCl=Zd=>{if(void 0===Zd||null===Zd||void 0===Zd.data||null===Zd.data||void 0===Zd.data.se||
null===Zd.data.se)a.ULS.sendTraceTag(41445393,ya.Ii,10,"FileSeedingSuccessCallback: args or args.Data or args.Data.ResponseData is null or Undefined");else if(Zd.data.Se!==ob.a.Zz)a.ULS.sendTraceTag(41445394,ya.Ii,10,"FileSeedingSuccessCallback: Returned unexpected args.Data.HttpStatus code: {0}",Zd.data.Se);else try{let pe;({group:pe}=Va.a.d2(Zd.data.se)).returnValue?pe.Responses&&pe.Responses.length?(Zd=null,pe&&pe.Responses&&pe.Responses.length&&(Zd=pe.Responses[0])?(this.o3.EVa(Zd),Zd.StatusCode?
a.ULS.sendTraceTag(41445398,ya.Ii,10,"FileSeedingSuccessCallback: FullFileAugLoopSeedingResponse returned unexpected status code: {0}",Zd.StatusCode):a.ULS.sendTraceTag(41445399,ya.Ii,50,"FileSeedingSuccessCallback: FullFileAugLoopSeeding was successful and last revision seeded is {0}",Zd.LastSeededRevisionId)):a.ULS.sendTraceTag(41445397,ya.Ii,10,"FileSeedingSuccessCallback: serverResponseGroup is null or serverResponseGroup.Responses is null or serverResponseGroup.Responses is empty or response is null")):
a.ULS.sendTraceTag(41445396,ya.Ii,10,"FileSeedingSuccessCallback: responseGroup or responseGroup.Responses is null or empty"):a.ULS.sendTraceTag(41445395,ya.Ii,10,"FileSeedingSuccessCallback received null or empty server response group")}catch(pe){a.ULS.sendTraceTag(41445400,ya.Ii,10,"FileSeedingSuccessCallback: {0}",pe.message)}};this.ECl=Zd=>{void 0===Zd||null===Zd||void 0===Zd.data||null===Zd.data||void 0===Zd.data.se||null===Zd.data.se?a.ULS.sendTraceTag(41445401,ya.Ii,10,"FileSeedingFailCallback: args or args.Data or args.Data.ResponseData is null or Undefined"):
a.ULS.sendTraceTag(41445402,ya.Ii,10,"FileSeedingFailCallback: Editor Service token generation server request failed:{0}",Zd.data.Se)};this.SWj=la.$("AugLoopServerSideSeedingIsEnabled");this.QWj=la.$("AugLoopReseedingIsEnabled");this.RWj=la.$("AugLoopFFSSeedBatchesInParallelIsEnabled");this.Z6g=la.mc("MaxReseedingRetries",1);this.$f=cb;this.qnd=vb;this.jO=ec;this.o3=xc;this.Je=ad;Q.App.za&&Q.App.za.jb&&Q.App.za.jb.Zc&&Q.App.za.jb.Zc.contentReplicator&&(this.vaa=Q.App.za.jb.Zc.contentReplicator)}CCm(la,
cb,vb){if(this.SWj){var ec=this.jO.Lfe;ec&&ec.trim().length?this.PWg?this.QWj&&(a.ULS.sendTraceTag(50861E3,ya.Ii,50,"InitiateFullFileSeedingFlow: Initiated Reseeding Flow"),this.IQe=0,this.vaa?(this.jO.F$c=!0,this.vaa.$Fc(this.G4c),this.lWb=Object.assign(new Ib,{n_i:la,url:cb,authToken:vb}),this.vaa.kF(null,null,this.lWb)):a.ULS.sendTraceTag(592814793,ya.Ii,50,"InitiateFullFileSeedingFlow: ContentReplicator is null")):(a.ULS.sendTraceTag(41445392,ya.Ii,50,"InitiateFullFileSeedingFlow: Initiated FullFileSeedingFlow"),
this.v6i(ec,la,cb,vb),this.PWg=!0):a.ULS.sendTraceTag(41445391,ya.Ii,10,"InitiateFullFileSeedingFlow: Empty or Null SeedRevision. Unable to InitiateFullFileSeedingFlow.")}else a.ULS.sendTraceTag(41445390,ya.Ii,50,"InitiateFullFileSeedingFlow: AugLoopServerSideSeeding BRS setting has been diabled. File will not be seeded to Augmentation Loop.")}ufj(la){this.IQe<this.Z6g?(a.ULS.sendTraceTag(594384E3,ya.Ii,50,"RetryReseeding: ForceInbound or pinning the latest revision failed. Reseeding retry #{0} of {1}",
++this.IQe,this.Z6g),this.vaa.kF(null,null,this.lWb)):(this.jO.F$c=!1,this.vaa.vjc(this.G4c),la())}v6i(la,cb,vb,ec){const xc=zc.construct(la,cb,ec,vb,y.AFrameworkApplication.rootQuerySignature,this.RWj);a.ULS.sendTraceTag(595178454,ya.Ii,50,"QueueFullFileSeedingRequest: Calling AddSeedRequestToRequestManager on Host store replicator load completion.");this.qnd.L3a.execute(()=>{this.fvk(xc)})}fvk(la){a.ULS.sendTraceTag(595178453,ya.Ii,50,"InitiateFullFileSeedingFlow: Adding seed request to RequestManager");
this.$f.mj(Q.App.webServiceBase+"OneNote.ashx?perfTag=FullFileAugLoopSeed",2,Sb.b(la),{["Content-Type"]:"application/json; charset=utf-8"},!1,2,this.FCl,this.ECl,la);a.ULS.sendTraceTag(42016906,ya.Ii,50,"InitiateFullFileSeedingFlow: Added seed request to RequestManager")}}ya.Ii=389;Object(e.a)(ya,"FullFileAugLoopSeedingService",null,[]);class ib{constructor(){}}Object(e.a)(ib,"RuntimeManagerInitializationTracker",null,[]);var wb=c(712);class bc{getAugLoopRuntimeManager(){return wb.a.getAugLoopRuntimeManager()}}
Object(e.a)(bc,"AlFactoryWrapper",null,[360]);class lc{ml(){return hc.a.ml()}}Object(e.a)(lc,"UtilsWrapper",null,[359]);var Kb=c(758),Bc=c(55),Xc=c(16),vd=c(46),vc=c(174),bd=c(2059),Sd=c(5),pd=c(104),Tc=c(218),Wc=c(26),Pc=c(355),Xd=c(393),Dd=c(99),$e=c(57);class se{constructor(la,cb,vb,ec,xc){this.Ca=la;this.Hf=vb;this.ep=ec;this.we=xc;this.vpa=this.Ca.$("WordDesignerCaptionDetectionEnabled")}njo(la,cb){la.listType=this.Q3l(cb);la.outlineLevel=fb.ParagraphReader.Koa(cb);la.indentation=se.Drf(this.ep.wU(cb));
la.alignment=se.Tnf(fb.ParagraphReader.Lx(cb));la.isInsideTable=this.isInsideTable(cb);la.isInsideTOC=cb.Gr;la.rightIndentation=se.Drf(this.ep.$2a(cb));var vb=this.ep.V$b(cb);la.specialIndentType=se.Tem(vb);la.specialIndentBy=se.Drf(vb);la.listType!==bd.e.NoList&&this.Vko(cb,la);this.Yno(cb,la);vb=[];this.vpa&&(vb=this.rIn(cb));la.formattedRanges=this.FZl(cb,vb);this.vpa&&null!=vb&&(la.objectReferences=0<vb.length?vb:void 0)}FZl(la,cb){var vb=la.qa?la.qa.length:0,ec=pd.FormattingReader.Yr(Wc.a.create(la));
let xc=Dd.a.OH,ad=0,Zd=Dd.a.GM/2;ec&&(Zd=pd.FormattingReader.ao(ec,Xc.a.fontSize,Dd.a.GM)/2,xc=pd.FormattingReader.ao(ec,Xc.a.font,Dd.a.OH),ad=pd.FormattingReader.language(ec));ec="Normal";var pe=this.we.So(la);pe&&(ec=pe.getValue(vd.a.la)||"Normal",pe.hasProperty(Xc.a.font)&&(xc=pe.getValue(Xc.a.font)));if(vb){--vb;pe=[];let lf=null,Rk=void 0,hm=null;this.vpa&&la.hasProperty(Xc.a.Sn)&&(hm=la.getValue(Xc.a.Sn));const Lj=la.properties.ja(sa.a.eha,null);for(let Bk=0;Bk<vb;Bk++){var Td=la.qa.J(Bk),Ie=
la.Mc,We=null;this.vpa&&(We=se.Fvf(la,hm,Bk));Td.Te&&(lf=se.yVo(Ie,Td.Te,lf));Td.hyperlink&&Td.hyperlink.url?Rk=Td.hyperlink.url:Td.Cm&&(Rk=void 0);var Vf=la.qa.J(Bk+1).cp-1;Ie=Td.cp;Vf=Vf-Td.cp+1;let Zi=!1,Rj=!1,tm=!1,dh=Zd,uk=0,gl=0,Um=ec,Sk=void 0,en=ad,Do=xc,Ui;if(Td.formatting){var tf=Td.formatting;Zi=pd.FormattingReader.ao(tf,Xc.a.bold,!1);Rj=pd.FormattingReader.ao(tf,Xc.a.italic,!1);tm=pd.FormattingReader.ao(tf,Xc.a.underline,!1);dh=pd.FormattingReader.ao(tf,Xc.a.fontSize,2*Zd)/2;uk=pd.FormattingReader.ao(tf,
vd.a.capitalization,0);gl=pd.FormattingReader.ao(tf,Xc.a.fontColor,0);en=pd.FormattingReader.language(tf)||ad;Do=pd.FormattingReader.ao(tf,Xc.a.font,xc);Um=ec;var yf=tf.Jn;yf&&(yf=yf.ja(vd.a.qw,null))&&!yf.equals(ua.a.nil)&&tf.paragraph.Mc&&(tf=tf.paragraph.Mc.Eb(yf))&&(Um=(new Tc.a(tf)).getValue(vd.a.la))}this.vpa&&(Ui=this.Ysf(We),null!=Ui&&this.iqh(cb,We,Ui,pe.length,bd.b.Inline));lf&&(Sk=0<lf.count);Td={isDeleted:this.dLm(Lj,Td,Bk,Rk),fontFamily:Do,fontWeight:Zi?bd.d.Bold:bd.d.Normal,fontSize:dh,
italic:Rj,underline:tm?bd.h.SingleLine:bd.h.None,capitalization:se.iKh(uk),color:gl,styleName:Um,isFollowUp:Sk,languageId:se.ZJh(en),start:Ie,length:Vf,link:Rk,isReference:se.isReference(Td)?!0:void 0,objectType:null!==Ui&&void 0!==Ui?Ui:void 0};We=0<pe.length?pe[pe.length-1]:void 0;se.cTk(We,Td)?We.length+=Td.length:pe.push(Td)}return pe}return[{fontFamily:xc,fontWeight:bd.d.Normal,fontSize:Zd,italic:!1,underline:bd.h.None,capitalization:se.iKh(0),color:0,styleName:ec,isFollowUp:void 0,languageId:se.ZJh(ad),
start:0,length:la.characterData.length}]}dLm(la,cb,vb,ec){if(this.QB()){if(cb.blob||cb.formatting&&cb.formatting.cache&&cb.formatting.cache.AJb||ec)return!0;if(la&&vb<la.length)return la[vb]}return $e.a.Xj&&cb.MR?!0:cb.Mh?!0:!1}QB(){return!!y.AFrameworkApplication.K&&y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}static cTk(la,cb){return!!la&&!!cb&&la.start+la.length===cb.start&&la.isDeleted===cb.isDeleted&&la.fontFamily===cb.fontFamily&&la.fontWeight===
cb.fontWeight&&la.fontSize===cb.fontSize&&la.italic===cb.italic&&la.underline===cb.underline&&la.capitalization===cb.capitalization&&la.color===cb.color&&la.highlightColor===cb.highlightColor&&la.styleName===cb.styleName&&void 0===la.link&&void 0===cb.link&&la.languageId===cb.languageId&&!la.isReference&&!cb.isReference&&!la.isFollowUp&&!cb.isFollowUp&&void 0===la.objectType&&void 0===cb.objectType}Q3l(la){const cb=new Sd.GraphIterator;cb.set(la);cb.zb(11);cb.jd(11);return(la=this.Hf.vw(cb))?se.H7k(la.listType):
bd.e.NoList}Vko(la,cb){var vb=this.Hf.Aca(la);vb&&(vb.hasProperty(sa.a.listID)&&(cb.listId=vb.getValue(sa.a.listID).toString()),vb=this.Ubi(la,Xc.a.font),la=this.Ubi(la,Xc.a.fontSize),vb&&(cb.bulletAndNumberFontFamily=vb),la&&(cb.bulletAndNumberFontSize=la))}isInsideTable(la){const cb=new Sd.GraphIterator;cb.set(la);return cb.zb(14)}Yno(la,cb){cb.spacingBeforeParagraph=this.Fhi(la,sa.a.A5,sa.a.XY,sa.a.Ui);cb.spacingAfterParagraph=this.Fhi(la,sa.a.z5,sa.a.WY,sa.a.ta);cb.lineSpacing=this.zGb(la)}Fhi(la,
cb,vb,ec){if(fb.ParagraphReader.ao(la,cb,!1))return 0;cb=fb.ParagraphReader.ao(la,vb,-1);if(0<=cb)return cb*Pc.a.kNb/100;la=fb.ParagraphReader.ao(la,ec,-1);return 0<=la?la/20:0}Ubi(la,cb){la=this.EWl(la);if(null!=la&&null!=la.cache)return la.cache.getValue(cb)}EWl(la){var cb;la=null===(cb=la.qa)||void 0===cb?void 0:cb.last;return null!=la&&la.Ph?la.formatting:(a.ULS.sendTraceTag(520680196,389,50,"EOP for list item does not have any formatting applied."),null)}zGb(la){const cb=fb.ParagraphReader.ao(la,
sa.a.ya,Pc.a.ya);la=fb.ParagraphReader.ao(la,sa.a.xa,Pc.a.lineSpacing);switch(cb){case 0:return la/240;case 1:return la/20;default:return 0}}static yVo(la,cb,vb){for(let ec=0;ec<cb.length;ec++){const xc=cb.J(ec),ad=xc.Lj,Zd=la.Eb(ad);Zd&&Zd.ja(sa.a.SG,!1)&&(vb||(vb=new fa.a(new Xd.a)),xc.Oc?vb.add(ad):vb.remove(ad))}return vb}static ZJh(la){return(la=Kb.a.tg(la))&&la.name?la.name.toLowerCase():void 0}static Drf(la){return la?2===la.unit?Math.floor(Bc.a.kCb(la.value)/20):Math.floor(la.value/20):0}static Tem(la){if(!la)return bd.g.Initial;
switch(la.specialIndentType){case 1:return bd.g.FirstLine;case 2:return bd.g.Hanging;default:return bd.g.Initial}}static iKh(la){switch(la){case 2:return bd.c.AllCaps;case 1:return bd.c.SmallCaps;default:return bd.c.NoCaps}}static Tnf(la){switch(la){case 1:return bd.a.Left;case 3:return bd.a.Right;case 2:return bd.a.Center;case 6:return bd.a.Justified;case 0:return bd.a.None;default:return bd.a.Other}}static H7k(la){switch(la){case 15:return bd.e.Any;case 1:return bd.e.Bullet;case 42:return bd.e.Invalid;
case 13:return bd.e.Lim;case 14:return bd.e.Nil;case 16:return bd.e.NoList;case 0:return bd.e.Numbered;default:return bd.e.Invalid}}static isReference(la){return la.blob&&(7===la.blob.vh||10===la.blob.vh)||la.$g&&0<la.$g.length||la.Te&&0<la.Te.length||la.Jb&&0<la.Jb.length?!0:!1}static Fvf(la,cb,vb){return null==cb?null:cb[vb]&&!cb[vb].equals(ua.a.nil)&&la.Mc?la.Mc.Eb(cb[vb]):null}Ysf(la){if(null==la)return null;if(la.hasProperty(sa.a.Qs)){var cb=la.getValue(sa.a.Qs);if(se.x2i.has(cb))return se.x2i.get(cb)}if(la.hasProperty(sa.a.O8b)&&
null!=la.getValue(sa.a.O8b))return bd.f.FootnoteEndnote;if(la.hasProperty(sa.a.pageBreak)&&la.getValue(sa.a.pageBreak))return bd.f.PageBreak;if(la.hasProperty(sa.a.cKb)&&la.getValue(sa.a.cKb))return bd.f.Tab;cb=!1;la.hasProperty(vc.a.P4)?cb=la.getValue(vc.a.P4):la.hasProperty(sa.a.tia)&&(cb=la.getValue(sa.a.tia));return cb&&la.hasProperty(sa.a.imageType)&&1==la.getValue(sa.a.imageType)?bd.f.Image:null}static aOm(la){return la.hasProperty(sa.a.Kac)&&0<=la.getValue(sa.a.Kac)?!0:!1}sDi(la){return se.MFo.has(la)}oNh(la,
cb,vb,ec){return null==la||null==cb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: propertySet or objectType is undefined."),null):ec===bd.b.Inline&&null==vb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Inline object does not have formattedRangeIndex defined."),null):ec===bd.b.Floating&&null!=vb?(a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Floating object has formattedRangeIndex defined."),null):0>vb?(a.ULS.sendTraceTag(null,
389,10,"FormattingExtractor.CreateObjectReference: FormattedRangeIndex is a negative number."),null):se.aOm(la)?null:this.sDi(cb)?{referencedPath:["session","doc","main",la.id.toString()],formattedRangeIndex:vb,anchorMode:null!==ec&&void 0!==ec?ec:bd.b.Unspecified,anchoredObjectType:ec==bd.b.Floating?cb:void 0}:null}iqh(la,cb,vb,ec,xc){cb=this.oNh(cb,vb,ec,xc);null!=cb&&null!=la&&la.push(cb)}rIn(la){const cb=[];if(null==la)return a.ULS.sendTraceTag(null,389,10,"FormattingExtractor.ProcessAnchoredObjects: paragraphNode is null."),
cb;let vb=null;la.hasProperty(sa.a.Y7)&&(vb=la.getValue(sa.a.Y7));if(null!=vb)for(let ec=0;ec<vb.length;++ec){const xc=se.Fvf(la,vb,ec),ad=this.Ysf(xc);null!=ad&&this.iqh(cb,xc,ad,null,bd.b.Floating)}return cb}$Ih(la){if(null==la||!la.hasProperty(Xc.a.Sn))return!1;const cb=la.getValue(Xc.a.Sn);for(let ec=0;ec<cb.length;ec++){var vb=se.Fvf(la,cb,ec);vb=this.Ysf(vb);if(this.sDi(vb))return!0}return!1}}se.x2i=new Map([[5,bd.f.Image],[11,bd.f.TextBox],[7,bd.f.Chart],[6,bd.f.SmartArt],[10,bd.f.Drawing],
[2,bd.f.EquationObject],[4,bd.f.Ink],[19,bd.f.PageBreak],[23,bd.f.FootnoteEndnote],[24,bd.f.FootnoteEndnote],[35,bd.f.FootnoteEndnoteReferenceMark],[36,bd.f.FootnoteEndnoteReferenceMark],[0,bd.f.Other]]);se.MFo=new Set([bd.f.Image,bd.f.TextBox,bd.f.Chart,bd.f.SmartArt,bd.f.Drawing,bd.f.Ink]);Object(e.a)(se,"FormattingExtractor",null,[357]);var wc=c(1235);class cd extends Sys.EventArgs{constructor(la){super();this.Dac=la}}Object(e.a)(cd,"HasNodeEventsEventArgs",Sys.EventArgs,[]);class Jd extends Sys.EventArgs{constructor(la){super();
this.w9=la}}Object(e.a)(Jd,"IsCollectingNodeEventsEventArgs",Sys.EventArgs,[]);class Qd{constructor(la,cb,vb){this.u1c=la;this.graphNode=cb;this.fullPath=vb}}Object(e.a)(Qd,"NodeEvent",null,[375]);class yd{constructor(){this.HFe=this.rDe=!1;this.Fwb=null;this.sa=new ha.a;this.Taa=new S.a(0);this.nbb=new wc.a(Ka.a.ih());this.qxb=new wc.a(Ka.a.ih());this.fsd=[]}Hqh(la){this.sa.addHandler("IsCollectingNodeEventsChangedKey",la)}UYk(){this.Taa=new S.a(0);this.Dac=!1}get Dac(){return this.rDe}set Dac(la){this.rDe!==
la&&(this.rDe=la,this.sa.raiseEvent("HasNodeEventsChangedKey",new cd(la),this))}get w9(){return this.HFe}set w9(la){this.HFe!==la&&(this.HFe=la,this.sa.raiseEvent("IsCollectingNodeEventsChangedKey",new Jd(la),this))}OPb(la,cb){this.nbb.nb(la)||this.nbb.Z(la,cb)}Fao(la,cb){this.qxb.Z(la,cb)}XNl(la){let cb=null;this.qxb.nb(la)&&(cb=this.qxb.J(la),this.qxb.remove(la));return cb}$ce(la,cb){if(la)if(this.w9){var vb=3!==cb&&4!==cb&&5!==cb||!this.nbb.nb(String.format("{0}",la.id))?hc.a.DJ(la):this.nbb.J(String.format("{0}",
la.id));if(({value:ec}=this.Taa.Fc(vb)).returnValue)if(ec||3!==cb)if(5===ec&&3===cb){if(la=vb.split("\\").pop(),this.qxb.nb(la)){var ec=this.qxb.J(la);ec===vb?(this.UNf(vb,cb),this.Taa.add(vb,cb)):(this.qxb.Z(la,vb),this.nbb.Z(la,ec),this.KLi(vb),this.Taa.remove(vb),this.UNf(vb,cb),this.Taa.add(ec,5))}}else ec&&(4!==ec||0!==cb&&3!==cb&&5!==cb)&&(this.UNf(vb,cb),this.Taa.add(vb,cb));else this.KLi(vb),this.Taa.remove(vb);else this.I8m(vb,cb),this.fsd.push(la),this.Taa.add(vb,cb);this.Dac=0<this.Taa.count}else a.ULS.sendTraceTag(593761369,
389,15,"Can't record a node event if not in collecting mode.");else a.ULS.sendTraceTag(593761370,389,15,"node is null.")}I8m(la,cb){a.ULS.sendTraceTag(593761368,389,100,"Recording new event in queue for node {0} of kind {1}.",la,cb)}UNf(la,cb){a.ULS.sendTraceTag(593761366,389,100,"Recording new event for node {0} of kind {1}.",la,cb)}KLi(la){a.ULS.sendTraceTag(593761367,389,100,"Removing node {0} form _nodeIdEventKindMap.",la)}a5k(){let la=null;var cb=!1;let vb=null;for(;this.fsd.length&&!cb;){vb=
Array.dequeue(this.fsd);if(!vb)return a.ULS.sendTraceTag(593761365,389,15,"graphNode should not be null."),null;this.nbb.nb(String.format("{0}",vb.id))?(la=this.nbb.J(String.format("{0}",vb.id)),this.nbb.remove(String.format("{0}",vb.id)),this.fsd.push(vb)):la=hc.a.DJ(vb);cb=this.Taa.nb(la)}if(!cb)return a.ULS.sendTraceTag(593761364,389,15,"NodeEventCollection is empty."),this.UYk(),null;cb=this.Taa.J(la);this.Taa.remove(la);this.Dac=0<this.Taa.count;a.ULS.sendTraceTag(593761363,389,100,"Consuming new event for node {0} of kind {1}.",
la,cb);return new Qd(cb,vb,la)}SSn(la){this.Fwb=la}b5k(){if(!this.Fwb)return null;for(var la=0;la<this.Fwb.length;la++){var cb=this.Fwb.J(la);cb=hc.a.DJ(cb.node);if(this.Taa.nb(cb))return null}la=this.Fwb;this.Fwb=null;return la}lZk(){this.Fwb=null}xCo(){this.w9=!0}vMm(la){return this.Taa.nb(la.id.toString())}}Object(e.a)(yd,"NodeEventsCollection",null,[356]);var Le=c(1503),gf=c(1424),xh=c(290),Qg=c(113);class Ng extends gf.a{constructor(la,cb,vb,ec,xc,ad,Zd,pe,Td,Ie,We){super();this.Jnd=new Le.a;
this.Zab=!1;this.Cuc=null;this.dja=(Vf,tf)=>{(Vf=tf.node)&&this.h8a(Vf)&&(a.ULS.sendTraceTag(40253400,389,100,"New paragraph Connect event."),hc.a.Ato(Vf,this.bma.w9,this.PUb,this.Aik)&&(this.bma.$ce(Vf,0),this.SFj(Vf)));this.bma.w9&&this.bba.Pnb(Vf)};this.ZTi=(Vf,tf)=>{Vf=tf.node;this.bma.OPb(String.format("{0}",Vf.id),hc.a.DJ(Vf))};this.OMb=(Vf,tf)=>{(Vf=tf.node)&&this.h8a(Vf)&&(a.ULS.sendTraceTag(40253401,389,100,"New paragraph Disconnect event."),this.bma.w9&&this.bma.$ce(Vf,3));this.bma.w9&&
this.bba.dXi(Vf,3)};this.TY=(Vf,tf)=>{Vf=tf.node;tf=tf.property;Vf&&this.nWj.has(tf)&&this.h8a(Vf)&&(a.ULS.sendTraceTag(40253402,389,100,"New paragraph Modified event."),this.bma.w9&&(this.bma.$ce(Vf,2),tf===sa.a.tj&&this.SFj(Vf)));this.bma.w9&&tf===sa.a.Wc&&this.bba.dXi(Vf,2)};this.$Ti=(Vf,tf)=>{(Vf=tf.node)&&fb.ParagraphReader.Xb(Vf)&&!this.huc.has(Vf)&&!this.EAe.has(Vf)&&(this.huc.add(Vf),this.QY())};this.fXi=(Vf,tf)=>{a.ULS.sendTraceTag(51389214,389,100,"Paragraph load event.");(Vf=tf.node)&&
this.Je.iln(Vf)};this.TTf=()=>{this.I$c()?this.lN():this.Zab&&!this.bma.w9&&this.lAa()};this.yC=cb;this.bma=vb;this.Aik=Qg.b(ec.Lfe);this.PUb=la.$("AugLoopOperationsAreEnabled");this.Je=xc;this.bba=ad;this.rC=Zd;this.Ib=pe;this.Un=Td;this.$F=Ie;this.huc=new Set;this.EAe=new Set;We.nra(this,7);this.nWj=new Set([Xc.a.wo,Xc.a.bold,Xc.a.italic,Xc.a.underline,Xc.a.font,Xc.a.fontSize,Xc.a.fontColor,vd.a.capitalization,Xc.a.Kh,Xc.a.Sn,sa.a.A5,sa.a.XY,sa.a.Ui,sa.a.z5,sa.a.WY,sa.a.ta,sa.a.ya,sa.a.xa,sa.a.listID,
sa.a.hN,sa.a.ee,sa.a.nja,sa.a.vu,sa.a.tj])}get index(){return 7}get C2c(){return this.Cuc}set C2c(la){this.Cuc=la;this.bba.bYf=la?()=>{this.Cuc()}:null}init(){this.I$c()&&this.lN();this.bma.Hqh(this.TTf)}lN(){this.yC?(this.Zab=!0,this.yC.ju(this.dja),this.yC.rO(this.ZTi),this.yC.Vw(this.OMb),this.yC.Eo(this.TY),this.yC.prh(this.fXi),this.yC.Hxk(this.$Ti)):a.ULS.sendTraceTag(39403912,389,10,"RegisterEventHandlers: ParagraphNode event handlers can't be null.")}lAa(){this.yC?(this.Zab=!1,this.yC.uV(this.dja),
this.yC.w$(this.ZTi),this.yC.Lja(this.OMb),this.yC.jS(this.TY),this.yC.Ybj(this.fXi),this.yC.E1n(this.$Ti)):a.ULS.sendTraceTag(39403913,389,10,"UnregisterEventHandlers: ParagraphNode event handlers can't be null.")}fXd(la){la&&this.Jnd.add(la.id,la.ja(sa.a.tj,0))}SFj(la){this.Jnd.nb(la.id)?(this.bba.a0o(ea.a.Kje,la,this.Jnd.J(la.id)),this.Jnd.remove(la.id)):(this.bba.fZk(ea.a.Kje),this.C2c&&this.C2c())}h8a(la){const cb=Q.App.za.jb.rc;return!!cb&&cb.mv&&!!cb.ed&&!!cb.ed.Mc&&!!la&&!!la.Mc&&la.Mc.id===
cb.ed.Mc.id}run(){if(0!==this.huc.size){var la=[];for(const cb of this.huc)la.push(cb),this.EAe.add(cb),100<=la.length&&(this.kXh(la),la=[]);0<la.length&&this.kXh(la);this.huc.clear()}}kXh(la){const cb=new ka.a(4,1,500,()=>{for(const vb of la)this.EAe.delete(vb),this.cUo(vb)},158);this.Ib.Wb(cb)}cUo(la){var cb=this.Un.kQa(la,0,ec=>this.dvo(ec.intent));if(0<cb.count)for(const ec of cb){cb=this.bba.Cbm(ec.intent.id);var vb=la.boa;const xc=fb.ParagraphReader.tR(la);ec.end<ec.Ec||(vb=xh.a.OKc(xc,vb,ec.Ec,
ec.end-ec.Ec,ec.Ec,ec.end-ec.Ec,la),this.$F.G7f(la.Mc,cb,vb))}}dvo(la){return!!la&&this.rC.vlb(la)&&!!la.content}I$c(){return!this.Zab&&this.bma.w9}}Object(e.a)(Ng,"ParagraphNodeEventHandler",gf.a,[352]);var zg=c(1028),Jf=c(399),fc=c(454),Fc=c(103);class id extends fc.a{constructor(){super();this.H_=Object.assign(new Fc.a,{T_:id.getTypeName(),B_:id.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(e.a)(id,
"DeltaUpdateOperation",fc.a,[]);var ld=c(371);class hd{constructor(){this.referencedPath=null}}Object(e.a)(hd,"ItemReference",null,[]);class Be extends ld.a{constructor(){super();this.op=this.deltas=this.delta=this.parentPath=null}}Object(e.a)(Be,"ItemWithPath",ld.a,[]);var Ke=c(998);class Me extends Ke.a{constructor(){super();this.prevParentPath=null;this.H_=Object.assign(new Fc.a,{T_:Me.getTypeName(),B_:Me.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext",
"AugLoop_Core_Operation"]}}Object(e.a)(Me,"MoveOperation",Ke.a,[]);var jf=c(444);class kg extends jf.a{constructor(){super();this.selectedRanges=null;this.H_=Object.assign(new Fc.a,{T_:kg.getTypeName(),B_:kg.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(e.a)(kg,"SelectionSignal",jf.a,[]);class sf extends kg{constructor(){super();this.content=null;this.H_=Object.assign(new Fc.a,{T_:sf.getTypeName(),B_:sf.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionContentSignal"}static getBaseTypes(){return["AugLoop_Text_SelectionSignal",
"AugLoop_Signals_Signal"]}}Object(e.a)(sf,"SelectionContentSignal",kg,[]);class Wg{constructor(){this.range=this.tileReference=null}}Object(e.a)(Wg,"TextTileRange",null,[]);var Db=c(1691),Gb=c(370),$c=c(36),Bd=c(17);class we{constructor(la,cb,vb,ec,xc,ad,Zd,pe){this._augLoopRuntimeManager=this.Jld=null;this.ZSe=!1;this.sma=this.dJe=this.Kwd=null;this.$Rg=2E3;this.BFl=()=>{if(Q.App.lostSession||Jf.SessionStatusManager.instance&&Jf.SessionStatusManager.instance.Jo)wb.a.getAugLoopRuntimeManager().closeSession(),
a.ULS.sendTraceTag(512623445,389,15,"TileView.firePreparedEventsForOperations: Closing AL session"),this.Ib.ff(this.Jld);this.ti.ie(()=>{var Td;const Ie=bb.a.instance.w4;this.QB()&&this.R5n();for(this.eEc.reset();this.vYa.Dac&&!this.eEc.dnb();){let tf;tf=this.vYa.a5k();if(!tf||!tf.graphNode){a.ULS.sendTraceTag(41719901,389,15,"FirePreparedEventsForOperations: nodeEvent or nodeEvent.GraphNode is null.");this.eEc.update();continue}if(!this.jto(tf)){a.ULS.sendTraceTag(41719902,389,50,"FirePreparedEventsForOperations: Node with id {0} was not processed.",
tf.graphNode.id);this.eEc.update();continue}const yf=tf.graphNode.id.toString();var We=-1,Vf=!0;Ie&&Bd.SelectionEditor.Ze(Ie)&&yf==Ie.node.id.toString()&&(We=Ie.cpBegin,Vf=!1);let lf=null;if(this.$yb.contains(yf))switch(tf.u1c){case 3:this.$yb.remove(yf);lf=3;break;default:lf=tf.u1c}else switch(tf.u1c){case 0:case 1:this.$yb.add(yf);lf=0;break;case 2:this.$yb.add(yf);lf=0;break;case 3:this.$yb.remove(yf);lf=3;break;default:lf=tf.u1c}if(null!=lf){We=this.Mdi(tf.graphNode,tf.fullPath,lf,We,Vf);if(4==
lf||5==lf){if(We.prevParentPath.join()!==We.parentPath.join()){Vf=Object.assign(new Ga.a,{parentPath:We.prevParentPath,items:We.items});const Rk=Object.assign(new Ra.a,{parentPath:We.parentPath,items:We.items,prevId:We.prevId,nextId:We.nextId});yf!==We.prevId&&yf!==We.nextId||a.ULS.sendTraceTag(512231646,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",lf,yf,We.prevId,We.nextId,tf.graphNode.type);this._augLoopRuntimeManager.submitOperation(Object.assign(new Gb.a,
{operation:Vf}));this._augLoopRuntimeManager.submitOperation(Object.assign(new Gb.a,{operation:Rk}));14===tf.graphNode.type&&this.vjj(tf.graphNode,We.parentPath).forEach(hm=>{this._augLoopRuntimeManager.submitOperation(Object.assign(new Gb.a,{operation:hm}))})}}else this._augLoopRuntimeManager.submitOperation(Object.assign(new Gb.a,{operation:We}));if(this.lhd&&this.sma&&this.sma[0]==yf)switch(lf){case 3:this.sma=null;break;case 0:case 1:case 2:case 4:case 5:this.sma[1]=null===(Td=this.sxb.JGb(tf.graphNode))||
void 0===Td?void 0:Td.$Pc(tf.graphNode)}a.ULS.sendTraceTag(40776388,389,100,"FirePreparedEventsForOperations: Operation with OpType {0} submitted for tileId {1}",va.a.getTypeNameFor(We),yf);switch(lf){case 0:case 4:case 5:this.Je.ovn(tf.graphNode);break;case 3:this.Je.pvn(tf.graphNode,We.parentPath.join("\\"))}}this.eEc.update()}(Td=this.vYa.b5k())&&this.Bdj(Td)},"TV:FPEFO")};this.Sqa=(Td,Ie)=>{var We;if(Ie.yl&&Ie.yl.length){if(this.lhd)if(Td=hc.a.J6l(Ie.yl),!Td)this.sma=null;else if(!this.sma||this.sma[0]!=
Td.id.toString()){const Vf=this.vYa.vMm(Td)?null:null===(We=this.sxb.JGb(Td))||void 0===We?void 0:We.$Pc(Td);this.sma=[Td.id.toString(),Vf]}this.ZSe&&this.vYa.SSn(Ie.yl.lb)}};this.Ca=la;this.vYa=cb;this.Ib=vb;this.eEc=ec;this.PWj=this.Ca.$("AugLoopOperationsAreEnabled");this.$yb=new fa.a(Ka.a.ih());this.Je=xc;this.ti=ad;this.sxb=Zd;this.hb=pe;this.lhd=this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoreplaceIsEnabled",!1);this.hb.Ww(this.Sqa);hc.a.ml().then(()=>{this._augLoopRuntimeManager=
wb.a.getAugLoopRuntimeManager();y.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacBox4AugLoopTimeBasedYieldTraversalSettings");this.Ca.$("AugLoopAnnotationsIsEnabled")&&this._augLoopRuntimeManager.setAnnotationResultCallback(Object.assign(new Db.a,{handler:Td=>{this.Je.UCk(Td)}}));this.PWj&&this.vYa.xCo();this.pDo()}).catch(()=>{});this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.IncreasedIntervalForDelayedCritiquesIsEnabled",!1)&&(this.$Rg=5E3)}R5n(){const la=this.Je.Ptc.entries();
for(let cb=0;cb<this.Je.Ptc.size;cb++){const vb=la.next();y.AFrameworkApplication.oe("gi204158;ef1e2812");Date.now()-vb.value[1].time>=this.$Rg&&this.Je.KSc(vb.value[1].annotation,!0,Ra.a.getTypeName(),!1)}}jto(la){return 3===la.u1c||hc.a.Brj(la.graphNode)}pDo(){!this.Jld&&this.vYa.w9&&(this.Jld=new ka.a(4,2,this.Ca.mc("NodeEventsFiringInterval",500),this.BFl,131),this.Ib.Wb(this.Jld))}vjj(la,cb){var vb,ec=[];const xc=Sd.GraphIterator.eb(la),ad=xc.Wp();for(var Zd=0;Zd<ad;Zd++){let pe=xc.rF(Zd);11===
pe.type&&(pe=$c.OutlineElementNavigator.Ee(xc));const Td=pe.id.toString(),Ie=null===(vb=this.sxb.JGb(pe))||void 0===vb?void 0:vb.TCb(pe);ec.push(Object.assign(new ld.a,{body:Ie,id:Td,revId:hc.a.Mvf(pe)}));xc.jd(la.type)}cb.push(la.id.toString());vb=[];vb.push(Object.assign(new Ra.a,{parentPath:cb.slice(),items:ec,prevId:null}));for(ec=0;ec<ad;ec++)Zd=xc.rF(ec),11===Zd.type&&(Zd=$c.OutlineElementNavigator.Ee(xc)),0<xc.Wp()&&(vb=vb.concat(this.vjj(Zd,cb))),xc.jd(la.type);cb.pop();return vb}oQa(la){return la.split("\\").slice(0,
-1)}Mdi(la,cb,vb,ec=-1,xc=!0){var ad;let Zd=null,pe=null;const Td=la.id.toString();var Ie=null;3!==vb&&(Ie=hc.a.wPk(la));if(Ie)for(let We=0;We<Ie.length;We++)if(Ie[We]===Td){pe=We+1<Ie.length?Ie[We+1]:null;Zd=We?Ie[We-1]:null;break}Td!==Zd&&Td!==pe||a.ULS.sendTraceTag(512231645,389,10,"Creating operation with circular reference. NodeEventKind: {0}, tileId: {1}, prevTileId: {2}, nextTileId: {3}, nodeType: {4}",vb,Td,Zd,pe,la.type);Ie=null===(ad=this.sxb.JGb(la))||void 0===ad?void 0:ad.TCb(la,ec,xc);
ec=[Object.assign(new ld.a,{body:Ie,id:Td,revId:hc.a.Mvf(la)})];switch(vb){case 0:case 1:return Object.assign(new Ra.a,{parentPath:this.oQa(cb),items:ec,prevId:Zd,nextId:pe});case 4:return Object.assign(new Me,{parentPath:this.oQa(hc.a.DJ(la)),prevParentPath:this.oQa(cb),items:ec,prevId:Zd,nextId:pe});case 5:return vb=this.vYa.XNl(Td),Object.assign(new Me,{parentPath:this.oQa(null!==vb&&void 0!==vb?vb:hc.a.DJ(la)),prevParentPath:this.oQa(cb),items:ec,prevId:Zd,nextId:pe});case 2:return Object.assign(new ta.a,
{parentPath:this.oQa(cb),items:ec});case 3:return Object.assign(new Ga.a,{parentPath:this.oQa(cb),items:ec});default:return a.ULS.sendTraceTag(42084322,389,15,"Submitted unknown operation for NodeEventKind ${0}, tileId {1}",vb,Td),Object.assign(new Ke.a,{parentPath:this.oQa(cb),items:ec,prevId:Zd,nextId:pe})}}Oim(la){return this.sma&&this.sma[0]===la?this.sma[1]:null}ffo(la){var cb;if(!this.lhd)return a.ULS.sendTraceTag(545552581,389,10,"sendTile: autoreplace is not enabled"),!1;if(!hc.a.Brj(la))return!1;
const vb=la.id.toString();var ec=this.$yb.contains(vb)?2:0;ec=this.Mdi(la,hc.a.DJ(la),ec);this._augLoopRuntimeManager.submitOperation(Object.assign(new Gb.a,{operation:ec}));this.$yb.add(vb);this.sma=[vb,null===(cb=this.sxb.JGb(la))||void 0===cb?void 0:cb.$Pc(la)];return!0}Sdo(la,cb){var vb;if(this.lhd){var ec=la.id.toString(),xc=this.oQa(hc.a.DJ(la));cb=[Object.assign(new Be,{id:ec,revId:hc.a.Mvf(la),parentPath:xc,delta:cb})];xc=Object.assign(new id,{parentPath:xc,items:cb});this._augLoopRuntimeManager.submitOperation(Object.assign(new Gb.a,
{operation:xc}));a.ULS.sendTraceTag(545552583,389,50,"sendDeltaOperation: tileId {0}",ec);this.sma=[ec,null===(vb=this.sxb.JGb(la))||void 0===vb?void 0:vb.$Pc(la)]}else a.ULS.sendTraceTag(545552582,389,10,"sendDeltaOperation: autoreplace is not enabled")}sHk(la,cb){if(la.tileReference.referencedPath.length!==cb.tileReference.referencedPath.length||la.range.start!==cb.range.start||la.range.length!==cb.range.length)return!1;for(let vb=0;vb<la.tileReference.referencedPath.length;vb++)if(la.tileReference.referencedPath[vb]!==
cb.tileReference.referencedPath[vb])return!1;return!0}nHk(la,cb){if(la.selectedRanges.length!==cb.selectedRanges.length||la.content!==cb.content)return!1;for(let vb=0;vb<la.selectedRanges.length;vb++)if(!this.sHk(la.selectedRanges[vb],cb.selectedRanges[vb]))return!1;return!0}Bdj(la){var cb;if(la){var vb=new lb.a,ec="";for(let Zd=0;Zd<la.length;Zd++){var xc=la.J(Zd),ad=(null===(cb=this.sxb.JGb(xc.node))||void 0===cb?void 0:cb.TCb(xc.node)).content;ec+=ad;ad=xc.cpBegin<ad.length?xc.cpBegin:-1;ad=Object.assign(new qa.a,
{start:ad,length:xc.cpEnd-xc.cpBegin});const pe=xc.node.id.toString();xc=this.oQa(hc.a.DJ(xc.node));xc.push(pe);vb.add(Object.assign(new Wg,{range:ad,tileReference:Object.assign(new hd,{referencedPath:xc})}))}la=Object.assign(new sf,{selectedRanges:vb.toArray(),content:ec});this.dJe&&this.nHk(la,this.dJe)||(cb=this.Kwd?this.Kwd:ua.a.create().toString(),vb=[Object.assign(new ld.a,{body:la,id:cb})],this.Kwd?cb=Object.assign(new ta.a,{parentPath:["session","doc"],items:vb}):(this.Kwd=cb,cb=Object.assign(new Ra.a,
{parentPath:["session","doc"],items:vb})),this._augLoopRuntimeManager.submitOperation(Object.assign(new Gb.a,{operation:cb})),this.dJe=la)}}Qno(la){(this.ZSe=la)?this.ldj():this.vYa.lZk()}ldj(){this.Bdj(this.hb.ib.lb)}QB(){return!!y.AFrameworkApplication.K&&y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}}Object(e.a)(we,"TileView",null,[355]);var He=c(41),Se=c(52);class jg{constructor(la){Se.a.assign(jg,this,la)}static getTypeName(){return"AugLoop_Table_TableRow"}static getBaseTypes(){return[]}static typeGuard(la){return Se.a.matchesTypesFor(la,
[jg.getTypeName()])}}jg.H_={T_:jg.getTypeName(),B_:jg.getBaseTypes()};class Hi{constructor(la){Se.a.assign(Hi,this,la)}static getTypeName(){return"AugLoop_Table_TableCell"}static getBaseTypes(){return[]}static typeGuard(la){return Se.a.matchesTypesFor(la,[Hi.getTypeName()])}}Hi.H_={T_:Hi.getTypeName(),B_:Hi.getBaseTypes()};class ii{constructor(la){Se.a.assign(ii,this,la)}static getTypeName(){return"AugLoop_Table_Table"}static getBaseTypes(){return[]}static typeGuard(la){return Se.a.matchesTypesFor(la,
[ii.getTypeName()])}}ii.H_={T_:ii.getTypeName(),B_:ii.getBaseTypes()};class Zh{constructor(la){Se.a.assign(Zh,this,la)}static getTypeName(){return"AugLoop_Table_WordTable"}static getBaseTypes(){return["AugLoop_Table_Table"]}static typeGuard(la){return Se.a.matchesTypesFor(la,[Zh.getTypeName()])}}Zh.H_={T_:Zh.getTypeName(),B_:Zh.getBaseTypes()};class vg{constructor(la){Se.a.assign(vg,this,la)}static getTypeName(){return"AugLoop_Table_WordOOXmlTableTile"}static getBaseTypes(){return["AugLoop_Table_WordTable",
"AugLoop_Table_Table"]}static typeGuard(la){return Se.a.matchesTypesFor(la,[vg.getTypeName()])}}vg.H_={T_:vg.getTypeName(),B_:vg.getBaseTypes()};var vf;(function(la){la[la.Top=0]="Top";la[la.Center=1]="Center";la[la.Bottom=2]="Bottom"})(vf||(vf={}));var Lf;(function(la){la[la.none=0]="none";la[la.firstRow=32]="firstRow";la[la.lastRow=64]="lastRow";la[la.firstCol=128]="firstCol";la[la.lastCol=256]="lastCol";la[la.Inp=512]="noHBand";la[la.Onp=1024]="noVBand";la[la.nwCell=160]="nwCell";la[la.neCell=
288]="neCell";la[la.swCell=192]="swCell";la[la.seCell=320]="seCell";la[la.Zil=1184]="defaultLook"})(Lf||(Lf={}));Object(e.b)("TableLookFlags",Lf);class Cg{TCb(la){if(la)switch(la.type){case 14:return this.qfl(la);case 15:return new jg;case 16:return this.pfl(la)}else a.ULS.sendTraceTag(524149331,389,10,"ConvertNodeToTile: Node can't be null.")}qfl(la){var cb=la.tG||[];let vb=0;for(let ec=0;ec<cb.length;ec++)vb+=cb[ec];cb=cb.map((ec,xc)=>({columnId:xc.toString(),widthPercent:0!=vb?100*ec/vb:0}));return new Zh({columnDefs:cb,
tableLook:la.properties.ja(sa.a.tableLook,Lf.Zil),complexTable:la.properties.ja(sa.a.complexTable,!1),floatingTable:la.properties.ja(sa.a.vyi,!1)})}pfl(la){return new Hi({rowspan:la.properties.ja(sa.a.rowSpan,1),colspan:la.properties.ja(sa.a.colSpan,1),borderInfo:{topBorder:{color:la.properties.ja(sa.a.SRb,0),size:la.properties.ja(sa.a.Zmc,4),style:la.properties.ja(sa.a.drb,"single")},leftBorder:{color:la.properties.ja(sa.a.QRb,0),size:la.properties.ja(sa.a.Xmc,4),style:la.properties.ja(sa.a.brb,
"single")},rightBorder:{color:la.properties.ja(sa.a.RRb,0),size:la.properties.ja(sa.a.Ymc,4),style:la.properties.ja(sa.a.crb,"single")},bottomBorder:{color:la.properties.ja(sa.a.PRb,0),size:la.properties.ja(sa.a.Wmc,4),style:la.properties.ja(sa.a.arb,"single")}},verticalAlignment:la.properties.ja(sa.a.nJa,vf.Top),ghostCell:la.properties.ja(sa.a.ghostCell,!1),renderCell:la.properties.ja(sa.a.renderCell,!1),skippedCell:la.properties.ja(sa.a.skippedCell,!1),fillColor:la.properties.ja(Xc.a.UK,0),verticalMerge:la.properties.ja(He.a.vMerge,
null)})}$Pc(la){return null===la||void 0===la?void 0:la.properties}}Object(e.a)(Cg,"TableElementNodeToTileConverter",null,[354]);class bg{constructor(la,cb,vb){this.sm=cb;this.Xza=vb;this.tNd=!1;this.Cuc=null;this.YYi=(ec,xc)=>{this.bza(xc.node,0)};this.UYi=(ec,xc)=>{ec=xc.node;this.Xza.OPb(ec.id.toString(),hc.a.DJ(ec))};this.ZYi=(ec,xc)=>{this.bza(xc.node,3)};this.Q8d=(ec,xc)=>{this.bza(xc.node,2)};this.aZi=(ec,xc)=>{this.bza(xc.node,0)};this.bZi=(ec,xc)=>{this.bza(xc.node,3)};this.$Yi=(ec,xc)=>
{ec=xc.node;this.Xza.OPb(ec.id.toString(),hc.a.DJ(ec))};this.R8d=(ec,xc)=>{this.bza(xc.node,2)};this.WYi=(ec,xc)=>{this.bza(xc.node,0)};this.VYi=(ec,xc)=>{ec=xc.node;this.Xza.OPb(ec.id.toString(),hc.a.DJ(ec))};this.XYi=(ec,xc)=>{this.bza(xc.node,3)};this.O8d=(ec,xc)=>{var ad;ec=xc.node;if(xc.property===sa.a.ghostCell){if(xc=ec.hg?ec:null===(ad=ec.iya)||void 0===ad?void 0:ad.AM){ad=Sd.GraphIterator.eb(xc);var Zd=ad.Wp();for(var pe=0;pe<Zd;pe++){ad.rF(pe);var Td=$c.OutlineElementNavigator.Ee(ad);this.Xza.OPb(Td.id.toString(),
String.format("{0}\\{1}",hc.a.DJ(xc),Td.id));this.bza(Td,4);ad.jd(16)}}}else if(xc.property===Xc.a.gf){xc=Sd.GraphIterator.eb(ec);ad=xc.Wp();let Ie=null;Zd=[];for(pe=0;pe<ad;pe++){xc.rF(pe);Td=$c.OutlineElementNavigator.Ee(xc);this.Xza.Fao(Td.id.toString(),String.format("{0}\\{1}",hc.a.DJ(ec),Td.id));if(14!==Td.type){if(Ie=hc.a.DJ(Td))this.Xza.OPb(Td.id.toString(),Ie),this.bza(Td,5)}else Zd.push(Td);xc.jd(16)}Ie&&Zd.forEach(We=>{this.Xza.OPb(We.id.toString(),String.format("{0}\\{1}",Ie.split("\\").slice(0,
-1).join("\\"),We.id));this.bza(We,5)})}this.bza(ec,2)};this.TTf=()=>{this.I$c()?this.lN():this.tNd&&!this.Xza.w9&&this.lAa()};this.PUb=la.$("AugLoopOperationsAreEnabled")}get C2c(){return this.Cuc}init(){this.I$c()&&this.lN();this.Xza.Hqh(this.TTf)}lN(){const {lyj:la,vle:cb,ayj:vb}=this.D9h();if(la&&cb&&vb){this.tNd=!0;var ec=this.UYi,xc=this.ZYi,ad=this.Q8d;la.ju(this.YYi);la.rO(ec);la.Vw(xc);la.Eo(ad);ec=this.$Yi;xc=this.bZi;ad=this.R8d;cb.ju(this.aZi);cb.rO(ec);cb.Vw(xc);cb.Eo(ad);ec=this.VYi;
xc=this.XYi;ad=this.O8d;vb.ju(this.WYi);vb.rO(ec);vb.Vw(xc);vb.Eo(ad)}else a.ULS.sendTraceTag(524149329,389,10,"RegisterEventHandlers: TableNode event handlers can't be null.")}lAa(){const {lyj:la,vle:cb,ayj:vb}=this.D9h();if(la&&cb&&vb){this.tNd=!1;var ec=this.UYi,xc=this.ZYi,ad=this.Q8d;la.uV(this.YYi);la.w$(ec);la.Lja(xc);la.jS(ad);ec=this.$Yi;xc=this.bZi;ad=this.R8d;cb.uV(this.aZi);cb.w$(ec);cb.Lja(xc);cb.jS(ad);ec=this.VYi;xc=this.XYi;ad=this.O8d;vb.uV(this.WYi);vb.w$(ec);vb.Lja(xc);vb.jS(ad)}else a.ULS.sendTraceTag(524149330,
389,10,"UnregisterEventHandlers: TableNode event handlers can't be null.")}bza(la,cb){la&&this.h8a(la)&&this.Xza.w9&&this.PUb&&this.Xza.$ce(la,cb)}D9h(){return{lyj:this.sm.Ue(14),vle:this.sm.Ue(15),ayj:this.sm.Ue(16)}}h8a(la){const cb=Q.App.za.jb.rc;return!!cb&&cb.mv&&!!cb.ed&&!!cb.ed.Mc&&!!la&&!!la.Mc&&la.Mc.id===cb.ed.Mc.id}I$c(){return!this.tNd&&!!this.Xza.w9}}Object(e.a)(bg,"TableNodeEventHandler",null,[352]);class eg{constructor(la,cb){this.K0i=la;this.uHo=cb}JGb(la){return la?14===la.type||
15===la.type||16===la.type?this.uHo:12===la.type?this.K0i:null:null}}Object(e.a)(eg,"NodeToTileConverterHolder",null,[351]);var sh=c(372);class nh{get name(){return"Box4.AugmentationLoop"}wc(la){this.W=la;const cb=this.W.resolve("Common.IAppSettingsManager"),vb=cb.$("AugLoopTaskUseTimeBasedYieldStrategy"),ec=new yd,xc=vb?new ba.a(cb.mc("AugLoopTaskAllowedRunTimeBeforeYielding",10),H.a.$e):new Y(cb.mc("AugLoopTaskNodesToRunBeforeYielding",10));this.W.ia("Common.ICpuMeter",()=>R.a.instance).ha();this.W.ia("Box4.AugmentationLoop.AugmentationLoopStateManager",
()=>new hb).as("Box4.AugmentationLoop.IAugmentationLoopStateManager").ha();this.W.ia("Box4.AugmentationLoop.ParagraphNodeEventHandler",()=>new Ng(cb,Q.App.si.Il.Ue(12),ec,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IPersistedAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),y.AFrameworkApplication.lc,this.W.resolve("Box4.Intent.IIntentRangeEditor"),
this.W.resolve("Box4.IIntelligenceEditor"),this.W.resolve("Box4.Graph.IGraphTransactionManager"))).as("Box4.AugmentationLoop.INodeEventHandler<Box4.AParagraphNode>").ha();hc.a.rie()&&this.W.ia("Box4.AugmentationLoop.TableNodeEventHandler",()=>new bg(cb,Q.App.si.Il,ec)).ha();this.W.ia("Common.App.AugmentationLoop.SDX.SdxPaneSuppressionManager",()=>new O).ha();this.W.ia("Box4.AugmentationLoop.IFormattingExtractor",()=>new se(this.W.resolve("Common.IAppSettingsManager"),this.W.Oa("Box4.IFeatureHelper"),
this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IParagraphIndentationReader"),this.W.resolve("Box4.Styles.IWACStyleReader"))).ha();this.W.ia("Box4.AugmentationLoop.IAnnotationPolicies",()=>new ea.a(new W.a(()=>Q.App.za.jb.Zc.xd),this.W.resolve("Box4.Intent.IIntentRangeEditor"))).ha();this.W.ia("Box4.AugmentationLoop.IPersistedAnnotationStorage",()=>new qc(this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.IIntelligenceReader"),this.W.resolve("Box4.IIntelligenceEditor"),this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),
new W.a(()=>Q.App.za.jb.Zc.xd),la.resolve("Box4.IFeatureHelper"))).ha();const ad=this.W.resolve("IRoamingDictionary");this.W.ia("Box4.AugmentationLoop.IAnnotationStorage",()=>new Eb(this.W.resolve("Common.IAppSettingsManager"),this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.Intent.IIntentRangeEditor"),new W.a(()=>Q.App.za.jb.Zc.xd),y.AFrameworkApplication.lc,this.W.Oa("Box4.IIntelligenceReader"),this.W.Oa("Box4.IIntelligenceEditor"),this.W.Oa("Box4.AugmentationLoop.IAnnotationPolicies"),this.W.Oa("Box4.AugmentationLoop.IPersistedAnnotationStorage"),
la.resolve("Box4.IFeatureHelper"),sh.a.instance,()=>{try{return wb.a.getAugLoopRuntimeManager()}catch(Zd){return a.ULS.sendTraceTag(50935320,389,10,"Unable to GetAugLoopRuntimeManager, most likely due to al bundle not being loaded: {0}",Zd),null}},ad)).ha();this.W.ia("Box4.AugmentationLoop.INodeToTileConverterHolder",()=>new eg(new zg.a(this.W.resolve("Box4.AugmentationLoop.IFormattingExtractor")),new Cg)).ha();this.W.ia("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>",
()=>new we(cb,ec,y.AFrameworkApplication.lc,xc,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),this.W.resolve("Box4.ISelectionManager"))).ha();a.ULS.sendTraceTag(39966347,389,50,"TileView<TextTile, AParagraphNode> registered.");this.W.ia("Box4.AugmentationLoop.IUtilsWrapper",()=>new lc).ha();this.W.ia("Box4.AugmentationLoop.IAlFactoryWrapper",()=>new bc).ha()}init(){if(y.AFrameworkApplication.nG.BootFailed)a.ULS.sendTraceTag(512624089,
389,15,"Cannot initialize Box4 Augmentation Loop package: Boot Failure");else if(y.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled")){a.ULS.sendTraceTag(35190237,389,50,"Initializing Box4 Augmentation Loop package.");const la=new ya(this.W.resolve("Common.IAppSettingsManager"),y.AFrameworkApplication.He,Q.App.g6,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),V.a.instance,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage")),cb=new Z;this.W.register(338,"Box4.AugmentationLoop.IAlSessionLifeEventNotifier").ha().y1o(()=>
cb);y.AFrameworkApplication.oe("b8afb343;bjdjj400");y.AFrameworkApplication.oe("72af9564;82jf1647");const vb=hc.a.d2m(this.W.resolve("Common.IDynamicScriptLoaderProvider").dA,this.W.resolve("Common.App.OAuth.IOAuthManager"),la,this.W.resolve("Common.ISharedDependencyLoader"),cb);this.W.ia("Box4.AugmentationLoop.RuntimeManagerInitializationTracker",()=>new ib(vb)).ha();this.W.resolve("Box4.AugmentationLoop.ParagraphNodeEventHandler").init();hc.a.rie()&&this.W.resolve("Box4.AugmentationLoop.TableNodeEventHandler").init();
this.W.resolve("Box4.IIntelligenceReader").init();this.W.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>")}}dispose(){}static main(la){z.a.instance.Gc(new nh,0,la);a.ULS.sendTraceTag(35190238,389,50,"Box4 Augmentation Loop package registered.")}}Object(e.a)(nh,"Box4AugmentationLoopPackage",null,[1,2]);var Sh=c(611),Xk=c(43),rl=c(12),sl=c(408),Xf=c(1158);class Dl{constructor(la,cb,vb,ec=null,xc=null,ad=null){this.BM=new Xf.a(cb,ec,xc,ad);this.Lb=
la;this.Oc=vb}get type(){return this.BM.type}get id(){return this.BM.id}get intent(){return this.BM.intent}vf(la){return new Dl(la,this.type,this.Oc,this.id,this.intent,this.BM.vya)}toString(){return String.format("Core = [{0}], IsStart = {1}",this.BM,this.Oc)}}Object(e.a)(Dl,"IntentObject",null,[166]);var rg=c(476),Hm=c(152),pf=c(250);class vh{constructor(){this.qvc=new Hm.a}OBd(la,cb,vb,ec,xc=null,ad=null,Zd=null){la=la.RX(cb,la.qa.UOo(cb));la.Qj||(la.Qj=new rg.a(la));la.Qj.add(new Dl(la,vb,ec,
xc,ad,Zd));la.t4a=!0}yaj(la){return la.Lb&&la.Lb.Qj&&la.Lb.Qj.V6c(cb=>cb===la,[la.type])?!0:!1}zaj(la,cb){if(la.type===cb.type&&la.Oc&&!cb.Oc&&la.Lb&&la.Lb.Qj&&la.Lb.Qj.contains(la)&&cb.Lb&&cb.Lb.Qj&&cb.Lb.Qj.contains(cb)){var vb=[la.type];la.Lb.Qj.V6c(ec=>ec===la,vb);cb.Lb.Qj.V6c(ec=>ec===cb,vb)}}r2o(la,cb,vb){if(!cb)return!1;vb=new Ja.a([vb]);for(let ec=0;ec<la.length;ec++){const xc=la.J(ec);if(!xc.Qj)continue;let ad=!0;vb.JVa(xc.Qj,void 0,Zd=>{Zd.id&&cb.equals(Zd.id)&&(ad=!1)});if(!ad)return!1}return!0}wGn(la,
cb,vb,ec){let xc=null,ad=null;cb=new Ja.a([cb]);const Zd=la.qa;for(let pe=0;pe<Zd.length;pe++){const Td=Zd.J(pe);if(!Td.Qj)continue;let Ie=!0;cb.JVa(Td.Qj,void 0,(We,Vf)=>{if(Vf){var tf=Vf.Lb.cp<vb,yf=We.Lb.cp>ec;tf&&We.Lb.cp<=vb||Vf.Lb.cp>=ec&&yf||(tf&&yf?Ie=!1:tf?xc=We:yf?ad=Vf:this.zaj(Vf,We))}});if(!Ie)return!1}if(xc){if(!this.yaj(xc))return!1;this.OBd(la,vb,xc.type,xc.Oc,xc.id,xc.intent,xc.BM.vya)}if(ad){if(!this.yaj(ad))return!1;this.OBd(la,ec,ad.type,ad.Oc,ad.id,ad.intent,ad.BM.vya)}return!0}lgg(la){let cb;
return y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TestBox4Ops",!1)?!1:({value:cb}=this.qvc.Fc(la.type,cb)).returnValue?cb.lgg(la):!0}fan(la,cb){if(this.lgg(cb)){var vb=cb.id,ec=cb.type,xc=cb.Ec,ad=cb.end;if(({cpEnd:ad}=vh.PJj(la,xc,ad)).returnValue){if(sl.a(ec)){if(!this.r2o(la.qa,vb,ec))return}else if(!this.wGn(la,ec,xc,ad))return;this.OBd(la,xc,ec,!0,vb,cb.intent,cb.BM.vya);this.OBd(la,ad,ec,!1,vb,cb.intent,cb.BM.vya)}}}R3c(la,cb){Q.App.za.zif(la,()=>{const vb=
new Xk.GraphTransaction(2);try{vb.Db(la);const ec=la.sZ();try{const xc=la.f0();try{cb()}finally{xc&&xc.dispose()}}finally{ec&&ec.dispose()}}finally{vb&&vb.dispose()}})}fHa(la,cb){this.R3c(la,()=>{this.fan(la,cb)})}han(la,cb){if(cb.count){var vb=new Wa.a,ec=new pf.a;for(var xc of cb){var ad=xc.value;sl.a(xc.key)||ad.Sc((pe,Td)=>pe.Ec!==Td.Ec?pe.Ec-Td.Ec:pe.end-Td.end);if(vh.w2o(ad))for(var Zd of ad)ad=Zd.end,({cpEnd:ad}=vh.PJj(la,Zd.Ec,ad)).returnValue&&(ad=ad!==Zd.end?new Bb.a(Zd.type,Zd.Ec,ad,Zd.id,
Zd.intent,Zd.BM.vya):Zd,vb.add(ad.Ec),vb.add(ad.end),vh.stk(ec,ad))}la.RMd(vb);la=la.qa;for(vb=0;vb<la.length;vb++){xc=la.J(vb);if(Zd=xc.Qj)for(const Td of cb.keys)Zd.tbj(Td);let pe;({value:pe}=ec.Fc(xc.cp,pe)).returnValue||(pe=null);if(pe){Zd||(Zd=xc.Qj=new rg.a(xc));for(const Td of pe)Zd.add(Td.vf(xc))}xc.t4a=!0}}}YOf(la,cb){const vb=new Hm.a;for(const ec of cb){let xc;({value:xc}=vb.Fc(ec.type,xc)).returnValue||(xc=new lb.a,vb.Z(ec.type,xc));xc.add(ec)}this.R3c(la,()=>{this.han(la,vb)})}lSo(la,
cb,vb){la=la.qa;const ec=new Ja.a([8]);cb===vb&&(vb+=1);for(let xc=0;xc<la.length;xc++){const ad=la.J(xc);ad.Qj&&ec.JVa(ad.Qj,void 0,(Zd,pe)=>{pe&&Math.max(pe.Lb.cp,cb)<Math.min(Zd.Lb.cp,vb)&&this.zaj(pe,Zd)})}}Kog(la,cb,vb){this.R3c(la,()=>{this.lSo(la,cb,vb)})}nSo(la,cb){la=la.qa;for(let vb=0;vb<la.length;vb++){const ec=la.J(vb);ec.Qj&&ec.Qj.tbj(cb)}}AVa(la,cb){this.R3c(la,()=>{this.nSo(la,cb)})}mSo(la,cb,vb){let ec=!1;cb=cb.qa;vb=[vb];for(let xc=0;xc<cb.length;xc++){const ad=cb.J(xc);ad.Qj&&(ec=
ad.Qj.V6c(la,vb)||ec)}return ec}ldd(la,cb,vb){let ec=!1;this.R3c(cb,()=>{ec=this.mSo(la,cb,vb)});return ec}tSd(la,cb,vb,ec){return!la||0>vb||ec>la.characterData.length||vb>ec?new lb.a:this.kQa(la,cb,xc=>Math.max(xc.Ec,vb)<=Math.min(xc.end,ec))}kQa(la,cb,vb){return vh.K1l(la,cb,vb)}static K1l(la,cb,vb){const ec=new lb.a;la=la.qa;cb=new Ja.a([cb]);if(!la)return ec;for(let xc=0;xc<la.length;xc++){const ad=la.J(xc);ad.Qj&&cb.JVa(ad.Qj,void 0,(Zd,pe)=>{pe&&(Zd=new Bb.a(pe.type,pe.Lb.cp,Zd.Lb.cp,pe.id,
pe.intent,pe.BM.vya),vb(Zd)&&ec.add(Zd))})}return ec}ZQc(la,cb){const vb=new lb.a;if(!vh.hXm(la.contextId))return vb;let ec;const xc=la.node;la.contextId!==rl.a.paragraph?(ec=la.cpBegin,la=la.cpEnd):(ec=0,la=xc.characterData.length);vb.addRange(this.tSd(xc,cb,ec,la));return vb}IWn(la){this.qvc.nb(0)||this.qvc.Z(0,la)}static PJj(la,cb,vb){la=fb.ParagraphReader.textLength(la);if(cb>=la)return{returnValue:!1,cpEnd:vb};vb>la&&(vb=la);return{returnValue:!0,cpEnd:vb}}static w2o(la){if(!la.count)return!0;
const cb=new Sh.a,vb=la.J(0).type,ec=sl.a(vb);let xc=-1;for(const ad of la){if(ad.type!==vb||(sl.c(ad.type)?ad.Ec>ad.end:ad.Ec>=ad.end))return!1;if(ec){la=ad.id;if(!la||la.equals(ua.a.nil)||cb.contains(la))return!1;cb.add(la)}else if(-1===xc)xc=ad.end;else if(xc>ad.Ec)return!1}return!0}static stk(la,cb){let vb;({value:vb}=la.Fc(cb.Ec,vb)).returnValue||(vb=new lb.a,la.Z(cb.Ec,vb));vb.add(new Dl(null,cb.type,!0,cb.id,cb.intent,cb.BM.vya));({value:vb}=la.Fc(cb.end,vb)).returnValue||(vb=new lb.a,la.Z(cb.end,
vb));vb.add(new Dl(null,cb.type,!1,cb.id,cb.intent,cb.BM.vya))}static hXm(la){return la===rl.a.Fd||la===rl.a.Uc||la===rl.a.paragraph}}Object(e.a)(vh,"IntentRangeEditor",null,[358]);class ri{constructor(){this.W=null}get name(){return"Box4.Intent"}wc(la){this.W=la;this.W.ia("Box4.Intent.IntentRangeEditor",()=>new vh).as("Box4.Intent.IIntentRangeEditor").ha()}init(){this.W.resolve("Box4.IProofingManager")}dispose(){}static main(la){z.a.instance.Gc(new ri,0,la);a.ULS.sendTraceTag(512336855,306,50,"Box4 Intent package registered.")}}
Object(e.a)(ri,"PackageManager",null,[1,2]);var tl=c(1046),ci=c(112),Li=c(1428);class kj{constructor(la){this.v9m=la;this.r9m=[]}get handler(){return this.v9m}get koa(){return this.r9m}}Object(e.a)(kj,"RegisteredListener",null,[]);class El{constructor(la,cb){this.type=0;this.payload=null;this.type=la;this.payload=cb}}Object(e.a)(El,"OfficeSharedCommentsEvent",null,[857]);class Ph{constructor(){this.eventType=0;this.newViewContainer=null;this.viewContainerVisibilityState=1}}Object(e.a)(Ph,"ViewContainerEvent",
null,[857]);var ji=c(585);class ej{constructor(la){this.rOf=!1;this.iqa=new lb.a;this.b4d=la}eWn(la){la=new kj(la);this.iqa.add(la)}kEj(la){for(let cb=0;cb<this.iqa.count;++cb)if(this.iqa.J(cb).handler===la){this.iqa.removeAt(cb);break}}fUa(la=!1){const cb=()=>{if(y.AFrameworkApplication.Rk)a.ULS.sendTraceTag(40420181,201,50,"Skipped processing comment pane events since app is shutting down.");else for(let xc=0;xc<this.iqa.count;++xc){const ad=this.iqa.J(xc);for(;0<ad.koa.length;){var vb=Array.dequeue(ad.koa);
if(Object(ci.a)(Ph,vb)){var ec=ad.handler;ec(vb)}else Object(ci.a)(El,vb)&&(ec=ad.handler,ec(vb.type,vb.payload))}}};la?cb():this.rOf||(this.rOf=!0,ji.a.R3(this.b4d,()=>{cb();this.rOf=!1},Li.a.kHl))}}Object(e.a)(ej,"GenericEventHost",null,[]);class Hk{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=this.comments=null;this.virtualized=!1;this.index=0;this.tempId=this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=
this.modelCapabilityFlags=0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=null}}Object(e.a)(Hk,"BasicEventPayload",null,[889]);class Yk{constructor(la){this.nextPopulatedContextDetails=0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=la}}Object(e.a)(Yk,"CommentContextDetails",null,[]);class nn{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}
Object(e.a)(nn,"ContextChangeWithSelectedThreadIndex",null,[889]);class Yl{constructor(){this.tasks=this.comments=null}}Object(e.a)(Yl,"LoadCommentsNoVirtualization",null,[889]);class Hh extends ej{constructor(la){super(la);this.neh=0}bno(){this.neh=1656}PWn(la,cb,vb,ec,xc,ad){la=new kj(la);ad&&Array.enqueue(la.koa,this.W9k(ad,this.neh));ad=cb?cb.length:0;Array.enqueue(la.koa,this.NLh(ad,vb,ec,0));ad&&Array.enqueue(la.koa,this.PMh(cb,xc));this.iqa.add(la);this.fUa()}JSb(la){this.kEj(la)}Mdo(la,cb,
vb,ec=0){this.CIb(this.NLh(la,cb,vb,ec));this.fUa()}Ndo(la,cb,vb){this.CIb(this.v$k(la,cb,vb));this.fUa()}leo(la,cb){this.CIb(this.PMh(la,cb));this.fUa()}selectComment(la){this.CIb(this.RNh(la,6));this.fUa()}highlightComment(la){this.CIb(this.RNh(la,7));this.fUa()}Wpg(la,cb){this.CIb(this.Mcl(la,cb));this.fUa()}O1f(la,cb){this.CIb(this.Sel(la,cb));this.fUa()}W9k(la,cb=0){const vb=new Hk;vb.modelCapabilityFlags=la;vb.richTextCapabilityFlags=cb;return new El(12,vb)}NLh(la,cb,vb,ec){const xc=new Hk;
xc.numberOfComments=la;xc.numberOfThreads=cb;xc.contextDetails=Object.assign(new Yk(vb),{nextPopulatedContextDetails:ec});xc.contextDrafts=null;xc.rehydrationDrafts=null;return new El(0,xc)}v$k(la,cb,vb){const ec=new Hk;ec.comments=la;ec.numberOfThreads=cb;ec.tasks=vb;return new El(2,ec)}PMh(la,cb){const vb=new Yl;vb.comments=la;vb.tasks=cb;return new El(1,vb)}RNh(la,cb){const vb=new Hk;vb.commentId="";la&&(vb.commentId=la);return new El(cb,vb)}Mcl(la,cb){const vb=new Hk;vb.changes=[];vb.contextDetails=
Object.assign(new Yk(cb),{nextPopulatedContextDetails:la});return new El(10,vb)}Sel(la,cb){const vb=new Hk;vb.commentId=la;vb.smartReplies=cb;return new El(15,vb)}CIb(la){for(let cb=0;cb<this.iqa.count;++cb)Array.enqueue(this.iqa.J(cb).koa,la)}}Object(e.a)(Hh,"OfficeSharedCommentsEventHost",ej,[876]);var bn=c(232),lj=c(178),il=c(274);class zk{constructor(){this.ISe=this.$Kg=!1;this.YI=this.Jp=this.v_g=this.N5g=this.vAd=this.$Zb=this.Wih=this.JPg=this.dA=this.eDc=null}initialize(la,cb,vb,ec=null,xc=
null,ad=null,Zd=null,pe=null,Td=null,Ie=null){this.dA=la;this.JPg=cb;this.Wih=vb;this.$Zb=ec;this.vAd=xc;this.N5g=ad;this.v_g=Zd;this.Jp=pe;this.$Kg=!0;this.YI=Td;this.eDc=Ie}mYd(la=null,cb=null){if(!this.$Kg)return a.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise((vb,ec)=>{ec(ji.a.QD(-2130915313))});if(this.ISe)return a.ULS.sendTraceTag(41424204,201,10,"InstantiateSharedComments called after shared comments was already instantiated."),
new Promise(()=>{});this.eDc||(y.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?this.eDc=appResourceLoader.loadChunk("sharedComments"):this.eDc=this.dA.loadScript("sharedComments"));return this.eDc.then(()=>{la&&la();this.ISe||(this.YI&&this.YI.execute(vb=>{vb.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}),cb&&cb(),sharedComments.instantiate(this.JPg,this.Wih,this.$Zb,this.vAd,this.N5g,this.v_g,this.Jp));this.ISe=!0})}}Object(e.a)(zk,
"CommentActivationManager",null,[921]);class Im extends ej{constructor(la){super(la)}EYn(la){this.eWn(la)}iTo(la){this.kEj(la)}Coj(la){la=this.r$k(la);for(let cb=0;cb<this.iqa.count;++cb)Array.enqueue(this.iqa.J(cb).koa,la);this.fUa(!0)}r$k(la){const cb=new Ph;cb.eventType=3;cb.viewContainerVisibilityState=la;return cb}JHl(){const la=this.agl();for(let cb=0;cb<this.iqa.count;++cb)Array.enqueue(this.iqa.J(cb).koa,la);this.fUa(!0)}agl(){const la=new Ph;la.eventType=2;return la}}Object(e.a)(Im,"ViewContainerEventHost",
ej,[844]);var zd=c(54);class hf{constructor(){this.actionBehavior=this.actionType=0}}Object(e.a)(hf,"CommentUIActionPayload",null,[]);var Mi=c(306);class Rl{constructor(la,cb){this.ga=la;this.Ksb=cb;this.Dqc=new Mi.a;for(let vb of this.Ksb)this.Dqc.Z(vb.value.canvasActionId,vb.key),la=vb.value,la.delayActionsUntilRegistration||this.ra(la)}ra(la){la.withFlags?this.ga.fb(la.canvasActionId,la.canvasContextId,Object(zd.a)(this,this.ynh,"actionHandler"),97):this.ga.ra(la.canvasActionId,la.canvasContextId,
Object(zd.a)(this,this.ynh,"actionHandler"))}ETa(la,cb){this.Ksb.nb(la)&&(this.Ksb.J(la).delayActionsUntilRegistration&&this.ra(this.Ksb.J(la)),this.Ksb.J(la).registeredCallback=cb)}ynh(la,cb,vb,ec,xc){if(this.Dqc.nb(la)){var ad=this.Dqc.J(la);if(!this.Ksb.nb(ad))return 8;const Zd=this.Ksb.J(ad);if(Zd.preCallback){const pe=Zd.preCallback(la,cb,vb,ec,xc);if(2!==pe)return pe}if(!Zd.registeredCallback)return 1===vb?8:2;ad=Object.assign(new hf,{actionType:ad});1===vb&&(ad.actionBehavior=1);ad=Zd.registeredCallback(ad);
return Zd.postCallback?Zd.postCallback(ad,la,cb,vb,ec,xc):ad?32:8}return 2}}Object(e.a)(Rl,"OfficeSharedCommentsActionHost",null,[878]);var me=c(1843),qd=c(67),Yj=c(133),af=c(1485),Xe=c(13),ho=c(27),ki=c(549),qm=c(1163),Fj=c(135),rm=c(308),Tf=c(48),Fl=c(21),Hf=c(1065),Ed=c(1057),Zl=c(1597),ed=c(176),Bf=c(11),Og=c(37),Rm=c(708),Xh=c(472),rf=c(15),Ak=c(2067);class ye{constructor(la){this.wW=la;this.gic=new S.a;this.z3a=new S.a;this.rBm();this.bvm=[new Ak.a(Og.a.bHh,Og.a.Y1k),new Ak.a(Og.a.pHd,Og.a.X1k),
new Ak.a(Og.a.TGh,Og.a.K1k),new Ak.a(Og.a.hHd,Og.a.J1k),new Ak.a(Og.a.cHh,Og.a.$1k),new Ak.a(Og.a.qHd,Og.a.Z1k)]}JTa(la){this.wW.JTa(la);this.OZn(la)}MGf(la,cb){return!!la&&!!la.objectId&&cb.contains(ua.a.If(la.objectId))}PRa(la){la=Object(Qb.a)(400,la);return!!la&&!!la.objectId}OZn(la){for(const cb of this.bvm)la.classList.remove(cb.className,cb.GSc);la.classList.remove(Og.a.m1f,Og.a.sHd,Og.a.UGh,Og.a.rHd,ye.kug)}rBm(){const la=new S.a,cb=new S.a;la.add(0,null);la.add(1,Og.a.pHd);la.add(2,Og.a.bHh);
la.add(3,Og.a.sHd);cb.add(0,null);cb.add(1,Og.a.hHd);cb.add(2,Og.a.TGh);cb.add(3,Og.a.UGh);this.z3a.Z(1,la);this.z3a.Z(2,cb);this.z3a.Z(3,cb);this.gic.add(0,null);this.gic.add(1,Og.a.qHd);this.gic.add(2,Og.a.cHh);this.gic.add(3,Og.a.rHd)}}ye.kug="CommentImportant";Object(e.a)(ye,"CommentHighlightUtils",null,[]);class rk{constructor(){this.vMd=0;this.BCb=null}}Object(e.a)(rk,"CommentGuidsInElementInfo",null,[]);class Hn{constructor(){this.Fni=!1;this.wna=this.ZMb=null;this.kTa=this.$Hb=0}}Object(e.a)(Hn,
"HighlightInfoForElement",null,[]);class fj{constructor(){this.jri=this.lri=this.kri=-1;this.epi=[];this.$4b=[];this.GUc=this.HUc=-1;this.lwi=!1}}Object(e.a)(fj,"HighlightInfoForElementsInPara",null,[]);class Qh{constructor(){this.Hog=this.GXf=null}}Object(e.a)(Qh,"OnAnchorMouseOutData",null,[]);var gh=c(1525);class sk{constructor(la,cb,vb,ec,xc,ad,Zd,pe){this.Mwe=la;this.qaa=cb;this.tk=vb;this.S2=ec;this.ga=xc;this.Ib=ad;this.gj=Zd;this.AYa=this.fj=null;this.Fmn=Td=>{if(!this.fj||this.S2.w_d)return!0;
if(Td=Td.Vo){if(this.fj.Tz&&Td[0].toString()===this.fj.Tz.objectId)return!0;this.AYa&&Td[0].equals(this.AYa.Hog[0])?this.Ib.ff(this.AYa.GXf):(this.AYa&&(this.Ib.ff(this.AYa.GXf),this.ga.Qb(Xe.a.tHd,2,this.AYa.Hog)),this.fj.Go.mwi(Td[0])&&!this.gj.Bm||this.ga.Qb(Xe.a.t9e,2,Td));this.AYa=null}return!0};this.Emn=Td=>{if(this.S2.w_d)return!0;const Ie=Td.Vo;Ie&&(Td=new ka.a(2,1,0,()=>{this.ga.Qb(Xe.a.tHd,2,Ie);this.AYa=null}),this.Ib.Wb(Td),this.AYa=Object.assign(new Qh,{GXf:Td,Hog:Ie}));return!0};this.yUi=
Td=>{const Ie=new ka.a(2,1,0,()=>{if(this.fj&&!this.fj.Go.Qx){var We=Td.Vo;if(!We)We=Q.App.za.Hp.currentScope,this.fj.Tz&&(!We||We.name!==ed.AFrame.JM&&We.name!==ed.AFrame.Ur)&&this.fj.clearSelection();else if(!this.fj.Tz||We.toString()!==this.fj.Tz.objectId)if(We=this.fj.Go.m0(We.toString()))We=Object.assign(new af.a,{commentId:We.id,mS:!1,E$:1}),this.ga.Qb(rf.a.selectComment,2,We)}});this.Ib.Wb(Ie);return!1};pe.execute(Td=>{this.fj=Td})}izh(la,cb,vb,ec){const xc=new fj,ad=[],Zd=this.qaa.PRa(cb)?
cb.objectId:null;for(let Ie=0,We=la.length;Ie<We;Ie++){var pe=la[Ie],Td=gh.g(pe);const Vf=gh.d(pe);pe=new Sh.a;const tf=new Hn;if(Td){const yf=new Xh.a(gh.c);Td=this.N_h(Td,Zd,yf);0<Td.length&&(this.QWo(Td,vb,pe,tf,Zd,ec),ad.push(Object.assign(new rk,{vMd:Ie,BCb:yf})))}Vf&&(Td=this.N_h(Vf,Zd),0<Td.length&&(this.SWo(Td,vb,pe,tf,xc,Zd,ec,Ie),this.eVo(ad,Td,Ie,tf)));0<vb.count&&this.TWo(cb,vb,tf,ec);this.cVo(ad,tf);xc.epi.push(tf)}return xc}Iuh(la,cb,vb){let ec=!1;for(let xc=0,ad=la.length;xc<ad;xc++){const Zd=
la[xc],pe=cb.epi[xc],Td=Rm.a(Zd);if(1!==Td&&2!==Td&&3!==Td)continue;const Ie=3===Td||2===Td&&-1!==Zd.className.indexOf(Og.a.PQa);this.qaa.JTa(Zd);this.quk(Zd,pe,Ie,ec);this.dtk(Zd,xc,Td,pe,cb,vb);this.etk(Zd,xc,cb,pe);ec=Ie}}N_h(la,cb,vb=null){const ec=[];for(let xc=0;xc<la.length;xc++)this.Mwe.$pj(la[xc],la[xc].toString()===cb)&&(ec.push(la[xc]),vb&&vb.add(la[xc]));return ec}QWo(la,cb,vb,ec,xc,ad){var Zd;let pe=!1,Td=!1;for(const We of la){cb.add(We);vb.add(We);var Ie=We.toString();Ie===xc?(Ie=ad?
1:2,ec.kTa=Ie,ec.$Hb=Ie):this.MGf(this.fj.Tz,cb)&&(Ie===(null===(Zd=this.fj.Tz)||void 0===Zd?void 0:Zd.objectId)&&(Td=!0),pe=!0)}0<la.length&&!ec.kTa&&(ec.kTa=Td?1:3,ec.$Hb=pe?1:3)}SWo(la,cb,vb,ec,xc,ad,Zd,pe){var Td,Ie;const We=new Xh.a(gh.c);Zd=Zd?1:2;let Vf=!1;for(const tf of la){const yf=tf.toString();cb.contains(tf)||(yf===ad?xc.jri=pe:(xc.kri=pe,ec.kTa=3,(null===(Td=this.fj.Tz)||void 0===Td?void 0:Td.objectId)===yf&&(xc.lri=pe,ec.kTa=1)),We.add(tf));yf===(null===(Ie=this.fj.Tz)||void 0===Ie?
void 0:Ie.objectId)&&(Vf=!0);cb.remove(tf);vb.contains(tf)&&this.RWo(ec,tf,yf,ad,Zd);yf===ad&&(ec.kTa=Zd)}0<la.length&&!ec.kTa&&(ec.kTa=Vf?1:3);0<We.count&&xc.$4b.push(Object.assign(new rk,{vMd:pe,BCb:We}))}eVo(la,cb,vb,ec){0!==la.length&&(cb.forEach(xc=>{for(let ad=la.length-1;0<=ad;ad--){const Zd=la[ad];if(Zd.BCb.contains(xc)){Zd.vMd===vb&&(ec.wna?ec.wna.push(xc):ec.wna=[xc]);Zd.BCb.remove(xc);break}}}),la=la.filter(xc=>0<xc.BCb.count))}TWo(la,cb,vb,ec){var xc,ad;this.MGf(la,cb)?vb.$Hb=ec?1:2:vb.$Hb||
(vb.$Hb=null!=(null===(xc=this.fj.Tz)||void 0===xc?void 0:xc.objectId)&&cb.contains(ua.a.If(null===(ad=this.fj.Tz)||void 0===ad?void 0:ad.objectId))?1:3);vb.ZMb||(vb.ZMb=[]);for(const Zd of cb)vb.ZMb.push(Zd)}cVo(la,cb){if(0<la.length){cb.wna||(cb.wna=[]);for(const vb of la[la.length-1].BCb)cb.wna.push(vb)}}RWo(la,cb,vb,ec,xc){la.Fni=!0;la.ZMb||(la.ZMb=[]);la.ZMb.push(cb);vb===ec&&(la.$Hb=xc)}MGf(la,cb){return!!la&&!!la.objectId&&cb.contains(ua.a.If(la.objectId))}quk(la,cb,vb,ec){!cb.kTa||vb||ec||
((vb=this.qaa.gic.J(cb.kTa))&&la.classList.add(vb),cb.Fni&&la.classList.add(Og.a.m1f))}dtk(la,cb,vb,ec,xc,ad){ec=this.qaa.z3a.J(vb).J(ec.$Hb);cb<xc.jri?ec=ad?this.qaa.z3a.J(vb).J(1):this.qaa.z3a.J(vb).J(2):cb<xc.kri&&!ec&&(ec=cb<xc.lri?this.qaa.z3a.J(vb).J(1):this.qaa.z3a.J(vb).J(3));ec&&(cb=xc.lwi,la.classList.add(ec),cb&&la.classList.add(ye.kug))}etk(la,cb,vb,ec){ec.wna||(ec.wna=this.vSl(cb,vb)||ec.ZMb);cb=null;ec.wna&&0<ec.wna.length&&(this.tk.ob(Bf.a.g1,la,this.Fmn,ec.wna),this.tk.ob(Bf.a.kya,
la,this.Emn,ec.wna),cb=ec.wna[0]);this.tk.ob(Bf.a.click,la,this.yUi,cb);this.tk.ob(Bf.a.hK,la,this.yUi,cb)}vSl(la,cb){for(;0<cb.$4b.length&&cb.$4b[0].vMd===la;)cb.$4b.splice(0,1);if(0<cb.$4b.length){la=[];for(const vb of cb.$4b[0].BCb)la.push(vb);return la}return null}}Object(e.a)(sk,"AllMarkupModeHighlightChangeHandler",null,[394]);var Xi=c(1497);class Zk extends Xi.a{constructor(la){super(100,25);this.Bqc=new S.a(0);this.zVj=6E4;this.gHl=()=>{const cb=this.Bqc.keys;if(cb.length){var vb="";for(let ec=
0;ec<cb.length;ec++)vb+=cb.J(ec)+":"+this.Bqc.J(cb.J(ec))+";";this.Xqa(vb);this.Bqc=new S.a(0)}};this.Vsb=new lb.a;this.Vsb.add(1);this.Vsb.add(6);this.Vsb.add(2);this.Vsb.add(4);this.Vsb.add(10);this.Vsb.add(11);this.Sg=la;la.e6f&&window.setInterval(this.gHl,this.zVj)}kIa(la){this.Sg.aRo&&this.Sg.e6f&&(this.Vsb.contains(la)?this.QQn(la):this.Xqa(la+""))}QQn(la){this.Bqc.Z(la,this.Bqc.Fz(la,0)+1)}}Object(e.a)(Zk,"CommentActionInTypingRecorder",Xi.a,[416]);var ne=c(1637),$k=c(243);class wf{static d0n(la){la&&
la.atmention&&delete la.atmention.isCurrentUser;return la}}Object(e.a)(wf,"DeltaFormatHelpers",null,[]);class wj{constructor(){this.optional=this.attributes=null}}Object(e.a)(wj,"Operation",null,[]);class Pe extends wj{constructor(){super();this.insert=null}}Object(e.a)(Pe,"DeltaOperation",wj,[]);class Kg{constructor(){this.ops=null}}Object(e.a)(Kg,"Delta",null,[]);var em=c(139),jl=c(179),io=c(151),Mf=c(59),nk=c(74),mj=c(101),Rf=c(495),sg=c(1206),db=c(1807);class Lb extends db.ACommentFormatTranslator{constructor(la,
cb){super(la);this.we=cb}Lmg(la){const cb=new ne.a;for(let vb=0;vb<la.length;vb++){const ec=la[vb];ec.bJb=!0;this.bEk(cb,ec);cb.Xca("\n")}return[cb.I9b()]}gLo(la,cb){la=ne.a.aGb(la[0]);la=this.WGn(la);const vb=new lb.a;let ec=0,xc=null,ad=null;for(;ec<la.ops.length;){const Zd=la.ops[ec];xc||(xc=sg.a.instance.createInstance(393230),xc.bJb=!0,xc.Hg(sa.a.Wc,$k.a.GF()),cb(xc),xc.qa.clear(),xc.qra(""));"\n"===Zd.insert?(ad=this.wMf(xc,ad),this.Apo(xc),vb.add(xc),xc=null):ad=this.k3m(xc,Zd,ad);ec++}return vb.toArray()}Apo(la){const cb=
la.VAh();for(let vb=0;vb<cb;vb++)la.ye.vq.Z(vb,Lb.Ygn),la.ye.nt.Z(vb,Lb.vTf)}wMf(la,cb){var vb=la.QMd();vb.cp===la.characterData.length?vb.Ph=!0:(vb=Object.assign(new jl.a(la,la.characterData.length),{Ph:!0}),la.qa.add(vb));vb=la.qa.last;if(cb){cb=!!cb.mw;const ec=this.yIh(la,vb,!cb,cb,null);vb.formatting=ec;cb&&(la=this.wIh(la,vb),vb.HU=la.Yj);vb.Cm=!0;cb=null}vb.cp||vb.formatting||(vb.formatting=new io.a(vb,ua.a.nil));return cb}k3m(la,cb,vb){const ec=la.QMd(),xc=!!cb.attributes&&!!cb.attributes.link,
ad=!!cb.attributes&&!!cb.attributes.atmention,Zd=this.yIh(la,ec,xc,ad,cb);ec.formatting=Zd;vb&&(vb.mw&&(vb=this.wIh(la,ec),ec.HU=vb.Yj),ec.Cm=!0,vb=null);if(xc||ad)this.H2m(ec,la,cb),vb=ec.hyperlink;la.qra(la.characterData+cb.insert);return vb}wIh(la,cb){cb=new io.a(cb,ua.a.create());let vb=this.CJd();vb.setValue(sa.a.$Jb,!0);vb=la.Mc.rV(vb);cb.Yj=vb.id;return cb}yIh(la,cb,vb,ec,xc){cb=new io.a(cb,ua.a.create());let ad=sg.a.instance.createInstance(1179649);if(vb||ec)ad.setValue(Xc.a.UB,!0),ad.setValue(Xc.a.T4,
!0),vb&&this.gho(la,ad);this.Sg.uBb&&xc&&xc.attributes&&this.cno(xc.attributes,ad);ad=la.Mc.rV(ad);cb.Yj=ad.id;return cb}gho(la,cb){(la=this.we.JB(la))&&(la=la.oj(Mf.StyleReader.Cpc))&&cb.setValue(vd.a.qw,la.id)}cno(la,cb){this.sQb(la.weight>=ne.a.R4d,cb,Xc.a.bold,!0);this.sQb(la.italic,cb,Xc.a.italic,!0);this.sQb(la.underline,cb,Xc.a.underline,!0);this.sQb(la.underline,cb,Xc.a.underlineType,Dd.a.FSb);this.sQb(la.strikethrough,cb,Xc.a.strikethrough,!0);if(nk.a.VYc(la.highlight)){var vb=nk.a.QFa(la.highlight);
this.sQb(!!la.highlight,cb,Xc.a.highlight,nk.a.I5(vb))}nk.a.VYc(la.color)&&(vb=nk.a.QFa(la.color),this.sQb(!!la.color,cb,Xc.a.fontColor,nk.a.I5(vb)))}sQb(la,cb,vb,ec){la&&cb.setValue(vb,ec)}H2m(la,cb,vb){if(vb.attributes&&vb.attributes.atmention){var ec=mj.a.GFa(vb.attributes.atmention.email);vb=vb.optional&&vb.optional.atmention&&vb.optional.atmention.contentId?vb.optional.atmention.contentId:Lb.eLl(1===vb.attributes.atmention.resolveState);ec=new Rf.a(la,ec,!0,void 0,void 0,void 0,vb);this.k9k(ec,
cb.Mc);la.hyperlink=ec}else cb=mj.a.GFa(vb.attributes.link),ec=this.dbl(la.paragraph.qa.first),la.hyperlink=new Rf.a(la,cb,!1,ec.Yj)}dbl(la){let cb=this.HNh();cb=la.paragraph.Mc.rV(cb);la=new io.a(la,ua.a.nil);la.Yj=cb.id;return la}k9k(la,cb){var vb=String.format(' HYPERLINK "{0}"',la.url),ec=la.mw;const xc=this.CJd();xc.setValue(sa.a.Qs,15);xc.setValue(sa.a.mw,ec);xc.setValue(sa.a.MRa,!0);xc.setValue(sa.a.UX,vb);la.Hua(cb.rV(xc).id);ec=this.CJd();ec.setValue(sa.a.Qs,47);ec.setValue(sa.a.UX,vb);la.Hua(cb.rV(ec).id);
vb=this.CJd();vb.setValue(sa.a.Qs,16);la.Hua(cb.rV(vb).id)}HNh(){const la=sg.a.instance.createInstance(1179649);la.setValue(Xc.a.UB,!0);la.setValue(Xc.a.T4,!0);la.setValue(Xc.a.isHidden,!0);return la}CJd(){const la=this.HNh();la.setValue(Xc.a.Z$,!0);return la}WGn(la){const cb=new lb.a;for(let vb=0;vb<la.ops.length;vb++){const ec=la.ops[vb];ec.optional=wf.d0n(ec.optional);if(-1!==ec.insert.indexOf("\n")&&"\n"!==ec.insert){const xc=ec.insert.split("\n");for(let ad=0;ad<xc.length;ad++)if(vb!==la.ops.length-
1||ad!==xc.length-1||xc[ad])cb.add(Object.assign(new Pe,{insert:xc[ad],attributes:ec.attributes,optional:ec.optional})),ad!==xc.length-1&&cb.add(Object.assign(new Pe,{insert:"\n"}))}else cb.add(ec)}return Object.assign(new Kg,{ops:cb.toArray()})}static eLl(la){return db.ACommentFormatTranslator.cIk+em.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+(la?"Z":"")}}Lb.Ygn=0;Lb.vTf=0;Object(e.a)(Lb,"CommentDeltaFormatTranslator",db.ACommentFormatTranslator,[]);var kc=c(1698),Kc=c(1599);
class Qc{get userPrincipalName(){return this.K.kb("UserPrincipalName")}constructor(la,cb,vb){this.Kj=la;this.K=cb;this.YK=vb}ZD(la){return this.Kj.ZD(la)}MJm(la){la=this.Kj.ZD(la);return la?!la.done:(a.ULS.sendTraceTag(521426529,327,10,"CommentFilterActor : Comment Not in Model. "),!1)}uWc(la){return this.Kj.uWc(la)}isCurrentUserMentioned(la){var cb,vb;la=this.Kj.kSl(la);for(const ec of la){if(!ec.text||0===ec.text.length)continue;la=ne.a.aGb(ec.text[0]);let xc=0;for(;la.ops&&xc<la.ops.length;){const ad=
null===(vb=null===(cb=la.ops[xc])||void 0===cb?void 0:cb.attributes)||void 0===vb?void 0:vb.atmention;if(ad&&ad.email===this.userPrincipalName)return!0;xc++}}return!1}k2c(){this.YK.s$("OnContentFilterUpdate")}}Object(e.a)(Qc,"CommentFilterActor",null,[413]);var md=c(102),Hd=c(2062),Ne=c(899),Cc=c(603);class oe{constructor(la,cb,vb,ec,xc,ad,Zd,pe,Td){this.Yh=la;this.Ib=cb;this.ti=vb;this.jWa=ec;this.gj=xc;this.G2=ad;this.zh=Zd;this.ZT=pe;this.sN=Td;this.cvb=null;this.UVe=0;this.Wpd=!1;this.rud=0;this.USb=
this.oad=this.MOg=this.Nxc=this.qAb=!1;this.updateViewportInfo=()=>{this.ZT.Ngg()&&this.zh.updateViewportInfo(this.Wpd,this.pZf)};this.unb=()=>{this.zh.Oma.Fpa()&&(this.q6c(this.zh.Oma.rc),this.zh.Oma.tjc(this.unb))};this.pZf=()=>{this.r9a();this.ZT.oZf()};this.Ejg=()=>{!this.qAb&&this.ZT.cgg()&&(this.rud=this.XXe.scrollTop,this.qAb=!0,this.jWa.kIa(2))};this.C6f=(Ie,We)=>{this.qAb&&(Ie=this.XXe.scrollTop,Ie-this.rud?(this.Nxc||We.ype||this.updatePosition(),this.Nxc||1!==We.ype||this.r9a(),this.$0e(Ie),
this.ZT.kYf()):this.Nxc=this.qAb=!1)};this.XXe=this.zh.Pea;this.qja=Cc.a.F9d;this.ut=this.zh.ut;this.zh.mIh()}get b_d(){return this.ZT.YHf()}get qja(){return this.zh.qja}set qja(la){this.zh.qja=la}get xvh(){return"1"===this.ut.CF.style.opacity}mpj(la){this.oad||(this.oad=!0,this.zh.d3i(),this.cvb=la(this.ut.eGa,this.zh.hbj,()=>{this.updatePosition()}),this.zh.MKi(this.cvb),this.ZT.initialize(this.cvb,this),this.zh.initialize(this.cvb,this.ZT.wnb),this.zh.G9i(),this.zh.gpj(),this.zh.hpj(),this.zh.lpj(this.ZT.m4e,
this.ZT.A8d,this.ZT.z8d),this.m7f())}l$c(){}lie(){return this.zh.eqj()}setInitialActiveContainerId(la,cb,vb=null){this.zh.setInitialActiveContainerId(la,0,vb)}updatePosition(){if(!this.USb&&this.b_d&&this.Yh.yac()){var la=H.a.$e()-this.UVe<Cc.a.yHj;la||this.Wpd||this.r9a(la)}}r3e(){this.r9a()}hUa(la,cb,vb){this.sN.Ghb&&this.G2.s$("OnFloatingCommentsVisibilityChange",!0);this.zh.hUa(la,cb,vb)}deleteContainer(la,cb,vb=!1){this.zh.deleteContainer(la,cb,()=>{this.Yh.bTc()||this.zh.JWd();this.ZT.pWf()},
vb)}addContainer(la,cb,vb){this.zh.addContainer(la,cb,vb,this.zh.pl,this.ZT.nRc,this.ZT.ZUf)}H1i(la){this.USb=!0;la();this.USb=!1}h7c(la,cb,vb){this.zh.h7c(la,cb,vb)}N4b(){this.zh.N4b()}UHj(){const la="1"===this.ut.CF.style.opacity;switch(!0){case la&&!this.Yh.bTc():this.zh.JWd();break;case !la&&this.Yh.bTc():this.zh.lRb()}}Zmg(la=!0){this.ZT.Igg&&this.zh.lAj(la)}static Z8h(la,cb=null){const vb=new Xa.a;for(const ec of la)ec.Df||ec.$q!==Hd.a.beingCreated&&(!cb||cb(ec))&&oe.Trk(vb,ec.objectId,ec);
return vb}static Trk(la,cb,vb){let ec;({value:ec}=la.Fc(cb,ec)).returnValue||(ec=[],la.Z(cb,ec));ec.push(vb)}q6c(la){la&&(la.tga(()=>{this.updateViewportInfo()}),this.rud=this.XXe.scrollTop,la.Erh(this.Ejg),la.Frh(this.C6f))}m7f(){this.zh.pl?this.q6c(this.zh.pl):this.zh.Oma?this.zh.Oma.J2b(this.unb):a.ULS.sendTraceTag(523011085,327,15,"Workspace undefined, failed to register page view handlers")}$0e(la){this.ut.CF.style.top=la-this.rud+"px";this.Nxc=!1}r9a(la=!1){la=new ka.a(0,1,0,()=>{this.ygf()},
129,void 0,!la);this.Ib.Wb(la);this.Wpd=!0;this.Nxc=this.qAb;this.jWa.kIa(10)}Atf(la){return this.zh.S0a({contentAnchorPositions:la.contentAnchorPositions})}ygf(){this.Wpd=!1;if(this.ut.eGa&&this.cvb&&this.Yh.yac()){this.zh.fNd();var la=0;this.ti.ie(()=>{la=this.zh.tRd()},"FCM:UP:GET");var cb=null,vb=null;this.ti.ie(()=>{const ec=this.ZT.y7h(la,this.zh.pl);cb=ec.L2k;vb=this.Atf(ec)},"FCM:UP:GP");this.ti.ie(()=>{this.qAb?(this.zh.uWh(vb),this.qAb=!1):this.cvb.emitEvent(3,vb);this.G2.Fce()},"FCM:UP:RC");
this.cvb.setFirstCommentRenderDone();"0"===this.ut.CF.style.opacity&&0<cb.count&&!this.gj.Bm&&this.gj.VIa&&this.ti.ie(()=>{this.zh.lRb()},"FCM:UP:SFC");!this.MOg&&0<cb.count&&(ji.a.R3(this.Ib,this.zh.jLi,Li.a.iLi),this.MOg=!0);this.UVe=H.a.$e();this.jWa.kIa(6)}else this.UVe=H.a.$e()}}Object(e.a)(oe,"FloatingCommentManager",null,[27,385]);var gc=c(115),eh=c(1498),nj;(function(la){la[la.ksp=0]="singleHint";la[la.qnp=1]="multiHint";la[la.Fqp=2]="resolvedHint";la[la.rnp=3]="multiResolvedHint";la[la.entryPoint=
4]="entryPoint";la[la.unknown=void 0]="unknown"})(nj||(nj={}));Object(e.b)("CommentIconType",nj);var vi=c(127),ge=c(1124);const wg={[1]:"CommentMultiHintIcon_16",[0]:"CommentHintIcon_16",[2]:"CommentResolvedHintIcon_16",[3]:"CommentResolvedMultiHintIcon_16",[4]:"NewCommentMarginEntrypoint_16",[nj.unknown]:""},$f={[0]:["OfficeIconColors_mCommentHintIconCenter","OfficeIconColors_mCommentHintIconBorder"],[1]:["OfficeIconColors_mCommentMultiHintIconCenter","OfficeIconColors_mCommentMultiHintIconBorder"],
[2]:["OfficeIconColors_mCommentResolvedHintIconCenter","OfficeIconColors_mCommentResolvedHintIconBorder","OfficeIconColors_mCommentResolvedHintIconStamp"],[3]:["OfficeIconColors_mCommentResolvedMultiHintIconCenter","OfficeIconColors_mCommentResolvedMultiHintIconBorder","OfficeIconColors_mCommentResolvedMultiHintIconStamp"],[4]:[],[nj.unknown]:[]},di=(la,cb)=>{switch(la){case "OfficeIconColors_mCommentHintIconCenter":case "OfficeIconColors_mCommentMultiHintIconCenter":case "OfficeIconColors_mCommentResolvedHintIconCenter":case "OfficeIconColors_mCommentResolvedMultiHintIconCenter":switch(cb){case 3:return ge.a.iHh;
case 2:return ge.a.jHh;case 1:return ge.a.kHh}break;case "OfficeIconColors_mCommentHintIconBorder":case "OfficeIconColors_mCommentMultiHintIconBorder":case "OfficeIconColors_mCommentResolvedHintIconBorder":case "OfficeIconColors_mCommentResolvedMultiHintIconBorder":switch(cb){case 3:return ge.a.fHh;case 2:return ge.a.gHh;case 1:return ge.a.hHh}break;case "OfficeIconColors_mCommentResolvedHintIconStamp":case "OfficeIconColors_mCommentResolvedMultiHintIconStamp":switch(cb){case 3:return ge.a.lHh;case 2:return ge.a.mHh;
case 1:return ge.a.nHh}}},ah=(la,cb)=>{vi.a("renderIcon")&&appChrome.api.renderIcon(la,cb)};class Zj{}Zj.gpi=16;Zj.ovm=1;Zj.kBf=20;Zj.oMj=2;Object(e.a)(Zj,"CommentIconConstants",null,[]);class ng{constructor(){this.iHd=0;this.RGc=!1}}Object(e.a)(ng,"CommentHintCensus",null,[]);class Xo{constructor(la,cb,vb,ec,xc){this.NPg=la;this.$1b=vb;this.c1j=ec;this.Oga=xc;this.ONa=-1;this.Lwe=new Set(cb)}get y(){if(-1!==this.ONa)return this.ONa;const la=Sys.UI.DomElement.getBounds(this.NPg),cb=this.NPg.getClientRects();
return this.ONa=0<cb.length&&cb[0]?this.c1j?la.y/this.$1b+Zj.oMj:Math.floor(cb[0].height)/(2*this.$1b)+la.y/this.$1b-Zj.gpi/2:0}get oHd(){return Array.from(this.Lwe)}Tvk(la){this.Lwe=new Set([...this.Lwe,...la])}}Object(e.a)(Xo,"HintInfo",null,[417]);class Mh extends eh.a{constructor(la,cb,vb,ec,xc,ad,Zd,pe,Td,Ie,We,Vf,tf,yf){super();this.Sg=la;this.ig=cb;this.tk=vb;this.yE=ec;this.ga=xc;this.Yh=Ie;this.Asa=We;this.jWa=Vf;this.gj=tf;this.AZj=yf;this.pid=new Map;this.Hvb=this.bzb=null;this.Unc={xrb:-1,
KTf:-1}}e8a(la){let cb=!1;Q.App.ELj&&la.nc.Zi?R.a.instance.ie(()=>{cb=gh.m(la,!0)},"CHA:SCIVE"):R.a.instance.ie(()=>{cb=gh.l(la.htmlElement,!0)},"CHA:SCI");return cb}R0a(la){const cb=this.zoom,vb=la.w5,ec=la.rxa;let xc=0;for(let pe=0;pe<la.L4.length;pe++)if(0<la.L4[pe].width){xc=pe;break}const ad=la.d0a(1,Zj.kBf,cb,xc);this.jWa.kIa(1);let Zd=[];ec.forEach((pe,Td)=>{const Ie=la.L4[Td].y/cb;pe=this.tbl(this.Y_l(pe,Td),We=>this.fbl(vb,We,We.y-Ie,ad),()=>Mh.hdl(vb));Zd=Zd.concat(pe)});return Zd}tbl(la,
cb,vb){vb=vb();const ec=[];for(const xc of la){la=cb(xc);for(const Zd of xc.oHd)this.pid.set(Zd.toString(),la);const ad=this.vdi(xc.oHd);this.nGj(ad,la);null==vb.Oga&&(vb.Oga=xc.Oga);vb.appendChild(la);ec.push(la)}this.Uac(this.Hvb);this.fkb(this.bzb);return[vb]}zsl(la,cb){la=null===la||void 0===la?void 0:la.querySelectorAll("."+Mh.y_i);return 0<(null===la||void 0===la?void 0:la.length)&&la[0]&&(la=Array.from(la[0].querySelectorAll(Mh.a2k)))?this.Xbo(la,cb):!1}Xbo(la,cb){let vb=0,ec=la.length-1,xc;
for(;ec>=vb;){xc=Math.floor((ec-vb)/2+vb);const ad=la[xc];if(ad.offsetTop>=cb-2&&ad.offsetTop<=cb+2)return!0;ad.offsetTop>cb+2?ec=xc-1:vb=xc+1}return!1}vdi(la){var cb,vb;let ec=0,xc=0;for(const ad of la)if(this.Yh.XGf(ad)){if(this.Sg.contentFilterApiEnabled&&this.gj.Bm&&(la=this.Yh.m0(ad.toString()),null===(vb=(cb=this.AZj).isContentInFilteredContent)||void 0===vb||!vb.call(cb,la.id)))continue;this.Yh.mwi(ad)?xc+=1:ec+=1}cb=new ng;cb.iHd=ec+xc;cb.RGc=0===ec;return cb}Koc(la){if(la=this.pid.get(la.objectId)){var cb=
gh.g(la);cb=this.vdi(cb);this.nGj(cb,la)}}nGj(la,cb){let vb,ec;if(this.Sg.contentFilterApiEnabled&&0===la.iHd)cb.style.display="none";else if(1===la.iHd?(vb=la.RGc?2:0,ec=la.RGc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleActiveLabel):1<=la.iHd&&(vb=la.RGc?3:1,ec=la.RGc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiActiveLabel),cb.style.display=
"block",la=cb.firstElementChild)this.Jjo(la,vb),la.title=ec+". "+la.title,ah(wg[vb],la)}Jjo(la,cb){la.title=WordEditorIntl.WordEditorStrings.L_CommentHintIcon_UserActionStatement;gc.a.Sl(la,Mh.oHh,cb)}Y_l(la,cb){la=this.gbl(la,cb);la.sort((vb,ec)=>vb.y-ec.y);return this.Rcn(la)}gbl(la,cb){const vb=[],ec=this.Sg.ar,xc=this.zoom;la=gh.f(la,!0);for(let ad=0,Zd=la.length;ad<Zd;ad++){const pe=la[ad],Td=gh.g(pe);Td&&vb.push(new Xo(pe,Td,xc,ec,cb))}return vb}Rcn(la){let cb=null;const vb=[];for(let ec=0;ec<
la.length;ec++)cb&&Math.abs(la[ec].y-cb.y)<Zj.gpi+Zj.ovm?cb.Tvk(la[ec].oHd):(cb=la[ec],vb.push(cb));return vb}fbl(la,cb,vb,ec){const xc=la.Fg.ownerDocument,ad=xc.createElement("div");ad.className=Mh.dHh;ad.style.top=vb+"px";ad.style.left=ec+"px";ad.style.right="auto";ad.style.zIndex="40";gc.a.Sl(ad,Og.a.sJc,cb.oHd);cb=xc.createElement("span");this.Lpg(cb,ad);ah(wg[0],cb);this.fC(cb,la);return ad}Lpg(la,cb){la.title=CommonUIStrings.l_CommentHintTooltip;la.setAttribute("role","button");cb.appendChild(la)}fC(la,
cb){this.ig.nE(Bf.a.click,la,this.kpn.bind(this),cb);this.ig.ob(Bf.a.vB,la,this.npn.bind(this));this.tk.ob(Bf.a.g1,la,this.ppn.bind(this));this.tk.ob(Bf.a.xL,la,this.opn.bind(this));this.yE.ob(la,this.mpn.bind(this))}static hdl(la){la=la.Fg.ownerDocument.createElement("div");la.className=Mh.y_i;return la}mpn(){return!0}npn(){return!0}kpn(la){const cb=gh.g(la.Xw.parentNode);la.eventName===Bf.a.hK&&(this.Asa.j8e(),this.bFh());this.ga.Qb(Xe.a.eHh,2,cb);return!0}ppn(la){this.uFa(this.Hvb)!==la.Xw&&(la=
gh.g(la.Xw.parentNode),this.ga.Qb(Xe.a.t9e,2,la));return!0}opn(){this.ga.processAction(Xe.a.tHd,2);return!0}Uac(la){this.bFh();this.Hvb=la;this.YEk()}YEk(){this.ZEk(this.uFa(this.Hvb),this.uFa(this.bzb))}fkb(la){this.GYk();this.bzb=la;if(la=this.uFa(this.bzb)){const cb=this.gSd(la);this.Wge(la,cb,1)}}uFa(la){if(!la)return null;let cb=null;if(la=this.Yh.m0(la))if(la=la.Df?this.Yh.ZD(la.Df):la)cb=la.objectId;return cb&&this.pid.has(cb)?this.pid.get(cb).firstChild:null}bFh(){this.IYk(this.uFa(this.Hvb),
this.uFa(this.bzb))}IYk(la,cb){if(la){const vb=this.gSd(la);this.Wge(la,vb,la===cb?1:3);this.Hvb=null}}ZEk(la,cb){la&&(la.title=0<this.Unc.KTf&&1<this.Unc.xrb?CommonUIStrings.l_CommentHintTooltip+String.format(CommonUIStrings.l_CommentHintNthOfTotal,this.Unc.KTf,this.Unc.xrb):CommonUIStrings.l_CommentHintTooltip,cb!==la&&(cb=this.gSd(la),this.Wge(la,cb,2)))}GYk(){const la=this.uFa(this.Hvb),cb=this.uFa(this.bzb);if(cb){const vb=this.gSd(cb);this.Wge(cb,vb,la===cb?2:3);this.bzb=null}}Wge(la,cb,vb){this.hOm()?
this.Ajo(la,vb):this.zlo(la,cb,vb)}Ajo(la,cb){la=null===la||void 0===la?void 0:la.querySelectorAll(".OfficeIconColors_HighContrast");0<(null===la||void 0===la?void 0:la.length)&&(la[0].style.fill=2===cb||1===cb?"Highlight":"ButtonText")}zlo(la,cb,vb){cb=$f[cb];for(let xc=0;xc<cb.length;xc++){var ec=cb[xc];const ad=di(ec,vb);if(!this.GKm(ad)){a.ULS.sendTraceTag(512262488,327,15,`The following CSS variable is undefined: ${ad}.`);break}ec=null===la||void 0===la?void 0:la.querySelectorAll("."+ec);0<(null===
ec||void 0===ec?void 0:ec.length)&&(ec[0].style.fill=`var(${ad})`)}}hOm(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch{return!1}}gSd(la){return gc.a.Eb(la,Mh.oHh)}GKm(la){var cb;const vb=document.getElementById(Fj.AppFrame.vMc);return!(null===(cb=null===vb||void 0===vb?void 0:vb.style)||void 0===cb||!cb.getPropertyValue(la))}}Mh.dHh="clip16x16 HintContainer";Mh.a2k=".clip16x16.HintContainer";Mh.y_i="OutlineElementHintMargin";Mh.oHh="CommentIconType";Object(e.a)(Mh,
"CommentHintActor",eh.a,[399]);var Ca=c(1027);class zb extends Ca.a{get Igg(){return this.v0()}get Bgf(){return this.b8o.vhi()}constructor(la,cb,vb,ec,xc,ad,Zd,pe,Td,Ie){super();this.Ch=la;this.Vr=cb;this.Kj=vb;this.taskManager=ec;this.lBd=xc;this.YK=ad;this.zh=Zd;this.getSelectedText=pe;this.b8o=Td;this.focusManager=Ie;this.Z1c=()=>{};this.u7d=()=>{};this.cMg=!1;this.PUk={[0]:()=>this.nRh(),[1]:()=>this.imc.r3e(),[2]:()=>this.nRh()};this.oZf=()=>{this.lBd.kIa(11)};this.m4e=We=>{if(this.Vr.uBb)for(const Vf of gh.t)We.bindAction(md.KeyInputManager.NG(Vf),
rf.a.W5e)};this.A8d=()=>{this.u7d()};this.z8d=(We,Vf)=>{if(We.name!==ed.AFrame.Ur&&Vf){var tf=this.Kj.tt?this.Kj.tt.id:"";this.Ch.sMb||(this.Ch.sMb=ji.a.R3(this.taskManager,()=>{this.Z1c(tf)}))}};this.DYi=()=>{};this.wnb=()=>{this.Wrj()};this.ZUf=(We,Vf)=>{0===Vf&&(this.YK.Fce(),this.lBd.kIa(0))};this.pWf=()=>{this.lBd.kIa(5)};this.nRc=We=>{let Vf=0;const tf=this.Kj.bP();for(let yf=0;yf<tf.length;yf++){if(tf[yf].Df||tf[yf].done)continue;if((tf[yf].$q===Hd.a.beingCreated?tf[yf].Bz.draftId:tf[yf].id)===
We.contentId)break;const lf=this.Jx.getContentAnchorPosition(tf[yf].id);!lf||4<Math.abs(We.anchorTop-lf.anchorTop)||Vf++}return Vf};this.HTi=()=>{this.YK.Fce()};this.kYf=()=>{this.lBd.kIa(2)};this.Wrj=()=>{if(!this.cMg&&this.zh.Pea){const We=this.zh.Pea.getElementsByClassName(Mh.dHh);for(let Vf=0;Vf<We.length;Vf++)We[Vf].style.opacity="1";this.cMg=!0}}}initialize(la,cb){this.Jx=la;this.imc=cb;this.r6c();this.Vr.Ghb&&this.eXn()}Zio(la,cb){this.u7d=la;this.Z1c=cb}K7h(la,cb){return{H_a:this.XSl(la,cb),
containerContentByType:{}}}y7h(la,cb){const vb=oe.Z8h(this.Kj.bP(),this.Kj.lia),ec=[],xc=gh.e(!0);var ad=this.Kj.bP();cb=this.ZIn(cb,ad,vb);!cb.z2f&&cb.contentAnchorPosition&&(ec.push(cb.contentAnchorPosition),cb.contentAnchorPosition=null);for(ad=0;ad<xc.length;ad++){const Zd=xc[ad],pe=gh.g(Zd);if(pe)for(let Td=0;Td<pe.length;Td++){const Ie=this.getContentAnchorPosition(la,vb,Zd,pe[Td]);Ie&&(ec.push(Ie),cb.z2f&&cb.contentAnchorPosition&&Ie.contentId===cb.z2f.id&&(ec.push(cb.contentAnchorPosition),
cb.contentAnchorPosition=null))}}cb.contentAnchorPosition&&ec.splice(0,0,cb.contentAnchorPosition);return{L2k:vb,contentAnchorPositions:ec}}YHf(){var la;return!(null===(la=this.Jx)||void 0===la||!la.getAreContainersEnabled())}v0(){return this.Kj.yac()}cgg(){return this.v0()}N$c(){return this.v0()}Ngg(){return this.Jx&&this.zh.Pea&&this.v0()}ELo(){this.YK.s$("OnFloatingCommentsVisibilityChange",this.Ch.VIa);if(this.Ch.VIa)this.zh.lRb();else{const la=this.Kj.rJ;la.Tz&&la.clearSelection();this.zh.JWd()}}sYi(la){0!==
la&&this.Z1c(this.Kj.tt?this.Kj.tt.id:"")}getContentAnchorPosition(la,cb,vb,ec){let xc=null;return({value:xc}=cb.Fc(ec.toString(),xc)).returnValue?(cb=xc[0])&&!cb.Df?{...(new Ne.a),anchorTop:(Cc.a.pQc(vb)-la)/this.zh.cca,anchorLeft:0,containerContentType:0,contentId:cb.id}:null:null}ZIn(la,cb,vb){var ec,xc;const ad={};"CREATE"===(null===(xc=null===(ec=this.Kj.Qx)||void 0===ec?void 0:ec.Bz)||void 0===xc?void 0:xc.sessionType)&&(ec=this.zh.Pea.querySelectorAll(gh.b),la=this.zh.i5h((0<ec.length?ec[0]:
null)||this.getSelectedText(),this.Kj.Qx.Bz.draftId,0,la),ad.z2f=this.C9l(cb,vb),ad.contentAnchorPosition=la);return ad}C9l(la,cb){var vb=Array.indexOf(la,this.Kj.Qx);for(--vb;-1<vb;vb--)if(cb.nb(la[vb].objectId))return la[vb]}XSl(la,cb){return this.y7h(la,cb).contentAnchorPositions}r6c(){this.YK.u$("OnAfterTrackChangeMarkupViewChange",(la,cb)=>{if(cb)this.PUk[cb.Nj]()})}eXn(){this.YK.u$("OnFloatingCommentsToggle",this.ELo.bind(this))}nRh(){const la=gh.i();if(0!==la.length){var cb=oe.Z8h(this.Kj.bP()),
vb=this.Kj.rJ;for(let ec=0;ec<la.length;ec++){const xc=gh.g(la[ec]);for(let ad=0;ad<xc.length;ad++){let Zd;({value:Zd}=cb.Fc(xc[ad].toString(),Zd)).returnValue&&(Zd.forEach(pe=>{var Td;pe&&!pe.Df&&(this.imc.deleteContainer(pe.id,0,!1),(null===(Td=vb.Tz)||void 0===Td?void 0:Td.id)===pe.id&&vb.clearSelection())}),this.focusManager.mg(ed.AFrame.In))}}}}}Object(e.a)(zb,"CommentFloatingContainerActor",Ca.a,[412]);var pc=c(1500),Dc=c(2068),dc=c(197);class he extends pc.a{constructor(la,cb,vb,ec,xc,ad,Zd,
pe,Td){super();this.$$j=la;this.U$a=cb;this.Mwe=vb;this.ti=xc;this.qaa=pe;this.G2=Td;this.fj=null;this.Nj=1;ec.execute(Ie=>{this.fj=Ie});this.f3=[];this.Gsc=new dc.ScriptSharpLegacyMap;this.WUn(ad,Zd);this.r6c()}get rj(){return this.$$j.value}get Q1k(){return this.U$a}get Nca(){return!!this.fj}get gkb(){return 0}get A3a(){return this.f3}get XYg(){return this.Gsc.nb(this.Nj)?this.Gsc.J(this.Nj):this.Gsc.J(0)}PRa(la){return this.qaa.PRa(la)}V2a(la,cb){if(la=Object(Qb.a)(400,la))for(const vb of this.pJn(la))cb.add(vb)}HHa(la,
cb){this.Nca&&this.ti.ie(()=>{this.Trn(la,cb)},"CHA:OPHC")}Trn(la,cb){if(this.fj.Go.yac()){var vb=this.Dr.mEa,ec=new fa.a(new Xd.a),xc=cb.dIa("*"),ad=this.zSl(vb),Zd=!!vb&&!vb.action||!!ad&&ad===this.fj.Tz,pe;this.ti.ie(()=>{this.Mwe.A7l(la.id,ec,null===ad||void 0===ad?void 0:ad.objectId)},"OPHC:GOI");this.ti.ie(()=>{pe=this.XYg.izh(xc,ad,ec,Zd);pe.lwi=this.jwi(vb)&&0===vb.action},"OPHC:BHI");this.ti.ie(()=>{this.XYg.Iuh(xc,pe,Zd)},"OPHC:AH")}}zSl(la){let cb=null;!this.jwi(la)||0!==la.action&&2!==
la.action||(cb=this.Dr.mEa.HA);return cb||this.fj.Tz}pJn(la){if(!la)return[];la=this.rj.Eb(ua.a.If(la.objectId));return this.Q1k.yTd(la,null)}G$i(){return!1}LF(la,cb,vb){this.Nca&&(la=Object.assign(new Dc.a,{action:la,type:0,HA:cb,VJ:vb}),this.Dr.LF(la))}j8e(){this.Nca&&(this.LF(3,this.fj.bbc,this.fj.bbc),this.fj.bbc=null)}WUn(la,cb){this.Gsc.add(1,la);this.Gsc.add(0,cb)}r6c(){this.G2.u$("OnBeforeTrackChangeMarkupViewChange",(la,cb)=>{cb&&cb.tTf!==this.Nj&&(this.Nj=cb.tTf)})}jwi(la){return la&&0===
la.type}}Object(e.a)(he,"CommentHighlightActor",pc.a,[411,333]);var Rc=c(1050),qe=c(327),bf=c(503),Cf=c(1534);class bh{constructor(la,cb){this.x2k=la;this.TUf=cb}}Object(e.a)(bh,"CommentEndParaIdBeforeChangeInfo",null,[]);var Lg=c(1638);class Th{constructor(la,cb,vb,ec,xc,ad,Zd,pe){this.NKf=la;this.Ch=cb;this.Kj=vb;this.YK=ec;this.sm=xc;this.Ik=ad;this.U1k=Zd;this.Vr=pe;this.ztb=null;this.$In=(Td,Ie)=>{(Td=Ie.commentNode)&&!gh.s(Td)&&(Ie=this.Kj.gpf(Td),ua.a.Dq(Ie.Rad,Ie.gNc)||this.MFj(Ie,Td)||this.MDh(Ie.QDa,
Ie.HOa,Td)||this.Xpg(Td))};this.vln=(Td,Ie)=>{Ie.property===sa.a.kwa&&(Td=gh.h(Ie.node,ua.a.nil),this.ztb=new bh(Ie.node.id,Td))};this.Hmn=(Td,Ie)=>{Td=Ie.node;if(Ie.property===sa.a.kwa&&Td){var We=gh.k(Td,ua.a.nil);Ie=gh.h(Td,ua.a.nil);var Vf=this.ztb?this.xd.Eb(this.ztb.TUf):null;!gh.s(Td)&&We&&!We.equals(Ie)&&this.ztb&&Td.id.equals(this.ztb.x2k)&&!We.equals(this.ztb.TUf)&&Vf&&Vf.isConnected&&this.i_e(this.ztb.TUf,Td.id);Ie&&this.Ch.$x.nb(Ie)&&(We=this.Ch.$x.J(Ie),We.t3a&&(a.ULS.shipAssertTag(572835481,
327,!!We.cN,"Paranode with HasSpanningComment true should have non null OpenCommentObjIds"),We.cN&&We.cN.contains(Td.id)&&(We.cN.remove(Td.id),We.cN.count||(We.t3a=!1),this.Ch.gV.nb(Td.id)?this.Ch.gV.J(Td.id).remove(Ie):a.ULS.sendTraceTag(572835482,327,15,"[OnPropertyChanged] OpenComment -> ParaNodes entry missing!"))))}};this.t2c=(Td,Ie)=>{Td=Ie.node.id;this.Ch.$x.nb(Td)&&this.i0n(Td)};this.fln=(Td,Ie)=>{Ie&&Ie.node&&this.AWa.nb(Ie.node)&&(Td=this.AWa.J(Ie.node).E9d,this.AWa.nb(Td)||(Td=this.AWa.J(Ie.node),
this.MDh(Td.cdf?Td.currentNode:Td.E9d,Td.cdf?Td.E9d:Td.currentNode,Td.commentNode)||this.Xpg(Td.commentNode)),this.AWa.remove(Ie.node))};this.Kmn=(Td,Ie)=>{const We=Td.Lj;if(!Ie&&this.kdb.nb(We)){var Vf;(Vf=this.kdb).Z(We,Vf.J(We)&(Td.Oc?-2:-3));this.kdb.J(We)||(this.Xpg(this.xd.Eb(We)),this.kdb.remove(We))}};this.AWa=new bf.a(new Rc.a);this.kdb=new wc.a(gh.c);this.YK.u$("OnCommentNodeAdded",this.$In);this.Vr.contentFilterApiEnabled?(this.YK.u$("OnCommentPaneOpen",this.zGm.bind(this)),this.YK.u$("OnCommentPaneClose",
this.yGm.bind(this)),this.YK.u$("OnContentFilterUpdate",this.k2c.bind(this))):["OnCommentPaneOpen","OnCommentPaneClose"].forEach(Td=>{this.YK.u$(Td,this.wGm.bind(this))});this.Vr.Ghb&&this.YK.u$("OnFloatingCommentsVisibilityChange",this.xGm.bind(this));la=this.sm.Ue(12);la.Vw(this.t2c);la.ju(this.fln);this.sm.Ue(40).cGc(this.vln);this.sm.Ue(40).Eo(this.Hmn);qe.a.FTa(this.Kmn)}get ox(){return this.NKf.value}get xd(){return this.ox.xd}A7l(la,cb,vb){if(this.qAn(la))for(const ec of this.Ch.$x.J(la).cN)!this.$pj(ec,
vb===ec.toString())||cb.add(ec)}$pj(la,cb){const vb=this.xd.Eb(la),ec=gh.s(vb);if(!vb||ec)return!1;la=this.Kj.m0(la.toString());return!la||this.Vr.contentFilterApiEnabled&&this.Ch.Bm&&!this.U1k.isContentInFilteredContent(la.id)||!this.Ch.Bm&&!this.Kj.lia(la)&&!cb?!1:!0}qAn(la){return this.Xzn(la)}Xpg(la){if(la){var cb=Cf.a.yTd(la,null),vb=new Wa.a;for(let ec=1;ec<cb.length-1;ec++)this.i_e(cb[ec].id,la.id),vb.add(cb[ec]);Rm.b(vb)}}xGm(){const la=new Wa.a;for(const cb of this.Kj.bP())!cb.Df&&cb.$q!==
Hd.a.beingCreated&&this.Kj.lia(cb)&&this.Kj.zoe(cb,la);Rm.b(la)}Xzn(la){if(!this.Ch.FY)return!1;let cb=null;if(({value:cb}=this.Ch.$x.Fc(la,cb)).returnValue)return cb.t3a;let vb=!1;this.Ik.ie(()=>{const ec=gh.e();for(let xc=0;xc<ec.length;xc++)vb=this.wYo(ec[xc],la,vb);vb||(this.Ch.$x.add(la,new Lg.a),this.Ch.$x.J(la).t3a=!1)},"CHORA:PHOC");return vb}wYo(la,cb,vb){la=gh.g(la);if(!la)return vb;for(let ec=0;ec<la.length;ec++){const xc=this.xd.Eb(la[ec]);xc&&!gh.s(xc)&&(vb=vb||this.pVk(xc,cb))}return vb}pVk(la,
cb){var vb=this.Kj.gpf(la);if(this.MFj(vb,la))return!1;var ec=vb.Rad;const xc=vb.gNc;vb=vb.QDa;if(ec!==ua.a.nil&&(ec.equals(xc)||ec.equals(cb)))return!1;for(ec=fb.ParagraphReader.Xf(vb,!1);ec&&!ec.id.equals(xc);){if(ec.id.equals(cb))return this.i_e(cb,la.id),!0;ec=fb.ParagraphReader.Xf(ec,!1)}return!1}i_e(la,cb){this.Ch.gV.nb(cb)||this.Ch.gV.add(cb,new fa.a(new Xd.a));this.Ch.gV.J(cb).add(la);this.Ch.$x.nb(la)?this.Ch.$x.J(la).cN||(this.Ch.$x.J(la).cN=new fa.a(new Xd.a)):this.Ch.$x.add(la,new Lg.a(!0));
this.Ch.$x.J(la).t3a=!0;this.Ch.$x.J(la).cN.add(cb)}i0n(la){if(this.Ch.$x.J(la).cN)for(const cb of this.Ch.$x.J(la).cN)this.Ch.gV.nb(cb)?this.Ch.gV.J(cb).remove(la):a.ULS.sendTraceTag(572835483,327,15,"[OnDisconnected] OpenComment -> ParaNodes entry missing!");this.Ch.$x.remove(la)}wGm(){const la=new Wa.a;for(const cb of this.Kj.bP())cb.Df||cb.$q===Hd.a.beingCreated||this.Kj.lia(cb)||this.Kj.zoe(cb,la);Rm.b(la)}zGm(){this.ZCf("OnCommentPaneOpen")}k2c(){this.ZCf("OnContentFilterUpdate")}yGm(){this.ZCf("OnCommentPaneClose")}ZCf(la){const cb=
new Wa.a;for(const vb of this.Kj.bP())vb.Df||vb.$q===Hd.a.beingCreated||this.Kj.rJ.CBh(la,vb)||this.Kj.zoe(vb,cb);Rm.b(cb)}MFj(la,cb){let vb=!1;if(!la.lke||!la.KMd){vb=!0;if(!la.QDa||!la.HOa)return a.ULS.sendTraceTag(571025377,327,15,"Anchor para nodes missing, start={0}, end={1}",!la.QDa,!la.HOa),!0;la.lke||this.AWa.nb(la.QDa)||this.AWa.add(la.QDa,{commentNode:cb,currentNode:la.QDa,E9d:la.HOa,cdf:!0});la.KMd||this.AWa.nb(la.HOa)||this.AWa.add(la.HOa,{commentNode:cb,currentNode:la.HOa,E9d:la.QDa,
cdf:!1})}return vb}MDh(la,cb,vb){la=Cf.a.Ewa(la,vb.id,!0);cb=Cf.a.Ewa(cb,vb.id,!1);let ec;la||({value:ec}=this.kdb.Fc(vb.id,ec),this.kdb.Z(vb.id,ec&1));cb||({value:ec}=this.kdb.Fc(vb.id,ec),this.kdb.Z(vb.id,ec&2));return!la||!cb}}Object(e.a)(Th,"CommentHighlightOnRestActor",null,[401]);var ak=c(547),Ih=c(436),xj=c(634);class Uh{constructor(la,cb){this.pAb=la;this.Ala=cb}getViewContainer(){return this.pAb}registerForViewContainerEvents(la){this.Ala.EYn(la)}unregisterForViewContainerEvents(la){this.Ala.iTo(la)}}
Object(e.a)(Uh,"ViewContainerProvider",null,[843]);class ul{constructor(la,cb,vb,ec){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=la;this.appLocale=cb;this.uiCulture=vb;this.dataCulture=ec}}Object(e.a)(ul,"LocalizationDetails",null,[]);var ti=c(1160),Vh=c(1548),Ad=c(480);class Id{constructor(la,cb,vb,ec,xc,ad,Zd,pe,Td,Ie,We,Vf,tf,yf,lf,Rk,hm,Lj,Bk,Zi,Rj,tm,dh,uk,gl,Um,Sk,en,Do,Ui,lp){this.Zq=la;this.Kj=cb;this.c5b=vb;this.X_=ec;this.Vr=xc;this.Ch=ad;
this.ZOd=Zd;this.Vac=pe;this.eq=Td;this.oc=Ie;this.dynamicScriptLoader=We;this.o9n=Vf;this.focusManager=tf;this.B9e=yf;this.x9e=lf;this.Fnh=Rk;this.q3o=hm;this.M1=Lj;this.YK=Bk;this.Y$n=Zi;this.sAl=Rj;this.iTi=tm;this.r3o=dh;this.CCb=uk;this.ZT=gl;this.zh=Um;this.sN=Sk;this.P$e=en;this.r6a=Do;this.uHd=Ui;this.a6k=lp;this.ood=this.NYa=null;this.q_g=!1;this.HMe=[];this.meh=this.r_g=!1;this.initialize=(Ji,rj)=>{this.rAm(rj)};this.Whl=Ji=>nk.a.wId(Ji);this.Lmn=()=>{this.hsi()};this.WYl=(Ji,rj,im)=>{Ji=
{...(new ti.a),containerPanel:Ji,paneOpenedCallback:rj,paneClosedCallback:im,ulsLogger:new ak.a,canvasAndFcHostOffset:wacBoot.ShiftUtils.canvasAndFcOuterSurfaceOffset,isRtl:y.AFrameworkApplication.isRtl,viewportInfo:this.zh.Upf(),destroyAllContainersCallback:()=>{this.Ch.Bm||a.ULS.sendTraceTag(571342851,327,10,"The pane is not open but we are destroying the containers!")},featureGates:{deselectionEnabled:!0,floatingContainerVirtualizationEnabled:this.Vr.$Od,synchronousContainerPositioningEnabled:!1,
trackChangeInSidetrackEnabled:this.Vr.trackChangeInSidetrackEnabled,improveJumpingFixEnabled:!1,shouldInitialize:!this.Vr.contentNavigationApiEnabled,scrollingPerfImprovementEnabled:!1,contentNavigationApiEnabled:this.Vr.contentNavigationApiEnabled,contentFilterApiEnabled:this.Vr.contentFilterApiEnabled,returnToDraftFixEnabled:!0}};this.Vr.contentNavigationApiEnabled&&(Ji.sidetrackContentNavigationApi=this.P$e,Ji.featureGateApiSettings=this.ZT.Bgf,Ji.telemetryDetails=this.iTi,this.Vr.contentFilterApiEnabled&&
(Ji.contentFilterAPI=this.a6k));return floatingContainerManager.FactoryGlobal.getFCManagerInstance(Ji)};this.Don=Ji=>{2!==this.Zq.mode&&3!==this.Zq.mode&&this.Kj.tt&&Ji===this.Kj.tt.id&&this.Zq.clearSelection();Q.App.za.updateCommandUI(!0)};this.AUi=(Ji,rj)=>{this.Fx("onCSCStart",window.performance.now());this.Leb&&!Ji&&(this.Pwn(),this.Fx("openInFishbowl",!0));this.c5b.Peb&&this.Vr.SDb&&this.oc.processAction(Xe.a.qHa,2);rj&&rj();this.Fx("onCSCEnd",window.performance.now())};this.YK.u$("OnCommentInit",
this.initialize);this.YK.u$("OnCommentRenderedOnce",this.Lmn);this.ZT.Zio(()=>{},this.Don);this.Vr.Ghb&&Ad.a.hTc&&(this.Ch.VIa=!1)}get mLa(){return this.Zq}get Leb(){return this.Ch.Leb}Fx(la,cb){this.r6a.Fx(tl.a.comments,la,cb,!0)}rAm(la){if(this.Ch.FY)la&&la.tHa&&la.tHa();else if(this.q_g)(null===la||void 0===la?0:la.tHa)&&this.HMe.push(la.tHa);else{var cb=this.Vr.zac;this.Fx("hasCommentOnBoot",cb);cb?this.CCb.logKpiUsage(Vh.a.b5b,0):Ih.a.bjn();this.q_g=!0;this.Fx("initInProgress",!0);this.Kj.initialize(this.Zq);
this.c5b.initialize(this.Zq,null);this.c5b.ipj(this.Zq);this.Vac.lBm(this.X_.Jno);this.Fx("InitAMSetup",window.performance.now());xj.a.Gp(this.sAl).continueWith(vb=>{(this.NYa=vb.result)||a.ULS.sendTraceTag(574734881,327,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");this.B9e.initialize(this.NYa);this.mLa.p9e.initialize(this.mLa,this.Kj,this.NYa,this.B9e);this.Fnh.initialize(this.dynamicScriptLoader,this.mLa.p9e,this.iTi,this.NYa,new Uh(this.q3o,this.r3o),this.jci(),"",this.B9e.vhi(),
this.M1,Q.App.cie);this.Fx("AMInitialized",window.performance.now());this.Vr.contentNavigationApiEnabled?(Q.App.gFb?Q.App.gFb:this.zh.THi()).then(()=>{this.Fx("FCMLoaded",window.performance.now());this.l$c();this.mYd(la)}):this.mYd(la)})}}UFn(){var la;null===(la=sharedComments.setDarkModeColorHandler)||void 0===la?void 0:la.call(sharedComments,this.Whl)}mYd(la){this.ood=this.Fnh.mYd(void 0,this.UFn.bind(this));this.VUc(la);this.Ch.FY=!0;this.Vr.lig&&this.x9e.initialize()}VUc(la){if(!this.Ch.nIb){this.Fx("InitCSStart",
window.performance.now());var cb=this.eq.Zf("Task","InitiateCommentingSession");this.CCb.logKpiUsage(Vh.a.pHh,0);try{const vb=this.eq.Zf("Task","InitiateCommentingSession-UpdateModel");this.uHd.JAm();vb.stop();this.Fx("initAtBoot",window.performance.now());this.Vr.ar&&this.Kj.yac()&&a.ULS.sendTraceTag(574734882,327,50,String.format("Comments loaded into the model at {0}",H.a.$e()));Yj.a.get_instance().nI(12);a.ULS.sendTraceTag(574734883,327,50,"CommentRendered AppInitializationStatus was set");this.Ch.nIb=
!0;this.ood.then(()=>{this.Fx("SCLoaded",window.performance.now());this.zh.cBm();this.Fx("FCMInitiated",window.performance.now());if(this.Vr.ar){let xc=!1;if(this.Leb){var ec=this.X_.VQd(this.Leb);ec?(y.AFrameworkApplication.oe("3ge3g205;cha3g788"),ec=this.X_.WQd(ec,0),ec)?this.Kj.lia(ec)||(xc=!0,this.Qwn(ec)):(xc=!0,this.Y5a()):xc=!0}ec=la?la.sVi:null;this.Vr.contentNavigationApiEnabled?this.AUi(xc,ec):this.B2m(xc,ec)}la&&la.tHa&&la.tHa();for(const xc of this.HMe)xc();this.r_g&&this.hsi();this.HMe=
[]})}catch(vb){a.ULS.Vz(539567713,327,10,vb,`Comments Initialization Failed: ${vb}`),this.CCb.logKpiFailure(Vh.a.pHh,"CommentsInitializationFailed",{isInternal:!0},{name:Vh.a.a5b,isInternal:!0})}finally{cb.stop(),this.Fx("InitCSEnd",window.performance.now())}this.oc.processAction(Xe.a.SGh,2)}}Qwn(la){this.oc.processAction(Xe.a.LV,2);this.ZT.Wrj();ji.a.R3(y.AFrameworkApplication.lc,()=>{this.X_.selectComment(la,{...(new af.a),mS:!0,E$:1});this.focusManager.mg(ed.AFrame.Ur);a.ULS.sendTraceTag(574734912,
327,50,"opened resolved deeplinked comment using pane, time since boot = {0}",(new Date).getTime()-y.AFrameworkApplication.vX)},Li.a.Gco);this.CCb.Tv(Xe.a.s9e);y.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordLinkToCommentSettings")}Y5a(){this.oc.processAction(Xe.a.Y5a,2)}B2m(la,cb){(Q.App.gFb?Q.App.gFb:this.zh.THi()).then(()=>{this.Fx("FCMLoaded",window.performance.now());this.l$c();this.AUi(la,cb)}).catch(vb=>{a.ULS.sendTraceTag(574734913,327,15,"Failed to load floatingContainerManager script: "+
vb.toString())})}l$c(){this.sN.trackChangeInSidetrackEnabled?(this.ZOd.l$c(),this.Fx("STSet",window.performance.now())):this.ZOd.mpj(this.WYl)}hsi(){this.meh||(this.Ch.FY&&this.ood?(this.ood.then(()=>{const la=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();this.Y$n.execute(cb=>{la.registerSafelinksNavigator(cb.uoc.bind(cb))});this.o9n.execute(cb=>{cb.ZUn(la)})}),this.meh=!0):(a.ULS.sendTraceTag(571618846,327,15,"[InitializeRichContentEditAPI] Shared comments runtime not yet loaded"),
this.r_g=!0))}jci(){return new ul(y.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,y.AFrameworkApplication.uiCulture,y.AFrameworkApplication.dataCulture)}Pwn(){this.X_.xij(this.Leb,{...(new af.a),Bgg:!1,oWc:!0});this.CCb.Tv(Xe.a.s9e)}}Object(e.a)(Id,"CommentInitActor",null,[]);class xe{constructor(la,cb,vb,ec,xc,ad){this.ig=la;this.yE=cb;this.ga=vb;this.BZj=ec;this.vj=xc;this.Sg=ad;this.dpe=this.pXa=null}get zoom(){let la=1;this.vj&&this.vj.instance&&(la=this.vj.instance.nj);return 0<
la?la:1}VBl(la,cb){if(!this.dpe||!la.rxa||cb>=la.rxa.length)return null;const vb=this.zoom,ec=la.w5,xc=la.d0a(1,Zj.kBf,vb,cb);return this.lal(la.rxa[cb],ec,(this.dpe.y-la.L4[cb].y)/vb+Zj.oMj,xc)}lal(la,cb,vb,ec){if(this.pXa)return(cb=this.pXa.parentElement)&&cb.removeChild(this.pXa),this.clj(la,this.pXa,vb,ec),this.pXa;const xc=cb.Fg.ownerDocument,ad=xc.createElement("div");ad.className=xe.R1k;this.clj(la,ad,vb,ec);la=xc.createElement("span");this.Lpg(la,ad);ah(wg[4],la);this.lWn(la,cb);return this.pXa=
ad}Lpg(la,cb){la.title=CommonUIStrings.l_CommentNewCommentButton;la.setAttribute("role","button");cb.appendChild(la)}lWn(la,cb){this.ig.nE(Bf.a.click,la,this.ion.bind(this),cb);this.ig.ob(Bf.a.vB,la,this.kon.bind(this));this.yE.ob(la,this.jon.bind(this))}DWd(){if(this.pXa){const la=this.pXa.parentElement;la&&la.removeChild(this.pXa)}}clj(la,cb,vb,ec){this.Sg.A9n||this.BZj.zsl(la,vb)?cb.style.left=ec+Zj.kBf+"px":cb.style.left=ec+"px";cb.style.top=vb+"px";cb.style.right="auto";cb.style.display="block";
cb.style.position="absolute";cb.style.overflow="hidden";cb.style.cursor="default";cb.style.zIndex="40"}kon(){return!0}ion(la){this.ga.MC=30;this.ga.processAction(Xe.a.qHa,2);la=la.Xw;ah(wg[4],la);la=la.parentElement;(null===la||void 0===la?0:la.parentElement)&&la.parentElement.removeChild(la);return!0}jon(){return!0}}xe.R1k="clip16x16 EntryPointContainer";Object(e.a)(xe,"CommentMarginEntryPointActor",null,[]);var ke=c(420),Gj=c(76),Ni=c(225),Bh=c(33),Nk=c(119);class Nh{constructor(la,cb,vb,ec,xc,
ad,Zd){this.NKf=la;this.r0m=cb;this.Go=vb;this.Ch=ec;this.Vr=xc;this.v9e=ad;this.CCb=Zd;this.j5i=new Set;this.aLb=new Set;this.X2c=new Ni.a;this.d5b=new Map;this.uHh=M.a.instance.Ve("Box4.CommentParagraphMapping");this.DCb=new Set;this.Lga=this.UQd()}get ox(){return this.NKf.value}get xd(){return this.ox.xd}get TDa(){return this.r0m.value}UQd(){const la=new Sd.GraphIterator;la.set(this.ox);this.TDa.Q5a(la);return la}JAm(){this.Ch.nIb&&a.ULS.sendTraceTag(523334300,327,15,"initializeCommentsAtBoot was called while the commenting session was already alive. [Call stack: {0}]",
Bh.Debug.f2a());this.Vr.contentNavigationApiEnabled||(this.Vr.zac&&this.HAm(),this.Go.BWi())}Oln(){this.sfj();this.DCb.forEach(la=>{this.Lvg(la)});this.DCb.clear();this.Go.BWi()}Lvg(la){if(ke.a.isEnabled){a.ULS.sendTraceTag(512235650,327,15,`Missing Start or End mapping info for Comment ${la}`);var cb=this.d5b.get(la).xmc,vb=this.d5b.get(la).R7b;cb===ua.a.nil||vb===ua.a.nil?a.ULS.sendTraceTag(512235652,327,15,`start ${cb} or end ${vb} has invalid value`):(this.uHh.value.y0a.set(la,cb),this.uHh.value.x0a.set(la,
vb),a.ULS.sendTraceTag(512235651,327,50,`Start ${cb} and End ${vb} mapping info for Comment ${la} added on Comment Model load`))}}oDm(la){const cb=[];for(const vb of la)la=vb.Lj.toString(),this.rFj(la,vb.paragraph.id,vb.Oc),vb.Oc&&(this.j5i.has(la)?a.ULS.sendTraceTag(523334301,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",vb.Lj):(this.j5i.add(la),(la=this.Vrk(vb))&&cb.push(la)));return cb}rFj(la,cb,vb){ke.a.isEnabled&&(this.d5b.has(la)||this.d5b.set(la,{xmc:ua.a.nil,R7b:ua.a.nil}),
vb?this.d5b.get(la).xmc=cb:this.d5b.get(la).R7b=cb)}Vrk(la){var cb=this.xd.Eb(la.Lj);this.Lga.Aj(cb);if(40!==this.Lga.Xe||!cb)return a.ULS.sendTraceTag(523334303,327,15,"[UpdateContent] Iterator is not at commentNode or CommentNode is null, commentnode is null: {0}, objId null: {1}",!cb,!la.Lj),this.Lga=39===this.Lga.Xe?this.Lga:this.UQd(),null;cb=this.Go.hJd(this.Lga);let vb;if(({index:vb}=this.Go.nne(cb)).returnValue)if(this.Go.FZe(cb,vb),this.aLb.add(cb.objectId),gh.p(cb)||this.DCb.add(cb.objectId),
cb.Df)this.Elf(cb);else return{contentId:cb.id,containerContentType:0,n$:{Bd:la.Lb.cp,bN:la.paragraph.Vk}};else this.X2c.add(cb);return null}Elf(la){if(la.Df){var cb=this.Go.ZD(la.Df);if(cb&&cb.Df){const vb=this.Go.ZD(cb.Df);vb&&(vb.Df?a.ULS.sendTraceTag(523270216,327,10,"Multiple chain of replies parented to other replies"):(la.Df=cb.Df,a.ULS.sendTraceTag(523270217,327,15,`Comment reply id pointing to another reply. objectid: ${la.objectId} parentObjectId: ${cb.objectId}`)))}}}HAm(){const la=new S.a(0),
cb=Gj.a.gp(this.Go.hKa),vb=new Set;this.Vr.oyn&&!ke.a.isEnabled&&this.cuk(cb,la);const ec=this.UQd(),xc=new Set,ad=new Set,Zd=new Xk.GraphTransaction(2);try{if(Zd.St(ec),ec.Jt(1)){for(;cb.moveNext();){if(!fb.ParagraphReader.oh(cb.iterator))continue;const Td=cb.iterator.currentNode,Ie=fb.ParagraphReader.QFb(Td);ke.a.isEnabled&&this.kan(Td,Ie,la);vb.add(Td.id.toString());this.G4i(Ie,ad,ec,xc)}this.sfj();const pe=this.ASl(vb);0<pe.length&&this.E8n(pe,vb,ec,ad);this.DCb.forEach(Td=>{this.Lvg(Td)});this.DCb.clear()}}finally{Zd&&
Zd.dispose()}0==this.aLb.size&&this.Vr.zac&&a.ULS.sendTraceTag(523334304,327,15,"Comments not loaded in model while graph has comments");Kc.a.E6m(xc,ad,this.xd)}G4i(la,cb,vb,ec){for(const xc of la){la=this.Vr.ar?!xc.Oc:xc.Oc;const ad=xc.Lj.toString();this.rFj(ad,xc.paragraph.id,xc.Oc);la?cb.has(ad)||ec.add(ad):cb.has(ad)?a.ULS.sendTraceTag(523334305,327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",xc.Lj):(cb.add(ad),this.Wrk(xc,vb))}}E8n(la,cb,vb,ec){const xc=this.M8l(la);Kc.a.qWk(xc);
const ad=new Set,Zd=new Set;xc.forEach(Td=>{cb.has(Td.id.toString())||Zd.has(Td.id.toString())||(Zd.add(Td.id.toString()),Td=fb.ParagraphReader.QFb(Td),a.ULS.sendTraceTag(523334306,327,50,`Retrying loading ${Td.length} CommentRangeObjects`),this.G4i(Td,ec,vb,ad))});const pe=[];la.forEach(Td=>{this.aLb.has(Td)||pe.push(Td)});0<pe.length&&(a.ULS.sendTraceTag(523334307,327,15,`Load Comments: ${pe.length} Failed To Load on Retry: ${pe.join(",")}`),this.CCb.logKpiFailure(Vh.a.b5b,"CommentsFailedToLoadOnRetry",
{isInternal:!0},{name:Vh.a.a5b,isInternal:!0}))}M8l(la){const cb=[];la.forEach(vb=>{if(vb=this.v9e.w7h(vb))vb=gh.k(vb),(vb=this.xd.Eb(vb))&&vb.xj&&cb.push(vb)});return cb}Wrk(la,cb){const vb=this.xd.Eb(la.Lj);cb.Aj(vb);40===cb.Xe&&vb?(la=this.Go.hJd(cb),({index:cb}=this.Go.nne(la)).returnValue?(this.Go.FZe(la,cb),this.aLb.add(la.objectId),gh.p(la)||this.DCb.add(la.objectId),la.Df&&this.Elf(la)):this.X2c.add(la)):(a.ULS.sendTraceTag(523334336,327,15,"[UpdateContent] Iterator is not at commentNode, commentnode is null: {0}, objId null: {1}",
!vb,!la.Lj),39===cb.Xe||this.UQd())}ASl(la){const cb=[],vb=this.v9e.uSl();if(this.aLb.size===vb.length)return cb;vb.forEach(ec=>{!this.aLb.has(ec)&&Kc.a.vXm(ec,la,this.v9e,this.xd)&&cb.push(ec)});return cb}sfj(){for(let la=0;la<this.X2c.length;la++){const cb=this.X2c.J(la);let vb;({index:vb}=this.Go.nne(cb)).returnValue?(this.Go.FZe(cb,vb),gh.p(cb)||this.DCb.add(cb.objectId),this.aLb.add(cb.objectId),cb.Df&&this.Elf(cb)):a.ULS.sendTraceTag(523334337,327,10,String.format("Orphaned Comment add on retry failed: CommentGuardID: {0}, DurableId: {1}, ObjectId: {2}, ParentId: {3}",
cb.cxa,cb.y1a,cb.objectId,cb.Df))}this.X2c.clear()}cuk(la,cb){la.yo(vb=>{if(11===vb.Xe){var ec=vb.currentNode;const xc=ec.ja(Nk.a.E9e,null),ad=ec.ja(Nk.a.C9e,null);vb=!!xc&&0<xc.length;const Zd=!!ad&&0<ad.length;vb&&xc.forEach(Td=>{const Ie=this.xd.Eb(Td);Ie&&!gh.s(Ie)&&cb.add(Td,0)});Zd&&ad.forEach(Td=>{cb.nb(Td)&&cb.remove(Td)});(ec=ec.ja(Xc.a.$K,null))&&ec.forEach(Td=>{const Ie=this.xd.Eb(Td);fb.ParagraphReader.Xb(Ie)&&!this.Ch.$x.nb(Td)&&this.Ch.$x.add(Td,new Lg.a)});const pe=cb.keys;for(let Td=
0;Td<pe.length;Td++){ec&&0<cb.J(pe.J(Td))&&(this.Ch.gV.nb(pe.J(Td))||this.Ch.gV.add(pe.J(Td),new fa.a(new Xd.a)),ec.forEach(We=>{const Vf=this.xd.Eb(We);fb.ParagraphReader.Xb(Vf)&&(this.Ch.$x.J(We).cN||(this.Ch.$x.J(We).cN=new fa.a(new Xd.a)),this.Ch.gV.J(pe.J(Td)).add(We),this.Ch.$x.J(We).t3a=!0,this.Ch.$x.J(We).cN.add(pe.J(Td)))}));let Ie;cb.Z(Ie=cb.keys.J(Td),cb.J(Ie)+1)}return vb||Zd}return!0},null)}kan(la,cb,vb){la&&(this.SSj(cb,vb),this.Ch.$x.nb(la.id)||this.Ch.$x.add(la.id,new Lg.a),vb.forEach((ec,
xc)=>{0<xc&&(this.Ch.gV.nb(ec)||this.Ch.gV.add(ec,new fa.a(new Xd.a)),this.Ch.$x.J(la.id).cN||(this.Ch.$x.J(la.id).cN=new fa.a(new Xd.a)),this.Ch.gV.J(ec).add(la.id),this.Ch.$x.J(la.id).t3a=!0,this.Ch.$x.J(la.id).cN.add(ec));vb.Z(ec,xc+1);return!0}))}SSj(la,cb){la.forEach(vb=>{if(vb.Oc){const ec=this.xd.Eb(vb.Lj);ec&&!gh.s(ec)&&cb.Z(vb.Lj,0)}else cb.nb(vb.Lj)&&cb.remove(vb.Lj)})}}Object(e.a)(Nh,"CommentModelBootLoader",null,[398]);var Vd=c(1061);class $p{constructor(la){this.rHh=la;this.uvc=null;
this.C7g=void 0;this.D7g=null;this.aAc=new Map;this.$ze=new Map}uYn(){Vd.a.FTa(this.bVo.bind(this))}bVo(la,cb){const vb=la.id.toString();var ec=la.getValue(sa.a.hF).toString();cb?(this.aAc.delete(vb),this.$ze.delete(ec)):(this.aAc.set(vb,la),this.$ze.set(ec,la));0===this.aAc.size&&this.uvc&&(la=+new Date-+this.uvc,this.uvc=null,a.ULS.sendTraceTag(543506649,327,50,`All Nodes Disconnected. Duration between first Node connection and all nodes disconnections : ${la}`));cb||this.C7g!==ec||(cb=+new Date-
+this.D7g,a.ULS.sendTraceTag(541878464,327,15,`Deeplinked Comment added after deeplink navigation failed: ${cb}`),ec=new K.a,ec.durationMs=cb,this.rHh.logKpiFailure(Vh.a.kHd,"CommentFoundAfterDeeplinkAttempt",{isInternal:!0,additionalValues:ec},{name:Vh.a.YGh,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:ec}));this.uvc||(this.uvc=new Date)}set oen(la){this.C7g=la;this.D7g=new Date;if(la=this.sSl(la))a.ULS.sendTraceTag(538789919,327,15,`Deeplinked Comment ${la.id} present but failed to load`),
la=new K.a,this.rHh.logKpiFailure(Vh.a.kHd,"CommentPresentButFailedToLoad",{isInternal:!0},{name:Vh.a.YGh,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:la})}uSl(){return[...this.aAc.keys()]}sSl(la){return this.$ze.get(la)}w7h(la){return this.aAc.get(la)}}Object(e.a)($p,"CommentNodeTracker",null,[]);class kf{get contentType(){return 0}constructor(la,cb,vb,ec,xc){this.dag=la;this.Go=cb;this.X_=vb;this.rJ=ec;this.Ch=xc;this.dag.e$i(this)}Bij(la,cb,vb){0===cb?(cb=this.Go.uWc(la),
this.X_.selectComment(cb?this.Go.Qx:this.Go.ZD(la),Object.assign(new af.a,{mS:vb||cb,E$:1}))):this.rJ.clearSelection()}Gqj(la){if(this.Ch.Bm||this.Go.uWc(la.contentId))return!0;const cb=this.Go.ZD(la.contentId);if(cb)return this.Go.lia(cb);a.ULS.sendTraceTag(508878870,327,10,`Failed to find comment for contentId: ${la.contentId}`);return!1}}Object(e.a)(kf,"CommentReviewSuggestionContentActor",null,[397]);class kh{get oxj(){return this.mkg}constructor(la,cb){this.uHd=la;this.Vr=cb;this.mkg=new Set([12])}initialize(){}aIi(la){if(!fb.ParagraphReader.Xb(la.node))return[];
la=fb.ParagraphReader.QFb(la.node);return this.uHd.oDm(la)}fUi(){this.uHd.Oln()}oni(){return this.Vr.Izo?this.Vr.zac:!0}}Object(e.a)(kh,"CommentReviewSuggestionContentProvider",null,[396]);var aq=c(309),cg=c(70),og=c(129),Tg=c(253),Ue=c(1598);class Nb{constructor(){this.commentId=null;this.gYc=!1}}Object(e.a)(Nb,"CommentToSelectOnPaneLoadData",null,[]);class Ll{constructor(la,cb,vb,ec,xc,ad,Zd,pe,Td,Ie,We,Vf,tf,yf,lf){this.Zq=la;this.Go=cb;this.SDa=vb;this.X_=ec;this.YK=xc;this.Ch=ad;this.ZOd=Zd;
this.Vr=pe;this.c5b=Td;this.LKb=Ie;this.oc=We;this.OKf=Vf;this.focusManager=tf;this.Ik=yf;this.u2k=lf;this.E5c=(Rk,hm,Lj,Bk,Zi)=>{if(1===Lj||!Zi)return 32;Zi[aq.a.On]=Ad.a.hTc?this.Ch.Bm:this.Ch.VIa;return 32};this.oc.ra(Xe.a.gRb,cg.a.frame,this.Zq.gRb.bind(this.Zq));this.oc.ra(Xe.a.ZLd,cg.a.frame,this.ZLd.bind(this));this.oc.ra(Xe.a.q9e,cg.a.frame,this.Dmn.bind(this));this.oc.ra(Xe.a.D1k,cg.a.frame,this.Cmn.bind(this));this.oc.ra(Xe.a.gRi,cg.a.frame,this.lrn.bind(this));this.oc.ra(Xe.a.yTh,cg.a.frame,
this.Qnn.bind(this));this.oc.ra(Xe.a.eHh,cg.a.frame,this.lpn.bind(this));this.oc.fb(Xe.a.t9e,cg.a.frame,this.IEk.bind(this),64);this.oc.fb(Xe.a.tHd,cg.a.frame,this.PZn.bind(this),64);this.oc.ra(rf.a.selectComment,cg.a.frame,this.X_.Dco.bind(this.X_));this.Vr.Y0m&&this.oc.ra(rf.a.E2d,cg.a.frame,this.E2d.bind(this));this.Boh(rf.a.ALc,!1);this.Boh(rf.a.qef,!0);this.oc.fb(rf.a.vHd,cg.a.frame,this.vHd.bind(this),64);this.Vr.Ghb&&(this.oc.ra(rf.a.Vmg,cg.a.frame,this.yvn.bind(this)),this.oc.fb(rf.a.E5c,
cg.a.frame,this.E5c.bind(this),96));this.oc.ra(rf.a.zKi,cg.a.frame,og.ActionManager.Of);this.Vr.uBb&&this.oc.ra(rf.a.W5e,cg.a.frame,this.cQk.bind(this));this.oc.ra(rf.a.mRh,cg.a.frame,(Rk,hm)=>Tg.a.sia(hm.ik)&&Tg.a.Mcc()?8:32)}get Kj(){return this.Go}get mode(){return this.Zq.mode}get Tz(){return this.Zq.Tz}get BA(){return this.Vr.ar}get rj(){return this.LKb.value}get mb(){return this.OKf.value}get rJ(){return this.Zq}ZLd(la,cb,vb,ec,xc){return xc?xc?(la=this.X_.VQd(xc.NavigationId))&&this.X_.WQd(la,
1)?32:8:(a.ULS.sendTraceTag(540160449,327,10,"ActionData could not be cast to dict: DoesCommentExist"),8):(a.ULS.sendTraceTag(540160448,327,10,"No action data: DoesCommentExist"),8)}Dmn(la,cb,vb,ec,xc){xc&&this.YK.s$("OnCommentInit",{...(new Ue.a),tHa:()=>{var ad=this.X_.VQd(xc.NavigationId);if(ad){var Zd=this.X_.WQd(ad,1);Zd?this.c5b.isVisible?(this.N8c(Zd,1),this.focusManager.kD(ed.AFrame.Ur)):this.Kj.lia(Zd)?(ad=gh.r(Zd),this.X_.selectComment(Zd,{...(new af.a),mS:!ad,E$:1}),this.focusManager.kD(ed.AFrame.JM)):
(this.Ch.Bm||this.oc.processAction(Xe.a.LV,2),ji.a.R3(y.AFrameworkApplication.lc,()=>{this.N8c(Zd,1)},Li.a.N8c)):this.oc.processAction(Xe.a.Y5a,2)}}});return 32}Cmn(la,cb,vb,ec,xc){xc?(la=this.Kj.XPc(xc))?this.rJ.Hgc(la.id):a.ULS.sendTraceTag(540160450,327,10,"We were not able to find the comment referenced in the Activity Pane!"):this.rJ.Hgc(null);return 32}lrn(la,cb,vb,ec,xc){if(xc){if(this.Ch.nIb){for(la=0;la<xc.length;la++)this.Kj.Ykj(xc[la]);this.Zq.ROb()}else this.Kj.Zvk(xc);this.M6m(xc)}return 32}Qnn(la,
cb,vb,ec,xc){if(xc)if(this.Ch.nIb){for(la=0;la<xc.length;la++)this.Kj.Ykj(xc[la],!0);this.Zq.ROb()}else this.Kj.TYk();return 32}lpn(la,cb,vb,ec,xc){this.BA||this.Ch.Bm||this.oc.processAction(Xe.a.LV,2);if(xc){la=null;if(!this.Tz||2!==this.mode&&3!==this.mode){if(!xc)return 8;if(this.BA)la=this.BDl(xc);else for(cb=0;cb<xc.length&&(la=this.Kj.m0(xc[cb].toString()),this.ZOd.b_d&&(!la||la.done));cb++);}else la=this.Tz;this.N8c(la,1);la&&this.Ch.FY&&this.focusManager.mg(this.BA&&!this.Ch.Bm?ed.AFrame.JM:
ed.AFrame.Ur)}else a.ULS.sendTraceTag(5017933,327,10,"We have hint but we couldn't find the paragraph that it belongs to!");return 32}IEk(la,cb,vb,ec,xc){var ad;if(!xc)return 32;if(xc&&0<xc.length){cb=la=vb=0;ec=!1;for(let Zd=0;Zd<xc.length;Zd++)xc[Zd].toString()===(null===(ad=this.Tz)||void 0===ad?void 0:ad.objectId)?(ec=!0,la++):this.Go.XGf(xc[Zd])&&(ec&&0===vb&&(vb=Zd,cb=la),la++);(ad=this.Go.m0(xc[vb].toString()))?(this.SDa.Unc.KTf=cb+1,this.SDa.Unc.xrb=la,this.rJ.Hgc(ad.id)):(xc=xc[vb],this.rj.Eb(xc)?
a.ULS.sendTraceTag(540148256,327,10,`Comment Node with ObjectId ${xc} has no corresponding comment in Model`):a.ULS.sendTraceTag(540148257,327,10,"Comment ObjectId:{0} is NOT in the model, but we are trying to hightlight!",xc.toString()))}return 32}PZn(){this.rJ.Hgc(null);return 32}Boh(la,cb){this.oc.ra(la,cg.a.frame,(vb,ec,xc)=>this.unn(xc,cb))}yvn(la,cb,vb){var ec;if(1===vb)return this.Go.Qx?8:32;if(2===vb){if(Ad.a.hTc||this.Ch.Bm)return this.oc.processAction(Xe.a.LV,2),this.Ch.VIa=this.Ch.Bm,32;
if(!this.Go.bTc())return 32;this.Ch.VIa=!this.Ch.VIa;this.YK.s$("OnFloatingCommentsToggle");null===(ec=Q.App.za)||void 0===ec?void 0:ec.updateCommandUI(!0)}return 32}E2d(la,cb,vb){2===vb&&(la=this.Kj.Zr.Pc(7),la.Db(this.Kj.hKa),cb=new ne.a,cb.Xca(`${String.fromCodePoint(128077)} \n`),this.Go.lDb(Tf.a.instance.ib.lb,void 0,cb),this.u2k.DWd(),la.dispose());return 32}unn(la,cb=!1){if(2===la)la=this.Kj.Zr.Pc(15),la.Db(this.Kj.hKa),this.Ik.ie(()=>{this.ALc(cb)},"ECM:DAC"),la.dispose();else if(1===la&&
!this.Kj.yac())return 2;return 32}ALc(la=!1){this.Zq.mode=1;const cb=this.Kj.bP();for(const vb of cb)vb.$q===Hd.a.beingCreated||la&&!vb.done||vb.Df||this.Zq.deleteComment(vb);this.focusManager.mg(ed.AFrame.In);0<(la?this.Kj.bP().filter(vb=>vb.done):this.Kj.bP()).length?a.ULS.sendTraceTag(540160454,327,10,"Not all comments were deleted. onlyDeleteResolved: {0}.",la):a.ULS.sendTraceTag(540160455,327,50,"All comments were successfully deleted. onlyDeleteResolved: {0}.",la)}vHd(la,cb,vb){if(2===vb)if(la=
this.focusManager.currentScope.name,la!==ed.AFrame.Ur&&la!==ed.AFrame.JM){!this.BA||this.Ch.Bm?(this.Ch.Bm||this.oc.processAction(Xe.a.LV,2),this.focusManager.mg(ed.AFrame.Ur)):this.focusManager.mg(ed.AFrame.JM);var ec=this.mb.ib.lb;if(!ec||!ec.Pa)return 2;la=ec.Pa.cpBegin;cb=ec.Pa.node;ec=!!this.Tz&&(Bd.SelectionEditor.Pl(ec)||ec.bI)&&gh.q(this.Tz,cb,this.rj,la);la=!!this.Tz&&(2===this.mode||3===this.mode);if(ec||la)return this.rJ.Dij(this.Tz.id,!0),32;ec=this.BA&&!this.Ch.Bm?this.Kj.x7h(!0,!0):
null;this.rJ.Mco(ec)}else this.Kj.tt&&(this.Zq.Vac.wij(this.Kj.tt,!0),this.Zq.Vac.fkb(null===(ec=this.Kj.tt)||void 0===ec?void 0:ec.objectId)),this.focusManager.mg(ed.AFrame.In);return 32}cQk(){return 4}M6m(la){const cb=new Set;for(let vb=0;vb<la.length;vb++){const ec=this.Kj.XPc(la[vb]);ec&&cb.add(ec.Df?ec.Df:ec.id)}a.ULS.sendTraceTag(540160456,327,50,"Threads with new comments: {0}",cb.size.toString())}N8c(la,cb){la?this.c5b&&!this.Ch.FY?this.Ch.jgb=Object.assign(new Nb,{commentId:la.id,gYc:!1}):
this.X_.selectComment(la,Object.assign(new af.a,{mS:!!cb,E$:cb})):a.ULS.sendTraceTag(5017932,327,10,"We were not able to find the comment in the model!")}BDl(la){let cb=null,vb=!1;for(let ec=0;ec<la.length;ec++){const xc=la[ec].toString();if(this.Kj.XGf(la[ec])){cb||(cb=xc);if(vb&&this.Kj.tt.objectId!==xc)return this.Kj.m0(xc);vb=vb||!!this.Kj.tt&&this.Kj.tt.objectId===xc}}return cb?this.Kj.m0(cb):null}}Object(e.a)(Ll,"CommentsActionManager",null,[]);var Gl=c(235),Wh=c(49),bk=c(182),wn=c(1845),Yo=
c(520),Vn=c(31),Fq;(function(la){la[la.mgp=0]="commentDeeplink";la[la.catchUpActivity=1]="catchUpActivity"})(Fq||(Fq={}));Object(e.b)("DeeplinkSource",Fq);class bq{constructor(la,cb,vb,ec,xc,ad,Zd,pe,Td,Ie,We,Vf,tf){this.ga=la;this.Yh=cb;this.Dv=vb;this.Nwe=ec;this.uQ=xc;this.lgh=ad;this.Vb=Zd;this.gj=pe;this.Sg=Td;this.Lwb=Ie;this.Pwe=We;this.pK=Vf;this.wTe=!1;this.Jno=yf=>{if(this.Sg.ar&&!this.gj.Bm){const lf=new ka.a(0,1,0,()=>{this.Kkj(yf)},136,void 0,!0);y.AFrameworkApplication.lc.Wb(lf)}else this.Kkj(yf)};
tf.execute(yf=>{this.LE=yf})}get Go(){return this.Yh}get mb(){return this.Lwb.value}vWh(la){let cb=la.$q===Hd.a.beingCreated?la.Bz.draftId:la.id,vb=null;la.Df&&(cb=la.Df,vb=()=>{this.lgh.selectComment(la.id)});this.uQ.setInitialActiveContainerId(cb,0,vb)}Dco(la,cb,vb,ec,xc){if(!xc.commentId)return 2;la=this.Yh.ZD(xc.commentId);if(!la)return 2;this.Fpb(la,xc);return 32}Aij(la,cb){var vb,ec;if(la){var xc=(null===(ec=null===(vb=this.Yh.Qx)||void 0===vb?void 0:vb.Bz)||void 0===ec?void 0:ec.draftId)===
la?this.Yh.Qx:this.Yh.ZD(la);this.selectComment(xc,cb)}}selectComment(la,cb){la&&this.Fpb(la,cb)}xij(la,cb){var vb=this.VQd(la);vb&&((vb=this.WQd(vb,0))?cb.Bgg?(this.gj.jgb=Object.assign(new Nb,{commentId:vb.id,gYc:!0}),a.ULS.sendTraceTag(579608864,327,50,"Deep linking before comment pane fully loaded.")):(this.Fpb(vb,Object.assign(new af.a,{commentId:vb.id,E$:1,mS:!0,oWc:!0})),this.Sg.ar&&void 0!==la&&null!==la&&this.vWh(vb),ji.a.R3(y.AFrameworkApplication.lc,()=>{this.Vb.mg(this.Sg.ar&&!this.gj.Bm?
ed.AFrame.JM:ed.AFrame.Ur)},Li.a.ajo),Gl.a.instance.pf(Wh.a.dQh,(new Date).getTime()),la=this.Sg.ar?"Deep linked discrete hosted comment":"Deep linked after comment pane fully loaded",la+=", elapsed since boot: {0} ms",a.ULS.sendTraceTag(579608865,327,50,la,(new Date).getTime()-y.AFrameworkApplication.vX)):this.ga.processAction(Xe.a.Y5a,2))}VQd(la){let cb=null;var vb=null;if(N.a.sdc(la))cb=la;else if(({Gt:vb}=v.d(la)).returnValue&&(la=vb))return Yo.a.comment in la&&(cb=la[Yo.a.comment]),cb;cb||(vb=
vb?Object.keys(vb):null,a.ULS.shipAssertTag(579608866,327,!1,"Unrecognized navigation id. {0}",vb?vb.join(","):"Not Json."));return cb?cb.toString():null}WQd(la,cb){const vb=this.Yh.XPc(la),ec=0===cb;ec&&this.pK.logKpiUsage(Vh.a.kHd,0);if(!vb){a.ULS.sendTraceTag(579608867,327,15,"Comment durableCommentId={0} not found for deep linking. Source: {1}",la,cb);const xc=new Vn.a;xc.name="DeepLinkSource";xc.string=Fq[cb];this.pK.logActivity("CommentDeeplinkNotFound",{dataFields:[xc]});ec&&(cb=new K.a,cb.extendedProperties=
new Map([["ErrorLevel","warning"]]),this.pK.logKpiFailure(Vh.a.kHd,"CommentNotFound",{isIntentional:!1,isInternal:!0,additionalValues:cb}),this.Pwe.oen=la)}return vb}Kkj(la){this.wTe=!0;this.mb.Ac(la);this.wTe=!1}Fpb(la,cb){if(la){this.Sg.Ghb&&!this.gj.VIa&&this.ga.processAction(rf.a.Vmg,2);this.gj.sMb&&(y.AFrameworkApplication.lc.ff(this.gj.sMb),this.gj.sMb=null);var vb=this.Yh.tt,ec=this.Go.xtf(la),xc=2===cb.E$,ad={};xc&&(ad.TriggeredByFindReplace=!0);if(this.gj.Bm)xc&&(ad.PaneAlreadyOpen=!0),bk.UISurfaces.Nu().then(Zd=>
{Zd.setSelectedTaskPane(wn.a.wHd);return null});else if(la.$q!==Hd.a.beingCreated&&!this.Go.lia(la))this.gj.FY?this.ga.processAction(rf.a.LV,2):this.gj.jgb=Object.assign(new Nb,{commentId:la.id,gYc:cb.oWc}),xc&&(ad.OpeningPaneToSelect=!0);else if(this.Sg.ar){const Zd=ec.$q===Hd.a.beingCreated;Zd?this.uQ.hUa(ec.Bz.draftId,0,cb.mS):this.uQ.hUa(ec.id,0,cb.mS);!Zd&&xc&&(ad.SelectingDHC=!0)}ji.a.R3(y.AFrameworkApplication.lc,()=>{this.gj.FY&&(cb.mS&&this.Vb.mg(this.Sg.ar&&!this.gj.Bm?ed.AFrame.JM:ed.AFrame.Ur),
cb.oWc&&this.Go.lia(la)||!cb.mS&&!cb.E$||this.lgh.selectComment(la.id))},Li.a.xdg);xc=this.Go.xtf(vb);this.Sg.rva&&this.LE&&xc&&xc.id!==ec.id&&this.LE.fireEvent(9,{comment:xc});this.Yh.selectComment(la);this.Sg.rva&&this.LE&&la.$q===Hd.a.normal&&!la.Df&&this.LE.fireEvent(8,{comment:la});this.Nwe.highlightComment(la,!0);this.Dv.LF(0,ec,vb);Q.App.za.updateCommandUI(!0);0<Object.keys(ad).length&&this.pK.Tv(rf.a.selectComment,{customData:ad})}}}Object(e.a)(bq,"CommentSelectionActor",null,[395]);class tk extends jf.a{constructor(){super();
this.comment=this.commentId=null;this.H_=Object.assign(new Fc.a,{T_:tk.getTypeName(),B_:tk.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(e.a)(tk,"CommentSmartReplySignal",jf.a,[]);class ip extends Pa.a{constructor(){super();this.DomainName=this.CommentId=null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new Fc.a,{T_:ip.getTypeName(),B_:ip.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}
Object(e.a)(ip,"SmartReply",Pa.a,[]);var cn=c(869);class $l{constructor(la){this.zsa=la}W5b(la,cb){return Object.assign(new cn.a,{parentPath:["Signal",tk.getTypeName()],items:[Object.assign(new ld.a,{body:Object.assign(new tk,{commentId:la,comment:cb})})]})}O1f(la){const cb=new lb.a;if(la&&la.CommentId&&la.ResultSets&&0<la.ResultSets.length&&la.ResultSets[0].Documents&&0<la.ResultSets[0].Documents.length){for(const vb of la.ResultSets[0].Documents)cb.add(vb.Caption);0<cb.count&&this.zsa.O1f(la.CommentId,
cb.toArray())}else a.ULS.sendTraceTag(574493152,327,10,"Invalid response from SmartReplies request")}getTypeName(){return ip.getTypeName()}}Object(e.a)($l,"BaseCommentSmartReplyProvider",null,[955]);class sm extends $l{constructor(la,cb,vb,ec){super(la);this.Je=cb;this.mB=vb;this.TWj=ec}initialize(){this.mB.ml().then(()=>{this.Je.ob(this,$l.prototype.getTypeName.call(this))})}invoke(la,cb){this.mB.ml().then(()=>{this.TWj.getAugLoopRuntimeManager().submitOperation(Object.assign(new Gb.a,{operation:this.W5b(la,
cb)}))})}KB(la,cb){la&&va.a.getTypeNameFor(la.content)===this.getTypeName()&&cb===Ra.a.getTypeName()?this.O1f(la.content):a.ULS.sendTraceTag(579170963,327,10,"Invalid annotation event for smart replies")}}Object(e.a)(sm,"CommentSmartReplyProvider",$l,[265]);var Co=c(38),hj=c(141),Jh=c(163);class Yi{constructor(la,cb,vb,ec,xc,ad){this.Ca=la;this.rd=cb;this.Cx=vb;this.wJe=ec;this.Pwe=xc;this.sN=ad;this.Qvb=!1;this.Pwe.uYn();this.KPg=this.d7l();this.e6f&&(Co.a.addHandler(window.self,Bf.a.wsh,()=>{this.Qvb=
!0}),Co.a.addHandler(window.self,Bf.a.xsh,()=>{this.Qvb=!1}));0<this.KPg&&y.AFrameworkApplication.oe("77dda873;fe8jd931")}get ox(){return this.Cx?this.Cx.value:null}get TDa(){return this.wJe.value}get aRo(){return this.Qvb}get zac(){return 0<this.KPg}get ar(){return this.sN.ar}get mpl(){return!0}get eJk(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoPopulateShareTUIComment",!1)}get $Rb(){return this.rd.isFeatureEnabled(114)&&!Jh.App.wXc}get Udo(){return this.rd.isFeatureEnabled(37)&&
this.Ca.$("SendErrorReportOnCommentInboundCrashIsEnabled")}get E1k(){return this.Ca.$("CommentAnchorHighlightOnIpSelectionIsEnabled")}get e6f(){return this.Ca.$("RecordCommentActionsInTypingIsEnabled")}get MRi(){return this.Ca.$("NoHighlightWhenCommentDraftInProgressIsEnabled")}get SDb(){return this.ar&&!this.zac&&!this.Ca.kb("BootActivityNavigationId")&&F.a.Nt}get uBb(){return this.rd.isFeatureEnabled(7)}get eIk(){return this.Ca.$("AtMentionUserFloodGateCampaignIsEnabled")}get W1k(){return this.Ca.$("CommentFriendlyTimestampsIsEnabled")}get epl(){return this.Ca.kb("DisabledChangeGatesInSharedComments")}get $Od(){return this.sN.$Od}get pRb(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordTrackChangesSimpleMarkupView",
!1)}get A9n(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.RightAlignedEntrypointIsEnabled",!1)}get lig(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartRepliesIsEnabled",!1)}get bZ(){return this.Ca.kb("PresenceUserId")}get Zda(){return Jh.App.cqe&&!!hj.PageReader.instance&&hj.PageReader.instance.Owa(Q.App.za.jb.Zc).Zda}get Hhb(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableDurableIdForIdentification",!1)}get qIo(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",
!1)}get Ghb(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.HideCommentsByDefaultEnabled",!1)}get N2k(){return this.Ca.$("CommentsTasksFpsIsEnabled")}get trackChangeInSidetrackEnabled(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.TCCardInSideTrack",!1)}get C2k(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReactionsFPSEnabled",!1)}get Y0m(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.LikeSelectedContentFlotie",!1)}get contentNavigationApiEnabled(){return this.sN.contentNavigationApiEnabled}get oyn(){return this.rd.isFeatureEnabled(87)}get rva(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentEventAPIEnabled",
!1)}get contentFilterApiEnabled(){return this.sN.contentFilterApiEnabled}get V1k(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentFilterHintIconFix",!0)}get Izo(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.SkipParaTraversalIfNoComments",!1)}get Fzl(){return this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.ExpandToFullHyperlinkRange",!1)}d7l(){if(this.ox&&this.TDa){const la=new Sd.GraphIterator;la.set(this.ox);this.TDa.Q5a(la);let cb=0;39===
la.Xe&&(cb=la.Wp());return cb}return-1}}Object(e.a)(Yi,"CommentsSettings",null,[]);var th=c(1635),sb=c(1391);class Xb{constructor(la){this.qaa=la}izh(la,cb,vb){const ec=new fj;cb=this.qaa.PRa(cb)?cb.objectId:null;if(!cb)return ec;cb=ua.a.If(cb);if(vb.contains(cb))return ec.HUc=0,ec.GUc=la.length,ec;for(let ad=0,Zd=la.length;ad<Zd;ad++){var xc=la[ad];vb=gh.g(xc);xc=gh.d(xc);vb&&sb.a.TIh(vb,cb)&&(ec.HUc=ad);if(xc&&sb.a.TIh(xc,cb)){ec.GUc=ad;break}}return ec}Iuh(la,cb,vb){const ec=-1===cb.HUc&&-1===
cb.GUc,xc=-1<cb.HUc?cb.HUc:-1;cb=-1<cb.GUc?cb.GUc:la.length;const ad=!ec&&xc===cb;var Zd=!1;for(let pe=0;pe<la.length;pe++){const Td=la[pe],Ie=Rm.a(Td);if(1!==Ie&&2!==Ie&&3!==Ie)continue;this.qaa.JTa(Td);if(ec||pe<xc||pe>cb)continue;const We=3===Ie||2===Ie&&-1!==Td.className.indexOf(Og.a.PQa),Vf=vb?1:2;this.IFk(pe,xc,cb,Vf,We,Zd,Td,ad);if(pe!==cb||ad)(Zd=this.qaa.z3a.J(Ie).J(Vf))&&Td.classList.add(Zd),Zd=We}}IFk(la,cb,vb,ec,xc,ad,Zd,pe){la!==cb&&la!==vb||xc||ad||((la=this.qaa.gic.J(ec))&&Zd.classList.add(la),
pe&&Zd.classList.add(Og.a.m1f))}}Object(e.a)(Xb,"DefaultHighlightChangeHandler",null,[394]);var fd;(function(la){la[la.success=0]="success";la[la.noSelection=1]="noSelection";la[la.invalidContent=2]="invalidContent"})(fd||(fd={}));Object(e.b)("AnchorCreationResult",fd);var Yc=c(62),Ve=c(23),mf=c(278),pg=c(237),Ze=c(1220);class yh{}Object(e.a)(yh,"EditorAnchorInfo",null,[409]);class Oi{constructor(la,cb,vb,ec,xc,ad,Zd,pe,Td){this.w0m=la;this.OKf=cb;this.Kj=vb;this.sxa=ec;this.SDa=xc;this.Nl=ad;this.YK=
Zd;this.Vr=pe;this.lng=Td;this.cgh=null;this.sxa.GTa(this.SDa);this.Vr.contentFilterApiEnabled&&(this.YK.u$("OnCommentPaneOpen",this.aXo.bind(this)),this.YK.u$("OnCommentPaneClose",this.$Wo.bind(this)),this.YK.u$("OnContentFilterUpdate",this.k2c.bind(this)))}get mb(){return this.OKf.value}get rj(){return this.w0m.value}initialize(){}lBm(la){this.cgh=la}dispose(){}fkb(la){this.SDa.fkb(la)}Uac(la){this.SDa.Uac(la)}highlightComment(la){this.wij(la,!1);this.SDa.fkb(la.objectId)}Koc(la){this.SDa.Koc(la)}uFa(la){return this.SDa.uFa(la)}k2c(){this.Ure("OnContentFilterUpdate")}aXo(){this.Ure("OnCommentPaneOpen")}$Wo(){this.Ure("OnCommentPaneClose")}Ure(la){const cb=
[],vb=new Set;for(const xc of this.Kj.bP())if(!xc.Df&&xc.$q!==Hd.a.beingCreated&&!this.Kj.rJ.CBh(la,xc)){var ec=this.Y7l(xc);vb.has(ec.id.toString())||(vb.add(ec.id.toString()),(ec=ec.te(Yc.InteractiveViewManager.instance.yd.$b))&&cb.push(ec))}cb.forEach(xc=>{this.sxa.Loc(xc)})}Y7l(la){var cb,vb,ec;const xc=null===(cb=this.rj)||void 0===cb?void 0:cb.Eb(la.objectId);if(!xc)return null;la=gh.k(xc);cb=null===(vb=this.rj)||void 0===vb?void 0:vb.Eb(la);return null===(ec=this.lng.instance)||void 0===ec?
void 0:ec.jHb(cb)}wij(la,cb){if(!la.$q){var vb=this.rj.Eb(ua.a.If(la.objectId)),ec=Cf.a.vca(vb,this.rj,!0);vb=Cf.a.vca(vb,this.rj,!1);if(ec&&vb){const xc=ec.Lb.paragraph;ec=ec.Lb.cp;if(this.CUm(xc,ec))Q.App.za.updateCommandUI(!0);else{ec=Ve.SelectionFactory.ne(xc,ec);vb=Wc.a.Rc(vb.Lb.paragraph,vb.Lb.cp);if(Oi.Yf.x9(ec.Pa)||Oi.Yf.x9(vb))la.wRa=!0,la.O5a();la=cb?Ve.SelectionFactory.Gy(ec,vb):ec;this.cgh(la)}}}}FYk(){this.SDa.Uac(null);this.SDa.fkb(null)}i9k(){const la=new yh;return{returnValue:fd.success,
anchor:la}}CUm(la,cb){if(la&&Object(ci.a)(Ze.MainView,this.Nl.yd)){var vb=la.te(this.Nl.yd.$b);la=document.getElementById(Fj.AppFrame.TVa);if(vb&&la){cb=mf.a.Wq(vb,cb);if(!cb)return!1;cb=cb.y;vb=Sys.UI.DomElement.getBounds(la).y;la=la.offsetHeight;if(cb>=vb&&cb<=vb+la)return!0}}return!1}static get Yf(){return pg.a.instance}static getInstance(){return Oi.fm()}static fm(){return Oi._instance||(Oi._instance=new Oi(new W.a(()=>Q.App.za.jb.Zc.xd),new W.a(()=>Tf.a.instance),M.a.instance.resolve("WordEditor.Comments.IEditorCommentModel"),
M.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,M.a.instance.resolve("WordEditor.Comments.CommentHintActor"),Yc.InteractiveViewManager.instance,M.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),M.a.instance.resolve("WordEditor.Comments.CommentsSettings"),M.a.instance.Ta("WordEditor.Indicator.TopLevelOutlineElementCache")))}}Oi._instance=null;Object(e.a)(Oi,"EditorCommentHintManager",null,[389,390,9]);var Kh=c(2065),ei=c(354),lh=c(1169);class Mc extends me.a{constructor(la,
cb,vb,ec,xc,ad,Zd,pe,Td,Ie,We,Vf,tf,yf,lf,Rk,hm,Lj,Bk,Zi,Rj,tm,dh,uk,gl,Um){super(Zd);this.ji=cb;this.Lwb=pe;this.p9e=Ie;this.Asa=We;this.Isc=Vf;this.uQ=tf;this.Sg=yf;this.Xo=lf;this.CVb=Rk;this.gj=hm;this.G2=Lj;this.je=Zi;this.pK=Rj;this.ZT=dh;this.mHd=uk;this.lng=Um;this.woi=this.Whh=this.GXa=null;this.unb=()=>{this.gsa.Fpa()&&(this.X9i(this.gsa.rc),this.gsa.tjc(this.unb))};this.P0c=Sk=>{2===Sk.mode?this.vD=1:1===Sk.mode&&(this.vD=0);this.Yh.Qx&&0===this.vD?a.ULS.sendTraceTag(542914062,327,50,"Switch to read only mode while drafting a comment with drafting session type [{0}].",
this.Yh.Qx.Bz.sessionType):this.gj.FY&&(this.BA||this.I2.isVisible)&&this.ROb()};this.Kkn=()=>{this.gj.nIb?this.mode=0:this.vD=0};this.JHa=(Sk,en)=>{var Do;Sk=en.yl.lb;if((this.BA||this.Mda&&this.Mda.isVisible)&&!this.CVb.wTe&&Sk){en=Bd.SelectionEditor.Pl(Sk);var Ui=Sk.bI;null!==(Do=this.woi)&&void 0!==Do&&Do.hca||(this.Go||a.ULS.sendTraceTag(509698397,327,15,"onSelectionChange: CommentModel Not Set."),Do=this.Go&&this.Go.Xkb(this.ga,!1),1!==this.mode||en&&!Ui||!Do?this.Isc.DWd():this.lcl(Sk));2!==
this.mode&&3!==this.mode&&this.Sg.E1k&&this.pPo(Sk,en,Ui)}};this.lWk=()=>{if(this.Kj&&this.Kj.Qx&&!Q.App.qDf){var Sk=this.Kj.Qx;Sk.Bz.sessionType!==Kh.a.metadata&&(a.ULS.sendTraceTag(545640771,327,15,`Draft Comment of type:${Sk.$q} present on app shutdown`),(Sk=Kc.a.xWl(Sk))&&this.pK.logKpiFailure(Sk,"CommentDraftLostOnAppShutdown",{isInternal:!0},{name:Vh.a.a5b,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}))}};this.Tkn=()=>{if(this.gj.FY){var Sk=()=>!0;this.BA&&!this.gj.Bm&&(Sk=en=>this.Go.lia(en));
Sk=this.Go.Mof(Sk);this.ROb(Sk)}};this.ga=Zd;this.vD=1===this.ga.mode?0:1;this.I2=xc;this.Yh=ec;this.Haa=ad;this.Vb=Td;this.tXn();vb.b7a(this.Asa);this.mb.Ww(this.JHa);la.CWR(()=>la.result.nC.XNa(this.Kkn));y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.y_a(this.P0c);this.G2.u$("OnAfterTrackChangeMarkupViewChange",this.Tkn);y.AFrameworkApplication.qI&&y.AFrameworkApplication.qI(this.lWk);gl.execute(Sk=>{this.LE=Sk});tm.execute(Sk=>{Sk.I6k.execute(en=>{this.woi=en})})}tXn(){this.gsa&&(this.gsa.Fpa()?
this.X9i(this.gsa.rc):this.gsa.J2b(this.unb))}X9i(la){la.tga(()=>{this.iDo()})}get gsa(){var la;return null===(la=Jh.App.nn)||void 0===la?void 0:la.jb}get mb(){return this.Lwb.value}get Kj(){return this.Yh}get Go(){return this.Yh}get BA(){return this.Sg.ar}get sRi(){return!0}get pjj(){return!0}get bbc(){return this.GXa}set bbc(la){this.GXa=la}get mode(){return super.mode}set mode(la){la!==this.vD&&(super.mode=la,this.O5a())}get Tz(){return this.model&&this.model.tt?this.model.tt.Df?this.model.ZD(this.model.tt.Df):
this.model.tt:null}get rj(){return this.ji.value}get Xrj(){return!1}get Zda(){return this.Sg.Zda}ROb(la=null,cb=null){const vb=this.Go,ec=!this.vD,xc=this.Mda.S1k,ad=vb.jTd();xc.Wpg(ad?5:1,ec);la=this.Sg.pRb&&la?la:vb.ipf(this.Sg.pRb&&this.BA&&!this.gj.Bm);xc.Ndo(la,ad,vb.DWa);this.Apg();cb&&a.ULS.sendTraceTag(572281362,327,50,cb)}l2c(la,cb,vb=!1){this.gj.Bm?this.uQ.UHj():cb?this.uQ.deleteContainer(la.$q===Hd.a.beingCreated?la.Bz.draftId:la.id,0,vb):this.zPn(la)}zPn(la){const {iKo:cb}=this.Yh.c1l(la),
vb=this.Haa.uFa(la.objectId);vb&&this.uQ.addContainer(la.id,vb.parentElement,0,cb)}Hij(la){const cb=this.Tz;this.P8c();this.Asa.LF(0,this.Yh.tt,cb);this.BA&&this.Yh.tt&&!this.gj.Bm&&this.uQ.hUa(this.Yh.tt.id,0,1===la)}Nco(){const la=this.Tz;this.Q8c();this.Asa.LF(0,this.Yh.tt,la);this.BA&&this.Yh.tt&&!this.gj.Bm&&this.uQ.hUa(this.Yh.tt.id,0,!1)}Koc(la){this.Haa.Koc(la)}Uul(la,cb){this.uQ.addContainer(la,null,0,cb)}gCn(la){this.uQ.H1i(la)}Wul(la,cb){this.uQ.h7c(la,cb,0)}iWo(){this.uQ.r3e()}zij(la){if(la&&
(2!==this.mode||la.$q===Hd.a.beingCreated)){var cb=this.Yh.tt;cb!==la&&(this.Yh.selectComment(la),this.I2.isVisible?this.gj.FY?(this.I2.selectComment(la,1),this.Ala.selectComment(la.id)):this.gj.jgb=Object.assign(new Nb,{commentId:la.id,gYc:!1}):this.BA&&!la.done&&(this.Dij(la.id,!1),this.Ala.selectComment(la.id)),!this.I2.isVisible&&this.BA&&la.done||(this.Vac.fkb(la.objectId),this.Asa.LF(0,this.Tz,cb)))}}VUc(){}iif(){this.gj.nIb=!1}MAb(la){this.Sg.MRi&&this.Yh.tt&&this.clearSelection();super.MAb(la);
this.pK.logKpiUsage(Vh.a.A9e,0);this.Apg();if(this.BA){const cb=this.Yh.Zhm(la.draftId);this.Uul(la.draftId,cb)}}addReply(la,cb){this.pK.logKpiUsage(Vh.a.yHd,0);super.addReply(la,cb)}sva(la){this.BA&&null!=la.Bz&&this.Yh.caj(la.Bz.draftId);super.sva(la);this.Haa.fkb(la.objectId);a.ULS.sendTraceTag(50426376,327,50,"{0}:  added by user action.",gh.a(la));this.pK.logKpiUsage(Vh.a.WGh,0);this.rWk(la);Kc.a.X2o(la,this.rj,this.pK);this.pK.Tv(rf.a.VGh,{succeeded:!0,customData:{actionType:la.Df?Kh.a.reply:
Kh.a.create}})}lgb(la){super.lgb(la);this.pK.Tv(rf.a.VGh,{succeeded:!0,customData:{actionType:Kh.a.edit}})}rWk(la){if(la.Df){var cb=this.Yh.xtf(la);if(cb.uGc&&cb.vGc){var vb=this.rj.Eb(ua.a.If(cb.vGc));cb=cb.vGc===cb.uGc?null:this.rj.Eb(ua.a.If(cb.uGc));Kc.a.yug(vb,la,!0);Kc.a.yug(cb,la,!1)}}}BLc(la){super.BLc(la);this.Tz&&this.Tz.id===la.id&&(super.clearSelection(),this.BA&&this.uQ.N4b());if(this.BA)if(gh.r(la)){var cb=[];let vb=null;for(const ec of this.model.bP())ec!==la&&(ec.Df===la.Df&&cb.push(ec),
ec.id===la.Df&&(vb=ec));vb&&vb.id&&vb.objectId&&!vb.done&&this.Go.SG(vb.objectId)&&!this.Go.v2i(vb.objectId)&&!cb.length&&this.l2c(vb,!0)}else cb=la.$q===Hd.a.beingCreated,la.done||this.l2c(la,!0),cb&&this.Yh.caj(la.Bz.draftId)}editComment(la,cb){1===this.mode&&la&&(this.Yh.LMc(la,cb),Kh.a.edit===cb.sessionType&&this.pK.logKpiUsage(Vh.a.aHh,0),this.Sg.$Rb&&3!==Kh.a.Irf(cb.sessionType)&&this.CVb.selectComment(la,Object.assign(new af.a,{mS:!1,E$:0})))}Mfe(la){this.BA&&!this.gj.Bm||super.Mfe(la)}deleteComment(la){la.$q!==
Hd.a.beingCreated&&this.Go.ARh(ua.a.If(la.objectId));this.GXa&&this.GXa.id===la.id&&(this.Yh.tt&&this.GXa.id===this.Yh.tt.id?this.GXa=null:this.Asa.j8e());!this.Yh.tt||this.Yh.tt.id!==la.id&&this.Yh.tt.Df!==la.id?this.Yh.tt&&this.Asa.LF(0,this.Yh.tt,null):void 0===la.Df||null===la.Df?this.clearSelection():this.Yh.selectComment(this.Yh.ZD(la.Df));la.wRa&&a.ULS.sendTraceTag(556360779,327,50,"The comment selected for deletion is currently locked: {0}.",gh.a(la));super.deleteComment(la);a.ULS.sendTraceTag(50426377,
327,50,`${gh.a(la)} deleted by user action. DurableId: ${la.y1a}`)}iCb(la,cb){super.iCb(la,cb);this.BA&&!this.gj.Bm&&cb&&(this.Yh.tt&&this.Yh.tt.id===la.id&&this.clearSelection(),this.bbc&&this.bbc.id===la.id&&this.Asa.j8e())}Mco(la=null){(la=this.Go.qSl(la))?this.CVb.selectComment(la,Object.assign(new af.a,{mS:!0,E$:1})):this.Hij(1)}lcl(la){var cb,vb=this.gsa.rc;if(vb){var ec=la.Pa.node,xc=null===(cb=this.lng.instance)||void 0===cb?void 0:cb.jHb(ec);if(xc)for(const ad of vb.PPa(xc))if(ad&&ad instanceof
ei.a&&(cb=ad,vb=lh.a.sNh(cb),this.Isc.dpe=this.dCl(ec,la),xc=this.mRk(vb),null!==xc)){if(la=this.Isc.VBl(vb,xc))vb.rxa[xc].appendChild(la),cb.fz(la);break}}}dCl(la,cb){let vb;for(const ec of la.kH)if(ec&&ec){vb=ec;break}la=cb.Pa.Wj;cb=!(null===vb||void 0===vb||!vb.fo)&&0<vb.fo.length;return 0>la||!cb||null===vb||void 0===vb||!vb.eop?null:mf.a.O_(la,vb,!1,!1)}mRk(la){var cb;const vb=null===(cb=this.Isc.dpe)||void 0===cb?void 0:cb.y;for(const [ec,xc]of la.L4.entries())if(la=vb-xc.y,-2<=la&&la<xc.height+
2)return ec;return null}O5a(){Q.App.Sjb=2===this.mode||3===this.mode;1!==this.mode&&this.Isc.DWd()}pPo(la,cb,vb){const ec=this.Vb.currentScope;let xc=null;if(cb||vb){cb=la.Pa.cpBegin;la=la.Pa.node;if(this.Tz&&gh.q(this.Tz,la,this.rj,cb))return;xc=this.N5l(la,cb)}xc?!this.BA||this.gj.Bm?ji.a.R3(y.AFrameworkApplication.lc,()=>{this.zij(xc)},Li.a.Fco):this.zij(xc):!this.Yh.tt||ec&&ec.name===ed.AFrame.JM||this.clearSelection()}N5l(la,cb){let vb=null;const ec=this.model.bP();for(let xc=ec.length-1;0<=
xc;xc--){const ad=ec[xc];if(ad.objectId&&!(ad.Df||this.BA&&!this.Mda.isVisible&&ad.done)&&gh.q(ad,la,this.rj,cb)){vb=ad;break}}return vb}selectComment(la,cb=1){this.CVb.Aij(la,Object.assign(new af.a,{mS:1===cb,E$:cb}))}Dij(la,cb){const vb=this.Yh.ZD(la);vb?this.BA&&!gh.r(vb)&&vb.$q!==Hd.a.beingCreated&&this.uQ.hUa(la,0,cb):a.ULS.sendTraceTag(42332933,327,10,"Selected Comment isn't in the model.")}clearSelection(){const la=this.model.tt;this.Sg.rva&&this.LE&&la&&this.LE.fireEvent(9,{comment:la});super.clearSelection();
this.Asa.LF(1,la,la);this.BA&&la&&this.uQ.N4b()}cUm(){var la;return 500>(null===(la=this.Whh)||void 0===la?void 0:la.oi)}Hgc(la,cb=1){if(!this.Sg.MRi||!this.Yh.Qx){var vb=this.Yh.ZD(la),ec=null;vb||(ec=this.GXa);var xc=this.cUm(),ad=!1;1===cb&&this.Ala&&(xc?ad=!0:this.Ala.highlightComment(la));la?vb?xc?ad=!0:this.Haa.Uac(vb.objectId):a.ULS.sendTraceTag(37323346,327,10,"Comment is NOT in the model, but we are trying to hightlight!"):this.Haa.Uac(null);vb?xc?ad=!0:(this.GXa=vb,this.Asa.LF(2,vb,ec)):
(this.GXa=null,this.Asa.LF(3,null,ec));ad&&a.ULS.sendTraceTag(544532572,327,50,"Comment highlighting was skipped due to the user actively scrolling.")}}iDo(){this.je&&(this.Whh=this.je.Zf("UserAction","StartScrollDetectionStopwatch"))}notify(la,cb){this.Xo.sendNotification(la,cb)}Apg(){this.mHd.onContentChanged()}CBh(la,cb){var vb,ec;switch(la){case "OnCommentPaneOpen":case "OnCommentPaneClose":return this.Czo(cb);case "OnContentFilterUpdate":return!(null===(ec=(vb=this.mHd).isContentInFilterUpdateDiff)||
void 0===ec?0:ec.call(vb,cb.id));default:return!0}}Czo(la){return this.Sg.V1k?!la.done&&this.Go.lia(la)===this.mHd.isContentInFilteredContent(la.id):this.Go.lia(la)===this.mHd.isContentInFilteredContent(la.id)}static getInstance(){return Mc.fm()}static fm(){Mc.Pg||(Mc.Pg=new Mc(Q.App.Uoa(),new W.a(()=>Q.App.za.jb.Zc.xd),M.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance,M.a.instance.resolve("Common.Comments.ICommentModel"),M.a.instance.resolve("Common.Comments.ICommentPane"),
Oi.getInstance(),y.AFrameworkApplication.va,new W.a(()=>Tf.a.instance),qd.FocusManager.instance(),M.a.instance.resolve("WordEditor.Comments.IWordEditorSharedCommentAPI"),M.a.instance.resolve("WordEditor.Comments.ICommentHighlightActor"),M.a.instance.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),M.a.instance.resolve("WordEditor.Comments.IFloatingCommentManager"),M.a.instance.resolve("WordEditor.Comments.CommentsSettings"),M.a.instance.resolve("Common.Utils.IAriaNotifier"),M.a.instance.resolve("WordEditor.Comments.ICommentSelectionActor"),
M.a.instance.resolve("WordEditor.Comments.CommentsState"),M.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),Jh.App.nn.jb.rc,Q.App.za.Lq,M.a.instance.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),M.a.instance.Ta("WordEditor.HeaderFooter.HeaderFooterControlOwner"),M.a.instance.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),M.a.instance.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),M.a.instance.Ta("WordEditor.Extension.RichApiEventManager"),
M.a.instance.Ta("WordEditor.Indicator.TopLevelOutlineElementCache")),Mc.Pg.MQb=!0);return Mc.Pg}}Mc.Pg=null;Object(e.a)(Mc,"EditorCommentManager",me.a,[386,387,388,9]);var Xg=c(1786);class fi{constructor(la,cb,vb,ec){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=la;this.body=cb;this.confirmButton=vb;this.cancelButton=ec}}Object(e.a)(fi,"ViewContainerModalDialogStrings",null,[]);c(1506);class kl{constructor(la,cb){this.canvasContextId=this.canvasActionId=0;this.withFlags=
!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.delayActionsUntilRegistration=!1;this.canvasActionId=la;this.canvasContextId=cb}}Object(e.a)(kl,"CommentUIAction",null,[]);var Gh=c(1073);class ie{constructor(la,cb,vb,ec,xc,ad,Zd,pe,Td,Ie,We,Vf,tf,yf,lf,Rk,hm){this.ga=la;this.ig=cb;this.ge=vb;this.Vb=ec;this.lp=xc;this.Nh=ad;this.G3=Zd;this.zsa=pe;this.vAd=Td;this.VXe=Ie;this.Ib=We;this.uQ=Vf;this.Sg=tf;this.gj=yf;this.CVb=lf;this.G2=Rk;this.xla=hm;this.Nwe=this.fj=null;this.ggh=
this.iLg=!1;this.GBc=null;this.$wo=(Lj,Bk,Zi)=>2!==Zi||this.gj.FY?1===Zi?32:2:(this.G2.s$("OnCommentInit",Object.assign(new Ue.a,{tHa:()=>{this.ga.processAction(Xe.a.LV,2)}})),32);this.Bri=(Lj,Bk,Zi)=>1!==Zi||this.gj.FY?2:8;this.Qqk=(Lj,Bk,Zi)=>{if(1===Zi)return!this.Xkb()||this.Peb?8:this.gj.FY?2:32;if(!this.gj.FY)return this.Peb=!0,this.G2.s$("OnCommentInit",Object.assign(new Ue.a,{tHa:()=>{this.ar||this.gj.Bm||this.ga.processAction(Xe.a.LV,2)}})),32;this.ar||this.gj.Bm||this.ga.processAction(Xe.a.LV,
2);(this.ar||this.gj.Bm)&&this.Vb.mg(this.gj.Bm?ed.AFrame.Ur:ed.AFrame.JM);return 2};this.fkl=(Lj,Bk,Zi)=>1===Zi&&Jf.SessionStatusManager.instance.Zj?8:2;this.Mol=(Lj,Bk,Zi,Rj)=>1!==Rj||(this.ar||this.isVisible)&&this.fj.model.tt?Lj||this.fj.model.tt?32:8:8;this.ckb=(Lj,Bk,Zi,Rj,tm)=>{if(1===Zi||!this.gj.Bm)return 32;if(!this.ar&&2===Zi&&(2===this.fj.mode||3===this.fj.mode))return tm=new fi(CommentPaneStrings.DiscardDialogTitle,CommentPaneStrings.DiscardDialogBody,CommentPaneStrings.DiscardDialogAbandon,
CommentPaneStrings.DiscardDialogResume),this.vAd.invokeModalConfirmationDialog(()=>{this.Tmn(Lj,Bk,Zi,Rj)},()=>{this.Yln()},tm),32;this.FWd();if(this.ar)return 32;tm&&this.tWh();return 32};this.AOb=(Lj,Bk,Zi,Rj,tm)=>{if(1===Zi)return 32;tm[aq.a.On]=this.isVisible;return 32};this.Dqc=this.c9k()}get isVisible(){return this.gj.Bm}get Peb(){return this.iLg}set Peb(la){this.iLg=la}get aro(){return"SharedCommentsTaskPaneProps"}get q3c(){return null}get hRi(){return null}get jF(){return this.lp}get Mda(){return null}get S1k(){return this.zsa}get ar(){try{return this.Sg.ar}catch(la){return!1}}jci(){return new ul(y.AFrameworkApplication.isRtl,
Sys.CultureInfo.CurrentCulture.name,y.AFrameworkApplication.uiCulture,y.AFrameworkApplication.dataCulture)}c9k(){const la=new Hm.a,cb=new kl(Xe.a.qHa,cg.a.frame);cb.preCallback=this.Qqk;const vb=new kl(rf.a.ETf,cg.a.frame),ec=new kl(rf.a.C2f,cg.a.frame),xc=new kl(rf.a.deleteComment,cg.a.frame);xc.preCallback=this.fkl;xc.postCallback=this.Mol;this.ar&&(vb.preCallback=this.Bri,ec.preCallback=this.Bri);const ad=new kl(Xe.a.LV,cg.a.frame);ad.preCallback=this.$wo;la.Z(6,ad);la.Z(0,cb);la.Z(1,vb);la.Z(2,
ec);la.Z(3,xc);return la}ipj(la){this.ggh||(this.emk=this.bUd(),this.G3.UOa(),this.lqo(),this.gqo(la),this.ggh=!0)}gqo(la){this.fj=la;this.Nwe=la.Vac;this.fj.zYh=this.zsa}initialize(la){this.ipj(la);this.Tb()}LBf(){this.GBc&&this.Vb.mg(ed.AFrame.Ur);this.Peb&&!this.ar?(this.ga.processAction(Xe.a.qHa,2),this.Peb=!1):this.gj.jgb&&ji.a.R3(y.AFrameworkApplication.lc,()=>{const la=this.gj.jgb.commentId,cb=this.gj.jgb.gYc;this.ga.Qb(rf.a.selectComment,2,Object.assign(new af.a,{commentId:la,E$:1,mS:!0,oWc:cb}));
cb&&(ji.a.R3(y.AFrameworkApplication.lc,()=>{this.Vb.mg(ed.AFrame.Ur)},Li.a.xdg),Gl.a.instance.pf(Wh.a.dQh,(new Date).getTime()));a.ULS.sendTraceTag(35149083,327,50,"Comment selected in shared comment pane after boot: {0}",(new Date).getTime()-y.AFrameworkApplication.vX);this.gj.jgb=null},Li.a.Eco)}dispose(){}T5(){}selectComment(){this.isVisible||this.ar||this.Gsj();this.Nh.updateCommandUI(!0)}Tb(){this.ga.ra(Xe.a.ckb,cg.a.frame,this.ckb);this.ga.fb(Xe.a.AOb,cg.a.frame,this.AOb,96)}O5a(){-1!==this.fj.mode&&
(this.fj.mode||this.tWh())}tWh(){const la=this.fj,cb=la.Go,vb=cb.jTd(),ec=cb.ipf(this.Sg.pRb&&this.Sg.ar&&!this.gj.Bm);this.zsa.Mdo(ec.length,vb,!la.mode,vb?5:1);this.zsa.leo(ec,cb.DWa)}lqo(){const la=this.Vb.fe(ed.AFrame.Ur);la.parent=ed.AFrame.Ap;la.eI=!0;la.Q7c=!0;la.KVa=!0;la.SNa((cb,vb)=>{Cc.a.BBh(vb.name)&&(this.gj.sMb=ji.a.R3(this.Ib,()=>{vb.name!==ed.AFrame.JM&&2!==this.fj.mode&&3!==this.fj.mode&&(this.fj.clearSelection(),this.Nh.updateCommandUI(!0));this.gj.sMb=null},Li.a.Imn))});this.lp.JT(ed.AFrame.Ur);
if(this.Sg.uBb)for(const cb of gh.t)la.bindAction(md.KeyInputManager.NG(cb),rf.a.W5e)}Oio(){this.GBc&&this.VXe.JHl()}xDh(){this.z3j&&this.Oio()}Tmn(la,cb,vb,ec){const xc=this.fj,ad=xc.Go.Qx;ad&&ad.Bz?xc.p9e.endCommentSession(ad.Bz.draftId):a.ULS.sendTraceTag(40130755,327,10,"Attempting to discard when there is no active draft!");this.ckb(la,cb,vb,ec,!0);ji.a.R3(this.Ib,()=>{this.Nh.updateCommandUI(!0)},Li.a.z9n)}Yln(){this.GBc&&this.Vb.mg(ed.AFrame.Ur);this.Nh.updateCommandUI(!0)}jIa(la){la.nr(this.Vb.WW);
la.nr(this.Vb.XW)}gRb(la,cb,vb){if(1===vb)return 32;this.Gsj();return 32}Gsj(){this.isVisible||(this.Sg.Ghb&&(this.gj.VIa=!0),this.gj.FY?(this.Lpl(),this.gj.Bm=!0,this.G2.Fce(),this.Vb.zFc(ed.AFrame.Ur),this.ar&&this.Sg.pRb&&this.fj.ROb(this.fj.model.Mof(()=>!0)),this.z3j=!0,bk.UISurfaces.Nu().then(la=>{la.showTaskPane(wn.a.wHd,this.emk);return null}).catch(()=>{a.ULS.sendTraceTag(559273377,327,10,"Error showing comment task pane.")}),this.fj.Hgc(null),this.Nh.updateCommandUI(!0),this.jIa(this.Vb.fe(ed.AFrame.Ur)),
this.G2.s$("OnCommentPaneOpen"),a.ULS.sendTraceTag(37007903,327,50,"New Comment Pane opened.")):this.G2.s$("OnCommentInit",Object.assign(new Ue.a,{tHa:()=>{this.gj.Bm||this.ga.processAction(Xe.a.LV,2)}})))}Lpl(){this.ga.Qb(rf.a.p4,2,null);this.ga.Qb(rf.a.iU,2,null)}Xkb(){return this.xla.Xkb(this.ga,!1)}MAb(){}show(){this.isVisible||this.ga.processAction(Xe.a.LV,2)}editComment(){return 2}FWd(){this.fj.paneClosing();this.gj.Bm=!1;if(this.ar&&this.Sg.pRb){const cb=this.fj.model;this.fj.ROb(cb.Mof(vb=>
cb.lia(vb)))}var la=qd.FocusManager.instance();la.currentScope&&la.currentScope.name===ed.AFrame.Ur&&la.mg(this.ar&&(2===this.fj.mode||3===this.fj.mode||this.fj.Kj.tt)?ed.AFrame.JM:la.gU);this.lp.fx(ed.AFrame.Ur);this.Vb.oLc(ed.AFrame.Ur);bk.UISurfaces.Nu().then(cb=>{cb.hideTaskPane(wn.a.wHd,2);return null}).catch(()=>{a.ULS.sendTraceTag(559273378,327,10,"Error hiding Comment Pane.")});this.ar&&(la=this.fj.model.tt)&&this.kVo(la);this.G2.s$("OnCommentPaneClose");a.ULS.sendTraceTag(572281360,327,50,
"New Comment Pane closed.")}kVo(la){la.done?this.fj.clearSelection():this.CVb.vWh(la)}gvn(la=null){this.VXe.Coj(3);this.LBf();if(la){this.xDh();Co.a.a7f(la,[Bf.a.contextMenu]);const cb=this.Vb.fe(ed.AFrame.Ur);this.ig.r2b(ed.AFrame.Ur,la,cb.KVa)}}Isn(la){this.lp.$I(ed.AFrame.Ur);1!==la&&ji.a.R3(y.AFrameworkApplication.lc,()=>{this.Vb.kD(ed.AFrame.Ur)},Li.a.xdg)}onTaskPaneClose(){this.gj.FY&&this.VXe.Coj(1)}bUd(){const la={type:this.aro,xjp:this.xDh};return Object.assign(new Gh.a,{title:WordEditorIntl.WordEditorStrings.L_Comments,
contentProps:la,hideHeader:!1,width:300,location:2,onOpen:cb=>{this.GBc=cb;this.gvn(cb);this.uQ.Zmg(!0)},onClose:()=>{this.GBc=null;this.ga.Qb(Xe.a.ckb,2,!0);this.Nh.updateCommandUI(!0);this.onTaskPaneClose();const cb=this.fj.Go;this.gj.VIa&&cb.bTc()&&this.uQ.Zmg(!1)},onShow:cb=>{this.Isn(cb)}})}LV(){return 32}}Object(e.a)(ie,"OfficeSharedCommentPane",null,[9,383,384]);var Cd=c(1696),ik=c(181);class oj{constructor(la,cb){this.containerType="full-pane";this.identifier=null;this.ga=la;this.identifier=
cb}openView(){this.ga.processAction(Xe.a.gRb,2)}closeView(){this.ga.Qb(Xe.a.ckb,2,!0)}invokeModalConfirmationDialog(la,cb,vb){const ec=new ik.StandardDialog;vb&&vb.title&&vb.body&&vb.confirmButton&&vb.cancelButton||(a.ULS.sendTraceTag(35678229,327,10,"InvokeModalConfirmationDialog: No localized strings provided."),vb=new fi("","","",""));ec.Cd=1;ec.ze(1,vb.confirmButton);ec.ze(0,vb.cancelButton);ec.rv(vb.title,vb.body,1,xc=>{1===xc?la():cb()})}}Object(e.a)(oj,"ViewContainerAPI",null,[380,381]);class ck{constructor(la,
cb,vb){this.EMo=la;this.Ch=cb;this.AJa=vb;this.fd=new ha.a;this.EMo.execute(ec=>{this.AJa.ode("OnBeforeTrackChangeMarkupViewChange",(xc,ad)=>{ad&&ad.tTf!==ec.Nj&&this.fd.raiseEvent("OnBeforeTrackChangeMarkupViewChange",ad)});this.AJa.ode("OnAfterTrackChangeMarkupViewChangeEventKey",(xc,ad)=>{ad&&ad.Nj===ec.Nj&&(th.a.Nj=ec.Nj,this.fd.raiseEvent("OnAfterTrackChangeMarkupViewChange",ad))})})}u$(la,cb){this.fd.addHandler(la,cb)}s$(la,cb){this.fd.raiseEvent(la,cb)}Fce(){this.Ch.E5f||(this.Ch.E5f=!0,this.fd.raiseEvent("OnCommentRenderedOnce"))}}
Object(e.a)(ck,"WordCommentEventsActor",null,[]);var Bi=c(1842);class uh{constructor(){this.insertIndex=0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(e.a)(uh,"InitCommentSessionResult",null,[]);class xg extends uh{constructor(){super();this.updatedDraftSessionConfiguration=null}}Object(e.a)(xg,"BeginDraftingHostResult",uh,[]);var Pd=c(2111),gi=c(2066),hg=c(1059);class Sl{constructor(la,cb,vb,ec,xc,ad,Zd,pe,Td,Ie,We,Vf,tf,yf,lf){this.taskManager=
la;this.zsa=cb;this.SUj=vb;this.PNo=ec;this.x9e=xc;this.Vr=ad;this.zt=Zd;this.focusManager=pe;this.M1=Td;this.oc=Ie;this.Ik=We;this.X_=Vf;this.Ch=tf;this.v2k=yf;this.t2k=lf;this.$Zb=this.y7=this.Om=null;this.IZj="WordWebCommitNewCommentActivity";this.JZj="WordWebCommitTaskActivity";this.FZj="WordWebCommentReactionActivity";this.PPg=null}get xla(){return this.y7}FGn(la){var cb;const vb=this.xla.Qx,ec=this.y7.bP();if(ec&&vb){const xc=hg.a.$hb(null!==(cb=vb.authorId)&&void 0!==cb?cb:"");cb=new Bi.a(vb.authorId,
vb.C3b,vb.author,null!==xc&&void 0!==xc?xc:"",!0);la.author=cb;la.insertIndex=Array.indexOf(ec,vb);la.authorName=vb.author;la.authorIdentity="";return null}return ji.a.QD(-2130915320)}initialize(la,cb,vb,ec){this.Om=la;this.y7=cb;this.$Zb=vb;this.PPg=ec}beginDraftingAsync(la){if(!la)return new Promise((ec,xc)=>{xc(ji.a.QD(-2130915327))});const cb=new xg,vb=Kh.a.Irf(la.sessionType);return void 0===vb||null===vb?new Promise((ec,xc)=>{xc(ji.a.QD(-2130915317))}):new Promise((ec,xc)=>{ji.a.R3(this.taskManager,
()=>{if(1!==this.Om.mode)a.ULS.sendTraceTag(40130753,327,10,"Create InitCommentSession Failed. CommentingMode={0}",this.Om.mode),xc(ji.a.QD(-2130915325));else{this.VCh();try{switch(vb){case 0:if(!this.Om.Mda.Xkb()){xc(ji.a.QD(-2130915326));return}this.v2k.DWd();a.ULS.sendTraceTag(553710798,327,50,`Creating comment for ${la.draftId}`);this.Om.MAb(la);break;case 1:if(!la.threadId||""===la.threadId){xc(ji.a.QD(-2130915324));return}if(this.Vr.lig){const pe=this.y7.ZD(la.threadId);if(pe){const Td=this.y7.s7h(pe,
!1),Ie=Pd.a.RFb(pe,Td,pe.authorId===this.Vr.bZ);Ie&&this.x9e.invoke(la.threadId,Ie)}else a.ULS.sendTraceTag(579170962,327,10,"Smart reply provider not invoked since comment is null",this.Om.mode)}this.Om.addReply(la.threadId,la);break;case 3:if(!la.threadId||""===la.threadId){xc(ji.a.QD(-2130915324));return}var ad=this.y7.ZD(la.threadId);if(!ad){xc(ji.a.QD(-2130915323));return}this.Om.editComment(ad,la);break;case 2:if(!la.commentId||""===la.commentId){xc(ji.a.QD(-2130915324));return}const Zd=this.y7.ZD(la.commentId);
if(!Zd){xc(ji.a.QD(-2130915323));return}this.Om.editComment(Zd,la)}}catch(Zd){xc(Zd);this.mej();a.ULS.sendTraceTag(553677466,327,10,`Drafting Exception ${Zd} on Session ${vb}`);return}(ad=this.FGn(cb))?xc(ad):ec(cb);this.mej()}},Li.a.beginDraftingAsync)})}commit(la,cb,vb){const ec=this.xla.Qx;if(!ec)throw ji.a.QD(-2130915320);var xc=ec.Bz;if(!xc)throw ji.a.QD(-2130915320);const ad=Kh.a.Irf(xc.sessionType);if(void 0===ad||null===ad)throw ji.a.QD(-2130915317);if(la!==xc.draftId)throw ji.a.QD(-2130915327);
let Zd=!1,pe=!1;xc=!1;switch(ad){case 3:if(!vb)throw ji.a.QD(-2130915327);break;case 0:this.Ik.ie(()=>{if(!this.Om.Mda.Xkb())throw ji.a.QD(-2130915326);ec.text=[cb];this.Om.BA&&!this.Ch.Bm?this.Om.gCn(()=>{this.Om.sva(ec);this.Om.Wul(la,ec.id)}):this.Om.sva(ec);pe=vb&&null!=vb.Task;Zd=this.Om.BA;ji.a.R3(this.taskManager,()=>{this.Fpb(ec.id)},Li.a.Fpb)},"WESCA:C:C");break;case 1:this.Ik.ie(()=>{ec.text=[cb];this.Om.sva(ec);pe=vb&&null!=vb.Task;Zd=this.Om.BA},"WESCA:C:R");break;case 2:this.Ik.ie(()=>
{ec.text=[cb];this.Om.lgb(ec);this.K4i(rf.a.A4m)},"WESCA:C:E");break;default:throw ji.a.QD(-2130915322);}vb&&(vb.Resolve&&(this.$kj(ec,vb.Resolve.isResolved),vb.Resolve.isResolved&&!this.Ch.Bm&&this.Om.notify(Box4Intl.Box4Strings.L_CommentResolved,!0)),vb.Task&&this.Om.V2k(ec,vb.Task),vb.Reaction&&(xc=this.Vr.C2k,vb.Reaction.isActive?this.Om.BBd(ec,vb.Reaction.reactionType):this.Om.Ade(ec,vb.Reaction.reactionType)));this.Vr.N2k&&pe&&this.M1.execute(Td=>Td.logActivity(this.JZj,"CommentsTasksFpsIsEnabled"));
Zd&&this.M1.execute(Td=>{Td.logActivity(this.IZj,"CommentsFpsIsEnabled")});xc&&this.M1.execute(Td=>{Td.logActivity(this.FZj,"CommentReactionsFpsIsEnabled")});return ec.id}endCommentSession(la){const cb=this.xla.Qx;if(cb){if(cb.Bz&&cb.Bz.draftId!==la)throw ji.a.QD(-2130915327);if(cb.$q===Hd.a.beingCreated)this.Om.deleteComment(cb),!this.Om.BA||cb.Df||this.Ch.Bm||this.focusManager.mg(ed.AFrame.In);else{if(3!==this.Om.mode){a.ULS.sendTraceTag(33621450,327,50,"CommentingMode != EditingComment at the time of ending a comment session");
return}cb.$q=Hd.a.normal;cb.eUa=gi.a.succeeded;cb.Bz=null;this.Om.S6e()}}this.zt&&this.zt.updateCommandUI(!0);this.xla.jTd()||this.zsa.Wpg(1,!this.Om.mode)}deleteComment(la){(la=this.y7.ZD(la))?(this.Om.deleteComment(la),this.Om.BA&&!this.Ch.Bm?la.Df||this.focusManager.mg(ed.AFrame.In):this.focusManager.kD(ed.AFrame.Ur),this.PNo.xgg(la)&&this.K4i(rf.a.zKi)):a.ULS.sendTraceTag(594600902,327,15,"Comment to delete is not in the model.")}selectComment(la){this.Fpb(la,0)}highlightComment(la){this.Om.Hgc(la,
0)}setThreadResolvedState(la,cb){(la=this.y7.ZD(la))&&this.$kj(la,cb)}$kj(la,cb){if(la.Df&&""!==la.Df)throw ji.a.QD(-2130915321);this.Om.iCb(la,cb);cb&&!this.Ch.Bm&&this.focusManager.mg(ed.AFrame.In)}presentLinkToComment(la){var cb=this.y7.ZD(la);cb?(cb=this.xla.vRd(cb))?(la={["nav"]:btoa(`{"${Yo.a.comment}":${cb}}`),["mode"]:"copy"},this.t2k.Tv(rf.a.presentLinkToComment),this.oc.Qb(Xe.a.V8,2,la,{["ControlId"]:"CopyLinkToComment"})):a.ULS.sendTraceTag(578058146,327,10,"[LinkToComment] Invalid durableCommentId for commentId: {0}",
la):a.ULS.sendTraceTag(578401558,327,10,"[LinkToComment] Comment not found for Id {0}",la)}selectFirstThreadInNextCommentContext(){this.Om.Hij(0)}selectLastThreadInPreviousCommentContext(){this.Om.Nco()}registerForCommentEvents(la){const cb=this.xla.ipf(this.Vr.pRb&&this.Vr.ar&&!this.Ch.Bm),vb=this.xla.DWa,ec=this.xla.jTd(),xc=!this.Om.mode;this.zsa.bno();this.PPg.c5l().then(ad=>{this.zsa.PWn(la,cb,ec,xc,vb,ad);this.zsa.Wpg(ec?5:1,xc);this.zt&&this.zt.updateCommandUI(!0)})}unregisterForCommentEvents(la){this.zsa.JSb(la)}registerForAction(la,
cb){this.SUj.ETa(la,cb)}unregisterForAction(){}checkAtMentionCapability(){return this.$Zb?this.$Zb.atMentionsEnabledAsync():(a.ULS.sendTraceTag(36475799,327,10,"AtMentionEnabled called before initialization."),new Promise(la=>{la(!1)}))}resolveSupported(){return!0}loadThreads(){a.ULS.sendTraceTag(40130754,327,10,"LoadThreads incorrectly called on unsupported platform.")}VCh(){const la=this.Om.BA&&!this.Ch.Bm?ed.AFrame.JM:ed.AFrame.Ur;if(la===ed.AFrame.Ur){if(!this.Ch.Bm)return;bk.UISurfaces.Nu().then(cb=>
{cb.setSelectedTaskPane(wn.a.wHd);return null})}this.focusManager.kD(la)}Fpb(la,cb=1){this.VCh();this.X_.Aij(la,Object.assign(new af.a,{E$:cb,mS:1===cb}))}mej(){this.Om.Mda.Peb&&(this.Om.Mda.Peb=!1)}K4i(la){this.oc.processAction(la,2)}}Object(e.a)(Sl,"WordEditorSharedCommentAPI",null,[378,379]);class hh{constructor(la,cb,vb,ec,xc,ad,Zd=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=la;this.parentId=cb;
this.commentBody=vb;this.author=ec;this.date=xc;this.commentFlags=ad;this.usersByReactionType=Zd}}Object(e.a)(hh,"OfficeSharedCommentModel",null,[]);c(1678);class xn{constructor(la,cb){this.Ca=la;this.LKb=cb;this.Wnh="AD";this.Hsc=new S.a;this.GXe=new S.a;this.GIk=RegExp("(.*?)\\s*(\\[\\d+\\])$");this.MPg=new Sh.a}get userPrincipalName(){return this.Ca.kb("UserPrincipalName")}get H6a(){return this.Ca.kb("PresenceProvider")}get bZ(){return this.Ca.kb("PresenceUserId")}get rj(){return this.LKb.value}ZRi(la){const cb=
this.GIk.exec(la);return cb?cb[1]:la}uhi(la,cb=!1){let vb=0;la.done&&(vb=la.Df&&""!==la.Df?vb|4:vb|8);la.jJh&&(vb|=2);cb&&(vb|=1);this.xgg(la)&&(vb|=16);la.zGf&&(vb|=32);this.$sm(la)||(vb|=128);return vb}$sm(la){return la?(la=this.rj.Eb(la.objectId))?la.hasProperty(sa.a.WQ):!1:!1}xgg(la){if(!la)return!1;if(void 0===la.authorId||null===la.authorId||""===la.authorId)return this.DNf(la.id,la.objectId,"Comment AuthorId null or empty"),!1;if(void 0===this.bZ||null===this.bZ||""===this.bZ)return this.DNf(la.id,
la.objectId,"PresenceUserId null or empty"),!1;if(this.bZ==la.authorId&&la.C3b==this.H6a)return!1;const cb=this.SNd(la.authorId),vb=this.SNd(this.bZ);if(this.H6a===this.Wnh&&cb&&vb&&cb[0]!=this.userPrincipalName&&cb[1]!=vb[1])return!0;this.DNf(la.id,la.objectId,"Unknown");return!1}isCurrentUser(la){if(!la||void 0===la.authorId||null===la.authorId||""===la.authorId||void 0===this.bZ||null===this.bZ||""===this.bZ)return!1;if(this.bZ==la.authorId&&la.C3b==this.H6a)return!0;la=this.SNd(la.authorId);const cb=
this.SNd(this.bZ);return this.H6a===this.Wnh&&la&&cb?la[0]==this.userPrincipalName||la[1]==cb[1]:!1}SNd(la){if(void 0===la||null===la)return null;la=la.split("::");return 3===la.length?la.slice(1,3):null}DNf(la,cb,vb){la&&!this.MPg.contains(la)&&(a.ULS.sendTraceTag(42824129,327,50,`No edit restriction for commentObjectId: ${cb}; reason: ${vb}`),this.MPg.add(la))}t3h(la,cb){var vb;if(!la)return null;const ec=la.J0d;let xc=!1;1===cb&&(xc=!0);cb=la.author?this.ZRi(la.author):"";const ad=hg.a.$hb(null!==
(vb=la.authorId)&&void 0!==vb?vb:"");vb=new Bi.a(la.authorId?la.authorId:"",la.C3b,cb,null!==ad&&void 0!==ad?ad:"",this.isCurrentUser(la));return new hh(la.id?la.id:"",la.Df?la.Df:"",la.text&&la.text.length?la.text[0]:null,vb,la.date||ec?la.date:new Date,this.uhi(la,xc),this.whi(la.usersByReactionType))}cKl(la,cb,vb){const ec=[],xc=new S.a;if(!la)return ec;for(const ad of la)ad.$q!==Hd.a.beingCreated&&vb(ad)&&(ad.id&&this.Hsc.nb(ad.id)?(la=this.Hsc.J(ad.id),la=this.Dcl(ad,la,cb),ec.push(la),xc.Z(ad.id,
la)):ad.id?(la=this.t3h(ad,cb),ec.push(la),xc.Z(ad.id,la)):a.ULS.sendTraceTag(50667679,327,10,"CommentId should not be null"));this.Hsc=xc;return ec}tQl(la,cb,vb){const ec=[];for(const xc of la)xc.$q!==Hd.a.beingCreated&&vb(xc)&&(xc.id&&this.Hsc.nb(xc.id)?ec.push(this.Hsc.J(xc.id)):xc.id&&ec.push(this.t3h(xc,cb)));return ec}Dcl(la,cb,vb){var ec=la.J0d,xc=1===vb;vb=la.Df?la.Df:"";const ad=la.text&&la.text.length?la.text[0]:null,Zd=la.author?this.ZRi(la.author):"",pe=la.authorId?la.authorId:"",Td=la.C3b?
la.C3b:"",Ie=hg.a.$hb(pe);ec=la.date||ec?la.date:new Date;xc=this.uhi(la,xc);const We=this.isCurrentUser(la),Vf=this.whi(la.usersByReactionType);return cb.parentId===vb&&cb.commentBody===ad&&cb.author.DisplayName===Zd&&cb.author.UserId===pe&&cb.author.Provider===Td&&cb.author.IsCurrentUser===We&&cb.date===ec&&cb.commentFlags===xc&&this.jHk(cb.usersByReactionType,Vf)?cb:(cb=new Bi.a(pe,Td,Zd,null!==Ie&&void 0!==Ie?Ie:"",We),new hh(la.id,vb,ad,cb,ec,xc,Vf))}jHk(la,cb){if(!la&&!cb)return!0;if(!cb||!la)return!1;
var vb=Object.keys(la);if(vb.length!==Object.keys(cb).length)return!1;for(const ec of vb){if(!(ec in cb))return!1;vb=la[ec];const xc=cb[ec];if(vb.length!==xc.length)return!1;for(let ad=0;ad<vb.length;ad++)if(!this.YGk(vb[ad],xc[ad]))return!1}return!0}YGk(la,cb){return la||cb?la&&cb&&la.UserId===cb.UserId&&la.Provider===cb.Provider&&la.Email===cb.Email&&la.DisplayName===cb.DisplayName&&la.IsCurrentUser===cb.IsCurrentUser?!0:!1:!0}whi(la){if(!la)return null;const cb={},vb=this.Ca.kb("PresenceUserId");
for(const xc of Object.keys(la)){const ad=[];var ec=la[xc];for(const Zd of ec){ec=Zd.UserId===vb;let pe;this.GXe.nb(Zd.UserId)?(pe=this.GXe.J(Zd.UserId),pe.IsCurrentUser=ec):(pe=new Bi.a(Zd.UserId,Zd.Provider,Zd.DisplayName,Zd.Email,ec),this.GXe.add(Zd.UserId,pe));ad.push(pe)}cb[xc]=ad}return cb}}Object(e.a)(xn,"WordEditorSharedCommentModelTranslator",null,[377]);class ch{constructor(){this.Jp=null;this.fhd=this.Jbh=this.lMg=this.Vih=this.Qlh=this.r8g=this.Ldh=!1}vhi(){this.Jp||(a.ULS.sendTraceTag(588292828,
327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),this.Inj());return this.Jp}c5l(){return new Promise((la,cb)=>{this.fhd?la(this.Kci()):this.zkj().then(()=>{la(this.Kci())}).catch(vb=>{cb(vb)})})}Kci(){this.fhd||a.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let la;la=33;this.lMg&&(la|=2);this.Ldh&&(la|=8);this.Qlh&&(la|=16);this.r8g&&(la|=4);this.Vih&&
(la|=64);this.Jbh&&(la|=128);return la}}Object(e.a)(ch,"OfficeSharedCommentsAppCapabilities",null,[877]);class on extends ch{constructor(la){super();this.NYa=null;this.Sg=la;this.noo();this.Inj()}noo(){this.Vih=this.Sg.$Rb;this.Qlh=!1;this.Jbh=this.r8g=this.Ldh=!0}initialize(la){this.NYa=la;this.zkj()}Inj(){this.Jp={};this.Jp.LivePersonaPicker="true";this.Jp.PersonaColor="true";this.Jp.DiscreteHostedComments=this.Sg.mpl.toString();this.Jp.NewCommentButton="true";this.Jp.DisabledChangeGates=this.Sg.epl;
this.Jp.CommentsFluentUI="true";this.Jp.CommentTasks=this.Sg.$Rb.toString();this.Jp.CommentTasksFromReply=this.Jp.CommentTasks;this.Jp.CommentFriendlyTimestamps=this.Sg.W1k.toString();this.Jp.AtMentionFloodgateSurvey=this.Sg.eIk.toString();this.Jp.HyperlinksInComments="true";this.Jp.LogDraftCommentIdPair="true";this.Jp.RichTextFormattingInWeb=this.Sg.uBb.toString();this.Jp.RichContentEditIntegration="true";this.Jp.HyperlinksWithDisplayText="true";this.Jp.SmartReplies=this.Sg.lig.toString();this.Jp.LinkToComment=
"true";this.Jp.TaskPaneWithNewInfrastructure="true";this.Jp.CommentReactions="true";this.Jp.WebThemeIntegration="true";this.Jp.NewSelectionInteractions="true";this.Jp.HighlightsAndFontColorInWebComments="true";this.Jp.TruncationUIWithReadMoreText="true";this.Jp.CtrlEnterTip="true";this.Jp.AtMentionHintMessage="true";this.Jp.LivePersonaCardForWeb="true";this.Jp.TaskHistoryRecordIDs=this.Sg.qIo.toString();this.Jp.ContentNavigation=this.Sg.contentNavigationApiEnabled.toString()}zkj(){return new Promise((la,
cb)=>{this.NYa?this.NYa.atMentionsEnabledAsync().then(vb=>{this.lMg=vb;this.fhd=!0;la(this.fhd)}):(a.ULS.sendTraceTag(588292830,327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),cb(ji.a.QD(-2130915320)))})}}Object(e.a)(on,"WordSharedCommentsAppCapabilities",ch,[376]);class Ml{constructor(){this._initialized=!1;this.M2k={crewAlias:"webasynccollabeng",featureName:"Comments",topLevelKpiName:Vh.a.pkf,vetoPillar:7};
this.xIo={crewAlias:"webasynccollabeng",featureName:"Tasks",topLevelKpiName:Cd.a.pkf,vetoPillar:7}}get r6a(){return null!=this.oFg?this.oFg:this.oFg=(()=>this.W.resolve("Box4.IPackageBootPerfLogger"))()}C_(la){this.r6a.C_(tl.a.comments,la,!0)}get name(){return"WordEditor.Comments"}wc(la){this.W=la;this.C_("CPConfigStart");la.ia("WordEditor.Comments.ICommentsUsageAndHealthLogger",()=>new Hf.a(m.Health.instance,new Ed.a,this.M2k)).as("WordEditor.Comments.ICommentsUsageAndHealthLogger").ha();la.ia("WordEditor.Comments.ITasksUsageAndHealthLogger",
()=>new Hf.a(m.Health.instance,new Ed.a,this.xIo)).as("WordEditor.Comments.ITasksUsageAndHealthLogger").ha();la.ia("WordEditor.Comments.CommentNodeTracker",()=>new $p(this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.CommentNodeTracker").ha();la.ia("WordEditor.Comments.CommentsSettings",()=>new Yi(y.AFrameworkApplication.K,this.W.resolve("Box4.IFeatureHelper"),new W.a(()=>Q.App.za.jb.Zc),new W.a(()=>Zl.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),
this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"))).as("WordEditor.Comments.CommentsSettings").ha();la.ia("WordEditor.Comments.CommentsState",()=>new th.a).ha();la.ia("WordEditor.Comments.WordCommentEventsActor",()=>new ck(la.Ta("Box4.TrackChange.ITrackChangeManager"),la.resolve("WordEditor.Comments.CommentsState"),la.resolve("Box4.TrackChange.ITrackChangeEventsActor"))).ha();la.ia("WordEditor.Comments.WordEditorSharedCommentModelTranslator",()=>new xn(y.AFrameworkApplication.K,new W.a(()=>
Q.App.za.jb.Zc.xd))).as("WordEditor.Comments.IWordEditorSharedCommentModelTranslator").ha();la.ia("WordEditor.Comments.CommentDeltaFormatTranslator",()=>new Lb(la.resolve("WordEditor.Comments.CommentsSettings"),la.resolve("Box4.Styles.IWACStyleReader"))).as("WordEditor.Comments.ICommentFormatTranslator").ha();la.ia("Common.Comments.OfficeSharedCommentsEventHost",()=>new Hh(y.AFrameworkApplication.lc)).as("Common.Comments.IOfficeSharedCommentsEventHost").ha();la.ia("WordEditor.Comments.CommentActionInTypingRecorder",
()=>new Zk(this.W.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentActionInTypingRecorder").ha();la.ia("WordEditor.Comments.EditorCommentModel",Xg.a.getInstance).as("Common.Comments.ICommentModel").as("WordEditor.Comments.IWordEditorCommentModel").as("WordEditor.Comments.IEditorCommentModel").ha();la.ia("WordEditor.Comments.ICommentModelBootLoader",()=>new Nh(new W.a(()=>Q.App.za.jb.Zc),new W.a(()=>Zl.a.instance),la.resolve("WordEditor.Comments.IEditorCommentModel"),
la.resolve("WordEditor.Comments.CommentsState"),la.resolve("WordEditor.Comments.CommentsSettings"),la.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger")));la.ia("WordEditor.Comments.ICommentFilterActor",()=>new Qc(la.resolve("WordEditor.Comments.IEditorCommentModel"),y.AFrameworkApplication.K,la.resolve("WordEditor.Comments.WordCommentEventsActor"))).ha();la.resolve("WordEditor.Comments.ICommentFilterActor");la.ia("WordEditor.Comments.CommentHighlightOnRestActor",
()=>new Th(new W.a(()=>Q.App.za.jb.Zc),la.resolve("WordEditor.Comments.CommentsState"),la.resolve("WordEditor.Comments.IEditorCommentModel"),la.resolve("WordEditor.Comments.WordCommentEventsActor"),la.resolve("Box4.INotebookManager").Il,R.a.instance,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"),la.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentHighlightOnRestActor").ha();la.ia("WordEditor.Comments.CommentHighlightUtils",()=>new ye(la.resolve("Box4.Highlight.IHighlightManager"))).ha();
la.ia("WordEditor.Comments.DefaultHighlightChangeHandler",()=>new Xb(la.resolve("WordEditor.Comments.CommentHighlightUtils"))).ha();la.ia("WordEditor.Comments.AllMarkupModeHighlightChangeHandler",()=>new sk(la.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),la.resolve("WordEditor.Comments.CommentHighlightUtils"),y.AFrameworkApplication.ua.X1,y.AFrameworkApplication.ua.uJa,y.AFrameworkApplication.va,y.AFrameworkApplication.lc,la.resolve("WordEditor.Comments.CommentsState"),la.Ta("WordEditor.Comments.IEditorCommentManager"))).ha();
la.ia("WordEditor.Comments.CommentHighlightActor",()=>new he(new W.a(()=>Q.App.za.jb.Zc.xd),la.resolve("WordEditor.CommentsInteractive.ICommentEditor"),la.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),la.Ta("WordEditor.Comments.IEditorCommentManager"),R.a.instance,la.resolve("WordEditor.Comments.AllMarkupModeHighlightChangeHandler"),la.resolve("WordEditor.Comments.DefaultHighlightChangeHandler"),la.resolve("WordEditor.Comments.CommentHighlightUtils"),la.resolve("WordEditor.Comments.WordCommentEventsActor"))).as("WordEditor.Comments.ICommentHighlightActor").ha();
la.ia("WordEditor.Comments.CommentHintActor",()=>new Mh(la.resolve("WordEditor.Comments.CommentsSettings"),bn.a.instance,lj.a.instance,il.a.instance,y.AFrameworkApplication.va,ho.TableCellReader.MPm,Fl.moveToLastRenderedCellOfTheRow,new ki.a,la.Ta("Box4.ContentControlConfigSettings"),la.resolve("WordEditor.Comments.IEditorCommentModel"),la.resolve("WordEditor.Comments.ICommentHighlightActor"),la.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),la.resolve("WordEditor.Comments.CommentsState"),
la.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).as("WordEditor.Comments.ICommentHintActor").ha();la.ia("WordEditor.Comments.CommentMarginEntryPointActor",()=>new xe(bn.a.instance,il.a.instance,y.AFrameworkApplication.va,la.resolve("WordEditor.Comments.ICommentHintActor"),la.Ta("Common.IZoomManager"),la.resolve("WordEditor.Comments.CommentsSettings"))).ha();la.ia("WordEditor.Comments.ViewContainerAPI",()=>new oj(y.AFrameworkApplication.va,"OfficeSharedCommentPaneSurface")).as("WordEditor.Comments.IWordViewContainerAPI").ha();
la.ia("Common.Comments.CommentActivationManager",()=>new zk).as("Common.Comments.ICommentActivationManager").ha();la.ia("Common.Comments.ViewContainerEventHost",()=>new Im(y.AFrameworkApplication.lc,"OfficeSharedCommentPaneSurface")).as("Common.Comments.IViewContainerEventHost").ha();la.ia("WordEditor.Comments.CommentSmartReplyProvider",()=>new sm(this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),
this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"))).as("Common.Comments.ICommentSmartReplyProvider").ha();la.ia("WordEditor.Comments.WordSharedCommentsAppCapabilities",()=>new on(la.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.IWordSharedCommentsAppCapabilities").ha();this.C_("CPConfigEnd")}init(){this.C_("CPInitStart");this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{try{this.wn(),this.C_("CPInitEnd")}catch(la){throw a.ULS.Vz(524300632,327,10,la,"Exception threw from Comments Package initialization in onAfterGraphFeaturesNodeLoaded: {0}",
la),this.r6a.Fx(tl.a.comments,"CPInitException",la,!0),la;}})}wn(){const la=this.W.resolve("WordEditor.Comments.CommentsSettings");this.C_("onAfterGFNLoadedStart");this.W.ia("WordEditor.Comments.OfficeSharedCommentPane",()=>new ie(y.AFrameworkApplication.va,y.AFrameworkApplication.ua.oD,y.AFrameworkApplication.ua.pD,y.AFrameworkApplication.ua.Hp,y.AFrameworkApplication.ua.wx,Q.App.za,qm.a.instance,this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),
this.W.resolve("Common.Comments.IViewContainerEventHost"),y.AFrameworkApplication.lc,this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),la,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"))).as("Common.Comments.ICommentPane").as("WordEditor.Comments.IOfficeSharedCommentPane").ha();this.W.ia("Common.Comments.OfficeSharedCommentsActionHost",
()=>new Rl(y.AFrameworkApplication.va,this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane").Dqc)).as("Common.Comments.IOfficeSharedCommentsActionHost").ha();this.W.ia("WordEditor.Comments.WordEditorSharedCommentAPI",()=>new Sl(y.AFrameworkApplication.lc,this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),this.W.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),
la,Q.App.za,y.AFrameworkApplication.ua.Hp,this.W.Ta("Common.ISystemInitiatedFeedback"),y.AFrameworkApplication.va,R.a.instance,this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.IWordEditorSharedCommentAPI").ha();me.a.factory=Mc.getInstance;this.W.ia("WordEditor.Comments.EditorCommentManager",
Mc.getInstance).as("Common.Comments.ICommentManagerCore").as("WordEditor.Comments.IEditorCommentManager").ha();this.W.ia("WordEditor.Comments.CommentFloatingContainerActor",()=>new zb(this.W.resolve("WordEditor.Comments.CommentsState"),la,this.W.resolve("WordEditor.Comments.IEditorCommentModel"),y.AFrameworkApplication.lc,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),
()=>document.querySelector(`#${Fj.AppFrame.TVa} .${rm.a.H6b}`),this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),y.AFrameworkApplication.ua.Hp)).as("WordEditor.Comments.ICommentFloatingContainerActor").ha();const cb=this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"),vb=cb.trackChangeInSidetrackEnabled;vb&&this.W.resolve("WordEditor.Sidetrack.IFloatingContainerActorConsumer").K9i(this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"));this.W.ia("WordEditor.Comments.FloatingCommentManager",
()=>new oe(this.W.resolve("WordEditor.Comments.IEditorCommentModel"),y.AFrameworkApplication.lc,R.a.instance,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),cb)).ha();this.W.ia("WordEditor.Comments.IFloatingCommentManager",()=>vb?this.W.resolve("WordEditor.Sidetrack.SidetrackManager"):
this.W.resolve("WordEditor.Comments.FloatingCommentManager")).as("Box4.IFloatingObjectUpdater").ha();this.W.ia("WordEditor.Comments.CommentSelectionActor",()=>new bq(y.AFrameworkApplication.va,this.W.resolve("Common.Comments.ICommentModel"),this.W.resolve("WordEditor.Comments.ICommentHighlightActor"),Oi.getInstance(),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),y.AFrameworkApplication.ua.Hp,this.W.resolve("WordEditor.Comments.CommentsState"),
la,new W.a(()=>Tf.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.W.Ta("WordEditor.Extension.RichApiEventManager"))).as("WordEditor.Comments.ICommentSelectionActor").ha();this.W.ia("WordEditor.Comments.CommentInitActor",()=>new Id(this.W.resolve("WordEditor.Comments.IEditorCommentManager"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"),this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane"),
this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),la,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),Oi.getInstance(),Q.App.za.Lq,y.AFrameworkApplication.va,this.W.resolve("Common.IDynamicScriptLoaderProvider").dA,this.W.Ta("WordEditor.Comments.ICommentRibbonCommandHandler"),y.AFrameworkApplication.ua.Hp,this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),
this.W.resolve("Common.Comments.ICommentActivationManager"),this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),this.W.Ta("Common.ISystemInitiatedFeedback"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.Ta("Common.App.SafeLinks.ISafeLinksManager"),this.W.Ta("Common.App.People.IExternalPeopleAPI"),this.W.resolve("Common.OfficeSharedCommentsTelemetry"),this.W.resolve("Common.Comments.IViewContainerEventHost"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),
this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),cb,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentNavigationAPI"),this.W.resolve("Box4.IPackageBootPerfLogger"),this.W.resolve("WordEditor.Comments.ICommentModelBootLoader"),this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentFilterAPI"))).ha();this.W.ia("WordEditor.Comments.CommentsActionManager",()=>new Ll(this.W.resolve("WordEditor.Comments.EditorCommentManager"),
this.W.resolve("WordEditor.Comments.EditorCommentModel"),this.W.resolve("WordEditor.Comments.ICommentHintActor"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),la,this.W.resolve("Common.Comments.ICommentPane"),new W.a(()=>Q.App.za.jb.Zc.xd),y.AFrameworkApplication.va,new W.a(()=>Tf.a.instance),qd.FocusManager.instance(),
R.a.instance,this.W.resolve("WordEditor.Comments.CommentMarginEntryPointActor"))).as("WordEditor.Comments.CommentsActionManager").ha();this.W.resolve("WordEditor.Comments.CommentInitActor");la.contentNavigationApiEnabled&&(this.W.ia("WordEditor.Comments.CommentContentProvider",()=>new kh(this.W.resolve("WordEditor.Comments.ICommentModelBootLoader"),this.W.resolve("WordEditor.Comments.CommentsSettings"))).ha(),this.W.ia("WordEditor.Comments.CommentContentActor",()=>new kf(this.W.resolve("WordEditor.ReviewSuggestionContent.IReviewSuggestionContentManager"),
this.W.resolve("WordEditor.Comments.IEditorCommentModel"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.IEditorCommentManager"),this.W.resolve("WordEditor.Comments.CommentsState"))).ha(),this.W.resolve("WordEditor.Comments.CommentContentProvider"),this.W.resolve("WordEditor.Comments.CommentContentActor"));const ec=la.ar,xc=this.W.resolve("WordEditor.Comments.EditorCommentManager");this.W.resolve("WordEditor.Comments.CommentsActionManager");xc&&ec&&
(this.W.resolve("WordEditor.Comments.CommentsState").Leb=Ml.Y5h(),la.SDb||this.W.resolve("WordEditor.Comments.WordCommentEventsActor").s$("OnCommentInit"));Kc.a.P6m();la.zac&&Q.App.za.jb.mXh();me.a.instance&&(la.SDb||Yj.a.get_instance().pk(4,()=>{this.Jmn(ec)},11).continueWith(()=>{this.GAm()}),this._initialized=!0);this.VUn(this.W.Ta("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}GAm(){this.W.resolve("WordEditor.Comments.WordCommentEventsActor").s$("OnCommentInit")}Jmn(la){la||
this.vmm()}vmm(){const la=Ml.Y5h();la&&(a.ULS.sendTraceTag(35149084,327,50,"Comment deep linking starts after boot: {0}",(new Date).getTime()-y.AFrameworkApplication.vX),this.W.resolve("WordEditor.Comments.WordCommentEventsActor").s$("OnCommentInit",Object.assign(new Ue.a,{tHa:()=>{me.a.instance.Mda.isVisible||y.AFrameworkApplication.va.processAction(Xe.a.LV,2);this.W.resolve("WordEditor.Comments.ICommentSelectionActor").xij(la,Object.assign(new af.a,{Bgg:!0}))}})),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger").Tv(Xe.a.s9e))}VUn(la,
cb,vb){la&&la.execute(ec=>{ec.D5(new kc.a(cb,vb))})}dispose(){this._initialized&&(me.a.instance&&me.a.instance.dispose(),this._initialized=!1)}static Y5h(){return y.AFrameworkApplication.K.kb("BootActivityNavigationId")}}Object(e.a)(Ml,"PackageManager",null,[1,2]);const Ok=la=>{const cb=M.a.instance.Ta("Box4.IPackageBootPerfLogger"),vb=window.performance.now();cb.execute(ec=>{ec.Fx(tl.a.comments,"CPMain",vb,!0)});z.a.instance.Gc(new Ml,0,la)};var sc=c(1988);class jp{isComment(la){return Cf.a.isComment(la)}tZd(la){return Cf.a.tZd(la)}SDf(la){return Cf.a.SDf(la)}dWf(la,
cb){Cf.a.dWf(la,cb)}hWf(la,cb){Cf.a.hWf(la,cb)}Abf(la){return Cf.a.Abf(la)}Q5a(la){return Zl.a.instance.Q5a(la)}deleteComment(la,cb){Cf.a.deleteComment(la,cb)}OKd(la,cb){Cf.a.OKd(la,cb)}epb(la){Cf.a.epb(la)}vca(la,cb,vb){return Cf.a.vca(la,cb,vb)}Ewa(la,cb,vb){return Cf.a.Ewa(la,cb,vb)}W$b(la,cb){return Cf.a.W$b(la,cb)}WPc(la,cb,vb,ec=null){return Cf.a.WPc(la,cb,vb,ec)}p2b(la,cb,vb,ec){Cf.a.p2b(la,cb,vb,ec)}ABd(la,cb,vb,ec){return Cf.a.ABd(la,cb,vb,ec)}get aJb(){return Cf.a.aJb}set aJb(la){Cf.a.aJb=
la}NMb(la,cb){Cf.a.NMb(la,cb)}E6c(la){Cf.a.E6c(la)}Q7f(la){Cf.a.Q7f(la)}yTd(la,cb){return Cf.a.yTd(la,cb)}eWf(la,cb){Cf.a.eWf(la,cb)}gWf(la,cb){Cf.a.gWf(la,cb)}Y6d(la,cb,vb,ec,xc,ad){Cf.a.Y6d(la,cb,vb,ec,xc,ad)}Fif(la,cb){Cf.a.Fif(la,cb)}z4c(la,cb,vb,ec){return Cf.a.z4c(la,cb,vb,ec)}E4c(la,cb,vb,ec){return Cf.a.E4c(la,cb,vb,ec)}}Object(e.a)(jp,"CommentEditorProxy",null,[370]);class Lp{constructor(){this.W=null}get TRb(){return null!=this.OHg?this.OHg:this.OHg=(()=>this.W.Ta("WordEditor.ITableEditor"))()}get r6a(){return null!=
this.pFg?this.pFg:this.pFg=(()=>this.W.resolve("Box4.IPackageBootPerfLogger"))()}C_(la){this.r6a.C_(tl.a.comments,la,!0)}get name(){return"WordEditor.CommentsInteractive"}wc(la){this.W=la;this.C_("CIPConfigStart");la.ia("WordEditor.CommentsInteractive.CommentEditorProxy",()=>new jp).as("WordEditor.CommentsInteractive.ICommentEditor").ha();this.C_("CIPConfigEnd")}init(){this.C_("CIPInitStart");this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{this.wn();this.C_("CIPInitEnd")})}wn(){this.tvm()}dispose(){}tvm(){qe.a.FTa(Cf.a.hWf);
sc.a.s0e(Cf.a.eWf);sc.a.mCd(Cf.a.gWf);sc.a.Oxk(Cf.a.Gmn);this.TRb.execute(cb=>{cb.t0e(Cf.a.NMb)});const la=Q.App.si.Il;la.Ue(39).Eo(Cf.a.dWf);sc.a.Vwk(Cf.a.Lln);sc.a.Mwk(Cf.a.Ukn);ke.a.isEnabled&&la.Ue(12).Vw(Cf.a.XQj)}}Object(e.a)(Lp,"PackageManager",null,[1,2]);const jk=la=>{const cb=M.a.instance.Ta("Box4.IPackageBootPerfLogger"),vb=window.performance.now();cb.execute(ec=>{ec.Fx(tl.a.comments,"CIPMain",vb,!0)});z.a.instance.Gc(new Lp,0,la)};var Zo=c(2109),Pk=c(177),so=c(1695);class Nd{constructor(la,
cb,vb,ec,xc,ad,Zd){this.CNa=la;this.tba=cb;this.M7=vb;this.Yc=ec;this.M4j=xc;this.RLe=ad;this.Wwb=Zd;so.a.Nxk((pe,Td)=>{this.Kvk(Td.graphNode,Td.F1k)});so.a.tyk((pe,Td)=>{this.u8k(Td.graphNode,Td.z_k)})}xSd(){var la=this.M4j();const cb=this.Yc.Ek();cb.set(la);if(this.tba.OQo(cb))return cb;cb.set(la);Pk.PageNavigator.instance.IP(cb);la=this.M7.sfl(cb.currentNode);cb.Aj(la);return cb}PUd(la){const cb=this.xSd();let vb=null;this.tba.APd(cb,ec=>{this.M7.Tii(ec)===la&&(vb=ec);return!vb});return vb}Pii(la){const cb=
this.xSd();let vb=null;this.tba.APd(cb,ec=>{this.M7.aac(ec)===la&&(vb=ec);return!vb});return vb}dLi(la,cb,vb){a.ULS.sendTraceTag(594928199,3003,50,"History Record Generated. [RecordType: {0}], [TaskID: {1}], [TaskCompletion: {2}]",la,cb,vb)}Uii(){const la=this.xSd(),cb=[];this.tba.APd(la,vb=>{cb.push(this.M7.Tii(vb));return!0});return cb}Kgb(la,cb){if(!cb.length)return this.Wwb&&a.ULS.sendTraceTag(42812043,3003,10,"A task must always have at least one history record."),null;const vb=this.xSd(),ec=
em.a.create().toString(),xc=new Ni.a;for(let ad of cb)xc.add(ad),this.dLi(ad.type,ec,ad.completion);cb=this.CNa.ycg(xc);this.M7.Kgb(vb.currentNode,ec,la,cb);this.RLe();return ec}ff(la){(la=this.PUd(la))?(this.M7.ff(la),this.RLe()):this.Wwb&&a.ULS.sendTraceTag(51656714,3003,10,"DeleteTask : Unable to find task with given ID")}aac(la){la=this.PUd(la);return la?this.M7.aac(la):(this.Wwb&&a.ULS.sendTraceTag(42812044,3003,10,"GetTaskCommentAnchorId : Unable to find task with given ID"),null)}Qii(la){return this.M7.aac(la)}Sii(la){la=
this.PUd(la);if(!la)return this.Wwb&&a.ULS.sendTraceTag(42812045,3003,10,"GetTaskHistory : Unable to find task with given ID"),null;la=this.M7.Cuf(la);return this.CNa.Q6b(la).toArray()}kEk(la,cb){if(!cb.length)return this.Wwb&&a.ULS.sendTraceTag(594928198,3003,10,"AppendTaskHistory : New records do not exist"),!1;const vb=this.PUd(la);if(!vb)return this.Wwb&&a.ULS.sendTraceTag(42812046,3003,10,"AppendTaskHistory : Unable to find task with given ID"),!1;const ec=this.M7.Cuf(vb),xc=this.CNa.Q6b(ec);
for(let ad of cb)xc.add(ad),this.dLi(ad.type,la,ad.completion);la=this.CNa.ycg(xc);la!==ec&&(this.M7.Ono(vb,la),this.RLe());return!0}Kvk(la,cb){if(cb=this.Pii(cb)){const vb=this.Yc.Ek();vb.set(la);this.M7.Wb(cb.clone(),this.M7.Lxl(cb,vb))}}z8i(la,cb,vb){if(cb.nb(la))return cb.J(la);const ec=em.a.create().toString();cb.add(la,ec);vb&&this.Wwb&&a.ULS.sendTraceTag(593281437,3003,10,"RecordIdFromMapOrGenerateNewIdAndAddToMap : Unexpectedly creating new id.");return ec}u8k(la,cb){const vb=new pf.a;var ec=
this.Yc.Ek();ec.set(la);ec.Ub(38)&&this.tba.APd(ec,xc=>{const ad=this.M7.aac(xc);void 0!==ad&&null!==ad&&vb.add(ad,xc);return!0});for(let xc of cb)if(la=null,({value:la}=vb.Fc(xc.key,la)).returnValue)if(xc.value===xc.key)la=this.Pii(xc.key),this.M7.Boo(la,parseInt(xc.key));else{la=this.M7.Cuf(la);if(!la||""===la){a.ULS.sendTraceTag(595347466,3003,10,"CopyTaskNodesFromParentNode : History Records not found on taskNode on clipboard");break}la=this.CNa.Q6b(la);ec=new Xa.a;for(let ad=0;ad<la.length;ad++){if(la.J(ad).commentId){const Zd=
Number.parseInvariant(la.J(ad).commentId);cb.nb(Zd)?la.J(ad).commentId=cb.J(Zd).toString():la.J(ad).commentId=null}la.J(ad).recordId=this.z8i(la.J(ad).recordId,ec,!1);-1===la.J(ad).type&&(la.J(ad).undoId=this.z8i(la.J(ad).undoId,ec,!0))}this.Kgb(xc.value,la.toArray())}}static Xr(){return new Nd(M.a.instance.resolve("WordEditor.Tasks.ITaskHistorySerialization"),M.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),M.a.instance.resolve("WordEditor.Tasks.ITaskEditor"),new ki.a,()=>Q.App.za.jb.Zc,()=>
{M.a.instance.Ta("Common.Interface.IEditNotificationManager").execute(la=>{la.editHappened()})},!0)}}Object(e.a)(Nd,"TaskActor",null,[443]);var Qk=c(1137);class No{create(){return new Qk.a}}Object(e.a)(No,"TaskContentNodeFactory",null,[404]);var fm=c(1081);class kp{create(){return new fm.a}}Object(e.a)(kp,"TaskNodeFactory",null,[404]);class yc{constructor(la,cb,vb,ec,xc,ad){this.tba=la;this.Lc=cb;this.Yc=vb;this.Zlk=ec;this.cmk=xc;this.SUb=ad}Rdl(la,cb,vb){const ec=this.cmk.create(1074135162);ec.setValue(sa.a.taskId,
la);ec.setValue(sa.a.XRb,cb);ec.setValue(sa.a.$za,vb);return ec}cac(la){const cb=this.Lc.Pc(4);cb.Db(la);this.SUb();return cb}Tii(la){return this.tba.eKb(la)?la.getValue(sa.a.taskId):(a.ULS.sendTraceTag(42812047,3003,10,"Unexpected node type"),null)}aac(la){return this.tba.eKb(la)?la.hasProperty(sa.a.XRb)?la.getValue(sa.a.XRb):null:(a.ULS.sendTraceTag(42812048,3003,10,"Unexpected node type"),null)}Cuf(la){return this.tba.eKb(la)?la.getValue(sa.a.$za):(a.ULS.sendTraceTag(42812049,3003,10,"Unexpected node type"),
null)}sfl(la){if(7!==la.type)return a.ULS.sendTraceTag(42812050,3003,10,"Unexpected node type"),null;const cb=this.cac(la);try{const vb=this.Zlk.create(1074135161),ec=this.Yc.Ek();ec.set(la);ec.O3(vb,38,yc.mIo);return vb}finally{cb&&cb.dispose()}}Kgb(la,cb,vb,ec){if(!this.tba.AIf(la))return a.ULS.sendTraceTag(42812051,3003,10,"Unexpected node type"),null;const xc=this.cac(la);try{const ad=this.Rdl(cb,vb,ec),Zd=this.Yc.Ek();Zd.set(la);Zd.O3(ad,1,new ua.a(em.a.Gva(vb.toString()),1));return ad}finally{xc&&
xc.dispose()}}ff(la){if(this.tba.eKb(la))if(la.anchor&&la.anchor.Vp){var cb=la.anchor.Vp.us.node;if(this.tba.AIf(cb)){var vb=this.cac(cb);try{const ec=this.Yc.Ek();ec.set(cb);ec.Aj(la.anchor.node);ec.zg()}finally{vb&&vb.dispose()}}else a.ULS.sendTraceTag(51656717,3003,10,"Task node unexpectedly parented to non-content node")}else a.ULS.sendTraceTag(51656716,3003,10,"Cannot delete an unlinked node");else a.ULS.sendTraceTag(51656715,3003,10,"Unexpected node type")}Ono(la,cb){if(this.tba.eKb(la)){var vb=
this.cac(la);try{la.setValue(sa.a.$za,cb)}finally{vb&&vb.dispose()}}else a.ULS.sendTraceTag(42812052,3003,10,"Unexpected node type")}Boo(la,cb){if(this.tba.eKb(la)){var vb=this.cac(la);try{const ec=la.hasProperty(sa.a.XRb)?la.getValue(sa.a.XRb):null;void 0===ec||null===ec||ec===cb?la.Hg(sa.a.XRb,cb):a.ULS.sendTraceTag(595347464,3003,10,"TaskAnchorId is changed.")}finally{vb&&vb.dispose()}}else a.ULS.sendTraceTag(595347465,3003,10,"Unexpected node type")}Lxl(la,cb){if(!cb.Jt(38)){const vb=this.Yc.Ek();
vb.set(la);vb.zb(71);vb.jd(71);la=kb.b(vb.currentNode,la.Yi().Mc,!0);cb.Bf(la,38)}return cb.Ub(38)}Wb(la,cb){if(this.tba.AIf(cb)){var vb=this.cac(cb);try{const ec=this.Yc.Ek();ec.set(cb);ec.Bf(la,1)}finally{vb&&vb.dispose()}}else a.ULS.sendTraceTag(595347463,3003,10,"Unexpected node type")}static Xr(){return new yc(M.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),new sh.a,new ki.a,new No,new kp,()=>{Jh.App.nn.jb.Zc.sF.g8(10)})}}yc.mIo=new ua.a(em.a.If("50f73b87-1d48-4f4a-94a3-4c20e2cf6387"),
1);Object(e.a)(yc,"TaskEditor",null,[371]);class td{constructor(la,cb){this.Cx=la;this.Rxb=cb}eKb(la){return!!la&&72===la.type}gWm(la){return!!la&&71===la.Xe}AIf(la){return!!la&&71===la.type}OQo(la){la.set(this.Cx.value);this.Rxb.IP(la);return!!la.Ub(38)}APd(la,cb){if(la&&cb)if(this.gWm(la))for(var vb=!0,ec=la.Ub(1);vb&&ec;)this.eKb(ec)||a.ULS.sendTraceTag(42812055,3003,10,"Unexpected node type {0}",ec.type),vb=cb(ec),ec=la.Mf(1);else a.ULS.sendTraceTag(42812054,3003,10,"Unexpected iterator type {0}",
la.Xe);else a.ULS.sendTraceTag(42812053,3003,10,"ForEachTaskInTaskContent : Invalid Input")}static Xr(){return new td(new W.a(()=>Q.App.za.jb.Zc),Pk.PageNavigator.instance)}}Object(e.a)(td,"TaskNavigator",null,[369]);class kk{constructor(){this.W=null}get name(){return"WordEditor.Tasks"}init(){this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{this.wn()})}dispose(){}wc(la){this.W=la;la.ia("WordEditor.Tasks.JsonTaskHistorySerialization",()=>new Zo.a).as("WordEditor.Tasks.ITaskHistorySerialization").ha();
la.ia("WordEditor.Tasks.TaskNavigator",()=>td.Xr()).as("WordEditor.Tasks.ITaskNavigator").ha();la.ia("WordEditor.Tasks.TaskEditor",()=>yc.Xr()).as("WordEditor.Tasks.ITaskEditor").ha();la.ia("WordEditor.Tasks.TaskActor",()=>Nd.Xr()).as("WordEditor.Tasks.ITaskActor").ha()}wn(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(114)}}Object(e.a)(kk,"TasksPackage",null,[1,2]);var jo=c(79),cq=c(1692),vl=c(402),Sm=c(94);class $o{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=
this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}Object(e.a)($o,"TaskPaneGroupAppProps",null,[]);var to=c(186);class yl{static $2k(la,cb){qd.FocusManager.lK()&&(lj.a.instance.cDa(la,cb,!1),to.a.instance.cDa(la,cb,!1),y.AFrameworkApplication.ua.wx.JT(la))}}Object(e.a)(yl,"ReactTaskPaneManagerUtils",null,[]);var Tm=c(143),Wn=c(336);class ij{constructor(){this.type=null}}Object(e.a)(ij,
"SampleTaskPaneProps",null,[]);var Dh=c(1693);class yn{constructor(){this.entry=null;this.show=!1}}Object(e.a)(yn,"AnimationBatchEntry",null,[]);var pj=c(296),qg=c(1153),fl=c(128);class gm{constructor(){this.vah=[];this.wah=[];this.Gma={};this.SKa=this.RKa=null;this.Oyd=!1;this.f_=null;this.Vvd=this.Qqd=0;this.Wqc=[];this.fHe=!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Kb.Dlb;this.Pw=!1}initialize(){this.Oyd=!1;(this.Pw=!!y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Kb.tL)&&
this.mcf()}ocf(la,cb,vb,ec){cb=this.RUd(cb);a.ULS.sendTraceTag(4290588,320,50,"Create new task pane.");this.mcf();const xc=document.createElement("div");xc.id=cb;xc.className=gm.$3o;xc.style.width="0";this.fHe||(this.Esk(vb,cb,xc),this.Gma[cb]=la.ocf(cb,vb,ec,xc));return xc}mcf(){this.Oyd||this.Bqo()}Esk(la,cb,vb){let ec=null,xc=null;0===la?(ec=this.RKa,xc=this.vah):1===la&&(ec=this.SKa,xc=this.wah);if(ec){la=!1;for(let ad=0;ad<xc.length;ad++)if(!la)xc[ad]===cb&&(la=!0);else if(xc[ad]in this.Gma){this.cFm(ec,
vb,this.Gma[xc[ad]]);return}ec.appendChild(vb)}}cFm(la,cb,vb){la.insertBefore(cb,vb.element)}xql(la){la=this.RUd(la);if(la in this.Gma){const cb=this.Gma[la];cb.element.parentNode.removeChild(cb.element);delete this.Gma[la]}}otj(la){la=this.RUd(la);la in this.Gma&&(la=this.Gma[la])&&!la.isVisible&&(this.wsj(la,!0),this.csh(la.position,!0,this.TAh(la,!0)),1===la.position&&1<G.a.count(this.Gma)&&this.C8m())}Num(la){la=this.RUd(la);la in this.Gma&&(la=this.Gma[la])&&la.isVisible&&(this.wsj(la,!1),this.csh(la.position,
!1,this.TAh(la,!1)))}e6b(la){if(this.f_)return this.f_;const cb=document.createElement("div");document.body.appendChild(cb);cb&&(this.f_=new cq.a(cb,la));return this.f_}wsj(la,cb){la.element&&(la.isVisible=cb,this.Wqc.push(Object.assign(new yn,{entry:la,show:cb})));0===la.position?this.Qqd+=cb?1:-1:this.Vvd+=cb?1:-1;1===this.Wqc.length&&window.setTimeout(Object(zd.a)(this,this.cDo,"startPaneAnimation"),0);this.Pw&&la.element&&la.element.parentNode&&(0===la.position&&!this.Qqd||1===la.position&&!this.Vvd?
(la.element.parentNode.style.minHeight="0px",la.element.parentNode.style.height="0px",la.element.parentNode.style.overflow="hidden"):(la.element.parentNode.style.minHeight="",la.element.parentNode.style.height="",la.element.parentNode.style.overflow=""))}cDo(){this.$Wi();var la=Vb.where(Vb.asEnumerable(this.Wqc),xc=>0===xc.entry.position),cb=Vb.where(la,xc=>!xc.show);if(Vb.any(cb)&&Vb.Ct(cb)!==Vb.Ct(la)){for(var vb of cb)vb.entry.element.style.width="0";la=Vb.where(la,xc=>xc.show)}cb=Vb.where(Vb.asEnumerable(this.Wqc),
xc=>1===xc.entry.position);vb=Vb.where(cb,xc=>!xc.show);if(Vb.any(vb)&&Vb.Ct(vb)!==Vb.Ct(cb)){for(var ec of vb)ec.entry.element.style.width="0";cb=Vb.where(cb,xc=>xc.show)}for(let xc of Vb.concat(la,cb))la=xc.entry,fl.WacAirSpace.zV(la.element,pj.a.phg),ec=new qg.a(la.element),xc.show?ec.G1e(0,la.width):ec.G1e(la.width,0),fl.WacAirSpace.animate(ec,null,null);this.Wqc.length=0}$Wi(){}TAh(la,cb){let vb=la.width;la=0===la.position?this.Qqd:this.Vvd;if(cb&&1===la||!cb&&!la)vb+=1;return vb}Bqo(){this.Oyd||
(this.RKa||(this.RKa=document.createElement("div"),this.RKa.id=gm.Y3o,this.RKa.className=gm.BKj,Sys.UI.DomElement.addCssClass(this.RKa,"alignLeft"),y.AFrameworkApplication.ua&&y.AFrameworkApplication.ua.Kb.C9&&Sys.UI.DomElement.addCssClass(this.RKa,"FlexBoxLayout"),this.fHe&&Sys.UI.DomElement.addCssClass(this.RKa,gm.yKj),this.dqh(0,this.RKa)),this.SKa||(this.SKa=document.createElement("div"),this.SKa.id=gm.Z3o,this.SKa.className=gm.BKj,Sys.UI.DomElement.addCssClass(this.SKa,"alignRight"),y.AFrameworkApplication.ua&&
y.AFrameworkApplication.ua.Kb.C9&&Sys.UI.DomElement.addCssClass(this.SKa,"FlexBoxLayout"),this.fHe&&Sys.UI.DomElement.addCssClass(this.SKa,gm.yKj),this.dqh(1,this.SKa)),this.eZi(this.RKa,this.SKa),this.Oyd=!0)}eZi(){}gDa(la,cb){Array.add(1===la?this.wah:this.vah,cb)}RUd(la){return la+"-Entry"}C8m(){let la=0;for(const cb of G.a.gP(this.Gma)){const vb=Object(Qb.a)(943,this.Gma[cb]);vb&&vb.isVisible&&1===vb.position&&la++}2===la?a.ULS.sendTraceTag(595179606,320,50,"2 simultaneous panes open"):2<la&&
a.ULS.sendTraceTag(595179605,320,50,la+" simultaneous panes open")}}gm.Y3o="WACTaskPaneContainerLeft";gm.Z3o="WACTaskPaneContainerRight";gm.BKj="WACTaskPaneContainer";gm.$3o="WACTaskPaneEntry";gm.yKj="WACReactTaskPaneContainer";Object(e.a)(gm,"BaseTaskPaneManager",null,[944]);var nf=c(492),ll=c(294);class qf extends gm{constructor(la,cb){super();this.Nzc=this.Mzc=this.ZXe=this.YXe=0;this.H2h=()=>{Yc.InteractiveViewManager.instance.forEach(vb=>{vb.EPd()})};this.ga=la;this.h0g=cb}dqh(la,cb){const vb=
Q.App.za.tE;vb.parentNode&&(la?1===la&&(this.Pw?((la=Object(ll.a)("FarPane"))&&la.appendChild(cb),cb.classList.add("regionComposer"),Q.App.za.aJ.registerBoundingWindowRectsChanged("farPane",(ec,xc)=>{"DP"===xc||3===xc?cb.classList.add("DL"):cb.classList.remove("DL")})):vb.parentNode.insertBefore(cb,vb.nextSibling)):this.Pw?((la=Object(ll.a)("NearPane"))&&la.appendChild(cb),cb.classList.add("regionComposer")):vb.parentNode.insertBefore(cb,vb))}csh(la,cb,vb){this.Pw||(cb=cb?vb:-vb,la?this.Nzc+=cb:this.Mzc+=
cb)}$Wi(){if(!this.Pw){var la=Q.App.za.tE;fl.WacAirSpace.zV(la,pj.a.phg);if(this.YXe!==this.Mzc){const cb=new nf.a(la);cb.FCk(this.YXe,this.Mzc,this.h0g);fl.WacAirSpace.animate(cb,null,this.H2h);this.YXe=this.Mzc}this.ZXe!==this.Nzc&&(la=new nf.a(la),la.GCk(this.ZXe,this.Nzc,this.h0g),fl.WacAirSpace.animate(la,null,this.H2h),this.ZXe=this.Nzc)}}}Object(e.a)(qf,"TaskPaneManager",gm,[]);var Ug=c(251);class On extends qf{get fyi(){null==this.kse&&(this.kse=y.AFrameworkApplication.K?y.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ExternalContentFloatiePositionIsEnabled",
!1):!1);return this.kse}constructor(la,cb){super(la,cb);this.WW=md.KeyInputManager.ic(jo.a.Iw,0);this.XW=md.KeyInputManager.ic(jo.a.Iw,4);this.MQe=this.yzc=null;this.s5g="AccCheckerTaskPane";this.sa=new ha.a;this.isPaneOpen=!1;this.kse=this.bBe=null;this.gDa(0,"SampleTaskPane");this.gDa(0,Ug.a.iib);this.gDa(1,Ug.a.$Hk);this.gDa(1,"CustomTaskPane");this.gDa(1,Ug.a.JCf);this.gDa(1,ed.AFrame.Ur);this.gDa(1,ed.AFrame.Tnh);this.gDa(1,ed.AFrame.Onh);this.gDa(1,Ug.a.KPd);this.gDa(1,Ug.a.LLc);this.gDa(1,
Ug.a.CNc);this.n9j=(this.RLg=!!y.AFrameworkApplication.ua&&!!y.AFrameworkApplication.ua.Kb)&&y.AFrameworkApplication.ua.Kb.tHf;this.t8j=Jh.App.qec;this.z8j=this.RLg&&y.AFrameworkApplication.ua.Kb.VXc;this.initialize();la.fb(rf.a.Ihg,rl.a.application,On.Ihg,96)}get Cee(){if(!Q.App.za||!Q.App.za.tE)return null;this.MQe||(this.MQe=new cq.a(Q.App.za.tE,qd.FocusManager.instance()));return this.MQe}Tb(){}eZi(la,cb){const vb=vl.a.instance,ec=qd.FocusManager.instance(),xc=Sm.EventHandlerManager.instance,
ad=this;bk.UISurfaces.Nu().then(Zd=>{ad.yzc=ad.e6b(ec);let pe;Zd.renderTaskPaneGroups(la,cb,(pe=new $o,pe.middleContainer=Q.App.za.tE,pe.onTabStripFocus=()=>{ec.kD(Ug.a.Umc)},pe.onOpen=(Td,Ie)=>{ad.uHf(Td)&&yl.$2k(Td,Ie);xc.OZe(Ie,"focus",ad.Pgi(Td,ec),!0);var We=ad.Ozi(Td),Vf=Zd.selectors.getTabbedTaskPaneCount(We?1:2);We=We?Ug.a.jle:Ug.a.Umc;1===Vf&&(vb.V7(We),this.isPaneOpen=!0,this.W6i({isPaneOpen:this.isPaneOpen,ZRb:Ie}));Ie=ad.Vqf(Td);if(Vf=ec.fe(Ie))Vf.HJc=We,ad.cvo(Td)&&(Vf.nr(ad.WW),Vf.nr(ad.XW)),
vb.yyi(Ie)&&vb.fx(Ie);this.fyi&&this.ONd&&this.ONd.dismissFloatie(!0)},pe.onClose=(Td,Ie)=>{ad.uHf(Td);const We=ad.Ozi(Td),Vf=We?Ug.a.jle:Ug.a.Umc;Zd.selectors.getTabbedTaskPaneCount(We?1:2)||(vb.fx(Vf),this.isPaneOpen=!1,this.W6i({isPaneOpen:this.isPaneOpen,ZRb:Ie}));xc.T7f(Ie,"focus",ad.Pgi(Td,ec),!0);this.fyi&&this.ONd&&this.ONd.dismissFloatie(!0)},pe.setFocusCallback=(Td,Ie)=>{ad.uHf(Td)&&Ie&&(Td=ec.fe(ad.Vqf(Td)),Td.mZk(),Td.pga(Ie))},pe.onOverflowMenuOpen=()=>{if(ad.yzc)ad.yzc.onMenuOpen()},
pe.onOverflowMenuClose=()=>{if(ad.yzc)ad.yzc.onMenuClose()},pe.onShow=(Td,Ie)=>{2===Ie&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{ec.mg(Td)},0)})},pe.onHide=(Td,Ie,We)=>{We&&1!==Ie&&ec.mg(ec.gU)},pe.onResizeStart=()=>{if(Q.App.za&&(Q.App.za.tE.className=Fj.AppFrame.Krg,ad.Cee))ad.Cee.onMenuOpen()},pe.onResizeEnd=()=>{if(Q.App.za&&(Tm.a.dCi()||(Q.App.za.tE.className+=" "+Q.App.za.iCh),ad.Cee))ad.Cee.onMenuClose()},pe));this.hka(Ug.a.Umc,ec,cb,ad);this.hka(Ug.a.jle,ec,la,ad);return null})}hka(la,
cb,vb,ec){const xc=cb.fe(la);xc.parent=ed.AFrame.Ap;xc.eI=!0;lj.a.instance.cDa(la,vb,!1);to.a.instance.cDa(la,vb,!1);la=new Wn.DOMFocusListing(()=>vb);la.Rm(3);la.Rm(2);la.Rm(4);la.Rm(1);cb.ina(()=>vb,xc,la).BP=!0;xc.nr(ec.WW);xc.nr(ec.XW)}Vqf(la){return la===this.s5g?Ug.a.Zmh:la}Pgi(la,cb){return()=>{cb.kD(this.Vqf(la))}}cvo(la){return la===this.s5g?!1:!0}PMm(la){return la===Ug.a.iib}uHf(la){return this.PMm(la)||la===Ug.a.Zmh||0<=la.indexOf("AppForOfficePanel")||la===Ug.a.KPd||la===Ug.a.JCf&&this.n9j||
la===Ug.a.LLc&&this.t8j||la===Ug.a.CNc&&this.z8j||la===Dh.a.oFb?!0:!1}Ozi(la){return la===Ug.a.iib||"SampleTaskPane"===la}static vhm(){return new On(y.AFrameworkApplication.va,y.AFrameworkApplication.isRtl)}static Ihg(la,cb,vb,ec,xc){if(1===vb)return 32;bk.UISurfaces.Nu().then(ad=>{ad.showTaskPane(xc,Object.assign(new Gh.a,{title:"Sample Task Pane",width:320,location:2,contentProps:Object.assign(new ij,{type:"SampleTaskPaneProps"})}));return null});return 32}C_a(la){this.sa.addHandler("onPaneToggle",
la)}Z6c(la){this.sa.removeHandler("onPaneToggle",la)}W6i(la){this.sa.raiseEvent("onPaneToggle",la)}get ONd(){this.bBe||(this.bBe=M.a.instance.Oa("WordEditor.Actors.ExternalContentFloatieEventManager"));return this.bBe}}Object(e.a)(On,"TaskPaneManager",qf,[366]);class dn{constructor(){this.zT=null}get name(){return"WordEditor.TaskPaneManager"}wc(){}init(){this.zT=On.vhm();this.zT.Tb();Q.App.za.K8a=this.zT}dispose(){}}Object(e.a)(dn,"PackageManager",null,[1,2]);c.d(I,"a",function(){return l})},1988:function(D,
I,c){D=c(0);var l=c(173),e=c(736),a=c(357),k=c(22),x=c(2),y=c(81),m=c(42),t=c(41),z=c(6),v=c(16),H=c(7),F=c(75),G=c(443),M=c(88),K=c(471),L=c(5),R=c(599),S=c(199),N=c(223),O=c(18),W=c(1118),V=c(36),Q=c(84),Y=c(40),ba=c(782),Z=c(27),ea=c(77),ha=c(21),ka=c(53);class ua{constructor(Wa,yb,Yb,qc){this.$Kd=this.YKd=null;this.Bad=Wa;this.rle=yb;this.Fuj=Yb;this.Guj=qc}}Object(D.a)(ua,"TableSimplificationInformation",null,[]);var sa=c(78),Da=c(26),Pa=c(447),Ra=c(260),Ga=c(934),ta=c(1623),va=c(283),ia=c(3),
qa=c(10),pa=c(141),Fa=c(17),za=c(261),Oa=c(32),xa=c(256),fa=c(8),Ka=c(639),lb=c(571),Xa=c(343);class kb extends Sys.EventArgs{constructor(Wa){super();this.Ro=Wa}}Object(D.a)(kb,"AfterTrimCompleteOnCopyArgs",Sys.EventArgs,[]);var Bb=c(1798);class Ja extends Bb.a{constructor(Wa,yb,Yb,qc){super(Wa,yb,{});this.jUa=[];for(Wa=0;Wa<Yb.length;Wa++)this.jUa.push(...Yb.J(Wa).toArray());this.$Da=0;this.Iy=qc;this.Ro={}}}Object(D.a)(Ja,"BasicInternalCopyArguments",Bb.a,[]);class Ma extends Sys.EventArgs{constructor(Wa,
yb){super();this.Ro=yb;this.jUa=[];for(yb=0;yb<Wa.length;yb++)this.jUa.push(...Wa.J(yb).toArray())}}Object(D.a)(Ma,"BeforeCopyArguments",Sys.EventArgs,[]);class fb extends Sys.EventArgs{constructor(Wa){super();this.Ro=Wa}}Object(D.a)(fb,"BeforePasteArguments",Sys.EventArgs,[]);class hc extends Sys.EventArgs{constructor(Wa,yb,Yb,qc){super();this.paragraph=Wa;this.cpBegin=yb;this.cpEnd=Yb;this.Ro=qc}}Object(D.a)(hc,"BeforeTrimOnCopyArguments",Sys.EventArgs,[]);var cc=c(1840),mb=c(1841);class Hb{constructor(Wa,
yb,Yb,qc,Hc,$b,Ub,mc,ic){this.anc=Wa;this.source=yb;this.target=Yb;this.UZf=qc;this.rowIndex=Hc;this.Fo=$b;this.n0a=Ub;this.p1i=mc;this.ke=ic}}Object(D.a)(Hb,"CoreInternalTablePasteArguments",null,[]);class Ua extends Sys.EventArgs{constructor(Wa,yb,Yb,qc,Hc){super();this.operation=Wa;this.g_i=yb;this.original=Yb;this.clone=qc;this.Ro=Hc}}Object(D.a)(Ua,"ParagraphCopyPasteArguments",Sys.EventArgs,[]);var Ya=c(90);c.d(I,"a",function(){return Fb});class Fb{constructor(Wa,yb,Yb,qc,Hc,$b,Ub,mc,ic,ab,
bb,Jb,Eb,hb,ob){this.fX=this.yt=null;this.KLe=!1;this.zBa=null;this.KYk=(Va,Qb)=>{l.a.mark(5566);Qb=Qb.target;if(Qb.Rd())return Qb.zg(),!0;Va.pi(this.KNc);return!0};this.KNc=(Va,Qb)=>{Qb=new cc.a(Qb,null);const Vb=new e.a(Va,this.iKc,Qb);Vb.Rl("ExecuteCoreCopyToInternalClipboard");this.vIn(Qb);Vb.run();Va.pi(this.BOo);return!0};this.iKc=(Va,Qb)=>{if(!Qb.source.Rd())return Qb.yi&&(Qb.yi.cGd=null),H.ULS.shipAssertTag(6305560,307,!1),this.rg.logKpiFailure({kpiName:Xa.a.CFd,errorName:"InternalCopyFailedSourceHasNoChildren"}),
!1;Va.pi(this.JKh);return!0};this.JKh=(Va,Qb)=>{const Vb=Qb.insertAfter,Sb=Qb.source,nb=Qb.target,ac=Sb.currentNode;var zc=this.GZi;if(!ac.yia)return Va.pi(this.hKc),!0;Qb.yi.RQb&&(Qb.RQb=!0);if(!this.pWk(Qb))return Qb.Kka.oGa.c++,Va.pi(this.hKc),!0;if(!Qb.RQb&&(ac.f8b()&&Qb.Kka.oGa.c++,ac.f8b()||zc&&!ac.zlb(this.uv)))return Va.pi(this.hKc),!0;if(!Qb.RQb&&zc&&!ac.Rz)return Sb.Iz()&&(Qb.Uoe=!0,Qb=new e.a(Va,this.iKc,new cc.a(Qb,Vb)),Qb.Rl("RecursiveCoreCopyToInternalClipboard"),Qb.run()),Va.pi(this.hKc),
!0;zc=nb.currentNode.Yi().xd;zc=R.b(ac,zc,!0);zc.$kb=!0;this.$ra.ade(Qb.Kka.xHb,zc);nb.ZH(zc,Vb,18===Sb.parentNode.type?1:Sb.role);nb.Aj(zc);Qb.insertAfter=zc;fa.ParagraphReader.Xb(zc)&&(this.IIn(Va,this.iKc,ac,zc,Qb),this.HIn(Va,ac,zc));this.aYh(ac,zc);Sb.Iz()&&(H.ULS.shipAssertTag(6305562,307,!Qb.Uoe),Qb=new e.a(Va,this.iKc,new cc.a(Qb,null)),Qb.Rl("RecursiveCoreCopyToInternalClipboard"),Qb.run());Va.pi((Ib,ya)=>this.w8k(Ib,ya));return!0};this.hKc=(Va,Qb)=>{Qb.Uoe&&(Qb.insertAfter=Qb.cGd,Qb.Uoe=
!1);if(!Qb.source.It()){Qb.yi&&(Qb.yi.cGd=Qb.insertAfter);const Vb=Qb.source;11!==Vb.Xe||Vb.n$b(-1)||this.lJn(Va,Vb.currentNode,Qb.target.currentNode,Qb);return!1}Va.pi(this.JKh);return!0};this.BOo=(Va,Qb)=>{if(Qb.$Da>=Qb.jUa.length)return Fb.sa.raiseEvent("AfterTrimCompleteOnCopy",new kb(Qb.Ro)),Va.pi(this.v8k),!0;Va=Qb.jUa[Qb.$Da];var Vb=Va.node,Sb=Va.cpBegin;let nb=Va.cpEnd;if(!Fa.SelectionEditor.nv(Va))if(!Qb.$Da&&Fa.SelectionEditor.Lk(Va))nb=Sb=fa.ParagraphReader.textLength(Vb);else if(fa.ParagraphReader.vm(Va))Sb=
0,nb=fa.ParagraphReader.textLength(Vb);else if(Fa.SelectionEditor.ada(Va)){H.ULS.shipAssertTag(6305568,307,!Qb.$Da);var ac=L.GraphIterator.eb(Vb);Sb=ac.zb(12);H.ULS.shipAssertTag(6305569,307,Sb);Vb=ac.origin;nb=Sb=fa.ParagraphReader.textLength(Vb)}else{if(Q.OutlineReader.f0d(Va))for(Va=S.a.gp(Va.node);Va.moveNext();)ac=Va.currentNode,fa.ParagraphReader.Xb(ac)&&Qb.jUa.push(Da.a.createTextRange(ac,0,fa.ParagraphReader.textLength(ac)));Qb.$Da++;return!0}ac=Qb.N_f[Vb.id.toString()];H.ULS.shipAssertTag(6305570,
307,!!ac);if(!ac)return H.ULS.sendTraceTag(21041548,307,15,"TrimNewTextParagraphCloneNull: {0}",{["ContextIndex"]:Qb.$Da,["SelectedContextsLength"]:Qb.jUa.length,["SelectedNodeType"]:Vb.type,["ContextId"]:Va.contextId}),Qb.$Da++,!0;Vb=sa.e(ac);let zc,Ib=!1;for(zc=Vb.length-1;0<=zc;zc--)if(!Vb[zc].CDa)if(4===Vb[zc].vh)Vb[zc].Lb.blob=null,Vb[zc].Lb.blob=new Pa.a(Vb[zc].Lb),Qb.Kka.oGa.e++;else{Vb[zc].Lb.blob=null;if(-1!==Vb[zc].qe){var ya=Vb[zc].Lb.formatting,ib=void 0,wb=void 0;ya&&-1===ya.qe?(wb=Vb[zc].qe+
1,ib=Vb[zc].i5-1,ya.qe=Vb[zc].qe):(ib=Vb[zc].i5,wb=Vb[zc].qe);for(ya=0;ya<ib;ya++)ac.ye.removeAt(wb,16);0<ib&&(Ib=!0)}ib="";va.f(Vb[zc])?(ib=" ",Qb.Kka.oGa.f++):va.g(Vb[zc])&&(wb=va.b(Vb[zc]))&&(ib=va.a(wb),Qb.Kka.oGa.g++);wb=Vb[zc].Lb.cp;wb>=Sb&&wb<nb&&(Fb.jg.Ge(Da.a.createTextRange(ac,wb,wb+1),ib,void 0,void 0,void 0,void 0,!0),nb=nb-1+ib.length,Qb.Kka.oGa.i++)}Ib&&ac.Wl();this.s0n(ac);Fb.sa.raiseEvent("BeforeTrimOnCopy",new hc(ac,Sb,nb,Qb.Ro));Vb=fa.ParagraphReader.textLength(ac);nb<Vb&&Fb.jg.Ge(Da.a.createTextRange(ac,
nb,Vb),"",void 0,void 0,void 0,void 0,!0);0<Sb&&Fb.jg.Ge(Da.a.createTextRange(ac,0,Sb),"",void 0,void 0,void 0,void 0,!0);this.Lnm(ac,Qb.Kka.oGa);fa.ParagraphReader.textLength(ac)||Qb.$Da!==Qb.jUa.length-1||!Fa.SelectionEditor.nv(Va)||ac.Ms||(Va=L.GraphIterator.eb(ac),Va.zb(25)&&(V.OutlineElementNavigator.Yd(Va),this.rh.r1a(Va),Qb.$Da&&(this.yt.lb.lwa=!0)));Qb.$Da!=Qb.jUa.length-1||this.lwa||ac.Cg(t.a.B5,t.a.Nda,t.a.Fqa,t.a.Nya,t.a.g$);this.$ra.f6c(Qb.Kka.n$d,Qb.Kka.oCb,Qb.Kka.tfb,ac);Qb.$Da++;return!0};
this.v8k=(Va,Qb)=>{this.xka.uTb(null);Qb.Iy.dispose();l.a.mark(5567);this.Shn();this.fX=Qb.Kka;this.tKi("Copy");this.zJm&&H.ULS.sendTraceTag(6305600,307,50,"Empty ClipboardRoot");return!1};this.WBn=(Va,Qb)=>{if(Qb.anc){if(Qb.anc.inProgress)return!0;Z.TableCellReader.isTableCell(Qb.source)||Qb.source.jd(16);if(this.tfn(Qb))return!1}else Oa.TableReader.isTable(Qb.target)||Qb.target.jd(14),Oa.TableReader.isTable(Qb.source)||Qb.source.jd(14),ha.moveToCell(Qb.target,Qb.rowIndex,Qb.Fo),ha.moveToCell(Qb.source,
0,0);if(Z.TableCellReader.hg(Qb.source)||Z.TableCellReader.hg(Qb.target))return!0;this.JBn(Qb,Va);return!0};this.kKc=(Va,Qb)=>{if(!Qb.source.Rd())return Va.pi(this.vob),!0;Va.pi(this.LKh);return!0};this.LKh=(Va,Qb)=>{const Vb=Qb.source,Sb=Qb.target,nb=Vb.currentNode;if(!nb.yia||!nb.pOa||this.Luo(Vb,Sb))return Va.pi(this.xaf),!0;if(M.a.instance.J(1)&&Y.OutlineElementReader.Eh(Vb)){if(!V.OutlineElementNavigator.Ee(Vb).pOa)return V.OutlineElementNavigator.Yd(Vb),Va.pi(this.xaf),!0;V.OutlineElementNavigator.Yd(Vb)}H.ULS.shipAssertTag(6305608,
307,!nb.f8b());var ac=Sb.currentNode.Yi().xd;ac=R.b(nb,ac,!0);ac.xHa();ac.GXc=!0;this.F4n(Vb,Sb);Sb.ZH(ac,Qb.insertAfter,Vb.role);Sb.Aj(ac);Qb.insertAfter=ac;qa.App.zd.Uo&&qa.App.zd.fq.gG(ac);this.aYh(nb,ac);Qb=new e.a(Va,this.kKc,new mb.a(Vb,Sb,null,Qb.UZf,Qb.Ro));Qb.Rl("RecursiveCorePasteOperation");Qb.run();Va.pi(this.z8k);return!0};this.z8k=(Va,Qb)=>{const Vb=Qb.target,Sb=Vb.currentNode,nb=Qb.source,ac=nb.currentNode;let zc=-1;Qb.Ro[Fb.IAf]&&(zc=Qb.Ro[Fb.IAf]);fa.ParagraphReader.Xb(Sb)&&(this.xJn(Va,
this.kKc,ac,Sb,Qb),this.tJn(Va,ac,Sb));Sb.i1();Qb.Ro[W.a.iui]?22===Sb.type&&(Z.TableCellReader.P0(nb)||Sb.setValue(z.a.listID,Number.MAX_VALUE)):this.CK.P3n(Sb);if(fa.ParagraphReader.Xb(Sb)&&(Qb=sa.i(Sb,5),0<Qb.length)){for(const Ib of Qb)!Ib.properties.hasProperty(z.a.yNb)&&Ib.properties.hasProperty(z.a.P$d)&&(Qb=Ib.properties.getValue(z.a.P$d),Ib.properties.setValue(z.a.yNb,Qb)),O.ImageReader.ncc()?O.ImageReader.gKb(Ib.properties)&&this.Vj.jbg(Ib.properties,zc):O.ImageReader.Oy(Ib.properties)||
this.Vj.jbg(Ib.properties,zc);Sb.Yi().contentReplicator.forceOutbound(null,null,null)}this.$Xh(Vb);this.r_o(ac,Sb);Oa.TableReader.KR(Sb)&&H.ULS.sendTraceTag(524919814,3022,50,"TablePasted");Z.TableCellReader.Rpa(Vb)&&ta.a.Bhj(Sb);Vb.uc();Va.pi(this.xaf);return!0};this.xaf=(Va,Qb)=>{if(!Qb.source.It())return Va.pi(this.vob),!0;Va.pi(this.LKh);return!0};this.vob=()=>{l.a.mark(5565);return!1};this.yZb=$b;this.ep=Ub;this.Vj=Wa;this.dVe=yb;this.FK=Yb;this.rh=qc;this.CK=Hc;this.Ca=mc;this.Lc=ab;this.oAd=
ic.create(2097162);this.V6f(this.oAd);this.Xze=ic.create(2097162);this.V6f(this.Xze);this.aYe=ic.create(2097162);this.V6f(this.aYe);this.$yd=this.oAd;this.MZ=bb;this.D3=Jb;this.Vd=Eb;this.rg=a.a.getInstance(Xa.a.i0a);this.cDc=hb;this.Qik=hb.substr(0,3);this.h7=ob}get Tk(){return null!=this.OFg?this.OFg:this.OFg=k.a.instance.resolve("Box4.IParagraphEditor")}get Zb(){return null!=this.Azg?this.Azg:this.Azg=k.a.instance.Oa("Box4.IFeatureHelper")}get uv(){return this.yt?this.yt.uv:0}get JCb(){return this.yt.lb.JCb}get lwa(){return this.yt.lb.lwa}get xka(){return this.$yd}get lzj(){return this.aYe}get B$e(){return this.yt.LJ&&
!this.KLe}Joj(){this.KLe=!0}get GZi(){return!this.yt.LJ}get $ra(){return Ka.a.instance}V6f(Wa){var yb=new Ga.a(-1);this.yZb.Il.UNa(yb);const Yb=new L.GraphIterator;Yb.set(yb);x.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordNoRenderGraphTransactionInternalClipboardSettings");yb=3;this.Ca&&this.Ca.$("NoRenderGraphTransactionInternalClipboardIsEnabled")&&(yb=0);yb=this.Lc.Pc(yb);yb.St(Yb);Yb.Bf(Wa,80);yb.dispose()}PId(Wa,yb=null){Wa=Wa.mb;this.yt=Wa.ib.clone();this.KLe=!1;Wa=
L.GraphIterator.eb(Wa.Z1);const Yb=L.GraphIterator.eb(this.xka),qc=this.Lc.Pc(3,ia.a.VFm);qc.St(Yb);Wa.Ub(82);do Wa.currentNode.uTb(null);while(Wa.Ti(82));Wa=new e.a(yb,this.KYk,new Ja(Wa,Yb,this.yt,qc));Wa.Rl("InternalCopy");Wa.Qh=!yb||yb.Qh;Wa.run()}w8k(Wa,yb){var Yb=yb.source;const qc=yb.target;var Hc=qc.currentNode,$b=Yb.currentNode;fa.ParagraphReader.oh(qc)&&(yb.N_f[$b.id.toString()]=Hc);if(fa.ParagraphReader.Xb(Hc)){if(0<fa.ParagraphReader.rii($b))if(0<this.ep.IG($b).Wt)$b.setValue(z.a.dTa,
0);else{const Ub=this.ep.F4($b).Wt;this.Tk.qq.jea(Hc,Ub)}if(!this.wZd&&this.h7.q1i){Yb.uc();if(!Oa.TableReader.lx(qc)&&Yb.KGa&&!this.lwa)for(const Ub of this.h7.P_f)Hc.removeProperty(Ub);Yb.Aj($b)}}if(fa.ParagraphReader.Xb(Hc)){for($b=0;$b<Hc.ye.length;$b++)Hc.ye.vq.Z($b,xa.CharacterPropertiesEditor.aN),Hc.ye.nt.Z($b,xa.CharacterPropertiesEditor.YR);H.ULS.shipAssertTag(6305565,307,!!qa.App.zd);(this.Vd.xg||M.a.instance.J(1)&&qa.App.Hv.uSb)&&Hc.setValue(z.a.zRa,!0);Hc.Cg(z.a.UEb,z.a.t0i,z.a.H_f);M.a.instance.J(1)&&
fa.ParagraphReader.Xb(Hc)&&Hc.Cg(z.a.Qxa)}this.GZi&&(this.$Xh(qc),Oa.TableReader.isTable(qc)&&(Hc=this.yt.IO(),Hc.moveNext(),(Hc=Z.TableCellReader.mFa(Yb,Hc.current.node))||(Hc=new ba.a(0,0)),Yb=new ua(Hc,qc,Oa.TableReader.Hha(Yb),Oa.TableReader.kuf(Yb)),this.dVe.value.Q6n(Yb)));Y.OutlineElementReader.Eh(qc)&&!qc.Jt(2)&&(this.rh.NH(qc),qc.uc());qc.uc();yb.yi&&(yb.yi.cGd=yb.insertAfter);Wa.pi(this.hKc);return!0}pWk(Wa){const yb=Wa.source;if(Y.OutlineElementReader.Eh(yb)&&yb.Ujb(12)){const Yb=yb.Rd();
if(fa.ParagraphReader.Xb(Yb)&&Yb.ja(z.a.DN,null))return yb.uc(),Wa.RQb=!1;yb.uc()}else if(fa.ParagraphReader.Xb(yb.Gn)&&yb.Gn.ja(z.a.DN,null))return!1;return!0}HIn(Wa,yb,Yb){yb=sa.e(yb);Yb=sa.e(Yb);for(let qc=0;qc<yb.length;qc++)yb[qc].HVf(Yb[qc],Wa,this.iKc)}s0n(Wa){if(Wa=Wa.qa){var yb=new F.a;for(let Yb=0;Yb<Wa.length;Yb++){const qc=Wa.J(Yb);qc.Ki&&yb.add(qc)}for(const Yb of yb)Yb.Ki=null}}get zJm(){return!L.GraphIterator.eb(this.xka).Rd()}$Ij(){this.$yd=this.aYe}ZIj(){this.$yd=this.oAd}Q0o(){this.$yd=
this.Xze}get XWm(){return this.xka===this.oAd}get NLm(){return this.xka===this.Xze}cFh(){const Wa=L.GraphIterator.eb(this.xka);for(;Wa.Rd();)Wa.zg()}tKi(Wa){const yb=this.fX.oGa.b;Wa+="-"+yb;this.fX.oGa.b=Wa;this.fX.xHb.b=Wa;this.fX.n$d.b=Wa;this.fX.oCb.b=Wa;this.fX.tfb.b=Wa;this.$ra.d6m(this.fX.oGa);this.$ra.oNf(this.fX.xHb);this.$ra.lLi(this.fX.n$d);this.$ra.aNf(this.fX.oCb);this.$ra.YMf(this.fX.tfb);this.fX.oGa.b=yb;this.fX.xHb.b=yb;this.fX.n$d.b=yb;this.fX.oCb.b=yb;this.fX.tfb.b=yb}m1i(Wa,yb,
Yb,qc,Hc=null,$b=null){this.tKi("Paste");yb=L.GraphIterator.eb(yb);const Ub=L.GraphIterator.eb(this.xka);var mc=null;Hc&&(mc=new K.a(Q.OutlineReader.Qil,Q.OutlineReader.Bjl),mc=Hc.equals(new K.a(-1,-1))?new K.a(0,0):Hc.Kke(mc));if(this.cui())if(Ub.Rd(),O.ImageReader.Mt(Ub.currentNode))Hc=Ub.currentNode,Ub.uc(),Ub.ZH(this.rh.Jgb(),null,1),Ub.Rd(),Ub.ZH(Hc,null,2),Ub.uc(),Ub.Aj(Hc),Ub.zg(),this.Joj();else if(N.isFloatingEmbeddedFileNode(Ub.currentNode)){Hc=Ub.currentNode;Ub.uc();Ub.ZH(this.rh.Jgb(),
null,1);Ub.Rd();var ic=this.rh.NH(Ub);ic=Da.a.Rc(ic,0);Fb.jg.Ge(ic,"<<"+N.getEmbeddedFileName(Hc)+">>",void 0,void 0,void 0,void 0,!0);Ub.uc();Ub.uc();Ub.Aj(Hc);Ub.zg();this.Joj()}this.MZ&&this.MZ.YGf(Yb)||!this.aEi(Ub,yb)?(l.a.mark(5564),Ub.currentNode.uTb(null),Wa={},Wa[Fb.IAf]=qc,Ya.ListItemReader.lg(Yb)&&(Wa[W.a.iui]=!0),Yb=new mb.a(Ub,yb,Yb,mc,Wa),qc=new e.a($b,this.kKc,Yb),qc.Rl("ExecuteCorePasteFromInternalClipboard"),qc.Qh=!$b||$b.Qh,this.wIn(Yb),qc.run()):(Ub.currentNode.uTb(null),H.ULS.sendTraceTag(7869376,
307,50,"Begin internal paste table in table"),this.t4n($b,Ub,yb,mc,Wa),H.ULS.sendTraceTag(39699553,307,50,"The call to ReplaceTableCellsFromClipboardTable ended."))}xDi(Wa){if(Wa&&Wa.isValid){const yb=L.GraphIterator.eb(this.xka);return this.aEi(yb,Wa)}return!1}aEi(Wa,yb){if(Z.TableCellReader.Rpa(yb)&&1===Wa.Wp()){Wa.Ub(1);if(Y.OutlineElementReader.Eh(Wa)){V.OutlineElementNavigator.Ee(Wa);if(Oa.TableReader.isTable(Wa))return Oa.TableReader.RB(Wa.currentNode)&&H.ULS.sendTraceTag(17835601,307,50,"Source table is a complex table."),
yb.zb(14)&&!Oa.TableReader.RB(ha.getContainingTable(yb))?H.ULS.sendTraceTag(19269659,307,50,"Target table is not a complex table."):H.ULS.sendTraceTag(19269660,307,50,"Target table is a complex table."),!0;V.OutlineElementNavigator.Yd(Wa)}Wa.uc()}return!1}t4n(Wa,yb,Yb,qc,Hc){let $b,Ub;let mc;Object(m.a)("ReplaceTableCellsFromClipboardTable",!0);Yb.zb(14);$b=ka.a.Ls(Yb);Ub=ea.a(Yb);Yb.jd(14);var ic=Oa.TableReader.gg(Yb.currentNode);mc=Oa.TableReader.hh(Yb.currentNode);const ab=Oa.TableReader.gg(yb.currentNode),
bb=Oa.TableReader.hh(yb.currentNode);H.ULS.sendTraceTag(8716373,307,50,"Target and source table row column counts: target: {0},{1}; source: {2},{3};  and target insert index: {5},{6}",ic,mc,ab,bb,$b,Ub);if(za.TableBorderSelectionCache.rSc())this.Aoo(),ic=Math.min(this.Cle+1,ic),mc=Math.min(this.ulg+1,mc),this.ulg-this.jIo==mc-1&&(this.vyj==this.Cle?Ub=0:this.Cle-this.vyj==ic-1&&(Yb.Rd(),$b=ka.a.Ls(Yb),Ub=ea.a(Yb)));else{this.zBa=lb.a.l$b;const Jb=$b+ab-ic;0<Jb&&(ha.moveToLastRow(Yb),H.ULS.sendTraceTag(8716374,
307,50,"Begin insert rows: "+Jb),this.dVe.value.insertRows(Yb,!1,Jb,this.zBa),H.ULS.sendTraceTag(8716375,307,50,"Completed inserting rows."),Yb.jd(14));const Eb=Ub+bb-mc;if(0<Eb){H.ULS.sendTraceTag(8716376,307,50,"Begin insert columns: "+Eb);try{this.dVe.value.insertColumns(Yb,mc,!1,Eb,this.zBa)}catch(hb){throw H.ULS.sendTraceTag(19269661,307,10,"Insert columns failed: {0}",hb.toString()),hb;}H.ULS.sendTraceTag(8716377,307,50,"Completed inserting columns.")}(0<Jb||0<Eb)&&Object(m.a)("InsertRowsAndColumnsForInternalCCP",
!0)}ic=this.bRl(ic,mc,ab,bb,$b,Ub);H.ULS.sendTraceTag(8716378,307,50,"Begin paste cell contents");Wa=new e.a(Wa,this.WBn,new Hb(null,yb,Yb,qc,$b,Ub,ic,null,Hc));Wa.Rl("ExecuteCorePasteTableInTable");Wa.Qh=!1;Wa.run()}Shn(){if(this.wZd){for(var Wa=L.GraphIterator.eb(this.xka),yb=Wa.currentNode;14!==Wa.Xe;)if(yb=Wa.Rd(),!yb){H.ULS.sendTraceTag(39716809,307,50,"NormalizeCopiedTable: Couldn't find any Table graph node under this.TheClipboardRoot.");return}this.dSi(yb)}}Whn(Wa){this.wZd&&this.dSi(Wa)}aLo(Wa){const yb=
L.GraphIterator.eb(Wa);this.FK.Fkb(yb,null,!0);Wa.hg=!1;Wa.rowSpan=1;Wa.colSpan=1}dSi(Wa){if(Wa&&14===Wa.type){H.ULS.sendTraceTag(39716810,307,50,"NormalizeTable: start to normalize.");var yb={},Yb=Oa.TableReader.gg(Wa),qc=Oa.TableReader.hh(Wa),Hc=L.GraphIterator.eb(Wa);ha.forEachCellInTable(Hc,($b,Ub,mc)=>{const ic={};$b=$b.currentNode;if(16===$b.type)if($b.hg)Fb.YHh(Ub,mc)in yb||(this.aLo($b),ic.IsGhostCell="->false");else{Fb.eUn(Wa,$b,Ub,mc,Yb,(bb,Jb,Eb)=>{ic.rowSpan=String.format("{0}:{1}->{2}",
bb,Jb,Eb)});Fb.dUn(Wa,$b,mc,Ub,qc,(bb,Jb,Eb)=>{ic.colSpan=String.format("{0}:{1}->{2}",bb,Jb,Eb)});const ab=String.format("{0},{1}-{2},{3}",Ub,mc,Ub+$b.rowSpan,mc+$b.colSpan);for(let bb=0;bb<$b.rowSpan;bb++)for(let Jb=0;Jb<$b.colSpan;Jb++)if(bb||Jb)yb[Fb.YHh(Ub+bb,mc+Jb)]=ab}if(0<G.a(ic).length){if(void 0===ic.IsGhostCell||null===ic.IsGhostCell){if(void 0===ic.rowSpan||null===ic.rowSpan)ic.rowSpan=$b.rowSpan;if(void 0===ic.colSpan||null===ic.colSpan)ic.colSpan=$b.colSpan}H.ULS.sendTraceTag(39175904,
307,50,"NormalizeTable: [{0},{1}]: {2}.",Ub,mc,ic)}return!0});Fb.stl(yb)}}Lnm(Wa,yb){if(Wa&&fa.ParagraphReader.Xb(Wa)){var Yb=0,qc=L.GraphIterator.eb(Wa);for(qc.Ub(6);!qc.$r;){var Hc=qc.currentNode;qc.Ti(6);O.ImageReader.Mt(Hc)?O.ImageReader.BHf(Hc)?L.GraphIterator.eb(Hc).Ujb(59)?H.ULS.sendTraceTag(590455048,307,50,"HandleAnchoredObjectsForInternalCopy: Not converting anchored image to inline."):(this.Tk.MJh(Hc,Da.a.Rc(Wa,Yb),!0),yb.d++,Yb++):(Hc=L.GraphIterator.eb(Hc),Hc.zb(12),Hc.zg(),yb.h++):H.ULS.shipAssertTag(6305571,
307,!1)}}}get wZd(){return!!this.Ca&&this.Ca.$("ComplexTableCellPasteWithFormattingIsEnabled")}bRl(Wa,yb,Yb,qc,Hc,$b){const Ub=[];let mc,ic,ab,bb;za.TableBorderSelectionCache.rSc()?(mc=Math.min(Wa,Hc+Yb),ic=Math.min(yb,$b+qc),bb=Hc):(bb=0,mc=Math.max(Hc+Yb,Wa));for(;bb<mc;bb++)for(za.TableBorderSelectionCache.rSc()?ab=$b:(ab=0,ic=$b+qc,bb<Hc?ab=yb:bb>=Hc&&bb<Math.min(Hc+Yb,Wa)?ab=$b:bb>=Hc+Yb&&bb<Wa?ab=yb:ic=Math.max($b+qc,yb));ab<ic;ab++)Ub.push(Array(2)),Ub[Ub.length-1][0]=bb,Ub[Ub.length-1][1]=
ab;return Ub}F4n(Wa,yb){if(this.wZd)if(!yb||!Wa)H.ULS.sendTraceTag(39175905,307,50,"ReplicateTableCellProperties: {0}",{["source"]:Wa,["table"]:yb});else if(16===yb.currentNode.type&&16===Wa.parentNode.type){yb=yb.currentNode;Wa=Wa.parentNode;var Yb={};yb.hg!==Wa.hg&&(yb.hg=Wa.hg,Yb.IsGhostCell=yb.hg);yb.Z4!==Wa.Z4&&(yb.Z4=Wa.Z4,Yb.IsSkippedCell=yb.Z4);yb.uqb!==Wa.uqb&&(yb.uqb=Wa.uqb,Yb.ShouldRenderCell=yb.uqb);yb.colSpan!==Wa.colSpan&&(Yb.ColSpan=String.format("{0}<={1}.",yb.colSpan,Wa.colSpan),
yb.colSpan=Wa.colSpan);yb.rowSpan!==Wa.rowSpan&&(Yb.RowSpan=String.format("{0}<={1}.",yb.rowSpan,Wa.rowSpan),yb.rowSpan=Wa.rowSpan);G.a(Yb)}}Luo(Wa,yb){let Yb=!1;Y.OutlineElementReader.Eh(Wa)&&(Yb=Y.OutlineElementReader.ZQ(Wa)&&this.fWm(yb));return Yb}fWm(Wa){if(Wa)return Wa=Wa.Xe,36===Wa||38===Wa||16===Wa;throw Error.argument("IsTargetNodeInValidForIFrameContent: target iterator is null for paste.");}tJn(Wa,yb,Yb){yb=sa.e(yb);const qc=sa.e(Yb);for(let Hc=yb.length-1;0<=Hc;Hc--){if(!yb[Hc].Llc(Yb)){const $b=
Da.a.createTextRange(Yb,yb[Hc].Lb.cp,yb[Hc].Lb.cp+1);Fb.jg.Ge($b,"",void 0,void 0,void 0,void 0,!0)}yb[Hc].Y1c(qc[Hc],Wa,this.kKc,this.NLm)}}r_o(Wa,yb){if(M.a.instance.J(1)&&Oa.TableReader.KR(Wa)){let Yb=0;const qc=Oa.TableReader.gg(Wa);for(const Hc of Oa.TableReader.Nx(Wa,0,qc-1))Hc.Wu&&Yb++;Wa=this.Lc.Pc(4);Wa.Db(yb);yb.properties.setValue(v.a.Yza,qc-Yb);Wa.dispose()}}e6d(){return!L.GraphIterator.eb(this.xka).Rd()}cui(){return this.B$e?1===L.GraphIterator.eb(this.xka).Wp():!1}h8h(Wa){try{return this.OTl(Wa)}catch(yb){return H.ULS.sendTraceTag(23643968,
307,10,"GetCopySourceFromDOMTree failed with exception:{0}",yb.message),0}}OTl(Wa){let yb=0;if(Wa&&(yb=this.NTl(Wa),!yb&&Wa.childNodes))for(let Yb=0;Yb<Wa.childNodes.length&&!(yb=this.h8h(Wa.childNodes[Yb]));Yb++);return yb}NTl(Wa){if(1===Wa.nodeType&&Wa.getAttribute){Wa=(Wa.getAttribute("class")||"").split(" ");for(const yb of Wa)if(yb.startsWith(this.Qik))return yb.startsWith(this.cDc)?this.uv&&yb===this.cDc+this.uv?3:2:1}return 0}IIn(Wa,yb,Yb,qc,Hc){Hc.Ro||(Hc.Ro={});Fb.sa.raiseEvent("OnParagraphCopy",
new Ua(Wa,yb,Yb,qc,Hc.Ro))}lJn(Wa,yb,Yb,qc){qc.Ro||(qc.Ro={});Fb.sa.raiseEvent("OnCopyComplete",new Ua(Wa,null,yb,Yb,qc.Ro))}wIn(Wa){Wa.Ro||(Wa.Ro={});Fb.sa.raiseEvent("BeforePaste",new fb(Wa.Ro))}vIn(Wa){Wa.Ro||(Wa.Ro={});Fb.sa.raiseEvent("BeforeCopy",new Ma(this.yt,Wa.Ro))}xJn(Wa,yb,Yb,qc,Hc){Fb.sa.raiseEvent("OnParagraphPaste",new Ua(Wa,yb,Yb,qc,Hc.Ro))}$Xh(Wa){Z.TableCellReader.isTableCell(Wa)&&(Wa.Ub(1)||this.FK.a8(Wa,!0),Wa.uc())}aYh(Wa,yb){this.D3.Uxa(yb)&&(yb.width=Wa.width)}static s0e(Wa){Fb.sa.addHandler("OnParagraphCopy",
Wa)}static mCd(Wa){Fb.sa.addHandler("OnParagraphPaste",Wa)}static U1n(Wa){Fb.sa.removeHandler("OnParagraphPaste",Wa)}static Oxk(Wa){Fb.sa.addHandler("OnCopyComplete",Wa)}static Uwk(Wa){Fb.sa.addHandler("BeforePaste",Wa)}static l1n(Wa){Fb.sa.removeHandler("BeforePaste",Wa)}static Swk(Wa){Fb.sa.addHandler("BeforeCopy",Wa)}static Vwk(Wa){Fb.sa.addHandler("BeforeTrimOnCopy",Wa)}static Mwk(Wa){Fb.sa.addHandler("AfterTrimCompleteOnCopy",Wa)}static get jg(){return null!=Fb.bxg?Fb.bxg:Fb.bxg=k.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get hH(){return Ra.a.instance}static get Hi(){return pa.PageReader.instance}static stl(Wa){const yb=
{};for(const Yb of G.a(Wa)){const qc=Wa[Yb];yb[qc]=qc in yb?String.format("{0}|{1}",yb[qc],Yb):Yb}1<=G.a(yb).length&&H.ULS.sendTraceTag(39204995,307,50,"NormalizeTable: ghostCells - {0}",yb)}static dUn(Wa,yb,Yb,qc,Hc,$b){yb.colSpan>Hc-Yb&&($b&&$b("A",yb.colSpan,Hc-Yb),yb.colSpan=Hc-Yb);Wa=Fb.Yyo(Wa,yb,qc,Yb);yb.colSpan!==Wa&&($b&&$b("B",yb.colSpan,Wa),yb.colSpan=Wa)}static eUn(Wa,yb,Yb,qc,Hc,$b){yb.rowSpan>Hc-Yb&&($b&&$b("A",yb.rowSpan,Hc-Yb),yb.rowSpan=Hc-Yb);Wa=Fb.Zyo(Wa,yb,Yb,qc);yb.rowSpan!==
Wa&&($b&&$b("B",yb.rowSpan,Wa),yb.rowSpan=Wa)}static Yyo(Wa,yb,Yb,qc){return Fb.Atj(Wa,yb.colSpan,(Hc,$b)=>{ha.moveToCell(Hc,Yb,qc+$b)})}static Zyo(Wa,yb,Yb,qc){return Fb.Atj(Wa,yb.rowSpan,(Hc,$b)=>{ha.moveToCell(Hc,Yb+$b,qc)})}static Atj(Wa,yb,Yb){if(14!==Wa.type)throw Error.argument("tableNode is not a Table.");if(!Yb)throw Error.argumentNull("MoveToCellAction");for(let Hc=1;Hc<yb;Hc++){var qc=L.GraphIterator.eb(Wa);Yb(qc,Hc);qc=qc.currentNode;if(!qc||16!==qc.type||!qc.hg)return Hc}return yb}static YHh(Wa,
yb){return Wa+","+yb}JBn(Wa,yb){for(;Wa.target.Rd();)Wa.target.zg();Wa.anc=new e.a(yb,Wa.p1i?Wa.p1i:this.kKc,new mb.a(Wa.source,Wa.target,null,Wa.UZf));Wa.anc.Rl("ExecuteCorePasteCellContentInCell");Wa.anc.Qh=!1;Wa.anc.run()}tfn(Wa){let yb=!1;if(za.TableBorderSelectionCache.rSc()){const Yb=ea.a(Wa.target),qc=ka.a.Ls(Wa.target);let Hc=this.Cle;isNullOrUndefined(Wa.n0a[Wa.n0a.length-1])||(Hc=Math.min(Hc,Wa.n0a[Wa.n0a.length-1][0]));let $b=this.ulg;isNullOrUndefined(Wa.n0a[Wa.n0a.length-1])||($b=Math.min($b,
Wa.n0a[Wa.n0a.length-1][1]));Z.TableCellReader.vRa(Wa.target)||Z.TableCellReader.vRa(Wa.source)||qc==Hc&&Yb==$b?yb=!0:(Z.TableCellReader.isTableCell(Wa.target)||Wa.target.jd(16),Z.TableCellReader.gda(Wa.source)?(Z.TableCellReader.vRa(Wa.target)||(ha.moveToNextRow(Wa.target),ha.moveToColumnByIndex(Wa.target,Wa.Fo),H.ULS.sendTraceTag(8716379,307,50,"Move to next row to replace cell contents")),ha.moveToNextOrPreviousCell(Wa.source,!1,!1)):Z.TableCellReader.gda(Wa.target)||Yb==$b?(ha.moveToNextRow(Wa.source),
ha.moveToColumnByIndex(Wa.source,0),H.ULS.sendTraceTag(537519906,307,50,"Move to next row to replace cell contents"),ha.moveToNextRow(Wa.target),ha.moveToColumnByIndex(Wa.target,Wa.Fo),H.ULS.sendTraceTag(537519907,307,50,"Move to next row to replace cell contents")):(ha.moveToNextOrPreviousCell(Wa.target,!1,!1),ha.moveToNextOrPreviousCell(Wa.source,!1,!1)))}else Z.TableCellReader.vRa(Wa.source)?yb=!0:(Z.TableCellReader.isTableCell(Wa.target)||Wa.target.jd(16),Z.TableCellReader.gda(Wa.source)?(ha.moveToNextRow(Wa.target),
ha.moveToColumnByIndex(Wa.target,Wa.Fo),H.ULS.sendTraceTag(537716887,307,50,"Move to next row to replace cell contents")):ha.moveToNextOrPreviousCell(Wa.target,!1,!1),ha.moveToNextOrPreviousCell(Wa.source,!1,!1));yb&&(this.MZ&&this.MZ.vJn(Wa.target,Wa.n0a),Oa.TableReader.isTable(Wa.target)||Wa.target.jd(14),this.Whn(Wa.target.currentNode),H.ULS.sendTraceTag(7869377,307,50,"End of internal paste table in table"));return yb}Aoo(){this.Cle=za.TableBorderSelectionCache.C$.bottomMostRowSelected;this.ulg=
za.TableBorderSelectionCache.C$.rightMostColumnSelected;this.jIo=za.TableBorderSelectionCache.C$.leftMostColumnSelected;this.vyj=za.TableBorderSelectionCache.C$.topMostRowSelected}}Fb.sa=new y.a;Fb.IAf="PasteConstrainingWidth";Object(D.a)(Fb,"InternalClipboard",null,[])},1998:function(D,I,c){D=c(0);var l=c(2),e=c(129),a=c(60),k=c(243),x=c(22),y=c(19),m=c(86),t=c(192),z=c(16),v=c(46),H=c(6),F=c(7),G=c(69),M=c(42),K=c(31),L=c(306),R=c(88),S=c(12),N=c(5),O=c(104),W=c(18),V=c(36),Q=c(252),Y=c(40),ba=
c(254),Z=c(21),ea=c(78),ha=c(151),ka=c(889),ua=c(3),sa=c(82),Da=c(61),Pa=c(10),Ra=c(99),Ga=c(43),ta=c(478),va=c(445),ia=c(214),qa=c(17),pa=c(23),Fa=c(48),za=c(32),Oa=c(237),xa=c(8),fa=c(1582),Ka=c(1603),lb=c(297),Xa=c(173),kb=c(67),Bb=c(509),Ja=c(57);class Ma extends lb.a{constructor(Ua,Ya,Fb,Wa,yb,Yb,qc,Hc){super();this.tfh=this.jw=null;this.init(Ua);this.Rl("FormattingViewOperation");this.zkb(l.AFrameworkApplication.va,Ya,Wa,yb,Yb);this._context=Fb;this.b$a=0;this.zs=!0;this.k3j=qc;this.en=Hc}get mca(){return this.en.instance}run(){const Ua=
this._context.view;var Ya=null;Ua.ue&&(Ya=Ua.mb);if(Ya){var Fb=Ya.ib.lb,Wa=!Ka.a.rcc(this.actionId);!Fb||Ma.Yf.SHf(Fb,Wa)?(Ma.Ic.Yb(sa.a.ef,{["Reason"]:Da.a.cF}),this.zs=!1):this.mca&&this.mca.Jcc(Fb)?(Ma.Ic.Yb(sa.a.ef,{["Reason"]:Da.a.P1a}),this.zs=!1):Ma.ah.xAa(xa.ParagraphReader.OU,Ya.qg)&&(Ma.Ic.Yb(sa.a.ef,{["Reason"]:Da.a.AO}),this.zs=!1)}else Ma.Ic.Yb(sa.a.ef,{["Reason"]:Da.a.Eda}),this.zs=!1;1!==this.behavior&&this.zs||(this.zs&&(Fb=Ya.ib.lb,1===Ya.ib.length&&1===Fb.length&&qa.SelectionEditor.vl(Fb.Pa)&&
ea.b(Fb.Pa)&&(Ma.Ic.Yb(sa.a.ef,{["Reason"]:Da.a.KJc}),this.zs=!1)),(Fb=this.zs)&&this.actionId===ua.a.N5&&((Fb=Array.from(Ya.ib.lb).some(O.FormattingReader.v$e))||Ma.Ic.Yb(sa.a.ef,{["Reason"]:Da.a.Ngf})),this.ur=Fb?32:8,this.b$a=3);this.b$a||(Xa.a.mark(5730),this.tfh=Bb.SelectionReferenceFactory.instance.pDb(),Fb=Ya.ib.lb.Pa,this.jw=new Ga.GraphTransaction(15),this.jw.Db(Fb.node),this.jw.Uj=this.actionId,this.b$a=1);if(1===this.b$a){this.JC||this.r9c(this._context.ik);if(1===this.M6a())return;this.b$a=
2}if(2===this.b$a){if(this.actionId===ua.a.N5)if(Ya=Ya.qg,Ya.jx)for(Fb=0;Fb<Ya.length;Fb++)Wa=Ya.getContext(Fb),this.qDj(Wa);else this.qDj(Ya);Ja.a.I$e&&this.QOo(this.actionId,this.vd);this.tfh.cra(this.actionId===ua.a.lZ||this.actionId===ua.a.fva);(Ya=Object(G.a)(24,this.vd))&&!Ya.DUa||kb.FocusManager.instance().mg(Ua.uJ);this.jw.dispose();this.jw=null;Pa.App.za.updateCommandUI();Xa.a.mark(5731);this.b$a=3;this.ur=32}3===this.b$a&&(this.k3j.process(this.actionId,this._context,this.behavior,this.response),
this.tra())}QOo(Ua,Ya){const Fb={};Fb.FormattingActionId=Ua;Fb.FormattingActionData=Ya;8===this.ga.Qb(ua.a.qDd,2,Fb)&&F.ULS.sendTraceTag(509110153,368,10,"Command applyFormattingToContentControls failed! ActionId '{0}', ActionData '{1}'",Ua,Ya)}qDj(Ua){(qa.SelectionEditor.nv(Ua)||qa.SelectionEditor.Lk(Ua))&&Pa.App.zN.tea(Ua.node)}static get Yf(){return Oa.a.instance}static get ah(){return ia.ContextSetEditor.instance}static get Ic(){return t.a.instance}}Object(D.a)(Ma,"FormattingViewOperation",lb.a,
[]);var fb=c(1055),hc=c(954),cc=c(74);c.d(I,"a",function(){return Hb});const mb=new Set([ua.a.u0,ua.a.L1,ua.a.LC,ua.a.GDa,ua.a.HDa,ua.a.k0a,ua.a.cva,ua.a.l0a]);class Hb{constructor(Ua,Ya,Fb=null,Wa,yb,Yb,qc,Hc,$b,Ub,mc,ic,ab){this.kpiName="ChangeCaseCommandUsage";this.S8="wwaengidc";this.bmb=new Map;this.o6g=new Set;this.yFb=()=>new ka.a(2);this.N5i=(bb,Jb,Eb,hb,ob)=>{hb=!0;Jb.contextId!==S.a.view&&(hb=!1);if(1===Eb&&!hb)return 8;if(bb===ua.a.d5c)bb=ob.formatting,ob=ob.oig;else{if(!Jb.view||!Jb.view.ue)return 2;
Jb=Jb.view;if(!Jb.mb||!Jb.mb.ib.lb)return 8;bb=ob;ob=Jb.mb.ib}this.M3k(ob,bb);return 32};this.h2e=(bb,Jb,Eb,hb,ob,Va)=>new Ma(bb,Jb,Eb,hb,ob,Va,this.R3j,Hb.ix());this.nDd=(bb,Jb,Eb,hb,ob)=>{var Va,Qb,Vb;let Sb=!0,nb=Jb;const ac=!Ka.a.rcc(bb);Jb.contextId!==S.a.Fd&&Jb.contextId!==S.a.Uc?Sb=!1:(Hb.Yf.x9(nb,!1,ac)&&(Hb.Ic.Yb(sa.a.vn,{["Reason"]:Da.a.cF}),Sb=!1),Hb.ix()&&Hb.ix().instance&&Hb.ix().instance.SU(nb)&&(Sb=!1),Sb&&qa.SelectionEditor.vl(Jb)&&ea.b(nb)&&(Hb.Ic.Yb(sa.a.vn,{["Reason"]:Da.a.KJc}),
Sb=!1),xa.ParagraphReader.OU(Jb)&&(Hb.Ic.Yb(sa.a.ef,{["Reason"]:Da.a.AO}),Sb=!1));if(1===Eb||!Sb)return Sb?32:8;if(Jb.contextId===S.a.Uc)return 2;(Jb=null===(Va=this.Lo)||void 0===Va?void 0:Va.KTd(nb))&&(nb=Jb);this.avo(bb)&&(Va=qa.SelectionEditor.ySb(nb),qa.SelectionEditor.Ze(Va)||(nb=Va));Va="boolean"===typeof ob&&ob;Jb=!1;(null===(Qb=this.Daa)||void 0===Qb?0:Qb.annotateRange)&&(null===(Vb=this.Daa)||void 0===Vb?0:Vb.Bdc(nb.node))&&(Jb=this.rX(nb,bb,ob,Va));Jb&&bb!==ua.a.N5||Hb.Eea.rX(nb,zc=>{this.Zkc(zc,
bb,ob,nb.cpEnd)},Va);nb.node.Gr&&(Qb=[Object.assign(new K.a,{name:"Source",string:"CharacterFormatting"})],M.a("TOCFormatting",!0,void 0,Qb));this.mJm(bb)&&this.KFd(nb,bb);hb&&fa.a.krb&&(hb.Hs|=fa.a.Tib(nb.node));return 32};this.ecd=(bb,Jb,Eb)=>1!==Eb&&2===Eb?(this.bmb.set("Source","Shortcut"),bb=Jb.node.characterData.substr(Jb.cpBegin,Jb.cpEnd-Jb.cpBegin),Hb.lIf(bb,0,bb.length)?this.KFd(Jb,ua.a.GDa):Hb.uVm(bb,bb.length)?this.KFd(Jb,ua.a.cva):this.KFd(Jb,ua.a.HDa)):32;this.Zfb=(bb,Jb,Eb)=>{let hb=
!0;bb=!Ka.a.rcc(bb);Jb.contextId!==S.a.Fd&&Jb.contextId!==S.a.Uc?hb=!1:(Hb.Yf.x9(Jb,!1,bb)&&(Hb.Ic.Yb(sa.a.vn,{["Reason"]:Da.a.cF}),hb=!1),hb&&qa.SelectionEditor.vl(Jb)&&ea.b(Jb)&&(Hb.Ic.Yb(sa.a.vn,{["Reason"]:Da.a.KJc}),hb=!1),hb&&xa.ParagraphReader.OU(Jb)&&(Hb.Ic.Yb(sa.a.ef,{["Reason"]:Da.a.AO}),hb=!1));if(1===Eb||!hb)return hb?32:8;Jb=Jb.node;this.Ys.sCb(Jb,!1);Jb.Gr&&(Jb=[Object.assign(new K.a,{name:"Source",string:"ClearFormatting"})],M.a("TOCFormatting",!0,void 0,Jb));return 32};this.LIc=(bb,
Jb,Eb,hb,ob)=>{bb={};bb[fb.a.fKa]=6168;bb[fb.a.eKa]=6169;const Va=Jb.view;var Qb=null;Va.Zi&&(Qb=Va);var Vb=!0;let Sb=32;Qb&&(Qb=Qb.mb.ib.lb)&&(Hb.Yf.SHf(Qb)?(Hb.Ic.Yb(sa.a.ef,{["Reason"]:Da.a.cF}),Sb=8,Vb=!1):1===Eb&&(Sb=32,Vb=!1));Vb&&(Vb=new Ga.GraphTransaction(1===Eb?3:15),Vb.Db(Va.root),Sb=fb.a.Kqa(ua.a.Zfb,Jb,Eb,hb,ob,bb,12),Vb.dispose());return Sb};this.p2e=(bb,Jb,Eb,hb,ob)=>{var Va,Qb=!0,Vb=32;const Sb=!Ka.a.rcc(bb);Jb.contextId!==S.a.Uc?Qb=!1:Hb.Yf.x9(Jb,!1,Sb)&&(Hb.Ic.Yb(sa.a.vn,{["Reason"]:Da.a.cF}),
Qb=!1);if(1===Eb||!Qb)return Qb?32:8;Eb=Jb.node;bb===ua.a.LC&&(Hb.Qn.MIc(Eb),this.Ys.vFh(Eb),Qb=this.qz.JB(Eb).oj(this.qz.wordStyleIdNormal),this.$u.aK(Qb,Eb,!0));Eb=Hb.Bj.Auf(Jb);!Eb&&(Qb=null===(Va=this.Lo)||void 0===Va?void 0:Va.KTd(Jb))&&(Jb=Qb,Eb=pa.SelectionFactory.Zn(Jb));if(Eb)Vb=Fa.a.kDb(Eb),Vb=l.AFrameworkApplication.va.Nf(Vb,bb,2,!1,hb,ob);else{hb=Object(G.a)(24,ob);Va=O.FormattingReader.Yr(Jb);if(!Va)return 16;Va=Va.cache;switch(bb){case ua.a.font:Hb.H1h();if(hb&&hb.vd){const {fontName:nb,
Gea:ac,bold:zc,italic:Ib}=Hb.Xqf(hb.vd);Hb.Bj.Qge(nb);Hb.Bj.Reg(ac);Object(ta.a)()&&(bb=1==zc,ob=1==Ib,bb||ob)&&(Hb.Bj.HL(bb),Hb.Bj.az(ob))}break;case ua.a.Yv:F.ULS.sendTraceTag(595153824,340,50,"Font color is selected from Standard/Theme colors.");Hb.Bj.Yv(ob);break;case ua.a.sra:Hb.Bj.Yv(ob);this.v1.w_a(ob)||F.ULS.sendTraceTag(594899723,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ua.a.Jga:Hb.Bj.Jga();break;case ua.a.lZ:F.ULS.sendTraceTag(594899722,340,50,"Font background color is selected from Standard colors.");
Hb.Bj.Gza(ob);break;case ua.a.H$:Hb.Bj.Gza(ob);this.v1.w_a(ob)||F.ULS.sendTraceTag(594899720,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ua.a.fva:Hb.Bj.qGd();break;case ua.a.WA:Hb.H1h();Hb.Bj.WA(hb.vd);break;case ua.a.u0:bb=Hb.Bj.KG(z.a.fontSize,Va.fontSize);Hb.Bj.WA(this.De.u0(bb));break;case ua.a.L1:bb=Hb.Bj.KG(z.a.fontSize,Va.fontSize);Hb.Bj.WA(this.De.L1(bb));break;case ua.a.bold:bb=Hb.Bj.KG(z.a.bold,Va.isBold);Hb.Bj.HL(!bb);break;case ua.a.az:bb=Hb.Bj.KG(z.a.italic,
Va.isItalic);Hb.Bj.az(!bb);break;case ua.a.underline:bb=Hb.Bj.KG(z.a.underline,Va.isUnderline);Hb.Bj.Q5(!bb);break;case ua.a.fka:Hb.Bj.fka(ob);break;case ua.a.superscript:bb=Hb.Bj.KG(z.a.superscript,Va.isSuperscript);Hb.Bj.vra(!bb);break;case ua.a.subscript:bb=Hb.Bj.KG(z.a.subscript,Va.isSubscript);Hb.Bj.OIa(!bb);break;case ua.a.strikethrough:bb=Hb.Bj.KG(z.a.strikethrough,Va.isStrikethrough);Hb.Bj.dka(!bb);break;case ua.a.Ht:bb=Hb.Bj.KG(v.a.Ht,Va.isDoubleStrikethrough);Hb.Bj.Kge(!bb);break;case ua.a.LC:Hb.Bj.p7a();
break;case ua.a.N5:ob.hasProperty(z.a.uL)&&Hb.Bj.N5(ob.getValue(z.a.uL));ob.hasProperty(H.a.noProof)&&(bb=ob.getValue(H.a.noProof),Hb.Bj.ylo(bb));break;default:this.o6g.has(bb)||(this.o6g.add(bb),(ob=e.ActionManager.yba(bb))&&ob.length||(ob="UnknownAction"),F.ULS.sendTraceTag(523120736,324,15,`TextFormattingActor.applyFormattingIp received unexpected command: ${ob} (${bb})`))}}Pa.App.za.updateCommandUI();return Vb};this.RT=(bb,Jb,Eb,hb,ob)=>{hb=Hb.Ic.Fp(ua.a.qio);var Va=!0;Jb.contextId!==S.a.Vc&&
(Va=!1);if(1===Eb||!Va)return Va?32:8;Eb=Jb.node;Va=N.GraphIterator.eb(Jb.node);Va.qd();Va=Va.aia(4);if((Va=!!Va&&Hb.Jd.hda(Va))&&!Pa.App.cfc)return 8;var Qb=!xa.ParagraphReader.textLength(Eb);hb.properties.Z("Action",bb.toString());hb.properties.Z("ListContext",Va.toString());hb.properties.Z("IsEmptyParagraph",Qb.toString());F.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",bb,Va,Qb);Va=Eb.qa.last;this.A0n(Eb,bb);var Vb=!!Va.formatting;const Sb=Eb.getValue(H.a.jwa);
Qb=this.Md.J1a(Eb);Vb=!Vb&&Sb&&Sb.equals(a.a.nil)?new ha.a(Va,a.a.nil):Qb.vf(Qb.Lb);this.Zkc(Qb,bb,ob,Va.cp);R.a.instance.J(1)&&Hb.Ej.kQb(Eb,Va,Jb.cpBegin,Jb.cpEnd,Vb,Qb,Hb.Qd.xg);hb.end();return 32};this.Wma=(bb,Jb,Eb)=>{bb=!0;const hb=N.GraphIterator.eb(Jb.node);hb.qd();Jb.contextId===S.a.Vc&&hb.aia(4)||(Hb.Ic.Yb(sa.a.vn,{["Reason"]:Da.a.sLf}),bb=!1);return Hb.Jd.hda(hb.currentNode)?1!==Eb&&bb?32:bb?32:8:8};this.Uqa=(bb,Jb,Eb,hb,ob)=>{bb=!0;Jb.contextId!==S.a.paragraph&&(bb=!1);if(1===Eb&&!bb)return 8;
Eb=Jb.node;-1!==ob.Kh?ob.Kh!==xa.ParagraphReader.Lx(Eb)&&(ob.Kh=0):ob.Kh=xa.ParagraphReader.Lx(Eb);bb=this.ep.ijb(Eb);ob.Lt?(!ob.Csm&&this.Fsm(ob.Lt,bb)&&2===ob.Lt.specialIndentType&&(ob.Lt.specialIndentType=0),ob.Lt.pIb===bb.pIb&&k.a.Cxa(ob.Lt.OB,bb.OB)||(ob.Lt.OB=Number.MAX_VALUE),ob.Lt.qIb===bb.qIb&&k.a.Cxa(ob.Lt.jpa,bb.jpa)||(ob.Lt.jpa=Number.MAX_VALUE)):ob.Lt=bb;Jb=Hb.ah.vwh(Jb.ik);void 0!==Jb&&null!==Jb&&(Jb=Jb.node,void 0!==Jb&&null!==Jb&&(Jb=Q.WordSectionNavigator.instance.yL(Jb),void 0!==
Jb&&null!==Jb&&(Jb=Hb.Uf.qu(Jb)-(Hb.Uf.CJ(Jb)+Hb.Uf.mL(Jb)+Pa.App.BAa),bb.FUc=Jb-bb.OB,bb.EUc=Jb-bb.jpa,ob.Lt.EUc=Math.min(ob.Lt.EUc,bb.EUc),ob.Lt.FUc=Math.min(ob.Lt.FUc,bb.FUc))));Jb=this.zW.nQa(Eb);ob.spacing?(ob.spacing.beforeSpacing=Hb.ksh(Jb.beforeSpacing,ob.spacing.beforeSpacing),ob.spacing.afterSpacing=Hb.ksh(Jb.afterSpacing,ob.spacing.afterSpacing),ob.spacing.lineSpacing.unit===Jb.lineSpacing.unit&&k.a.Cxa(ob.spacing.lineSpacing.value,Jb.lineSpacing.value)||(ob.spacing.lineSpacing.unit=0,
ob.spacing.lineSpacing.value=0)):ob.spacing=Jb;Jb=new N.GraphIterator;Jb.set(Eb);Jb.zb(11);if(Eb=Jb.jd(11))ob.isRtl=Y.OutlineElementReader.Pn(Eb);Eb=Hb.Jd.vw(Jb);Jb=16;void 0!==Eb&&null!==Eb&&(Jb=Eb.listType);ob.listType=Hb.vUl(ob.listType,Jb);ob.Tx=16===ob.listType?null:Eb;return 32};this.cMn=(bb,Jb,Eb,hb,ob)=>{ob.isRtl=Y.OutlineElementReader.Pn(V.OutlineElementNavigator.El(Jb.node));return 32};this.jvh=(bb,Jb,Eb)=>{if(bb===ua.a.GQb)bb=!0;else if(bb===ua.a.FQb)bb=!1;else return 2;bb&&this.vLi(Jb);
if(1===Eb)return 32;this.rh.wQb(V.OutlineElementNavigator.El(Jb.node),bb);return 32};this.TLn=(bb,Jb,Eb,hb,ob)=>{bb=Jb.node;ob.isRtl=Y.OutlineElementReader.isRtl(V.OutlineElementNavigator.El(bb));ob.Kh=W.ImageReader.Lx(bb);return 32};this.cNn=(bb,Jb,Eb,hb,ob)=>{bb=Jb.node;ob.isRtl=Y.OutlineElementReader.isRtl(V.OutlineElementNavigator.El(bb));ob.Kh=za.TableReader.Lx(bb);-1!==ob.Kh&&ob.Kh||(ob.Kh=ob.isRtl?3:1);return 32};this.z2e=(bb,Jb,Eb,hb,ob)=>{let Va;if(!({Ay:Va}=Ka.a.bgg(Eb,Jb)).returnValue)return Va;
const Qb=Jb.node;switch(bb){case ua.a.FQb:this.rh.tlc(Qb,!1);break;case ua.a.GQb:this.vLi(Jb);this.rh.tlc(Qb,!0);break;case ua.a.N5:Va=l.AFrameworkApplication.va.Nf(Jb.ik,bb,Eb,!0,hb,ob),32===Va&&xa.ParagraphReader.vm(Jb)&&Hb.M4c&&Hb.M4c.tea(Qb)}return 32};this.CYk=(bb,Jb,Eb,hb,ob)=>{const Va={};Va[fb.a.fKa]=6168;Va[fb.a.eKa]=6169;var Qb=Jb.view;const Vb=new Ga.GraphTransaction(1===Eb?3:15);Vb.Db(Qb.root);let Sb=fb.a.Kqa(bb,Jb,Eb,hb,ob,Va,0),nb=null;Qb.Zi&&(nb=Qb);Qb=!0;let ac=null;nb&&(ac=nb.mb.ib.lb)&&
(bb=!Ka.a.rcc(bb),Hb.Yf.SHf(ac,bb)?(Hb.Ic.Yb(sa.a.ef,{["Reason"]:Da.a.cF}),Sb=8,Qb=!1):1===Eb&&(Sb=32,Qb=!1),Hb.ah.xAa(xa.ParagraphReader.OU,nb.mb.qg)&&(Hb.Ic.Yb(sa.a.ef,{["Reason"]:Da.a.AO}),Sb=8,Qb=!1));Qb&&this.zVm(ac)&&(Sb=fb.a.Kqa(ua.a.Zfb,Jb,Eb,hb,ob,Va,12));Vb.dispose();return Sb};this.BYk=(bb,Jb,Eb)=>{bb=!0;Jb.contextId!==S.a.paragraph&&Jb.contextId!==S.a.Uc?bb=!1:Hb.Yf.M4a(Jb)&&(Hb.Ic.Yb(sa.a.vn,{["Reason"]:Da.a.cF}),bb=!1);if(1===Eb||!bb)return bb?32:8;Jb=Jb.node;Eb=new Ga.GraphTransaction(15);
Eb.Db(Jb);Hb.Qn.MIc(Jb);this.Ys.sCb(Jb,!0);this.$u.q8e(Jb);Eb.dispose();return 2};this.aom=(bb,Jb,Eb)=>{bb=!0;Jb.contextId!==S.a.view&&(bb=!1);if(1===Eb&&!bb)return 8;if(!Jb.view||!Jb.view.ue)return 2;Jb=Jb.view;if(!Jb.mb||!Jb.mb.ib.lb)return 8;if(Hb.ah.xAa(xa.ParagraphReader.OU,Jb.mb.qg))return Hb.Ic.Yb(sa.a.ef,{["Reason"]:Da.a.AO}),8;Jb=Jb.mb.ib;for(const hb of Jb)for(const ob of hb)if(ob&&ob.contextId!==S.a.Fd&&ob.contextId!==S.a.Uc&&ob.contextId!==S.a.paragraph&&ob.contextId!==S.a.Vc)return 2;
return 32};this.U6a=(bb,Jb,Eb,hb,ob)=>{bb=!0;Jb.contextId!==S.a.paragraph&&(bb=!1);if(1===Eb&&!bb)return 8;ob.Lt||(Jb=Jb.node,Eb=this.ep.ijb(Jb),ob.Lt=Eb,Jb=V.OutlineElementNavigator.El(Jb),ob.isRtl=Jb?Y.OutlineElementReader.Pn(Jb):!1);return 32};this.dNn=(bb,Jb,Eb,hb,ob)=>{Jb=Jb.node;bb=V.OutlineElementNavigator.El(Jb);ob.Lt||(Jb=this.g9l(Jb),Jb=this.ep.ijb(Jb),ob.Lt=Jb,ob.isRtl=Y.OutlineElementReader.isRtl(bb));return 32};this.R3j=Ua;this.Daa=Ya;this.f7=Fb;this.Lo=Wa;this.De=yb;this.Md=Yb;this.Ys=
qc;this.zW=Hc;this.$u=Ub;this.qz=$b;this.rh=mc;this.ep=ab}get v1(){return null!=this.qGg?this.qGg:this.qGg=x.a.instance.Oa("Box4.UI.RecentColorsSectionHandler")}get oPd(){return!!this.f7&&this.f7.enabled}Tb(){const Ua=l.AFrameworkApplication.va,Ya=this.cMn;(Hb.Zb?Hb.Zb.TB(42):l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled"))?(Ua.ra(ua.a.font,S.a.Vc,this.RT),Ua.ra(ua.a.WA,S.a.Vc,this.RT),Ua.ra(ua.a.u0,S.a.Vc,this.RT),Ua.ra(ua.a.L1,S.a.Vc,this.RT),Ua.ra(ua.a.Yv,
S.a.Vc,this.RT),Ua.ra(ua.a.sra,S.a.Vc,this.RT),Ua.ra(ua.a.Jga,S.a.Vc,this.RT),Ua.ra(ua.a.lZ,S.a.Vc,this.RT),Ua.ra(ua.a.H$,S.a.Vc,this.RT),Ua.ra(ua.a.fva,S.a.Vc,this.RT),Ua.ra(ua.a.bold,S.a.Vc,this.RT),Ua.ra(ua.a.az,S.a.Vc,this.RT),Ua.ra(ua.a.underline,S.a.Vc,this.RT),Ua.ra(ua.a.fka,S.a.Vc,this.RT),Ua.ra(ua.a.superscript,S.a.Vc,this.RT),Ua.ra(ua.a.subscript,S.a.Vc,this.RT),Ua.ra(ua.a.strikethrough,S.a.Vc,this.RT),Ua.ra(ua.a.Ht,S.a.Vc,this.RT),Ua.ra(ua.a.N5,S.a.Vc,this.RT),Ua.ra(ua.a.LC,S.a.Vc,this.RT)):
Pa.App.cfc&&(Ua.ra(ua.a.font,S.a.Vc,this.Wma),Ua.ra(ua.a.WA,S.a.Vc,this.Wma),Ua.ra(ua.a.Yv,S.a.Vc,this.Wma),Ua.ra(ua.a.sra,S.a.Vc,this.Wma),Ua.ra(ua.a.Jga,S.a.Vc,this.Wma),Ua.ra(ua.a.bold,S.a.Vc,this.Wma),Ua.ra(ua.a.az,S.a.Vc,this.Wma),Ua.ra(ua.a.superscript,S.a.Vc,this.Wma),Ua.ra(ua.a.subscript,S.a.Vc,this.Wma),Ua.ra(ua.a.strikethrough,S.a.Vc,this.Wma),Ua.ra(ua.a.Ht,S.a.Vc,this.Wma),Ua.ra(ua.a.u0,S.a.Vc,this.Wma),Ua.ra(ua.a.L1,S.a.Vc,this.Wma));const Fb=Pa.App.lVa.wKc(Wa=>va.OutlineElementGeneralizer.Aha(Wa.ib,
!0));Ua.fb(ua.a.r7e,S.a.view,this.aom,100);Ua.fb(ua.a.ecd,S.a.Fd,this.ecd,1028);Ua.ra(ua.a.R6a,S.a.view,this.N5i);Ua.ra(ua.a.d5c,S.a.view,this.N5i);Ua.ra(ua.a.Uqa,S.a.view,Fb);Ua.ra(ua.a.Uqa,S.a.paragraph,this.Uqa);Ua.ra(ua.a.Uqa,S.a.image,this.TLn);Ua.ra(ua.a.Uqa,S.a.unsupportedObject,Ya);Ua.ra(ua.a.Uqa,S.a.table,this.cNn);Ua.ra(ua.a.U6a,S.a.view,Fb);Ua.ra(ua.a.U6a,S.a.paragraph,this.U6a);Ua.ra(ua.a.U6a,S.a.table,this.dNn);Ua.Xc(ua.a.R6a,99);Ua.Xc(ua.a.d5c,1127);Ua.Xc(ua.a.Uqa,97);Ua.Xc(ua.a.U6a,
97);this.tM(Ua,ua.a.font);this.tM(Ua,ua.a.WA);this.tM(Ua,ua.a.u0);this.tM(Ua,ua.a.L1);Ua.Neb(ua.a.e2h,S.a.view,this.h2e);Ua.Xc(ua.a.e2h,1092);this.tM(Ua,ua.a.Yv);this.tM(Ua,ua.a.sra);this.tM(Ua,ua.a.Jga);this.tM(Ua,ua.a.lZ);this.tM(Ua,ua.a.H$);this.tM(Ua,ua.a.k0a);this.tM(Ua,ua.a.GDa);this.tM(Ua,ua.a.HDa);this.tM(Ua,ua.a.cva);this.tM(Ua,ua.a.l0a);this.tM(Ua,ua.a.fva);this.tM(Ua,ua.a.bold);Ua.cQb(ua.a.bold,this.yFb);this.tM(Ua,ua.a.az);Ua.cQb(ua.a.az,this.yFb);this.tM(Ua,ua.a.underline);Ua.cQb(ua.a.underline,
this.yFb);this.tM(Ua,ua.a.fka);this.tM(Ua,ua.a.superscript);Ua.cQb(ua.a.superscript,this.yFb);this.tM(Ua,ua.a.subscript);Ua.cQb(ua.a.subscript,this.yFb);this.tM(Ua,ua.a.strikethrough);Ua.cQb(ua.a.strikethrough,this.yFb);this.tM(Ua,ua.a.Ht);Ua.cQb(ua.a.Ht,this.yFb);Ua.fb(ua.a.cRa,S.a.Fd,this.nDd,96);Ua.Neb(ua.a.N5,S.a.view,this.h2e);Ua.ra(ua.a.N5,S.a.paragraph,this.z2e);Ua.ra(ua.a.N5,S.a.Fd,this.nDd);Ua.ra(ua.a.N5,S.a.Uc,this.p2e);Ua.ra(ua.a.LC,S.a.view,this.CYk);Ua.ra(ua.a.LC,S.a.paragraph,this.BYk);
Ua.ra(ua.a.LC,S.a.Fd,this.nDd);Ua.ra(ua.a.LC,S.a.Uc,this.p2e);Ua.Xc(ua.a.LC,1036);Ua.ra(ua.a.Zfb,S.a.Fd,this.Zfb);Ua.ra(ua.a.Zfb,S.a.Uc,this.Zfb);Ua.ra(ua.a.LIc,S.a.view,this.LIc);Ua.ra(ua.a.FQb,S.a.view,Ka.a.lw);Ua.ra(ua.a.FQb,S.a.paragraph,this.z2e);Ua.ra(ua.a.FQb,S.a.unsupportedObject,this.jvh);Ua.Xc(ua.a.FQb,1028);Ua.ra(ua.a.GQb,S.a.view,Ka.a.lw);Ua.ra(ua.a.GQb,S.a.paragraph,this.z2e);Ua.ra(ua.a.GQb,S.a.unsupportedObject,this.jvh);Ua.Xc(ua.a.GQb,1028)}tM(Ua,Ya){Ua.Neb(Ya,S.a.view,this.h2e);Ua.ra(Ya,
S.a.Fd,this.nDd);Ua.ra(Ya,S.a.Uc,this.p2e);Ua.Xc(Ya,1036)}M3k(Ua,Ya){for(const Hc of Ua)for(const $b of Hc){Ua=null;if($b.contextId===S.a.Fd){if(ea.b($b))continue;Ua=[];var Fb=$b.node.qa;if(Fb){var Wa=Fb.length-1;const Ub=$b.cpBegin,mc=$b.cpEnd;let ic=!1;const ab=$b.node.characterData;if(ab&&""!==ab){var yb=ab.substr(Ub,mc-Ub);yb&&""!==yb&&y.a.D$e(yb,0,yb.length)&&(ic=!0)}yb=!1;for(let bb=0;bb<Wa;bb++){var Yb=Fb.J(bb).cp,qc=Fb.J(bb+1).cp;if(Fb.J(bb).formatting&&Math.max(Yb,Ub)<Math.min(qc,mc)){if(ab&&
""!==ab&&(Yb=Yb<Ub?Ub:Yb,qc=ab.substr(Yb,(qc<mc?qc:mc)-Yb),!ic&&y.a.D$e(qc,0,qc.length)))continue;yb=!0;Ua.push(Fb.J(bb).formatting)}else if(yb)break}Fb.J(Wa).formatting&&$b.cpEnd>Fb.J(Wa).cp&&Ua.push(Fb.J(Wa).formatting)}}else if($b.contextId===S.a.paragraph&&!xa.ParagraphReader.OU($b)){if(Ua=[],Fb=$b.node.qa)for(Wa=0;Wa<Fb.length;Wa++)Fb.J(Wa).formatting&&Ua.push(Fb.J(Wa).formatting)}else if($b.contextId===S.a.Vc)Ua=[O.FormattingReader.Yr($b)];else if($b.contextId===S.a.Uc){this.BLn($b,Ya);return}if(Ua&&
0<Ua.length)for(const Ub of Ua)if(O.FormattingReader.kpg(Ya,Ub.cache,$b))return}}BLn(Ua,Ya){if(Ua=O.FormattingReader.Yr(Ua)){Ua=Ua.cache;var Fb=Hb.Bj.KG(z.a.bold,Ua.isBold);Ya.bold=Fb?1:0;Fb=Hb.Bj.KG(z.a.italic,Ua.isItalic);Ya.italic=Fb?1:0;Fb=Hb.Bj.KG(z.a.underline,Ua.isUnderline);Ya.underline=Fb?1:0;Ya.underlineType=Hb.Bj.KG(z.a.underlineType,Ua.underlineType);Fb=Hb.Bj.KG(z.a.superscript,Ua.isSuperscript);Ya.superscript=Fb?1:0;Fb=Hb.Bj.KG(z.a.subscript,Ua.isSubscript);Ya.subscript=Fb?1:0;Fb=Hb.Bj.KG(z.a.strikethrough,
Ua.isStrikethrough);Ya.strikethrough=Fb?1:0;Fb=Hb.Bj.KG(v.a.Ht,Ua.isDoubleStrikethrough);Ya.Ht=Fb?1:0;Fb=Hb.Bj.KG(z.a.font,Ua.FG);Ya.fontName=Ra.a.A2a(Fb);Ya.Gea=Ua.Ie;Ya.fontSize=Hb.Bj.KG(z.a.fontSize,Ua.fontSize);Ya.fontColor=Hb.Bj.KG(z.a.fontColor,Ua.fontColor);Ya.highlight=Hb.Bj.KG(z.a.highlight,Ua.highlight)}}avo(Ua){return Ua===ua.a.underline||Ua===ua.a.fka||Ua===ua.a.strikethrough||Ua===ua.a.Ht||Ua===ua.a.lZ}static Xqf(Ua){return"string"===typeof Ua?{fontName:Ua,Gea:-1,bold:2,italic:2}:Ua}rX(Ua,
Ya,Fb,Wa){var yb;const Yb=Ua.cpBegin,qc=Ua.cpEnd,Hc=Ua.node;var $b=O.FormattingReader.Yr(Ua);let Ub=Yb;const mc=null===(yb=l.AFrameworkApplication.K)||void 0===yb?void 0:yb.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);yb=Hb.Qd.xg;if(mc&&(yb||Hc.Ms))return!1;if(mb.has(Ya))for(const ic of Hc.qa)if(!(ic.cp<=Yb)){if(ic.cp>=qc)break;ic.formatting&&ic.formatting.cache.fontSize!=$b.cache.fontSize&&($b=this.brf(Ua.node,$b,Ya,Fb,mc?null:Wa),this.Daa.annotateRange(Ua.node,
mc?Hc.qa.v1a(Ub):Ub,mc?Hc.qa.v1a(ic.cp):ic.cp,$b),Ub=ic.cp,$b=ic.formatting)}Ya=this.brf(Ua.node,$b,Ya,Fb,mc?null:Wa);this.Daa.annotateRange(Ua.node,mc?Hc.qa.v1a(Ub):Ub,mc?Hc.qa.v1a(qc):qc,Ya);return!0}brf(Ua,Ya,Fb,Wa,yb){const Yb={},qc=Object(G.a)(24,Wa),Hc=Ya.cache;switch(Fb){case ua.a.bold:2===Wa.value&&(Wa.value=Hc.isBold?0:1);Yb[z.a.bold.id]=1===Wa.value;break;case ua.a.az:2===Wa.value&&(Wa.value=Hc.isItalic?0:1);Yb[z.a.italic.id]=1===Wa.value;break;case ua.a.underline:2===Wa.value&&(Wa.value=
Hc.isUnderline?0:1);Yb[z.a.underline.id]=1===Wa.value;break;case ua.a.fka:Yb[z.a.underlineType.id]=Wa.number;break;case ua.a.superscript:2===Wa.value&&(Wa.value=Hc.isSuperscript?0:1);Yb[z.a.superscript.id]=1===Wa.value;1===Wa.value&&(Yb[z.a.subscript.id]=!1);break;case ua.a.subscript:2===Wa.value&&(Wa.value=Hc.isSubscript?0:1);Yb[z.a.subscript.id]=1===Wa.value;1===Wa.value&&(Yb[z.a.superscript.id]=!1);break;case ua.a.strikethrough:6!==l.AFrameworkApplication.va.MC?F.ULS.sendTraceTag(529090079,340,
50,"User used strikethrough from ribbon"):F.ULS.sendTraceTag(529090080,340,50,"User used strikethrough from keyboard shortcut");2===Wa.value&&(Wa.value=Hc.isStrikethrough?0:1);Yb[z.a.strikethrough.id]=1===Wa.value;break;case ua.a.Ht:2===Wa.value&&(Wa.value=Hc.isDoubleStrikethrough?0:1);Yb[v.a.Ht.id]=1===Wa.value;break;case ua.a.font:if(qc&&qc.vd){const {fontName:Ub,Gea:mc,bold:ic,italic:ab}=Hb.Xqf(qc.vd);Wa=Ub.substr(0,Hb.UNi);this.oPd&&(Yb[H.a.UT.id]=Wa,Yb[H.a.QC.id]=Wa,Yb[H.a.Y_.id]=Wa,Yb[H.a.x0.id]=
Wa,Yb[H.a.Le.id]=mc,Yb[H.a.Ye.id]=mc,Yb[H.a.Ke.id]=mc,Yb[H.a.Me.id]=mc);Yb[z.a.font.id]=Wa;Yb[H.a.Ie.id]=mc;if(Object(ta.a)()){Wa=1==ic;var $b=1==ab;if(Wa||$b)Yb[z.a.bold.id]=Wa,Yb[z.a.italic.id]=$b}}break;case ua.a.Yv:Wa=hc.a.instance.nva(Ua,Wa);Yb[z.a.fontColor.id]=Wa;break;case ua.a.sra:$b=hc.a.instance.nva(Ua,Wa);Yb[z.a.fontColor.id]=$b;this.v1.w_a(Wa)||F.ULS.sendTraceTag(529006977,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ua.a.Jga:Yb[z.a.fontColor.id]=cc.a.auto;
break;case ua.a.lZ:Yb[z.a.highlight.id]=parseInt(Wa,16);break;case ua.a.H$:Yb[z.a.highlight.id]=parseInt(Wa,16);this.v1.w_a(Wa)||F.ULS.sendTraceTag(529006978,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ua.a.fva:Yb[z.a.highlight.id]=cc.a.auto;break;case ua.a.WA:Yb[z.a.fontSize.id]=this.De.o5b(qc.vd);break;case ua.a.u0:Yb[z.a.fontSize.id]=this.X0l(Hc.fontSize);break;case ua.a.L1:Yb[z.a.fontSize.id]=this.hVl(Hc.fontSize);break;case ua.a.cRa:if(Wa=null===($b=Hb.gA)||
void 0===$b?void 0:$b.cRa)for(const Ub of Wa.xl())Yb[Ub.id]=Wa.wf(Ub);break;case ua.a.LC:if(Wa=Ya.Jn)for(const Ub of Wa.xl())Yb[Ub.id]=null;Yb[H.a.rCb.id]=!0;break;case ua.a.GDa:case ua.a.HDa:case ua.a.k0a:case ua.a.cva:case ua.a.l0a:Hc.zQa&&2===Hc.capitalization&&(Yb[v.a.capitalization.id]=0)}null!=yb&&(Yb[l.AFrameworkApplication.anf]=yb);return Yb}X0l(Ua){Ua=this.De.u0(Ua);return this.De.o5b(Ua)}hVl(Ua){Ua=this.De.L1(Ua);return this.De.o5b(Ua)}Zkc(Ua,Ya,Fb,Wa){var yb=Ua.cache;const Yb=Object(G.a)(24,
Fb);switch(Ya){case ua.a.bold:2===Fb.value&&(Fb.value=yb.isBold?0:1);this.De.HL(Ua,1===Fb.value);break;case ua.a.az:2===Fb.value&&(Fb.value=yb.isItalic?0:1);this.De.az(Ua,1===Fb.value);break;case ua.a.underline:2===Fb.value&&(Fb.value=yb.isUnderline?0:1);this.De.Q5(Ua,1===Fb.value);break;case ua.a.fka:this.De.fka(Ua,Fb);break;case ua.a.superscript:2===Fb.value&&(Fb.value=yb.isSuperscript?0:1);this.De.vra(Ua,1===Fb.value);break;case ua.a.subscript:2===Fb.value&&(Fb.value=yb.isSubscript?0:1);this.De.OIa(Ua,
1===Fb.value);break;case ua.a.strikethrough:6!==l.AFrameworkApplication.va.MC?F.ULS.sendTraceTag(539305613,340,50,"User used strikethrough from ribbon"):F.ULS.sendTraceTag(539305614,340,50,"User used strikethrough from keyboard shortcut");2===Fb.value&&(Fb.value=yb.isStrikethrough?0:1);this.De.dka(Ua,1===Fb.value);break;case ua.a.Ht:2===Fb.value&&(Fb.value=yb.isDoubleStrikethrough?0:1);this.De.Kge(Ua,1===Fb.value);break;case ua.a.font:if(Yb&&Yb.vd){const {fontName:qc,Gea:Hc,bold:$b,italic:Ub}=Hb.Xqf(Yb.vd);
this.De.$ja(Ua,qc.substr(0,Hb.UNi));this.De.Reg(Ua,Hc);Object(ta.a)()&&(Fb=1==$b,Wa=1==Ub,Fb||Wa)&&(this.De.HL(Ua,Fb),this.De.az(Ua,Wa))}break;case ua.a.Yv:F.ULS.sendTraceTag(595153825,340,50,"Font color is selected from Standard/Theme colors.");this.De.Yv(Ua,Fb,null);break;case ua.a.sra:this.De.Yv(Ua,Fb,null);this.v1.w_a(Fb)||F.ULS.sendTraceTag(594899727,340,50,"Color selected from Recent Colors section. Menu: Font");break;case ua.a.Jga:this.De.Jga(Ua);break;case ua.a.lZ:F.ULS.sendTraceTag(594899726,
340,50,"Font background color is selected from Standard colors.");this.De.Gza(Ua,Fb);break;case ua.a.H$:this.De.Gza(Ua,Fb);this.v1.w_a(Fb)||F.ULS.sendTraceTag(594899724,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ua.a.fva:this.De.qGd(Ua);break;case ua.a.WA:this.De.WA(Ua,Yb.vd);break;case ua.a.u0:this.De.Zli(Ua);break;case ua.a.L1:this.De.ytj(Ua);break;case ua.a.N5:yb=Fb.ja(H.a.noProof,!1);this.De.Tdg(Ua,Fb.getValue(z.a.uL),Wa,yb);break;case ua.a.cRa:this.De.Sge(Ua);
break;case ua.a.LC:this.De.Iga(Ua);break;case ua.a.GDa:case ua.a.HDa:case ua.a.k0a:case ua.a.cva:case ua.a.l0a:yb.zQa&&2===yb.capitalization&&this.De.oYk(Ua)}}A0n(Ua,Ya){ua.a.LC===Ya&&V.OutlineElementNavigator.El(Ua).properties.removeProperty(z.a.n1)}Fsm(Ua,Ya){return this.Bvh(Ua,Ya)||this.Bvh(Ya,Ua)}Bvh(Ua,Ya){return(1===Ua.specialIndentType||!Ua.specialIndentType)&&2===Ya.specialIndentType}g9l(Ua){Ua=N.GraphIterator.eb(Ua);Ua.zb(11);Z.moveToCell(Ua,0,0);Ua.Rd();Ua.iY();return Ua.currentNode}zVm(Ua){return!Ua||
qa.SelectionEditor.Pl(Ua)||1===Ua.length&&qa.SelectionEditor.vl(Ua.Pa)&&!qa.SelectionEditor.elb(Ua.Pa)?!1:!0}vLi(Ua){Hb.Geh.nb(Ua.contextId)||(F.ULS.sendTraceTag(42276747,340,50,"RTL Usage : {0}",Ua.contextId),Hb.Geh.Z(Ua.contextId,!0))}mJm(Ua){return Ua===ua.a.k0a||Ua===ua.a.GDa||Ua===ua.a.HDa||Ua===ua.a.cva||Ua===ua.a.l0a}KFd(Ua,Ya){const Fb=Ua.node,Wa=Fb.characterData.substr(Ua.cpBegin,Ua.cpEnd-Ua.cpBegin);this.bmb.set("Command",Ya.toString());m.Health.instance.recordKpiUsage(this.kpiName,1,this.S8,
this.bmb);Ya=Hb.rJo(Wa,Ya);Fb.qra(Fb.characterData.substr(0,Ua.cpBegin)+Ya+Fb.characterData.substr(Ua.cpEnd));return 32}static get Bj(){return Hb.gA||(Hb.gA=x.a.instance.resolve("Box4.IInsertionPointFormatting"))}static ix(){return Hb.en||(Hb.en=x.a.instance.Ta("Box4.IExternalSelectionManager"))}static get ah(){return ia.ContextSetEditor.instance}static get Yf(){return Oa.a.instance}static get Ic(){return t.a.instance}static get Zb(){return null!=Hb.xzg?Hb.xzg:Hb.xzg=x.a.instance.Oa("Box4.IFeatureHelper")}static get M4c(){return Pa.App.zN}static get Qd(){return null!=
Hb.$Ig?Hb.$Ig:Hb.$Ig=x.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Ej(){return null!=Hb.BIg?Hb.BIg:Hb.BIg=x.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Eea(){return null!=Hb.eIg?Hb.eIg:Hb.eIg=x.a.instance.resolve("Box4.TextFormattingHelper")}static get Jd(){return null!=Hb.AEg?Hb.AEg:Hb.AEg=x.a.instance.resolve("Box4.List.IListReader")}static get Qn(){return null!=Hb.mEg?Hb.mEg:Hb.mEg=x.a.instance.resolve("Box4.List.IListEditor")}static get Uf(){return ba.a.instance}static vUl(Ua,
Ya){return 42===Ua?Ya:Ua!==Ya||16===Ua?16:Ua}static ksh(Ua,Ya){Ua.Iwi||(Ya.Iwi?Ya=Ua:Ya.unit===Ua.unit&&k.a.Cxa(Ya.value,Ua.value)||(Ya.value=-1));return Ya}static rJo(Ua,Ya){switch(Ya){case ua.a.GDa:return Ua.toLowerCase();case ua.a.HDa:return 6!==l.AFrameworkApplication.va.MC?F.ULS.sendTraceTag(539305615,340,50,"User changed the case via ribbon"):F.ULS.sendTraceTag(539305616,340,50,"User changed the case from keyboard shortcut"),Ua.toUpperCase();case ua.a.k0a:case ua.a.cva:return Hb.cVk(Ua,Ya===
ua.a.cva);case ua.a.l0a:return Hb.ILo(Ua);default:return Ua}}static ILo(Ua){let Ya="";for(let Fb=0;Fb<Ua.length;Fb++)Ya=Ua.charAt(Fb)===Ua.charAt(Fb).toUpperCase()?Ya+Ua.charAt(Fb).toLowerCase():Ya+Ua.charAt(Fb).toUpperCase();return Ya}static cVk(Ua,Ya){let Fb,Wa,yb=!0,Yb=Ua.length,qc=0,Hc=Hb.lIf(Ua,qc,Yb);for(;0<Yb;){Wa=Fb=!1;var $b=Yb;let mc;var Ub=void 0;for(Ub=0;0<$b&&Hb.zXk(Ua.charAt(qc+Ub));Ub++,$b--)Wa=Hb.Q0d(Ua.charAt(qc+Ub));for(mc=Ub;0<$b&&!(Fb=Hb.Q0d(Ua.charAt(qc+Ub)))&&" "!==Ua.charAt(qc+
Ub)&&"/"!==Ua.charAt(qc+Ub);Ub++,$b--);$b=Ub-mc;if(0>=$b)break;qc+=mc;Ub=Ua.substr(qc,$b);Ub=Ub===Ub.toUpperCase();if(Hc||!Ub)Ua=yb||Wa||Ya?Ua.substr(0,qc)+Ua.charAt(qc).toUpperCase()+Ua.substr(qc+1,$b-1).toLowerCase()+Ua.substr(qc+$b):Ua.substr(0,qc)+Ua.substr(qc,$b).toLowerCase()+Ua.substr(qc+$b);Yb-=$b+mc;qc+=$b;if(yb=Fb)qc++,Yb--,Hc=Hb.lIf(Ua,qc,Yb)}return Ua}static lIf(Ua,Ya,Fb){for(;0<Fb&&!Hb.Q0d(Ua.charAt(Ya));){if(Ua.charAt(Ya)!==Ua.charAt(Ya).toUpperCase())return!1;Ya++;Fb--}return!0}static uVm(Ua,
Ya){for(var Fb=0;0<Ya&&!Hb.Q0d(Ua.charAt(Fb));){if(Ua.charAt(Fb)!==Ua.charAt(Fb).toLowerCase())return!1;Fb++;Ya--}return!0}static Q0d(Ua){return"."===Ua||"!"===Ua||"?"===Ua?!0:!1}static zXk(Ua){return-1==="0123456789".indexOf(Ua)&&Ua.toUpperCase()===Ua.toLowerCase()}static H1h(){const Ua=x.a.instance.Ta("Common.ISystemInitiatedFeedback");Ua&&Ua.execute(Ya=>{Ya.logActivity("FontsSurveyActivity","FontsFloodgateSurvey")})}}Hb.Geh=new L.a;Hb.gA=null;Hb.en=null;Hb.UNi=31;Object(D.a)(Hb,"TextFormattingActor",
null,[])},2060:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);var l;(function(e){e[e.none=0]="none";e[e.heading1=1]="heading1";e[e.heading2=2]="heading2";e[e.heading3=3]="heading3";e[e.heading4=4]="heading4";e[e.heading5=5]="heading5";e[e.heading6=6]="heading6";e[e.citation=7]="citation";e[e.maxParagraphStyle=7]="maxParagraphStyle"})(l||(l={}));Object(D.b)("ParagraphStyle",l)},2061:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);var l;(function(e){e[e.unspecified=0]="unspecified";e[e.none=
1]="none";e[e.defaultUnordered=2]="defaultUnordered";e[e.disc=3]="disc";e[e.circle=4]="circle";e[e.square=5]="square";e[e.defaultOrdered=6]="defaultOrdered";e[e.decimal=7]="decimal";e[e.lowerAlpha=8]="lowerAlpha";e[e.lowerRoman=9]="lowerRoman";e[e.upperAlpha=10]="upperAlpha";e[e.upperRoman=11]="upperRoman"})(l||(l={}));Object(D.b)("ListStyleType",l)},2063:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.email=this.fullName="";this.resolveState=0}}Object(D.a)(l,"AtMentionAttributes",
null,[])},2070:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);var l;(function(e){e[e.initial=0]="initial";e[e.startSearch=1]="startSearch";e[e.searching=2]="searching";e[e.searchComplete=3]="searchComplete";e[e.replaceAllInProgress=4]="replaceAllInProgress";e[e.replaceAllComplete=5]="replaceAllComplete";e[e.tooManyResults=6]="tooManyResults";e[e.noMatchesFound=7]="noMatchesFound"})(l||(l={}));Object(D.b)("FindReplaceViewType",l)},2072:function(D,I,c){c.d(I,"a",function(){return l});var l;
(function(e){e[e.initial=0]="initial";e[e.headings=1]="headings";e[e.find=2]="find";e[e.replace=3]="replace";e[e.intelligentPlaceholder=4]="intelligentPlaceholder";e[e.contracts=5]="contracts"})(l||(l={}))},2089:function(D,I,c){function l(b,h){h=Object.assign(new ha.a,{name:"LinkType",string:h});e(Nb.a.ODm,b,[h])}function e(b,h,r,B=!0){h&&h.UILocation&&Object(Ke.d)(b,B,Ke.e,0,h.UILocation,0,r)}function a(b,h){const r=Ma.a.instance;return new RB(b,h,r.Ve("WordEditor.TableOfContents.StyleBasedDocumentHeadings").value,
r.Ve("WordEditor.Bookmark.FullBookmarkManager").value,r.resolve("Box4.IHyperlinkStrategy"),r.resolve("Box4.IHyperlinkEditor"),r.resolve("Box4.ICharacterPropertiesEditor"),r.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,r.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,Wq.a.instance,r.Oa("Box4.IInternalLinkManager"))}function k(b,h){var r;return b===et.none?"none":null===(r=Zt[b])||void 0===r?void 0:r[h]}function x(){const b=Ma.a.instance.Oa("WordEditor.Gc2Inline.IWordEditHostFactory");
void 0===b&&t.ULS.sendTraceTag(509694672,322,10,"getEditHostFactory: Failed to resolve edit host factory from container.");return b}function y(){const b=Ma.a.instance.Oa("WordEditor.Gc2Inline.IGc2ClassFactory");void 0===b&&t.ULS.sendTraceTag(509224267,322,10,"getGC2ClassFactory: Failed to resolve GC2 class factory from container.");return b}c.r(I);var m=c(0),t=c(7),z=c(54),v=c(2),H=c(34),F=c(19),G=c(167),M=c(87);class K{constructor(b){this.Dmg=0;this.aIb=this.Cic=this.QUa=null;this.nS=v.AFrameworkApplication.ua.Lq;
this.pY=b;this.pY.Fv(M.a.mlj);this.pY.eC(M.a.mlj,Object(z.a)(this,this.Osn,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.aIb)return t.ULS.sendTraceTag(589050652,344,100,"Returning existing promise"),this.aIb;this.QUa=this.nS.Zf("ComponentAttach","getCustomAuthConfig");return this.aIb=new Promise((b,h)=>{const r={};let B=!1,P=!1,ca=0;this.Dmg=window.setInterval(()=>{4>ca?(ca++,this.pY.sendMessage(M.a.getCustomAuthConfig,r)):(window.clearInterval(this.Dmg),B=!0,t.ULS.sendTraceTag(588087303,
344,10,H.c({["error"]:"Request timeout after 4 retries."})),h("Request timeout."))},1E3);this.Cic=(ra,Qa)=>{window.clearInterval(this.Dmg);B||P||(P=!0,ra?(t.ULS.sendTraceTag(589050653,344,50,"Resolving Promise with authConfig"),b(ra)):(t.ULS.sendTraceTag(589050654,369,10,H.c({["error"]:Qa.toString()})),h(Qa)))};this.pY.sendMessage(M.a.getCustomAuthConfig,r)})}Osn(b){try{const h=H.a(b.Values[G.a.qQk]);let r=v.AFrameworkApplication.K.kb("Application")||"";r=F.a.eh(r);h.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+
r+"%3Facctsw%3D1&prompt=select_account";h.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1";h.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1&prompt=select_account";h.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+r+"%3Facctsw%3D1";this.QUa&&(this.QUa.stop(),this.QUa=null);this.Cic(h,"")}catch(h){t.ULS.sendTraceTag(589050655,344,10,H.c({["error"]:h.message,["stack"]:h.stack})),this.Cic(null,h.message)}}}Object(m.a)(K,"AccountSwitchingManager",
null,[149]);var L=c(185);class R{get name(){return"Common.App.AccountSwitching"}wc(b){b.register(K,"Common.App.AccountSwitching.AccountSwitchingManager").as("Common.App.AccountSwitching.IAccountSwitching").ha().Ud(()=>new K(b.resolve("Postmessage.IHostPostmessenger")))}init(){}dispose(){}static main(){L.a.instance.Gc(new R)}}Object(m.a)(R,"AccountSwitchingPackage",null,[1,2]);var S;(function(b){b[b.generalException=0]="generalException";b[b.invalidArgument=1]="invalidArgument";b[b.notAllowed=2]="notAllowed";
b[b.apiNotAvailable=3]="apiNotAvailable";b[b.unresolvedPendingRequest=4]="unresolvedPendingRequest";b[b.timeout=5]="timeout";b[b.adalTimeout=6]="adalTimeout";b[b.userNotSignedIn=7]="userNotSignedIn";b[b.userAborted=8]="userAborted";b[b.silentSignInFailed=9]="silentSignInFailed";b[b.invalidResourceUrl=10]="invalidResourceUrl";b[b.invalidGrant=11]="invalidGrant";b[b.connectionLost=12]="connectionLost";b[b.clientError=13]="clientError";b[b.serverError=14]="serverError"})(S||(S={}));Object(m.b)("ErrorCodes",
S);c(1834);class N{constructor(b,h){this.requestCallback=this.requestParameters=null;this.requestParameters=b;this.requestCallback=h}}Object(m.a)(N,"OutstandingRequest",null,[]);class O{}O.yhn="AADSTS50058";O.invalidResourceUrl="AADSTS50001";O.rhn="AADSTS65001";O.ein="AADSTS70011";O.userAborted="13002";O.dFn="Popup Window is null";O.cFn="Popup Window closed";O.adalTimeout="Token renewal operation failed due to timeout";O.RLo="tokenRevoked";Object(m.a)(O,"WopiHostErrorType",null,[]);var W=c(466),V=
c(60),Q=c(1833);class Y{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(m.a)(Y,"WopiIdentityInfo",null,[755]);class ba{constructor(b,h,r){this.expiration=this.authority=this.accessToken=null;this.accessToken=b;this.authority=h;this.expiration=r}}Object(m.a)(ba,"WopiIdentityToken",null,[754]);var Z=c(20),ea=c(190),ha=c(31),ka=c(175);class ua{constructor(b){this._initialized=!1;this.yhc={};this.zke={};this.nS=v.AFrameworkApplication.ua.Lq;
this.cAf=b}Nhb(b){this._initialized||(b.Fv(M.a.uic),b.eC(M.a.uic,Object(z.a)(this,this.Nsn,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(b,h,r=null){this.KY(b,h);return new Promise((B,P)=>{if(this.tDf(h))if(h in this.yhc)P("unresolvedPendingRequest");else{var ca=window.setTimeout(()=>{t.ULS.sendTraceTag(37856032,344,10,H.c({["error"]:"Request timeout.",["callerId"]:h}));P("timeout")},12E4);this.Mnf(b,h,r,(ra,Qa)=>{window.clearTimeout(ca);ra?B(ra):(t.ULS.sendTraceTag(37856033,369,
15,H.c({["error"]:S[Qa]})),P(Qa))})}else t.ULS.sendTraceTag(37856034,344,10,H.c({["error"]:"Caller is not allowed."})),P("notAllowed")})}getPrimaryIdentityInfo(b){return new Promise((h,r)=>{this.tDf(b)?this.lam((B,P)=>{B?h(B):(t.ULS.sendTraceTag(37856064,369,10,H.c({["error"]:P.toString()})),r(P))}):(t.ULS.sendTraceTag(37856065,344,10,H.c({["error"]:"Caller is not allowed."})),r("notAllowed"))})}getAuthContext(b){return new Promise((h,r)=>{const B=this.getAuthContextSync(b);B?h(B):r("notAllowed")})}getAuthContextSync(b){if(this.tDf(b)){const h=
new Q.a;h.upn=v.AFrameworkApplication.K.kb("UserPrincipalName");h.userId=v.AFrameworkApplication.K.kb("LoggableUserId");h.authority=v.AFrameworkApplication.K.kb("HostAuthAuthority");h.tenantId=v.AFrameworkApplication.K.kb("TenantId");h.isAnonymous=v.AFrameworkApplication.K.$("IsAnonymousUser");h.supportsAuthToken=this.Qvm(b);b=v.AFrameworkApplication.K.kb("HostAuthType");h.authorityType="aad"===b.toLowerCase()?2:"msa"===b.toLowerCase()?1:0;return h}t.ULS.sendTraceTag(40751647,344,10,H.c({["error"]:"Caller is not allowed."}));
return null}Qvm(b){const h=W.OAuthManagerSettings.MTc;return Z.a.NRa?h&&W.OAuthManagerSettings.Gyj?Array.contains(W.OAuthManagerSettings.Gyj,b.toLowerCase()):!1:h}Mnf(b,h,r,B){var P=[];Array.add(P,Object.assign(new ha.a,{name:"CallerId",string:h}));Array.add(P,Object.assign(new ha.a,{name:G.a.Xig,string:b.correlationId}));ea.a.sendTelemetryEvent(Object.assign(new ka.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:P}));P=V.a.create().toString();const ca="getAccessToken_"+
P,ra=this.nS.Zf("ComponentAttach",ca);this.zke[ca]=ra;const Qa={};Qa[G.a.Yig]=P;Qa[G.a.iCo]=b.resource;Qa[G.a.jCo]=b.scope;Qa[G.a.mvj]=v.AFrameworkApplication.K.kb("HostAuthType");Qa[G.a.mCo]=v.AFrameworkApplication.K.kb("UserPrincipalName");Qa[G.a.kCo]=b.silentLogin;Qa[G.a.fCo]=b.options;Qa[G.a.Xig]=b.correlationId;Qa[G.a.gCo]=h;r&&(Qa[G.a.addinName]=r.AddinName,Qa[G.a.eCo]=r.AddinTrustId);this.cAf.execute(tb=>{this.Nhb(tb);tb.sendMessage(M.a.getAuthToken,Qa)});this.yhc[P]=new N(b,B)}lam(b){const h=
v.AFrameworkApplication.K.kb("UserName"),r=v.AFrameworkApplication.K.kb("UserPrincipalName"),B=v.AFrameworkApplication.K.kb("LoggableUserIdSpace"),P=new Y;P.email=r;P.displayName=h;switch(B){case "OrgIdPuid":P.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":P.authority="MicrosoftAccount";break;default:P.authority=B}b(P,null)}Nsn(b){let h=null;try{let B=b.Values[G.a.Yig];const P=b.Values[G.a.dCo],ca=b.Values[G.a.mvj],ra=b.Values[G.a.lCo];let Qa=null,tb=null;const Mb=this.yhc[B];
if("undefined"!==typeof Mb&&Mb){var r=[];Array.add(r,Object.assign(new ha.a,{name:G.a.Xig,string:Mb.requestParameters.correlationId}));ea.a.sendTelemetryEvent(Object.assign(new ka.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:r}));h=Mb.requestCallback;delete this.yhc[B];"undefined"!==typeof P&&P&&P.length?tb=new ba(P,ca,ra):Qa=S[this.C$m(b)];r="getAccessToken_"+B;r in this.zke&&(this.zke[r].stop(),delete this.zke[r]);h(tb,Qa)}else t.ULS.sendTraceTag(37856066,
344,10,H.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:B}))}catch(B){b=b.Values[G.a.Yig],b in this.yhc&&delete this.yhc[b],this.b3d(),t.ULS.sendTraceTag(37856067,344,10,H.c({["error"]:B.message,["stack"]:B.stack})),h&&h(null,"generalException")}}tDf(b){var h=v.AFrameworkApplication.kmm();b=b.toLowerCase();for(const r of h)if(b===r.toLowerCase())return!0;h=W.OAuthManagerSettings.Q1e;for(let r in h)if(b===h[r].toLowerCase())return!0;return!1}C$m(b){b=b.Values[G.a.hCo];
this.b3d();t.ULS.sendTraceTag(39068821,344,15,H.c({["error"]:b}));return b?-1<b.indexOf(O.yhn)?9:-1<b.indexOf(O.dFn)||-1<b.indexOf(O.cFn)?12:-1<b.indexOf(O.invalidResourceUrl)?10:-1<b.indexOf(O.userAborted)?8:-1<b.indexOf(O.ein)||-1<b.indexOf(O.rhn)||b===O.RLo?11:-1<b.indexOf(O.adalTimeout)?6:0:13}KY(b,h){b=this.ZTn(b.resource);t.ULS.sendTraceTag(39921882,344,50,H.c({["callerId"]:h,["resource"]:b}))}b3d(){t.ULS.sendTraceTag(39068822,344,50,H.c({["userAgent"]:window.navigator.userAgent}))}ZTn(b){return(b?
b:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(m.a)(ua,"WopiIdentityManager",null,[718]);class sa{constructor(){this.W=null}get name(){return"Common.App.WopiIdentity"}wc(b){this.W=b;b.register(ua,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").ha().Ud(()=>new ua(b.Ta("Postmessage.IHostPostmessenger")))}init(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.Nn(Object(z.a)(this,this.Xx,"onFullAppSettingsReady"))}Xx(){try{this.W.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(b){t.ULS.sendTraceTag(571074327,
383,10,"Failed to initialize WopiIdentityPackage with exception: "+b)}}dispose(){}static main(){L.a.instance.Gc(new sa)}}Object(m.a)(sa,"WopiIdentityPackage",null,[1,2]);var Da=c(503),Pa=c(359),Ra=c(69),Ga;(function(b){b[b.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";b[b.cloudPolicySettings=1]="cloudPolicySettings";b[b.alternateAuthToken=2]="alternateAuthToken"})(Ga||(Ga={}));Object(m.b)("ApplicationFeatureHelperRequestType",Ga);class ta{constructor(){this.message=null;this.httpStatusCode=
0}}Object(m.a)(ta,"HttpRequstToPromiseRejectData",null,[]);var va=c(86),ia=c(45),qa=c(201),pa=c(765);class Fa{constructor(b,h){this.Ca=b;this.$f=h}EKc(b,h,r,B=null,P=null,ca=null,ra=null,Qa=null){const tb=Ga[r],Mb=tb+"RequestFailure";va.Health.instance.recordKpiUsage(Mb,0,"jpittsdirects",null);return new Promise((Zb,jc)=>{t.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",tb);const Gc=null!=ra?ra:this.Ca.mc("ApplicationFeatureHelperRequestQueueTimeout",
15E3),Uc=null!=Qa?Qa:this.Ca.mc("ApplicationFeatureHelperRequestSentTimeout",3E4);this.$f.QAb(b,1,null,this.nrf(r,B),ca,1,od=>{t.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",tb);try{if(void 0===od||null===od||void 0===od.data||null===od.data||void 0===od.data.se||null===od.data.se){va.Health.instance.recordKpiFailure(Mb,"Invalid RequestSucceededEventArgs",!1,!0,null);let ze=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
tb);jc(this.FFa(ze,od))}else if(od.data.Se!==qa.a.Zz){va.Health.instance.recordKpiFailure(Mb,"HttpStatusCode_"+od.data.Se.toString(),!1,!0,null);let ze=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",od.data.Se,tb);jc(this.FFa(ze,od))}else{void 0!==P&&null!==P&&void 0!==od.data.Dj&&null!==od.data.Dj&&P(od.data.Dj);var Od=h(od.data.se);if(Od)t.ULS.sendTraceTag(50622690,3004,50,
"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",tb),Zb(Od);else{va.Health.instance.recordKpiFailure(Mb,"Parse Failure",!1,!0,null);let ze=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",tb);jc(this.FFa(ze,od))}}}catch(ze){va.Health.instance.recordKpiFailure(Mb,"Unexpected Failure",!1,!0,null),Od=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
ze,tb),jc(this.FFa(Od,od))}},od=>{if(od.data){va.Health.instance.recordKpiFailure(Mb,"HttpStatusCode_"+od.data.Se.toString(),!1,!0,null);var Od=pa.a.P$b(od.data.se||"No Data");Od=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",od.data.Se,Od,tb)}else va.Health.instance.recordKpiFailure(Mb,"Invalid RequestFailedEventArgs",!1,!0,null),Od=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",
tb);jc(this.FFa(Od,od))},void 0,void 0,Gc,Uc)})}FFa(b,h){const r=new ta;r.message=b;r.httpStatusCode=h&&h.data?h.data.Se:-1;return r}nrf(b,h){const r={};r["x-UserDataSignature"]=this.Ca.kb("UserDataSignature");r["x-LicensingIsEnabled"]=this.Ca.$("LicensingIsEnabled").toString();r["x-CacheIsEnabled"]=this.Ca.$("LicensingRedisIsEnabled").toString();r["x-OcpsIsEnabled"]=this.Ca.$("OcpsIsEnabled").toString();r["x-LicensingAADIdIsEnabled"]=this.Ca.$("LicensingAadIdIsEnabled").toString();0===b&&(r["x-LicenseCheckOnTenantEnabled"]=
"true",r["x-SupportUserConsentDependentFeatures"]="true",r["x-AFHUserConsentGroupValue"]="0",r["x-UseShellServiceForUserConsentGroup"]="true",r["x-SMBUserLicensingEnabled"]="true",r["x-AFHPIPLComplianceEnabled"]=ia.a.kP(window.location.href,"wd_afhpipl")||"false",r["x-ConsumerLicensingSNICertIsEnabled"]=this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ConsumerLicensingSNICertIsEnabled",!1).toString(),r["x-MSGraphInLicensingIsEnabled"]=this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MSGraphInLicensingIsEnabled",
!1).toString());if(h)for(let B of h.keys)r[B]=h.J(B);return r}}Object(m.a)(Fa,"HttpRequestToPromiseUtility",null,[]);var za;(function(b){b[b.loki=0]="loki";b[b.augloopACLP=1]="augloopACLP"})(za||(za={}));Object(m.b)("AlternateAuthSupportApp",za);class Oa{constructor(){this.Token=null;this.ExpirationTime=0}}Object(m.a)(Oa,"WacAlternateAuthToken",null,[]);class xa{constructor(b,h){this.PLo=3E5;if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");
this.Ca=b;this.Jgd=new Da.a(Pa.a.ih());this.ywc=new Fa(b,h);void 0!==W.OAuthManagerSettings.XNf&&null!==W.OAuthManagerSettings.XNf&&void 0!==W.OAuthManagerSettings.J3d&&null!==W.OAuthManagerSettings.J3d&&0<W.OAuthManagerSettings.J3d&&(b=new Oa,b.Token=W.OAuthManagerSettings.XNf,b.ExpirationTime=W.OAuthManagerSettings.J3d,this.Jgd.Z("loki",b))}NNl(){let b=null;this.Jgd.nb(za[0])&&(b=this.Jgd.J(za[0]));return void 0===b||null===b||this.BWm(b)?this.YBl():Promise.resolve(b.Token)}BWm(b){return b.ExpirationTime-
Date.now()<this.PLo}YBl(){const b=new Da.a(Pa.a.ih());b.Z("X-AlternateAuthApp",za[0]);return this.ywc.EKc(this.$ib("/afhs/AlternateAuthHelperHandler.ashx"),Object(z.a)(this,this.JAn,"parseAlternateAuthTokenResponse"),2,b).then(h=>{t.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",za[0]);this.Jgd.Z(za[0],h);return h.Token},h=>{h=Object(Ra.a)(ta,h);t.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",
h.message,h.httpStatusCode);return null})}JAn(b){let h=null;({Gt:h}=H.d(b));t.ULS.sendTraceTag(545821457,3004,h?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",b);return h}$ib(b){const h=this.Ca.$("SuiteOriginForAFHSIsEnabled")?this.Ca.kb("SuiteOrigin"):this.Ca.kb("WebServiceBase");return String.format("{0}{1}?{2}",h,b,v.AFrameworkApplication.em)}}Object(m.a)(xa,"AlternateAuthHelper",null,[698]);var fa=c(612);class Ka{constructor(b,h,r){this.featureName=null;this.isEnabled=
!1;this.tierName=0;this.featureName=b;this.isEnabled=h;this.tierName=r}}Object(m.a)(Ka,"FeatureStateChangeArgs",null,[]);var lb=c(153),Xa=c(205),kb=c(85),Bb=c(139),Ja;(function(b){b[b.Enabled=0]="Enabled";b[b.Disabled=1]="Disabled"})(Ja||(Ja={}));Object(m.b)("FeatureState",Ja);var Ma=c(22),fb=c(13),hc=c(117);class cc{constructor(b,h,r=null,B=null,P=null){this.dib=this.oma=this.Edh=this.pcb=this.Xxd=null;this.ywc=new Fa(b,h);this.Ca=b;this.dak=b.mc("LicensingMaxRetryAttempts",0);this.tpd=b.$("IsO365ConsumerHost");
this.OGe=b.$("IsO365CommercialHost");this.hGe=b.$("PremiumUpsellIsEnabled");this.kYb=!1;this.oJe=0;this.qPg=r;this.Alh=B;this.ga=P;this.ocb=b.$("LicensingIsEnabled");this.wxb=b.$("OcpsIsEnabled")&&this.OGe;this.HXe=b.$("ShowPrivacyDialog")&&!!B;this.$Xb=b.$("IsAnonymousUser");this.$Nd=new Promise(ca=>{ca(!1)});this.Grb=new Promise(ca=>{ca(!0)});this.cib=new Da.a(Pa.a.ih());this.pAd=!0;this.v5g=this.V2l();this.L4a()&&!this.$Xb?(void 0!==v.AFrameworkApplication.ua&&null!==v.AFrameworkApplication.ua&&
(this.Xxd=v.AFrameworkApplication.ua.Lq,void 0!==this.Xxd&&null!==this.Xxd&&(this.pcb=this.Xxd.rSa("WebServiceCall","ApplicationFeatureHelperService"))),this.dib=this.dog()):this.dib=new Promise(ca=>{ca({})});this.dib.catch(ca=>{ca=Object(Ra.a)(ta,ca);t.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",ca?ca.httpStatusCode.toString():"Unknown")});this.pAd&&this.isFeatureEnabled("FreemiumUpsell",!0).then(ca=>{this.kYb=ca;return null})}V2l(){const b=
this.Ca.rw("AllLicensedFeatures")?this.Ca.DB("AllLicensedFeatures"):[],h=new fa.a;for(let r=0;r<b.length;r++)h.add(b[r]);return h}L4a(){return this.OGe||this.tpd}dog(b=0,h=!1){t.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",h);const r=lb.a.vG();r&&(r.set("retryAttempt",b.toString()),r.set("forceRefresh",h.toString()),r.set("isO365ConsumerHost",this.tpd.toString()),r.set("isO365CommercialHost",this.OGe.toString()),r.set("isFreemiumUpsellSettingEnabled",
this.hGe.toString()));va.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",r);va.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",r);void 0!==this.pcb&&null!==this.pcb&&this.pcb.start();let B=null;h&&(B=new Da.a(Pa.a.ih()),B.Z("x-LicensingForceRefresh","true"));this.Edh=new Date;return(this.ocb?this.ywc.EKc(this.$ib("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(z.a)(this,this.NAn,"parseApplicationFeatureHelperResponse"),
0,B,Object(z.a)(this,this.tIn,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(P=>{const ca=Object.assign(new hc.a,{durationMs:this.fwj()});ca.extendedProperties=r;ca.extendedProperties&&P&&(ca.extendedProperties.set("featureCount",kb.a.count(P).toString()),ca.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in P).toString()),ca.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in P).toString()),"FreemiumUpsell"in P&&
ca.extendedProperties.set("isFreemiumUpsellEnabled",P.FreemiumUpsell.toString()),this.oma&&ca.extendedProperties.set("fromCache",(this.oma<this.Edh).toString()));va.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",ca);return P},P=>{const ca=Object.assign(new hc.a,{durationMs:this.fwj()}),ra=Object(Ra.a)(ta,P);if(!ra)return t.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),va.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest",
"InvalidCastToHttpRequestToPromiseRejectData",!1,!0,ca),new Promise((Qa,tb)=>{tb(P)});ca.extendedProperties=r;ca.extendedProperties&&ca.extendedProperties.set("status",ra.httpStatusCode.toString());va.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,ca);return 408===ra.httpStatusCode&&++b<=this.dak?this.dog(b):new Promise((Qa,tb)=>{tb(ra)})})}NAn(b){(b=H.b(b))?(t.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),
t.ULS.sendTraceTag(50938594,3004,50,"{0}",b)):t.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return b.Features}$ib(b){var h=this.Ca.$("SuiteOriginForAFHSIsEnabled")?this.Ca.kb("SuiteOrigin"):this.Ca.kb("WebServiceBase");h=String.format("{0}{1}",h,b);this.Ca.rw("ApplicationFeatureHelperHttpCachingEnabled")&&this.Ca.$("ApplicationFeatureHelperHttpCachingEnabled")&&(b=cc.TSd(this.Ca))&&0<b.length&&(this.pAd&&
(b+="ucbf"),h=new Xa.QueryStringBuilder(h),h.Be("afhskey",b),h=h.toString());return h}isFeatureEnabled(b,h){if(!this.wxb&&!this.HXe&&!this.ocb)return this.Grb;t.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",b);if("ConnectedServices"===b){var r=this.wxb?this.qPg.Z8("ControllerConnectedServicesEnabled"):this.Grb;const ca=this.HXe?this.Alh.getSettings().then(ra=>2!==ra.hJ,()=>h):this.Grb;return r.then(ra=>ra?ca:this.$Nd)}if("FreemiumUpsell"===
b&&(!this.hGe||!this.tpd||this.$Xb))return this.$Nd;r=null;r=this.wxb?this.qPg.isFeatureEnabled(b):this.Grb;let B=null;B=this.ocb?this.GMm(b,h):this.Grb;let P=null;P=this.HXe?this.Alh.isFeatureEnabled(b):this.Grb;return r.then(ca=>ca?P.then(ra=>ra?B:this.$Nd):this.$Nd).then(ca=>{this.GKi(b,ca,!0);return ca},()=>{this.GKi(b,h,!1);return h})}GKi(b,h,r){t.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",b,h,r)}getFeatureTier(b,h){if(!this.ocb)return new Promise(r=>{r(2)});
t.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",b);return this.dib.then(r=>this.YUd(b,r,h),()=>h)}isFreemiumUpsellEnabled(){if(this.hGe&&this.tpd&&!this.$Xb){if(this.kYb&&2!==this.oJe||!this.kYb&&1!==this.oJe)t.ULS.sendTraceTag(509728161,3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",this.kYb.toString()),this.oJe=this.kYb?2:1;return this.kYb}return!1}launchUpsellExperience(b,h=null){t.ULS.sendTraceTag(594564814,
3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",b));var r=lb.a.vG();r&&(r.set("experienceId",b),h&&r.set("campaignId",h));va.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",r);if(r=Ma.a.instance.Oa("Common.IInProductMessagingUIManager")){const B=Object(z.a)(this,this.Gom,"handleDimeTaskComplete");r.vGi(b,B,h)}else t.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),va.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess",
"InProductMessagingNotInitialized",!1,!0,null),this.ga.Qb(fb.a.SPd,2,{["experience"]:b})}gza(b,h){if(!this.ocb)return null;if(!b||!h)return t.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;const r=Bb.a.create().toString();this.cib.nb(b)||this.cib.Z(b,new Da.a(Pa.a.ih()));this.cib.J(b).add(r,h);t.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",
r,b));return r}ojc(b,h){this.ocb&&(b&&this.cib.nb(b)?h&&Bb.a.isValid(h)?this.cib.J(b).nb(h)?(t.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",h,b)),this.cib.J(b).remove(h)):t.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",h,b)):t.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",
h,b)):t.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",b)))}YUd(b,h,r){return this.pAd?b in h?h[b].LicenseTier:r:b in h?this.xBn(h[b],r):r}xBn(b,h){switch(b.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return h}}Gom(){t.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.dib.then(b=>{this.h9i(b)}).catch(()=>
{this.h9i({})})}h9i(b){t.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const h=this.dog(0,!0);h.then(r=>{this.dib=h;kb.a.count(r)>kb.a.count(b)?va.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):va.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(let B of this.cib.keys)if(B in r){const P=this.YUd(B,r,0);B in b?this.YUd(B,b,0)!==P&&this.lUf(B,!0,P):this.lUf(B,!0,P)}else B in
b&&this.lUf(B,!1,this.YUd(B,b,0))}).catch(r=>{va.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);t.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(r))})}lUf(b,h,r){t.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",b,h,r);h=new Ka(b,h,r);r=this.cib.J(b);for(let B of r)try{B.value(h)}catch(P){t.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",
b,B.key,P.message))}}FMm(b,h){if(this.ocb){const r=this.v5g.contains(b);let B=!0,P="",ca=!1;return this.dib.then(ra=>{b in ra?(ra=ra[b],P=Ja[ra.FeatureState],B=1!==ra.FeatureState):B=!r;this.UKi(b,r,P,ca,h,B);return B},()=>{ca=!0;r&&(B=h);this.UKi(b,r,P,ca,h,B);return B})}return this.Grb}UKi(b,h,r,B,P,ca){t.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",b,h,B,r,P,ca)}GMm(b,h){if(this.pAd)return this.FMm(b,
h);if(this.ocb){if(this.v5g.contains(b))return this.dib.then(r=>b in r,()=>h);t.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",b)}return this.Grb}tIn(b){try{b&&"Date"in b&&(this.oma=new Date(b.Date),t.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.oma.toString()))}catch(h){t.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",
h)}}fwj(){if(void 0!==this.pcb&&null!==this.pcb){const b=this.pcb.oi;this.pcb.stop();return b}return null}static TSd(b){try{if(Z.a.Yke){const h=b.kb("UserDataSignature").split(".");if(1<h.length){const r=window.self.atob(h[1]),B=JSON.parse(r).LocalStorageKey;if(void 0!==B&&null!==B&&0<B.length)return B}}}catch(h){t.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",h.toString())}return null}}Object(m.a)(cc,"ApplicationFeatureHelper",null,[699]);var mb=c(75);class Hb{constructor(b,
h){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=b.PolicySettings;b=new Date;b.setMinutes(b.getMinutes()+h);this.ExpirationTime=b.getTime()}}Object(m.a)(Hb,"CloudPolicySettingsCacheData",null,[]);var Ua=c(1395),Ya=c(633),Fb=c(293);class Wa{static Etj(){return v.AFrameworkApplication.K.$("SideCarIsEnabled")?Wa.Gfe&&Wa.tWc?new Promise(b=>{b(!0)}):new Promise((b,h)=>{Wa.Gfe=Fb.a.create(v.AFrameworkApplication.K.kb("SideCarUrl"));Ya.a.PX(Wa.Gfe);Wa.Gfe.D_((r,B)=>{(Wa.tWc=B.succeeded)?
b(B.succeeded):h(B.succeeded)})}):new Promise(b=>{b(!1)})}}Wa.tWc=!1;Wa.Gfe=null;Object(m.a)(Wa,"SideCarLoader",null,[]);class yb{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(m.a)(yb,"CloudPolicySettingsData",null,[]);class Yb{constructor(b,h){this.Sve=0;this.NGd=null;this.ywc=new Fa(b,h);this.Ca=b;h=b.kb("HostAuthType");this.wxb=b.$("OcpsIsEnabled")&&b.$("IsO365CommercialHost")&&!(void 0===h||null===h)&&"aad"===h.toLowerCase();this.f9g=H.b(b.kb("OcpsDefaultSettings")||
"{}");this.Oyc=this.TSd();h=this.Ca.rw("ServicesControlsMicrosoftControllerServicesList")?this.Ca.DB("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.bjd=new fa.a;for(let r=0;r<h.length;r++)this.bjd.add(h[r]);this.wxb&&!b.$("IsAnonymousUser")&&b.$("SideCarIsEnabled")?this.NGd=this.RPo():this.NGd=this.cog(this.wxb,this.$ib("/afhs/CloudPolicySettings.ashx"),Object(z.a)(this,this.SAn,"parseCloudPolicySettingsResponse"));this.NGd.then(()=>null).catch(r=>{r=Object(Ra.a)(ta,r);t.ULS.sendTraceTag(50622685,
3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",r?r.httpStatusCode.toString():"Unknown")})}Z8(b,h=!0){if(!this.wxb){const ca=this;return new Promise(ra=>{ra(ca.rRc(b))})}let r=this,B=this;const P=this.NGd.then(ca=>{try{let ra=null;ca.PolicySettings&&"unknown"in ca.PolicySettings&&(ra=ca.PolicySettings.unknown);if(ra){if(b in ra&&void 0!==ra[b]&&null!==ra[b])return new Promise(tb=>{tb("0"!==ra[b])});const Qa=b.toLowerCase();if(Qa in ra&&void 0!==ra[Qa]&&null!==ra[Qa])return new Promise(tb=>
{tb("0"!==ra[Qa])});t.ULS.sendTraceTag(51512667,3004,50,"Policy"+b+" not found, using default");return new Promise(tb=>{tb(r.rRc(b))})}return new Promise(Qa=>{Qa(r.rRc(b))})}catch(ra){return t.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+b+" policy value. Error Message: {0}",ra.message),r.handleError(ra.toString(),h,r.rRc(b))}},ca=>B.handleError(ca,h,B.rRc(b)));P.then(ca=>{t.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",b,ca);
return null});return P}isFeatureEnabled(b,h=!0){if(this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.IMm(b,h);let r=new Promise(P=>{P(!0)}),B="";this.bjd.contains(b)&&(B="ControllerConnectedServicesEnabled",r=this.Z8(B,h));r.then(P=>{t.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",b,P,B);return null});return r}IMm(b,h=!0){let r=new Promise(P=>
{P(!0)}),B="";"mso_sendASmile"===b?B="Enabled":"Survey"===b||"FloodgateSurvey"===b?B="SurveyEnabled":this.bjd.contains(b)&&(B="ControllerConnectedServicesEnabled");""!==B&&(r=this.Z8(B,h));r.then(P=>{t.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",b,P,B);return null});return r}handleError(b,h,r){return h?new Promise(B=>{B(r)}):new Promise((B,P)=>{P(b)})}cog(b,h,r){if(!b)return Promise.resolve(new yb);let B=!1,P=
null;va.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let ca=this.Iaf("GetCloudPolicySettings");return(new Promise((ra,Qa)=>{if(void 0!==this.Oyc&&null!==this.Oyc&&0<this.Oyc.length){const tb=this.uPo();if(void 0!==tb&&null!==tb){B=!0;ra(tb);return}}this.ywc.EKc(h,r,1,null,Object(z.a)(this,this.FIn,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],this.Ca.mc("CloudPolicySettingsRequestQueueTimeout",15E3),this.Ca.mc("CloudPolicySettingsRequestSentTimeout",
3E4)).then(tb=>{t.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.CQo(tb);ra(tb);return tb},tb=>{Qa(tb);return null})})).then(ra=>{({YA:ca,returnValue:P}=this.wke(ca));var Qa=lb.a.vG();Qa&&Qa.set("FromCache",B.toString());Qa=Object.assign(new hc.a,{durationMs:P,extendedProperties:Qa});va.Health.instance.recordKpiSuccess("GetCloudPolicySettings",Qa);return ra})}RPo(){return Wa.Etj().then(()=>{t.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");
return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}$ib(b){const h=this.Ca.$("SuiteOriginForAFHSIsEnabled")?this.Ca.kb("SuiteOrigin"):this.Ca.kb("WebServiceBase");return String.format("{0}{1}",h,b)}SAn(b){let h=null;({Gt:h}=H.d(b));b=!!h;t.ULS.sendTraceTag(50622687,3004,b?50:10,"ParseCloudPolicySettingsResponse: Success={0}",b);return h}FIn(b){try{if(void 0!==b&&null!==b&&"CheckIn-Interval"in b){const h=parseInt(b["CheckIn-Interval"]);void 0!==h&&null!==h&&0<h&&(this.Sve=h)}}catch(h){t.ULS.sendTraceTag(51662934,
3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",h)}}rRc(b){return b in this.f9g?"0"!==this.f9g[b]:!0}uPo(){try{const b=Ua.a.instance.getItem(this.Oyc);if(void 0===b||null===b)return t.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;t.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",b);const h=JSON.parse(b);if(void 0===h||null===h)return t.ULS.sendTraceTag(51662938,
3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===h.ExpirationTime||null===h.ExpirationTime)return t.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(h.ExpirationTime)).getTime()<Date.now())return t.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const r=new yb;r.PolicySettings=h.PolicySettings;
r.ControllerConnectedServicesFeatureNames=new mb.a;this.Ca.rw("ServicesControlsMicrosoftControllerServicesList")&&this.Ca.DB("ServicesControlsMicrosoftControllerServicesList");for(let B of this.bjd)r.ControllerConnectedServicesFeatureNames.add(B);t.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return r}catch(b){return t.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",b.toString()),null}}CQo(b){try{if(void 0===
b||null===b||void 0===b.PolicySettings||null===b.PolicySettings)t.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.Sve)t.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{const h=new Hb(b,this.Sve),r=JSON.stringify(h);t.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",r);Ua.a.instance.setItem(this.Oyc,r);t.ULS.sendTraceTag(51662947,
3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(h){t.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",h.toString())}}TSd(){const b=cc.TSd(this.Ca);return b&&0<b.length?"OCPS"+b:null}Iaf(b){const h=Ma.a.instance.Oa("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==h&&null!==h?h.Zf("WebServiceCall",b):null}wke(b){if(void 0!==b&&null!==b){const h=b.oi;b.stop();return{returnValue:h,YA:null}}return{returnValue:null,
YA:b}}}Object(m.a)(Yb,"CloudPolicySettingsHelper",null,[696]);class qc{constructor(){this.jVh=this.fJj=this.hJ=0;this.kVh=this.gJj=this.RCb="";this.PTe=this.MVa=2}clone(){const b=new qc;b.hJ=this.hJ;b.fJj=this.fJj;b.jVh=this.jVh;b.RCb=this.RCb;b.gJj=this.gJj;b.kVh=this.kVh;b.MVa=this.MVa;b.PTe=this.src;return b}get src(){return this.PTe}serialize(b=null){const h={};if(!b||b.contains(qc.iMb))h[qc.iMb]=this.hJ;if(!b||b.contains(qc.K1c))h[qc.K1c]=this.RCb;if(!b||b.contains(qc.L1c))h[qc.L1c]=this.MVa;
return JSON.stringify(h)}static create(b,h=null){const r=new qc;r.PTe=b;void 0!==h&&null!==h&&(qc.iMb in h&&(r.hJ=h[qc.iMb]),qc.K1c in h&&(r.RCb=h[qc.K1c]),qc.L1c in h&&(r.MVa=h[qc.L1c]));return r}static deserialize(b,h){try{const r=JSON.parse(b);if(void 0!==r&&null!==r)return qc.create(h,r);t.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",b);throw Error.argument("settingsData");}catch(r){throw t.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",
r.toString()),r;}}}qc.iMb="CCS";qc.K1c="CCSTime";qc.L1c="OfficePrivacyRoamedNoticeShown";Object(m.a)(qc,"UserPrivacySettings",null,[]);var Hc=c(157);class $b{constructor(b,h){if(void 0===b||null===b||void 0===h||null===h)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Ca=b;this.$f=h;this.GSe=this.Wf=null}$ib(b){var h=String.format("{0}RoamingServiceHandler.ashx?action=",this.Ca.appSettings.RoamingServiceHandlerWebServiceBase||"");h=new Sys.StringBuilder(h);h.append(b);h.append("&");
h.append(v.AFrameworkApplication.em);return h.toString()}executeRequest(b,h,r,B=null){return this.$f.C2b(b,h,B,null,r,"33",!1,null,6E4)}saveSettings(b){return new Promise((h,r)=>{try{if(void 0===this.Wf||null===this.Wf||void 0===b||null===b)t.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),r("Can't determine setting changes to save");else{var B=this.Wf.hJ!==b.hJ;if(2===this.Wf.src&&B)this.Qao(b),h(!0);else{var P=this.Lfo(b);if(void 0===P||null===
P||!P.length)t.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),r("No changes to save");else if(1===this.Wf.src)h(this.lDj(P));else if(0===this.Wf.src){t.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",P);const ca=this.executeRequest(this.$ib("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",P);ca.continueWith(()=>{if(ca.Io||ca.Gi)t.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),
h(!1);else{var ra=ca.result;void 0!==ra.args&&null!==ra.args&&void 0!==ra.args.data&&null!==ra.args.data&&ra.args.data.Se===qa.a.Zz?(t.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),h(!0)):(t.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),h(!1))}})}}}}catch(ca){t.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",ca.toString()),h(!1)}})}Lfo(b){if(void 0===this.Wf||null===this.Wf||void 0===b||null===
b)throw Error.invalidOperation("User Privacy settings have not been initialized");const h=new mb.a;0===b.src?(this.Wf.hJ!==b.hJ&&(h.add(qc.iMb),h.add(qc.K1c)),this.Wf.MVa!==b.MVa&&h.add(qc.L1c)):1===b.src&&this.Wf.hJ!==b.hJ&&h.add(qc.iMb);return h.count?b.serialize(h):(t.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)}getSettings(){if(!this.GSe){const b=this;this.GSe=new Promise(h=>{try{b.Wf?h(b.Wf.clone()):b.LPo().then(r=>{b.Wf=r;h(b.Wf.clone());
return null},()=>{b.JPo().then(r=>{b.Wf=r;h(b.Wf.clone());return null},()=>{b.KPo().then(r=>{b.Wf=r;h(b.Wf.clone());return null},()=>{t.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");b.Wf=new qc;h(b.Wf.clone());return null});return null});return null})}catch(r){t.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",r.toString()),b.Wf=new qc,h(b.Wf.clone())}})}return this.GSe}LPo(){return new Promise((b,h)=>
{try{const B=-1!==window.location.href.indexOf("&wd_pn=2");if(this.Ca.$("PrivacyDialogShouldCheckRoaming")||B){var r=this.executeRequest(this.$ib("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");r.continueWith(()=>{try{if(r.Io||r.Gi)t.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const P=r.result;if(P&&P.args&&P.args.data)if(P.args.data.Se!==qa.a.Zz)t.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",
P.args.data.Se);else{if(P.args.data.se){b($b.parse(P.args.data.se,0));t.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",P.args.data.se);return}t.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else t.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");h("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(P){t.ULS.sendTraceTag(50860938,
3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",P.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else t.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),h("Roaming should not be used")}catch(B){t.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",B.toString()),h("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}JPo(){return new Promise((b,
h)=>{try{const r=Hc.a.get("WacUPToggleState");let B=null;void 0!==r&&null!==r&&0<r.length&&(B=decodeURIComponent(r));if(void 0!==B&&null!==B&&0<B.length){const P=$b.parse(B,1);t.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",P.toString());b(P)}else{const P=qc.create(1),ca=new mb.a;ca.add(qc.iMb);const ra=P.serialize(ca);this.lDj(ra)?(t.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",
ra),b(P)):(t.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",ra),h("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(r){t.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",r.toString()),h("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}KPo(){return new Promise(b=>{try{var h=-1!==window.location.href.indexOf("&wdccsoff=1");let r=qc.create(2);h?(r.hJ=
2,v.AFrameworkApplication.eTh(),t.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",r.toString())):(r.hJ=1,t.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",r.toString()));b(r)}catch(r){t.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",r.toString()),h=qc.create(2),h.hJ=1,b(h)}})}Qao(b){t.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");
2===b.hJ?v.AFrameworkApplication.eTh():v.AFrameworkApplication.ovl();t.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",b)}lDj(b){try{t.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",b);const h=this.Ca.kb("PrivacyCookieDomain")||"";if(!h||!h.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");t.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",b);return Hc.a.Goj("WacUPToggleState",
b,Hc.a.hHa,h)}catch(h){return t.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",h.toString()),!1}}isFeatureEnabled(b){return this.getSettings().then(h=>{const r=this.Ca.rw("ServicesControlsMicrosoftControllerServicesList")?this.Ca.DB("ServicesControlsMicrosoftControllerServicesList"):[],B=new fa.a;for(let P=0;P<r.length;P++)B.add(r[P]);return B.contains(b)?2!==h.hJ:!0},()=>{t.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",b);
return!0})}static parse(b,h){try{return t.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",b,h),qc.deserialize(b,h)}catch(r){throw t.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",r.toString()),r;}}}Object(m.a)($b,"UserPrivacySettingsHelper",null,[697]);class Ub{constructor(){this.W=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}wc(b){this.W=b;this.W.register(696,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").ha().Ud(()=>
new Yb(v.AFrameworkApplication.K,v.AFrameworkApplication.He));this.W.register(697,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").ha().Ud(()=>new $b(v.AFrameworkApplication.K,v.AFrameworkApplication.He));this.W.register(698,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").ha().Ud(()=>new xa(v.AFrameworkApplication.K,v.AFrameworkApplication.He));this.W.register(699,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").ha().Ud(()=>new cc(v.AFrameworkApplication.K,
v.AFrameworkApplication.He,this.W.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.W.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),v.AFrameworkApplication.va))}init(){v.AFrameworkApplication.K.Nn(()=>{const b=this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");v.AFrameworkApplication.K.$("LicensingIsEnabled")&&(b.isFeatureEnabled("LicensingTestFeature",!1).then(h=>{t.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",
h,v.AFrameworkApplication.K.kb("IsAnonymousUser"));return null}),b.getFeatureTier("LicensingTestFeature",0).then(h=>{t.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",h,v.AFrameworkApplication.K.kb("IsAnonymousUser"));return null}));this.W.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.cJo()})}dispose(){}cJo(){try{v.AFrameworkApplication.K.$("SideCarIsEnabled")&&Wa.Etj().then(b=>
{t.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",b);return b})}catch(b){}}static main(){L.a.instance.Gc(new Ub)}}Object(m.a)(Ub,"ApplicationFeatureHelperPackage",null,[1,2]);var mc=c(172);class ic{YSd(b,h){let r;const B=[];for(;r=h.exec(b);){const P=r.index;B.push(new mc.a(P,P+r[0].length))}return B}isEndPuncSpecialCase(b){const h=this.YSd(b,ic.UAo);for(const r of h)if(r.end===b.length)return!0;return!1}PNc(b){for(const h of ic.Kzl){const r=
this.YSd(b,h);if(0<r.length&&!r[0].Ec)return r[0].end-1}return 0}findBeginBoundary(b,h,r){var B=b.substring(r,h);b=this.YSd(B,ic.eXh);for(h=b.length-1;0<=h;h--){const P=B.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(P))return B=B.substring(b[h].Ec,B.length),r+b[h].end+this.PNc(B)}return r}findEndBoundary(b,h,r){var B=b.substring(h,r);b=this.YSd(B,ic.eXh);for(r=0;r<b.length;r++){const P=B.substring(0,b[r].end);if(!this.isEndPuncSpecialCase(P))return B=B.substring(b[r].Ec,B.length),h+b[r].end+
this.PNc(B)}return-1}}ic.Ojf="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b]|[\u00bb\u2019\u201d\u203a\"']|[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])*[\u2028\u2029\n\r])";ic.Pjf="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])+)";
ic.Qjf="([\u3002\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*)";ic.Kzl=[new RegExp(ic.Ojf,"ig"),new RegExp(ic.Pjf,"ig"),new RegExp(ic.Qjf,"ig")];ic.xig="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";ic.Aig="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";ic.zig="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";
ic.yig=ic.Aig+"|"+ic.zig;ic.Cig="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";ic.Dig="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";ic.Eig="(([A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]|[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]|[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45])[.])+|(([\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d])[.\ufe52\uff0e])+";
ic.Fig="([\uff21-\uff3a\uff41-\uff5a])[.\ufe52\uff0e]";ic.wcg="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f])("+
ic.yig+"|"+ic.Cig+"|"+ic.Dig+")";ic.vcg="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]|[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]|[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a])("+
ic.Eig+")";ic.PTf=ic.xig+"|"+ic.Fig;ic.wig=ic.PTf+"|"+ic.wcg+"|"+ic.vcg;ic.eXh=RegExp("[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]|[\u3002\uff61]","ig");ic.UAo=new RegExp(ic.wig,"g");Object(m.a)(ic,"ProofingSentenceSeparatorScriptSharp",null,[694]);class ab{Afd(b,h){const r=[];let B;for(;null!=(B=h.exec(b));){const P=B.index;r.push({Ec:P,end:P+B[0].length})}return r}isEndPuncSpecialCase(b){return this.Afd(b,ab.aSj).some(h=>
h.end==b.length)}PNc(b){for(const h of ab.WOj){const r=this.Afd(b,h);if(0<r.length&&0==r[0].Ec)return r[0].end-1}return 0}findBeginBoundary(b,h,r){var B=b.substring(r,h);b=this.Afd(B,ab.Utg);for(h=b.length-1;0<=h;h--){const P=B.substring(0,b[h].end);if(!this.isEndPuncSpecialCase(P))return B=B.substring(b[h].Ec,B.length),r+b[h].end+this.PNc(B)}return r}findEndBoundary(b,h,r){var B=b.substring(h,r);b=this.Afd(B,ab.Utg);for(r=0;r<b.length;r++){const P=B.substring(0,b[r].end);if(!this.isEndPuncSpecialCase(P))return B=
B.substring(b[r].Ec,B.length),h+b[r].end+this.PNc(B)}return-1}}ab.ENj="[)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]";ab.WRj="[\u2639\u263a\u263b]";ab.Kug="[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]";ab.HOj="[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]";
ab.ZQj="[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a]";ab.Qug="[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]";
ab.Symbol="[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]";
ab.Jug="[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]";ab.cQj="[A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]";ab.bQj="[\uff21-\uff3a\uff41-\uff5a]";ab.$Pj="[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]";
ab.ZPj="[\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d]";ab.aQj="[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45]";ab.Pqe="[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]";ab.Ttg="[\u3002\uff61]";ab.Vfd="[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]";ab.dPj="[\u00bb\u2019\u201d\u203a\"']";ab.jre=ab.ENj+"|"+ab.WRj;ab.dQj="[\u2028\u2029\n\r]";ab.YPj="("+ab.Vfd+"|"+ab.Kug+"|"+ab.Qug+"|"+ab.Jug+
")";ab.XPj="("+ab.Vfd+"|"+ab.Kug+"|"+ab.Qug+"|"+ab.Symbol+"|"+ab.Jug+"|"+ab.HOj+"|"+ab.ZQj+")";ab.Ojf="("+ab.Pqe+"("+ab.jre+"|"+ab.dPj+"|"+ab.Vfd+")*"+ab.dQj+")";ab.Pjf="("+ab.Pqe+"("+ab.jre+")*("+ab.Vfd+")+)";ab.Qjf="("+ab.Ttg+"("+ab.jre+")*)";ab.WOj=[new RegExp(ab.Ojf,"ig"),new RegExp(ab.Pjf,"ig"),new RegExp(ab.Qjf,"ig")];ab.xig="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";ab.Aig="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";
ab.zig="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";ab.yig=ab.Aig+"|"+ab.zig;ab.Cig="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";ab.Dig="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";
ab.Eig="(("+ab.cQj+"|"+ab.$Pj+"|"+ab.aQj+")[.])+|(("+ab.ZPj+")[.\ufe52\uff0e])+";ab.Fig="("+ab.bQj+")[.\ufe52\uff0e]";ab.wcg=ab.YPj+"("+ab.yig+"|"+ab.Cig+"|"+ab.Dig+")";ab.vcg=ab.XPj+"("+ab.Eig+")";ab.PTf=ab.xig+"|"+ab.Fig;ab.wig=ab.PTf+"|"+ab.wcg+"|"+ab.vcg;ab.Utg=new RegExp(ab.Pqe+"|"+ab.Ttg,"ig");ab.aSj=new RegExp(ab.wig,"g");Object(m.a)(ab,"ProofingSentenceSeparator",null,[694]);class bb{constructor(){this.W=null}get name(){return"Box4.ProofingGrammarCheck"}wc(b){this.W=b;v.AFrameworkApplication.K.$("ProofingSentenceSeparatorTypeScriptIsEnabled")?
b.ia("Box4.Proofing.IProofingSentenceSeparator",()=>new ab).ha():b.ia("Box4.Proofing.IProofingSentenceSeparator",()=>new ic).ha()}init(){this.W.resolve("Box4.Proofing.IProofingSentenceSeparator")}dispose(){}static main(){L.a.instance.Gc(new bb)}}Object(m.a)(bb,"Box4GrammarCheckPackage",null,[1,2]);var Jb=c(102),Eb=c(10),hb=c(62),ob=c(1848);class Va{constructor(){this.W=null}get name(){return"Box4.AtMentions"}wc(b){this.W=b;this.W.ia("Box4.AtMentions.IAtMentionsListener",()=>new ob.a(this.W.resolve("Box4.IEditingDomManager"),
this.W.resolve("Box4.ICaretPositionManager"),this.W.resolve("Box4.BackspaceDeleteEventSource"),hb.InteractiveViewManager.instance)).ha()}init(){v.AFrameworkApplication.K.Nn(()=>{this.W.resolve("Box4.AtMentions.IAtMentionsListener").qfb(Eb.App.za.jb,Jb.KeyInputManager.instance)})}dispose(){this.W.resolve("Box4.AtMentions.IAtMentionsListener").dispose()}static main(){L.a.instance.Gc(new Va)}}Object(m.a)(Va,"Box4AtMentionsPackage",null,[1,2]);class Qb{get name(){return"Box4.Workers"}wc(){}init(){}dispose(){}static main(){L.a.instance.Gc(new Qb)}}
Object(m.a)(Qb,"Box4WorkersPackage",null,[1,2]);var Vb=c(306),Sb=c(83);class nb{constructor(){this.rKa=new Sb.a}K5(b,h){this.rKa.Z(b,h)}Snf(b){({value:b}=this.rKa.Fc(b));return b}}Object(m.a)(nb,"AggregationMethodsForActivityName",null,[]);var ac=c(255);class zc{constructor(){this.Bud=new Vb.a;this.rKa=new Vb.a}K5(b,h,r){this.rKa.nb(b)&&this.rKa.J(b)||this.rKa.Z(b,new nb);this.rKa.J(b).K5(h,r)}Snf(b,h){return this.rKa.nb(b)&&this.rKa.J(b)?this.rKa.J(b).Snf(h):null}IRc(b){this.Bud.nb(b)&&this.Bud.J(b)||
this.Bud.Z(b,new ac.a);return this.Bud.J(b)}UPh(b,h){this.IRc(b).add(h)}}Object(m.a)(zc,"ActivityAggregationInfo",null,[739]);var Ib=c(112),ya=c(1006),ib=c(1031);class wb extends ya.a{constructor(b,h){super(b);this.dXe=(this.aVj=h)?h.OYl():ib.a.Enf()}get aDa(){return this.aVj}get activityName(){return this.aDa.name}get startTime(){return this.aDa.startTime}get endTime(){return this.aDa.endTime}end(){}cancel(){}umf(){}vWo(){this.X8b.Z("AM",this.aDa.mode.toString());this.X8b.Z("C",this.aDa.count.toString());
this.X8b.Z("DA",this.aDa.CVh.toFixed(2));this.X8b.Z("DV",this.aDa.vtl.toFixed(2))}Otf(b){return this.aDa.Otf(b)}tuf(){return this.aDa.tuf()}H2b(){for(let b of this.aDa.bDa)b.H2b()}}Object(m.a)(wb,"AggregatedActivity",ya.a,[]);class bc{constructor(b,h){this.nte=0;this.GAa=b;this.lWa=h}nBk(b,h){this.nte=h;for(h=0;h<b.count;h++){const r=b.J(h);this.oBk(r)}}oBk(b){const h=Object(Ra.a)(wb,b);if(h)if(1===this.nte)this.mBk(h);else if(2===this.nte){this.pBk(h);for(let r of this.lWa.IRc(this.GAa)){const B=
h.aDa.bDa.J(0);B.properties.nb(r)&&b.properties.Z(r,B.properties.J(r))}}}mBk(b){for(let h of this.lWa.IRc(this.GAa))this.Igj(b,h)}pBk(b){for(let h of b.tuf())this.Igj(b,h)}Igj(b,h){const r=this.lWa.Snf(this.GAa,h);if(r){const B=b.Otf(h);b.properties.Z(h,r(B))}}}Object(m.a)(bc,"PropertyAggregationHelper",null,[]);var lc=c(1099);class Kb{constructor(b,h,r,B,P){this.zUb=b;this.lWa=h;this.VPg=P;this.Vse=B;this.z$j=r}get Mnh(){return this.z$j.value}uJc(b){if(Object(Ib.a)(lc.a,b))b.uJc();else if(Object(Ib.a)(wb,
b)&&this.Vse.KBh(b.activityName.toString())){b=Object(Ra.a)(wb,b);b.vWo();b=b.mNi();var h=[];Array.add(h,b);b=H.c(h);t.ULS.sendTraceTag(6907266,213,50,b)}}jDa(b,h){const r=(new Date).getTime();var B=this.VPg.list.J(b);const P=({rBk:B}=this.WMl(B)).returnValue;this.VPg.list.Z(b,new mb.a);h&&(B=this.E8k(B,r,this.zUb.Dli));0<B.count&&(new bc(b,this.lWa)).nBk(B,P)}E8k(b,h,r){const B=new mb.a;for(let P=0;P<b.count;P++){const ca=b.J(P);ca.startTime>h-r?ca.H2b():B.add(ca)}return B}WMl(b){const h=this.Mnh.Jzj(b);
b=this.Mnh.zKo(b);const r=this.sBk(h,b);return{returnValue:r,rBk:1===r?h:b}}sBk(b,h){return b.count*this.zUb.HPi<h.count?1:2}get enabled(){return this.zUb.enabled}H2b(){}}Object(m.a)(Kb,"ActivityAggregationManager",null,[740]);class Bc{constructor(b){this.enabled=!1;this.YNi=500;this.mPi=2;this.HPi=5;this.Dli=3E4;this.XNc(b.appSettings)}XNc(b){this.enabled=Boolean.parse(b[Bc.dif]||"false");this.YNi=parseInt(b[Bc.nbn]||"500");this.mPi=parseInt(b[Bc.Sdn]||"2");this.HPi=parseInt(b[Bc.ten]||"5");this.Dli=
parseInt(b[Bc.Dmm]||"30000")}}Bc.dif="ActivityAggregationEnabled";Bc.nbn="ActivityAggregationMaxInterval";Bc.Sdn="ActivityAggregationMinChain";Bc.ten="ActivityAggregationModeFactor";Bc.Dmm="ActivityAggregationGraceWindow";Object(m.a)(Bc,"ActivityAggregationParams",null,[]);class Xc{constructor(b,h){this.lWa=b;this.fLg=h}Jzj(b,h=1){if(!b||!b.count)return b;const r=new mb.a;var B=null;for(let P=0;P<b.count;P++){const ca=b.J(P);if(!ca)continue;const ra=ca.activityName;B?B.$Xm(ca)?B.add(ca):(B=B.process(),
r.addRange(B),B=this.fLg(ra,h),B.add(ca)):(B=this.fLg(ra,h),B.add(ca))}B&&(b=B.process(),r.addRange(b));return r}zKo(b){if(!b||!b.count)return b;const h={};var r=null;for(let P=0;P<b.count;P++){const ca=b.J(P);if(ca){if(!r){r=new mb.a;var B=this.lWa.IRc(ca.activityName);for(let ra of B)r.add(ra)}B=this.Mam(ca,r);null!==B&&(B in h&&h[B]||(h[B]=new mb.a),h[B].add(ca))}}b=new mb.a;for(const P of kb.a.gP(h))r=this.Jzj(h[P],2),b.addRange(r);return b}Mam(b,h){let r="";for(let B of h)r+=B,r=b.properties.nb(B)&&
void 0!==b.properties.J(B)&&null!==b.properties.J(B)?r+b.properties.J(B):r+"null";return r}}Object(m.a)(Xc,"ActivityAggregationSchemes",null,[732]);class vd{constructor(b,h,r,B,P){this.ys=this.ki=0;this.zUb=r;this.Kqc=B;this.lWa=P;this.name=b;this.mz=h;this.bDa=new mb.a}get mode(){return this.mz}get count(){return this.bDa.count}get startTime(){return this.ki}get endTime(){return this.ys}get CVh(){if(!this.count)return 0;let b=0;for(let h of this.bDa)b+=h.endTime-h.startTime;return b/this.count}get vtl(){if(!this.count)return 0;
let b=0;const h=this.CVh;for(let r of this.bDa){const B=r.endTime-r.startTime;b+=(B-h)*(B-h)}return b/this.count}add(b){this.count?this.ys=b.endTime>this.endTime?b.endTime:this.endTime:(this.ki=b.startTime,this.ys=b.endTime);this.bDa.add(b)}$Xm(b){return 0>=this.count?!1:b.startTime-this.endTime<=this.zUb.YNi}process(){if(this.count>=this.zUb.mPi){const b=new mb.a,h=this.Kqc(this);b.add(h);return b}return this.bDa}Otf(b){const h=new mb.a;for(let r of this.bDa)if(r.properties.nb(b)){const B=r.properties.J(b);
h.add(B)}else h.add(null);return h}tuf(){const b=this.lWa.IRc(this.name),h=new ac.a;for(let r of this.ANl())b.contains(r)||h.add(r);return h}ANl(){const b=new ac.a;if(!this.bDa)return b;for(let h of this.bDa)for(let r of h.properties.keys)b.add(r);return b}OYl(){return this.bDa.J(0).uniqueID}}Object(m.a)(vd,"ActivityCollection",null,[724]);class vc{constructor(){this.Btb=new Vb.a}get list(){return this.Btb}add(b){const h=b.activityName;if(this.Btb.nb(h)&&this.Btb.J(h)){const r=this.$0l(this.Btb.J(h),
b);this.Btb.J(h).insert(r,b)}else this.Btb.Z(h,new mb.a),this.Btb.J(h).add(b)}$0l(b,h){for(let r=b.count-1;0<=r;r--)if(h.startTime>b.J(r).startTime)return r+1;return 0}}Object(m.a)(vc,"CompletedActivitiesHelper",null,[722]);class bd{constructor(){this.W=null}get name(){return"Common.App.ActivityAggregator"}init(){v.AFrameworkApplication.qI(()=>{this.W.resolve("Common.App.ActivityAggregator.ActivityAggregationManager")})}dispose(){}wc(b){this.W=b;const h=B=>new wb(()=>b.Oa("Common.App.Activities.IActivityAggregationManager"),
B),r=(B,P)=>new vd(B,P,b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),h,b.resolve("Common.IActivityAggregationInfo"));b.register(Kb,"Common.App.ActivityAggregator.ActivityAggregationManager").as("Common.App.Activities.IActivityAggregationManager").ha().Ud(()=>new Kb(b.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),b.resolve("Common.IActivityAggregationInfo"),b.Ve("Common.App.ActivityAggregator.IActivityAggregationSchemes"),b.resolve("Common.App.Activities.IActivityThrottler"),
b.resolve("Common.App.ActivityAggregator.CompletedActivitiesHelper")));b.register(Bc,"Common.App.ActivityAggregator.ActivityAggregationParams").ha().Ud(()=>new Bc(v.AFrameworkApplication.K));b.register(zc,"Common.App.ActivityAggregator.ActivityAggregationInfo").as("Common.IActivityAggregationInfo").ha().Ud(()=>new zc);b.register(Xc,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as("Common.App.ActivityAggregator.IActivityAggregationSchemes").ha().Ud(()=>new Xc(b.resolve("Common.IActivityAggregationInfo"),
r));b.register(vc,"Common.App.ActivityAggregator.CompletedActivitiesHelper").ha().Ud(()=>new vc)}static main(){L.a.instance.Gc(new bd)}}Object(m.a)(bd,"ActivityAggregatorPackage",null,[1,2]);var Sd=c(535),pd=c(11),Tc=c(1406);class Wc{constructor(b){this.Ybh=0;this.Pve=null;this.Egk=b}get chat(){return window.swc}get isInitialized(){return!!this.chat}get Efg(){return this.Egk.value}Tb(){this.isInitialized?this.hjc():this.aXn(Object(z.a)(this,this.hjc,"registerActionsInternal"))}hjc(){t.ULS.sendTraceTag(50595938,
333,50,"Registering for chat events");try{this.isInitialized&&(this.chat.getContainerProvider().then(b=>{b.getChatsContainer(Object(z.a)(this,this.jmn,"onChatContainerReady"))}).catch(b=>{t.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",b)}),this.chat.getChatsCounter().then(b=>{b.onChatsCountChange(Object(z.a)(this,this.mVk,"chatCountChanged"))}).catch(b=>{t.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",b)}),this.chat.getKeyboard().then(b=>
{b.onKeyDown(Object(z.a)(this,this.mmn,"onChatKeyPress"))}).catch(b=>{t.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",b)}))}catch(b){t.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",b)}}mVk(b){t.ULS.sendTraceTag(50595970,333,50,"Chat count:{0}",b);if(!b)this.Efg.imn();else if(1===b&&!this.Ybh){const h=document.getElementById(this.Pve?this.Pve:Tc.a.lCb);h?this.Efg.nmn(h,Object(z.a)(this,this.qNo,"transferFocusToChat")):t.ULS.sendTraceTag(50595971,
333,10,"Chat parent is null")}this.Ybh=b}jmn(b){this.Pve=b}mmn(b){b.ctrlKey&&"f6"===b.key.toLowerCase()&&this.pNo(b.shiftKey)}aXn(b){Sd.a.instance.ob(pd.a.qGo,window.self,()=>{b();return!0})}qNo(){t.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&this.chat.getFocuser().then(b=>{b.focusConversationInput()}).catch(b=>{t.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",b)})}catch(b){t.ULS.sendTraceTag(50595974,333,10,"Failed to transfer focus to chat: {0}",
b)}}pNo(b){t.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");this.Efg.kmn(b)}}Object(m.a)(Wc,"ChatManager",null,[760]);var Pc=c(81);class Xd{constructor(){this.sa=new Pc.a;this.ank=!1}Ryk(b){this.sa.addHandler("OnTopRowControlsCreatedEvent",b)}Byk(b){this.sa.addHandler("OnRenameTextboxStatusChangedEventKey",b)}get gMo(){return this.ank}a7i(b){this.sa.raiseEvent("OnRenameTextboxStatusChangedEventKey",b?"true":"false")}}Object(m.a)(Xd,"HeaderEventSource",null,[]);var Dd=c(176),$e=c(336),
se=c(79);class wc{constructor(b,h,r,B,P){this.Czd=null;this.Vb=b;this.lp=h;this.tk=r;this.dnk=B;this.ga=P}I9i(b,h,r,B=null){const P=this.Vb.fe(h);P.parent=r;P.eI=!0;B&&P.Q3(B);this.tk.cDa(h,b,!1);this.dnk.cDa(h,b,!1);h=new $e.DOMFocusListing(()=>b);h.Rm(2);h.Rm(1);h.Rm(8);h.Rm(5);h.Rm(3);h.Rm(6);this.Vb.ina(()=>b,P,h).BP=!0;h=Jb.KeyInputManager.ic(se.a.Iw,0);r=Jb.KeyInputManager.ic(se.a.Iw,4);P.nr(h);P.nr(r)}onFlexPaneOpen(b){this.I9i(b,Tc.a.Qfc,Tc.a.FQa);this.Vb.mg(Tc.a.Qfc);this.lp.V7(Tc.a.Qfc)}onFlexPaneClose(){this.lp.fx(Tc.a.Qfc);
this.Vb.mg(Tc.a.FQa)}nmn(b,h){this.Czd||(this.Czd=h,this.I9i(b,Tc.a.lCb,Dd.AFrame.wM,Object(z.a)(this,this.lmn,"onChatFocus")));this.Vb.mg(Tc.a.lCb);this.lp.V7(Tc.a.lCb)}lmn(){this.Czd&&this.Czd()}imn(){this.lp.fx(Tc.a.lCb);this.Vb.FPd(Dd.AFrame.In)}kmn(b){this.ga.processAction(b?fb.a.gkf:fb.a.Rqe,2)}}Object(m.a)(wc,"ReactSharedHeaderFocusManager",null,[759]);var cd=c(129),Jd=c(1070),Qd=c(39),yd=c(70);class Le{constructor(b){this.ga=b}Tb(){this.ga.ra(fb.a.SPd,yd.a.frame,Object(z.a)(this,this.TQi,
"navigateToUpsellPage"));this.ga.ra(fb.a.r3h,yd.a.frame,Object(z.a)(this,this.launchUpsellExperience,"launchUpsellExperience"));this.ga.ra(fb.a.Z4n,yd.a.frame,cd.ActionManager.Of);this.ga.ra(fb.a.udj,yd.a.frame,cd.ActionManager.Of)}TQi(b,h,r,B,P){if(1===r)return 32;b=8;2===r&&(r=this.dpf(P,"experience","gopremiumribbon"),P=ia.a.e9("2116536"),P=ia.a.No(P,"ocid",Jd.b(v.AFrameworkApplication.ua.Kb.yk,v.AFrameworkApplication.ua.Kb.Yia,r)),Qd.a.wm(P,"_blank",void 0,"NavigateToUpsellPage"),b=32,this.ga.processAction(fb.a.udj,
2),t.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));return b}launchUpsellExperience(b,h,r,B,P){if(1===r)return 32;var ca=8;2===r&&(t.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(ca=Ma.a.instance.Oa("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))?(b=this.dpf(P,"experience","gopremium"),P=this.dpf(P,"dimeCampaignId",null),ca.launchUpsellExperience(b,P),ca=32):(t.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),ca=this.TQi(b,
h,r,B,P)));return ca}dpf(b,h,r){b&&b[h]&&(r=Object(Ra.a)(String,b[h]));return r}}Object(m.a)(Le,"UpsellActor",null,[758]);class gf{constructor(){this.W=null}get name(){return"Common.App.Header"}init(){Ma.a.instance.resolve("Common.App.Header.IUpsellActor").Tb();Ma.a.instance.resolve("Common.App.Header.IChatManager").Tb()}dispose(){}wc(b){this.W=b;this.W.register(Xd,"Common.App.Header.HeaderEventSource").ha();this.W.register(Le,"Common.App.Header.UpsellActor").as("Common.App.Header.IUpsellActor").ha().Ud(()=>
new Le(v.AFrameworkApplication.va));this.W.register(wc,"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").ha().Ud(()=>new wc(v.AFrameworkApplication.ua.Hp,v.AFrameworkApplication.ua.wx,v.AFrameworkApplication.ua.X1,v.AFrameworkApplication.ua.Xle,v.AFrameworkApplication.va));this.W.register(Wc,"Common.App.Header.ChatManager").as("Common.App.Header.IChatManager").ha().Ud(()=>new Wc(this.W.Ve("Common.App.Header.IReactSharedHeaderFocusManager")))}static main(){L.a.instance.Gc(new gf)}}
Object(m.a)(gf,"CommonAppHeaderPackage",null,[1,2]);var xh=c(761);class Qg{static w5h(b,h){switch(b){case 3:return Qg.zlm(h);case 2:return Qg.k8l(h);case 1:return Qg.vXl(h)}return""}static zlm(b){switch(b){case 1:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static k8l(b){switch(b){case 1:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString();
case 2:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static vXl(b){switch(b){case 1:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return v.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(b,h,r){if(Z.a.vi||Z.a.OG)window.setTimeout(()=>{Qg.Z8i(r,Qg.mVd())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(Qg.Fth(r),b,0,!1)}static UZk(b,h,r,B){h&&
B&&B();Qg.openInClient(b,h,r)}static mVd(){return Z.a.vi?1:Z.a.OG?2:Z.a.b5a?3:Z.a.fl?4:0}static hlm(b){switch(b){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}}static ilm(b){switch(b){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}}static get lGf(){return"zh-CN"===window.navigator.language}static Z8i(b,h){1===h?(t.ULS.sendTraceTag(17151569,
306,50,"User Directed to App Store"),b=Qg.w5h(b,h),8<Z.a.B3a?Qd.a.wm(b,void 0,void 0,"RedirectToAppStore"):Qd.a.rib(b)):document.hidden||(Qg.lGf?(b=v.AFrameworkApplication.K.appSettings.WildFireUrlChinaStoreAndroid.toString())?(t.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),Qd.a.rib(b)):t.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(t.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(Qg.w5h(b,
h),null,null)))}static Fth(b){switch(b){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get Jie(){return(Z.a.b5a||Z.a.fl)&&Z.a.Fr}static get Duo(){return Z.a.vi||Z.a.OG}static Q5h(b){switch(b){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static Xzi(b){return(b=Qg.T1l(b))&&""!==b?Boolean.parse(b):!1}static Zeg(b){Qg.lko(b)}static T1l(b){try{return localStorage.getItem(b)}catch(h){return t.ULS.sendTraceTag(18416668,
306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+h.message),null}}static lko(b){try{localStorage.setItem(b,"true")}catch(h){t.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+h.message)}}}Qg.rEh="ChromeExtensionBarDismiss";Object(m.a)(Qg,"WildFireUtilities",null,[]);var Ng=c(367);class zg{constructor(){this.Fte=new Ng.a;this.Dte=new Ng.a;this.Cte=new Ng.a;this.dNk(this.Fte);this.cNk(this.Dte);this.bNk(this.Cte);this.hEe=new Ng.a;
this.gEe=new Ng.a;this.fEe=new Ng.a;this.FPk(this.hEe);this.EPk(this.gEe);this.DPk(this.fEe);this.gwe=new Ng.a;this.nNk(this.gwe);this.KAb(this.gwe);this.KAb(this.Cte);this.KAb(this.Dte);this.KAb(this.Fte);this.KAb(this.gEe);this.KAb(this.hEe);this.KAb(this.fEe)}zUd(b,h){switch(b){case 1:return this.pmm(h);case 2:return this.ZNl(h)}return Qg.Jie?this.gwe:null}dNk(b){b.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}cNk(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}bNk(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}FPk(b){b.add("Headline",
CommonUIStrings.l_WildFireWordBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);b.add("OverlayBig","Get the Word app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1",
"Discover Word");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}nNk(b){b.add("Headline","Get the Office Online extension for Chrome");b.add("UseAppButton","Get the extension");b.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}EPk(b){b.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);b.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);
b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);b.add("OverlayBig","Get the PowerPoint app");b.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");b.add("OverlaySmallSplit1","Discover PowerPoint");b.add("OverlaySmallSplit2","designed for the iPad.");b.add("SkipButton","Skip for now")}DPk(b){b.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);b.add("UseAppButton",
CommonUIStrings.l_WildFireBizBarUseAppButtonText);b.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);b.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);b.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}KAb(b){b.add("Corporation","Microsoft Corporation")}pmm(b){switch(b){case 3:return this.hEe;case 2:return this.gEe;case 1:return this.fEe}return null}ZNl(b){switch(b){case 3:return this.Fte;case 2:return this.Dte;case 1:return this.Cte}return null}static get instance(){zg._instance||
(zg._instance=new zg);return zg._instance}}zg._instance=null;Object(m.a)(zg,"WildFireStringFactory",null,[]);class Jf{constructor(b,h,r,B,P=null,ca=null){this.aNe=null;this._id=b;this.COe=h;this.b5j=P;this.pxc=B;this.ECc=ca;this.r$a=null;this.VEc=r;this.MDc=zg.instance.zUd(h,b)}U9k(){this.r$a=new xh.a(this.title,this.message,null);this.r$a.addButton(this.WPk,Object(z.a)(this,this.Rln,"onButtonOneClick"),"");this.VEc&&this.r$a.Vph(this.bQk,Object(z.a)(this,this.Wln,"onButtonTwoClick"));this.r$a.Kga=
Object(z.a)(this,this.ppl,"dismissBar");this.r$a.image=3;this.r$a.id=16;this.r$a.closeable=!0}get title(){return this.MDc.J("Headline")}get message(){return this.MDc.J("CallToAction")}get WPk(){return this.VEc?this.MDc.J("InstallButton"):this.MDc.J("UseAppButton")}get bQk(){return this.VEc?this.MDc.J("OpenAppButton"):""}Rln(){this.VEc?this.sFm():this.O0o()}Wln(){this.VEc&&this.Jwn()}get Qzh(){return this.r$a}get NHa(){this.aNe||(this.aNe=this.b5j());return this.aNe}sFm(){t.ULS.sendTraceTag(17932829,
306,50,"Install App Button of BusinessBar Clicked");this.pxc&&this.ECc&&this.ECc();Qg.Z8i(this._id,this.COe)}Jwn(){this.NHa&&(t.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.pxc&&this.ECc&&this.ECc(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(Qg.Fth(this._id),this.NHa,0,!1))}O0o(){Qg.Jie?this.SPk():(t.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),Qg.Zeg("BizBarClicked"),1!==this.COe&&2!==this.COe||Qg.UZk(this.NHa,this.pxc,this._id,this.ECc))}SPk(){this.pxc?
t.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):t.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");Qd.a.rib(v.AFrameworkApplication.K.appSettings.WildFireChromeExtensionUrl.toString())}qpl(){this.pxc?t.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):t.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");Qg.Zeg(Qg.rEh)}ppl(){Qg.Jie?this.qpl():(Qg.Zeg(Qg.Q5h(this._id)),t.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static tcf(){const b=v.AFrameworkApplication.ua.Kb;
new Jf(b.yk,Qg.mVd(),8<Z.a.B3a,1===b.Yia,()=>b.UQ,b.Uag());t.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}}Object(m.a)(Jf,"WildFireBusinessBar",null,[]);class fc{get name(){return"Common.App.WildFire"}CZe(b){const h=v.AFrameworkApplication.ua.Kb;let r=!1;b&&(b.U9k(),b.Qzh&&(r=h.Qma(b.Qzh,!0)));return r}Z9k(){var b=v.AFrameworkApplication.ua.Kb;b=new Jf(b.yk,Qg.mVd(),!1,1===b.Yia);this.CZe(b)&&t.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}tcf(b,h,r,B,P,ca){b=new Jf(b,
r,B,h,P,ca);this.CZe(b)&&t.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}jgl(){const b=v.AFrameworkApplication.ua.Kb;var h=v.AFrameworkApplication.K;const r=b.yk,B=1===b.Yia;if(h.$(Qg.hlm(r))){var P=Qg.mVd(),ca=8<Z.a.B3a;if(2!==r||2!==P||!B){h=h.$(Qg.ilm(r));var ra=b.Uag(),Qa=()=>b.UQ;h&&!Qg.Xzi(Qg.Q5h(r))&&this.tcf(r,B,P,ca,Qa,ra)}}}init(){var b=v.AFrameworkApplication.K;const h=b.$("WildFireChromeExtensionEnabled");b=b.$("WildFireChromeExtensionBar")&&h;Qg.Jie&&b&&!Qg.Xzi(Qg.rEh)?this.Z9k():
(document.body&&Qg.Duo&&this.jgl(),v.AFrameworkApplication.va.ra(fb.a.AKf,yd.a.frame,Object(z.a)(this,this.AKf,"launchWildFireBusinessBar")))}AKf(b,h,r,B,P){if(1===r)return 32;if(!P)return 8;this.tcf(P.app,P.mode,P.platform,P.useTwoButton,null,null);return 32}dispose(){}wc(){}static main(){L.a.instance.Gc(new fc)}}Object(m.a)(fc,"PackageManager",null,[1,2]);class Fc{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=
this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(m.a)(Fc,"BrowserInfo",null,[]);class id{constructor(){this.Version=
this.Name=null}}Object(m.a)(id,"PluginInfo",null,[]);class ld{static c5(){if(v.AFrameworkApplication.K.$("LogBrowserInfoIsEnabled")){var b=ld.uKl();try{const h=JSON.stringify(b);t.ULS.sendTraceTag(6903563,102,50,h)}catch(h){t.ULS.sendTraceTag(6903564,102,15,h.message)}}else t.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static t$l(){const b=window.navigator.plugins;if(!b||!b.length)return null;const h=[];for(let r=0;r<b.length;r++){const B=b[r].name,P=b[r].version;
Array.add(h,Object.assign(new id,{Name:B,Version:P}))}return h}static uKl(){const b=new Fc,h=new Sys.StringBuilder;ld.XH(r=>{b.DocElemClientHeight=r},()=>document.documentElement.clientHeight,h);ld.XH(r=>{b.DocElemClientWidth=r},()=>document.documentElement.clientWidth,h);ld.XH(r=>{b.DocElemOffsetHeight=r},()=>document.documentElement.offsetHeight,h);ld.XH(r=>{b.DocElemOffsetWidth=r},()=>document.documentElement.offsetWidth,h);ld.XH(r=>{b.ScreenAvailHeight=r},()=>window.screen.availHeight,h);ld.XH(r=>
{b.ScreenAvailWidth=r},()=>window.screen.availWidth,h);ld.XH(r=>{b.ScreenWidth=r},()=>window.screen.width,h);ld.XH(r=>{b.ScreenHeight=r},()=>window.screen.height,h);ld.XH(r=>{b.ScreenLogicalXdpi=r},()=>window.screen.logicalXDPI,h);ld.XH(r=>{b.ScreenLogicalYdpi=r},()=>window.screen.logicalYDPI,h);ld.XH(r=>{b.ScreenDeviceXdpi=r},()=>window.screen.deviceXDPI,h);ld.XH(r=>{b.ScreenDeviceYdpi=r},()=>window.screen.deviceYDPI,h);ld.XH(r=>{b.WinInnerHeight=r},()=>window.self.innerHeight,h);ld.XH(r=>{b.WinInnerWidth=
r},()=>window.self.innerWidth,h);ld.XH(r=>{b.WinOuterHeight=r},()=>window.self.outerHeight,h);ld.XH(r=>{b.WinOuterWidth=r},()=>window.self.outerWidth,h);ld.XH(r=>{b.WinOrientation=r},()=>window.self.orientation,h);ld.XH(r=>{b.WinDevicePixelRatio=r},()=>window.self.devicePixelRatio,h);ld.XH(r=>{b.SupportsTouch=r},()=>Z.a.mbd,h);ld.XH(r=>{b.NavAppName=r},()=>window.navigator.appName,h);ld.XH(r=>{b.NavAppVersion=r},()=>window.navigator.appVersion,h);ld.XH(r=>{b.NavLanguage=r},()=>window.navigator.browserLanguage||
window.navigator.language,h);ld.XH(r=>{b.NavUserAgent=r},()=>window.navigator.userAgent,h);ld.XH(r=>{b.NavPlatform=r},()=>window.navigator.platform,h);ld.XH(r=>{b.NavPlugins=r},ld.t$l,h);ld.XH(r=>{b.CalculatedDevicePixelRatio=r},()=>ld.devicePixelRatio,h);b.Error=h.toString();return b}static get devicePixelRatio(){const b=window.devicePixelRatio;return isNaN(b)?window.screen.deviceXDPI/window.screen.logicalXDPI:b}static XH(b,h,r){try{const B=h();b(B)}catch(B){r.isEmpty()||r.append(" | "),r.append(B.message||
"null")}}}Object(m.a)(ld,"BrowserInfoLogger",null,[]);class hd{get name(){return"Common.App.BrowserInfoLogger"}wc(){}init(){ld.c5()}dispose(){}static main(){L.a.instance.Gc(new hd)}}Object(m.a)(hd,"BrowserInfoLoggerPackage",null,[1,2]);class Be{constructor(){this.sa=new Pc.a}Teb(b){this.sa.addHandler("OnEditHappenedEvent",b)}X6c(b){this.sa.removeHandler("OnEditHappenedEvent",b)}cOn(){this.sa.raiseEvent("OnEditHappenedEvent")}}Object(m.a)(Be,"EditNotificationEventSource",null,[]);var Ke=c(42),Me=c(93);
class jf{constructor(b,h,r,B,P,ca,ra=0){this.eAe=!1;this.dAe=this.uxb=null;this.vlh=!1;this.Ib=h;this.msd=b;this.Ebb=r;this.kfa=B;this.tlh=P;this.H1j=ca;this.Ckd=0;this.Omd=!1;try{0<ra&&(this.Ckd=ra,3E5>this.Ckd&&(this.Ckd=3E5),this.Ib&&!this.dAe&&(this.dAe=new Me.a(3,2,this.Ckd,Object(z.a)(this,this.T4n,"reportEditDocumentUserActionTelemetryIfNecessary")),this.Ib.Wb(this.dAe)))}catch(Qa){t.ULS.sendTraceTag(51246176,383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+
Qa)}}get crg(){return this.vlh}editHappened(){this.crg?this.Omd=!0:(this.vlh=!0,va.Health.instance.addQosPillar("Save"),va.Health.instance.addQosPillar("ContentCreation"),Ke.c(fb.a.editDocument));this.eAe=!0;this.tlh&&this.tlh.Pnh();this.kfa&&this.kfa.cOn();v.AFrameworkApplication.Og&&v.AFrameworkApplication.Og.R$m();this.H1j&&!this.uxb&&(this.c9c(null),this.uxb=new Me.a(3,2,this.msd,Object(z.a)(this,this.c9c,"sendPostMessageIfNecessary"),113),this.Ib.Wb(this.uxb))}c9c(){this.eAe&&(this.Ebb.CWR(()=>
this.Ebb.result.sendMessage(M.a.editNotification,null)),t.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.eAe=!1)}T4n(){try{this.Omd&&(Ke.c(fb.a.editDocument),this.Omd=!1)}catch(b){this.Omd=!1,t.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+b)}}}Object(m.a)(jf,"EditNotificationManager",null,[541]);class kg{constructor(b,h,r,B,P){this.hDe=this.uxb=null;this.DXb=this.Rse=!1;this.Ib=h;this.msd=
b;this.Ebb=r;this.tk=B;this.sMe=P;this.P9i(null)}P9i(){const b=document.getElementById(v.AFrameworkApplication.o3b);!this.DXb&&this.tk&&b&&(this.tk.ob(pd.a.g1,b,Object(z.a)(this,this.nQf,"mouseActivityHandler"),null),this.DXb=!0);this.sMe(()=>{this.dispose()})}nQf(){this.DXb&&(this.tk.sc(pd.a.g1,document.getElementById(v.AFrameworkApplication.o3b),Object(z.a)(this,this.nQf,"mouseActivityHandler")),this.DXb=!1);this.Pnh();return!1}Pnh(){this.Rse=!0;this.hDe||(this.hDe=new Me.a(3,2,this.msd,Object(z.a)(this,
this.P9i,"registerHandlerTask"),112),this.Ib.Wb(this.hDe));this.uxb||(this.c9c(null),this.uxb=new Me.a(3,2,this.msd,Object(z.a)(this,this.c9c,"sendPostMessageIfNecessary"),111),this.Ib.Wb(this.uxb))}c9c(){this.Rse&&(this.Ebb.CWR(()=>this.Ebb.result.sendMessage(M.a.l1o,null)),t.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this.Rse=!1)}dispose(){this.DXb&&(this.tk.sc(pd.a.g1,document.getElementById(v.AFrameworkApplication.o3b),Object(z.a)(this,
this.nQf,"mouseActivityHandler")),this.DXb=!1)}}Object(m.a)(kg,"UserActivityHostNotificationManager",null,[538,9]);var sf=c(178),Wg=c(109),Db=c(634);class Gb{constructor(){this.W=null}get name(){return"Common.App.EditNotification"}init(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.Nn(Object(z.a)(this,this.Xx,"onFullAppSettingsReady"))}Xx(){Gb.Stl&&0<Gb.rhf&&(this.W.register(Be,"Common.App.HostNotification.EditNotificationEventSource").ha(),this.W.register(kg,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").ha().Ud(()=>
new kg(6E4,Wg.a.instance,Db.a.Gp(this.W.Ta("Postmessage.IHostPostmessenger")),sf.a.instance,v.AFrameworkApplication.qI)),this.W.register(jf,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").ha().Ud(()=>new jf(Gb.rhf,Wg.a.instance,Db.a.Gp(this.W.Ta("Postmessage.IHostPostmessenger")),this.W.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.W.Oa("Common.Interface.IUserActivityHostNotificationManager"),Gb.Ttl,Gb.Ltl)),this.W.resolve("Common.Interface.IEditNotificationManager"),
t.ULS.shipAssertTag(38086291,209,0<Gb.rhf,"EditNotification Interval is less than or equal to 0."))}wc(b){this.W=b}dispose(){}static get rhf(){return v.AFrameworkApplication.K?parseInt(v.AFrameworkApplication.K.appSettings.EditNotificationTimeIntervalMs||"300000"):3E5}static get Ltl(){return v.AFrameworkApplication.K?parseInt(v.AFrameworkApplication.K.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0}static get Stl(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("EditNotificationIsEnabled")}static get Ttl(){return!!v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.$("EditNotificationPostMessageIsEnabled")}static main(){L.a.instance.Gc(new Gb)}}Object(m.a)(Gb,"CommonHostNotificationPackage",null,[1,2]);class $c{constructor(b,h,r){this.pzb=null;this.Ib=b;this.ga=h;this.eWg=r.create()}Zob(){this.pzb?t.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(t.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.pzb=new Me.a(2,1,3E4,Object(z.a)(this,this.Wie,"showFloatPane"),
67),this.Ib.Wb(this.pzb))}Wie(){this.pzb=null;t.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.eWg.display()}ETa(){this.ga.ra(fb.a.Wie,yd.a.frame,Object(z.a)(this,this.Nwo,"showFloatPaneHandler"))}Nwo(b,h,r,B,P){return b!==fb.a.Wie?2:1===r?32:2===r&&P?(t.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",P),P?this.Zob():(this.pzb?(t.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),
this.Ib.ff(this.pzb)):(t.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.eWg.remove(null)),this.pzb=null),32):8}}Object(m.a)($c,"FloatPaneActor",null,[540]);var Bd=c(96),we=c(91),He=c(38),Se=c(28);class jg{constructor(b,h,r,B,P){this.LJe=this.lwc=this.lvd=this.gZa=this.Mfa=this.zWa=this.Zue=this.Zaa=this.QAc=this.Jyc=this.Kyc=this.NBe=null;this.Ib=h;this.Ca=b;this.ig=r;this.W=P;this.KAa=B}PLh(){this.Zaa=document.createElement("div");this.Zaa.className=String.format("{0} {1}",
"WACFloatPane","WACFloatPaneFadeIn");this.Zaa.style.width=this.Mfa.width+"px";(this.LJe=this.f7l(this.KAa))?(this.gZa=document.createElement("a"),this.gZa.setAttribute(Se.a.uh,Se.a.wz),this.ig.ob(pd.a.click,this.gZa,Object(z.a)(this,this.HXi,"onRedirectClick")),this.gZa.href=this.LJe,this.gZa.target="_blank",this.gZa.appendChild(this.Mfa),this.Zaa.appendChild(this.gZa)):this.Zaa.appendChild(this.Mfa);this.zWa=document.createElement("a");this.zWa.setAttribute(Se.a.uh,Se.a.X3);this.zWa.className="StandardButton WACFloatPaneCloseButton";
this.zWa.title=CommonUIStrings.l_Close;this.zWa.tabIndex=-1;this.Zue=we.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.Zue.setAttribute(Se.a.uh,Se.a.wz);this.zWa.appendChild(this.Zue);this.ig.ob(pd.a.click,this.zWa,Object(z.a)(this,this.onClose,"onClose"));this.Zaa.appendChild(this.zWa);this.QAc.appendChild(this.Zaa)}L0l(b){const h=this.Ca.$("O365PromotionHasStarted");switch(b){case 2:return Bd.a.Tba(String.format("adppt{0}.png",
h?"sale":""));case 1:return Bd.a.Tba(String.format("adxls{0}.png",h?"sale":""));case 3:return Bd.a.Tba(String.format("addoc{0}.png",h?"sale":""))}return null}f7l(b){const h=this.Ca.kb("O365AdPaneRedirectedURL");switch(b){case 1:return String.format(h,"Excel");case 2:return String.format(h,"PowerPoint");case 3:return String.format(h,"Word")}return null}hide(b=null){this.lwc=null;this.Zaa&&!this.lvd&&(b?t.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):t.ULS.sendTraceTag(23674903,
207,50,"User clicks button to close the float pane."),this.Zaa.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.Zaa.style.height="0px",this.lvd=new Me.a(2,1,1E3,Object(z.a)(this,this.remove,"remove"),67),this.Ib.Wb(this.lvd))}remove(){this.Zaa&&this.QAc&&(this.gZa&&this.ig.sc(pd.a.click,this.gZa,Object(z.a)(this,this.HXi,"onRedirectClick")),this.ig.sc(pd.a.click,this.zWa,Object(z.a)(this,this.onClose,"onClose")),this.QAc.removeChild(this.Zaa),this.Zaa=null);this.lvd=null}display(){if(this.NBe=
this.W.Oa("Common.IFloatPaneContainer"))if(this.QAc=this.NBe.container){var b=this.L0l(this.KAa);b?(t.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",b),this.Mfa=document.createElement("img"),this.Mfa.className="WACFloatPaneImage",this.Kyc=Object(z.a)(this,this.Fqn,"onLoadImageFinish"),He.a.addHandler(this.Mfa,pd.a.load,this.Kyc),this.Jyc=Object(z.a)(this,this.Eqn,"onLoadImageError"),He.a.addHandler(this.Mfa,pd.a.error,this.Jyc),this.Mfa.src=b):t.ULS.sendTraceTag(23674907,
207,15,"The target image is empty, can't show the float pane.")}else t.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else t.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}Fqn(){const b=this.Ca.mc("O365AdPaneShowingDuration",60);this.PLh();this.Zaa.style.display="block";this.Zaa.style.height=this.Mfa.height+"px";this.lwc=new Me.a(2,1,1E3*b,Object(z.a)(this,this.hide,"hide"),67);this.Ib.Wb(this.lwc);
this.vaj()}Eqn(){t.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.vaj();this.Mfa=null}vaj(){this.Kyc&&this.Mfa&&He.a.removeHandler(this.Mfa,pd.a.load,this.Kyc);this.Kyc=null;this.Jyc&&this.Mfa&&He.a.removeHandler(this.Mfa,pd.a.error,this.Jyc);this.Jyc=null}HXi(){t.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1}onClose(){this.lwc&&this.Ib.ff(this.lwc);this.hide();return!0}dispose(){this.hide()}}
Object(m.a)(jg,"FloatPane",null,[566]);class Hi{constructor(b,h,r,B,P){this.Ib=h;this.Ca=b;this.ig=r;this.W=P;this.KAa=B}create(){return new jg(this.Ca,this.Ib,this.ig,this.KAa,this.W)}}Object(m.a)(Hi,"FloatPaneFactory",null,[539]);var ii=c(232);class Zh{constructor(){this.W=null}get name(){return"Common.App.FloatPane"}get tyi(){return v.AFrameworkApplication.K.$("O365AdvertisementIsEnabled")&&v.AFrameworkApplication.K.$("IsShowAdvertisementPaneEnabled")}init(){this.tyi&&(t.ULS.sendTraceTag(23674944,
207,50,"Setup task to show the float pane."),this.W.resolve("Common.App.FloatPane.IFloatPaneActor").Zob(),t.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.W.resolve("Common.App.FloatPane.IFloatPaneActor").ETa())}wc(b){this.W=b;this.tyi&&(this.W.register(Hi,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").Ud(()=>new Hi(v.AFrameworkApplication.K,v.AFrameworkApplication.lc,ii.a.instance,v.AFrameworkApplication.ua.Kb.yk,this.W)).ha(),
this.W.register($c,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").Ud(()=>new $c(v.AFrameworkApplication.lc,v.AFrameworkApplication.va,this.W.resolve("Common.App.FloatPane.IFloatPaneFactory"))).ha())}dispose(){}static main(){L.a.instance.Gc(new Zh)}}Object(m.a)(Zh,"FloatPanePackage",null,[1,2]);var vg=c(1677);class vf{}Object(m.a)(vf,"LokiTokenResult",null,[]);class Lf{constructor(b){this.usd=b}ssf(){const b=this.d4l();return b?Lf.L4a?new Promise((h,r)=>{this.usd.continueWith(()=>
{this.usd.Io||this.usd.Gi?r(Error.create("Error downloading auth library")):this.usd.result.OV("Loki",b).then(B=>{B=v.AFrameworkApplication.K.$("ForceLokiFallbackToACLPTokenIsEnabled")?this.g4l():B.IsSuccess&&B.Token?Object.assign(new vf,{isSuccess:!0,token:B.Token,errorMessage:null}):Object.assign(new vf,{isSuccess:!1,token:null,errorMessage:JSON.stringify(B)});h(B);return B})})}):Promise.resolve(Object.assign(new vf,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):
Promise.resolve(Object.assign(new vf,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",vg.a.E5h())}))}g4l(){const b=v.AFrameworkApplication.K.kb("LokiUserDataSignature")||"";return Object.assign(new vf,{isSuccess:!0,token:b,errorMessage:null})}d4l(){let b=null;const h=vg.a.vQd();2===h?b=v.AFrameworkApplication.K.kb("LokiAADAppId"):1===h&&(b=v.AFrameworkApplication.K.kb("LokiMSAAppId"));return b}static get L4a(){return v.AFrameworkApplication.K.$("IsO365CommercialHost")||
v.AFrameworkApplication.K.$("IsO365ConsumerHost")}}Object(m.a)(Lf,"LokiTokenManager",null,[537]);class Cg{get name(){return"Common.App.LivePersonaUtils"}init(){Ma.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}wc(b){b.register(Lf,"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").ha().Ud(()=>new Lf(Db.a.Gp(b.Ta("Common.App.OAuth.IOAuthManager"))))}static main(){L.a.instance.Gc(new Cg)}}Object(m.a)(Cg,"LivePersonaUtilsPackage",null,[1,2]);class bg{constructor(b){this.yte=
b}yxi(b){if(!this.yte)return!0;b=ia.a.trf(b);if(!b)return!1;b=b.toLowerCase();for(let h=0;h<this.yte.length;h++)if(b.endsWith(this.yte[h]))return!0;return!1}}Object(m.a)(bg,"DomainAllowListManager",null,[]);class eg{constructor(b,h){this.sdf=null;this.dWe=b;this.url=h}get Kqg(){return ia.a.Kja(this.url)}get vs(){return this.dWe}Pmg(){const b={},h=this.vs;b.a=this.Kqg;b.b=this.round(h.navigationStart);b.c=this.round(h.unloadEventStart);b.d=this.round(h.unloadEventEnd);b.e=this.round(h.redirectStart);
b.f=this.round(h.redirectEnd);b.g=this.round(h.fetchStart);b.h=this.round(h.domainLookupStart);b.i=this.round(h.domainLookupEnd);b.j=this.round(h.connectStart);b.k=this.round(h.connectEnd);b.l=void 0!==h.secureConnectionStart&&null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.m=this.round(h.requestStart);b.n=this.round(h.responseStart);b.o=this.round(h.responseEnd);b.q=this.round(h.domInteractive);b.r=this.round(h.domContentLoadedEventStart);b.s=this.round(h.domContentLoadedEventEnd);
b.t=this.round(h.domComplete);b.u=this.round(h.loadEventStart);b.v=this.round(h.loadEventEnd);b.w=this.sdf;return b}round(b){return Math.round(1E3*b)/1E3}}Object(m.a)(eg,"PerformanceTimingEntry",null,[]);const sh=(b,h)=>{const r={};let B=null;switch(b){case 0:B="ResourceTiming";b=h.a;null!=b&&(r.Url=b);b=h.b;null!=b&&(r.InitiatorType=b);b=null==h.c?null:h.c.toString();null!=b&&(r.RedirectStart=b);b=null==h.d?null:h.d.toString();null!=b&&(r.RedirectEnd=b);b=null==h.e?null:h.e.toString();null!=b&&(r.FetchStart=
b);b=null==h.f?null:h.f.toString();null!=b&&(r.DomainLookupStart=b);b=null==h.g?null:h.g.toString();null!=b&&(r.DomainLookupEnd=b);b=null==h.h?null:h.h.toString();null!=b&&(r.ConnectStart=b);b=null==h.i?null:h.i.toString();null!=b&&(r.ConnectEnd=b);b=null==h.j?null:h.j.toString();null!=b&&(r.SecureConnectionStart=b);b=null==h.k?null:h.k.toString();null!=b&&(r.RequestStart=b);b=null==h.l?null:h.l.toString();null!=b&&(r.ResponseStart=b);b=null==h.m?null:h.m.toString();null!=b&&(r.ResponseEnd=b);b=h.n;
null!=b&&(r.CustomText=b);b=null==h.o?null:h.o.toString();null!=b&&(r.DecodedBodySize=b);b=null==h.p?null:h.p.toString();null!=b&&(r.EncodedBodySize=b);h=null==h.q?null:h.q.toString();null!=h&&(r.TransferSize=h);break;case 1:B="PerformanceTiming",b=h.a,null!=b&&(r.Url=b),b=null==h.b?null:h.b.toString(),null!=b&&(r.NavigationStart=b),b=null==h.c?null:h.c.toString(),null!=b&&(r.UnloadEventStart=b),b=null==h.d?null:h.d.toString(),null!=b&&(r.UnloadEventEnd=b),b=null==h.e?null:h.e.toString(),null!=b&&
(r.RedirectStart=b),b=null==h.f?null:h.f.toString(),null!=b&&(r.RedirectEnd=b),b=null==h.g?null:h.g.toString(),null!=b&&(r.FetchStart=b),b=null==h.h?null:h.h.toString(),null!=b&&(r.DomainLookupStart=b),b=null==h.i?null:h.i.toString(),null!=b&&(r.DomainLookupEnd=b),b=null==h.j?null:h.j.toString(),null!=b&&(r.ConnectStart=b),b=null==h.k?null:h.k.toString(),null!=b&&(r.ConnectEnd=b),b=null==h.l?null:h.l.toString(),null!=b&&(r.SecureConnectionStart=b),b=null==h.m?null:h.m.toString(),null!=b&&(r.RequestStart=
b),b=null==h.n?null:h.n.toString(),null!=b&&(r.ResponseStart=b),b=null==h.o?null:h.o.toString(),null!=b&&(r.ResponseEnd=b),b=null==h.p?null:h.p.toString(),null!=b&&(r.DomLoading=b),b=null==h.q?null:h.q.toString(),null!=b&&(r.DomInteractive=b),b=null==h.r?null:h.r.toString(),null!=b&&(r.DomContentLoadedEventStart=b),b=null==h.s?null:h.s.toString(),null!=b&&(r.DomContentLoadedEventEnd=b),b=null==h.t?null:h.t.toString(),null!=b&&(r.DomComplete=b),b=null==h.u?null:h.u.toString(),null!=b&&(r.LoadEventStart=
b),b=null==h.v?null:h.v.toString(),null!=b&&(r.LoadEventEnd=b),h=h.w,null!=h&&(r.CustomText=h)}r.Table=B;return Sys.Serialization.JavaScriptSerializer.serialize(r)};var nh=c(49),Sh=c(235),Xk=c(171);class rl{constructor(b,h=null,r=null){this.Vf=b;this.Jqg=this;this.h4j=h||(()=>window.location.href);this.Mze=new bg(r)}run(){if(rl.Cfb(window.performance))try{const P=this.h4j();if(rl.nnk.exec(P)&&this.Mze.yxi(P)){var b=new eg(window.performance.timing,P);Xk.a.instance.aRn(b.vs.fetchStart);Xk.a.instance.bRn(b.vs.navigationStart);
Xk.a.instance.OY(nh.a.IJl,"connectStart","requestStart");Xk.a.instance.OY(nh.a.QJl,"requestStart","responseStart");Xk.a.instance.OY(nh.a.TJl,"responseStart","responseEnd");this.Jqg.v5a(1,b.Pmg());this.Vf.pf(nh.a.xib,b.vs.fetchStart);this.Vf.pf(nh.a.NJl,b.vs.domainLookupStart);this.Vf.pf(nh.a.MJl,b.vs.domainLookupEnd);this.Vf.pf(nh.a.KJl,b.vs.connectStart);this.Vf.pf(nh.a.VJl,b.vs.secureConnectionStart);this.Vf.pf(nh.a.JJl,b.vs.connectEnd);this.Vf.pf(nh.a.RJl,b.vs.requestStart);this.Vf.pf(nh.a.Umf,
b.vs.responseStart);this.Vf.pf(nh.a.OJl,b.vs.responseEnd-b.vs.responseStart);this.Vf.pf(nh.a.SJl,b.vs.responseStart-b.vs.requestStart);var h=0,r=0,B=0;({transferSize:h,fif:r,Qdf:B}=this.hQo(P)).returnValue&&(this.Vf.pf(nh.a.XJl,h),this.Vf.pf(nh.a.LJl,B),this.Vf.pf(nh.a.PJl,r));this.Vf.pf(nh.a.$Oc,b.vs.navigationStart)}}catch(P){t.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",P)}}hQo(b){let h,r,B;B=r=h=-1;if(void 0===window.performance.getEntriesByName||null===
window.performance.getEntriesByName)return{returnValue:!1,transferSize:h,fif:r,Qdf:B};b=window.performance.getEntriesByName(b,"navigation");if(void 0===b||null===b||1!==b.length)return{returnValue:!1,transferSize:h,fif:r,Qdf:B};b=b[0];var P=b.transferSize;void 0!==h&&null!==h&&(h=P);P=b.decodedBodySize;void 0!==P&&null!==P&&(B=P);b=b.encodedBodySize;void 0!==b&&null!==b&&(r=b);return{returnValue:!0,transferSize:h,fif:r,Qdf:B}}v5a(b,h){t.ULS.sendTraceTag(4551815,306,50,sh(b,h))}static get instance(){return rl._instance||
(rl._instance=new rl(Sh.a.instance,null,v.AFrameworkApplication.K.$("PerfTimingLoggerFilterDomainsIsEnabled")?v.AFrameworkApplication.K.DB("ResourceLoggerDomainAllowList"):null))}static Cfb(b){return!(void 0===b||null===b)&&!(void 0===b.timing||null===b.timing)}}rl._instance=null;rl.nnk=RegExp("^https?://.*","i");Object(m.a)(rl,"PerformanceTimingLogger",null,[536]);class sl{constructor(b,h){this.sdf=null;this.dWe=b;this.behavior=h;this.url=this.vs.name}get Kqg(){return 2===this.behavior?this.url:
ia.a.Kja(this.url)}get vs(){return this.dWe}Pmg(){const b={},h=this.vs;b.a=this.Kqg;b.b=h.initiatorType;b.c=this.round(h.redirectStart);b.d=this.round(h.redirectEnd);b.e=this.round(h.fetchStart);b.f=this.round(h.domainLookupStart);b.g=this.round(h.domainLookupEnd);b.h=this.round(h.connectStart);b.i=this.round(h.connectEnd);b.j=void 0!==h.secureConnectionStart&&null!==h.secureConnectionStart?this.round(h.secureConnectionStart):0;b.k=this.round(h.requestStart);b.l=this.round(h.responseStart);b.m=this.round(h.responseEnd);
b.o=this.round(sl.yjb(h,"decodedBodySize"));b.p=this.round(sl.yjb(h,"encodedBodySize"));b.q=this.round(sl.yjb(h,"transferSize"));b.n=this.sdf;return b}round(b){return Math.round(1E3*b)/1E3}static yjb(b,h){return b[h]}}Object(m.a)(sl,"ResourceTimingEntry",null,[567]);class Xf{constructor(b,h=null,r=100){this.ULg=b;this.Uxd=h;this.o$a={};this.sYj=r}NOo(b){var h=b.name.toLowerCase();const r=ia.a.RGb(h);this.Sej(r,h)&&(r in this.o$a?t.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",
r):(h={},h.fetchstart=b.fetchStart,h.responseend=b.responseEnd,h.iscached=this.ZDi(b),h.encodedsize=sl.yjb(b,"encodedBodySize"),h.decodedsize=sl.yjb(b,"decodedBodySize"),this.o$a[r]=h))}OOo(b){var h=b.name.toLowerCase();const r=ia.a.RGb(h);this.J7n(r,h)&&(r in this.o$a?t.ULS.sendTraceTag(508925201,306,50,"AppStaticResourceManager: file downloaded multiple times for filename: {0}",r):(h={},h.fetchstart=b.fetchStart,h.responseend=b.responseEnd,h.iscached=this.ZDi(b),h.encodedsize=sl.yjb(b,"encodedBodySize"),
h.decodedsize=sl.yjb(b,"decodedBodySize"),h.it=b.initiatorType,h.ress=b.responseStart,h.cs=b.connectStart,h.ce=b.connectEnd,h.dls=b.domainLookupStart,h.dle=b.domainLookupEnd,h.rs=b.redirectStart,h.re=b.redirectEnd,h.reqs=b.requestStart,h.scs=b.secureConnectionStart,this.o$a[r]=h))}Sej(b,h){if(this.ULg)return Array.contains(this.ULg,b);if(this.Uxd)for(b=ia.a.aY(h),h=0;h<this.Uxd.length;h++)if(this.Uxd[h]&&b.endsWith(this.Uxd[h]))return!0;return!1}J7n(b,h){return this.Sej(b,h)?b.endsWith(".js")||b.endsWith(".css"):
!1}ZDi(b){try{const h=sl.yjb(b,"transferSize");if(void 0!==h&&null!==h)return!h;t.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return b.responseEnd-b.fetchStart<this.sYj}catch(h){t.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",h.message)}return!1}BTn(){if(kb.a.af(this.o$a))t.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");
else{var b=v.AFrameworkApplication.flightId?v.AFrameworkApplication.flightId.split(";"):[],h=Object.assign(new hc.a,{extendedProperties:lb.a.vG()});h.extendedProperties.set("Flights",H.c(b));this.$Ki(h,this.o$a,va.Health.instance)}}Rnf(b){let h=0,r=0,B=0,P=0;const ca=this.o$a;for(let Qa in ca){var ra=ca[Qa];Qa.endsWith(".js")&&(ra=Object(Ra.a)(Object,ra),ra.responseend<b&&(h+=1,r+=ra.decodedsize,P+=ra.encodedsize,B+=ra.iscached?0:ra.encodedsize))}b={};b.filesLoaded=h;b.decodedBytes=r;b.transferredBytes=
B;b.encodedBytes=P;return b}$Ki(b,h,r){if(h){var B=0,P=0,ca=0,ra=0,Qa=0,tb=0,Mb=0,Zb=0,jc=0,Gc=0,Uc=0;for(let Od in h){var od=h[Od];try{const ze=Object(Ra.a)(Object,od);if(!ze)continue;const de=ze.iscached?Boolean.parse(ze.iscached.toString()):!1,ee=ze.fetchstart?this.parseFloat(ze.fetchstart.toString()):0,je=(ze.responseend?this.parseFloat(ze.responseend.toString()):0)-ee,ue=ze.encodedsize?this.parseFloat(ze.encodedsize.toString()):0,Qf=ze.decodedsize?this.parseFloat(ze.decodedsize.toString()):0;
B+=je;ra+=ue;Mb+=Qf;Gc++;de?(ca+=je,tb+=ue,jc+=Qf,Uc++):(P+=je,Qa+=ue,Zb+=Qf)}catch(ze){t.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",ze.message)}}b.extendedProperties.set("StaticResources",H.c(h));b.extendedProperties.set("TotalResourceDownloadLatency",B.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",P.toString());b.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",ca.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",
ra.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Qa.toString());b.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",tb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Mb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Zb.toString());b.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",jc.toString());b.extendedProperties.set("TotalNumberOfResourcesDownloaded",Gc.toString());
b.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",Uc.toString());r.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);r.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",b)}}parseFloat(b){if(!b)return 0;b=parseFloat(b);return isNaN(b)?0:b}}Object(m.a)(Xf,"AppStaticResourceManager",null,[]);class Dl extends Sys.EventArgs{constructor(b){super();this.entries=b}}Object(m.a)(Dl,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class rg{constructor(b,
h,r=null,B=null,P=100,ca=!1){this.SHe=!1;this.Do=null;this.htc=0;this.sa=new Pc.a;this.atb=null;this.c_=!1;this.Ejh=0;this.Ib=b;this.NRg=0;this.Jqg=this;this.Mze=new bg(r);this.JK=h;B&&(this.atb=new Xf(null,B,P));this.yVj=ca}get Vyh(){try{return!(void 0===this.JK||null===this.JK)&&!(void 0===this.JK.getEntriesByType||null===this.JK.getEntriesByType)}catch(b){return t.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",b),!1}}get Ail(){return this.NRg}get isActive(){return this.c_}get Emg(){return this.Ejh}Eqh(b){this.sa.addHandler(rg.ejf,
b)}Dbj(b){this.sa.removeHandler(rg.ejf,b)}wc(b,h){const r=this.Emg!==b;this.Ejh=b;this.isActive&&this.Ib&&r&&(this.ff(),this.Wb());this.NRg=h}activate(){!this.isActive&&this.Vyh&&(this.Wb(),this.c_=!0)}deactivate(b){this.isActive&&(this.ff(),b&&this.flush(),this.c_=!1)}flush(){if(this.isActive&&this.Vyh)try{var b=window.performance.getEntriesByType("resource");0<b.length-this.htc&&t.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",
b.length-this.htc);const h=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);h&&(window.performance.clearResourceTimings(),this.htc=0);const r=[];for(let B=this.htc;B<b.length;B++)this.Mze.yxi(b[B].name)&&(this.atb&&(this.yVj?this.atb.OOo(b[B]):this.atb.NOo(b[B])),r.push(new sl(b[B],this.Ail)));h||(this.htc=b.length);this.sa.raiseEvent(rg.ejf,new Dl(r));for(b=0;b<r.length;b++)0!==r[b].behavior&&2!==r[b].behavior||this.Jqg.v5a(0,r[b].Pmg());0<r.length&&
t.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",r.length)}catch(h){t.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",h)}}v5a(b,h){t.ULS.sendTraceTag(4310804,306,50,sh(b,h))}WQn(){this.atb.BTn()}Rnf(b){return this.atb.Rnf(b)}Wb(){this.Ib&&0<this.Emg&&(this.Do=new Me.a(3,2,1E3*this.Emg,()=>{this.flush()},5),this.Ib.Wb(this.Do),this.SHe=!0)}ff(){this.SHe&&(this.Ib.ff(this.Do),this.Do=null,this.SHe=
!1)}}rg.ejf="EntriesAvailable";Object(m.a)(rg,"ResourceTimingLogger",null,[497,536]);class Hm{constructor(){this.W=null}get name(){return"Common.ResourceTiming"}init(){this.W.resolve("Common.NetworkTiming.IResourceTimingLogger");rl.instance.run()}dispose(){}wc(b){this.W=b;let h=null;if(v.AFrameworkApplication.K.$("ResourceLoggerFilterDomainsIsEnabled"))try{h=v.AFrameworkApplication.K.DB("ResourceLoggerDomainAllowList")}catch(ca){t.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const r=
[];r.push(ia.a.aY(Bd.a.Z5).toLowerCase());r.push(ia.a.aY(Bd.a.p$c).toLowerCase());const B=v.AFrameworkApplication.K.mc("AppStaticResourceMonitorCacheThresholdInMs",100),P=v.AFrameworkApplication.K.$("PPTAggregateResourceTimingV2Enabled");b.register(497,"Common.NetworkTiming.IResourceTimingLogger").ha().Ud(()=>new rg(v.AFrameworkApplication.lc,window.performance,h,r,B,P))}static main(){L.a.instance.Gc(new Hm)}}Object(m.a)(Hm,"ResourceTimingPackage",null,[1,2]);var pf=c(249);class vh{constructor(){this.Ose=
{}}yqk(b){this.Ose[b.id.toString()]=b}Bin(b){const h=this.Ose;for(let r in h)h[r].notify(b,!1);this.Ose={}}MLn(b,h){h&&this.yqk(h);return this.UXi(b,h)}Shf(b){this.Bin(b)}sWh(b,h){b.notify(h,!0)}}Object(m.a)(vh,"AEventEmitter",null,[534]);var ri;(function(b){b[b.notStarted=0]="notStarted";b[b.waiting=1]="waiting";b[b.shouldRetry=2]="shouldRetry";b[b.complete=3]="complete"})(ri||(ri={}));Object(m.b)("EventResultState",ri);class tl{constructor(){this._state=0}get state(){return this._state}set state(b){t.ULS.sendTraceTag(5849616,
202,50,"Changing event result state. {0}",{["OldState"]:ri[this._state],["NewState"]:ri[b]},"ResultType",this.rgi());this._state=b}}Object(m.a)(tl,"AEventResult",null,[579]);class ci extends tl{constructor(){super();this.uUe=this.jBc=null;this.state=0;this.uFe=this.L_g=!1}get Rda(){return this.jBc}get A8a(){return this.uUe}get zFm(){return this.L_g}rgi(){return"GetMoreInfo Result"}}Object(m.a)(ci,"GetMoreInfoResult",tl,[582,579]);var Li=c(1397),kj=c(1578),El=c(1071);class Ph{constructor(b,h,r,B,P,
ca,ra,Qa){this.ga=b;this.$f=h;this.Nh=r;this.KAa=B;this.Ib=P;this.yD=ca;this.B5j=ra;this.qyd=Qa}XUn(){this.lgc.ra(fb.a.rhc,yd.a.frame,Object(z.a)(this,this.rhc,"openUrlInNewTab"));this.lgc.ra(fb.a.BZf,yd.a.frame,Object(z.a)(this,this.BZf,"openDocumentUrl"));v.AFrameworkApplication.gha?this.cLi():this.lgc.fb(fb.a.QLd,yd.a.frame,Object(z.a)(this,this.QLd,"documentLoaded"),96)}rhc(b,h,r,B,P){P&&P.MenuItemId&&(t.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:P.SourceControlId,["AppType"]:El.a[this.Dda]}),
Qd.a.wm(P.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}BZf(b,h,r,B,P){if(P&&P.MenuItemId){const ca=v.AFrameworkApplication.K.$("WacInTabOpenMRUIsEnabledForUiHost"),ra=v.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");t.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",ca,ra);if(ca&&ra){t.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:P.SourceControlId,["AppType"]:El.a[this.Dda]});
b=P.MenuItemId.toString();const Qa={};Qa[G.a.ejc]="1";Qa[G.a.documentUrl]=b;Qa[G.a.reason]=kj.a.open;t.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");v.AFrameworkApplication.mP().execute(tb=>{tb.sendMessage(M.a.eEb,Qa)})}else this.rhc(b,h,r,B,P)}return 32}QLd(){this.cLi();return 32}hSa(b,h,r=""){if(h&&h.$H){const B=Li.a[h.status];h=h.$H.getTime();const P=this.nq()-h;t.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:b,["RequestStatus"]:B,
["ElapsedMs"]:P,["StartTime"]:h,["Notes"]:r})}else t.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:b})}cLi(){var b=v.AFrameworkApplication.K.$("QPGVCI"),h=ia.a.kP(document.URL,"wdNewAndOpenCt",b);if(h){h=parseInt(h);var r=ia.a.kP(document.URL,"wdPreviousSession",b);b=ia.a.kP(document.URL,"wdPreviousCorrelation",b);var B=v.AFrameworkApplication.K.$("NAOPLP");if(v.AFrameworkApplication.gha){var P=v.AFrameworkApplication.gha.getTime();
!h||h>P?t.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:h,["DocumentLoadedTime"]:P,["SessionId"]:r,["Correlation"]:b}):t.ULS.sendTraceTag(5849683,202,B?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:P-h,["ClickTimestamp"]:h,["SessionId"]:r,["Correlation"]:b})}else t.ULS.sendTraceTag(5849681,202,B?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",
{["ClickTimestamp"]:h,["SessionId"]:r,["Correlation"]:b})}}get lgc(){return this.ga.value}get l1c(){return this.$f.value}get fRi(){return this.Nh.value}get Dda(){return this.KAa.value}get P5d(){return this.Ib.value}get nq(){return this.yD}get CSa(){return this.B5j.value}get XUa(){return this.qyd.value}static get instance(){return Ph._instance||(Ph._instance=Ph.Xr())}static Xr(){return new Ph(new pf.a(()=>v.AFrameworkApplication.va),new pf.a(()=>v.AFrameworkApplication.He),new pf.a(()=>v.AFrameworkApplication.ua),
new pf.a(()=>v.AFrameworkApplication.ua.Kb.yk),new pf.a(()=>v.AFrameworkApplication.lc),()=>(new Date).getTime(),new pf.a(()=>v.AFrameworkApplication.ua.Kb.CSa),new pf.a(()=>v.AFrameworkApplication.XUa))}}Ph._instance=null;Object(m.a)(Ph,"NewAndOpenCommonHelpers",null,[533]);class ji{constructor(b,h,r){this.Pwd=this.Do=null;this.WQe=0;this.Sik=b;this.Ib=h;this.oSg=r}ZAk(){this.WQe=this.Qjc+1}q$f(b){this.Do&&(this.Ib.ff(this.Do),this.Do=null);b&&(this.WQe=0)}$Co(b){const h=this.KKo;0<=h?(this.ZAk(),
this.q$f(!1),this.Do=new Me.a(4,1,h,b,107),this.Ib.Wb(this.Do)):(this.q$f(!0),t.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.oSg}))}get Qjc(){return this.WQe}get KKo(){return this.Qjc>=this.ckj.length?-1:this.ckj[this.Qjc]}get ckj(){if(!this.Pwd){const b=(this.Sik.value||"0").split(",");this.Pwd=[];for(let h=0;h<b.length;h++){const r=parseInt(b[h]);isNaN(r)?t.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.oSg,["Entry"]:b[h]}):
Array.add(this.Pwd,r)}}return this.Pwd}}Object(m.a)(ji,"RetryHelper",null,[]);class ej extends vh{constructor(b,h){super();this.YBa=b;this.mCc=new ji(h,this.S0c.P5d,"GetMoreInfo");this.Mp=new ci}Y9m(){this.MOf("Document opened")}jcl(b){return()=>{this.MOf(b,!0)}}UXi(b,h=null){t.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:b});3===this.Mp.state?(h&&this.sWh(h,this.Mp),t.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:b})):
this.MOf(b);return this.Mp}MOf(b,h=!1){this.mCc.q$f(!h);1===this.Mp.state?t.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:b,["RetryIndex"]:this.mCc.Qjc}):(t.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:b,["RetryIndex"]:this.mCc.Qjc}),this.Mp.state=1,h=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.S0c.CSa,v.AFrameworkApplication.em),this.S0c.l1c.QAb(h,1,null,null,[ej.ibh,ej.Xhh],5,this.Wal(),this.Val(b)))}Wal(){return b=>
{var h=!1;let r=!1;var B=!1,P;v.AFrameworkApplication.K.$("GetMoreInfoDataFromResponseBody")&&(b.data.se?({Gt:P}=H.d(b.data.se)).returnValue?P?(B=!0,this.Mp.uUe=P.StorageServiceDisplayName,this.Mp.jBc=ej.NEi(P.PersonalFileStorageUrl)?P.PersonalFileStorageUrl:"",""===this.Mp.Rda&&"SharePointOnlineConsumer"===v.AFrameworkApplication.K.kb("FileSource")&&(this.Mp.jBc=ia.a.Kja(v.AFrameworkApplication.breadcrumbFolderUrl)),h=""===this.Mp.Rda&&""!==this.Mp.A8a):t.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):
t.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):t.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));B||((P=b.data.Dj)?(this.Mp.uUe=(P[ej.Xhh]||"").toString(),h=(P[ej.ibh]||"").toString(),this.Mp.jBc=ej.NEi(h)?h:"",""===this.Mp.Rda&&"SharePointOnlineConsumer"===v.AFrameworkApplication.K.kb("FileSource")?(this.Mp.jBc=ia.a.Kja(v.AFrameworkApplication.breadcrumbFolderUrl),
h=""===this.Mp.Rda&&""!==this.Mp.A8a):h=""===h&&""!==this.Mp.A8a):(t.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),r=!0));B=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.mCc.Qjc,r,h,B);this.S0c.hSa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",b.data,B);this.skj(3,h,r)}}Val(b){return h=>{this.S0c.hSa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",h.data,"Failure");
this.skj(2);this.mCc.$Co(this.jcl(b))}}skj(b,h=!1,r=!1){this.Mp.state=b;this.Mp.L_g=h;this.Mp.uFe=r;this.Shf(this.Mp)}get S0c(){return this.YBa.value}static get instance(){return ej._instance||(ej._instance=ej.Xr())}static Xr(){return new ej(new pf.a(()=>Ph.instance),new pf.a(()=>v.AFrameworkApplication.s5l))}static NEi(b){if(!b)return t.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(F.a.eh(b).startsWith("https://"))return!0;t.ULS.sendTraceTag(5849625,
202,10,"StorageUrl has invalid scheme.");return!1}}ej.ibh="PersonalFileStorageUrl";ej.Xhh="StorageServiceDisplayName";ej._instance=null;Object(m.a)(ej,"GetMoreInfoActor",vh,[]);class Hk{constructor(b,h,r,B,P){this.R6j=6E4;this.Uqi="inactive";this.Gnh="active";this.c_=!0;this.Ib=b;this.G4j=h;this.yD=r;this.mzd=B;this.sa=new Pc.a;P&&this.OCo();this.W3g=this.Jbi()}goh(b){this.sa.addHandler(this.Gnh,b)}Xtk(b){this.sa.addHandler(this.Uqi,b)}OCo(){const b=new Me.a(5,2,this.R6j,Object(z.a)(this,this.eym,
"inactiveLoop"),108);this.fym.Wb(b)}eym(){const b=this.Jbi(),h=this.nq()-b;h>this.ome&&this.c_&&(t.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:h}),this.c_=!1,this.sa.raiseEvent(this.Uqi));b-this.W3g>this.ome&&(this.c_=!0,this.sa.raiseEvent(this.Gnh));this.W3g=b}get fym(){return this.Ib.value}get Jbi(){return this.G4j}get nq(){return this.yD}get ome(){return this.mzd.value}static get instance(){return Hk._instance||(Hk._instance=Hk.Xr())}static Xr(){return new Hk(new pf.a(()=>
Wg.a.instance),()=>v.AFrameworkApplication.nKf.getTime(),()=>(new Date).getTime(),new pf.a(()=>v.AFrameworkApplication.ome),!0)}}Hk._instance=null;Object(m.a)(Hk,"InactivityManager",null,[]);var Yk=c(1699);class nn extends tl{constructor(){super();this.Bbk=this.Z7g=this.Y7g=null;this.state=this.Fjh=0;this.uFe=!1}get MQf(){return this.Y7g}get wQi(){return this.Z7g}get QKo(){return this.Fjh}rgi(){return"MruActor Result"}}Object(m.a)(nn,"MruResult",tl,[578,579]);class Yl{constructor(b,h,r){this.task=
null;this.sIb=b;this.maxRetries=h;this.taskManager=r;this.retryCount=this.BVc=0;this.jPe=this.oZc=null}rSm(b,h){return b===qa.a.Q8b||20===h||18===h||3===h}JTm(b){return 3===b||5===b||6===b||7===b||9===b||10===b||11===b||12===b||13===b||14===b||15===b||16===b||23===b||26===b||27===b||28===b}get Hae(){return this.jPe}reset(){this.BVc=this.retryCount=0;this.jPe=this.oZc=null;this.task&&(this.taskManager.ff(this.task),this.task=null)}ECm(b,h,r,B){this.jPe=String.format("{0}_{1}",r,B);if(this.retryCount>=
this.maxRetries)return t.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.rSm(r,B))return t.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.JTm(B)&&1<=this.BVc)return this.oZc=r,!1;h=Math.max(h,this.sIb*Math.pow(2,this.BVc));if(26===B)h=Math.max(h,3E4);else if(27===B||28===B)h=Math.max(h,6E4);9===B||412===r&&(null==this.oZc||412!==this.oZc)?h=500:this.BVc+=1;this.oZc=r;this.retryCount+=1;this.task&&this.taskManager.ff(this.task);t.ULS.sendTraceTag(562656909,
202,50,"Scheduling next retry after {0} ms.",h);this.task=new Me.a(2,1,h,b,107);this.taskManager.Wb(this.task);return!0}}Object(m.a)(Yl,"RetryManager",null,[]);var Hh=c(127);class bn{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(m.a)(bn,"WriteOptions",null,[]);var lj=c(758);class il extends vh{constructor(b,h,r,B,P,ca,ra){super();this.YBa=b;this.sak=h;this.pdb=new Yl(v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",
5E3),v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.dN.P5d);this.Feb=new Yl(v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.dN.P5d);this.Hgk=r;this.Gmh=B;this.spk={};this.Wla=new nn;this.d4j=P;this.Trd="";this.bM=ca;this.lUg=ra;this.dvd="";this.Lgk=v.AFrameworkApplication.K.mc("WordRecentLinksCount",
25)}get pqe(){return this.spk}HYn(){this.dN.lgc.ra(fb.a.ncj,yd.a.frame,Object(z.a)(this,this.C2n,"renameMruEntry"))}C2n(){return this.Xsg("Rename")}p$m(){this.oNi("File Opened")}q$m(){this.oNi("IntervalUpdate")}oNi(b){t.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:b});this.Xsg(b)}Mha(b){(b=F.a.Mha(b))&&b.startsWith(".")&&(b=b.substring(1,b.length));return b}qQd(){switch(this.dN.Dda){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";
case 4:return"OneNote";default:return"Unknown"}}lkm(b){var h=this.d4j();if(!h)return null;const r=new bn;r.documentUrl=this.lUg.value?encodeURI(h):h;r.mruItemId=this.Trd;r.app=this.qQd();if(h=this.bM())r.folderName=h.breadcrumbFolderName,h=h.xz,r.documentName=F.a.yJ(h),r.documentExt=this.Mha(h);b&&(r.documentName?r.documentName.length?255<=r.documentName.length?b.set("DocumentNameLength","Long"):2084<=r.documentName.length&&b.set("DocumentNameLength","VeryLong"):b.set("DocumentNameLength","0"):b.set("DocumentNameLength",
"Null"));return JSON.stringify(r)}Xsg(b,h=!1){if(4===this.dN.Dda&&!v.AFrameworkApplication.NLd)return 2;var r=lb.a.vG();r&&(r.set("Trigger",b),r.set("IsRetry",h?"true":"false"),r.set("MruIdSent",this.Trd?"true":"false"),r.set("URLEncoded",this.lUg.value?"true":"false"));va.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",r);b=this.lkm(r);if(!b)return h=!v.AFrameworkApplication.FTb,r&&(r.set("WebEditingIsEnabled",v.AFrameworkApplication.FTb?"true":"false"),r.set("ProtectedFile",v.AFrameworkApplication.cZ?
"true":"false")),va.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",h,!1,Object.assign(new hc.a,{extendedProperties:r})),2;this.Feb&&!h&&this.Feb.reset();r=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.dN.CSa,this.PMf);this.Gmh?this.pqe["X-FileId"]=v.AFrameworkApplication.em:r+=String.format("&{0}",v.AFrameworkApplication.em);v.AFrameworkApplication.sessionStartInfoSettings&&(this.pqe["X-Office-AudienceGroup"]=Object(Ra.a)(String,v.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||
"");this.pqe["X-Timeout"]=15E3;return this.dN.l1c.mj(r,2,b,this.pqe,!0,5,Object(z.a)(this,this.E8o,"writeMruV2EntryOnServerSuccessCallback"),Object(z.a)(this,this.pgl,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}E8o(b){this.Bmi(b.data)}Bmi(b){const h=lb.a.vG();this.Feb&&(h&&this.Feb.Hae&&(h.set("LastError",this.Feb.Hae),h.set("NumRetries",this.Feb.retryCount.toString())),this.Feb.reset());const r=Yk.c(b.se);r&&r.diagnostics_data&&(this.Trd=r.diagnostics_data.mru_id);
b=+b.aU-+b.$H;h&&h.set("RequestDuration",b.toString());va.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new hc.a,{extendedProperties:h}))}pgl(b){if(b.data.Se===qa.a.g6b)this.Bmi(b.data);else{var h=b.data.Se===qa.a.yja,r=lb.a.vG();this.Lmi(this.Feb,b,this.Wfl(),r);r&&(r.set("StatusCode",b.data.Se.toString()),h||this.NZe(b.data,r));va.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",b.data.Se),h,!1,Object.assign(new hc.a,{extendedProperties:r}))}}Wfl(){return()=>
{this.Xsg("Retry",!0)}}B5l(){this.Y_c("Polling")}A5l(){this.Y_c("Retry",!0)}a$m(){this.Y_c("Open")}$9m(){this.Y_c("Activity")}Z9m(){this.Y_c("ActivityRecentLinks",!1,!0)}Y_c(b,h=!1,r=!1){t.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:b});const B=lb.a.vG();B&&(B.set("Trigger",b),B.set("IsRetry",h?"true":"false"),r&&B.set("RecentLinks","true"));va.Health.instance.recordKpiUsage("GetMru",0,"smartfio",B);this.pdb&&!h&&this.pdb.reset();r?this.sMh(Object(z.a)(this,this.C5l,"getMruV2ForRecentLinksFromServerSuccessCallback"),
Object(z.a)(this,this.x5l,"getMruForRecentLinksFromServerFailureCallback"),!0):this.sMh(Object(z.a)(this,this.D5l,"getMruV2FromServerSuccessCallback"),Object(z.a)(this,this.z5l,"getMruFromServerFailureCallback"))}NZe(b,h){b&&b.Dj&&(b=b.Dj["X-CorrelationId"])&&h.set("ServerCorrelationId",b)}D5m(b,h){b&&(h&&h.set("RequestDuration",(+b.aU-+b.$H).toString()),va.Health.instance.recordKpiSuccess("GetMru",Object.assign(new hc.a,{extendedProperties:h})))}D5l(b){this.Oci(b)}Oci(b,h=!1){var r="";let B=null,
P=null,ca=null;const ra=Yk.c(b.data.se);ra&&(B=ra.places?ra.places.items:[],P=ra.documents?ra.documents.items:[],(ca=Yk.a(ra,h))&&(r=H.c(ca)));v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.GRa&&Hh.c()&&(h?this.dvd=r:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(r,!0)));r=lb.a.vG();this.pdb&&(r&&this.pdb.Hae&&(r.set("LastError",this.pdb.Hae),r.set("NumRetries",this.pdb.retryCount.toString())),this.pdb.reset());h&&r&&r.set("RecentLinks","true");ca||B||P?(h?this.dN.hSa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",
b.data,"Success"):this.dN.hSa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Success"),this.woe(3,ca,B,P),this.D5m(b.data,r)):(h?this.dN.hSa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",b.data,"Failure: Invalid JSON"):this.dN.hSa("MruActor.GetMruV2FromServerSuccessCallback",b.data,"Failure: Invalid JSON"),r&&this.NZe(b.data,r),va.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new hc.a,{extendedProperties:r})),this.woe(3,null,null,null,!0));this.Shf(this.Wla)}C5l(b){this.Oci(b,
!0)}Lmi(b,h,r,B){let P=0,ca=0;const ra=Yk.c(h.data.se);ra&&(null!=ra.response_code&&(P=ra.response_code,B&&B.set("MruResponseCode",P.toString()),9===P&&(this.Trd="")),ra.error_data&&null!=ra.error_data.retry_after_ms&&(ca=ra.error_data.retry_after_ms,B&&B.set("ExpectedRetryAfter",ca.toString())));b&&(h=b.ECm(r,ca,h.data.Se,P),B&&(B.set("CurrentRetryCount",b.retryCount.toString()),B.set("RetryScheduled",h?"true":"false")))}z5l(b){this.Nci(b)}Nci(b,h=!1){const r=b.data.Se===qa.a.yja,B=lb.a.vG();B&&
(B.set("StatusCode",b.data.Se.toString()),h&&B.set("RecentLinks","true"),r||this.NZe(b.data,B));h?this.dN.hSa("MruActor.GetMruForRecentLinksFromServerFailureCallback",b.data,"Failure"):this.dN.hSa("MruActor.GetMruFromServerFailureCallback",b.data,"Failure");this.woe(2);this.Lmi(this.pdb,b,Object(z.a)(this,this.A5l,"getMruFromServerRetryTask"),B);va.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",b.data.Se),r,!1,Object.assign(new hc.a,{extendedProperties:B}));this.Shf(this.Wla);
v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.GRa&&Hh.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),h?this.dvd=null:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}x5l(b){this.Nci(b,!0)}woe(b,h=null,r=null,B=null,P=!1){if(3!==this.Wla.state||3===b)this.Wla.Y7g=h,this.Wla.Z7g=r,this.Wla.Bbk=B,this.Wla.state=b,this.Wla.uFe=P,this.Wla.Fjh=this.dN.nq()}UXi(b,h){t.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:b,["ResultState"]:this.Wla.state});
h&&3===this.Wla.state&&this.sWh(h,this.Wla);return this.Wla}sMh(b,h,r=!1){this.woe(1);let B;const P={};B=r?String.format(this.dN.CSa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",this.Lgk,"OfficeSuite",this.PMf,"ClassicMru"):String.format(this.dN.CSa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.qQd(),this.PMf);this.Hgk.value||(B+="&entity=docs");v.AFrameworkApplication.sessionStartInfoSettings&&(P["X-Office-AudienceGroup"]=Object(Ra.a)(String,v.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||
"");r&&(P["X-Office-Application"]="147");this.Gmh?P["X-FileId"]=v.AFrameworkApplication.em:B+=String.format("&{0}",v.AFrameworkApplication.em);this.dN.l1c.mj(B,1,null,P,!0,5,b,h,null)}get dN(){return this.YBa.value}get PMf(){return this.sak.value}static get instance(){return il._instance||(il._instance=il.Xr())}static Xr(){return new il(new pf.a(()=>Ph.instance),new pf.a(()=>lj.a.tg(v.AFrameworkApplication.lcid).name),new pf.a(()=>v.AFrameworkApplication.ua.Kb.vF),v.AFrameworkApplication.K.$("MruWriteFileIdInHeader"),
()=>v.AFrameworkApplication.ua.Kb.UQ,()=>v.AFrameworkApplication.Js,new pf.a(()=>v.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled")))}}il._instance=null;Object(m.a)(il,"MruActor",vh,[]);class zk{constructor(){this.OEc=this.Gch=this.W=null;this.Oh=!1}get name(){return"Common.App.NewAndOpen.Core"}wc(b){this.W=b;b.register(533,"Common.INewAndOpenCommonHelpers").ha().Ud(()=>Ph.instance);b.register(534,"Common.IEventEmitter<Common.IGetMoreInfoResult>").ha().Ud(()=>ej.instance);b.register(534,"Common.IEventEmitter<Common.IMruResult>").ha().Ud(()=>
il.instance)}init(){v.AFrameworkApplication.K.Nn(()=>{this.K3a()})}K3a(){this.W.resolve("Common.INewAndOpenCommonHelpers");this.W.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.W.resolve("Common.IEventEmitter<Common.IMruResult>");var b=!1;Ph.instance.XUn();v.AFrameworkApplication.rHa&&(b=!0);v.AFrameworkApplication.P5f&&(il.instance.a$m(),0<v.AFrameworkApplication.xQi&&this.Voh(),this.tqo(),b=!0);v.AFrameworkApplication.XUa&&b&&ej.instance.Y9m();v.AFrameworkApplication.mYo&&(b=il.instance,
b.HYn(),b.p$m(),Wg.a.instance.Wb(this.nYo))}tqo(){Hk.instance.goh(Object(z.a)(il.instance,il.instance.$9m,"makeGetMruRequestActivityTrigger"));Hk.instance.goh(Object(z.a)(this,this.Voh,"addGetMruFromServerTask"));Hk.instance.Xtk(Object(z.a)(this,this.Skl,"deleteGetMruFromServerTask"))}Skl(){Wg.a.instance.ff(this.yQi)}Voh(){Wg.a.instance.Wb(this.yQi)}get yQi(){return this.Gch||(this.Gch=new Me.a(5,2,v.AFrameworkApplication.xQi,Object(z.a)(il.instance,il.instance.B5l,"getMruFromServerTask"),109))}get nYo(){return this.OEc||
(this.OEc=new Me.a(2,2,6E4*v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(z.a)(il.instance,il.instance.q$m,"makeUpdateMruTask"),197))}dispose(){this.Oh||(this.Oh=!0,this.OEc&&(Wg.a.instance.ff(this.OEc),this.OEc=null))}}Object(m.a)(zk,"CorePackageManager",null,[1,2,9]);var Im=c(1574),zd=c(149);class hf{static Evl(b){return hf.Fzh("New",b)}static Fvl(b){return hf.Fzh("Open",b)}static lzh(b,h){return hf.a0a("LoadingMenuSection",hf.t3m,
b,hf.JHc("lblLoading",h))}static KHc(b,h,r=null,B=null){return hf.a0a("MessageMenuSection",hf.vQi,h,hf.JHc("lblMessage",b,r,B))}static uOk(b){return hf.lzh(b,CommonUIStrings.l_VoicedLoadingText)}static vOk(b,h){return hf.KHc(CommonUIStrings.l_NewCreationLocationMessage,b.labelText,h.Rda,h.A8a)}static tOk(b,h){return hf.KHc(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,h.A8a,"\n\n"),b.labelText)}static pzh(b){return hf.KHc(CommonUIStrings.l_NewGenericErrorMessage,b.labelText)}static rOk(b,
h,r){return hf.a0a("menuNewBlank",hf.Itm,r?b.labelText:null,hf.GHc(b.roi,b.soi,b.toi,null,b.C3a,b.fUc,h,"blank"))}static nPk(){return hf.JHc("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static Dzh(){return hf.JHc("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static oPk(b,h){return hf.a0a("menuNewTemplates",b,null,h)}static pOk(b,h){return hf.a0a("menuNewMoreTemplates",hf.r2h,null,hf.GHc("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,
null,null,null,b,h))}static hNk(b,h,r){let B="";r&&h&&(B=hf.a0a("BrowseMoreMenuSection",hf.r2h,null,hf.GHc("btnBrowseMore",h,h,null,null,null,b||"1959943459",r)));return B}static JHc(b,h,r=null,B=null){let P=B;h&&0<h.length&&(P=hf.oRi.yob(h).trimEnd(),P=0<=P.indexOf("{0}")?String.format(P,B):String.format("{0} {1}",P,B));r=r&&B?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',F.a.zf(r),F.a.zf(B),F.a.zf(P)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',
F.a.zf(b||""),hf.oRi.yob(F.a.zf(h||"")),r)}static GHc(b,h,r,B,P,ca,ra,Qa){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',F.a.zf(b||""),F.a.zf(h||""),F.a.zf(r||""),B||"32by32",F.a.zf(P||""),F.a.zf(ca||""),ra,F.a.zf(Qa||""))}static Fzh(b,h){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',
b,h)}static a0a(b,h,r,B){r=r?String.format('Title="{0}"',F.a.zf(r)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',F.a.zf(b||""),F.a.zf(h||""),r,B)}}hf.vQi="MenuMru";hf.t3m="MenuLoading";hf.Itm="MenuHeader";hf.r2h="MenuFooter";hf.oRi=zd.a.NC("\n","&#10;");Object(m.a)(hf,"NewAndOpenXmlUtilities",null,[]);
class Mi{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(m.a)(Mi,"HostInformation",null,[]);var Rl=c(194);class me{constructor(b,h,r,B,P,ca){this.Y0b=this.aw=this.Dhd=null;this.vxd=this.mTe=!1;this.k7g=0;this.TSe=this.jHe=!1;this.YBa=b;this.mvc=h;this.BXa=new pf.a(()=>new Im.a(r.value,Object(z.a)(this,this.EGb,"getMoreInfoEventReceived")));this.zbk=B;this.Gcb=P;this.Xjk=ca;this.kDc=this.Fie;this.Tpd=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("GateTemplateRenderingByGetMoreInfoResponse");
2===this.JP.Dda&&(this.TSe=!0);v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&this.jCl()}get Z7(){switch(this.JP.Dda){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}jCl(){Wg.a.instance.Wb(new Me.a(5,1,0,()=>{this.getTemplateListJson()}))}Tb(){const b=this.JP.lgc;b.ra(fb.a.newDocument,yd.a.frame,Object(z.a)(this,this.newDocument,"newDocument"));
b.ra(fb.a.jae,yd.a.frame,Object(z.a)(this,this.jae,"populateNewMenu"))}newDocument(b,h,r,B,P){if(1===r)return 32;if(2===r&&P){if(v.AFrameworkApplication.K.$("BackstagePremiumTemplateExperienceEnabled")&&P.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),v.AFrameworkApplication.va.processAction(fb.a.iGn,2);if(P.MenuItemId&&P.SourceControlId)return"NewDocumentHome"===P.SourceControlId&&Ke.a("NewDocumentFromHomeTab"),this.LKc(P.MenuItemId,P.SourceControlId)}return 8}LKc(b,
h){var r=this.U5d.aNh;if(null===r)return 8;var B=v.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(v.AFrameworkApplication.Tlb&&B){t.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const P={};P[G.a.template]=b;P[G.a.Z7]=this.Z7;P[G.a.lcid]=v.AFrameworkApplication.lcid.toString();P[G.a.reason]=kj.a.Lbf;P[G.a.uiCulture]=v.AFrameworkApplication.uiCulture;P[G.a.dataCulture]=v.AFrameworkApplication.dataCulture;
v.AFrameworkApplication.mP().execute(ca=>{ca.sendMessage(M.a.LKc,P)})}else B=(new Date).getTime(),h=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",r,F.a.Gj(this.rHa),F.a.Gj(b),F.a.Gj(this.Z7),F.a.Gj(v.AFrameworkApplication.lcid.toString()),F.a.Gj(B.toString()),F.a.Gj(h),F.a.Gj(v.AFrameworkApplication.canary),v.AFrameworkApplication.em),(r=v.AFrameworkApplication.K.kb("ScenarioId"))&&""!==r&&(h+="&wdscenarioid="+F.a.Gj(r)),
h+="&"+v.AFrameworkApplication.tUd(),v.AFrameworkApplication.xRa&&(h+="&"+v.AFrameworkApplication.VSd()),(r=this.aw?this.aw.Rda:null)?h+="&DestinationUrl="+F.a.Gj(r):3===this.JP.Dda&&this.JP.XUa&&t.ULS.sendTraceTag(508928088,202,10,"CreateNewDocument: getMorInfoResult is null or PersonalFileStorageUrl is empty"),Qd.a.wm(h,"_blank",void 0,"CreateNewDocument");2!==this.JP.Dda&&3!==this.JP.Dda||t.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:El.a[this.JP.Dda],["Template"]:b});
v.AFrameworkApplication.K&&v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.ConsumerTemplateTelemetry")&&1===this.JP.Dda&&("blank"===b?Ke.b("ConsumerTemplateNewBlank"):(b=[Object.assign(new ha.a,{name:"TemplateId",string:b})],Ke.b("ConsumerTemplateNew",null,0,!0,0,b)));return 32}$7m(b){let h=Number.MAX_VALUE,r=Number.MIN_VALUE;const B=window.performance;if(B&&"undefined"!==typeof B.getEntriesByName){for(let ca=0;ca<b.length;ca++){var P=B.getEntriesByName(b[ca]);P&&
0<P.length&&(P=P[0],h=Math.min(parseInt(String(P.fetchStart)),h),r=Math.max(parseInt(String(P.responseEnd)),r))}r>h&&t.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:r-h,["MinFetchStart"]:h,["MaxResponseEnd"]:r})}}jae(b,h,r,B,P){if(1===r)return this.TSe&&(v.AFrameworkApplication.fqa("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.TSe=!1),32;2!==r||this.jHe||(this.k7g=(new Date).getTime(),t.ULS.sendTraceTag(5849602,
202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.Fie,["CachedNewMenuXmlExists"]:!!this.Dhd,["ShouldCallGetMoreInfo"]:this.JP.XUa}));v.AFrameworkApplication.oe("AdditionalDocumentTemplates-tf;AdditionalDocumentTemplates-cf");v.AFrameworkApplication.oe("WordConsumerTemplates-tf;WordConsumerTemplates-cf");return this.QEn(P)}QEn(b){b&&(this.Dhd?b.PopulationXML=this.Dhd:(this.JP.XUa&&!this.aw&&this.Vgn.lP("Opened New menu",!0),b.PopulationXML=this.QLl(this.getTemplateListJson())));
return 32}bCi(){return!this.JP.XUa||!!this.aw&&3===this.aw.state&&!!this.aw.A8a&&!!this.aw.Rda}wHf(){return v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.GRa&&!this.Tpd?!0:this.bCi()}getTemplateListJson(){if(!this.Fie&&!this.Tpd&&!this.wHf())return null;if(this.kDc&&!this.vxd){var b="9";v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&(b="21");const h=v.AFrameworkApplication.K.appSettings;"NumberOfTemplatesInBackstage"in
h&&(b=h.NumberOfTemplatesInBackstage);let r=this.Z7;"TemplateCollectionId"in h&&(r=h.TemplateCollectionId);v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordConsumerTemplates",!1)&&(r="WordConsumerWAC",b="23");b=String.format(this.JP.CSa+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",F.a.Gj(v.AFrameworkApplication.lcid.toString()),F.a.Gj(r),b);Boolean.parse(h.AppendOriginQueryParam||"false")&&(b+="&org=backstage");Boolean.parse(h.BackstagePremiumTemplateExperienceEnabled||
"false")&&"TemplateTier"in h&&(b+="&templateTier="+h.TemplateTier);b+="&"+v.AFrameworkApplication.tUd();v.AFrameworkApplication.xRa&&(b+="&"+v.AFrameworkApplication.VSd());this.JP.l1c.mj(b,1,null,null,!1,2,B=>{this.JP.hSa("CreateNewActor.GetTemplateListJson",B.data);this.bJo(B.data.se)},B=>{this.JP.hSa("CreateNewActor.GetTemplateListJson",B.data);this.aJo()},null,void 0,void 0,void 0,void 0,"5");this.kDc=!1}return this.Y0b}bJo(b){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",
!1)?this.Y0b=this.hDl(b):this.Y0b=b;this.kDc=!1;this.l6c();this.Tpd?this.wHf()?this.bgf():this.aw&&(t.ULS.sendTraceTag(508867410,202,10,"GetMoreInfo Received but info is missing"),this.agf()):this.bgf()}bgf(){if(v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.GRa&&Hh.c()){const b=v.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC"),h=v.AFrameworkApplication.Tlb;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.Y0b,!0,b&&h));3===this.JP.Dda&&
t.ULS.sendTraceTag(508867409,202,15,"DispatchSuccessTemplateListJson")}}aJo(){this.vxd=this.kDc=!0;this.l6c();this.agf();va.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}agf(){v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.GRa&&Hh.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1)),3===this.JP.Dda&&t.ULS.sendTraceTag(508867408,202,15,"DispatchFailureTemplateListJson"))}hDl(b){b=JSON.parse(b);const h=
new mb.a;h.add("TM00002102");h.add("TM00002101");h.add("TM16392939");const r=Rl.a.msg(b,B=>h.contains(B.AssetId));b=b.slice(0,9);b.splice.apply(b,[2,0].concat(r));return JSON.stringify(b)}Kvf(b){var h=0;for(var r=0;r<b.length;r++)if("ST"===b[r].ImageType){h=r;break}const B=b.length?b[h]:null;b=B?B.Url||"":"";var P;let ca=r=h=!1;if(B&&(P=B.AspectRatio))P=parseFloat(P),1>P?h=!0:1.5<P?r=!0:1===P&&(ca=!0);else switch(t.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:b}),
this.JP.Dda){case 3:h=!0;break;case 2:r=!0;break;case 5:ca=!0}return{returnValue:b,Ixm:h?"95by123":r?"123by69":ca?"100by100":"123by95"}}QLl(b){b=({kie:h}=this.sOk(b,this.U5d,this.U5d.NHc||"1056925771")).returnValue;if(h){this.Dhd=b;var h=(new Date).getTime()-this.k7g;t.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:h})}return b}EGb(b,h){t.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.aw||3!==b.state?2===
b.state&&(t.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.mTe=!0,this.l6c()):(this.aw=b,h||this.l6c(),v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.GRa&&Hh.c()&&Hh.d("setFileMenuHostInformation")&&(b=Object.assign(new Mi,{hostUrl:this.aw.Rda,hostName:this.aw.A8a,folderUrl:v.AFrameworkApplication.breadcrumbFolderUrl,folderName:v.AFrameworkApplication.breadcrumbFolderName}),t.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(b)),
this.Tpd&&this.Y0b&&this.Y0b.length&&(this.wHf()?this.bgf():this.agf(),t.ULS.sendTraceTag(508867407,202,15,"Dispatched on GetMoreInfoReceived"))))}sOk(b,h,r){let B;B=!1;const P=this.bCi();let ca="";this.JP.XUa&&(this.mTe?(ca=hf.pzh(h),this.mTe=!1,t.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.aw?P?ca=hf.vOk(h,this.aw):this.aw.zFm?(B=!0,this.kDc=!1,ca=hf.tOk(h,this.aw),t.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):
(B=!0,ca=hf.pzh(h),t.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.aw.Rda,["StorageServiceDisplayNameIsSet"]:!!this.aw.A8a})):(ca=hf.uOk(h.labelText),t.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));P&&(ca+=hf.rOk(h,r,!ca)+({kie:B}=this.mPk(b,r)).returnValue);return{returnValue:hf.Evl(ca),kie:B}}mPk(b,h){let r;r=!1;if(!this.Fie)return r=!0,t.ULS.sendTraceTag(5849609,
202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",kie:r};let B="",P="",ca="MenuTemplate";if(this.vxd)B=hf.Dzh(),this.vxd=!1,t.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(b){try{const ra=Sys.Serialization.JavaScriptSerializer.deserialize(b,!0);B=this.lPk(ra,h);t.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");v.AFrameworkApplication.pRi&&"OneDrive"===this.rHa&&(P=hf.pOk(this.Wgn,v.AFrameworkApplication.pRi))}catch(ra){t.ULS.sendTraceTag(5849613,
202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:b}),B=hf.Dzh()}r=!0}else ca="MenuLoading",B=hf.nPk(),t.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:hf.oPk(ca,B)+P,kie:r}}lPk(b,h){let r="";const B=[];for(let ca=0;ca<b.length;ca++){var P=b[ca];let ra="";if(P){const Qa=P.Title,tb=P.AssetId;P=P.Thumbnails;tb&&Qa&&P&&({Ixm:P,returnValue:ra}=this.Kvf(P),r+=hf.GHc("jbtnNewTemplate"+ca,Qa,null,P,null,ra,h,tb))}B[ca]=
ra}b=new Me.a(4,1,5E3,()=>{this.$7m(B)},106);this.JP.P5d.Wb(b);return r}l6c(){this.jHe=!0;this.JP.fRi.VJa(this.U5d.OOc);this.jHe=!1}get JP(){return this.YBa.value}get U5d(){return this.mvc.value}get Vgn(){return this.BXa.value}get Wgn(){return this.zbk.value}get rHa(){return this.Gcb.value}get Fie(){return this.Xjk.value}}Object(m.a)(me,"CreateNewActor",null,[]);class qd{constructor(){this._initialized=!1;this.xUe={}}IB(b){this.YXh();return this.get(b)}contains(b){this.YXh();return b.toString()in
this.xUe}YXh(){this._initialized||(this.zvk(),this._initialized=!0)}Qeb(b,h){this.xUe[b.toString()]=h}get(b){return this.xUe[b.toString()]}}Object(m.a)(qd,"AIntlHelper",null,[]);class Yj extends qd{constructor(){super()}zvk(){this.Qeb(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.Qeb(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.Qeb(2,CommonUIStrings.l_Open);this.Qeb(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.Qeb(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.Qeb(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return Yj._instance||
(Yj._instance=new Yj)}static qxn(b){return Yj.instance.IB(b)}}Yj._instance=null;Object(m.a)(Yj,"MruActorIntlHelper",qd,[]);var af;(function(b){b[b.success=0]="success";b[b.failure=1]="failure";b[b.spinner=2]="spinner";b[b.none=3]="none"})(af||(af={}));Object(m.b)("DisplayState",af);class Xe{constructor(b,h,r,B,P,ca,ra,Qa){this.kve=null;this.iYe=!0;this.Chd="";this.Wmk=0;this.VYb=null;this.NIe=3;this.Ca=Qa;this.YBa=b;this.fua=h;this.V2j=r;this.XXj=B;this.WXj=P;this.BXa=new pf.a(()=>new Im.a(ca.value,
null));this.J4j=new pf.a(()=>new Im.a(ra.value,Object(z.a)(this,this.Ofn,"mruEventResultReceived")));this.Ca.$("WacInTabOpenMRUIsEnabledForUiHost");this.Ca.$("UiHostSupportsDocRebootFeatures")}Ofn(b,h){this.VYb=b;h||this.l9i()}KXn(){this.dN.lgc.fb(fb.a.M1f,yd.a.frame,Object(z.a)(this,this.M1f,"populateMruMenu"),96)}M1f(b,h,r,B,P){return 1!==r&&P?this.OEn(P):32}OEn(b){this.pwl();this.owl();b.PopulationXML=hf.Fvl(this.Chd+this.kve);return 32}pwl(){var b=3;let h=!1;if(this.Chd&&this.Wmk===this.VYb.QKo)t.ULS.sendTraceTag(5849627,
202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),b=this.NIe;else{t.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var r=this.dN.nq();this.VYb=this.Nfn.lP("File Open opened",!0);this.Chd&&2!==this.NIe&&3!==this.VYb.state?h=!0:(b=this.dem(this.VYb),v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.GRa&&Hh.c()&&b&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(b,
!0)),this.Chd=({Ngn:b}=this.SLl(this.VYb)).returnValue);r=this.dN.nq()-r;t.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:r})}2!==b&&(r={["DisplayState"]:af[b]},1!==b&&(r.IsStale=h),t.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",r));this.NIe=b}dem(b){let h;try{h=H.c(b.MQf)}catch(r){h=null,t.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",
r)}return h}owl(){this.iYe?(t.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.kve=({j4o:this.iYe}=this.V9m()).returnValue):t.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");t.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.iYe,["NotDisplayingLink"]:!this.kve})}SLl(b){let h;1===b.state||0===b.state?(t.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),
b=2,h=hf.lzh(this.f3a(2),this.f3a(5))):3===b.state&&b.MQf?(h=this.qOk(b.MQf),b=0):(t.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),h=hf.KHc(this.f3a(1),this.f3a(2)),b=1);return{returnValue:h,Ngn:b}}qOk(b){let h;const r=this.D0c.NHc||"2155708348";if(b.length){h=hf.JHc("lblRecentDocuments",this.f3a(3));let B=0;for(let P=0;P<b.length;P++){const ca=b[P];"FileName"in ca&&"DocumentUrl"in ca&&"Path"in ca&&(h+=hf.GHc("MruButton"+P,ca.FileName.toString(),ca.Path.toString(),
null,this.D0c.C3a,this.D0c.fUc,r,ca.DocumentUrl.toString()),ca.IsPinned&&B++)}h=hf.a0a("RecentDocumentsMenuSection",hf.vQi,this.f3a(2),h);t.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:b.length,["NumPinnedDocuments"]:B})}else h=hf.KHc(this.f3a(0),this.f3a(2)),t.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return h}V9m(){let b;b=!0;let h=this.zMk;var r=this.yMk;if(h&&r||!this.dN.XUa)b=!1;else{const B=this.aTd.lP("File Open",
!1);3===B.state&&(h=B.Rda,r=B.A8a,b=!1)}r=r?String.format(this.f3a(4),r):null;return{returnValue:hf.hNk(this.D0c.NHc,r,h),j4o:b}}l9i(){this.dN.fRi.VJa(this.D0c.OOc)}get dN(){return this.YBa.value}get f3a(){return this.fua.value}get D0c(){return this.V2j.value}get zMk(){return this.XXj.value}get yMk(){return this.WXj.value}get aTd(){return this.BXa.value}get Nfn(){return this.J4j.value}}Object(m.a)(Xe,"MruRenderer",null,[]);var ho=c(1579);class ki{constructor(b,h,r,B,P,ca,ra){this.aw=null;this.dfh=
!1;this.Zsa=this.B2=0;this.Pbk=b;this.vZb=h;this.$rd=r;this.mvc=B;this.Gcb=P;this.YBa=ca;this.BXa=new pf.a(()=>new Im.a(ra.value,Object(z.a)(this,this.EGb,"getMoreInfoEventReceived")))}LKc(){!this.aw&&this.lTf.XUa?this.aTd.lP("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}EGb(b){if(!this.aw&&3===b.state)this.aw=b;else if(2===b.state){this.dfh?t.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.aTd.lP("NewDocumentFromStream",!0),this.dfh=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.B2=
(new Date).getTime();var b=this.yCl.aNh;if(null===b)this.vZb(null);else{var h=this.$rd.menuItemId,r=this.$rd.cJa,B=this.$rd.CEo,P=this.$rd.GCl;this.Zsa="streamBase64"===B?P.length/1024:0;t.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.Z7,this.Zsa);var ca=(new Date).getTime();b=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",b,F.a.Gj(this.rHa),F.a.Gj(h),F.a.Gj(this.Z7),F.a.Gj(v.AFrameworkApplication.lcid.toString()),
F.a.Gj(ca.toString()),F.a.Gj(r),F.a.Gj(v.AFrameworkApplication.canary),v.AFrameworkApplication.em,F.a.Gj(B));b+="&"+v.AFrameworkApplication.tUd();v.AFrameworkApplication.xRa&&(b+="&"+v.AFrameworkApplication.VSd());(h=this.aw?this.aw.Rda:null)&&(b+="&DestinationUrl="+F.a.Gj(h));this.lTf.l1c.mj(b,2,P,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(z.a)(this,this.Qgn,"newDocumentFromStreamSuccessHandler"),Object(z.a)(this,this.Pgn,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,
void 0,void 0,"31")}}Qgn(b){if(b&&b.data&&b.data.se)if(({Gt:h}=H.d(b.data.se)).returnValue)if(b=h,b.StatusCode!==qa.a.Zz&&b.StatusCode!==qa.a.g6b)t.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.Z7,this.Zsa,b.StatusCode),this.vZb(null);else if(b.NewDocumentUrl&&""!==b.NewDocumentUrl){var h=(new Date).getTime()-this.B2;t.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.Z7,this.Zsa,h);this.Pbk(b.NewDocumentUrl)}else t.ULS.sendTraceTag(24904476,
202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.Z7,this.Zsa),this.vZb(null);else t.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.Z7,this.Zsa,{["ResponseData"]:ho.a.Mcd(b.data.se)}),this.vZb(null);else t.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.Z7,this.Zsa),
this.vZb(null)}Pgn(b){b&&b.data&&t.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.Z7,this.Zsa,b.data.status);this.vZb(null)}get Z7(){switch(this.lTf.Dda){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get yCl(){return this.mvc.value}get rHa(){return this.Gcb.value}get lTf(){return this.YBa.value}get aTd(){return this.BXa.value}}Object(m.a)(ki,"NewDocumentFromStreamOperation",
null,[]);class qm{constructor(b,h,r,B){this.mvc=b;this.Gcb=h;this.YBa=r;this.I4j=B}create(b,h,r){return new ki(b,h,r,this.mvc,this.Gcb,this.YBa,this.I4j)}}Object(m.a)(qm,"NewDocumentFromStreamOperationFactory",null,[563]);var Fj=c(131);class rm{get name(){return"Common.App.NewAndOpen.UX"}wc(b){b.register(qm,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").ha().Ud(()=>new qm(new pf.a(()=>v.AFrameworkApplication.ua.Kb.Jqf()),
new pf.a(()=>v.AFrameworkApplication.rHa),new pf.a(()=>b.Oa("Common.INewAndOpenCommonHelpers")),new pf.a(()=>b.Oa("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){v.AFrameworkApplication.K.Nn(()=>{this.K3a()})}K3a(){const b=Db.a.Gp(Ma.a.instance.Ta("Common.INewAndOpenCommonHelpers")),h=Db.a.Gp(Ma.a.instance.Ta("Common.IEventEmitter<Common.IGetMoreInfoResult>"));v.AFrameworkApplication.rHa&&Fj.Task.WAA.call(null,b,h).continueWith(()=>{const r=new me(new pf.a(()=>b.result),new pf.a(()=>
v.AFrameworkApplication.ua.Kb.Jqf()),new pf.a(()=>h.result),new pf.a(()=>v.AFrameworkApplication.ua.Kb.Kqf().NHc||"1959943459"),new pf.a(()=>v.AFrameworkApplication.rHa),new pf.a(()=>v.AFrameworkApplication.OQm));r.Tb();r.l6c()});if(v.AFrameworkApplication.P5f){const r=Db.a.Gp(Ma.a.instance.Ta("Common.IEventEmitter<Common.IMruResult>"));Fj.Task.WAA.call(null,b,h,r).continueWith(()=>{const B=new Xe(new pf.a(()=>b.result),new pf.a(()=>Yj.qxn),new pf.a(()=>v.AFrameworkApplication.ua.Kb.Kqf()),new pf.a(()=>
v.AFrameworkApplication.pxn),new pf.a(()=>v.AFrameworkApplication.oxn),new pf.a(()=>h.result),new pf.a(()=>r.result),v.AFrameworkApplication.K);B.KXn();B.l9i()})}}dispose(){}}Object(m.a)(rm,"UXPackageManager",null,[1,2,9]);var Tf=c(181);class Fl extends Tf.StandardDialog{constructor(){super();this.Cd=0;this.ze(1,CommonUIStrings.l_DialogClose)}PO(b){this.vx(b,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}jgf(b){this.vx(b,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,
null,!0)}}Object(m.a)(Fl,"ErrorDialog",Tf.StandardDialog,[595]);var Hf=c(462);class Ed{o5h(){t.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const b=new Hf.a;b.Dg("api.onedrive.com");return b.task}}Object(m.a)(Ed,"OneDriveConsumerEndpointHelper",null,[496]);var Zl=c(50);class ed{constructor(b,h,r,B){this.Cxb=this.AHa=null;this.FSe=this.HSe=!1;this.GZb=null;this.Ca=b;this.HUb=h;this.Nwb=r;this.sH=B}get kth(){return this.HUb}get K(){return this.Ca}r$b(){this.GZb||(this.GZb=this.qhc?
Fb.a.create(this.qhc,null,null,null,!1):null);return this.GZb}setup(b){this.Cxb=b;this.HSe||this.FSe?this.HSe&&this.Cxb&&this.Cxb(!0):(b=this.r$b())?(this.FSe=!0,b.s5a.continueWith(h=>{this.wrn(h)}),Ya.a.PX(b)):(t.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.Cxb(!1))}rXf(b){t.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",b.exception?b.exception.toString():"No error detail.")}wrn(b){this.FSe=!1;if(b.Gi)this.rXf(b),
this.Cxb(!1);else try{this.HSe=!0,t.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.zBf(),t.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.Cxb(!0)}catch(h){t.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",h.toString()),this.Cxb(!1)}}Tad(b){this.AHa=b;this.Nwb?t.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(t.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(z.a)(this,
this.pVf,"onApiReady")))}pVf(b){b?this.o2d():this.Ep()}Ep(){this.sH().PO(Zl.a.zwn)}onSuccess(b){t.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.AHa&&this.AHa(!0,b)}dispose(){this.GZb&&this.GZb.dispose()}}Object(m.a)(ed,"AOneDriveFilePickerApiManager",null,[573,9]);class Bf extends ed{constructor(b,h,r,B,P,ca){super(h,r,B,ca);this.Pm=null;this.aua=b;this.ekk=P}get qhc(){return this.K.kb("OneDriveApiUrl")}start(b,h){this.Pm=b;this.Tad(h)}zBf(){WL.init(1===
this.kth||2===this.kth?{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}Tad(b){this.AHa=b;!this.Nwb&&this.aua.RVc?(t.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(z.a)(this,this.pVf,"onApiReady"))):(t.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.ekk())}o2d(){try{t.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),
WL.fileDialog(this.Pm).then(Object(z.a)(this,this.onSuccess,"onSuccess"),Object(z.a)(this,this.onFailure,"onFailure"))}catch(b){t.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",b,b.stack),this.Ep()}}onFailure(b){if(b&&b.error){if("user_canceled"===b.error.code){t.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}t.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",b.error.code,b.error.message)}else t.ULS.sendTraceTag(17909060,
352,50,"File Dialog returned with no response");this.AHa&&this.AHa(!1,b);this.Ep()}}Object(m.a)(Bf,"OneDriveFilePickerApiManagerV5",ed,[]);class Og extends ed{constructor(b,h,r,B,P){super(b,h,r,B);this.lnd=this.t$g=null;this.e2j=P;this.options={};this.options.clientId=this.K.kb("OneDriveApiV7ClientId");this.options.cancel=Object(z.a)(this,this.yme,"toggleHostDivVisibility")}get qhc(){return this.K.kb("OneDriveApiV72Url")}start(b,h){this.lnd=h;const r=this.e2j.o5h();r.continueWith(()=>{t.ULS.sendTraceTag(24134241,
352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.t$g=r.result;this.Tad((B,P)=>{this.yme();b(B,P)})},3);r.continueWith(()=>{t.ULS.sendTraceTag(24134242,352,15,r.exception.message);this.yme()},5)}zBf(){this.options.success=b=>{const h={};h.data=b;this.onSuccess(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.t$g;this.options.advanced.iframeParentDiv=
this.lnd}o2d(){try{t.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.yme(),OneDrive.open(this.options)}catch(b){t.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",b.message),this.Ep()}}onFailure(b){this.AHa&&this.AHa(!1,b);this.Ep()}yme(){this.lnd.style.visibility="hidden"===this.lnd.style.visibility?"":"hidden"}}Object(m.a)(Og,"OneDriveFilePickerApiManagerV7",ed,[]);class Rm extends ed{constructor(b,h,r,B){super(b,h,r,B);this.mWj=
b;this.options={};this.options.advanced={};this.options.action="query";this.options.clientId=this.K.kb("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get qhc(){return this.K.kb("OneDriveApiV72Url")}start(b,h,r,B){this.options.advanced.iframeParentDiv=r;this.options.advanced.endpointHint=B;this.options.cancel=h;this.mWj.$("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive=
{},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.Tad(b)}Tad(b){this.AHa=b;this.Nwb?t.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(t.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(z.a)(this,this.pVf,"onApiReady")))}zBf(){this.options.success=b=>{const h={};h.data=b;this.onSuccess(h)};this.options.error=b=>{const h={};h.error=b;this.onFailure(h)}}o2d(){try{t.ULS.sendTraceTag(23881879,
216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(b){t.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.Ep()}}rXf(b){t.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",b.exception?b.exception.toString():"No error detail.");Ya.a.B0n(this.qhc);this.GZb=null}Ep(){this.sH().jgf(Zl.a.jao)}onFailure(b){this.AHa&&this.AHa(!1,b)}}Object(m.a)(Rm,"OneDriveFilePickerApiManagerV72",
ed,[]);class Xh{constructor(b){this.olsSessionId=this.value=this.key=null;this.olsSessionId=b}}Object(m.a)(Xh,"IExtraData",null,[]);class rf extends Rm{constructor(b,h,r,B){super(b,h,r,B);this.options.advanced.filter=b.kb("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=v.AFrameworkApplication.zth;b.$("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=b.kb("OneDriveApiV72CommandMode")||"none");b.$("OneDriveApiV72QosExtraDataEnabled")&&
(this.options.qosExtradata=new Xh(v.AFrameworkApplication.userSessionId))}get qhc(){return this.K.kb("OneDriveApiV72Url")}o2d(){try{t.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",v.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(b){t.ULS.sendTraceTag(26071183,
352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",b.message,b.stack),this.Ep()}}}Object(m.a)(rf,"OneDriveFilePickerApiOpenManagerV72",Rm,[]);class Ak{constructor(b){this.jq=null;this.$f=b;this.UQe=3}o5h(){this.jq=new Hf.a;t.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.fcg();return this.jq.task}fcg(b=null){const h=String.format("GetMoreInfoHandler.ashx?{0}",v.AFrameworkApplication.yDb);this.$f.QAb(h,1,null,b,["PersonalFileStorageUrl",
"X-NewKey"],2,Object(z.a)(this,this.t5l,"getMoreInfoSucceeded"),Object(z.a)(this,this.r5l,"getMoreInfoFailed"),void 0,void 0,void 0,void 0,"21")}r5l(b){if(b.data.Se===qa.a.yja&&"X-NewKey"in b.data.Dj){t.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const h={};h["X-Key"]=b.data.Dj["X-NewKey"];this.fcg(h)}else 0<this.UQe?(t.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",
this.UQe),this.UQe--,this.fcg()):(t.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.jq.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}t5l(b){"PersonalFileStorageUrl"in b.data.Dj&&""!==b.data.Dj.PersonalFileStorageUrl?(t.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.jq.Dg(b.data.Dj.PersonalFileStorageUrl)):(t.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),
this.jq.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}Object(m.a)(Ak,"OneDriveForBusinessEndpointHelper",null,[496]);var ye=c(760);class rk{constructor(){this.W=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}wc(b){this.W=b;this.W.register(Bf,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").ha().Ud(()=>new Bf(ye.a.instance,v.AFrameworkApplication.K,
v.AFrameworkApplication.M8,v.AFrameworkApplication.bqa,v.AFrameworkApplication.Lhg,()=>new Fl));v.AFrameworkApplication.VJb?this.W.register(496,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ha().Ud(()=>new Ed):this.W.register(496,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ha().Ud(()=>new Ak(v.AFrameworkApplication.He));this.W.register(Og,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").ha().Ud(()=>new Og(v.AFrameworkApplication.K,v.AFrameworkApplication.M8,
v.AFrameworkApplication.bqa,()=>new Fl,this.W.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.W.register(Rm,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").ha().Ud(()=>new Rm(v.AFrameworkApplication.K,v.AFrameworkApplication.M8,v.AFrameworkApplication.bqa,()=>new Fl));this.W.register(rf,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").ha().Ud(()=>new rf(v.AFrameworkApplication.K,v.AFrameworkApplication.M8,v.AFrameworkApplication.bqa,
()=>new Fl))}static main(){L.a.instance.Gc(new rk)}}Object(m.a)(rk,"PackageManager",null,[1,2]);class Hn{constructor(b,h,r,B,P,ca){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=b;this.WebAffinitizedUrl=h;this.PolicyCookie=r;this.PolicyCookieTTL=B;this.WasServiceDown=P;this.AffinitizedUrl=ca}}Object(m.a)(Hn,"SafeLinksData",null,[]);class fj{constructor(b,h){this.Dle=b;this.YA=h}}Object(m.a)(fj,
"SafeLinksGetUrlReputationRequestData",null,[]);class Qh{constructor(b,h,r,B){this.Ca=b;this.$f=h;this.c5j=r;Qh.je=B}uoc(b,h,r){try{var B=null;Qh.je&&(B=Qh.je.Zf("WebServiceCall","SafeLinksGetUrlReputation"));const P=new fj(h,B);B={};B.AffinitizedUrl=b;B.TargetUrl=h;B.PolicyCookie=r;const ca=H.c(B);this.$f.mj(this.c5j,2,ca,null,!1,2,Object(z.a)(this,this.bpn,"onGetUrlReputationSuccessCallback"),Object(z.a)(this,this.apn,"onGetUrlReputationFailureCallback"),P,void 0,void 0,3E3,3E3,"36");return!0}catch(P){t.ULS.sendTraceTag(588788033,
378,10,P.message)}return!1}bpn(b){let h="OnGetUrlReputationSuccessCallback: ",r=10;const B=b.data.state;try{const P=H.b(b.data.se).reputationResults[0],ca=P.navigateUrl.length,ra=B.Dle.length,Qa=P.navigateUrl===B.Dle;P.navigateUrl&&0<P.navigateUrl.length&&(B.Dle=P.navigateUrl);h+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",b.data.Se,P.verdict,ra.toString(),ca.toString(),Qa.toString());r=50}catch(P){h+=String.format("Exception {0}",
P.message)}this.tmi(B,h,r)}apn(b){let h="OnGetUrlReputationFailureCallback: ";const r=b.data.state;try{h+=String.format("HttpStatus {0}",b.data.Se)}catch(B){h+=String.format("Exception {0}",B.message)}this.tmi(r,h,10)}tmi(b,h,r){b.YA&&(b.YA.stop(),b.YA=null);t.ULS.sendTraceTag(588788034,378,r,h);Qd.a.wm(b.Dle,void 0,"noopener,noreferrer","SafeLinksNav")}}Qh.je=null;Object(m.a)(Qh,"SafeLinksNavigationHelper",null,[]);var gh;(function(b){b[b.enabledByPolicy=0]="enabledByPolicy";b[b.disabledByPolicy=
1]="disabledByPolicy";b[b.disabled_GetPolicyFailure=2]="disabled_GetPolicyFailure";b[b.disabled_PendingGetPolicyRequest=3]="disabled_PendingGetPolicyRequest"})(gh||(gh={}));Object(m.b)("SafeLinksNavigationState",gh);class sk{constructor(b,h,r,B=!1,P=null,ca=null){this.tvb=this.svb=0;this.LWc=this.Dmd=!1;this.$cb=null;this.EYb=!0;this.Qwd=null;t.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");this.Ca=b;this.$f=h;this.Vea=r;sk.je=ca;this.$ok=B?this.Ca.kb("SafeLinksHandlerWebServiceBase"):
this.Ca.kb("WebServiceBase");this.uok=this.Ca.kb("SafeLinksHashedUserId");this.s8o=this.Ca.kb("SafeLinksWorkloadIdHeaderValue");this.lrd=this.Ca.mc("SafeLinksMaxGetPolicyBootRetries",2);this.mrd=this.Ca.mc("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.Xod=this.YTm();this.Wod=this.XTm();sk.zlh=this.Ca.kb("UserPrincipalName")||"";sk.gEc=this.Ca.kb("TenantId")||"";t.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.Xod,this.Wod);if(this.Xod&&
this.Wod){h=(b=this.Oib())?b.IsSafeLinksEnabled.toLowerCase():"";r=this.bHf();t.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",h,r);var ra=!b||"unknown"===h||b.WasServiceDown||r,Qa=lb.a.vG();Qa&&(Qa.set("shouldGetSafeLinksDataFromServer",ra.toString()),Qa.set("isSafeLinksEnabledCacheValue",h.toString()));P?(this.EYb=!1,P.execute(tb=>{tb.isFeatureEnabled("MsoUrlreputation",!0).then(Mb=>{this.EYb=Mb;Qa.set("isUserLicensedForSafeLinks",this.EYb.toString());
va.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Qa);this.EYb&&ra&&this.mUd(!0);return null})})):(va.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Qa),ra&&this.mUd(!0))}}get appName(){return this.Vea}get Jpe(){return this.$ok}get userId(){return this.uok}get cki(){try{if(""===sk.PCe){const b={};b["X-AppName"]=this.appName;b["X-AppVersion"]=v.AFrameworkApplication.buildVersion;b.OS=this.Ca.kb("PlatformNameAndVersion")||"";const h=JSON.stringify(b);
sk.PCe=window.self.btoa(h)}}catch(b){t.ULS.sendTraceTag(508909765,378,10,"GetUrlReputationAdditionalProperties Error: {0}",b.message)}return sk.PCe}get v$l(){const b=this.Jpe?this.Jpe+"/":"",h=new Xa.QueryStringBuilder("SafeLinksHandler.ashx");h.Be("app",this.appName);this.Ca.$("SafeLinksUseDebugHeader")&&h.Be("action","debug");this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&h.Be("s2satpop","1");this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",
!1)&&h.Be("s2se03","1");return String.format("{0}{1}&{2}",b,h.toString(),v.AFrameworkApplication.em)}get Mjm(){const b=this.Jpe?this.Jpe+"/":"",h=new Xa.QueryStringBuilder("SafeLinksHandler.ashx");h.Be("app",this.appName);this.Ca.$("SafeLinksUseDebugHeader")&&h.Be("action","debug");this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&h.Be("s2satpop","1");this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&h.Be("s2saat","1");this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",
!1)&&h.Be("s2se03","1");this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",!1)&&h.Be("sladpar",this.cki);h.Be("slrt","GetUrlReputation");return String.format("{0}{1}&{2}",b,h.toString(),v.AFrameworkApplication.em)}get tgn(){sk.FRe||(sk.FRe=new Qh(this.Ca,this.$f,this.Mjm,sk.je));return sk.FRe}uoc(b){if(!b)return t.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),!1;var h=this.pOm(b);t.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",
h,this.Xod,this.Wod,this.EYb);if(!(h&&this.Xod&&this.Wod&&this.EYb))return!1;h=0;const r=({state:h}=this.bvo()).returnValue;t.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",gh[h]);const B=lb.a.vG();B&&B.set("SafeLinksNavigationState",gh[h]);va.Health.instance.recordKpiUsage("SafeLinksNavigations",0,"jpittsdirects",B);if(!r)return 2!==h&&3!==h||va.Health.instance.recordKpiFailure("SafeLinksNavigations",gh[h],!1,!0,null),!1;t.ULS.sendTraceTag(26019601,
378,50,"Using safelinks to navigate hyperlink");if(this.zvo())return this.bHf()?!1:this.tgn.uoc(this.VMl(),b,this.$ei());if(!this.bHf())return this.YCj(b),!0;this.$cb=b;t.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.LWc=!1;this.mUd();return!0}pOm(b){b=b.toLowerCase();const h=this.Ca.DB("SafeLinksUnsupportedProtocols");if(h)for(let r=0;r<h.length;r++)if(b.startsWith(h[r]))return!1;return!0}mUd(b=!1){var h=lb.a.vG();h&&h.set("isOnBootRequest",b.toString());
va.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",1,"jpittsdirects",h);va.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",0,"jpittsdirects",h);h=this.Iaf("SafeLinksGetPolicy");this.$f.mj(this.v$l,1,null,null,!0,2,Object(z.a)(this,this.Wcm,"getSafeLinksDataFromServer_OnSuccessCallback"),Object(z.a)(this,this.Vcm,"getSafeLinksDataFromServer_OnFailureCallback"),h,void 0,void 0,void 0,void 0,"23");this.LWc=b;this.Dmd=!0;b?this.svb++:this.tvb++}Wcm(b){let h=qa.a.cin,
r="";try{this.Dmd=this.LWc=!1;var B=b.data.state;const Gc=({YA:B}=this.wke(B)).returnValue,Uc=Object.assign(new hc.a,{durationMs:Gc});va.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",Uc);t.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",b.data.Se,b.data.se.length,Gc);if(b.data.Se!==qa.a.Zz)r="Unexpected httpStatus: "+b.data.Se.toString();else{B=null;try{B=H.b(b.data.se)}catch(od){r="Exception:"+
od.toString()+" deserializing response";return}if(B){var P=B.IsSafeLinksEnabled;if(void 0===P||null===P||0>=P.length)r="Invalid isSafeLinksEnabledString";else{t.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",P);var ca=sk.g0f(P);if(void 0===B.WebAffinitizedUrl||null===B.WebAffinitizedUrl||0>=B.WebAffinitizedUrl.length)r="Invalid WebAffinitizedUrl";else if(void 0===B.PolicyCookie||null===B.PolicyCookie||0>=B.PolicyCookie.length)r="Invalid PolicyCookie";else if(void 0===B.PolicyCookieTTL||
null===B.PolicyCookieTTL)r="Invalid PolicyCookieTTL";else{var ra=B.WebAffinitizedUrl,Qa=B.PolicyCookie,tb=B.AffinitizedUrl,Mb=new Date;Mb.setMinutes(Mb.getMinutes()+(5<B.PolicyCookieTTL?B.PolicyCookieTTL-5:0));var Zb=Mb.getTime(),jc=new Hn(P,ra,Qa,Zb,!1,tb);this.Jkj(jc);h=b.data.Se;this.$cb&&(ca?(this.YCj(this.$cb),this.tvb=this.svb=0):(t.ULS.sendTraceTag(26019602,378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),va.Health.instance.recordKpiFailure("SafeLinksNavigations","disabledByPolicy",
!0,!0,null),Qd.a.rib(this.$cb)),this.$cb=null)}}}else r="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(Gc){r="GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+Gc.toString()}finally{h!==qa.a.Zz&&this.smi(h,r)}}Vcm(b){this.Dmd=!1;let h=500,r="";try{let B=b.data.state;const P=({YA:B}=this.wke(B)).returnValue,ca=Object.assign(new hc.a,{durationMs:P});h=b.data.Se;va.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest","HttpStatusCode_"+h.toString(),
!1,!0,ca);r="Request Failed, Status="+Li.a[b.data.status]+" Duration: "+P}catch(B){r="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+B.toString()}finally{this.smi(h,r)}}smi(b,h=""){try{if(t.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",b,h),this.svb<this.lrd&&this.tvb<this.mrd)this.mUd(this.LWc);else{this.LWc=!1;t.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",
this.svb,this.tvb,b,h);h=null;const r=lb.a.vG();r&&(r.set("HttpStatus",b.toString()),h=Object.assign(new hc.a,{extendedProperties:r}));va.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,h);const B=new Hn("false","","",0,!0,"");this.Jkj(B);this.$cb&&(t.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}","disabled_GetPolicyFailure"),va.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",
!1,!0,null),Qd.a.rib(this.$cb),this.$cb=null)}}catch(r){t.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",r.toString())}}YCj(b){const h=this.$ei(),r=this.$km(),B={};B.Url=b;B.SafeLinksCookie=h;B.CorrelationId=Bb.a.create().toString();B.WorkloadId=this.s8o;B.UserAgentInfo=Z.a.qG+"|"+this.appName;this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksParamUpdates",!1)&&(B.User=sk.zlh,B.TenantId=sk.gEc,B.AdditionalProperties=this.cki);t.ULS.sendTraceTag(23900187,
378,50,"Validating hyperlink with request correlation: {0}",B.CorrelationId);Qd.a.Z1f(Qd.a.esa(4),r,B)}YTm(){const b=this.Ca.kb("IsSafeLinksEnabledForUser");return b?sk.g0f(b):!1}XTm(){const b=this.Ca.DB("SafeLinksDisabledBrowsers");if(Z.a.O4){if(this.Ca.rw("SafeLinksForTeamsIsEnabled")&&this.Ca.$("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(b,"Electron"))return!1}else if(Array.contains(b,Z.a.qG))return!1;return"officecomhwa"===(this.Ca.kb(v.AFrameworkApplication.Dka)||"").toLowerCase()?
!1:!0}zvo(){return-1!==window.location.href.indexOf("&wd_slnh=1")||this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksUseNavigationHelperForMobile",!1)&&Z.a.oXc?!0:Z.a.O4}bvo(){let b;b=0;const h=this.Oib(),r=h?h.IsSafeLinksEnabled:"";if(""!==r)return h.WasServiceDown?(t.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===r.toLowerCase()?(t.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),{returnValue:!1,state:1}):
{returnValue:sk.g0f(r),state:b};if(this.Dmd)return b=3,t.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:b};if(this.svb>=this.lrd||this.tvb>=this.mrd)return b=2,t.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.svb,this.lrd,this.tvb,this.mrd),{returnValue:!1,state:b};t.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",
this.lrd+this.mrd-(this.svb+this.tvb));return{returnValue:!0,state:b}}$ei(){const b=this.Oib();return b?b.PolicyCookie:""}$km(){const b=this.Oib();return b?b.WebAffinitizedUrl:""}VMl(){const b=this.Oib();return b?b.AffinitizedUrl:""}xXl(){const b=new Date;try{const h=this.Oib();b.setTime(h?h.PolicyCookieTTL:0)}catch(h){t.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",h)}return b}bHf(){const b=this.xXl();return!!b&&b.getTime()<Date.now()}Oib(){if(!this.Qwd){const b=
Ua.a.instance.getItem(this.userId);if(!b||""===b)return null;this.Qwd=JSON.parse(b)}return this.Qwd}Jkj(b){if(void 0===b||null===b)throw Error.argumentNull("safeLinksData");if(void 0===b.IsSafeLinksEnabled||null===b.IsSafeLinksEnabled||0>=b.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");this.Qwd=b;b.WasServiceDown||this.H8o(b)}H8o(b){b=JSON.stringify(b);Ua.a.instance.setItem(this.userId,b)}Iaf(b){return void 0!==sk.je&&null!==sk.je?sk.je.Zf("WebServiceCall",
b):null}wke(b){if(void 0!==b&&null!==b){const h=b.oi;b.stop();return{returnValue:h,YA:null}}return{returnValue:null,YA:b}}static g0f(b){return"false"!==b.toLowerCase()?!0:!1}}sk.je=null;sk.FRe=null;sk.gEc="";sk.zlh="";sk.PCe="";Object(m.a)(sk,"SafeLinksManager",null,[596]);const Xi=b=>{switch(b){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 4:return"OneNote";case 5:return"Visio";default:return"Unknown"}},Zk=b=>{switch(b){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";
default:return"Unknown"}};class ne{constructor(){this.W=null}get name(){return"Common.App.SafeLinks"}wc(b){this.W=b}init(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.Nn(Object(z.a)(this,this.Xx,"onFullAppSettingsReady"))}dispose(){}Xx(){v.AFrameworkApplication.K.$("WACSafeLinksIsEnabled")&&(this.W.register(sk,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").ha().Ud(()=>new sk(v.AFrameworkApplication.K,v.AFrameworkApplication.He,String.format("{0}-{1}",
Xi(v.AFrameworkApplication.ua.Kb.yk),Zk(v.AFrameworkApplication.ua.Kb.Yia)),!1,this.W.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),v.AFrameworkApplication.ua.Lq)),this.W.Oa("Common.App.SafeLinks.ISafeLinksManager"))}static main(){L.a.instance.Gc(new ne)}}Object(m.a)(ne,"SafeLinksPackage",null,[1,2]);var $k=c(212);class wf{constructor(b){this.sa=new Pc.a;this.Nh=b}Ueb(b){this.sa.addHandler(wf.Eza,b)}Y6c(b){this.sa.removeHandler(wf.Eza,b)}A_a(b){this.sa.addHandler(wf.rVa,b)}cPb(b){this.sa.removeHandler(wf.rVa,
b)}y0e(b){this.sa.addHandler(wf.Snc,b)}fhg(){this.sa.raiseEvent(wf.Eza)}hzf(){return $k.a.instance.IRa(v.AFrameworkApplication.zy)}}wf.Eza="SE";wf.j9c="SEP";wf.rVa="SER";wf.Snc="TRP";Object(m.a)(wf,"NullSessionExpirationManager",null,[493,494]);class wj{constructor(){this.dDc=this.Ndb=!1;const b=v.AFrameworkApplication.zy;0>=b||(this.zy=b,t.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.zy,["NowGetTime"]:(new Date).getTime(),["BootTime"]:v.AFrameworkApplication.vX}),
$k.a.instance.Lrh(Object(z.a)(this,this.ihc,"onSessionExpiredDetected")),$k.a.instance.Krh(Object(z.a)(this,this.G2c,"onSessionExpiringDetected")))}ihc(){$k.a.instance.hcj(Object(z.a)(this,this.ihc,"onSessionExpiredDetected"));t.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.yyf()}G2c(){$k.a.instance.q2n(Object(z.a)(this,this.G2c,"onSessionExpiringDetected"));this.dDc||this.Ndb||(t.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.dDc=!0,
this.Nhg())}yyf(){this.Ndb||(v.AFrameworkApplication.mN(Zl.a.i9c),this.Ndb=!0,this.qje())}}Object(m.a)(wj,"ASessionExpirationManager",null,[]);var Pe=c(155),Kg=c(276);class em{constructor(b,h,r,B){this.nmg="";this.mgd=b;this.Sfh=r;this.Ofh=B;this.e1g=h;b=(new Date(this.mgd)).format(v.AFrameworkApplication.Zpj);this.nmg=this.e1g?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,b)}Qkc(b){1===b?this.Sfh&&this.Sfh(this.e1g):0===b&&v.AFrameworkApplication.va.Qb(fb.a.close,
2,Kg.g)}dispose(){this.Ofh&&this.Ofh()}}em.id="SessionExpirationDialog";Object(m.a)(em,"SessionExpirationDialogSharedProperties",null,[]);class jl{}jl.Vg="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";Object(m.a)(jl,"SessionExpirationDialogHtml",null,[]);class io extends Pe.a{constructor(b,h,r,B){super(h);const P={};this.EZa=new em(b,h,r,B);this.yg=em.id;v.AFrameworkApplication.GBh?(this.Cd=1,
this.ze(0,CommonUIStrings.l_DialogClose)):(this.Cd=0,this.Kt=!1);h||1===v.AFrameworkApplication.ua.mode?this.ze(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.ze(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.Vg=jl.Vg;P.WACSessionExpirationText=this.EZa.nmg;this.Uh(CommonUIStrings.l_DefaultDialogTitle,Object(z.a)(this,this.Qkc,"sessionExpirationDialogHandler"),P);this.L5(this.qj("WACSessionExpirationText"))}Qkc(b){this.EZa.Qkc(b)}Dzf(){this.hide()}dispose(){super.dispose();
this.EZa&&this.EZa.dispose()}}Object(m.a)(io,"LegacySessionExpirationDialog",Pe.a,[666]);class Mf extends Tf.StandardDialog{constructor(b,h,r,B){super(h);this.EZa=new em(b,h,r,B);this.yg=em.id;v.AFrameworkApplication.GBh?(this.Cd=1,this.ze(0,CommonUIStrings.l_DialogClose)):(this.Cd=0,this.Kt=!1);h||1===v.AFrameworkApplication.ua.mode?this.ze(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.ze(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.rv(CommonUIStrings.l_DefaultDialogTitle,
this.EZa.nmg,0,Object(z.a)(this,this.Qkc,"sessionExpirationDialogHandler"))}Qkc(b){this.EZa.Qkc(b)}Dzf(){this.hide()}dispose(){super.dispose();this.EZa&&this.EZa.dispose()}}Object(m.a)(Mf,"SessionExpirationDialog",Tf.StandardDialog,[666]);const nk=(b,h,r,B)=>v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.vF&&v.AFrameworkApplication.K.$("ReactStandardSessionExpirationDialogIsEnabled")?new Mf(b,h,r,B):new io(b,h,r,B);var mj=c(203);class Rf extends wj{constructor(b){super();this.txd=this.u0b=
!0;this.o_=null;this.sa=new Pc.a;this.Nh=b}Ueb(b){this.sa.addHandler(Rf.Eza,b)}Y6c(b){this.sa.removeHandler(Rf.Eza,b)}A_a(b){this.sa.addHandler(Rf.rVa,b)}cPb(b){this.sa.removeHandler(Rf.rVa,b)}y0e(b){this.sa.addHandler(Rf.Snc,b)}hzf(){return $k.a.instance.IRa(v.AFrameworkApplication.zy)}fhg(b){this.u0b=b}Nhg(){if(!this.o_&&!mj.a.DM){if(this.txd){const b=Object(z.a)(this,this.c7b,"disposeCallback");this.o_=nk(this.zy,!1,Object(z.a)(this,this.Rkc,"sessionExpirationHandler"),b)}this.sa.raiseEvent(Rf.j9c)}}qje(){this.o_&&
(this.o_.Mpa&&this.o_.Dzf(),this.o_=null);if(this.u0b){const b=Object(z.a)(this,this.c7b,"disposeCallback");this.o_=nk(this.zy,!0,Object(z.a)(this,this.Rkc,"sessionExpirationHandler"),b)}this.sa.raiseEvent(Rf.Eza)}c7b(){this.o_=null}Rkc(b){(b||this.Nh.fEd())&&this.Nh.refreshDocument(null)}}Rf.Eza="SE";Rf.j9c="SEP";Rf.rVa="SER";Rf.Snc="TRP";Object(m.a)(Rf,"SessionExpirationManager",wj,[493,494]);class sg{}sg.Fpk="Aborting";sg.tBd="ActivityDuration";sg.error="Error";sg.njf="Errors";sg.failed="Failed";
sg.aFb="FirstActivity";sg.initialized="Initialized";sg.kickedOut="KickedOut";sg.WZm="LastActivity";sg.tfj="RetryOverride";sg.ree="RequestGroups";sg.mpb="Requests";sg.Dee="Responses";sg.jge="SessionDuration";sg.status="Status";sg.success="Success";sg.uFo="Successful";sg.tokens="Tokens";sg.w1f="PollingDuration";Object(m.a)(sg,"SessionExpirationStrings",null,[]);class db{constructor(b){this.sC={};this.Wka={};this.OYa={};this.TKi=15;this.a3g=!1;this.Uik=new Date;this.jqd=new Date;this.Ib=b;this.kO=new Me.a(2,
2,6E4*this.TKi,Object(z.a)(this,this.kMj,"writeMeasures"),135,"SL",!1);this.Ib.Wb(this.kO);this.CBm()}kMj(){t.ULS.sendTraceTag(41964821,217,50,t.ULS.gZc({["Aggregate"]:this.Wka,["Current"]:this.sC}))}CBm(){this.Wka[sg.ree]=0;this.Wka[sg.mpb]=0;this.Wka[sg.Dee]=0;this.Wka[sg.status]=sg.initialized;this.Wka[sg.aFb]=new Date;this.Wka[sg.jge]=0;this.Wka[sg.tBd]=0;this.Wka[sg.jge]=0;this.sC[sg.jge]=0;this.Wka[sg.tBd]=0;this.sC[sg.tBd]=0}get dEn(){this.OYa[sg.w1f]=+new Date-+this.OYa[sg.aFb];return this.OYa}fBf(b,
h){var r=b[h];r=r?r:0;r++;b[h]=r;this.Udg(b)}Udg(b){const h=new Date;b[sg.tBd]=+h-+this.jqd;this.jqd=h;b[sg.jge]=+this.jqd-+this.Uik;b[sg.WZm]=this.jqd}J$(b,h){this.sC[b]=h;this.Udg(this.sC)}jdg(b,h){this.sC[b]=h;this.Udg(this.sC)}xbc(b){this.fBf(this.sC,b);this.fBf(this.Wka,b);this.fBf(this.OYa,b)}flush(){this.a3g||(this.Wka[sg.status]=this.sC[sg.status],this.kMj(this.kO),this.Ib.A1(this.kO,6E4*this.TKi))}q6n(){const b=this.sC[sg.status];b&&(this.Wka[sg.status]=b);this.sC={}}H6n(){this.OYa={};this.OYa[sg.w1f]=
0;this.OYa[sg.aFb]=new Date}stop(){t.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.a3g=!0;this.Ib.ff(this.kO)}}Object(m.a)(db,"SessionLogger",null,[489]);class Lb{constructor(b,h){this.rzd=b;this.tBa=h}get tokens(){return this.rzd}get errors(){return this.tBa}}Object(m.a)(Lb,"TokenRefreshArgs",null,[535]);var kc=c(399);class Kc extends Sys.EventArgs{constructor(b,h,r,B,P,ca,ra){super();this.OYa=b;this.VDn=h;this.ree=B;this.failed=P;this.mpb=ca;this.Dee=
ra}}Object(m.a)(Kc,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);var Qc=c(35);class md{constructor(b,h=null,r=null){this.dDc=this.Ndb=!1;this.txd=this.u0b=!0;this.sa=new Pc.a;this.fDc=this.eyc=this.fvd=!1;this.hyb=null;this.sbh=10;this.Apd=!1;this.lWe=b;this.THe=v.AFrameworkApplication.bYm;this.Ib=Wg.a.instance;t.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:v.AFrameworkApplication.zy,["NowGetTime"]:(new Date).getTime(),["BootTime"]:v.AFrameworkApplication.vX});
this.ve=h||new db(Wg.a.instance);this.zma=r;$k.a.instance.Lrh(Object(z.a)(this,this.zpk,"aSessionExpirationManagerWithRefresh_OnSessionExpired"));$k.a.instance.Krh(Object(z.a)(this,this.QYe,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));kc.SessionStatusManager.instance.v0e(Object(z.a)(this,this.QYe,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));kc.SessionStatusManager.instance.fzk(Object(z.a)(this,this.XFn,"preemptiveTokenRefresh"));this.u4g=new Date;v.AFrameworkApplication.aYm&&
($k.a.instance.Y6e=Object(z.a)(this,this.$Tn,"refreshAccessTokenWhenSessionExpired"));b=!1;v.AFrameworkApplication.K&&(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",!1),this.sbh=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1),b=v.AFrameworkApplication.K.$("WopiTokenRefreshWhenNetworkResumed"));
b?kc.SessionStatusManager.instance.v0e(Object(z.a)(this,this.Apk,"aSessionExpirationManagerWithRefresh_OnSessionExpiringNetworkResumed")):kc.SessionStatusManager.instance.v0e(Object(z.a)(this,this.QYe,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"))}Ueb(b){this.sa.addHandler(md.Eza,b)}Y6c(b){this.sa.removeHandler(md.Eza,b)}A_a(b){this.sa.addHandler(md.rVa,b)}cPb(b){this.sa.removeHandler(md.rVa,b)}y0e(b){this.sa.addHandler(md.Snc,b)}hzf(){return $k.a.instance.IRa(v.AFrameworkApplication.zy)}$Tn(){this.WSc(!1);
return!$k.a.instance.IRa(v.AFrameworkApplication.zy)}zpk(b,h){$k.a.instance.V0d?this.ihc(b,h):this.THe?(this.eyc=!1,this.WSc(!1)):(this.Ndb||t.ULS.sendTraceTag(520954892,217,15,"Detected session expiry before token refresh got blocked"),this.ihc(b,h))}Apk(b,h){$k.a.instance.U0d?this.G2c(b,h):(Qc.b(512247769,306,50,"Refreshing tokens since the user has network and session is expiring."),this.eyc=!1,this.WSc(!0))}QYe(b,h){$k.a.instance.U0d?this.G2c(b,h):this.WSc(!0)}WSc(b){if(!this.fvd&&!this.eyc)if(this.zma&&
this.zma.Jo)this.fDc=!0,this.ve.J$(sg.status,sg.kickedOut),this.ve.flush(),this.ve.stop();else if(t.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",b,this.fDc),this.fDc)this.qje();else{this.ve.flush();this.ve.q6n();this.ve.xbc(sg.ree);this.fvd=!0;this.Apd||(this.ve.H6n(),this.Apd=!0,this.v9k());const h=this.lWe.tUn(b);h.continueWith(()=>{if(this.lWe.cKn(h))this.ve.xbc(sg.uFo),this.ve.J$(sg.status,sg.success),this.txd=!1,this.THe&&(this.u0b=!1),this.eyc=!1,this.u4g=
new Date,this.fEo(),this.sa.raiseEvent(md.rVa,new Lb(h.result.tokens,null));else{const r=h.result.errors;this.ve.xbc(sg.failed);this.ve.J$(sg.status,sg.failed);b||(this.fDc=this.lWe.IXc(r));this.fDc&&(this.ve.J$(sg.Fpk,JSON.stringify(r)),t.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.eyc=!0;this.sa.raiseEvent(md.rVa,new Lb(null,r))}this.ve.flush();this.fvd=!1})}}ihc(){this.THe||$k.a.instance.hcj(Object(z.a)(this,this.ihc,"onSessionExpiredDetected"));t.ULS.sendTraceTag(39408094,
217,50,"SessionExpiredDetected");this.yyf($k.a.instance.V0d)}G2c(){this.dDc||this.Ndb||(t.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.dDc=!0,this.Nhg($k.a.instance.U0d))}yyf(b){if(!this.Ndb){var h=b?Zl.a.Tfo:Zl.a.i9c;const r=Object.assign(new hc.a,{extendedProperties:new Map});r.extendedProperties.set("ErrorCode",String.format("{0}",h));v.AFrameworkApplication.mN(h,void 0,["SessionExpired"],r);b||(b=new Date,h=new Date(v.AFrameworkApplication.vX),t.ULS.sendTraceTag(51642974,
217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",h,b,+b-+h),864E5>+b-+h&&va.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",["SessionExpired"],!0,!0,!1,!0,r),2592E5>+b-+h&&va.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,r));this.Ndb=!0;this.qje()}}fEo(){this.Apd&&(this.Ib.ff(this.hyb),this.Apd=!1)}v9k(){this.hyb=new Me.a(2,2,1E3*this.sbh,Object(z.a)(this,this.OLo,"tokenRefreshPolling"),
135);this.Ib.Wb(this.hyb)}OLo(){const b=this.ve.dEn;t.ULS.sendTraceTag(555255521,217,50,"{0}",H.c(b));this.sa.raiseEvent(md.Snc,new Kc(b,b[sg.w1f],b[sg.aFb],b[sg.ree],b[sg.failed],b[sg.mpb],b[sg.Dee]))}XFn(){3E5<+new Date-+this.u4g?(t.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),this.WSc(!1)):t.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")}}md.Eza="SE";md.j9c="SEP";md.rVa="SER";md.Snc="TRP";Object(m.a)(md,
"ASessionExpirationManagerWithRefresh",null,[]);class Hd extends md{constructor(b,h,r=null,B=null){super(h,r,B);this.o_=null;this.Nh=b}fhg(b){this.u0b=b}Nhg(b){if(!this.o_&&!mj.a.DM){if(b){var h=Object(z.a)(this,this.c7b,"disposeCallback");this.o_=nk(v.AFrameworkApplication.zpb,!1,Object(z.a)(this,this.Rkc,"sessionExpirationHandler"),h)}else if(this.txd){if(this.fvd)return;h=Object(z.a)(this,this.c7b,"disposeCallback");this.o_=nk(v.AFrameworkApplication.zy,!1,Object(z.a)(this,this.Rkc,"sessionExpirationHandler"),
h)}t.ULS.sendTraceTag(39408096,217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",md.j9c,b);this.sa.raiseEvent(md.j9c)}}qje(){this.o_&&(this.o_.Mpa&&this.o_.Dzf(),this.o_=null);if(this.u0b){this.ve.stop();if(this.zma&&this.zma.Jo)return;const b=Object(z.a)(this,this.c7b,"disposeCallback");this.o_=nk(v.AFrameworkApplication.zy,!0,Object(z.a)(this,this.Rkc,"sessionExpirationHandler"),b)}t.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",md.Eza);this.sa.raiseEvent(md.Eza)}c7b(){this.o_=null}Rkc(b){(b||
this.Nh.fEd())&&this.Nh.refreshDocument(null)}}Object(m.a)(Hd,"SessionExpirationManagerWithRefresh",md,[493,494]);class Ne{constructor(b,h,r=null,B=null){this.hlh=!1;this._instance=null;this._frame=b;this.Om=h;this.ve=r||new db(Wg.a.instance);this.zma=B}create(){this.hlh=v.AFrameworkApplication.TRa;if(!this.hlh)return new Rf(this._frame);v.AFrameworkApplication.ho("WOPITokenRefreshIsEnabled");t.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");if(!this._instance)switch(v.AFrameworkApplication.U4o){case 1:t.ULS.sendTraceTag(39408090,
217,50,"Creating new NullSessionExpirationManager");this._instance=new wf(this._frame);break;case 2:t.ULS.sendTraceTag(39408091,217,50,"Creating new SessionExpirationManagerWithRefresh");this._instance=new Hd(this._frame,this.Om,this.ve,this.zma);break;default:t.ULS.sendTraceTag(39408092,217,50,"Creating new legacy SessionExpirationManager"),this._instance=new Rf(this._frame)}t.ULS.sendTraceTag(39408089,217,50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this._instance).getName());
return this._instance}}Object(m.a)(Ne,"SessionExpirationManagerFactory",null,[492]);class Cc{}Object(m.a)(Cc,"Error",null,[]);class oe{}Object(m.a)(oe,"NamedResult",null,[]);class gc extends oe{}Object(m.a)(gc,"ErrorInfo",oe,[]);var eh=c(1094);class nj{constructor(b,h,r,B=null,P=!1,ca=null,ra=!1,Qa=!1){this.rCa=0;this.DNa=this.Do=null;this.rzd=new mb.a;this.tBa=new mb.a;this.jq=null;this.Mxc=!1;this.sEc=this.tEc=null;this.Ib=b;this.xbh=h;this.xbh.execute(tb=>{tb.eC(M.a.eAf,Object(z.a)(this,this.qpn,
"onHostResponseReceived"))});this.t3=r;this.Mjh=new eh.a("WebServiceCall","TokenRefresh");this.ve=B||new db(b);this.Nik=P;this.rf=ca?ca:kc.SessionStatusManager.instance;this.iUg=ra;this.Ukd=Qa}qpn(b){if(b.MessageId!==M.a.eAf)Qc.b(39408099,306,15,"Unexpected message.");else{var h=new mb.a,r=new mb.a;this.ve.xbc(sg.Dee);var B=b.Values[G.a.ikj];if(!B||0>=B.length)Qc.b(40122317,306,15,"Found no tokens in the dictionary"),B=b.Values;Qc.b(40122318,306,100,"The Tokens array contains {0} tokens",B.length);
this.ve.J$("Correlation",b.CorrelationId);var P="";for(let Qa=0;Qa<B.length;Qa++){this.ve.jdg(sg.tokens,B.length);var ca=B[Qa],ra=ca;if(!ra||!ra.Name)continue;this.ve.xbc(ra.Name);const tb=ca;if(tb&&tb.Value)Qc.b(39408128,306,100,"Received token with name: {0}",tb.Name),h.add(tb),this.rzd.add(tb),this.Ukd||this.ve.J$(sg.status,sg.success),this.iUg&&this.rf&&this.rf.Z6n();else if(ca=this.gdm(ca),Qc.b(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",ra.Name,
JSON.stringify(ca),this.DNa),r.add(ca),this.Ukd||(this.tBa.add(ca),P=JSON.stringify(ca),this.ve.J$(sg.error,JSON.stringify(ca)),this.ve.J$(sg.status,sg.failed)),this.iUg)for(const Mb of ca.Errors)ra=this.lXl(Mb),this.rf&&this.rf.gwk(ra)}this.Ukd?(0<r.count?this.sEc?this.sEc(new Lb(h,r)):Qc.b(512267295,306,15,"Received errors but the promise has completed"):this.tEc?this.tEc(new Lb(h,r)):Qc.b(512267294,306,15,"Received valid tokens but the promise has completed"),Qc.b(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",
h.count,r.count,b.CorrelationId,this.DNa)):(0<r.count&&""!==P?(B=Object.assign(new hc.a,{extendedProperties:new Map}),B.extendedProperties.set("Errors",P),B.extendedProperties.set("RetryCount",this.rCa.toString()),B.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),B.extendedProperties.set("IsTokenExpiring",this.Mxc.toString()),va.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,B)):va.Health.instance.recordKpiSuccess("WACTokenRefresh",null),
Qc.b(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",h.count,r.count,b.CorrelationId,this.DNa),0<r.count&&!this.IXc(r)?(b=this.t3.sgi(r),b!==this.t3.Rjc&&(this.ve.jdg(sg.tfj,b),this.Ib.A1(this.Do,b))):(this.ve.flush(),this.Do&&(Qc.b(39408131,306,100,"Deleting task {0} from task manager",this.Do.name),this.Ib.ff(this.Do)),this.jq&&!this.jq.task.isCompleted?this.jq.Dg(new Lb(h,r)):Qc.b(512267293,306,15,"Received results but the task has completed")))}}gdm(b){if(!b)return null;
const h=Object.assign(new gc,{Name:b.Name,Errors:[]});for(const r of b.Errors)b=new Cc,b.Id=r.Id,b.Details=pa.a.P$b(r.Details,500),h.Errors.push(b);return h}requestTokensOnce(){this.eej()}eej(){v.AFrameworkApplication.oe("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.rCa>=this.t3.B4d?(Qc.b(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.DNa),this.nal(this.jq)):(va.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.rjj())}rjj(){const b=
{};b[G.a.ikj]=this.t3.tokens;const h=Bb.a.create().toString();Qc.b(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.t3.tokens),this.rCa+1,h,this.DNa);this.xbh.execute(r=>{r.sendMessage(M.a.V1e,b,h)});this.rCa++;this.ve.xbc(sg.mpb)}nal(b){const h=new mb.a;for(let r=0;r<this.t3.tokens.length;r++){const B=Object.assign(new gc,{Name:this.t3.tokens[r],Errors:[Object.assign(new Cc,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});
h.add(B);this.tBa.add(B)}this.Ib.ff(this.Do);this.ve.J$(sg.njf,JSON.stringify(this.tBa));this.ve.J$(sg.status,sg.failed);b&&!b.task.isCompleted&&b.Dg(new Lb(new mb.a,this.tBa))}tUn(b){this.Mjh.start();this.Mxc=b;this.DNa=Bb.a.create().toString();Qc.b(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.DNa,this.Mxc);this.rCa=0;this.tBa.clear();this.rzd.clear();this.jq=new Hf.a;this.Ukd?this.fej(this.t3.B4d).then(h=>{this.jq&&!this.jq.task.isCompleted&&this.jq.Dg(h);this.sEc=
this.tEc=null;this.ve.J$(sg.njf,JSON.stringify(this.tBa));this.ve.J$(sg.status,sg.success);this.ve.flush()}).catch(h=>{this.jq&&!this.jq.task.isCompleted&&this.jq.Dg(Object(Ra.a)(535,h));this.sEc=this.tEc=null;this.ve.J$(sg.njf,JSON.stringify(this.tBa));this.ve.J$(sg.status,sg.failed);this.ve.flush()}):(this.Do=new Me.a(this.t3.priority,2,this.t3.Rjc,Object(z.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,M.a.V1e,!0),this.Nik&&this.eej(),this.Ib.Wb(this.Do));return this.jq.task}fej(b){const h=
this,r=new Promise((Qa,tb)=>{h.tEc=Qa;h.sEc=tb;va.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);h.rjj()}),B=this,P=new Promise((Qa,tb)=>{window.setTimeout(()=>{tb(B.iMh("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},B.t3.Rjc)});let ca=b;const ra=this;return new Promise((Qa,tb)=>{ca--;Promise.race([r,P]).then(Mb=>{va.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Qa(Mb)}).catch(Mb=>{var Zb=ra.t3.Rjc;if(Object(Ib.a)(535,Mb)&&
(Mb=Object(Ra.a)(535,Mb),0<Mb.errors.count)){ra.a5m(Mb.errors);ra.Hoh(Mb.errors);if(ra.IXc(Mb.errors)){tb(Mb);return}const jc=ra.t3.sgi(Mb.errors);jc!==ra.t3.Rjc?(ra.ve.jdg(sg.tfj,jc),Zb=jc):ra.xWm(Mb.errors)&&(Zb=0)}ca?window.setTimeout(()=>{ra.fej(ca).then(Qa).catch(tb)},Zb):(Zb=ra.iMh("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),ra.Hoh(Zb.errors),tb(Zb),Qc.b(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",
ra.DNa))})})}Hoh(b){for(let h of b)this.tBa.add(h)}xWm(b){if(!b.count)return!1;b=b.J(b.count-1);return b.Errors.length?"TIMEOUT"==b.Errors[0].Id:!1}iMh(b,h){const r=new mb.a;for(let B=0;B<this.t3.tokens.length;B++){const P=this.oal(this.t3.tokens[B],b,h);r.add(P)}return new Lb(new mb.a,r)}oal(b,h,r){return Object.assign(new gc,{Name:b,Errors:[Object.assign(new Cc,{Id:h,Details:r})]})}a5m(b){if(b.count){b=b.J(b.count-1);b=JSON.stringify(b);var h=Object.assign(new hc.a,{extendedProperties:new Map});
h.extendedProperties.set("Errors",b);h.extendedProperties.set("RetryCount",this.rCa.toString());h.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());h.extendedProperties.set("IsTokenExpiring",this.Mxc.toString());va.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,h);this.ve.J$(sg.error,b);this.ve.J$(sg.status,sg.failed)}}cKn(b){this.Mjh.stop();const h=this.gsm(b.result.errors);t.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!h,this.DNa,this.Mxc,this.rCa,this.tBa.count,0<b.result.errors.count?b.result.errors.J(0).Name:"",0<b.result.errors.count&&0<b.result.errors.J(0).Errors.length?b.result.errors.J(0).Errors[0].Id:"",0<b.result.errors.count&&0<b.result.errors.J(0).Errors.length?b.result.errors.J(0).Errors[0].Details:"");return h?!1:this.bKn(b.result.tokens)}IXc(b){return this.t3.IXc(b)}bKn(b){for(let h=0;h<b.count;h++){const r=b.J(h);if(r.Name===G.a.accessToken){const B=(new Date).getTime();r.Expiry>v.AFrameworkApplication.zy?
(t.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:r.Expiry,["NowGetTime"]:B,["BootTime"]:v.AFrameworkApplication.vX},"PreviousAccessTokenTtl",v.AFrameworkApplication.zy),v.AFrameworkApplication.accessToken=r.Value,v.AFrameworkApplication.zy=Math.floor(r.Expiry),v.AFrameworkApplication.qsg=B,v.AFrameworkApplication.Cua=Math.floor(r.Expiry)):t.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:r.Expiry,
["NowGetTime"]:B,["BootTime"]:v.AFrameworkApplication.vX},"PreviousAccessTokenTtl",v.AFrameworkApplication.zy)}}return!0}gsm(b){let h=!1;for(let r=0;r<b.count;r++){h=!0;const B=b.J(r);t.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",B.Name,JSON.stringify(B.Errors),this.DNa)}return h}lXl(b){let h=Zl.a.i9c;b=parseInt(b.Id);if(isNaN(b))h=Zl.a.lLj;else{switch(b){case 401:h=Zl.a.rsg;break;case 403:h=Zl.a.jLj;break;case 500:h=Zl.a.kLj;break;case 503:h=Zl.a.nLj}h===
Zl.a.i9c&&(h=500<b?Zl.a.mLj:Zl.a.iLj)}return h}}Object(m.a)(nj,"TokenRefreshManager",null,[491]);class vi{constructor(){this.Rjc=v.AFrameworkApplication.X4o;this.B4d=v.AFrameworkApplication.V4o;this.tokens=v.AFrameworkApplication.mmm();this.priority=v.AFrameworkApplication.Y4o;this.Vdh=this.Ymo();this.vYe=v.AFrameworkApplication.lmm()}IXc(b){b=JSON.stringify(b);if(this.vYe&&0<this.vYe.length)for(const h of this.vYe)if(0<h.length&&0<=b.indexOf(h))return!0;return!1}sgi(b){try{if(b)for(let h of b)if(h.Errors)for(const r of h.Errors)if(r.Id in
this.Vdh)return Number.parseInvariant(this.Vdh[r.Id].toString())}catch(h){t.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",h.toString())}return this.Rjc}Ymo(){const b={};try{if(!v.AFrameworkApplication.uVd()||0>=v.AFrameworkApplication.uVd().length||""===v.AFrameworkApplication.uVd()[0])return b;for(const h of v.AFrameworkApplication.uVd())0<h.length&&(b[h]=v.AFrameworkApplication.W4o)}catch(h){t.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",
h.toString())}return b}}Object(m.a)(vi,"TokenRefreshPolicy",null,[490]);class ge{constructor(){this.W=null}get name(){return"Common.App.SessionExpiration"}init(){v.AFrameworkApplication.K.Nn(()=>{this.K3a()})}K3a(){this.W.resolve("Common.ISessionExpirationManagerFactory");this.W.resolve("Common.ISessionExpirationManager");this.W.resolve("Common.ISessionExpirationManagerWithDialog")}dispose(){}wc(b){this.W=b;b.register(489,"Common.App.SessionExpiration.ISessionLogger").ha().Ud(()=>new db(Wg.a.instance));
b.register(490,"Common.App.SessionExpiration.ITokenRefreshPolicy").ha().Ud(()=>new vi);b.register(491,"Common.App.SessionExpiration.ITokenRefreshManager").ha().Ud(()=>new nj(Wg.a.instance,v.AFrameworkApplication.mP(),b.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),v.AFrameworkApplication.K.$("WopiTokenRefreshSendTokenRequestWithoutTasks"),b.Oa("Common.ISessionStatus"),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",
!1),v.AFrameworkApplication.K.$("WopiTokenRefreshSyncMessageWithTimeout")));b.register(492,"Common.ISessionExpirationManagerFactory").ha().Ud(()=>new Ne(v.AFrameworkApplication.ua,b.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),b.resolve("Common.App.SessionExpiration.ISessionLogger"),b.Oa("Common.ISessionStatus")));b.register(493,"Common.ISessionExpirationManagerWithDialog").ha().Ud(()=>b.resolve("Common.ISessionExpirationManagerFactory").create());b.register(494,"Common.ISessionExpirationManager").ha().Ud(()=>
b.resolve("Common.ISessionExpirationManagerWithDialog"))}static main(){L.a.instance.Gc(new ge)}}Object(m.a)(ge,"SessionExpirationPackage",null,[1,2]);var wg=c(763),$f=c(401),di=c(340),ah=c(208);class Zj extends ah.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(m.a)(Zj,"PersonaButtonProps",ah.a,[]);class ng{$5b(b,h){if(b&&!(1>b.length)&&h){var r=Object.assign(new di.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.Eal(b,r.ControlList);
h.push(r)}}Eal(b,h){const r=Object.assign(new wg.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new $f.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(h,r);h=Object.assign(new di.a,{Title:"",ControlList:[]});Array.add(r.Menu.MenuSectionList,h);this.Bdl(b,h.ControlList)}Bdl(b,h){for(let r=0;r<b.length;r++){const B=Object.assign(new Zj,{ExternalId:String.format("CoauthorPersona_{0}",r),
Command:"336231556",DisplayName:b[r].userName,LabelText:b[r].userName,ImageBackColor:b[r].color,PersonaId:b[r].email,IsAnonymous:b[r].isAnonymous});Array.add(h,B)}}}Object(m.a)(ng,"PresenceContextMenuSectionBuilder",null,[532]);var Xo=c(100);class Mh{constructor(b,h,r,B){this.SAa=this.wt=this.Do=this.ai=this.zKa=null;this.yxd=b;this.bkk=B;this.yxd.RVc&&(this.Do=new Me.a(3,2,5E3,Object(z.a)(this,this.EIk,"authenticationCheckTask"),2),v.AFrameworkApplication.lc.Wb(this.Do),this.Tb(h,r));this.yxd.Pwk(()=>
{this.oMb()});this.yxd.zqh(()=>{this.pMb()})}get SK(){return this.wt||(this.wt=Ma.a.instance.Oa("CommonUI.IBusinessBar"))}get Rzh(){return this.SAa||(this.SAa=Ma.a.instance.Oa("CommonUI.IBusinessBarEntryFactory"))}Tb(b,h){const r=v.AFrameworkApplication.va;r.fb(fb.a.Lwh,yd.a.frame,b,96);r.fb(fb.a.Mwh,yd.a.frame,h,96);r.ra(fb.a.bCh,yd.a.frame,cd.ActionManager.gR);r.ra(fb.a.cCh,yd.a.frame,cd.ActionManager.gR);r.ra(fb.a.yKf,yd.a.frame,cd.ActionManager.gR)}oMb(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);
v.AFrameworkApplication.va.processAction(fb.a.Lwh,2)}pMb(){this.MIo();v.AFrameworkApplication.va.processAction(fb.a.Mwh,2)}EIk(){this.yxd.authenticationCheck()}MIo(){this.ai&&(this.ai.hide(),this.ai.dispose(),this.ai=null);this.zKa&&this.SK&&(v.AFrameworkApplication.Rk||this.SK.removeEntry(this.zKa),this.zKa.dispose(),this.zKa=null)}showDialog(b){Xo.a.jC(this.ai);this.ai=new Tf.StandardDialog;this.bkk||(this.ai.Kt=!1,this.ai.Cd=0);this.ai.ze(1,CommonUIStrings.l_SignIn);this.ai.FV(CommonUIStrings.l_DefaultDialogTitle,
b,Object(z.a)(this,this.fca,"dialogHandler"))}fca(b){1===b?(ye.a.N$d(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),v.AFrameworkApplication.va.processAction(fb.a.yKf,2)):(this.Ovo(),v.AFrameworkApplication.va.processAction(fb.a.cCh,2))}Ovo(){this.SK&&this.Rzh&&(this.zKa=this.Rzh.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.zKa.closeable=!0,this.zKa.addButton(CommonUIStrings.l_SignIn,Mh.Hfb,""),this.zKa.Kga=
Object(z.a)(this,this.NPk,"businessBarEntryCloseHandler"),this.SK.sA(this.zKa,!1))}NPk(){this.Vol();v.AFrameworkApplication.va.processAction(fb.a.bCh,2)}Vol(){this.Do&&(v.AFrameworkApplication.lc.ff(this.Do),this.Do=null)}dispose(){this.Do=this.ai=this.zKa=null}static Hfb(){ye.a.N$d();v.AFrameworkApplication.va.processAction(fb.a.yKf,2)}}Object(m.a)(Mh,"SignOutResponseUI",null,[9]);class Ca{get name(){return"Common.App.UI"}wc(b){b.register(ng,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").ha()}init(){}dispose(){Xo.a.jC(Ca.aua);
Ca.aua=null}static main(){L.a.instance.Gc(new Ca)}static Szm(b,h,r){Ca.Avo()&&(Ca.aua=new Mh(ye.a.instance,b,h,r))}static Avo(){return v.AFrameworkApplication.L5d&&!v.AFrameworkApplication.oia}}Ca.aua=null;Object(m.a)(Ca,"CommonAppUIPackage",null,[1,2]);class zb{get name(){return"Common.App.DialogWithLinkToResource"}wc(){}init(){}dispose(){}static main(){L.a.instance.Gc(new zb)}}Object(m.a)(zb,"CommonAppDialogWithLinkToResourcePackage",null,[1,2]);var pc=c(67);class Dc{constructor(b){this.yy=b;this.my=
Array.indexOf(this.yy,this.xha)}dispose(){this.yy=null}get l4(){return this.yy[this.my]}gz(b){this.q9c(b,!1);return!0}T8b(b){this.q9c(b,!0)}q9c(b,h){b&&(this.l4!==b||h)&&(b.tabIndex=0,pc.FocusManager.iK(b));Array.contains(this.yy,b)&&(this.my=Array.indexOf(this.yy,b))}get e4i(){let b=this.my;do if(b)if(0<b&&b<this.yy.length)b--;else break;else b=this.yy.length-1;while(!$e.DOMFocusListing.B1a(this.yy[b])&&b!==this.my);return this.yy[b]}get wRi(){let b=this.my;do if(b===this.yy.length-1)b=0;else if(0<=
b&&b<this.yy.length-1)b++;else break;while(!$e.DOMFocusListing.B1a(this.yy[b])&&b!==this.my);return this.yy[b]}get xha(){let b=0;for(;!$e.DOMFocusListing.B1a(this.yy[b])&&b<this.yy.length;)b++;return $e.DOMFocusListing.B1a(this.yy[b])?this.yy[b]:null}get Mec(){let b=this.yy.length-1;for(;!$e.DOMFocusListing.B1a(this.yy[b])&&0<b;)b--;return $e.DOMFocusListing.B1a(this.yy[b])?this.yy[b]:null}}Object(m.a)(Dc,"DialogFocusListing",null,[157]);var dc=c(56);class he extends Tf.StandardDialog{constructor(b,
h,r,B=null){super();this.Nfa=this.Qw=this.cbb=null;this.yy=[];this.Ntd=h;this.tk=b;this.T5j=r;this.Mwd=B;this.rm=new eh.a("LoadResource","LoadPrintablePdf")}HEa(){this.Cd=5;this.width=40;const b=document.createElement("span");b.id=this.qj("DirectPrintHeaderContent");const h=document.createElement("span");h.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(h,"DirectPrintHeader");this.Nfa=document.createElement("iframe");this.Nfa.name="pdfObjectFrame";this.Nfa.title=
CommonUIStrings.l_DirectPrintDialogIFrame;this.Nfa.onload=Object(z.a)(this,this.RHn,"printablePdfLoaded");if(this.Mwd&&0<this.Mwd.count){var r=ia.a.utf(this.Ntd,this.Mwd);const B=ia.a.k8f(this.Ntd,this.Mwd);this.Qw=document.createElement("form");this.Qw.id="printPreviewPostForm";this.Qw.method="POST";this.Qw.target=this.Nfa.name;this.Qw.action=B;for(let P of r)r=document.createElement("input"),r.type="hidden",r.name=P.key,r.value=P.value,this.Qw.appendChild(r)}else this.Nfa.setAttribute("src",this.Ntd);
Sys.UI.DomElement.addCssClass(this.Nfa,mj.a.c9g);this.T5j?(Sys.UI.DomElement.addCssClass(this.Nfa,"DirectPrintPdfObjectHidden"),h.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,Se.a.lr(this.Nfa,Se.a.uA,Se.a.xp)):(Sys.UI.DomElement.addCssClass(this.Nfa,"DirectPrintPdfObject"),this.yy.push(this.Nfa));b.appendChild(h);b.appendChild(document.createElement("br"));b.appendChild(this.Nfa);this.Qw&&b.appendChild(this.Qw);b.appendChild(document.createElement("br"));b.appendChild(this.K4k(this.Qw?
"#":this.Ntd));this.rm.start();this.Rmb(CommonUIStrings.l_AppTitle,null,null,null,null,b);this.L5(this.qj("DirectPrintHeaderContent"));this.Qw&&this.Qw.submit();this.Fal();t.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}K4k(b){const h=document.createElement("span");var r=document.createElement("span");r.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;h.appendChild(r);v.AFrameworkApplication.K&&(2===v.AFrameworkApplication.ua.Kb.yk&&v.AFrameworkApplication.K.$("PPTDisableDirectPrintDialogDownloadPDFLink")||
1===v.AFrameworkApplication.ua.Kb.yk&&v.AFrameworkApplication.K.$("XLODisableDirectPrintDialogOpenPDFLink"))?(b=document.createElement("span"),2===v.AFrameworkApplication.ua.Kb.yk?b.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===v.AFrameworkApplication.ua.Kb.yk&&(b.innerText=CommonUIStrings.l_InternalError_Directive,t.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.cbb=b,h.appendChild(document.createElement("br")),h.appendChild(b)):(r=
document.createElement("a"),r.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,r.href=b,r.target="_blank",r.id="PrintPDFLink",r.className="AllowBrowserClick",this.cbb=r,h.appendChild(document.createElement("br")),h.appendChild(r),this.Qw&&He.a.addHandler(r,"click",Object(z.a)(this,this.Vun,"onSubmit")),this.tk.ob(pd.a.click,this.cbb,Object(z.a)(this,this.oVh,"downloadPDFLinkClicked"),null));this.yy.push(this.cbb);return h}Vun(b){this.Qw&&(this.Qw.target="_blank",this.Qw.submit());b.preventDefault()}Fal(){if(0<
this.yy.length){const b=new Dc(this.yy),h=pc.FocusManager.instance().at();h&&(this.cbb.focus(),h.hk=b,h.BP=!0)}}oVh(){t.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1}B_c(){t.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}RHn(){t.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.rm&&this.rm.stop()}dispose(){this.cbb&&(this.tk.sc(pd.a.click,this.cbb,Object(z.a)(this,this.oVh,"downloadPDFLinkClicked")),
this.cbb=null);dc.a.qx(this.Nfa);this.Nfa=null;super.dispose()}}Object(m.a)(he,"DirectPrintDialog",Tf.StandardDialog,[576]);class Rc{constructor(b){this.tk=b}XVl(b,h,r=null){return new he(this.tk,b,h,r)}}Object(m.a)(Rc,"DirectPrintDialogFactory",null,[562]);class qe{constructor(b,h){this._url=b;this.Xdk=h}aUh(){this.Xdk?Qd.a.downloadFile(this._url):Qd.a.wm(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(m.a)(qe,"OpenUrlInTabDialogDownloadBehavior",null,
[585,9]);class bf extends Tf.StandardDialog{constructor(b,h=!0,r=!1,B=null,P=null,ca=!1,ra=null){super();this.sXb=this.rXb=this.Qw=this.n3=null;var Qa=this.Kmg?this.Kmg:CommonUIStrings.l_DefaultDialogTitle;bf.Qac=ca;this.wYj=ra;this.Rze=B||new qe(b,!0);const tb=[],Mb=[];bf.PL&&(this.ACd&&this.ACd.forEach(jc=>{Array.add(tb,jc)}),this.ash&&this.ash.forEach(jc=>{Array.add(Mb,jc)}));h?r?this.IZd?(this.Cd=12,this.ze(1,this.buttonText),this.ze(2,CommonUIStrings.l_DownloadAsPdfDialog_CopyALinkButton),this.ze(3,
CommonUIStrings.l_DialogClose)):this.HZd?(this.Cd=12,this.ze(1,this.buttonText),this.ze(2,CommonUIStrings.l_DownloadACopyDialog_CopyALinkButton),this.ze(3,CommonUIStrings.l_DialogClose)):this.TZd?(this.Cd=12,this.ze(1,this.buttonText),this.ze(2,CommonUIStrings.l_DownloadACopyDialog_EmailALinkButton),this.ze(3,CommonUIStrings.l_DialogClose)):(this.Cd=4,this.ze(1,this.buttonText),this.ze(2,CommonUIStrings.l_DialogClose)):(this.Cd=6,this.ze(0,CommonUIStrings.l_DialogClose)):this.Cd=5;ca=document.createElement("span");
this.YKc&&(ca.className=this.YKc);B=document.createElement("a");B.innerText=this.bfc;B.href=b;B.target="_blank";B.id=this.d_c;B.className=Dd.AFrame.w1e;if(ra=!Z.a.O4&&!!P&&0<P.count){const jc=ia.a.utf(b,P);P=ia.a.k8f(b,P);B.href="#";B.target="_self";this.Qw=document.createElement("form");this.Qw.id="printPreviewPostForm1";this.Qw.method="post";this.Qw.target="_blank";this.Qw.action=P;for(var Zb of jc)P=document.createElement("input"),P.type="hidden",P.name=Zb.key,P.value=Zb.value,this.Qw.appendChild(P)}else this.Qw=
null;this.Qw||bf.Qac?bf.Qac||Array.add(Mb,{["type"]:"AppLinkProps",["id"]:this.d_c,["text"]:this.bfc,["onExecute"]:()=>{this.D7i()}}):Array.add(Mb,{["type"]:"AppLinkProps",["id"]:this.d_c,["text"]:this.bfc,["handler"]:{["href"]:ra?"#":b,["target"]:ra?"_self":"_blank"}});this.N5a&&Array.add(tb,this.N5a);r?(b=document.createElement("span"),b.innerText=this.N5a.replace("{0}",""),ca.appendChild(b)):this.bPi?(b=document.createElement("span"),b.id=this.qj("message"),Zb=document.createElement("span"),P=
document.createElement("span"),ra=this.N5a.split("{0}"),Zb.innerText=ra[0],P.innerText=ra[1],b.appendChild(Zb),b.appendChild(B),b.appendChild(P),ca.appendChild(b)):(b=document.createElement("span"),b.innerText=this.N5a,ca.appendChild(b),ca.appendChild(document.createElement("br")),ca.appendChild(document.createElement("br")),ca.appendChild(B),bf.Qac||Array.add(tb,"{0}"));this.Qw&&ca.appendChild(this.Qw);bf.PL&&(this.nmb&&(this.KZc?this.Koh(this.nmb,this.KZc):(Array.add(tb,"{0}"),Array.add(Mb,{["type"]:"AppLinkProps",
["id"]:"LearnMoreLinkId",["text"]:this.nmb,["onExecute"]:()=>{}}))),this.IFc(tb,Mb));this.Rmb(Qa,null,this.pAf,null,Object(z.a)(this,this.fca,"dialogHandler"),bf.PL?null:ca);this.L5(this.qj("message"));!bf.PL&&this.KZc&&this.nmb&&(Qa=document.createElement("div"),Qa.className="WACDialogLearnMoreLinkContainer",this.n3=document.createElement("a"),this.n3.innerText=this.nmb,this.n3.href=this.KZc,this.n3.target="_blank",this.n3.id=this.qj("LearnMoreLinkId"),this.n3.className=Dd.AFrame.w1e,Qa.appendChild(this.n3),
h?this.Kc.insertBefore(Qa,this.Kc.lastChild):this.Kc.appendChild(Qa),this.L5(String.format("{0} {1}",this.qj("message"),this.qj("LearnMoreLinkId"))));this.wuc=B;r?this.I1(this.mH):this.I1(this.wuc);this.l3d();v.AFrameworkApplication.ua.X1.ob(pd.a.click,this.wuc,Object(z.a)(this,this.nVh,"downloadLinkClicked"),null);this.n3&&v.AFrameworkApplication.ua.X1.ob(pd.a.click,this.n3,Object(z.a)(this,this.VGi,"learnMoreLinkClicked"),null);this.nW=!1}get pAf(){return null}get Kmg(){return null}get N5a(){return null}get x6e(){return this.wYj}get KZc(){return null}get nmb(){return null}get bPi(){return!1}get buttonText(){return CommonUIStrings.l_Open}get YKc(){return null}get ACd(){return null}get ash(){return null}get IZd(){return!1}get HZd(){return!1}get TZd(){return!1}BKh(){this.V8({SourceControlId:"CopyLink"},
{ControlId:"CopyLink"})}Kul(){this.V8({SourceControlId:"Share"},{ControlId:"Share"})}V8(b,h){const r=v.AFrameworkApplication.va;r.MC=8;r.Qb(fb.a.V8,2,b,h)}cna(){this.Qw&&(this.rXb||(this.rXb=Object(z.a)(this,this.rkn,"onActionButtonClicked"),this.Qq.ob(pd.a.click,this.mH,this.rXb)),this.sXb||(this.sXb=Object(z.a)(this,this.skn,"onActionButtonKeyUp"),this.ge.ob(pd.a.yh,this.mH,this.sXb)));super.cna()}rkn(b){this.QYh(b);return!0}skn(b){return this.jZc(b,Object(z.a)(this,this.QYh,"executeDismissActionButtonFromArgs"))}QYh(b){this.Qw&&
this.Qw.submit();this.FEb(b.yf)}B_c(){}nVh(){this.dNf();this.Qw?this.Qw.submit():this.Rze.aUh();return!0}VGi(){return!1}dispose(){this.Rze.dispose();this.wuc&&(v.AFrameworkApplication.ua.X1.sc(pd.a.click,this.wuc,Object(z.a)(this,this.nVh,"downloadLinkClicked")),this.wuc=null);this.n3&&(v.AFrameworkApplication.ua.X1.sc(pd.a.click,this.n3,Object(z.a)(this,this.VGi,"learnMoreLinkClicked")),this.n3=null);this.Qq&&this.rXb&&(this.Qq.sc(pd.a.click,this.mH,this.rXb),this.rXb=null);this.ge&&this.sXb&&(this.ge.sc(pd.a.yh,
this.mH,this.sXb),this.sXb=null);super.dispose()}D7i(){this.Qw&&(document.body.appendChild(this.Qw),this.Qw.submit(),document.body.removeChild(this.Qw))}fca(b){1===b?(this.B_c(),this.Qw?bf.PL&&this.D7i():this.Rze.aUh()):2===b&&(this.HZd||this.IZd?this.BKh():this.TZd&&this.Kul());this.dispose()}static get PL(){return v.AFrameworkApplication.ua.Kb.vF&&v.AFrameworkApplication.ua.Kb.YBi}static get Qac(){return bf.PYg}static set Qac(b){bf.PYg=b}}bf.PYg=!1;Object(m.a)(bf,"ADialogWithLinkToResource",Tf.StandardDialog,
[]);class Cf extends bf{constructor(b,h,r=null,B=!0,P=!1,ca=null){super(b,!0,!(Cf.Yrb&&B),new qe(b,h),r,P,ca);Cf.Yrb=Cf.Yrb&&B;if(Cf.Yrb){h=document.createElement("iframe");B=null;P=this.ASh;h.name="pdfObjectFrame";h.id="pdfObjectIFrame";if(r&&0<r.count){ca=ia.a.utf(b,r);b=ia.a.k8f(b,r);B=document.createElement("form");B.id="printPreviewPostForm";B.method="POST";B.target=h.name;B.action=b;for(let ra of ca)b=document.createElement("input"),b.type="hidden",b.name=ra.key,b.value=ra.value,B.appendChild(b)}else h.src=
b;P.appendChild(h);B&&(P.appendChild(B),B.submit());Sys.UI.DomElement.addCssClass(h,"DirectPrintPdfObjectHidden");Se.a.lr(h,Se.a.uA,Se.a.xp)}}get pAf(){return"Print_32x32x32"}get Kmg(){return Cf.Yrb?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get N5a(){return Cf.Yrb?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get ACd(){const b=[];Array.add(b,CommonUIStrings.l_PrintDialogCanCloseDocument);if(bf.Qac){let h=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==v.AFrameworkApplication.ua.Kb.APh&&
(h=v.AFrameworkApplication.ua.Kb.APh);Array.add(b,h)}return Cf.Yrb?b:null}get bfc(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get d_c(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get YKc(){return v.AFrameworkApplication.k1a?"UIFontDialogTextLarge":null}l3d(){t.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}dNf(){v.AFrameworkApplication.Vl.H3a(9540);t.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}B_c(){t.ULS.sendTraceTag(19462215,
324,50,"Legacy print dialog button clicked")}static get Yrb(){return!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.vF&&v.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")&&!(Z.a.O4||Z.a.gt||Z.a.Cj||Z.a.kda)&&!v.AFrameworkApplication.NYc&&v.AFrameworkApplication.K.$("ShouldHostDefaultToNativeBrowserPrintExperience")}static set Yrb(b){}}Object(m.a)(Cf,"PrintDialogWithLinkToPdf",bf,[]);class bh{constructor(b){this.isEnabled=Boolean.parse(b.DirectPrintIsEnabled||"false");
this.OSm=Boolean.parse(b.DirectPrintProbeIsEnabled||"false");this.oPm=Boolean.parse(b.DirectPrintEnabledForInternetExplorer||"false");this.CRb=(b.DirectPrintSupportedMimeTypes||"").split(bh.Cff);this.Tqb=(b.DirectPrintSupportedPlugins||"").split(bh.Cff);this.Uxm=(b.DirectPrintImmersivePreviewPlugins||"").split(bh.Cff);this.Gxi=Boolean.parse(b.DirectPrintEnabledForEdge||"false");this.sJm=Boolean.parse(b.ChromePrintLayoutFixIsEnabled||"false");this.EXk=parseInt(b.ChromeVersionFromWhichPrintLayoutIsEnabled||
"76");this.WPf=14;this.oPi=14394;if(b=b.DirectPrintMinimalSupportedEdgeVersion){const h=b.split(".");2===h.length?(this.WPf=parseInt(h[0]),this.oPi=parseInt(h[1])):t.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",b)}else t.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}bh.Cff=",";Object(m.a)(bh,"DirectPrintBrsSettings",null,[]);class Lg{constructor(b,h){this.nkg=
b;this.Tqb=h}}Object(m.a)(Lg,"DirectPrintProbeResults",null,[]);class Th{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb){this.nAd=null;this.Y0j=b;this.Izc=h;this.xLe=r;this.y8j=B;this.E9j=P;this.zBc=new pf.a(Object(z.a)(this,this.qam,"getProbeResults"));this.$tc=ca;this.t5g=tb;this.yT=ra;this.Kxc=Qa;this.Z9j=Mb}get fR(){return this.Y0j}start(){}nIn(){this.fR.OSm&&this.h7m()}ZMn(){const b=Array(this.fR.CRb.length);if(void 0!==this.Izc&&null!==this.Izc)for(let h=0;h<this.fR.CRb.length;h++)b[h]=this.fR.CRb[h]in
this.Izc&&this.y8j(this.Izc[this.fR.CRb[h]]);return b}$Mn(){const b=Array(this.fR.Tqb.length),h=!(void 0===this.xLe||null===this.xLe);for(let r=0;r<this.fR.Tqb.length;r++){const B=this.fR.Tqb[r];b[r]=h&&B in this.xLe?!0:this.E9j(B)}return b}hgm(){const b=this.ZMn(),h=Array(b.length);for(let r=0;r<b.length;r++)h[r]=b[r]?this.OAl(this.Izc[this.fR.CRb[r]]):null;return h}OAl(b){if(void 0===b||null===b)return null;b=b.enabledPlugin;return void 0===b||null===b?null:b.name}h7m(){t.ULS.sendTraceTag(4535643,
328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.zBc.value.nkg,this.zBc.value.Tqb)}qam(){var b=this.hgm();const h=this.$Mn(),r={},B={};for(let P=0;P<this.fR.CRb.length;P++)r[this.fR.CRb[P]]=b[P];for(b=0;b<this.fR.Tqb.length;b++)B[this.fR.Tqb[b]]=h[b];return new Lg(r,B)}svo(){return this.Z9j||!this.fR.isEnabled||v.AFrameworkApplication.NYc?!1:this.IFo()}yvo(){if(null!=this.nAd)return this.nAd;const b=Th.Fxi(this.fR);return this.nAd=this.fR.Gxi&&b||this.rJm()}rJm(){return Z.a.Fr&&this.fR.sJm&&Z.a.DXk>=
this.fR.EXk?!0:!1}IFo(){if(!this.Kxc(this.fR))return!1;var b=kb.a.oHb(this.zBc.value.nkg);for(const h of b)if(void 0!==h&&null!==h)return!0;b=kb.a.oHb(this.zBc.value.Tqb);for(const h of b)if(h)return!0;return!1}qsm(){const b=kb.a.oHb(this.zBc.value.nkg);for(const h of b)if(Rl.a.contains(this.fR.Uxm,h))return!0;return!1}Rxo(b,h=null){v.AFrameworkApplication.ua&&v.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")?this.t5g(b,h):this.svo()?this.aql(b,this.qsm()&&!0,h):this.t5g(b,
h)}aql(b,h,r=null){const B=this.yT.Zf("UserAction","OpenDirectPrintDialog");this.$tc.XVl(b,h,r).HEa();B.stop()}static AVm(b){try{return new ActiveXObject(b),!0}catch(h){t.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",b)}return!1}static mMm(b){return void 0===b||null===b?!1:!(void 0===b.enabledPlugin||null===b.enabledPlugin)}static create(b){const h=new bh(v.AFrameworkApplication.K.appSettings);let r=null;try{r=window.navigator.mimeTypes}catch(Mb){t.ULS.sendTraceTag(573923532,
328,15,"Failed to get Window.Navigator.mimeTypes")}let B=null;try{B=window.navigator.plugins}catch(Mb){t.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const P=Th.mMm,ca=Th.AVm;b=b.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const ra=v.AFrameworkApplication.ua.Lq,Qa=Th.BVm,tb=!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.vF&&!v.AFrameworkApplication.K.$("PrintDialogFallbackLinkEnabled");return new Th(h,r,B,P,ca,b,ra,Qa,(Mb,Zb)=>new Cf(Mb,!1,
Zb,!0,tb),v.AFrameworkApplication.oia)}static BVm(b){return Z.a.Fr||Z.a.gt&&b.oPm||b.Gxi&&Th.Fxi(b)?!0:!1}static Fxi(b){var h=Z.a.u7b;if(h){var r=h.split(".");if(2===r.length)return h=parseInt(r[0]),r=parseInt(r[1]),h>b.WPf||h===b.WPf&&r>=b.oPi}return!1}}Object(m.a)(Th,"DirectPrintManager",null,[531]);class ak{constructor(){this.pub=this.W=null}get name(){return"Common.App.DirectPrint"}wc(b){this.W=b;b.register(Rc,"Common.App.DirectPrint.DirectPrintDialogFactory").ha().Ud(()=>new Rc(v.AFrameworkApplication.ua.X1));
b.register(531,"Common.App.DirectPrint.IDirectPrintManager").ha().Ud(()=>Th.create(this.W))}init(){this.pub=this.W.resolve("Common.App.DirectPrint.IDirectPrintManager");this.pub.start()}dispose(){}}Object(m.a)(ak,"PackageManager",null,[1,2]);class Ih{constructor(b,h=3E4){this.bng=9E5;this.dng=1E4;this.qMi=this.Cfc=null;this.mOf=0;this.Vgb=Date.now;this.nim=b;this.T8a=h;this.nQd()}yji(b=!0){const h=this.Vgb();if(h<this.mOf+this.bng)return h>this.mOf+this.dng&&this.nQd(),this.qMi;b&&this.nQd();return null}getToken(b=
!0){return(b=this.yji(b))?Promise.resolve(b):this.nQd()}nQd(){return this.Cfc=this.Cfc||new Promise(b=>{this.nim().then(h=>{this.Cfc=null;""!==h&&h&&(this.qMi=h,this.mOf=this.Vgb(),b(h));b(null)}).catch(()=>{this.Cfc=null;b(null)});window.setTimeout(()=>{this.Cfc=null;b(null)},this.T8a)})}}Object(m.a)(Ih,"OAuthCacheManager",null,[]);var xj=c(114),Uh=c(292);class ul{constructor(){this.P9=null;this.qUg={};this.Qnc=new Da.a(Pa.a.ih())}getToken(b,h){if(this.Qnc.nb(h))return this.Qnc.J(h).getToken();const r=
new Ih(()=>this.zji(b,h));this.Qnc.Z(h,r);return r.getToken()}mim(b,h){if(this.Qnc.nb(h))return this.Qnc.J(h).yji();const r=new Ih(()=>this.zji(b,h));this.Qnc.Z(h,r);return null}zji(b,h){if(!this.P9)try{this.P9=Ma.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(r){t.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+r)}return this.P9?new Promise(r=>{const B=Date.now();this.P9.OV(b,h).then(P=>{const ca=P.Token;!P.IsSuccess||this.AWm(ca)?(this.Ekc("GetTokenInternalImplicitJS",
!1,Date.now()-B,b,P.ErrorCode,P.ErrorMessage,h),r(null)):(this.Ekc("GetTokenInternalImplicitJS",!0,Date.now()-B,b,P.ErrorCode,P.ErrorMessage,h),r(ca))}).catch(P=>{P=P?H.c(P):"";this.Ekc("GetTokenInternalImplicitJS",!1,Date.now()-B,b,"Caught Exception",P,h);r(null)})}):new Promise(r=>{this.Ekc("GetTokenInternalImplicitJS",!1,0,b,"Null OAuthManager","OAuthManager not set");r(null)})}Ekc(b,h,r,B,P="",ca="",ra=""){var Qa="Search"===B;const tb=[];b=xj.a.c9(Qa?"Event":"EventName",b,2);B=xj.a.c9("AppName",
B,2);Array.add(tb,b);Array.add(tb,B);Qa&&(B=xj.a.c9("LatencyType","FetchToken",2),Array.add(tb,B));P&&""!==P&&(P=xj.a.c9("ErrorCode",P,2),Array.add(tb,P));ca&&""!==ca&&(ca=xj.a.c9("ErrorMessage",ca,2),Array.add(tb,ca));ra&&""!==ra&&(ca=!(ra in this.qUg),this.qUg[ra]=ca,ca=xj.a.c9("WarmUpCall",ca.toString(),1),Array.add(tb,ca),ra=xj.a.c9("Service",this.hem(ra),2),Array.add(tb,ra));Qa=Qa?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";h=Object.assign(new Uh.a,{name:Qa,
samplingPolicy:2,dataFields:tb,succeeded:h,durationMs:r});ea.a.sendActivityEvent(h)}hem(b){return b===v.AFrameworkApplication.YNf?"Loki":b===v.AFrameworkApplication.fkg?"Substrate":v.AFrameworkApplication.K&&b===v.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}AWm(b){return!b||!b.length}}Object(m.a)(ul,"SearchOAuthManager",null,[486]);class ti{constructor(){this.W=null}get name(){return"Common.App.SearchOAuthManager"}wc(b){this.W=b;this.W.register(486,"Common.App.SearchCommon.ISearchOAuthManager").ha().Ud(()=>
new ul)}init(){}dispose(){}static main(){L.a.instance.Gc(new ti)}}Object(m.a)(ti,"SearchOAuthPackage",null,[1,2]);var Vh=c(225),Ad=c(5),Id=c(18),xe=c(17),ke=c(8);class Gj{constructor(b,h,r){this.oMe=this.Iyb=this.lMe=this.Hyb=this.cJe=null;this.Lom=B=>{try{this.Kom(B)}catch(P){B=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",P.message,P.stack),t.ULS.sendTraceTag(5285580,334,10,B)}};this.Xo=b;this.L1j=h;this.hb=r;this.init()}init(){this.L1j.ob(this.Lom);
this.Hyb=new Ng.a;this.lMe=new Ng.a;this.Iyb=new Ng.a;this.oMe=new Vh.a}D5(b){this.Hyb.add(b.key,b)}kjc(b){this.Iyb.add(b.key,b)}Kom(b){let h;const r=this.hb.ib.lb;({gdf:h}=Gj.OPo(r)).returnValue&&(b=Gj.yTl(b,this.cJe,h),this.GIn(b,h,r),this.cJe=h)}GIn(b,h,r){b=this.ZMl(b,h,r);let B;({notification:B}=Gj.EPo(b)).returnValue&&this.Xo.sendNotification(B,!1)}ZMl(b,h,r){const B=new Ng.a;B.Z(1,new Vh.a);B.Z(0,new Vh.a);b.forEach(P=>{3===P?(Gj.rgg(h.node)||this.Y5n(h,r),this.c9l(B,h)):P||this.XTl(B,h);return!0});
return B}Y5n(b,h){this.Hyb.forEach((r,B)=>{B.reset(b,h);return!0})}XTl(b,h){let r=new Ng.a;Gj.rgg(h.node)||(r=this.VTl(h.cpBegin));this.WTl(b,this.lMe,r,Gj.bjj(this.cJe,h));this.lMe=r}VTl(b){const h=new Ng.a;this.Hyb.forEach((r,B)=>{r=null;({hG:r}=B.GJa(b)).returnValue&&h.Z(B.key,r);return!0});return h}WTl(b,h,r,B){const P=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;h.forEach((ca,ra)=>{const Qa=this.Hyb.J(ca).$w||ra.title;let tb;({value:tb}=r.Fc(ca)).returnValue?B&&tb.contentObject!==ra.contentObject&&
(Qa&&b.J(1).add(Qa),ca=this.Hyb.J(ca).$w,ca=String.format(P,tb.title,ca),tb.description&&(ca+=", "+tb.description),b.J(0).add(ca)):Qa&&b.J(1).add(Qa);return!0});r.forEach((ca,ra)=>{h.nb(ca)||(ca=this.Hyb.J(ca).$w,ca=String.format(P,ra.title,ca),ra.description&&(ca+=", "+ra.description),b.J(0).add(ca));return!0})}c9l(b,h){h=this.zfm(h.node);h=this.q0k(h);this.Afm(b,this.oMe,h);this.oMe=h}zfm(b){const h=new Ad.GraphIterator;h.set(b);if(!h.zb(1))return null;const r=new Vh.a;for(;1!==h.Xe;)this.Iyb.forEach((B,
P)=>{let ca;({Bna:ca}=P.roc(h)).returnValue&&r.add(ca);return!0}),h.uc();r.reverse();return r}q0k(b){b=b.toArray();let h=0;for(;h<b.length-1;){var r=b[h];if(r.$G===b[h+1].$G&&(this.Iyb.J(r.$G),({t0k:r}={returnValue:!1,t0k:null}).returnValue)){b.splice(h,2,r);continue}h++}return new Vh.a(b)}Afm(b,h,r){var B;for(B=0;B<Math.min(r.length,h.length)&&r.J(B).contentId.equals(h.J(B).contentId);B++){var P=this.Iyb.J(r.J(B).$G).WFb(r.J(B),h.J(B));P&&(r.J(B).description&&(P+=", "+r.J(B).description),b.J(0).add(P))}for(P=
B;P<r.length;P++){let ca=this.Iyb.J(r.J(P).$G).WFb(r.J(P),null);ca&&(r.J(P).description&&(ca+=", "+r.J(P).description),b.J(0).add(ca))}for(r=B;r<h.length;r++)(B=this.Iyb.J(h.J(r).$G).$w)&&b.J(1).add(B)}static yTl(b,h,r){const B=new Vh.a;(b=b||Gj.sdo(h,r))?(B.add(3),B.add(0)):Gj.bjj(h,r)&&B.add(0);return B}static sdo(b,h){return!b||!b.node.id.equals(h.node.id)}static bjj(b,h){return!b||!b.equals(h)}static OPo(b){let h=null;if(!b||!(xe.SelectionEditor.Pl(b)||(b=xe.SelectionEditor.Jj(b,!0,!1),xe.SelectionEditor.Pl(b)||
b.Pa&&Gj.rgg(b.Pa.node))))return{returnValue:!1,gdf:h};h=b.Pa;return{returnValue:!!h,gdf:h}}static EPo(b){const h=new Vh.a;b.J(1).forEach(r=>{r=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,r);h.add(r);return!0});b.J(0).forEach(r=>{r=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,r);h.add(r);return!0});b=h.toArray().join(" ");return{returnValue:0<h.length,notification:b}}static rgg(b){return Id.ImageReader.Mt(b)||ke.ParagraphReader.uva(b)}}Object(m.a)(Gj,
"AccessibilityContextManager",null,[487]);class Ni{constructor(b,h){this.H2g=!1;this.KCc=null;this.Jwd=this.dAd=!1;this.NTg=null;this.GCd=(r,B)=>{(B.FN||B.mra)&&this.Kin(B.FN,B.mra)};this.Ib=b;this.QN=h}get gtm(){return!!this.KCc}ob(b){this.H2g||(this.QN.Rqh(this.GCd),this.H2g=!0);this.NTg=b}Kin(b,h){this.gtm&&this.Ib.ff(this.KCc);this.dAd=this.dAd||b;this.Jwd=this.Jwd||h;this.KCc=new Me.a(5,1,Ni.Lyl,()=>{this.NTg(this.dAd,this.Jwd);this.reset()},126);this.Ib.Wb(this.KCc)}reset(){this.KCc=null;this.Jwd=
this.dAd=!1}}Ni.Lyl=100;Object(m.a)(Ni,"EditingViewOnAfterValidateEventsConsolidator",null,[485]);var Bh=c(48);class Nk{constructor(){this.W=null}get name(){return"Box4.Accessibility"}init(){Eb.App.Svh&&this.W.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}wc(b){this.W=b;b.ia("Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator",()=>new Ni(v.AFrameworkApplication.lc,b.resolve("Box4.ContentEditableViewEventSource"))).as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").ha();
b.ia("Box4.Accessibility.AccessibilityContextManager",()=>new Gj(b.resolve("Common.Utils.IAriaNotifier"),b.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),Bh.a.instance)).as("Box4.Accessibility.IAccessibilityContextManager").ha()}static main(){L.a.instance.Gc(new Nk)}}Object(m.a)(Nk,"Box4AccessibilityPackage",null,[1,2]);var Nh=c(192),Vd=c(1077),$p=c(1667),kf=c(903),kh=c(173),aq=c(1554),cg=c(43),og=c(23),Tg=c(101),Ue=c(26),Nb=c(3);class Ll extends aq.a{get xxa(){return null!=
this.hDg?this.hDg:this.hDg=Ma.a.instance.Oa("Box4.IInternalLinkManager")}get g3i(){return null!=this.kGg?this.kGg:this.kGg=Ma.a.instance.Oa("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy")}get bD(){return!0}get commandId(){return Nb.a.NIk}Xna(b){kh.a.mark(7012);const h=new cg.GraphTransaction(15);h.Db(b);var r=this.VG,B=this.d1,P=ke.ParagraphReader.text(b),ca=P.substring(r,B);const ra=({n1c:Qa}=F.a.Mjg(ca)).returnValue;ca!==ra&&(r+=Qa,B=r+ra.length);ca=Ue.a.createTextRange(b,r,B);var Qa=P.substring(r,
B);Ll.hPm(P,r,B)&&(this.Md.Ge(Ue.a.createTextRange(b,r-1,B+1),Qa,!0,!1),--r,--B,ca=Ue.a.createTextRange(b,r,B),r=og.SelectionFactory.ne(b,B),Bh.a.instance.Ac(r));r=Tg.a.GFa(Qa);Ll.hp.fF(ca,r,!1);P=Qa="";B=!1;this.xxa&&({z7f:Qa,wFb:P}=this.xxa.Vng(r)).returnValue&&(r=Qa,B=!0,Qa=Tg.a.Ez(ca,!1),Ll.hp.iS(Qa[0].paragraph,Qa[0].hyperlink),""!==P&&(this.Md.Ge(ca,P,!0,!1),ca=Ue.a.createTextRange(b,this.VG,this.VG+P.length),b=og.SelectionFactory.ne(b,this.VG+this.VG+P.length),Bh.a.instance.Ac(b)),Ll.hp.fF(ca,
r,!1));h.dispose();!B&&this.g3i&&this.g3i.uFn(ca,r);kh.a.mark(7013)}set bD(b){super.bD=b}static get hp(){return null!=Ll.iBg?Ll.iBg:Ll.iBg=Ma.a.instance.resolve("Box4.IHyperlinkEditor")}static hPm(b,h,r){r=r!==b.length&&('"'===b.charAt(r)||"\u201d"===b.charAt(r));return!!h&&('"'===b.charAt(h-1)||"\u201c"===b.charAt(h-1))&&r}}Object(m.a)(Ll,"HyperlinkAction",aq.a,[]);class Gl{constructor(b){this.Md=b}jbl(b,h,r){return new Ll(null,b,h,r,this.Md)}}Object(m.a)(Gl,"HyperlinkActionFactory",null,[482]);
var Wh=c(237);class bk{constructor(){this.W=null}get name(){return"Box4.AutoCorrect"}wc(b){this.W=b;b.ia("Box4.AutoCorrect.AutoCorrectRules",()=>new $p.a(b.resolve("Box4.IHyperlinkActionFactory"),b.resolve("Box4.ICharacterPropertiesEditor"),Wh.a.instance,v.AFrameworkApplication.va,v.AFrameworkApplication.K,b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)).as("Box4.IAutoCorrectRules").ha();b.ia("Box4.AutoCorrect.AutoCorrectOptionsInfo",()=>
new Vd.a(b.resolve("Box4.IRoamingServiceRequestManager"),v.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled"))).as("Box4.IAutoCorrectOptionsInfo").ha();b.ia("Box4.AutoCorrect.AutoCorrectScheduler",()=>new kf.a(b.resolve("Box4.IAutoCorrectRules"),Bh.a.instance,Nh.a.instance,v.AFrameworkApplication.K,b.resolve("Box4.IAutoCorrectOptionsInfo"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>"))).as("Box4.IAutoCorrectScheduler").ha();
b.ia("Box4.AutoCorrect.HyperlinkAction.Factory",()=>new Gl(b.resolve("Box4.ICharacterPropertiesEditor"))).as("Box4.IHyperlinkActionFactory").ha()}init(){this.W.resolve("Box4.IAutoCorrectRules").p2m();const b=v.AFrameworkApplication.K;b.$("AutoCorrectOptionSettingIsEnabledForWordOnline")&&b.$("IsRoamingServiceEnabled")&&this.W.resolve("Box4.IAutoCorrectOptionsInfo").JOl()}dispose(){}static main(){L.a.instance.Gc(new bk)}}Object(m.a)(bk,"Box4AutoCorrectPackage",null,[1,2]);class wn{get name(){return"Box4.Clipboard"}init(){}dispose(){}wc(){}static main(){L.a.instance.Gc(new wn)}}
Object(m.a)(wn,"Box4ClipboardPackage",null,[1,2]);class Yo{get name(){return"Box4.ImageEditors"}wc(){}init(){}dispose(){}static main(){L.a.instance.Gc(new Yo)}}Object(m.a)(Yo,"Box4ImageEditorsPackage",null,[1,2]);var Vn=c(622),Fq=c(885),bq=c(721),tk=c(837),ip=c(1166);class cn{constructor(){this.ChangeStateList=this.Revision=null}static construct(b,h,r,B,P){const ca=new cn;ca.DocumentId=P;ca.UserId=r;ca.WACSessionId=B;ca.Revision=b;ca.ChangeStateList=ip.a.Yjj(h);return ca}}Object(m.a)(cn,"LocalUnsavedChange",
null,[]);class $l{constructor(){this.X2d=null}uoe(b){return new Promise((h,r)=>{this.RLh().then(B=>{const P=B.transaction($l.w_c,"readwrite");P.objectStore($l.w_c).put(b);P.oncomplete=()=>h();P.onerror=()=>r(P.error.message)}).catch(r)})}uGd(b,h,r){return new Promise((B,P)=>{this.RLh().then(ca=>{const ra=ca.transaction($l.w_c,"readwrite");ra.objectStore($l.w_c).delete([b,h,r]);ra.oncomplete=()=>B();ra.onerror=()=>P(ra.error.message)}).catch(P)})}static isSupported(){return"indexedDB"in window}RLh(){return new Promise((b,
h)=>{if($l.isSupported())if(this.X2d)b(this.X2d);else{var r=window.indexedDB.open($l.y3m,$l.z3m);r.onsuccess=()=>{this.X2d=r.result;b(r.result)};r.onerror=()=>{h(r.error.message)};r.onupgradeneeded=()=>{const B=r.result,P=B.createObjectStore($l.w_c,{keyPath:["DocumentId","UserId","WACSessionId"]});P.createIndex("DocumentId, UserId",["DocumentId","UserId"],{unique:!1});P.createIndex("UserId",["UserId"],{unique:!1});this.X2d=B;b(B)}}else h("This browser does not support IndexedDB.")})}}$l.y3m="LocalUnsavedChangeDatabase";
$l.z3m=1;$l.w_c="LocalUnsavedChange";Object(m.a)($l,"LocalUnsavedChangeStore",null,[]);class sm{constructor(b,h,r,B,P,ca){this.fKi=b;this.Ree=h;this.Cdi=r;this.eSd=B;this.bVk=P;this.uza=ca}initialize(){const b=Fq.a.huf(this.Cdi());this.$Jd=this.aLc=b;this.uza.Fyk(this.ZXi.bind(this));this.uza.Gyk(this.$Xi.bind(this))}dispose(){this.uza.X1n(this.ZXi.bind(this));this.uza.Y1n(this.$Xi.bind(this))}ZXi(b,h){this.FXo(h.cUa)}$Xi(b,h){this.lUo(h.cUa)}lUo(b){b.equals(this.aLc)||(this.aLc=b,b.equals(this.$Jd)?
this.uGd():this.uoe())}FXo(b){b.equals(this.$Jd)||(this.$Jd=b,b.equals(this.aLc)?this.uGd():this.uoe())}ccl(){const b=new tk.a(this.$Jd,this.aLc,this.Cdi(),this.eSd().zr,this.eSd().apb,this.eSd().contextId,this.aLc.id,this.Ree,bq.FolderReader.jJb(this.eSd()),!1);return cn.construct(b,this.bVk.iQc(),sm.userId,sm.sessionId,sm.documentId)}uoe(){const b=this.ccl();this.fKi.uoe(b).then(()=>{t.ULS.sendTraceTag(509366736,306,50,"Successfully updated local unsaved change with LatestRevision: {0}",b.Revision.Id)}).catch(h=>
{t.ULS.sendTraceTag(509366735,306,10,"Failed to update local unsaved change because {0}",h)})}uGd(){this.fKi.uGd(sm.documentId,sm.userId,sm.sessionId).then(()=>{t.ULS.sendTraceTag(509366734,306,50,"Successfully clear local unsaved change.")}).catch(b=>{t.ULS.sendTraceTag(509366733,306,10,"Failed to clear local unsaved change because {0}",b)})}static isSupported(){return $l.isSupported()&&null!=this.documentId&&null!=this.userId&&null!=this.sessionId}static get documentId(){return null!=sm.syg?sm.syg:
sm.syg=v.AFrameworkApplication.sessionStartInfoSettings.ServerDocId}static get userId(){return null!=sm.zJg?sm.zJg:sm.zJg=v.AFrameworkApplication.K.kb("LoggableUserId")}static get sessionId(){return null!=sm.PGg?sm.PGg:sm.PGg=v.AFrameworkApplication.K.kb("SessionId")}}Object(m.a)(sm,"LocalUnsavedChangeManager",null,[481]);class Co{get name(){return"Box4.LocalUnsavedChange"}init(){this.pxi()&&sm.isSupported()&&(this.OMf=this.container.resolve("Box4.LocalUnsavedChange.LocalUnsavedChangeManager"),this.OMf.initialize())}dispose(){this.OMf&&
this.OMf.dispose()}wc(b){this.container=b;if(this.pxi()){b.ia("Box4.LocalUnsavedChange.LocalUnsavedChangeStore",()=>new $l).ha();var h=(r,B,P)=>new Vn.a(r,B,P);b.ia("Box4.LocalUnsavedChange.LocalUnsavedChangeManager",()=>new sm(b.resolve("Box4.LocalUnsavedChange.LocalUnsavedChangeStore"),h,()=>Eb.App.za.jb.Zc.xd,()=>Eb.App.za.jb.Zc,b.resolve("Box4.CatchUpActivity.IChangeStateManager"),b.resolve("Box4.Revision.RevisionSequenceNumberManager"))).ha()}}static main(){L.a.instance.Gc(new Co)}pxi(){return v.AFrameworkApplication.K.$("DisconnectedScenarioIsEnabled")}}
Object(m.a)(Co,"LocalUnsavedChangePackage",null,[1,2]);class hj{get name(){return"Box4.NotebookLevelEditors"}wc(){}init(){}dispose(){}static main(){L.a.instance.Gc(new hj)}}Object(m.a)(hj,"Box4NotebookLevelEditorsPackage",null,[1,2]);var Jh=c(1565);class Yi{get name(){return"Box4.Search"}wc(b){b.ia("Box4.Search.FindManagerHelper",()=>Jh.FindManagerHelper.instance).as("Box4.Search.IFindManagerHelper").ha()}init(){}dispose(){}}Object(m.a)(Yi,"PackageManager",null,[1,2]);class th{get name(){return"Box4.TableEditors"}wc(){}init(){}dispose(){}static main(){L.a.instance.Gc(new th)}}
Object(m.a)(th,"Box4TableEditorsPackage",null,[1,2]);class sb{get name(){return"Box4.TextLevelEditors"}wc(){}init(){}dispose(){}static main(){L.a.instance.Gc(new sb)}}Object(m.a)(sb,"Box4TextLevelEditorsPackage",null,[1,2]);var Xb=c(115),fd=c(358),Yc=c(174),Ve=c(618),mf=c(1580);class pg{constructor(b,h,r){this.gw=this.qLa=this.zNa=null;this.vE=this.jye=this.IKa=0;this.Rla=this.hpd=this.xXa=this.wXa=!1;this.Snd=this.SZg=this.VZg=0;this.IBa=b;this.ga=h;this.kn=r}vP(b){return!Eb.App.za.jb.isEditingAllowed||
kc.SessionStatusManager.instance.Zj?!1:""!==this.KQc(b.yf)}AL(b){if(!this.vP(b))return!1;this.Xjo(b);this.vE=this.IBa.G9b();this.Smo(b);this.Tmo();({Ucc:this.hpd,nec:this.Rla}=this.nnj(this.jye));this.Umo();this.zNa=b.lI;this.gw=new Sys.UI.Point(0,0);[this.VZg,this.SZg]=this.IBa.getDimensions();t.ULS.sendTraceTag(16802335,322,50,"Image resize drag started");return!0}eV(b){this.qLa=b.lI;this.GQk();this.Snd=mf.b(this.gw.x,this.gw.y,this.VZg,this.SZg,this.hpd,this.Rla,this.Snd,v.AFrameworkApplication.K.$("SmoothImageHelperGetScaleIsEnabled"));
this.IBa.eqg(this.Snd,this.hpd,this.Rla);return!0}iE(){this.setSize();t.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")}RY(){this.IBa.p$f();t.ULS.sendTraceTag(16802337,322,50,"Image resize drag canceled")}Xjo(b){this.IBa=Xb.a.Eb(b.yf,Ve.a)}Tmo(){this.jye=(Math.floor((this.vE+22)/45)%8+this.IKa)%8}nnj(b){let h,r;if(this.vE&&90!==this.vE&&180!==this.vE&&270!==this.vE&&360!==this.vE||this.lPm(b))return{Ucc:!0,nec:!0};h=r=!1;switch(b){case 1:case 5:h=!0;break;case 3:case 7:r=!0}return{Ucc:r,
nec:h}}Umo(){this.xXa=this.wXa=!1;switch(this.jye){case 0:this.xXa=this.wXa=!0;break;case 1:case 2:this.xXa=!0;break;case 7:case 6:this.wXa=!0}}lPm(b){return!(b%2)}KQc(b){var h=b.classList.toString();-1===h.indexOf("WACImageResizeHandle")&&b.parentNode&&(h=b.parentNode.classList.toString());b=h.split(" ");for(h=0;h<b.length;h++){const r=b[h].toString();if(r.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==r)return r}return""}Smo(b){switch(this.KQc(b.yf)){case "WACImageResizeHandleNW":this.IKa=
0;break;case "WACImageResizeHandleN":this.IKa=1;break;case "WACImageResizeHandleNE":this.IKa=2;break;case "WACImageResizeHandleE":this.IKa=3;break;case "WACImageResizeHandleSE":this.IKa=4;break;case "WACImageResizeHandleS":this.IKa=5;break;case "WACImageResizeHandleSW":this.IKa=6;break;case "WACImageResizeHandleW":this.IKa=7}}GQk(){var b=1;this.kn.instance&&(b=this.kn.instance.nj);const h=(this.qLa.x-this.zNa.x)/b;b=(this.qLa.y-this.zNa.y)/b;this.gw.x=this.wXa?-h:h;this.gw.y=this.xXa?-b:b}setSize(){const b=
new fd.DictionaryPropertySet;b.setValue(Yc.a.xUc,100*this.Snd);b.setValue(Yc.a.Dqi,!0);if(90===this.vE||270===this.vE){let h,r;({Ucc:h,nec:r}=this.nnj(this.IKa));b.setValue(Yc.a.KAf,h);b.setValue(Yc.a.LAf,r)}else b.setValue(Yc.a.KAf,this.hpd),b.setValue(Yc.a.LAf,this.Rla);this.ga.Qb(Nb.a.obc,2,b)}}Object(m.a)(pg,"ImageResizeDragAdapter",null,[139]);var Ze=c(126),yh=c(890);class Oi{constructor(b,h,r,B){this.KEe=this.qLa=this.zNa=this.dwd=null;this.btd=this.LAd=0;this.Gb=null;this.ga=b;this.hb=h;this.kn=
r;this.J5g=this.uCa=0;this.ld=B}vP(b){return Eb.App.za.jb.isEditingAllowed&&!kc.SessionStatusManager.instance.Zj&&b&&this.STm(b.yf)?(this.dwd=this.hb.qg)?!0:!1:!1}XOd(){}iuf(){return null}AL(b){if(!this.vP(b))return!1;this.IBa=Xb.a.Eb(b.yf,Ve.a);if(!this.IBa)return!1;this.Bwd=this.IBa.D$;if(!this.Bwd)return!1;this.dwd=this.hb.qg;this.Gb=Id.ImageReader.rn(this.dwd);if(!this.Gb)return!1;this.zNa=this.WPa(b);this.KEe=Sys.UI.DomElement.getBounds(this.Bwd);this.LAd=0<Id.ImageReader.VQc(this.Gb)?Id.ImageReader.VQc(this.Gb):
0;this.btd=Id.ImageReader.SQc(this.Gb);return!0}eV(b){this.qLa=this.WPa(b);this.OQk();if(this.IBa)return this.IBa.Goe(this.uCa,this.J5g),!0;t.ULS.sendTraceTag(538809933,322,50,"Image rotate drag move aborted because img presenter is null.");return!1}iE(){this.LAd=this.uCa=mf.c(this.uCa);this.P5()}RY(){this.IBa.Goe(this.btd,0)}STm(b){return b.classList.contains(yh.c)||b.classList.contains(yh.b)||b.classList.contains(yh.a)||!!b.parentElement&&b.parentElement.classList.contains(yh.a)}WPa(b){return this.ld.yd.l2a(b)}OQk(){var b=
1;this.kn&&this.kn.instance&&(b=this.kn.instance.nj);var h=new Sys.UI.Point(this.KEe.x+this.Bwd.clientWidth/2*b,this.KEe.y+this.Bwd.clientHeight/2*b);b=mf.a(this.zNa,h);h=mf.a(this.qLa,h);this.uCa=Math.round(Ze.a.FNn(h-b));0<this.LAd&&(this.uCa+=this.LAd-this.btd);this.J5g=this.uCa;this.uCa+=this.btd}P5(){const b=new fd.DictionaryPropertySet;b.setValue(Yc.a.uUc,0);b.setValue(Yc.a.JU,this.uCa);this.ga.Qb(Nb.a.m9,2,b)}}Object(m.a)(Oi,"ImageRotateDragAdapterSimplified",null,[477,139]);class Kh{constructor(){this.W=
null}get name(){return"Box4.Images"}wc(b){this.W=b;this.W.ia("Box4.Images.ImageResizeDragAdapter",()=>new pg(null,v.AFrameworkApplication.va,Ma.a.instance.Ta("Common.IZoomManager"))).as("Box4.Images.IImageResizeDragAdapter").ha();this.W.ia("Box4.Images.ImageRotateDragAdapterUpdated",()=>new Oi(v.AFrameworkApplication.va,Bh.a.instance,Ma.a.instance.Ta("Common.IZoomManager"),hb.InteractiveViewManager.instance)).as("Box4.Images.IImageRotateDragAdapter").ha()}init(){this.W.resolve("Box4.Images.IImageResizeDragAdapter");
this.W.resolve("Box4.Images.IImageRotateDragAdapter")}dispose(){}static main(){L.a.instance.Gc(new Kh)}}Object(m.a)(Kh,"Box4ImagesPackage",null,[1,2]);var ei=c(314),lh=c(119),Mc=c(6),Xg=c(689),fi=c(457),kl=c(578),Gh=c(257),ie=c(262),Cd=c(1799),ik=c(1700),oj=c(1219);class ck extends ik.a{constructor(b,h,r){super(b,h,r);this.cud=this.seb=null}get nS(){return v.AFrameworkApplication.ua.Lq}FRd(b){switch(b){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;
default:return""}}kpe(b){return ck.Lka(b,this.gki())}gki(){return ck.LXe}Lka(b,h=null){b=this.kpe(b);return 0!==b?(h&&h.IBd(),2===b&&(h=this.FRd(b),this.Ep(this.A9h(b),h)),!1):!0}uwa(b,h){t.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.kZf=h;kh.a.mark(5576);this.cud=this.nS.Zf("LoadResource","PictureUploadTime");this.gYd()?this.l7c(b):this.ohc()}Ep(b,h){const r=new Tf.StandardDialog;r.Cd=0;r.vx(b,CommonUIStrings.l_ImageUploadFailedTitle,h,null)}ohc(){t.ULS.sendTraceTag(36783361,
322,50,"PictureUploader.OnUploadComplete");super.ohc();this.cud&&(this.cud.stop(),this.cud=null)}n8a(){this.seb=(new oj.a).create();this.seb.message=CommonUIStrings.l_ImageUploadWait;this.seb.Cd=5;this.seb.Kt=!1;this.seb.JL(null,null,null)}S4b(){this.seb&&(this.seb.close(),this.seb=null)}static vtm(b,h){b=F.a.eh(b);for(let r=0;r<h.length;++r)if(b.endsWith(h[r]))return!0;return!1}static Lka(b,h=null){h||(h=ck.LXe);return b?ck.vtm(b,h)?0:2:1}}ck.LXe=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");
Object(m.a)(ck,"PictureUploader",ik.a,[]);var Bi=c(357),uh;(function(b){b[b.validPicture=0]="validPicture";b[b.noPictureSpecified=1]="noPictureSpecified";b[b.invalidExtension=2]="invalidExtension";b[b.pictureTooLarge=3]="pictureTooLarge"})(uh||(uh={}));Object(m.b)("PictureValidationResult",uh);var xg=c(55),Pd=c(16),gi=c(46),hg=c(1035);class Sl{constructor(){this.YO=null}}Object(m.a)(Sl,"ImageData",null,[]);var hh=c(51),xn=c(1800),ch=c(1639),on=c(1675);class Ml extends Pe.a{constructor(b,h=!0){super(!1,
!1,Ml.PL);this.s_b=null;this.yVg=!1;this.yy=[];this.gq=null;this.ueb=b;this.ajk=h;this.Faa=this.Gih=!1;this.f_a=null;this.sBe=!1;this.Vg=this.Lnl;this.yg="InsertFileDialog";this.ze(1,this.bBd);Ml.PL?(this.s_b={["id"]:this.yg,["bodyControls"]:{["uploadButtonProps"]:{["label"]:CommonUIStrings.l_DialogChooseFile,["onExecute"]:Object(z.a)(this,this.Yvn,"onUploadButtonClick")}},["uploadStatusLabel"]:CommonUIStrings.l_DialogNoFileChosen,["onFrameReady"]:Object(z.a)(this,this.Oon,"onFrameReady")},this.Uh(this.titleText,
Object(z.a)(this,this.XXd,"insertDialogHandler"),this.s_b),this.nW=!0):(this.showDialog(this.titleText,Object(z.a)(this,this.XXd,"insertDialogHandler")),h&&this.fpo(),(b=this.zQd(1))&&this.yy.push(b),(b=this.zQd(0))&&this.yy.push(b),this.RGj(),this.nW=!1)}get KIj(){return this.ueb}validate(){this.gq.YO||t.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.gq.YO.value?!0:(Ml.vx(CommonUIStrings.l_FileUploadNoFileSpecified),!1)}Oon(b){this.ajk&&(this.gq=this.qoj(b,this.ueb))}Yvn(){this.gq&&
this.gq.YO&&(this.yVg||(this.gq.cXn(Object(z.a)(this,this.AWf,"onFileChosen")),this.yVg=!0),this.gq.A_h())}AWf(b){this.s_b.uploadStatusLabel=b;this.p6(this.titleText,Object(z.a)(this,this.XXd,"insertDialogHandler"),this.s_b)}XXd(b){1===b&&this.isEnabled()?Ml.PL&&this.gq.YO&&!this.gq.YO.value?(this.s_b.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.p6(this.titleText,Object(z.a)(this,this.XXd,"insertDialogHandler"),this.s_b)):(this.HWd(),this.ueb.uwa(this.gq,Object(z.a)(this,this.dispose,
"dispose"))):0===b&&this.hide()}fpo(){this.sBe=!1;this.gq=this.qoj(document.getElementById("uploadFrameContainer"),this.ueb);v.AFrameworkApplication.K.$("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.f_a=Object(z.a)(this,this.lZf,"onUploadFrameLoad"),He.a.addHandler(this.gq.iFrame,"load",this.f_a));this.gq.YO||t.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.O4i()}lZf(){this.O4i()}O4i(){if(this.gq&&!this.sBe){var b=this.gq.YO;b&&(He.a.addHandler(b,pd.a.gi,Object(z.a)(this,
this.onKeyDown,"onKeyDown")),b=[b],this.yy=b.concat.apply(b,this.yy),this.RGj(),this.sBe=!0)}}dispose(){if(this.gq&&!Ml.PL){const b=this.gq.YO;b&&He.a.removeHandler(b,pd.a.gi,Object(z.a)(this,this.onKeyDown,"onKeyDown"));this.f_a&&He.a.removeHandler(this.gq.iFrame,"load",this.f_a)}this.gq=null;super.dispose()}RGj(){if(0<this.yy.length){const b=new Dc(this.yy),h=pc.FocusManager.instance().at();h&&(this.yy[0].focus(),h.hk=b,h.BP=!0)}}onKeyDown(b){4!==pc.FocusManager.instance().S4i(b)&&b.preventDefault()}static get PL(){return v.AFrameworkApplication.ua.Kb.vF&&
v.AFrameworkApplication.ua.Kb.$Bi}static vx(b){const h=document.getElementById("errorText");h.innerText=b;h.style.display="inline-block"}}Object(m.a)(Ml,"InsertFileDialog",Pe.a,[]);class Ok{static get Vg(){return Pe.a.Kx(Ok.Xm,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}Ok.Xm="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(m.a)(Ok,"InsertImageDialogHtml",null,[]);class sc extends Ml{constructor(b,h=!0){super(b,h)}get bBd(){return CommonUIStrings.l_ImageUploadButtonText}get titleText(){return CommonUIStrings.l_ImageUploadingTitle}get Lnl(){return Ok.Vg}validate(){this.gq.YO||t.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var b=Object(Ra.a)(ck,this.KIj);const h=b.kpe(this.gq.YO.value);return 0!==h?(b=b.FRd(h),Ml.vx(b),!1):!0}}Object(m.a)(sc,"InsertImageDialog",Ml,[]);class jp extends sc{constructor(b){super(b)}qoj(b,
h){const r=v.AFrameworkApplication.ua.Kb.vF&&v.AFrameworkApplication.ua.Kb.$Bi;return new on.a(b,Object(z.a)(h,h.l6a,"onUploadFrameInitialized"),Object(z.a)(h,h.Kea,"uploadResponseReceived"),v.AFrameworkApplication.K,!r)}isEnabled(){return jp.qP.Hga(this.KIj.context)}static get qP(){return null!=jp.tBg?jp.tBg:jp.tBg=Ma.a.instance.resolve("Box4.Images.IImageEditor")}}Object(m.a)(jp,"Box4InsertImageDialog",sc,[]);class Lp{U6k(b){return new Promise((h,r)=>{this.V6k(b).then(B=>{h(B)},B=>{r(B)})})}OJh(b){return new Promise((h,
r)=>{const B=new FileReader;B.addEventListener("load",()=>{h(B.result)},!1);B.addEventListener("error",()=>{r("FileReader exception ("+B.error.name+")")});B.readAsDataURL(b)})}V6k(b){return new Promise((h,r)=>{this.OJh(b).then(B=>{this.faf(B,"image/jpeg").then(P=>{h(P)},P=>{r(P)})},B=>{r(B)})})}faf(b,h){return new Promise((r,B)=>{const P=new Image;P.addEventListener("load",()=>{const ca=document.createElement("canvas"),ra=ca.getContext("2d");ca.width=P.width;ca.height=P.height;ra.drawImage(P,0,0);
r(ca.toDataURL(h))});P.addEventListener("error",()=>{B("Image failed to load")});P.src=b})}}Object(m.a)(Lp,"ImageFormatConverter",null,[]);var jk=c(396);const Zo=["ImageInsertFailed"];class Pk extends ck{constructor(b,h,r,B,P,ca,ra=!0){super(b,h,r);this.FBa=this.Yl=this.lH=this.Ef=null;this.gOd="wwpicturesfc";this.kpiName="ImageFileExtension";this.$xc="LocalDeviceUpload";this.Eia=new Map;this.G_h=0;this.teb=null;this.qBe="";this.Zsa=0;this.Xo=null;this.Rwc="";this.L6g=50;this.aXg=this.cvc=this.xDc=
this.Xzc=!1;this.Rak=19922944;this.Y8g=0;this.uBe=[];this.xVg=[];this.Z8g=0;this.fYf=Qa=>{t.ULS.sendTraceTag(36783363,322,50,"Box4PictureUploader.OnPlaceholderNodeSaved");if(Qa){var tb={},Mb=this.lH?this.lH.properties.Qc.toString():this.Ef.Qc.toString();tb[fi.a.nodeId]=this.lH?this.lH.id.toString():this.Ef.id.toString();tb[fi.a.classId]=Mb;this.Yg.hasProperty(Mc.a.imageType)&&(tb[Xg.a.imageType]=this.Yg.getValue(Mc.a.imageType));this.Yg.hasProperty(Mc.a.IU)&&(tb[Xg.a.IU]=this.Yg.getValue(Mc.a.IU));
this.Yg.hasProperty(lh.a.iha)&&(tb[Xg.a.iha]=this.Yg.getValue(lh.a.iha));this.Yg.hasProperty(Mc.a.Dmb)&&(tb[Xg.a.Dmb]=this.Yg.getValue(Mc.a.Dmb));ch.d(Qa,this.Ef,this.Yl,tb)&&(this.fbd(Qa),Pk.zgc++)}else t.ULS.sendTraceTag(16869584,352,15,"InsertPicture:UploadFrame is null")};this.xon=Qa=>{if(!this.mCf){var tb=this.T9h(this.gq);tb&&(this.qBe=tb.name,this.Zsa=tb.size);if(!this.Lka(Qa,this.gq)||!this.trg(tb,this.gq)){tb=Object.assign(new hc.a,{extendedProperties:new Map});tb.extendedProperties.set("type",
this.Lka(Qa,this.gq)?"Image too large":"FileType invalid");this.t3d(tb);this.m3d();return}}this.uwa(this.gq,null)};this.Yg=B;this.Qm=P;this.ga=ca;this.rg=Bi.a.getInstance(jk.a);this.K5g=r.$("WACLocalRenderingForInsertLocalImageIsEnabled");this.c7g=r.mc("ImageUploadMaxByteSize",Number.MAX_VALUE);ra&&this.showDialog();Eb.App.Bnc.addHandler(this)}get Dzi(){return this.K.$("JfifImageInsertIsEnabled")}get yP(){return this.$xc}get fileExtension(){return this.qBe}get fileSize(){return this.Zsa}get JIj(){return this.teb}get Gv(){return this.Xo||
(this.Xo=Ma.a.instance.resolve("Common.Utils.IAriaNotifier"))}get mCf(){return this.yP===this.$xc}showDialog(){ch.a(this.K)?(this.m1a=!1,this.gq=new on.a(document.body,Object(z.a)(this,this.l6a,"onUploadFrameInitialized"),Object(z.a)(this,this.Kea,"uploadResponseReceived"),this.K,!1,void 0,!0)):ch.b()||this.anb&&Z.a.TG?(this.m1a=!1,this.gq=new on.a(document.body,Object(z.a)(this,this.l6a,"onUploadFrameInitialized"),Object(z.a)(this,this.Kea,"uploadResponseReceived"),this.K,!1)):(this.m1a=!0,this.gq=
(new jp(this)).gq)}A9h(b){switch(b){case uh.noPictureSpecified:return hh.a.noPictureSpecified;case uh.invalidExtension:return hh.a.GEm;case uh.pictureTooLarge:return hh.a.GMf}return Zl.a.unknown}l7c(b){this.mCf||(this.Ef.Yi()?(t.ULS.sendTraceTag(36783362,322,50,"Box4PictureUploader.ReplicatePlaceholder"),xn.a.instance.Hqg(this.Ef.Yi()),this.Ef.Yi().contentReplicator.forceOutbound(this.fYf,Object(z.a)(this,this.ZNb,"processFailure"),b)):this.ZNb(b,157))}BSm(){return ch.c(this.Ef)}fbd(b){b.fbd();this.teb=
b.teb}Kea(b){this.G_h=+new Date-+this.JIj;this.m3d();t.ULS.sendTraceTag(36783364,322,50,"Box4PictureUploader.UploadResponseReceived");ch.e(this,b,this.Ef)}Dqg(){t.ULS.sendTraceTag(36783365,322,50,"Box4PictureUploader.UploadComplete");this.ohc();Pk.zgc--;this.ga.processAction(fb.a.t9a,2);this.Ef?xn.a.instance.Voc(this.Ef.Yi(),0):t.ULS.sendTraceTag(42468439,339,50,"Not able to notify upload notifier for completion");this.Gv.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)}ZNb(b,h){var r;if(this.H8n(b))t.ULS.sendTraceTag(16798870,
352,50,"InsertPicture:OutboundRetry:Retry={0}:Error={1}",this.retryCount,h.toLocaleString());else{b=Object.assign(new hc.a,{extendedProperties:new Map});b.extendedProperties.set("result",h.toLocaleString());(null===(r=v.AFrameworkApplication.K)||void 0===r?0:r.$("ShouldLogPicturesExtendedHealthKpis"))?this.rg.logKpiFailure({kpiName:jk.c.ZFa,errorName:"PictureFromLocalUploadRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:{name:jk.c.mbc,errorNameOverride:null,
isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b}}):va.Health.instance.recordQosError("PictureFromLocalUploadRequestFailed",Zo,!1,!0,!1,!1,b);r=this.mjf(h);t.ULS.sendTraceTag(16798871,352,10,"InsertPicture:Failure:Retries={0}:Error={1}",this.retryCount,h.toLocaleString());b=this.Ef.zJ();var B=new cg.GraphTransaction(15,Nb.a.BR);B.Db(this.Ef);Pk.qP.rUa(this.Yg,r);Pk.qP.l8f(this.Ef,this.lH);Id.ImageReader.hmj(this.Yg,hg.a.failed);B.dispose();this.Hsj(r);this.Qm.Q4b(b,
!1);this.ohc();Pk.zgc--;xn.a.instance.Voc(this.Ef.Yi(),h)}}Hsj(b){const h=new Tf.StandardDialog;h.Cd=0;h.vx(hh.a.invalidImageFile,CommonUIStrings.l_ImageUploadFailedTitle,b,null)}mjf(b){switch(b){case 23:return Box4Intl.Box4Strings.l_ImageUploadSizeError;default:return Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord}}DPj(){if(this.Rwc&&0<this.Rwc.length){const b=new fd.DictionaryPropertySet;b.setValue(Yc.a.NP,this.Rwc);b.setValue(Yc.a.P4,!0);this.ga.Qb(Nb.a.P_,2,b)}this.Dwo()}Dwo(){let b="";this.aXg?
b=Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord:this.Xzc&&this.cvc&&this.xDc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatSizeAndMaxNumberExceededError:this.Xzc&&this.cvc?b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatAndMaxNumberExceededError:this.Xzc&&this.xDc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndMaxNumberExceededError:this.xDc&&this.cvc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndFormatError:this.xDc?b=Box4Intl.Box4Strings.l_MultipleImageUploadSizeError:this.cvc?
b=Box4Intl.Box4Strings.l_MultipleImageUploadFormatError:this.Xzc&&(b=Box4Intl.Box4Strings.l_MultipleImageUploadMaxNumberExceededError);""!==b&&(this.Hsj(b),this.jQj())}Wvk(b){this.Rwc+=String.format('<img src="{0}"></img>',b);this.Z8g++}X5m(){this.xDc=!0;t.ULS.sendTraceTag(524873990,322,10,"Image too large");const b=Object.assign(new hc.a,{extendedProperties:new Map});b.extendedProperties.set("type","Image too large");this.t3d(b)}V5m(){this.cvc=!0;t.ULS.sendTraceTag(545093781,322,10,"Image filetype not supported");
const b=Object.assign(new hc.a,{extendedProperties:new Map});b.extendedProperties.set("type","Filetype invalid");this.t3d(b)}JKi(b){this.aXg=!0;t.ULS.sendTraceTag(524873991,322,15,"Something went wrong during paste with format conversion: {0}",b)}yCo(b){const h=new Lp;if(this.kpe(b.name)===uh.validPicture)return h.OJh(b);if(ck.Lka(b.name,on.a.MXe)===uh.validPicture)return h.U6k(b)}d7k(b){return new Promise(h=>{const r=this.yCo(b);void 0===r&&(this.JKi("Failed starting conversion work"),h());r.then(B=>
{B.length>this.Rak?this.X5m():this.Wvk(B);h()},B=>{this.JKi(B);h()})})}lXm(b){return this.kpe(b.name)===uh.validPicture||ck.Lka(b.name,on.a.MXe)===uh.validPicture}UDm(){const b=[];if(this.gq.YO.files){this.Y8g=this.gq.YO.files.length;this.gq.YO.files.length>this.L6g&&(this.Xzc=!0);this.n8a();for(let h=0;h<this.gq.YO.files.length&&this.L6g;h++){const r=this.gq.YO.files[h];this.uBe.push(r.name);this.xVg.push(r.size);r&&(this.lXm(r)?b.push(this.d7k(r)):this.V5m())}}Promise.all(b).then(()=>{this.S4b();
this.DPj()});return!0}IEm(){this.Yl=Bb.a.create();this.Yg||(this.Yg=new fd.DictionaryPropertySet);this.K5g&&this.FBa&&this.Yg.setValue(lh.a.dKi,this.FBa);var b=480;let h=320;const r=this.context.view.xh.editingElement.clientWidth;0<r&&r<b&&(h=Math.floor(1*r/b*h),b=r,this.Yg.setValue(lh.a.iha,r));this.Yg.setValue(Pd.a.Hia,xg.a.Ql(b,0));this.Yg.setValue(Pd.a.Gia,xg.a.Ql(h,1));this.Yg.setValue(gi.a.B0,hg.a.uploading);this.Yg.setValue(Yc.a.P4,!0);this.Yg.setValue(Mc.a.Dmb,Box4Intl.Box4Strings.l_Picture);
b=Pk.qP.dUh(this.context,this.Yg,this.Yl);if(!b)return!1;this.Ef=b.node;this.Yg=(this.lH=b.blob)?this.lH.properties:this.Ef.properties;Eb.App.zd.Uo&&Eb.App.zd.fq.gG(this.Ef);return!0}gYd(){return this.mCf?this.UDm():this.IEm()}jQj(){var b;this.Eia.set("FileExtensions",this.ISl());this.Eia.set("FileSizeInBytes",this.xVg.toString());this.Eia.set("Source",this.yP);this.Eia.set("NumberOfImagesAttemptedToInsert",this.Y8g.toString());this.Eia.set("NumberOfImagesPasted",this.Z8g.toString());(null===(b=v.AFrameworkApplication.K)||
void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?(this.Eia.set("ErrorLevel","warning"),b=Object.assign(new hc.a,{extendedProperties:this.Eia}),this.rg.logKpiFailure({kpiName:jk.c.ZFa,errorName:"MultipleImageInsertFailed",optionalProperties:{additionalValues:b}})):va.Health.instance.recordKpiUsage("MultipleImageInsert",0,this.gOd,this.Eia)}ISl(){let b="";for(let h=0;h<this.uBe.length;++h)b=b+this.S9h(this.uBe[h])+",";return b}uwa(b,h){this.K5g&&(this.FBa=new Sl,this.FBa.YO=b.YO);super.uwa(b,
h)}l6a(b){this.gq=b;if(!this.m1a){if(this.Zdd){if(ch.a(this.K)||this.anb&&Z.a.TG){b.nMc(this.xon);return}const h=b.nMc(null),r=this.T9h(b);r&&(this.qBe=r.name,this.Zsa=r.size);if(!this.Lka(h,b)||!this.trg(r,b)){b=Object.assign(new hc.a,{extendedProperties:new Map});b.extendedProperties.set("type",this.Lka(h,this.gq)?"Image too large":"FileType invalid");this.t3d(b);this.m3d();return}}this.uwa(b,null)}}xWd(){return!!Pk.zgc}m3d(){var b;this.Eia.set("FileExtension",this.S9h(this.fileExtension));this.Eia.set("Source",
this.yP);this.Eia.set("FileSizeInBytes",this.fileSize.toString());this.Eia.set("RequestTimeInMs",this.G_h.toString());(null===(b=v.AFrameworkApplication.K)||void 0===b?0:b.$("ShouldLogPicturesExtendedHealthKpis"))?this.rg.logKpiUsage({kpiName:jk.c.ZFa,kpiType:0,optionalProperties:{extendedProperties:this.Eia}}):va.Health.instance.recordKpiUsage(this.kpiName,0,this.gOd,this.Eia)}S9h(b){return b&&(b=b.split("."),1<b.length)?b[b.length-1].substring(0,4):""}gki(){return this.Dzi?on.a.Dlh:ck.LXe}T9h(b){return(b=
b.YO)?b.files[0]:null}trg(b,h){return b&&b.size>this.c7g?(h&&h.IBd(),b=this.FRd(uh.pictureTooLarge),this.Ep(this.A9h(uh.pictureTooLarge),b),!1):!0}FRd(b){switch(b){case uh.noPictureSpecified:return CommonUIStrings.l_ImageUploadNoFileSpecified;case uh.invalidExtension:return this.Dzi?CommonUIStrings.l_WordImageUploadUnsupportedFileType:CommonUIStrings.l_ImageUploadUnsupportedFileType;case uh.pictureTooLarge:return String.format(CommonUIStrings.l_ImageUploadSizeErrorWithLimit,Math.round(this.c7g/1E6));
default:return""}}t3d(b){var h;(null===(h=v.AFrameworkApplication.K)||void 0===h?0:h.$("ShouldLogPicturesExtendedHealthKpis"))?(h={name:jk.c.mbc,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","info"),this.rg.logKpiFailure({kpiName:jk.c.ZFa,errorName:"PictureFromLocalInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:h})):va.Health.instance.recordQosError("PictureFromLocalInvalid",
Zo,!0,!0,!1,!1,b)}static get qP(){return null!=Pk.sBg?Pk.sBg:Pk.sBg=Ma.a.instance.resolve("Box4.Images.IImageEditor")}}Pk.zgc=0;Object(m.a)(Pk,"Box4PictureUploader",ck,[569,570]);var so=c(844),Nd=c(134);class Qk{constructor(){this.Qr=this.Op=this.myb=this.ujh=this.dhd=this.bZj=null;this.NQe=0;this.Qsa=this.YLe=this.Byb=null;this.kQg=0;this.due=this.Sfa=this.wIe=null;this.p0g=!1;this.ite=this.ete=this.jte=null}get assetId(){return this.dhd}get thumbnailUrl(){return this.ujh}get GHn(){return this.myb}get displayName(){return this.Qsa}get dimensions(){return String.format(Box4Intl.Box4Strings.l_ClipartDimensionsDisplay,
this.Op,this.Qr)}get kAk(){if(this.ete&&this.ite&&this.jte){const b=document.createElement("a");b.setAttribute("href",this.jte);b.setAttribute("target","_blank");b.innerText=this.ite;return b}return null}get $rh(){return this.ete}get fileSize(){return String.format(Box4Intl.Box4Strings.l_ClipartFileSizeDisplay,this.kQg)}get uPn(){const b=document.createElement("span");var h=0;if(this.Byb&&0<this.Byb.length){var r=this.Byb.indexOf("."),B=0>r?this.Byb:this.Byb.substring(0,r);for(B=Number.parseInvariant(B);h<
B&&5>h;h++)b.appendChild(we.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",Nd.a.wg("box42.png"),"","",!0,""));0<r&&(r=Number.parseInvariant(this.Byb.substr(r+1)),3>r?b.appendChild(we.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",Nd.a.wg("box42.png"),"","",!0,"")):8>r?b.appendChild(we.createClusteredImageFromCluster(13,13,"RsHalf_13x13x8","box42",Nd.a.wg("box42.png"),"","",!0,"")):b.appendChild(we.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",Nd.a.wg("box42.png"),
"","",!0,"")),h++)}for(;5>h;h++)b.appendChild(we.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",Nd.a.wg("box42.png"),"","",!0,""));this.YLe&&(h=document.createElement("span"),h.innerText=String.format(Box4Intl.Box4Strings.l_ClipartRatingVotes,this.YLe),b.appendChild(h));return b}get n7n(){return 0<this.NQe?String.format(Box4Intl.Box4Strings.l_ClipartResolutionDisplay,this.NQe):""}get AIk(){if(this.p0g){var b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByCommunity;
return b}if(this.due&&this.Sfa)return Qk.Tbl(this.due,this.Sfa);b=document.createElement("span");b.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByMicrosoft;return b}get keywords(){let b;if(this.wIe){const h=this.wIe.split(",");b=Array(h.length);for(let r=0;r<h.length;r++)b[r]=h[r].trim()}else b=[];return b}static gKl(b){const h=new Qk;for(let r=0;r<b.childNodes.length;r++){const B=b.childNodes[r];if(1===B.nodeType)try{const P=B.firstChild.nodeValue;switch(B.nodeName){case "src":h.bZj=P;break;case "assetid":h.dhd=
P;break;case "thumb":"64x64"===B.attributes.getNamedItem("size").nodeValue?h.ujh=Qk.VBj(P):"192x192"===B.attributes.getNamedItem("size").nodeValue&&(h.myb=Qk.VBj(P));break;case "imagedim":if(P){const ra=P.indexOf("x");0<ra&&ra<P.length&&(h.Op=P.substr(0,ra),h.Qr=P.substr(ra+1))}break;case "resolution":h.NQe=Number.parseInvariant(P);break;case "rating":h.Byb=P;break;case "numofratings":h.YLe=P;break;case "displayname":h.Qsa=P;break;case "contentlength":h.kQg=Number.parseInvariant(P)/1024;break;case "subject":h.wIe=
P;break;case "provider":h.Sfa=P;break;case "attributionlink":h.due=P;break;case "iscsc":h.p0g=1===Number.parseInvariant(P);break;case "additional":const ca=B.firstChild;if(B.hasChildNodes()&&ca&&"id"===ca.nodeName&&1===Number.parseInvariant(ca.text))for(let ra=0;ra<B.childNodes.length;ra++){const Qa=B.childNodes[ra];switch(Qa.nodeName){case "caption":h.ete=Qa.text;break;case "value":h.jte=Qa.text;break;case "string":h.ite=Qa.text}}}}catch(P){}}return h}static Tbl(b,h){const r=document.createElement("a");
r.setAttribute("href",b);r.setAttribute("target","_blank");r.innerText=h;return r}static VBj(b){let h;return b&&0<(h=b.indexOf("://"))?b.substr(h+1):b}}Object(m.a)(Qk,"ClipArtSearchResult",null,[]);class No{static get Vg(){return Pe.a.Kx(No.Xm,Box4Intl.Box4Strings.l_ClipartSearchButtonText,Box4Intl.Box4Strings.l_ClipartDefaultText)}}No.Xm="<div class='ClipartDialog' id='clipartdialog'> <div class='ClipartResultsPane' id='clipartresultspane'> <div class='ClipartSearchHeader' id='clipartsearchheader'> <input type='text' id='textInput' class='ClipartSearchInput' title='{0}' autocomplete=\"off\"/> <input type='image' id='btnSearch' class='WACButton ClipartSearchButton' title='{0}' alt='{0}'/> </div> <div class='ClipartSearchResults' id='clipartsearchresults'> {1} </div> </div> <div class='ClipartPreviewPane' id='clipartpreviewpane'> <div class='ClipartDisplayName UIFontBold' id='clipartattributedisplayname'> </div> <div class='ClipartSeeSimilar' id='clipartseesimilar'> </div> <div class='ClipartPreviewImage' id='clipartpreviewimage'> </div> <div class='ClipartPreviewDetails' id='clipartpreviewdetails'> <div class='ClipartAttributeContainer' id='clipartattribution'> <div class='ClipartAttributeName' id='clipartattributionname'> </div> <div class='ClipartAttributeValue' id='clipartattributionvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartadditional'> <div class='ClipartAttributeName' id='clipartadditionalname'> </div> <div class='ClipartAttributeValue' id='clipartadditionalvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartrating'> <div class='ClipartAttributeName' id='clipartratingname'> </div> <div class='ClipartAttributeValue' id='clipartratingvalue'> </div> </div> <div class='ClipartDimensions' id='clipartdimensions'> </div> <div class='ClipartAttributeContainer' id='clipartkeywords'> </div> </div> </div> </div>";
Object(m.a)(No,"InsertClipartDialogHtml",null,[]);class fm extends Pe.a{constructor(b){super();this.DBa=this.Lvb=0;this.Nbh=null;this.cPe=!1;this.f_b=this.WYa=this.bO=null;this.oYi=h=>{const r=this.ZW.value;r&&0<r.trim().length&&(this.search(this.ZW.value),this.ora(1,!1));h.preventDefault();h.stopPropagation()};this.bun=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&(this.oYi(h),h.preventDefault(),h.stopPropagation())};this.pYi=h=>{100<=this.ZW.value.length&&(h.preventDefault(),h.stopPropagation())};
this.xsn=h=>{h=Number.parseInvariant(h.target.parentNode.id.substr(4));this.b4i(h);this.wdg(h)};this.onScroll=()=>{if(this.Rr&&this.Rr.children&&!(2>this.Rr.children.length)){var h=this.Rr.children[0].children[0],r=this.Rr.clientHeight-(h.clientHeight-h.children[0].clientHeight+2)+this.Rr.scrollTop,B=h.clientHeight+2,P=parseInt(String(this.Rr.scrollTop/B));h=parseInt(String(r/B));var ca=parseInt(String(this.Rr.clientWidth/B));h<r/B&&h<parseInt(String(this.bO.length/ca))&&h++;for(r=P;r<h;r++)for(B=
0;B<ca;B++){var ra=r*ca+B;P=this.bO[ra];(ra=document.getElementById("clip"+ra))&&!ra.childNodes.length&&(P=this.uOh(P),ra.appendChild(P))}}};this.nvn=h=>{h.target.setAttribute("src",Nd.a.wg("phthumb.64x64x32.png"))};this.ysn=h=>{h.target.setAttribute("src",Nd.a.wg("phpreview.96x96x32.png"))};this.NVi=h=>{Qd.a.wm(h.target.attributes.getNamedItem("href").value,h.target.attributes.getNamedItem("target").value,void 0,"InsertClipartDialog");h.stopPropagation();h.preventDefault()};this.ypn=h=>{(h?h.keyCode:
window.event.keyCode)===Sys.UI.Key.enter&&this.NVi(h)};this.gWi=h=>{const r=h.target.innerText;this.ZW&&(this.ZW.value=r);this.search(r);h.stopPropagation();h.preventDefault();this.ora(1,!1)};this.nqn=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.gWi(h)};this.rYi=h=>{this.bO&&(this.gco(this.bO[this.Lvb]),h.stopPropagation(),h.preventDefault(),this.ZW.value="",this.ora(1,!1))};this.cun=h=>{(h?h.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.rYi(h)};this.onKeyDown=h=>{if(h.keyCode>=
Sys.UI.Key.left&&h.keyCode<=Sys.UI.Key.down){let r=0;switch(h.keyCode){case Sys.UI.Key.up:r=-5;break;case Sys.UI.Key.down:r=5;break;case Sys.UI.Key.left:r=-1;break;case Sys.UI.Key.right:r=1}this.DBa=this.DBa+r<this.Rr.children.length-1?0>this.DBa+r?0:this.DBa+r:this.Rr.children.length-1;this.wdg(this.DBa);h.preventDefault();h.stopPropagation()}else h.keyCode===Sys.UI.Key.enter?(h=Number.parseInvariant(h.target.id.substr(4)),0<=h&&h<this.Rr.children.length&&this.Kij(h)):h.keyCode===Sys.UI.Key.tab&&
(this.DBa=h.shiftKey?Math.max(0,this.DBa-1):Math.min(this.DBa+1,this.Rr.children.length-1))};this.onError=()=>{this.Rr&&(this.Rr.innerText=Box4Intl.Box4Strings.l_ClipartCannotConnect)};this.f5i=h=>{if(this.Rr)if(h.data.Oja){var r=h.data.Oja.lastChild.childNodes;this.bO||(this.bO=[]);for(h=0;h<r.length&&100>this.bO.length;h++){var B=r[h];1===B.nodeType&&"image"===B.nodeName&&(B=Qk.gKl(B),this.bO.push(B))}this.MTh();this.bO.length||(this.Rr.innerText=Box4Intl.Box4Strings.l_ClipartNoResultsFound)}else if(h.data.se){h=
F.a.Lwj(h.data.se);try{r=parseInt(h)}catch(P){r=14}this.Rr.innerText=26===r?Box4Intl.Box4Strings.l_ClipartCannotConnect:Box4Intl.Box4Strings.l_ClipartNoResultsFound}};this.MTh=()=>{if(this.bO){dc.a.U_(this.Rr);this.WYa&&(this.WYa.dispose(),this.WYa=null);this.Rr.focus();this.Rr.classList.remove("ClipartSearchInProgress");for(let r=0;r<this.bO.length;r++){var h=document.createElement("a");h.setAttribute("href","#");h.id="itab"+r;const B=document.createElement("span");B.id="clip"+r;B.classList.add("ClipartImageContainer");
h.appendChild(B);this.Rr.appendChild(h);r<parseInt(String(this.Rr.clientHeight/B.clientHeight))*parseInt(String(this.Rr.clientWidth/B.clientWidth))&&(h=this.uOh(this.bO[r]),B.appendChild(h))}this.cPe&&(this.Kij(this.Lvb),this.wdg(this.Lvb))}};this.jDm=h=>{1===h&&this.bO&&fm.qP.Hga(this.hPg.context)&&(h=this.bO[this.Lvb])&&this.hPg.Rza(h)};this.hPg=b;this.Vg=No.Vg;this.yg="InsertClipartDialog";this.ze(1,Box4Intl.Box4Strings.l_ClipartUploadButtonText);this.showDialog(Box4Intl.Box4Strings.l_ClipartUploadDialogTitle,
this.jDm);this.Rr=document.getElementById("clipartsearchresults");this.wwd=this.onKeyDown;He.a.addHandler(this.Rr,"keydown",this.wwd);this.vwd=this.onScroll;He.a.addHandler(this.Rr,"scroll",this.vwd);this.ZW=document.getElementById("textInput");this.Wyd=this.bun;He.a.addHandler(this.ZW,"keydown",this.Wyd);this.Xyd=this.pYi;He.a.addHandler(this.ZW,"keypress",this.Xyd);this.Yyd=this.pYi;He.a.addHandler(this.ZW,"paste",this.Yyd);this.Drc=document.getElementById("btnSearch");this.Drc.setAttribute("src",
Nd.a.wg("search.16x16x32.png"));this.uwd=this.oYi;He.a.addHandler(this.Drc,"click",this.uwd);this.vWb=document.getElementById("clipartpreviewimage");this.vze=document.getElementById("clipartattributedisplayname");this.Kab=document.getElementById("clipartseesimilar");this.uze=document.getElementById("clipartdimensions");this.muc=document.getElementById("clipartadditionalvalue");this.wze=document.getElementById("clipartratingvalue");this.cXa=document.getElementById("clipartattributionvalue");this.dXa=
document.getElementById("clipartkeywords");this.sze=document.getElementById("clipartadditionalname");this.xze=document.getElementById("clipartratingname");this.tze=document.getElementById("clipartattributionname");this.ePe=this.xsn;this.SVe=this.nvn;this.wnd=this.NVi;this.xnd=this.ypn;this.uIe=this.gWi;this.vIe=this.nqn;this.ywd=this.rYi;this.zwd=this.cun;this.ZW.focus();this.ora(1,!1)}dispose(){this.Rr&&this.JEh();this.Rr&&this.wwd&&(He.a.removeHandler(this.Rr,"keydown",this.wwd),this.wwd=null);
this.Rr&&this.vwd&&(He.a.removeHandler(this.Rr,"scroll",this.vwd),this.vwd=null);this.Rr=null;this.ZW&&this.Wyd&&(He.a.removeHandler(this.ZW,"keydown",this.Wyd),this.Wyd=null);this.ZW&&this.Xyd&&(He.a.removeHandler(this.ZW,"keypress",this.Xyd),this.Xyd=null);this.ZW&&this.Yyd&&(He.a.removeHandler(this.ZW,"paste",this.Yyd),this.Yyd=null);this.ZW=null;this.Drc&&this.uwd&&(He.a.removeHandler(this.Drc,"click",this.uwd),this.Drc=this.uwd=null);this.tze=this.xze=this.sze=this.dXa=this.cXa=this.wze=this.muc=
this.uze=this.Kab=this.vze=this.vWb=this.zwd=this.ywd=this.vIe=this.uIe=this.xnd=this.wnd=this.f_b=this.SVe=this.ePe=null;this.WYa&&(this.WYa.dispose(),this.WYa=null);super.dispose()}KL(){super.KL();document.getElementById(this.qj("WACDialogPanel")).style.width=String.format("{0}px",656)}search(b){this.$Pb(b,!1,this.f5i)}$Pb(b,h,r){this.DBa=this.Lvb=0;this.JEh();if(this.bO&&b===this.Nbh&&this.cPe===h)window.setTimeout(this.MTh,500);else{this.bO&&(Array.clear(this.bO),this.bO=null);this.Nbh=b;this.cPe=
h;var B=new Sys.StringBuilder('<search xmlns="urn:schema-microsoft-com:office:office">');B.append("<query>");B.append(F.a.zf(b));B.append("</query>");B.append("<mediatype>Illustration</mediatype>");B.append("<mediatype>Photo</mediatype>");B.append("<filetype>jpg</filetype>");B.append("<filetype>jpeg</filetype>");B.append("<filetype>gif</filetype>");B.append("<filetype>bmp</filetype>");B.append("<filetype>tif</filetype>");B.append("<filetype>tiff</filetype>");B.append("<filetype>png</filetype>");B.append("</search>");
b=v.AFrameworkApplication.lcid.toString(16).toUpperCase();for(let P=b.length;4>P;P++)b="0"+b;v.AFrameworkApplication.He.mj(String.format("{0}OfficeOnlineProxy.ashx?lidhelp={1}&liduser={1}&lidui={1}&{2}={3}",Eb.App.webServiceBase,b,Xg.a.hzo,h.toString()),2,B.toString(),{"Content-Type":"text/xml; charset=utf-8"},!0,2,r,this.onError,null)}}gco(b){this.$Pb(b.assetId,!0,this.f5i);this.bO||(this.bO=[],this.bO.push(b))}uOh(b){const h=document.createElement("img");h.classList.add("ClipartThumbImage");h.setAttribute("src",
b.thumbnailUrl);b=b.displayName?b.displayName:Box4Intl.Box4Strings.l_ClipartImageAltNoCaption;h.setAttribute("title",b);h.setAttribute("alt",b);He.a.addHandler(h,"click",this.ePe);He.a.addHandler(h,"error",this.SVe);return h}Bll(b){1===b.childNodes.length&&(b=b.childNodes[0],He.a.removeHandler(b,"click",this.ePe),He.a.removeHandler(b,"error",this.SVe))}b4i(b){const h=this.bO[b];var r=h.GHn;this.HEh();this.f_b=this.ysn;var B=document.createElement("img");B.setAttribute("src",r);if(h.displayName)r=
String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltWithCaption,h.displayName);else{r=new Sys.StringBuilder;for(let P=0;P<h.keywords.length&&5>P;P++)P&&r.append(", "),r.append(h.keywords[P]);r=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltNoCaption,r.toString())}B.setAttribute("title",r);B.setAttribute("alt",r);He.a.addHandler(B,"error",this.f_b);this.vWb.appendChild(B);B=document.getElementById("clip"+this.Lvb);B.classList.remove("ClipartSelectedImage");B=document.getElementById("clip"+
b);B.classList.add("ClipartSelectedImage");this.Lvb=b;h.displayName&&(this.vze.innerText=h.displayName);b=document.createElement("a");b.innerText=Box4Intl.Box4Strings.l_ClipartSeeSimilarLink;b.setAttribute("href",'""');He.a.addHandler(b,"click",this.ywd);He.a.addHandler(b,"keydown",this.zwd);this.Kab.appendChild(b);this.uze.innerText=String.format("{0} | {1} | {2}",h.dimensions,h.n7n,h.fileSize);(b=h.kAk)&&h.$rh?(this.muc.parentNode.style.display="block",this.sze.innerText=h.$rh,this.muc.appendChild(b)):
this.muc.parentNode.style.display="none";this.wze.appendChild(h.uPn);dc.a.U_(this.cXa);if(b=h.AIk)this.cXa.appendChild(b),"a"===b.nodeName.toLowerCase()&&(He.a.addHandler(b,"click",this.wnd),He.a.addHandler(b,"keydown",this.xnd));this.dXa.innerText=Box4Intl.Box4Strings.l_ClipartKeywords;for(b=0;b<h.keywords.length;b++)B=h.keywords[b],r=document.createElement("a"),r.innerText=B,r.setAttribute("href",'""'),He.a.addHandler(r,"click",this.uIe),He.a.addHandler(r,"keydown",this.vIe),this.dXa.appendChild(r),
b<h.keywords.length-1&&(B=document.createElement("span"),B.innerText=", ",this.dXa.appendChild(B));this.xze.innerText=Box4Intl.Box4Strings.l_ClipartRating;this.tze.innerText=Box4Intl.Box4Strings.l_ClipartProvidedBy;this.ora(1,!0)}HEh(){this.vWb&&1===this.vWb.childNodes.length&&(this.f_b&&(He.a.removeHandler(this.vWb.childNodes[0],"error",this.f_b),this.f_b=null),dc.a.U_(this.vWb));this.cXa&&0<this.cXa.childNodes.length&&"a"===this.cXa.childNodes[0].nodeName.toLowerCase()&&(this.wnd&&He.a.removeHandler(this.cXa.childNodes[0],
"click",this.wnd),this.xnd&&He.a.removeHandler(this.cXa.childNodes[0],"keydown",this.xnd));this.Kab&&0<this.Kab.children.length&&"a"===this.Kab.children[0].nodeName.toLowerCase()&&(this.ywd&&He.a.removeHandler(this.Kab.children[0],"click",this.ywd),this.zwd&&He.a.removeHandler(this.Kab.children[0],"keydown",this.zwd),dc.a.U_(this.Kab));if(this.dXa){for(let b=0;b<this.dXa.childNodes.length;b++){const h=this.dXa.childNodes[b];"a"===h.nodeName.toLowerCase()&&(He.a.removeHandler(h,"click",this.uIe),He.a.removeHandler(h,
"keydown",this.vIe))}dc.a.U_(this.dXa)}this.vze.innerText="";this.uze.innerText="";dc.a.U_(this.muc);dc.a.U_(this.wze);dc.a.U_(this.cXa);this.dXa.innerText="";this.sze.innerText="";this.xze.innerText="";this.tze.innerText=""}Kij(b){if(!(this.Rr.children.length<=b||0>b)){var h=this.Rr.children[b],r=this.Rr.children[0];r=r.clientHeight-r.children[0].clientHeight+2;this.Rr.scrollTop+this.Rr.clientHeight<h.offsetTop+h.clientHeight?this.Rr.scrollTop=h.offsetTop-3*h.clientHeight-r:this.Rr.scrollTop>h.offsetTop&&
(this.Rr.scrollTop=h.offsetTop-r/2);this.b4i(b)}}validate(){return!0}JEh(){if(pc.FocusManager.lK()){var b=pc.FocusManager.instance().getRegion(this.gL);b&&b.hk.gz(this.ZW)}else this.ZW.focus();for(b=0;b<this.Rr.childNodes.length;b++){const h=this.Rr.childNodes[b];1===h.childNodes.length&&this.Bll(h.childNodes[0])}dc.a.U_(this.Rr);this.HEh();this.ora(1,!1);this.WYa=new so.a(Box4Intl.Box4Strings.l_ClipartSearching);this.WYa.$Ci=!1;this.Rr.appendChild(this.WYa.element);this.Rr.classList.add("ClipartSearchInProgress")}wdg(b){this.DBa=
b;b=this.Rr.children[this.DBa];pc.FocusManager.lK()?pc.FocusManager.instance().getRegion(this.gL).hk.gz(b):b.focus()}static get qP(){return fm.Vj=fm.Vj||Ma.a.instance.resolve("Box4.Images.IImageEditor")}}fm.Vj=null;Object(m.a)(fm,"InsertClipartDialog",Pe.a,[]);class kp extends Pk{constructor(b,h,r,B,P,ca){super(b,h,r,B,P,ca,!1);this.fsn=ra=>{if(this.BSm()){var Qa=this.Ef.Yi(),tb=Qa.contentReplicator.Pu.toString(),Mb=new Sys.Net.WebRequest;Mb.set_url("ClipArtUpload.ashx");Mb=new Sys.StringBuilder(Mb.getResolvedUrl());
this.mX(Mb,Xg.a.assetId,ra.assetId,!0);this.mX(Mb,fi.a.lcid,v.AFrameworkApplication.lcid.toString());this.mX(Mb,fi.a.nodeId,this.lH?this.lH.id.toString():this.Ef.id.toString());this.mX(Mb,fi.a.cellId,Qa.Gm.toString());this.mX(Mb,fi.a.fileId,Qa.zr);this.mX(Mb,fi.a.Yua,tb);this.mX(Mb,fi.a.JX,this.Yl.toString());ra=this.Ef.ja(lh.a.QJ,ie.a.Pt);this.mX(Mb,fi.a.QJ,ra.toString());this.mX(Mb,fi.a.jsb,"1");Qa.TH&&this.mX(Mb,fi.a.TH,Qa.TH);this.mX(Mb,fi.a.classId,this.lH?this.lH.properties.Qc.toString():this.Ef.Qc.toString());
this.Yg.hasProperty(Mc.a.imageType)&&this.mX(Mb,Xg.a.imageType,this.Yg.getValue(Mc.a.imageType).toString());Gh.a.instance.ewk(Mb);v.AFrameworkApplication.He.mj(Mb.toString(),2,"",{},!1,2,this.k0o,this.HIj,null);Pk.zgc++}};this.k0o=ra=>{if(({group:Qa}=kl.a.d2(ra.data.se)).returnValue){var Qa=Qa.Responses[0];Qa.kpb=ra.data.$H;Qa.Wr=ra.data.Dj?ra.data.Dj[ei.a.$Q]:"";this.Kea(Qa)}else this.HIj(null)};this.HIj=()=>{const ra=new Cd.a;ra.StatusCode=14;this.Kea(ra)};new fm(this)}Rza(b){this.gYd()&&this.Ef.Yi().contentReplicator.forceOutbound(this.fsn,
null,b)}mX(b,h,r,B){b.append(B?"?":"&");b.append(F.a.Gj(h));b.append("=");b.append(F.a.Gj(r))}mjf(b){switch(b){case 26:return Box4Intl.Box4Strings.l_ClipartCannotConnect;case 27:return Box4Intl.Box4Strings.l_ClipartCannotDownload;default:return super.mjf(b)}}Kea(b){super.Kea(b);Pk.zgc--}}Object(m.a)(kp,"ClipartUploader",Pk,[]);var yc=c(12);class td{constructor(b,h,r){this.kDm=(B,P,ca,ra,Qa)=>{if(!this.Vj||!this.Vj.value)return t.ULS.sendTraceTag(524109267,306,15,"ImageEditor not available"),8;B=this.Vj.value.Hga(P);
return 2===ca&&B?(new kp(P,Wg.a.instance,v.AFrameworkApplication.K,Qa,this.Qm,this.ga),32):1===ca?B&&Eb.App.CFh?32:8:2};this.Vj=b;this.Qm=h;this.ga=r}Tb(){this.ga.fb(Nb.a.Jsi,yc.a.view,this.kDm,260)}}Object(m.a)(td,"ClipArtActor",null,[]);class kk{constructor(){this.W=null}get name(){return"Box4.ClipArt"}wc(b){this.W=b;b.ia("Box4.ClipArt.ClipArtActor",()=>new td(b.Ve("Box4.Images.IImageEditor"),b.resolve("Box4.IUndoManager"),v.AFrameworkApplication.va)).ha()}init(){this.W.resolve("Box4.ClipArt.ClipArtActor").Tb();
const b=Eb.App.za;b&&b.updateCommandUI()}dispose(){}}Object(m.a)(kk,"ClipartPackage",null,[1,2]);class jo{constructor(b){this.sZa=this.dZa=this.xZa=this.wZa=null;this.oYg=this.WSg=this.pYg=this.n4g=this.Zh=this.Qaa=!1;this.CQe=this.T4g=null;this.D4g=0;this.Ca=this.O4g=null;this.kfa=b;this.LN=3;this.dYb=!0}initialize(b,h,r){this.wZa=this.ruf(b,h);this.xZa=CommonUIStrings.l_SavingStatus;this.dZa=CommonUIStrings.l_ReadOnlyStatus;this.sZa=CommonUIStrings.l_ReviewModeStatus;this.kfa&&this.kfa.execute(B=>
{B.Teb(Object(z.a)(this,this.Odd,"updateToSavingStatus"))});this.Zh=!0;this.Ca=r;this.WSg=this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIcons",!1);return!0}Wrb(b,h){this.Qaa=b;this.LN=h;this.GVa(this.dYb)}GVa(b){!this.dYb&&b&&(this.O4g=new Date);this.dYb=b;this.oYg=!1;b=null;3===this.LN&&(b=this.dYb?this.wZa:this.xZa);this.Spl(b)}ruf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,
h):CommonUIStrings.l_SavedStatus}Odd(){this.GVa(!1)}b5l(){switch(this.LN){case 1:return this.dZa;case 2:return this.sZa;default:return null}}a5l(){if(3!==this.LN)switch(this.LN){case 1:return"ReadOnly";case 2:return"ReviewOnly";default:return null}return this.oYg?"FailedToSave":this.dYb?"Saved":"Saving"}BLm(b){return this.n4g===this.Qaa&&this.D4g===this.LN&&this.T4g===b}Xff(b){appChrome.getHeaderApi().then(h=>{h.updateDocumentTitleStatus(this.Qaa,b,this.b5l(),this.O4g,this.dYb,this.WSg?h.getHeaderSaveStatusIconProps(this.a5l()):
null);this.pYg=!0;return null});this.CQe=null}Spl(b){this.Zh&&Hh.c()&&!this.BLm(b)&&(!this.pYg&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.Xff(b):Qd.a.see()?(this.CQe&&t.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.CQe=window.requestIdleCallback(()=>{this.Xff(b)})):window.requestAnimationFrame(()=>{this.Xff(b)}),this.n4g=this.Qaa,this.T4g=b,this.D4g=this.LN)}}Object(m.a)(jo,"ReactSaveStatusUIHandler",
null,[550]);class cq{constructor(b,h){this.pY=null;this.wZa=CommonUIStrings.l_SavedStatus;this.xZa=CommonUIStrings.l_SavingStatus;this.dZa=CommonUIStrings.l_ReadOnlyStatus;this.sZa=CommonUIStrings.l_ReviewModeStatus;this.Dbb=h;this.kfa=b;this.LN=3;this.Fdb=!0}fC(){this.kfa&&this.kfa.execute(b=>{b.Teb(Object(z.a)(this,this.Odd,"updateToSavingStatus"))});this.Dbb.execute(b=>{this.pY=b})}Wrb(b,h){this.LN=h;3===h?this.GVa(this.Fdb):2===h?this.rog(this.sZa):this.rog(this.dZa)}Odd(){this.GVa(!1)}GVa(b){this.Fdb=
b;this.rog(this.Fdb?this.wZa:this.xZa)}rog(b){this.pY&&this.pY.sendMessage(M.a.fRo,this.V4k(b))}V4k(b){const h={};h.StatusText=b;return h}}Object(m.a)(cq,"SaveStatusPostMessageHandler",null,[550]);var vl=c(219),Sm=c(143);class $o{constructor(b,h,r,B){this.sZa=this.dZa=this.xZa=this.wZa=null;this.cxb=0;this.n_=this.LRe=this.$sb=this.Pte=this.eWe=null;this.ng=b;this.xbb=h;this.kfa=r;this.om=B;this.n1g=!0;this.Qaa=!1;this.LN=3;this.Fdb=!0}initialize(b,h){if(!this.ng)return!1;this.wZa=this.ruf(b,h);this.xZa=
CommonUIStrings.l_SavingStatus;this.dZa=CommonUIStrings.l_ReadOnlyStatus;this.sZa=CommonUIStrings.l_ReviewModeStatus;this.fC();return!0}ruf(b,h){return b?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):h&&h.length?String.format(CommonUIStrings.l_SavedToStatus,h):CommonUIStrings.l_SavedStatus}fC(){this.xbb&&this.xbb.execute(b=>{b.Ryk(Object(z.a)(this,this.bOh,"createStatusAndModeElements"));b.Byk(Object(z.a)(this,this.dxo,"showHideSaveStatusElement"));b.gMo&&this.bOh(null,
null)});this.kfa&&this.kfa.execute(b=>{b.Teb(Object(z.a)(this,this.Odd,"updateToSavingStatus"))})}o6(){this.n_&&this.ng&&this.ng.kAa(this.n_)}dxo(b,h){this.Wrb("true"===h,this.LN)}Wrb(b,h){this.Qaa=b;this.LN=h;this.Pte&&(this.Pte.style.display=this.Qaa||3===this.LN||!this.eWe?"none":"");this.$sb&&(this.$sb.style.display=this.Qaa||3===this.LN?"none":"",this.$sb.innerText=1===this.LN?this.dZa:this.sZa,this.$sb.title=1===this.LN?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);
this.LRe&&(this.LRe.style.display=this.Qaa||1===this.LN||!this.eWe&&!this.$sb?"none":"");this.n_&&(this.n_.style.display=this.Qaa||1===this.LN?"none":"",this.GVa(this.Fdb),this.n_.title=CommonUIStrings.l_SaveStatusTooltip)}bOh(b,h){b=document.getElementById(vl.CuiHelper.Jtm);h&&h.N4o||!b||""===this.wZa||""===this.xZa||""===this.dZa||""===this.sZa||(this.eWe=document.getElementById(vl.CuiHelper.r5e),this.Pte=vl.CuiHelper.eJd(b,"BreadcrumbAppModeDash","-"),this.$sb=vl.CuiHelper.eJd(b,"BreadcrumbAppModeStatus",
1===this.LN?this.dZa:this.sZa),this.VFj(this.$sb),this.LRe=vl.CuiHelper.eJd(b,"BreadcrumbSaveStatusDash","-"),this.n_=vl.CuiHelper.eJd(b,"BreadcrumbSaveStatus",this.wZa),this.VFj(this.n_),this.Wrb(this.Qaa,this.LN))}Odd(){this.GVa(!1)}GVa(b){this.Fdb=b;this.BZo(this.Fdb?this.wZa:this.xZa)}BZo(b){!this.n_||3!==this.LN&&2!==this.LN||(this.n1g&&!this.Fdb?(this.cxb=this.n_.offsetWidth<this.cxb?this.cxb:this.n_.offsetWidth,this.YTo(this.xZa),this.n1g=!1):this.n_.innerText=b)}VFj(b){b.style.direction=this.om?
"rtl":"ltr";b.style.width="auto";b.style.textAlign=this.om?"right":"left";b.style.display=this.Qaa?"none":"";b.setAttribute("Unselectable","on")}YTo(b){this.n_&&(this.n_.style.width="",this.n_.innerText=b,this.cxb=this.n_.offsetWidth<this.cxb?this.cxb:this.n_.offsetWidth,b=Sm.a.AB(this.n_),this.n_.style.width=this.cxb-dc.a.iN(b.paddingLeft)-dc.a.iN(b.paddingRight)+1+"px")}}Object(m.a)($o,"SaveStatusUIHandler",null,[550]);var to=c(94);class yl{constructor(){this.MRe=this.PPe=this.qNa=this.W=null}get name(){return"Common.App.SaveStatus"}wc(b){this.W=
b;v.AFrameworkApplication.K.$("PostMessageEmbedded")&&v.AFrameworkApplication.nY?this.W.register(cq,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ha().Ud(()=>new cq(this.W.Ta("Common.App.HostNotification.EditNotificationEventSource"),this.W.Ta("Postmessage.IHostPostmessenger"))):v.AFrameworkApplication.ua.Kb.qIf||(v.AFrameworkApplication.ua.Kb.MJ?this.W.register(jo,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ha().Ud(()=>
new jo(this.W.Ta("Common.App.HostNotification.EditNotificationEventSource"))):this.W.register($o,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ha().Ud(()=>new $o(to.EventHandlerManager.instance,this.W.Ta("Common.App.Header.HeaderEventSource"),this.W.Ta("Common.App.HostNotification.EditNotificationEventSource"),v.AFrameworkApplication.isRtl)))}init(){v.AFrameworkApplication.K.Nn(Object(z.a)(this,this.Xx,"onFullAppSettingsReady"))}Xx(){const b=v.AFrameworkApplication.K,
h=!!v.AFrameworkApplication.ua.Kb&&4===v.AFrameworkApplication.ua.Kb.yk;if(b.$("WordEditorAutoSaveImprovementIsEnabled")||b.$("PptEditorSaveStatusInHeaderEnabled")||h&&b.$("SimplifiedReactRibbonUxIsEnabled")||b.$("ExcelSaveStatusInHeaderEnabled")||b.$("VisioSaveStatusInHeaderEnabled"))v.AFrameworkApplication.K.$("PostMessageEmbedded")&&v.AFrameworkApplication.nY?(this.MRe=this.W.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.MRe.fC():v.AFrameworkApplication.ua.Kb.qIf||v.AFrameworkApplication.hideHeader||
(v.AFrameworkApplication.ua.Kb.MJ?(this.PPe=this.W.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.PPe.initialize(b.$("IsSkyDrive"),b.kb("HostNameToIncludeInSavedStatus"),v.AFrameworkApplication.K):(this.qNa=this.W.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.qNa.initialize(b.$("IsSkyDrive"),b.kb("HostNameToIncludeInSavedStatus")))}dispose(){this.qNa&&this.qNa.o6()}}Object(m.a)(yl,"PackageManager",null,[1,2]);var Tm=c(1672);class Wn{get name(){return"Common.App.EventsCachePackage"}wc(){}init(){Tm.a.instance.init()}dispose(){}static main(){L.a.instance.Gc(new Wn)}}
Object(m.a)(Wn,"EventsCachePackage",null,[1,2]);var ij=c(133),Dh=c(165),yn=c(89),pj=c(627),qg=c(309),fl=c(448),gm=c(288),nf=c(25),ll=c(245),qf=c(24);class Ug{constructor(b){this.v0g=!1;this.rgd=this.xm=null;this.Nse=!1;this.zE=b}get control(){return this.zE}get Sd(){return this.control.Sd}get root(){return this.control.root}get iI(){return this.control.iI}get p_a(){return this.control.p_a}get wk(){return this.control.wk}get dF(){return this.control.dF}dJ(){}initialize(){}gx(b,h,r){this.control.Nql(b,
h,r)}Hm(){nf.c(this.control.Jh.Command)||this.wu(this.control.Jh.Command,null,null)}wu(b,h,r){let B=0;this.root&&(B=this.root.Oqa(b,h,r));this.control.enabled=0<(B&1);return B}v9a(){let b=this.control.visible;this.root.YUa&&(b=this.Sd[ll.a.visible],b!==this.control.visible&&(this.control.visible=b,this.root.jgc=!0));return b}Ppg(){const b=qf.a.bsa(this.Sd[ll.a.labelText],this.control.Jh.LabelText);this.fhe(b)}fhe(b){this.control.labelText!==b&&(this.dF.forEach(h=>{h.fhe(b)}),this.control.labelText=
b,this.root.S5a=!0)}YSb(){const b=qf.a.bsa(this.Sd[ll.a.alt],this.control.Jh.Alt);this.ulc(b)}ulc(b){this.control.tooltip!==b&&(this.dF.forEach(h=>{h.ulc(b)}),this.control.tooltip=b)}Ika(){const b=qf.a.bsa(this.Sd[pj.a.Image16by16Class],this.control.Jh.Image16by16Class),h=qf.a.bsa(this.Sd[pj.a.Image32by32Class],this.control.Jh.Image32by32Class);var r=qf.a.bsa(this.Sd[pj.a.Image48by48Class],this.control.Jh.Image48by48Class);r=nf.b(r)?h:r;this.IGc(this.dF.small,b);this.IGc(this.dF.medium,b);this.IGc(this.dF.large,
h);this.IGc(this.dF.gAo,b);this.IGc(this.dF.Kec,r)}IGc(b,h){!b||nf.c(b.iR)||nf.c(h)||b.iR.className===h||(b.iR.className=h)}MVo(b){if(!nf.b(b)&&this.root.rkg){for(const h of this.control.T9e){const r=h.kU===b;r&&(this.control.kZe=h);this.control.visible&&(h.$A=r)}this.control.visible&&(this.root.S5a=!0)}}DAk(){if(this.dF.Kec&&this.dF.Kec.UO&&this.dF.Kec.Ahb){const b=this.dF.Kec.UO,h=qf.a.bsa(this.Sd[qg.a.Description],this.control.Jh.Description);nf.b(h)&&(b.style.position="relative",b.style.top=(b.parentNode.offsetHeight-
b.offsetHeight)/2+"px",b.style.padding="0px")}}onFocus(){const b=this.wk;Object(Ib.a)(fl.a,b)?this.iI.Qrb(b):this.root.QCb=this.control;return!1}onBlur(){const b=this.wk;this.control.XJb()&&qf.a.Ew(b.Nc,"cui-ctl-menu-hovered-without-focus");this.root.QCb=null;return!1}KP(b){if(this.control.XJb()){var h=this.iI.Fra;const r=h===this.root.FLb-1;h=r?null:this.root.eD[h+1];this.M8e(!1);r||this.control===h||qf.a.Ew(h.IKb,gm.MenuLauncher.B0c);this.control.enabled&&this.control.Mu?r?this.control.kZ():(qf.a.ag(this.wk.Nc,
"cui-ctl-menu-hovered-without-focus"),h.jha=this.control.Mu):r?this.iI.setFocus(b.kg):(h.jha=this.iI.Nc,this.iI.bra())}return!1}SJ(){this.control.XJb()&&qf.a.Ew(this.wk.Nc,"cui-ctl-menu-hovered-without-focus");return!1}onKeyDown(b){let h=!1;if(!nf.c(b.Hb)&&!nf.c(b.Hb.rawEvent)){const r=b.Hb.keyCode;b=b.Hb.rawEvent.shiftKey;r===Sys.UI.Key.enter&&(h=!0);if(Object(Ib.a)(fl.a,this.wk)){const B=this.iI;if(!nf.c(B)){const P=B.Fra,ca=0===this.root.U1,ra=!nf.c(this.control.EAn);if(r!==Sys.UI.Key.tab&&r!==
Sys.UI.Key.left&&r!==Sys.UI.Key.right&&r!==Sys.UI.Key.up&&r!==Sys.UI.Key.down&&r!==Sys.UI.Key.esc)return h;Qd.a.n8e();r!==Sys.UI.Key.tab||b?r===Sys.UI.Key.tab&&b?(B.eL(1),h=!0):r===Sys.UI.Key.left&&ca||r===Sys.UI.Key.right&&!ca?(ra?B.eL(2):0<P&&this.root.v0a(P,!0,!1),h=!0):r===Sys.UI.Key.right&&ca||r===Sys.UI.Key.left&&!ca?(ra&&B.eL(4),h=!0):r===Sys.UI.Key.up?(B.eL(5),h=!0):r===Sys.UI.Key.down?(B.eL(6),h=!0):r===Sys.UI.Key.esc&&(this.root.v0a(P,!0,!1),h=!0):(B.eL(0),h=!0)}}}return h}Uy(b){let h=!1;
if(!nf.c(b.Hb)&&!nf.c(b.Hb.rawEvent)){const r=b.Hb.keyCode;Jb.KeyInputManager.Gni(b)||r!==Sys.UI.Key.enter&&r!==Sys.UI.Key.space||(h=this.hyf(b),h||(this.gx(b.yf,1,b.Hb),h=!0))}return h}gD(b){this.H9e();if(this.p_a){let h=!0;2===b.kg&&(h=b.zda===Sys.UI.MouseButton.leftButton);h&&this.wk&&this.nBd(this.wk.Nc)}(b.Hb.type.toLowerCase()!==pd.a.cQ||this.p_a)&&b.Hb.preventDefault();return!1}get TDf(){return this.v0g}mvl(){this.v0g=!0}H9e(){this.TDf&&this.control.root.kgb()}Cya(b){Object(Ib.a)(fl.a,this.wk)&&
!this.p_a&&2===b.kg&&b.zda===Sys.UI.MouseButton.leftButton?(this.gx(b.yf,b.kg,b.Hb),b=!0):b=this.control.Qva(b);return b}onClick(b){let h=!1;Object(Ib.a)(fl.a,this.wk)&&!this.p_a&&3===b.kg&&(this.gx(b.yf,b.kg,b.Hb),h=!0);return Z.a.vi?!1:h}$nb(b){return this.G6d(b)}LHa(b){this.Qva(b);return!1}G6d(b){return nf.c(this.xm)?!1:(this.Kcg(Qd.a.s0d(this.Jnh,b.clientPoint)),!0)}Sgc(b){let h=!1;this.Qva(b)&&(h=!0);3!==b.kg&&(b=!0,!this.root&&Ug.tUf&&(t.ULS.sendTraceTag(588084884,207,50,"Root is null"),b=!1),
b&&this.root.e4(),h=!0);return h}Vgc(b){return this.Qva(b)}Tgc(b){return this.G6d(b)}Ugc(b){return this.Qva(b)}Qgc(b){return 3===b.kg?(this.root.e4(),!0):!1}Rgc(){return!1}get Jnh(){!nf.c(this.xm)&&nf.c(this.rgd)&&(this.rgd=Qd.a.getElementBounds(this.xm));return this.rgd}Kcg(b){this.Nse!==b&&(this.Nse=b,this.lZe(this.Nse))}lZe(b){nf.c(this.xm)||qf.a.j6(this.xm,yn.Control.qBd,b)}nBd(b){this.control.enabled&&(this.xm=b,this.root.DFc=this.control,this.Kcg(!0),this.root.Cga(this.control,!1))}Qva(b){if(!nf.c(this.xm)){this.Kcg(!1);
let h=!!this.root;if(Ug.tUf){const r=cd.ActionManager.yba(parseInt(this.control.Jh.Command))||"";t.ULS.sendTraceTag(588084885,207,50,"Root not null: {0}, Action: {1}",h,r)}h&&this.root.jca(this.control,!1);nf.c(b)||Qd.a.s0d(this.Jnh,b.clientPoint)&&this.gx(this.xm,b.kg,b.Hb);h=!!this.root;Ug.tUf&&t.ULS.sendTraceTag(588084886,207,50,"Root not null: {0}",h);h&&(this.root.DFc=null);this.rgd=this.xm=null;return!0}return!1}eL(b){return Object(Ib.a)(fl.a,this.wk)&&2!==b&&4!==b&&!Qd.a.Xbc(this.control.Mu)?
this.kZ():!1}kZ(){try{if(this.control.visible){const b=this.control.Mu;if(!nf.c(b))return b.focus(),!0}}catch(b){}return!1}M8e(b){const h=this.iI;nf.c(h)||this.root.v0a(h.Fra+1,b)}vqa(){}hyf(){return!1}gY(b){let h=null;b&&b.rawEvent&&(h={},h[Ug.triggerTime]=b.rawEvent.timeStamp);return h}static get tUf(){null==Ug.TLe&&(Ug.TLe=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("NullCheckRootInOnModalBodyPointerDownIsEnabled"));return Ug.TLe}}Ug.triggerTime="TriggerTime";Ug.TLe=null;Object(m.a)(Ug,
"ControlBehavior",null,[577]);var On=c(186);class dn extends Ug{constructor(b){super(b)}get button(){return this.control}get properties(){return this.control.Jh}dJ(b){const h=b.Ym;b=b.kU;nf.c(h)||(Sd.a.instance.ob(pd.a.focus,h,Object(z.a)(this,this.onFocus,"onFocus")),Sd.a.instance.ob(pd.a.blur,h,Object(z.a)(this,this.onBlur,"onBlur")),Dh.a.instance.ob(pd.a.pointerOver,h,Object(z.a)(this,this.KP,"onPointerOver")),Dh.a.instance.ob(pd.a.pointerOut,h,Object(z.a)(this,this.SJ,"onPointerOut")),Jb.KeyInputManager.instance.nE(pd.a.gi,
h,Object(z.a)(this,this.onKeyDown,"onKeyDown"),b),Jb.KeyInputManager.instance.nE(pd.a.ru,h,Object(z.a)(this,this.XG,"onKeyPress"),b),Jb.KeyInputManager.instance.nE(pd.a.yh,h,Object(z.a)(this,this.Uy,"onKeyUp"),b),Dh.a.instance.ob(pd.a.pointerDown,h,Object(z.a)(this,this.gD,"onPointerDown")),Dh.a.instance.ob(pd.a.jN,h,Object(z.a)(this,this.Cya,"onPointerUp")),ii.a.instance.ob(pd.a.click,h,Object(z.a)(this,this.onClick,"onClick")),On.a.instance.ob(pd.a.bQ,h,Object(z.a)(this,this.$nb,"onTouchMove")),
On.a.instance.ob(pd.a.hK,h,Object(z.a)(this,this.LHa,"onTouchEnd")))}gx(b,h,r){this.control.enabled&&(b=null,this.wk&&this.wk.lXc()&&this.iI&&(b=this.root.eD[this.iI.Fra])&&!this.TDf&&(b.iUa(this.button),b=null),this.executeCommand(this.control.Jh.Command,h,!0,r),b&&b.iUa(this.button))}executeCommand(b,h,r,B){if(!nf.c(b)){const P=this.Sd;P.CommandValueId=this.button.OFb();P.MenuItemId=this.button.Jh.MenuItemId;P.SourceControlId=this.control.id;this.root.executeCommand(b,P,this.wk,h,r,null,this.gY(B))}}Hm(){nf.c(this.control.Jh.Command)||
0<(this.wu(this.properties.Command,this.properties.QueryCommand,this.Sd)&2)&&this.v9a()&&this.DVa()}DVa(){this.Ppg();this.YSb();this.Ika()}onFocus(b){super.onFocus(b);this.ljg();return!1}onBlur(b){super.onBlur(b);this.mif();return!1}onKeyDown(b){let h=super.onKeyDown(b);nf.c(b.Hb)||this.Xfg(b.Vo,b.Hb.keyCode)&&(h=!1);return h}XG(b){let h=!1;nf.c(b.Hb)||nf.c(b.Hb.rawEvent)||(this.Xfg(b.Vo,b.Hb.rawEvent.keyCode)?(this.gx(b.yf,b.kg,b.Hb),h=!0):b.Hb.preventDefault());return h}Xfg(b,h){if(Z.a.gt&&h===
Sys.UI.Key.enter)switch(b){case "MenuMru":case "MenuTemplate":case "MenuHeader":case "MenuFooter":return!0}return!1}Uy(b){let h=!1;nf.c(b.Hb)||this.Xfg(b.Vo,b.Hb.keyCode)||(h=super.Uy(b));return h}ljg(){this.control.enabled&&this.executeCommand(this.properties.CommandPreview,0,!1,null)}mif(){this.control.enabled&&this.executeCommand(this.properties.CommandRevert,0,!1,null)}}Object(m.a)(dn,"ButtonBehavior",Ug,[]);var la=c(997);class cb{}cb.Color="Color";cb.IndexColorSelected="ColorSelected";Object(m.a)(cb,
"ColorPickerCommandProperties",null,[]);class vb extends Ug{constructor(b){super(b);this.TCc=this.Cv=-1}get yCb(){return this.control}get EOa(){return this.yCb.Q0k.EOa}get properties(){return this.yCb.Jh}gx(b,h,r){if(this.control.enabled){const B=this.Sd;B.Color=vb.dTd(b)[la.ColorPicker.aHd];b=null;qf.a.hs(this.properties.Stateful)&&this.wk&&this.wk.lXc()&&this.iI&&(b=this.root.eD[this.iI.Fra]);this.root.executeCommand(this.properties.Command,B,this.wk,h,!0,null,this.gY(r));b&&b.iUa(this.yCb)}}Hm(){var b=
this.Sd;b.SourceControlId=this.properties.Id;if(0<(this.wu(this.properties.Command,this.properties.QueryCommand,b)&2)&&(b=-1,cb.IndexColorSelected in this.Sd&&(b=this.Sd[cb.IndexColorSelected]),b!==this.TCc)){const h=this.EOa;0<=b&&b<h.length&&this.jFj(h[b],!0);0<=this.TCc&&this.TCc<h.length&&this.jFj(h[this.TCc],!1);this.TCc=b}}jFj(b,h){h?qf.a.ag(b,"cui-colorpicker-selected"):qf.a.Ew(b,"cui-colorpicker-selected")}dJ(b){for(let h=0;h<b.RYe.length;++h){const r=b.RYe[h];Sd.a.instance.ob(pd.a.focus,
r,Object(z.a)(this,this.NVf,"onCellFocus"));Sd.a.instance.ob(pd.a.blur,r,Object(z.a)(this,this.emn,"onCellBlur"));Jb.KeyInputManager.instance.ob(pd.a.gi,r,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Jb.KeyInputManager.instance.ob(pd.a.yh,r,Object(z.a)(this,this.Uy,"onKeyUp"));ii.a.instance.ob(pd.a.click,r,Object(z.a)(this,this.fmn,"onCellClick"));Dh.a.instance.ob(pd.a.jN,r,Object(z.a)(this,this.PVf,"onCellPointerUp"));Dh.a.instance.ob(pd.a.pointerOver,r,Object(z.a)(this,this.OVf,"onCellPointerOver"));
Dh.a.instance.ob(pd.a.pointerDown,r,Object(z.a)(this,this.gmn,"onCellPointerDown"))}}NVf(b){b=vb.dTd(b.yf);this.iI.Qrb(this.wk);this.eoe(b,!0);return!0}emn(b){this.eoe(vb.dTd(b.yf),!1);return!0}eoe(b,h){h?(this.Cv=parseInt(b.getAttribute("arrayPosition")),qf.a.ag(b,"cui-colorpicker-hoveredOver"),this.ljg(b)):(this.Cv=-1,this.mif(b),qf.a.Ew(b,"cui-colorpicker-hoveredOver"))}fmn(b){3===b.kg&&this.gx(b.yf,b.kg,b.Hb);return!0}PVf(b){3!==b.kg&&this.gx(b.yf,b.kg,b.Hb);return!0}OVf(b){this.M8e(!1);b=parseInt(vb.dTd(b.yf).getAttribute("arrayPosition"));
this.w9c(b);return!0}gmn(){return!1}ljg(b){if(this.control.enabled){const h=this.properties.CommandPreview;if(!nf.b(h)){const r=this.Sd;r.Color=b[la.ColorPicker.aHd];this.root.executeCommand(h,r,this.wk,0,!1)}}}mif(b){if(this.control.enabled){const h=this.properties.CommandRevert;if(!nf.b(h)){const r=this.Sd;r.Color=b[la.ColorPicker.aHd];this.root.executeCommand(h,r,this.wk,0,!1)}}}eL(b){b=yn.Control.bmf(this.Cv,this.yCb.width,this.EOa.length,b);if(b!==this.Cv&&this.w9c(b))return!0;this.eoe(this.EOa[this.Cv],
!1);return!1}kZ(){return this.w9c(0)}w9c(b){return this.EOa&&this.EOa.length>b&&(b=this.EOa[b],b.firstChild)?(b.firstChild.focus(),!0):!1}vqa(){-1!==this.Cv&&this.eoe(this.EOa[this.Cv],!1)}static dTd(b){return vb.L5l(b)}static L5l(b){var h=["td"];const r=h.length;if(!b)return null;for(var B=0;B<r;B++)if(b.tagName.toLowerCase()===h[B].toLowerCase())return b;for(b=b.parentNode;b;){for(B=0;B<r;B++)if(b.tagName.toLowerCase()===h[B].toLowerCase())return b;b=b.parentNode}return null}}Object(m.a)(vb,"ColorPickerBehavior",
Ug,[]);var ec=c(341),xc=c(296),ad=c(1701),Zd=c(696),pe=c(374),Td=c(1144);class Ie{constructor(b,h){this.vmk=b;this.f0g=h}Oge(b,h,r,B){if(nf.c(b)||nf.c(h))return null;const P=new Td.a;const ca=B.x;var ra=B.y;const Qa=B.width;var tb=B.height;let Mb;Ie.U6b(h,"flyoutWidth");B=Ie.U6b(h,"flyoutRealHeight");const Zb=Ie.U6b(h,"viewportWidth");var jc=Ie.U6b(h,"viewportHeight"),Gc=Ie.U6b(h,"viewableLeft");const Uc=Ie.U6b(h,"viewableTop"),od=this.vmk;let Od=!1,ze=!1;const de=1===r,ee=4===r,je=this.f0g;b.style.maxHeight=
"none";b.style.top="0px";b.style.overflowY="visible";b.style.width="auto";Mb=this.uOi(b);P.pKj=jc;P.Lrg=Zb;if(de)od?h=ca+Qa:(h=ca-Mb,P.lmb=!0),tb=ra;else{var ue="";Qa>Mb&&(Mb=Qa,ue=(Mb-2*pe.Menu.H4d).toString());od?h=ca:(h=ca+Qa-Mb,P.lmb=!0);tb=ra+tb;""!==ue&&(b.style.minWidth=ue+"px")}je&&(tb+=Uc,h+=Gc);b.style.top=tb+"px";b.style.left=h+"px";let Qf=!1;ue=!1;Mb<=Zb?h+Mb>Gc+Zb?(de&&od&&ca-Mb>Gc||ee&&ca-Mb>Gc?(h=ca-Mb,je&&(h+=Gc),ue=P.lmb=!0):(h=Gc+Zb-Mb,Od=!0),Qf=!0):h<Gc&&(de&&!od&&ca+Qa+Mb<Gc+Zb?
(h=ca+Qa,je&&(h+=Gc),P.lmb=!1,ue=!0):(h=Gc,ze=!0,P.lmb=!0),Qf=!0):od?(h=Gc,Qf=!0,P.lmb=!0):(h=Gc+Zb-Mb,Qf=!0,P.lmb=!1);Qf&&(b.style.left=h+"px");P.J8b=tb;tb+B<=Uc+jc&&3!==r||(P.CKf=!0,{Sgn:r,sHl:ra,dNm:jc,fUm:Gc}=this.Blf(r,tb,B,ra,Uc,jc),tb!==r&&(b.style.top=r+"px",P.J8b=r),-1<ra&&(b.style.maxHeight=ra+"px"),jc&&(b.style.bottom="0px",b.style.height="auto"),Gc&&this.X9m(b,od,de,ue,ze,Od,Zb,ca,Qa));P.POc=h;P.Ylf=Mb;P.Ulf=B;return P}Blf(b,h,r,B,P,ca){let ra,Qa,tb;ra=-1;tb=Qa=!1;const Mb=h,Zb=P+ca-h;
h=B-r;const jc=this.f0g;let Gc=!1;0>h&&(h=P);jc||(B-=P);r<=B&&1!==b||(4===b||1===b?r<ca?(h=ca-r,Qa=!0):(h=P,Gc=tb=Qa=!0):(B<Zb&&3!==b?(h=Mb,Qa=!0):ra=B,tb=!0));jc&&(Qa=!1,Gc?ra=ca:h+=P);return{Sgn:h,sHl:ra,dNm:Qa,fUm:tb}}X9m(b,h,r,B,P,ca,ra,Qa,tb){b.style.overflowY="scroll";b.style.width="auto";if(h){if(ca||B)b.style.left="",b.style.right=(ca?0:ra-Qa)+"px"}else P||B||(b.style.left="",b.style.right=(r?ra-Qa:ra-Qa-tb)+"px")}VVl(b){const h={};if(nf.c(b))return h;h.viewportWidth=dc.a.qHb();h.viewportHeight=
dc.a.hY();nf.c(h.viewportWidth)&&(h.viewportWidth=document.documentElement.clientWidth,h.viewportHeight=document.documentElement.clientHeight);nf.c(h.viewportWidth)&&(h.viewportWidth=document.body.clientWidth,h.viewportHeight=document.body.clientHeight);h.viewableTop=window.pageYOffset;h.viewableLeft=window.pageXOffset;nf.c(h.viewableTop)&&(h.viewableTop=document.documentElement.scrollTop,h.viewableLeft=document.documentElement.scrollLeft);nf.c(h.viewableTop)&&(h.viewableTop=document.body.scrollTop,
h.viewableLeft=document.body.scrollLeft);h.flyoutRealHeight=b.scrollHeight!==b.offsetHeight?b.scrollHeight+2*pe.Menu.H4d:b.scrollHeight;const r=b.style.overflowY;b.style.overflowY="visible";h.flyoutWidth=this.uOi(b);b.style.overflowY=r;return h}uOi(b){return b.offsetWidth}static U6b(b,h){return nf.c(b)?0:b[h]}}Object(m.a)(Ie,"MenuPositioner",null,[]);var We=c(511),Vf=c(610),tf=c(1146),yf=c(1145),lf=c(1142),Rk=c(1143),hm=c(1148),Lj=c(386),Bk=c(995);class Zi extends Ug{constructor(b){super(b);this.PKe=
0;this.h4g=null;this.mOe=-1;this.Fkd=null;this.v1f=this.YXg=!1;this.kbk=new Ie(0===this.root.U1,qf.a.hs(this.root.properties.DivSyndicated))}get KOi(){return this.kbk}get Tu(){return this.control}get properties(){return this.control.Jh}get menu(){return this.Tu.menu}set menu(b){this.Tu.menu=b}get wL(){return this.Tu.wL}set wL(b){this.Tu.wL=b}get Zwh(){nf.c(this.Fkd)&&(this.Fkd=Zi.ebl());return this.Fkd}get grj(){let b=!this.root.VAf;Object(Ib.a)(304,this.root)&&1===this.root.FLb&&(b=!0);return b}gx(b,
h){Object(Ib.a)(304,this.root)&&this.root.Gif();this.Tu.U0(h)}U0(b){if(this.Tu.enabled&&!this.wL){var h=Nh.a.instance.Fp(fb.a.U0);h.properties.add("Id",this.Tu.Jh.Id);h.properties.add("InputMethod",ec.a[b]);h.end();kh.a.mark(10326);Qd.a.F4d(this.Tu.Jh.Id,"MenuOpen");this.Tu.Mu&&(this.Tu.jha=Qd.a.Fib(this.Tu.Mu.ownerDocument));this.PKe=b;this.O2i(b);this.cge();this.Tu.m9a(this.Tu.Mu,!0)}}cge(){nf.c(this.properties.PopulateAsyncTriggerCommand)||this.YXg||(this.Cin(),this.YXg=!0)}Cin(){const b={};b[ad.a.Callback]=
Object(z.a)(this,this.j9i,"refreshMenuCallback");this.root.executeCommand(this.properties.PopulateAsyncTriggerCommand,b,this.wk,0,!1)}j9i(){this.Tu.DTa()}DTa(){this.wL&&this.O2i(this.PKe,!0)}O2i(b,h=!1){var r=!0;if(qf.a.hs(this.properties.PopulateDynamically)){r=!1;const B=this.W3c(b);B!==this.h4g&&(r=this.L1f(B,h));r=r||!this.wL}r&&(h=v.AFrameworkApplication.ua.Lq,r=null,h&&(r=h.Zf("LoadResource","Menu Initialization")),this.dGa(b),r&&r.stop(),this.T7d())}dGa(b){if(!nf.c(this.menu)){if(this.Tu.y6a){var h=
this.Tu.wk;if(h&&h.keytip){var r=h.keytip.key.toLocaleLowerCase();this.menu.emo(String.format("{0} {1}",this.Tu.y6a,h.keytip.Jhf),this.Tu.gTa&&""!==this.Tu.gTa?String.format("{0}-{1}",this.Tu.gTa,r):r)}}this.menu.hoa();qf.a.ag(this.menu.Nc,this.Tu.T0e);qf.a.j6(this.menu.Nc,"cui-touch",3===b||this.root.Mme);if(this.menu.hasItems()){this.menu.dJ();h=this.wk;h.xXh();h.bUc=!0;h.Bf(this.menu);h.bUc=!1;this.menu.K2i();r=Object(Ib.a)(Bk.a,this.root);var B=null,P=!1;r&&(B=this.root,P=B.f8a,B.f8a=!1);var ca=
this.menu.Nc;ca.style.visibility="hidden";ca.style.position="absolute";ca.style.top="0px";ca.style.left="0px";Z.a.gt&&!Z.a.olb&&(ca.style.maxHeight="100px",ca.style.overflowY="scroll");document.body.appendChild(ca);this.HAk();this.jFn(ca);Sys.Browser.agent===Sys.Browser.InternetExplorer&&this.Uqk();qf.a.ag(this.Tu.IKb,gm.MenuLauncher.B0c);var ra=this.root.FLb;this.Nso&&this.root.Cga(this.control,!0);ca.style.zIndex=String(v.AFrameworkApplication.ua.Dua);this.root.Ctk(this.Tu);this.menu.Fra=ra;ca.style.visibility=
"visible";ra=this.P6h();if(Object(Ib.a)(Rk.a,this.menu)){ca.style.position="fixed";const Qa=this.root.eD[0];Qa&&Qa.menu&&Qa.menu.Nc?100!==Qd.a.sRc(this.root.eD[0].menu.Nc)&&xc.a.whg(ca,ra,Object(z.a)(this,this.d1e,"afterShowMenu")):xc.a.whg(ca,ra,Object(z.a)(this,this.d1e,"afterShowMenu"))}else xc.a.whg(ca,ra,Object(z.a)(this,this.d1e,"afterShowMenu"));this.wL=!0;this.menu.BKf=!0;!Z.a.vi&&this.Tu.Zdo&&this.menu.setFocus(b);r&&(B.f8a=P);r=this.properties.CommandMenuOpen;nf.b(r)||this.root.executeCommand(r,
null,h,b,!1)}}kh.a.mark(10327)}T7d(){}Uqk(){this.mOe=qf.a.eCb(this.mOe);this.mOe=window.setTimeout(Object(z.a)(this,this.Vqk,"addAndPositionBackFrameInternal"),50)}Vqk(){this.menu&&this.menu.Nc&&(document.body.appendChild(this.Zwh),this.fFn())}fFn(){const b=this.Zwh;var h=this.menu.Nc;b.style.position="absolute";b.style.visibility="hidden";b.style.left=h.style.left;b.style.right=h.style.right;b.style.top=h.style.top;b.style.bottom=h.style.bottom;let r=h.offsetWidth;h=h.offsetHeight;Z.a.olb&&(r-=4,
h-=4);b.style.width=r.toString()+"px";b.style.height=h.toString()+"px";b.style.visibility="visible"}get Nso(){return this.root.FLb?!1:!0}d1e(b){b.element&&(b.element.style.filter="",b.element.style.opacity="",this.menu&&this.menu.Nc===b.element&&Object(Ib.a)(lf.a,this.menu)&&xc.a.ACk(this.P6h()))}P6h(){const b=this.menu.children,h=[];if(Object(Ib.a)(lf.a,this.menu))for(let r=0;r<b.count;r++){const B=b.J(r);Array.add(h,B.separator);for(let P=0;P<B.children.count;P++){const ca=B.children.J(P);Array.add(h,
ca.Nc)}}return h}HAk(){var b=this.menu.children;for(let r=0;r<b.count;r++){const B=b.J(r).children;for(let P=0;P<B.count;P++){var h=B.J(P);if(Object(Ib.a)(fl.a,h)){const ca=h;if("Menu32"===ca.kU||"Menu48"===ca.kU)h=h.control,h.behavior&&(Object(Ib.a)(Vf.a,h)||Object(Ib.a)(yf.a,h))&&h.behavior.DAk()}}}0<b.count&&(b=b.J(0),nf.c(b.separator)||(b.separator.style.display="none"),nf.c(b.rme)||qf.a.ag(b.rme,"cui-menusection-titleAtTop"))}jFn(b){if(!nf.c(b)){b.style.top="0px";b.style.left="0px";b.style.bottom=
"";b.style.right="";b.style.width="";b.style.minWidth="";var h=Zd.a.create();try{const r=this.KOi.VVl(b),B=this.cRc();let P=this.root.Oge(b,r,this.Tu.I4d,B);P||(P=this.KOi.Oge(b,r,this.Tu.I4d,B));this.root.LOi=P}finally{h&&h.dispose()}}}cRc(){const b=Qd.a.getElementBounds(this.Tu.IKb);var h=this.iI;nf.c(h)||nf.c(h.Nc)||(h=Qd.a.getElementBounds(h.Nc),b.x=h.x+pe.Menu.H4d,b.width=h.width-2*pe.Menu.H4d);Object(Ib.a)(Lj.a,this.Tu.s2d)&&(b.height=0);return b}lva(){if(this.Tu.wL){t.ULS.sendTraceTag(6688860,
207,50,"Menu closing {0}",{["Id"]:this.Tu.Jh.Id});this.menu.vqa();this.Jaj();this.wL=!1;this.menu.BKf=!1;this.root.jca(this.control,!0);this.grj?v.AFrameworkApplication.ua.P7c(this.Tu.jha,this.PKe):this.W7n();this.Tu.jha=null;var b=this.Tu.IKb;qf.a.Ew(b,gm.MenuLauncher.B0c);this.Tu.m9a(this.Tu.Mu,!1);qf.a.Ew(b,"cui-ctl-menu-hovered-without-focus");this.menu.bra();nf.b(this.properties.CommandMenuClose)||this.root.executeCommand(this.properties.CommandMenuClose,null,this.wk,0,!1);this.Iaj()}}W7n(){const b=
this.Tu.jha;if(b)try{b.focus()}catch(h){}}Iaj(){dc.a.qx(this.menu.Nc);dc.a.qx(this.Fkd);qf.a.kAa(this.menu.Nc)}W3c(b){if(this.v1f&&qf.a.hs(this.properties.PopulateOnlyOnce)||nf.c(this.properties.PopulateQueryCommand))return null;if(void 0===b||null===b)b=0;const h=this.Tu.epf();return 0<(this.root.Oqa(this.properties.PopulateQueryCommand,this.properties.PopulateQueryCommand,h,b)&1)?h.PopulationXML:null}L1f(b,h=!1){if(this.v1f&&qf.a.hs(this.properties.PopulateOnlyOnce))return!0;let r=null;this.h4g=
b;nf.c(b)||(r=this.ocl(b));nf.c(r)||(this.v1f=!0);if(h){this.root.RYk(this.Tu);if(nf.c(r)||!r.hasItems())return this.lva(),!1;this.Jaj();this.Iaj()}this.hlo(r);return!0}eVi(){}ocl(b){b=We.Builder.nKh(b);if(!nf.c(b)){const h=new hm.a;h.KFh=!0;h.parentId=this.control.id;let r;r=Object(Ib.a)(tf.a,this.control);return this.root.wO.$_a(b,h,r)}return null}hlo(b){nf.c(b)||(nf.c(this.menu)||this.menu.dispose(),this.menu=b,this.eVi())}Jaj(){const b=this.menu.parent;b?(b.bUc=!0,b.removeChild(this.menu.id),
b.bUc=!1):t.ULS.sendTraceTag(572330335,207,10,"Parent not found for the Menu component {0}",this.menu.id)}onKeyDown(b){let h=!1;nf.c(b.Hb)||nf.c(b.Hb.rawEvent)||Object(Ib.a)(fl.a,this.wk)||!b.Hb.rawEvent.altKey||b.Hb.keyCode!==Sys.UI.Key.down||(this.gx(b.yf,1,b.Hb),h=!0);h||(h=super.onKeyDown(b));return h}gD(b){this.H9e();2===b.kg&&b.zda!==Sys.UI.MouseButton.leftButton||this.gx(b.yf,b.kg,b.Hb);b.Hb.preventDefault();return!1}hyf(b){if(!this.iI||!this.iI.inKeytipMode||!this.Tu.rWi)return!1;this.Tu.rWi(this.wk,
b);return!0}static ebl(){const b=qf.a.createElement("iframe");b.style.position="absolute";b.style.visibility="hidden";b.style.borderWidth="0px";return b}}Object(m.a)(Zi,"MenuLauncherBehavior",Ug,[597,577]);var Rj=c(930);class tm extends Zi{constructor(b){super(b)}get qt(){return this.GMc.properties}get GMc(){return this.control}get hPa(){return this.GMc.hPa}dJ(){Dh.a.instance.ob(pd.a.pointerDown,this.hPa.Ym,Object(z.a)(this,this.gD,"onPointerDown"));Jb.KeyInputManager.instance.ob(pd.a.gi,this.hPa.Ym,
Object(z.a)(this,this.onKeyDown,"onKeyDown"));Jb.KeyInputManager.instance.ob(pd.a.yh,this.hPa.Ym,Object(z.a)(this,this.Uy,"onKeyUp"))}Hm(){const b=this.Sd[Rj.a.SelectedItemId];if(0<(this.wu(this.qt.Command,this.qt.QueryCommand,this.Sd)&2)){const h=this.Sd[Rj.a.SelectedItemId];nf.c(h)||b===h||this.GMc.O8c(h)||(this.Sd[Rj.a.SelectedItemId]=null)}}}Object(m.a)(tm,"DropDownBehavior",Zi,[]);var dh=c(525),uk=c(711);class gl extends tm{constructor(b){super(b);this.mXa=null;this.yLe=this.Zvb=this.WBa=!1;
this.bBc=null;this.$Ac=-1}get f4(){return this.control}get VQ(){return this.f4.VQ}get KH(){return this.f4.KH}get h_d(){return this.Sd[dh.a.IsFreeForm]}set h_d(b){this.Sd[dh.a.IsFreeForm]=b}dJ(b){Dh.a.instance.ob(pd.a.pointerDown,b.Ym,Object(z.a)(this,this.gD,"onPointerDown"));const h=b.yr;Sd.a.instance.ob(pd.a.focus,h,Object(z.a)(this,this.Knb,"onInputFocus"));Sd.a.instance.ob(pd.a.blur,h,Object(z.a)(this,this.yya,"onInputBlur"));Jb.KeyInputManager.instance.ob(pd.a.gi,h,Object(z.a)(this,this.Qpn,
"onInputKeyDown"));Jb.KeyInputManager.instance.ob(pd.a.ru,h,Object(z.a)(this,this.Rpn,"onInputKeyPress"));sf.a.instance.ob(pd.a.Bda,h,Object(z.a)(this,this.eXf,"onInputMouseUp"));Dh.a.instance.ob(pd.a.pointerDown,h,Object(z.a)(this,this.Tpn,"onInputPointerDown"));Dh.a.instance.ob(pd.a.pointerDown,b.dWh,Object(z.a)(this,this.CXf,"onMenuButtonPointerDown"))}Hm(){0<(this.wu(this.KH.Command,this.KH.QueryCommand,this.Sd)&2)&&(this.Zvb||this.vIj(),this.oWo())}eVi(){this.f4.menuItems=null;var b;var h=b=
null;if(!nf.c(this.menu)){this.qge();for(let B of this.menu.children)for(let P of B.children)if(Object(Ib.a)(fl.a,P)){var r=P;r=r.control;Object(Ib.a)(575,r)&&(b=r,b=b.Jh.MenuItemId);Object(Ib.a)(559,r)&&(h=r,h=h.d3a());nf.c(b)||nf.c(h)||(this.f4.menuItems[h]=b,b=h=null)}}}Tpn(b){Object(Ib.a)(304,this.root)&&2===b.kg&&(this.mXa=Qd.a.Fib(this.control.Mu.ownerDocument),this.control.Mu.focus());return!1}gD(b){this.H9e();let h=!1;3===b.kg&&(h=super.gD(b),this.qge());h&&b.Hb.preventDefault();return!1}CXf(b){let h=
!1;if(2!==b.kg||b.zda===Sys.UI.MouseButton.leftButton)this.gx(b.yf,b.kg,b.Hb),this.qge(),h=!0;h&&b.Hb.preventDefault();return!1}Qpn(b){let h=!1;if(!nf.c(b.Hb)&&!nf.c(b.Hb.rawEvent)){const r=b.Hb.keyCode;b=b.Hb.rawEvent.shiftKey;qf.a.hs(this.KH.AutoComplete);if(r===Sys.UI.Key.enter)this.$T(),this.C$f(),Object(Ib.a)(uk.Ribbon,this.root)&&this.root.g0(),h=!0;else if(r===Sys.UI.Key.tab){if(this.$T(),this.C$f(),Object(Ib.a)(uk.Ribbon,this.root)&&(h=this.root.iqe(this.wk.Nc,!b)),Object(Ib.a)(304,this.root))return!0}else r===
Sys.UI.Key.backspace||r===Sys.UI.Key.del?this.control.enabled?(this.V6e(),this.bBc=null):h=!0:r===Sys.UI.Key.esc?(this.G$f(),this.C$f(),Object(Ib.a)(uk.Ribbon,this.root)&&this.root.g0(),h=!0):r===Sys.UI.Key.down&&(this.U0(1),this.qge(),h=!0)}return h}Rpn(b){if(!this.control.enabled)return!0;!nf.c(b.Hb)&&b.Hb.charCode&&this.Mjl();return!1}eXf(){return this.WBa?!1:this.WBa=!0}Syl(){this.$Ac=-1;const b=this.VQ.yr,h=b.value,r=this.yYl(h);if(r){b.value=r.key;if(b.setSelectionRange)b.setSelectionRange(h.length,
b.value.length);else if(b.createTextRange){const B=b.createTextRange();B.moveStart("character",h.length);B.moveEnd("character",b.value.length);B.select()}this.bBc=r.value}else this.bBc=null}yYl(b){const h=this.f4.menuItems;for(let r in h){const B={key:r,value:h[r]};if(B.key.toLowerCase().startsWith(b.toLowerCase()))return B}return null}Mjl(){qf.a.hs(this.KH.AutoComplete)&&-1===this.$Ac&&(this.yLe&&(this.W3c(0),this.yLe=!1),this.$Ac=window.setTimeout(Object(z.a)(this,this.Syl,"executeAutoComplete"),
this.f4.IIk))}V6e(){qf.a.hs(this.KH.AutoComplete)&&(this.$Ac=qf.a.eCb(this.$Ac))}Knb(b){if(this.wL)return this.menu.setFocus(0),!0;Object(Ib.a)(304,this.root)&&(pc.FocusManager.instance().kD("ribbon"),this.root.nTc=!1);this.onFocus(b);this.Zvb=!0;qf.a.ag(this.VQ.Ym,"cui-cb-focus");qf.a.hs(this.KH.PopulateDynamically)&&(this.yLe=!0);Qd.a.K8c(this.VQ.yr);nf.c(this.menu)||this.menu.Im();return this.WBa=!1}yya(){this.Zvb=!1;this.$T();qf.a.Ew(this.VQ.Ym,"cui-cb-focus");return!1}C$f(){Object(Ib.a)(304,
this.root)&&(void 0!==this.mXa&&null!==this.mXa&&v.AFrameworkApplication.ua.P7c(this.mXa,2),this.mXa=null)}$T(){if(this.control.enabled){this.V6e();var b=this.VQ.yr;if(void 0===this.Sd[dh.a.Value]||null===this.Sd[dh.a.Value]||b.value!==this.Sd[dh.a.Value].toString())if(this.f4.O8c(this.bBc))this.h_d=!1,this.Sd[dh.a.Value]=b.value,b={["IsFreeForm"]:!1,["CommandValueId"]:this.f4.T8c.OFb(),["MenuItemId"]:this.f4.T8c.Jh.MenuItemId},this.root.executeCommand(this.KH.Command,b,this.wk,0,!1);else{if(!qf.a.hs(this.KH.AutoComplete)){var h=
this.f4.menuItems[b.value];if(!nf.b(h)&&this.f4.O8c(h)){this.h_d=!1;this.Sd[dh.a.Value]=b.value;b={["IsFreeForm"]:!1,["CommandValueId"]:this.f4.T8c.OFb(),["MenuItemId"]:h};this.root.executeCommand(this.KH.Command,b,this.wk,0,!1);return}}h=!nf.b(b.value)&&""!==F.a.jza(b.value);this.f4.Msh&&h?(this.h_d=!0,this.Sd[dh.a.Value]=b.value,this.root.executeCommand(this.KH.Command,{["IsFreeForm"]:!0,["Value"]:b.value},this.wk,0,!1)):this.G$f()}}else this.G$f()}G$f(){this.V6e();this.bBc=null;this.vIj()}vIj(){const b=
this.Sd[dh.a.Value]||"";b!==this.VQ.yr.value&&(this.VQ.yr.value=b);this.f4.O8c(this.f4.menuItems[b])}oWo(){const b=this.Sd[dh.a.FontStyle]||"normal";b!==this.VQ.yr.style.fontStyle&&(this.VQ.yr.style.fontStyle=b)}qge(){this.control.Mu&&this.menu&&this.control.Mu.setAttribute(Se.a.Uvh,this.menu.id)}}Object(m.a)(gl,"ComboBoxBehavior",tm,[]);class Um extends Zi{constructor(b){super(b)}get oId(){return this.control}cRc(){let b=0;this.menu&&this.menu.Nc&&2===this.menu.horizontalAlignment&&(b=this.menu.Nc.clientWidth);
return new Sys.UI.Bounds(this.oId.x-b,this.oId.y,this.oId.EKf,this.oId.DKf)}}Object(m.a)(Um,"ContextMenuLauncherBehavior",Zi,[]);class Sk extends Zi{constructor(b){super(b)}get lLd(){return this.control}cRc(){return new Sys.UI.Bounds(this.lLd.x,this.lLd.y,this.lLd.EKf,this.lLd.DKf)}}Object(m.a)(Sk,"DialogMenuLauncherBehavior",Zi,[]);var en=c(609);class Do extends Zi{constructor(b){super(b);this.BLe=!1;this.Tjk=!qf.a.pia(this.qt.ShouldRefreshWhenDropped)}get cFa(){return this.control}get qt(){return this.control.Jh}dJ(b){b=
b.Ym;nf.c(b)||(Sd.a.instance.ob(pd.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus")),Sd.a.instance.ob(pd.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur")),Dh.a.instance.ob(pd.a.pointerOver,b,Object(z.a)(this,this.KP,"onPointerOver")),Jb.KeyInputManager.instance.ob(pd.a.gi,b,Object(z.a)(this,this.onKeyDown,"onKeyDown")),Jb.KeyInputManager.instance.ob(pd.a.yh,b,Object(z.a)(this,this.Uy,"onKeyUp")),Dh.a.instance.ob(pd.a.pointerDown,b,Object(z.a)(this,this.gD,"onPointerDown")))}Hm(){nf.c(this.control.Jh.Command)||
(this.cFa.wL&&!this.Tjk?this.BLe=!0:(0<(this.wu(this.qt.Command,this.qt.QueryCommand,this.Sd)&2)&&this.v9a()&&this.DVa(),qf.a.hs(this.qt.RefreshableMenu)&&this.wL&&this.menu.YDn()))}DVa(){this.lWo();this.Ika();this.bXo();this.cFa.EAf=this.Sd[en.a.ImageIsVisible]}lWo(){const b=qf.a.bsa(this.Sd[en.a.LabelText],this.qt.LabelText),h=this.Sd[en.a.LabelTextUserGeneratedPlaceholderReplacements];if(this.control.labelText!==b||this.qt.LabelTextUserGeneratedPlaceholderReplacements!==h)this.dF.medium&&this.mWo(this.dF.medium.UO,
b,h),this.root.S5a=!0,this.control.labelText=b,this.qt.LabelTextUserGeneratedPlaceholderReplacements=h}mWo(b,h,r){const B=b.lastChild;qf.a.hlj(b,h+" ",r);h=nf.c(B);t.ULS.sendTraceTag(38535884,207,50,"FlyoutAnchorBehaviorUpdate.FlyoutLabelTextDom: arrow type: {0}",h?"":B.nodeType.toString());h||b.appendChild(B)}bXo(){const b=this.Sd[en.a.ImageBackColor];this.dF.forEach(h=>{Do.GEk(h.iR,b)})}U0(b){"faPrint"===this.control.id&&"jewelWordEditor"===this.control.root.id&&(v.AFrameworkApplication.fqa("Microsoft.Office.Web.SessionSettings.IWacWordPrintToWebSettings"),
v.AFrameworkApplication.va.processAction(fb.a.pLd,2));"faRemix"!==this.control.id&&"faTransform"!==this.control.id&&"faPublish"!==this.control.id||"jewelWordEditor"!==this.control.root.id||v.AFrameworkApplication.va.processAction(fb.a.pLd,2);Object(Ib.a)(fl.a,this.wk)&&(this.wL||this.M8e(!0),this.control.enabled&&this.kZ());super.U0(b)}lva(){super.lva();this.BLe&&(this.BLe=!1,this.Hm())}KP(b){return this.control.XJb()?(this.cFa.wL?(this.root.XBh(),qf.a.ag(this.cFa.IKb,gm.MenuLauncher.B0c),this.cFa.jha=
this.control.Mu):(super.KP(b),this.gx(b.yf,b.kg,b.Hb)),!1):super.KP(b)}onKeyDown(b){let h=!1;if(!nf.c(b.Hb)&&!nf.c(b.Hb.rawEvent)){if(Object(Ib.a)(fl.a,this.wk)){const r=b.Hb.rawEvent,B=b.Hb.keyCode,P=0===this.root.U1;r.shiftKey||r.ctrlKey||!(B===Sys.UI.Key.right&&P||B===Sys.UI.Key.left&&!P)||(h=this.hyf(b),h||(this.gx(b.yf,1,b.Hb),h=!0))}h||(h=super.onKeyDown(b))}return h}static GEk(b,h){nf.c(b)||nf.c(h)||b.style.backgroundColor===h||(b.style.backgroundColor=h)}}Object(m.a)(Do,"FlyoutAnchorBehavior",
Zi,[]);var Ui=c(957);class lp extends Ug{constructor(b){super(b)}get b9b(){return this.control}get properties(){return this.b9b.properties}get Nga(){return this.b9b.Nga}dJ(b){b=b.pEb;Sd.a.instance.ob(pd.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));Sd.a.instance.ob(pd.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));Dh.a.instance.ob(pd.a.pointerOver,b,Object(z.a)(this,this.KP,"onPointerOver"));Dh.a.instance.ob(pd.a.pointerOut,b,Object(z.a)(this,this.SJ,"onPointerOut"));Jb.KeyInputManager.instance.ob(pd.a.gi,
b,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Jb.KeyInputManager.instance.ob(pd.a.yh,b,Object(z.a)(this,this.Uy,"onKeyUp"));Dh.a.instance.ob(pd.a.pointerDown,b,Object(z.a)(this,this.gD,"onPointerDown"));Dh.a.instance.ob(pd.a.jN,b,Object(z.a)(this,this.Cya,"onPointerUp"));On.a.instance.ob(pd.a.bQ,b,Object(z.a)(this,this.$nb,"onTouchMove"));On.a.instance.ob(pd.a.hK,b,Object(z.a)(this,this.LHa,"onTouchEnd"))}Hm(){const b=this.Sd[Ui.a.On],h=this.Sd[Ui.a.IsRtl];this.aIj();if(0<(this.wu(this.properties.Command,
this.properties.QueryCommand,this.Sd)&2)){var r=!nf.c(this.Sd[Ui.a.InnerHTML])||!nf.c(this.properties.InnerHTML),B=!nf.c(this.properties.Image);r||B||(this.control.enabled=!1);B=this.Nga.pEb;if(!nf.c(B)){if(r){r=qf.a.bsa(this.Sd[Ui.a.InnerHTML],this.properties.InnerHTML);if(null===B.innerHTML||null===r||F.a.eh(B.innerHTML)!==F.a.eh(r))B.innerHTML=r;""===r&&(this.control.enabled=!1)}r=B.title;const P=qf.a.bsa(this.Sd[Ui.a.Alt],this.properties.Alt);P===r||this.control.hgg||(B.title=P)}B=this.Sd[Ui.a.IsRtl];
b===this.Sd[Ui.a.On]&&h===B||this.control.TMb()}}aIj(){const b=this.Sd;b[Ui.a.CommandValueId]=this.control.OFb();b.MenuItemId=this.control.Jh.MenuItemId;b.SourceControlId=this.properties.Id}gx(b,h,r){if((b=this.wk)&&this.control.enabled){const B=this.root;if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("ExcelBorderMenuCompactionEnabled")&&b.lXc()&&this.iI){const P=B.eD[this.iI.Fra];P?P.iUa(this.b9b):t.ULS.sendTraceTag(41034837,207,15,"GalleryButtonBehavior.DoDefaultAction: Did not get Menulauncher for the menu item.")}this.aIj();
this.Sd[Ui.a.On]||(this.Sd[Ui.a.On]=!0,this.control.TMb());"Menu"===b.kU&&qf.a.Ew(this.Nga.Ym,"cui-gallerybutton-focused");B.executeCommand(this.properties.Command,this.Sd,b,h,!0,null,this.gY(r))}}onFocus(b){super.onFocus(b);qf.a.ag(this.Nga.Ym,"cui-gallerybutton-focused");return!1}onBlur(b){super.onBlur(b);qf.a.Ew(this.Nga.Ym,"cui-gallerybutton-focused");return!1}}Object(m.a)(lp,"GalleryButtonBehavior",Ug,[]);var Ji=c(1149),rj=c(1409),im=c(645);class In extends Ug{constructor(b){super(b);this.zYa=
-1}get Kbc(){return this.control}get properties(){return this.Kbc.Jh}get mJc(){return this.Kbc.mJc}get aAf(){var b=null;if(this.wk&&(b=this.wk.parent,!Object(Ib.a)(im.a,b)))throw Error.create("InsertTable must live inside of a MenuSection.");return b}get wIb(){return this.Kbc.jYd.wIb}get Z2c(){return this.Kbc.jYd.Z2c}gx(b,h,r){if(this.control.enabled){b=this.Frf(this.s9b(b));const B=this.LQd(b);this.mJc[rj.a.Rows]=this.jUd(b)+1;this.mJc[rj.a.Columns]=B+1;this.root.executeCommand(this.properties.Command,
this.mJc,this.wk,h,!0,null,this.gY(r))}}dJ(b){var h=b.Ym;const r=b.KCh;b=b.cells;Dh.a.instance.ob(pd.a.pointerOut,h,Object(z.a)(this,this.inn,"onControlPointerOut"));On.a.instance.ob(pd.a.bQ,h,Object(z.a)(this,this.knn,"onControlTouchMove"));On.a.instance.ob(pd.a.hK,h,Object(z.a)(this,this.jnn,"onControlTouchEnd"));for(h=0;h<b.length;++h)this.gIk(r[h],b[h])}gIk(b,h){Sd.a.instance.ob(pd.a.focus,b,Object(z.a)(this,this.NVf,"onCellFocus"));Dh.a.instance.ob(pd.a.pointerOver,h,Object(z.a)(this,this.OVf,
"onCellPointerOver"));Dh.a.instance.ob(pd.a.jN,h,Object(z.a)(this,this.PVf,"onCellPointerUp"));Jb.KeyInputManager.instance.ob(pd.a.gi,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Jb.KeyInputManager.instance.ob(pd.a.yh,h,Object(z.a)(this,this.Uy,"onKeyUp"));On.a.instance.ob(pd.a.cQ,h,Object(z.a)(this,this.hmn,"onCellTouchStart"))}Frf(b){return parseInt(b.id.substr(this.Kbc.id.length+1))}vmi(b){this.umi(this.Frf(b))}jUd(b){return Math.floor(b/Ji.a.C1c)}LQd(b){return b%Ji.a.C1c}umi(b){if(b!==this.zYa){var h=
this.LQd(b),r=this.jUd(b),B=-1;let P=-1;-1!==this.zYa&&(B=this.jUd(this.zYa),P=this.LQd(this.zYa));for(;B!==r||P!==h;)B<r?this.tnj(++B,P,!0):B>r?(this.tnj(B,P,!1),B--):P<h?this.Vkj(++P,B,!0):P>h&&(this.Vkj(P,B,!1),P--);this.aAf?this.aAf.hoj(this.z6h(r+1,h+1)):(r=(h=this.control.T9e)&&0<h.length?h[0]:null,B=this.wk,t.ULS.sendTraceTag(19748692,207,15,"Insert table menu is NULL. {0}",{["CtrlComps"]:!!h,["FirstComp"]:!!r,["FirstCompPar"]:!!r&&!!r.parent,["DispComp"]:!!B,["DispCompPar"]:!!B&&!!B.parent}));
this.zYa=b}}tnj(b,h,r){for(let B=0;B<=h;B++)this.Nkj(b,B,r)}Vkj(b,h,r){for(let B=0;B<=h;B++)this.Nkj(B,b,r)}Nkj(b,h,r){h=b*Ji.a.C1c+h;b=this.wIb[h];h=this.Z2c[h];r?(b.className="cui-it-activeCell",h.className="cui-it-activeCellOuter"):(b.className="cui-it-inactiveCell",h.className="cui-it-inactiveCellOuter")}PVf(b){this.gx(b.yf,b.kg,b.Hb);return!0}s9b(b){for(;b.hasChildNodes();)b=b.childNodes[0];return nf.c(b.tagName)||"a"!==b.tagName.toLowerCase()?null:b.parentNode.parentNode}ioj(b){const h=this.Frf(b);
b.childNodes[0].childNodes[0].title=this.z6h(this.jUd(h)+1,this.LQd(h)+1)}z6h(b,h){let r=this.properties.Alt;nf.c(r)&&(r=this.properties.MenuSectionTitle);return r=String.format(r,h.toString(),b.toString())}Ejc(){if(this.wk){for(var b=0;b<Ji.a.wgc;b++)this.wIb[b].className="cui-it-inactiveCell",this.Z2c[b].className="cui-it-inactiveCellOuter";this.zYa=-1;b=this.properties.MenuSectionInitialTitle;nf.c(b)&&(b="");this.aAf.hoj(b)}}OVf(b){this.control.enabled&&(b=this.s9b(b.yf),this.w9c(b),this.qgf(b));
return!1}qgf(b){this.ioj(b);this.vmi(b)}NVf(b){if(!this.control.enabled)return!1;b=this.s9b(b.yf);this.ioj(b);this.vmi(b);return!1}inn(b){Qd.a.aHf(this.Kbc.jYd.Ym,b.clientPoint)||this.Ejc();return!1}hmn(b){if(!this.control.enabled)return!1;b=this.s9b(b.yf);this.qgf(b);return!0}knn(b){if(!this.control.enabled)return!1;b=Qd.a.zRd(b.clientPoint);if(!b||"table"===b.tagName.toLowerCase())return!1;(b=this.s9b(b))?this.qgf(b):this.Ejc();return!0}jnn(b){if(!this.control.enabled)return!1;var h=Qd.a.zRd(b.clientPoint);
if(!h||"table"===h.tagName.toLowerCase())return this.Ejc(),!0;(h=this.s9b(h))?this.gx(h,3,b.Hb):this.Ejc();return!0}eL(b){b=yn.Control.bmf(this.zYa,Ji.a.C1c,Ji.a.wgc,b);if(b!==this.zYa)return this.wIb[b].firstChild.focus(),this.umi(b),!0;this.Ejc();this.zYa=-1;return!1}kZ(){const b=this.wIb[0];if(nf.c(b))return!1;b.firstChild.focus();return!0}w9c(b){if(nf.c(b))return!1;b.firstChild.firstChild.focus();return!0}vqa(){this.Ejc()}}Object(m.a)(In,"InsertTableBehavior",Ug,[]);class Ki extends Zi{constructor(b){super(b)}Hm(){this.control.enabled=
!!this.menu}gx(b,h,r){v.AFrameworkApplication.va.Qb(fb.a.bSa,2,h,this.gY(r))}}Object(m.a)(Ki,"JewelMenuLauncherBehavior",Zi,[]);var $h=c(1085);class Er extends Ug{constructor(b){super(b)}get properties(){return this.control.Jh}Hm(){0<(this.wu(this.properties.Command,this.properties.QueryCommand,this.Sd)&2)&&this.v9a()&&this.DVa()}DVa(){this.x_o();this.Ika();this.YSb()}x_o(){const b=this.control.labelText;let h=this.Sd[$h.a.Value];nf.c(h)&&(h=this.properties.LabelText,nf.c(h)&&(h=""));h!==b&&this.fhe(h)}dJ(b){b=
b.Ym;nf.c(b)||(Dh.a.instance.ob(pd.a.pointerDown,b,Object(z.a)(this,this.gD,"onPointerDown")),Dh.a.instance.ob(pd.a.pointerOver,b,Object(z.a)(this,this.KP,"onPointerOver")),Dh.a.instance.ob(pd.a.pointerOut,b,Object(z.a)(this,this.SJ,"onPointerOut")))}}Object(m.a)(Er,"LabelBehavior",Ug,[]);var Rr=c(883),sn=c(213),Vm=c(303);class vq extends Zi{constructor(b){super(b);this.LEe=this.xwe=!1;this.PXb=this.rUb=null;if(this.rYb=v.AFrameworkApplication.K.$("TellMeRedesignIsEnabled"))this.rUb=this.xu.Rja.LightImage16by16Class,
this.PXb=this.xu.Rja.DarkImage16by16Class}get xu(){return this.control}f6d(b,h,r,B){h&&(this.xu.jha=r,v.AFrameworkApplication.ua.Q7a());if(Object(Ib.a)(sn.a,b)&&B){r=new Rr.a;r.CommandLocation=this.root.A$;r.InvocationMethod=0;const P={};(b=b.control)&&b.Jh&&(P.CommandId=b.Jh.Command,P.ControlId=b.Jh.Id,P.CloseAllMenus=h,b.iI&&b.iI.parent&&b.iI.parent.id&&(P.ParentControlId=b.iI.parent.id.split("-")[0]),this.root.JF&&this.root.JF.vPa(B,P,r))}}lva(){this.xu.jha||(this.xu.jha=this.xu.Ly);!this.xu.Sen&&
this.rYb&&(qf.a.Ew(this.xu.Ly,"cui-sb-focus"),qf.a.Ew(this.xu.c2,"cui-sb-focus"),qf.a.Ew(this.xu.Bza,this.rUb),qf.a.ag(this.xu.Bza,this.PXb));this.xwe=!0;super.lva();this.xwe=!1;this.w5f()}get grj(){return!this.xu.nTa}T7d(){this.xu.T7d()}Hce(){this.LEe||this.xwe||(this.LEe=!0,this.xu.raiseEvent(Vm.a.Z3a,null))}w5f(){this.wL||this.xu.YBf||(this.LEe=!1,this.xu.raiseEvent(Vm.a.OIb,null))}cXf(b){qf.a.Ew(this.xu.Ly,"cui-sb-focus");qf.a.Ew(this.xu.c2,"cui-sb-focus");this.rYb&&!this.xu.wL&&(qf.a.Ew(this.xu.Bza,
this.rUb),qf.a.ag(this.xu.Bza,this.PXb));this.xu.raiseEvent(Vm.a.blur,b);this.w5f();this.xu.jha=this.xu.Ly;return!1}dXf(b){qf.a.ag(this.xu.Ly,"cui-sb-focus");qf.a.ag(this.xu.c2,"cui-sb-focus");this.rYb&&(qf.a.Ew(this.xu.Bza,this.PXb),qf.a.ag(this.xu.Bza,this.rUb));this.xu.raiseEvent(Vm.a.focus,b);this.Hce();return!1}EYf(){this.rYb&&(qf.a.ag(this.xu.c2,"cui-sb-hover"),qf.a.ag(this.xu.Ly,"cui-sb-hover"),qf.a.Ew(this.xu.Bza,this.PXb),qf.a.ag(this.xu.Bza,this.rUb));return!1}DYf(){this.rYb&&(qf.a.Ew(this.xu.c2,
"cui-sb-hover"),qf.a.Ew(this.xu.Ly,"cui-sb-hover"),this.xu.wL||this.xu.YBf||(qf.a.Ew(this.xu.Bza,this.rUb),qf.a.ag(this.xu.Bza,this.PXb)));return!1}}Object(m.a)(vq,"SearchBoxBehavior",Zi,[591,577]);class Jn{}Jn.Value="value";Jn.MinValue="MinValue";Jn.MaxValue="MaxValue";Jn.Text="Text";Object(m.a)(Jn,"SliderCommandProperties",null,[]);class zs extends Ug{constructor(b){super(b)}get kig(){return this.control}get V5(){return this.kig.V5}get properties(){return this.control.Jh}initialize(){}gx(){}dJ(b){b=
b.yr;Sd.a.instance.ob(pd.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));Sd.a.instance.ob(pd.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));Sd.a.instance.ob(pd.a.nIc,b,Object(z.a)(this,this.Gda,"onChange"));Sd.a.instance.ob(pd.a.input,b,Object(z.a)(this,this.Gda,"onChange"))}onFocus(b){this.V5.Ym&&Sys.UI.DomElement.addCssClass(this.V5.Ym,"cui-sldr-onfocus");return super.onFocus(b)}onBlur(b){this.V5.Ym&&Sys.UI.DomElement.removeCssClass(this.V5.Ym,"cui-sldr-onfocus");return super.onBlur(b)}Gda(){this.X2k(this.V5.yr.value);
return!0}X2k(b){this.Sd[Jn.Value]=parseFloat(b);this.root.executeCommand(this.properties.Command,this.Sd,this.wk,0,!1)}Hm(){const b=this.Sd[Jn.Value],h=this.Sd[Jn.MaxValue],r=this.Sd[Jn.Text];var B=this.wu(this.properties.Command,this.properties.QueryCommand,this.Sd);this.V5&&this.V5.yr&&(this.V5.yr.disabled=!this.control.enabled);if(0<(B&2)){B=this.Sd[Jn.Value];const P=this.Sd[Jn.MaxValue],ca=this.Sd[Jn.Text];(P!==h||B!==b||r!==ca)&&this.V5&&this.V5.yr&&(this.V5.yr.setAttribute(Se.a.KDd,String.format("{0}",
P)),this.V5.yr.setAttribute("max",String.format("{0}",P)),this.V5.yr.value=B,this.V5.UO.innerText=this.Sd[Jn.Text])}}}Object(m.a)(zs,"SliderBehavior",Ug,[]);var Pi=c(1403);class jj extends Ug{constructor(b){super(b);this.tsd=0;this.qeb=null;this.Ppd=!1;this.Flh=null;this.NTe=!1;this.uvd=this.Ptd=-1;this.WBa=!1}get spinner(){return this.control}get bH(){return this.spinner.bH}get properties(){return this.control.Jh}initialize(){const b=this.spinner.nrg;this.Flh=this.eSo(b);this.tsd=b[0].min;this.qeb=
b[0];this.Ppd=!1}gx(){}dJ(b){const h=b.yr,r=b.F7b;b=b.TMc;Sd.a.instance.ob(pd.a.focus,h,Object(z.a)(this,this.onFocus,"onFocus"));Sd.a.instance.ob(pd.a.blur,h,Object(z.a)(this,this.onBlur,"onBlur"));Jb.KeyInputManager.instance.ob(pd.a.gi,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Jb.KeyInputManager.instance.ob(pd.a.ru,h,Object(z.a)(this,this.XG,"onKeyPress"));Jb.KeyInputManager.instance.ob(pd.a.yh,h,Object(z.a)(this,this.Uy,"onKeyUp"));Sd.a.instance.ob(pd.a.nIc,h,Object(z.a)(this,this.Gda,"onChange"));
sf.a.instance.ob(pd.a.Bda,h,Object(z.a)(this,this.eXf,"onInputMouseUp"));Dh.a.instance.ob(pd.a.pointerDown,r,Object(z.a)(this,this.QTi,"onArrowPointerDown"));Dh.a.instance.ob(pd.a.pointerDown,b,Object(z.a)(this,this.QTi,"onArrowPointerDown"));Dh.a.instance.ob(pd.a.jN,r,Object(z.a)(this,this.RTi,"onArrowPointerUp"));Dh.a.instance.ob(pd.a.jN,b,Object(z.a)(this,this.RTi,"onArrowPointerUp"));On.a.instance.ob(pd.a.bQ,r,Object(z.a)(this,this.TTi,"onArrowTouchMove"));On.a.instance.ob(pd.a.bQ,b,Object(z.a)(this,
this.TTi,"onArrowTouchMove"));On.a.instance.ob(pd.a.hK,r,Object(z.a)(this,this.STi,"onArrowTouchEnd"));On.a.instance.ob(pd.a.hK,b,Object(z.a)(this,this.STi,"onArrowTouchEnd"))}onFocus(b){super.onFocus(b);qf.a.ag(this.bH.Ym,"cui-spn-focus");this.control.enabled&&Qd.a.K8c(this.bH.yr);return this.WBa=!1}onBlur(b){super.onBlur(b);qf.a.Ew(this.bH.Ym,"cui-spn-focus");return!1}onKeyDown(b){let h=!1;if(!nf.c(b.Hb)&&!nf.c(b.Hb.rawEvent)){const r=b.Hb.keyCode,B=b.Hb.rawEvent.shiftKey;if(r===Sys.UI.Key.up||
r===Sys.UI.Key.down)this.root.nEf(this.control)||this.Ovj(r===Sys.UI.Key.up,b.kg),h=!0;else if(r===Sys.UI.Key.enter)this.$T(),Object(Ib.a)(uk.Ribbon,this.root)&&this.root.g0(),h=!0;else if(r===Sys.UI.Key.tab)this.$T(),Object(Ib.a)(uk.Ribbon,this.root)&&(h=this.root.iqe(this.wk.Nc,!B));else if(r===Sys.UI.Key.esc)this.Gjc(),Object(Ib.a)(uk.Ribbon,this.root)&&this.root.g0(),h=!0;else if(r===Sys.UI.Key.backspace||r===Sys.UI.Key.del)h=!this.control.enabled}return h}XG(){return!this.control.enabled}Uy(){this.hil();
return!1}Gda(){this.$T();return!1}eXf(){return this.WBa?!1:this.WBa=!0}QTi(b){var h=!1;let r=!0;2===b.kg&&(r=b.zda===Sys.UI.MouseButton.leftButton);r&&(h=b.yf,this.Ovj(h===this.bH.F7b||h===this.bH.oWh||h===this.bH.nWh,b.kg),h=!0);return h}RTi(b){return this.Qva(b)}TTi(b){return this.G6d(b)}STi(b){return this.Qva(b)}jym(b){if(this.control.enabled){var h=!1;if(!this.Ppd){var r=this.W0l(b);r=b?r+this.qeb.step:r-this.qeb.step;r=Math.min(r,this.qeb.max);r=Math.max(r,this.qeb.min);r!==this.tsd&&(this.G9e(r,
this.qeb),this.root.executeCommand(this.properties.Command,this.Sd,this.wk,0,!1),h=!0)}h||(h=this.properties.SpinCommand,r=this.Sd,r.Increment=b,nf.c(h)||this.root.executeCommand(h,r,this.wk,0,!1))}}W0l(b){const h=Math.pow(10,v.AFrameworkApplication.numberFormat.n6d),r=Math.round(this.qeb.step*h);let B=Math.round(this.tsd*h)/r;B=b?Math.floor(B):Math.ceil(B);return B*r/h}Ovj(b,h){if(this.control.enabled){this.$T();const r=b?this.bH.F7b:this.bH.TMc;switch(h){case 2:case 3:this.NTe=b;this.nBd(r);break;
case 1:this.NTe=b,this.xqk(r)}}}twj(){this.YBh();this.PTk()}bRh(){-1===this.Ptd&&(this.Ptd=window.setTimeout(Object(z.a)(this,this.U3n,"repeatSpin"),500))}YBh(){this.Ptd=qf.a.eCb(this.Ptd)}U3n(){this.YBh();-1===this.uvd&&(this.ake(),this.uvd=window.setInterval(Object(z.a)(this,this.ake,"spin"),50))}PTk(){this.uvd=qf.a.LTk(this.uvd)}ake(){this.jym(this.NTe)}xqk(b){this.root.Cga(this.control,!1);qf.a.ag(b,yn.Control.qBd);this.ake();this.bRh()}hil(){this.root.jca(this.control,!1);this.twj();qf.a.Ew(this.bH.F7b,
yn.Control.qBd);qf.a.Ew(this.bH.TMc,yn.Control.qBd)}flc(b){this.bH.yr.value!==b&&(this.bH.yr.value=b)}Gjc(){this.flc(this.Sd[Pi.a.Text])}klj(b){this.flc(b);this.Sd[Pi.a.Text]=b;this.Ppd=!0}Jho(b,h,r){this.flc(r);this.Sd[Pi.a.Text]=r;this.Sd[Pi.a.Number]=b;this.Sd[Pi.a.UnitType]=h.type;this.tsd=b;this.qeb=h;this.bH.yr.setAttribute(Se.a.l3e,r);this.bH.yr.setAttribute(Se.a.awh,String.format("{0}",h.min));this.bH.yr.setAttribute(Se.a.KDd,String.format("{0}",h.max));this.Ppd=!1}BHh(b){var h;if(({bin:h}=
this.fVm(b)).returnValue)this.klj(h);else{({number:b,i9a:h}=F.a.$0i(b,this.Flh,v.AFrameworkApplication.numberFormat));let r=this.Rne(h);0===h&&nf.c(r)&&(r=this.Rne(this.Sd[Pi.a.UnitType]));this.G9e(b,r)}}G9e(b,h){b=this.ZTf(b,h);if(isNaN(b)||nf.c(h))this.Gjc();else{const r=v.AFrameworkApplication.numberFormat;let B;B=F.a.gFa(b,h.type,r);B=B.replace(6===h.type?r.o6d:r.F0f,"");this.Jho(b,h,B)}}fVm(b){let h,r=!1;h="";b=b.trim();const B=this.spinner.CJj;if(!nf.c(B))for(let P=0;P<B.length;P++)if(B[P].toLowerCase()===
b.toLowerCase()){h=B[P];r=!0;break}return{returnValue:r,bin:h}}ZTf(b,h){return isNaN(b)||nf.c(h)?Number.NaN:h.ZTf(b)}Rne(b){let h=null;const r=this.spinner.nrg;for(let B=0;B<r.length;B++)if(r[B].type===b){h=r[B];break}return h}eSo(b){const h=b.length,r=Array(h);for(let B=0;B<h;B++)r[B]=b[B].type;return r}$T(){if(this.control.enabled){const b=this.Sd[Pi.a.Text],h=this.bH.yr.value;h!==b&&(this.BHh(h),this.Sd[Pi.a.Text]!==b&&this.root.executeCommand(this.properties.Command,this.Sd,this.wk,0,!1))}else this.Gjc()}Hm(){var b=
this.Sd[Pi.a.Text],h=this.Sd[Pi.a.Number];const r=this.Sd[Pi.a.UnitType],B=this.Sd[Pi.a.MaxValue];if(0<(this.wu(this.properties.Command,this.properties.QueryCommand,this.Sd)&2)){const P=this.Sd[Pi.a.Text],ca=this.Sd[Pi.a.Number],ra=this.Sd[Pi.a.UnitType],Qa=this.Sd[Pi.a.MaxValue];Qa!==B&&(this.Rne(ra).max=Qa,this.bH.yr.setAttribute(Se.a.KDd,String.format("{0}",Qa)));P!==b?""===P?this.klj(P):this.BHh(P):isNaN(ca)||ca===h&&ra===r||this.G9e(ca,this.Rne(ra));b=this.bH.Ym.title;h=qf.a.bsa(this.Sd[Pi.a.Alt],
this.properties.Alt);h!==b&&(this.bH.yr.title=h,this.bH.F7b.title=h,this.bH.TMc.title=h)}}lZe(b){super.lZe(b);b?(this.ake(),this.bRh()):this.twj()}}Object(m.a)(jj,"SpinnerBehavior",Ug,[590,577]);var $i=c(407),Sj=c(896);class mp extends Zi{constructor(b){super(b);this.oZb=!0;this.otb=!1}get Y5(){return this.control}get qt(){return this.Y5.properties}dJ(b){const h=b.Ym,r=b.zhb;b=b.VMc;Sd.a.instance.ob(pd.a.focus,h,Object(z.a)(this,this.onFocus,"onFocus"));Sd.a.instance.ob(pd.a.blur,h,Object(z.a)(this,
this.onBlur,"onBlur"));Jb.KeyInputManager.instance.ob(pd.a.gi,h,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Jb.KeyInputManager.instance.ob(pd.a.yh,h,Object(z.a)(this,this.Uy,"onKeyUp"));Z.a.Nt&&16>this.GWl()&&(Dh.a.instance.ob(pd.a.pointerDown,h,Object(z.a)(this,this.LYi,"onSplitbuttonPointerDownPointerUp")),Dh.a.instance.ob(pd.a.jN,h,Object(z.a)(this,this.LYi,"onSplitbuttonPointerDownPointerUp")));Dh.a.instance.ob(pd.a.pointerOver,r,Object(z.a)(this,this.Tln,"onButtonPointerOver"));Dh.a.instance.ob(pd.a.pointerOut,
r,Object(z.a)(this,this.Sln,"onButtonPointerOut"));Dh.a.instance.ob(pd.a.pointerDown,r,Object(z.a)(this,this.hUi,"onButtonPointerDown"));Dh.a.instance.ob(pd.a.jN,r,Object(z.a)(this,this.iUi,"onButtonPointerUp"));On.a.instance.ob(pd.a.bQ,r,Object(z.a)(this,this.Vln,"onButtonTouchMove"));On.a.instance.ob(pd.a.hK,r,Object(z.a)(this,this.Uln,"onButtonTouchEnd"));Dh.a.instance.ob(pd.a.pointerDown,b,Object(z.a)(this,this.CXf,"onMenuButtonPointerDown"));Dh.a.instance.ob(pd.a.pointerOver,b,Object(z.a)(this,
this.Sqn,"onMenuButtonPointerOver"));Dh.a.instance.ob(pd.a.pointerOut,b,Object(z.a)(this,this.Rqn,"onMenuButtonPointerOut"))}gx(b,h,r){Sys.UI.DomElement.containsCssClass(b,"cui-ctl-a1")?this.otb&&(this.Y5.on=!this.Y5.on,b=this.Sd,b.CommandValueId=this.control.OFb(),this.root.executeCommand(this.qt.Command,b,this.wk,h,!0,null,this.gY(r))):this.oZb&&super.gx(b,h,r)}Uy(b){const h=b.Hb.keyCode;return h===Sys.UI.Key.enter||h===Sys.UI.Key.space?(b=this.Sd,b.CommandValueId=this.control.OFb(),this.root.executeCommand(this.qt.Command,
b,this.wk,1,!0),!0):super.Uy(b)}Hm(){const b=this.root.Oqa(this.qt.Command,this.qt.QueryCommand,this.Sd),h=0<(b&1);let r=!0;r=nf.c(this.qt.CommandMenuOpen)?h:0<(this.root.Oqa(this.qt.CommandMenuOpen,null,null)&1);if(r!==this.oZb||h!==this.otb||(r||h)!==this.control.enabled)this.control.enabled=r||h,h!==this.otb&&this.eon(h),r!==this.oZb&&this.fon(r),this.oZb=r,this.otb=h;if(0<(b&2)){this.Ika();const B=qf.a.bsa(this.Sd[Sj.a.LabelText],this.qt.LabelText);this.Sd[Sj.a.ApplyLabelTextToControlOnly]?this.Y5.P8b(P=>
{P.Ym.title=B;P.zhb.removeAttribute("title");P.VMc.removeAttribute("title")}):this.Y5.P8b(P=>{P.zhb.title=B});this.Sd[Sj.a.EnsureControlRoleIsButton]&&this.Y5.P8b(P=>{Se.a.lr(P.Ym,Se.a.uh,Se.a.X3)});nf.c(this.Sd[Sj.a.Visible])||this.v9a()&&this.DVa()}this.Y5.setState(this.Y5.on&&h)}DVa(){this.Ppg();this.YSb();this.Ika()}fon(b){this.Y5.P8b(h=>{qf.a.Spb(h.VMc,b)});this.H6c();this.oZb=b}eon(b){this.Y5.P8b(h=>{qf.a.Spb(h.zhb,b)});this.H6c();this.otb=b}H6c(){const b=this.Y5.Yib();nf.c(b)||(qf.a.Ew(b.childNodes[0],
"cui-ctl-split-hovered-primary"),qf.a.Ew(b.childNodes[0],"cui-ctl-split-hovered-secondary"),qf.a.Ew(b.childNodes[1],"cui-ctl-split-hovered-primary"),qf.a.Ew(b.childNodes[1],"cui-ctl-split-hovered-secondary"))}LYi(b){if(0!==$i.a(b.Hb))return!1;let h=!1;b.eventName===pd.a.pointerDown?h=this.hUi(b):b.eventName===pd.a.jN&&(h=this.iUi(b));return h}hUi(b){let h=!1;const r=b.kg;switch(r){case 3:this.vvo()?this.gx(this.wk.Nc,r,b.Hb):this.nBd(this.Y5.PTh);h=!0;break;case 2:b.zda===Sys.UI.MouseButton.leftButton&&
(this.nBd(this.Y5.PTh),h=!0)}h&&b.Hb.preventDefault();return!1}vvo(){const b=this.wk.kU;return"Small"===b||"Medium"===b||"Menu16"===b||"MenuTellMe"===b}iUi(b){return this.Qva(b)}Vln(b){return this.G6d(b)}Uln(b){return this.Qva(b)}onFocus(b){super.onFocus(b);this.Ozf(!0,!0);return!1}onBlur(b){super.onFocus(b);this.H6c();return!1}Tln(){this.control.enabled&&this.otb&&this.Ozf(!0,this.Y5.on);return!1}Sln(){this.control.enabled&&this.otb&&this.H6c();return!1}CXf(b){let h=!1;if(2!==b.kg||b.zda===Sys.UI.MouseButton.leftButton)this.gx(b.yf,
b.kg,b.Hb),h=!0;h&&b.Hb.preventDefault();return!1}Sqn(){this.control.enabled&&this.oZb&&this.Ozf(this.Y5.on,!0);return!1}Rqn(){this.H6c();return!1}Ozf(b,h){const r=this.control.Yib();nf.c(r)||(qf.a.ag(r.childNodes[0],b?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"),qf.a.ag(r.childNodes[1],h?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"))}GWl(){var b=Z.a.u7b;return b&&(b=b.split("."),2===b.length)?parseInt(b[0]):0}}Object(m.a)(mp,"SplitButtonBehavior",Zi,[]);
var Vi=c(1408);class ap extends Ug{constructor(b){super(b);this.Zvb=this.WBa=!1;this.s2j=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("ExcelTableRenameEnabled")}get textBox(){return this.control}get Dea(){return this.textBox.Dea}get Alg(){return this.textBox.Jh}dJ(b){b=b.yr;Sd.a.instance.ob(pd.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));Sd.a.instance.ob(pd.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));Jb.KeyInputManager.instance.ob(pd.a.gi,b,Object(z.a)(this,this.onKeyDown,
"onKeyDown"));Jb.KeyInputManager.instance.ob(pd.a.ru,b,Object(z.a)(this,this.XG,"onKeyPress"));Jb.KeyInputManager.instance.ob(pd.a.yh,b,Object(z.a)(this,this.Uy,"onKeyUp"));Sd.a.instance.ob(pd.a.nIc,b,Object(z.a)(this,this.Gda,"onChange"));sf.a.instance.ob(pd.a.Bda,b,Object(z.a)(this,this.SSa,"onMouseUp"))}onFocus(b){super.onFocus(b);this.Zvb=!0;qf.a.ag(this.Dea.Ym,"cui-tb-focus");this.control.enabled&&Qd.a.K8c(this.Dea.yr);return this.WBa=!1}onBlur(b){this.Zvb=!1;super.onBlur(b);qf.a.Ew(this.Dea.Ym,
"cui-tb-focus");return!1}onKeyDown(b){let h=super.onKeyDown(b);if(!nf.c(b.Hb)&&!nf.c(b.Hb.rawEvent)){const r=b.Hb.keyCode,B=b.Hb.rawEvent.shiftKey;r===Sys.UI.Key.tab?(this.$T(),Object(Ib.a)(uk.Ribbon,this.root)&&(h=this.root.iqe(this.wk.Nc,!B))):r===Sys.UI.Key.enter?this.s2j&&(this.$T(),Object(Ib.a)(uk.Ribbon,this.root)&&this.root.g0(),h=!0):r===Sys.UI.Key.esc?(this.Gjc(),Object(Ib.a)(uk.Ribbon,this.root)&&this.root.g0(),h=!0):r===Sys.UI.Key.backspace||r===Sys.UI.Key.del?h=!this.control.enabled:b.ova&&
(He.a.VBh(b.Hb),h=!1)}return h}XG(){return!this.control.enabled}Uy(){return!1}Gda(){this.$T();return!1}SSa(){return this.Dea.isEditable?this.WBa?!1:this.WBa=!0:(Qd.a.K8c(this.Dea.yr),!0)}flc(b){this.Dea.yr.value!==b&&(this.Dea.yr.value=b)}Gjc(){this.flc(this.Sd[Vi.a.Text])}$T(){if(this.control.enabled&&this.Dea.isEditable){const b=this.Dea.yr.value;b!==this.Sd[Vi.a.Text]&&(this.Sd[Vi.a.Text]=b,this.root.executeCommand(this.Alg.Command,this.Sd,this.wk,0,!1))}else this.Gjc()}Hm(){const b=this.Sd[Vi.a.Text];
if(0<(this.wu(this.Alg.Command,this.Alg.QueryCommand,this.Sd)&2)&&!this.Zvb){const h=this.Sd[Vi.a.Text];h!==b&&this.flc(h)}}}Object(m.a)(ap,"TextBoxBehavior",Ug,[587,577]);var Mp=c(387);class Xn extends Ug{constructor(b){super(b)}get toggleButton(){return this.control}get properties(){return this.control.Jh}gx(b,h,r){this.control.enabled&&(qf.a.pia(this.properties.TogglesWhenExecuted)||this.toggle(),this.Sd.CommandValueId=this.toggleButton.OFb(),this.Sd.MenuItemId=this.toggleButton.Jh.MenuItemId,
this.Sd.SourceControlId=this.control.id,this.root.executeCommand(this.properties.Command,this.Sd,this.wk,h,!qf.a.pia(this.properties.CloseMenuWhenExecuted),B=>{qf.a.hs(this.properties.UpdateHtmlPostToggle)&&(32===B?this.oAj():this.mAj())},this.gY(r)))}mAj(){this.Sd[qg.a.On]=!this.Sd[qg.a.On]}oAj(){this.toggleButton.setState(this.Sd[qg.a.On]);(this.toggleButton.rAa&&this.toggleButton.$oe||qf.a.hs(this.properties.UpdateHtmlPostToggle))&&this.DVa()}toggle(){this.mAj();qf.a.hs(this.properties.UpdateHtmlPostToggle)||
this.oAj()}onKeyDown(b){const h=super.onKeyDown(b);if(!h&&!nf.c(b.Hb)&&this.iI){const r=b.Hb.keyCode;r!==Sys.UI.Key.enter&&r!==Sys.UI.Key.space||b.Hb.preventDefault()}return h}Hm(){nf.c(this.properties.MenuItemId)||(this.Sd.MenuItemId=this.properties.MenuItemId);0<(this.wu(this.properties.Command,this.properties.QueryCommand,this.Sd)&2)&&this.v9a()&&this.DVa()}DVa(){this.toggleButton.setState(this.Sd[qg.a.On]);this.MVo(qf.a.bsa(this.Sd[qg.a.DisplayMode],""));this.Ppg();this.Ika();this.zXo();qg.a.Alt in
this.Sd&&this.YSb()}zXo(){const b=this.dF.Kec;if(b&&b.Ahb){var h=qf.a.bsa(this.Sd[qg.a.Description],this.properties.Description);h!==b.Ahb.innerText&&(b.Ahb.innerText=h,b.UO&&!Object(Ib.a)(Mp.Jewel,this.root)&&(h=!nf.b(h),qf.a.j6(b.UO,"UIFontBold",h),qf.a.j6(b.UO,"cui-ctl-mediumlabel-nodescription",!h)))}}dJ(b){b=b.Ym;Sd.a.instance.ob(pd.a.focus,b,Object(z.a)(this,this.onFocus,"onFocus"));Sd.a.instance.ob(pd.a.blur,b,Object(z.a)(this,this.onBlur,"onBlur"));Dh.a.instance.ob(pd.a.pointerOver,b,Object(z.a)(this,
this.KP,"onPointerOver"));Dh.a.instance.ob(pd.a.pointerOut,b,Object(z.a)(this,this.SJ,"onPointerOut"));Jb.KeyInputManager.instance.ob(pd.a.gi,b,Object(z.a)(this,this.onKeyDown,"onKeyDown"));Jb.KeyInputManager.instance.ob(pd.a.yh,b,Object(z.a)(this,this.Uy,"onKeyUp"));Dh.a.instance.ob(pd.a.pointerDown,b,Object(z.a)(this,this.gD,"onPointerDown"));Dh.a.instance.ob(pd.a.jN,b,Object(z.a)(this,this.Cya,"onPointerUp"));ii.a.instance.ob(pd.a.click,b,Object(z.a)(this,this.onClick,"onClick"));On.a.instance.ob(pd.a.bQ,
b,Object(z.a)(this,this.$nb,"onTouchMove"));On.a.instance.ob(pd.a.hK,b,Object(z.a)(this,this.LHa,"onTouchEnd"))}}Object(m.a)(Xn,"ToggleButtonBehavior",Ug,[]);class np{constructor(b){this.HZj=b;this.iBe={["Button"]:h=>new dn(h),["FileMenuButton"]:h=>new dn(h),["ColorPicker"]:h=>new vb(h),["ComboBox"]:h=>new gl(h),["ContextMenuControl"]:h=>new Um(h),["ContextMenuLauncher"]:h=>new Um(h),["DialogMenuLauncher"]:h=>new Sk(h),["DropDown"]:h=>new tm(h),["FlyoutAnchor"]:h=>new Do(h),["GalleryButton"]:h=>new lp(h),
["StatefulColorFlyoutAnchor"]:h=>new Do(h),["JewelMenuLauncher"]:h=>new Ki(h),["Label"]:h=>new Er(h),["Placeholder"]:h=>new Ug(h),["SearchBox"]:h=>new vq(h),["Separator"]:h=>new Ug(h),["SplitButton"]:h=>new mp(h),["StatefulColorSplitButton"]:h=>new mp(h),["StatefulImageSplitButton"]:h=>new mp(h),["TextBox"]:h=>new ap(h),["ToggleButton"]:h=>new Xn(h)}}LWh(){this.iBe[yn.Control.sti]=b=>new In(b)}bif(){this.iBe[yn.Control.Quj]=b=>new jj(b)}YOl(b){const h=this.iBe[b.controlType];(b=h?h(b):null)&&this.HZj&&
b.mvl();return b}static get instance(){return np._instance||(np._instance=new np(!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("CUICommitChangeFixIsEnabled")))}}np._instance=null;Object(m.a)(np,"ControlBehaviorFactory",null,[527]);var aj=c(996),vk=c(150);class Ol extends gm.MenuLauncher{constructor(b,h,r,B){super(b,h,r,B);this.j5g=null;this.ONa=this.lFc=0;this.JF=null;this.Ayc=this.zyc=0;this.lh("Menu");this.enabled=!0}get x(){return this.lFc}get y(){return this.ONa}get DKf(){return this.zyc}get EKf(){return this.Ayc}get controlType(){return"DialogMenuLauncher"}S7a(){}m9a(){}epf(){const b=
{};b.MenuId=this.id;b.DialogMoveCommand=this.qt.DialogMoveCommand;b.DialogCloseCommand=this.qt.DialogCloseCommand;return b}E_m(b,h){this.lFc=b.x;this.ONa=b.y;this.zyc=b.height;this.Ayc=b.width;this.U0(h)}bR(b){this.j5g=qf.a.createElement("span");return new vk.a(b,this.j5g)}get qt(){return this.Jh}tva(b,h,r){return new Ol(b,this.id,h,r)}}Object(m.a)(Ol,"DialogMenuLauncher",gm.MenuLauncher,[]);var zn=c(829);class ih extends aj.a{constructor(b,h){super(b,h);this.k$a=null}get oZe(){return this.k$a}get zSh(){return this.properties}get A$(){return 20}Im(){super.Im();
nf.c(this.Nc)&&this.VC();this.Nc=qf.a.MTa(this.Nc);this.qX(this.Nc);this.dirty=!1}WO(b){if(!Object(Ib.a)(zn.a,b))throw Error.create("Only children of type StandaloneDock can be added to a DialogMenuRoot");}abf(b,h,r,B){r=new pe.Menu(this,h,r,B,null);b||(b={});b.CommandMenuOpen=this.zSh.CommandMenuOpen;b.CommandMenuClose=this.zSh.CommandMenuClose;b=new Ol(this,h,b,r);this.uDb[h]=b;h=new zn.a(this,"dock"+h);h.Bf(b.cR("Menu"));this.Bf(h);this.refresh()}ehg(b,h,r,B){const P=this.uDb[b];if(nf.c(P))throw Error.create('The dialog menu "'+
b+'" does not exist');P.E_m(new Sys.UI.Bounds(h,r,0,0),B);this.k$a=P.menu}N8e(b){b=this.uDb[b];nf.c(b)||(b.lva(),this.k$a=null)}U7d(){this.k$a=null}dispose(){const b=this.uDb;for(let h in b)b[h].dispose();super.dispose()}}Object(m.a)(ih,"DialogMenuRoot",aj.a,[]);class Yn{constructor(){this.LabelText=this.TextDirection=this.ImageSpinner=this.ImageExpandedArrowClass=this.ImageExpandedArrow=this.ImageCollapsedArrowClass=this.ImageCollapsedArrow=this.ImageUncheckMarkClass=this.ImageUncheckMark=this.ImageCheckMarkClass=
this.ImageCheckMark=this.ImageUpArrow8by8Class=this.ImageUpArrow8by8=this.ImageUpArrowClass=this.ImageUpArrow=this.ImageSideArrowClass=this.ImageSideArrow=this.ImageDownArrow8by8Class=this.ImageDownArrow8by8=this.ImageDownArrowClass=this.ImageDownArrow=this.DivSyndicated=null}}Object(m.a)(Yn,"RootProperties",null,[]);class Eo extends Yn{constructor(){super()}}Object(m.a)(Eo,"StandaloneRootProperties",Yn,[]);class Fo extends Eo{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}
Object(m.a)(Fo,"DialogMenuRootProperties",Eo,[]);class qq{constructor(){const b=new Fo;b.ImageSideArrow=v.AFrameworkApplication.Ns;b.ImageSideArrowClass=we.getImageClass("SubmenuFlyoutArrow_13x13x32");b.TextDirection=v.AFrameworkApplication.isRtl?"rtl":"ltr";this.Gd=new ih("DialogMenuRootId",b);this.Gd.JF=this;this.Gd.refresh();v.AFrameworkApplication.va.fb(fb.a.D1f,yd.a.frame,Object(z.a)(this,this.D1f,"populateDialogMenu"),96)}get Y1(){return this.Gd}vPa(b,h,r,B,P=null){b=parseInt(b);B=v.AFrameworkApplication.va;
r&&(B.MC=r.CommandLocation,B.I0=r.InvocationMethod);h=B.Qb(b,2,h,P);this.Gd.refresh();return 32===h}NGa(b){return b?32===v.AFrameworkApplication.va.processAction(parseInt(b),1):!0}wu(){this.Y1.root.Hm()}abf(b,h,r){const B={PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"3675896289",Command:"798637440"};B.DialogMoveCommand=h;B.DialogCloseCommand=r;this.Y1.abf(B,b,"","")}ehg(b,h,r,B){this.Y1.ehg(b,h,r,B)}N8e(b){this.Y1.N8e(b)}D1f(b,h,r,B,P){if(1===r)return 32;b=new Sys.StringBuilder;
b.append('<Menu Id="dialogMenu">');b.append('<MenuSection Id="dialogMenuSection" DisplayMode="Menu"><Controls>');b.append(String.format('<Button Id="DialogMenuMoveControl" Command="{0}" LabelText="{1}"/>',P.DialogMoveCommand,CommonUIStrings.l_DialogMove));b.append(String.format('<Button Id="DialogMenuCloseControl" Command="{0}" LabelText="{1}"/>',P.DialogCloseCommand,CommonUIStrings.l_DialogClose));b.append("</Controls></MenuSection>");b.append("</Menu>");P.PopulationXML=b.toString();return 32}dispose(){this.Gd&&
(this.Gd.dispose(),this.Gd=null)}}Object(m.a)(qq,"DialogMenuRootUser",null,[244,9,478]);class Oo{constructor(b,h,r){this.Wtb=this.Qxd=this.Dzc=this.Cl=null;this.REe=this.exd=!1;this.Ivc=b;this.ge=h;this.Bs=r;this.qYb=v.AFrameworkApplication.isRtl}get WAf(){return this.REe}$xl(b){b?(this.Cl=b,this.REe=!0,this.exd=!1,this.ge.capture(Object(z.a)(this,this.lZm,"keyEventHandler"),null),this.Bs.ob(pd.a.pointerDown,this.Ivc,Object(z.a)(this,this.jic,"pointerDownHandler")),this.Dzc||this.ycl(),this.Cl.appendChild(this.Dzc),
this.PAm()):t.ULS.sendTraceTag(21516492,201,10,"Cannot move null element")}Ljf(){this.REe=!1;this.Qxd=this.Wtb=null;this.c0n();this.B7f();this.Cl=null}B7f(){this.ge.releaseCapture();this.Bs.sc(pd.a.pointerDown,this.Ivc,Object(z.a)(this,this.jic,"pointerDownHandler"))}PAm(){if(this.Cl.style.left.endsWith("px")&&this.Cl.style.right.endsWith("px"))this.Wtb=new Sys.UI.Point(Sm.a.YY(this.qYb?this.Cl.style.right:this.Cl.style.left),Sm.a.YY(this.Cl.style.top));else{const b=this.qYb?this.Ivc.offsetWidth-
(this.Cl.offsetLeft+this.Cl.offsetWidth+Sm.a.YY(this.Cl.style.marginRight)):this.Cl.offsetLeft-Sm.a.YY(this.Cl.style.marginLeft),h=this.Cl.offsetTop-Sm.a.YY(this.Cl.style.marginTop);this.Pnj(b,h);this.Wtb=new Sys.UI.Point(b,h)}this.Qxd=this.Wtb}ycl(){this.Dzc=we.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}c0n(){this.Dzc.parentNode===this.Cl&&this.Cl.removeChild(this.Dzc)}lZm(b){if(!this.WAf)return!1;b.Hb.preventDefault();if(b.eventName===pd.a.gi){const h=b.Hb.ctrlKey?
1:10;let r;switch(b.Hb.keyCode){case se.a.v6:this.dgc(0,-1*h);break;case se.a.Lea:this.dgc(0,1*h);break;case se.a.dpc:r=this.qYb?1:-1;this.dgc(r*h,0);break;case se.a.dsb:r=this.qYb?-1:1;this.dgc(r*h,0);break;case se.a.YJa:this.XPi(this.Qxd.x,this.Qxd.y);this.exd=!0;break;case se.a.Ss:this.exd=!0}}b.eventName===pd.a.yh&&this.exd&&this.Ljf();return!0}jic(b){if(!this.WAf)return!1;b.Hb.preventDefault();this.Ljf();return!0}dgc(b,h){this.XPi(this.Wtb.x+b,this.Wtb.y+h)}XPi(b,h){b=this.IAk(b,h);this.Pnj(b.x,
b.y);this.Wtb=b}Pnj(b,h){this.qYb?this.Cl.style.right=b+"px":this.Cl.style.left=b+"px";this.Cl.style.top=h+"px"}IAk(b,h){const r=this.qYb?Sm.a.YY(this.Cl.style.marginRight):Sm.a.YY(this.Cl.style.marginLeft),B=Sm.a.YY(this.Cl.style.marginTop);return new Sys.UI.Point(Math.min(Math.max(-r,b),this.Ivc.offsetWidth-this.Cl.offsetWidth-r),Math.min(Math.max(-B,h),this.Ivc.offsetHeight-this.Cl.offsetHeight-B))}}Object(m.a)(Oo,"KeyMoveAdapter",null,[479]);var cr=c(1138),Fh=c(570);class fn{get name(){return"CUI.Behavior"}wc(b){v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&(b.register(478,"Common.UI.IDialogMenuRootUser").ha().Ud(()=>new qq),b.register(479,"Common.IKeyMoveAdapter").ha().Ud(()=>new Oo(v.AFrameworkApplication.ua.yoa(),Jb.KeyInputManager.instance,Dh.a.instance)));b.register(Fh.a,"CommandUI.RootManager").as("Common.IRootManager").ha().Ud(()=>Fh.a.instance)}init(){cr.a.aaf=np.instance;const b=Fh.a.instance.lgj;for(let h=0;h<b.length;++h){const r=Object(Ra.a)(480,b[h]);r&&r.pPa()}ij.a.get_instance().nI(6)}dispose(){}static main(){L.a.instance.Gc(new fn,
5)}}Object(m.a)(fn,"CuiBehaviorPackage",null,[1,2]);class jm{constructor(b){const h=new Eo;h.ImageUpArrow=h.ImageDownArrow=h.ImageSideArrow=h.ImageCheckMark=h.ImageUncheckMark=h.ImageDownArrow8by8=h.ImageUpArrow8by8=b;h.ImageUpArrowClass=we.getImageClass("RibbonUpArrow_5x3x32");h.ImageDownArrowClass=we.getImageClass("SplitButtonArrow_5x3x32");h.ImageUpArrow8by8Class=we.getImageClass("RibbonUpArrow_8x8x32");h.ImageDownArrow8by8Class=we.getImageClass("SplitButtonArrow_8x8x32");h.ImageSideArrowClass=
we.getImageClass("SubmenuFlyoutArrow_13x13x32");h.ImageCheckMarkClass=we.getImageClass("CheckboxChecked_16x16x32");h.ImageUncheckMarkClass=we.getImageClass("CheckboxUnchecked_16x16x32");h.TextDirection=v.AFrameworkApplication.isRtl?"rtl":"ltr";this.Ydb=aj.a.Yel(h);this.Ydb.refresh()}get pea(){return this.Ydb}dispose(){this.Ydb.dispose()}}Object(m.a)(jm,"StandaloneRootController",null,[850,9]);var tn=c(1163),mi=c(164);class Np{constructor(b){this.bCc=b}create(b,h){const r=new Sys.StringBuilder;this.SKc(r,
b,h);this.xbf(r,b);return r.toString()}jDb(b,h){const r=[];this.hcf(r,b,h);this.ybf(r,b);return r}SKc(b,h,r){switch(h.errorType){case 0:b.append(this.bCc.build());break;case 1:case 2:b.append(this.H5e(h,r))}}hcf(b,h,r){switch(h.errorType){case 0:b.push(this.bCc.vzh());break;case 1:case 2:b.push(this.xNk(h,r))}}xbf(b,h){b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>');b.append(mi.a("btnIgrnoreSpellingError",(2===h.errorType?Nb.a.PJa:Nb.a.kxa).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,
null));b.append("</Controls></MenuSection>")}ybf(b,h){const r=Object.assign(new di.a,{ControlList:[]});h=2===h.errorType?"UnknownSpellingError":"IgnoreSpellingError";r.ControlList.push(Object.assign(new ah.a,{ExternalId:h}));b.push(r)}H5e(b,h){b=this.xLl(b.suggestions,h);return 0<b.length?mi.g("msUnknownWord",mi.d(null,b),"Menu16"):mi.g("msUnknownWord",mi.d(null,[mi.a("btnNoSuggestions",Nb.a.PJa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)]),"Menu16")}xLl(b,h){const r=[];if(b){const B=Math.min(h.length,
b.length);for(let P=0;P<B;++P)b[P]&&r.push(mi.a("btnCorrectWord"+P,h[P].toString(),b[P]))}return r}xNk(b,h){const r=Object.assign(new di.a,{Id:"Suggestions",ControlList:[]});this.wLl(b.suggestions,h,r.ControlList);0>=r.ControlList.length&&(b=Object.assign(new ah.a,{ExternalId:"NoSuggestions"}),r.ControlList.push(b));return r}wLl(b,h,r){if(b){const B=Math.min(h.length,b.length);for(let P=0;P<B;++P){if(!b[P])continue;const ca=Object.assign(new ah.a,{ExternalId:"btnCorrectWord"+P,Command:h[P].toString(),
LabelText:b[P]});r.push(ca)}}}}Object(m.a)(Np,"DefaultProofingContextMenuCreator",null,[]);var bp=c(716);class pr{constructor(b,h){this.ORg=b;this.QTg=h;this.Bma=[Nb.a.hrb,Nb.a.irb,Nb.a.jrb,Nb.a.VRb,Nb.a.WRb]}create(b,h){return h?Object(Ib.a)(bp.a,h)?this.QTg.create(b,h,this.Bma):this.ORg.create(h,this.Bma):""}$5b(b,h){return h?Object(Ib.a)(bp.a,h)?this.QTg.jDb(b,h,this.Bma):this.ORg.jDb(h,this.Bma):null}}Object(m.a)(pr,"ProofingContextMenuSectionFactory",null,[646]);class Go{build(){const b=[mi.a("btnDeleteRepeatedWord",
Nb.a.zEa.toString(),Box4Intl.Box4Strings.l_DeleteRepeatedWord,null)];return mi.g("msRepeatedWord",mi.d(null,b),"Menu16")}vzh(){const b=Object.assign(new di.a,{ControlList:[]}),h=Object.assign(new ah.a,{ExternalId:"DeleteRepeatedWord"});b.ControlList.push(h);return b}}Object(m.a)(Go,"ProofingRepeatedWordSectionBuilder",null,[645]);class Bp{static get Vg(){return Pe.a.Kx(Bp.Xm,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,
Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}Bp.Xm="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> </table> </div>";
Object(m.a)(Bp,"AutoCorrectOptionsDialogHTML",null,[]);class uo{static get Vg(){return Pe.a.Kx(uo.Xm,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}uo.Xm="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='ReplaceQuoteWithSmartQuoteLabel' class='\"WACDialogInlineLabel\"' for='ReplaceQuoteWithSmartQuote'>{8}</label> </td> </tr> </table> </div>";
Object(m.a)(uo,"AutoCorrectOptionsDialogHTML2",null,[]);class Tk extends Pe.a{constructor(b,h){super();this.Ego=(r,B)=>{1!==r?t.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):B.ReplaceTextAsYouType!==this.aW.QTa||B.CapitalizeFirstLetterOfSentences!==this.aW.pFd||B.ReplaceOrdianalsWithSuperscript!==this.aW.fee||B.ReplaceHyphensWithDash!==this.aW.i7c||B.ReplaceFractionsWithFractionCharacter!==this.aW.eee||this.Ufa&&B.ReplaceQuoteWithSmartQuote!==
this.aW.D9f?(r={},r.ReplaceTextAsYouType=B.ReplaceTextAsYouType,r.CapitalizeFirstLetterOfSentences=B.CapitalizeFirstLetterOfSentences,r.ReplaceOrdianalsWithSuperscript=B.ReplaceOrdianalsWithSuperscript,r.ReplaceHyphensWithDash=B.ReplaceHyphensWithDash,r.ReplaceFractionsWithFractionCharacter=B.ReplaceFractionsWithFractionCharacter,this.Ufa&&(r.ReplaceQuoteWithSmartQuote=B.ReplaceQuoteWithSmartQuote),this.aW.pao(r),t.ULS.sendTraceTag(24523524,324,50,"User close the option dialog and trigger to save the setting: {0}"+
{["ReplaceTextAsYouType"]:B.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:B.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:B.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:B.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:B.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.Ufa,["ReplaceQuoteWithSmartQuote"]:this.Ufa&&B.ReplaceQuoteWithSmartQuote}),Eb.App.za.updateCommandUI(!0)):t.ULS.sendTraceTag(24523523,
324,50,"User close the option dialog or cancle it without do any changes.")};this.aW=b;this.Ufa=h;this.yg="AutoCorrectOptionsDialog"}vhg(){t.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.Vg=this.Ufa?uo.Vg:Bp.Vg;const b={};b.ReplaceTextAsYouType=this.aW.QTa;b.CapitalizeFirstLetterOfSentences=this.aW.pFd;b.ReplaceOrdianalsWithSuperscript=this.aW.fee;b.ReplaceHyphensWithDash=this.aW.i7c;b.ReplaceFractionsWithFractionCharacter=this.aW.eee;this.Ufa&&(b.ReplaceQuoteWithSmartQuote=
this.aW.D9f);this.Uh(Box4Intl.Box4Strings.l_AutoCorrectOptions,this.Ego,b)}}Object(m.a)(Tk,"AutoCorrectOptionsDialog",Pe.a,[644]);class dr{static get Vg(){return Pe.a.Kx(dr.Xm,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}dr.Xm="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(m.a)(dr,"AltTextDialogWithDescriptionHtml",null,[]);class dq{static get Vg(){return Pe.a.Kx(dq.Xm,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}dq.Xm="<div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(m.a)(dq,"AltTextDialogWithDescriptionNoTitleHtml",null,[]);class Po extends Pe.a{constructor(b=!1,h=!1){super(!1,!1,b);this.Woi=!1;h?(this.Woi=!0,this.Vg=dq.Vg):this.Vg=dr.Vg;this.yg=b?"AltTextDialog":"BaseAltTextDialogWithDescription"}Haf(b){this.Uh(CommonUIStrings.l_AlternativeTextDialogTitle,Object(z.a)(this,this.mCk,"altTextDialogHandler"),this.dqf(b));b=document.getElementById(Po.A1e)||document.getElementById(Po.SCd);b.focus();b.select()}dqf(b){const h={};this.Woi?h[Po.Pum]=!0:h[Po.A1e]=
this.aof(b);h[Po.SCd]=this.EVl(b)||"";return h}Uva(b){return b.yf.id===Po.SCd?!1:super.Uva(b)}}Po.A1e="titleText";Po.SCd="descriptionText";Po.Pum="hideTitleField";Object(m.a)(Po,"BaseAltTextDialogWithDescription",Pe.a,[]);var Rh=c(32);class wq extends Po{constructor(b,h,r,B,P){super();this.Mk=h;this.Tm=r;this.Zr=B;this.Qd=P;this.frb=this.cU=null;this.Haf(b)}EVl(b){this.cU=b.node;this.frb=Rh.TableReader.Cii(b);return Rh.TableReader.kvf(this.frb)}aof(b){this.cU=b.node;this.frb=Rh.TableReader.Cii(b);
return Rh.TableReader.lvf(this.frb)}mCk(b,h){if(1===b){b=Rh.TableReader.lvf(this.frb);const r=Rh.TableReader.kvf(this.frb),B=h[Po.A1e];h=h[Po.SCd];this.hide();const P=this.Zr.Pc(15);try{P.Db(this.cU),this.Mk.Meg(this.frb,B),this.Mk.Unj(this.frb,h)}finally{P&&P.dispose()}B===b&&h===r||this.Qd.Zs(16)}this.Tm.Uo&&this.Tm.fq.gG(this.cU)}}Object(m.a)(wq,"TableAltTextDialog",Po,[]);class Op{constructor(b,h,r){this.qA=b;this.Lc=h;this.Vd=r}create(b){return new wq(b,this.qA,Eb.App.zd,this.Lc,this.Vd)}}Object(m.a)(Op,
"TableAltTextDialogFactory",null,[]);const um=()=>{Eb.App.Osh=!0;return 32},cp=(b,h,r,B,P)=>{if(1===r)return 32;if(!({point:b,Rx:h}=op(P)).returnValue)return 16;Eb.App.za.Slc(b,h);return 32},qr=(b,h,r,B,P)=>{if(1===r)return 32;if(!({point:b,Rx:h}=op(P)).returnValue)return 16;Eb.App.za.ika(b,h);return 32},op=b=>{let h=null,r=0;if(!b)return{returnValue:!1,point:h,Rx:r};b=b.split(",");if(3>b.length)return{returnValue:!1,point:h,Rx:r};h=new Sys.UI.Point(parseInt(b[0]),parseInt(b[1]));r=parseInt(b[2]);
return{returnValue:!0,point:h,Rx:r}};var ml=c(1851);class fs extends Sys.EventArgs{constructor(b,h,r,B,P,ca=0,ra=0,Qa=null){super();this.controlId=b;this.Uhc=r;this.commandId=B;this.time=P;this.commandSurface=ca;this.Rx=ra;this.contentType=Qa}}Object(m.a)(fs,"CommandClickEventArgs",Sys.EventArgs,[]);class rr{constructor(b,h){this.gta=b.Ppf();this.dtc=b;this.e$a=h}vPa(b,h,r,B=null,P=null){r&&(this.e$a.MC=r.CommandLocation,this.e$a.I0=r.InvocationMethod,this.e$a.GOa=r.CommandTabName);b=parseInt(b);
let ca=this.dtc.E9h(b,h,r);ca.SSf&&(ca=this.dtc.E9h(ca.qM,h,r));if(void 0!==ca.z1a&&null!==ca.z1a)return ca.z1a;if(ca.OHb)P=32;else{var ra=null;this.gta&&this.gta.$1f&&(ra=this.gta.$1f(ca,P));ca.zia||ca.TXc?ca.TEa?P=16:(P=this.e$a.Qb(ca.qM,ca.Edc?2:1,ca.vd,P),2===P&&(P=32)):ca.TEa?P=this.e$a.Rqa(null,ca.qM,ca.vd,Qa=>{B&&B(Qa.response)},P):(P=this.e$a.Qb(ca.qM,2,ca.vd,P),B&&B(P));this.gta&&this.gta.T1f&&this.gta.T1f(ca,P,ra);if(h&&r&&-1!==r.InvocationMethod&&r.InvocationMethod){r=h.LegacyId;if(void 0===
r||null===r)r="";ra=h.ParentMenuId;void 0!==ra&&null!==ra||!h.MenuId||(ra=h.MenuId);let Qa=h.SqmControlId;void 0!==Qa&&null!==Qa||!h.SourceControlId||(Qa=h.SourceControlId);(void 0!==Qa&&null!==Qa||void 0!==ra&&null!==ra)&&ml.a.TNn(new fs(Qa,r,ra,cd.ActionManager.yba(b),Date.now()))}}ca.zia&&32===P&&this.gta&&this.gta.pDa&&this.gta.pDa(ca,h);ca.TXc&&32===P&&this.gta&&this.gta.K_a&&this.gta.K_a(ca,h);return 32===P||1===P}NGa(b,h=null){if(v.AFrameworkApplication.Rk||Wg.a.instance.Rv)return!1;null!=
h&&null!=h.UILocation&&(this.e$a.MC=h.UILocation);const r=parseInt(b);if(!b||r===cd.ActionManager.Uhf)return!0;b=this.dtc.u9h(r,h);b.SSf&&(b=this.dtc.u9h(b.qM,h));if(void 0!==b.z1a&&null!==b.z1a)return b.z1a;r===fb.a.w2b&&h&&(b.vd=h);return 32===this.e$a.Qb(b.qM,1,b.vd)}clearCache(){this.dtc.clearCache()}}Object(m.a)(rr,"GeneralCuiUser",null,[243,244]);var vo=c(197),Ck=c(98),Hl=c(59),ko=c(1076);class Fr{get uE(){return null!=this.JJg?this.JJg:this.JJg=Ma.a.instance.resolve("Box4.Styles.IWACStyleEditor")}constructor(b,
h,r,B){this.fTg="DocumentProofingFailed";this.IVe=b;this.ajh=h;this.jhd=r;this.NI=B}qdm(){const b=this.NI.xam(this.IVe);return{returnValue:this.NI.zFa(this.IVe),yKn:b}}yXo(b,h){const r=Ck.a.Ar();if(r){var B=new vo.ScriptSharpLegacyMap;B.add(Pd.a.uL,b);B.add(Mc.a.noProof,h);b=new cg.GraphTransaction(15);b.Db(r);this.uE.ASa(Hl.StyleReader.wordStyleIdNormal,B,r)?ko.a.CBj():(t.ULS.sendTraceTag(555775183,375,10,"Style could not be modified"),ko.a.recordQosError(this.fTg,[ko.a.DBc],"Style could not be modified"));
b.dispose()}else t.ULS.sendTraceTag(555775182,375,10,"PageContentNode not found"),ko.a.recordQosError(this.fTg,[ko.a.DBc],"PageContentNode not found")}eio(b,h){this.yXo(b,h)}uno(b,h){if(this.ajh){var r=new fd.DictionaryPropertySet;this.jhd.execute(B=>{B.pNc(b)});r.setValue(Pd.a.uL,b);r.setValue(Mc.a.noProof,h);h=new cg.GraphTransaction(15);h.set(Eb.App.si.Il);this.ajh.N5(r);h.dispose()}}Ze(){return xe.SelectionEditor.Ze(this.IVe)}}Object(m.a)(Fr,"LanguageEditor",null,[643]);var lo=c(611),Pp=c(250),
Qo=c(105);class pp{constructor(b=!1,h=0){this.languages=pp.Dhi(lj.a.uUl());this.Lqd=new Pp.a;this.xTa=[];this.u_b=new lo.a;this.Z7i=b;this.Nch=0>=h?7:h;this.Mch=this.XPe=0;this.hYg=!1;b&&(this.YBm(),v.AFrameworkApplication.qI(()=>{this.o7m()}))}YBm(){for(var b of this.languages)this.Lqd.Z(b.LCID,b);b=[];try{const B=Hc.a.get("RecentlyUsedLcids");if(B&&""!==B){const P=decodeURIComponent(B).split(",").slice(0,this.Nch);for(const ca of P){let ra;({value:ra}=this.Lqd.Fc(parseInt(ca),ra)).returnValue&&
b.push(ra)}}}catch(B){t.ULS.sendTraceTag(38385057,324,15,"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",B.message),Array.clear(b)}if(b.length)for(var h of b){var r=h.LCID;this.u_b.contains(r)||(this.xTa.push(h),this.u_b.add(r))}else h=v.AFrameworkApplication.lcid,({value:r}=this.Lqd.Fc(h,r)).returnValue&&(this.xTa.push(r),this.u_b.add(h));this.nhj()}nhj(){const b=Qo.toArray(Qo.select(Qo.asEnumerable(this.xTa),h=>h.LCID)).join(",");Hc.a.PIa("RecentlyUsedLcids",
b,180)}m2l(b){let h,r=-1,B=null;var P=pp.Dhi(this.xTa);this.Z7i&&0<P.length&&(B=Qo.toArray(Qo.Si(Qo.asEnumerable(P),(Qa,tb)=>{b===Qa.LCID&&-1===r&&(r=tb);return{["key"]:tb,["text"]:Qa.displayName,["value"]:Qa.LCID.toString()}})));let ca=0;B&&(ca=B.length);P=ca;const ra=Qo.toArray(Qo.Si(Qo.asEnumerable(this.languages),(Qa,tb)=>{b===Qa.LCID&&-1===r&&(r=ca+tb);return{["key"]:ca+tb,["text"]:Qa.displayName,["value"]:Qa.LCID.toString()}}));h=r;return 0<ca?{returnValue:B.concat.apply(B,ra),selectedIndex:h,
fvj:P}:{returnValue:ra,selectedIndex:h,fvj:P}}oko(b,h){if(this.Z7i&&({value:r}=this.Lqd.Fc(b,r)).returnValue){h=b!==h;if(this.u_b.contains(b))b=Array.indexOf(this.xTa,r),0<=b&&(Array.removeAt(this.xTa,b),this.xTa.push(r)),h&&this.XPe++;else{this.u_b.add(b);this.xTa.push(r);if(this.xTa.length>this.Nch){var r=this.xTa.shift();this.u_b.remove(r.LCID)}h&&this.Mch++}this.nhj()}}o7m(){const b=this.XPe+this.Mch;!this.hYg&&0<b&&(t.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",
100*this.XPe/b),this.hYg=!0)}static Dhi(b){b=Array.clone(b);b.sort((h,r)=>h.displayName.localeCompare(r.displayName));return b}}Object(m.a)(pp,"LanguageListHelper",null,[642]);var rq=c(195);class ek extends rq.a{constructor(){super();this.Type=this.Number=0}get ControlType(){return 10}}Object(m.a)(ek,"NumberButtonProps",rq.a,[]);var An=c(214);class km{static get W5(){return null!=km.eHg?km.eHg:km.eHg=Ma.a.instance.Oa("Box4.ISpacingCommands")}static get ah(){return An.ContextSetEditor.instance}static get n5a(){return null!=
km.bEg?km.bEg:km.bEg=Ma.a.instance.Oa("Box4.ILineSpacingHelper")}static get Wqj(){return!!km.W5}static Tb(){const b=v.AFrameworkApplication.va;b.ra(Nb.a.qic,yc.a.view,km.qic);b.Xc(Nb.a.qic,1124);b.ra(Nb.a.qic,yc.a.paragraph,km.GXo)}static qic(b,h,r,B,P){if(1===r||!km.Wqj)return km.Wqj?32:8;if(!km.mAi){var ca=[];ca.push(Object.assign(new ek,{ExternalId:"LineSpacing1_00",Number:1,Type:0}));ca.push(Object.assign(new ek,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0}));ca.push(Object.assign(new ek,
{ExternalId:"LineSpacing1_50",Number:1.5,Type:0}));ca.push(Object.assign(new ek,{ExternalId:"LineSpacing2_00",Number:2,Type:0}));ca.push(Object.assign(new ek,{ExternalId:"LineSpacing2_50",Number:2.5,Type:0}));ca.push(Object.assign(new ek,{ExternalId:"LineSpacing3_00",Number:3,Type:0}));P.MenuItems=mi.e(ca);km.mAi=!0}t.ULS.sendTraceTag(588394560,340,50,"Line Spacing Menu is opened");h=h.view.mb;ca=null;h&&h.ib.lb&&(ca=h.ib.lb);h=km.ah.P3h(ca.Pa);v.AFrameworkApplication.va.Nf(h,b,r,!0,B,P);return 32}static GXo(b,
h){let r=b=!0;h=km.n5a.nQa(h.node);var B=h.beforeSpacing;let P=!1;1===B.unit&&(P=!0);if(P||0<B.value)b=!1;h=h.afterSpacing;B=!1;1===h.unit&&(B=!0);if(B||0<h.value)r=!1;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(km.uvk,!b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(km.O0n,b));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(km.tvk,!r));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(km.N0n,r));return 32}}km.uvk="AddSpaceBeforeParagraph";
km.tvk="AddSpaceAfterParagraph";km.O0n="RemoveSpaceBeforeParagraph";km.N0n="RemoveSpaceAfterParagraph";km.mAi=!1;Object(m.a)(km,"LineSpacingRibbonMenu",null,[]);var al=c(182),eq=c(1706),Sr=c(1398),Qi=c(135);const gs=(b,h,r)=>{if(1===r)return 32;b=Eb.App.za.notificationBar.Cva("Automation test",!1);b.image=3;Eb.App.za.notificationBar.sA(b);return 32},sr=(b,h,r,B,P)=>{let ca;if(!({YIj:ca}=Gr(P)).returnValue)return 16;al.UISurfaces.LM().then(ra=>{let Qa=null;var tb=Object.assign(new eq.a,{label:"OK",
onExecute:()=>{Qa&&ra.removeNotification(Qa)}});tb=Object.assign(new Sr.a,{target:"#"+Qi.AppFrame.qag,content:"Here's the text for the callout",title:"Your title",primaryButtonProps:tb,useTeachingStyles:ca});tb=ra.callout(tb);Qa=ra.addNotification(tb);return null},ra=>{t.ULS.sendTraceTag(593352341,383,15,"Failed to GetNotificationsAPIAsync: {0}",ra);return null});return 32},Gr=b=>{let h=!1;if(!b)return{returnValue:!1,YIj:h};h=Boolean.parse(b);return{returnValue:!0,YIj:h}};var Gq=c(1488);let qp,wk,
Bn,Ho,am;class dp{constructor(){this.G7=new mb.a;this.G2g=!1}w_a(b){const h=this.G7.indexOf(b);let r=!0;if(-1!==h){r=!1;if(!h)return r;this.G7.removeAt(h)}this.G7.insert(0,b);t.ULS.sendTraceTag(594899716,340,50,"{0} is added at the start of recent color list.",b);11===this.G7.count&&(t.ULS.sendTraceTag(594899715,340,50,"Removing {0} from the recent color list.",this.G7.J(10)),this.G7.removeAt(10));this.hZo();return r}Hoe(b){let h="#";for(let B=0;B<this.G7.count;B++){var r="#"+this.G7.J(B).substring(4,
6)+this.G7.J(B).substring(2,4)+this.G7.J(B).substring(0,2);r=Object.assign(new Gq.a,{Color:this.G7.J(B),Alt:r,DisplayColor:r});if(r.DisplayColor.toLowerCase()===b.toLowerCase()){h=r.Color;break}}for(const B of dp.Jch)appChrome.api.dispatch(appChrome.actions.updateColorPickerSelectedColor(B,h))}hZo(){t.ULS.sendTraceTag(594899714,340,50,"Sending a redux action to populate the recent colors menu section");const b=[];for(let r=0;r<this.G7.count;r++){var h="#"+this.G7.J(r).substring(4,6)+this.G7.J(r).substring(2,
4)+this.G7.J(r).substring(0,2);h=Object.assign(new Gq.a,{Color:this.G7.J(r),Alt:h,DisplayColor:h});b.push(appChrome.api.colorPickerCell(h.Color,h.DisplayColor,h.Alt))}for(const r of dp.Jch)appChrome.api.dispatch(appChrome.actions.populateColorPickerCells(r,b));this.G2g||this.dYo();this.G2g=!0}dYo(){for(const b of Object.keys(dp.l7g)){t.ULS.sendTraceTag(594899713,340,50,"Sending a redux action to update the {0} menu",b);const h=dp.l7g[b],r=[];for(const B of h)r.push(appChrome.api.menuSection([B],B in
dp.RKe?dp.RKe[B].toString():null));appChrome.api.dispatch(appChrome.actions.updateMenu(b,r,dp.RKe[b].toString()))}}}dp.l7g={["FontColor"]:(am=new mb.a,am.add("AutomaticFontColor"),am.add("ThemeFontColorPickerMCU"),am.add("ThemeFontColorPicker"),am.add("StandardFontColorPicker"),am.add("RecentFontColorPicker"),am.add("MoreFontColors"),am),["CellShading"]:(Ho=new mb.a,Ho.add("ThemeShadingColorPickerMCU"),Ho.add("ThemeShadingColorPicker"),Ho.add("StandardShadingColorPicker"),Ho.add("RecentCellShadingColorPicker"),
Ho.add("ClearShadingColor"),Ho.add("MoreCellShadingColors"),Ho),["PictureBorders"]:(Bn=new mb.a,Bn.add("ThemePictureBorderColorPickerMCU"),Bn.add("ThemePictureBorderColorPicker"),Bn.add("StandardPictureBorderColorPicker"),Bn.add("RecentPictureBorderColorPicker"),Bn.add("MorePictureBorderColors"),Bn.add("NoPictureBorder"),Bn.add("PictureBorderWeightOptions"),Bn.add("PictureBorderStyleOptions"),Bn),["PageColor"]:(wk=new mb.a,wk.add("ThemePageColorPickerMCU"),wk.add("ThemePageColorPicker"),wk.add("StandardPageColorPicker"),
wk.add("RecentPageColorPicker"),wk.add("NoPageColor"),wk.add("MorePageColors"),wk)};dp.RKe={["StandardFontColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardPageColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["RecentFontColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentHighlighterColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentCellShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,
["RecentPictureBorderColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentPageColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["FontColor"]:Box4Intl.Box4Strings.L_FontColor,["Highlighter"]:Box4Intl.Box4Strings.L_HighlightColor,["CellShading"]:Box4Intl.Box4Strings.L_CellShadingColor,["PictureBorders"]:Box4Intl.Box4Strings.L_PictureBorderColor,["PageColor"]:Box4Intl.Box4Strings.L_PageColor};dp.Jch=(qp=new mb.a,qp.add("RecentFontColorPicker"),qp.add("RecentCellShadingColorPicker"),qp.add("RecentPictureBorderColorPicker"),
qp.add("RecentPageColorPicker"),qp);Object(m.a)(dp,"RecentColorsSectionHandler",null,[]);var Hr=c(1426),vm=c(1073);class Mj{constructor(b){this.Nek=b}p5(){}n5(b){this.Nek.yin(b)}}Object(m.a)(Mj,"DataBuddyActionListener",null,[33]);class Uk{constructor(){this.type="DataBuddyTaskPaneProps";this.onClearClick=this.clearButtonLabel=this.actions=null}}Object(m.a)(Uk,"DataBuddyTaskPaneProps",null,[]);class wo{constructor(b){this.isVisible=!1;this.AZ=new mb.a;this.Ise=null;this.G3=b;this.kB=new Hr.a;this.Vb=
pc.FocusManager.instance()}initialize(){this.Ise=new Mj(this);this.G3.UOa();this.kB.FL(this.Cuk());this.kB.FL(this.Erk())}toggle(){this.isVisible?this.hide():this.show()}yin(b){if(2===b.behavior){const h=cd.ActionManager.yba(b.actionId)||b.actionId.toString();h.startsWith("Query")||(this.AZ.add(h+": "+wo.oMl(b.response)),this.Mm())}}hide(){al.UISurfaces.Nu().then(b=>{b.hideTaskPane(wo.lC,2);return null})}show(){al.UISurfaces.Nu().then(b=>{b.showTaskPane(wo.lC,this.xA());return null});this.isVisible&&
al.UISurfaces.Nu().then(b=>{b.setSelectedTaskPane(wo.lC);return null})}Cuk(){return b=>{b.actions=this.AZ.toArray();b.clearButtonLabel=CommonUIStrings.l_WAC_DataBuddyClearButtonLabel}}Erk(){return b=>{b.onClearClick=()=>{this.AZ.clear();this.Mm()}}}Tb(){v.AFrameworkApplication.va.eZ(this.Ise)}j9a(){v.AFrameworkApplication.va.JSb(this.Ise)}xA(){const b=new Uk;this.kB.$pb(b);return Object.assign(new vm.a,{title:"Data Buddy",hideHeader:!1,width:wo.width,location:2,contentProps:b,onOpen:()=>{this.G$();
this.Tb();this.isVisible=!0;v.AFrameworkApplication.ua.updateCommandUI()},onClose:()=>{this.kea();this.j9a();this.isVisible=!1;this.Mm();v.AFrameworkApplication.ua.updateCommandUI()},isModernPane:!0})}Mm(){al.UISurfaces.Nu().then(b=>{b.updateTaskPane(wo.lC,this.xA());return null})}G$(){this.Vb.mg(wo.lC)}kea(){this.X4a()&&this.Vb.mg(this.Vb.gU)}X4a(){return!!this.Vb.currentScope&&this.Vb.currentScope.name===wo.lC}static oMl(b){switch(b){case 0:return"Unattempted";case 1:return"In Progress";case 2:return"Not Handled";
case 4:return"Handle Externally";case 8:return"Failed";case 16:return"Error";case 32:return"Succeeded";case 64:return"Delayed";default:return b.toString()}}}wo.lC="DataBuddyTaskPane";wo.width=300;Object(m.a)(wo,"Box4DataBuddyTaskPane",null,[476]);class nl{constructor(b){this.Nh=b}SJa(b){this.Nh&&this.Nh.jH(b)}udd(){this.Nh&&this.Nh.Jdd(void 0)}}Object(m.a)(nl,"RibbonButtonUpdater",null,[475]);var Il=c(372);class Qp{constructor(){this.STe=this.W=null}get name(){return"Box4.UI"}wc(b){this.W=b;b.ia("Box4.IGeneralCuiUser",
()=>new rr(b.resolve("Box4.UI.CuiActionBridge"),v.AFrameworkApplication.va)).ha();b.ia("Box4.UI.TableAltTextDialogFactory",()=>new Op(b.resolve("Box4.ITableEditor"),new Il.a,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).ha();b.ia("Box4.UI.ILanguageEditor",()=>new Fr(Bh.a.instance.qg,b.Oa("Box4.ITextFormattingCommands"),b.Ta("Box4.IAutoCorrectRules"),b.resolve("Box4.ILanguageReader")));b.ia("CommandUI.StandaloneRootController",()=>new jm(v.AFrameworkApplication.Ns)).as("Common.IStandaloneRootController").ha();
b.ia("Box4.UI.IAutoCorrectOptionsDialog",()=>new Tk(b.resolve("Box4.IAutoCorrectOptionsInfo"),v.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled")));b.ia("Box4.UI.LanguageListHelper",()=>new pp(v.AFrameworkApplication.K.$("RecentlyUsedLanguagesListIsEnabled"))).as("Box4.UI.ILanguageListHelper").ha();b.register(Go,"Box4.UI.ProofingRepeatedWordSectionBuilder").as("Box4.UI.IProofingRepeatedWordSectionBuilder").ha();b.ia("Box4.UI.DefaultProofingContextMenuCreator",()=>new Np(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"))).ha();
b.ia("Box4.UI.ProofingContextMenuSectionFactory",()=>new pr(b.resolve("Box4.UI.DefaultProofingContextMenuCreator"),b.resolve("Box4.UI.EditorServiceProofingContextMenuCreator"))).as("Box4.UI.IProofingContextMenuSectionFactory").ha();b.ia("Box4.RibbonButtonUpdater",()=>new nl(this.W.resolve("Box4.IAppFrame"))).as("Common.IRibbonButtonUpdater").ha();b.ia("Box4.UI.RecentColorsSectionHandler",()=>new dp).ha();b.ia("Common.IDataBuddyTaskPane",()=>new wo(tn.a.instance)).ha()}init(){var b=Eb.App.za;const h=
b.Kb;Ca.Szm(Object(z.a)(h,h.oMb,"onAuthenticationLost"),Object(z.a)(h,h.pMb,"onAuthenticationRestored"),b.zTk);b=v.AFrameworkApplication.va;b.ra(Nb.a.uHn,yc.a.application,um);b.fb(Nb.a.fwo,yc.a.application,cp,96);b.fb(Nb.a.Owo,yc.a.application,qr,96);b=v.AFrameworkApplication.va;b.fb(Nb.a.Ayo,yc.a.application,gs,96);b.fb(Nb.a.Wvo,yc.a.application,sr,96);km.Tb();this.eCm();this.STe=this.W.resolve("Common.IStandaloneRootController")}eCm(){this.W.Ta("Box4.IGeneralCuiUser").execute(b=>{this.W.Ta("Common.IStandaloneRootController").execute(h=>
{h.pea.JF=b})})}dispose(){this.STe.dispose();this.STe=null}static main(){L.a.instance.Gc(new Qp,6)}}Object(m.a)(Qp,"Box4UIPackage",null,[1,2]);var Tl=window.InsightsTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InsightsTaskPane",Title:"STR@L_SmartLookupPaneTitle",Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"InsightsIFrameContainer",IsStretched:"true"}}]}]}]},Vq=c(1866);class mo{get name(){return"Box4.Insights"}init(){}dispose(){}wc(b){b.ia("Box4.Insights.Box4InsightsSelection",
()=>new Vq.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ha()}}Object(m.a)(mo,"Box4InsightsPackage",null,[1,2]);const bm=b=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+b)};var Rp=c(402),Pl=c(547),Vk=c(703),Cn=c(1836);class Ro{dnb(){return!1}reset(){}update(){}}Object(m.a)(Ro,"NullTaskYieldStrategy",null,[458]);var Hq=c(1430);class aa{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=
this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(m.a)(aa,"CatchUpConfiguration",null,[]);class oa{constructor(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=
this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}}Object(m.a)(oa,"SharedControllerFactoryParameters",null,[]);var ub=c(163),qb=c(15);class Ec{constructor(b,h,r,B){this.wvn=(P,ca)=>{(this.Aod=!this.Aod)&&ca.ik&&ca.ik.contextId===yc.a.Uc&&this.QDh(ca.ik.node,ca.ik.Wj);return 32};this.jy=b;this.Xo=h;this.ga=r;this.Vb=B;this.kqd=this.lqd=null;this.Aod=!1;this.ga.ra(qb.a.Yzj,yc.a.view,this.wvn);this.Vb.fe(Dd.AFrame.Ap).bindAction(Jb.KeyInputManager.ic(se.a.rqc,
6),qb.a.Yzj)}UY(b,h){this.Aod&&this.Xo&&h&&h.yl&&h.yl.lb&&h.yl.lb.Pa&&h.yl.lb.Pa.node&&h.yl.lb.Pa.contextId===yc.a.Uc&&this.QDh(h.yl.lb.Pa.node,h.yl.lb.Pa.Wj)}QDh(b,h){b&&(this.SRi(b)?(this.lqd&&this.lqd.id.equals(b.id)||(this.Xo.sendNotification(WordEditorIntl.WordEditorStrings.L_CatchUpActivityParagraphAnnouncementTemplate,!1),this.lqd=b),this.U9m(b,h)):this.kqd=this.lqd=null)}SRi(b){return 0<this.jy.FGb(b).count}U9m(b,h){if(b){var r=-1,B=null,P=null;for(let ca=0;ca<b.qa.length;ca++){const ra=b.qa.J(ca);
if(!(null==P||ra.changeStart&&ra.changeStart.equals(B))&&h>=r&&h<=ra.cp&&!B.equals(this.kqd))if(this.jy.yJb(B)){(b=this.jy.nPc(B,b.id))&&0<b.actors.length&&b.displayTimestamp&&(b=String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityChangeAnnouncementTemplate,b.actors[0].displayName,b.displayTimestamp.toLocaleString()),this.Xo.sendNotification(b,!1),this.kqd=B);break}else this.kqd=null;ra.changeStart&&!ra.changeStart.equals(B)&&(r=ra.cp,B=ra.changeStart);P=ra.changeStart}}}}Object(m.a)(Ec,
"ActivityAnnouncementManager",null,[]);var gd=c(1399),rd=c(539),Wd=c(775),De=c(596);class Pf{constructor(){this.activityId=null;this.type=0;this.priorityId=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(m.a)(Pf,"Activity",null,[]);var If=c(393);class Vg extends Pf{constructor(){super();this.Iv=this.objectId=null}static fH(b){const h=new De.a(new If.a);if(b.Iv)for(const r of b.Iv)h.add(r);return h}}Object(m.a)(Vg,"RevisionSetActivity",Pf,[]);class tg{constructor(b,
h,r,B=!1){this.fxe=null;this.dismiss=()=>{this.nSi.then(P=>{P.removeNotification(this.fxe);return this.fxe=null})};this.wX=b;this.oc=h;this.nSi=r;this.pdc=B}iQo(b){if(b)switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:this.oc.Qb(fb.a.Y5a,2,null);break;default:this.Din()}else t.ULS.sendTraceTag(593049027,3012,10,"Null activity: TryNotifyContentDoesNotExist. Unable to notify.")}Din(){this.nSi.then(b=>{var h=Object.assign(new Sr.a,{target:'[data-unique-id~="CatchUpWithChanges"]',
showCloseIcon:!0,content:CommonUIStrings.l_ChangeDoesNotExistNotification,calloutProps:Object.assign(new gd.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});h=b.callout(h);const r=Object.assign(new rd.a,{expirationOptions:Object.assign(new Wd.a,{displayTimeoutSeconds:10,onExpire:this.dismiss})});this.fxe=b.addNotification(h,r)})}doesContentExist(b){if(!b)return t.ULS.sendTraceTag(593049026,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(b.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!b.navigationId)return t.ULS.sendTraceTag(593049025,
3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;const h={};h.NavigationId=atob(b.navigationId);if(8===this.oc.Qb(fb.a.ZLd,2,h))return!1;break;case 1:return this.srl(b)}return!0}srl(b){b=Vg.fH(b);return b?0<this.wX.dSd(b).count:(t.ULS.sendTraceTag(593049024,3012,10,"Null changeIds: DoRevisionsExist. Default to false."),!1)}}Object(m.a)(tg,"ActivityContentManager",null,[608]);var ag=c(1500),Ci=c(2067),Dg=c(392),Te=c(708);class sj{constructor(){this.Iv=this.oY=null}compare(b){if(!b)return!1;
if(this.oY&&b.oY){if(this.oY.count!==b.oY.count)return!1;for(const h of this.oY)if(!b.oY.contains(h))return!1}else if(!b.oY&&this.oY||!this.oY&&b.oY)return!1;if(b.Iv&&this.Iv){if(b.Iv.count!==this.Iv.count)return!1;for(const h of this.Iv)if(!b.Iv.contains(h))return!1}else if(!this.Iv&&b.Iv||!b.Iv&&this.Iv)return!1;return!0}}Object(m.a)(sj,"ActivityHighlightableObject",null,[]);class fk extends ag.a{constructor(b,h){super();this.hPe=this.i_b=null;this.vgd=b;this.jy=h;this.f3=[new Ci.a(Dg.a.xCh,Dg.a.wCh),
new Ci.a(Dg.a.uCh,Dg.a.tCh),new Ci.a(Dg.a.uFd,Dg.a.vFd),new Ci.a(Dg.a.wFd,Dg.a.e7e)]}get gkb(){return 1}get A3a(){return this.f3}get Nca(){return!0}V2a(b,h){if(b=Object(Ra.a)(sj,b))if(b.oY)for(const r of b.oY)h.add(r);else t.ULS.sendTraceTag(594900750,377,15,"Activity Highlight: no highlightable paragraphs")}HHa(b,h){if(this.Dr.mEa){var r=this.vgd.J7a,B=this.vgd.ikb,P=!!r&&r.compare(B),ca=this.Dr.mEa,ra=ca.action,Qa=this.Rso(ca,b),tb=!1;2!==ra&&ra&&(tb=(tb=this.Dr.vZc)?1===tb.type:!!r||!!B);h=h.dIa("*");
for(let Mb=0,Zb=h.length;Mb<Zb;Mb++){const jc=h[Mb],Gc=this.TWl(jc,Dg.a.hIc);if(Gc&&Gc.mu)if(this.E_n(jc),1===ca.type)switch(ra){case 0:Qa&&r.Iv.contains(Gc.mu)&&this.rDd(jc,2,Gc,!1);break;case 2:Qa&&B.Iv.contains(Gc.mu)&&this.rDd(jc,P?2:1,Gc,!1);break;default:this.Tac(b,jc,Gc,!1)}else tb?this.Tac(b,jc,Gc,!1):this.Tac(b,jc,Gc,!0)}this.i_b&&(this.i_b.classList.add(Dg.a.wFd),this.hPe=this.i_b=null)}}TWl(b,h){return Xb.a.Eb(b,h)}Rso(b,h){if(b&&b.HA){const r=b.HA,B=b.action;if(1===b.type&&(2===B||!B)&&
r.oY)return r.oY.contains(h);if(r.Iv)for(const P of r.Iv){b=this.jy.IQc(P);for(const ca of b)if(ca===h)return!0}}return!1}Tac(b,h,r,B){const P=this.vgd.J7a,ca=this.vgd.ikb;P&&P.Iv.contains(r.mu)&&(!P.oY||P.oY.contains(b))?this.rDd(h,2,r,B):ca&&ca.Iv.contains(r.mu)&&(!ca.oY||ca.oY.contains(b))&&this.rDd(h,1,r,B)}rDd(b,h,r,B){b&&Te.a(b)&&(b.classList.add(this.U_l(2===h,B)),this.Bjo(b,r,B))}Bjo(b,h,r){this.i_b?-1!==h.cpEnd&&this.hPe.cpEnd!==h.cpBegin&&(this.i_b.classList.add(r?Dg.a.e7e:Dg.a.wFd),b.classList.add(r?
Dg.a.vFd:Dg.a.uFd)):b.classList.add(r?Dg.a.vFd:Dg.a.uFd);b.classList.add(Dg.a.vCh);this.i_b=b;this.hPe=h}E_n(b){this.Dr.JTa(b);this.uZn(b)}uZn(b){b.classList.remove(Dg.a.uFd,Dg.a.vFd,Dg.a.vCh,Dg.a.wFd,Dg.a.e7e)}U_l(b,h){return h?b?Dg.a.tCh:Dg.a.wCh:b?Dg.a.uCh:Dg.a.xCh}}Object(m.a)(fk,"ActivityHighlightActor",ag.a,[]);var ol=c(2068),Rg=c(169);class hn{constructor(b,h,r,B,P,ca,ra,Qa){this.wW=b;this.jO=h;this.jy=r;this.Iek=P;this.hb=ca;this.Xo=Qa;this.Vb=ra;this.jO.w0d=!1}tYi(b,h,r){b?this.$um(b,h,r):
this.jO.J7a&&(b=Object.assign(new ol.a,{action:1,type:1,HA:null,VJ:this.jO.J7a}),this.jO.J7a=null,this.wW.LF(b))}$um(b,h,r){if(h){b=new De.a(new If.a);for(P of h){var B=this.jy.OPc(P);for(let ca=0;ca<B.length;ca++){const ra=B[ca];this.jy.yJb(ra)&&b.add(ra)}}var P=this.jy.dSd(b);P=this.kLh(P,b);B=this.jO.J7a;this.jO.J7a=P;P=Object.assign(new ol.a,{action:0,type:1,HA:this.jO.J7a,VJ:B});this.wW.LF(P);r&&!this.Qbo(h.J(0),b)||this.Fdo(h.J(0),b)}else t.ULS.sendTraceTag(589345503,377,10,"HighlightActivity: no target nodes for activityId {0}",
b.activityId)}Qbo(b,h){if(!b)return t.ULS.sendTraceTag(587239560,377,10,"ScrollToHighlightParagraph: No target node from activity"),!1;if(12!==b.type)return t.ULS.sendTraceTag(587239561,377,10,"ScrollToHighlightParagraph: target node is not a paragraph"),!1;h=this.ZTl(b,h);return this.Iek.gUa(b.id,h)?this.Ac(b,h)?!0:!1:(t.ULS.sendTraceTag(587239563,377,10,"ScrollToHighlightParagraph: call to ScrollToParagraphMatchingNodeId failed"),!1)}Fdo(b,h){b=this.V_l(b,h);h=new Sys.StringBuilder;for(let r=0;r<
b.count;r++)h.append(String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityHighlightReadoutTemplate,r+1,b.count,b.J(r)));this.Xo.sendNotification(h.toString(),!0)}Ac(b,h){if(!b||!ke.ParagraphReader.Xb(b))return t.ULS.sendTraceTag(579396806,377,10,"SetSelection: Invalid node provided"),!1;if(0>h)return t.ULS.sendTraceTag(579396807,377,10,"SetSelection: Invalid cp provided"),!1;this.jO.w0d=!0;b=Ue.a.Rc(b,h);b=new Rg.Selection([b],!0);this.hb.Ac(b);pc.FocusManager.lK()&&this.Vb.mg(Dd.AFrame.In);
return!0}ZTl(b,h){if(h&&0<h.count)for(let r=0;r<b.qa.length;r++){const B=b.qa.J(r);if(B.changeStart&&h.contains(B.changeStart))return B.cp}t.ULS.sendTraceTag(36824330,377,15,"Could not find the matching change in the paragraph, return default cp 0");return 0}V_l(b,h){const r=new mb.a;if(h&&0<h.count&&b){let B=-1;for(let P=0;P<b.qa.length;P++){const ca=b.qa.J(P);if(-1!==B&&ca.Er)if(ca.changeStart&&h.contains(ca.changeStart))continue;else r.add(b.characterData.substring(B,ca.cp)),B=-1;ca.changeStart&&
h.contains(ca.changeStart)&&(B=ca.cp)}}return r}AXi(b,h){if(b)switch(b.type){case 1:if(h){b=new De.a(new If.a);for(var r of h){h=this.jy.OPc(r);for(let B=0;B<h.length;B++){const P=h[B];this.jy.yJb(P)&&b.add(P)}}}else b=Vg.fH(b);h=this.jy.dSd(b);this.jO.ikb=this.kLh(h,b);r=Object.assign(new ol.a,{action:2,type:1,HA:this.jO.ikb,VJ:null});this.wW.LF(r)}else this.jO.ikb&&(r=Object.assign(new ol.a,{action:3,type:1,HA:null,VJ:this.jO.ikb}),this.jO.ikb=null,this.wW.LF(r))}kLh(b,h){var r=null;if(b){r=new fa.a;
for(const B of b)12===B.type&&r.add(B)}b=new sj;b.oY=r;b.Iv=h?h:this.S5l(r);return b}S5l(b){const h=new De.a(new If.a);if(!b)return h;for(const r of b)for(const B of this.jy.FGb(r))h.add(B);return h}}Object(m.a)(hn,"ActivityHighlightManager",null,[]);var Jm=c(504),un=c(463),cm=c(1498),Pn=c(113),Km=c(58);class Tr{constructor(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}}Object(m.a)(Tr,"CreateIndicatorTooltipParameters",null,[]);class hs{constructor(){this.clearSticky=
!1}}Object(m.a)(hs,"DismissIndicatorTooltipParameters",null,[]);class tr{constructor(){this.target=null;this.isSticky=!1}}Object(m.a)(tr,"UpdateIndicatorTooltipParameters",null,[]);class Sp extends Sys.EventArgs{constructor(b,h,r){super();this.aFb=b;this.qri=h;this.Tto=r}}Object(m.a)(Sp,"ActivityIndicatorEventArg",Sys.EventArgs,[]);class $g{constructor(){this.rri=new Map;this.sri=new Set}ZMo(b,h){this.sri.add(b);this.rri.set(b,h)}UOm(b){return Qd.a.Nxi(b.htmlElement)}Qkm(){const b=new Set;for(const h of this.sri){const r=
this.rri.get(h);r&&this.TOm(r)&&b.add(h)}return b}TOm(b){return b.parentElement&&Qd.a.Nxi(b.parentElement)}}Object(m.a)($g,"IndicatorVisibilityTracker",null,[]);class Dn extends cm.a{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb){super();this.sa=new Pc.a;this.Xvb=this.Maa=null;this.Kqm=(jc,Gc,Uc,od,Od)=>{if(!Od)return t.ULS.sendTraceTag(592540299,377,50,"Null actionData: HandleShowIndicatorFlyoutForActivity"),8;Gc=Vg.fH(Od.Activity);jc=null;if(Od.NodeId&&(Od=Pn.b(Od.NodeId),!V.a.Dq(Od,V.a.nil)&&(Od=this.jy.Q$h(Od),
this.jog(Od,!1))))return 32;for(const ze of Gc)if(this.jy.yJb(ze)){Od=this.jy.P9b(ze);if(this.jog(Od,!0))return 32;Od&&!jc&&(jc=Od)}if(this.jog(jc,!1))return 32;t.ULS.sendTraceTag(589866521,377,15,"Unable to find indicator from ShowIndicatorFlyoutForActivity");return 8};this.Iqm=(jc,Gc,Uc,od,Od)=>{t.ULS.sendTraceTag(595126290,377,50,"User requested to Show Catch-Up Activities for a Paragraph from the Context Menu.");Od&&Gc&&Gc.el&&(jc=Gc.node)&&((jc=this.Lqc.nSd(jc))?this.mBd(jc,!1,!1):t.ULS.sendTraceTag(595126289,
377,50,"Unable to obtain indicator container for node after context menu action."));return 32};this.Cyo=jc=>{(jc=this.Lqc.nSd(jc.customData))&&this.mBd(jc,!1,!1)};this.onMouseEnter=jc=>this.DWi(jc.Xw,!0);this.wqa=jc=>{jc=jc.Xw;if(jc===this.Maa)return!0;this.faj(jc);return!0};this.yHa=jc=>{this.Xvb=null;return this.DWi(jc.Xw,!1)};this.j1=()=>{this.Zhg();this.sGd(!0);return!1};this.kt=()=>{this.k0i()};this.Y9d=()=>{this.Maa&&this.zGj(this.Maa);this.Xvb&&this.faj(this.Xvb);this.Mpn()};this.k0i=()=>{this.Maa?
this.zGj(this.Maa):this.f8e()};this.jy=b;this.Sse=h;this.k_g=r;this.b7j=B;this.Uxb=P;this.e7=null;this.Ib=ra;this.Lqc=Qa;this.WEe=new $g;this.zx=tb;this.GK=Mb;this.MI=Zb;this.Fk&&(this.Fk.tga(this.Y9d),this.Fk.orh(this.k0i));ca&&ca.execute(jc=>{jc.fZ(this.kt)})}get Fk(){return this.Uxb&&this.Uxb.Zi?this.Uxb:(t.ULS.sendTraceTag(579396804,377,15,"Could not obtain valid PageView."),null)}Gna(b,h,r){if(this.Maa){var B=Km.a(this.Maa);if(b===B)return this.Maa}const P=b.Fg.ownerDocument;B=Jm.a.createElement(P,
un.a.div);B.className=Dg.a.xFd;B.style.left=h+"px";B.style.top=r+"px";h=Jm.a.createElement(P,un.a.div);h.className=this.zx?Dg.a.DCh:Dg.a.yCh;B.style.cursor="pointer";h.style.cursor="pointer";this.MI&&(h.style.backgroundColor=this.GK.GQl(),h.style.outlineWidth="1px",h.style.outlineStyle="solid",h.style.outlineColor=this.GK.HQl());B.appendChild(h);sf.a.instance.ob(pd.a.WR,B,this.onMouseEnter);sf.a.instance.ob(pd.a.xL,B,this.wqa);ii.a.instance.ob(pd.a.click,B,this.yHa);sf.a.instance.ob(pd.a.contextMenu,
B,this.j1);t.ULS.sendTraceTag(41457152,377,50,"An activity indicator has been created!");this.$5m(b);h=this.M6l(b);this.WEe.ZMo(h,B);this.WEe.UOm(b)&&this.TVi(h);return B}e8a(b){return this.Lro(b)}R0a(b){const h=this.nRk(b),r=[];r.push(this.Gna(b.w5,h,b.qpc[0].y-b.L4[0].y));return r}nRk(b){let h=Dg.a.Zym+(0>b.LZc?-b.LZc:0);const r=xg.a.Qi(b.leftMargin,0)/2;1>=r&&t.ULS.sendTraceTag(578082778,377,50,"Margin is too small to show indicators");h=h>r?r:h;h=h<Dg.a.zCh?Dg.a.zCh:h;return v.AFrameworkApplication.isRtl?
b.L4[0].width/this.zoom+h:-h}iqj(b){if(b&&393230===b.Qc||393251===b.Qc){const h=this.jy.FGb(b);if(h)for(const r of h)if(b===this.jy.P9b(r))return!0}return!1}Lro(b){for(const h of ke.ParagraphReader.xw(b.Cb,!0,!1))if(this.iqj(h))return!0;return!1}Tb(b){b.ra(qb.a.Srj,yc.a.Uc,this.Iqm);b.ra(qb.a.rhg,yc.a.Uc,this.Kqm)}jog(b,h){if(!b)return!1;const r=this.Lqc.nSd(b);if(r)return this.mBd(r,!1,!0),!0;if(!h){let B;this.N5c((B=new mb.a,B.add(b),B),!1,!0,!0);h=new Me.a(3,1,0,this.Cyo,181);h.customData=b;this.Ib.Wb(h);
return!0}return!1}sbl(b,h=!1){h&&this.sGd(!0);if(b&&b.parentNode){var r=this.vvf(b);r=this.AMl(r);this.e7||(this.e7=document.createElement("Div"),document.getElementById(v.AFrameworkApplication.o3b).appendChild(this.e7));this.Sse.createActivityIndicatorTooltip(Object.assign(new Tr,{target:b,container:this.e7,activityIds:r,isSticky:h,dirHint:9}));h&&(this.Maa=b)}else t.ULS.sendTraceTag(36794392,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}dwl(b){b&&
b.classList.add(Dg.a.yFd)}DWi(b,h){return this.mBd(b,h,!1)}mBd(b,h,r){if(h&&b===this.Maa)return!0;const B=this.vvf(b);h||this.Zhg();this.sbl(b,!h);this.dwl(b.getElementsByClassName(this.zx?Dg.a.DCh:Dg.a.yCh)[0]);this.N5c(B,h,!0,r);this.PKi(B,h?1:2);this.b7j.E3d();h&&(this.Xvb=b);return!0}sGd(b=!1){this.Sse.dismissActivityIndicatorTooltips(Object.assign(new hs,{clearSticky:b}));this.Xvb=null;b&&(this.Maa=null)}ztj(b){b&&b.classList.remove(Dg.a.yFd)}Zhg(){this.Maa&&this.ztj(this.Maa.getElementsByClassName(Dg.a.yFd)[0])}faj(b){const h=
this.vvf(b);this.N5c(h,!0,!1,!1);this.ztj(b.getElementsByClassName(Dg.a.yFd)[0]);this.sGd(!1);this.Xvb=null}vvf(b){let h=null;(b=(b=Km.a(b))?b.Cb:null)&&11===b.type&&(h=ke.ParagraphReader.xw(b,!0,!1));return h}f8e(){const b=!!this.Xvb;if(this.Maa||b)this.Zhg(),this.sGd(!0),this.N5c(null,!1,!1,!1),this.N5c(null,!0,!1,!1)}Ewk(b){this.sa.addHandler(Dn.Rnh,b)}Fwk(b){this.sa.addHandler(Dn.Snh,b)}N5c(b,h,r,B){let P=null;if(r&&b){for(const ca of b)if(r=this.jy.OPc(ca))for(let ra=0;ra<r.length;ra++){const Qa=
r[ra];if(this.jy.yJb(Qa)){P=this.jy.nPc(Qa,ca.id);break}}if(!P){t.ULS.sendTraceTag(36717344,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in this GraphNode.");return}}h?this.sa.raiseEvent(Dn.Rnh,new Sp(P,b,!1)):this.sa.raiseEvent(Dn.Snh,new Sp(P,b,B))}AMl(b){const h=[];if(b)for(const B of b){var r=this.jy.FGb(B);for(const P of r)(r=this.jy.nPc(P,B.id))&&h.push(r.activityId)}!h.length&&b&&b.count&&t.ULS.sendTraceTag(36844643,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in these Nodes.");
return h}zGj(b){b&&b.parentNode?(this.Sse.updateActivityIndicatorTooltip(Object.assign(new tr,{target:b,isSticky:!0})),this.Maa=b):t.ULS.sendTraceTag(40935511,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}Mpn(){const b=this.WEe.Qkm();for(const h of b)this.TVi(h)}TVi(b){this.k_g.OKi(b,3)}M6l(b){return(b=ke.ParagraphReader.xw(b.Cb,!0,!1))&&b.count?b.J(0).id:null}$5m(b){b=ke.ParagraphReader.xw(b.Cb,!0,!1);this.PKi(b,0)}PKi(b,
h){b&&b.count&&this.Z5m(b.J(0).id,h)}Z5m(b,h){this.k_g.OKi(b,h)}}Dn.Rnh="ActivityIndicatorPreviewed";Dn.Snh="ActivityIndicatorSelected";Object(m.a)(Dn,"ActivityIndicatorActor",cm.a,[]);var ig=c(36);class xo{constructor(b,h,r){this.jy=b;this.ozd=h;this.Uxb=r}get Fk(){return this.Uxb&&this.Uxb.Zi?this.Uxb:(t.ULS.sendTraceTag(555356833,377,15,"Could not obtain valid PageView."),null)}nSd(b){t.ULS.sendTraceTag(555356834,377,50,"Attempting to find the indicator container related to changes in a given node.");
const h=this.Pai(b);if(!h){t.ULS.sendTraceTag(555356835,377,50,"Looking in different nodes to find the indicator container related to grouped changes on the desired node.");b=this.jy.FGb(b);for(const r of b)if(b=this.jy.P9b(r),b=this.Pai(b))return b}return h}Pai(b){if(!b||12!==b.type)return t.ULS.sendTraceTag(539779146,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid node provided."),null;if(!b)return t.ULS.sendTraceTag(539779147,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid paragraph node."),
null;var h=this.ozd.jHb(b);if(!h||11!==h.type)return t.ULS.sendTraceTag(539779148,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find top level outline element."),null;h=h.te(this.Fk.$b);if(!h||!h.htmlElement)return t.ULS.sendTraceTag(539779149,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid view element."),null;var r=dc.a.PPc(h.htmlElement,xo.Qnh);if(r)return r;h=h.FOd();if(!h)return t.ULS.sendTraceTag(539779150,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid list container wrapper."),
null;h=dc.a.uRl(h,xo.Qnh);if(!h)return t.ULS.sendTraceTag(539779151,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid indicators array."),null;for(r=0;r<h.length;r++){const B=Km.a(h[r]),P=ig.OutlineElementNavigator.El(b);if(B&&B.Cb&&P&&B.Cb.id.equals(P.id))return h[r]}t.ULS.sendTraceTag(539779152,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find indicator.");return null}i1l(b){b=this.jy.Q$h(b);if(!b||12!==b.type)return t.ULS.sendTraceTag(555356864,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get paragraph node from node Id."),
V.a.nil;b=this.nSd(b);if(!b)return t.ULS.sendTraceTag(541888733,377,15,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get indicator from paragraph node."),V.a.nil;b=Km.a(b);return b?b.Cb.id:(t.ULS.sendTraceTag(555356865,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get view element from paragraph node."),V.a.nil)}}xo.Qnh="CatchUpActivityIndicatorContainer";Object(m.a)(xo,"ActivityIndicatorHelper",null,[]);var Kn=c(1707);class no{constructor(b,h,r,B,P,ca,ra){this.sxa=
b;this.pageContentNode=h;this.tZe=r;this.oc=B;this.wX=P;this.Qe=ca;this.mZd=ra;this.SEi=!1;this.S$m=(Qa,tb,Mb)=>{if(1===Mb)return this.dzf?32:8;2===Mb&&(this.dzf&&(this.tZe.f8e(),this.eYk()),t.ULS.sendTraceTag(38138719,377,50,H.c({["MarkAsRead invoked"]:!0})));Eb.App.za.updateCommandUI();return 8};this.sxa.GTa(this.tZe)}initialize(){this.oc.ra(qb.a.xNi,yd.a.frame,this.S$m)}get dzf(){return!!this.wX.XR&&0<this.wX.XR.count||!!this.wX.mgc&&0<this.wX.mgc.count}get iYm(){return this.SEi}tZf(b){const h=
b&&b.wywaActivities?b.wywaActivities.length:0;if(!this.mZd||0<h||!b){const r=new Map;r.set("activityCount",h.toString());this.Qe.logKpiUsage("CatchUpActivitiesReady",0,{extendedProperties:r})}b?(this.vkn(b.wywaActivities),this.SEi=!0):(t.ULS.shipAssertTag(36538305,377,!1),this.mZd||Object(Kn.a)(),this.Qe.logKpiFailure("CatchUpActivitiesReady","CatchUpActivitiesPayloadIsInvalid",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}))}vkn(b){b?(t.ULS.sendTraceTag(36509256,377,50,"Catch-Up Activities are Ready and Indicators should be created."),
this.cqo(b),b=this.wX.Yvk(b),this.dqo(b)):t.ULS.sendTraceTag(50959501,377,10,"activities passed in is null!")}cqo(b){if(b){var h=new mb.a;for(const r of b)switch(r.type){case 2:case 3:case 4:case 10:b=4===r.type?r.R0i:r.contentId,h.add(b),this.wX.mgc.add(b)}0<h.count&&(t.ULS.sendTraceTag(51196435,377,50,"{0}",h.count),this.oc.Qb(fb.a.gRi,2,h.toArray()))}}dqo(b){const h=new De.a(new If.a),r=new cg.GraphTransaction(3);try{r.Db(this.pageContentNode);for(const B of b){const P=this.wX.P9b(B);P&&this.tZe.iqj(P)&&
(h.add(P.id),this.sxa.RIb(P,!0))}}finally{r&&r.dispose()}0<b.count&&Eb.App.za.updateCommandUI();b={};b.highlightedNodeCount=h.count;t.ULS.sendTraceTag(36509257,377,50,"{0}",H.c(b))}eYk(){t.ULS.sendTraceTag(36509258,377,50,"Catch-Up Activity Indicators requested to be cleared.");0<this.wX.mgc.count&&(this.oc.Qb(fb.a.yTh,2,this.wX.mgc.toArray()),this.wX.mgc.clear());const b=this.g_k(this.wX.XR);this.oZn(b)}oZn(b){t.ULS.sendTraceTag(36509259,377,50,"Catch-Up Activities some Indicators requested to be removed.");
const h=new cg.GraphTransaction(3);try{h.Db(this.pageContentNode);for(const r of b){this.wX.XR.remove(r);for(const B of this.wX.IQc(r))this.sxa.RIb(B,!0)}this.wX.AEh()}finally{h&&h.dispose()}}g_k(b){const h=new De.a(new If.a);for(const r of b)h.add(r);return h}}Object(m.a)(no,"ActivityIndicatorManager",null,[]);class Ir{constructor(){this.ikb=this.J7a=null;this.isFirstDocumentOpen=this.w0d=!1}}Object(m.a)(Ir,"ActivityStateManager",null,[601]);class rp{constructor(b,h){this.Phd={};this.hVb=b;this.HK=
h;this.mgc=new mb.a}get XR(){return this.hVb.XR}FGb(b){const h=new De.a(new If.a);if(!b)return h;b=this.hVb.DQd(b);for(let r=0;r<b.length;r++){const B=b[r];this.yJb(B)&&h.add(B)}return h}IQc(b){return this.hVb.IQc(b)}dSd(b){const h=new mb.a;if(b)for(const r of b)h.addRange(this.IQc(r));return h}Yvk(b){const h=new De.a(new If.a);if(b)for(const r of b)if(1===r.type&&(b=r))for(const B of b.Iv){h.add(B);this.XR.add(B);const P=B.toString();this.Phd[P]||(this.Phd[P]=new mb.a);this.Phd[P].add(b)}this.AEh();
return h}yJb(b){return this.XR&&b?this.XR.contains(b):!1}nPc(b,h){if(b&&(b=this.Phd[b.toString()])&&0<b.count){for(const r of b)if(r.objectId.equals(h))return r;return b.J(0)}return null}P9b(b){return this.hVb.P9b(b)}AEh(){this.hVb.RXk()}OPc(b){return this.hVb.OPc(b)}Q$h(b){if(!this.HK)return null;const h=this.HK.Mc;return h?h.Eb(b):null}}Object(m.a)(rp,"ChangeIdCache",null,[]);var Ia=c(156),Cb=c(103);class nc extends Ia.a{constructor(){super();this.activityClassifications=this.inferences=this.correspondingRequest=
null;this.H_=Object.assign(new Cb.a,{T_:nc.getTypeName(),B_:nc.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(m.a)(nc,"ChangeSummariesResponse",Ia.a,[]);var Nc=c(444);class ud extends Nc.a{constructor(){super();this.activityChanges=this.documentContent=this.requestId=null;this.H_=Object.assign(new Cb.a,{T_:ud.getTypeName(),B_:ud.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesRequest"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(m.a)(ud,"ChangeSummariesRequest",Nc.a,[]);var re=c(335),cf=c(371),Ee=c(242),Ef=c(370);class Ag{constructor(){this.ljc=this.H7c=null}}Object(m.a)(Ag,"ActionPair",null,[]);class Lh{constructor(b,h,r,B){this.Wvl=P=>{P=P.customData;const ca=this.E$i(P);ca&&(t.ULS.sendTraceTag(579745163,377,15,"ChangeSummariesAugloopProvider.EndRequestWithTimeout: augloop request timed out, time since request = {0}",this.Esf(P)),ca.ljc("Request timeout"))};this.mB=b;this.YV=h;this.Je=r;this.Ib=B;this.YEe=null;this.rPe=
new Sb.a;this.Fdh=new Sb.a}oFo(b){const h=Object.assign(new re.a,{parentPath:["Signal",ud.getTypeName()],items:[Object.assign(new cf.a,{body:b})]});return this.initialize().then(()=>{const r=new Promise((B,P)=>{this.rPe.Z(b.requestId,Object.assign(new Ag,{H7c:B,ljc:P}))});this.Fdh.Z(b.requestId,new Date);t.ULS.sendTraceTag(561111456,377,50,"ChangeSummariesAugloopProvider.SubmitRequest: submitting request to aug-loop, timeout duration = {0}",Lh.requestTimeoutMs);this.YV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Ef.a,
{operation:h}));this.Qmo(b.requestId);return r})}initialize(){this.YEe||(this.YEe=this.mB.ml().then(()=>{this.Je.ob(this,nc.getTypeName())}));return this.YEe}KB(b,h){if(b&&Ee.a.getTypeNameFor(b.content)===nc.getTypeName())if(b=b.content){var r=this.E$i(b.correspondingRequest);r?h!==re.a.getTypeName()?r.ljc("Invalid operation type"):(t.ULS.sendTraceTag(579745162,377,50,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: resolving augloop request, time since request = {0}",this.Esf(b.correspondingRequest)),
r.H7c(b)):t.ULS.sendTraceTag(589083081,377,15,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: cannot find action pair to resolve promise, time since request = {0}",this.Esf(b.correspondingRequest))}else t.ULS.sendTraceTag(589083080,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: null response from ChangeSummariesRequest");else t.ULS.sendTraceTag(589600964,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: invalid annotation event")}Qmo(b){const h=new Me.a(3,1,Lh.requestTimeoutMs,
this.Wvl,176);h.$Ad=0;h.customData=b;this.Ib.Wb(h)}E$i(b){if(!b)return null;let h;if(!({value:h}=this.rPe.Fc(b,h)).returnValue)return null;this.rPe.remove(b);return h}Esf(b){if(!b)return-1;let h;return({value:h}=this.Fdh.Fc(b,h)).returnValue?(new Date).getTime()-h.getTime():-1}static get requestTimeoutMs(){return v.AFrameworkApplication.K.mc("ChangeSummariesRequestTimeoutMs",5E3)}}Object(m.a)(Lh,"ChangeSummariesAugloopProvider",null,[265]);class rh{constructor(){this.activityGroups=null}}Object(m.a)(rh,
"FeaturedActivityGroupPayload",null,[]);class zj{constructor(b,h,r,B,P){this.uhk=b;this.XWj=h;this.OYj=r;this.x1j=B;this.Nsb=P}getFeaturedActivityGroups(b){return b&&b.wywaActivities&&b.wywaActivities.length?this.x1j.tyb.then(()=>this.PXl(b)):zj.Vhf}bom(b,h,r){if(!h)return t.ULS.sendTraceTag(574103583,377,15,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: response is null"),null;bm("TranslateFeaturedActivityGroups");r=this.OYj.NNo(b,h,r.wywaActivities);t.ULS.sendTraceTag(542942800,377,
50,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: sent changes to aug-loop = {0}, received inferences from aug-loop = {1}, provided items to the flyout = {2}",0<b.activityChanges.length,0<h.inferences.length,0<r.length);this.Nsb.set(h.correspondingRequest,r);return Object.assign(new rh,{activityGroups:r})}PXl(b){bm("BuildFeaturedActivityGroupRequest");const h=this.uhk.mNk();if(!h||!h.documentContent||!h.activityChanges)return t.ULS.sendTraceTag(588379905,377,15,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummariesRequest is null"),
zj.Vhf;if(!h.documentContent.length||!h.activityChanges.length)return zj.Vhf;t.ULS.sendTraceTag(578954499,377,50,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummaries Request Id: "+h.requestId);bm("SubmitFeaturedActivityGroupRequest");return this.XWj.oFo(h).then(r=>this.bom(h,r,b))}}zj.Vhf=Promise.resolve(Object.assign(new rh,{activityGroups:[]}));Object(m.a)(zj,"ChangeSummariesDataProvider",null,[602]);class Tj{constructor(b,h){this.jy=b;this.hmk=h}mNk(){const b=new mb.a,
h=new mb.a,r=new De.a(new If.a);var B=this.jy.XR;if(!B||!B.count)return Tj.Yhf;B=this.jy.dSd(B);if(!B||!B.count)return t.ULS.sendTraceTag(592056450,377,15,"ChangeSummariesRequestBuilder.BuildChangeSummariesRequest: no GraphNodes exist for the new changeIds"),Tj.Yhf;for(const P of B)r.contains(P.id)||(r.add(P.id),this.qJn(P,b,h));return h.count&&b.count?Object.assign(new ud,{activityChanges:h.toArray(),documentContent:b.toArray(),requestId:Pn.a(V.a.create())}):Tj.Yhf}qJn(b,h,r){if(ke.ParagraphReader.Xb(b)){var B=
ke.ParagraphReader.Uda(b);if(B&&B.length){h.add(B);B=this.jy.FGb(b);B=this.knm(B);for(const P of B){B=new mb.a;const ca=this.getTextRanges(b,P);for(const ra of ca)B.add({changeEnd:ra.endIndex,changeSpanId:ra.Nfo,changeStart:ra.startIndex,contentIndex:h.count-1,locationId:Pn.a(b.id)});(B=this.d9k(P,B.toArray()))&&r.add(B)}}else t.ULS.sendTraceTag(591975071,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: no content available")}else t.ULS.sendTraceTag(592056452,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: node did not cast to AParagraphNode")}knm(b){const h=
new Sb.a;for(const r of b)(b=this.Pei(r))?(h.nb(b)||h.Z(b,new De.a(new If.a)),h.J(b).add(r)):t.ULS.sendTraceTag(579712270,377,15,"ChangeSummariesRequestBuilder.GroupChangeIdsByUser: unable to get person id from change id");return h.values}d9k(b,h){const r=[];let B=null;for(const P of b)if(b=this.jy.nPc(P,V.a.nil)){if(!B){const ca=this.Pei(P);if(!ca||!ca.length){t.ULS.sendTraceTag(579712272,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get person id from change id");continue}B=
ca}r.push(b)}else t.ULS.sendTraceTag(579712271,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get activity from change id");return r.length?B?h.length?{activityId:r[0].activityId,changes:h,personId:B,timestamp:r[0].displayTimestamp.toISOString()}:(t.ULS.sendTraceTag(579712273,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no changes provided for ActivityChange"),null):(t.ULS.sendTraceTag(579605389,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: could not get personId for ActivityChange"),
null):(t.ULS.sendTraceTag(579605388,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no activities exist for ActivityChange"),null)}Pei(b){b=this.jy.nPc(b,V.a.nil);if(!b)return t.ULS.sendTraceTag(579712274,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: unable to get activity from change id"),null;b=b.actors;if(!b||!b.length||!b[0])return t.ULS.sendTraceTag(592056451,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: no people are associated with this Activity in ChangeSummariesRequest"),
null;let h=b[0].id;h&&h.length||(h=b[0].email);return h}getTextRanges(b,h){const r=new mb.a;if(!h||!h.count||!b)return r;let B=-1,P=new De.a(new If.a);for(let ca=0;ca<b.qa.length;ca++){const ra=b.qa.J(ca);if(-1!==B&&ra.Er){if(ra.changeStart&&h.contains(ra.changeStart)){P.add(ra.changeStart);continue}r.add({startIndex:B,endIndex:ra.cp,Nfo:this.hmk.Xjj(P)});B=-1;P=new De.a(new If.a)}ra.changeStart&&h.contains(ra.changeStart)&&(B=ra.cp,P.add(ra.changeStart))}return r}}Tj.Yhf=Object.assign(new ud,{activityChanges:[],
documentContent:[],requestId:Pn.a(V.a.nil)});Object(m.a)(Tj,"ChangeSummariesRequestBuilder",null,[]);class lk{constructor(){this.changes=this.content=null}}Object(m.a)(lk,"ContentChange",null,[]);class lm{constructor(){this.ranking=0;this.reasons=this.contentChanges=this.locationId=this.activities=null}}Object(m.a)(lm,"FeaturedActivityGroup",null,[]);class Zn{constructor(){this.end=this.start=0}}Object(m.a)(Zn,"TextRange",null,[]);class En{constructor(b){this.Lqc=b}NNo(b,h,r){if(!h)return t.ULS.sendTraceTag(588379906,
377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is null"),En.BMd;if(!h.inferences)return t.ULS.sendTraceTag(588379907,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.Inferences is null"),En.BMd;if(!h.activityClassifications)return t.ULS.sendTraceTag(588379908,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.ActivityClassifications is null"),En.BMd;if(!h.inferences.length||!h.activityClassifications.length)return t.ULS.sendTraceTag(561111455,
377,50,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is empty"),En.BMd;const B=[],P=new Da.a(new If.a);for(const ca of h.inferences){const ra=this.MNo(ca,b,h,r);if(!ra)continue;const Qa=this.Lqc.i1l(Pn.b(ra.locationId));Qa.equals(V.a.nil)?B.push(ra):P.nb(Qa)?P.J(Qa).ranking>ra.ranking&&P.Z(Qa,ra):P.add(Qa,ra)}b=[...Array.from(P.values),...B];b.sort((ca,ra)=>ca.ranking-ra.ranking);return b.slice(0,En.jbn)}MNo(b,h,r,B){if(!b||Rl.a.af(b.activitiesInGroup))return t.ULS.sendTraceTag(588379909,
377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: inference is empty"),null;const P=new mb.a,ca=new Sb.a;let ra=null;for(const tb of b.activitiesInGroup){if(!tb){t.ULS.sendTraceTag(588379910,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity is null");continue}if(0>tb.activityIndex||tb.activityIndex>=r.activityClassifications.length){t.ULS.sendTraceTag(588379911,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity.ActivityIndex is invalid");
continue}const Mb=r.activityClassifications[tb.activityIndex];if(!Mb||Rl.a.af(Mb.contents))t.ULS.sendTraceTag(588379912,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activityClassification is empty");else{var Qa=this.qDl(B,Mb.activityId);if(Qa){P.add(Qa);for(const Zb of tb.changes){if(!Zb){t.ULS.sendTraceTag(576251591,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef is null");continue}Qa=Zb.value;if(0>Qa||Qa>=Mb.contents.length){t.ULS.sendTraceTag(576251592,
377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef index is invalid");continue}Qa=Mb.contents[Qa];if(!Qa){t.ULS.sendTraceTag(576251593,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContent is null");continue}const jc=h.documentContent[Qa.contentIndex],Gc=Object.assign(new Zn,{start:Qa.changeStart,end:Qa.changeEnd});if(ca.nb(jc))ca.J(jc).add(Gc);else{let Uc;ca.Z(jc,(Uc=new mb.a,Uc.add(Gc),Uc))}ra||(ra=Qa.locationId)}}else t.ULS.sendTraceTag(588379913,
377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activity is null")}}if(!P.count)return t.ULS.sendTraceTag(588379914,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no activities for ActivityGroup"),null;h=this.cjm(ca);return h.count?Object.assign(new lm,{ranking:b.ranking.value,reasons:[1],activities:P.toArray(),contentChanges:h.toArray(),locationId:ra}):(t.ULS.sendTraceTag(588379915,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no content change for ActivityGroup"),
null)}qDl(b,h){for(const r of b)if(r&&r.activityId&&r.activityId===h)return r;return null}cjm(b){const h=new mb.a;for(const B of b){b=B.key;const P=B.value;P.Sc((ca,ra)=>ca.start-ra.start);var r=P.J(0).start;if(r>En.ZNi){r-=En.ZNi;b=b.substring(r,b.length);for(const ca of P)ca.start-=r,ca.end-=r}h.add(Object.assign(new lk,{content:b,changes:P.toArray()}))}return h}}En.BMd=[];En.ZNi=10;En.jbn=4;Object(m.a)(En,"ChangeSummariesResponseTranslator",null,[]);class La{constructor(){this.Nsb=new Sb.a;this.BQe=
new Sb.a}set(b,h){if(h.length&&b){this.Nsb.Z(b,h);for(const r of h)if(r.activities)for(const B of r.activities)B&&B.activityId?this.BQe.Z(B.activityId,b):t.ULS.sendTraceTag(573920657,377,15,"FeaturedActivityGroupCache.Set: null activity in group");else t.ULS.sendTraceTag(573920656,377,15,"FeaturedActivityGroupCache.Set: null activities for group")}}get(b){return b&&this.Nsb.nb(b)?this.Nsb.J(b):null}W8m(b){return b&&this.BQe.nb(b)?this.BQe.J(b):null}}Object(m.a)(La,"FeaturedActivityGroupCache",null,
[]);class Za{constructor(b){this.Z2d=(h,r,B,P,ca)=>{if(!ca)return t.ULS.sendTraceTag(574103576,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null actionData"),8;h=ca.Activity;if(!h)return t.ULS.sendTraceTag(574103577,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null activity"),8;r=this.Nsb.W8m(h.activityId);if(!r)return t.ULS.sendTraceTag(574103578,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: No matching request Id found"),
8;B=Vg.fH(h);t.ULS.sendTraceTag(574103579,377,50,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: [RequestId={0};ActivityId={1};ChangeIds={2}]",r,h.activityId,this.Xjj(B));return 32};this.Nsb=b;this.yOg=new Map}Tb(b){b.ra(qb.a.Z2d,yd.a.frame,this.Z2d)}Xjj(b){let h=0;const r=Array(b.count);for(const B of b)b=this.G7l(B),r[h]=Pn.a(b),h++;return r.join(",")}G7l(b){let h=this.yOg.get(b);if(h&&h!=V.a.nil)return h;h=V.a.create();this.yOg.set(b,h);return h}}Object(m.a)(Za,"FeaturedActivityGroupTelemetryActor",
null,[]);var Ab=c(76);class uc extends Sys.EventArgs{constructor(b){super();this.node=b}}Object(m.a)(uc,"OnParagraphVisitedArgs",Sys.EventArgs,[]);class Lc{constructor(b,h,r){this.hO=null;this.RNo=B=>{this.l_a.reset();B=this.Uim(B.customData);let P=null;for(;B.moveNext();){const ca=B.currentNode;if(ca&&(ke.ParagraphReader.Xb(ca)&&this.sa.raiseEvent("OPV",new uc(ca)),this.l_a.update(),this.l_a.dnb())){P=ca;break}}P?this.qqh(P):this.hO(!0)};this.Ib=b;this.l_a=h;this.HK=r;this.sa=new Pc.a;this.tyb=new Promise(B=>
{this.hO=B})}syk(b){this.sa.addHandler("OPV",b)}lKk(){this.qqh(null)}qqh(b){const h=new Me.a(3,1,0,this.RNo,182);h.customData=b;this.Ib.Wb(h)}Uim(b){if(!b)return Ab.a.gp(this.HK);b=Ad.GraphIterator.eb(b);b.zb(7);return Ab.a.Gs(b,this.HK)}}Object(m.a)(Lc,"DocumentTraverser",null,[]);class kd{constructor(b){this.oc=b}shouldShowEmptyExperienceButton(){return v.AFrameworkApplication.F1d()}getExplanationText(){return""}getCommandName(){return WordEditorIntl.WordEditorStrings.L_FileHistory}onButtonClick(){this.oc.Qb(fb.a.yje,
2,null)}onInviteOthersButtonClick(){this.oc.Qb(fb.a.V8,2,null)}}Object(m.a)(kd,"EmptyCatchUpBehaviorManager",null,[600]);class Kd{constructor(b,h){this.EHl=()=>{const r=document.getElementById("flyoutItem0");r&&(t.ULS.sendTraceTag(588129371,3012,50,"Focused on the catch-up flyout via ctrl+F6"),r.focus())};this.lp=b;this.Vb=h}initialize(){const b=this.Vb.fe(Dd.AFrame.w4b);b.eI=!0;b.parent=Dd.AFrame.Ap;b.pga(this.EHl);this.lp.JT(Dd.AFrame.w4b)}enableF6Focus(){this.lp.$I(Dd.AFrame.w4b)}disableF6Focus(){this.lp.fx(Dd.AFrame.w4b)}}
Object(m.a)(Kd,"FlyoutFocus",null,[599]);class ce{constructor(b,h,r){this.ANg=this.$Xg=this.txc=this.bpd=!1;this.QBe=this.zhd=null;this.Esn=(B,P,ca,ra,Qa)=>{Qa[qg.a.Visible]=!0;Qa[qg.a.On]=this.txc&&this.bpd;return 32};this.xvn=(B,P,ca)=>{if(1===ca)return this.bpd?(this.$Xg||(this.$Xg=!0,t.ULS.sendTraceTag(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.zhd)return t.ULS.sendTraceTag(588129369,3012,10,"OnToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."),
8;this.ANg=!0;this.zhd();return 32};this.ga=b;this.fWg=h;this.Vb=r}get Wlf(){return this.QBe?this.QBe:(t.ULS.sendTraceTag(578401728,3012,15,"Attempted to get _flyoutShowTimestamp before the value was set."),new Date)}set Wlf(b){this.QBe=b}initialize(){this.Tb()}registerButtonClickedEvent(b){this.zhd&&t.ULS.sendTraceTag(588129366,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.zhd=b.buttonClickedCallback}onFlyoutInitialized(){this.bpd&&t.ULS.sendTraceTag(588129367,
3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const b=(new Date).getTime()-this.Wlf.getTime();t.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",b);this.bpd=!0;Ke.c(fb.a.mUk,!0,void 0,void 0,void 0,b)}onFlyoutVisibilityChanged(b){this.txc!==b.flyoutIsVisible&&(this.txc=b.flyoutIsVisible,Eb.App.za&&Eb.App.za.updateCommandUI(!0),this.txc&&this.ANg&&this.Vb.mg(Dd.AFrame.w4b),this.txc||this.fWg&&this.fWg.q4m())}logFlightTriggers(b){b.hasFlyoutData&&
v.AFrameworkApplication.oe("WoCha187;WoCha187cf")}Tb(){this.ga.ra(fb.a.bAj,yd.a.frame,this.xvn);this.ga.fb(fb.a.m6i,yd.a.frame,this.Esn,96)}}Object(m.a)(ce,"FlyoutRibbonButton",null,[598]);var Fe=c(152);class Af{constructor(b,h){this.XR=null;this.RYd=this.qBi=!1;this.wX=b;this.Qe=h;this.Okb=new Fe.a;this.wYd=new Map;this.Okb.Z(1,new De.a(new If.a));this.Okb.Z(0,new De.a(new If.a));this.Okb.Z(2,new De.a(new If.a));this.Okb.Z(3,new De.a(new If.a));this.wYd.set(3,"CatchUpIndicatorVisible");this.wYd.set(1,
"CatchUpIndicatorPreviewed");this.wYd.set(2,"CatchUpIndicatorSelected");this.aee=0}OKi(b,h){if(this.Okb.J(h).add(b)){this.a6m(h);switch(h){case 0:t.ULS.sendTraceTag(592545740,377,50,"LogIndicatorTelemetry: indicator rendered");break;case 1:t.ULS.sendTraceTag(592545739,377,50,"LogIndicatorTelemetry: indicator hovered");break;case 2:t.ULS.sendTraceTag(592545738,377,50,"LogIndicatorTelemetry: indicator clicked");break;case 3:t.ULS.sendTraceTag(528593420,377,50,"LogIndicatorTelemetry: indicator visible")}this.LDh()}}Vrn(b){this.jxl();
b=this.wX.FGb(b);for(const h of b)if(this.XR.remove(h)){this.aee++;break}}jxl(){if(!this.XR){this.XR=new De.a(new If.a);for(const b of this.wX.XR)this.XR.add(b)}}QBk(){t.ULS.sendTraceTag(590890074,377,50,"Total number of renderable indicators: {0}",this.aee);this.LDh()}LDh(){this.aee&&(this.cWk(),this.NVk())}cWk(){!this.qBi&&.5<=this.Okb.J(0).count/this.aee&&(this.qBi=!0,Ke.c(fb.a.oUk),t.ULS.sendTraceTag(590926531,377,50,"User started Catch Up Passive Session"))}NVk(){if(!this.RYd){var b="";1<=this.Okb.J(1).count&&
(this.RYd=!0,b="previews");1<=this.Okb.J(2).count&&(this.RYd=!0,b="selections");this.RYd&&(Ke.c(fb.a.hUk),t.ULS.sendTraceTag(590926532,377,50,"User started Catch Up Active Session due to {0}",b))}}a6m(b){(b=this.wYd.get(b))&&this.Qe.logKpiUsage(b,0)}}Object(m.a)(Af,"IndicatorTelemetryActor",null,[]);var jh=c(483);c(1092);class Uj{constructor(b,h){this.o$c=b;this.iIc=h}Tkm(){return this.iIc.promise.then(b=>b.getWywaActivitiesResponse)}getActivities(b,h){return jh.b(this.o$c.requestActivities(b,h))}getRelevantActivities(b,
h){return this.iIc.promise.then(r=>r.getWywaActivitiesResponse.WywaWaterline===b?Promise.resolve(r.getRelevantActivitiesResponse):jh.b(this.o$c.requestRelevantActivities(b,h)))}updateActivityState(b){return jh.b(this.o$c.updateActivityState(b))}getActivityFeed(){return this.iIc.promise.then(b=>void 0!==b.activityFeed?Promise.resolve(b.activityFeed):jh.b(this.o$c.requestActivityFeed()))}updateWaterline(){return jh.b(this.o$c.K5n())}}Object(m.a)(Uj,"ActivityRepository",null,[]);var ug=c(1093),Ri=c(1600);
class Nj{constructor(b,h,r,B,P,ca=!1){this.activityContentManager=b;this.oc=h;this.nsl=r;this.Qe=B;this.$ym=P;this.pdc=ca}RNf(b){const h=new Map;h.set("activityType",b.type.toString());this.Qe.logKpiUsage("CatchUpNavigateToActivity",0,{extendedProperties:h})}fNf(b){this.Qe.logKpiFailure("CatchUpNavigateToActivity",b,{},{name:"CatchUpExperienceDegraded",errorNameOverride:"NavigateToActivityFailed"})}jgn(b){try{const h=b.activity;this.RNf(b.activity);1==h.type&&this.$ym.E3d();if(!this.activityContentManager.doesContentExist(h))return this.activityContentManager.iQo(h),
this.fNf("Content does not exist"),Promise.resolve(2);const r={};let B=0;switch(h.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:r.ActivityId=h.activityId;r.NavigationId=atob(h.navigationId);B=this.oc.Qb(fb.a.q9e,2,r);break;case 1:r.Activity=h,r.NodeId=b.locationId,B=this.oc.Qb(qb.a.rhg,2,r),r.NodeId&&this.oc.Qb(qb.a.Z2d,2,r)}8==B&&this.fNf("Action failed")}catch(h){return t.ULS.sendTraceTag(592237846,3012,10,"Exception thrown trying to navigate to an activity. {0}",h),this.fNf("Exception was thrown"),
Promise.resolve(3)}return Promise.resolve(1)}navigateToActivity(b){return this.nsl.tyb.then(()=>this.jgn(b))}}Object(m.a)(Nj,"WordActivityNavigationManager",null,[529]);var Vj;(function(b){b[b.default=0]="default";b[b.D48X48=1]="D48X48";b[b.D64X64=2]="D64X64";b[b.D96X96=3]="D96X96";b[b.D120X120=4]="D120X120";b[b.D240X240=5]="D240X240";b[b.D360X360=6]="D360X360";b[b.D432X432=7]="D432X432";b[b.D504X504=8]="D504X504";b[b.D648X648=9]="D648X648"})(Vj||(Vj={}));Object(m.b)("ProfilePhotoDimension",Vj);var of=
c(780),Qe=c(1499);class df{constructor(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(m.a)(df,"ActivityFeedEntry",null,[]);const lg=(b,h)=>h.UYc?Qo.toArray(Qo.select(Qo.asEnumerable(b),r=>{if(!r||!r.activityFeedItemPayload)return r;const B=JSON.parse(r.activityFeedItemPayload);var P=B.actor;if(!P||P.pictureUrl)return r;const ca=P.userPrincipalName||P.email;if(!ca)return r;P=h.tDb(ca,P.provider,v.AFrameworkApplication.em,0);
if(!P)return r;B.actor.pictureUrl=P;return Object.assign(new df,{id:r.id,type:r.type,collectionId:r.collectionId,activityState:r.activityState,activityFeedItemPayload:JSON.stringify(B),timestamp:r.timestamp})})):b,yg=(b,h)=>{const r=new Map,B=new Map;for(const P of b){if(!P||!P.activityFeedItemPayload)continue;b=JSON.parse(P.activityFeedItemPayload).actor;if(!b)continue;const ca=b.email||b.userPrincipalName;ca&&!B.has(ca)&&B.set(ca,new of.a(ca,null,b.name))}B.forEach(P=>{const ca=h.jac(P,6);r.set(P.UserId,
ca)});return r};var Aj=c(508);class Fi{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(m.a)(Fi,"ActivityRequestPayload",null,[]);class Ik{constructor(){this.color=this.imageUrl=this.email=this.displayName=this.provider=this.id=null}}Object(m.a)(Ik,"Person",null,[]);class wl extends Pf{constructor(){super();this.relationship=0}}Object(m.a)(wl,"TaskActivity",Pf,[]);class pk extends Pf{constructor(){super();
this.contentId=null}}Object(m.a)(pk,"CommentActivity",Pf,[]);class is extends pk{constructor(){super()}}Object(m.a)(is,"CommentReplyActivity",pk,[]);class Io extends pk{constructor(){super();this.R0i=null}}Object(m.a)(Io,"MentionActivity",pk,[]);class Ur{constructor(b,h,r,B){this.Osb=b;this.VMa=h;this.ABc=r;this.jO=B;this.jO.isFirstDocumentOpen=!1}requestWYWAActivities(){return this.Osb.Tkm().then(b=>{if(!b||b.StatusCode&&155!==b.StatusCode)throw this.Kbf("GetWYWAActivities",b);155===b.StatusCode&&
(t.ULS.sendTraceTag(40433563,377,50,"No waterline is found on GetWywaActivities request."),this.jO.isFirstDocumentOpen=!0);const h=this.Hng(b.People);return Object.assign(new Fi,{activities:this.Sme(b.Activities,h),actors:h,hasMore:!b.AllWYWA,highWaterline:b.HighWaterline,lowWaterline:b.LowWaterline,wywaWaterline:b.WywaWaterline,isFirstDocumentOpen:155===b.StatusCode})})}requestActivities(b,h){return this.Osb.getActivities(b,h).then(r=>{if(!r||r.StatusCode)throw this.Kbf("GetActivities",r);const B=
this.Hng(r.People);return Object.assign(new Fi,{activities:this.Sme(r.Activities,B),actors:B,hasMore:!r.RequestedRetrieved,highWaterline:r.HighWaterline,lowWaterline:r.LowWaterline})})}requestRelevantActivities(b){return this.Osb.getRelevantActivities(b,this.jO.isFirstDocumentOpen).then(h=>{if(!h||h.StatusCode)throw this.Kbf("GetRelevantActivities",h);const r=this.Hng(h.People),B=this.Sme(h.NewActivities,r,2);h=this.Sme(h.OutstandingActivities,r,3);for(const P of h)B.push(P);return Object.assign(new Fi,
{activities:B,actors:r})})}updateActivityState(b){return this.Osb.updateActivityState(b)}requestActivityFeed(){return this.Osb.getActivityFeed().then(b=>({activityFeedItems:this.GCm(b),personaColorMap:this.EOk(b)}))}Sme(b,h,r=1){const B=[];if(!b)return B;for(const ra of b){var P=null;b=[];b.push(h[ra.CreatorIndex]);switch(ra.ActivityType){case 1:P=ra;var ca=new Vg;ca.Iv=new mb.a;for(const Qa of P.ChangeIds)ca.Iv.add(Pn.b(Qa));ca.objectId=Pn.b(P.ObjectId);P=ca;break;case 2:P=ra;ca=new pk;ca.contentId=
P.ContentId;ca.navigationId=P.NavigationId;P=ca;break;case 4:P=ra;ca=new Io;b.push(h[P.MentioneeIndex]);ca.R0i=P.ParentContentId;ca.navigationId=P.NavigationId;P=ca;break;case 3:case 10:P=ra;ca=new is;b.push(h[P.RepliedIndex]);ca.contentId=P.ContentId;ca.navigationId=P.NavigationId;P=ca;break;case 6:case 7:case 8:case 9:P=ra,ca=new wl,b.push(h[P.MentioneeIndex]),ca.navigationId=P.NavigationId,ca.relationship=P.Relationship,P=ca}P&&(P.actors=b,P.displayTimestamp=new Date(ra.DisplayTimestamp),P.activityId=
Pn.b(ra.ActivityId).toString(),P.type=ra.ActivityType,1!==r&&(P.relevancy=r),B.push(P))}return B}u8n(b,h,r){return this.ABc&&this.ABc.UYc?this.ABc.tDb(h,r,v.AFrameworkApplication.em,Vj.default):b}Hng(b){if(!b)return null;const h=Array(b.length);for(let r=0;r<b.length;r++){if(!b[r])continue;const B=new Ik;B.id=b[r].Id;B.provider=b[r].Provider;B.displayName=b[r].DisplayName;B.email=b[r].Email;B.imageUrl=this.u8n(b[r].PictureUrl,b[r].Email,b[r].Provider);this.VMa&&(B.color=this.VMa.jac(new of.a(B.email,
void 0,B.displayName),Qe.a.catchUpFlyout));h[r]=B}return h}Kbf(b,h){let r="null";h&&(r=Aj.a[h.StatusCode]);return Error.create(String.format("{0} failed with status code: {1}.",b,r))}GCm(b){return this.ABc?lg(b,this.ABc):b}EOk(b){return this.VMa?yg(b,this.VMa):new Map}}Object(m.a)(Ur,"WordActivityRequestManager",null,[528]);class As{constructor(b,h,r){this.Zrd=0;this.JBc=!1;this.o4g=null;this.updateWaterline=()=>{if(Eb.App.lostSession)t.ULS.sendTraceTag(51217553,391,100,"The session is lost. Stop fetching new activities.");
else if(this.JBc||3>=this.Zrd){this.JBc?this.JBc=!1:this.Zrd++;const B=Math.max(this.Ca.mc("WordEditorActivityManagementMaturityMiliSeconds",30001)+5E3-(+new Date-+this.o4g),0);t.ULS.sendTraceTag(39396256,391,100,"Requesting new activities in {0}ms",B);Fj.Task.delay(B).continueWith(()=>{this.Osb.updateWaterline().then(()=>{this.Bfe();return null}).catch(()=>{this.Bfe();this.JBc=!0;this.Zrd=0})})}else this.Bfe()};this.Ca=b;this.Osb=r;h.nCd(()=>{this.JBc=!0;this.o4g=new Date;this.Zrd=0})}start(){this.Bfe()}Bfe(){window.setTimeout(this.updateWaterline,
6E4)}}Object(m.a)(As,"WordEditorActivityScheduler",null,[]);class sv{constructor(){this.resolve=null;this.promise=new Promise(b=>{this.resolve=b})}Xgo(b){this.resolve(b)}}Object(m.a)(sv,"CatchUpNetworkRequestWorkerCache",null,[]);class fq{constructor(b,h,r){this.shl=b;this.K=h;this.Qe=r}tZf(b){b&&b.authors&&this.U5m(b.authors)}U5m(b){for(const h of b)h&&h.displayName===this.shl&&(this.Qe.logKpiFailure("CatchUpActivitiesReady","CatchUpShowsChangesFromCurrentAuthor",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}),
t.ULS.sendTraceTag(571745507,377,15,"LogIfWywaAuthorMatchesCurrentUser: WYWA author has same name as current user [same id={0},same email={1}]",h.id===this.K.kb("PresenceUserId"),h.email===this.K.kb("UserPrincipalName")))}}Object(m.a)(fq,"WywaAuthorComparator",null,[]);class tv{constructor(b){this.M1=b}E3d(){this.M1&&this.M1.execute(b=>b.logActivity("CatchUpIndicatorSurveyNomination",null))}}Object(m.a)(tv,"IndicatorSurveyActor",null,[]);var Nt=c(1065),Iq=c(1057);class Ox{constructor(){this.pUk={crewAlias:"webasynccollabeng",
featureName:"CatchUp",topLevelKpiName:"CatchUpFeatureUsage",vetoPillar:7}}get name(){return"WordEditor.CatchUpActivity"}get jUk(){return v.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")}get JDf(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ChangeSummariesEnabled",!1)}get Bxi(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpDynamicEntryPointEnabled",!1)}get Twi(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpCustomDynamicEntryPointEnabled",
!1)}get TYd(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)}get mZd(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsCatchUpActivitiesReadyTelemetryFixV2Enabled",!1)}get YWm(){return v.AFrameworkApplication.K.$("IsUserFromDifferentTenant")}get pdc(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpMockDataEnabled",!1)}wc(b){bm("Configure");this.container=
b;b.ia("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache",()=>new sv).ha()}init(){bm("Init");this.jUk&&(L.a.instance.registerOnPackageInit("WordEditor.Workers",()=>{this.container.resolve("Box4.Workers.IWebWorkerRouter").sendMessage(2,4,v.AFrameworkApplication.rootQuerySignature,Eb.App.webServiceBase+"OneNote.ashx",Vk.a.word,this.TYd)}),bm("HotStore"),Eb.App.g6.L3a.execute(()=>{bm("ChromeReady");ij.a.get_instance().pk(7,()=>{bm("ScriptDownload");(v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk("catchUpActivity"):this.container.resolve("Common.IDynamicScriptLoaderProvider").dA.loadScript("catchUpActivity")).catch(b=>{t.ULS.sendTraceTag(592233361,377,10,"Failed to load the resources for the CatchUpActivity feature: {0}",b)}).then(()=>this.dmn()).catch(b=>{t.ULS.sendTraceTag(36548867,377,10,"Failed to initialize the CatchUpActivity feature: {0}",b)})})}))}dmn(){bm("CreateObjectsAndInitializeState");this.j5m();this.r9k();return this.$Am()}j5m(){t.ULS.sendTraceTag(592217358,
377,50,"CatchUpActivity feature enabled successfully");t.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");t.ULS.sendTraceTag(594401288,3012,50,"Tasks and outstanding data is enabled");this.JDf&&t.ULS.sendTraceTag(588130079,3012,50,"ChangeSummaries is enabled");this.Bxi&&t.ULS.sendTraceTag(553911650,3012,50,"DynamicEntryPoint is enabled");this.Twi&&t.ULS.sendTraceTag(553769042,3012,50,"CustomDynamicEntryPoint is enabled");t.ULS.sendTraceTag(545036493,3012,50,"IsUserFromDifferentTenant: {0}",
this.YWm);this.TYd&&t.ULS.sendTraceTag(526718752,3012,50,"ActivityFeedData is enabled")}$Am(){this.FBm();this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").Wlf=new Date;bm("InitializeCatchUpApp");return this.v4b.initialize(Object.assign(new aa,{featuredActivityGroupsEnabled:this.JDf,summaryStringEnabled:!0,dynamicEntryPointEnabled:this.Bxi,customDynamicEntryPointEnabled:this.Twi,activityFeedDataEnabled:this.TYd})).then(()=>{this.container.resolve("WordEditor.CatchUpActivity.WordEditorActivityScheduler").start()})}r9k(){this.container.ia("WordEditor.CatchUpActivity.ChangeIdCache",
()=>new rp(this.container.resolve("WordEditor.CatchUpActivity.IChangeIdObjectIdCache"),ub.App.nn.jb.rc.ed)).ha();this.container.ia("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger",()=>new Nt.a(va.Health.instance,new Iq.a,this.pUk)).ha();this.container.ia("WordEditor.CatchUpActivity.IActivityStateManager",()=>new Ir).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityContentManager",()=>new tg(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),v.AFrameworkApplication.va,
al.UISurfaces.LM(),this.pdc)).as("Common.App.CatchUpActivity.IActivityContentManager").ha();this.container.ia("WordEditor.CatchUpActivity.Network.ActivityRepository",()=>new Uj(new ug.a(Db.a.Xzj(this.container.Ta("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper")),()=>v.AFrameworkApplication.rootQuerySignature,Eb.App.webServiceBase+"OneNote.ashx",Vk.a.word,Db.a.Xzj(this.container.Ta("Common.App.CatchUpActivity.ICatchUpRequestHandler"))),this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"))).ha();
this.container.ia("Common.App.CatchUpActivity.IActivityRequestManager",()=>new Ur(this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"),this.container.resolve("Common.App.People.IPeopleColorUtils"),this.container.resolve("Common.App.People.IUserProfilePictureUtilsV2"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.pdc)).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityHighlightManager",()=>new hn(this.container.resolve("Box4.Highlight.IHighlightManager"),
this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),ub.App.nn.jb.rc,new Ri.a(ub.App.nn.jb.rc),Bh.a.instance,pc.FocusManager.instance(),this.container.resolve("Common.Utils.IAriaNotifier"))).ha();this.container.ia("WordEditor.CatchUpActivity.DocumentTraverser",()=>{let b;b=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfYieldableDocumentTraversalIsEnabled",!1)?new Cn.a(50,
Qd.a.$e):new Ro;return new Lc(v.AFrameworkApplication.lc,b,ub.App.nn.jb.rc.ed)}).ha();this.container.ia("WordEditor.CatchUpActivity.IndicatorSurveyActor",()=>new tv(this.container.Ta("Common.ISystemInitiatedFeedback"))).ha();this.container.ia("Common.App.CatchUpActivity.IActivityNavigationManager",()=>new Nj(this.container.resolve("WordEditor.CatchUpActivity.ActivityContentManager"),v.AFrameworkApplication.va,this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),
this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),this.pdc)).ha();this.container.ia("WordEditor.CatchUpActivity.FlyoutRibbonButton",()=>new ce(v.AFrameworkApplication.va,this.container.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"),pc.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutRibbonButton").ha();this.container.ia("WordEditor.CatchUpActivity.FlyoutFocus",()=>new Kd(Rp.a.instance,pc.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutFocus").ha();
this.container.ia("WordEditor.CatchUpActivity.FeaturedActivityGroupCache",()=>new La).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityIndicatorHelper",()=>new xo(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),ub.App.nn.jb.rc)).ha();this.container.ia("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor",()=>new Za(this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"))).ha();
this.container.ia("Common.App.CatchUpActivity.IChangeSummariesDataProvider",()=>new zj(new Tj(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor")),new Lh(this.container.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.container.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.container.resolve("Box4.AugmentationLoop.IAnnotationStorage"),v.AFrameworkApplication.lc),new En(this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper")),
this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"),this.pdc)).ha();this.container.ia("WordEditor.CatchUpActivity.EmptyCatchUpBehaviorManager",()=>new kd(v.AFrameworkApplication.va)).as("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager").ha();this.v4b=catchUpActivity.FactoryGlobal.getWordCatchUpAppInstance(Object.assign(new oa,{activityContentManager:this.container.resolve("Common.App.CatchUpActivity.IActivityContentManager"),
activityNavigationManager:this.container.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),activityRequestManager:this.container.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),appColorUpdateIsEnabled:v.AFrameworkApplication.K.$("AppColorUpdateIsEnabled"),changeSummariesDataProvider:this.container.resolve("Common.App.CatchUpActivity.IChangeSummariesDataProvider"),dataCulture:v.AFrameworkApplication.dataCulture,emptyCatchUpBehaviorManager:this.TYd?this.container.resolve("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager"):
null,flyoutRibbonButton:this.container.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),flyoutFocus:this.container.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),uiCulture:v.AFrameworkApplication.uiCulture,ulsLogger:new Pl.a}));this.v4b.setWebpackPublicPath(v.AFrameworkApplication.a6);this.container.ia("WordEditor.CatchUpActivity.ActivityHighlightActor",()=>new fk(this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"))).ha();
this.container.ia("WordEditor.CatchUpActivity.WordEditorActivityScheduler",()=>new As(v.AFrameworkApplication.K,Hq.a.instance,this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"))).ha();this.container.ia("WordEditor.CatchUpActivity.IndicatorTelemetryActor",()=>new Af(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityIndicatorActor",
()=>new Dn(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.v4b.getActivityIndicatorTooltipManager(),this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor"),this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),ub.App.nn.jb.rc,this.container.Ta("Common.IZoomManager"),v.AFrameworkApplication.lc,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper"),!!Eb.App.instance&&Eb.App.instance.Hpa,this.container.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),
!!Eb.App.instance&&Eb.App.instance.dD)).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityIndicatorManager",()=>new no(this.container.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,ub.App.nn.jb.rc.ed,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor"),v.AFrameworkApplication.va,this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),this.mZd)).ha();this.container.ia("WordEditor.CatchUpActivity.ActivityAnnouncementManager",
()=>new Ec(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("Common.Utils.IAriaNotifier"),v.AFrameworkApplication.va,pc.FocusManager.instance())).ha();this.container.ia("WordEditor.CatchUpActivity.WywaAuthorComparator",()=>new fq(v.AFrameworkApplication.userName,v.AFrameworkApplication.K,this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).ha()}FBm(){var b=this.container.resolve("Box4.Highlight.IHighlightManager"),h=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightActor");
b.b7a(h);const r=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightManager");b=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager");const B=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor");h=this.container.resolve("WordEditor.CatchUpActivity.ActivityAnnouncementManager");const P=this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),ca=Bh.a.instance,ra=this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser");
ca.Ww(()=>{P.w0d?P.w0d=!1:(P.J7a&&r.tYi(null,null,!1),P.ikb&&r.AXi(null,null),B.f8e())});ca.Ww(Object(z.a)(h,h.UY,"onSelectionChanged"));this.v4b.getWywaEvent().addListener(Object(z.a)(b,b.tZf,"onWywaActivityReady"));b=this.container.resolve("WordEditor.CatchUpActivity.WywaAuthorComparator");this.v4b.getWywaEvent().addListener(Object(z.a)(b,b.tZf,"onWywaActivityReady"));const Qa=this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor");ra.syk((tb,Mb)=>{Mb&&Qa.Vrn(Mb.node)});ra.tyb.then(()=>
{Qa.QBk()});this.v4b.getWywaEvent().addListener(()=>{ra.lKk()});B.Ewk((tb,Mb)=>{Mb&&r.AXi(Mb.aFb,Mb.qri)});B.Fwk((tb,Mb)=>{Mb&&r.tYi(Mb.aFb,Mb.qri,Mb.Tto)});B.Tb(v.AFrameworkApplication.va);this.JDf&&this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor").Tb(v.AFrameworkApplication.va);this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").initialize();this.container.resolve("WordEditor.CatchUpActivity.FlyoutFocus").initialize();this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager").initialize();
this.dyo()}dyo(){Hh.c()&&(t.ULS.sendTraceTag(591673372,3012,50,"WordEditorCatchUpActivityPackageManager.ShowRibbonControls"),appChrome.api.dispatch([appChrome.actions.updateControlHiddenState("MarkCatchUpChangeAsRead",!1)]))}dispose(){}}Object(m.a)(Ox,"WordEditorCatchUpActivityPackageManager",null,[1,2]);var ur=c(188),Jr=c(400),uv=c(1530),Dk=c(455),js=c(1640),Wj=c(1531),Px=c(1702),Qw=c(1703),Ot=c(643),Vs=c(1704),vr=c(869),Bs=c(138),dm=c(1539);class Rw{constructor(){this.mt=this.annotation=null}}Object(m.a)(Rw,
"AnnotationChangedData",null,[]);class Ws{constructor(b,h,r,B,P,ca,ra,Qa=!1,tb){this.annotationType=b;this.tA=h;this.eq=r;this.Imc=B;this.jed=P;this.A1o=ca;this.jb=ra;this.fqj=Qa;this.K=tb;this.YA=null;this.tBi=!1;this.fd=new Pc.a;this.F1c=0}iG(b){this.fd.addHandler("AnnotationChangedEvent",b)}jI(b){this.fd.removeHandler("AnnotationChangedEvent",b)}register(){return this.jed().then(()=>{0===this.F1c&&(this.fqj&&(this.YA=this.eq.Zf("WebServiceCall",this.annotationType)),this.tA.ob(this,this.annotationType));
this.F1c++})}unregister(){return this.jed().then(()=>(new Promise(b=>setTimeout(b,this.K.mc(Bs.a.Kml,3E3)))).then(()=>{0<this.F1c&&(this.F1c--,0===this.F1c&&this.tA.sc(this,this.annotationType))}))}k9b(){return this.jed().then(()=>this.tA.getAnnotationsByType(this.annotationType))}n5h(b){b=Jr.a.DJ(b);return(b=this.tA.gof(b))&&0<b.count?b.toArray().filter(h=>Ee.a.matchesTypesFor(h.content,[this.annotationType])):[]}getParent(b){return b?b.parent?b.parent:b.parentPath?this.A1o(this.jb.Zc.xd,b.parentPath):
null:(t.ULS.shipAssertTag(575930380,3016,!1),null)}ewa(b){b.timestamp||(b.timestamp=Date.now());b=Object.assign(new vr.a,{parentPath:["Signal",Ee.a.getTypeNameFor(b)],items:[Object.assign(new cf.a,{body:b})]});this.Imc.submitOperation(b)}Xul(b,h){b=Object.assign(new re.a,{parentPath:["Signal",h],items:b});this.Imc.submitOperation(b)}KB(b,h){b?h?(this.fqj&&!this.tBi&&(this.YA.stop(),this.tBi=!0),this.fd.j9&&(b=new dm.a(Object.assign(new Rw,{annotation:b,mt:h})),this.fd.raiseEvent("AnnotationChangedEvent",
b))):t.ULS.shipAssertTag(575930382,3016,!1):t.ULS.shipAssertTag(575930381,3016,!1)}}Object(m.a)(Ws,"AnnotationManager",null,[613,265]);class Vr{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb){this.pJ=b;this.afe=h;this.uFb=r;this.e2a=B;this.K8=P;this.ozj=ca;this.a2=ra;this.dSb=Qa;this.k7b=tb;this.fOb=Mb;this.YHo=Zb}}Object(m.a)(Vr,"AnnotationManagerHolder",null,[612]);class vv{constructor(b,h){this.V3=b;this.jed=h}submitOperation(b){return this.jed().then(()=>{this.V3.getAugLoopRuntimeManager().submitOperation(Object.assign(new Ef.a,
{operation:b}))})}}Object(m.a)(vv,"SubmitOperationHelper",null,[]);var wv=c(1087),mu=c(1705),Sw=c(1090),fg=c(90),oi=c(124),So=c(78),wr=c(772);class Lm{constructor(b,h,r){this.K8=b;this.um=h;this.fNb=r;this.IEa={};this.vUh=!1;this.Anb=(B,P)=>{var ca;P.data.mt!==re.a.getTypeName()&&P.data.mt!==wr.n.getTypeName()||!P.data.annotation||P.data.annotation.annotationType!==mu.a.getTypeName()||(B=P.data.annotation.content)&&null!==(ca=B.documentTypeConfidences)&&void 0!==ca&&ca.length&&(this.uUh=B.documentTypeConfidences[0].documentTypeLabel,
t.ULS.sendTraceTag(541078657,3016,50,"Document type obtained: {0}",this.uUh))};this.K8.iG(this.Anb);this.K8.register();this.IEa={["docType"]:null,["characterCount"]:null,["paragraphCount"]:null,["imageCount"]:null,["tableCount"]:null,["listElementsCount"]:null,["blobsCount"]:null,["pageCount"]:null,["currentPage"]:null}}oSd(){this.vUh||(this.K8.ewa(new Sw.a),t.ULS.sendTraceTag(541078658,3016,50,"Document type classifier signal sent"),this.vUh=!0);this.ugf();this.IEa.docType=this.uUh;this.IEa.characterCount=
this.characterCount;this.IEa.paragraphCount=this.eS;this.IEa.imageCount=this.HJ;this.IEa.tableCount=this.X$;this.IEa.listElementsCount=this.oHi;this.IEa.blobsCount=this.pHc;this.IEa.pageCount=this.fNb.kHb();this.IEa.currentPage=this.fNb.fei();return this.IEa}ugf(){this.eS=this.pHc=this.oHi=this.X$=this.HJ=this.characterCount=0;var b=this.um.Eoa(ub.App.nn.jb.rc.ed,7,7).currentNode,h=Ad.GraphIterator.eb(b);for(b=Ab.a.Gs(h,b);b.moveNext();)if(h=b.currentNode)if(Id.ImageReader.Mt(h))this.HJ++;else if(Rh.TableReader.KR(h))this.X$++;
else if(fg.ListItemReader.lg(h))this.oHi++;else if(ke.ParagraphReader.Xb(h)){var r=So.e(h);for(let B=0;B<r.length;B++)5===r[B].vh?this.HJ++:this.pHc++;r=oi.AParagraphNode.UP(h.characterData);r=r.trim();this.characterCount+=r.length;0<r.length&&!ke.ParagraphReader.N0(h)&&!ke.ParagraphReader.GR(h)&&this.eS++}}}Object(m.a)(Lm,"LoggingDocumentInfo",null,[609]);class Wm{constructor(){this.sa=new Pc.a}Oyk(b){this.sa.addHandler("OnTaskPaneReviewStateChanged",b)}c2n(b){this.sa.removeHandler("OnTaskPaneReviewStateChanged",
b)}Jxk(b){this.sa.addHandler("BlueDotClickedEvent",b)}G1n(b){this.sa.removeHandler("BlueDotClickedEvent",b)}Xxk(b){this.sa.addHandler("OnFormattingMarkedForReview",b)}Zxk(b){this.sa.addHandler("OnFormattingReviewCompleted",b)}Wxk(b){this.sa.addHandler("OnFormattingAccept",b)}Yxk(b){this.sa.addHandler("OnFormattingReject",b)}Eyk(b){this.sa.addHandler("OnReviewInvalidated",b)}Arh(b){this.sa.addHandler("OnTraigeAction",b)}u0e(b){this.sa.addHandler("OnReviewVisibilityChanged",b)}W1n(b){this.sa.removeHandler("OnReviewVisibilityChanged",
b)}Gxk(b){this.sa.addHandler("OnBeforeReviewNavigation",b)}Ayk(b){this.sa.addHandler("OnRegisterEnhancement",b)}Qyk(b){this.sa.addHandler("onTooltipVisibilityChanged",b)}d2n(b){this.sa.removeHandler("onTooltipVisibilityChanged",b)}Q5c(b){b?this.sa.raiseEvent("OnTaskPaneReviewStateChanged",new dm.a(b)):t.ULS.shipAssertTag(575930374,3016,!1)}zOn(b){b?this.sa.raiseEvent("BlueDotClickedEvent",new dm.a(b)):t.ULS.shipAssertTag(575930375,3016,!1)}COn(b){b?this.sa.raiseEvent("OnFormattingMarkedForReview",
new dm.a(b)):t.ULS.shipAssertTag(575930376,3016,!1)}Q6i(b){b?this.sa.raiseEvent("OnFormattingReviewCompleted",new dm.a(b)):t.ULS.shipAssertTag(573850377,3016,!1)}BOn(b){b?this.sa.raiseEvent("OnFormattingAccept",new dm.a(b)):t.ULS.shipAssertTag(575930377,3016,!1)}DOn(b){b?this.sa.raiseEvent("OnFormattingReject",new dm.a(b)):t.ULS.shipAssertTag(575930378,3016,!1)}EOn(b){b?this.sa.raiseEvent("OnReviewInvalidated",new dm.a(b)):t.ULS.shipAssertTag(575930379,3016,!1)}y5f(b){b?this.sa.raiseEvent("OnTraigeAction",
new dm.a(b)):t.ULS.shipAssertTag(573850378,3016,!1)}R6i(b){b?this.sa.raiseEvent("OnReviewVisibilityChanged",new dm.a(b)):t.ULS.shipAssertTag(573850379,3016,!1)}yOn(b){b?this.sa.raiseEvent("OnBeforeReviewNavigation",new dm.a(b)):t.ULS.shipAssertTag(573687395,3016,!1)}Yic(b){b?this.sa.raiseEvent("OnRegisterEnhancement",new dm.a(b)):t.ULS.shipAssertTag(555055117,3016,!1)}k7i(b){b?this.sa.raiseEvent("onTooltipVisibilityChanged",new dm.a(b)):t.ULS.shipAssertTag(540587343,3016,!1)}}Object(m.a)(Wm,"ReviewEvents",
null,[516]);class Tw{constructor(b){this.gu=b;if(!b)throw ur.a.argument("Workspace is null");}get name(){return"WordEditor.Designer.Common"}init(){}wc(b){this.W=b;b.ia("WordEditor.Designer.Common.AL.ISubmitOperationHelper",()=>new vv(this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),Jr.a.ml)).ha();b.ia("WordEditor.Designer.IDesignerControl",()=>new wv.a(b.resolve("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager"),v.AFrameworkApplication.uiCulture)).ha();b.ia("WordEditor.Designer.Common.Review.IReviewEvents",
()=>new Wm).ha();b.ia("WordEditor.Designer.Common.AL.IAnnotationManagerHolder",()=>new Vr(this.eEa(Wj.DocumentRoleDetectionAnnotation.getTypeName()),this.eEa(Wj.RoleDetectionAnnotation.getTypeName()),this.eEa(uv.FormattingSuggestionsSummaryAnnotation.getTypeName(),!0),this.eEa(uv.FormattingSuggestionsAnnotation.getTypeName()),this.eEa(Dk.DocumentTypeClassifierAnnotation.getTypeName()),this.eEa(Qw.ThemeExtractorAnnotation.getTypeName()),this.eEa(Ot.ThemeGeneratorAnnotation.getTypeName()),this.eEa(Px.TextToImageAnnotation.getTypeName()),
this.eEa(js.DocumentPullQuoteAnnotation.getTypeName()),this.eEa(js.PullQuoteAnnotation.getTypeName()),this.eEa(Vs.TableTypeAnnotation.getTypeName()))).ha();b.ia("WordEditor.Designer.DocumentInfo",()=>new Lm(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").K8,b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("WordEditor.IPageNumberFinder"))).ha()}dispose(){}eEa(b,h=!1){return new Ws(b,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),
this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),Jr.a.ml,Jr.a.ljb,this.gu,h,this.W.resolve("Common.IAppSettingsManager"))}}Object(m.a)(Tw,"PackageManager",null,[1,2]);var Jq=c(1053),Wr=c(1523),Xs=c(1708);class To extends Sys.EventArgs{constructor(b,h){super();this.node=b;this.ATf=h}}Object(m.a)(To,"RoleChangeArgs",Sys.EventArgs,[]);class aw{constructor(b){this.Oh=!1;this.I7=b;this.I7.yod++}dispose(){this.Oh||(this.Oh=!0,this.I7.yod--)}}Object(m.a)(aw,"InvalidationSuspension",
null,[9]);class Ul{constructor(){this.qbd=null;this.role=this.$4d=0;this.kBb=this.D0d=this.uia=this.jec=!1;this.f4d=this.b0c=this.JPa=null;this.hpb=this.placeholder=!1;this.mDd=this.xcf=null;this.lDd=0}get s4a(){return!this.role||!this.JPa||!this.JPa.length}sGm(){this.kBb=this.D0d=!0}oXm(){return!!this.role||!!this.JPa||!!this.qbd}}Object(m.a)(Ul,"RoleState",null,[551]);class mm{constructor(b,h,r,B,P){this.Zh=!1;this.EYd=null;this.ROf=new Ng.a;this.TYg=0;this.K9n=(ca,ra)=>{ra.data.mt===re.a.getTypeName()&&
(ra=ra.data.annotation,(ca=ra.content)?(ra=this.I_b.getParent(ra))&&this.J9c(ra,Wr.e(ca.roleType),!1,void 0,null!=ca.listID?ca.listID:0,ca.listItemlevel,ca.listItemPrefix):t.ULS.shipAssertTag(575813856,3016,!1))};this.Yrl=(ca,ra)=>{if(ra.data.mt===re.a.getTypeName())if(ca=ra.data.annotation.content)for(t.ULS.sendTraceTag(556074199,3016,50,ca.confidence.toString()),this.ROf=new Ng.a,ra=0;ca.listInfos&&ra<ca.listInfos.length;ra++){const Qa=ca.listInfos[ra];this.ROf.Z(Qa.listID,Qa)}else t.ULS.shipAssertTag(556323522,
3016,!1)};this.iAi=(ca,ra)=>{ca=ca.RL;if(!ca||ca.ja(Mc.a.tB,!1))return!1;ca=ca.getValue(Mc.a.ma);if(!ca)return!1;ca=Wr.f(ca);return 1!=ca&&ca!=ra.role};this.AJl=(ca,ra)=>{ca=ra.data.annotation;const Qa=this.mmd.getParent(ca);if(Qa)if(ra.data.mt===re.a.getTypeName()){const tb=ra.data.annotation.content;tb?this.lea(Qa,Mb=>{this.EYd&&Mb.xcf&&this.EYd>Mb.xcf&&!Mb.kBb||Mb.role!==Mb.$4d||this.iAi(Qa,Mb)?(t.ULS.sendTraceTag(572301727,3016,50,"InvalidationTimestamp: {0} | InvalidatedFlag: {1} | RlmRole==ModelRole: {2}",
this.EYd,Mb.kBb,Mb.role===Mb.$4d),Mb.qbd=tb.suggestions):(Mb.JPa=tb.suggestions,Mb.kBb=!1)}):t.ULS.shipAssertTag(575813859,3016,!1)}else ra.data.mt===Jq.a.getTypeName()&&this.lea(Qa,tb=>{tb.JPa=null;tb.qbd=null});else t.ULS.shipAssertTag(575813858,3016,!1,`Parent not found for annotation id: ${ca.id} parentPath: ${ca.parentPath}`)};this.Kon=(ca,ra)=>{(ca=ra.data.paragraphNode)?this.lea(ca,Qa=>{ra.data.nJj?(Qa.mDd=Qa.JPa,Qa.lDd=Qa.role):(Qa.mDd=null,Qa.lDd=0);Qa.uia=!0}):t.ULS.shipAssertTag(575930368,
3016,!1)};this.Mon=(ca,ra)=>{(ca=ra.data.paragraphNode)?this.lea(ca,Qa=>{Qa.uia=!1;Qa.mDd=null;Qa.lDd=0;5!==ra.data.state&&(Qa.JPa=null)}):t.ULS.shipAssertTag(573850380,3016,!1)};this.Ion=(ca,ra)=>{(ca=ra.data.paragraphNode)?this.lea(ca,Qa=>{Qa.uia=!0}):t.ULS.shipAssertTag(575930369,3016,!1)};this.Lon=(ca,ra)=>{(ca=ra.data.paragraphNode)?this.J9c(ca,1,!0,!0):t.ULS.shipAssertTag(575930370,3016,!1)};this.bZf=(ca,ra)=>{(ca=ra.data.paragraphNode)?this.J9c(ca,ra.data.ATf,!0,!0):t.ULS.shipAssertTag(575484484,
3016,!1)};this.Mmm=(ca,ra)=>{if(ra.node){var Qa=ra.node;ca=this.GA(Qa);27==ca.role&&t.ULS.sendTraceTag(541435078,3016,50,"Pull Quote node deleted.");ca.uia&&27!==ca.role&&28!==ca.role&&this.apj(this.EPb-1);ca.s4a||27===ca.role||28===ca.role||this.Uoj(this.inconsistenciesCount-1);this.lea(Qa,tb=>{tb.hpb=!0});setTimeout(()=>this.removeNode(Qa),1E4)}else t.ULS.shipAssertTag(575930371,3016,!1)};this.removeNode=ca=>{let ra;({value:ra}=this.Bu.Fc(ca.id));(null===ra||void 0===ra?0:ra.hpb)&&this.Bu.remove(ca.id)};
this.Lmm=(ca,ra)=>{ra.node?(ca=ra.node,this.UGf(ca)?this.lea(ca,Qa=>{Qa.hpb=!1}):this.lea(ca,Qa=>{Qa.kBb=!1})):t.ULS.shipAssertTag(540672206,3016,!1)};this.Nmm=(ca,ra)=>{ra.node?this.egg(ra.property,ra.node)&&(ca=ra.node,this.yod||ca.Aae?this.lea(ca,Qa=>{Qa.kBb=!1}):this.lea(ca,Qa=>{Qa.sGm();Qa.qbd&&(Qa.JPa=Qa.qbd,Qa.role=Qa.$4d)}).uia&&this.rZa.EOn(new Xs.a(ra.node))):t.ULS.shipAssertTag(575930372,3016,!1)};this.Wsn=(ca,ra)=>{switch(ra.data.role){case 27:const Qa=ra.data;this.lea(ra.data.paragraphNode,
Mb=>{Mb.role=27;Mb.jec=!0;Mb.placeholder=Qa.placeholder});break;case 28:const tb=ra.data;this.lea(ra.data.paragraphNode,Mb=>{Mb.role=28;Mb.jec=!0;Mb.placeholder=tb.placeholder;Mb.dpa=tb.dpa});break;case 2:this.lea(ra.data.paragraphNode,Mb=>{Mb.role=2})}};this.mmd=b;this.I_b=h;this.Fze=r;this.Sq=B;this.rZa=P;this.Bu=new Ng.a;this.sa=new Pc.a;this.yod=this.Xvd=this.bod=0}get NGm(){return this.yod}byk(b){this.sa.addHandler(mm.SVi,b)}Iyk(b){this.sa.addHandler(mm.dYi,b)}Hyk(b){this.sa.addHandler(mm.cYi,
b)}get inconsistenciesCount(){return this.bod}Uoj(b){this.bod!==b&&(this.bod=b,this.sa.raiseEvent(mm.SVi,new dm.a(this.bod)))}get EPb(){return this.Xvd}apj(b){this.Xvd!==b&&(this.Xvd=b,this.sa.raiseEvent(mm.dYi,new dm.a(this.Xvd)))}get Mzf(){return this.TYg}UGf(b){return this.Bu.nb(b.id)}q4l(b){var h,r;return null===(r=null===(h=this.ROf)||void 0===h?void 0:h.Fc(b))||void 0===r?void 0:r.value}xei(b,h){var r,B,P;const ca=new Map;for(const ra of h)if(h=ra){const Qa=null!==(P=null===(B=null===(r=this.Bu.Fc(h.id))||
void 0===r?void 0:r.value)||void 0===B?void 0:B.role)&&void 0!==P?P:1;b.has(Qa)&&(ca.has(Qa)?ca.get(Qa).add(h):ca.set(Qa,new mb.a([h])))}return ca}GA(b){if(!b)return t.ULS.shipAssertTag(575813855,3016,!1),null;let h;return({value:h}=this.Bu.Fc(b.id)).returnValue?h:Object.assign(new Ul,{role:1,jec:!1})}w5n(){this.EYd=new Date;return new aw(this)}register(){this.mmd.register();this.I_b.register();this.Fze.register()}unregister(){this.mmd.unregister();this.I_b.unregister();this.Fze.unregister()}initialize(){if(!this.Zh){const b=
this.Sq.Ue(12);b.Vw(this.Mmm);b.ju(this.Lmm);b.Eo(this.Nmm);this.mmd.iG(this.AJl);this.I_b.iG(this.K9n);this.Fze.iG(this.Yrl);this.rZa.Yxk(this.Lon);this.rZa.Wxk(this.Ion);this.rZa.Xxk(this.Kon);this.rZa.Zxk(this.Mon);this.rZa.Arh(this.bZf);this.rZa.Ayk(this.Wsn);this.Zh=!0}}Od(){}J9c(b,h,r,B=!1,P=0,ca=0,ra){let Qa=0,tb=!1;this.lea(b,Mb=>{const Zb=Mb.D0d||!Mb.role||1==Mb.role;r||(Mb.$4d=h);if(B||Zb)tb=Mb.role!==h,Qa=Mb.role,Mb.role=h,Mb.jec=r,Mb.D0d=!1,Mb.b0c=P,Mb.f4d=ca,Mb.listItemPrefix=ra,Mb.xcf=
new Date});if(tb){const Mb=h-4;Mb>this.Mzf&&8>Mb&&(this.TYg=Mb);1===h&&this.lea(b,Zb=>{Zb.JPa=null});this.sa.raiseEvent(mm.cYi,new dm.a(new To(b,h,Qa)))}}lea(b,h){let r;if(({value:r}=this.Bu.Fc(b.id)).returnValue){b=r.s4a;const B=r.uia;h(r);if(27!==r.role&&28!==r.role){if(r.hpb)return r;b!==r.s4a&&this.Uoj(this.inconsistenciesCount+(b?1:-1));B!==r.uia&&this.apj(this.EPb+(B?-1:1))}}else h(r=new Ul),r.oXm()&&this.Bu.add(b.id,r);return r}egg(b,h){({value:h}=this.Bu.Fc(h.id));return 28===(null===h||void 0===
h?void 0:h.role)?!(null===h||void 0===h?0:h.placeholder)&&b===Pd.a.wo:!(null===h||void 0===h?0:h.placeholder)&&(b===Pd.a.wo||b===Pd.a.Sn||Array.contains(oi.AParagraphNode.$ha(),b))}}mm.SVi="OnInconsistenciesChanged";mm.dYi="OnRoleReviewCount";mm.cYi="OnRoleChanged";Object(m.a)(mm,"RoleLifecycleManager",null,[521,522,523]);class Cs{constructor(b,h,r,B,P){this.rZa=b;this.I_b=h;this.Je=r;this.Sq=B;this.I7=P;this.Zh=!1;this.bZf=(ca,ra)=>{(ca=ra.data.paragraphNode)?this.JFj(ca,()=>!0,Qa=>Qa.userSetRole=
Wr.d(ra.data.ATf)):t.ULS.shipAssertTag(557057378,3016,!1)};this.Rrn=(ca,ra)=>{0<this.I7.NGm||this.egg(ra.property)&&this.JFj(ra.node,Qa=>!(Qa&&Qa.isInvalidated),Qa=>Qa.isInvalidated=!0)}}initialize(){this.Zh||(this.rZa.Arh(this.bZf),this.Sq.Ue(12).Eo(this.Rrn),this.Zh=!0)}Od(){}JFj(b,h,r){if(b=(b=this.I_b.n5h(b))&&1===b.length&&b[0]){var B=b.content;B=B&&B.M_&&B.M_.customMetadata;h(B)&&(h=new Wj.RoleDetectionCustomMetadata,h.isInvalidated=B&&B.isInvalidated,h.userSetRole=B&&B.userSetRole,r(h),this.Je.aUo(b,
h))}}egg(b){return b===Pd.a.wo||b===Pd.a.Sn||Array.contains(oi.AParagraphNode.$ha(),b)}}Object(m.a)(Cs,"RoleDetectionMetadataUpdater",null,[520]);class bw{constructor(b,h){this.Imc=b;this.fEb=h;this.d2c=(r,B)=>{r=B.data;if(r.mt==wr.a.getTypeName()||r.mt==wr.n.getTypeName())if(r=r.annotation&&r.annotation.content)this.runId=r.runId};this.revisionId=0}initialize(){this.fEb.iG(this.d2c)}Od(){this.fEb.jI(this.d2c)}oln(){if(void 0===this.runId)Promise.resolve();else{var b=new Wj.RoleDetectionSettings({acceptedRunId:this.runId});
b=new wr.a({parentPath:["session","doc","main"],items:[{id:"RoleDetectionSettings",body:b,revId:(this.revisionId++).toString()}]});this.Imc.submitOperation(b)}}}Object(m.a)(bw,"RoleDetectionSettingsUpdater",null,[]);class st{constructor(b,h,r){this.wFm=b;this.tA=h;this.Zd=r;this.Eti=this.initialized=!1;this.NTi=()=>{this.Hqj()&&(this.esi(),this.tA.y1n(this.NTi))}}initialize(){this.initialized||(this.LBf(),this.initialized=!0)}Od(){}LBf(){this.Hqj()?this.esi():this.tA.uxk(this.NTi)}Hqj(){return!this.Eti&&
(this.Zd.ixi()||this.tA.acc(Wj.DocumentRoleDetectionAnnotation.getTypeName())||this.tA.acc(Wj.RoleDetectionAnnotation.getTypeName()))}esi(){for(const b of this.wFm)b.initialize();this.Eti=!0}}Object(m.a)(st,"RLMInitializer",null,[]);class tt{constructor(b,h,r){this.BZ=b;this.gu=h;this.Ygd=r;this.W=null;this.nka=()=>{this.zVc();this.gu.gpb(this.nka)};if(!b)throw ur.a.argument("AppLifecycleManager is null");if(!h)throw ur.a.argument("Workspace is null");if(!r)throw ur.a.argument("ApplicationInstance is null");
}get name(){return"WordEditor.DocumentUnderstanding.RLM"}init(){this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>this.wn())}wc(b){this.W=b;b.ia("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater",()=>new bw(this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").pJ)).ha();b.ia("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater",()=>new Cs(b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),
b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").afe,b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).ha();b.ia("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager",()=>new mm(b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").e2a,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").afe,b.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").pJ,
b.resolve("Box4.Graph.IGraphInstance"),b.resolve("WordEditor.Designer.Common.Review.IReviewEvents"))).ha();b.ia("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader",()=>b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager")).ha();b.ia("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer",()=>new st([this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater")],b.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
b.resolve("WordEditor.Designer.IDesignerControl"))).ha()}dispose(){}wn(){this.Ygd.MJ?this.BZ.pk(16,()=>this.NUc()):this.NUc()}NUc(){this.gu.zxa?this.zVc():this.gu.sga(this.nka)}zVc(){this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater").initialize();this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer").initialize()}}Object(m.a)(tt,"PackageManager",null,[1,2]);class Qn{constructor(){this.ContractVersion=0;this.FileName=this.Paragraphs=null}static construct(b,
h){const r=new Qn;r.ContractVersion=b;r.FileName=h;r.Paragraphs=[];return r}}Object(m.a)(Qn,"DocumentSwayPreviewContent",null,[]);class ep{constructor(){this.TextRuns=this.ParagraphFormatting=this.RawText=null;this.ParagraphIndex=0;this.IsRTL=!1}static R6k(b,h,r,B){const P=new ep;P.RawText=b;P.ParagraphFormatting=h;P.TextRuns=r;P.IsRTL=B;P.ParagraphIndex=0;return P}}Object(m.a)(ep,"ParagraphContent",null,[]);var Am=c(99),gq=c(1215);class $n{constructor(){this.Name=null;this.Size=0}static construct(b,
h){const r=new $n;r.Name=b;r.Size=h;return r}}Object(m.a)($n,"FontData",null,[]);class Jk{constructor(){this.IsUppercase=this.IsUnderline=this.IsBold=!1;this.Font=null;this.LeftIndent=this.Alignment=0}static construct(b,h,r,B,P,ca){const ra=new Jk;ra.IsBold=b;ra.IsUnderline=h;ra.IsUppercase=r;ra.Font=B;ra.Alignment=P;ra.LeftIndent=ca;return ra}}Object(m.a)(Jk,"TextFormatting",null,[]);class xq{constructor(){this.RunFormatting=this.RawText=null}static construct(b,h){const r=new xq;r.RawText=b;r.RunFormatting=
h;return r}}Object(m.a)(xq,"TextRunContent",null,[]);var pn=c(104),Uf=c(40);class Nu{constructor(b,h){this.oab=null;this.P$j=b;this.YN=h||""}get szn(){return this.P$j.value}EAl(){var b=Date.now();const h=Qn.construct(2,this.YN);h.Paragraphs=this.vNl();b=Date.now()-b;const r={};r.ExtractionDurationInMs=b.toString();t.ULS.sendTraceTag(25268374,382,50,"{0}",r);return h}vNl(){const b=new mb.a;var h=0;let r=0,B=!1;var P=new Ad.GraphIterator;P.set(this.szn);P=Ab.a.gp(P.currentNode);const ca=new Ng.a(0);
for(;P.moveNext()&&2100>r&&25>h;){var ra=P.currentNode;if(ke.ParagraphReader.Xb(ra)&&!ke.ParagraphReader.N0(ra)){!B&&ke.ParagraphReader.GR(ra)&&(B=!0);let Qa=oi.AParagraphNode.UP(ra.characterData);Qa=Qa.trim();if(0<Qa.length){const tb=this.AU(ra);tb.ParagraphIndex=h;h++;r+=Qa.length;b.add(tb);this.xXo(ca,ke.ParagraphReader.language(ra))}}}this.oab=this.tUl(ca);h={};h.documentHasList=B;t.ULS.sendTraceTag(25776736,382,50,"{0}",h);return b.toArray()}tUl(b){let h=-1,r=1033;for(const B of b.keys.toArray())B&&
b.J(B)>h&&(h=b.J(B),r=B);return lj.a.tg(r)}xXo(b,h){b.nb(h)?b.Z(h,b.J(h)+1):b.Z(h,1)}AU(b){const h=oi.AParagraphNode.UP(b.characterData),r=this.Y8l(b),B=this.Ohm(b);b=this.$Rm(b);return ep.R6k(h,r,B,b)}Y8l(b){const h=ke.ParagraphReader.ao(b,Pd.a.bold,!1),r=ke.ParagraphReader.ao(b,Pd.a.underline,!1);var B=ke.ParagraphReader.ao(b,Pd.a.fontSize,Am.a.GM);const P=ke.ParagraphReader.ao(b,Pd.a.font,Am.a.OH);var ca=ke.ParagraphReader.Lx(b);ca=this.Tnf(ca);const ra=!!ke.ParagraphReader.ao(b,gi.a.capitalization,
0);b=(new gq.a).wU(b).value/20;B=$n.construct(P,B);return Jk.construct(h,r,ra,B,ca,b)}Ohm(b){const h=new mb.a;for(let P=0;P<b.qa.length-1;P++){var r=b.qa.J(P),B=b.qa.J(P+1);r.formatting&&(B=oi.AParagraphNode.UP(b.characterData.substr(r.cp,B.cp-r.cp)),r=this.Phm(r.formatting),r=xq.construct(B,r),h.add(r))}return h.toArray()}Phm(b){const h=pn.FormattingReader.XRc(b,Pd.a.bold,!1),r=pn.FormattingReader.XRc(b,Pd.a.underline,!1);var B=pn.FormattingReader.XRc(b,Pd.a.fontSize,Am.a.GM);const P=pn.FormattingReader.XRc(b,
Pd.a.font,Am.a.OH);B=$n.construct(P,B);b=!!pn.FormattingReader.XRc(b,gi.a.capitalization,0);return Jk.construct(h,r,b,B,5,0)}Tnf(b){switch(b){case 1:return 0;case 3:return 1;case 2:return 2;case 6:return 3;case 0:return 5;default:return 4}}$Rm(b){const h=new Ad.GraphIterator;h.set(b);h.zb(11);return(b=h.jd(11))?Uf.OutlineElementReader.Pn(b):!1}}Object(m.a)(Nu,"DocumentContentExtractor",null,[474]);class Aa{get name(){return"WordEditor.DocumentContentExtractor"}init(){}dispose(){}wc(b){b.ia("WordEditor.DocumentContentExtractor.DocumentContentExtractor",
()=>new Nu(new pf.a(()=>ub.App.nn.jb.rc.ed),v.AFrameworkApplication.Js.xz)).as("Box4.DocumentContentExtractor.IDocumentContentExtractor").ha()}static main(){L.a.instance.Gc(new Aa)}}Object(m.a)(Aa,"DocumentContentExtractorPackage",null,[1,2]);class Sa{}Sa.Vg="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";Object(m.a)(Sa,"EmbedDialogHtml",null,[]);class Ea{constructor(b,h,r,B){this.thc=
b;this.E3a=h;this.y9d=r;this.value=B}}Object(m.a)(Ea,"OptionInfo",null,[]);class wa{constructor(b,h,r){this.Ebg=b;this.lbc=h;this.E3a=r}}Object(m.a)(wa,"SectionInfo",null,[]);var $a=c(274);class rb extends Pe.a{constructor(b,h=!1){super(!1,!1,h);this.Qkd=476;this.MWb=288;this.Xye=798;this.Nfk=476;this.Mfk=288;this.E3c={};this.Dpb=[];this.qW=this.RYa=this.Ixb=this.oub=this.$sd=this.g_b=null;this.Kuc=v.AFrameworkApplication.LTc;this.myb=b;this.fNe=Object(z.a)(this,this.Kxn,"optionClickHandler");this.xAc=
Object(z.a)(this,this.Lxn,"optionKeyHandler");this.Zte=Object(z.a)(this,this.OHk,"arrowClickHandler");this.LUb=Object(z.a)(this,this.PHk,"arrowKeyHandler");this.Vyd=Object(z.a)(this,this.oJo,"textAreaOnFocusHandler");this.l9j=h;this.Vg=Sa.Vg;this.Cd=0;this.yg="EmbedDialog"}get Qr(){return this.MWb}set Qr(b){this.MWb=b}ctj(b){const h={["id"]:this.yg,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,
["interactionSectionTitle"]:CommonUIStrings.l_Interaction,["initialPreviewUrl"]:ia.a.fp(this.myb,"wdPreview","1"),["initialEmbedUrl"]:this.Kuc,["getEmbedCode"]:rb.s9h,["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};for(const r of Object.keys(b))h[r]=b[r];this.Cd=1;this.ze(1,CommonUIStrings.l_CopyAction);this.ze(0,CommonUIStrings.l_Close);this.Uh(CommonUIStrings.l_Embed,null,h)}Vlc(){if(this.l9j)this.ctj({});else{this.showDialog(CommonUIStrings.l_Embed,null);this.g_b=document.getElementById("embedpreviewpane");
this.$sd=document.getElementById("embedoptionpane");this.g_b.style.width=String.format("{0}px",this.Nfk);this.RYa=document.createElement("iframe");this.RYa.className=rb.Lfk;this.RYa.frameBorder="0";this.RYa.style.height=String.format("{0}px",this.Mfk);this.RYa.tabIndex=-1;this.g_b.appendChild(this.JJd(CommonUIStrings.l_Preview,this.RYa,rb.Qbh,rb.Pbh,rb.Qbh,!0));this.qW=document.createElement("textarea");this.qW.className=rb.R1j;Sys.UI.DomElement.addCssClass(this.qW,$a.a.x1e);this.qW.id=rb.ZTg;Z.a.vi||
(this.qW.readOnly=!0);this.qW.rows=4;this.qW.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;this.qW.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;this.qW.setAttribute(Se.a.yga,String.format("{0} {1}",rb.YTg,rb.XTg));this.g_b.appendChild(this.JJd(CommonUIStrings.l_EmbedCode,this.qW,rb.YTg));He.a.addHandler(this.qW,"focus",this.Vyd);var b=document.createElement("span");b.className=rb.G3j;b.innerText=CommonUIStrings.l_CopyText;b.id=rb.XTg;this.g_b.appendChild(b);this.oub=document.createElement("div");
this.oub.className=rb.X0j;this.$sd.appendChild(this.JJd(CommonUIStrings.l_Dimensions,this.oub));this.Ixb=document.createElement("div");this.$sd.appendChild(this.g$k(rb.E$g,this.Ixb));this.Cd=0;this.ze(1,CommonUIStrings.l_Close);this.tpg();this.BHj();Z.a.vi||this.qW.focus()}}dispose(){if(this.E3c){var b=this.E3c;for(let h in b){const r=b[h];this.Qq.sc(pd.a.click,r.thc,this.fNe);this.ge.sc(pd.a.gi,r.thc,this.xAc);this.ge.sc(pd.a.yh,r.thc,this.xAc)}this.xAc=this.fNe=this.E3c=null}if(this.Dpb){for(b=
0;b<this.Dpb.length;++b)this.Qq.sc(pd.a.click,this.Dpb[b].lbc,this.Zte),this.ge.sc(pd.a.gi,this.Dpb[b].lbc,this.LUb),this.ge.sc(pd.a.ru,this.Dpb[b].lbc,this.LUb),this.ge.sc(pd.a.yh,this.Dpb[b].lbc,this.LUb);this.ge=this.Zte=this.Dpb=null}this.Vyd&&this.qW&&(He.a.removeHandler(this.qW,"focus",this.Vyd),this.Vyd=null);this.qW=this.RYa=this.Ixb=this.oub=this.$sd=this.g_b=null;super.dispose()}Wda(){super.Wda();this.Kc.style.width=String.format("{0}px",this.Xye);this.FDa()}UVo(b,h){const r=ia.a.fp(this.Kuc,
b,h);return this.Kuc!==r?(this.Kuc=r,this.myb=ia.a.fp(this.myb,b,h),!0):!1}tpg(){this.qW&&(this.qW.innerText=rb.s9h(this.Kuc,this.Qkd,this.MWb))}BHj(){this.RYa&&this.RYa.contentWindow.location.replace(ia.a.fp(this.myb,"wdPreview","1"))}moe(b,h){this.UVo(b,h)&&(this.tpg(),this.BHj())}JJd(b,h,r=null,B=null,P=null,ca=!1){const ra=document.createElement("div");ra.className=rb.xik;B&&(ra.id=B);P&&ra.setAttribute(Se.a.yga,P);ca&&(ra.tabIndex=0);B=document.createElement("span");B.className=rb.yik;B.innerText=
b;r&&(B.id=r);ra.appendChild(B);ra.appendChild(h);return ra}g$k(b,h){const r=this.JJd(CommonUIStrings.l_Interaction,h),B=this.jj.createElement("div");B.className=rb.CWj;B.id=rb.gMg+b;B.setAttribute(Se.a.uh,Se.a.X3);B.tabIndex=0;r.insertBefore(B,h);b=we.createClusteredImage(16,16,rb.DWj,rb.EWj,!0,"");B.appendChild(b);b=b.childNodes[0];b.className=we.getImageClass(rb.oTg);b.title=CommonUIStrings.l_Expand;B.title=CommonUIStrings.l_Expand;h.style.visibility="hidden";h=new wa(h,B,b);Array.add(this.Dpb,
h);this.Qq.nE(pd.a.click,B,this.Zte,h);this.ge.nE(pd.a.gi,B,this.LUb,h);this.ge.nE(pd.a.ru,B,this.LUb,h);this.ge.nE(pd.a.yh,B,this.LUb,h);return r}OHk(b){this.TCh(b);return!0}PHk(b){return this.jZc(b,Object(z.a)(this,this.TCh,"changeArrowState"))}TCh(b){b=b.Vo;"visible"===b.Ebg.style.visibility?(b.Ebg.style.visibility="hidden",b.E3a.className=we.getImageClass(rb.oTg),b.E3a.title=CommonUIStrings.l_Expand,b.lbc.title=CommonUIStrings.l_Expand):(b.Ebg.style.visibility="visible",b.E3a.className=we.getImageClass(rb.Pnk),
b.E3a.title=CommonUIStrings.l_Collapse,b.lbc.title=CommonUIStrings.l_Collapse)}GLh(b,h){const r=document.createElement("div");r.className=rb.B$g;r.id=b+rb.C$g;var B=this.jj.createElement("div");B.tabIndex=0;B.className=rb.DOg;B.id=b+rb.isc;B.setAttribute(Se.a.uh,Se.a.b3e);B.setAttribute(Se.a.rDa,Se.a.xp);B.setAttribute(Se.a.yga,b+rb.jWb);r.appendChild(B);r.setAttribute(Se.a.uh,Se.a.wz);var P=we.createClusteredImage(16,16,rb.JOg,rb.IOg,!0,"");B.appendChild(P);P=P.childNodes[0];P.id=b+rb.D$g;P.className=
we.getImageClass(rb.Wve);B=new Ea(r,P,B,1);this.E3c[b]=B;this.Qq.nE(pd.a.click,r,this.fNe,b);B=document.createElement("span");B.className=rb.jWb;B.innerText=h;B.id=b+rb.jWb;r.appendChild(B);this.ge.nE(pd.a.gi,r,this.xAc,b);this.ge.nE(pd.a.yh,r,this.xAc,b);return r}Kxn(b){this.k_i(b);return!0}Lxn(b){return this.jZc(b,Object(z.a)(this,this.k_i,"optionHandler"))}k_i(b){const h=this.E3c[b.Vo.toString()];h.value?(h.value=0,h.E3a.className=we.getImageClass(rb.YWe),h.y9d.setAttribute(Se.a.rDa,Se.a.xM)):
(h.value=1,h.E3a.className=we.getImageClass(rb.Wve),h.y9d.setAttribute(Se.a.rDa,Se.a.xp));this.moe(b.Vo.toString(),h.value.toString())}oJo(){this.qW.select()}static s9h(b,h,r){if(!rb.JLe){const B=String.format('<a target="_blank" href="{0}">{1}</a>',F.a.cbc("https://office.com"),CommonUIStrings.l_Office),P=String.format('<a target="_blank" href="{0}">{1}</a>',F.a.cbc("https://office.com/webapps"),CommonUIStrings.l_WebAppName);rb.JLe=String.format(CommonUIStrings.l_NoFrames,B,P)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',
F.a.cbc(b),h,r,rb.JLe)}}rb.JLe=null;rb.Wve="CheckboxChecked_16x16x32";rb.YWe="CheckboxUnchecked_16x16x32";rb.Pnk="OutlookSearchChevronUp_16x16x32";rb.oTg="OutlookSearchChevronDown_16x16x32";rb.JOg="CommentChecked";rb.DWj="UpArrowServer";rb.jWb="EmbedDescription";rb.xik="EmbedSectionHeader";rb.yik="EmbedSectionName UIFontBold";rb.G3j="EmbedCodeFooter";rb.IOg="EmbedOptionImage";rb.Lfk="EmbedPreviewFrame";rb.R1j="EmbedCodeTextArea";rb.B$g="EmbedOption";rb.X0j="EmbedDimensionSection";rb.EWj="EmbedArrowIcon";
rb.CWj="WACGlyph EmbedArrowHolder";rb.DOg="EmbedCheckBoxHolder";rb.C$g="Option";rb.D$g="OptionImage";rb.ZTg="EmbedCode";rb.YTg="EmbedCodeHeader";rb.Qbh="Preview";rb.Pbh="PreviewHeader";rb.E$g="Options";rb.gMg="Arrow";rb.isc="Check";rb.XTg="EmbedCodeFooter";Object(m.a)(rb,"EmbedDialog",Pe.a,[]);class Ob extends Ea{constructor(b,h,r,B,P){super(b,h,r,B);this.N3a=P}}Object(m.a)(Ob,"OptionInputInfo",Ea,[]);class oc extends rb{constructor(b,h){super(b,oc.PL);this.oba=null;this.euc=[];this.Pxd=Object(z.a)(this,
this.aDo,"startOnOptionClickHandler");this.G0b=Object(z.a)(this,this.bDo,"startOnOptionKeyHandler");this.rtd=Object(z.a)(this,this.Irn,"onPageNumberChanged");this.ize=Object(z.a)(this,this.Nnn,"onDimensionChanged");this.qH=h}Vlc(){if(oc.PL){var b=oc.aQn,h=[];h.push({["id"]:"wdPrint",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.qH.k4i,["urlTransformFunctionOnChange"]:b},{["id"]:"wdEmbedCode",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.qH.$8i,["urlTransformFunctionOnChange"]:b},{["id"]:"wdStartOn",
["checkboxInitialValue"]:!1,["checkboxLabel"]:this.qH.Fvj,["urlTransformFunctionOnChange"]:b,["textInputProps"]:{["title"]:this.qH.Gvj}});this.ctj({["dimensionsOptions"]:{["isMultipleChoice"]:!1,["defaultWidth"]:this.Qkd,["defaultHeight"]:this.MWb,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:this.qH.aLj,["heightLabel"]:this.qH.Doi},["interactionOptions"]:h})}else super.Vlc(),this.Coh(this.qH.aLj,"EmbedWidthInput",this.Qkd),this.Coh(this.qH.Doi,"EmbedHeightInput",this.MWb),this.Ixb.appendChild(this.GLh("wdPrint",
this.qH.k4i)),this.Ixb.appendChild(this.GLh("wdEmbedCode",this.qH.$8i)),this.zrk(this.qH.Fvj),this.FDa(),pc.FocusManager.lK()&&(b=pc.FocusManager.instance(),h=[document.getElementById(rb.ZTg),document.getElementById("EmbedWidthInput"),document.getElementById("EmbedHeightInput"),document.getElementById(rb.gMg+rb.E$g),document.getElementById("wdPrint"+rb.isc),document.getElementById("wdEmbedCode"+rb.isc),document.getElementById("wdStartOn"+rb.isc),document.getElementById("wdStartOnText"),document.getElementById(mj.a.pgd),
document.getElementById(rb.Pbh)],h=new Dc(h),b.at().hk=h,Z.a.vi?this.I1(document.getElementById(mj.a.pgd)):this.qW.select())}dispose(){if(!oc.PL){if(this.euc){for(let b=0;b<this.euc.length;++b)He.a.removeHandler(this.euc[b],"change",this.ize);this.euc=this.ize=null}this.rtd&&(He.a.removeHandler(this.oba.N3a,"change",this.rtd),this.rtd=null);this.Pxd&&(this.Qq.sc(pd.a.click,this.oba.thc,this.Pxd),this.Pxd=null);this.G0b&&(this.ge.sc(pd.a.gi,this.oba.thc,this.G0b),this.ge.sc(pd.a.yh,this.oba.thc,this.G0b),
this.G0b=null);this.oba=null}super.dispose()}Coh(b,h,r){const B=document.createElement("label");B.className="EmbedInputPrefix";B.innerText=b;this.oub.appendChild(B);b=document.createElement("input");b.className=h;b.id=h;b.value=r.toString();b.type="text";b.setAttribute("data-lpignore","true");B.setAttribute("for",h);this.oub.appendChild(b);this.euc.push(b);He.a.addHandler(b,"change",this.ize);this.oub.appendChild(document.createElement("br"))}Nnn(b){"EmbedWidthInput"===b.target.id?this.Qkd=this.ZMd(b.target,
375):this.MWb=this.ZMd(b.target,250);this.tpg()}ZMd(b,h){let r=parseInt(b.value);if(isNaN(r)||r<h)r=h;b.value=r.toString();return r}Irn(b){b=this.ZMd(b.target,1);1===this.oba.value&&this.moe("wdStartOn",b.toString())}zrk(b){const h=document.createElement("div");h.className=rb.B$g+" EmbedInlineOption";h.id="wdStartOn"+rb.C$g;const r=this.jj.createElement("div");r.tabIndex=0;r.className=rb.DOg;r.id="wdStartOn"+rb.isc;r.setAttribute(Se.a.uh,Se.a.b3e);r.setAttribute(Se.a.rDa,Se.a.xM);r.setAttribute(Se.a.yga,
"wdStartOn"+rb.jWb);h.appendChild(r);h.setAttribute(Se.a.uh,Se.a.wz);var B=we.createClusteredImage(16,16,rb.JOg,rb.IOg,!0,"");r.appendChild(B);B=B.childNodes[0];B.id="wdStartOn"+rb.D$g;B.className=we.getImageClass(rb.YWe);const P=document.createElement("span");P.className=rb.jWb;P.innerText=b;P.id="wdStartOn"+rb.jWb;h.appendChild(P);this.Ixb.appendChild(h);b=document.createElement("input");b.className="EmbedPageNumberInput";b.id="wdStartOnText";b.type="text";b.title=this.qH.Gvj;b.setAttribute("data-lpignore",
"true");this.Ixb.appendChild(b);He.a.addHandler(b,"change",this.rtd);this.oba=new Ob(h,B,r,0,b);this.moe("wdStartOn","1");this.Qq.ob(pd.a.click,h,this.Pxd);this.ge.ob(pd.a.gi,h,this.G0b);this.ge.ob(pd.a.yh,h,this.G0b)}aDo(b){this.Dvj(b);return!0}bDo(b){return this.jZc(b,Object(z.a)(this,this.Dvj,"startOnOptionHandler"))}Dvj(){let b=1;this.oba.value?(this.oba.value=0,this.oba.E3a.className=we.getImageClass(rb.YWe),this.oba.y9d.setAttribute(Se.a.rDa,Se.a.xM)):(this.oba.value=1,this.oba.E3a.className=
we.getImageClass(rb.Wve),b=this.ZMd(this.oba.N3a,1),this.oba.y9d.setAttribute(Se.a.rDa,Se.a.xp));this.moe("wdStartOn",b.toString())}static get PL(){return v.AFrameworkApplication.ua.Kb.vF}static aQn(b,h,r,B=null){if("wdPrint"===h||"wdEmbedCode"===h)return ia.a.fp(b,h,r?"1":"0");if("wdStartOn"===h){let P="1";r&&B&&(B=parseInt(B),!isNaN(B)&&1<=B&&(P=B.toString()));return ia.a.fp(b,h,r?P:"1")}return b}}Object(m.a)(oc,"WordEmbedDialog",rb,[]);class Ic{constructor(b,h,r,B,P){this.vfa=null;this.ga=b;this.Dbb=
h;this.mQ=r;this.qH=B;this.Uea=P}Tb(){this.ga.ra(this.mQ,yd.a.frame,Object(z.a)(this,this.ywo,"showEmbedCode"));this.Dbb.execute(Object(z.a)(this,this.VWf,"onHostPostmessengerCreated"))}VWf(b){t.ULS.shipAssertTag(4994850,332,!!b);this.vfa=b;v.AFrameworkApplication.oia||(this.vfa.Fv(M.a.FBh),this.vfa.eC(M.a.FBh,Object(z.a)(this,this.Vlc,"showEmbedDialog")))}Vlc(b){b=b.Values.HostEmbeddedViewUrl.toString();v.AFrameworkApplication.LTc=b;this.Uea.Rhf=b;(new oc(b,this.qH)).Vlc()}ywo(b,h,r){if(2===r)if(v.AFrameworkApplication.LTc)(new oc(this.Uea.Rhf,
this.qH)).Vlc();else return v.AFrameworkApplication.Vl.H3a(Ic.xOj),v.AFrameworkApplication.Oqg&&this.vfa.sendMessage(M.a.uCl,null)?32:v.AFrameworkApplication.ua.cV(!0,v.AFrameworkApplication.Bkf);return 32}}Ic.xOj=10381;Object(m.a)(Ic,"EmbedActor",null,[]);class J{}Object(m.a)(J,"WordEmbedDialogStrings",null,[]);var ma=c(224);class Ta extends Ic{constructor(b,h){super(b,h,qb.a.khg,Object.assign(new J,{aLj:WordEditorIntl.WordEditorStrings.l_Width,Doi:WordEditorIntl.WordEditorStrings.l_Height,k4i:WordEditorIntl.WordEditorStrings.l_PrintOption,
$8i:WordEditorIntl.WordEditorStrings.l_ReembedOption,Fvj:WordEditorIntl.WordEditorStrings.l_StartOnOption,Gvj:WordEditorIntl.WordEditorStrings.l_StartPage}),ma.WoncaApp.instance)}}Object(m.a)(Ta,"EmbedActor",Ic,[]);class pb{constructor(){this.W=null}get name(){return"WordEditor.Embed"}wc(b){this.W=b;b.ia("WordEditor.Embed.EmbedActor",()=>new Ta(v.AFrameworkApplication.va,b.Ta("Postmessage.IHostPostmessenger"))).ha()}init(){this.W.resolve("WordEditor.Embed.EmbedActor").Tb()}dispose(){}}Object(m.a)(pb,
"EmbedPackage",null,[1,2]);class Wb{constructor(b,h,r){this.gw=this.qLa=this.zNa=null;this.fLa=0;this.uYb=this.oYb=this.aYb=this.DYb=this.xXa=this.wXa=!1;this.Vj=b;this.kn=r}vP(b){return Eb.App.za.jb.isEditingAllowed?""!==this.KQc(b.yf):!1}AL(b){if(!this.vP(b))return!1;this.Dho(b);this.Eho();this.Fho();this.zNa=b.lI;this.gw=new Sys.UI.Point(0,0);t.ULS.sendTraceTag(22381023,322,50,"Image Crop drag started");return!0}eV(b){this.qLa=b.lI;this.WQk();this.Vj.wGj(this.gw.x,this.gw.y,this.DYb,this.aYb,this.oYb,
this.uYb,!1);return!0}iE(){this.Vj.wGj(this.gw.x,this.gw.y,this.DYb,this.aYb,this.oYb,this.uYb,!0);t.ULS.sendTraceTag(22381024,322,50,"Image Crop drag succeeded")}RY(){this.Vj.QTk();t.ULS.sendTraceTag(22381025,322,50,"Image Crop drag canceled")}Eho(){this.uYb=this.oYb=this.aYb=this.DYb=!1;switch(this.fLa){case 1:this.DYb=!0;break;case 5:this.aYb=!0;break;case 3:this.uYb=!0;break;case 7:this.oYb=!0;break;case 0:this.oYb=this.DYb=!0;break;case 2:this.uYb=this.DYb=!0;break;case 6:this.oYb=this.aYb=!0;
break;case 4:this.uYb=this.aYb=!0}}Fho(){this.xXa=this.wXa=!1;switch(this.fLa){case 0:this.xXa=this.wXa=!0;break;case 1:case 2:this.xXa=!0;break;case 7:case 6:this.wXa=!0}}KQc(b){var h=b.className;-1===h.indexOf("WACImageCropHandle")&&b.parentNode&&(h=b.parentNode.className);b=h.split(" ");for(h=0;h<b.length;h++){const r=b[h].toString();if(r.startsWith("WACImageCropHandle")&&"WACImageCropHandles"!==r)return r}return""}Dho(b){switch(this.KQc(b.yf)){case "WACImageCropHandleNW":this.fLa=0;break;case "WACImageCropHandleN":this.fLa=
1;break;case "WACImageCropHandleNE":this.fLa=2;break;case "WACImageCropHandleE":this.fLa=3;break;case "WACImageCropHandleSE":this.fLa=4;break;case "WACImageCropHandleS":this.fLa=5;break;case "WACImageCropHandleSW":this.fLa=6;break;case "WACImageCropHandleW":this.fLa=7}}WQk(){var b=1;this.kn.instance&&(b=this.kn.instance.nj);const h=(this.qLa.x-this.zNa.x)/b;b=(this.qLa.y-this.zNa.y)/b;this.gw.x=this.wXa?-h:h;this.gw.y=this.xXa?-b:b}}Object(m.a)(Wb,"ImageCropDragAdapter",null,[139]);class Jc{constructor(b,
h){this.ga=b;this.kn=h}B0l(b){return new Wb(b,this.ga,this.kn)}}Object(m.a)(Jc,"ImageCropDragAdapterFactory",null,[472]);var Zc=c(300),jd=c(243),dd=c(41),Ld=c(441),$d=c(704),le=c(82),ae=c(61),Oe=c(403),ef=c(991),oh=c(517),Ff=c(910),si=c(141),ui=c(362),Gg=c(253),Bj=c(877),xk=c(207),Yg=c(84),Kf=c(21),wm=c(283),dg=c(785),Bm=c(376),Nf=c(118);class zh{constructor(b,h,r,B,P,ca,ra,Qa,tb=null){this.Zb=tb;this.qVc=null;this.FK=b;this.rh=h;this.Lc=r;this.Ys=B;this.Md=P;this.hb=ca;this.en=ra;this.NE=Qa}get xX(){return null!=
this.Pwg?this.Pwg:this.Pwg=Ma.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get qc(){return null!=this.eKg?this.eKg:this.eKg=Ma.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Hi(){return si.PageReader.instance}Pjo(b,h,r){const B=this.Lc.Pc(15);B.Db(h.node);this.rUa(b,r);B.dispose()}Ojo(b,h,r){const B=this.Lc.Pc(15);B.Db(h.node);this.mQb(b,r);B.dispose()}rUa(b,h){b.setValue(Pd.a.imageAltText,h)}mQb(b,h){b.setValue(Mc.a.sY,h)}Wjo(b,h){b.setValue(Pd.a.jkb,h)}gmj(b,h){var r=Id.ImageReader.ui(b);
Eb.App.instance&&Eb.App.instance.HR(r)?(r=b.ja(dd.a.w6d,null),h=dg.a.fdl(h,r),b.setValue(dd.a.w6d,h)):b.setValue(Mc.a.tY,h)}Sjo(b,h,r,B,P){let ca=0;var ra=0;({width:ca,height:ra}=Id.ImageReader.gjb(b));ra-=(h+r)/1E5*ra;this.LIa(b,ca-(B+P)/1E5*ca);this.KIa(b,ra);this.ymj(b);b.setValue(Mc.a.mUc,h);b.setValue(Mc.a.jUc,r);b.setValue(Mc.a.kUc,B);b.setValue(Mc.a.lUc,P)}Tno(b,h,r,B){const P=this.Lc.Pc(15);P.Db(h.node);this.Hge(b,r,B);P.dispose()}Hge(b,h,r){this.LIa(b,h);this.KIa(b,r);this.ymj(b);b.removeProperty(Yc.a.W$d);
b.removeProperty(Yc.a.U$d)}LIa(b,h){b.setValue(Pd.a.Hia,h);b.setValue(Yc.a.YFa,-1)}KIa(b,h){b.setValue(Pd.a.Gia,h);b.setValue(Yc.a.XFa,-1)}oE(b,h){b.setValue(Mc.a.GTc,h);b.setValue(Pd.a.Kh,h);b.setValue(Pd.a.hr,h)}Ioo(b,h){b.setValue(Mc.a.eSb,h)}Igo(b,h){b.setValue(Mc.a.j4e,h)}Moo(b){if(!Id.ImageReader.Q4(b)&&b.el){var h=b.node;if(Id.ImageReader.r9(h)){const P=this.Lc.Pc(15);P.Db(b.node);b=Ad.GraphIterator.eb(h);b.zb(12);b=b.parentNode;var r=b.properties.wf(Mc.a.vq),B=h.properties.getValue(Mc.a.runId);
h.ja(Mc.a.Wc,ie.a.yS);const ca=b.qa,ra=[Mc.a.GTc,Pd.a.Kh,Pd.a.hr,Mc.a.j4e,Mc.a.eSb,Mc.a.F_a];Eb.App.instance&&Eb.App.instance.HR(Id.ImageReader.ui(h))&&ra.push(dd.a.Ywf,dd.a.Xwf);h.Cg.apply(h,ra);r=this.Hpf(B,r,ca);B=Ue.a.Rc(b,r);this.Ys.MJh(h,B);(h=this.NE.lJ(b,r,r+1))&&this.hb.Ac(h);this.xX.pra(b,r,r+1);P.dispose()}}}Pcg(b,h){if(b.properties.hasProperty(Mc.a.Y7)){const r=b.properties.wf(Mc.a.Y7);r.push(h);b.properties.setValue(Mc.a.Y7,Array.clone(r))}else b.properties.setValue(Mc.a.Y7,[h])}Uhe(b,
h,r=0,B=!1){if(b.el){var P=this.Lc.Pc(15),ca=b.node;P.Db(ca);if(Id.ImageReader.Q4(b)){const Mb=this.Zb&&this.Zb.isFeatureEnabled(47)?new Ff.a:new oh.a;Mb.ax(Id.ImageReader.rn(b));var ra=ca.qa,Qa=this.hEl(b.cpBegin,ra);this.ZGk(b.cpEnd,ra,Qa)&&t.ULS.sendTraceTag(594392136,322,50,"[ImageEditor][SetToAnchor]Comment will be lost");ra=ra.J(Qa).blob;Qa=ra.qe;var tb=ca.properties.wf(Mc.a.vq);tb=this.APn(tb);Qa=tb[Qa];tb=ca.ja(Mc.a.Wc,ie.a.yS);if(ra=Object(Ra.a)(ef.ImageBlobObject,ra))ra.OQb=!1;this.Md.Ge(b,
"");ra&&(ra.OQb=!0);Mb.properties.setValue(Mc.a.runId,Qa);Mb.properties.setValue(Mc.a.Wc,tb);b=Ad.GraphIterator.eb(ca);b.zb(12);b.Bf(Mb,6);this.Pcg(b.currentNode,Mb.anchor.node.id);ca=Mb}r&&this.oE(ca.properties,r);this.Igo(ca.properties,B);this.Ioo(ca.properties,h);this.xX.Ykc(ca);(h=this.NE.Eq(ca))&&this.hb.Ac(h);P.dispose()}}jbg(b,h){if(!(0>=h)){var r=xg.a.Ql(h,0),B=Id.ImageReader.oF(b),P=Id.ImageReader.JG(b);B>r&&(P*=r/B,this.LIa(b,r),this.KIa(b,P),t.ULS.sendTraceTag(37843205,322,50,"Scale image width and height to fit constraining width {0} : ",
h))}}ZGk(b,h,r){const B=h.length;if(r>=B||!h.J(r).Te)return!1;const P=new lo.a;for(;r<B;r++){const ca=h.J(r);if(ca.cp>b||!ca.Te)break;for(let ra=0;ra<ca.Te.length;ra++){if(P.contains(ca.Te.J(ra).Lj))return!0;P.add(ca.Te.J(ra).Lj)}}return!1}APn(b){for(var h=0;h<b.length&&!b[h];)h++;if(h===b.length)for(var r=0;r<b.length;)b[r]=r+1,r++;else{var B=b[h];r=h-1;for(var P=B-1;0<=r;)b[r]=P,r--,P--;P=0;for(r=h+1;r<b.length;)(h=b[r])?h<B?(B=h+P,b[r]=B):B=h:(P+=2,B++,b[r]=B),r++}return b}llf(b,h){let r=0;for(;r<
h.length&&!(b<h[r]);)r++;return r}Hpf(b,h,r){let B=0;const P=this.llf(b,h);let ca=0;if(P===h.length)ca=r.length-1;else for(;ca<r.length;){h=r.J(ca);if(h.formatting&&h.formatting.qe===P)break;ca++}ca<r.length?B=r.J(ca).cp:t.ULS.sendTraceTag(21248159,322,15,"GetCpForRunId index out of bound. {0}",{["Index"]:ca,["RunId"]:b,["CharacterPropertiesArrayLength"]:r.length});return B}hEl(b,h){let r=0;for(;r<h.length&&h.J(r).cp!==b;)r++;r===h.length&&t.ULS.sendTraceTag(21248160,322,15,"FindImageBlobIndexInCharacterPropertiesArray index out of bound. {0}",
{["Index"]:r,["CharacterPropertiesArrayLength"]:h.length});return r}ymj(b){b.setValue(Pd.a.Lxa,!0)}xae(b,h,r,B=!1){h&&r?(h=Math.max(h,$d.a.qPi),r=Math.max(r,$d.a.qPi)):r=h=$d.a.vQh;b.setValue(Pd.a.Hia,xg.a.Ql(h,0));b.setValue(Pd.a.Gia,xg.a.Ql(r,1));b.setValue(Pd.a.imageAltText,Box4Intl.Box4Strings.l_PastedImageLoading);b.setValue(gi.a.B0,hg.a.uploading);b.setValue(Mc.a.tia,B)}fYd(){return null}dUh(b,h,r){let B=null;h=({ZLb:B}=this.eUh(b,h,r)).returnValue;B&&b.view.mb.Ac(B);return h}eUh(b,h,r){var B=
null;if(!this.Hga(b))return{returnValue:null,ZLb:B};var P=b.view;const ca=this.Lc.Pc(15,Nb.a.EIb);ca.Db(P.ed);h||(h=new fd.DictionaryPropertySet);h.setValue(Yc.a.Lsl,!0);let ra=P.mb.qg;var Qa=new Bj.a;if(!xe.SelectionEditor.Ze(ra)){if(2===v.AFrameworkApplication.va.processAction(Nb.a.Qna,2))return ca.dispose(),{returnValue:null,ZLb:B};ra=P.mb.qg}else if(ra.el&&ke.ParagraphReader.Xb(ra.node)){Eb.App.zd.Uo&&Eb.App.zd.fq.gG(ra.node);P=pn.FormattingReader.Yr(ra);if(!P)return ca.dispose(),{returnValue:null,
ZLb:B};P.cache.UB&&(P=P.vf(null),zh.qn.F5(P));Qa.formatting=P.Yj;Qa.languageId=pn.FormattingReader.language(P);Qa.Pka=this.qc.So(ra.node)}if(!ra.el)return ca.dispose(),{returnValue:null,ZLb:B};if(!this.xCf(b.ik,h))return ca.dispose(),this.qVc=null,{returnValue:null,ZLb:B};b=this.qVc;this.qVc=null;1===b.location?(B=b.node,h=Bm.a.instance.bwf(B),ig.OutlineElementNavigator.ns(h,!1,!1)||(xk.OutlineNavigator.Oee(h),this.FK.a8(h,!0,Qa)),ig.OutlineElementNavigator.Ee(h),Rh.TableReader.isTable(h)&&(Object(Ib.a)(Nf.a,
h)||Object(Ib.a)(ui.a,h)?(Qa=new Ad.GraphIterator,Qa.set(h.currentNode),Kf.moveToCellContent(Qa,0,0),h.set(Qa.currentNode)):Kf.moveToCellContent(h,0,0),Uf.OutlineElementReader.Eh(h)?ig.OutlineElementNavigator.Ee(h):h=Bm.a.instance.bwf(B)),B=ke.ParagraphReader.Bt(h.currentNode)?this.NE.ne(h.currentNode,0):this.NE.Eq(h.currentNode)):b.location||(Qa=b.blob.Lb.cp+1,B=this.NE.lJ(b.node,Qa-1,Qa));ca.eHa(r,1);ca.Uj=Nb.a.EIb;ca.dispose();return{returnValue:b,ZLb:B}}xCf(){return!1}Hga(b){b.contextId===yc.a.view&&
b.view.ue&&b.view.mb&&(b=b.view.mb.qg);if(!b)return zh.Ic.Yb(le.a.ef,{["Reason"]:ae.a.noSelection}),!1;if(zh.Yf.$_(b))return zh.Ic.Yb(le.a.ef,{["Reason"]:ae.a.cF}),!1;if(zh.Yf.via(b))return zh.Ic.Yb(le.a.ef,{["Reason"]:ae.a.Ysi}),!1;if(this.en&&this.en.instance&&this.en.instance.SU(b))return zh.Ic.Yb(le.a.ef,{["Reason"]:ae.a.P1a}),!1;if(this.Hi.N4)return zh.Ic.Yb(le.a.ef,{["Reason"]:ae.a.compatMode}),!1;if(b.el)return Yg.OutlineReader.f0d(b)?(zh.Ic.Yb(le.a.ef,{["Reason"]:ae.a.A$e}),!1):Id.ImageReader.c_d(b)?
(zh.Ic.Yb(le.a.ef,{["Reason"]:ae.a.t$e}),!1):wm.c(b)?(zh.Ic.Yb(le.a.ef,{["Reason"]:ae.a.u$e}),!1):Gg.a.fFf(b)?(zh.Ic.Yb(le.a.ef,{["Reason"]:ae.a.s$e}),!1):ke.ParagraphReader.OU(b)||Id.ImageReader.cIm(b)?(zh.Ic.Yb(le.a.ef,{["Reason"]:ae.a.AO}),!1):!0;if(Oe.a.wGf(b)){let h=!0;for(let r=0;r<b.length;++r){const B=b.getContext(r);if(!B.el)return!1;h&&!ke.ParagraphReader.OU(B)&&(h=!1)}return h?(zh.Ic.Yb(le.a.ef,{["Reason"]:ae.a.AO}),!1):!0}return!1}l8f(b,h){const r=this.Lc.Pc(7);r.Db(b);if(12===b.type){h=
h.Lb.cp;var B=ke.ParagraphReader.textLength(b);B=Ue.a.HO(h,h+1,h+1===B?!0:!1,b);this.Md.Ge(B,"");b=Ue.a.Rc(b,h);this.hb.Ac(og.SelectionFactory.Zn(b))}else this.rh.kza(b);r.dispose()}static get qn(){return null!=zh.AAg?zh.AAg:zh.AAg=Ma.a.instance.resolve("Box4.IFormattingEditor")}static get Yf(){return Wh.a.instance}static get Ic(){return Nh.a.instance}}Object(m.a)(zh,"ImageEditor",null,[468]);class Hj{constructor(b,h,r,B=0){this.node=b;this.blob=h;this.location=r;this.IU=B}}Object(m.a)(Hj,"InsertPictureResult",
null,[]);var sp=c(832),Si=c(289),zf=c(106),Cp=c(505),oo;(function(b){b[b.other=0]="other";b[b.picture=1]="picture"})(oo||(oo={}));Object(m.b)("ImageType",oo);var tp=c(1201);class nu extends zh{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc,Uc){super(b,h,r,B,P,ca,ra,Qa,Uc);this.V_j="WACImageCropHandleNW WACImageCropHandleN WACImageCropHandleNE WACImageCropHandleW WACImageCropHandleE WACImageCropHandleSW WACImageCropHandleS WACImageCropHandleSE".split(" ");this.kab="WACImageCropInnerHandleTop WACImageCropInnerHandleTopBorder WACImageCropInnerHandleBottom WACImageCropInnerHandleBottomBorder WACImageCropInnerHandleLeft WACImageCropInnerHandleLeftBorder WACImageCropInnerHandleRight WACImageCropInnerHandleRightBorder".split(" ");
this.rK=this.XLa=this.lBa=null;this.kla=Array(8);this.Pnd=this.HBa=null;this.YLa=!1;this.Ond=this.EEe=null;this.ljd=this.wkd=!1;this.lT=this.kT=this.jT=this.mT=this.lW=this.kW=this.jW=this.mW=this.HW=this.IW=0;this.UY=()=>{this.YLa&&this.jif()};this.tya=od=>{this.YLa&&od.Hb.keyCode!==se.a.Ss&&this.jif(!0);return!1};this.PZg=Gc;ca.Ww(this.UY);this.ge=jc;this.S2=Zc.a.instance;this.ga=v.AFrameworkApplication.va;this.Vd=Mb;this.Aq=tb;this.rd=Uc}Zge(b,h,r,B,P){b.hasProperty(Yc.a.gSa)&&b.removeProperty(Yc.a.gSa);
const ca=Array(4);ca[zf.a.left]=h;ca[zf.a.right]=r;ca[zf.a.top]=B;ca[zf.a.bottom]=P;b.setValue(Mc.a.Tda,ca)}k_n(b){b.setValue(Mc.a.$Fa,Cp.a.notRendered);b.setValue(Mc.a.yNb,"");this.Zge(b,0,0,0,0)}Kdg(b,h,r,B,P){b.setValue(Mc.a.mUc,h);b.setValue(Mc.a.jUc,r);b.setValue(Mc.a.kUc,B);b.setValue(Mc.a.lUc,P)}ahe(b,h,r,B){b.setValue(Mc.a.JU,h);b.setValue(Mc.a.Uyf,r);b.setValue(Mc.a.qzf,B);b.setValue(Yc.a.JU,-1)}dYd(b,h){b=b.node;const r=Ad.GraphIterator.eb(b);if(ke.ParagraphReader.Xb(b)&&ke.ParagraphReader.isEmpty(r)){var B=
b.properties.wf(Mc.a.Wc);h.setValue(Mc.a.Wc,B);h.setValue(Mc.a.runId,1);B=new tp.a;h&&B.ax(h);r.Bf(B,6);this.Pcg(b,B.anchor.node.id);this.xX.Ykc(B);return new Hj(B,null,3)}return null}fYd(b,h){var r=sp.a.instance.Gfd;h&&r.ax(h);r.setValue(Mc.a.imageType,oo.picture);let B=0;B=jd.a.GF();r.setValue(Mc.a.IU,B);const P=b.node.Mc.Uu(r,r.id);r=this.Md.hia(b,ca=>new ef.ImageBlobObject(ca,P));Si.GraphTransactionManager.instance.BWf(b.node);if(this.Vd.xg){const ca=new cg.GraphTransaction(15);ca.Db(b.node);
this.Aq.wra(b.node,b.cpBegin,b.cpBegin+1,1,null);ca.dispose()}this.xX.rOa&&!h.ja(Mc.a.tia,!1)&&this.xX.pra(b.node,b.cpBegin,b.cpBegin+1);return new Hj(b.node,r,0,B)}xCf(b,h){if(!this.Hga(b))return!1;const r=this.Lc.Pc(7);r.Db(b.node);v.AFrameworkApplication.K.$("ContentAppIsEnabled")&&h.ja(Mc.a.jvi,!1)?this.qVc=this.dYd(b,h):this.qVc=this.fYd(b,h);r.dispose();return!0}qjc(b,h,r,B){if(!r.Xb(b))return!1;r=this.Lc.Pc(7,Nb.a.anm);r.Db(b);var P=b.properties.ja(Pd.a.Jm,[]);P.push(0);for(const ca of P)if((P=
B.vof(b,ca))&&5===P.vh&&P.id.equals(h))return this.Md.Ge(Ue.a.createTextRange(b,ca,ca+1),""),r.dispose(),!0;r.dispose();t.ULS.sendTraceTag(588817112,3001,10,"RemoveInlineImageFromParagraph: Failed to remove image.");return!1}xZn(b,h,r,B){if(!Id.ImageReader.r9(b))return!1;h.set(b);h.zb(12);const P=h.ko(12);if(!P)return t.ULS.sendTraceTag(588817114,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image because unable to acquire containing graph node."),!1;if(r.AXc(P))return t.ULS.sendTraceTag(588817115,
3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image."),!1;B(b);r=this.Lc.Pc(7);r.Db(b);h.zg();r.dispose();return!0}k4n(b,h,r,B){return Id.ImageReader.a4a(b)?this.Z3n(b,r):Id.ImageReader.Q4(b)?this.n4n(b,h,r,B):null}n4n(b,h,r,B){const P=sp.a.instance.Gfd;r&&P.ax(r);r=0;r=jd.a.GF();P.setValue(Mc.a.IU,r);r=b.node.Mc;b=b.node;B=B.EPc(b,5);for(const ca of B)if(ca.id.equals(h)){this.Md.Ge(Ue.a.createTextRange(b,ca.Lb.cp,ca.Lb.cp+1),"");const ra=r.Uu(P,P.id);h=Ue.a.Rc(b,ca.Lb.cp);
this.Md.hia(h,Qa=>new ef.ImageBlobObject(Qa,ra));return P}return null}Z3n(b,h){if(!Id.ImageReader.a4a(b))return null;h.setValue(Mc.a.IU,jd.a.GF());b=b.node;var r=b.anchor.node.id;b=Ad.GraphIterator.eb(b);b.zb(12);const B=b.parentNode;let P;B.properties.hasProperty(Mc.a.Y7)?(P=B.properties.wf(Mc.a.Y7),r=V.a.indexOf(P,r),-1!==r&&Array.removeAt(P,r)):P=[];B.properties.setValue(Mc.a.Y7,Array.clone(P));b.zg();r=this.rd&&this.rd.isFeatureEnabled(47)?new Ff.a:new oh.a;r.ax(h);b.Bf(r,6);this.Pcg(B,r.anchor.node.id);
return r}fcd(b,h){this.YLa?this.jif():this.BCo(b,h)}Yjo(b,h){b.setValue(Yc.a.JU,h)}F0l(b){let h=null,r=null;if(!b)return t.ULS.sendTraceTag(22381026,322,15,"Unable to obtain Image Element Container for Crop due to null Context."),{returnValue:null,view:h,rj:r};if(!hb.InteractiveViewManager.instance.yd)return t.ULS.sendTraceTag(22381027,322,15,"Unable to obtain Image Element Container for Crop due to null SelectionView."),{returnValue:null,view:h,rj:r};const B=b.node;if(!B)return t.ULS.sendTraceTag(22381056,
322,15,"Unable to obtain Image Element Container for Crop due to null Context Node."),{returnValue:null,view:h,rj:r};r=B.Mc;var P=B.te(hb.InteractiveViewManager.instance.yd.$b);if(!P)return t.ULS.sendTraceTag(23961792,322,15,"Unable to obtain Image Element Container for Crop due to null Html View Element."),{returnValue:null,view:h,rj:r};h=P.Fg;if(b.el&&Id.ImageReader.Q4(b)){b=Id.ImageReader.vFa(b);if(!b)return t.ULS.sendTraceTag(22381057,322,15,"Unable to obtain Image Element Container for Crop due to null Blob from Context."),
{returnValue:null,view:h,rj:r};P=b.Swa(h,P);if(!P)return t.ULS.sendTraceTag(22381058,322,15,"Unable to obtain Image Element Container for Crop due to null Presenter from Blob."),{returnValue:null,view:h,rj:r};P=P.element}else if(Id.ImageReader.Mt(B))P=P.htmlElement;else return t.ULS.sendTraceTag(22381059,322,15,"Unable to obtain Image Element Container for Crop due to context not being Image blob nor Image node."),{returnValue:null,view:h,rj:r};return{returnValue:P,view:h,rj:r}}hqo(b){for(let B=0;B<
this.kla.length;B++){this.kla[B]=b.Qk(un.a.span);this.kla[B].className="WACImageCropHandles "+this.V_j[B];if(2>=B){var h=b.Qk(un.a.span);h.className=this.kab[0];var r=b.Qk(un.a.span);r.className=this.kab[1];this.kla[B].appendChild(h);this.kla[B].appendChild(r)}else 4<B&&(h=b.Qk(un.a.span),h.className=this.kab[2],r=b.Qk(un.a.span),r.className=this.kab[3],this.kla[B].appendChild(h),this.kla[B].appendChild(r));if(!B||3===B||5===B)h=b.Qk(un.a.span),h.className=this.kab[4],r=b.Qk(un.a.span),r.className=
this.kab[5],this.kla[B].appendChild(h),this.kla[B].appendChild(r);else if(2===B||4===B||7===B)h=b.Qk(un.a.span),h.className=this.kab[6],r=b.Qk(un.a.span),r.className=this.kab[7],this.kla[B].appendChild(h),this.kla[B].appendChild(r)}}BCo(b,h){t.ULS.sendTraceTag(22381060,322,50,"Starting Image Cropping Mode.");if(this.YLa)t.ULS.sendTraceTag(22381061,322,100,"Attempted to start Crop Mode when it was already On.");else{var r=null,B=null;if((this.HBa=({view:r,rj:B}=this.F0l(h)).returnValue)&&r){this.HBa.classList.add("ImageCropMode");
this.lBa=r.Qk(un.a.div);this.lBa.className="WACImageCropMode";this.XLa=r.Qk(un.a.F3a);this.XLa.className="WACImageCropBase";this.rK=r.Qk(un.a.span);this.rK.className="WACImageCropSrcRect";this.hqo(r);this.lBa.appendChild(this.rK);for(r=0;r<this.kla.length;r++)this.rK.appendChild(this.kla[r]);this.lBa.appendChild(this.XLa);this.XLa.style.visibility="";this.XLa.style.display="";this.HBa.appendChild(this.lBa);this.iFn(b);B=Id.ImageReader.Rwa(b,B);r=Id.ImageReader.m6(b,Yc.a.Cqa,null);this.XLa.src=r?r:
Id.ImageReader.hjb(B);this.PZg&&this.PZg.execute(P=>{this.Pnd||(this.Pnd=P.B0l(this))});this.wkd||(this.S2.QP(this.HBa,this.Pnd),this.wkd=!0);this.ge&&this.ge.ob(pd.a.lG,hb.InteractiveViewManager.instance.xe.editingElement,this.tya);this.YLa=!0;this.EEe=b;this.Ond=h;this.ljd=!1;b=new cg.GraphTransaction(4);b.Db(this.Ond.node);this.EEe.setValue(Yc.a.Fxa,this.YLa);b.dispose()}else t.ULS.sendTraceTag(22381062,322,15,"Unable to start Crop Mode because unable to obtain Image Element Container from given Context.")}}iFn(b){const h=
xg.a.nf(Id.ImageReader.oF(b),0),r=xg.a.nf(Id.ImageReader.JG(b),1);var B=Id.ImageReader.yca(b);const P=Math.max(B.top,0),ca=Math.max(B.bottom,0),ra=Math.max(B.left,0);B=Math.max(B.right,0);this.IW=1E5*h/(1E5-(ra+B));this.HW=1E5*r/(1E5-(P+ca));this.mW=Math.floor(P*this.HW/1E5);this.jW=Math.floor(ca*this.HW/1E5);this.kW=Math.floor(ra*this.IW/1E5);this.lW=Math.floor(B*this.IW/1E5);this.rK.style.top=this.mW+"px";this.rK.style.bottom=this.jW+"px";this.rK.style.left=this.kW+"px";this.rK.style.right=this.lW+
"px";this.XLa.style.width=this.IW+"px";this.XLa.style.height=this.HW+"px";Id.ImageReader.Oy(b)&&(this.lBa.style.width=this.IW+"px",this.lBa.style.height=this.HW+"px");this.mT=this.mW;this.jT=this.jW;this.kT=this.kW;this.lT=this.lW}jif(b=!1){t.ULS.sendTraceTag(22381063,322,50,"Ending Image Cropping Mode.");this.YLa?(b||this.S2k(),this.XLa?dc.a.KC(this.XLa):t.ULS.sendTraceTag(23961793,322,15,"Unable to clear imageCropBase dom element because it was already null."),this.HBa?(this.lBa?this.lBa.parentNode===
this.HBa?this.HBa.removeChild(this.lBa):t.ULS.sendTraceTag(24174606,322,15,"Unable to Remove child divImageCropMode from imageElementContainer, because it was no longer a child of it."):t.ULS.sendTraceTag(23961794,322,15,"Unable to clear Crop mode div because it was already null."),this.HBa.classList.remove("ImageCropMode"),this.YLa=!1,b=new cg.GraphTransaction(4),b.Db(this.Ond.node),this.EEe.setValue(Yc.a.Fxa,this.YLa),b.dispose(),this.wkd&&(this.S2.eQ(this.HBa,this.Pnd),this.wkd=!1),this.ge&&this.ge.sc(pd.a.lG,
hb.InteractiveViewManager.instance.xe.editingElement,this.tya),this.HBa=this.lBa=null):t.ULS.sendTraceTag(22381065,322,15,"Unable to finish Image Crop clean-up because unable to obtain Image Element Container from Context.")):t.ULS.sendTraceTag(22381064,322,100,"Attempted to End Image Crop Mode when it was already off.")}wGj(b,h,r,B,P,ca,ra){if(r){r=Math.max(this.mW-h,0);const Qa=Math.floor(this.HW)-this.jW-r;5<=Qa?(this.mT=r,this.jT=this.jW):5>Qa&&0<=Qa||0>Qa&&!this.jW?(this.mT=r-(5-Qa),this.jT=
this.jW):0>Qa&&5>=Math.abs(Qa)?(this.mT=Math.floor(this.HW)-this.jW,this.jT=Math.max(this.jW-(r-(this.HW-this.jW))-(5-Math.abs(Qa)),0)):(this.mT=Math.floor(this.HW)-this.jW,this.jT=Math.max(this.jW-(r-(this.HW-this.jW)),0));this.rK.style.top=this.mT+"px";this.rK.style.bottom=this.jT+"px";ra&&(this.mW=this.mT,this.jW=this.jT)}B&&(h=Math.max(this.jW-h,0),B=Math.floor(this.HW)-this.mW-h,5<=B?(this.jT=h,this.mT=this.mW):5>B&&0<=B||0>B&&!this.mW?(this.jT=h-(5-B),this.mT=this.mW):0>B&&5>=Math.abs(B)?(this.jT=
Math.floor(this.HW)-this.mW,this.mT=Math.max(this.mW-(h-(this.HW-this.mW))-(5-Math.abs(B)),0)):(this.jT=Math.floor(this.HW)-this.mW,this.mT=Math.max(this.mW-(h-(this.HW-this.mW)),0)),this.rK.style.top=this.mT+"px",this.rK.style.bottom=this.jT+"px",ra&&(this.mW=this.mT,this.jW=this.jT));P&&(P=Math.max(this.kW-b,0),h=Math.floor(this.IW)-this.lW-P,5<=h?(this.kT=P,this.lT=this.lW):5>h&&0<=h||0>h&&!this.lW?(this.kT=P-(5-h),this.lT=this.lW):0>h&&5>=Math.abs(h)?(this.kT=Math.floor(this.IW)-this.lW,this.lT=
Math.max(this.lW-(P-(this.IW-this.lW))-(5-Math.abs(h)),0)):(this.kT=Math.floor(this.IW)-this.lW,this.lT=Math.max(this.lW-(P-(this.IW-this.lW)),0)),this.rK.style.left=this.kT+"px",this.rK.style.right=this.lT+"px",ra&&(this.kW=this.kT,this.lW=this.lT));ca&&(b=Math.max(this.lW-b,0),ca=Math.floor(this.IW)-this.kW-b,5<=ca?(this.lT=b,this.kT=this.kW):5>ca&&0<=ca||0>ca&&!this.kW?(this.lT=b-(5-ca),this.kT=this.kW):0>ca&&5>=Math.abs(ca)?(this.lT=Math.floor(this.IW)-this.kW,this.kT=Math.max(this.kW-(b-(this.IW-
this.kW))-(5-Math.abs(ca)),0)):(this.lT=Math.floor(this.IW)-this.kW,this.kT=Math.max(this.kW-(b-(this.IW-this.kW)),0)),this.rK.style.left=this.kT+"px",this.rK.style.right=this.lT+"px",ra&&(this.kW=this.kT,this.lW=this.lT));ra&&(this.ljd=!0,Eb.App.za.updateCommandUI())}QTk(){this.mT=this.mW;this.jT=this.jW;this.kT=this.kW;this.lT=this.lW;this.rK.style.top=this.mT+"px";this.rK.style.bottom=this.jT+"px";this.rK.style.left=this.kT+"px";this.rK.style.right=this.lT+"px"}S2k(){if(this.ljd){t.ULS.sendTraceTag(22381066,
322,50,"Commiting new Image Cropping Properties.");var b=Math.floor(1E5*this.mW/this.HW),h=Math.floor(1E5*this.jW/this.HW),r=Math.floor(1E5*this.kW/this.IW),B=Math.floor(1E5*this.lW/this.IW),P=new fd.DictionaryPropertySet;P.setValue(Yc.a.rkb,b);P.setValue(Yc.a.okb,h);P.setValue(Yc.a.pkb,r);P.setValue(Yc.a.qkb,B);this.ga.Nf(this.Ond,qb.a.pqi,2,!1,null,P)}else t.ULS.sendTraceTag(23070481,322,50,"No New Cropping Properties To Commit.")}Fxa(){return this.YLa}yUl(){return{top:this.mT,bottom:this.jT,left:this.kT,
right:this.lT}}dXo(b,h){if(0>b)t.ULS.sendTraceTag(22552777,322,15,"Unexpected negative value for new Crop properties.");else{switch(h){case 0:this.mW=this.mT=Math.min(Math.floor(this.HW)-this.jT-5,b);this.rK.style.top=this.mT+"px";break;case 1:this.jW=this.jT=Math.min(Math.floor(this.HW)-this.mT-5,b);this.rK.style.bottom=this.jT+"px";break;case 2:this.kW=this.kT=Math.min(Math.floor(this.IW)-this.lT-5,b);this.rK.style.left=this.kT+"px";break;case 3:this.lW=this.lT=Math.min(Math.floor(this.IW)-this.kT-
5,b),this.rK.style.right=this.lT+"px"}this.ljd=!0}}}Object(m.a)(nu,"ImageEditor",zh,[467,468]);class er{constructor(){this.W=null}get name(){return"WordEditor.ImageEditors"}wc(b){this.W=b;this.W.ia("WordEditor.ImageEditors.ImageCropDragAdapterFactory",()=>new Jc(v.AFrameworkApplication.va,Ma.a.instance.Ta("Common.IZoomManager"))).as("WordEditor.IImageCropDragAdapterFactory").ha();this.W.ia("WordEditor.ImageEditors.ImageEditor",()=>new nu(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),
b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.ISelectionManager"),b.Ta("Box4.IExternalSelectionManager"),b.resolve("Box4.ISelectionFactory"),b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),Jb.KeyInputManager.instance,b.Ta("WordEditor.IImageCropDragAdapterFactory"),b.Oa("Box4.IFeatureHelper"))).as("WordEditor.IImageEditor").as("Box4.Images.IImageEditor").ha()}init(){this.W.resolve("WordEditor.IImageCropDragAdapterFactory")}dispose(){}static main(){L.a.instance.Gc(new er)}}
Object(m.a)(er,"WordEditorImageEditorsPackage",null,[1,2]);class Bl{}Object(m.a)(Bl,"FolderContentEditor",null,[1341]);class Dp{}Object(m.a)(Dp,"PageEditor",null,[1246]);class Xr extends Dp{constructor(){super()}}Object(m.a)(Xr,"PageEditor",Dp,[]);class Ou{get name(){return"WordEditor.NotebookLevelEditors"}wc(b){b.ia("Box4.NotebookLevelEditors.FolderContentEditor",()=>new Bl).as("Box4.Folder.IFolderContentEditor").ha();b.ia("WordEditor.NotebookLevelEditors.PageEditor",()=>new Xr).as("Box4.Pages.IPageEditor").ha()}init(){}dispose(){}static main(){L.a.instance.Gc(new Ou)}}
Object(m.a)(Ou,"WordEditorNotebookLevelEditorsPackage",null,[1,2]);class Ys{get WNb(){return v.AFrameworkApplication.privacyUrl}gva(){t.ULS.sendTraceTag(37034014,342,50,"User clicked on the Privacy statement.");Qd.a.wm(this.WNb,"_blank",void 0,"SendUsYourFileDialog.PrivacyLink");return!0}}Object(m.a)(Ys,"PrivacyLinkHandler",null,[801]);class vn{constructor(b,h){this.zMe=null;this.Pik=b;this.Oik=h}showDialog(b){this.zMe=b;this.Oik.create().Uh(Object(z.a)(this,this.Fom,"handleDialog"))}Fom(b){1===b&&
this.Pik.Mjj();this.zMe();this.zMe.prototype}}Object(m.a)(vn,"SendUsYourFileController",null,[785]);class Ep extends Tf.StandardDialog{constructor(b,h,r){super();this.l_b=null;this.ig=b;this.yBc=h;this.qH=r}Uh(b){this.Cd=1;this.ze(1,this.qH.send);this.ze(0,this.qH.xhn);t.ULS.shipAssertTag(37034013,342,!this.l_b,"privacy anchor should be null before initializing it.");const h=this.dialogContent();this.Rmb(this.qH.FDk,null,"CancelRequest_32x32x32",null,b,h);this.L5(this.qj(Ep.Vjj))}dialogContent(){const b=
document.createElement("span");b.innerText=this.qH.oIn;const h=document.createElement("span");h.innerText=this.qH.ZIo;h.style.fontWeight=this.qH.u1o;const r=document.createElement("span");r.innerText=this.qH.sfo;const B=this.W4k(),P=document.createElement("span");P.id=this.qj(Ep.Vjj);P.appendChild(b);P.appendChild(document.createElement("br"));P.appendChild(document.createElement("br"));P.appendChild(h);P.appendChild(document.createElement("br"));P.appendChild(r);P.appendChild(document.createElement("br"));
P.appendChild(document.createElement("br"));P.appendChild(document.createElement("br"));P.appendChild(B);return P}W4k(){const b=document.createElement("span"),h=document.createElement("a");h.innerText=this.qH.XHn;h.href=this.yBc.WNb||"";b.appendChild(h);this.l_b=h;this.ig.ob(pd.a.click,this.l_b,Object(z.a)(this.yBc,this.yBc.gva,"clickHandler"));return b}dispose(){this.l_b&&(this.ig.sc(pd.a.click,this.l_b,Object(z.a)(this.yBc,this.yBc.gva,"clickHandler")),this.l_b=null);super.dispose()}}Ep.Vjj="sendUsYourFileId";
Object(m.a)(Ep,"SendUsYourFileDialog",Tf.StandardDialog,[799]);class xr{create(){return Ma.a.instance.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialog")}}Object(m.a)(xr,"Factory",null,[798]);var Fn=c(592);class ks extends Fn.a{constructor(){super();this.FileId=null}nl(){return 38}static construct(b){const h=new ks;h.FileId=b;return h}}Object(m.a)(ks,"CreateSendUsYourFileRequest",Fn.a,[]);var Ln=c(1008);class Zs{constructor(b,h,r){this.E6=b;this.vQ=h;this.Aak=r}Mjj(b=!1){if(this.vQ){const h=
ks.construct(this.vQ()),r=new Ln.a;r.Jq=h;r.status=1;r.YG="BootErrorReport";b=b?this.E6(null):this.E6(B=>{this.L7c(r,B)});b.IH(r);b.jU();this.Aak()}}L7c(b){5===b.statusCode&&this.Mjj(!0)}}Object(m.a)(Zs,"SendUsYourFileManager",null,[786]);class Pt{constructor(b,h){this.W=null;this.qH=b;this.vQ=h}wc(b){this.W=b;this.W.ia("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings",()=>this.qH).ha();this.W.ia("Wac.Common.SendUsYourFile.ISendUsYourFileDialog",()=>new Ep(ii.a.instance,new Ys,this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings")));
this.W.ia("Wac.Common.SendUsYourFile.ISendUsYourFileManager",()=>new Zs(h=>this.Fha(0,h),this.vQ,()=>{t.ULS.sendTraceTag(42022664,342,50,"send us your file request is now sent.")}));this.W.ia("Wac.Common.SendUsYourFile.ISendUsYourFileController",()=>{const h=new xr;return new vn(this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileManager"),h)}).ha()}init(){this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileController")}dispose(){}}Object(m.a)(Pt,"SendUsYourFilePackageManager",null,[]);
var ut=c(516),Yr=c(1052);class Kk{get FDk(){return CommonUIStrings.l_AppTitle}get send(){return CommonUIStrings.l_Send}get xhn(){return CommonUIStrings.l_NoThanks}get oIn(){return WordEditorIntl.WordEditorStrings.L_ProblemOpeningDocument}get ZIo(){return WoncaIntl.WoncaStrings.l_SaveErrorReportTitle}get u1o(){return CommonUIStrings.l_UserInterfaceFontWeightBold}get sfo(){return WordEditorIntl.WordEditorStrings.L_SendUsYourFileDialogText}get XHn(){return CommonUIStrings.l_PrivacyStatement}}Object(m.a)(Kk,
"WordEditorSendUsYourFileDialogStrings",null,["__INTERFACE__@1js/wac-common:ISendUsYourFileDialogStrings"]);class fr extends Pt{constructor(){super(new Kk,()=>v.AFrameworkApplication.rootQuerySignature)}Fha(b,h){return new Yr.a(b,h,"SendUsYourFile.ashx",Vk.a.word,Eb.App.webServiceBase,ut.a.amIAlone,ut.a.N7c,ut.a.y7c)}get name(){return"WordEditor.SendUsYourFile"}static main(){L.a.instance.Gc(new fr)}}Object(m.a)(fr,"PackageManager",Pt,["__INTERFACE__@1js/msoserviceplatform:IPackage","__INTERFACE__@1js/msoserviceplatform:IContainerConfiguration"]);
var Tp=c(549),Sg=c(649),Mm=c(1867),bl=c(122),Ah=c(27),xm=c(154),Wi=c(74),qi=c(954),Eg=c(148),Nm=c(1018);class Kq{constructor(b,h,r,B,P,ca){this.I3h=b;this.gallerySectionId=h;this.lAl=r;this.KBk=B;this.commandId=P;this.queryCommandId=ca}}Object(m.a)(Kq,"BorderStyleMenuPropsArguments",null,[]);class jn{constructor(b,h,r,B,P,ca,ra){this.Q3b=b;this.Mwj=h;this.width=r;this.PSi=B;this.height=P;this.iHi=ca;this.altText=ra}}Object(m.a)(jn,"TableBorderStyleProperties",null,[]);class Sf{constructor(){this.$xh=
[new jn(Sf.yuj,"","2",1,8,0,"Solid Line"),new jn(Sf.LPh,"5,3","1",1,8,0,"Dashed Line"),new jn(Sf.bVh,"1,1","1",1,8,0,"Dotted Line"),new jn(Sf.dVh,"","1",2,8,3,"Double Line")];this.ayh=[new jn(Sf.hyh,"","1",1,8,0,"0.25pt"),new jn(Sf.eyh,"","1",1,8,0,"0.5pt"),new jn(Sf.kyh,"","2",1,8,0,"0.75pt"),new jn(Sf.fyh,"","2",1,8,0,"1pt"),new jn(Sf.dyh,"","3",1,8,0,"1.5pt"),new jn(Sf.lyh,"","4",1,8,0,"2.25pt"),new jn(Sf.jyh,"","4",1,8,0,"3pt"),new jn(Sf.cyh,"","5",1,8,0,"4.5pt"),new jn(Sf.iyh,"","6",1,8,0,"6pt")]}initialize(){this.h7f()}ZKl(){const b=
new Kq("Line Style gallery","DefaultLineStyleOptions","LineStyleOptionsGallery",this.$xh,Nb.a.fqb,Nb.a.g5f);return this.i4h(b)}$Kl(){const b=new Kq("Line Weight gallery","DefaultLineWeightOptions","LineWeightOptionsGallery",this.ayh,Nb.a.gqb,Nb.a.h5f);return this.i4h(b)}$5h(b){switch(b){case Sf.yuj:return Eg.a.R3b;case Sf.LPh:return Eg.a.zfb;case Sf.bVh:return Eg.a.zHc;case Sf.dVh:return Eg.a.b4;default:return Eg.a.Zua}}a6h(b){switch(b){case Sf.hyh:return Eg.a.gyh;case Sf.eyh:return Eg.a.Q4e;case Sf.kyh:return Eg.a.P3b;
case Sf.fyh:return Eg.a.yfb;case Sf.dyh:return Eg.a.ena;case Sf.lyh:return Eg.a.xDa;case Sf.jyh:return Eg.a.Ega;case Sf.cyh:return Eg.a.R_a;case Sf.iyh:return Eg.a.wDa;default:return Eg.a.pG}}i4h(b){const h=new $f.a,r=new di.a,B=Object.assign(new Sg.a,{Id:b.I3h,ExternalId:b.gallerySectionId,ExternalGalleryId:b.lAl,Type:4,Width:1,GalleryItems:[]});for(const ca of b.KBk){var P={};const ra={};ra.width=Sf.h1m;ra.height=Sf.g1m;P.root=ra;P=Object.assign(new Mm.a,{Id:ca.Q3b,ExternalId:String.format("{0}_GalleryButton",
ca.Q3b),Icon:ca.Q3b,Command:b.commandId.toString(),QueryCommand:b.queryCommandId.toString(),MenuItemId:ca.Q3b,FullIconStyle:P,ShouldSetTitle:"true",Alt:ca.altText});B.GalleryItems.push(P)}r.ControlList=[];h.MenuSectionList=[];r.ControlList.push(B);h.MenuSectionList.push(r);h.UpdateDynamically=!0;return h}h7f(){const b={};for(const h of this.$xh)b[h.Q3b]=appChrome.buildBorderStyleIcon(h.Mwj,h.width,h.PSi,h.height,h.iHi);for(const h of this.ayh)b[h.Q3b]=appChrome.buildBorderStyleIcon(h.Mwj,h.width,
h.PSi,h.height,h.iHi);appChrome.api.registerIconProvider(()=>b)}Sgo(b,h,r){if(!b)return t.ULS.sendTraceTag(578073118,306,15,"table border context should not be null."),!1;if(b.contextId!==yc.a.e6)return t.ULS.sendTraceTag(577910617,306,15,"Context should be of type table border. Getting context of type: {0}",b.contextId),!1;switch(b.border){case 2:this.K1(bl.a.vU(b),b.node,5,r,h);break;case 0:this.K1(bl.a.vU(b),b.node,3,r,h);break;case 1:this.K1(bl.a.vU(b),b.node,4,r,h);break;case 3:this.K1(bl.a.vU(b),
b.node,0,r,h);break;case 7:this.K1(bl.a.vU(b),b.node,1,r,h);break;case 8:this.K1(bl.a.vU(b),b.node,2,r,h);break;case 6:this.K1(bl.a.vU(b),b.node,1,r,h);this.K1(bl.a.vU(b),b.node,2,r,h);break;case 5:this.K1(bl.a.vU(b),b.node,3,r,h);this.K1(bl.a.vU(b),b.node,5,r,h);this.K1(bl.a.vU(b),b.node,4,r,h);this.K1(bl.a.vU(b),b.node,0,r,h);break;case 4:this.K1(bl.a.vU(b),b.node,3,r,h),this.K1(bl.a.vU(b),b.node,5,r,h),this.K1(bl.a.vU(b),b.node,4,r,h),this.K1(bl.a.vU(b),b.node,0,r,h),this.K1(bl.a.vU(b),b.node,
1,r,h),this.K1(bl.a.vU(b),b.node,2,r,h)}return!0}Ycg(b,h,r,B){if(!h)return t.ULS.sendTraceTag(578073119,306,15,"cell border context should not be null."),!1;if(h.contextId!==yc.a.Q1)return t.ULS.sendTraceTag(577910656,306,15,"Context should be of type cell border. Getting context of type: {0}",h.contextId),!1;var P=h.node;const ca=new Ad.GraphIterator;ca.set(P);ca.zb(14);P=Ah.TableCellReader.VPa(ca);switch(h.border){case 2:this.mUa(b,h.node,5,B,r,P);this.rhe(h.node,5,r);this.pge(b,h.g2a(),3,r,B,P);
break;case 0:this.mUa(b,h.node,3,B,r,P);this.rhe(h.node,3,r);this.pge(b,h.g2a(),1,r,B,P);break;case 1:this.mUa(b,h.node,4,B,r,P);this.rhe(h.node,4,r);this.pge(b,h.g2a(),0,r,B,P);break;case 3:this.mUa(b,h.node,0,B,r,P),this.rhe(h.node,0,r),this.pge(b,h.g2a(),2,r,B,P)}return!0}aNn(b,h){if(xe.SelectionEditor.AYc(b)&&h)switch(b=Object(Ra.a)(xm.TableNodeBorderContext,b),b.border){case 2:this.iP(b.node,Sf.Oo.NM(5),h);break;case 0:this.iP(b.node,Sf.Oo.NM(3),h);break;case 3:this.iP(b.node,Sf.Oo.NM(0),h);
break;case 1:this.iP(b.node,Sf.Oo.NM(4),h);break;case 7:this.iP(b.node,Sf.Oo.NM(1),h);break;case 8:this.iP(b.node,Sf.Oo.NM(2),h);break;case 5:h=this.iP(b.node,Sf.Oo.NM(5),h);h=this.iP(b.node,Sf.Oo.NM(3),h);h=this.iP(b.node,Sf.Oo.NM(0),h);this.iP(b.node,Sf.Oo.NM(4),h);break;case 6:h=this.iP(b.node,Sf.Oo.NM(1),h);this.iP(b.node,Sf.Oo.NM(2),h);break;case 4:h=this.iP(b.node,Sf.Oo.NM(5),h),h=this.iP(b.node,Sf.Oo.NM(3),h),h=this.iP(b.node,Sf.Oo.NM(0),h),h=this.iP(b.node,Sf.Oo.NM(4),h),h=this.iP(b.node,
Sf.Oo.NM(1),h),this.iP(b.node,Sf.Oo.NM(2),h)}}zLn(b,h){if(xe.SelectionEditor.BYc(b)&&h)switch(b=Object(Ra.a)(xm.TableNodeBorderContext,b),b.border){case 2:this.iP(b.node,Sf.Oo.dP(5),h);break;case 0:this.iP(b.node,Sf.Oo.dP(3),h);break;case 3:this.iP(b.node,Sf.Oo.dP(0),h);break;case 1:this.iP(b.node,Sf.Oo.dP(4),h)}}Cof(b,h,r){r=null;if(!b)return t.ULS.sendTraceTag(575980876,306,15,"Node should not be null"),r;b.properties.hasProperty(h.size)&&(r=new Nm.a,r.weight=b.properties.ja(h.size,Eg.a.pG),r.style=
b.properties.ja(h.style,Eg.a.Zua),r.color=b.properties.ja(h.color,0));return r}Xcg(b,h,r){b?r?(b.properties.setValue(h.size,r.weight),b.properties.setValue(h.style,r.style),b.properties.setValue(h.color,r.color)):t.ULS.sendTraceTag(575980878,306,15,"Property Value object should not be null"):t.ULS.sendTraceTag(575980877,306,15,"Node should not be null")}YOb(b,h){b?(b.properties.removeProperty(h.size),b.properties.removeProperty(h.style),b.properties.removeProperty(h.color)):t.ULS.sendTraceTag(575980879,
306,15,"Node should not be null")}K1(b,h,r,B,P){P=this.l_o(b,h,r,B,P);this.Tkc(h,Sf.Oo.NM(r),P);switch(r){case 5:this.dpb(h,2,B,P);break;case 4:this.dpb(h,1,B,P);break;case 0:this.dpb(h,3,B,P);break;case 3:this.dpb(h,0,B,P);break;case 1:this.dpb(h,7,B,P);break;case 2:this.dpb(h,8,B,P)}}l_o(b,h,r,B,P){if(3!==B){var ca=Sf.Ig.xRd(b,h,r,3);void 0!==ca&&null!==ca&&ca!==Eg.a.N_&&(ca=Wi.a.Yjc(ca),P.color=Sf.N8a.nva(h,ca))}1!==B&&(ca=Sf.Ig.xRd(b,h,r,1),void 0!==ca&&null!==ca&&ca!==Eg.a.oG&&(P.weight=parseFloat(ca)*
Eg.a.yHc));2!==B&&(b=Sf.Ig.xRd(b,h,r,2),void 0!==b&&null!==b&&b!==Eg.a.oG&&(P.style=b));return P}mUa(b,h,r,B,P,ca){B&&(P=this.IUo(b,h,ca,r,B,P));this.Tkc(h,Sf.Oo.dP(r),P)}IUo(b,h,r,B,P,ca){if(3!==P){var ra="",Qa=Sf.Ig.cGb(b,h,B,!1,!0,r,3);Qa&&(ra=Qa.FBb);void 0!==ra&&null!==ra&&ra!==Eg.a.N_&&(ra=Wi.a.Yjc(ra),ca.color=Sf.N8a.nva(h,ra))}if(1!==P){ra="";if(Qa=Sf.Ig.cGb(b,h,B,!1,!0,r,1))ra=Qa.FBb;void 0!==ra&&null!==ra&&ra!==Eg.a.oG&&(ca.weight=parseFloat(ra)*Eg.a.yHc)}if(2!==P){P="";if(b=Sf.Ig.cGb(b,
h,B,!1,!0,r,2))P=b.FBb;void 0!==P&&null!==P&&P!==Eg.a.oG&&(ca.style=P)}return ca}Jen(b){let h=0,r=0;({hen:h,Nbn:r}=this.W4l(b.style,h,r));b.weight<h&&(b.weight=h);b.weight>r&&(b.weight=r);return b}W4l(b,h,r){switch(b){case Eg.a.R3b:case Eg.a.zfb:case Eg.a.zHc:h=2;r=48;break;case Eg.a.b4:h=2;r=24;break;default:h=2,r=48}return{hen:h,Nbn:r}}pge(b,h,r,B,P,ca){if(h)if(B)for(let ra=0;ra<h.length;ra++)switch(r){case 2:this.mUa(b,h[ra],5,P,B,ca);break;case 0:this.mUa(b,h[ra],3,P,B,ca);break;case 1:this.mUa(b,
h[ra],4,P,B,ca);break;case 3:this.mUa(b,h[ra],0,P,B,ca)}else t.ULS.sendTraceTag(578073121,306,15,"tableBorderPropertyValue should not be null");else t.ULS.sendTraceTag(578073120,306,15,"Adjacent cell array should not be null")}rhe(b,h,r){const B=new Ad.GraphIterator;B.set(b);B.zb(14);const P=Ah.TableCellReader.Qoa(b);b=Ah.TableCellReader.eP(b);Kf.forEachCell(B,P,b,(ca,ra,Qa)=>{ca=ca.currentNode;Ah.TableCellReader.es(ca)&&0==Qa&&0<ra&&this.Tkc(ca,Sf.Oo.dP(h),r)})}Tkc(b,h,r){b?(r=this.Jen(r),b.properties.setValue(h.color,
r.color),b.properties.setValue(h.size,r.weight),b.properties.setValue(h.style,r.style)):t.ULS.sendTraceTag(578073122,306,15,"Graph node should not be null")}dpb(b,h,r,B){if(b){var P=Rh.TableReader.gg(b),ca=Rh.TableReader.hh(b),ra=new Ad.GraphIterator,Qa=[];for(let tb=0;tb<P;tb++)for(let Mb=0;Mb<ca;Mb++)if(ra.set(b),Kf.moveToCell(ra,tb,Mb),ra&&ra.currentNode&&!Ah.TableCellReader.hg(ra))switch(h){case 2:Ah.TableCellReader.qia(ra)&&Qa.push(xm.TableNodeBorderContext.y8(ra.currentNode,2));break;case 0:Ah.TableCellReader.ria(ra)&&
Qa.push(xm.TableNodeBorderContext.y8(ra.currentNode,0));break;case 3:Ah.TableCellReader.YFf(b,ra.currentNode)&&Qa.push(xm.TableNodeBorderContext.y8(ra.currentNode,3));break;case 1:Ah.TableCellReader.ZFf(b,ra.currentNode)&&Qa.push(xm.TableNodeBorderContext.y8(ra.currentNode,1));break;case 7:Ah.TableCellReader.ZFf(b,ra.currentNode)||Qa.push(xm.TableNodeBorderContext.y8(ra.currentNode,1));break;case 8:Ah.TableCellReader.YFf(b,ra.currentNode)||Qa.push(xm.TableNodeBorderContext.y8(ra.currentNode,3))}for(b=
0;b<Qa.length;b++)switch(h=Qa[b],h.border){case 2:this.D6c(h.node,Sf.Oo.dP(5),r,B);this.vde(h.g2a(),Sf.Oo.dP(0),r,B);break;case 0:this.D6c(h.node,Sf.Oo.dP(3),r,B);this.vde(h.g2a(),Sf.Oo.dP(4),r,B);break;case 1:this.D6c(h.node,Sf.Oo.dP(4),r,B);this.vde(h.g2a(),Sf.Oo.dP(3),r,B);break;case 3:this.D6c(h.node,Sf.Oo.dP(0),r,B),this.vde(h.g2a(),Sf.Oo.dP(5),r,B)}}else t.ULS.sendTraceTag(578073123,306,15,"Table node should not be null")}vde(b,h,r,B){if(b)for(let P=0;P<b.length;P++)this.D6c(b[P],h,r,B);else t.ULS.sendTraceTag(578062292,
306,15,"Adjacent cell array should not be null")}D6c(b,h,r,B){if(b){var P=b.ja(h.color,Sf.Sdf),ca=b.ja(h.size,Sf.Udf),ra=b.ja(h.style,Sf.Tdf),Qa=new Nm.a;Qa.weight=B.weight;Qa.style=B.style;Qa.color=B.color;2!==r||P===Sf.Sdf&&ca===Sf.Udf?3!==r||ra===Sf.Tdf&&ca===Sf.Udf?1!==r||P===Sf.Sdf&&ra===Sf.Tdf?(b.properties.removeProperty(h.color),b.properties.removeProperty(h.size),b.properties.removeProperty(h.style)):(Qa.color=P,Qa.style=ra,this.Tkc(b,h,Qa)):(Qa.style=ra,Qa.weight=ca,this.Tkc(b,h,Qa)):(Qa.color=
P,Qa.weight=ca,this.Tkc(b,h,Qa))}else t.ULS.sendTraceTag(578073152,306,15,"Graph node should not be null")}iP(b,h,r){var B=b.properties.ja(h.style,Eg.a.oG);B!==Eg.a.oG&&(r.lineStyle!==Eg.a.oG?r.lineStyle!==B&&(r.lineStyle=Eg.a.fMk):r.lineStyle=B);B=b.properties.ja(h.size,Eg.a.pG);B!==Eg.a.pG&&(r.a_c!==Eg.a.pG?r.a_c!==B&&(r.a_c=Eg.a.YLk):r.a_c=B);b=b.properties.ja(h.color,0);b=Wi.a.eF(b);b!==Eg.a.N_&&(r.borderColor!==Eg.a.N_?r.borderColor!==b&&(r.borderColor=Eg.a.QLk):r.borderColor=b);return r}static get Oo(){return null!=
Sf.Ewg?Sf.Ewg:Sf.Ewg=Eg.a.instance}static get Ig(){return null!=Sf.zKg?Sf.zKg:Sf.zKg=Ma.a.instance.Oa("WordEditor.IWACTableStyleReader")}static get N8a(){return null!=Sf.mIg?Sf.mIg:Sf.mIg=qi.a.instance}}Sf.h1m="110px";Sf.g1m="20px";Sf.yuj="SolidLineStyle";Sf.LPh="DashedLineStyle";Sf.bVh="DottedLineStyle";Sf.dVh="DoubleLineStyle";Sf.hyh="BorderPointSizeOneQuarter";Sf.eyh="BorderPointSizeOneHalf";Sf.kyh="BorderPointSizeThreeQuarters";Sf.fyh="BorderPointSizeOne";Sf.dyh="BorderPointSizeOneAndHalf";Sf.lyh=
"BorderPointSizeTwoAndQuarter";Sf.jyh="BorderPointSizeThree";Sf.cyh="BorderPointSizeFourAndHalf";Sf.iyh="BorderPointSizeSix";Sf.Tdf="single";Sf.Udf=4;Sf.Sdf=0;Object(m.a)(Sf,"TableBorderManager",null,[473]);var cl=c(861),dl=c(53),Jo=c(209);class gr{constructor(b,h){this.Uch=this.E8g=null;this.tOa=b;this.$$g=h}get z_i(){return this.$$g}get rqa(){return this.E8g}get H6f(){return this.Uch}knj(b,h){this.Uch=b;this.E8g=h}Slo(b){this.$$g=b}}Object(m.a)(gr,"CellNodeAndOutlineElementInfoForInsertion",null,
[]);var gk=c(80),nm=c(199),Lq=c(364),up=c(147),Rn=c(254),fp=c(599),ou=c(77),Qt=c(479),Pu=c(1068);class kn extends cl.a{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb=null,jc=null){super(b,h,r,jc,Zb);this.X$a=Pu.a.instance;this.sa=new Pc.a;this.LCh=[Mc.a.Zmc,Mc.a.drb,Mc.a.SRb,Mc.a.Xmc,Mc.a.brb,Mc.a.QRb,Mc.a.Wmc,Mc.a.arb,Mc.a.PRb,Mc.a.Ymc,Mc.a.crb,Mc.a.RRb];this.MYj=[Mc.a.ya,Mc.a.xa,Pd.a.Kh,Pd.a.hr];this.ji=B;this.Ezb=P;this.Yc=ca;this.hb=ra;this.d7=Qa;this.km=tb;this.Nvc=Mb;this.Zjh=Zb;this.enk=jc;this.oKn=
this.P3f.bind(this)}get rj(){return this.ji.value}get $s(){return this.d7?this.d7.instance:null}t0e(b){this.sa.addHandler("OnParagraphDelete",b)}get jh(){return!!this.Nvc.instance&&this.Nvc.instance.jh}mVc(b,h,r,B,P){h.setValue(Mc.a.Wc,jd.a.GF());h.setValue(Mc.a.TJm,P);fp.c(B,h,[Mc.a.S1]);super.mVc(b,h,r,B,P)}TXd(b,h,r,B,P){const ca=this.PSc(h,r,B,P);this.IId(ca,h,!1);return super.TXd(b,h,r,B,P)}yBd(b,h,r,B,P){const ca=this.PSc(h,r,B,P);this.IId(ca,h,!0);super.yBd(b,h,r,B,P);return ca}saf(b,h,r,B){h=
this.PSc(b,h,r,B);this.IId(h,b,!0);return h}insertRows(b,h,r,B){const P=dl.a.Ls(b),ca=new Ad.GraphIterator;ca.kd(b);const ra=ca.currentNode;ca.Ub(1);let Qa;Qa=h?b.QM(1):b.currentNode;const tb=b.uc();if(!tb)throw Error.create("table row insertion cannot be performed on a null tableNode");const Mb=Rh.TableReader.gg(tb),Zb=tb.Z_.Ig;let jc=!1;try{tb.tza=1;const Gc=this.X$a.Qib(tb,Zb.qF(tb));this.AUa(b.currentNode);this.Yra(b);this.Qtk(r,b,Qa,ca,ra,h,B);const Uc=this.X$a.Qib(tb,Zb.qF(tb));this.a8a(tb,
Rh.TableReader.gg(tb)+r);jc=!0;this.CYd(tb,Gc,Uc)}finally{tb.tza=0,jc||this.a8a(tb,Rh.TableReader.gg(tb)+r)}P+1!==Mb||h?!P&&h&&kn.SCf(tb,r):kn.SCf(tb,P);h=P+r+(h?0:1);h<Mb+r&&this.Jui(tb,h);return b.currentNode}Qtk(b,h,r,B,P,ca,ra){let Qa=null,tb=null;for(var Mb=0;Mb<b;++Mb){var Zb=Jo.a.instance.createInstance(393251);tb||(tb=Zb);Qa=Zb;this.mVc(h,Zb,r,P,ca)}b=Rh.TableReader.hh(h.currentNode);r=!0;do{r?(h.Aj(Qa),r=!1):h.Mf(1);P=Array(b);for(Mb=0;Mb<b;++Mb){Zb=this.WOa();const jc=this.saf(Zb,B.currentNode,
ca,!0);let Gc=null;jc.hg||(Gc=ra(jc));P[Mb]=new gr(Zb,Gc);P[Mb].knj(jc,null);B.Mf(1)}for(Mb=0;Mb<b;++Mb)Zb=P[Mb].tOa,h.O3(Zb,1,cl.a.LLa?cl.a.LLa():null),Ah.TableCellReader.es(Zb)||(this.dBb(h,Zb,P[Mb].z_i),this.wKh(P[Mb].H6f,Zb,!0));B.aia(1)}while(h.currentNode!==tb)}insertColumns(b,h,r,B,P){let ca=b.currentNode,ra=!1,Qa=Rh.TableReader.hh(b.currentNode);const tb=Qa;try{this.AUa(b.currentNode);this.Yra(b);const Mb=ca.Z_.Ig;ca.tza=1;const Zb=this.X$a.Qib(ca,Mb.qF(ca));Qa=Rh.TableReader.hh(b.currentNode);
-1===h&&(h=Qa);this.Otk(b,B,r,h,P);ca=b.currentNode;Qa+=B;this.$5f(b,Qa,B,h);ra=!0;const jc=this.X$a.Qib(ca,Mb.qF(ca));this.CYd(ca,Zb,jc)}finally{ca.tza=0,ra||this.$5f(b,Qa,B,h)}h!==tb||r?!h&&r&&kn.RCf(ca,B):kn.RCf(ca,h-1)}Otk(b,h,r,B,P){var ca=b.currentNode;B=r?B:B-1;b.Ub(1);var ra=new mb.a;do{var Qa=b.MG(B,1);b.uc();var tb=Array(h);for(let Zb=0;Zb<h;++Zb){var Mb=this.WOa();const jc=this.N6l(b,Qa,r),Gc=this.saf(Mb,Qa,r,!1);Mb=new gr(Mb,null);Mb.knj(Gc,jc);tb[Zb]=Mb}ra.add(tb)}while(b.Ti(1));r=ra.toArray();
for(B=0;B<r.length;B++)for(ra=0;ra<h;ra++)Qa=r[B][ra],tb=Qa.H6f,tb.hg||Qa.Slo(P(tb));b.set(ca);b.Ub(1);P=0;do{for(ca=0;ca<h;++ca)B=r[P][ca],ra=B.tOa,b.AIb(ra,B.rqa,1,cl.a.LLa?cl.a.LLa():null),Ah.TableCellReader.es(ra)||(this.dBb(b,ra,B.z_i),this.wKh(B.H6f,ra,!1));P++}while(b.Ti(1))}CYd(b,h,r){if(h){var B=2===b.tza,P=[],ca=new Ad.GraphIterator;ca.set(b);for(var ra=ca.Ub(1);ra;){for(ra=ca.Ub(1);ra;){const Qa=ra.id.toString();Qa in h&&h[Qa]===r[Qa]&&(!B||!Ah.TableCellReader.ria(ca)&&!Ah.TableCellReader.qia(ca))||
P.push(ra);ra=ca.Ti(1)}ra=ca.Ti(1)}if(0<P.length){h=new cg.GraphTransaction(3);try{h.set(b.xj);for(const Qa of P)Qa.TCf()}finally{h&&h.dispose()}}}}deleteRows(b,h){const r=dl.a.Ls(b),B=r+h;let P=b.uc();const ca=P.Z_.Ig;let ra=!1;t.ULS.sendTraceTag(579479247,341,50,"Performing DeleteRows. Table node Id: {0}, Table Node Type: {1},  Row index: {2}, Row count to delete: {3}",P.id.toString(),P.type,r,h);const Qa=Rh.TableReader.gg(P);try{P.tza=2;const tb=this.X$a.Qib(P,ca.qF(P));this.AUa(b.currentNode);
this.Yra(b);for(let Zb=B-1;Zb>=r;--Zb){b.MG(Zb,1);let jc=b.Ub(1);for(;jc;)this.$1c(jc,!0),jc=b.Ti(1);this.q3a(b);t.ULS.sendTraceTag(579479248,341,50,"Deleting table row node: ID:{0}, Type:{1}",b.currentNode.id.toString(),b.Xe);b.zg()}P=b.currentNode;const Mb=this.X$a.Qib(P,ca.qF(P));this.a8a(P,Rh.TableReader.gg(P)-h);this.e7d(b);ra=!0;this.CYd(P,tb,Mb)}finally{P.tza=0,ra||(this.a8a(b.currentNode,Rh.TableReader.gg(b.currentNode)-h),this.e7d(b))}Qa===B&&0<=r-1&&kn.SCf(P,r-1);r<Qa-h&&this.Jui(P,r)}deleteColumns(b,
h,r){b=Object(Ra.a)(Ad.GraphIterator,b);let B=Object(Ra.a)(Qt.a,b.currentNode),P=Rh.TableReader.hh(b.currentNode);const ca=B.Z_.Ig;let ra=!1;t.ULS.sendTraceTag(579479249,341,50,"Performing DeleteColumns. Table Node Id:{0}, Table Node type:{1}, Column Index: {2}, Column count to delete: {3}",B.id.toString(),B.type,h,r);const Qa=P;try{B.tza=2;const tb=this.X$a.Qib(B,ca.qF(B));this.AUa(b.currentNode);this.Yra(b);-1===h&&(h=P-r);b.Ub(1);do for(let Zb=h+r-1;Zb>=h;--Zb)b.MG(Zb,1),this.$1c(b.currentNode,
!1),this.q3a(b),b.zg();while(b.Ti(1));P-=r;this.Z5f(b,P,h,r);ra=!0;B=Object(Ra.a)(Qt.a,b.currentNode);const Mb=this.X$a.Qib(B,ca.qF(B));this.CYd(B,tb,Mb);this.d7d(b)}finally{B&&(B.tza=0),ra||(this.Z5f(b,P,h,r),this.d7d(b))}Qa===h+r&&0<=h-1&&kn.RCf(B,h-1)}mergeCells(b,h,r){if(b&&(1!==h||1!==r)){var B=new Ad.GraphIterator;B.kd(b);B.zb(14);this.Jbf(B,h,r);this.pUo(B,h,r);B.uc();B.uc();this.sWi(B)}}avj(b,h,r){if(b&&(1!==h||1!==r)){var B=new Ad.GraphIterator;B.kd(b);B.zb(14);this.Wel(B,h,r);B.uc();B.uc();
this.KYi(B)}}$1c(b,h){t.ULS.sendTraceTag(579479250,341,50,"Table cell getting deleted. ID:{0}, Type:{1}",b.id.toString(),b.type);this.xom(b,h,this.oKn)}P3f(b,h){const r=b.currentNode;r.hg=!1;this.IId(h.currentNode,b.currentNode,!0);r.removeProperty(Mc.a.skippedCell);r.removeProperty(Mc.a.renderCell);1===r.colSpan&&1===r.rowSpan&&r.KIc();cl.a.FK.a8(b,!0,cl.a.Tdi(h.currentNode));Kf.returnToCell(b);this.k8k(h,b)}kyf(b,h,r){super.kyf(b,h,r);1===h.AM.colSpan&&1===h.AM.rowSpan?h.AM.KIc():!r&&h.dfe&&(b.AQa?
1<b.colSpan&&(h=new Ad.GraphIterator,h.set(b),h.zb(15),Kf.moveToNextColumn(h),h.currentNode.colSpan=b.colSpan-1):(r=new Ad.GraphIterator,r.set(h.AM),r.zb(15),h=ou.a(r),r=new Ad.GraphIterator,r.set(b),r.zb(15),Kf.moveToColumnByIndex(r,h),--r.currentNode.colSpan))}PSc(b,h,r,B){const P=super.PSc(b,h,r,B);if(b.hg&&!B){var ca=h.iya;ca.dfe&&(B=cl.a.t9b(ca.AM,B),!ca.SGd&&r||ca.SGd===B-1&&!r?b.colSpan=1:(r=new Ad.GraphIterator,r.set(ca.AM),r.zb(15),ca=ou.a(r),r=new Ad.GraphIterator,r.set(h),r.zb(15),Kf.moveToColumnByIndex(r,
ca),r.currentNode.colSpan+=1))}P.ja(Mc.a.skippedCell,!1)&&(b.hg=!0,b.Z4=!0,b.uqb=!0);return P}e7d(b){this.SSb(b,Mc.a.complexTable)}d7d(b){this.SSb(b,Mc.a.complexTable)}sWi(b){this.SSb(b,Mc.a.complexTable)}KYi(b){this.SSb(b,Mc.a.complexTable)}k8k(b,h){if(b&&h){let r;b=Ad.GraphIterator.eb(b.currentNode);xk.OutlineNavigator.S9(b)&&(b.Ub(2),b=b.currentNode,12==b.type&&(r=b.wf(Pd.a.Kh)));r&&(b=new Ad.GraphIterator,b.kd(h),xk.OutlineNavigator.S9(b)&&b.Ub(2)&&(h=b.currentNode,12==h.type&&h.Hg(Pd.a.Kh,r)))}}IId(b,
h,r){b&&(fp.c(b,h,this.LCh),fp.c(b,h,[Pd.a.UK]),r&&fp.c(b,h,[Mc.a.oS,Mc.a.IV,Mc.a.eVa,Mc.a.dVa,Mc.a.nJa,Mc.a.skippedCell,Mc.a.renderCell]))}wKh(b,h,r){b&&(b=Ad.GraphIterator.eb(b),b.qd(),b.Rd(),h=Ad.GraphIterator.eb(h),h.qd(),h.Rd(),Uf.OutlineElementReader.Eh(b)&&ig.OutlineElementNavigator.Ee(b)&&Uf.OutlineElementReader.Eh(h)&&ig.OutlineElementNavigator.Ee(h)&&fp.c(b.currentNode,h.currentNode,this.MYj),r&&(ig.OutlineElementNavigator.Yd(b),ig.OutlineElementNavigator.Yd(h),fg.ListItemReader.lg(b)&&
(r=kn.U1m.vw(b),r.gC=gk.a.im,{txa:r}=kn.Qn.Uma(r.propertySet,h,r))))}q3a(b){this.jh&&this.km.$Yn(b.currentNode);for(b=nm.a.Qp(b);b.moveNext();)if(ke.ParagraphReader.Xb(b.currentNode)){const h=So.e(b.currentNode);for(const r of h)r.bja();this.sa.raiseEvent("OnParagraphDelete",b.currentNode)}else fg.ListItemReader.lg(b.iterator)&&this.$s&&this.$s.Yda(b.iterator)}oE(b,h){let r=null;if(this.Zjh.xg){const B=Object(Ra.a)(Qt.a,b);B&&(r=B.oV())}Rh.TableReader.Pn(b)&&(1===h?h=3:3===h&&(h=1));super.oE(b,h);
this.Zjh.xg&&this.enk.BUa(b,r);Object(Ib.a)(Qt.a,b)&&cl.a.rh.Xnj(Object(Ra.a)(Qt.a,b),(new Lq.a(1,0)).Wt)}feg(b,h){const r=Array(h),B=this.Jii(b)/h;for(let P=0;P<h;P++)r[P]=Math.max(xg.a.Ql(up.a.yea,0),B);b.setValue(Pd.a.Xz,r)}Rmj(b){b.setValue(Mc.a.tableLayout,0)}ish(b,h,r,B,P){const ca=Array(r);for(var ra=0,Qa=0;ra<B;++ra)ca[ra]=h[ra],Qa+=ca[ra];for(;ra<r;++ra)ca[ra]=0>ra-P?h[0]:h[ra-P],Qa+=ca[ra];ra=this.Jii(b.currentNode);if(Qa>ra)for(Qa=ra/Qa,ra=0;ra<r;++ra)ca[ra]=Math.max(xg.a.Ql(up.a.yea,0),
ca[ra]*Qa);return ca}Jii(b){var h=Ad.GraphIterator.eb(b);b=xg.a.Ql(xg.a.Qi(Rh.TableReader.wii(h),0),0);if(h.zb(16))return Kf.returnToCell(h),h=up.a.Ync(h.currentNode),xg.a.Ql(xg.a.Qi(h,0),0)-b;h=Rn.a.ocd(h);return xg.a.Ql(xg.a.Qi(h,0),0)-b}eP(b,h,r){const B=new Ad.GraphIterator;B.set(b);Kf.moveToCell(B,h,r);return B.currentNode.ja(Mc.a.colSpan,1)}$kc(b){var h=Eb.App.za.jb.iu;if(h.ue&&(h=b.te(h.$b))){var r=!1,B=Rh.TableReader.hh(b),P=b.ja(Pd.a.Xz,Array(B));for(var ca of P)if(!ca){r=!0;break}if(r){P=
Rl.a.clone(P);ca=b.ja(Mc.a.complexTable,!1);t.ULS.sendTraceTag(36726403,341,50,"Performing set column widths: columnCount {0} | columnWidths: {1} | isComplexTable: {2}",B,P,ca);r=1;var ra=0;for(let tb=0;tb<B;)if(ca&&(r=this.eP(b,0,tb)),1<r){for(var Qa=0;Qa<r;Qa++)P[tb]||(P[tb]=this.yci(0)),tb++;ra+=r-1}else(Qa=h.xUl(tb-ra))||t.ULS.sendTraceTag(36726404,341,50,"Got no width for graph column {0} (ghost cells {1})",tb,ra),P[tb]||(P[tb]=this.yci(Qa)),tb++;b.setValue(Pd.a.Xz,P)}}}yci(b){return xg.a.Ql(Math.max(b,
up.a.yea),0)}AUa(b){b=Ad.GraphIterator.eb(b);this.$kc(b.currentNode);b.zb(14)&&(Kf.returnToContainingTable(b),this.$kc(b.currentNode))}Unj(b,h){h&&b.setValue(Mc.a.Y$,h)}Meg(b,h){h&&b.setValue(Mc.a.Vmc,h)}WEh(b,h){const r=Rh.TableReader.hh(b);cl.a.sYk(b,h,r)}Qho(b,h,r){let B;if(!({tableNode:B}=this.bec(b)).returnValue)return!1;if(h&&r&&h.length===r.length){if(!this.Gql(B,h))return!1;for(let P=0;P<h.length;++P){const ca=this.Ezb.t9c(b,h[P],r[P]);if(ca)return t.ULS.sendTraceTag(17584922,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",
ca),!1}this.j5d(B);return!0}return!1}fEk(b,h){let r;if(!({tableNode:r}=this.bec(b)).returnValue||Rh.TableReader.RB(r))return!1;var B=Object(Ra.a)(Ad.GraphIterator,this.Yc.Rf(r));Kf.moveToLastRow(B);var P=Rh.TableReader.gg(r);if(h&&0<h.length){this.insertRows(B,!1,h.length,()=>null);B=Rh.TableReader.gg(r);var ca=this.Yc.Rf(r);P=this.sii(ca,P,B-1);for(B=0;B<P.length;++B){ca=P[B];const ra=h[B];for(let Qa=0;Qa<ca.length;++Qa){let tb;if(tb=ra&&ra[Qa]?this.Ezb.t9c(b,ca[Qa],ra[Qa].toString()):this.Ezb.t9c(b,
ca[Qa],""))return t.ULS.sendTraceTag(17584923,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",tb),!1}}}this.j5d(r);return!0}ODk(b,h){let r;if(!({tableNode:r}=this.bec(b)).returnValue||Rh.TableReader.RB(r))return!1;var B=this.Yc.Rf(r),P=Rh.TableReader.hh(r);if(h&&0<h.length){this.insertColumns(Object(Ra.a)(Ad.GraphIterator,B),P,!1,h[1].length,()=>null);var ca=Rh.TableReader.hh(r);B=this.Fgm(B,P,ca-1);for(P=0;P<B.length;++P){ca=h[P];const ra=B[P];for(let Qa=
0;Qa<ra.length;++Qa){let tb;if(tb=ca&&ca[Qa]?this.Ezb.t9c(b,ra[Qa],ca[Qa].toString()):this.Ezb.t9c(b,ra[Qa],""))return t.ULS.sendTraceTag(17584924,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",tb),!1}}}this.j5d(r);return!0}hkl(b){let h;if(!({tableNode:h}=this.bec(b)).returnValue)return!1;let r=this.F2a(h);const B=Rh.TableReader.gg(h);var P=this.Yc.Rf(h);P=this.sii(P,r,B-1);for(let ca=0;ca<P.length;++ca){const ra=P[ca];for(let Qa=0;Qa<ra.length;++Qa){const tb=
this.Ezb.t$i(b,ra[Qa]);if(tb)return t.ULS.sendTraceTag(17584925,341,10,"Unexpected failure to release content control in table cell. error code is {0}",tb),!1}}r=r?r:1;b=this.Yc.Rf(h);b.rF(r)&&15===b.Xe&&this.deleteRows(Object(Ra.a)(Ad.GraphIterator,b),B-r);this.j5d(h);return!0}F2a(b){let h=0;const r=this.Yc.Rf(b);let B=r.Rd();for(;B&&B.ja(Mc.a.Olb,!1);)h++,B=r.It();return!h&&cl.a.Ex.q0(b)&32?1:h}pUo(b,h,r){var B,P;const ca=b.currentNode,ra=new Ad.GraphIterator;ra.kd(b);let Qa=null,tb=null,Mb=null;
const Zb=Eg.a.instance.dP(3),jc=Eg.a.instance.dP(4),Gc=Eg.a.instance.dP(5),Uc=Eg.a.instance.dP(0);Kf.forEachCell(ra,h,r,(od,Od,ze)=>{od=od.currentNode;Od||ze||(Qa=kn.Wz.Cof(od,Zb,Qa));Od||ze!==r-1||(tb=kn.Wz.Cof(od,jc,tb));0<Od&&!ze&&(Qa?kn.Wz.Xcg(od,Zb,Qa):kn.Wz.YOb(od,Zb),tb?kn.Wz.Xcg(od,jc,tb):kn.Wz.YOb(od,jc),kn.Wz.YOb(od,Gc),Od!==h-1&&kn.Wz.YOb(od,Uc));ze||Od!==h-1||(Mb=kn.Wz.Cof(od,Uc,Mb))});b=null===(P=null===(B=null===Eb.App||void 0===Eb.App?void 0:Eb.App.za)||void 0===B?void 0:B.jb)||void 0===
P?void 0:P.iu;tb?(B=xm.TableNodeBorderContext.y8(ca,1),kn.Wz.Ycg(bl.a.oq(b),B,tb,0)):kn.Wz.YOb(ca,jc);B=xm.TableNodeBorderContext.y8(ca,0);if(Qa)kn.Wz.Ycg(bl.a.oq(b),B,Qa,0);else for(B=Object(Ra.a)(xm.TableNodeBorderContext,B).g2a(),P=0;P<B.length;P++)kn.Wz.YOb(B[P],jc);Mb?kn.Wz.Xcg(ca,Uc,Mb):kn.Wz.YOb(ca,Uc)}Gql(b,h){for(let B=0;B<h.length;++B){var r=this.Yc.Rf(h[B]);if(r.zb(14)&&(r=r.jd(14),b.id===r.id))continue;return!1}return!0}bec(b){let h=null;if(b&&b.yu.toString()!==b.Dz.toString())return{returnValue:!1,
tableNode:h};h=this.rj.Eb(b.yu);return 14===h.type&&this.Ezb.bec(b)?{returnValue:!0,tableNode:h}:{returnValue:!1,tableNode:h}}sii(b,h,r){const B=[];Kf.forEachCellInTable(Object(Ra.a)(Ad.GraphIterator,b),(P,ca,ra)=>{if(ca>=h&&ca<=r)ra||B.push([]),Ah.TableCellReader.hg(P)||Array.add(B[ca-h],P.currentNode);else if(ca>r)return!1;return!0});return B}Fgm(b,h,r){const B=[];Kf.forEachCellInTable(Object(Ra.a)(Ad.GraphIterator,b),(P,ca,ra)=>{ra>=h&&ra<=r&&(ra===h&&B.push([]),Ah.TableCellReader.hg(P)||Array.add(B[ca],
P.currentNode));return!0});return B}j5d(b){if(b&&14===b.type){b=Object(Ra.a)(Ad.GraphIterator,this.Yc.Rf(b));const h=new mb.a;ke.ParagraphReader.rjb(b,!0,!1,h);b=og.SelectionFactory.ne(h.J(h.count-1),0);this.hb.Ac(b)}}static get Wz(){kn.iua||(kn.iua=Ma.a.instance.Oa("WordEditor.ITableBorderManager"));return kn.iua}static get U1m(){return null!=kn.oEg?kn.oEg:kn.oEg=Ma.a.instance.resolve("Box4.List.IListReader")}static get Qn(){return null!=kn.iEg?kn.iEg:kn.iEg=Ma.a.instance.resolve("Box4.List.IListEditor")}Jui(b,
h){const r=new Ad.GraphIterator;r.set(b);Kf.moveToFirstRow(r);Kf.moveToRowByIndex(r,h);do r.currentNode.ol(4,!0);while(Kf.moveToNextRow(r))}static SCf(b,h){if(b){var r=Rh.TableReader.gg(b),B=Rh.TableReader.hh(b);if(!(!Eb.App.za.jb.iu.ue||0>h||h>=r))for(r=new Ad.GraphIterator,r.set(b),b=0;b<B;b++){b?Kf.moveToNextColumn(r):Kf.moveToCell(r,h,b);if(!r||!r.currentNode||16!==r.currentNode.type)continue;let P=r.currentNode;Ah.TableCellReader.es(P)&&(P=Ah.TableCellReader.vha(P));P&&P.ol(4,!0)}}else t.ULS.sendTraceTag(577868247,
306,15,"Can not invalidate row when there is no table node")}static RCf(b,h){if(b){var r=Rh.TableReader.gg(b),B=Rh.TableReader.hh(b),P=new Ad.GraphIterator;if(!(!Eb.App.za.jb.iu.ue||0>h||h>=B))for(B=0;B<r;B++){P.set(b);Kf.moveToCell(P,B,h);if(!P||!P.currentNode)continue;let ca=P.currentNode;Ah.TableCellReader.es(ca)&&(ca=Ah.TableCellReader.vha(ca));ca&&ca.ol(4,!0)}}else t.ULS.sendTraceTag(577868248,306,15,"Can not invalidate column when there is no table node")}}kn.iua=null;Object(m.a)(kn,"TableEditor",
cl.a,[470,471]);class Qu{get name(){return"WordEditor.TableEditors"}wc(b){v.AFrameworkApplication.K.$("TableEditorsDelayInitializationEnabled")&&(b.ia("WordEditor.TableEditors.TableEditor",()=>new kn(b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("WordEditor.IWACTableStyleReader"),new pf.a(()=>Eb.App.za.jb.Zc.xd),b.resolve("WordEditor.ContentControl.ITableContentControlEditor"),new Tp.a,Bh.a.instance,b.Ta("WordEditor.IFlatListEditor"),b.resolve("Box4.ContentControl.IContentControlOperator"),
b.Ta("Box4.ContentControlConfigSettings"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)).as("WordEditor.ITableEditor").as("Box4.ITableEditor").ha(),b.ia("WordEditor.TableEditors.TableBorderManager",()=>new Sf).as("WordEditor.ITableBorderManager").ha())}init(){}dispose(){}static main(){L.a.instance.Gc(new Qu)}}Object(m.a)(Qu,"WordEditorTableEditorsPackage",null,[1,2]);class Ds{get name(){return"WordEditor.TextLevelEditors"}wc(){}init(){}dispose(){}static main(){L.a.instance.Gc(new Ds)}}
Object(m.a)(Ds,"WordEditorTextLevelEditorsPackage",null,[1,2]);var Ru=c(1989);c(471);var Rt=c(774),ls=c(221),Cm=c(252);class Zr{constructor(b){this.oek=b}kdl(){const b=Jo.a.instance.createInstance(393228);b.setValue(Pd.a.CL,ls.a.first);b.setValue(Pd.a.Exh,0);b.setValue(Pd.a.Hia,Yg.OutlineReader.ijl);(new Rt.OutlineIndentInfo(!0)).whj(b);return b}a8(b,h,r=null){const B=b.currentNode;if(!b.EJ(1))return this.Fkb(b,null,h,r);Uf.OutlineElementReader.sL(b)&&ig.OutlineElementNavigator.KQf(b,!0);return Uf.OutlineElementReader.Eh(b)?
Zr.Pf.My(b,!1,h,r):(b.U7c(B),null)}XSk(b){return Yg.OutlineReader.QGf(b.currentNode)||Uf.OutlineElementReader.Eh(b)||Uf.OutlineElementReader.sL(b)||Ah.TableCellReader.isTableCell(b)}Fkb(b,h=null,r=!1,B=null){if(!this.XSk(b))return null;const P=Zr.Pf.Jgb();this.lno(P,b);b.AIb(P,h,1,null);b.Aj(P);r&&(Zr.Pf.NH(b,B),ig.OutlineElementNavigator.Yd(b));return P}lno(b,h){if(h=this.Icm(h))switch(h.type){case 11:Zr.Pf.jhf(h,b,!0);break;case 8:h=Zr.Hi.isRtl(h),Zr.Pf.xQb(b,h)}}Icm(b){return this.oek.Jcm(b)}wQb(b,
h){b.setValue(Pd.a.hr,h?11:9)}Yho(b,h){const r=Cm.WordSectionNavigator.instance.yL(b);return r?Yg.OutlineReader.YX(b)!==h?(r.setValue(Mc.a.cef,h),!0):!1:null}static get Hi(){return si.PageReader.instance}static get Pf(){return Zr.rh||(Zr.rh=Ma.a.instance.resolve("Box4.IOutlineElementEditor"))}static set Pf(b){Zr.rh=b}}Zr.rh=null;Zr.De=null;Object(m.a)(Zr,"OutlineEditor",null,[526]);const Su=b=>{b.ia("Box4.OutlineLevelEditors.OutlineEditor",()=>new Zr(b.resolve("Box4.IOutlineElementNodeIdFactory"))).as("Box4.IOutlineEditor").ha();
b.ia("Box4.OutlineLevelEditors.OutlineElementEditor",()=>new Ru.a(b.Ve("Box4.IOutlineEditor"),b.Ve("Box4.List.IListEditor"),b.Ve("Box4.List.IListReader"),b.resolve("Box4.ICreateParagraphStrategy"),b.resolve("Box4.IMergeListEditorInOutlineElementStrategy"),b.resolve("Box4.IBox4GraphWriter"),b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.Styles.IWACStyleReader"),b.Ta("Common.ISystemInitiatedFeedback"),b.resolve("Box4.IParagraphCollection"))).as("Box4.IOutlineElementEditor").ha()};
class St{Qqj(){return{Pqj:!0,cLj:!1}}}Object(m.a)(St,"CursorMovementValidator",null,[469]);class Hy{get name(){return"Box4.OutlineLevelEditors"}wc(b){b.ia("Box4.ListEditors.CursorMovementValidator",()=>new St).as("Box4.List.ICursorMovementValidator").ha();Su(b)}init(){}dispose(){}static main(){L.a.instance.Gc(new Hy)}}Object(m.a)(Hy,"Box4OutlineLevelEditorsPackage",null,[1,2]);class Iy{constructor(b){this.gKd=null;this.hTi=b.kb("OfficeOnlineChromeExtensionId");this.qTi=b.kb("ChromeClipboardAccessExtensionId");
this.aJm=b.$("OfficeOnlineChromeExtensionIsEnabled");this.rgh=!this.oRm();this.gKd=this.QQb?this.qTi:this.hTi}l6n(){this.gKd===this.hTi&&this.Wzi&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported"));this.gKd=this.qTi;this.rgh=!0}get QQb(){return this.rgh}oRm(){if(this.aJm&&this.Wzi){var b=localStorage.getItem("IsOfficeOnlineExtensionInstalled");if(b&&"true"===b)return b=localStorage.getItem("IsCopyPasteSupported"),!!b&&"true"===b}return!1}get Wzi(){let b=
!1;try{localStorage.setItem("LocalStorageAccessiblityTest","LocalStorageAccessiblityTest"),b="LocalStorageAccessiblityTest"===localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(h){t.ULS.sendTraceTag(19452045,307,50,h.toString())}return b}}Object(m.a)(Iy,"ChromeExtensionHelper",null,[957]);var pu=c(1465),Jy=c(681),xv=c(1416);class cw{create(b){return new xv.a(b)}}Object(m.a)(cw,"Factory",null,[708]);var yo=c(145);class Hz{constructor(b,
h,r){this.$nk=b;this.we=h;this.VZa=r}Tb(){this.VZa.fb(Nb.a.mae,yc.a.application,this.mae.bind(this),96);this.VZa.ra(Nb.a.Soc,yc.a.view,this.c_o.bind(this));this.VZa.fb(Nb.a.q6i,yc.a.view,this.e_o.bind(this),96)}mae(b,h,r,B,P){if(1===r)return 32;b=Object.assign(new $f.a,{ExternalId:"StylesGalleryContextMenu",UpdateDynamically:!0,MenuSectionList:[]});h=[];r=Object.assign(new di.a,{ControlList:[]});r.ControlList.push(Object.assign(new ah.a,{ExternalId:"UpdateStyle",QueryCommand:"QueryUpdateStyle"}));
h.push(r);Array.addRange(b.MenuSectionList,h);P.MenuItems=b;return 32}e_o(b,h,r,B,P){if(1===r)return 32;b=Ck.a.Swj();null==b&&8;b=this.we.uR(b);P[pj.a.LabelText]=String.format(F.a.zf(Box4Intl.Box4Strings.l_UpdateStyleCommand),b);return 32}c_o(b,h,r){b=Ck.a.ZJb(h);if(1===r||b)return b?8:32;r=new Map;r.set("Source","StyleContextMenuActor");r.set("Action","UpdateStyle");va.Health.instance.recordKpiUsage(yo.a.CAa,0,yo.a.yB,r);this.$nk.rqg(h)?Qc.b(539842578,3018,50,"User Successfully Updated styles from UI"):
(h=new Map,h.set("Source","StyleContextMenuActor"),h.set("Action","UpdateStyle"),h=Object.assign(new hc.a,{extendedProperties:h}),va.Health.instance.recordKpiFailure(yo.a.CAa,"UpdateStyleFailed",!1,!0,h),Qc.b(539842780,3018,50,"User tried to update a style via UI, but we were unable to update it."));return 32}}Object(m.a)(Hz,"StyleContextMenuActor",null,[]);var Tt=c(1054),Ky=c(1538),ms=c(447),dw=c(1788);class Iz extends dw.a{constructor(b,h,r,B,P,ca,ra=null,Qa=null){super(b,ca,ra,Qa);this._formatting=
null;this.FLa=!1;this.dvb=v.AFrameworkApplication.K.$("FollowDestinationFormattingPasteIsEnabled");this.oxb=0;this.$Dc=new mb.a;Qc.a(8128527,307,Uf.OutlineElementReader.Eh(b));this.oM=h;this.oM.H3b(this);this.qq=r;this.Qn=B;this.Jd=P;this.k5e=Qa;this.jOe=fg.ListItemReader.lg(this.zc)}get Tk(){return null!=this.NFg?this.NFg:this.NFg=Ma.a.instance.resolve("Box4.IParagraphEditor")}get ZJd(){return null}get E5b(){return this.jOe&&!this.oM.sEa}get HDb(){return 0<this.oxb}Jda(b,h){if(!this.FZ.bog(this.zc,
h,!0)){Qc.a(8701077,307,ke.ParagraphReader.oh(this.zc));var r=this.zc.currentNode,B=Ue.a.tw(r);this.dvb&&this._formatting.nR&&(r=r.qa.last,this.FLa&&(r.formatting=this._formatting.nR.vf(r),this.FLa=!1),b=this.FZ.uyf(b,h),this.FZ.K$(this.zc.currentNode,this._formatting.Qda,h));this.jg.Ge(B,b)}}Ida(){Qc.a(8701078,307,ke.ParagraphReader.oh(this.zc));const b=Ue.a.tw(this.zc.currentNode);this.jg.hia(b,h=>new ms.a(h))}Xnb(){this.FZ.Ayf(this.zc)}BHa(){this.dvb&&(this.FLa=!0)}MSa(){Qc.a(8701079,307,ke.ParagraphReader.oh(this.zc))}LSa(){Qc.a(8701080,
307,ke.ParagraphReader.oh(this.zc))}jE(b){this.oM.sEa||(this.dvb?(this.a2e(b),this._formatting.gne(this.zc.currentNode),b&&"P"===b.f$.SWd&&this.k5e.mea(this.zc.currentNode,this._formatting.fS),this.FZ.K$(this.zc.currentNode,this._formatting.Qda,b)):this.nKk(b))}AF(){this.oM.sEa||this.hNc()}RSa(){}i6a(){}Bya(){Qc.a(8701081,307,Uf.OutlineElementReader.Eh(this.zc)||Yg.OutlineReader.mx(this.zc)||ke.ParagraphReader.oh(this.zc)&&this.oM.sEa);let b=!1;this.HDb||(b=this.E5b||!0);b||(this.mV+=1);this.oxb++}zya(){this.oxb--;
let b=!1;this.HDb||(b=this.E5b||!0,this.Qn.Gaj(this.$Dc));b||--this.mV}FHa(b){Qc.a(8701082,307,Uf.OutlineElementReader.Eh(this.zc)||Yg.OutlineReader.mx(this.zc)||ke.ParagraphReader.oh(this.zc)&&this.oM.sEa);Qc.a(8701083,307,!!b.listStyleType)}Aya(){Qc.a(8701084,307,Uf.OutlineElementReader.Eh(this.zc)||ke.ParagraphReader.oh(this.zc)&&this.oM.sEa);this.oM.sEa||Qc.a(8701085,307,this.zc.Jt(2))}b$(b){this.oM.b$(b)}Z9(){this.oM.Z9()}Acd(b){this.$Dc.add(b)}u5(b){this.oM.u5(b)}a$(){this.oM.a$()}Y9(b){this.oM.Y9(b)}X9(){this.oM.X9()}nKk(b){this.ggc(!1);
(new Ad.GraphIterator).kd(this.zc);b=dw.a.Pf.NH(this.zc,this.kRc(b));Qc.a(8128534,307,b===this.zc.currentNode);Qc.a(8128535,307,ke.ParagraphReader.Xb(b))}hNc(){Qc.a(8128536,307,ke.ParagraphReader.oh(this.zc));ig.OutlineElementNavigator.Yd(this.zc)}reset(){this.dvb&&(super.reset(),this._formatting=this.Zpf(!0))}a2e(b){this.ggc(!1);(new Ad.GraphIterator).kd(this.zc);b=dw.a.Pf.NH(this.zc,this.kRc(b));Qc.a(36577367,307,b===this.zc.currentNode);Qc.a(36577368,307,ke.ParagraphReader.Xb(b));-1!==this._formatting.yw&&
this.Tk.oE(b,this._formatting.yw);this._formatting.lineSpacing&&this.k5e.mD(b,this._formatting.lineSpacing);this._formatting.X5&&this.k5e.Ihe(b,this._formatting.X5);this.FLa=!0;this._formatting.paragraph=b}static maf(b,h){let r=0;switch(h){case 3:r=Ze.a.Nv(b);break;case 7:r=xg.a.Wy(b,0);break;case 1:r=Ze.a.p7e(b);break;case 5:r=Ze.a.Nv(Ze.a.o1f(b));break;default:t.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",b,h)}return r}}
Object(m.a)(Iz,"TextOnlyBox4PasteSteward",dw.a,[]);class Ly extends Iz{constructor(b,h,r,B,P,ca,ra,Qa=null,tb=null){super(h,r,B,P,ca,ra,Qa,tb);this.xxc=!1;this.cwb=[];this.ejh=b;h={};h.textOnlyPasteFlags=b;t.ULS.sendTraceTag(509088282,307,50,H.c(h))}reset(){super.reset();this.xxc=!1;this.cwb.length=0;this.Bod=!1}jE(b){this.xxc||(super.jE(b),this.xxc=!0)}AF(){this.Bod?this.Bod=!1:this.Ida(null)}Ida(b){this.ejh&2||super.Ida(b)}Bya(){}zya(){}FHa(){}Aya(){}b$(){}Z9(){}u5(b){this.xxc||(super.u5(b),this.xxc=
!0);this.cwb.push(!1)}a$(){this.ejh&1&&this.Ida(null);0<this.cwb.length?this.cwb.pop():Qc.a(509088281,307,!1)}Y9(){var b=this.cwb.length-1;0<=b?this.cwb[b]?(b=Ue.a.tw(this.zc.currentNode),this.jg.Ge(b,", ")):this.cwb[b]=!0:Qc.a(509088280,307,!1);this.Bod=!0}X9(){this.Bod=!1}Acd(){}}Object(m.a)(Ly,"StrictTextOnlyBox4PasteSteward",Iz,[]);class My{constructor(b,h,r,B){this.rNe=b;this.CK=h;this.Hf=r;this.FZ=B}create(b,h,r,B,P=null,ca=null,ra=null,Qa=null){return 1===b?null!==Qa&&0!==Qa?new Ly(Qa,h,B,
this.rNe,this.CK,this.Hf,P,ca,this.FZ):new Iz(h,B,this.rNe,this.CK,this.Hf,P,ca,this.FZ):new Ky.Box4PasteSteward(h,r,B,this.rNe,this.CK,this.Hf,P,ca,this.FZ,ra)}}Object(m.a)(My,"Box4PasteStewardFactory",null,[706]);var HA=c(191),pl=c(338),qn=c(1623);class Tu{constructor(b,h,r){this.iz=null;this.pxb=0;this.zc=b;this.Mk=r}H3b(b){this.iz=b}get sEa(){return 0<this.pxb}b$(b){var h;Qc.a(7869459,307,!!this.iz);Qc.a(7869460,307,Uf.OutlineElementReader.Eh(this.zc)||Yg.OutlineReader.mx(this.zc));Qc.b(38563978,
307,50,"Table pasting started");this.iz.ggc(!0);const r=new Ad.GraphIterator;r.kd(this.zc);let B=qn.a.cwm[b.styleId];B||(v.AFrameworkApplication.oe("gdea6103;0df65435"),(null===(h=v.AFrameworkApplication.K)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBorderFixEnabled",!1))&&b.EDf?(t.ULS.sendTraceTag(509125329,3022,50,"onTableStart: Fixed default table style"),B=qn.a.Phn):B=qn.a.RQh);h=this.Mk.PTn(this.zc,b.rowCount,b.fgb,B,b.tableLook,this.iz.kRc(b),b.EDf);b.Qkg&&
(Qc.b(573691298,3022,100,"Applying table border properties"),qn.a.suh(b.Qkg,this.zc,!1,!0));b.EXd&&(Qc.b(573691299,3022,100,"Applying indentation properties"),qn.a.$Ek(this.zc,b.EXd.spaceBefore,b.EXd.spaceAfter));b.TGd&&(Qc.b(573691328,3022,100,"Applying column widths"),qn.a.HEk(b.TGd,this.zc,Object(Ra.a)(pl.TableNode,h),b.P4a));this.iz.uDd(r,!1);this.pxb++;fg.ListItemReader.lg(r)&&this.iz.Acd(r.currentNode);Qc.a(7869461,307,Rh.TableReader.isTable(this.zc))}Z9(){Qc.a(7869462,307,!!this.iz);Qc.a(7869463,
307,dl.a.isTableRow(this.zc));Qc.b(38563979,307,50,"Table pasting finished");this.zc.rt(14)&&qn.a.Bhj(this.zc.Gn);ig.OutlineElementNavigator.Yd(this.zc);this.pxb--}u5(b){Qc.a(7869464,307,!!this.iz);Qc.b(573691329,3022,100,"Table row pasting started");Rh.TableReader.isTable(this.zc)?Kf.moveToFirstRow(this.zc):dl.a.isTableRow(this.zc)&&Kf.moveToNextRow(this.zc);b.height&&(Qc.b(573691330,3022,100,"Applying table row height"),qn.a.QFk(this.zc,b.height));Qc.a(7869465,307,dl.a.isTableRow(this.zc))}a$(){Qc.a(7869466,
307,!!this.iz);Qc.a(7869467,307,Ah.TableCellReader.isTableCell(this.zc));Kf.returnToContainingRow(this.zc)}Y9(b){Qc.a(7869468,307,!!this.iz);Qc.a(7869469,307,!this.iz.mV);dl.a.isTableRow(this.zc)?Kf.moveToFirstColumn(this.zc):Ah.TableCellReader.isTableCell(this.zc)?Kf.moveToNextColumn(this.zc):Qc.a(7869471,307,!1);if(this.zc.currentNode){Qc.b(573691331,3022,100,"Table cell pasting started");var h=Object(Ra.a)(HA.TableCellNode,this.zc.currentNode);Qc.a(50689760,307,!h&&16!==this.zc.currentNode.type||
!!h&&16===this.zc.currentNode.type);if(h){var r=new Ad.GraphIterator;r.kd(this.zc);if(b.Wdc)Qc.b(573691332,3022,100,"Processing skipped cell"),qn.a.QJn(r,b);else{if(1<b.colSpan||1<b.rowSpan){const B=Kf.returnToContainingTable(r);if(!B)return;B.setValue(Mc.a.complexTable,!0);r.kd(this.zc);Qc.b(573691333,3022,100,"Processing merged cell");qn.a.gJn(r,b);h.rowSpan=b.rowSpan;h.colSpan=b.colSpan}qn.a.WFk(this.zc,b.shadingColor);qn.a.LGk(this.zc,b.verticalAlignment);qn.a.vEk(this.zc,b.mle);qn.a.suh(b.ska,
this.zc,!b.colSpan&&!b.rowSpan,!1);(new Ad.GraphIterator).kd(this.zc);Kf.forEachCell(r,b.rowSpan,b.colSpan,(B,P,ca)=>{Qc.b(573691334,3022,100,"Setting ghost cell borders");qn.a.Ulj(B,b.ska,P,ca,b.rowSpan,b.colSpan)});qn.a.NGk(this.zc,b.width,b.P4a);Qc.a(7869472,307,Yg.OutlineReader.mx(this.zc))}}}}X9(){Qc.a(7869473,307,!!this.iz);Qc.a(7869474,307,Uf.OutlineElementReader.Eh(this.zc)||Ah.TableCellReader.isTableCell(this.zc));Kf.returnToCell(this.zc);Qc.a(7869475,307,0>=this.iz.mV);this.iz.l8e()}}Object(m.a)(Tu,
"Box4TableSteward",null,[727,240]);class yk{constructor(b,h,r){this.iz=null;this.pxb=0;this.zc=b;this.Mk=r}H3b(b){this.iz=b}get sEa(){return 0<this.pxb}b$(){this.sEa&&(Qc.a(8787101,307,ke.ParagraphReader.oh(this.zc)),ig.OutlineElementNavigator.Yd(this.zc));Qc.a(8701086,307,!!this.iz);Qc.a(8701087,307,Uf.OutlineElementReader.Eh(this.zc)||Yg.OutlineReader.mx(this.zc));this.pxb++}Z9(){Qc.a(8701088,307,!!this.iz);ig.OutlineElementNavigator.Yd(this.zc);this.pxb--;if(this.sEa){this.iz.ggc(!0);const b=yk.Pf.NH(this.zc);
Qc.a(8787102,307,b===this.zc.currentNode);Qc.a(8787103,307,ke.ParagraphReader.oh(this.zc))}}u5(b){Qc.a(8701089,307,!!this.iz);this.iz.ggc(!0);const h=new Ad.GraphIterator;h.kd(this.zc);this.iz.uDd(h,!1);fg.ListItemReader.lg(h)&&this.iz.Acd(h.currentNode);b=yk.Pf.NH(this.zc,this.iz.kRc(b));Qc.a(8701090,307,b===this.zc.currentNode);Qc.a(8701091,307,ke.ParagraphReader.oh(this.zc))}a$(){Qc.a(8701120,307,!!this.iz);Qc.a(8701121,307,ke.ParagraphReader.oh(this.zc));ig.OutlineElementNavigator.Yd(this.zc)}Y9(){Qc.a(8701122,
307,!!this.iz);Qc.a(8701123,307,ke.ParagraphReader.oh(this.zc));Qc.a(8701124,307,!this.iz.mV);var b=this.zc.currentNode;ke.ParagraphReader.textLength(b)&&(b=Ue.a.tw(b),this.iz.jg.Ge(b,", "))}X9(){Qc.a(8701125,307,!!this.iz);Qc.a(8701126,307,ke.ParagraphReader.oh(this.zc));Qc.a(8701127,307,0>=this.iz.mV);this.iz.l8e()}static get Pf(){return null!=yk.bFg?yk.bFg:yk.bFg=Ma.a.instance.resolve("Box4.IOutlineElementEditor")}}Object(m.a)(yk,"TextOnlyBox4TableSteward",null,[727,240]);class vp{constructor(b,
h,r=!1,B=!1){this.CK=b;this.qA=h;this.Wek=r;this.cfk=B}create(b,h){return 1===b?new yk(h,this.CK,this.qA):new Tu(h,this.CK,this.qA,this.Wek,this.cfk)}}Object(m.a)(vp,"Box4TableStewardFactory",null,[707]);class ln{create(){return new Nf.a}}Object(m.a)(ln,"Factory",null,[705]);class hq{constructor(b){this.ga=b}bfn(b){if(4===b)b=Nb.a.VGa;else if(2===b)b=Nb.a.Qja;else if(1===b)b=Nb.a.LSb;else if(3===b)b=Nb.a.w1a;else return;this.ga.processAction(b,2)}Thb(){this.ga.processAction(Nb.a.Thb,2)}}Object(m.a)(hq,
"SelectionCommands",null,[704]);var hr=c(231),Ut=c(1112),Ny=c(142),Qx=c(639);class vt{constructor(){this.aZc=!1;this.H3o=v.AFrameworkApplication.K.kb("WordEditorVisiFontFileUri");this.J3o=v.AFrameworkApplication.K.kb("WordEditorVisiRtlFontFileUri");this.I3o=v.AFrameworkApplication.K.kb("WordEditorVisiPilcrowFontFileUri");this.E3o=v.AFrameworkApplication.K.kb("WordEditorVisiCarriageReturnFontFileUri");this.G3o=v.AFrameworkApplication.K.kb("WordEditorVisiCarriageReturnRtlFontFileUri")}LLo(){this.aZc=
!this.aZc}KLo(b){this.LLo();let h=b.getElementsByClassName("VisiFontStyle")[0],r=b.getElementsByClassName("VisiFontRtlStyle")[0],B=b.getElementsByClassName("VisiFontPilcrowStyle")[0],P=b.getElementsByClassName("VisiFontCarriageReturnStyle")[0],ca=b.getElementsByClassName("VisiFontCarriageReturnRtlStyle")[0];h||(h=document.createElement("Style"),h.className="VisiFontStyle",dc.a.vv(h,""),b.appendChild(h));r||(r=document.createElement("Style"),r.className="VisiFontRtlStyle",dc.a.vv(r,""),b.appendChild(r));
B||(B=document.createElement("Style"),B.className="VisiFontPilcrowStyle",dc.a.vv(B,""),b.appendChild(B));P||(P=document.createElement("Style"),P.className="VisiFontCarriageReturnStyle",dc.a.vv(P,""),b.appendChild(P));ca||(ca=document.createElement("Style"),ca.className="VisiFontCarriageReturnRtlStyle",dc.a.vv(ca,""),b.appendChild(ca));if(this.aZc)return t.ULS.sendTraceTag(593294047,324,50,"Formatting markers are inserted"),this.NGc(h)&&this.NGc(r)&&this.NGc(B)&&this.NGc(P)&&this.NGc(ca);t.ULS.sendTraceTag(593294046,
324,50,"Formatting markers are removed");return this.U6c(h)&&this.U6c(r)&&this.U6c(B)&&this.U6c(P)&&this.U6c(ca)}NGc(b){return""===dc.a.Hy(b)?("VisiFontStyle"===b.className?dc.a.vv(b,this.zQc("WordVisi_MSFontService",this.H3o)):"VisiFontRtlStyle"===b.className?dc.a.vv(b,this.zQc("WordVisiRtl_MSFontService",this.J3o)):"VisiFontPilcrowStyle"===b.className?dc.a.vv(b,this.zQc("WordVisiPilcrow_MSFontService",this.I3o)):"VisiFontCarriageReturnStyle"===b.className?dc.a.vv(b,this.zQc("WordVisiCarriageReturn_MSFontService",
this.E3o)):"VisiFontCarriageReturnRtlStyle"===b.className&&dc.a.vv(b,this.zQc("WordVisiCarriageReturnRtl_MSFontService",this.G3o)),!0):!1}U6c(b){return""!==dc.a.Hy(b)?(dc.a.vv(b,""),!0):!1}zQc(b,h){return"@font-face { font-family: "+b+"; src: url('"+h+"'); unicode-range: U+0020, U+00A0, U+200B, U+2003; font-display: swap; }"}}Object(m.a)(vt,"VisiMarkersOperation",null,[702]);var Es=c(451),wp=c(378);class Vt extends Es.a{constructor(b,h){super(b,h);this.$Ee=-1;this.bvb=0;this.OBe=null;this.a_g=!1;
this.bDe=[];this.upd=!1;this.k8g=!0;this.EMe=this.gnd=null;this.preventDismissOnScroll=this.Cae=this.xic=!1;this.v8=null;this.Azd=!1;this.nTc=!0;this.Ws=!1;this.q1g=v.AFrameworkApplication.K.$("FloatieLightDismissIsEnabled");Vt.$ch||(v.AFrameworkApplication.va.ra(fb.a.showFloatie,yd.a.frame,cd.ActionManager.Of),Vt.$ch=!0)}get z1h(){return this.wO}set z1h(b){this.wO=b}get JAj(){return this.Azd}get zUc(){return this.a_g}set zUc(b){this.a_g=b;this.bvb=0}get $A(){return!0}get cssClass(){return v.AFrameworkApplication.ua&&
v.AFrameworkApplication.ua.Kb.D9?"cui-floatie MLRVisualRefresh":"cui-floatie"}get isVisible(){return this.Ws}oUa(){for(let b of this.children)if(b.oUa())return!0;return!1}get A$(){return 9}Bf(b){this.bDe[this.bDe.length]=b;super.Bf(b)}Im(){super.Im();nf.c(this.Nc)&&this.VC();this.Nc=qf.a.MTa(this.Nc);this.qX(this.Nc);this.dirty=!1}Sgc(b){3===b.kg||this.Cae||this.dismissFloatie(b);return!1}Vgc(){return!1}Tgc(b){3!==b.kg&&this.nTc&&!this.xic&&this.vYo(b);return!1}Ugc(){return!1}Qgc(b){3===b.kg&&this.dismissFloatie(b);
return!1}Rgc(b){void 0!==this.v8&&null!==this.v8||this.preventDismissOnScroll||this.dismissFloatie(b);return!1}gD(){this.Gif();return!1}U7d(){this.zUc=!0}vYo(b){if(b=jd.a.e7b(b.clientPoint,this.OBe)){if(this.zUc){if(!this.bvb||b<this.bvb)this.bvb=b;b-=this.bvb}b-=this.$Ee;0>b&&(b=0);const h=255-4*b;0>=h&&63.75<=b?this.dismissFloatie():Z.a.setOpacity(this.Nc,Math.max(h/255,0))}else this.zUc=!1,this.bvb=0,Z.a.setOpacity(this.Nc,1)}MWo(b){let h=null;void 0!==this.gnd&&null!==this.gnd&&(h=this.gnd(b));
b=null;for(const r of this.bDe){let B=!this.JAj&&r.eEi;if(!B&&void 0!==h&&null!==h)for(let P=0;P<h.length;P++)if(r.id===h[P]){B=!0;break}r.Nc.style.display=B?"none":"";r.b7b=!B;B||(b=r)}b&&(b.b7b=!1)}o$h(){const b=this.Nc.style.top,h=this.Nc.style.left;this.Nc.style.top="0px";this.Nc.style.left="0px";const r=this.gGb();this.Nc.style.top=b;this.Nc.style.left=h;return r}gGb(){const b=this.Nc.style.visibility,h=this.Nc.style.display;this.Nc.style.visibility="hidden";this.Nc.style.display="";const r=
Qd.a.getElementBounds(this.Nc);this.Nc.style.display=h;this.Nc.style.visibility=b;return r}f9i(b){3===b||this.Mme?(Sys.UI.DomElement.addCssClass(this.Nc,wp.a.pSb),this.Azd=!0):(Sys.UI.DomElement.removeCssClass(this.Nc,wp.a.pSb),this.Azd=!1);this.MWo(b)}k8a(b,h,r,B=!1){this.isVisible||(this.v8||!this.k8g&&this.preventDismissOnScroll||(this.k8g=!1,Qd.a.F4d("ShowLegacyFloatie",""),v.AFrameworkApplication.va.processAction(fb.a.showFloatie,2)),this.f9i(r),this.nTc=!0,this.bvb=0,this.zUc=!1,!this.q1g||
void 0!==this.v8&&null!==this.v8?(this.upd=!1,this.Cga(this,!1)):(this.upd=!0,this.mKk(this)),h=B?b:this.gFn(b,h),this.Nc.style.top=h.y.toString()+"px",this.Nc.style.left=h.x.toString()+"px",this.wu(),this.OBe=this.gGb(),this.$Ee=jd.a.e7b(b,this.OBe),Z.a.setOpacity(this.Nc,1),this.Nc.style.zIndex=String(v.AFrameworkApplication.ua.Dua),this.Nc.style.display="",this.Ws=!0)}gFn(b,h){const r=this.JAj?30:17,B=this.o$h(),P=dc.a.qHb(),ca=dc.a.hY();b=new Sys.UI.Point(b.x,b.y);1===h?b.y-=B.height:3===h?(b.y-=
B.height,b.x-=B.width):2===h&&(b.x-=B.width);b.x+B.width>P&&(b.x=Math.floor(P-B.width));0>b.x&&(b.x=0);b.y=3===h||1===h?b.y-r:b.y+r;0>b.y&&(b.y=0);b.y+B.height>ca&&(b.y=ca-B.height);return b}hFn(b,h){const r=b.LOi;if(r){this.f9i(h);var B=this.o$h();this.v8=b;b=r.Lrg-r.POc>B.width;var P=r.POc+r.Ylf>B.width,ca=r.J8b>B.height+17,ra=r.pKj-(r.J8b+r.Ulf)>B.height+17;B=new Sys.UI.Point(r.POc,r.J8b);P||b||(P=!0,B.x=r.Lrg);b=r.lmb?r.CKf?ra?P?2:0:P?3:1:ca?P?3:1:P?2:0:r.CKf?ra?b?0:2:b?1:3:ca?b?1:3:b?0:2;if(3===
b||2===b)B.x=r.POc+r.Ylf;if(2===b||0===b)B.y=r.J8b+r.Ulf;this.k8a(B,b,h);this.nTc=!1;h=this.v8.oZe.Nc;void 0!==h&&null!==h&&(h.style.zIndex=String(v.AFrameworkApplication.ua.Dua))}}o4(){let b=super.o4();this.dismissFloatie()&&(b=!0);return b}dismissFloatie(b=null){if(!this.isVisible)return!1;void 0!==this.DFc&&null!==this.DFc&&this.DFc.Qva(null);void 0!==this.v8&&null!==this.v8&&this.v8.e4();this.e4();this.q1g&&this.upd?this.Ovl(this):this.jca(this,!1);this.upd=!1;this.$Ee=-1;this.v8=null;this.Nc.style.display=
"none";this.Ws=!1;this.EMe&&this.EMe(b);return!0}Gif(){void 0!==this.v8&&null!==this.v8&&(this.v8.q_a=null,this.v8.e4(),this.v8=null,this.Z4d.style.zIndex=String(v.AFrameworkApplication.ua.$Ca),this.Nc.style.zIndex=String(v.AFrameworkApplication.ua.Dua))}rWn(b){this.gnd=b}dXn(b){this.EMe=b}set $A(b){super.$A=b}}Vt.$ch=!1;Object(m.a)(Vt,"Floatie",Es.a,[556,304,305]);class Uw{constructor(b,h){this.Bv=this.CLa=null;this.aMi=b;this.Egj=h}get B1h(){return this.CLa}Jpo(b){this.CLa=b}gGb(){return this.Bv.gGb()}M0(){return this.Bv?
this.Bv.isVisible:!1}pxh(b){this.Jpo(b)}showFloatie(b,h){this.k8a(h.location,h.Rx,h.isRtl)}k8a(b,h,r){r=r?this.Egj:this.aMi;this.YMd();this.Bv&&this.Bv.k8a(b,r,h)}dismissFloatie(){this.Bv&&this.Bv.dismissFloatie()}YMd(){this.CLa&&!this.Bv&&(this.Bv=Object(Ra.a)(Vt,this.CLa()))}MNd(){}}Object(m.a)(Uw,"AFloatieManager",null,[721]);class Uu extends Uw{constructor(){super(1,3);this.Wyj=!1;this.fSh=""}k8a(b,h,r){r=r?this.Egj:this.aMi;this.YMd();this.Bv&&(this.Bv.isVisible&&this.Bv.dismissFloatie(),this.Wyj||
this.Bv.Hm(),this.Bv.k8a(b,r,h,!0))}YMd(){this.B1h&&!this.Bv&&(this.Bv=this.CLa())}MNd(){if(this.Bv&&this.Bv.isVisible){const b=Object(Ra.a)(yn.Control,this.Bv.controls["PasteFloatie.FlyoutAnchor"]);b.behavior.gx(b.Yib(),1,null)}}Geg(b){this.fSh=b}M2n(b){b=b.Xpf("Menu16",null);Hh.a("renderIcon")&&b&&appChrome.api.renderIcon(Uu.M0j,b.firstElementChild)}Roc(b,h,r){if(this.Bv){const B=this.Bv.controls[this.fSh];B&&(Uu.P0g||(this.M2n(B),Uu.P0g=!0),B.Sd[ll.a.labelText]=b,B.Sd[ll.a.alt]=h,r&&B.behavior.Hm())}}}
Uu.P0g=!1;Uu.M0j="Designer_20";Object(m.a)(Uu,"PasteFloatieManager",Uw,[]);var qu=c(1063);class Vw{constructor(){this.Nd=null}get $w(){return null}getTitle(){return null}S8h(){return null}reset(b){this.Nd=b.node}GJa(b){b=So.d(this.Nd,b);let h=null;if(!b||b.vh!==this.vh)return{returnValue:!1,hG:h};h=Object.assign(new qu.a,{$G:this.key,contentObject:b,title:this.getTitle(b),description:this.S8h(b)});return{returnValue:!0,hG:h}}}Object(m.a)(Vw,"BlobDetailsProvider",null,[414,415]);class wt extends Vw{constructor(){super()}get key(){return"EQUATION"}get vh(){return 11}get $w(){return Box4Intl.Box4Strings.l_EquationContentTitle}}
Object(m.a)(wt,"EquationDetailsProvider",Vw,[]);class $s{constructor(){this.DZg=null}get key(){return"LINK"}get $w(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(b){this.DZg=Tg.a.Z9b(b.node)}GJa(b){let h=null;for(const r of this.DZg)if(r.cpBegin<=b&&b<r.cpEnd)return h=Object.assign(new qu.a,{$G:this.key,contentObject:r.hyperlink}),{returnValue:!0,hG:h};return{returnValue:!1,hG:h}}}Object(m.a)($s,"HyperlinkDetailsProvider",null,[414,415]);var Rx=c(1396),at=c(912);class FB{constructor(){this.y3g=
!1}get key(){return"IFRAMENODE"}get $w(){return this.y3g?Box4Intl.Box4Strings.l_IFrameVideoTitle:Box4Intl.Box4Strings.l_IFrameWebContentTitle}roc(b){let h=null;b=b?ke.ParagraphReader.gQa(b.currentNode):null;if(!b)return{returnValue:!1,Bna:h};h=Object.assign(new Rx.a,{$G:this.key,contentId:b.id,contentObject:b});return{returnValue:!0,Bna:h}}WFb(b,h){b=b?Object(Ra.a)(at.a,b.contentObject):null;h=h?Object(Ra.a)(at.a,h.contentObject):null;let r="";h&&b.id===h.id||(this.y3g=b.$4a,r=String.format(Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat,
b.$w,this.$w));return r}}Object(m.a)(FB,"IFrameDetailsProvider",null,[720,415]);class GB extends Vw{constructor(){super()}get key(){return"IMAGE"}get vh(){return 5}reset(b,h){super.reset(b,h);this.k9j=!xe.SelectionEditor.Pl(h)}get $w(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(b){return Id.ImageReader.bY(b.properties)}S8h(b){var h;b=Id.ImageReader.iQa(b.properties);return null!==(h=Eb.App.instance)&&void 0!==h&&h.M1d&&this.k9j?String.format(Box4Intl.Box4Strings.l_ContentSelectedNotificationFormat,
b):b}}Object(m.a)(GB,"ImageDetailsProvider",Vw,[]);class Jz{get key(){return"IMAGENODE"}get $w(){return Box4Intl.Box4Strings.l_ImageContentTitle}roc(b){let h=null;if(!b||!Id.ImageReader.Mt(b.currentNode))return{returnValue:!1,Bna:h};h=Object.assign(new Rx.a,{$G:this.key,contentId:b.currentNode.id,contentObject:b.currentNode});return{returnValue:!0,Bna:h}}WFb(b,h){b=b.contentObject;const r=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;let B="";h&&b.id===h.contentObject.id||(B=String.format(r,
Id.ImageReader.bY(b.properties),Box4Intl.Box4Strings.l_ImageContentTitle));return B}}Object(m.a)(Jz,"ImageNodeDetailsProvider",null,[720,415]);let Up,Xm;class ew{constructor(b,h){this.zUg=null;this.Cn=h;this.xPe=b;this.key=ew.keys.J(b);this.$w=ew.m6k.J(b)}reset(b){this.zUg=this.Cn.E4(b.node)}GJa(b){var h=ew.LFl(this.zUg||[],r=>this.AKm(b,r));h=this.z$k(h);return{returnValue:!!h,hG:h}}AKm(b,h){return h.Ec<=b&&b<h.end&&(!h.errorDetails||this.xPe===h.errorDetails.proofingType)}z$k(b){return b?Object.assign(new qu.a,
{$G:this.key,contentObject:b.errorDetails,description:this.Vib()}):null}Vib(){return ko.a.qRa()?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static LFl(b,h){for(const r of b)if(h(r))return r;return null}}ew.keys=(Xm=new Fe.a,Xm.add(1,"SPELLINGERROR"),Xm.add(2,"GRAMMATICALERROR"),Xm.add(3,"ADVANCEDERROR"),Xm);ew.m6k=(Up=new Fe.a,Up.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),Up.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),Up.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),
Up);Object(m.a)(ew,"ProofingDetailsProvider",null,[414,415]);class Sx{constructor(){this.tableNode=null;this.RGd=this.cfe=this.columns=this.rows=0}}Object(m.a)(Sx,"TableInfo",null,[]);class HB{get key(){return"TABLE"}get $w(){return Box4Intl.Box4Strings.l_TableContentTitle}roc(b){var h=null;if(!Ah.TableCellReader.isTableCell(b))return{returnValue:!1,Bna:h};h=new Ad.GraphIterator;h.kd(b);b=new Sx;b.cfe=dl.a.Ls(h)+1;b.RGd=ou.a(h)+1;Kf.returnToContainingTable(h);b.tableNode=h.currentNode;b.columns=Rh.TableReader.hh(b.tableNode);
b.rows=Rh.TableReader.gg(b.tableNode);h=Object.assign(new Rx.a,{$G:this.key,contentId:b.tableNode.id,contentObject:b});return{returnValue:!0,Bna:h}}WFb(b,h){b=b.contentObject;const r=new Vh.a;h||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,b.columns,b.rows));h&&h.contentObject.RGd===b.RGd||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,b.RGd));h&&h.contentObject.cfe===b.cfe||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,
b.cfe));return r.toArray().join(" ")}}Object(m.a)(HB,"TableDetailsProvider",null,[720,415]);class ph{constructor(b,h){this.HLa=b;this.Cn=h}get cTb(){return null!=this.rJg?this.rJg:this.rJg=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AriaInvalidForSpellingGrammar",!1)}X6f(){this.HLa.execute(b=>{b.D5(new $s);this.cTb||(b.D5(new ew(1,this.Cn)),b.D5(new ew(2,this.Cn)));b.D5(new ew(3,this.Cn));b.D5(new wt);b.D5(new GB);b.kjc(new HB);b.kjc(new Jz);b.kjc(new FB)})}}Object(m.a)(ph,
"AccessibilityActor",null,[]);class IA{constructor(b,h,r){this.Kwn=(B,P,ca)=>{if(1===ca)return 32;this.fXj().vhg();return 32};this.VZa=b;this.fXj=r}Tb(){this.VZa.fb(Nb.a.LZi,yc.a.view,this.Kwn,1028)}}Object(m.a)(IA,"AutoCorrectActor",null,[]);var ru=c(1990);class pm{constructor(){this.A4d=!0}xya(){}k6a(){}H3b(){}$Xf(){}$ge(){}get dic(){return!1}get qnb(){return 0}get eOi(){return!1}get JX(){return Bb.a.nil}}Object(m.a)(pm,"TextOnlyBox4ImageSteward",null,[719]);class Dz{constructor(b,h,r,B,P,ca,ra=
!1){this.qP=b;this.taskManager=h;this.ug=r;this.Kxm=B;this.notificationBar=P;this.Zb=ca;this.S3m=ra}create(b,h,r,B){return 1===b?new pm:new ru.a(h,this.qP,this.taskManager,this.ug,this.Zb,this.Kxm,this.notificationBar,this.S3m,r,B)}}Object(m.a)(Dz,"Box4ImageStewardFactory",null,[701]);var Fk=c(37);class DA{constructor(b){this.o0d=b}MRm(b){if(!b||!b.LB||1>b.LB.count)return!1;const h=[Fk.a.VOh,Fk.a.UOh];return!!this.KQd(b.LB,1,r=>this.XHd(r,h))}Cxi(b){return!b||!b.LB||1>b.LB.count?!1:!!this.KQd(b.LB,
1,h=>this.XHd(h,[Fk.a.EG]))}KOm(b){return!b||!b.LB||1>b.LB.count?!1:!!this.KQd(b.LB,2,h=>this.XHd(h,[Fk.a.VZc]))}oh(b){return!b||!b.LB||1>b.LB.count?!1:!!this.KQd(b.LB,1,h=>this.XHd(h,[Fk.a.pja]))}g_d(b){if(!b||!b.LB)return!1;b=b.LB;for(let h=0;h<b.count;++h)if(!b.J(h)||0<b.J(h).zIk)return!1;return!0}vyl(b,h){return this.Cxi(h)||this.KOm(h)?"":b}KQd(b,h,r){if(b&&0<b.count)for(let B=b.count-1;0<=B;--B){if(r(b.J(B)))return b.J(B);if(b.count-B>=h)break}return null}XHd(b,h){b=b&&b.Epi?b.Epi.split(" "):
null;if(!b)return!1;for(const r of h)if(0<=Array.indexOf(b,r))return!0;return!1}}Object(m.a)(DA,"Box4PasteStewardUtils",null,[700]);var qv=c(736);class Kx{constructor(){this.Coc=0;this.efc=Array(9)}}Object(m.a)(Kx,"FullListMetadata",null,[]);class Ey{constructor(b,h,r){this.Coc=this.level=0;this.TZh=null;this.Whc=!1;this.level=b;this.bqe=h;this.Rxn=r}}Object(m.a)(Ey,"ListItemMetadata",null,[]);var ar=c(1602);class Fy{constructor(){this.level=0;this.tagName="UL";this.Umb=null;this.ignore=!1;this.xjn=
0;this.listStyle="BulletListStyle1";this.xmb=new ar.a;this.font=this.levelText=""}}Object(m.a)(Fy,"ListLevelMetadata",null,[]);class EA{constructor(){}}Object(m.a)(EA,"LevelLists",null,[]);class FA{constructor(b){this.nodes=b;this.YOa=0;this.lists={};this.xmb=[];this.$Fi=null;this.hhl=[];this.hhl[0]=new EA}}Object(m.a)(FA,"WordConverterArguments",null,[]);var Ap=c(597);class Gf{}Gf.ail="data-ccp-timestamp";Gf.qKd="data-clipservice-ccpid";Gf.dil="data-shapeids";Gf.Bmm="docs-internal-guid-";Gf.Bwn=
"SCXO";Gf.HFn="SCXP";Gf.N5o="SCXW";Gf.Wfn="MsoListParagraphCxSpFirst";Gf.Xfn="MsoListParagraphCxSpLast";Gf.Gdf="data-pkey";Gf.Hdf="data-clipservice-type";Gf.Edf="data-clipservice-count";Gf.Fdf="data-clipservice-dc";Gf.lLc="data-clipservice-client";Gf.Idf="data-clipservice-version";Object(m.a)(Gf,"HtmlContentMetadataConstants",null,[]);class Tq{constructor(){this.y=this.x=0;this.top=this.left=null}}Object(m.a)(Tq,"AbsolutePosition",null,[]);var br=c(868);class Mo{constructor(b,h,r="",B=0){this.Ax=
!1;this.qZg=this.rZg=null;let P=!1;Mo.WNm(b)&&(P=!0,this.rZg=b);Mo.nOm(h)&&(this.qZg=h);this.g6j=r;this.NWj=B;this.Ax=P&&this.SWd?!0:!1}get isValid(){return this.Ax}get Hpi(){return this.rZg}get SWd(){return this.qZg}get Epi(){return this.g6j}get zIk(){return this.NWj}static WNm(b){return b?-1===b.indexOf(" ")&&0<b.length:!0}static nOm(b){return b?-1===b.indexOf(" ")&&0<b.length:!1}}Object(m.a)(Mo,"HtmlElementInfo",null,[]);class Ss{constructor(b){this.next=null;this.data=b}}Object(m.a)(Ss,"StackNode",
null,[]);class lu{constructor(){this.Vq=null;this.ak=0}get count(){return this.ak}get isEmpty(){return!this.count||!this.Vq}push(b){b=new Ss(b);b.next=this.Vq;this.Vq=b;this.ak=this.count+1}$Y(){return this.count&&this.Vq?this.Vq.data:null}pop(){if(!this.count||!this.Vq)return null;const b=this.Vq;this.Vq=b.next;this.ak=this.count-1;return b.data}clear(){this.Vq=null;this.ak=0}toArray(){const b=Array(this.count);let h=this.Vq;for(let r=this.count-1;0<=r&&h;r--)b[r]=h.data,h=h.next;return b}}Object(m.a)(lu,
"Stack",null,[]);class Qj{constructor(b){this.$i=b;this.Gvc=this.Csd=null;this.Ekd=!1}get ZJd(){return this.Gvc.$Y()}reset(){this.$i.reset();this.Csd=new lu;this.Gvc=new lu;this.Gvc.push(this.$i.vLc);this.Ekd=!1}L6d(){this.Ekd=!1}YJ(b){this.Ekd||(this.Csd.push(null),this.Ekd=!0);this.Csd.push(b)}onClose(){for(;;){const b=this.Csd.pop();if(!b)break;b()}}Slj(){return!1}Qin(){this.kv(()=>!0)}kv(b){const h=this.ZJd.clone();return b(h)?(this.Gvc.push(h),this.$i.BHa(h),this.YJ(Object(z.a)(this,this.Jon,
"onFormattingEnd")),!0):!1}fyf(b){return b.style?this.kv(h=>this.Slj(h,b))?1:2:2}Jon(){this.Gvc.pop();this.$i.BHa(this.ZJd)}Jda(){}F6d(){return 2}WUf(){return 2}XUf(){return 2}bVf(){return 2}qVf(){return 3}sVf(){}K6d(){return 2}tVf(){}uVf(){}vVf(){return 2}N6d(){return 2}O6d(){return 2}JVf(){return 2}P6d(){}LVf(){return 2}Q6d(){return 2}R6d(){return 2}U6d(){return 2}V6d(){return 2}YVf(){}ZVf(){return 2}b7d(){return 2}c7d(){return 2}f7d(){return 2}g7d(){return 2}i7d(){return 2}j7d(){return 2}l7d(){return 2}n7d(){return 2}zWf(){return 2}v7d(){return 2}GWf(){return 2}IWf(){}JWf(){return 2}y7d(){return 2}z7d(){return 2}A7d(){return 2}B7d(){return 2}C7d(){return 2}D7d(){return 2}QWf(){return 3}E7d(){}XWf(){return 2}F7d(){return 2}ZWf(){return 3}I7d(){}fXf(){}J7d(){return 2}lXf(){return 3}L7d(){return 2}N7d(){return 2}P7d(){return 2}Q7d(){return 2}wXf(){}AXf(){return 3}S7d(){return 2}onMenuOpen(){return 2}EXf(){}NXf(){return 2}OXf(){return 2}QXf(){return 3}d8d(){return 2}SXf(){return 2}e8d(){return 2}i8d(){return 2}ZXf(){}p8d(){return 2}jYf(){return 2}w8d(){return 2}x8d(){return 2}BYf(){return 3}IYf(){return 2}F8d(){return 2}G8d(){return 2}I8d(){return 2}J8d(){return 2}MYf(){return 3}K8d(){return 2}N8d(){return 2}P8d(){return 2}PYf(){return 2}I2c(){return 2}SYf(){return 2}TYf(){return 2}S8d(){return 2}UYf(){return 2}XYf(){return 3}X8d(){return 2}Y8d(){return 2}Z8d(){return 2}$8d(){return 2}e9d(){return 2}b9d(){return 2}static Vha(b){return b&&
-1!==b.indexOf("px")&&(b=parseInt(F.a.substring(b,0,b.indexOf("px"))),!isNaN(b))?b:0}static Gfi(b){if(!b||""===b)return-1;const h=F.a.eh(b);if(-1!==h.indexOf("pt")){if(b=parseFloat(F.a.substring(b,0,h.indexOf("pt"))),!isNaN(b))return b}else if(-1!==h.indexOf("px")&&(b=parseFloat(F.a.substring(b,0,h.indexOf("px"))),!isNaN(b)))return 3*b/4;return-1}static xci(b){b=Qj.Gfi(b);return-1===b?0:0>b?(t.ULS.sendTraceTag(508925786,307,50,"Negative margin in px or pt"),0):b}static Iem(b){return Qj.Gfi(b)}static dfi(b){return b&&
""!==b?Qj.Vha(b):null}static lE(b){let h=null,r=null,B=null,P=null;b&&b.jf&&(h=Qj.rR(b.jf,"id"),r=Qj.rR(b.jf,"lang"),B=b.jf.tagName,b.sEk&&(P=Object.assign(new Tq,{x:Qj.Vha(b.jf.style.left),y:Qj.Vha(b.jf.style.top),left:Qj.dfi(b.jf.style.left),top:Qj.dfi(b.jf.style.top)})),void 0===h&&(h=""),void 0===r&&(r=""));return new br.a(new Mo(h,B),b.LB,null,r,P)}static rR(b,h){return b[h]}}Object(m.a)(Qj,"AHtmlTranslator",null,[285]);class bj extends br.a{constructor(b,h,r,B=0,P=0,ca=null){super(ca?ca.f$:
null,ca?ca.LB:null,ca?ca.Kya:null,ca?ca.cultureName:null,ca?ca.YCa:null);this.width=B;this.height=P}}Object(m.a)(bj,"AugmentationSemanticArgs",br.a,[]);var Nn=c(1712);class Nw{constructor(){this.stop=this.color=null}}Object(m.a)(Nw,"ColorStopPair",null,[]);var dj=c(1996);class Qr{constructor(){this.direction=null;this.hJc=new ar.a}wni(){return!!this.direction&&0<this.direction.length}}Object(m.a)(Qr,"LinearGradient",null,[]);class GA{constructor(){this.wcc=!1}}Object(m.a)(GA,"HtmlTranslatorContext",
null,[]);var Ez=c(1870);class BC{constructor(b,h){this.spaceBefore=b;this.spaceAfter=h}}Object(m.a)(BC,"IndentationProperties",null,[]);var xp=c(1402);class fw extends br.a{constructor(b,h,r,B,P=null,ca=0,ra=null,Qa=null,tb=!1,Mb=!1,Zb=69905,jc=null){super(jc?jc.f$:null,jc?jc.LB:null,jc?jc.Kya:null,jc?jc.cultureName:null,jc?jc.YCa:null);this.colSpan=b;this.rowSpan=h;this.width=r;this.Wdc=Mb;this.height=B;this.P4a=tb;this.shadingColor=P;this.verticalAlignment=ca;this.ska=ra;this.mle=Qa;this.l8=Zb}}
Object(m.a)(fw,"TableCellSemanticArgs",br.a,[]);class vj extends br.a{constructor(b,h=null){super(h?h.f$:null,h?h.LB:null,h?h.Kya:null,h?h.cultureName:null,h?h.YCa:null);this.height=b}}Object(m.a)(vj,"TableRowSemanticArgs",br.a,[]);class Ow extends br.a{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb=null,Zb=-1,jc=null){super(jc?jc.f$:null,jc?jc.LB:null,jc?jc.Kya:null,jc?jc.cultureName:null,jc?jc.YCa:null);this.TGd=null;this.rowCount=b;this.fgb=h;this.width=r;if(P)for(this.TGd=Array(P.length),b=0;b<P.length;++b)this.TGd[b]=
P[b];this.EDf=ca;this.Qkg=Qa;this.TIm=ra;this.P4a=B;this.EXd=tb;this.styleId=Mb;this.tableLook=Zb}}Object(m.a)(Ow,"TableSemanticArgs",br.a,[]);var go=c(1417);let Gk;class Wk extends Qj{get pNm(){if(null!=this.ADg)var b=this.ADg;else{var h;v.AFrameworkApplication.oe("FontFamilyFix;FontFamilyFixCf");b=this.ADg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.FontFamilyFixIsEnabled",!1)}return b}constructor(b,h,r=new GA,B=null){super(b);this.settings=
h;this.context=r;this.p_c=B;this.Rwb=null;this.lak=kb.a.h6("none",1,"disc",3,"circle",4,"square",5,"1",7,"A",10,"a",8,"I",11,"i",9,"armenian",7,"decimal",7,"decimal-leading-zero",7,"georgian",7,"lower-alpha",8,"lower-greek",8,"lower-latin",8,"lower-roman",9,"upper-alpha",10,"upper-latin",10,"upper-roman",11);this.Dlo=new Set(["DIV","P"])}get GHi(){return this.lak}dci(b,h){var r;if((r=b.style?b.style.listStyleType:"")&&""!==r&&(r=this.GHi[F.a.eh(r)])||(r=Qj.rR(b,"type"))&&""!==r&&(r=this.GHi[r]))return r;
if((r=b.tagName.toLowerCase())&&("ol"===r||"ul"===r)&&(b=b.className))if("ul"===r)switch(b=Wk.fVd(b,"BulletListStyle"),b){case "BulletListStyle1":return 3;case "BulletListStyle2":return 4;case "BulletListStyle3":return 5}else if("ol"===r)switch(b=Wk.fVd(b,"NumberListStyle"),b){case "NumberListStyle1":return 7;case "NumberListStyle2":return 8;case "NumberListStyle3":return 9;case "NumberListStyle4":return 10;case "NumberListStyle5":return 11}return h}Xbi(b){let h=-1,r=b.tagName.toLowerCase();if("ol"===
r||"ul"===r){b=dc.a.Z9h(b,"li");if(!b)return h;r="li"}if("li"===r){h=(h=this.tQd(b,"data-aria-level",0))?h:-1;if(0<h)return h-1;if(b=dc.a.Z9h(b,"p"))return Wk.p3l(b)-1}return h}tQd(b,h,r){b=b.getAttribute(h);b=parseInt(b);return isNaN(b)||0>b?r:b}zqn(){this.Rwb.pop();this.$i.zya()}QSc(b,h){this.kv(P=>P.mea(0,0));const r=this.dci(b.jf,h?6:2);let B=1;h&&(B=this.tQd(b.jf,"start",1));h=!1;h=b.jf.getAttribute("data-pasteFromRc");(h=!!h&&"true"===h)&&b.jf.removeAttribute("data-pasteFromRc");(Z.a.S4||Z.a.Cj)&&
Wk.vGd(b.jf);b=new xp.a(r,B,Qj.lE(b),0,-1,h);this.Rwb.push(b);this.$i.Bya(b);this.YJ(Object(z.a)(this,this.zqn,"onListElementClose"));return 1}cfl(b,h,r){return(h=h.getAttribute(r))?b.jcf(h):!1}reset(){super.reset();this.Rwb=new lu}static get FXc(){if(null!=Wk.GDg)var b=Wk.GDg;else{var h;v.AFrameworkApplication.oe("ghdeg324;j91ib322");b=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isPastedHtmlRenderingInIframeEnabled",!1);b=Wk.GDg=b}return b}Slj(b,
h){var r,B,P,ca;let ra=!1;try{var Qa=h.getAttribute("xml:lang")||Qj.rR(h,"lang")}catch(Zb){Qa=null}Qa&&""!==Qa&&(ra=b.Sdg(Qa)||ra);(Qa=Qj.rR(h,"dir"))&&(ra=b.tlc(Qa)||ra);if(this.settings.Gso(this.context)&&h.getAttribute)for(Qa=0;Qa<Wk.Owj.length;Qa++)ra=this.cfl(b,h,Wk.Owj[Qa])||ra;Qa=h.style;var tb=0;go.a.ERa&&(tb=window.performance.now());const Mb=Wk.FXc?getComputedStyle(h):null;go.a.ERa&&(go.a.Jme+=window.performance.now()-tb,go.a.Z5d+=1);if(Qa){if(Qa.fontWeight){tb=F.a.ZA(Qa.fontWeight);const Zb=
parseInt(tb);isNaN(Zb)?"BOLD"===tb?ra=b.HL(!0)||ra:"NORMAL"===tb&&(ra=b.HL(!1)||ra):ra=600<=Zb?b.HL(!0)||ra:b.HL(!1)||ra}this.settings.wqj&&Qa.fontSize&&(tb=null!==(r=null===Mb||void 0===Mb?void 0:Mb.fontSize)&&void 0!==r?r:Qa.fontSize,r=Qj.Iem(tb),0<r&&(ra=b.Rge(Math.floor(2*r))||ra));(null===(B=v.AFrameworkApplication.K)||void 0===B?0:B.getBooleanFeatureGate("Microsoft.Office.WordOnline.isParagraphSpacingFixInPasteEnabled",!1))&&this.Dlo.has(h.tagName)&&(B=Qj.xci(null!==(P=null===Mb||void 0===Mb?
void 0:Mb.marginTop)&&void 0!==P?P:Qa.marginTop),P=Qj.xci(null!==(ca=null===Mb||void 0===Mb?void 0:Mb.marginBottom)&&void 0!==ca?ca:Qa.marginBottom),ra=b.mea(B,P)||ra);this.settings.Kso(this.context)&&(this.settings.Aqj&&h.getAttribute?(ca=h.getAttribute("data-indent"))&&0<ca.length&&(ca=xg.a.Qi(parseInt(ca),0)+"px",ra=b.Rhe(ca)||ra):Qa.textIndent&&(ra=b.Rhe(Qa.textIndent)||ra));this.settings.Fso(this.context)&&Qa.marginLeft&&(this.settings.Aqj&&h.getAttribute?(ca=h.getAttribute("data-margin"))&&
0<ca.length&&(ra=b.aka(Qa.marginLeft)||ra):"TABLE"!==h.tagName&&(ra=b.aka(Qa.marginLeft)||ra));if(this.settings.Iso(this.context)&&(ca=h.getAttribute("style"))&&""!==ca)for(ca=ca.split(";"),P=0;P<ca.length;P++)B=ca[P].trim(),B.startsWith("tab-stops")&&(ra=b.Leg(B.replace("tab-stops:",""))||ra);this.settings.Eso(this.context)&&Qa.lineHeight&&(ra=b.mD(Qa.lineHeight)||ra);this.settings.Bso&&(ca=Qa.textTransform?F.a.eh(Qa.textTransform):null,P=Qa.fontVariantCaps?F.a.eh(Qa.fontVariantCaps):null,B=Qa.fontVariant?
F.a.eh(Qa.fontVariant):null,"uppercase"===ca?ra=b.Y9c("uppercase")||ra:"small-caps"===P||B&&0<=B.indexOf("small-caps")?ra=b.Y9c("small-caps")||ra:this.settings.ZTk&&"none"===ca&&(ra=b.Y9c("none")||ra));this.settings.Jso(this.context)&&Qa.textAlign&&(ra=b.EQb(F.a.eh(Qa.textAlign))||ra);Qa.fontStyle&&(ca=F.a.ZA(Qa.fontStyle),"ITALIC"===ca||"OBLIQUE"===ca?ra=b.Vpb(!0)||ra:"NORMAL"===ca&&(ra=b.Vpb(!1)||ra));ca=Wk.Ihm(h);if(Qa.textDecoration||ca)P=F.a.eh(Qa.textDecoration||""),ca=F.a.eh(ca||""),h.parentNode&&
h.parentNode.tagName&&"a"===F.a.eh(h.parentNode.tagName)?(B=(h.querySelector(".TextRun")||h).className)&&-1<B.indexOf("Underlined")&&(ra=b.Q5(!0)||ra):Qa.Etp||Wk.isUnderline(P)||Wk.isUnderline(ca)?ra=b.Q5(!0)||ra:this.settings.Grj&&(ra=b.Q5(!1)||ra),Qa.Dtp||Wk.Pzi(P)||Wk.Pzi(ca)?ra=b.dka(!0)||ra:this.settings.Grj&&(ra=b.dka(!1)||ra);if(Qa.verticalAlign){ca=F.a.ZA(Qa.verticalAlign);P=this.sQn(ca);if("SUB"===ca||this.settings.zqj(this.context)&&h.className&&-1<h.className.indexOf("Subscript")||0>P&&
this.settings.drj)ra=b.OIa(!0)||ra;else if("SUPER"===ca||this.settings.zqj(this.context)&&h.className&&-1<h.className.indexOf("Superscript")||0<P&&this.settings.drj)ra=b.vra(!0)||ra;this.settings.wqj&&("SUB"===ca||"SUPER"===ca)&&h.getAttribute&&(ca=parseFloat(h.getAttribute("data-fontsize")),isNaN(ca)||(ra=b.Rge(Math.floor(2*ca))||ra))}ca=!1;v.AFrameworkApplication.K&&(ca=v.AFrameworkApplication.K.$("CopyAndPasteFontTelemetryIsEnabled"));this.settings.Dso&&Qa.fontFamily&&(this.settings.Mso&&h.getAttribute?
(P=h.getAttribute("data-usefontface"))&&"true"===P&&(ca&&t.ULS.sendTraceTag(524038490,307,50,"Customized fontface"),ra=this.Qlj(b,Qa.fontFamily,ra)):ra=this.Qlj(b,Qa.fontFamily,ra));P=null;this.settings.Cso&&Qa.color&&(P=dj.a.yva(Qa.color));B=!!P;this.settings.Lso(this.context)&&h.getAttribute&&(P=h.getAttribute("data-scheme-color"),P=null!==P?P:"",B=""!==P||!this.context.wcc||Wk.rWm(h));B&&(ra=b.Yv(P)||ra);this.settings.zso&&Qa.backgroundColor&&(h.tagName&&Wk.WHo.contains(F.a.ZA(h.tagName))||(ra=
b.Gza(dj.a.yva(Qa.backgroundColor))||ra));if(this.settings.Aso&&Qa.backgroundImage&&h.className&&-1<h.className.indexOf("Highlight")&&(Qa=Wk.vkm(Qa.backgroundImage))&&0<Qa.hJc.count){P=Qa.hJc.J(0).color;B=!0;for(r=0;r<Qa.hJc.count&&(B=B&&P===Qa.hJc.J(r).color,B);r++);B&&(ca&&t.ULS.sendTraceTag(524038491,307,50,"Paste text with highlight"),ra=b.Gza(dj.a.yva(P))||ra)}}this.settings.yqj(this.context)&&h.getAttribute&&(Qa=h.getAttribute("data-ccp-props"))&&(ra=b.K$(Qa)||ra);h.getAttribute&&((Qa=h.getAttribute("data-ccp-charstyle"))&&
this.settings.sqb&&(ra=b.wge(Qa)||ra),(h=h.getAttribute("data-ccp-parastyle"))&&this.settings.sqb&&(ra=b.yhe(h)||ra));return ra}Fuo(b){if(this.settings.Guo)for(b=b.parentNode;b&&b.tagName;){if(b.className&&Object.getType(b.className)===String&&-1<F.a.ZA(b.className).indexOf("MSOCOM"))return!0;if("DIV"===F.a.ZA(b.tagName))break;b=b.parentNode}return!1}Qlj(b,h,r){if(this.pNm){h=Wk.kNl(h);let P=!1,ca=0;if(!h)return r;for(var B of h){if(P=b.pUa(B,this.settings.lxj))break;ca++}1<h.length&&(P?t.ULS.sendTraceTag(508889217,
307,50,"Secondary font matched from font-family at : {0} out of {1}",ca+1,h.length):t.ULS.sendTraceTag(508889216,307,50,"Secondary fonts {0} available in font-family but no match found",h.length));return P||r}B=Wk.s$h(h);return b.pUa(B,this.settings.lxj)||r}sQn(b){let h=0;b&&b.length&&(b=parseInt(b),isNaN(b)||(h=b));return h}Jda(b,h){"\u200b"===b&&(b="\u00a0");h&&h.jf&&this.Fuo(h.jf)&&(b="");this.$i.Jda(b,Qj.lE(h))}F6d(b){const h=Qj.rR(b.jf,"href");return h&&""!==h?(this.$i.MSa(h,Qj.lE(b)),this.YJ(Object(z.a)(this.$i,
this.$i.LSa,"onAnchorEnd")),1):2}K6d(){return this.kv(b=>b.HL(!0))?1:2}N6d(){return this.kv(b=>b.ayf())?1:2}O6d(b){this.$i.jE(Qj.lE(b));this.YJ(Object(z.a)(this.$i,this.$i.AF,"onParagraphEnd"));return 1}P6d(b){this.$i.Ida(Qj.lE(b))}Q6d(b){this.$i.jE(Qj.lE(b));this.YJ(Object(z.a)(this.$i,this.$i.AF,"onParagraphEnd"));return 1}U6d(){return this.kv(b=>b.Vpb(!0))?1:2}R6d(b){this.kv(h=>h.EQb("center"));this.$i.jE(Qj.lE(b));this.YJ(Object(z.a)(this.$i,this.$i.AF,"onParagraphEnd"));return 1}V6d(){return this.kv(b=>
b.pUa("consolas"))?1:2}c7d(){return this.kv(b=>b.dka(!0))?1:2}b7d(b){return this.QSc(b,!1)}f7d(){return this.kv(b=>b.Vpb(!0))?1:2}g7d(b){return this.QSc(b,!1)}i7d(b){var h=b.jf.getAttribute("data-render-src");const r=b.jf.getAttribute("data-render-method");if(h&&""!==h&&r&&""!==r){const ra=b.jf.getAttribute("data-render-fallback");let Qa=0,tb=0;if(b.jf.currentStyle){var B=b.jf.currentStyle.width,P=b.jf.currentStyle.height;B&&-1!==B.indexOf("px")&&(B=parseInt(F.a.substring(B,0,B.indexOf("px"))),isNaN(B)||
(Qa=B));P&&-1!==P.indexOf("px")&&(P=parseInt(F.a.substring(P,0,P.indexOf("px"))),isNaN(P)||(tb=P))}b=new bj(h,r,ra,Qa,tb,Qj.lE(b));this.$i.k6a(b);return 2}(Z.a.S4||Z.a.Cj)&&(h=b.jf.className.match(RegExp("^SCX[0-9a-zA-Z]+$")))&&h.length&&Wk.vGd(b.jf);const ca=b.jf.getAttribute("align");this.kv(ra=>ra.EQb(ca));this.$i.jE(Qj.lE(b));this.YJ(Object(z.a)(this.$i,this.$i.AF,"onParagraphEnd"));return 1}j7d(b){this.$i.jE(Qj.lE(b));this.YJ(Object(z.a)(this.$i,this.$i.AF,"onParagraphEnd"));return 1}l7d(b){this.$i.jE(Qj.lE(b));
this.YJ(Object(z.a)(this.$i,this.$i.AF,"onParagraphEnd"));return 1}n7d(){return this.kv(b=>b.Vpb(!0))?1:2}v7d(b){return this.kv(h=>{var r=Wk.s$h(b.jf.getAttribute("face"));r=h.pUa(r);h=h.Yv(dj.a.yva(b.jf.getAttribute("color")));return r||h})?1:2}y7d(b){this.kv(h=>this.settings.sqb?h.Xpb(1):h.Zpb(1));this.$i.jE(Qj.lE(b));this.YJ(Object(z.a)(this.$i,this.$i.AF,"onParagraphEnd"));return 1}z7d(b){this.kv(h=>this.settings.sqb?h.Xpb(2):h.Zpb(2));this.$i.jE(Qj.lE(b));this.YJ(Object(z.a)(this.$i,this.$i.AF,
"onParagraphEnd"));return 1}A7d(b){this.kv(h=>this.settings.sqb?h.Xpb(3):h.Zpb(3));this.$i.jE(Qj.lE(b));this.YJ(Object(z.a)(this.$i,this.$i.AF,"onParagraphEnd"));return 1}B7d(b){this.kv(h=>this.settings.sqb?h.Xpb(4):h.Zpb(4));this.$i.jE(Qj.lE(b));this.YJ(Object(z.a)(this.$i,this.$i.AF,"onParagraphEnd"));return 1}C7d(b){this.kv(h=>this.settings.sqb?h.Xpb(5):h.Zpb(5));this.$i.jE(Qj.lE(b));this.YJ(Object(z.a)(this.$i,this.$i.AF,"onParagraphEnd"));return 1}D7d(b){this.kv(h=>this.settings.sqb?h.Xpb(6):
h.Zpb(6));this.$i.jE(Qj.lE(b));this.YJ(Object(z.a)(this.$i,this.$i.AF,"onParagraphEnd"));return 1}E7d(b){this.$i.Ida(Qj.lE(b))}I7d(b){var h=b.jf;const r=h.src,B=h.alt,P=h.Lmp,ca=h.getAttribute("data-external-content-url");let ra=0,Qa=0;h.style&&(ra=Qj.Vha(h.style.width),Qa=Qj.Vha(h.style.height));ra&&Qa||(ra=h.width,Qa=h.height);let tb=0,Mb=0;b.jf.currentStyle&&(ra||Qa||(ra=Qj.Vha(b.jf.currentStyle.width),Qa=Qj.Vha(b.jf.currentStyle.height)),tb=Qj.Vha(b.jf.currentStyle.maxWidth),Mb=Qj.Vha(b.jf.currentStyle.maxHeight));
let Zb=null;const jc=h.getAttribute(Gf.qKd);if(jc&&(t.ULS.sendTraceTag(524038492,307,50,"Chart paste from xlo"),v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("ChartsPasteFromXLOIsEnabled"))){const Gc=h.getAttribute(Gf.Gdf),Uc=h.getAttribute(Gf.Hdf),od=h.getAttribute(Gf.Edf),Od=h.getAttribute(Gf.Fdf),ze=h.getAttribute(Gf.lLc);h=h.getAttribute(Gf.Idf);Gc&&Od&&(Zb=new Nn.a(jc,Gc,Uc,od,Od,ze,h))}b=new Ez.a(r,B,ra,Qa,Qj.lE(b),tb,Mb,P,null,ca,Zb);this.$i.xya(b)}F7d(){return this.kv(b=>b.Vpb(!0))?
1:2}J7d(){return this.kv(b=>b.Q5(!0))?1:2}L7d(){return this.kv(b=>b.pUa("consolas"))?1:2}N7d(b){this.$i.jE(Qj.lE(b));this.YJ(Object(z.a)(this.$i,this.$i.AF,"onParagraphEnd"));return 1}P7d(b){this.$i.jE(Qj.lE(b));this.YJ(Object(z.a)(this.$i,this.$i.AF,"onParagraphEnd"));return 1}Q7d(b){let h;const r=this.dci(b.jf,0);let B=this.tQd(b.jf,"value",0);0<this.Rwb.count?h=this.Rwb.$Y():(h=new xp.a(2,1,Qj.lE(b)),B||(B=1));var P=Wk.B3l(b.jf,xp.a.HDj);3!==P&&(h.ks=P);P=h.listLevel;let ca=h.listId;this.settings.xqj?
(P=this.Xbi(b.jf),P=0>P&&0>h.listLevel&&0<this.Rwb.count?h.listLevel=this.Rwb.count-1:h.listLevel=0<=P?P:h.listLevel,this.p_c&&this.p_c.b<P&&(this.p_c.b=P)):0>P&&(P=h.listLevel=this.Xbi(b.jf));1>ca&&(ca=h.listId=this.tQd(b.jf,xp.a.f_c,0));b.jf.getAttribute(xp.a.M2d)&&(h.levelText=b.jf.getAttribute(xp.a.M2d));var ra=b.jf.getAttribute(xp.a.pLf);ra&&(h.font=ra);ra=!1;v.AFrameworkApplication.K&&(ra=v.AFrameworkApplication.K.$("FollowDestinationThemePasteIsEnabled"));if(ra){var Qa=b.jf.getAttribute("data-charcodes");
ra=[];if(Qa&&""!==Qa)if(-1<Qa.indexOf(",")){Qa=Qa.split(",");for(var tb=0;tb<Qa.length;tb++)ra.push(parseInt(Qa[tb]))}else ra.push(parseInt(Qa));if(ra&&0<ra.length){Qa=Array(ra.length);for(tb=0;tb<ra.length;tb++)Qa[tb]=ra[tb];h.C7e=Qa}(ra=b.jf.getAttribute("data-buAutoNum"))&&0<ra.length&&(h.buAutoNum=parseInt(ra))}(P=0<=P&&0<ca)&&Wk.vGd(b.jf);h.sFk(r,B,P);h.oLf=this.c3l(b.jf);this.$i.FHa(h.clone());this.YJ(Object(z.a)(this.$i,this.$i.Aya,"onListItemEnd"));return 1}c3l(b){var h=b.getAttribute(xp.a.pHi);
if(!h)return null;b=void 0;try{b=JSON.parse(h)}catch{t.ULS.sendTraceTag(524038493,307,15,"getListDefnPropsFromElement for CCP - Cannot parse list definition properties from element attribute.")}if(!b)return null;h=new fd.DictionaryPropertySet;for(const r in b)h.yoj(+r,b[r]);return h}onMenuOpen(b){return this.QSc(b,!1)}S7d(b){if(this.kv(h=>h.ilc(!0))){const h=b.jf.getAttribute("OuterHtml");this.$i.RSa(h,Qj.lE(b));this.YJ(Object(z.a)(this.$i,this.$i.i6a,"onMathEnd"))}return 1}d8d(b){return this.QSc(b,
!0)}e8d(b){this.$i.jE(Qj.lE(b));this.YJ(Object(z.a)(this.$i,this.$i.AF,"onParagraphEnd"));return 1}i8d(b){const h=b.jf.getAttribute("align");this.kv(B=>B.EQb(h));const r=b.jf.parentNode;r&&r.tagName.toLowerCase().startsWith("li")&&Wk.vGd(b.jf,Z.a.S4||Z.a.Cj);this.$i.jE(Qj.lE(b));this.YJ(Object(z.a)(this.$i,this.$i.AF,"onParagraphEnd"));return 1}p8d(){this.kv(b=>b.pUa("consolas"));this.$i.Snb();this.YJ(Object(z.a)(this.$i,this.$i.Rnb,"onPreFormattedTextEnd"));return 1}w8d(){return this.kv(b=>b.dka(!0))?
1:2}x8d(){return this.kv(b=>b.pUa("consolas"))?1:2}F8d(){return this.kv(b=>b.Xhg())?1:2}G8d(b){var h=b.jf.attributes.getNamedItem("style"),r="";h&&h.value&&(r=h.value);h=dj.a.jBn(r);if(0<h&&this.settings.QCm){for(r=0;r<h;r++)this.$i.Xnb(Qj.lE(b));return 3}return 2}I8d(){return this.kv(b=>b.dka(!0))?1:2}J8d(){return this.kv(b=>b.HL(!0))?1:2}K8d(){return this.kv(b=>b.OIa(!0))?1:2}N8d(){return this.kv(b=>b.vra(!0))?1:2}P8d(b){this.kv(Zb=>Zb.LC()&&Zb.l$f());dj.a.OVd(b.jf,this);const h=dj.a.xki(b.jf),
r=dj.a.v6h(b.jf),B=dj.a.CJ(b.jf),P=dj.a.mL(b.jf),ca=!parseInt(Qj.rR(b.jf,"border")),ra=dj.a.SVm(b.jf);let Qa=-1,tb="";var Mb=-1;b.jf.attributes.hasOwnProperty("style")&&-1!==(Mb=b.jf.attributes.getNamedItem("style").value.indexOf("mso-yfti-tbllook:"))?Qa=parseInt(b.jf.attributes.getNamedItem("style").value.substr(Mb+17)):b.jf.attributes.hasOwnProperty(Ap.a.rKd.toString())&&(Qa=parseInt(b.jf.attributes.getNamedItem(Ap.a.rKd.toString()).value));Mb=-1;b.jf.attributes.hasOwnProperty("class")&&-1!==(Mb=
b.jf.attributes.getNamedItem("class").value.indexOf("Mso"))?tb=b.jf.attributes.getNamedItem("class").value.substr(Mb).split(" ")[0]:b.jf.attributes.hasOwnProperty(Ap.a.mLc.toString())&&(tb=b.jf.attributes.getNamedItem(Ap.a.mLc.toString()).value);this.$i.b$(new Ow(0,0,h.value,h.fCi,null,ca,ra,r,new BC(B.value,P.value),tb,Qa,Qj.lE(b)));this.YJ(Object(z.a)(this.$i,this.$i.Z9,"onTableEnd"));v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordPasteTableCellMarginImprovementsSettings");
return 1}I2c(b){const h=dj.a.gai(b.jf),r=dj.a.xki(b.jf);if(!r.value&&r.j_d&&(v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.settings.j1i))return 3;let B=parseInt(Qj.rR(b.jf,"colSpan"));if(void 0===B||null===B||""===B+"")B=r.value?1:0;let P=parseInt(Qj.rR(b.jf,"rowSpan"));if(void 0===P||null===P||""===P+"")P=h.value?1:0;let ca=!1;b.jf.attributes.hasOwnProperty("style")&&(ca=-1!==b.jf.attributes.getNamedItem("style").value.indexOf("mso-cell-special:placeholder")||
-1!==b.jf.attributes.getNamedItem("style").value.indexOf("mso-cell-special: placeholder"));!ca&&b.jf.attributes.hasOwnProperty("class")&&(ca=-1!==b.jf.attributes.getNamedItem("class").value.indexOf("SkippedGhostCell"));let ra=69905;if(b.jf.attributes.hasOwnProperty(Ap.a.Ddf.toString())){var Qa=parseInt(b.jf.attributes.getNamedItem(Ap.a.Ddf.toString()).value);isNaN(Qa)||(ra=Qa)}Qa=dj.a.yva(b.jf.style.backgroundColor);const tb=dj.a.Akm(b.jf);this.kv(jc=>jc.mea(0,0));dj.a.OVd(b.jf,this);const Mb=dj.a.v6h(b.jf),
Zb=this.settings.VBn?dj.a.MQl(b.jf):null;b=new fw(B,P,r.value,h.value,Qa,tb,Mb,Zb,r.fCi,ca,ra,Qj.lE(b));this.$i.Y9(b);this.YJ(Object(z.a)(this.$i,this.$i.X9,"onTableCellEnd"));this.Qin();return 1}S8d(b){const h=this.I2c(b);if(3===h)return h;this.kv(r=>{const B=r.HL(!0);r=r.EQb("center");return B||r});dj.a.OVd(b.jf,this);return 1}X8d(b){dj.a.OVd(b.jf,this);const h=dj.a.gai(b.jf);if(h.j_d&&!h.value&&(v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),
this.settings.j1i))return 3;this.$i.u5(new vj(h.value,Qj.lE(b)));this.YJ(Object(z.a)(this.$i,this.$i.a$,"onTableRowEnd"));return 1}Y8d(){return this.kv(b=>b.pUa("consolas"))?1:2}Z8d(){return this.kv(b=>b.Q5(!0))?1:2}$8d(b){return this.QSc(b,!1)}b9d(){return 2}e9d(){return this.kv(b=>b.Q5(!0))?1:2}static MWl(b){if(!b)return null;b=b.split(",");1<b.length&&t.ULS.sendTraceTag(508889187,307,50,"Secondary fonts available in font-family");return b[0]}static iNl(b){return b?b.split(","):null}static SBj(b){if(!b)return null;
b=F.a.y8f(b.trim(),'"');return b=F.a.y8f(b,"'")}static s$h(b){if(!b)return null;b=Wk.MWl(b);return b=Wk.SBj(b)}static kNl(b){var h;if(!b)return null;b=null===(h=Wk.iNl(b))||void 0===h?void 0:h.map(r=>Wk.SBj(r));h=null===b||void 0===b?void 0:b.filter(r=>!!r);return null!==h&&void 0!==h?h:null}static aqh(b,h){h=h.trim();var r=h.match(RegExp("^-?[0-9]+deg$"));if(r&&0<r.length){if(b.wni())return!1;b.direction=h;return!0}if((r=h.match(RegExp("^to +(left|right|top|bottom|lefttop|leftbottom|righttop|rightbottom)$")))&&
0<r.length){if(b.wni())return!1;b.direction=h;return!0}var B=(r=h.match(RegExp("^rgb\\(.*\\)")))&&0<r.length?h.indexOf(")")+1:h.indexOf(" ");r=-1===B?h:dj.a.yva(h.substr(0,B).trim());if(!r||""===r)return!1;h=-1===B?"":h.substr(B).trim();B=new Nw;B.color=r;B.stop=h;b.hJc.add(B);return!0}static vkm(b){try{if(!b)return null;b=b.trim();if(!b.startsWith("linear-gradient(")||!b.endsWith(")"))return null;let h=b.substr(16);h=h.substr(0,h.lastIndexOf(")"));const r=new Qr;for(;0<h.trim().length;){let B=h.indexOf(",");
const P=h.indexOf("(");if(0<P&&P<B){const ca=h.indexOf(")");if(ca<P)return null;B=h.indexOf(",",ca)}if(-1===B){if(!Wk.aqh(r,h))return null;h=""}else{const ca=h.substr(0,B);h=h.substr(B+1);if(!Wk.aqh(r,ca))return null}}return r}catch(h){return null}}static fVd(b,h){b=b.split(" ");if(0<b.length)for(let r=0;r<b.length;r++)if(0<=b[r].indexOf(h))return b[r];return""}static vGd(b,h=!1){b&&3!==b.nodeType&&(b.style.margin="",h&&Wk.VEh(b,h))}static VEh(b,h){if(b)for(b=b.firstChild;b;)3!==b.nodeType&&(b.style&&
(b.style.margin=""),h&&Wk.VEh(b,h)),b=b.nextSibling}static p3l(b){if("p"!==b.tagName.toLowerCase())return-1;if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf("mso-list")){b=b.split(";");for(let r=0;r<b.length;r++){var h=b[r].split(":");if(2===h.length&&"mso-list"===h[0].trim()&&(h=h[1].trim().split(" "),3===h.length))return Number.parseInvariant(h[1].substr(5))}}return-1}static B3l(b,h){if(!b)return 3;switch(b.getAttribute(h)){case "default":return 0;case "numbered":return 1;case "bullet":return 2;
default:return 3}}static rWm(b){return!(void 0===b.className||null===b.className)&&b.className.startsWith("TextRun")}static Ihm(b){b=b.style.textDecorationLine;return void 0===b||null===b?null:b}static Pzi(b){return 0<=b.indexOf("line-through")}static isUnderline(b){return 0<=b.indexOf("underline")}}Wk.WHo=(Gk=new mb.a,Gk.add("TABLE"),Gk.add("THEAD"),Gk.add("TBODY"),Gk.add("TFOOT"),Gk.add("TR"),Gk.add("TH"),Gk.add("TD"),Gk);Wk.Owj=["data-ccp-charstyle-defn","data-ccp-parastyle-defn","data-ccp-charstyle-linked-defn",
"data-ccp-parastyle-linked-defn"];Object(m.a)(Wk,"DefaultHtmlTranslator",Qj,[]);var Dq=c(1573);class Gm{constructor(b=null){this.K3=b||Dq.a.Cki("");this.w8g=Number.parseInvariant((new Date).format("HHmmss"))}get Jc(){return this.K3}process(b,h){if(b&&b.querySelectorAll){const ca=b.querySelectorAll("p");if(ca&&0<ca.length){for(var r=0,B=!1,P=ca[0].parentNode;5>r&&P&&P!==b;){r++;const ra=P.id.toLowerCase();if(ra&&ra.length&&-1!==ra.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(P,"WACEditing")&&
Sys.UI.DomElement.containsCssClass(P,"EditingSurfaceBody")){B=!0;break}P=P.parentNode}if(B&&P!==b){r=b.firstChild;for(B=!1;0<P.children.length&&P.children[0]!==r;)b.insertBefore(P.children[0],r),B=!0;if(B)for(;r;)P=r.nextSibling,b.removeChild(r),r=P}b=new qv.a(h,Object(z.a)(this,this.jJn,"processNodesDiscovery"),new FA(ca));b.Rl("Word Converter Operation");b.Qh=!h||h.Qh;b.run()}}}jJn(b,h){const r=h.nodes[h.YOa];var B=Gm.k3l(r);if(B){let ca=B.bqe.replace(RegExp("level[0-9]"),"").trim();ca=ca&&ca.length?
ca:B.bqe;let ra=h.lists[ca];ra||(ra=new Kx,ra.Coc=this.w8g++);let Qa=ra.efc[B.level-1];Qa||(Qa=new Fy,Qa.level=B.level);var P=r.parentNode;if(P&&"li"===P.tagName.toLowerCase()){if(P=P.parentNode)!(P=P.tagName.toUpperCase())||"OL"!==P&&"UL"!==P||(Qa.tagName=P)}else Qa.Umb=Gm.M9h(r,5),Qa.Umb&&Qa.Umb.length||(Qa.Umb=Gm.gvf(r,5)),Qa.ignore=!Qa.Umb||!Qa.Umb.length,Qa.tagName=Gm.L9h(Qa.Umb),"UL"===Qa.tagName&&(Qa.font=this.v$h(r,5));B.Coc=ra.Coc;Qa.xjn++;Qa.ignore||"li"===r.parentNode.tagName.toLowerCase()||
(P=(P=Gm.gvf(r,5))?P:Qa.Umb)&&P.length&&(B.TZh=P,(P=Gm.Yko(r,P,Qa.listStyle,B.level-1))&&P.length&&(Qa.listStyle=P));h.xmb[h.xmb.length]=B;Qa.xmb.contains(B)||Qa.xmb.add(B);if(void 0===ra.efc[B.level-1]||null===ra.efc[B.level-1]||ra.efc[B.level-1]!==Qa)ra.efc[B.level-1]=Qa;h.lists[ca]&&h.lists[ca]===ra||(h.lists[ca]=ra);h.$Fi=r}else if((B=h.$Fi)&&Gm.lbm(r)===B&&r.tagName===B.tagName&&r.className===B.className){B.appendChild(B.ownerDocument.createElement("BR"));for(B.appendChild(B.ownerDocument.createElement("BR"));r.firstChild;)B.appendChild(r.firstChild);
r.parentNode.removeChild(r)}h.YOa++;if(h.nodes.length<=h.YOa){if(!h.xmb.length)return!1;h.YOa=0;b.pi(Object(z.a)(this,this.iJn,"processNodeConvert"))}return!0}iJn(b,h){b=h.xmb[h.YOa];var r=b.Rxn,B=b.bqe.replace(RegExp("level[0-9]"),"").trim();B=B&&B.length?B:b.bqe;B=h.lists[B];var P=B.efc[b.level-1],ca=r.parentNode.tagName.toLowerCase();if(!P.ignore&&r.parentNode&&"li"!==ca){if(ca=Gm.Wbl(r,P)){Gm.GEh(r,5);const ra=r.ownerDocument.createElement("LI");ra.setAttribute("data-aria-level",String.format("{0}",
b.level));ra.setAttribute(xp.a.f_c,String.format("{0}",B.Coc));"UL"===P.tagName&&(ra.setAttribute(xp.a.M2d,String.format("{0}",b.TZh)),ra.setAttribute(xp.a.pLf,String.format("{0}",P.font)));for(;r.firstChild;)ra.appendChild(r.firstChild);ca.appendChild(ra);r.parentNode.removeChild(r);"UL"===P.tagName?this.Jc.b++:this.Jc.c++}}else"li"===ca&&(P=P.tagName,r=r.parentNode,b.Whc&&(b=r.parentNode)&&b.tagName.toUpperCase()===P&&b.setAttribute("data-pasteFromRc","true"),r.setAttribute(xp.a.f_c,String.format("{0}",
B.Coc)),"UL"===P?this.Jc.b++:this.Jc.c++);h.YOa++;return h.YOa<h.xmb.length}v$h(b,h){let r=null;for(let B=0;!r&&B<b.childNodes.length;B++){const P=b.childNodes[B];r=Gm.gZl(P);!r&&1===P.nodeType&&1<h&&(r=this.v$h(P,h-1))}return r}static Wbl(b,h){b=Gm.Vbl(b,h.tagName);return Gm.t7k(b,h)}static t7k(b,h){if(h.tagName!==b.tagName){for(h=b.ownerDocument.createElement(h.tagName);b.firstChild;)h.appendChild(b.firstChild);b.parentNode.insertBefore(h,b);b.parentNode.removeChild(b);b=h}return b}static Vbl(b,
h){h=b.ownerDocument.createElement(h?h:"UL");var r=b.getAttribute("start");r&&0<r.length&&(h.setAttribute("start",r),b.removeAttribute("start"));(r=b.className)&&0<r.length&&(r="OL"===h.tagName?Wk.fVd(r,"NumberListStyle"):Wk.fVd(r,"BulletListStyle"),0<r.length&&(Sys.UI.DomElement.addCssClass(h,r),Sys.UI.DomElement.removeCssClass(b,r)));b.parentNode.insertBefore(h,b);return h}static GEh(b,h){for(let r=0;r<b.childNodes.length;r++){const B=b.childNodes[r];1===B.nodeType&&1<h&&Gm.GEh(B,h-1);if(Gm.fMm(B)||
Gm.$yi(B))b.removeChild(B),r--}}static k3l(b){if(1===b.nodeType){var h=Gm.bvf(b,"mso-list");if(h&&0<h.length)try{var r=h.split(" ");if(3===r.length){const B=Number.parseInvariant(r[1].substr(5)),P=new Ey(B,h,b);P.Whc=!0;return P}}catch(B){}else if((r=b.parentNode)&&"li"===r.tagName.toLocaleLowerCase()&&(h=r.getAttribute("data-"+Se.a.IDd),r=r.getAttribute(xp.a.f_c),h&&r&&0<h.length&&0<r.length))return b=new Ey(Number.parseInvariant(h),r+" level"+h,b),b.Whc=!1,b}return null}static Yko(b,h,r,B){if("p"===
b.tagName.toLowerCase()&&h&&h.length){if("UL"===Gm.L9h(h))return r=Gm.cQl(h),Sys.UI.DomElement.addCssClass(b,r),r;var P=h.match(RegExp("^[0-9]+"));return P&&P.length?(r="NumberListStyle1",Sys.UI.DomElement.addCssClass(b,r),b.setAttribute("start",P[0]),r):(P=h.match(RegExp("^[a-zA-Z]+")))&&P.length&&(P=P[0],B=(h=P.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&h.length?Gm.rcm(r,B):1,1!==B&&((r=Gm.vId(b,P,RegExp("^[ivxlcdm]+"),F.a.WJh,"NumberListStyle3"))||(r=Gm.vId(b,P,RegExp("^[IVXLCDM]+"),F.a.WJh,"NumberListStyle5")))||
B&&((r=Gm.vId(b,P,RegExp("^[a-z]+"),F.a.UJh,"NumberListStyle2"))||(r=Gm.vId(b,P,RegExp("^[A-Z]+"),F.a.UJh,"NumberListStyle4"))))?r:"NumberListStyle1"}return null}static cQl(b){switch(b){case "o":return"BulletListStyle2";case "\u00a7":return"BulletListStyle3";default:return"BulletListStyle1"}}static rcm(b,h){b&&b.length||(b="");switch(b){case "NumberListStyle2":case "NumberListStyle4":b=1;break;case "NumberListStyle3":case "NumberListStyle5":b=0;break;default:b=-1}if(0>b)switch(h%3){case 0:b=0;break;
case 1:b=1;break;case 2:b=0;break;default:b=0}return b}static vId(b,h,r,B,P){return(h=h.match(r))&&h.length?(B=B(h[0]),B=1>B?1:B,Sys.UI.DomElement.addCssClass(b,P),b.setAttribute("start",B+""),P):null}static L9h(b){return Gm.bJm(b)?"UL":"OL"}static bJm(b){return!b||"\u00a7"===b||"\u00b7"===b||"o"===b||"-"===b||"\u00d8"===b||"v"===b||"\u00fc"===b||"\u2666"===b||"\u00a8"===b}static gvf(b,h){let r=null;var B;let P,ca;for(let ra=-1;!r&&ra<b.childNodes.length;ra++){const Qa=-1===ra?b:b.childNodes[ra];
if(Qa)if((B=Qa.innerHTML)&&0<B.length){if(P=B.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=P&&(ca=B.indexOf("\x3c!--[endif]--\x3e"),0<=ca)){B=B.substring(P,ca+14);Qa.innerHTML=Qa.innerHTML.replace(B,"");if(B.length){b=b.ownerDocument.createElement("span");b.innerHTML=B;r=b.innerText.trim();break}r&&r.length||(r="o")}}else 0<=ra&&1===Qa.nodeType&&1<h&&(r=Gm.gvf(Qa,h-1))}return r}static gZl(b){let h=null;1===b.nodeType&&((h=Gm.u$h(b,"font-family"))||(h=Gm.u$h(b,"mso-ascii-font-family")));return h}static u$h(b,
h){return(b=Gm.bvf(b,h))&&0<b.length?b.trim():null}static M9h(b,h){let r=null;for(let B=0;!r&&B<b.childNodes.length;B++){const P=b.childNodes[B];Gm.$yi(P)?(r="string"===typeof P.innerText?P.innerText.trim():P.textContent.trim(),r.length||(r="o"),P.parentNode.removeChild(P)):1===P.nodeType&&1<h&&(r=Gm.M9h(P,h-1))}return r}static $yi(b){return 1===b.nodeType&&(b=Gm.bvf(b,"mso-list"))&&0<b.length&&"ignore"===b.trim().toLowerCase()?!0:!1}static fMm(b){return 1===b.nodeType&&!b.firstChild&&"SPAN"===b.tagName.toUpperCase()}static bvf(b,
h){if((b=b.getAttribute("style"))&&0<b.length&&-1!==b.indexOf(h)){b=b.split(";");for(let r=0;r<b.length;r++){const B=b[r].split(":");if(2===B.length&&B[0].trim()===h)return B[1].trim()}}return null}static lbm(b){do b=b.previousSibling;while(b&&Gm.Sxi(b));return b}static Sxi(b){return b?3===b.nodeType?(b=b.nodeValue,b=b.replace(Gm.eak,""),!b.trim().length):1!==b.nodeType||b.firstChild!==b.lastChild||"SPAN"!==b.tagName&&"FONT"!==b.tagName?!1:Gm.Sxi(b.firstChild):!0}}Gm.eak=RegExp("[\n|\r]","gi");Object(m.a)(Gm,
"WacAndRichClientWordConverter",null,[241]);class su{constructor(){}create(b=null){return new Gm(b)}}Object(m.a)(su,"Box4WordConverterFactory",null,[695]);var Kz=c(1793);class Oy{constructor(b,h,r,B,P){this.sUg=0;this.i4o=ca=>{let ra=!0;const Qa=this.cga.mxl;null!=Qa?(ca.Bqa=Qa,ra=!1):Date.now()-this.sUg>this.fwe&&(t.ULS.sendTraceTag(18354843,307,50,null),this.Ad.Yb(le.a.moa,{["Reason"]:ae.a.h_i}),ra=ca.Bqa=!1);return ra};this.Ad=b;this.Re=h;this.fwe=P;this.cga=r;this.xNa=B}fXk(b,h,r){t.ULS.sendTraceTag(9037318,
307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",h,r,this.Re.qG);b.Qh&&this.Re.Fr&&window.chrome&&t.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",h);this.cga.wNc(!!(h&16));this.xNa.create(b,this.i4o,null).Rl("ClipboardPreProcess");this.sUg=Date.now()}W6n(){this.cga.reset()}}Object(m.a)(Oy,"ClipboardOperationClipboardAccessHelper",null,[693]);var ao=c(343);class Pw{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc,
Uc,od,Od){this.QXa=null;this.ga=b;this.Ad=h;this.iA=r;this.rh=B;this.hb=P;this.cga=ca;this.gb=ra;this.Fe=Qa;this.Wn=tb;this.Yc=Mb;this.Scb=Zb;this.mQe=jc;this.NE=Gc;this.lk=od;this.OXb=Uc?Uc.$("ImageDataURLSkippedForSafari12IsEnabled"):!1;this.zpd=Uc?Uc.$("PasteKeepSourceFontSizeFixIsEnabled"):!1;this.rd=Od;this.rg=Bi.a.getInstance(ao.a.i0a)}get Pf(){return this.rh}get Ic(){return this.Ad}get mWc(){if(null==this.QXa)if(this.rd)if(this.rd.pq.isCompleted)this.QXa=this.rd.isFeatureEnabled(3);else return!1;
else this.QXa=!1;return this.QXa}a4o(b){b.GN();return!0}zKh(b,h){b=h.Tw;t.ULS.shipAssertTag(18130960,307,!!(b&16));if(b&256){let B=!1,P;Z.a.Rxa&&v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings");this.mWc&&h.ke&&h.ke.xh&&(B=this.lk.dph(h.ke.xh.editingElement));P=this.lk.Dyf(h.ke.xh.editingElement,!1);var r=h.ke.xh.editingElement;this.lk.eDf(r,!1,1);this.OXb&&Z.a.Rxa?(r=h.ke.xh.editingElement,this.lk.A9f(r,"data-src","data-srcurl"),b=this.cga.copy(),
this.lk.A9f(r,"data-srcurl","data-src")):this.zpd&&h.ke&&h.ke.xh?(r=this.lk.t7e(h.ke.xh.editingElement,h.ke.uB,!0),b=this.cga.copy(),r&&this.lk.t7e(h.ke.xh.editingElement,h.ke.uB,!1)):(this.lk.zbj(h.ke.xh.editingElement),b=this.cga.copy());this.mWc&&B&&this.lk.Q0n(h.ke.xh.editingElement);P&&this.lk.Dyf(h.ke.xh.editingElement,!0);r=h.ke.xh.editingElement;this.lk.eDf(r,!1,0);if(!b)return t.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),b=new Map,b.set("ErrorLevel","info"),this.rg.logKpiFailure({kpiName:ao.a.CFd,
errorName:"SystemClipboardCopyFailed",optionalProperties:{additionalValues:{extendedProperties:b}}}),this.Ic.Yb(le.a.MEb,{["Reason"]:ae.a.Mkg}),h.cS&&h.cS.fail("SystemClipboard did not copy",!1),h.failed=!0,!1}return!0}uaf(b,h){const r=h.ke;t.ULS.shipAssertTag(18130961,307,!!(h.Tw&16));h.Fzo?this.iA.cFh():this.iA.PId(r,b);return!0}xRh(b,h){var r=h.context,B=h.vd;const P=h.x$;var ca=!1;b=this.hb.ib.lb.Tc;if(this.gb.vm(b)||this.Fe.Lk(b)){const ra=this.Yc.Rf(b.node),Qa=ra.qd();t.ULS.shipAssertTag(18130962,
307,Qa);this.Wn.Yd(ra);this.Scb.plb(ra)&&(ca=!0)}B=h.Tw&64?new fd.DictionaryPropertySet:B||new fd.DictionaryPropertySet;B.setValue(Yc.a.qMc,!1);r=this.ga.Nf(r,Nb.a.PH,2,!0,P,B);8===r&&(t.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.Ic.Yb(le.a.moa,{["Reason"]:ae.a.wRh}),h.cS&&h.cS.fail("DeleteKey failed",!1),this.rg.logKpiFailure({kpiName:ao.a.h7e,errorName:"DeleteForCutFailed"}),h.failed=!0);32===r&&this.rg.logKpiSuccess({kpiName:ao.a.h7e});32===r&&ca&&(h=this.hb.ib.lb,this.Fe.Pl(h)&&
h.Pa.node===b.node&&!this.gb.textLength(h.Pa.node)&&(h=this.Yc.Rf(h.Pa.node),b=this.Fe.zu(h),t.ULS.shipAssertTag(18130964,307,b),this.Wn.Yd(h),this.Scb.ZZd(h)||(b=this.mQe.create(),b.kd(h),this.Wn.h1(b,!1,!1),ca=this.Wn.Ee(b),this.gb.Xb(ca)&&(this.Wn.Yd(b),this.Pf.merge(b,h,!1,!1),this.hb.Ac(this.NE.ne(ca,this.gb.textLength(ca)))))));return!0}}Object(m.a)(Pw,"ClipboardOperationCutCopy",null,[715]);class Lx{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc,Uc,od,Od){this.ga=b;this.Ad=h;this.iA=r;this.cga=
ca;this.hb=P;this.rh=B;this.gb=ra;this.Fe=Qa;this.Wn=tb;this.Yc=Mb;this.Scb=Zb;this.mQe=jc;this.NE=Gc;this.Ca=Uc;this.lk=od;this.rd=Od}create(){return new Pw(this.ga,this.Ad,this.iA,this.rh,this.hb,this.cga,this.gb,this.Fe,this.Wn,this.Yc,this.Scb,this.mQe,this.NE,this.Ca,this.lk,this.rd)}}Object(m.a)(Lx,"Factory",null,[692]);var Mx=c(1710),zm=c(57);class Zp{constructor(b,h){this.Usc=null;this.e8k=(r,B)=>{let P;if(zm.a.nda){if(!B.vd)return!1;P=B.vd.tSc;if(!P)return!1}else{if(!Object(Ib.a)(96,B.vd))return!1;
const Qa=Object(Ra.a)(96,B.vd);if(!Qa.hasProperty(Yc.a.tSc))return!1;P=Qa.getValue(Yc.a.tSc)}const ca=B.ke,ra=ca.mb;this.iA.$Ij();ra.JPb(()=>{ra.Ac(P,void 0,!0);this.iA.PId(ca,r)},!0);return!0};this.iA=b;this.JZ=h;this.EI=0}process(b,h){this.EI||(this.Usc=[this.e8k,Object(z.a)(this.JZ,this.JZ.OBn,"pasteGlossaryPlaceholder")],zm.a.nda&&this.Usc.push(Object(z.a)(this.JZ,this.JZ.Deg,"setSelectionAfterPaste")));let r=!0;this.EI<this.Usc.length&&(r=this.Usc[this.EI++](b,h));return r?this.EI<this.Usc.length:
!1}}Object(m.a)(Zp,"ClipboardOperationContentControlShowPlaceholderProcessor",null,[741]);class Lu{constructor(b){this.$tb=null;this.D2=b;this.EI=-1}process(b,h){-1===this.EI&&(this.Mhl(b,h),this.EI=0);let r=!1;this.EI<this.$tb.length&&(r=this.$tb[this.EI++](b,h));return r?this.EI<this.$tb.length:!1}Mhl(b,h){Z.a.U4||h.Tw&512?(this.$tb=[Object(z.a)(this.D2,this.D2.uaf,"copyInternal")],t.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):!b.Qh&&h.Tw&
256?(this.$tb=[Object(z.a)(this.D2,this.D2.a4o,"waitBeforeCopy"),Object(z.a)(this.D2,this.D2.zKh,"copyExternal"),Object(z.a)(this.D2,this.D2.uaf,"copyInternal")],t.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this.$tb=[Object(z.a)(this.D2,this.D2.zKh,"copyExternal"),Object(z.a)(this.D2,this.D2.uaf,"copyInternal")],t.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));
h.Tw&32&&(b=Object(z.a)(this.D2,this.D2.xRh,"deleteForCut"),this.$tb.push(b),t.ULS.sendTraceTag(18158337,307,50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));ao.a.G4m(h)}}Object(m.a)(Lu,"ClipboardOperationCutCopyProcessor",null,[738]);class Eq{constructor(b,h,r,B){this.Qrd=null;this.h8k=(P,ca)=>{ca=ca.ke;this.iA.Q0o();this.iA.PId(ca,P);return!0};this.T0c=(P,ca)=>{ca=new Rg.Selection([ca.vd],!0);this.hb.Ac(ca,P);return!0};this.iA=b;this.hb=h;this.D2=r;this.JZ=B;this.EI=
0}process(b,h){this.EI||(this.Qrd=[this.h8k,Object(z.a)(this.D2,this.D2.xRh,"deleteForCut"),this.T0c,Object(z.a)(this.JZ,this.JZ.o1i,"pasteInternal"),Object(z.a)(this.JZ,this.JZ.Deg,"setSelectionAfterPaste")]);let r=!0;this.EI<this.Qrd.length&&(r=this.Qrd[this.EI++](b,h));return r?this.EI<this.Qrd.length:!1}}Object(m.a)(Eq,"ClipboardOperationMoveProcessor",null,[714]);var nq=c(1709);class Xj{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc,Uc,od,Od,ze,de){this.iA=b;this.ga=h;this.ksc=r;this.Ad=B;this.Fe=
P;this.Re=ca;this.Lc=ra;this.$hd=Qa;this.gZj=tb;this.sVb=Mb;this.twe=Zb;this.Xrc=jc;this.xNa=Gc;this.HD=Uc;this.Vd=od;this.Qm=Od;this.i_=ze;this.ega=de}create(b,h,r,B,P,ca,ra,Qa,tb=!0){const Mb=this.$hd.create(B,Object(Ra.a)(96,Qa));var Zb=this.gZj.create();const jc=new Zp(this.iA,Mb),Gc=new Eq(this.iA,Bh.a.instance,Zb,Mb);Zb=new Lu(Zb);B=new nq.a(v.AFrameworkApplication.K,pu.a.instance,B,Nh.a.instance,Mb,this.sVb);return new Mx.a(b,h,r,P,ca,ra,Qa,this.ksc,this.ga,this.Ad,this.Fe,this.Re,this.Lc,
jc,Gc,Zb,B,this.sVb,this.twe,this.Xrc,this.xNa,this.HD,this.Vd,this.Qm,this.i_,this.ega,v.AFrameworkApplication.Tgg(),tb)}}Object(m.a)(Xj,"Factory",null,[691]);var Gy=c(261);class oq{constructor(b,h){this.xHb=b.irf(h);this.Caf=b.bUl(h);this.oCb=b.Wof(h);this.tfb=b.wof(h)}static mF(b){return oq.Xr(b)}static Xr(b){return new oq(Qx.a.instance,b)}}Object(m.a)(oq,"CpUsageHelper",null,[]);class Fz{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc){this.y3=!1;this.Ad=b;this.iA=h;this.YAc=r;this.uua=B;this.hb=P;
this.ga=ca;this.bEe=ra;this.ZWe=tb;this.gOe=Qa;this.Ize=Mb;this.rwe=Zb;this.Vd=jc;this.rg=Bi.a.getInstance(ao.a.i0a);this.y3=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("ShouldLogCcpExtendedHealthKpis")}get ug(){return this.ZWe.value}get $ra(){return this.uua}get Ic(){return this.Ad}get hTa(){return this.gOe.hTa}paste(b,h){const r=this.Vd.Q_a();try{const B=h.ke,P=h.Tw;this.hb&&this.hb.ib&&this.hb.ib.lb&&Gy.TableBorderSelectionCache.Mpo(this.hb.ib.lb.Pv||this.hb.ib.lb.Qlb);qn.a.Gno(this.hb);
t.ULS.shipAssertTag(18131010,307,!!(P&1));Object(Ib.a)(96,h.vd)&&h.vd.setValue(lh.a.iha,B.xh.editingElement.clientWidth);this.rwe.FQo(b,h);let ca;if(!({jId:ca}=this.bEe.value.xCj()).returnValue)return this.E_c(h,"HTML import strategy failed",!1),this.y3?this.rg.logKpiFailure({kpiName:ao.a.sOa,errorName:"HtmlImportStrategyFailed",optionalVeto:{name:ao.a.uob,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}):va.Health.instance.recordQosError("HtmlImportStrategyFailed",[ao.a.uob],
!1,!0,!0,!1,null),!1;this.ug.tF();let ra=!0,Qa=null;const tb=this.Ize.create(ca),Mb=h.XIj;if(!B||!B.mb)return this.E_c(h,"Fail to set selection.",!1),this.y3?this.rg.logKpiFailure({kpiName:ao.a.sOa,errorName:"SetSelectionFailed",optionalVeto:{name:ao.a.uob,isIntentional:!1,isInternal:!0,alertOnPillar:!0,isSessionEndingError:!1}}):va.Health.instance.recordQosError("SetSelectionFailed",[ao.a.uob],!1,!0,!0,!1,null),!1;B.mb.JPb(()=>{Mb&&2===this.ga.processAction(Nb.a.Qna,2)?ra=!1:(Qa=Mb?this.hb&&this.hb.ib&&
this.hb.ib.lb?this.hb.ib.lb.Pa:null:h.vd)?(t.ULS.shipAssertTag(18158338,307,xe.SelectionEditor.Ze(Qa)),this.aLi(Qa,"paste")):t.ULS.sendTraceTag(591958036,307,15,"ipContext is null. useSelection: {0}; ",Mb)},this.gOe.sBi);if(!ra)return this.E_c(h,"fail to deleteForReplace.",!0),!1;if(!Qa)return this.E_c(h,"null ipContext after RunAgainstSelectionCollection.",!0),!1;if(!Qa.node||!Qa.node.isConnected)return this.E_c(h,"node is null or not connected in ip context.",!0),!1;B.xe.disable(!0,25);tb.restore();
this.YAc.IBn(ca,Qa,b);return!0}finally{r&&r.dispose()}}E_c(b,h,r){b.failed=!0;b.cS&&b.cS.fail(h,r)}OBn(b,h){var r,B;let P;if(zm.a.nda){P=h.vd;var ca=P.vVd}else ca=Object(Ra.a)(96,h.vd).getValue(Yc.a.vVd);t.ULS.shipAssertTag(20492440,307,xe.SelectionEditor.Ze(ca));if(!this.gEh(ca,h))return!1;this.ug.tF();const ra=(new Il.a).Pc(15);ra.Db(this.iA.xka);const Qa=zm.a.nda?this.hb.ib.lb:null;this.YAc.jui(ca,b);zm.a.nda&&(b=null!==(B=null===(r=P.placeholderText)||void 0===r?void 0:r.length)&&void 0!==B?B:
0,r=h.WEa,ca=Qa&&xe.SelectionEditor.Ze(Qa.Pa)&&r&&xe.SelectionEditor.Ze(r.Pa)&&Qa.Pa.node===r.Pa.node&&Qa.Pa.cpBegin>ca.cpBegin?og.SelectionFactory.ne(Qa.Pa.node,Qa.Pa.cpBegin+b):Qa,h.WEa=ca);this.iA.cFh();ra.dispose();return!0}o1i(b,h){const r=this.hb.ib.lb.Pa;if(!this.gEh(r,h))return!1;this.ug.tF();this.ga.processAction(Nb.a.Qna,2);this.aLi(r,"intPaste");this.YAc.jui(r,b);return!0}gEh(b,h){if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("AbortClipboardOperationForInvalidIpContext")){if(!b||
!b.isValid)return t.ULS.sendTraceTag(595142426,307,15,"Invalid ip context. IsTouch: {0}",!!h&&h.HYc),h.cS&&(h.cS.fail("Invalid ipContext before InternalPasteAtIp",!0),h.failed=!0),h=new Map,h.set("ErrorLevel","warning"),this.rg.logKpiFailure({kpiName:ao.a.sOa,errorName:"InvalidIpContextBeforeInternalPasteAtIp",optionalProperties:{additionalValues:{extendedProperties:h}}}),!1;if(!xe.SelectionEditor.Ze(b))return t.ULS.sendTraceTag(587843167,307,15,"Ip context is not insertion point. IsTouch: {0}; contextId: {1}; ipContext.Node: {2}; ipContext.Node.Anchor: {3};",
!!h&&h.HYc,b.contextId,!!b.node,!!b.node&&!!b.node.anchor),b=new Map,b.set("ErrorLevel","warning"),this.rg.logKpiFailure({kpiName:ao.a.sOa,errorName:"InternalPasteIPContextIsNotInsertionPoint",optionalProperties:{additionalValues:{extendedProperties:b}}}),h.cS&&(h.cS.fail("ipContext is not insertion point in InternalPasteAtIp",!0),h.failed=!0),!1}return!0}aLi(b,h){h=oq.mF(h);this.$ra.tRn(h,b.node,b.cpBegin);this.$ra.I4m(h.Caf);this.$ra.oNf(h.xHb);this.$ra.aNf(h.oCb);this.$ra.YMf(h.tfb)}Deg(b,h){if(!h.XIj)return!1;
h.Tw&64&&this.iA.ZIj();if(!h.WEa)return t.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.Ic.Yb(le.a.f2,{["Reason"]:ae.a.Pkb}),h.cS&&h.cS.fail("No selection after paste",!1),h.failed=!0,!1;this.gOe.h0o(h);this.ug.tF();return!1}}Object(m.a)(Fz,"ClipboardOperationPaste",null,[712]);class Uq{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb){this.Ad=b;this.iA=h;this.YAc=r;this.uua=B;this.hb=P;this.ga=ca;this.ZWe=Qa;this.afk=ra;this.Ize=tb;this.rwe=Mb;this.Vd=Zb}create(b,h){h=this.afk.create(this.hb,
h);return new Fz(this.Ad,this.iA,this.YAc,this.uua,this.hb,this.ga,b,h,this.ZWe,this.Ize,this.rwe,this.Vd)}}Object(m.a)(Uq,"Factory",null,[690]);var rv=c(1642);class rt{constructor(b,h){this.WEo=b;this.HAn=h}}Object(m.a)(rt,"ParagraphFormatStore",null,[]);class Ts{constructor(b,h,r){this.hb=b;this.gb=h;this.we=r}FQo(b,h){if(h.vdc){h=b.Bqa;var r=this.hb.ib.lb.Pa.node,B=null;this.gb.Xb(r)&&(B=this.we.So(r),r=this.gb.U2a(r),B=new rt(B,r));h=new rv.a(h.context,h.Tw,h.cS,h.x$,h.vd,B);b.Bqa=h}}}Object(m.a)(Ts,
"ClipboardOperationPasteOvertypeStrategy",null,[689]);class Mu{constructor(b){this.UJe=null;this.hb=b;b.JPb(h=>{this.UJe=h},!1)}get sBi(){return!1}h0o(b){b=this.b1e(b);this.Ac(this.hb,b)}b1e(b){let h=b.WEa;(b.LVa||b.Wja)&&b.mke&&(h=og.SelectionFactory.Gy(b.mke,h.Pa));return h}Ac(b,h){b.Ac(h)}}Object(m.a)(Mu,"AClipboardOperationPasteStrategy",null,[744]);class Gz extends Mu{constructor(b){super(b)}get hTa(){return this.UJe}}Object(m.a)(Gz,"ClipboardOperationPasteToLiveSelectionStrategy",Mu,[]);class Nx extends Mu{constructor(b,
h){super(b);this.cYe=null;this.obk=h;b.JPb(r=>{this.cYe=r},!0)}get sBi(){return!0}get hTa(){return this.cYe}b1e(b){let h=super.b1e(b);b.vd.setValue(Yc.a.t1i,h);return h=this.obk.Hci(this.UJe.lb,this.cYe.lb,h)}}Object(m.a)(Nx,"ClipboardOperationPasteToVirtualSelectionStrategy",Mu,[]);class Us{constructor(b){this.bYe=b.$("EnableVirtualSelectionInSelectionManager")}create(b,h){return h&&h.ja(Yc.a.LVa,!1)&&this.bYe?new Nx(b,this.B3o):new Gz(b)}get B3o(){return null!=this.HJg?this.HJg:this.HJg=Ma.a.instance.Oa("Box4.Actors.IVirtualSelectionMerger")}}
Object(m.a)(Us,"ClipboardOperationPasteStrategyFactory",null,[688]);class Sq{constructor(b,h,r,B){this.Ic=b;this.mb=h;this.Tm=r;this.Yf=B}AGn(b){(b&1||b&32)&&this.Tm.Uo&&this.mb.e2b()}yJm(b,h){return b&1&&this.Yf.$_(h,!0)?(this.Ic.Yb(le.a.ef,{["Reason"]:ae.a.cF}),!1):!0}}Object(m.a)(Sq,"ClipboardOperationWordStrategy",null,[]);class gw{constructor(){}C7k(b,h){if(h)if(h=h.sheet)if(h=h.cssRules){var r=Array.clone(h);r.reverse();var B=h=0,P=0,ca=0;for(const Qa of r){r=Qa.style;var ra=Qa.selectorText;
r=r?r.cssText:null;ra=ra?ra.split(","):null;if(r&&ra&&Qa.type===Qa.STYLE_RULE){ca+=ra.length;for(const tb of ra){0<=tb.indexOf("#")&&h++;0<=tb.indexOf(".")&&B++;0>tb.indexOf("#")&&0>tb.indexOf(".")&&P++;ra=null;try{ra=b.querySelectorAll(tb)}catch(Mb){t.ULS.sendTraceTag(41427107,307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",tb,Mb.message)}if(ra)for(let Mb=0;Mb<ra.length;Mb++)ra[Mb].setAttribute("style",r+(ra[Mb].getAttribute("style")||""))}}}t.ULS.sendTraceTag(51245663,
307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",ca,h,B,P)}else this.zLi();else this.zLi()}zLi(){t.ULS.sendTraceTag(41211202,307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",Z.a.qG)}}Object(m.a)(gw,"ExternalPasteCssConverter",null,[687]);class IB{constructor(b){this.YOa=0;this.BFh=null;this.node=b}}Object(m.a)(IB,"ChartConverterArguments",null,[]);class tu{constructor(b=null){this._imgNodesConverted=
0;this.K3=b||Dq.a.J6h("")}get Jc(){return this.K3}process(b,h){b&&(this._imgNodesConverted=0,b.querySelectorAll&&(b=b.querySelectorAll("div"),1===b.length&&(b=new qv.a(h,this.yAl.bind(this),new IB(b[0])),b.Rl("Chart Converter Operation"),b.Qh=!h||h.Qh,b.run())))}yAl(b,h){var r=h.node;if(1<h.YOa)return!1;if(1===r.nodeType&&"DIV"===r.tagName){const B=r.getAttribute(Gf.qKd);if(B){const P=r.getAttribute(Gf.Gdf),ca=r.getAttribute(Gf.Hdf),ra=r.getAttribute(Gf.Edf),Qa=r.getAttribute(Gf.Fdf),tb=r.getAttribute(Gf.lLc);
r=r.getAttribute(Gf.Idf);P&&Qa&&ca&&"chart"===ca&&tb&&"XLO"===tb&&(h.BFh=new Nn.a(B,P,ca,ra,Qa,tb,r))}}b.pi(this.Cen.bind(this));return!0}Cen(b,h){var r=h.node;if(b=h.BFh)1===r.childElementCount&&1===r.firstChild.nodeType&&"IMG"===r.firstChild.tagName?(r=r.firstChild,r.setAttribute(Gf.qKd,b.ccpId),r.setAttribute(Gf.Gdf,b.pKey),r.setAttribute(Gf.Hdf,b.type),r.setAttribute(Gf.Fdf,b.dc),r.setAttribute(Gf.lLc,b.client),b.version&&r.setAttribute(Gf.Idf,b.version),b.count&&r.setAttribute(Gf.Edf,b.count),
this._imgNodesConverted++):t.ULS.sendTraceTag(541361690,307,15,"Invalid html received"),this.K3._imgNodesConverted=this._imgNodesConverted;h.YOa++;return!1}}Object(m.a)(tu,"ChartConverter",null,[]);class hk{constructor(b,h=null,r=null){this.mf=b;this.K3=h||Dq.a.fhi("");this.Slk=r||Dq.a.ghi("")}get Jc(){return this.K3}get nlg(){return this.Slk}b$(b){this.nlg.b++;this.mf.b$(b)}Z9(){this.mf.Z9()}u5(b){this.nlg.c++;this.mf.u5(b)}a$(){this.mf.a$()}Y9(b){this.nlg.d++;this.mf.Y9(b)}X9(){this.mf.X9()}reset(){this.mf.reset()}get vLc(){return this.mf.vLc}Jda(b,
h){this.Jc.b++;this.mf.Jda(b,h)}Ida(b){this.Jc.c++;this.mf.Ida(b)}Xnb(b){this.Jc.b++;this.mf.Xnb(b)}xya(b){this.Jc.d++;this.mf.xya(b)}BHa(b){this.Jc.f++;this.mf.BHa(b)}MSa(b,h){this.Jc.g++;this.mf.MSa(b,h)}LSa(){this.mf.LSa()}jE(b){this.Jc.h++;this.mf.jE(b)}AF(){this.mf.AF()}Snb(){this.mf.Snb()}Rnb(){this.mf.Rnb()}RSa(b,h){this.Jc.i++;this.mf.RSa(b,h)}i6a(){this.mf.i6a()}Bya(b){this.Jc.j++;this.mf.Bya(b)}zya(){this.mf.zya()}FHa(b){this.Jc.k++;this.mf.FHa(b)}Aya(){this.mf.Aya()}k6a(b){this.Jc.l++;
this.mf.k6a(b)}}Object(m.a)(hk,"SemanticEventUsageCollector",null,[239,240]);class fh{constructor(b=null){this.Wd=b}J0k(b,h){var r,B;if(null!==(r=this.Wd)&&void 0!==r&&r.$h&&(h=h.match(/[0-9]+[a-zA-Z%]+/g)))for(const P of h)h=P.replace(/[0-9]+/,""),this.Wd.Gke.has(b)||this.Wd.Gke.set(b,new Map),r=this.Wd.Gke.get(b),null===r||void 0===r?void 0:r.set(h,(null!==(B=r.get(h))&&void 0!==B?B:0)+1)}BKi(b){var h,r,B;v.AFrameworkApplication.oe("ec3e8394;h715g427");null!==(h=this.Wd)&&void 0!==h&&h.Oxi&&(h=
b.cssText)&&(b=h.match(/[0-9]+em;/g),h=h.match(/[0-9]+rem;/g),this.Wd.LTf+=null!==(r=null===b||void 0===b?void 0:b.length)&&void 0!==r?r:0,this.Wd.MTf+=null!==(B=null===h||void 0===h?void 0:h.length)&&void 0!==B?B:0)}Ld(b){const h=b.jf;if(h&&this.Wd){var r=h.tagName.toLowerCase();this.BKi(h.style);"font"===r&&this.h0f(b);if(b=h.style)for(0===b.length&&this.Wd.QQa(h.tagName,"no style present"),r=0;r<b.length;r++){const B=b[r];B&&0<B.length&&(this.Wd.QQa(h.tagName,B),this.J0k(B,b.getPropertyValue(B)))}}}h0f(b){if((b=
b.jf)&&"font"===b.tagName.toLowerCase()&&this.Wd){var h=b.getAttribute("face");h&&0<h.length&&this.Wd.QQa(b.tagName,"font-attr-face");(h=b.getAttribute("color"))&&0<h.length&&this.Wd.QQa(b.tagName,"font-attr-color");(h=b.getAttribute("size"))&&0<h.length&&this.Wd.QQa(b.tagName,"font-attr-size")}}}Object(m.a)(fh,"HtmlEventUsageCollectorHelper",null,[]);class bo{constructor(b,h=null,r=null,B=null,P=null){this.ei=P;this.LZj="span p div br a img label b font i strong u em h1 h2 h3 h4 h5 h6 table tbody td tr li ol ul".split(" ");
this.mf=b;this.K3=h||Dq.a.pai(Z.a.IBb,"");this.Av=r;this.Mjk=B?B.$("ParseStyleForHtmlTagEventIsEnabled"):!1;this.Njk=B?B.$("ParseStyleForUncommonHtmlTagEventIsEnabled"):!1;this.SPg=new De.a(Pa.a.ih());for(const ca of this.LZj)this.SPg.add(ca)}get Jc(){return this.K3}get Wd(){return this.Av}Dh(b){return b?b+1:1}reset(){this.mf.reset()}L6d(){this.mf.L6d()}fyf(b){if(b&&this.Wd&&(b.getAttribute&&(b.getAttribute(Gf.ail)&&(this.Wd.h3h=!0),b.getAttribute(Gf.qKd)&&(this.Wd.CJl=!0),b.getAttribute(Gf.lLc)&&
(this.Wd.D8e=b.getAttribute(Gf.lLc)),b.getAttribute(Gf.dil)&&(this.Wd.i3h=!0)),b.id&&b.id.startsWith&&b.id.startsWith(Gf.Bmm)&&(this.Wd.j3h=!0),b.className&&b.className.split))for(const h of b.className.split(" ")){h.startsWith(Gf.Bwn)&&(this.Wd.n3h=!0);h.startsWith(Gf.HFn)&&(this.Wd.o3h=!0);h.startsWith(Gf.N5o)&&(this.Wd.p3h=!0);if(h.startsWith(Z.a.t5e)&&h.length===Z.a.t5e.length+1){const r=parseInt(F.a.substring(h,h.length-1,h.length));isNaN(r)||(this.Wd.fKc=r)}if(h===Gf.Wfn||h===Gf.Xfn)this.Wd.YOc=
!0}return this.mf.fyf(b)}onClose(){this.mf.onClose()}gRm(b){for(const h of b)if("\n"!==h)return!0;return!1}Jda(b,h){this.Wd&&(this.Wd.EJl=!0);this.Wd&&!this.Wd.Tmf&&b&&(this.Wd.Tmf=this.gRm(b));this.Jc.d=this.Dh(this.Jc.d);this.mf.Jda(b,h)}F6d(b){var h,r;this.Wd&&(this.Wd.l3h=!0);this.Jc.e=this.Dh(this.Jc.e);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.F6d(b)}WUf(b){var h,r;this.Jc.f=this.Dh(this.Jc.f);(null===(h=this.Wd)||void 0===
h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.WUf(b)}XUf(b){var h,r;this.Jc.g=this.Dh(this.Jc.g);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.XUf(b)}bVf(b){var h,r;this.Jc.h=this.Dh(this.Jc.h);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.bVf(b)}qVf(b){var h,r;this.Jc.i=this.Dh(this.Jc.i);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===
(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.qVf(b)}sVf(b){var h,r;this.Jc.j=this.Dh(this.Jc.j);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.mf.sVf(b)}K6d(b){var h,r;this.Jc.k=this.Dh(this.Jc.k);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.K6d(b)}tVf(b){var h,r;this.Jc.l=this.Dh(this.Jc.l);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===
r?void 0:r.Ld(b):this.Ld(b);this.mf.tVf(b)}uVf(b){var h,r;this.Jc.m=this.Dh(this.Jc.m);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.mf.uVf(b)}vVf(b){var h,r;this.Jc.n=this.Dh(this.Jc.n);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.vVf(b)}N6d(b){var h,r;this.Jc.o=this.Dh(this.Jc.o);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);
return this.mf.N6d(b)}O6d(b){var h,r;this.Jc.p=this.Dh(this.Jc.p);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.O6d(b)}JVf(b){var h,r;this.Jc.q=this.Dh(this.Jc.q);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.JVf(b)}P6d(b){var h,r;this.Jc.r=this.Dh(this.Jc.r);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.mf.P6d(b)}LVf(b){var h,
r;this.Jc.s=this.Dh(this.Jc.s);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.LVf(b)}Q6d(b){var h,r;this.Jc.t=this.Dh(this.Jc.t);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.Q6d(b)}R6d(b){var h,r;this.Jc.u=this.Dh(this.Jc.u);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.R6d(b)}U6d(b){var h,r;this.Jc.v=
this.Dh(this.Jc.v);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.U6d(b)}V6d(b){var h,r;this.Jc.w=this.Dh(this.Jc.w);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.V6d(b)}YVf(b){var h,r;this.Jc.x=this.Dh(this.Jc.x);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.mf.YVf(b)}ZVf(b){var h,r;this.Jc.y=this.Dh(this.Jc.y);
(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.ZVf(b)}b7d(b){var h,r;this.Jc.z=this.Dh(this.Jc.z);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.b7d(b)}c7d(b){var h,r;this.Jc.ba=this.Dh(this.Jc.ba);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.c7d(b)}f7d(b){var h,r;this.Jc.bb=this.Dh(this.Jc.bb);(null===
(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.f7d(b)}g7d(b){var h,r;this.Jc.bc=this.Dh(this.Jc.bc);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.g7d(b)}i7d(b){var h,r;this.Jc.bd=this.Dh(this.Jc.bd);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.i7d(b)}j7d(b){var h,r;this.Jc.be=this.Dh(this.Jc.be);(null===(h=this.Wd)||
void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.j7d(b)}l7d(b){var h,r;this.Jc.bf=this.Dh(this.Jc.bf);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.l7d(b)}n7d(b){var h,r;this.Jc.bg=this.Dh(this.Jc.bg);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.n7d(b)}zWf(b){var h,r;this.Jc.bh=this.Dh(this.Jc.bh);(null===(h=this.Wd)||void 0===
h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.zWf(b)}v7d(b){var h,r;this.Jc.bi=this.Dh(this.Jc.bi);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.v7d(b)}GWf(b){var h,r;this.Jc.bj=this.Dh(this.Jc.bj);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.GWf(b)}IWf(b){var h,r;this.Jc.bk=this.Dh(this.Jc.bk);(null===(h=this.Wd)||void 0===h?0:h.$h)?
null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.mf.IWf(b)}JWf(b){var h,r;this.Jc.bl=this.Dh(this.Jc.bl);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.JWf(b)}y7d(b){var h,r;this.Jc.bm=this.Dh(this.Jc.bm);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.y7d(b)}z7d(b){var h,r;this.Jc.bm=this.Dh(this.Jc.bm);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||
void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.z7d(b)}A7d(b){var h,r;this.Jc.bm=this.Dh(this.Jc.bm);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.A7d(b)}B7d(b){var h,r;this.Jc.bm=this.Dh(this.Jc.bm);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.B7d(b)}C7d(b){var h,r;this.Jc.bm=this.Dh(this.Jc.bm);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===
r?void 0:r.Ld(b):this.Ld(b);return this.mf.C7d(b)}D7d(b){var h,r;this.Jc.bm=this.Dh(this.Jc.bm);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.D7d(b)}QWf(b){this.Jc.bn=this.Dh(this.Jc.bn);return this.mf.QWf(b)}E7d(b){var h,r;this.Jc.bo=this.Dh(this.Jc.bo);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.mf.E7d(b)}XWf(b){this.Jc.bp=this.Dh(this.Jc.bp);return this.mf.XWf(b)}F7d(b){var h,
r;this.Jc.bq=this.Dh(this.Jc.bq);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.F7d(b)}ZWf(b){var h,r;this.Jc.br=this.Dh(this.Jc.br);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.ZWf(b)}I7d(b){var h,r;this.Wd&&(this.Wd.k3h=!0);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.Jc.bs=this.Dh(this.Jc.bs);this.mf.I7d(b)}fXf(b){var h,
r;this.Jc.bt=this.Dh(this.Jc.bt);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.mf.fXf(b)}J7d(b){var h,r;this.Jc.bu=this.Dh(this.Jc.bu);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.J7d(b)}lXf(b){var h,r;this.Jc.bv=this.Dh(this.Jc.bv);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.lXf(b)}L7d(b){var h,r;this.Jc.bw=
this.Dh(this.Jc.bw);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.L7d(b)}N7d(b){var h,r;this.Jc.bx=this.Dh(this.Jc.bx);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.N7d(b)}P7d(b){var h,r;this.Jc.by=this.Dh(this.Jc.by);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.P7d(b)}Q7d(b){var h,r;this.Wd&&(this.Wd.YOc=
!0);this.Jc.bz=this.Dh(this.Jc.bz);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.Q7d(b)}wXf(b){var h,r;this.Jc.ca=this.Dh(this.Jc.ca);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.mf.wXf(b)}AXf(b){var h,r;this.Jc.cb=this.Dh(this.Jc.cb);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.AXf(b)}S7d(b){var h,r;this.Wd&&
(this.Wd.DJl=!0);this.Jc.cc=this.Dh(this.Jc.cc);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.S7d(b)}onMenuOpen(b){var h,r;this.Jc.cd=this.Dh(this.Jc.cd);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.onMenuOpen(b)}EXf(b){this.Jc.ce=this.Dh(this.Jc.ce);this.mf.EXf(b)}NXf(b){var h,r;this.Jc.cf=this.Dh(this.Jc.cf);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||
void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.NXf(b)}OXf(b){var h,r;this.Jc.cg=this.Dh(this.Jc.cg);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.OXf(b)}QXf(b){var h,r;this.Jc.ch=this.Dh(this.Jc.ch);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.QXf(b)}d8d(b){var h,r;this.Wd&&(this.Wd.YOc=!0);this.Jc.ci=this.Dh(this.Jc.ci);(null===(h=this.Wd)||void 0===h?0:h.$h)?
null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.d8d(b)}SXf(b){var h,r;this.Jc.cj=this.Dh(this.Jc.cj);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.SXf(b)}e8d(b){var h,r;this.Jc.ck=this.Dh(this.Jc.ck);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.e8d(b)}i8d(b){var h,r;this.Jc.cl=this.Dh(this.Jc.cl);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===
(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.i8d(b)}ZXf(b){var h,r;this.Jc.cm=this.Dh(this.Jc.cm);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);this.mf.ZXf(b)}p8d(b){var h,r;this.Jc.cn=this.Dh(this.Jc.cn);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.p8d(b)}jYf(b){var h,r;this.Jc.co=this.Dh(this.Jc.co);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||
void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.jYf(b)}w8d(b){var h,r;this.Jc.cp=this.Dh(this.Jc.cp);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.w8d(b)}x8d(b){var h,r;this.Jc.cq=this.Dh(this.Jc.cq);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.x8d(b)}BYf(b){this.Jc.cr=this.Dh(this.Jc.cr);return this.mf.BYf(b)}IYf(b){var h,r;this.Jc.cs=this.Dh(this.Jc.cs);(null===
(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.IYf(b)}F8d(b){var h,r;this.Jc.ct=this.Dh(this.Jc.ct);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.F8d(b)}G8d(b){var h,r;this.Jc.cu=this.Dh(this.Jc.cu);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.G8d(b)}I8d(b){var h,r;this.Jc.cv=this.Dh(this.Jc.cv);(null===(h=this.Wd)||
void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.I8d(b)}J8d(b){var h,r;this.Jc.cw=this.Dh(this.Jc.cw);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.J8d(b)}MYf(b){this.Jc.cx=this.Dh(this.Jc.cx);return this.mf.MYf(b)}K8d(b){var h,r;this.Jc.cy=this.Dh(this.Jc.cy);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.K8d(b)}N8d(b){var h,
r;this.Jc.cz=this.Dh(this.Jc.cz);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.N8d(b)}P8d(b){var h,r;this.Wd&&(this.Wd.uoa=!0);this.Jc.da=this.Dh(this.Jc.da);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.P8d(b)}PYf(b){var h,r;this.Wd&&(this.Wd.uoa=!0);this.Jc.db=this.Dh(this.Jc.db);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):
this.Ld(b);return this.mf.PYf(b)}I2c(b){var h,r;this.Wd&&(this.Wd.uoa=!0);this.Jc.dc=this.Dh(this.Jc.dc);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.I2c(b)}SYf(b){var h,r;this.Jc.dd=this.Dh(this.Jc.dd);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.SYf(b)}TYf(b){var h,r;this.Jc.de=this.Dh(this.Jc.de);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===
r?void 0:r.Ld(b):this.Ld(b);return this.mf.TYf(b)}S8d(b){var h,r;this.Wd&&(this.Wd.uoa=!0);this.Jc.df=this.Dh(this.Jc.df);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.S8d(b)}UYf(b){var h,r;this.Wd&&(this.Wd.uoa=!0);this.Jc.dg=this.Dh(this.Jc.dg);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.UYf(b)}XYf(b){var h,r;this.Jc.dh=this.Dh(this.Jc.dh);(null===(h=this.Wd)||void 0===
h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.XYf(b)}X8d(b){var h,r;this.Wd&&(this.Wd.uoa=!0);this.Jc.di=this.Dh(this.Jc.di);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.X8d(b)}Y8d(b){var h,r;this.Jc.dj=this.Dh(this.Jc.dj);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.Y8d(b)}Z8d(b){var h,r;this.Jc.dk=this.Dh(this.Jc.dk);(null===(h=
this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.Z8d(b)}$8d(b){var h,r;this.Wd&&(this.Wd.YOc=!0);this.Jc.dl=this.Dh(this.Jc.dl);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.$8d(b)}e9d(b){var h,r;this.Jc.dm=this.Dh(this.Jc.dm);(null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b);return this.mf.e9d(b)}b9d(b){var h,r;this.Jc.dn=this.Dh(this.Jc.dn);
this.Wwi&&((null===(h=this.Wd)||void 0===h?0:h.$h)?null===(r=this.ei)||void 0===r?void 0:r.Ld(b):this.Ld(b));return this.mf.b9d(b)}get Wwi(){if(null!=this.sDg)var b=this.sDg;else{var h;b=this.sDg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isDNMLoggingForUnknownElementsEnabled",!1)}return b}Ld(b){var h;const r=b.jf;if(r&&this.Wd){var B=r.tagName.toLowerCase();null===(h=this.ei)||void 0===h?void 0:h.BKi(r.style);if(this.Mjk&&this.qwi(B)||
this.Njk&&!this.qwi(B)||this.Wd.Vwi)if("font"===B&&this.h0f(b),r.style&&(b=r.style)){0===b.length&&this.Wd.QQa(r.tagName,"no style present");for(const P of b)P&&0<P.length&&this.Wd.QQa(r.tagName,P)}}}h0f(b){if((b=b.jf)&&"font"===b.tagName.toLowerCase()&&this.Wd){var h=b.getAttribute("face");h&&0<h.length&&this.Wd.QQa(b.tagName,"font-attr-face");(h=b.getAttribute("color"))&&0<h.length&&this.Wd.QQa(b.tagName,"font-attr-color");(h=b.getAttribute("size"))&&0<h.length&&this.Wd.QQa(b.tagName,"font-attr-size")}}qwi(b){return this.SPg.contains(b)}}
Object(m.a)(bo,"HtmlEventUsageCollector",null,[285]);class po{constructor(b,h,r=!1){this.jf=b;this.LB=h;this.sEk=r}}Object(m.a)(po,"TagEventParam",null,[]);class yp{constructor(b,h=null){this.rkd=this._prunedElements=this.NWe=this._voidElements=null;this.ud=b;this.K3=h||Dq.a.qai("");this.epo()}get Jc(){return this.K3}djn(b,h,r){this.NWe[h]?this.BSi():(this.Jc.e++,(h=this.rkd[h])&&h(new po(b,r,!1)),this.Jc.b++)}BSi(){this.Jc.d++}Yin(){this.Jc.c++}Lin(b,h,r){if(this.NWe[h])this.BSi();else{if(h=this.rkd[h])return this.Jc.b++,
h(new po(b,r,!1));this.Jc.f++;if(this.ud.Wwi)return this.ud.b9d(new po(b,null))}return 2}epo(){this._voidElements=kb.a.h6("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",!0);this.NWe=kb.a.h6("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,"HTML",!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this._prunedElements=kb.a.h6("APPLET",!0,"AREA",!0,
"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0);const b=this.ud,h=this.ud,r=this.ud,B=this.ud,P=this.ud,ca=this.ud,ra=this.ud,Qa=this.ud,tb=this.ud,Mb=this.ud,Zb=this.ud,jc=this.ud,Gc=this.ud,Uc=this.ud,od=this.ud,Od=this.ud,ze=this.ud,de=this.ud,ee=this.ud,je=this.ud;this.rkd=kb.a.h6("A",Object(z.a)(this.ud,this.ud.F6d,"onAOpen"),"ABBR",Object(z.a)(this.ud,this.ud.WUf,"onAbbrOpen"),
"ACRONYM",Object(z.a)(this.ud,this.ud.XUf,"onAcronymOpen"),"ADDRESS",Object(z.a)(this.ud,this.ud.bVf,"onAddressOpen"),"APPLET",Object(z.a)(this.ud,this.ud.qVf,"onAppletOpen"),"AREA",Object(z.a)(this.ud,this.ud.sVf,"onAreaTag"),"B",Object(z.a)(this.ud,this.ud.K6d,"onBOpen"),"BASE",Object(z.a)(this.ud,this.ud.tVf,"onBaseTag"),"BASEFONT",Object(z.a)(this.ud,this.ud.uVf,"onBasefontTag"),"BDO",Object(z.a)(this.ud,this.ud.vVf,"onBdoOpen"),"BIG",Object(z.a)(this.ud,this.ud.N6d,"onBigOpen"),"BLOCKQUOTE",
Object(z.a)(this.ud,this.ud.O6d,"onBlockquoteOpen"),"BODY",Object(z.a)(this.ud,this.ud.JVf,"onBodyOpen"),"BR",Object(z.a)(this.ud,this.ud.P6d,"onBrTag"),"BUTTON",Object(z.a)(this.ud,this.ud.LVf,"onButtonOpen"),"CAPTION",Object(z.a)(this.ud,this.ud.Q6d,"onCaptionOpen"),"CENTER",Object(z.a)(this.ud,this.ud.R6d,"onCenterOpen"),"CITE",Object(z.a)(this.ud,this.ud.U6d,"onCiteOpen"),"CODE",Object(z.a)(this.ud,this.ud.V6d,"onCodeOpen"),"COL",Object(z.a)(this.ud,this.ud.YVf,"onColTag"),"COLGROUP",Object(z.a)(this.ud,
this.ud.ZVf,"onColgroupOpen"),"DD",Object(z.a)(this.ud,this.ud.b7d,"onDdOpen"),"DEL",Object(z.a)(this.ud,this.ud.c7d,"onDelOpen"),"DFN",Object(z.a)(this.ud,this.ud.f7d,"onDfnOpen"),"DIR",Object(z.a)(this.ud,this.ud.g7d,"onDirOpen"),"DIV",Object(z.a)(this.ud,this.ud.i7d,"onDivOpen"),"DL",Object(z.a)(this.ud,this.ud.j7d,"onDlOpen"),"DT",Object(z.a)(this.ud,this.ud.l7d,"onDtOpen"),"EM",Object(z.a)(this.ud,this.ud.n7d,"onEmOpen"),"FIELDSET",Object(z.a)(this.ud,this.ud.zWf,"onFieldsetOpen"),"FONT",Object(z.a)(this.ud,
this.ud.v7d,"onFontOpen"),"FORM",Object(z.a)(this.ud,this.ud.GWf,"onFormOpen"),"FRAME",Object(z.a)(this.ud,this.ud.IWf,"onFrameTag"),"FRAMESET",Object(z.a)(this.ud,this.ud.JWf,"onFramesetOpen"),"H1",Object(z.a)(this.ud,this.ud.y7d,"onH1Open"),"H2",Object(z.a)(this.ud,this.ud.z7d,"onH2Open"),"H3",Object(z.a)(this.ud,this.ud.A7d,"onH3Open"),"H4",Object(z.a)(this.ud,this.ud.B7d,"onH4Open"),"H5",Object(z.a)(this.ud,this.ud.C7d,"onH5Open"),"H6",Object(z.a)(this.ud,this.ud.D7d,"onH6Open"),"HEAD",Object(z.a)(this.ud,
this.ud.QWf,"onHeadOpen"),"HR",Object(z.a)(this.ud,this.ud.E7d,"onHrTag"),"HTML",Object(z.a)(this.ud,this.ud.XWf,"onHtmlOpen"),"I",Object(z.a)(this.ud,this.ud.F7d,"onIOpen"),"IFRAME",Object(z.a)(this.ud,this.ud.ZWf,"onIframeOpen"),"IMG",Object(z.a)(this.ud,this.ud.I7d,"onImgTag"),"INPUT",Object(z.a)(this.ud,this.ud.fXf,"onInputTag"),"INS",Object(z.a)(this.ud,this.ud.J7d,"onInsOpen"),"ISINDEX",Object(z.a)(this.ud,this.ud.lXf,"onIsindexOpen"),"KBD",Object(z.a)(this.ud,this.ud.L7d,"onKbdOpen"),"LABEL",
Object(z.a)(this.ud,this.ud.N7d,"onLabelOpen"),"LEGEND",Object(z.a)(this.ud,this.ud.P7d,"onLegendOpen"),"LI",Object(z.a)(this.ud,this.ud.Q7d,"onLiOpen"),"LINK",Object(z.a)(this.ud,this.ud.wXf,"onLinkTag"),"MAP",Object(z.a)(this.ud,this.ud.AXf,"onMapOpen"),"MATH",Object(z.a)(this.ud,this.ud.S7d,"onMathOpen"),"MENU",Object(z.a)(this.ud,this.ud.onMenuOpen,"onMenuOpen"),"META",Object(z.a)(this.ud,this.ud.EXf,"onMetaTag"),"NOFRAMES",Object(z.a)(this.ud,this.ud.NXf,"onNoframesOpen"),"NOSCRIPT",Object(z.a)(this.ud,
this.ud.OXf,"onNoscriptOpen"),"OBJECT",Object(z.a)(this.ud,this.ud.QXf,"onObjectOpen"),"OL",Object(z.a)(this.ud,this.ud.d8d,"onOlOpen"),"OPTGROUP",Object(z.a)(this.ud,this.ud.SXf,"onOptgroupOpen"),"OPTION",Object(z.a)(this.ud,this.ud.e8d,"onOptionOpen"),"P",Object(z.a)(this.ud,this.ud.i8d,"onPOpen"),"PARAM",Object(z.a)(this.ud,this.ud.ZXf,"onParamTag"),"PRE",Object(z.a)(this.ud,this.ud.p8d,"onPreOpen"),"Q",Object(z.a)(this.ud,this.ud.jYf,"onQOpen"),"S",Object(z.a)(this.ud,this.ud.w8d,"onSOpen"),"SAMP",
Object(z.a)(this.ud,this.ud.x8d,"onSampOpen"),"SCRIPT",Object(z.a)(this.ud,this.ud.BYf,"onScriptOpen"),"SELECT",Object(z.a)(this.ud,this.ud.IYf,"onSelectOpen"),"SMALL",Object(z.a)(b,b.F8d,"onSmallOpen"),"SPAN",Object(z.a)(h,h.G8d,"onSpanOpen"),"STRIKE",Object(z.a)(r,r.I8d,"onStrikeOpen"),"STRONG",Object(z.a)(B,B.J8d,"onStrongOpen"),"STYLE",Object(z.a)(P,P.MYf,"onStyleOpen"),"SUB",Object(z.a)(ca,ca.K8d,"onSubOpen"),"SUP",Object(z.a)(ra,ra.N8d,"onSupOpen"),"TABLE",Object(z.a)(Qa,Qa.P8d,"onTableOpen"),
"TBODY",Object(z.a)(tb,tb.PYf,"onTbodyOpen"),"TD",Object(z.a)(Mb,Mb.I2c,"onTdOpen"),"TEXTAREA",Object(z.a)(Zb,Zb.SYf,"onTextareaOpen"),"TFOOT",Object(z.a)(jc,jc.TYf,"onTfootOpen"),"TH",Object(z.a)(Gc,Gc.S8d,"onThOpen"),"THEAD",Object(z.a)(Uc,Uc.UYf,"onTheadOpen"),"TITLE",Object(z.a)(od,od.XYf,"onTitleOpen"),"TR",Object(z.a)(Od,Od.X8d,"onTrOpen"),"TT",Object(z.a)(ze,ze.Y8d,"onTtOpen"),"U",Object(z.a)(de,de.Z8d,"onUOpen"),"UL",Object(z.a)(ee,ee.$8d,"onUlOpen"),"VAR",Object(z.a)(je,je.e9d,"onVarOpen"))}}
Object(m.a)(yp,"AHtmlProcessor",null,[]);class yv{constructor(b,h){this.childNodes=b.childNodes;this.LB=h;this.Rcf=0;this.KZd=!1}}Object(m.a)(yv,"HtmlProcessorArguments",null,[]);class Mq extends yp{constructor(b,h=null){super(b,h);this.WGe=null}get kSm(){null==this.WGe&&(this.WGe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("CopyAndPasteTextFromWordWin32FixIsEnabled"):!1);return this.WGe}process(b,h=null){b&&(this.ud.reset(),this.D4i(new yv(b,new ar.a),h))}D4i(b,h){b.childNodes.length&&
(b=new qv.a(h,Object(z.a)(this,this.EIn,"processChild"),b),b.Rl("HTML Processing Operation"),h||(b.Qh=!0),b.run())}EIn(b,h){const r=h.childNodes[h.Rcf];if(3===r.nodeType)return this.ud.L6d(),this.ud.Jda(r.nodeValue,new po(r,h.LB.f8h())),Mq.xoc(h);if(1!==r.nodeType)return Mq.xoc(h);if(!h.KZd){const P=F.a.ZA(r.tagName);if(!Mq.Orm(r))if(this._prunedElements[P])this.Yin();else{Mq.O$m(r);this.ud.L6d();var B=r.id;const ca=r.tagName,ra=h.LB.f8h(),Qa=r.getAttribute?r.getAttribute("class"):null;B=new Mo(B,
ca,Qa?Qa:"",r.attributes?r.attributes.length:0);B.isValid&&ra.add(B);if(this._voidElements[P])return this.djn(r,P,ra),Mq.xoc(h);B=!1;switch(this.Lin(r,P,ra)){case 1:B=!0;break;case 3:return Mq.xoc(h)}switch(this.ud.fyf(r)){case 1:B=!0}h.KZd=B;this.D4i(new yv(r,ra),b);if(!b.Qh)return!0}}if(h.KZd){if(this.kSm&&!this.rkd[F.a.ZA(r.tagName)])return Mq.xoc(h);this.ud.onClose()}return Mq.xoc(h)}static O$m(b){3!==b.nodeType&&Xb.a.Sl(b,"alreadyPasted",!0)}static Orm(b){return 3!==b.nodeType&&Xb.a.Eb(b,"alreadyPasted")}static xoc(b){b.Rcf++;
b.KZd=!1;return b.Rcf<b.childNodes.length}}Object(m.a)(Mq,"HtmlProcessor",yp,[]);var Vu=c(545);const hw={["font-size"]:0,["box-sizing"]:1,["font-family"]:2,["color"]:3,["padding"]:4,["margin"]:5,["border-bottom-width"]:6,["border-left-width"]:7,["border-top-width"]:8,["border-right-width"]:9,["border-bottom-style"]:10,["border-left-style"]:11,["border-top-style"]:12,["border-right-style"]:13,["line-height"]:14,["border-bottom-color"]:15,["border-left-color"]:16,["border-top-color"]:17,["border-right-color"]:18,
["border-image-repeat"]:19,["border-image-source"]:20,["border-image-width"]:21,["border-image-outset"]:22,["border-image-slice"]:23,["margin-bottom"]:24,["font-weight"]:25,["background-color"]:26,["font-style"]:27,["margin-top"]:28,["padding-top"]:29,["padding-right"]:30,["padding-left"]:31,["padding-bottom"]:32,["vertical-align"]:33,["margin-left"]:34,["margin-right"]:35,["white-space"]:36,["width"]:37,["position"]:38,["text-align"]:39,["display"]:40,["font-variant-ligatures"]:41,["font-variant-caps"]:42,
["outline-style"]:43,["outline-width"]:44,["outline-color"]:45,["font-variant-numeric"]:46,["font-stretch"]:47,["font-variant-east-asian"]:48,["height"]:49,["background-clip"]:50,["background-repeat-x"]:51,["background-repeat-y"]:52,["background-position-y"]:53,["background-position-x"]:54,["background-image"]:55,["background-size"]:56,["background-origin"]:57,["background-attachment"]:58,["text-indent"]:59,["overflow-x"]:60,["overflow-y"]:61,["text-decoration-color"]:62,["text-decoration-style"]:63,
["letter-spacing"]:64,["text-transform"]:65,["overflow-wrap"]:66,["float"]:67,["-webkit-text-stroke-width"]:68,["word-spacing"]:69,["orphans"]:70,["widows"]:71,["top"]:72,["border-top-right-radius"]:73,["border-top-left-radius"]:74,["border-bottom-right-radius"]:75,["border-bottom-left-radius"]:76,["text-decoration-line"]:77,["left"]:78,["unicode-bidi"]:79,["clear"]:80,["max-width"]:81,["list-style-type"]:82,["min-height"]:83,["text-shadow"]:84,["bottom"]:85,["list-style-position"]:86,["list-style-image"]:87,
["right"]:88,["-webkit-font-smoothing"]:89,["visibility"]:90,["cursor"]:91,["resize"]:92,["max-height"]:93,["word-break"]:94,["font-attr-size"]:95,["font-attr-face"]:96,["user-select"]:97,["min-width"]:98,["transition-duration"]:99,["transition-property"]:100,["transition-timing-function"]:101,["transition-delay"]:102,["clip"]:103,["transform"]:104,["opacity"]:105,["-webkit-tap-highlight-color"]:106,["align-items"]:107,["flex-direction"]:108,["font-attr-color"]:109,["direction"]:110,["flex-shrink"]:111,
["box-shadow"]:112,["text-rendering"]:113,["z-index"]:114,["flex-grow"]:115,["text-size-adjust"]:116,["flex-basis"]:117,["transform-origin"]:118,["quotes"]:119,["caption-side"]:120,["border-collapse"]:121,["counter-reset"]:122,["font-kerning"]:123,["text-overflow"]:124,["-webkit-text-stroke-color"]:125,["-webkit-user-drag"]:126,["-webkit-box-flex"]:127,["font-variant"]:128,["font-feature-settings"]:129,["-webkit-border-horizontal-spacing"]:130,["-webkit-border-vertical-spacing"]:131,["justify-content"]:132,
["margin-inline-start"]:133,["speak"]:134,["caret-color"]:135,["flex-wrap"]:136,["animation-duration"]:137,["animation-name"]:138,["animation-timing-function"]:139,["animation-fill-mode"]:140,["animation-delay"]:141,["animation-iteration-count"]:142,["animation-direction"]:143,["animation-play-state"]:144,["pointer-events"]:145,["grid-column-end"]:146,["grid-column-start"]:147,["break-inside"]:148,["counter-increment"]:149,["touch-action"]:150,["word-wrap"]:151,["hyphens"]:152,["zoom"]:153,["break-after"]:154,
["content"]:155,["break-before"]:156,["margin-block-start"]:157,["margin-block-end"]:158,["padding-inline-start"]:159,["-webkit-box-align"]:160,["tab-size"]:161,["-webkit-appearance"]:162,["table-layout"]:163,["transform-style"]:164,["-webkit-box-orient"]:165,["writing-mode"]:166,["-webkit-box-pack"]:167,["-webkit-box-direction"]:168,["order"]:169,["text-decoration"]:170,["--darkreader-inline-color"]:171,["empty-cells"]:172,["backface-visibility"]:173,["object-fit"]:174,["--transition-duration"]:175,
["clip-path"]:176,["margin-inline-end"]:177,["grid-template-columns"]:178,["--darkreader-inline-bgcolor"]:179,["-webkit-print-color-adjust"]:180,["-webkit-box-decoration-break"]:181,["filter"]:182,["perspective-origin"]:183,["fill"]:184,["align-content"]:185,["align-self"]:186,["column-count"]:187,["outline-offset"]:188,["--czi-counter-name"]:189,["--czi-counter-reset"]:190,["--czi-list-style-type"]:191,["-webkit-line-clamp"]:192,["--darkreader-inline-border-bottom"]:193,["--darkreader-inline-border-left"]:194,
["--darkreader-inline-border-right"]:195,["--darkreader-inline-border-top"]:196,["--saf-0"]:197,["will-change"]:198,["grid-row-start"]:199,["padding-inline-end"]:200,["padding-block-end"]:201,["padding-block-start"]:202,["grid-row-end"]:203,["-webkit-box-ordinal-group"]:204,["column-gap"]:205,["object-position"]:206,["image-rendering"]:207,["-webkit-user-modify"]:208,["column-width"]:209,["text-decoration-skip-ink"]:210,["line-break"]:211,["grid-template-rows"]:212,["perspective"]:213,["justify-self"]:214,
["page"]:215,["--language-font-face"]:216,["mix-blend-mode"]:217,["-webkit-text-fill-color"]:218,["grid-template-areas"]:219,["--darkreader-inline-bgimage"]:220,["--darkreader-inline-outline"]:221,["-webkit-hyphenate-character"]:222,["row-gap"]:223,["scroll-behavior"]:224,["text-align-last"]:225,["stroke"]:226,["column-fill"]:227,["--chat-message-background-color"]:228,["--message-border-radius-bottom-left"]:229,["--message-border-radius-bottom-right"]:230,["--message-border-radius-top-left"]:231,
["--message-border-radius-top-right"]:232,["-webkit-mask-image"]:233,["--ehixd-mediumheight"]:234,["--ehixd-mediumpadding"]:235,["--czi-content-line-height"]:236,["--chat-default-message-background-color"]:237,["overscroll-behavior-x"]:238,["overscroll-behavior-y"]:239,["contain"]:240,["-webkit-user-select"]:241,["border"]:242,["justify-items"]:243,["-webkit-border-image"]:244,["column-rule-color"]:245,["column-rule-style"]:246,["column-rule-width"]:247,["--avatar-size"]:248,["--chat-message-align"]:249,
["--chat-message-link-color"]:250,["--chat-message-max-width"]:251,["--black"]:252,["--blacktranslucent40"]:253,["--flaggedmessage"]:254,["--headerbackground"]:255,["--headerbackgroundsearch"]:256,["--headerbadgebackground"]:257,["--headerbadgetext"]:258,["--headerbrandtext"]:259,["--headerbuttonsbackground"]:260,["--headerbuttonsbackgroundhover"]:261,["--headerbuttonsbackgroundsearch"]:262,["--headerbuttonsbackgroundsearchhover"]:263,["--headersearchboxbackground"]:264,["--headersearchboxicon"]:265,
["--headersearchbuttonbackground"]:266,["--headersearchbuttonbackgroundhover"]:267,["--headersearchbuttonicon"]:268,["--headersearchfilters"]:269,["--headersearchfiltershover"]:270,["--headersearchicon"]:271,["--headersearchplaceholdertext"]:272,["--headertexticons"]:273,["--neutraldark"]:274,["--neutrallight"]:275,["--neutrallighter"]:276,["--neutrallighteralt"]:277,["--neutralprimary"]:278,["--neutralprimaryalt"]:279,["--neutralquaternary"]:280,["--neutralquaternaryalt"]:281,["--neutralsecondary"]:282,
["--neutraltertiary"]:283,["--neutraltertiaryalt"]:284,["--reddark"]:285,["--richusercontentbackground"]:286,["--searchboxbackground"]:287,["--themedark"]:288,["--themedarkalt"]:289,["--themedarker"]:290,["--themelight"]:291,["--themelighter"]:292,["--themelighteralt"]:293,["--themeprimary"]:294,["--themesecondary"]:295,["--themetertiary"]:296,["--white"]:297,["--whitetranslucent40"]:298,["--whitetranslucent90"]:299,["--button-width"]:300,["fill-opacity"]:301,["--mousedown-x"]:302,["--mousedown-y"]:303,
["--height"]:304,["--purple"]:305,["-webkit-line-break"]:306,["grid-auto-flow"]:307,["overflow-anchor"]:308,["backdrop-filter"]:309,["--spritesheet-position"]:310,["-webkit-mask-position-x"]:311,["-webkit-mask-position-y"]:312,["no style present"]:313,["OTHERS"]:314,["animation"]:315,["background"]:316,["background-blur"]:317,["background-position"]:318,["background-repeat"]:319,["border-bottom"]:320,["border-color"]:321,["border-image"]:322,["border-left"]:323,["border-radius"]:324,["border-right"]:325,
["border-spacing"]:326,["border-style"]:327,["border-top"]:328,["border-width"]:329,["column-rule"]:330,["column-span"]:331,["columns"]:332,["flex"]:333,["flex-flow"]:334,["font"]:335,["font-size-adjust"]:336,["gap"]:337,["grid"]:338,["grid-area"]:339,["grid-auto-columns"]:340,["grid-auto-rows"]:341,["grid-column"]:342,["grid-column-gap"]:343,["grid-gap"]:344,["grid-row"]:345,["grid-row-gap"]:346,["grid-template"]:347,["isolation"]:348,["list-style"]:349,["outline"]:350,["overflow"]:351,["page-break-after"]:352,
["page-break-before"]:353,["page-break-inside"]:354,["place-content"]:355,["place-items"]:356,["place-self"]:357,["scroll-snap-align"]:358,["scroll-snap-stop"]:359,["scroll-snap-type"]:360,["shape-image-threshold"]:361,["shape-margin"]:362,["shape-outside"]:363,["text-combine-upright"]:364,["text-justify"]:365,["text-orientation"]:366,["text-underline-position"]:367,["transition"]:368,["perspective-origin-x"]:369,["perspective-origin-y"]:370,["scrollbar-width"]:371,["scroll-snap-coordinate"]:372,
["scroll-snap-destination"]:373,["scroll-snap-points-x"]:374,["scroll-snap-points-y"]:375,["scroll-snap-type-x"]:376,["scroll-snap-type-y"]:377,["text-emphasis"]:378,["text-underline-offset"]:379,["transform-box"]:380},zv={["a"]:1,["b"]:2,["big"]:3,["blockquote"]:4,["br"]:5,["caption"]:6,["center"]:7,["cite"]:8,["code"]:9,["col"]:10,["colgroup"]:11,["dd"]:12,["del"]:13,["dfn"]:14,["area"]:15,["base"]:16,["basefont"]:17,["frame"]:18,["hr"]:19,["img"]:20,["input"]:21,["link"]:22,["meta"]:23,["param"]:24,
["abbr"]:25,["acronym"]:26,["address"]:27,["bdo"]:28,["body"]:29,["button"]:30,["fieldset"]:31,["form"]:32,["frameset"]:33,["html"]:34,["noframes"]:35,["noscript"]:36,["optgroup"]:37,["q"]:38,["select"]:39,["textarea"]:40,["applet"]:41,["head"]:42,["iframe"]:43,["isindex"]:44,["map"]:45,["object"]:46,["script"]:47,["style"]:48,["title"]:49,["dir"]:50,["div"]:51,["dl"]:52,["dt"]:53,["em"]:54,["font"]:55,["h"]:56,["i"]:57,["ins"]:58,["kbd"]:59,["label"]:60,["legend"]:61,["li"]:62,["math"]:63,["menu"]:64,
["ol"]:65,["option"]:66,["p"]:67,["pre"]:68,["s"]:69,["samp"]:70,["small"]:71,["span"]:72,["strike"]:73,["strong"]:74,["sub"]:75,["sup"]:76,["tables"]:77,["tbody"]:78,["td"]:79,["text"]:80,["tfoot"]:81,["th"]:82,["thead"]:83,["tr"]:84,["tt"]:85,["u"]:86,["ul"]:87,["var"]:88,["OTHERS"]:89,["article"]:90,["aside"]:91,["audio"]:92,["bb"]:93,["canvas"]:94,["command"]:95,["datagrid"]:96,["datalist"]:97,["details"]:98,["dialog"]:99,["embed"]:100,["eventsource"]:101,["figcaption"]:102,["figure"]:103,["footer"]:104,
["h1"]:105,["h2"]:106,["h3"]:107,["h4"]:108,["h5"]:109,["h6"]:110,["header"]:111,["hgroup"]:112,["keygen"]:113,["mark"]:114,["meter"]:115,["nav"]:116,["output"]:117,["progress"]:118,["rp"]:119,["rt"]:120,["ruby"]:121,["section"]:122,["source"]:123,["table"]:124,["time"]:125,["track"]:126,["video"]:127,["wbr"]:128};class tj{constructor(){this.Tw=0;this.fKc=6;this.CJl=this.h3h=!1;this.D8e=null;this.p3h=this.o3h=this.n3h=this.j3h=this.i3h=!1;this.progId=null;this.Tmf=this.l3h=this.k3h=this.uoa=this.YOc=
this.DJl=this.EJl=!1;this.x1i=this.Vhc=0;this.f_i=this.platform=null;this.Nvi=this.y1d=!1;this.MTf=this.LTf=0;this.Gke=new Map;this.Mkk={["Excel Online"]:1,["Word Online"]:2,["PowerPoint Online"]:3,["OneNote Online"]:4,["Google Docs"]:5,["Excel"]:6,["Word"]:7,["PowerPoint"]:8,["OneNote"]:9,["Other"]:10};this.ogf=[1,3,4,2,5];this.Jvb={}}get $h(){if(null!=this.PDg)var b=this.PDg;else{var h;v.AFrameworkApplication.oe("h7cgh605;1hh5d387");b=this.PDg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:
h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isStyleUnitLoggingEnabled",!1)}return b}get QKm(){if(null!=this.qDg)var b=this.qDg;else{var h;b=this.qDg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isDNMLoggingForPasteEvent2Enabled",!1)}return b}get RKm(){if(null!=this.rDg)var b=this.rDg;else{var h;v.AFrameworkApplication.oe("diei0591;5a40j462");b=this.rDg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isDNMLoggingForPasteEvent3Enabled",
!1)}return b}get Vwi(){if(null!=this.pDg)var b=this.pDg;else{var h;b=this.pDg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isDNMLoggingForPasteEvent1Enabled",!1)}return b}get Oxi(){if(null!=this.xDg)var b=this.xDg;else{var h;b=this.xDg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isEmRemLoggingInPasteEnabled",!1)}return b}get nig(){if(null!==this.D8e)switch(this.D8e){case "XLO":return"Excel Online"}if(this.p3h)return"Word Online";
if(this.o3h||this.i3h)return"PowerPoint Online";if(this.h3h)return"Excel Online";if(this.j3h)return"Google Docs";if(this.n3h)return"OneNote Online";switch(this.progId){case "Word.Document":return"Word";case "OneNote.File":return"OneNote";case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}kJ(b,h){const r=new ha.a;r.name=b;"number"===typeof h?r.int64=h:"boolean"===typeof h?r.bool=h:"string"===typeof h&&(r.string=h);return r}Y8c(b,h,r){const B=new Vu.a;B.name=b;
B.dataFields=h;B.dnmInterval=r;B.dnmAllowedPartA=this.ogf;ea.a.sendDirectNumericEvent(B)}O7m(){if(this.$h)for(const [b,h]of this.Gke)for(const [r,B]of h){const P=[this.kJ("style",b),this.kJ("unit",r),this.kJ("frequency",B)];Object(Ke.a)("StylesAndUnitsFrequency",!0,0,P)}}M5m(){const b=this.aOk();if(this.QKm){var h=[];const r=[this.kJ("isUserConsumer",this.y1d),this.kJ("isDocumentBlank",this.Nvi),this.kJ("FoundText",this.Tmf),this.kJ("FoundTable",this.uoa),this.kJ("FoundImage",this.k3h),this.kJ("FoundList",
this.YOc),this.kJ("FoundLink",this.l3h),this.kJ("Browser",this.Vhc),this.kJ("SourceApp",this.Mkk[this.nig])];for(const B of r)h.push(B);this.Y8c("Office.DNM.Word.Online.ExternalPasteEvent2",h,2)}this.Oxi&&(h=[this.kJ("NumberOfEm",this.LTf),this.kJ("NumberOfRem",this.MTf)],Object(Ke.a)("NoOfTimesEmRemAppeared_PerPaste",!0,void 0,h));t.ULS.sendTraceTag(51406241,307,50,JSON.stringify(b))}D$k(b,h){var r,B;const P=[];b=this.kJ("tag",null!==(r=zv[b])&&void 0!==r?r:zv.OTHERS);h=this.kJ("style",null!==(B=
hw[h])&&void 0!==B?B:hw.OTHERS);B=this.kJ("IsUserConsumer",this.y1d);P.push(b);P.push(h);P.push(B);this.Y8c("Office.DNM.Word.Online.ExternalPasteEvent1",P,2)}E$k(b){var h;const r=[];b=this.kJ("tag",null!==(h=zv[b])&&void 0!==h?h:zv.OTHERS);h=this.kJ("IsUserConsumer",this.y1d);r.push(b);r.push(h);this.Y8c("Office.DNM.Word.Online.ExternalPasteEvent3",r,2)}N5m(){const b=this.Jvb;for(const B in b){var h=B,r=b[B];this.RKm&&this.E$k(h);if(this.Vwi)for(const P of Object.keys(r))this.D$k(h,P)}}QQa(b,h){b&&
b.length&&h&&h.length&&(b=b.toLowerCase(),h=h.toLowerCase(),b in this.Jvb||(this.Jvb[b]={}),this.Jvb[b][h]=this.Efm(b,h)+1)}Efm(b,h){if(!(b&&b.length&&h&&h.length&&this.Jvb&&b in this.Jvb))return 0;b=b.toLowerCase();h=h.toLowerCase();return(b=this.Jvb[b])&&h in b?b[h]:0}aOk(){const b={};b.ActionIdFlags=this.Tw;b.SourceApp=this.nig;b.CopySourceBrowser=this.fKc;b.PasteBrowser=this.Vhc;b.IsSameBrowserPaste=this.ZTm(this.fKc,this.Vhc);b.IsCrossBrowserPaste=this.EKm(this.fKc,this.Vhc);b.IsUncategorizedBrowserPaste=
this.OWm(this.fKc,this.Vhc);b.Platform=this.platform;b.OperationId=this.f_i;return b}ZTm(b,h){return 5===b||6===b?!1:b===h}EKm(b,h){return 6===b?!1:b!==h}OWm(b,h){return 5===b&&5===h}}Object(m.a)(tj,"HtmlContentMetadata",null,[]);var iw=c(248),ns=c(1463),Py=c(1078),Vp=c(377),Ym=c(136),JB=c(1711),CC=c(137);class co{get jo(){return null!=this.vHg?this.vHg:this.vHg=Ma.a.instance.Oa("Box4.Styles.StyleSettings")}constructor(b,h,r,B,P,ca,ra){this.u8b=ra;this.T2g=!1;this.vAj=this.cGe=null;this.MBn=Qa=>{kh.a.mark(5568);
this.YYh(Qa);let tb=this.MOi;if(this.nAi){const Mb=this.urj();Mb&&(tb=this.vob);t.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",Mb)}Qa.pi(tb);return!0};this.MOi=Qa=>{kh.a.mark(5569);var tb=new Ad.GraphIterator;this.G6a.restore(tb);var Mb=new Ad.GraphIterator;this.fmf.restore(Mb);this.fmf=null;t.ULS.shipAssertTag(6305489,307,Uf.OutlineElementReader.Eh(tb));t.ULS.shipAssertTag(6305490,307,Uf.OutlineElementReader.Eh(Mb));ig.OutlineElementNavigator.Ee(tb);var Zb=ke.ParagraphReader.oh(tb)?
ke.ParagraphReader.textLength(tb.currentNode):0;ig.OutlineElementNavigator.Yd(tb);ig.OutlineElementNavigator.Ee(Mb);t.ULS.shipAssertTag(6305491,307,ke.ParagraphReader.oh(Mb));var jc=ke.ParagraphReader.textLength(Mb.currentNode);ig.OutlineElementNavigator.Yd(Mb);let Gc=this.C$c;var Uc=new Nf.a;Uc.kd(tb);ig.OutlineElementNavigator.ns(Uc,!1,!1);var od=Uc.currentNode===Mb.currentNode,Od=!!this.yi&&!!(this.yi.Tw&8192);let ze=!1;if(!Od&&this.yi.vd&&Object(Ib.a)(fd.DictionaryPropertySet,this.yi.vd)){var de=
this.yi.vd.wf(Yc.a.tNb);Od=de&&""!==de?!0:!1}de=!1;this.yi.vd instanceof iw.APropertySet&&(de=this.yi.vd.ja(Yc.a.P4,!1));if(od){Zb=Ad.GraphIterator.eb(tb.currentNode);ke.ParagraphReader.Bt(ig.OutlineElementNavigator.Ee(Zb))||(tb=Mb);tb.currentNode.id!==Mb.currentNode.id&&(t.ULS.sendTraceTag(40691869,307,50,"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",fg.ListItemReader.lg(tb),fg.ListItemReader.lg(Mb)),Od=co.Pf.merge(tb,Mb,!0,Od),t.ULS.shipAssertTag(6305492,
307,Od));Mb=tb;var ee=!0}else{od=!!(this.yi.Tw&4);ee=this.Qd.xg&&od&&this.yi.o4a;var je=!!(this.yi.Tw&262144);this.o0f&&this.yi&&!od&&!je&&(this.o0f.Qmi(tb,!1),this.o0f.Qmi(Mb,!0));ig.OutlineElementNavigator.Ee(Uc);od=ke.ParagraphReader.oh(Uc)?ke.ParagraphReader.textLength(Uc.currentNode):0;ig.OutlineElementNavigator.Yd(Uc);zm.a.xr&&this.yi.Tw&65536||this.GGk(Uc,tb,Mb);je=new Nf.a;je.kd(Uc);ig.OutlineElementNavigator.ns(je,!1,!1);je.currentNode.id===Mb.currentNode.id&&(this.T2g=!0);if(this.xX.rOa||
this.Hso)if(je.Gn.id!==Mb.Gn.id){for(;Uc.currentNode.id!==Mb.currentNode.id;)ig.OutlineElementNavigator.Ee(Uc,!1),this.xX.IIa(Ue.a.create(Uc.currentNode)),Uc.uc(),ig.OutlineElementNavigator.ns(Uc,!1,!1);Uc.kd(tb);ig.OutlineElementNavigator.ns(Uc,!1,!1)}else ze=!0;this.MZ&&({C$c:Gc,wwa:Uc}=this.MZ.r3f(tb,Mb,Gc,Uc));CC.a.dL&&this.u8b&&(Uc=this.u8b.r3f(tb,Mb,Uc));if(this.yi.iee&&(t.ULS.shipAssertTag(6305493,307,this.yi.vdc),je=new Ad.GraphIterator,je.kd(Uc),je=ig.OutlineElementNavigator.Ee(je))){var ue=
this.yi.iee.vf(je.qa.J(0));je.qa.J(0).formatting=ue}je=0;Od&&this.hOe&&(je=1);ue=this.gto(tb,Uc,je);this.yi.mke=null;if(this.yi.Wja||this.yi.LVa)this.yi.mke=this.jfm(ue?tb.currentNode:Uc.currentNode,ue);var Qf=!1;ue&&(Qf=fg.ListItemReader.lg(tb),t.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",Qf,fg.ListItemReader.lg(Mb)),this.cGe=Qf=co.Pf.merge(tb,Uc,!0,Od,Mb,void 0,ze,ee,this.hOe),this.hto(tb,je)&&this.Jcn(tb,Mb,je,Od));je=co.aCn.PBm(tb,
Uc,Mb,Zb,Qf,this.yWc);var Jg=!1;if(Gc){const Ql=new Nf.a;Ql.kd(Mb);ig.OutlineElementNavigator.h1(Ql,!1,!1);Jg=fg.ListItemReader.lg(Ql);const Fm=fg.ListItemReader.lg(Mb),Kp=de;t.ULS.sendTraceTag(509661707,307,50,"preserve EOP formatting : {0}",Kp);ee=co.Pf.merge(Ql,Mb,!0,Od,void 0,!0,void 0,ee,this.hOe,Kp);t.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",Jg,Fm,ee?"True":"False, will cause IP to reset to zero.");
Mb=(Jg=ee)?Ql:Mb}else ee=!1,t.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero.");this.xX.rOa&&ze&&(ue&&!this.aNm(je,Qf)?(Uc=new Ad.GraphIterator,Uc.kd(tb),tb=ig.OutlineElementNavigator.Ee(Uc),this.xX.pra(tb,Zb,Zb+od)):Gc&&!this.LPm(je,Jg)?(tb=new Ad.GraphIterator,tb.kd(Uc),tb=ig.OutlineElementNavigator.Ee(tb),this.xX.pra(tb,0,od)):(tb=new Ad.GraphIterator,tb.kd(Uc),tb=ig.OutlineElementNavigator.Ee(tb),this.xX.IIa(Ue.a.create(tb))));this.xFn(je);this.B9&&!Od&&this.VH.yJn(je)}t.ULS.shipAssertTag(6305494,
307,Mb.isValid);Od=ig.OutlineElementNavigator.Ee(Mb);jc=ee?ke.ParagraphReader.textLength(Od)-jc:0;this.yi.WEa=de?og.SelectionFactory.lJ(Od,jc-1,jc):og.SelectionFactory.ne(Od,jc);this.yi&&this.yi.vdc&&ke.ParagraphReader.Xb(Od)&&this.yi.A9d&&((jc=this.yi.A9d.WEo)&&this.uE.aK(jc,Od,!0),(jc=this.yi.A9d.HAn)&&this.Tk.Xuh(Od,jc));Qa.pi(this.vob);return!0};this.Eno=Qa=>{const tb=Ad.GraphIterator.eb(this.vAj);tb.EJ(1);this.yi.WEa=og.SelectionFactory.ro(tb.currentNode,!1);Qa.pi(this.vob);return!0};this.vob=
()=>{var Qa=void 0===this.yi.Tw||null===this.yi.Tw?"not available":Object(ns.a)(JB.a,this.yi.Tw);t.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.yi.Tw,Qa);t.ULS.shipAssertTag(6305497,307,!!this.yi.WEa);this.yWc?Object(Ke.a)("ExternalPasteAction",!0):Object(Ke.a)("InternalPasteAction",!0);this.G6a&&(Qa=new Ad.GraphIterator,this.G6a.restore(Qa),this.G6a=null,this.brm(Qa));this.transaction.dispose();go.a.ERa&&go.a.V6m();Qa=this.gu.iu;if(!Qa.ue||!Qa.xe.$j)return!1;Qa.xe.HIo();return!1};
this.vGa=b;this.fmf=this.G6a=null;this.yi=h;this.transaction=r;this.MZ=B;this.gu=P;this.h7=ca}get K(){return v.AFrameworkApplication.K}get hOe(){return!!this.K&&this.K.$("PasteTextOnlyKeepDestinationStyleIsEnabled")}get VH(){return null!=this.lAg?this.lAg:this.lAg=Ma.a.instance.resolve("Box4.IFontStylesGalleryCache")}get B9(){return this.jo&&this.jo.B9}get uE(){return null!=this.NJg?this.NJg:this.NJg=Ma.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get qc(){return null!=this.pKg?this.pKg:this.pKg=
Ma.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Tk(){return null!=this.UFg?this.UFg:this.UFg=Ma.a.instance.resolve("Box4.IParagraphEditor")}get Jd(){return null!=this.BEg?this.BEg:this.BEg=Ma.a.instance.resolve("Box4.List.IListReader")}get Qn(){return null!=this.nEg?this.nEg:this.nEg=Ma.a.instance.resolve("Box4.List.IListEditor")}get xR(){return null!=this.WAg?this.WAg:this.WAg=Ma.a.instance.resolve("Box4.IBox4GraphWriter")}get qad(){return null!=this.$Gg?this.$Gg:this.$Gg=Ma.a.instance.Oa("Box4.List.ISingleLevelListEditor")}get Ej(){return null!=
this.FIg?this.FIg:this.FIg=Ma.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get Gh(){return null!=this.eJg?this.eJg:this.eJg=Ma.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}get Qd(){return null!=this.OIg?this.OIg:this.OIg=Ma.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get xX(){return null!=this.Qwg?this.Qwg:this.Qwg=Ma.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor")}get o0f(){return null!=this.fGg?this.fGg:
this.fGg=Ma.a.instance.Oa("Box4.IPastedParagraphSpaceHandler")}get F1i(){return!1}ZYh(){}get yWc(){return!1}r1i(b){var h=void 0===this.yi.Tw||null===this.yi.Tw?"not available":Object(ns.a)(JB.a,this.yi.Tw);t.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",this.yi.Tw,h);t.ULS.shipAssertTag(6305487,307,xe.SelectionEditor.Ze(this.vGa));if(this.e6d)return t.ULS.sendTraceTag(6305488,307,50,"NothingToPaste"),this.yi.WEa=og.SelectionFactory.Zn(this.vGa),b.pi(this.vob),!0;if(!this.vGa.node)return t.ULS.sendTraceTag(572330334,
307,10,"Something's wrong! The IP is pointing to a null node. Aborting paste"),!1;h=new Ad.GraphIterator;h.set(this.vGa.node);xe.SelectionEditor.zu(h);ig.OutlineElementNavigator.Yd(h);this.vAj=h.origin;if(this.F1i)return h.rt(10),this.ZYh(h,b),b.pi(this.Eno),!0;this.MZ&&this.MZ.Hln(this.vGa);if(!this.RBo(this.vGa))return this.yi.cS&&(this.yi.cS.fail("SplitLine Failed",!0),this.yi.failed=!0),this.yi.WEa=og.SelectionFactory.Zn(this.vGa),b.pi(this.vob),!0;const r=new Nf.a;r.kd(h);ig.OutlineElementNavigator.ns(r,
!1,!1);this.G6a=new Py.a(h);this.fmf=new Py.a(r);b.pi(this.MBn);return!0}urj(){return!1}get nAi(){return this.K.$("PptCcpFix2IsEnabled")}get Hso(){return this.K.$("CopyAndPasteOneParagraphIndentationFixIsEnabled")}aNm(b,h){return!h&&!!b&&Uf.OutlineElementReader.Eh(b.wwa)&&Uf.OutlineElementReader.qgb(b.wwa)}LPm(b,h){return!h&&!!b&&Uf.OutlineElementReader.Eh(b.fmb)&&Uf.OutlineElementReader.qgb(b.fmb)}xFn(b){co.o3i&&b&&co.o3i.uJn(b)}gto(b,h,r){var B;fg.ListItemReader.lg(b)?(null===(B=this.qad)||void 0===
B?void 0:B.lBf(b),h=fg.ListItemReader.lg(h)?this.Oqj:!0):Uf.OutlineElementReader.isEmpty(b,!0)&&!r?(co.Pf.r1a(b),h=!1):h=!0;this.MZ&&(h=this.MZ.XWk(b,h));return h}hto(b,h){return fg.ListItemReader.lg(b)||1===h?!0:!1}Jcn(b,h,r,B){const P=fg.ListItemReader.lg(b);if(P){if(B=new Nf.a,B.kd(b),ig.OutlineElementNavigator.ns(B,!1,!1),B.Gn.id!==h.Gn.id){r=this.Jd.vw(b);this.Jd.HP(b);var ca=b.currentNode.ja(Mc.a.listID,0);b.uc();var ra=this.Jd.fuj,Qa=!0;for(r.gC=gk.a.im;B.currentNode.id!==h.currentNode.id;){if(!ra||
!Uf.OutlineElementReader.Kuo(B))if(!fg.ListItemReader.lg(B))Ym.a.getInstance().Ov?(Uf.OutlineElementReader.Iac(B)||({txa:r}=this.Qn.Uma(r.propertySet,B,r)),this.Qn.r6()):{txa:r}=this.Qn.Uma(r.propertySet,B,r),Qa=!1;else if(P){Qa=this.Jd.hsf(B);var tb=this.Jd.Mx(b.currentNode,ca,Qa);tb=tb?Vp.a.z8(tb,null):r;Qa=Vp.a.c0(tb.listType,r.listStyle,null,0,Qa,"","");Qa.tnb=b.currentNode;this.Qn.jmo(Qa);this.Qn.lhe(B,!0);Qa=!1}ig.OutlineElementNavigator.ns(B,!1,!1)}ra&&Qa&&this.Qn.PIk()}}else if(1===r)for(r=
new Nf.a,r.kd(b),ig.OutlineElementNavigator.Ee(r),b=ke.ParagraphReader.oh(r)?r.currentNode:null,ca=this.qc.Xuf(r),ig.OutlineElementNavigator.Yd(r),ig.OutlineElementNavigator.ns(r,!1,!1);r.currentNode.id!==h.currentNode.id;)ig.OutlineElementNavigator.Ee(r),ra=ke.ParagraphReader.oh(r)?r.currentNode:null,ig.OutlineElementNavigator.Yd(r),ra&&b&&B&&(ca&&this.uE.aK(ca,ra,!0),this.h7.XOi(b,ra,P),this.h7.jHa(b,ra,1,!0)),ig.OutlineElementNavigator.ns(r,!1,!1)}GGk(b,h,r){var B=!1;if(this.Qd.xg)if(zm.a.xr)B=
!0;else{var P=!1;this.MZ&&(P=h.currentNode,P=this.MZ.nSm(P)||this.MZ.YGf(P));P?this.Qd.C6a=4:B=!0}if(B){for(;b.currentNode!==r.currentNode;){ig.OutlineElementNavigator.Ee(b,!1);B=this.Gh.Ead(Ue.a.create(b.currentNode));let ca;({type:ca}=B.gVd()).returnValue&&this.Qd.Zs(ca);for(P=0;P<B.length;P++){let ra;const Qa=({s1d:ra}=B.getContext(P)).returnValue;ra&&(co.hp.lnb(Qa,1),this.Ej.iqb(Qa,1,null,!0))}b.uc();ig.OutlineElementNavigator.ns(b,!1,!1)}b.kd(h);ig.OutlineElementNavigator.ns(b,!1,!1)}}jfm(b,
h){b=Ad.GraphIterator.eb(b);ig.OutlineElementNavigator.Ee(b);return ke.ParagraphReader.Xb(b.currentNode)?(h=h?ke.ParagraphReader.textLength(b.currentNode):0,og.SelectionFactory.ne(b.currentNode,h)):Rh.TableReader.KR(b.currentNode)?og.SelectionFactory.Eq(b.currentNode):null}brm(b){if(b){if(this.yWc&&Rh.TableReader.lx(b)&&this.T2g){if(null!=this.cGe&&0==this.cGe){var h=new Nf.a;h.kd(b);ig.OutlineElementNavigator.ns(h,!1,!1);b.kd(h)}h=qn.a.u4n(b);const r=ke.ParagraphReader.al(h);h&&r&&(this.yi.WEa=og.SelectionFactory.ne(r,
0),b=Ad.GraphIterator.eb(h))}else co.jSm&&qn.a.UBn(b);b&&Rh.TableReader.lx(b)&&Kf.returnToContainingCell(b)&&qn.a.wAk(b.currentNode)}else t.ULS.sendTraceTag(525361991,3022,50,"Preceding iterator should not be null.")}Gro(b,h){const r=new Ad.GraphIterator;r.kd(b);b=ig.OutlineElementNavigator.Ee(r);h=ke.ParagraphReader.Xb(b)&&h===ke.ParagraphReader.textLength(b);t.ULS.sendTraceTag(50384992,307,50,"IsPasteAtEndofParagraph: {0}",h);return h}RBo(b){var h;t.ULS.shipAssertTag(6305498,307,xe.SelectionEditor.Ze(b));
if(null===(h=this.xR)||void 0===h?0:h.Jqb)return!!this.xR.Jqb(b.node,b.cpBegin,{eKl:!0,Fb:b.Fb,Sb:b.Sb});h=Ad.GraphIterator.eb(b.node);var r=h.qd();ig.OutlineElementNavigator.Yd(h);r&&b.isValid||t.ULS.sendTraceTag(40425481,307,15,"sourceOE GraphIterator setup. {0}",{["tryToRootAtOutlineAncestorSuccess"]:r,["ipContextNodeType"]:b.node.type,["isValidIpContext"]:b.isValid});if(!Uf.OutlineElementReader.Eh(h)&&(t.ULS.sendTraceTag(594072134,307,10,"sourceOE is not an OutlineElement"),this.K.$("AbortClipboardOperationWhenFailToRootAtOEIsEnabled")))return!1;
r=co.Pf.npa(h,!0);const B=this.Gro(h,b.cpBegin);co.Pf.S$(h,r,b,!1,!1,!0,B);return!0}static get hp(){return null!=co.dBg?co.dBg:co.dBg=Ma.a.instance.resolve("Box4.IHyperlinkEditor")}static get Hi(){return si.PageReader.instance}static get Pf(){return null!=co.fFg?co.fFg:co.fFg=Ma.a.instance.resolve("Box4.IOutlineElementEditor")}static get tq(){return Ym.a.getInstance()}static get Zb(){return null!=co.tzg?co.tzg:co.tzg=Ma.a.instance.Oa("Box4.IFeatureHelper")}static get o3i(){return null!=co.lGg?co.lGg:
co.lGg=Ma.a.instance.resolve("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste")}static get aCn(){return null!=co.eGg?co.eGg:co.eGg=Ma.a.instance.resolve("Box4.Actors.PastedContentsPostProcessorHelper")}static get jSm(){null==this.VGe&&(v.AFrameworkApplication.oe("PasteTableBelowTableNewExperience;PasteTableBelowTableNewExperienceCf"),this.VGe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBelowTableNewExperienceIsEnabled",!1):
!1);return this.VGe}}co.VGe=null;Object(m.a)(co,"APasteExecutionManager",null,[]);class JA{constructor(b){this.Tj=b}reset(){this.Tj.reset()}get vLc(){return this.Tj.vLc}Jda(b,h){this.Tj.Jda(b,h)}Ida(b){this.Tj.Ida(b)}Xnb(b){this.Tj.Xnb(b)}xya(b){this.Tj.xya(b)}BHa(b){this.Tj.BHa(b)}MSa(b,h){this.Tj.MSa(b,h)}LSa(){this.Tj.LSa()}jE(b){this.Tj.jE(b)}AF(){this.Tj.AF()}Snb(){this.Tj.Snb()}Rnb(){this.Tj.Rnb()}Bya(b){this.Tj.Bya(b)}zya(){this.Tj.zya()}FHa(b){this.Tj.FHa(b)}Aya(){this.Tj.Aya()}k6a(b){this.Tj.k6a(b)}b$(b){this.Tj.b$(b)}Z9(){this.Tj.Z9()}u5(b){this.Tj.u5(b)}a$(){this.Tj.a$()}Y9(b){this.Tj.Y9(b)}X9(){this.Tj.X9()}RSa(b,
h){this.Tj.RSa(b,h)}i6a(){this.Tj.i6a()}}Object(m.a)(JA,"AHtmlNormalizer",null,[239,240]);class KB extends JA{constructor(b){super(b);this.WJ=!1}Jda(b,h){this.WJ?this.kN.IM(()=>{this.E3f(b,h)}):this.E3f(b,h)}E3f(b,h){this.Tj.Jda(b,h)}Ida(b){this.WJ?this.kN.IM(()=>{this.h3f(b)}):this.h3f(b)}h3f(b){this.Tj.Ida(b)}xya(b){this.WJ?this.kN.IM(()=>{this.B4c(b)}):this.B4c(b)}B4c(b){this.Tj.xya(b)}BHa(b){this.WJ?this.kN.IM(()=>{this.f3f(b)}):this.f3f(b)}f3f(b){this.Tj.BHa(b)}MSa(b,h){this.WJ?this.kN.IM(()=>
{this.a3f(b,h)}):this.a3f(b,h)}a3f(b,h){this.Tj.MSa(b,h)}LSa(){this.WJ?this.kN.IM(Object(z.a)(this,this.$2f,"processAnchorEnd")):this.$2f()}$2f(){this.Tj.LSa()}jE(b){this.WJ?this.kN.IM(()=>{this.q3f(b)}):this.q3f(b)}q3f(b){this.Tj.jE(b)}AF(){this.WJ?this.kN.IM(Object(z.a)(this,this.p3f,"processParagraphEnd")):this.p3f()}p3f(){this.Tj.AF()}Snb(){this.WJ?this.kN.IM(Object(z.a)(this,this.t3f,"processPreFormattedTextStart")):this.t3f()}t3f(){this.Tj.Snb()}Rnb(){this.WJ?this.kN.IM(Object(z.a)(this,this.s3f,
"processPreFormattedTextEnd")):this.s3f()}s3f(){this.Tj.Rnb()}Bya(b){this.WJ?this.kN.IM(()=>{this.l3f(b)}):this.l3f(b)}l3f(b){this.Tj.Bya(b)}zya(){this.WJ?this.kN.IM(Object(z.a)(this,this.i3f,"processListEnd")):this.i3f()}i3f(){this.Tj.zya()}FHa(b){this.WJ?this.kN.IM(()=>{this.k3f(b)}):this.k3f(b)}k3f(b){this.Tj.FHa(b)}Aya(){this.WJ?this.kN.IM(Object(z.a)(this,this.j3f,"processListItemEnd")):this.j3f()}j3f(){this.Tj.Aya()}b$(b){this.WJ?this.kN.IM(()=>{this.D3f(b)}):this.D3f(b)}D3f(b){this.Tj.b$(b)}Z9(){this.WJ?
this.kN.IM(Object(z.a)(this,this.A3f,"processTableEnd")):this.A3f()}A3f(){this.Tj.Z9()}u5(b){this.WJ?this.kN.IM(()=>{this.C3f(b)}):this.C3f(b)}C3f(b){this.Tj.u5(b)}a$(){this.WJ?this.kN.IM(Object(z.a)(this,this.B3f,"processTableRowEnd")):this.B3f()}B3f(){this.Tj.a$()}Y9(b){this.WJ?this.kN.IM(()=>{this.z3f(b)}):this.z3f(b)}z3f(b){this.Tj.Y9(b)}X9(){this.WJ?this.kN.IM(Object(z.a)(this,this.y3f,"processTableCellEnd")):this.y3f()}y3f(){this.Tj.X9()}RSa(b,h){this.WJ?this.kN.IM(()=>{this.n3f(b,h)}):this.n3f(b,
h)}n3f(b,h){this.Tj.RSa(b,h)}i6a(){this.WJ?this.kN.IM(Object(z.a)(this,this.W4i,"processMathEnd")):this.W4i()}W4i(){this.Tj.i6a()}}Object(m.a)(KB,"AQueuingHtmlNormalizer",JA,[]);var DC=c(2001);class Qy{constructor(){this.HPe=new DC.a}IM(b){this.HPe.enqueue(b)}flush(b=!1){for(b&&this.Dge();!this.HPe.isEmpty;)this.HPe.dequeue()();b&&this.xee()}Dge(){}xee(){}}Object(m.a)(Qy,"QueuedEventManager",null,[]);class Av extends Qy{constructor(b){super();this.id=void 0;this.edf=null;this.C_d=!1;this.Gqa="";this.B_d=
this.u0d=!1;this.Vcf=this.o6b=null;this.j1c=0;this.hXc=this.LYc=this.OIf=!1;this.table=null;this.gTf=0;this.g_=b}get tGc(){return!!this.table}Dge(){this.g_.xhc.push(this.g_.currentState);this.g_.currentState=this}xee(){this.g_.currentState=this.g_.xhc.pop()}}Av.nextId=void 0;Object(m.a)(Av,"ContentState",Qy,[]);class jw{constructor(b,h,r){this.colSpan=b.colSpan;this.rowSpan=b.rowSpan;this.width=b.width;this.height=b.height;this.P4a=b.P4a;this.shadingColor=b.shadingColor;this.verticalAlignment=b.verticalAlignment;
this.ska=b.ska;this.mle=b.mle;this.Wdc=b.Wdc;this.l8=b.l8;this.contents=r;this.rmm=h}}Object(m.a)(jw,"TableCell",null,[]);var EC=c(1713),kw=c(1714);class Bv extends Qy{constructor(b,h){super();this.g_=b;this.Pih=new ar.a;this.ila=new ar.a;this.SKe=[];this.ewd=[];this.aLa=-1;this.LWa=0;this.e8j=h.EDf;this.d8j=h.TIm;this.Ilk=h.Qkg;this.Op=h.width;this.I2g=h.P4a;this.j5j=new br.a(new Mo(h.f$.Hpi,h.f$.SWd),h.LB,h.Kya,h.cultureName,h.YCa);this.Y6j=h.EXd;this.Hyd=h.styleId;this.Nlk=h.tableLook}get Tj(){return this.g_.Tj}SGn(b){this.aLa++;
this.Pih.add(b);this.ewd[this.aLa]=b.height;this.LWa=0}get ahl(){for(;this.LWa>=this.ila.count;)this.ila.add(Array(this.aLa+1));return this.ila.J(this.LWa)}vrk(b,h,r,B,P,ca,ra){if(0>this.aLa)return!1;for(;this.SKe[this.LWa]>=this.aLa;)this.LWa++;b=new jw(b,new br.a(h,r,B,P,ca),ra);this.ahl[this.aLa]=b;if(1<b.rowSpan)for(h=this.aLa+b.rowSpan-1,B=this.LWa,r=this.LWa+b.colSpan-1;B<=r;B++)this.SKe[B]>=h||(this.SKe[B]=h);this.LWa+=b.colSpan;this.ewd[this.aLa]<b.height&&(this.ewd[this.aLa]=b.height);return!0}Dge(){this.g_.currentState.table=
this}xee(){this.g_.currentState.table=null}M1h(){v.AFrameworkApplication.oe("fd8b6402;j6e17681");this.flush(!0);const b=this.aLa+1;var h=Array(b);for(var r=0;r<b;r++)h[r]=Array(this.ila.count);r=!0;var B=0;for(var P=0;P<this.ila.count;P++){var ca=this.ila.J(P),ra=!0;for(var Qa=0;Qa<b;Qa++){var tb=ca[Qa];tb&&(ra=!1,h[Qa][P+B]=new fw(tb.colSpan,tb.rowSpan,tb.width,tb.height,void 0,void 0,void 0,void 0,tb.P4a,tb.Wdc))}ra?(this.ila.removeAt(P),P--,++B):r=!1}if(!r){(h=this.I2g?this.g_.mBh(h,this.Op/100):
this.g_.mBh(h,1,this.Op))&&h.length!==this.ila.count&&(h=null);this.g_.Mhb(!0);this.g_.LGd();this.Tj.b$(new Ow(b,this.ila.count,this.Op,this.I2g,h,this.e8j,this.d8j,this.Ilk,this.Y6j,this.Hyd,this.Nlk,this.j5j));for(h=0;h<b;h++){r=this.Pih.J(h);this.Tj.u5(new vj(this.ewd[h],new br.a(r.f$,r.LB,r.Kya,r.cultureName,r.YCa)));for(r=0;r<this.ila.count;r++){B=this.ila.J(r)[h];var Mb=!!this.Hyd&&""!==this.Hyd&&"Custom"!==this.Hyd;P=B?B.colSpan:0;ca=B?B.rowSpan:0;B&&(P=Math.min(B.colSpan,this.ila.count-r),
ca=Math.min(B.rowSpan,b-h));ra=B?B.width:0;Qa=B?B.height:0;tb=B?B.l8:0;const Zb=B?B.P4a:!1,jc=B&&(65536&tb||!Mb)?B.shadingColor:"",Gc=B?B.verticalAlignment:0,Uc=B?B.Wdc:!1;Mb=B?this.g_.X6l(B.ska,r,h,this.ila,Mb,B.l8):new EC.a;const od=B?B.mle:new kw.a,Od=B?B.rmm:null;this.Tj.Y9(new fw(P,ca,ra,Qa,jc,Gc,Mb,od,Zb,Uc,tb,new br.a(Od?Od.f$:null,Od?Od.LB:null,Od?Od.Kya:null,Od?Od.cultureName:null,Od?Od.YCa:null)));B&&!B.Wdc&&(B.contents.Dge(),B.contents.flush(),this.g_.Mhb(!1),this.g_.LGd(),B.contents.xee());
this.Tj.X9()}this.Tj.a$()}this.Tj.Z9();this.g_.currentState.hXc=!1;this.g_.RXh(!1)}}}Object(m.a)(Bv,"NormalizedTable",Qy,[]);class Tx{constructor(b=!1,h=!1){this.O8j=b;this.wma=h}get YOm(){return this.O8j}get u8a(){return this.wma}}Object(m.a)(Tx,"HtmlNormalizerSettings",null,[342]);class Nq extends KB{constructor(b,h=null){super(b);this.OHe=null;this.xhc=new lu;this.MXb=h||new Tx}reset(){super.reset();this.currentState=new Av(this);this.xhc.clear();this.WJ=!1}get kN(){return this.currentState&&this.currentState.tGc?
this.currentState.table:this.currentState}bNd(b=!1){this.currentState.C_d||(this.LGd(),this.Tj.jE(this.currentState.edf),this.currentState.C_d=!0,this.currentState.hXc=!1);b||!this.currentState.o6b||this.currentState.B_d||(this.Tj.MSa(this.currentState.o6b,this.currentState.Vcf),this.currentState.B_d=!0)}vNc(){this.currentState.B_d&&(this.Tj.LSa(),this.currentState.B_d=!1)}nxl(){this.currentState.C_d&&(this.Tj.AF(),this.currentState.C_d=!1,this.currentState.Gqa="")}RXh(b){this.currentState.LYc&&(this.currentState.hXc?
b||(this.Tj.jE(null),this.Tj.AF(),this.Tj.Aya(),this.currentState.LYc=!1):(this.Tj.Aya(),this.currentState.LYc=!1,this.currentState.hXc=!0))}Mhb(b){this.vNc();this.nxl();this.RXh(b)}rxn(b){this.Tj.Bya(new xp.a(2,1,b));this.currentState.j1c++;this.currentState.OIf=!0}LGd(){!this.currentState.LYc&&this.currentState.OIf&&(this.Tj.zya(),this.currentState.j1c--,this.currentState.OIf=!1)}E3f(b,h){b=this.ain(b);if(""!==b)if(this.bNd(),this.currentState.u0d)this.F3f(b,h);else{b=b.split(Nq.mQk);for(let r=
0;r<b.length-1;r++)this.F3f(b[r],h),this.Tj.Xnb(h);this.F3f(b[b.length-1],h)}}n3f(b,h){""!==b&&(this.bNd(),this.Tj.RSa(b,h))}h3f(b){this.MXb.u8a||this.vNc();this.bNd(!0);this.Tj.Ida(b)}f3f(b){this.currentState.tGc||this.Tj.BHa(b)}B4c(b){this.currentState.o6b&&(b.href=this.currentState.o6b);super.B4c(b)}a3f(b,h){this.vNc();this.currentState.o6b=b;this.currentState.Vcf=h}$2f(){this.vNc();this.currentState.o6b=null;this.currentState.Vcf=null}q3f(b){this.currentState.edf=b;this.Mhb(!0)}p3f(){this.currentState.edf=
null;this.Mhb(!0)}t3f(){this.currentState.u0d=!0}s3f(){this.currentState.u0d=!1}l3f(b){this.Mhb(!1);this.LGd();this.Tj.Bya(b);this.currentState.j1c++}i3f(){this.Mhb(!1);this.Tj.zya();this.currentState.j1c--}k3f(b){this.Mhb(!1);this.currentState.j1c||this.rxn(b);this.Tj.FHa(b);this.currentState.LYc=!0;this.currentState.hXc=!0}j3f(){this.Mhb(!1)}b$(b){this.currentState.tGc||(this.WJ=!0,this.currentState.table=new Bv(this,b))}D3f(){}Z9(){if(this.currentState.table){var b=this.currentState.table;this.currentState.table=
null;this.xhc.isEmpty?(this.WJ=!1,b.M1h()):this.kN.IM(Object(z.a)(b,b.M1h,"flushTable"))}}A3f(){}u5(b){this.currentState.tGc&&this.currentState.table.SGn(b)}C3f(){}a$(){}B3f(){}Y9(b){let h=!1;if(this.currentState.tGc){const r=new Av(this);this.currentState.table.vrk(b,new Mo(b.f$.Hpi,b.f$.SWd),b.LB,b.Kya,b.cultureName,b.YCa,r)?(this.xhc.push(this.currentState),this.currentState=r):h=!0}else h=!0;h&&this.currentState.gTf++}z3f(){}X9(){0<this.currentState.gTf?this.currentState.gTf--:this.currentState=
this.xhc.pop()}y3f(){}mBh(b,h=1,r=0){if(!b)return null;const B=b.length;if(!B)return null;const P=b[0].length;for(var ca=1;ca<B;ca++)if(b[ca].length!==P)return null;ca=Array(P+1);ca[0]=0;const ra=Array(P+1);for(var Qa=0;Qa<ra.length;Qa++)ra[Qa]=!1;const tb=new mb.a;Qa=0;for(let Zb=0;Zb<P;Zb++){for(var Mb=0;Mb<B;Mb++){const jc=b[Mb][Zb];if(jc&&0<jc.width){const Gc=Math.min(Zb+jc.colSpan,P);ca[Gc]=ca[Zb]+jc.width*(jc.P4a?h:1);ra[Gc]=!0}}if(ra[Zb+1]){Mb=ca[Zb+1]-ca[Zb];if(0>=Mb)return null;tb.add(Mb)}else ca[Zb+
1]=ca[Zb],0<r&&this.ADi&&(tb.add(-1),Qa++)}b=tb.toArray();if(0<Qa&&0<r&&this.ADi)for(t.ULS.sendTraceTag(509125462,3022,50,"CalculateTableWidths: All Table Column width not set"),r=(r-ca[ca.length-1])/Qa,h=0;h<b.length;h++)-1===b[h]&&(b[h]=r);return b}get ADi(){null==this.OHe&&(v.AFrameworkApplication.oe("2i46g603;2fc7g589"),this.OHe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixTableColumnWidthCalculationInCCP",!1):!1);return this.OHe}yan(b,
h){1&h||(b.borderTopStyle=12);16&h||(b.borderRightStyle=12);256&h||(b.borderBottomStyle=12);4096&h||(b.borderLeftStyle=12);return b}X6l(b,h,r,B,P,ca){if(!b)return null;P&&(b=this.yan(b,ca));if(0>r||0>h||h>B.count-1)return b;0<=h-1&&r<=B.J(h-1).length-1&&1===b.borderLeftStyle&&(P=B.J(h-1)[r])&&1!==P.ska.borderRightStyle&&(b.borderLeftStyle=P.ska.borderRightStyle,b.borderLeftColor=P.ska.borderRightColor,b.borderLeftWidth=P.ska.borderRightWidth);0<=r-1&&r<=B.J(h).length-1&&1===b.borderTopStyle&&(h=B.J(h)[r-
1])&&1!==h.ska.borderBottomStyle&&(b.borderTopStyle=h.ska.borderBottomStyle,b.borderTopColor=h.ska.borderBottomColor,b.borderTopWidth=h.ska.borderBottomWidth);return b}ain(b){this.currentState.u0d||(b=this.MXb.YOm?b.replace(Nq.nwm," "):b.replace(Nq.mwm," "));b.startsWith(" ")&&(this.currentState.Gqa.endsWith(" ")||""===this.currentState.Gqa)&&(b=F.a.substring(b,1,b.length));return b}F3f(b,h){""!==b&&(this.Tj.Jda(b,h),this.currentState.Gqa+=b)}}Nq.mwm=RegExp("[ \t\f\u200b\r\n]+","g");Nq.nwm=RegExp("[ \f\u200b\r\n]+",
"g");Nq.mQk="\t";Object(m.a)(Nq,"DefaultHtmlNormalizer",KB,[]);class Lz extends Nq{constructor(b,h,r){super(b,r);this.CYg=!1;this.Ovb=h}static kLm(b){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerImageUrl",!1)&&b?(b=Lz.pml.exec(b))&&0<b.length:!1}B4c(b){this.Ovb.dic&&(v.AFrameworkApplication.bqa?this.CYg||(b=new Tf.StandardDialog,b.Cd=0,b.ze(1,CommonUIStrings.l_DialogClose),b.rv(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,
1,null),this.CYg=!0):this.Ovb.eOi?this.Ovb.A4d=!0:b.src&&""!==b.src?ia.a.getOrigin(b.src)!==ia.a.getOrigin(window.location.href)||Lz.kLm(b.src)?b.src.startsWith("data:")&&19922944<b.src.length?v.AFrameworkApplication.va.processAction(Nb.a.A1i,2):b.src.startsWith("webkit-fake-url")?v.AFrameworkApplication.va.processAction(Nb.a.z1i,2):(this.vNc(),this.bNd(!0),this.Tj.xya(b)):v.AFrameworkApplication.va.processAction(Nb.a.C1i,2):v.AFrameworkApplication.va.processAction(Nb.a.B1i,2))}}Lz.pml=RegExp(".\\/we\\/s\\/\\d+_resources\\/\\d+\\/\\D.+(.png|.jpg)");
Object(m.a)(Lz,"Box4HtmlNormalizer",Nq,[]);class LB{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb){this.htmlProcessor=b;this.MAf=h;this.kVk=r;this.sLj=B;this.zJl=P;this.xdo=ca;this.ydo=ra;this.STc=Qa;this.fwm=tb;this.iwm=Mb;this.p_c=Zb}}Object(m.a)(LB,"ExecutePasteArguments",null,[]);class Cv extends co{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc,Uc,od,Od,ze){super(h,r,B,Mb,jc,od,ze);this.j3=null;this.Uhn=de=>{this.tnd.LFi(this.$aa)&&v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordRemoveSpacesAfterEndFragmentSettings");
this.Ujk&&this.tnd.DOo(this.$aa);de.pi(this.XGn);return!0};this.XGn=de=>{if(this.hjk){const ee=this.$aa.getElementsByTagName("style");if(ee&&0<ee.length){t.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let je=0;je<ee.length;je++)this.cBe.C7k(this.$aa,ee[je]),ee[je]&&(ee[je].parentNode.removeChild(ee[je]),je--)}}de.pi(this.P7k);return!0};this.P7k=(de,ee)=>{this.wYe.value.create(ee.sLj).process(this.$aa,de);(ee=Ma.a.instance.Oa("Box4.IFeatureHelper"))&&
ee.isFeatureEnabled(10)?de.pi(this.X6k):de.pi(this.Q4i);return!0};this.X6k=(de,ee)=>{(new tu(ee.kVk)).process(this.$aa,de);de.pi(this.Q4i);return!0};this.Q4i=(de,ee)=>{var je;if(Wk.FXc&&!document.getElementById("FrameContainingPastedDOM")){var ue=window.performance.now(),Qf=document.createElement("iframe");Qf.style.display="none";Qf.style.contain="strict";Qf.setAttribute("sandbox","allow-same-origin");Qf.id="FrameContainingPastedDOM";document.body.appendChild(Qf);go.a.ERa&&(go.a.ycf=window.performance.now()-
ue)}Qf=null;Wk.FXc&&(Qf=document.getElementById("FrameContainingPastedDOM"));Wk.FXc&&Qf instanceof HTMLIFrameElement?(ue=0,go.a.ERa&&(ue=window.performance.now()),Qf=null===(je=Qf.contentDocument)||void 0===je?void 0:je.querySelector("body"),null===Qf||void 0===Qf?void 0:Qf.appendChild(this.$aa),go.a.ERa&&(go.a.Ucj=window.performance.now()-ue),je=null===Qf||void 0===Qf?void 0:Qf.children,1!==(null===je||void 0===je?void 0:je.length)&&t.ULS.sendTraceTag(508913473,307,15,"Found Multiple Pasted Container in iframe element"),
ee.htmlProcessor.process(1===(null===je||void 0===je?void 0:je.length)?je[0]:this.$aa,de)):ee.htmlProcessor.process(this.$aa,de);de.pi(ee.MAf&&ee.MAf.dic?this.kPb:this.cXh);return!0};this.kPb=(de,ee)=>{if(ee=ee.MAf){let ue=!1,Qf=!1,Jg=!1,Ql=!1;var je=-1;const Fm=new fd.DictionaryPropertySet,Kp=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');Object(Ib.a)(96,this.yi.vd)?(ue=this.yi.vd.ja(Mc.a.tia,!1),je=this.yi.vd.ja(Yc.a.NP,""),Jg=this.yi.vd.ja(Yc.a.P4,!1),Ql=this.yi.vd.ja(Pd.a.Lxa,!1),Kp.test(je)&&
(Qf=!0),je=this.yi.vd.ja(lh.a.iha,-1)):this.yi.Tw&256&&this.$aa&&(ue=!0,Kp.test(this.$aa.innerHTML)&&(Qf=!0));Fm.setValue(Mc.a.tia,ue);Fm.setValue(Yc.a.RYc,Qf);Fm.setValue(Yc.a.P4,Jg);Fm.setValue(lh.a.iha,je);Fm.setValue(Pd.a.Lxa,Ql);ee.$ge(Fm);ee.$Xf();ee.qnb&&(this.yi.WWc=!0,this.yi.gBf=ee.JX,this.yi.AUf=ee.qnb,ue&&!Jg&&Ke.c(Nb.a.rAl),v.AFrameworkApplication.va.processAction(Nb.a.kPb,2))}de.pi(this.cXh);return!0};this.cXh=(de,ee)=>{var je;de=0;go.a.ERa&&(de=window.performance.now());if(Wk.FXc){var ue=
document.getElementById("FrameContainingPastedDOM");ue instanceof HTMLIFrameElement&&(ue=null===(je=ue.contentDocument)||void 0===je?void 0:je.querySelector("body"),(null===ue||void 0===ue?0:ue.firstElementChild)?(t.ULS.sendTraceTag(508858444,307,50,"iframe body first element child was not null"),null===ue||void 0===ue?void 0:ue.removeChild(null===ue||void 0===ue?void 0:ue.firstElementChild)):t.ULS.sendTraceTag(508858443,307,15,"iframe body first element child was null"))}go.a.ERa&&(go.a.kcj=window.performance.now()-
de);Dq.a.G8m(ee.sLj);Dq.a.P5m(ee.iwm);Dq.a.z7m(ee.xdo);Dq.a.A7m(ee.ydo);Dq.a.o6m(ee.p_c);je="Others";ee.STc&&(ee.STc.M5m(),ee.STc.N5m(),ee.STc.O7m(),je=ee.STc.nig);Dq.a.O5m(ee.fwm,je);Dq.a.y5m(ee.zJl,je);return!1};this.$aa=b;this.Uue=P;this.IEe=ca;this.hVe=ra;this.wYe=Qa;this.xwc=tb;this.MXb=Uc;this.Ca=Zb;this.uZg=Object.assign(new GA,{wcc:2===this.yi.H5b||3===this.yi.H5b});this.cBe=Gc;this.tnd=Od;this.p0b=Zb.$("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.hjk=Zb.$("ParseStyleFromRawHtmlHeadIsEnabled");
this.Ujk=Zb.$("RemoveSpacesAfterEndFragmentIsEnabled")}get e6d(){return!1}get yWc(){return!0}YYh(b){this.j3=new Ad.GraphIterator;this.G6a.restore(this.j3);t.ULS.shipAssertTag(6305550,307,Uf.OutlineElementReader.Eh(this.j3));this.yi.cS&&this.yi.cS.m3b("external");var h=this.yi.Tw&8192?1:0,r=this.IEe.value.create(h,this.j3,this.yi.XIc,this.yi.tpb),B=this.hVe.value.create(h,this.j3);const P=Dq.a.J6h(v.AFrameworkApplication.userSessionId),ca=Dq.a.Cki(v.AFrameworkApplication.userSessionId),ra=Dq.a.crf(Z.a.IBb,
this.yi.XIc),Qa=Dq.a.fhi(v.AFrameworkApplication.userSessionId),tb=Dq.a.ghi(v.AFrameworkApplication.userSessionId),Mb=this.p0b?this.sBm():null,Zb=Dq.a.pai(Z.a.IBb,this.yi.XIc),jc=Dq.a.qai(v.AFrameworkApplication.userSessionId),Gc=this.xwc.xqj?Dq.a.S3l(v.AFrameworkApplication.userSessionId):null;h=this.Uue.value.create(h,this.j3,r,B,null,ra,this.xCk,this.yi.Tle);h=new hk(h,Qa,tb);h=new Lz(h,r,this.MXb);h=new Wk(h,this.xwc,this.uZg,Gc);B=new fh(Mb);h=new bo(h,Zb,Mb,this.Ca,B);h=new Mq(h,jc);r=new LB(h,
r,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc);r=new qv.a(b,this.Uhn,r);r.Rl("paste and request pictures");r.Qh=!b||b.Qh;r.run()}get xCk(){return this.$aa.getElementsByTagName("a").length}sBm(){const b=new tj;b.Vhc=Z.a.IBb;this.yi&&(b.Tw=this.yi.Tw,b.f_i=this.yi.XIc,this.yi.vd&&(b.progId=this.yi.vd.ja(Yc.a.y1i,"")));this.$aa&&this.$aa.innerHTML&&(b.x1i=this.$aa.innerHTML.length,go.a.ERa&&(go.a.v1i=b.x1i));v.AFrameworkApplication.sessionStartInfoSettings&&(b.platform=v.AFrameworkApplication.sessionStartInfoSettings.Platform,
b.y1d=v.AFrameworkApplication.K.$("IsO365ConsumerHost"),b.Nvi=ke.ParagraphReader.Eba(Eb.App.za.jb.rc.ed));return b}get Oqj(){return!0}get C$c(){t.ULS.shipAssertTag(6305551,307,!!this.j3);if(this.xwc.yqj(this.uZg)){var b=!1;Uf.OutlineElementReader.Eh(this.j3)&&(this.j3.iY(),b=!0);var h=ke.ParagraphReader.oh(this.j3)&&!this.j3.currentNode.ja(Yc.a.Yxi,!1);b&&this.j3.uc();return h}return this.yi.Tw&524288?(b=!1,Uf.OutlineElementReader.Eh(this.j3)&&(this.j3.iY(),b=!0),h=ke.ParagraphReader.oh(this.j3),
b&&this.j3.uc(),h):ke.ParagraphReader.oh(this.j3)}}Object(m.a)(Cv,"ExternalPasteExecutionManager",co,[]);class Ux{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc){this.u8b=jc;this.Uue=b;this.IEe=h;this.hVe=r;this.wYe=B;this.xwc=P;this.MZ=ca;this.Ca=ra;this.cBe=Qa;this.MXb=tb;this.h7=Mb;this.tnd=Zb}create(b,h,r,B){return new Cv(b,h,r,B,this.Uue,this.IEe,this.hVe,this.wYe,this.xwc.value,this.MZ,this.Ca,Eb.App.za.jb,this.cBe,this.MXb,this.h7,this.tnd,this.u8b)}}Object(m.a)(Ux,"Factory",null,[686]);class MB{LFi(b){if(!b||
!b.childNodes)return!1;const h=b.childNodes.length;return 2>h?!1:this.oMm(b.childNodes[h-2])&&this.WXm(b.childNodes[h-1])}DOo(b){this.LFi(b)&&(b.removeChild(b.lastChild),t.ULS.sendTraceTag(579371169,307,50,"Remove spaces after end fragment"))}OJm(b){return!!b&&8===b.nodeType}nWm(b){return!!b&&3===b.nodeType}oMm(b){return this.OJm(b)&&"EndFragment"===b.nodeValue}WXm(b){if(!this.nWm(b))return!1;b=b.nodeValue;return!!b&&!b.trim().length}}Object(m.a)(MB,"HtmlNormalizerHelper",null,[685]);var bt=c(1988),
lw=c(642);class KA extends co{constructor(b,h,r,B,P,ca,ra,Qa,tb){super(b,h,r,P,ca,Qa,tb);this.iA=B;this.hM=ra}get Zl(){return this.hM.value}get e6d(){return this.iA.e6d()}get F1i(){const b=this.iA;return b.B$e&&!b.cui()}ZYh(b,h){t.ULS.shipAssertTag(6305616,307,Yg.OutlineReader.mx(b));const r=lw.a(b.currentNode);if(Yg.OutlineReader.isEmpty(b)){var B=Ue.a.create(b.currentNode);b.rt(8);v.AFrameworkApplication.va.Nf(B,Nb.a.PH,2,!0,null,null)}else b.rt(8);(B=b.EJ(1))&&b.uc();this.iA.m1i(this.yi.ke,b.currentNode,
B,-1,r,h)}YYh(b){const h=new Ad.GraphIterator;this.G6a.restore(h);t.ULS.shipAssertTag(6305618,307,Uf.OutlineElementReader.Eh(h));this.yi.cS&&this.yi.cS.m3b("internal");let r=-1;if(Object(Ib.a)(96,this.yi.vd))r=this.yi.vd.ja(lh.a.iha,-1);else{const B=this.XUl(h.currentNode);r=B?B.clientWidth:r}this.iA.m1i(this.yi.ke,h.parentNode,h.currentNode,r,null,b);this.nAi&&(this.G6a.restore(h),Uf.OutlineElementReader.Eh(h)&&this.iA.xDi(h)&&(b=ig.OutlineElementNavigator.Ee(h)))&&(this.yi.WEa=og.SelectionFactory.ne(b,
0))}XUl(b){return b?(b=b?b.te(this.Zl.$b):null)?b.htmlElement:null:null}urj(){const b=new Ad.GraphIterator;this.G6a.restore(b);return this.iA.xDi(b)}get Oqj(){return!0}get C$c(){return!this.iA.lwa&&!this.iA.B$e}}Object(m.a)(KA,"InternalPasteExecutionManager",co,[]);class zo{constructor(b,h,r,B,P){this.u8b=P;this.iA=b;this.MZ=h;this.hM=r;this.h7=B}create(b,h,r){return new KA(b,h,r,this.iA,this.MZ,Eb.App.za.jb,this.hM,this.h7,this.u8b)}}Object(m.a)(zo,"Factory",null,[684]);var Mz;(function(b){b[b.unknown=
0]="unknown";b[b.uhp=1]="differentBox4App";b[b.brp=2]="sameBox4AppDifferentSession";b[b.crp=3]="sameBox4AppSameSession"})(Mz||(Mz={}));Object(m.b)("CopySource",Mz);class os{constructor(b,h,r,B){this.iA=b;this.P_g=h;this.B2j=r;this.Ok=B}IBn(b,h,r){t.ULS.shipAssertTag(6305620,307,!!b);t.ULS.shipAssertTag(6305621,307,xe.SelectionEditor.Ze(h));t.ULS.shipAssertTag(6305622,307,!!r);t.ULS.shipAssertTag(6305623,307,Object(Ib.a)(rv.a,r.Bqa));const B=r.Bqa;B.H5b=this.iA.h8h(b);this.c6m(b,B);let P=!1;zm.a.hId&&
this.Ok.via(h,Qa=>P=Qa)&&(B.Tw|=8192,zm.a.iId&&(B.Tle=1,P||(B.Tle|=2)));const ca=this.nPm(B);var ra=new cg.GraphTransaction(7,Nb.a.paste);ra.Db(h.node);h.node.zJ().sF.g8(8);ca?(t.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",B.Tw,B.browserName),b=this.P_g.create(h,B,ra)):(t.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",B.Tw,B.H5b,B.browserName),os.S5m(b),b=this.B2j.create(b,h,B,ra));r=new qv.a(r,Object(z.a)(b,b.r1i,"pasteSetup"),null);
r.Rl("Paste");r.run()}nPm(b){return!this.lSm(b)&&3===b.H5b}lSm(b){return 1===(b.Tw&8192?1:0)}jui(b,h){t.ULS.shipAssertTag(6305624,307,xe.SelectionEditor.Ze(b));t.ULS.shipAssertTag(6305625,307,!!h);t.ULS.shipAssertTag(6305626,307,Object(Ib.a)(rv.a,h.Bqa));const r=new cg.GraphTransaction(7,Nb.a.yYd);r.Db(b.node);b=this.P_g.create(b,h.Bqa,r);h=new qv.a(h,Object(z.a)(b,b.r1i,"pasteSetup"),null);h.Rl("InternalPasteAtIp");h.run()}c6m(b,h){if(b){let r=!1,B=!1;b.innerHTML&&0<=b.innerHTML.indexOf("mso-tab-count")?
B=!0:b.innerText&&0<=b.innerText.indexOf("\t")&&(r=!0);(r||B)&&t.ULS.sendTraceTag(42471960,307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",Mz[h.H5b],r,B)}}static S5m(b){b&&os.apk.test(b.innerText)&&t.ULS.sendTraceTag(6350173,307,50,"External paste operation starts on WebUrl")}}os.apk=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");Object(m.a)(os,"PasteCoordinator",null,[]);class LA{constructor(b,
h,r,B,P){this.wwa=b;this.fmb=h;this.$Bn=r;this.ZBn=B;this.yWc=P}}Object(m.a)(LA,"PastedContentsPostProcessorParams",null,[]);class Wu{PBm(b,h,r,B,P,ca){b=this.KYl(b,h,P);r=this.y2l(r);if(!b||!r)return null;B=this.W9l(b,B,P);P=this.V9l(r);return new LA(b,r,B,P,ca)}KYl(b,h,r){b=r?b:h;if(!Uf.OutlineElementReader.Eh(b))return null;h=new Nf.a;h.kd(b);return h}y2l(b){if(!Uf.OutlineElementReader.Eh(b))return null;const h=new Nf.a;h.kd(b);ig.OutlineElementNavigator.h1(h,!1,!1);return h}W9l(b,h,r){ig.OutlineElementNavigator.Ee(b);
let B=-1;ke.ParagraphReader.oh(b)&&(B=r?h:0);ig.OutlineElementNavigator.Yd(b);return B}V9l(b){ig.OutlineElementNavigator.Ee(b);const h=ke.ParagraphReader.oh(b)?ke.ParagraphReader.textLength(b.currentNode):-1;ig.OutlineElementNavigator.Yd(b);return h}}Object(m.a)(Wu,"PastedContentsPostProcessorHelper",null,[]);var FC=c(805),wh=c(1107),mw=c(1106);class Mg{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc=null){this.Hqa=b;this.i$=h;this.Nl=r;this.X3i=B;this.ua=P;this.z6a=ca;this.K=ra;this.NBn=Qa;this.Pda=
tb;this.yHb=Mb;this.xva=Zb;this.mb=jc;this.Aia=Gc;this.SPh=100;this.hec=!1;this.Uxe=null;this.DGe=!1;this.Ktd=null;this.Zpd=this.gMa=!1;this.TGl=(Uc,od)=>{this.dismissFloatie(od.mDl)};this.Pwo=(Uc,od)=>{this.Cal(Uc,od)};this.TY=(Uc,od)=>{od.property===Pd.a.lastModifiedTime?(t.ULS.sendTraceTag(520734533,307,50,"Last Modified Time was used "),this.yHb.bdf.contains(Nb.a.dqg)||this.t5f(od)):t.ULS.sendTraceTag(520734532,307,50,"Last Modified Time was NOT used but theoretically would be if we remove Last Modified was removed.")};
this.OMb=(Uc,od)=>{this.t5f(od)};this.dja=(Uc,od)=>{od.tEf||this.t5f(od)};this.NWi=()=>{FC.a.instance.keyCode===se.a.vAa&&this.i$.K6i()};this.ICo()}ICo(){this.i$.wrh(this.Pwo);this.i$.crh(this.TGl)}Cal(b,h){var r,B,P;(null===(B=null===(r=this.mb.ib)||void 0===r?void 0:r.lb)||void 0===B?0:B.EWc)?t.ULS.sendTraceTag(512313220,307,50,"Box4 Paste floatie not created because Loop component was pasted."):(this.z6a.QCf(),1===this.NBn.Ral(h.M3c)?t.ULS.sendTraceTag(575255107,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",
h.correlationId):this.showFloatie(b,h)?(this.gMa?this.gMa=!1:this.DYn(),this.n6c(),b="Box4 Paste floatie created."+String.format(" PasteCommand: {0}, CorrelationId: {1}",Nb.a.zU(h.ZY)||"Unknown",h.correlationId),t.ULS.sendTraceTag(40379588,307,50,b),Ke.a("Box4PasteFloatieCreated",!0,void 0,[Object.assign(new ha.a,{name:"PasteCommand",int64:Nb.a.zU(h.ZY)||"Unknown"}),Object.assign(new ha.a,{name:"CorrelationId",string:null===(P=h.correlationId)||void 0===P?void 0:P.toString()})]),this.OSb()):t.ULS.sendTraceTag(575255108,
307,50,"Box4 Paste floatie not created. CorrelationId: {0}",h.correlationId))}dismissFloatie(b){var h;!this.DGe&&(this.gMa||(this.Aia?null===(h=this.xva)||void 0===h?0:h.M0:this.Hqa.M0()))&&(b&&(this.z6a.QCf(),this.oEj(),t.ULS.sendTraceTag(50685514,307,50,"Last paste command before dimiss or hiding the floatie. Command: {0}",this.Ktd)),this.gMa=!b,this.Vne(),this.Aia?v.AFrameworkApplication.va.processAction(Nb.a.WHb,2):this.Hqa.dismissFloatie())}DYn(){this.Zpd||(this.Uxe=this.Nl.yd,He.a.addHandler(this.Uxe.container,
"scroll",Object(z.a)(this,this.RPb,"scrollHandler")),this.ua.E_(Object(z.a)(this,this.Nja,"resizeHandler")),this.Zpd=!0)}oEj(){this.Zpd&&(He.a.removeHandler(this.Uxe.container,"scroll",Object(z.a)(this,this.RPb,"scrollHandler")),this.ua.$da(Object(z.a)(this,this.Nja,"resizeHandler")),this.Zpd=!1)}OSb(){if(this.Aia)this.xva.M0&&v.AFrameworkApplication.va.processAction(Nb.a.WHb,2),v.AFrameworkApplication.va.processAction(Nb.a.bad,2),this.hec=!1;else{const b=new mw.a(0,v.AFrameworkApplication.isRtl);
b.location=this.z6a.eQa();this.z6a.hNm(b.location)?this.showFloatie(null,b):this.i$.gIa(new wh.a(!1))}}Nja(){this.Aia?(v.AFrameworkApplication.va.processAction(Nb.a.WHb,2),this.pLc()):this.OSb()}RPb(){this.Aia?(v.AFrameworkApplication.va.processAction(Nb.a.WHb,2),this.pLc()):this.OSb()}n6c(){this.X3i.dyk(this.NWi);this.i$.hrh(Object(z.a)(this.Hqa,this.Hqa.MNd,"expandFloatie"));this.i$.srh(Object(z.a)(this,this.u1i,"pastedFloatieStatusChange"));this.Pda.ju(this.dja);this.Pda.Vw(this.OMb);this.Pda.Eo(this.TY)}Vne(){this.X3i.O1n(this.NWi);
this.i$.Ubj(Object(z.a)(this.Hqa,this.Hqa.MNd,"expandFloatie"));this.i$.acj(Object(z.a)(this,this.u1i,"pastedFloatieStatusChange"));this.Pda.uV(this.dja);this.Pda.Lja(this.OMb);this.Pda.jS(this.TY)}u1i(b,h){this.DGe=h.DWc;h.ZY&&(this.Ktd=h.ZY);h.Mgg&&this.Hqa.M0()&&this.OSb()}t5f(b){b.node.loading||this.i$.gIa(new wh.a(!0))}showFloatie(b,h){h||(h=new mw.a(0,v.AFrameworkApplication.isRtl));h.location||(h.location=this.z6a.eQa());if(!h.location)return!1;this.gMa&&(this.gMa=!1,this.n6c());this.Aia?v.AFrameworkApplication.va.processAction(Nb.a.bad,
2):this.Hqa.showFloatie(b,h);return!0}pLc(){if(!this.hec){const b=new Me.a(3,1,this.SPh,()=>{this.OSb()},215);Wg.a.instance.Wb(b);this.hec=!0}}}Object(m.a)(Mg,"PasteFloatieEventManager",null,[]);class Vx{constructor(b,h){this.lk=b;this.zI=h}Ral(b){return Qo.any(Qo.where(Qo.asEnumerable(Vx.JFo),h=>this.zI.cYc(h)))?(b=this.lk.sob(b))&&(b=b.innerText)&&0<b.trim().length?0:1:1}}Vx.JFo=[Nb.a.BTa.toString(),Nb.a.CTa.toString(),Nb.a.dza.toString()];Object(m.a)(Vx,"PasteFloatieFeatureSetBuilder",null,[]);
class Nz{constructor(){this.Pya=null;this.Zhc=0}}Object(m.a)(Nz,"PasteFloatieAnchorData",null,[]);class nw{constructor(b,h,r,B,P,ca=!1){this.ayb=null;this.hb=b;this.lua=h;this.ld=r;this.m4j=B;this.eOe=P;this.eHe=ca}QCf(){this.ayb=null}eQa(){const b=this.Tqf(this.ayb)||this.ZAh();if(!b){let h="null",r="null";if(this.ayb&&this.ayb.Pya){if(!this.ld.yd)return t.ULS.sendTraceTag(51143187,307,15,"SelectoinView is null when we try to get floatie position"),null;h=Object.getType(this.ayb.Pya).getName();const B=
this.ld.yd.zj(this.ayb.Pya);B&&(r=Object.getType(B).getName())}t.ULS.shipAssertTag(40641054,307,!1,"Failed to calculate position for pasted node type {0}, view element type {1}",h,r)}return b}hNm(b){if(!b)return!1;const h=this.eOe.gGb(),r=this.m4j(this.ld.yd.container);b=new Sys.UI.Bounds(b.x,b.y,h.width,h.height);return b.y>=r.y&&b.y+b.height<=r.y+r.height}ZAh(){if(!this.hb||!this.hb.ib||!this.hb.ib.lb)return t.ULS.sendTraceTag(51431265,307,15,"Selection is null when we try to calculate floatie position"),
null;var b=this.hb.ib.lb.Pa,h=!b.cpBegin&&!b.cpEnd;let r=b.node;if(r&&h){do r=this.nfi(r);while(r&&Object(Ib.a)(oi.AParagraphNode,r)&&!r.characterData.trim().length)}let B="";const P=Object(Ra.a)(oi.AParagraphNode,r);P&&(B=P.characterData.length===b.cpBegin||h?P.characterData.trimEnd():P.characterData.substring(0,b.cpBegin).trimEnd());h=P?B.length:b.cpBegin;b=Object.assign(new Nz,{Pya:Object(Ra.a)(133,(P?Object(Ra.a)(133,P):Object(Ra.a)(133,r))||b.node),Zhc:h});return this.Tqf(b)}nfi(b){const h=new Ad.GraphIterator;
if(!b.anchor)return null;h.set(b);if(!h.qd())return null;h.jd(11);return h.FJ()?h.Ub(2):null}Tqf(b){if(!b||!b.Pya)return null;this.ayb=b;const h=this.ld.yd;if(!h)return t.ULS.sendTraceTag(51143188,307,15,"SelectoinView is null when we try to get floatie position"),null;b=this.rai(b,h);if(!b)return null;v.AFrameworkApplication.isRtl&&this.eOe.M0()&&(b.x-=this.eOe.gGb().width);return new Sys.UI.Point(b.x+b.width,b.y+b.height)}rai(b,h){h=h.te(b.Pya);if(!h)return null;let r=null;if(Object(Ib.a)(oi.AParagraphNode,
b.Pya)){const B=Object(Ra.a)(117,h);if(!B)return null;try{r=this.lua.O_(b.Zhc,B,0<b.Zhc,!1,!1,!1),r.height+=this.eHe?nw.MPn:nw.WGl}catch(P){t.ULS.sendTraceTag(40953486,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",P),r=null}}else Object(Ib.a)(pl.TableNode,b.Pya)&&(r=Object(Ra.a)(106,h).qvf());r||(r=h.getBounds());return r}}nw.WGl=2;nw.MPn=60;Object(m.a)(nw,"PasteFloatiePositionProvider",null,[]);class ps{constructor(b,h){this.auc=b;this.cZj=h}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get f3h(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get ydf(){return CommonUIStrings.l_ClipboardCut}get JOf(){return CommonUIStrings.l_ClipboardCut_Mac}get waf(){return CommonUIStrings.l_ClipboardCopy}get IOf(){return CommonUIStrings.l_ClipboardCopy_Mac}get Yhc(){return CommonUIStrings.l_ClipboardPaste}get KOf(){return CommonUIStrings.l_ClipboardPaste_Mac}get j$(){return CommonUIStrings.l_ClipboardPasteText}get LOf(){return CommonUIStrings.l_ClipboardPasteText_Mac}get E8e(){return this.cZj}get DFh(){return CommonUIStrings.l_ClipboardExtensionLink}get cgb(){return CommonUIStrings.l_ClipboardExtensionSuggestion}sZh(){t.ULS.sendTraceTag(8716421,
307,50,null);Qd.a.wm(this.E8e,"_blank",void 0,"ClipboardAccessExtensionLink")}cea(b,h){let r=Z.a.fl;v.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(r=Z.a.vi||r);return r?String.format(h,"\u2318"):b}dispose(){this.auc=null}J5f(b){this.GKh(b)}J0m(b){this.GKh(b)}GKh(b){this.auc&&this.auc(b)}}ps.id="CopyPasteShortcutDialog";ps.Zyj="CopyPasteText";Object(m.a)(ps,"ACopyPasteShortcutDialog",null,[9]);class GC extends ps{constructor(b,h,r){super(b,h);b=document.createElement("span");b.className=
"WACCopyPasteShortcutDialogTextPanel";h=document.createElement("span");h.id=ps.Zyj;var B=document.createElement("span");B.innerText=this.f3h;var P=document.createElement("span");P.className="UIFontBold";P.innerText=this.cea(this.ydf,this.JOf);const ca=document.createElement("span");ca.className="UIFontBold";ca.innerText=this.cea(this.waf,this.IOf);const ra=document.createElement("span");ra.className="UIFontBold";ra.innerText=this.cea(this.Yhc,this.KOf);h.appendChild(B);h.appendChild(document.createElement("br"));
h.appendChild(P);h.appendChild(ca);h.appendChild(ra);r.$("PasteTextOnlyShortcutDialogIsEnabled")&&(Z.a.Fr||Z.a.Cj)&&(r=document.createElement("span"),r.className="UIFontBold",r.innerText=this.cea(this.j$,this.LOf),h.appendChild(r));b.appendChild(h);this.E8e?(t.ULS.sendTraceTag(8716420,307,50,null),r=document.createElement("span"),h=document.createElement("a"),h.href="#",h.innerText=this.DFh,He.a.addHandler(h,"click",Object(z.a)(this,this.sZh,"extensionLinkHandler")),r.appendChild(h),P=this.cgb.indexOf("{0}"),
-1!==P&&(B=this.cgb.substring(0,P),P=this.cgb.substring(P+3,this.cgb.length),B=document.createTextNode(B),P=document.createTextNode(P),r.insertBefore(B,h),r.appendChild(P)),b.appendChild(document.createElement("br")),b.appendChild(r)):t.ULS.sendTraceTag(8716422,307,50,null);r=new Tf.StandardDialog;r.Cd=0;r.yg=ps.id;r.rv(this.titleText,null,0,Object(z.a)(this,this.J0m,"legacyCopyPasteShortcutDialogHandler"),b);r.L5(ps.Zyj)}}Object(m.a)(GC,"CopyPasteShortcutDialog",ps,[]);class ow extends ps{constructor(b,
h){super(b,h);h={};b=this.uFm;h.extensionStartText=this.gAl;h.extensionLink=null;h.extensionEndText=null;h.shortcutsMessageText=this.oro;h.cutText=this.cea(this.ydf,this.JOf);h.copyText=this.cea(this.waf,this.IOf);h.pasteText=this.cea(this.Yhc,this.KOf);4!==v.AFrameworkApplication.ua.Kb.yk&&(h.pasteTextOnly=this.cea(this.j$,this.LOf));h={["id"]:"CopyPasteInstallDialog",["bodyControls"]:h};const r=new Pe.a(!1,!1,!0);r.yg="CopyPasteInstallDialog";r.Cd=0;r.ze(1,this.tFm);r.BV(1);r.Uh(b,Object(z.a)(this,
this.J5f,"reactCopyPasteShortcutDialogHandler"),h)}get oro(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get tFm(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get uFm(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get gAl(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}static wvo(){var b=window.location.origin;return b?RegExp("^https:\\/\\/((.*?(word-edit|powerpoint|onenote|excel|visio)\\.(officeapps\\.live\\.com|partner\\.officewebapps\\.cn|gov\\.online\\.office365\\.us|dod\\.online\\.office365\\.us))|(project\\.microsoft\\.com))$",
"g").test(b):!1}}Object(m.a)(ow,"ReactCopyPasteInstallDialog",ps,[]);class HC extends ps{constructor(b){super(b,null);this.UGi="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";var h={};b=this.ohn;var r="";let B="";this.messageText&&(r=this.messageText.split(" {")[0],B=this.messageText.split("} ")[1]);h.startText=r;h.endText=B;h.cutText=this.Nhl;h.copyText=this.g8k;h.pasteText=this.QBn;
h.cutShortcutText=this.cea(this.Ohl,this.J9m);h.copyShortcutText=this.cea(this.q8k,this.I9m);h.pasteShortcutText=this.cea(this.TBn,this.L9m);h.imageSrc=Bd.a.Tba("NoClipboardAccessDialogImage.svg");h.imageAltText=this.imageAltText;h.primaryButtonLabel=this.NHn;this.UGi&&(t.ULS.sendTraceTag(527986756,307,50,"Learn more link is available"),h.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.nmb,["onExecute"]:()=>{this.D0m()}});h={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:h};
r=new Pe.a(!1,!1,!0);r.Cd=0;r.yg="CopyPasteNoClipboardAccessDialog";r.Uh(b,Object(z.a)(this,this.J5f,"reactCopyPasteShortcutDialogHandler"),h)}get ohn(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get nmb(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get imageAltText(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get NHn(){return CommonUIStrings.l_DialogOk}get Nhl(){return CommonUIStrings.l_CutString}get Ohl(){return CommonUIStrings.l_CutShortcut}get J9m(){return CommonUIStrings.l_CutShortcut_Mac}get g8k(){return CommonUIStrings.l_CopyString}get q8k(){return CommonUIStrings.l_CopyShortcut}get I9m(){return CommonUIStrings.l_CopyShortcut_Mac}get QBn(){return CommonUIStrings.l_PasteString}get TBn(){return CommonUIStrings.l_PasteShortcut}get L9m(){return CommonUIStrings.l_PasteShortcut_Mac}D0m(){t.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");Qd.a.wm(this.UGi,"_blank",void 0,"learnMoreLink")}}Object(m.a)(HC,"ReactCopyPasteNoClipboardAccessDialog",ps,[]);class NB extends ps{constructor(b,h,r){super(b,h);b={};b.forwardElementText=this.f3h;b.cutText=this.cea(this.ydf,this.JOf);b.copyText=this.cea(this.waf,this.IOf);b.pasteText=this.cea(this.Yhc,this.KOf);r.$("PasteTextOnlyShortcutDialogIsEnabled")&&(Z.a.Fr||Z.a.Cj)&&(b.pasteTextOnly=this.cea(this.j$,this.LOf));this.E8e?(t.ULS.sendTraceTag(40726914,307,
50,null),b.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.DFh,["onExecute"]:B=>{this.sZh(B)}},r=this.cgb.indexOf("{0}"),-1!==r&&(b.suggestionPrefixElement=this.cgb.substring(0,r),b.suggestionSuffixElement=this.cgb.substring(r+3,this.cgb.length))):t.ULS.sendTraceTag(40726915,307,50,null);r={["id"]:ps.id,["bodyControls"]:b};b=new Pe.a(!1,!1,!0);b.Cd=0;b.yg=ps.id;b.Uh(this.titleText,Object(z.a)(this,this.J5f,"reactCopyPasteShortcutDialogHandler"),r)}}Object(m.a)(NB,"ReactCopyPasteShortcutDialog",
ps,[]);class Fs{constructor(){this.iMa=!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.vF}Waf(b,h,r=!1){t.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.iMa,r));this.iMa?r?new ow(b,h):new NB(b,h,v.AFrameworkApplication.K):new GC(b,h,v.AFrameworkApplication.K)}static get instance(){return Fs._instance||(Fs._instance=new Fs)}}Fs._instance=null;Object(m.a)(Fs,"CopyPasteShortcutDialogFactory",null,[962]);class Ry{constructor(b,h,r,B,
P,ca,ra,Qa){this.Bgh=this.J1g=this.mUe=!1;this.Blk=b;this.ld=h;this.gu=r;this.Vb=B;this.Ce=P;this.fg=ca;this.Re=ra;Qa&&(this.Bgh=Qa.$("ShouldLogExecCommandCopySuccess"))}get bVa(){return this.Blk}get E4a(){return this.J1g}set E4a(b){this.J1g=b;this.fg.xAf=b}wNc(b){this.bVa.wNc(b);b||this.Jbd(!0)}get mxl(){return this.bVa.I$f}SNb(b){this.E4a=!0;this.bVa.SNb(b,this.slg)}reset(){this.E4a=!1}paste(){var b=null;let h=null;if(!this.bVa.GTb){(b=this.ld.yd)&&this.Vb.mg(b.uJ);var r=this.gu.iu;if(!r.ue||!r.xe.$j)return null;
h=r.xe;b=this.Ce.uw();this.E4a=!0;r.E9a()}r=null;try{h&&h.xGn(),r=b=this.bVa.LNc(this.slg,b)}catch(B){t.ULS.shipAssertTag(6305672,307,!1),this.emi()}this.E4a=!1;return r}copy(){var b=this.ld.yd;b&&this.Vb.mg(b.uJ);b=this.gu.iu;if(!b.ue||1!==b.xe.mode)return!1;this.E4a=!0;let h;try{const r=new Map;r.set("View","ContentEditableView");va.Health.instance.recordKpiUsage(ao.a.B4b,0,ao.a.EFd,r);const B=this.bVa.Djf(this.slg);h=!0;this.Bgh&&t.ULS.sendTraceTag(558384097,307,50,"execCommandCopySuccess, {0}, browser: {1}",
B,this.Re.qG);if(!B){const P=Object.assign(new hc.a,{extendedProperties:r});va.Health.instance.recordKpiFailure(ao.a.B4b,ao.a.g7e,!0,!0,P)}}catch(r){t.ULS.shipAssertTag(6305673,307,Z.a.Cj),t.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",Z.a.qG),h=!1}this.E4a=!1;return h?!0:!1}Jbd(){if(this.mUe)return!0;var b=this.gu.iu;if(!b.ue||!b.xe.$j)return!1;const h=b.xe;b=this.Ce.uw();this.E4a=!0;const r=new xv.a(b);let B=!1;try{B=this.bVa.Jbd(b,()=>{h.yGd()},
()=>{h.CIa()})}catch(P){}r.restore();this.E4a=!1;B?this.mUe=!0:(t.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",Z.a.qG),this.emi());return B}emi(){this.mUe=!1;if(v.AFrameworkApplication.S3o)Fs.instance.Waf(null,null);else{const b=new Tf.StandardDialog;b.Cd=0;b.FV(CommonUIStrings.l_ClipboardAccessDeniedTitle,CommonUIStrings.l_ClipboardAccessDenied,null)}}get slg(){const b=this.Ce.Zib();return b?b.$n:null}}Object(m.a)(Ry,"SystemClipboard",null,
[683]);class Xu{constructor(b,h,r){this.mAd=!1;this.MAd=this.tT=this.C4g=this.qwe=this.Zhd=null;this.aFn=B=>{1===B?(t.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",this.ewe)),this.M1b&&(t.ULS.sendTraceTag(594882642,307,50,String.format("_useInstallDialog={0}",this.M1b)),Qd.a.wm(this.VCe+this.jMe,"_blank",void 0,"ChromeCCPInstallDialog"))):B||t.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",this.ewe))};this.ewe=b.$("ChromeClipboardAccessExtensionSuggestionIsEnabled");
this.VCe=b.kb("ChromeClipboardAccessExtensionLink");this.$ab=h;this.lk=r;this.jMe=b.kb("ChromeClipboardAccessExtensionId");this.jok=b.$("UseGetClipboardDataIsEnabled");this.Pch=b.$("RecordExtensionInstallStatusKpiIsEnabled");this.M1b=!1;b.$("CcpInstallDialogIsEnabled")&&v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.vF&&(this.M1b=ow.wvo()||b.$("IgnoreDomainCheckCcpInstallDialog"),t.ULS.sendTraceTag(587314304,307,50,"_useInstallDialog: {0}",this.M1b));this.bvc=null}wNc(b){b?this.tT=!0:(this.tT=
null,chrome.runtime&&chrome.runtime.sendMessage?(this.bvc=this.$ab.gKd,this.$ab.QQb?(this.mAd=this.jok,this.IDh()):(this.mAd=!0,this.IDh(),t.ULS.sendTraceTag(19256732,307,50,V.a.create().toString()))):(this.iRb(),this.tT=!1))}get I$f(){return this.tT}get GTb(){return this.MAd}Jbd(){return!0}Djf(b){t.ULS.sendTraceTag(24402115,307,50,"Execute chrome copy");(b=Qd.a.GEb(b,"copy"))||t.ULS.sendTraceTag(24402116,307,10,String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,
2)));return b}Yof(b){if(!b)return null;var h=b.img;const r=b.text;b=b.html;const B=this.lk.Cij(!!h,!!r,b);let P=null;if(3===B){if(!b)return null;h=this.lk.BZh(b);(h=this.lk.IZh(h))&&(b+=h);P=this.lk.sob(b)}else 2===B?P=this.lk.e0f(r,!0):1===B&&(P=this.lk.sob(h));return P}LNc(b,h){if(this.GTb)h=this.Yof(this.qwe),this.qwe=null;else{if(!this.Zhd)return h;b=document.implementation.createHTMLDocument("doc");b.body.innerHTML=this.Zhd;h=b.body;this.Zhd=null}return h}SNb(b){const h=V.a.create();this.C4g=
h;this.$ab.QQb?t.ULS.sendTraceTag(7377737,307,50,h.toString()):t.ULS.sendTraceTag(19256735,307,50,h.toString());const r={};r.command=this.GTb?"getClipboardData":"paste";chrome.runtime.sendMessage(this.bvc,r,B=>{h.equals(this.C4g)?this.GTb?this.qwe=B:this.Zhd=B:t.ULS.sendTraceTag(7385868,307,50,null);t.ULS.sendTraceTag(7377738,307,50,h.toString());chrome.runtime.lastError&&(this.ktl(),this.$ab.QQb?t.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):t.ULS.sendTraceTag(19256737,307,10,
chrome.runtime.lastError.message));b()})}iRb(){t.ULS.sendTraceTag(8716423,307,50,null);let b=null;this.M1b?b=this.VCe+this.jMe:this.ewe&&(b=this.VCe+this.bvc);Fs.instance.Waf(this.aFn,b,this.M1b)}ktl(){this.$ab.l6n();this.iRb()}Sjj(b,h){chrome.runtime.sendMessage(b,{command:"test",object:"ping"},h)}xVk(){const b=V.a.create();this.$ab.QQb?t.ULS.sendTraceTag(592491466,307,50,b.toString()):t.ULS.sendTraceTag(591984031,307,50,b.toString());chrome.runtime.sendMessage(this.bvc,{command:"getAvailableCommands"},
h=>{t.ULS.sendTraceTag(592491467,307,50,b.toString());h?Object(Ib.a)(Array,h)?(t.ULS.sendTraceTag(592491470,307,50,"Extension responded: {0}",h),this.MAd=-1!==Array.indexOf(h,"getClipboardData")):(t.ULS.sendTraceTag(592491469,307,15,"ChromeApi has non-string[] response. o: {0}",h),this.MAd=!1):(t.ULS.sendTraceTag(592491468,307,15,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.MAd=!1)})}IDh(){const b=V.a.create();this.$ab.QQb?t.ULS.sendTraceTag(7726105,
307,50,b.toString()):t.ULS.sendTraceTag(591984032,307,50,b.toString());this.mAd&&this.xVk();this.Sjj(this.bvc,h=>{t.ULS.sendTraceTag(7726106,307,50,b.toString());h&&"ping"===h?this.tT=!0:(h?"ping"!==h&&t.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",h,chrome.runtime.lastError?chrome.runtime.lastError.message:null):t.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),
this.iRb(),this.tT=!1);this.mAd&&!this.GTb&&t.ULS.sendTraceTag(592491471,307,50,"No response for CheckGetClipboardDataExistenceAsync")})}SKi(b,h){const r={};r.OfficeOnlineExtensionInstallationStatus=b;r.OfficeClipboardExtensionInstallationStatus=h;t.ULS.sendTraceTag(51144839,307,50,JSON.stringify(r));this.Pch&&(b&&va.Health.instance.recordKpiSuccess(Xu.l9g,null),h&&va.Health.instance.recordKpiSuccess(Xu.i9g,null))}e5m(){this.Pch&&(va.Health.instance.recordKpiUsage(Xu.l9g,1,Xu.OUg,null),va.Health.instance.recordKpiUsage(Xu.i9g,
1,Xu.OUg,null));if(chrome.runtime&&chrome.runtime.sendMessage){var b=!this.$ab.QQb;this.Sjj(this.jMe,h=>{this.SKi(b,!!h)})}else this.SKi(!1,!1)}}Xu.l9g="OfficeOnlineExtensionInstallationStatus";Xu.i9g="OfficeClipboardExtensionInstallationStatus";Xu.OUg="wwccp";Object(m.a)(Xu,"ChromeSystemClipboardAccessManager",null,[711]);class OB{constructor(b,h){this.tT=null;this.Re=b;this.Ca=h;this.wXj=!this.Ca.$("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&this.Ca.$("BlockCopyCutOnFirefoxIsEnabled");this.$ik=
h.$("SetResultForEnsureAccessOperationForElectronIsEnabled")}wNc(b){this.wXj&&b&&this.Re.Cj?(this.iRb(),this.tT=!1):this.tT=!0}get I$f(){return this.tT}get GTb(){return!1}Djf(b){return Qd.a.GEb(b,"copy")}LNc(b,h){Qd.a.GEb(b,"paste");return h}SNb(b){b()}Jbd(b,h,r){if(this.Re.O4)return this.$ik&&(this.tT=!1),!1;h();r();b=this.LNc(b.ownerDocument,b);h=b.innerHTML;b.innerHTML=Bb.a.create().toString();r();b=this.LNc(b.ownerDocument,b);return this.tT=b=h===b.innerHTML}iRb(){Fs.instance.Waf(null,null)}}
Object(m.a)(OB,"DefaultSystemClipboardAccessManager",null,[711]);class Wt{constructor(b,h,r){this.tT=this.Kaa=this.ZZb=this.dma=this.LYa=this.Vhd=null;this.lk=h;this.VYa=r;this.Vak=b.mc("ClipboardDataImageBlobLimitaton",10);b.$("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");this.Ejk=b.$("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}wNc(b){this.Ejk&&b&&(this.tT=!0)}get I$f(){return this.tT}get GTb(){return!1}Djf(b){return b?Qd.a.GEb(b,pd.a.copy):!1}LNc(b,h){this.LYa&&(h=this.LYa,this.LYa=
null);return h}SNb(b,h=null){if(b&&h){this.Vhd=b;this.ZZb=h;$addHandler(this.ZZb,pd.a.paste,Object(z.a)(this,this.hXi,"onPasteEvent"));this.Kaa=this.dma=null;if(this.eDj(this.ZZb)){if(this.Kaa&&0<this.Kaa.length&&(!this.dma||this.lk.Yoe(this.dma))){this.VYa.XJh(this.Kaa,Object(z.a)(this,this.Bpn,"onImageConverted"));this.LYa&&!this.LYa.hasChildNodes()&&t.ULS.sendTraceTag(42592151,307,50,"pastedContentDom has no child nodes.");return}this.dma&&this.dma.innerHTML&&((this.LYa=this.Ipi(this.dma.innerHTML))&&
!this.LYa.hasChildNodes()&&t.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),dc.a.KC(this.dma))}this.S0h()}else b&&b()}Jbd(b){return this.tT=b=this.eDj(b.ownerDocument)}hXi(b){try{b&&b.rawEvent&&((this.dma=b.rawEvent.target)&&this.dma.id&&-1<this.dma.id.indexOf("Paste")?(t.ULS.sendTraceTag(40690080,307,15,"The pasted target element of paste event: "+this.dma.id),this.dma=null):this.Kaa=this.y0l(b.rawEvent))}catch(h){t.ULS.sendTraceTag(22073952,307,15,"Exception while processing context menu paste event: "+
h.toString())}}Bpn(b){b&&(this.VYa.Vqj&&(b=String.format('<img src="{0}">',b)),this.LYa=this.Ipi(b));this.S0h()}S0h(){this.ZZb&&($removeHandler(this.ZZb,pd.a.paste,Object(z.a)(this,this.hXi,"onPasteEvent")),this.ZZb=null);this.Vhd&&(this.Vhd(),this.Vhd=null)}y0l(b){let h=null;(b=this.lk.c7h(b))&&({BAf:h}=this.lk.GCj(b,this.Vak,this.VYa.WNi));return h}eDj(b){return Qd.a.GEb(b,pd.a.paste)}Ipi(b){const h=document.implementation.createHTMLDocument("doc");h.body.innerHTML=b;return h.body}iRb(){}}Object(m.a)(Wt,
"EdgeSystemClipboardAccessManager",null,[711]);class Sy{constructor(b,h,r,B){this.Ca=b;this.SYj=h;this.lk=r;this.Re=B}create(){let b=null;v.AFrameworkApplication.Pgg()&&this.Re.Fr&&window.chrome?(t.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),b=new Xu(this.Ca,this.SYj,this.lk),this.Ca.$("LogChromeExtensionInstallationStatusIsEnabled")&&b.e5m()):this.Ca.$("EdgeContextMenuPasteFixIsEnabled")&&this.Re.Nt?(t.ULS.sendTraceTag(22073953,307,50,"EdgeSystemClipboardAccessManager"),
b=new Wt(this.Ca,Ma.a.instance.resolve("Box4.IClipboardDataHelper"),Ma.a.instance.resolve("Box4.IProcessImageStrategy"),Ma.a.instance.resolve("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy"))):(t.ULS.sendTraceTag(7377744,307,50,"DefaultSystemClipboardAccessManager"),b=new OB(this.Re,this.Ca));return b}}Object(m.a)(Sy,"SystemClipboardAccessManagerFactory",null,[682]);class Ty{Pyl(b){return b}}Object(m.a)(Ty,"DeleteTableSegmentStrategy",null,[681]);var Uy=c(445),$r=c(1055);class Fp{get qq(){return Tt.a.MGb}get Tk(){return null!=
this.MFg?this.MFg:this.MFg=Ma.a.instance.resolve("Box4.IParagraphEditor")}get q1(){return this.Tk.qq}get Ic(){return Nh.a.instance}get SA(){return null!=this.XFg?this.XFg:this.XFg=Ma.a.instance.resolve("Box4.IParagraphIndentationReader")}MGc(b,h,r,B,P,ca,ra){let Qa=2;if(!b.ue)return 2;const tb=b.mb;if(!tb)return this.Ic.Yb(le.a.ef,{["Reason"]:ae.a.Eda}),8;if(v.AFrameworkApplication.K.$("Box4PartialPromoteDemoteIsEnabled")){b=this.MBh(h===Nb.a.ZG,r,!0);if(1===B)return b?32:8;b&&(Qa=$r.a.bic(h,r,B,
P,ca,ra))}else Qa=$r.a.bic(h,r,1,P,ca,ra),1!==B&&32===Qa?(b.mb.B8d(),b=new cg.GraphTransaction(15),b.Db(r.view.ed),Qa=this.MBh(h===Nb.a.ZG,r,!1)?$r.a.bic(h,r,B,P,ca,ra):8,b.dispose()):1!==B&&8===Qa&&(b.mb.B8d(),this.x3k(h,r,tb));return Qa}MBh(b,h,r){h=h.view.mb;if(!h||!h.ib.lb)return this.Ic.Yb(le.a.ef,{["Reason"]:ae.a.cMb}),!1;if(h.ib.LJ)return this.Ic.Yb(le.a.ef,{["Reason"]:ae.a.A$e}),!1;h=Uy.OutlineElementGeneralizer.Aha(h.ib,!1);if(!h)return this.Ic.Yb(le.a.ef,{["Reason"]:ae.a.XNd}),!1;let B=
!1;for(let P=0;P<h.length;P++){const ca=h.getContext(P),ra=new Ad.GraphIterator;ra.set(ca.node);xe.SelectionEditor.zu(ra);if(!Uf.OutlineElementReader.Eh(ra))if(r)continue;else return this.Ic.Yb(le.a.ef,{["Reason"]:ae.a.gEb}),!1;if(b?!this.qq.bCb(ra):!this.qq.m4b(ra))if(r)continue;else return this.Ic.Yb(le.a.f7b,{["Reason"]:ae.a.Z6e}),!1;B=!0}return r?B:!0}x3k(b,h,r){const B=new cg.GraphTransaction(15);try{B.Db(h.view.ed);h=!0;const P=Uy.OutlineElementGeneralizer.Aha(r.ib,!1);for(let ca=0;ca<P.length;ca++){const ra=
P.getContext(ca),Qa=new Ad.GraphIterator;Qa.set(ra.node);xe.SelectionEditor.zu(Qa);if(!Uf.OutlineElementReader.Eh(Qa))h=!1;else if(b===Nb.a.ZG?this.qq.bCb(Qa):this.qq.m4b(Qa))switch(h=!1,b){case Nb.a.ZG:this.qq.oTa(Qa,-1,0);break;case Nb.a.MO:this.qq.ILc(Qa,1)}}if(h){const ca=r.ib.lb;for(r=0;r<ca.length;r++){const ra=ca.J(r);if(ra.el){const Qa=this.SA.ijb(ra.node),tb=Qa.sea;if(b===Nb.a.ZG?Qa.OB>tb:Qa.OB<18*tb){const Mb=new Ad.GraphIterator;Mb.set(ra.node);this.q1.Iza(Mb,1,b===Nb.a.ZG?Qa.OB>=2.5*tb?
Qa.OB-2*tb:tb:Qa.OB<16*tb?Qa.OB+2*tb:18*tb)}}}}}finally{B&&B.dispose()}}}Object(m.a)(Fp,"IndentationActorExtension",null,[680]);var Yu=c(756),Oz=c(1234);class IC{constructor(b,h){this.mo=new fd.DictionaryPropertySet;this.yud=new fd.DictionaryPropertySet;this.iwb=!1;this.kCa=this.Htb=null;this.f7=b;this.pWg=h}get mrb(){return null!=this.bIg?this.bIg:this.bIg=Ma.a.instance.Oa("Box4.ITextFormattingCommands")}get qn(){return null!=this.yAg?this.yAg:this.yAg=Ma.a.instance.resolve("Box4.IFormattingEditor")}get qc(){return null!=
this.iKg?this.iKg:this.iKg=Ma.a.instance.resolve("Box4.Styles.IWACStyleReader")}p7a(){this.iwb||(0<this.cRa.aL()&&(this.yud=this.mo.clone()),this.mo.K7f(),this.Htb=null,this.Q_n())}p8k(b){var h;const r=null!==(h=pn.FormattingReader.Yr(b))&&void 0!==h?h:pn.FormattingReader.SRd(b.node,b.cpBegin,-1);!r.cache.UB&&(b=r.Jn)&&(h=new fd.DictionaryPropertySet,h.ax(b),h.ax(this.mo),h.hasProperty(gi.a.qw)&&(this.Htb=r.paragraph.Mc),this.mo=h)}hasProperty(b){return this.mo.hasProperty(b)}kTc(){return 0<this.mo.aL()}get cRa(){return this.mo}freeze(){this.iwb=
!0}sJa(){this.iwb=!1}KG(b,h){return this.cRa.ja(b,h)}WA(b){this.mo.setValue(Pd.a.fontSize,this.qn.o5b(b));this.J1();Am.a.o6f(this.yud,this.mo)}fontSize(){return this.mo.ja(Pd.a.fontSize,Am.a.GM)}Qge(b){this.mo.setValue(Pd.a.font,b);this.pWg&&this.pWg.execute(h=>{null==h?t.ULS.sendTraceTag(527029267,324,10,"IFontNameFormattingStrategy is null after future execution"):h.Qge(this.mo)});this.f7&&this.f7.enabled&&(Qc.b(40506690,306,50,"InsertionPointFomatting: Set font slot values"),this.f7.ijo(this.mo,
b));this.J1();Am.a.o6f(this.yud,this.mo)}Reg(b){this.mo.setValue(Mc.a.Ie,b);this.f7&&this.f7.enabled&&(Qc.b(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.f7.Joo(this.mo,b));this.J1()}Yv(b){b=qi.a.instance.nva(Bh.a.instance.ib.lb.Pa.node,b);this.mo.setValue(Pd.a.fontColor,b);this.J1();Am.a.o6f(this.yud,this.mo)}Jga(){this.mo.setValue(Pd.a.fontColor,Wi.a.auto);this.J1()}fontColor(){return this.mo.ja(Pd.a.fontColor,Wi.a.nil)}Gza(b){this.mo.setValue(Pd.a.highlight,parseInt(b,
16));this.J1()}qGd(){this.mo.setValue(Pd.a.highlight,Wi.a.auto);this.J1()}isBold(){return this.mo.ja(Pd.a.bold,!1)}HL(b){this.mo.setValue(Pd.a.bold,b);this.J1()}isItalic(){return this.mo.ja(Pd.a.italic,!1)}az(b){this.mo.setValue(Pd.a.italic,b);this.J1()}isUnderline(){return this.mo.ja(Pd.a.underline,!1)}Q5(b){this.mo.setValue(Pd.a.underline,b);this.mo.setValue(Pd.a.underlineType,b?Am.a.FSb:Am.a.QV);this.J1()}underlineType(){return this.mo.ja(Pd.a.underlineType,Am.a.QV)}fka(b){b<Am.a.FSb||b>Am.a.QV||
(this.mo.setValue(Pd.a.underline,b!==Am.a.QV),this.mo.setValue(Pd.a.underlineType,b),this.J1())}isSuperscript(){return this.mo.ja(Pd.a.superscript,!1)}vra(b){this.mo.setValue(Pd.a.superscript,b);b&&this.isSuperscript()&&this.mo.setValue(Pd.a.subscript,!1);this.J1()}isSubscript(){return this.mo.ja(Pd.a.subscript,!1)}OIa(b){this.mo.setValue(Pd.a.subscript,b);b&&this.isSubscript()&&this.mo.setValue(Pd.a.superscript,!1);this.J1()}isStrikethrough(){return this.mo.ja(Pd.a.strikethrough,!1)}dka(b){this.mo.setValue(Pd.a.strikethrough,
b);this.J1()}isDoubleStrikethrough(){return this.mo.ja(gi.a.Ht,!1)}Kge(b){this.mo.setValue(gi.a.Ht,b);this.J1()}I6h(){return this.mo.ja(gi.a.qw,null)}c8a(b,h){this.mo.K7f();this.mo.setValue(gi.a.qw,b.id);this.Htb=h.Mc;this.J1()}N5(b){let h=Pd.a.uL;const r=Yu.a.A2d(b);switch(r){case 1:h=Mc.a.Iec;break;case 2:h=Mc.a.Jec}this.mo.setValue(Mc.a.g5a,r);this.mo.setValue(h,b);this.J1()}language(){let b=Pd.a.uL;switch(this.mo.ja(Mc.a.g5a,0)){case 1:b=Mc.a.Iec;break;case 2:b=Mc.a.Jec}return this.mo.ja(b,0)}ylo(b){this.mo.setValue(Mc.a.noProof,
b);this.J1()}AJb(){return this.mo.ja(Mc.a.noProof,!1)}aRm(){return this.mo.hasProperty(Mc.a.noProof)}HPm(){return this.mo.hasProperty(Pd.a.uL)||this.mo.hasProperty(Mc.a.Iec)||this.mo.hasProperty(Mc.a.Jec)}J1(){if(Z.a.Qmc){var b=Bh.a.instance.ib.lb.Pa,h=b.node;if(h===this.kCa)this.kCa.ol(16,!0);else{this.kCa=h;h=this.kCa.sZ();try{this.kCa.RX(b.cpBegin).Hxa=!0}finally{h&&h.dispose()}}}}Q_n(){if(Z.a.Qmc&&this.kCa){var b=0,h=this.kCa.sZ();try{for(let r=this.kCa.qa.length-1;0<=r;r--){const B=this.kCa.qa.J(r);
B.Hxa&&(B.Hxa=!1,b++,B.isEmpty&&this.kCa.qa.removeAt(r))}}finally{h&&h.dispose()}this.kCa=null}}p6k(b){if(b.cpBegin!==b.cpEnd)return!1;b=b.node.qa.nh(b.cpBegin);return!!b&&b.Hxa}r2e(b){if(this.mrb){this.freeze();var h=new cg.GraphTransaction(7);h.Db(b.node);this.mrb.Sge(b);this.sJa();this.p7a();h.dispose()}}Auf(b){const h=ke.ParagraphReader.text(b.node);return b.cpBegin&&b.cpBegin!==h.length&&!F.a.Qv(h.charCodeAt(b.cpBegin))&&Oz.a.instance.C2a(h,b.cpBegin-1)!==b.cpBegin&&xe.SelectionEditor.Llb(b)?
(b=xe.SelectionEditor.j0(b,!1))?1<b.length||xe.SelectionEditor.vl(b.Pa)?b:null:null:null}}Object(m.a)(IC,"InsertionPointFormatting",null,[679]);class Ww{constructor(b){this.ga=b}get oc(){return this.ga}LPk(b,h,r=null){const B=new fd.DictionaryPropertySet;B.setValue(Yc.a.MA,b);B.setValue(Yc.a.eSa,h);r&&B.ax(r);B.CommandSource="autobulleting";this.oc.Qb(Nb.a.rD,2,B)}Gjn(b,h,r,B,P){const ca=new fd.DictionaryPropertySet;ca.setValue(Yc.a.MA,b);ca.setValue(Yc.a.eSa,h);ca.setValue(Yc.a.q5a,r);P&&ca.setValue(lh.a.OQ,
P);B&&ca.setValue(Mc.a.pv,B);Ym.a.DY&&(ca.setValue(lh.a.cqa,"autocorrect"),P&&ca.setValue(lh.a.Jia,P));ca.CommandSource="autonumbering";return 32===this.oc.Qb(Nb.a.LL,2,ca)}}Object(m.a)(Ww,"ListCommands",null,[678]);var Dv=c(297);class Vy extends Dv.a{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb){super();this.p_b=this.jn=this.ZKa=null;this.KIn=(jc,Gc)=>{Gc=this.Ota.Mae(this.ZKa,Gc);jc.pi(this.dKl);return Gc};this.dKl=(jc,Gc)=>{if(this.jn.moveNext())return jc=this.jn.currentNode,12!==jc.type||jc===this.ZKa.node?
!0:this.Ota.D4c(jc,Gc);this.bPk();jc.pi(this.fKl);return!0};this.fKl=(jc,Gc)=>{if(this.jn.moveNext()){const Uc=this.jn.currentNode;return 12!==Uc.type?!0:Uc===this.ZKa.node?(jc.pi(this.LIn),!0):this.Ota.D4c(Uc,Gc)}return!1};this.LIn=(jc,Gc)=>{this.Ota.Nae(this.ZKa,Gc);return!1};this.init(b);this.Rl(Zb);this.zkb(Qa,h,B,P,ca);this.XL=ca;this._context=r;this.hb=tb;this.Fe=Mb;this.Ota=ra;this.nz=0}run(){this.L7e();this.nz||this.xqo();1===this.nz&&this.RJn();2===this.nz&&this.KIo();3===this.nz&&this.yFl()}L7e(){this.hb.ib&&
this.hb.ib.lb?1===this.behavior&&(this.Ota.L7e(this._context)?this.ur=32:this.ur=2,this.nz=3):(t.ULS.sendTraceTag(20321351,324,15,"No selection for ignore all"),this.ur=2,this.nz=3)}xqo(){this.GOk();this.Ota.ufg(this.ZKa)?(this.ZNk(),this.nz=1):(this.ur=8,this.nz=3)}RJn(){this.JC||new qv.a(this,this.KIn,this.XL);do if(this.JC.run(),this.JC.inProgress&&!this.Qh)return;while(this.JC.inProgress);this.mGd();this.nz=2}KIo(){this.Ota.Dlg(this)?this.ur=32:this.ur=8;this.nz=3}yFl(){this.tra()}GOk(){let b=
this.hb.ib.lb;if(b=this.Fe.Jj(b,!0,!1))this.ZKa=b.Pa;this.ZKa&&this.ZKa.node&&(this.p_b=this.Ota.Dfi(this.ZKa.node))}ZNk(){if(!this.p_b)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new Nf.a;b.set(this.ZKa.node);b.zb(this.p_b.type);this.jn=nm.a.Gs(b,this.p_b);this.jn.yo(Object(z.a)(this.Ota,this.Ota.qmc,"spellErrorFilter"),null)}bPk(){if(!this.p_b)throw Error.argumentNull("_proofingWholeDocumentRootNode");const b=new Nf.a;b.set(this.p_b);this.jn=nm.a.Qp(b);this.jn.yo(Object(z.a)(this.Ota,
this.Ota.qmc,"spellErrorFilter"),null)}}Object(m.a)(Vy,"ProofingWholeDocumentOperation",Dv.a,[]);var Wx=c(278);class Kr extends Eo{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}Object(m.a)(Kr,"ContextMenuRootProperties",Eo,[]);var MA=c(1383);class PB{constructor(b){const h=new Kr;h.ImageSideArrow=v.AFrameworkApplication.Ns;h.ImageSideArrowClass=we.getImageClass("SubmenuFlyoutArrow_13x13x32");h.TextDirection=Box4Intl.Box4Strings.L_RibbonOptionTextDirection;h.CommandMenuOpen=
Nb.a.kae.toString();this.mjh=new MA.ContextMenuRoot("ContextMenuRootName",h);b.execute(r=>{this.Y1.JF=r});this.Y1.refresh();v.AFrameworkApplication.va.ra(fb.a.showContextMenu,yd.a.frame,cd.ActionManager.Of);v.AFrameworkApplication.va.ra(fb.a.Tlc,yd.a.frame,cd.ActionManager.Of)}get Y1(){return this.mjh}dispose(){this.Y1&&(this.Y1.dispose(),this.mjh=null)}showContextMenu(b,h){this.vqb(b,h.clientPoint,h.kg)}M5b(b,h,r,B,P){this.Y1.M5b(b,h,r,B,P)}i8a(b,h,r){Qd.a.F4d(this.Y1.q_a?"ShowLegacyContextMenuAndFloatie":
"ShowLegacyContextMenu","");Eb.App.za.YIl();this.wu();this.Y1.i8a(b,h,r);this.Y1.q_a?v.AFrameworkApplication.va.processAction(fb.a.Tlc,2):v.AFrameworkApplication.va.processAction(fb.a.showContextMenu,2)}vqb(b,h,r){this.i8a(b,new Sys.UI.Bounds(h.x,h.y,0,0),r)}wu(){this.Y1.root.Hm()}o4(){return this.Y1.o4()}Tlc(b,h,r,B){const P=this.Y1;let ca=!1;r=Object(Ra.a)(Vt,r);P.q_a=r;B.Lza(b,h);P.oZe?r&&(r.hFn(P,h),ca=!0):(t.ULS.sendTraceTag(4801985,324,15,"Failed to launch the context menu!  Menu type:  {0}.",
B.ohl()),P.q_a=null);return ca}}Object(m.a)(PB,"AContextMenuController",null,[710,9]);class qs{}qs.Dic="faProofing";qs.RVh="EditorMenuSection";Object(m.a)(qs,"ContextMenuControlId",null,[]);var Ev=c(534);class ni{constructor(b){this.Fe=b}L7e(b){b=Object(Ra.a)(Ev.a,b);return!!b&&!!b.view&&b.view.ue}ufg(){return!0}Mae(){return!0}D4c(){return!0}Nae(){}Dlg(){return!0}qmc(b){if(b.$r)return!0;b=b.role;return 1===b||2===b||3===b||4===b||5===b}Dfi(b){if(!b||!this.Fe)return b;const h=new Nf.a;h.set(b);if(this.Fe.zu(h)){for(;!h.$r;)h.uc();
return h.currentNode}return b}}Object(m.a)(ni,"SimpleProofingWholeDocumentCallBacks",null,[546]);class Fv{constructor(b){this.value=b}}Object(m.a)(Fv,"RefBool",null,[]);class ct{constructor(){this.FNc=this.aMb=null;this.TDj=new Fv(!1)}}Object(m.a)(ct,"FindNextErrorOperationParam",null,[]);class Xx{constructor(){this.Priority=0;this.Context=null;this.Length=this.StartInContext=this.Start=0;this.Metadata=Xx.evl;this.Suggestions=this.TypeId=this.TraceId=null;this.CritiqueActions=this.SupportedActions=
0;this.RevisionId=this.TileId=this.Explanation=this.ExplanationLabel=this.ExplanationTitle=this.CategoryTitle=null;this.Tag=this.Status=this.BucketId=0}}Xx.evl=[];Object(m.a)(Xx,"Critique",null,[]);class Pz{constructor(){this.Text=null;this.Level=0;this.Source=null;this.BucketId=this.Action=0;this.Description=null;this.NumberOfInstances=0}}Object(m.a)(Pz,"Suggestion",null,[]);var QB=c(607);class Gn extends Sys.EventArgs{constructor(b,h,r,B,P,ca){super();this.p5j=b;this.v7j=h;this.w7j=r;this.Hse=B;
this.$z=P;this.f$a=ca}}Object(m.a)(Gn,"AugloopProofingContextMenuArgs",Sys.EventArgs,[]);var Yx=c(339);class rs{constructor(b,h,r){this.JAe=b;this.Un=h;this.sa=r}YJh(b){const [h,r,B]=this.hki(b);return this.B9h(h,r,B)}CKm(b){return Ee.a.getTypeNameFor(b.content)===Yx.a.getTypeName()}B9h(b,h,r){if(r&&this.CKm(r)){if(this.a3b(r.content))return null;const P=r.content;var B=new Xx;B.ExplanationTitle=P.explanationTitle;B.Suggestions=this.bgm(r);B.CategoryTitle=P.categoryName;B.TypeId=P.typeId;B.CritiqueActions=
P.critiqueActions;B.Priority=P.priority;r=this.JAe.create(B);B=P.context;r.token=B.substring(P.range.start,P.range.start+P.range.length);r.lcid=lj.a.tg(P.language).LCID;r.originalText=B;return new QB.a(b,h,r)}return null}bgm(b){var h=b.content.suggestions;b=[];for(const r of h)h=new Pz,h.Action=r.suggestionActions,h.Text=r.text,h.Description=r.description,b.push(h);return b}a3b(b){if(!b)return!0;if(!b.M_||!b.M_.state)return!1;b=b.M_.state;return 60===b||70===b}hki(b){const h=this.Un.ZQc(b,0),r=b.cpBegin,
B=b.cpEnd,P=xe.SelectionEditor.Ze(b);b=ke.ParagraphReader.text(b.node,0);for(const ca of h)if(P){if(ca.Ec<=r&&ca.end>=B)return[ca.Ec,ca.end,ca.intent]}else if(ca.Ec<=r&&ca.end>=r&&F.a.dJh(b,ca.end,B))return[ca.Ec,ca.end,ca.intent];return[null,null,null]}static QB(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}gyf(b,h,r){const [B,P,ca]=this.hki(b);ca&&this.sa.raiseEvent(rs.Hwh,new Gn(b,B,P,h,ca,r))}yxk(b){this.sa.addHandler(rs.Hwh,
b)}ZBl(b,h,r){b=this.Un.tSd(b,0,0,b.characterData.length);for(let B=0;B<b.count;B++){const P=b.J(B);if(P.intent){const ca=P.intent;if(ca.content&&(0==ca.content.priority||1==ca.content.priority)&&P.Ec>=h&&(!r||r(P.intent)))return this.B9h(P.Ec,P.end,P.intent)}}return null}}rs.Hwh="augloopProofingContextMenuActionEventKey";Object(m.a)(rs,"AugLoopProofingErrorDetailHelper",null,[]);class Wy extends ni{constructor(b,h,r,B){super(h);this.Cn=b;this.iDc=r;this.VWj=B}Mae(b,h){return!this.QMf(b.node,b.cpBegin,
h)}D4c(b,h){return!this.QMf(b,0,h)}Nae(b,h){this.QMf(b.node,0,h);Object(Ra.a)(ct,h)}QMf(b,h,r){r=Object(Ra.a)(ct,r);if(ke.ParagraphReader.Xb(b)&&!b.JJ)if(pn.FormattingReader.Yr(Ue.a.Rc(b,h)).cache.AJb)r.TDj.value=!0;else{if(rs.QB())return h=this.VWj.ZBl(b,h,this.iDc),null!=h?(r.aMb=h,r.FNc=b,!0):!1;const B=this.Cn.E4(b);for(let P=0;P<B.length;P++){const ca=B[P];if(ca.Ec>=h&&!ca.errorDetails.z4a()&&(!this.iDc||this.iDc(ca.errorDetails)))return r.aMb=ca,r.FNc=b,!0}return!1}}}Object(m.a)(Wy,"FindNextErrorCallbackSteps",
ni,[]);var Ko=c(305);class NA{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc,Uc,od,Od){this.p0k=(ze,de,ee,je,ue)=>{de=this.hb.ib.lb;if(!de)return this.Ad.Yb(le.a.ef,{["Reason"]:ae.a.noSelection}),2;de=this.Fe.Jj(de,!0,!1);return this.ga.Nf(de.Pa,ze,ee,!1,je,ue)};this.lxn=(ze,de,ee)=>{if(1===ee)return this.ga.processAction(Nb.a.N5,1);this.s$j().vhg();return 32};this.zEa=(ze,de,ee)=>{if(1===ee)return 32;kh.a.mark(4670);ee=this.Cn.Boa(de);if(this.pne(ee))return 8;de=de.node;const je=this.Lc.Pc(15);let ue=
ee.Ec;" "===ke.ParagraphReader.text(de).charAt(ue-1)&&ue--;je.Db(de);const Qf=this.Md.Ge(Ue.a.createTextRange(de,0<ee.Ec?ee.Ec-1:0,ee.end),"",!0,!1);this.hb.Ac(og.SelectionFactory.ne(de,Qf+ue));je.dispose();ee.errorDetails.Arb(ze);kh.a.mark(4671);return 32};this.kxa=(ze,de,ee)=>{if(1===ee)return 32;t.ULS.sendTraceTag(7660830,324,50,"Ignore spelling error triggerred");if(rs.QB())return this.w$a.gyf(de,null,Ko.b.IgnoreOnce),32;kh.a.mark(4670);ee=this.Cn.Boa(de);if(this.pne(ee))return 8;de=de.node;const je=
this.Lc.Pc(15);je.Db(de);this.Cn.fpb(de,[ee],!0);de.setValue(Pd.a.x$e,!0);je.dispose();ee.errorDetails.Arb(ze);kh.a.mark(4671);t.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");this.p7m(ee);this.ZYa.hqi(ee,de,!0);return 32};this.D8k=(ze,de,ee)=>{var je,ue=!this.Ok.x9(de);this.en&&this.en.instance&&this.en.instance.SU(de)&&(ue=!1);if(1===ee||!ue)return ue?32:8;this.ga.processAction(Nb.a.Lra,2);kh.a.mark(4670);ue=this.RTl(ze);if(0>ue)return 8;if(rs.QB())return this.w$a.gyf(de,
ue,Ko.b.Apply),32;ee=this.Cn.Boa(de);if(this.pne(ee))return 8;de=de.node;var Qf=ee.errorDetails.suggestions;if(!Qf)return this.Ad.Yb(le.a.MEb,{["Reason"]:"NoSuggestionsFound"}),kh.a.mark(4671),8;ue=ue<Qf.length?Qf[ue]:null;if(!ue)return this.Ad.Yb(le.a.MEb,{["Reason"]:"RequestedSuggestionIsNull"}),kh.a.mark(4671),8;(null===(je=Eb.App.zd)||void 0===je?0:je.Uo)&&Eb.App.zd.fq.gG(de);ue=ue.replace("  "," \u00a0");je=this.Lc.Pc(15);je.Db(de);Qf=this.Md.Ge(Ue.a.createTextRange(de,ee.Ec,ee.end),ue,!0,!1,
Nb.a.Lra);this.hb.Ac(og.SelectionFactory.ne(de,ee.Ec+ue.length+Qf));je.dispose();ee.errorDetails.Arb(ze);kh.a.mark(4671);this.P3m(ee);return 32};this.Hdo=(ze,de)=>{de=this.Cn.Boa(de);if(this.pne(de))return 8;de.errorDetails.Arb(ze);return 32};this.CEl=(ze,de,ee,je,ue)=>{if(!de.view.ue)return 2;const Qf=de.view;if(!this.hb.ib.lb)return this.Ad.Yb(le.a.ef,{["Reason"]:ae.a.noSelection}),2;if(1===ee)return 32;const Jg=new ct,Ql=new Wy(this.Cn,this.Fe,this.iDc,this.w$a);de=new Vy(null,ze,de,ee,je,Jg,Ql,
this.ga,this.hb,this.Fe,null);de.Qh=!0;de.run();if(de.isCompleted&&Jg.aMb){if(de=og.SelectionFactory.ne(Jg.FNc,Jg.aMb.Ec),de=og.SelectionFactory.Gy(de,Ue.a.Rc(Jg.FNc,Jg.aMb.end)),!this.kch.instance||!this.kch.instance.fHn(Jg.aMb,de,Qf)){this.hb.Ac(de);let Fm=0;ue&&(Fm=ue.Rx);Qf.Aie=!1;Wg.a.instance.Wb(new Me.a(1,1,1,()=>{this.Nbo(Qf,Fm,Jg.FNc,Jg.aMb)}))}}else{const Fm=new Tf.StandardDialog;Fm.Cd=0;Eb.App.zN.qYc?Fm.jka(CommonUIStrings.l_DefaultDialogTitle,Jg.TDj.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:
Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(Fm.jka(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ProofingInProgress,null),Eb.App.zN.XBd(()=>{Fm.Mpa&&(Fm.hide(),this.ga.processAction(ze,2))}))}return 32};this.kae=(ze,de,ee)=>{if(1===ee)return 32;this.efa&&this.efa.Y1&&(ze=this.efa.Y1.nwf(qs.Dic))&&!ze.wL&&(ze.U0(0),ze.menu.eL(0));return 32};this.ga=h;this.Cn=b;this.s$j=r;this.Md=B;this.Lc=P;this.hb=ca;this.en=ra;this.Fe=Qa;this.Hik=tb;this.Ok=Mb;this.Ad=Zb;this.w$a=Od;this.efa=
Object(Ra.a)(PB,jc);this.pYb=Gc.RXc;this.kch=Uc;this.ZYa=od;this.wqc=new Map;this.wqc.set(1,Nb.a.Mig);this.wqc.set(2,Nb.a.Owf);this.wqc.set(3,Nb.a.Njg);this.WBc=new Map;this.WBc.set(1,Nb.a.Nig);this.WBc.set(2,Nb.a.Pwf);this.WBc.set(3,Nb.a.Ojg)}Tb(){const b=this.ga,h=this.D8k,r=this.p0k;b.fb(Nb.a.p9d,yc.a.view,this.lxn,1028);b.ra(Nb.a.zEa,yc.a.Uc,this.zEa);b.ra(Nb.a.kxa,yc.a.Uc,this.kxa);b.ra(Nb.a.hrb,yc.a.Uc,h);b.ra(Nb.a.irb,yc.a.Uc,h);b.ra(Nb.a.jrb,yc.a.Uc,h);b.ra(Nb.a.VRb,yc.a.Uc,h);b.ra(Nb.a.WRb,
yc.a.Uc,h);b.ra(Nb.a.zEa,yc.a.view,r);b.ra(Nb.a.kxa,yc.a.view,r);b.ra(Nb.a.hrb,yc.a.view,r);b.ra(Nb.a.irb,yc.a.view,r);b.ra(Nb.a.jrb,yc.a.view,r);b.ra(Nb.a.VRb,yc.a.view,r);b.ra(Nb.a.WRb,yc.a.view,r);b.Xc(Nb.a.zEa,1028);b.Xc(Nb.a.kxa,1028);b.Xc(Nb.a.hrb,1028);b.Xc(Nb.a.irb,1028);b.Xc(Nb.a.jrb,1028);b.Xc(Nb.a.VRb,1028);b.Xc(Nb.a.WRb,1028);b.ra(Nb.a.Lra,yd.a.frame,cd.ActionManager.Of);this.pYb&&b.fb(Nb.a.kae,yc.a.view,this.kae,1124);b.fb(Nb.a.o1c,yc.a.view,this.CEl,1028);b.fb(Nb.a.Q3f,yc.a.Fd,this.Hdo,
1124);this.QWn([Nb.a.$je,Nb.a.Mig,Nb.a.Nig,Nb.a.BVd,Nb.a.Owf,Nb.a.Pwf,Nb.a.Cke,Nb.a.Njg,Nb.a.Ojg,Nb.a.p5i,Nb.a.JQi,Nb.a.Ouj])}QWn(b){for(let h=0;h<b.length;h++)this.ga.fb(b[h],yc.a.view,cd.ActionManager.gR,1028)}dYn(b){this.iDc=b}pne(b){return b?b.errorDetails?!1:(t.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this.Ad.Yb(le.a.MEb,{["Reason"]:"ErrorRangeMissingErrorDetails"}),kh.a.mark(4671),!0):(t.ULS.sendTraceTag(7660828,324,10,"Ignore Spelling Error: No flagged word"),
this.Ad.Yb(le.a.MEb,{["Reason"]:"RequestedErrorRangeNotFound"}),kh.a.mark(4671),!0)}p7m(b){b=b.errorDetails.proofingType;if(this.WBc.has(b)){const h=this.WBc.get(b);this.ga.processAction(h,2);t.ULS.sendTraceTag(527799886,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",h,b)}}RTl(b){switch(b){case Nb.a.hrb:return 0;case Nb.a.irb:return 1;case Nb.a.jrb:return 2;case Nb.a.VRb:return 3;case Nb.a.WRb:return 4;default:return-1}}P3m(b){b=b.errorDetails.proofingType;if(this.wqc.has(b)){const h=
this.wqc.get(b);this.ga.processAction(h,2);t.ULS.sendTraceTag(527799887,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",h,b)}}Nbo(b,h,r,B){b.E1();(b=r.te(b.$b))?(B=Wx.a.Wq(b,v.AFrameworkApplication.isRtl?B.Ec:B.end),this.Hik.Lza(new Sys.UI.Point(B.x,B.y+B.height),h)):t.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")}}Object(m.a)(NA,"ProofingActor",null,[]);var Cj=c(409),as=c(1582),JC=c(1873),Zu=c(542);class bs{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb){this.Hmc=
null;this.cHl="StyleUsageActivity";this.dHl="StylesFloodgateSurveyIsEnabled";this.dOa=(jc,Gc,Uc,od)=>{jc=this.Dfm(jc);return 0>jc||jc>this.Hmc.length?2:(jc=this.Hmc[jc])?v.AFrameworkApplication.va.Nf(Gc,Nb.a.NQ,Uc,!0,od,jc):2};this.INb=(jc,Gc,Uc,od,Od)=>{jc=!0;Gc.contextId!==yc.a.paragraph&&Gc.contextId!==yc.a.Fd&&Gc.contextId!==yc.a.Uc&&(jc=!1);if(1===Uc||!jc)return jc?32:8;if(2===Uc&&!Od)return 8;Gc=this.qc.JB(Gc.node);Od.MenuItems=Cj.a.v5l(Gc);return 32};this.WMn=(jc,Gc,Uc,od,Od)=>{jc=!0;Gc.contextId!==
yc.a.paragraph&&(jc=!1);if(1===Uc&&!jc)return 8;Gc=Gc.node;Uc=this.qc.So(Gc);if(!Uc||!Od)return t.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",Od,Gc,Uc),8;Od.TUa.ax(Uc.Gl());return 32};this.fGk=(jc,Gc,Uc,od,Od)=>{if(Gc.contextId!==yc.a.paragraph)return 8;if(this.Yf.M4a(Gc,!1))return this.Ic.Yb(le.a.vn,{["Reason"]:ae.a.cF}),8;if(1===Uc)return 32;const ze=Gc.node;if(ke.ParagraphReader.uva(ze)||!Od)return 8;const de=this.avf(Od,ze);if(!de)return this.Ic.Yb(le.a.f2,
{["Reason"]:ae.a.NEb}),8;if(2!==this.qc.LG(de))return 2;Uc=new cg.GraphTransaction(15);this.jo&&this.jo.B9&&this.VH.cmc(Od);Uc.Db(ze);this.Bj.p7a();const ee=[];jc!=Nb.a.LC&&ee.push(dd.a.cKa);this.c6.aK(de,ze,!1,void 0,void 0,void 0,zm.a.Xj?new JC.a(ee,!1,!0):null);(jc=this.qc.JB(ze))&&this.qc.le(de,jc)&&Qc.b(593078098,3017,50,"Custom linked style applied by user");ze.Gr&&(jc=[Object.assign(new ha.a,{name:"Source",string:"ApplyStyle"})],Ke.a("TOCFormatting",!0,void 0,jc));Uc.dispose();Od=F.a.RQ(Od);
od.Hs=Od>>>16^Od&65535;od&&as.a.krb&&(od.PC|=as.a.Tib(Gc.node));return 32};this.XMn=(jc,Gc,Uc,od,Od)=>{jc=!0;Gc.contextId!==yc.a.Fd&&(jc=!1);if(1===Uc&&!jc)return 2;Gc=pn.FormattingReader.Yr(Gc);Gc=pn.FormattingReader.Toa(Gc);if(!Gc)return 2;if(!Od)return 8;Od.TUa.ax(Gc.Gl());return 32};this.gGk=(jc,Gc,Uc,od,Od)=>{if(Gc.contextId!==yc.a.Fd)return 8;this.Yf.M4a(Gc);if(1===Uc)return 32;jc=Gc;zm.a.hId&&(Gc=this.Lo.KTd(jc))&&(jc=Gc);Gc=jc.node;if(!Od)return 8;const ze=this.avf(Od,jc.node);if(!ze)return this.Ic.Yb(le.a.f2,
{["Reason"]:ae.a.NEb}),8;if(1!==this.qc.LG(ze))return 2;Uc=this.qc.JB(Gc);if(!Uc)return this.Ic.Yb(le.a.f2,{["Reason"]:ae.a.PZh}),8;if(!Uc.oj(this.qc.Ag(ze)))return this.Ic.Yb(le.a.f2,{["Reason"]:ae.a.NEb}),8;const de=new cg.GraphTransaction(7);try{if(this.jo&&this.jo.B9&&this.VH.cmc(Od),de.Db(Gc),this.c6.qqg(Gc,Uc),this.Eea.rX(jc,ee=>{this.qn.Iga(ee);this.qn.c8a(ee,ze)}),Gc.Gr){const ee=[Object.assign(new ha.a,{name:"Source",string:"ApplyStyle"})];Ke.a("TOCFormatting",!0,void 0,ee)}}finally{de&&
de.dispose()}Uc&&this.qc.le(ze,Uc)&&Qc.b(593078097,3017,50,"Custom linked style applied by user");Od=F.a.RQ(Od);od.Hs=Od>>>16^Od&65535;od&&as.a.krb&&(od.PC|=as.a.Tib(jc.node));return 32};this.VMn=(jc,Gc,Uc,od,Od)=>{jc=!0;Gc.contextId!==yc.a.Uc&&(jc=!1);if(1===Uc&&!jc)return 2;Gc=this.c6.Jfm(Gc);if(!Gc)return 2;if(!Od)return 8;Od.TUa.ax(Gc.Gl());return 32};this.eGk=(jc,Gc,Uc,od,Od)=>{if(Gc.contextId!==yc.a.Uc)return 8;if(this.Yf.M4a(Gc,!1))return this.Ic.Yb(le.a.vn,{["Reason"]:ae.a.cF}),8;if(1===Uc)return 32;
var ze=Gc.node;if(!Od)return 8;Uc=this.avf(Od,Gc.node);if(!Uc)return this.Ic.Yb(le.a.f2,{["Reason"]:ae.a.NEb}),8;const de=this.qc.LG(Uc);if(1!==de&&2!==de)return 2;(Gc=this.Bj.Auf(Gc))?(Gc=Bh.a.kDb(Gc),jc=v.AFrameworkApplication.va.Nf(Gc,jc,2,!1,od,Od)):(jc=new cg.GraphTransaction(7),this.jo&&this.jo.B9&&this.VH.cmc(Od),jc.Db(ze),this.c6.ioo(Uc,ze),jc.dispose(),jc=32);ze.Gr&&(Gc=[Object.assign(new ha.a,{name:"Source",string:"ApplyStyle"})],Ke.a("TOCFormatting",!0,void 0,Gc));(ze=this.qc.JB(ze))&&
this.qc.le(Uc,ze)&&Qc.b(593078096,3017,50,"Custom linked style applied by user");Od=F.a.RQ(Od);od.Hs=Od>>>16^Od&65535;return jc};this.YMn=(jc,Gc,Uc,od,Od)=>{const ze=this.ved.Kqa(jc,Gc,Uc,od,Od,null,0);return 2!==ze?ze:this.ved.Kqa(jc,Gc,Uc,od,Od,null,12)};this.hGk=(jc,Gc,Uc,od,Od)=>{var ze;const de={};de[this.ved.fKa]=6168;de[this.ved.eKa]=6169;let ee=12;if(!Gc.view.ue)return 2;var je=Gc.view.mb,ue=je?je.qg:null;if(!ue)return this.Ic.Yb(le.a.ef,{["Reason"]:ae.a.noSelection}),8;if(this.ah.ZDa(Id.ImageReader.a4a,
ue))return this.Ic.Yb(le.a.ef,{["Reason"]:ae.a.IJc}),8;if(this.ah.xAa(ke.ParagraphReader.OU,ue))return this.Ic.Yb(le.a.ef,{["Reason"]:ae.a.AO}),8;if(this.Yf.vcc(ue,!1))return this.Ic.Yb(le.a.ef,{["Reason"]:ae.a.cF}),8;ue=this.qc.Cr();if(Od&&ue){const Qf=ue.oj(Od);if(Qf){(null===(ze=v.AFrameworkApplication.K)||void 0===ze?0:ze.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&Zu.a.instance.h7a("Style");ze=this.qc.Lwa(Qf,ue);let Jg=this.qc.LG(Qf);ze&&(je=je.ib.J(0),je.Yw&&
je.Pa.contextId===yc.a.Fd||2===je.length&&je.Pa.contextId===yc.a.Fd&&je.Tc.contextId===yc.a.Vc)&&(Jg=1,Od=ze.getValue(gi.a.la));1===Jg?ee=0:3===Jg&&(ee=14);!this.qc.le(Qf,ue)&&this.qc.Hd(Qf)&&(je=this.qc.Ag(Qf),Qc.b(562317522,3017,50,String.format("{0}: style applied by user",je)));this.Rra(this.cHl,this.dHl)}}return this.ved.Kqa(jc,Gc,Uc,od,Od,de,ee)};this.$u=h;this.De=r;this.RN=B;this.gA=P;this.Ok=ca;this.Ad=ra;this.YW=Qa;this.Nok=tb;this.we=Mb;this.Lo=Zb}get jo(){return null!=this.zHg?this.zHg:
this.zHg=Ma.a.instance.Oa("Box4.Styles.StyleSettings")}get c6(){return this.$u}get ah(){return this.RN}get Bj(){return this.gA}get qn(){return this.De}get Yf(){return this.Ok}get Ic(){return this.Ad}get Eea(){return this.YW}get ved(){return this.Nok}get qc(){return this.we}Tb(){const b=v.AFrameworkApplication.va,h=Eb.App.lVa.TLh(12);b.ra(Nb.a.NQ,yc.a.Fd,this.gGk);b.ra(Nb.a.fIa,yc.a.Fd,this.XMn);b.ra(Nb.a.NQ,yc.a.Uc,this.eGk);b.ra(Nb.a.fIa,yc.a.Uc,this.VMn);b.ra(Nb.a.NQ,yc.a.paragraph,this.fGk);b.ra(Nb.a.NQ,
yc.a.view,this.hGk);b.Xc(Nb.a.NQ,1036);b.ra(Nb.a.fIa,yc.a.view,this.YMn);b.ra(Nb.a.fIa,yc.a.paragraph,this.WMn);b.Xc(Nb.a.fIa,99);b.ra(Nb.a.INb,yc.a.view,h);b.ra(Nb.a.INb,yc.a.paragraph,this.INb);b.Xc(Nb.a.INb,1127);b.fb(Nb.a.C2e,yc.a.view,this.dOa,4);b.fb(Nb.a.D2e,yc.a.view,this.dOa,4);b.fb(Nb.a.E2e,yc.a.view,this.dOa,4);b.fb(Nb.a.F2e,yc.a.view,this.dOa,4);b.fb(Nb.a.G2e,yc.a.view,this.dOa,4);b.fb(Nb.a.H2e,yc.a.view,this.dOa,4);b.fb(Nb.a.I2e,yc.a.view,this.dOa,4);b.fb(Nb.a.fvh,yc.a.view,this.dOa,
4);b.fb(Nb.a.gvh,yc.a.view,this.dOa,4);b.fb(Nb.a.hvh,yc.a.view,this.dOa,4);this.Hmc=Array(10);this.qc.goo(this.Hmc)}Dfm(b){switch(b){case Nb.a.C2e:return 0;case Nb.a.D2e:return 1;case Nb.a.E2e:return 2;case Nb.a.F2e:return 3;case Nb.a.G2e:return 4;case Nb.a.H2e:return 5;case Nb.a.I2e:return 6;case Nb.a.fvh:return 7;case Nb.a.gvh:return 8;case Nb.a.hvh:return 9;default:return-1}}Rra(b,h){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$(h)&&window.setTimeout(()=>{const r=Ma.a.instance.Ta("Common.ISystemInitiatedFeedback");
r&&r.execute(B=>{B.logActivity(b,h)})},bs.xEa)}avf(b,h){if(b&&h&&ke.ParagraphReader.Xb(h))h=this.qc.JB(h);else return null;return h.oj(b)}get VH(){return null!=this.mAg?this.mAg:this.mAg=Ma.a.instance.resolve("Box4.IFontStylesGalleryCache")}}bs.xEa=5E3;Object(m.a)(bs,"StyleActor",null,[]);var Gs=c(1998);class Xy{constructor(b){this.ga=b}get oc(){return this.ga}Sge(b,h=!1){this.oc.Nf(b,Nb.a.cRa,2,!0,null,h)}N5(b){this.oc.Qb(Nb.a.N5,2,b)}}Object(m.a)(Xy,"TextFormattingCommands",null,[677]);class iq{constructor(b,
h,r,B){this.AWe=this.Vjh=!1;this.tMo=(P,ca,ra)=>{if(2!==ra)return 2;this.Vjh||(this.Vjh=!0);v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordPinchZoomSettings");v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordViewerPinchZoomSettings");return 32};this.YIn=(P,ca,ra,Qa,tb)=>{if(2!==ra)return 2;this.R4i(tb,!0);return 32};this.XIn=(P,ca,ra,Qa,tb)=>{if(2!==ra)return 2;this.R4i(tb,!1);return 32};this.SJn=(P,ca,ra)=>{if(2!==ra)return 2;if(!this.vbb)return 8;
this.vbb.Aum();return 32};this.RIn=(P,ca,ra)=>{if(2!==ra)return 2;if(!this.vbb)return 8;this.vbb.X7n();return 32};this.xqa=(P,ca)=>{3===ca.Rx&&xe.SelectionEditor.Pl(ca.yl.lb)&&(Ke.c(Nb.a.oMo),v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordExtendPageHeightInTouchSettings"),this.AWe=!0)};this.ga=b;this.Ca=h;this.vbb=r;this.hb=B}get sMo(){return this.AWe}Tb(){var b;this.ga.fb(fb.a.cQ,yc.a.view,this.tMo,4);this.ga&&this.Ca&&(this.Ca.$("TouchImageGrippiesResizedIsEnabled")&&(this.ga.fb(Nb.a.tng,
yc.a.view,this.YIn,4),this.ga.fb(Nb.a.vng,yc.a.view,this.XIn,4)),this.ga.fb(fb.a.Jvj,yc.a.application,this.SJn,4),this.ga.fb(fb.a.pif,yc.a.application,this.RIn,4),to.EventHandlerManager.instance.jXn(()=>{this.Evn()}));(null===(b=Eb.App.za.jb.rc)||void 0===b?0:b.ue)&&Eb.App.za.jb.rc.tga(()=>{this.Rbo()});this.hb&&this.hb.Ww(this.xqa)}rPn(){Ke.c(Nb.a.rMo);this.AWe=!0}Rbo(){const b=window.performance.now();iq.lJe&&250>b-iq.lJe&&1E3<b-iq.P4g&&(Ke.c(Nb.a.qMo),iq.P4g=b);this.vbb&&iq.Zb&&iq.Zb.TB(115)&&
this.vbb.showFloatie()}qHm(b,h){if(h){var r=null;Z.a.eK&&b&&(r=b.getSelection());b=null;r&&"Caret"===r.type&&(b=r.getRangeAt(0))&&this.vbb&&this.vbb.KWo(b.getBoundingClientRect(),h)}}Evn(){iq.lJe=window.performance.now()}R4i(b,h){if(b)for(b=b.firstChild;b;){if("SPAN"===b.tagName&&b.classList.contains(iq.Gxm)){for(b=b.firstChild;b;)this.CAk(b,h),b=b.nextSibling;break}b=b.nextSibling}}CAk(b,h){if(b.classList.contains(iq.Aqi)){const r="WACImageResizeHandleTouch"+this.n_l(b);h?b.classList.add(iq.Bqi,
r):b.classList.remove(iq.Bqi,r)}}n_l(b){for(const h of b.className.split(" "))if(h.startsWith("WACImageResizeHandle")&&h!==iq.Aqi)return F.a.substring(h,20,h.length);return""}static get Zb(){return null!=iq.gzg?iq.gzg:iq.gzg=Ma.a.instance.Oa("Box4.IFeatureHelper")}}iq.Aqi="WACImageResizeHandles";iq.Bqi="WACImageResizeHandlesTouch";iq.Gxm="WACImgSelection";iq.lJe=0;iq.P4g=0;Object(m.a)(iq,"TouchInputActor",null,[674]);class pw{get fKa(){return $r.a.fKa}get eKa(){return $r.a.eKa}get ppc(){return $r.a.ppc}Kqa(b,
h,r,B,P,ca,ra){return $r.a.Kqa(b,h,r,B,P,ca,ra)}bic(b,h,r,B,P,ca){return $r.a.bic(b,h,r,B,P,ca)}static get instance(){pw._instance||(pw._instance=new pw);return pw._instance}}pw._instance=null;Object(m.a)(pw,"ViewActionHandlerProxy",null,[673]);class KC{constructor(b,h){this.kpiName="VisiMarkersUsage";this.S8="wwaengidc";this.bmb=new Map;this.Tyo=(r,B,P,ca,ra)=>{if(1===P)return 32;if(!ra)return 2;this.bmb.set("Source",ec.a[this.ga.I0]);this.dYe.aZc?this.bmb.set("Action","Removed"):this.bmb.set("Action",
"Applied");va.Health.instance.recordKpiUsage(this.kpiName,1,this.S8,this.bmb);r=document.getElementsByTagName("head")[0];if(!this.dYe.KLo(r))return t.ULS.sendTraceTag(593294045,324,15,"Toggling Formatting markers failed"),8;Eb.App.za.jH({ShowVisiMarkers:"ToggleButtonModel"});return 32};this.nMn=(r,B,P,ca,ra)=>{if(1===P)return 32;ra[qg.a.On]=this.dYe.aZc;return 32};this.ga=b;this.dYe=h}Tb(){this.ga.fb(Nb.a.zje,yc.a.application,this.Tyo,1);this.ga.fb(Nb.a.i6i,yc.a.application,this.nMn,96)}}Object(m.a)(KC,
"VisiMarkersActor",null,[]);var Qz=c(110);class qw{constructor(b,h,r,B,P){this.Qn=b;this.Rjn=h;this.Ej=r;this.Qd=B;this.jg=P}get WSi(){return this.Rjn.value}execute(b,h,r,B){const P=Nh.a.instance.Fp(Nb.a.Mko);Uf.OutlineElementReader.isEmpty(b,!1)?this.rzl(b):this.szl(b,h,r,B);P.end()}rzl(b){this.WSi.H6e(b,-1)?this.WSi.oTa(b,-1,0):this.Qn.oIa(b,{waj:!0})}szl(b,h,r,B){h=B(b,h,r);b=ke.ParagraphReader.al(b.currentNode);!this.Qn.qRb&&this.HWm(b)&&this.hwk(h);this.Qn.r6();(null===b||void 0===b?0:b.qa)&&
!b.qa.last.formatting&&this.jg.J1a(b)}HWm(b){return b.Pi&&!b.Xy.hasProperty(Mc.a.listID)}hwk(b){ig.OutlineElementNavigator.Ee(b);b=b.currentNode;const h=new Qz.a;b.Mc.Uu(h);this.Ej.DV(b,h,this.Qd.xg)}}Object(m.a)(qw,"ListNewLineStrategy",null,[]);var Xt=c(1226);class Gv{constructor(b,h,r,B,P,ca){this.bcn=b;this.Eqa=h;this.N8a=r;this.Zr=B;this.v1=P;this.e_f=ca;this.$Ai=!1;this.P2c=(ra,Qa,tb)=>{if(1===tb)return 32;ra=this.pageContentNode.ja(Pd.a.jV,Wi.a.white);(new Xt.a(Gv.gJc,Nb.a.mlc)).Rlc(ra);return 32};
this.sic=(ra,Qa,tb,Mb,Zb)=>{if(1===tb)return 32;ra=this.pageContentNode.ja(Pd.a.jV,Wi.a.white);ra=Wi.a.eF(ra);this.dGa(this.e_f);this.e_f.WPb=ra;this.v1.Hoe(ra);ra=this.e_f.fPc(this.pageContentNode,Eb.App.xCb);if(!ra)return 8;Zb.MenuItems=ra;t.ULS.sendTraceTag(509109712,340,50,"Page color dropdown menu is opened.");return 32};this.y2e=(ra,Qa,tb,Mb,Zb)=>{if(1===tb)return 32;Qa=this.Zr.Pc(15);Qa.Db(this.pageContentNode);switch(ra){case Nb.a.wGd:this.pageContentNode.removeProperty(Pd.a.jV);break;case Nb.a.uUa:Zb=
this.N8a.nva(this.pageContentNode,Zb);this.pageContentNode.setValue(Pd.a.jV,Zb);break;case Nb.a.mlc:ra=this.N8a.nva(this.pageContentNode,Zb),this.pageContentNode.setValue(Pd.a.jV,ra),this.v1.w_a(Zb)}Qa.dispose();return 32}}dGa(b){this.$Ai||(b.nX(2,Nb.a.wGd),b.nX(3,Nb.a.uUa),b.nX(4,Nb.a.uUa),b.nX(5,Nb.a.mlc),b.nX(6,Nb.a.P2c),b.SAb(this.bcn,1),this.$Ai=!0)}Tb(){const b=v.AFrameworkApplication.va;b.ra(Nb.a.P2c,yc.a.view,this.P2c);b.ra(Nb.a.sic,yc.a.view,this.sic);b.ra(Nb.a.uUa,yc.a.view,this.y2e);b.ra(Nb.a.wGd,
yc.a.view,this.y2e);b.ra(Nb.a.mlc,yc.a.view,this.y2e);b.Xc(Nb.a.sic,1127)}get pageContentNode(){return this.Eqa.value}}Gv.gJc="Page";Object(m.a)(Gv,"PageColorActor",null,[]);var Hs=c(474),Hx=c(544),$u=c(1230);class uu{wc(b){b.ia("Box4.Actors.Box4PasteStewardFactory",()=>new My(Tt.a.MGb,b.resolve("Box4.List.IListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.Actors.IBox4PasteStewardBridge"))).as("Box4.Actors.IBox4PasteStewardFactory").ha();b.ia("Box4.Actors.Box4PasteStewardUtils",()=>
new DA(v.AFrameworkApplication.K.$("WacPasteBrAsNewParagraphIsEnabled"))).as("Box4.Actors.IBox4PasteStewardUtils").ha();b.ia("Box4.Actors.ClipboardActor",()=>new Kz.ClipboardActor(b.Ve("Box4.Actors.IClipboardOperationFactory"),b.resolve("Box4.Actors.ISystemClipboard"),Nh.a.instance,b.resolve("Box4.IClipboardDataHelper"),Bh.a.instance,v.AFrameworkApplication.va,b.resolve("Box4.IUndoManager"),v.AFrameworkApplication.K,pc.FocusManager.instance(),b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),
b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.IEditingDomManager"),b.resolve("Box4.IEditViewStateManager"),v.AFrameworkApplication.Tgg(),v.AFrameworkApplication.Lrj(),b.resolve("Box4.Actors.PasteFloatiePositionProvider"),Ma.a.instance.resolve("Common.IReactContextualUILauncher"),!!Eb.App.instance&&Eb.App.instance.Aia)).ha();b.ia("Common.App.ChromeExtensionHelper.IChromeExtensionHelper",()=>new Iy(v.AFrameworkApplication.K)).ha();b.ia("Box4.Clipboard.ISystemClipboardAccessManagerFactory",
()=>new Sy(v.AFrameworkApplication.K,b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),b.resolve("Box4.IClipboardDataHelper"),pu.a.instance)).ha();b.ia("Box4.Clipboard.ISystemClipboardAccessManager",()=>b.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory").create()).ha();b.ia("Box4.Actors.ISystemClipboard",()=>new Ry(b.resolve("Box4.Clipboard.ISystemClipboardAccessManager"),hb.InteractiveViewManager.instance,Eb.App.za.jb,pc.FocusManager.instance(),b.resolve("Box4.IEditingDomManager"),
b.resolve("Box4.IEditViewStateManager"),pu.a.instance,v.AFrameworkApplication.K)).ha();b.ia("Box4.Actors.IDeleteTableSegmentStrategy",()=>new Ty).ha();b.ia("Box4.ISelectionFactory",()=>new Ut.a).ha();b.ia("Box4.IRenderOrderGraphIteratorFactory",()=>new ln).ha();b.ia("Common.IDomElementContentStateFactory",()=>new cw).ha();b.ia("Box4.Actors.IClipboardOperationPasteOvertypeStrategy",()=>new Ts(Bh.a.instance,b.resolve("Box4.IParagraphReader"),b.resolve("Box4.Styles.IWACStyleReader"))).ha();b.ia("Box4.Actors.PastedContentsPostProcessorHelper",
()=>new Wu).ha();b.ia("Box4.Actors.PasteFloatiePositionProvider",()=>new nw(Bh.a.instance,b.resolve("Box4.ITextMetricsAdapter"),hb.InteractiveViewManager.instance,Qd.a.getElementBounds,b.resolve("Box4.UI.PasteFloatieManager"),!!Eb.App.instance&&Eb.App.instance.Aia)).ha();b.ia("Box4.Actors.PasteFloatieFeatureSetBuilder",()=>new Vx(b.resolve("Box4.IClipboardDataHelper"),Eb.App.Hv.fJ)).ha();b.ia("Box4.Actors.PasteFloatieEventManager",()=>new Mg(b.resolve("Box4.UI.PasteFloatieManager"),b.resolve("Box4.IPasteFloatieEventSource"),
hb.InteractiveViewManager.instance,Jy.a.instance(),v.AFrameworkApplication.ua,b.resolve("Box4.Actors.PasteFloatiePositionProvider"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),Eb.App.si.Il.Ue(12),b.resolve("Box4.Graph.IGraphTransactionManager"),b.resolve("Common.IReactContextualUILauncher"),b.resolve("Box4.SelectionManager"),!!Eb.App.instance&&Eb.App.instance.Aia)).ha();b.ia("Box4.Actors.IClipboardOperationPasteFactory",()=>new Uq(Nh.a.instance,b.resolve("Box4.Actors.InternalClipboard"),
b.resolve("Box4.Actors.PasteCoordinator"),Qx.a.instance,Bh.a.instance,v.AFrameworkApplication.va,b.resolve("Box4.Actors.IClipboardOperationPasteStrategyFactory"),b.Ve("Box4.IUndoManager"),b.resolve("Common.IDomElementContentStateFactory"),b.resolve("Box4.Actors.IClipboardOperationPasteOvertypeStrategy"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).ha();b.ia("Box4.Actors.IClipboardOperationCutCopyFactory",()=>new Lx(v.AFrameworkApplication.va,Nh.a.instance,b.resolve("Box4.Actors.InternalClipboard"),
b.resolve("Box4.IOutlineElementEditor"),Bh.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),b.resolve("Box4.IParagraphReader"),hr.a.instance,b.resolve("Box4.IOutlineElementNavigator"),b.resolve("Box4.Graph.IGraphIteratorFactory"),b.resolve("Box4.IOutlineElementReader"),b.resolve("Box4.IRenderOrderGraphIteratorFactory"),b.resolve("Box4.ISelectionFactory"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.IClipboardDataHelper"),b.Oa("Box4.IFeatureHelper"))).ha();b.ia("Box4.Actors.IClipboardOperationClipboardAccessHelper",
()=>new Oy(Nh.a.instance,pu.a.instance,b.resolve("Box4.Actors.ISystemClipboard"),b.resolve("Common.ISimpleOperationFactory"),v.AFrameworkApplication.K.appSettings.ChromeClipboardAccessOperationTimeout)).ha();b.ia("Box4.Actors.IClipboardOperationPasteStrategyFactory",()=>new Us(v.AFrameworkApplication.K)).ha();b.ia("Box4.Actors.IClipboardOperationFactory",()=>new Xj(b.resolve("Box4.Actors.InternalClipboard"),v.AFrameworkApplication.va,v.AFrameworkApplication.Pgg(),Nh.a.instance,hr.a.instance,pu.a.instance,
b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.Actors.IClipboardOperationPasteFactory"),b.resolve("Box4.Actors.IClipboardOperationCutCopyFactory"),b.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),b.resolve("Box4.Actors.ClipboardOperationWordStrategy"),b.resolve("Box4.ICannotCutDialog"),b.resolve("Common.ISimpleOperationFactory"),b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IUndoManager"),
b.resolve("Box4.IPasteFloatieEventSource"),b.resolve("Common.Utils.Telemetry.ITelemetry"))).ha();b.ia("Box4.Actors.IExternalPasteExecutionManagerFactory",()=>new Ux(b.Ve("Box4.Actors.IBox4PasteStewardFactory"),b.Ve("Box4.Actors.IBox4ImageStewardFactory"),b.Ve("Box4.Actors.IBox4TableStewardFactory"),b.Ve("Box4.Actors.IBox4WordConverterFactory"),b.Ve("HtmlImport.IHtmlTranslatorSettings"),b.Oa("Box4.IContentControlCopyPasteHelper"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.IExternalPasteCssConverter"),
b.resolve("HtmlImport.IHtmlNormalizerSettings"),b.resolve("Box4.IFormattingPropertyTransitStrategy"),b.resolve("Box4.Actors.IHtmlNormalizerHelper"),b.resolve("Box4.IFieldCopyPasteHelper"))).ha();b.ia("Box4.Actors.InternalClipboard",()=>new bt.a(b.resolve("Box4.Images.IImageEditor"),b.Ve("Box4.ITableEditor"),b.resolve("Box4.IOutlineEditor"),b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.List.IListEditor"),Eb.App.si,b.resolve("Box4.IParagraphIndentationReader"),v.AFrameworkApplication.K,b.resolve("Box4.Graph.IGraphNodeFactory"),
b.resolve("Box4.Graph.IGraphTransactionFactory"),b.Oa("Box4.IContentControlCopyPasteHelper"),b.resolve("Box4.ITableCellReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IConstantsProvider").Wjj,b.resolve("Box4.IFormattingPropertyTransitStrategy"))).ha();b.ia("Box4.Actors.IInternalPasteExecutionManagerFactory",()=>new zo(b.resolve("Box4.Actors.InternalClipboard"),b.Oa("Box4.IContentControlCopyPasteHelper"),new pf.a(()=>Eb.App.za.jb.rc),b.resolve("Box4.IFormattingPropertyTransitStrategy"),
b.resolve("Box4.IFieldCopyPasteHelper"))).ha();b.ia("Box4.List.IListCommands",()=>new Ww(v.AFrameworkApplication.va)).ha();b.ia("Box4.List.ListNewLineStrategy",()=>new qw(b.resolve("Box4.List.IListEditor"),b.Ve("Box4.IOutlineElementIndentationEditor"),b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.ICharacterPropertiesEditor"))).ha();b.ia("Box4.Actors.PasteCoordinator",()=>new os(b.resolve("Box4.Actors.InternalClipboard"),
b.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),b.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory"),Wh.a.instance)).ha();b.ia("Box4.Actors.Box4ImageStewardFactory",()=>new Dz(b.resolve("Box4.Images.IImageEditor"),v.AFrameworkApplication.lc,b.resolve("Box4.IUndoManager"),b.Oa("Box4.Actors.IImageStewardBridge"),Eb.App.za.notificationBar,b.Oa("Box4.IFeatureHelper"),b.resolve("Common.IAppSettingsManager").$("LogActionForFailedLocalImagePasteIsEnabled"))).as("Box4.Actors.IBox4ImageStewardFactory").ha();
b.ia("Box4.Actors.Box4TableStewardFactory",()=>new vp(Ma.a.instance.resolve("Box4.List.IListEditor"),Ma.a.instance.resolve("Box4.ITableEditor"),b.resolve("Common.IAppSettingsManager").$("PasteComplexTablesIsEnabled"),b.resolve("Common.IAppSettingsManager").$("PasteTableCellMarginImprovementsIsEnabled"))).as("Box4.Actors.IBox4TableStewardFactory").ha();b.ia("Box4.Actors.ClipboardOperationWordStrategy",()=>new Sq(Nh.a.instance,Bh.a.instance,Eb.App.zd,Wh.a.instance)).ha();b.ia("Box4.Actors.Box4WordConverterFactory",
()=>new su(v.AFrameworkApplication.K)).as("Box4.Actors.IBox4WordConverterFactory").ha();b.ia("Box4.Actors.IExternalPasteCssConverter",()=>new gw(v.AFrameworkApplication.K)).ha();b.ia("Box4.Actors.IHtmlNormalizerHelper",()=>new MB).ha();b.ia("Box4.ISelectionCommands",()=>new hq(v.AFrameworkApplication.va)).ha();b.ia("Box4.ITextFormattingCommands",()=>new Xy(v.AFrameworkApplication.va)).ha();b.ia("Box4.Actors.AccessibilityActor",()=>new ph(b.Ta("Box4.Accessibility.IAccessibilityContextManager"),b.resolve("Box4.Proofing.IErrorRangeEditor"))).ha();
b.ia("Box4.Actors.InsertionPointFormatting",()=>new IC(b.Oa("Box4.IFontSlotProvider"),b.Ta("Box4.Actors.IFontNameFormattingStrategy"))).as("Box4.IInsertionPointFormatting").ha();b.ia("Box4.UI.PasteFloatieManager",()=>new Uu).as("Box4.UI.IFloatieManager").ha();b.ia("Box4.Actors.ProofingActor",()=>new NA(Ma.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),v.AFrameworkApplication.va,()=>Ma.a.instance.resolve("Box4.UI.ILanguageDialog"),Ma.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ma.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),
Bh.a.instance,Ma.a.instance.Ta("Box4.IExternalSelectionManager"),hr.a.instance,Ma.a.instance.resolve("Box4.ISelectionContextMenuProvider"),Wh.a.instance,Nh.a.instance,Ma.a.instance.resolve("Box4.IContextMenuController"),Ma.a.instance.resolve("Box4.Proofing.IProofingFeatureConfiguration"),Ma.a.instance.Ta("Box4.Actors.IProofingErrorPresenter"),Ma.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),Ma.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).ha();b.ia("Box4.Actors.StyleActor",
()=>new bs(Ma.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ma.a.instance.resolve("Box4.Styles.IWACStyleEditor"),Ma.a.instance.resolve("Box4.IFormattingEditor"),An.ContextSetEditor.instance,Ma.a.instance.resolve("Box4.IInsertionPointFormatting"),Wh.a.instance,Nh.a.instance,Ma.a.instance.resolve("Box4.TextFormattingHelper"),pw.instance,Ma.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ma.a.instance.resolve("Box4.IContentControlChpHelper"))).ha();b.ia("Box4.Actors.StyleContextMenuActor",
()=>new Hz(Ma.a.instance.resolve("Box4.IUpdateStyleManager"),Ma.a.instance.resolve("Box4.Styles.IWACStyleReader"),v.AFrameworkApplication.va)).ha();b.ia("Box4.Actors.TextFormattingActor",()=>new Gs.a(b.resolve("Box4.Actors.IFormattingViewOperationFinishedStageProcessor"),b.resolve("Box4.IBox4GraphWriter"),b.Oa("Box4.IFontSlotProvider"),b.Oa("Box4.IContentControlChpHelper"),Ma.a.instance.resolve("Box4.IFormattingEditor"),Ma.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ma.a.instance.resolve("Box4.IParagraphEditor"),
Ma.a.instance.resolve("Box4.ILineSpacingHelper"),Ma.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ma.a.instance.resolve("Box4.Styles.IWACStyleEditor"),Ma.a.instance.resolve("Box4.IOutlineElementEditor"),Ma.a.instance.resolve("Box4.List.IListFormattingEditor"),Ma.a.instance.resolve("Box4.IParagraphIndentationReader"))).ha();b.ia("Box4.Actors.AutoCorrectActor",()=>new IA(v.AFrameworkApplication.va,Nh.a.instance,()=>Ma.a.instance.resolve("Box4.UI.IAutoCorrectOptionsDialog"))).ha();b.ia("Box4.Actors.TouchInputActor",
()=>new iq(v.AFrameworkApplication.va,v.AFrameworkApplication.K,Ny.GrippersManager.instance,Bh.a.instance)).as("Box4.ITouchInputActor").ha();b.register(vt,"Box4.VisiMarkersOperation").as("Box4.IVisiMarkersOperation").ha();b.ia("Box4.Actors.VisiMarkersActor",()=>new KC(v.AFrameworkApplication.va,b.resolve("Box4.IVisiMarkersOperation"))).ha();b.ia("Box4.Actors.IndentationActorExtension",()=>new Fp).as("Box4.Actors.IIndentationActorExtension").ha();Object(Hx.a)()&&b.ia("Box4.Actors.PageColorActor",()=>
new Gv(Hs.a.instance,new pf.a(()=>Eb.App.za.jb.rc.ed),qi.a.instance,Il.a.instance,Ma.a.instance.Oa("Box4.UI.RecentColorsSectionHandler"),new $u.a(Gv.gJc))).ha()}}Object(m.a)(uu,"Box4ActorsComponentConfiguration",null,[2]);var Ix=c(223),EB=c(1108);const Ii=()=>{const b=ym;v.AFrameworkApplication.va.ra(Nb.a.Vgf,yc.a.Ehb,b);v.AFrameworkApplication.va.ra(Nb.a.Vgf,yc.a.I8b,b);v.AFrameworkApplication.va.ra(Nb.a.Ugf,yc.a.Ehb,Zf);v.AFrameworkApplication.va.ra(Nb.a.Ugf,yc.a.I8b,Zf)},ym=(b,h,r)=>Eb.App.tLd?
8:2===r?(b=new Tf.StandardDialog,b.Cd=4,b.BV(1),b.ze(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),b.ze(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),b.Hhg(Box4Intl.Box4Strings.l_DownloadEmbeddedFileTitle,Box4Intl.Box4Strings.l_DownloadEmbeddedFileMessage,ys),32):2,ys=b=>{1===b&&v.AFrameworkApplication.va.processAction(Nb.a.Ugf,2)},Zf=(b,h,r)=>{if(Eb.App.tLd)return 8;if(1===r)return h.node.hasProperty(Pd.a.embeddedFileContainer)?32:2;if(2===r&&(h.contextId===yc.a.view&&h.view.mb&&
(h=h.view.mb.qg),Ix.isEmbeddedFileOrFloatingEmbeddedFileContext(h))){b=EB.a.cYl(h.node);Hc.a.xpo();try{Yt(b)}catch(B){t.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",B)}}return 32},Yt=b=>{Qd.a.wm(b,void 0,void 0,"EmbeddedFileActor.SaveFile")};var Rz=c(788);class dt{constructor(b){this.OBa=this.eW=null;this.gja=(h,r,B,P,ca)=>{if(1===B)return 32;v.AFrameworkApplication.va.Qb(Nb.a.R6a,2,ca);h=ca&&0<=ca.fontColor&&16777215>=ca.fontColor?ca.fontColor:0;Eb.App.za.dismissFloatie();
(new Xt.a(dt.gJc,Nb.a.sra)).Rlc(h);return 32};this.HNb=(h,r,B,P,ca)=>{if(1===B)return 32;if(2===B&&!ca)return 8;h=dt.Hi.rTd(r);r=new Rz.a;B=null;32===v.AFrameworkApplication.va.Qb(Nb.a.R6a,2,r)&&r&&(B=r.fontColor);P="";B&&!r.L8b&&(P=Wi.a.eF(B)||"");this.d2h.WPb=P;this.YXc&&this.v1.Hoe(P);h=this.d2h.fPc(h,Eb.App.xCb);if(!h)return 8;ca.MenuItems=h;t.ULS.sendTraceTag(595153826,340,50,"Font color dropdown menu is opened.");return 32};this.NKe=b}get d2h(){this.eW||(this.eW=new $u.a(dt.gJc),this.dGa(this.eW));
return this.eW}dGa(b){b.nX(1,Nb.a.Jga);b.nX(3,Nb.a.Yv);b.nX(4,Nb.a.Yv);b.nX(5,Nb.a.sra);b.nX(6,Nb.a.gja);b.SAb(this.NKe,1)}Tb(){const b=v.AFrameworkApplication.va;b.ra(Nb.a.gja,yc.a.view,this.gja);b.ra(Nb.a.HNb,yc.a.view,this.HNb);b.Xc(Nb.a.HNb,1127)}static cZl(){return new dt(Hs.a.instance)}static get instance(){return null!=dt.iCg?dt.iCg:dt.iCg=dt.cZl()}get v1(){return null!=this.tGg?this.tGg:this.tGg=Ma.a.instance.Oa("Box4.UI.RecentColorsSectionHandler")}static get Hi(){return si.PageReader.instance}get YXc(){null==
this.OBa&&(v.AFrameworkApplication.oe("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.OBa=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",!1):!1);return this.OBa}}dt.gJc="Font";Object(m.a)(dt,"FontColorActor",null,[]);class rw{constructor(b){this.gja=(h,r,B,P,ca)=>{if(1===B)return 32;v.AFrameworkApplication.va.Qb(Nb.a.R6a,2,ca);h=ca&&0<=ca.highlight&&16777215>=ca.highlight?ca.highlight:0;Eb.App.za.dismissFloatie();
(new Xt.a("Highlighter",Nb.a.H$)).Rlc(h);return 32};this.ga=b}Tb(){this.ga.ra(Nb.a.$Zi,yc.a.view,this.gja)}static W_l(){return new rw(v.AFrameworkApplication.va)}static get instance(){return null!=rw.UCg?rw.UCg:rw.UCg=rw.W_l()}}Object(m.a)(rw,"HighlighterColorActor",null,[]);var Wq=c(375),sq=c(88);class Xw{static get Vg(){return Pe.a.Kx(Xw.Xm,Box4Intl.Box4Strings.l_InsertLinkDisplayText,Box4Intl.Box4Strings.l_InsertLinkAddress)}}Xw.Xm="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(m.a)(Xw,"InsertLinkDialogHtml",null,[]);class gp extends Pe.a{constructor(b){super();this.R7d=()=>{const h=document.getElementById("txtLink");this.ora(1,!h||!h.value.length||Tg.a.RRa(h.value))};this.nCf=(h,r)=>{if(this.qh.mv){var B=this.qh.mb.ib.lb;if(B)if(B.equals(this.Dx)&&0!==h){h=new cg.GraphTransaction(15);h.Db(this.wT[0].node);for(B=0;B<this.wT.length;B++)this.wT[B].node.zJ().sF.g8(4);B=r.txtLink.trim();r=this.ikl();B=this.QDm(B);(r||B)&&gp.Qd.Zs(7);this.hide();h.dispose()}else this.qh.d6()}};
this.wT=b;this.qh=hb.InteractiveViewManager.instance.yd;this.Dx=this.qh.mb.ib.lb;this.tlf=b[0].cpBegin;this.ZJf=b[b.length-1].cpEnd;this.yg="InsertMultiParagraphLinkDialog";b=this.dWo();this.showDialog("",b)}showDialog(b,h){t.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows.");this.Vg=Xw.Vg;""===h.trim()&&this.ze(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);this.Uh(Box4Intl.Box4Strings.l_InsertLinkTitle,this.nCf,{["txtLink"]:h,["txtDisplay"]:b});document.getElementById("txtLink").focus();
document.getElementById("txtDisplay").disabled=!0;gp.DFf&&(b=document.getElementById("txtLink"),He.a.addHandler(b,pd.a.input,this.R7d),He.a.addHandler(b,pd.a.nIc,this.R7d))}hide(){if(gp.DFf){const b=document.getElementById("txtLink");b&&(He.a.removeHandler(b,pd.a.nIc,this.R7d),He.a.removeHandler(b,pd.a.input,this.R7d))}super.hide()}Uva(b){return gp.DFf?this.fQl(this.Dtc)?super.Uva(b):!1:super.Uva(b)}dWo(){let b;var h="";const r=this.wT.length,B=Tg.a.Ez(this.wT[0],!1);0<B.length&&({cpBegin:P,cpEnd:b}=
gp.z0.Qha(this.wT[0],B[0]),P<=this.wT[0].cpBegin&&(h=B[0].hyperlink.url),this.tlf=Math.min(this.tlf,P));var P=Tg.a.Ez(this.wT[r-1],!1);0<P.length&&({cpBegin:P,cpEnd:b}=gp.z0.Qha(this.wT[r-1],P[P.length-1]),this.ZJf=Math.max(this.ZJf,b));this.ePo(this.tlf,this.ZJf);return h}ePo(b,h){const r=this.wT.length;if(b!==this.wT[0].cpBegin||h!==this.wT[r-1].cpEnd){b=Ue.a.Rc(this.wT[0].node,b);b=og.SelectionFactory.Zn(b);h=Ue.a.Rc(this.wT[r-1].node,h);h=og.SelectionFactory.Gy(b,h);b=this.gji(h.Pa.clone());const B=
this.gji(h.Tc.clone());b&&B&&(this.wT[0]=b,this.wT[r-1]=B,this.qh.mb.Ac(h),this.Dx=h)}}QDm(b){if(!b)return!1;b=Tg.a.GFa(b);for(let r=0;r<this.wT.length;r++){var h=this.wT[r];if(gp.Gua&&xe.SelectionEditor.vl(h)&&(h=xe.SelectionEditor.Qng(h),!xe.SelectionEditor.vl(h)))continue;h=Ue.a.createTextRange(this.wT[r].node,h.cpBegin,h.cpEnd);this.GOo(h);gp.hp.fF(h,b,!1)}return!0}GOo(b){sq.a.instance.J(1)&&gp.Qd.YBj(b)}gji(b){return ke.ParagraphReader.vm(b)&&!xe.SelectionEditor.v9(b)&&ke.ParagraphReader.textLength(b.node)?
Ue.a.createTextRange(b.node,0,ke.ParagraphReader.textLength(b.node)):xe.SelectionEditor.vl(b)?b:null}ikl(){let b=!1;for(const h of this.wT){const r=Tg.a.Ez(h,!1);r&&(b=gp.z0.taj(h,r)||b)}return b}static get z0(){return null!=gp.pBg?gp.pBg:gp.pBg=Ma.a.instance.resolve("Box4.IHyperlinkStrategy")}static get Qd(){return null!=gp.PIg?gp.PIg:gp.PIg=Ma.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get hp(){return null!=gp.gBg?gp.gBg:gp.gBg=Ma.a.instance.resolve("Box4.IHyperlinkEditor")}static get Gua(){null==
gp.haa&&(gp.haa=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return gp.haa}static get DFf(){null==gp.pGe&&(gp.pGe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("HyperlinkUrlValidationIsEnabled"):!1);return gp.pGe}}gp.haa=null;gp.pGe=null;Object(m.a)(gp,"InsertMultiParagraphLinkDialog",Pe.a,[]);var Yy;(function(b){b.oap="Heading";b.Bookmark="Bookmark";b.Url="Url";b.acp="RecentLinks"})(Yy||(Yy={}));Object(m.b)("InsertLinkUserActivitySource",
Yy);class Pr{constructor(b,h,r,B,P){this.linkurl=b;this.isHeading=h;this.startCp=r;this.endCp=B;this.paragraphNode=P}}Object(m.a)(Pr,"HeadingDataForLinkDialog",null,[]);class Zx{constructor(b,h){this.linkurl=b;this.isHeading=h}}Object(m.a)(Zx,"BookmarkDataForLinkDialog",null,[]);class Yw{constructor(b,h,r,B,P,ca){this.key=b;this.name=h;this.startIndex=r;this.count=B;this.level=P;this.isCollapsed=ca}}Object(m.a)(Yw,"GroupHeaderDataForLinkDialog",null,[]);class Zy{constructor(b,h){this.selectedIndex=
b;this.selectedGroupId=h}}Object(m.a)(Zy,"SelectedItemFromLinkDialogGroupedList",null,[]);class RB{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb){this.kr=b;this.vd=h;this.Mrl=r;this.bookmarkManager=B;this.z0=P;this.hp=ca;this.jg=ra;this.Qd=Qa;this.Ej=tb;this.Ik=Mb;this.xxa=Zb;this.wFb=null;this.qxi=!1;this.nCf=(Uc,od)=>{var Od;if(this.ke.mv){var ze=Tg.a.SRc(this.kr),de=this.ke.mb.ib.lb;if(de){de=de.Pa;ke.ParagraphReader.vm(de)&&(de=Ue.a.createTextRange(de.node,0,ke.ParagraphReader.textLength(de.node)));
var ee=xe.SelectionEditor.ySb(de);xe.SelectionEditor.vl(ee)&&(de=ee);if(0!==Uc&&32===v.AFrameworkApplication.va.Nf(de,Nb.a.insertHyperlink,1,!0,null,null)&&this.kr.equals(de)){kh.a.mark(5562);(null===(Od=Eb.App.zd)||void 0===Od?0:Od.Uo)&&this.ke.mb.e2b();Uc=new cg.GraphTransaction(15);Uc.Db(this.kr.node);this.kr.node.zJ().sF.g8(4);Od=od.txtDisplay;de=!1;if(null!=od.linkurl)if(de=!0,od.isHeading){l(this.vd,"Heading");ee=od.paragraphNode;const je=od.startCp,ue=od.endCp;od=this.bookmarkManager.tPl(ee);
this.bookmarkManager.KFc(od,je,ue,ee,ee,!1)}else l(this.vd,"Bookmark"),od=od.linkurl;else l(this.vd,"Url"),od=od.txtLink.trim();this.insertLink(Od,od,ze,de);Uc.Uj=Nb.a.insertHyperlink;Uc.dispose();kh.a.mark(5563);this.kr.node.Ohb()}else this.ke.d6()}else t.ULS.sendTraceTag(509372371,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}};this.ke=hb.InteractiveViewManager.instance.yd;this.kr=b;r=xe.SelectionEditor.ySb(this.kr);xe.SelectionEditor.vl(r)&&(this.kr=r);const jc=
new Pe.a(!1,!1,!0);r=this.g_l();B={["displayTextLabel"]:Box4Intl.Box4Strings.l_InsertLinkDisplayText,["addressLabel"]:Box4Intl.Box4Strings.l_InsertLinkAddress,["insertInternalLinkEnabled"]:!0,["enterLinkTabLabel"]:Box4Intl.Box4Strings.l_EnterLinkText,["thisDocumentTabLabel"]:Box4Intl.Box4Strings.l_ThisDocumentText,["groupedList"]:r};P=this.wFb="";P=ke.ParagraphReader.text(this.kr.node);ra=this.kr.cpBegin;Qa=this.kr.cpEnd;({Qbg:P,Mjf:ra,Njf:Qa,nAf:ca}=this.IVl(P));if((h="object"===typeof h?h:null)&&
(h.Source&&"CommandingInterface"===h.Source||h.Url&&h.DisplayText))this.insertLink(h.DisplayText,h.Url,ca);else{ca[0]&&this.Ozl(ra,Qa,ca[0].paragraph);h=""===P.trim()?Box4Intl.Box4Strings.l_InsertLinkButtonText:CommonUIStrings.l_DialogOk;jc.ze(1,h);(null===P||void 0===P?0:P.startsWith(F.a.ufb))?(h=this.wdm(P,r))?r.selectedItem=h:B.txtLink=P:B.txtLink=P;B.txtDisplay=this.wFb;1>=ca.length&&this.z0.l5k(b,ca[0],1===ca.length)&&(this.qxi=!0,B.textDisplayDisabled=!0);var Gc={["id"]:"InsertLinkDialog",["bodyControls"]:B};
this.Ik.ie(()=>{jc.Uh(Box4Intl.Box4Strings.l_InsertLinkTitle,this.nCf,Gc)},"RILD:IAS")}}IVl(b){const h=Tg.a.SRc(this.kr);let r=this.kr.cpBegin,B=this.kr.cpEnd,P="";if(!h.length)return this.wFb=b.substring(this.kr.cpBegin,this.kr.cpEnd),{returnValue:!0,Qbg:P,Mjf:r,Njf:B,nAf:h};if(h[0].hyperlink){let ca,ra=0,Qa=Math.max(0,b.length-1),tb=0;for(let Mb=0;Mb<h.length;Mb++)h[Mb].cpBegin>=ra&&({cpBegin:ca,cpEnd:ra}=this.z0.Qha(this.kr,h[Mb]),Qa=Math.min(ca,Qa),tb=Math.max(ra,tb));r=Math.min(Qa,r);B=Math.max(tb,
B);this.wFb=b.substring(r,B);r===Qa&&(P=h[0].hyperlink.url);return{returnValue:!0,Qbg:P,Mjf:r,Njf:B,nAf:h}}return{returnValue:!1,Qbg:P,Mjf:r,Njf:B,nAf:h}}Ozl(b,h,r){if(h!==this.kr.cpEnd||b!==this.kr.cpBegin)b=og.SelectionFactory.lJ(r,b,h),this.ke.mb.Ac(b),this.kr=xe.SelectionEditor.ySb(b.Pa.clone())}VMo(b,h,r,B,P,ca=!1){B?(B=Ue.a.createTextRange(this.kr.node,this.kr.cpBegin,this.kr.cpBegin+b.length),this.hp.Mtl(B,r,h),b=og.SelectionFactory.ne(this.kr.node,this.kr.cpBegin+b.length)):(this.hp.lnb(this.kr,
2),this.Ej.iqb(this.kr,2),r=Ue.a.Rc(this.kr.node,this.kr.cpEnd),this.jg.Ge(r,b,!0),B=Ue.a.createTextRange(this.kr.node,this.kr.cpEnd,this.kr.cpEnd+b.length),this.hp.fF(B,h,P,!1,!0,ca),b=og.SelectionFactory.ne(this.kr.node,this.kr.cpEnd+b.length));b&&this.ke.mb.Ac(b)}insertLink(b,h,r,B=!1){var P=null;b||(b=h,v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveLinkUrlLineBreak",!0)&&(b=b.replace(/[\r\n\v]/g,"")));if(h&&(!r.length||h!==r[0].hyperlink.url)&&!B){h=Tg.a.GFa(h);
var ca="";this.xxa&&({z7f:ca}=this.xxa.Vng(h)).returnValue&&(h=ca)}this.qxi||(b=this.hp.z4n(b));ca=!1;if(h){P=0<r.length;const ra=ke.ParagraphReader.text(this.kr.node).substring(this.kr.cpBegin,this.kr.cpEnd)!==b,Qa=this.Qd.xg;if(Qa&&1===r.length&&!r[0].hyperlink.PG&&!(r[0].cpBegin>this.kr.cpBegin&&r[0].cpEnd<=this.kr.cpEnd)){this.VMo(b,h,r[0].hyperlink,!ra,P,B);return}if(P)for(let tb=0;tb<r.length;tb++)r[tb].hyperlink.PG&&(ca=!0),this.hp.iS(this.kr.node,r[tb].hyperlink,!1);ra?this.jg.Ge(this.kr,
b,!ca):Qa&&!ca&&this.Ej.iqb(this.kr,1);r=Ue.a.createTextRange(this.kr.node,this.kr.cpBegin,this.kr.cpBegin+b.length);this.hp.fF(r,h,P,ca,!0,B);P=og.SelectionFactory.ne(this.kr.node,this.kr.cpBegin+b.length)}else 0<r.length&&(b=r[0],b.hyperlink.PG&&(ca=!0),this.hp.iS(b.paragraph,b.hyperlink));ca&&this.Qd.Zs(ca?2:7);P&&this.ke.mb.Ac(P);Eb.App.tOo()}wdm(b,h){h=h.items;const r=b.substring(F.a.ufb.length),B=this.bookmarkManager.kei(r);b=-1;let P=0;for(let ca=0;ca<h.length;ca++)if(h[ca].isHeading&&0!=B.count&&
h[ca].paragraphNode.id==B.J(0).id){b=ca;break}else if(!h[ca].isHeading&&h[ca].linkurl==r){b=ca;P=1;break}h=new Zy(b,P);return-1!=b?h:null}g_l(){const b={};let h=[],r=0,B=0;var P=this.Mrl.I_l();P&&(r=P.count,h=h.concat(this.N_l(P)));if(P=this.bookmarkManager.jQd(!1))B=P.count,h=h.concat(this.xPl(P));b.groups=this.B_l(r,B);b.items=h;return b}B_l(b,h){const r=[],B=new Yw("ThisDocumentTabHeadings",Box4Intl.Box4Strings.l_InsertLinkHeadings,0,b,0,!0);r.push(B);b=new Yw("ThisDocumentTabBookmarks",Box4Intl.Box4Strings.l_InsertLinkBookmarks,
b,h,0,!0);r.push(b);return r}N_l(b){const h=[],r=/\uFFFC/;for(const B of b)b=B.characterData.replace(r," "),b=new Pr(b,!0,B.Ec,B.end,B.paragraphNode),h.push(b);return h}xPl(b){const h=[];for(const r of b)b=r.wf(Mc.a.At).toString(),b=new Zx(b,!1),h.push(b);return h}}Object(m.a)(RB,"ReactInsertLinkDialog",null,[]);class ff{static get Yf(){return Wh.a.instance}static get DX(){return null!=ff.sxg?ff.sxg:ff.sxg=Ma.a.instance.Oa("Box4.IContentControlChpHelper")}static get z0(){return null!=ff.qBg?ff.qBg:
ff.qBg=Ma.a.instance.resolve("Box4.IHyperlinkStrategy")}static ix(){return ff.en||(ff.en=Ma.a.instance.Ta("Box4.IExternalSelectionManager"))}static get Qd(){return null!=ff.aJg?ff.aJg:ff.aJg=Ma.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static get Gh(){return null!=ff.hJg?ff.hJg:ff.hJg=Ma.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance}static get ah(){return An.ContextSetEditor.instance}static get Ic(){return Nh.a.instance}static get Z0c(){null==
ff.Hsb&&(ff.Hsb=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return ff.Hsb}static get Gua(){null==ff.haa&&(ff.haa=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return ff.haa}static get hp(){return null!=ff.mBg?ff.mBg:ff.mBg=Ma.a.instance.resolve("Box4.IHyperlinkEditor")}static get jg(){return null!=ff.exg?ff.exg:ff.exg=Ma.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get L4a(){ff.PGe||
(ff.PGe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("IsO365CommercialHost")||v.AFrameworkApplication.K.$("IsO365ConsumerHost"):!1);return ff.PGe}static get uKo(){ff.xjh||(ff.xjh=v.AFrameworkApplication.K?v.AFrameworkApplication.K.mc("WordRecentLinksTimeInMsBetweenTwoMruCalls",6E4):6E4);return ff.xjh}static Tb(){const b=v.AFrameworkApplication.va;b.ra(Nb.a.insertHyperlink,yc.a.view,ff.fIb);b.ra(Nb.a.insertHyperlink,yc.a.Uc,ff.insertLink);b.ra(Nb.a.insertHyperlink,yc.a.Fd,ff.insertLink);b.Xc(Nb.a.insertHyperlink,
1028);b.ra(Nb.a.w7b,yc.a.view,ff.fIb);b.ra(Nb.a.w7b,yc.a.Uc,ff.insertLink);b.ra(Nb.a.w7b,yc.a.Fd,ff.insertLink);b.Xc(Nb.a.w7b,1028);b.ra(Nb.a.iS,yc.a.view,ff.fIb);b.ra(Nb.a.iS,yc.a.Uc,ff.Daj);b.ra(Nb.a.iS,yc.a.Fd,ff.Daj);b.Xc(Nb.a.iS,1028);b.ra(Nb.a.Nfe,yc.a.view,ff.fIb);b.ra(Nb.a.Nfe,yc.a.Uc,ff.Gij);b.ra(Nb.a.Nfe,yc.a.Fd,ff.Gij);b.ra(Nb.a.n6a,yc.a.view,ff.fIb);b.ra(Nb.a.n6a,yc.a.Uc,ff.c_i);b.ra(Nb.a.n6a,yc.a.Fd,ff.c_i);b.ra(Nb.a.n6a,yc.a.image,ff.CZf);b.ra(Nb.a.n6a,yc.a.hFb,ff.CZf);b.ra(Nb.a.n6a,
yc.a.X7,ff.CZf);b.ra(Nb.a.QIc,yc.a.application,ff.QIc);b.ra(Nb.a.NId,yc.a.view,ff.fIb);ff.L4a&&(b.fb(fb.a.Y6a,yc.a.view,this.fIb.bind(this),1028),b.ra(fb.a.Y6a,yc.a.Uc,this.Y6a.bind(this)),b.ra(fb.a.Y6a,yc.a.Fd,this.Y6a.bind(this)),b.Xc(fb.a.Y6a,1028),b.ra(fb.a.oCf,yc.a.Uc,this.Y6a.bind(this)),b.ra(fb.a.oCf,yc.a.Fd,this.Y6a.bind(this)),b.Xc(fb.a.oCf,1028),b.ra(fb.a.N1f,yc.a.view,this.N1f.bind(this)),b.ra(fb.a.H1f,yc.a.view,this.H1f.bind(this)),b.fb(fb.a.Gkb,yc.a.Uc,this.Gkb.bind(this),1028),b.fb(fb.a.Gkb,
yc.a.Fd,this.Gkb.bind(this),1028))}static QIc(){return 32}static Y6a(b,h,r){if(!ff.L4a)return 2;b=ff.KJj(h);if(32!=b)return b;if(!ff.QRa(h,!0).returnValue||ff.s5b(h))return 8;1!==r||ff.e1h||(ff.Doe(!0),ff.e1h=!0);return 32}static N1f(b,h,r,B,P){if(!ff.L4a)return 2;if(1===r)return 32;ff.Zce(ff.yfk,ff.zfk,ff.Lch);Wq.a.instance.ie(()=>{ff.Doe();P.MenuItems=Object.assign(new $f.a,{Id:"RecentLinksList",MenuSectionList:[],UpdateDynamically:!0});const ca=this.INh();ca?(t.ULS.sendTraceTag(526242130,324,50,
"Recent Links data load success in ribbon"),P.MenuItems.MenuSectionList.push(ca)):ff.S2i(P,ff.Lch)},"HA:PRLF");return 32}static H1f(b,h,r,B,P){if(!ff.L4a)return 2;if(1===r)return 32;ff.Zce(ff.wfk,ff.xfk,ff.Kch);Wq.a.instance.ie(()=>{ff.Doe();P.MenuItems=Object.assign(new $f.a,{Id:"InsertLinkFlyoutList",MenuSectionList:[],UpdateDynamically:!0});P.MenuItems.MenuSectionList.push(this.wbl());const ca=this.INh(!0);ca?(t.ULS.sendTraceTag(526242132,324,50,"Recent Links data load success in context menu"),
P.MenuItems.MenuSectionList.push(ca)):ff.S2i(P,ff.Kch)},"HA:PILF");return 32}static S2i(b,h){t.ULS.sendTraceTag(524911777,324,50,"Recent Links could not load in "+h);ff.Zce(ff.ack,ff.bck,h);b.MenuItems.MenuSectionList.push(this.Wdl());ff.Doe(!0)}static Wdl(){const b=this.Xbf("RecentLinksNoDataSection",!1);b.ControlList.push(Object.assign(new ah.a,{ExternalId:"RecentLinksNoDataSection",LabelText:Box4Intl.Box4Strings.l_RecentLinksErrorString}));return b}static wbl(){const b=this.Xbf("InsertLinkSection");
b.ControlList.push(Object.assign(new ah.a,{ExternalId:"InsertLink"}));return b}static INh(b=!1){if(il.instance.dvd){var h=this.Xbf("RecentLinksSection",b);b=JSON.parse(il.instance.dvd);this.cvd.clear();b.forEach((r,B)=>{this.cvd.set(B,[r.FileName,r.DocumentUrl]);const P=ff.mbm(r.FileName);var ca=ff.CZl(r.TimeStamp),ra=h.ControlList,Qa=ra.push,tb=Object,Mb=tb.assign,Zb=new ah.a,jc=fb.a.Gkb,Gc=fb.a.Gkb;ca=P!==r.FileName?r.FileName+"\n"+ca:ca;var Uc=r.FileName;let od="SaveAsWordDocx_32";switch(r.App){case "Word":od=
"SaveAsWordDocx_32";break;case "PowerPoint":od="SaveAsPowerPointPptx_32";break;case "Excel":od="SaveAsExcelXlsx_32"}Qa.call(ra,Mb.call(tb,Zb,{ExternalId:B,Command:jc,CommandValueId:Gc,LabelText:P,Alt:ca,AriaDescription:Uc,ExternalImageId:od,KeyTip:r.FileName}))});return h}}static Xbf(b,h=!1){return Object.assign(new di.a,{Title:h?Box4Intl.Box4Strings.l_RecentLinks:"",Id:b,DisplayMode:"Menu",ShowMenuSectionSeparator:!1,ControlsId:"Ctrl_"+b,ControlList:[]})}static Gkb(b,h,r,B,P){if(!ff.L4a)return 2;
if(!P||P.CommandValueId!=fb.a.Gkb)return 32;ff.Zce(ff.n7j,ff.o7j,ff.Mgk);r=h;h=new cg.GraphTransaction(15);h.Uj=b;h.Db(r.node);B=ff.QRa(r,!0).hyperlink;r=xe.SelectionEditor.ySb(r);if(B)ff.u8f(r),b=og.SelectionFactory.lJ(r.node,Math.min(r.cpBegin,B.cpBegin),Math.max(r.cpEnd,B.cpEnd)),Bh.a.instance.Ac(b),r=b.Pa;else if(xe.SelectionEditor.Ze(r)){var ca;xe.SelectionEditor.Llb(r)&&(ca=xe.SelectionEditor.j0(r,!1));ca||(ca=this.cvd.get(P.SourceControlId)[0],ff.jg.Ge(r,ca,!0,void 0,b),ca=og.SelectionFactory.lJ(r.node,
r.cpBegin,r.cpBegin+ca.length));if(ca&&(Bh.a.instance.Ac(ca),r=ca.Pa,ff.s5b(r)))return ff.Qd.hRb(!1),8}try{ff.hp.fF(r,this.cvd.get(P.SourceControlId)[1],0<Tg.a.SRc(r).length);const ra=og.SelectionFactory.ne(r.node,r.cpEnd);ra&&Bh.a.instance.Ac(ra);l(P,"RecentLinks")}finally{h&&h.dispose()}t.ULS.sendTraceTag(526242134,324,50,"Recent Links inserted");return 32}static fIb(b,h,r,B,P){if(ff.Z0c)return ff.wwm(b,h,r,B,P);if(!h.view.ue)return 2;var ca=h.view.mb;if(!ca||!ca.ib||!ca.ib.length)return 8;var ra=
ca.ib.lb;let Qa=ra.Pa.clone();if(2===ra.length){if(ra=ra.J(1),!xe.SelectionEditor.vl(Qa)||!xe.SelectionEditor.Lk(ra)||Qa.node!==ra.node)return 8}else if(2<ra.length)return 8;if(ca.ib.LJ)return 8;if(ff.ah.xAa(ke.ParagraphReader.OU,ca.qg))return ff.Ic.Yb(le.a.ef,{["Reason"]:ae.a.AO}),8;ke.ParagraphReader.vm(Qa)&&!xe.SelectionEditor.v9(Qa)&&(ca=Qa.node,Qa=Ue.a.createTextRange(ca,0,ke.ParagraphReader.textLength(ca)));return b===Nb.a.NId?ff.FKh(h,Qa,r,B):v.AFrameworkApplication.va.Nf(Qa,b,r,!0,B,P)}static wwm(b,
h,r,B,P){if(!h.view.ue)return 2;var ca=h.view.mb;if(!ca||!ca.ib||!ca.ib.length||ca.ib.LJ)return 8;var ra=ca.ib.lb;if(ca=ff.$Hf(ra))ra=ff.Cvf(ra.Pa.clone(),!0);else{let Qa=ra.J(0).clone(),tb=1;for(;tb<ra.length&&(!ke.ParagraphReader.textLength(Qa.node)||xe.SelectionEditor.Lk(Qa)||ff.Gua&&So.l(Qa));)Qa=ra.J(tb).clone(),tb++;ra=ff.Cvf(Qa,!1)}return ff.Gua&&xe.SelectionEditor.vl(ra)&&So.l(ra)||!xe.SelectionEditor.vl(ra)&&!ca?8:b===Nb.a.NId?ff.FKh(h,ra,r,B):v.AFrameworkApplication.va.Nf(ra,b,r,!0,B,P)}static $Hf(b){if(1===
b.length)return!0;if(2===b.length){const h=b.Pa.clone();b=b.J(1);return xe.SelectionEditor.vl(h)&&xe.SelectionEditor.Lk(b)&&h.node===b.node?!0:!1}return!1}static VHh(b){let h=null;const r=[];for(let B=0;B<b.length;B++){const P=ff.Cvf(b.J(B).clone(),!1);if(xe.SelectionEditor.vl(P))ff.Gua&&So.l(P)||r.push(P);else if(!xe.SelectionEditor.Lk(P)&&!ke.ParagraphReader.vm(P))return{returnValue:!1,zgb:h}}h=r;return{returnValue:!ff.Gua||0<h.length?!0:!1,zgb:h}}static insertLink(b,h,r,B,P){if(ff.Z0c)return ff.YDm(h,
r,P);B=ff.KJj(h);if(32!==B)return B;let ca;if(!({hyperlink:ca}=ff.QRa(h,!0)).returnValue||ff.s5b(h)||!ca&&b==Nb.a.w7b)return 8;if(1===r)return 32;if(!ca&&xe.SelectionEditor.Ze(h)&&xe.SelectionEditor.Llb(h)&&(b=xe.SelectionEditor.j0(h,!1))&&(Bh.a.instance.Ac(b),h=b.Pa,ff.s5b(h)))return ff.Qd.hRb(!1),8;ca&&t.ULS.sendTraceTag(593875799,324,50,"Edit link");a(h,P);return 32}static KJj(b){return!ff.F6e()||!ff.fFd(b)||b.node.Gr||Bh.a.instance.ib.LJ?8:xe.SelectionEditor.Q4(b)||Gg.a.hFf(b)?2:32}static YDm(b,
h,r){var B=Bh.a.instance.ib.lb;const P=ff.$Hf(B);if(P)b=[b];else if(!({zgb:b}=ff.VHh(B)).returnValue)return 8;if(!ff.F6e())return 8;for(B=0;B<b.length;B++)if(!ff.fFd(b[B]))return 8;if(Bh.a.instance.ib.LJ)return 8;B=Array(b.length);let ca=null;for(let ra=0;ra<b.length;ra++)if(B[ra]=b[ra],!({hyperlink:ca}=ff.QRa(B[ra],!0)).returnValue||ff.s5b(B[ra]))return 8;if(1===h)return 32;if(!ca&&1===B.length&&P&&xe.SelectionEditor.Ze(B[0])&&xe.SelectionEditor.Llb(B[0])&&(h=xe.SelectionEditor.j0(B[0],!1))&&(Bh.a.instance.Ac(h),
B[0]=h.Pa,ff.s5b(B[0])))return ff.Qd.hRb(!1),8;P?a(B[0],r):new gp(B,r);return 32}static Daj(b,h,r){if(ff.Z0c)return ff.R_n(b,h,r);if(!ff.fFd(h)||xe.SelectionEditor.Q4(h))return 2;let B;if(!({hyperlink:B}=ff.QRa(h,!1)).returnValue)return 2;if(2===r){r=new cg.GraphTransaction(15);try{r.Uj=b,r.Db(B.paragraph),ff.u8f(h)}finally{r&&r.dispose()}B.hyperlink.PG&&ff.Qd.Zs(2)}return 32}static R_n(b,h,r){var B=Bh.a.instance.ib.lb;if(ff.$Hf(B))h=[h];else if(!({zgb:h}=ff.VHh(B)).returnValue)return 8;if(!ff.F6e())return 8;
for(B=0;B<h.length;B++)if(!ff.fFd(h[B]))return 8;if(1===r&&!ff.QRa(h[0],!1).returnValue)return 2;if(2===r){for(r=0;r<h.length;r++)if(!ff.QRa(h[r],!0).returnValue)return 2;r=new cg.GraphTransaction(15);try{const P=h[0];r.Uj=b;r.Db(P.node);for(b=0;b<h.length;b++)ff.u8f(h[b])}finally{r&&r.dispose()}ff.Qd.Zs(7)}return 32}static u8f(b){const h=Tg.a.SRc(b);let r=0;for(let B=0;B<h.length;B++)if(h[B].cpBegin>=r){const P=({cpEnd:r}=ff.z0.Qha(b,h[B])).returnValue;ff.z0.taj(b,P)}}static Gij(b,h,r){if(Id.ImageReader.b4a(h)||
!({hyperlink:b}=ff.QRa(h,!1)).returnValue)return 2;if(2===r){const {cpBegin:B,cpEnd:P}=ff.z0.Qha(h,b);Bh.a.instance.Ac(og.SelectionFactory.lJ(b.paragraph,B,P))}return 32}static c_i(b,h,r){if(({hyperlink:b}=ff.rXm(h)).returnValue)t.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");else if(!({hyperlink:b}=ff.QRa(h,!1)).returnValue)return 2;2===r&&Eb.App.nFb(b.hyperlink.url);return 32}static CZf(b,h,r){b=Id.ImageReader.Qha(h.node);if(!b)return 2;2===r&&Eb.App.nFb(b);return 32}static FKh(b,
h,r,B){if(Id.ImageReader.b4a(h)||!hb.InteractiveViewManager.instance.xe.$j)return 2;let P;if(!({hyperlink:P}=ff.QRa(h,!1)).returnValue)return 2;if(1===r)return 32;const {cpBegin:ca,cpEnd:ra}=ff.z0.Qha(h,P);Bh.a.instance.Ac(og.SelectionFactory.lJ(P.paragraph,ca,ra));h=hb.InteractiveViewManager.instance.ODa.ownerDocument.createElement("span");h.innerText=P.hyperlink.url;h.style.backgroundColor="rgb(255, 255, 255)";return v.AFrameworkApplication.va.Nf(b,Nb.a.MId,2,!0,B,h)}static QRa(b,h){if(xe.SelectionEditor.vl(b)){const r=
So.g(b),B=Rl.a.all(r,P=>6===P.vh);if(0<r.length&&(!ff.Gua||!B)||ff.Yf.jh&&ff.DX&&0<ff.DX.$Qd(b).count)return{returnValue:!1,hyperlink:null}}return ff.gXm(b,h)}static rXm(b){let h=null;return Id.ImageReader.b4a(b)&&(h=Tg.a.a$b(b))?{returnValue:!0,hyperlink:h}:{returnValue:!1,hyperlink:h}}static gXm(b,h){let r=null;const B=Tg.a.SRc(b);return B.length?B[0].hyperlink?(r=B[0],b.cpBegin<B[0].cpBegin?{returnValue:h,hyperlink:r}:{returnValue:!0,hyperlink:r}):{returnValue:!1,hyperlink:r}:{returnValue:h,hyperlink:r}}static s5b(b){if(sq.a.instance.J(1)){b=
ff.Gh.pQa(b.node,b.cpBegin,b.cpEnd);for(let h=0;h<b.count;++h)if(2===b.J(h).Kd.changeType)return!0}return!1}static F6e(){return sq.a.instance.J(1)?!0:!sq.a.instance.J(1)||!Eb.App.Hv.uSb}static fFd(b){return ff.Yf.$_(b)||ff.Yf.via(b)||ff.ix()&&ff.ix().instance&&ff.ix().instance.SU(b)?!1:!0}static Cvf(b,h){return ke.ParagraphReader.vm(b)&&!xe.SelectionEditor.v9(b)&&(ke.ParagraphReader.textLength(b.node)||h)?Ue.a.createTextRange(b.node,0,ke.ParagraphReader.textLength(b.node)):b}static mbm(b){return b&&
b.length<=ff.Y7i?b:b.substring(0,ff.Y7i)+"..."}static CZl(b){try{const h=new Date(b);return String.format(Box4Intl.Box4Strings.l_RecentLinksTimeSeparator,h.toLocaleString(void 0,{weekday:"long"}),h.toLocaleString(void 0,{hour:"numeric",minute:"numeric"}))}catch(h){return""}}static Doe(b=!1){const h=Date.now();if(b||h-ff.WFi>ff.uKo)il.instance.Z9m(),ff.WFi=h}static Zce(b,h,r){const B=new Map;B.set("Source",r);B.set("Action",h);va.Health.instance.recordKpiUsage(b,0,this.uXa,B)}}ff.en=null;ff.Hsb=null;
ff.haa=null;ff.cvd=new Map;ff.PGe=null;ff.Y7i=35;ff.WFi=Date.now();ff.e1h=!1;ff.uXa="wwaengidc";ff.Mgk="RecentLinks";ff.Lch="RecentLinksRibbonOptions";ff.Kch="RecentLinksContextMenuOptions";ff.yfk="PopulateRecentLinksRibbon";ff.zfk="PopulateRecentLinksRibbonAction";ff.wfk="PopulateRecentLinksContextMenu";ff.xfk="PopulateRecentLinksContextMenuAction";ff.ack="PopulateRecentLinksContextMenu";ff.bck="PopulateRecentLinksContextMenuAction";ff.n7j="InsertRecentLinks";ff.o7j="InsertRecentLinksAction";Object(m.a)(ff,
"HyperlinkActor",null,[]);class OA{}OA.$lb=Object.freeze({Kym:"WordIndentationShortcutUsage"});OA.yB="wwaengidc";Object(m.a)(OA,"IndentationConstants",null,[]);class Dm{static get qq(){return Tt.a.MGb}static get ah(){return An.ContextSetEditor.instance}static get Yf(){return Wh.a.instance}static get Ic(){return Nh.a.instance}static get Nl(){return hb.InteractiveViewManager.instance}static ix(){return Dm.en||(Dm.en=Ma.a.instance.Ta("Box4.IExternalSelectionManager"))}static get Jym(){return null!=Dm.xBg?
Dm.xBg:Dm.xBg=Ma.a.instance.resolve("Box4.Actors.IIndentationActorExtension")}static Tb(){const b=v.AFrameworkApplication.va;b.ra(Nb.a.ZG,yc.a.view,Dm.MGc);b.ra(Nb.a.ZG,yc.a.LP,Dm.cvh);b.Xc(Nb.a.ZG,1036);b.ra(Nb.a.MO,yc.a.view,Dm.MGc);b.ra(Nb.a.MO,yc.a.LP,Dm.cvh);b.Xc(Nb.a.MO,1036)}static nSn(b){const h=new Map;b=b?b.ja(lh.a.fri,"Unknown"):"tab";h.set("actionCallSource",b);va.Health.instance.recordKpiUsage(OA.$lb.Kym,1,OA.yB,h)}static MGc(b,h,r,B,P){const ca=h.view;if(!ca.ue)return 2;var ra=ca.mb;
if(!ra)return Dm.Ic.Yb(le.a.ef,{["Reason"]:ae.a.Eda}),8;ra=ra.qg;if(!ra)return Dm.Ic.Yb(le.a.ef,{["Reason"]:ae.a.noSelection}),8;if(Gg.a.sia(h))return 8;if(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&Dm.Yf.vcc(ra))return Dm.Ic.Yb(le.a.ef,{["Reason"]:ae.a.cF}),8;if(1===r)return 32;if(Dm.ah.ZDa(Dm.F1e,ra))return Dm.Ic.Yb(le.a.ef,{["Reason"]:ae.a.IJc}),8;if(Dm.ah.xAa(ke.ParagraphReader.OU,ra))return Dm.Ic.Yb(le.a.ef,{["Reason"]:ae.a.AO}),8;if(!v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",
!1)&&Dm.Yf.vcc(ra))return Dm.Ic.Yb(le.a.ef,{["Reason"]:ae.a.cF}),8;if(Dm.ix()&&Dm.ix().instance&&Dm.ix().instance.SU(ra))return Dm.Ic.Yb(le.a.ef,{["Reason"]:ae.a.P1a}),8;ra={};ra[$r.a.fKa]=5794;ra[$r.a.eKa]=5795;return Dm.Jym.MGc(ca,b,h,r,B,P,ra)}static cvh(b,h,r,B,P){var ca,ra;if(h.contextId!==yc.a.LP)return 2;var Qa=h.clone().Iig();if(Rh.TableReader.BDi(Qa)){if(Dm.Yf.CDi(Qa))return Dm.Ic.Yb(le.a.vn,{["Reason"]:ae.a.cF}),8}else if(Dm.Yf.M4a(Qa))return Dm.Ic.Yb(le.a.vn,{["Reason"]:ae.a.cF}),2;Qa=
new Ad.GraphIterator;Qa.set(h.node);xe.SelectionEditor.zu(Qa);if(!Uf.OutlineElementReader.Eh(Qa))return 2;let tb;switch(b){case Nb.a.ZG:tb=Dm.qq.bCb(Qa);break;case Nb.a.MO:tb=Dm.qq.m4b(Qa);break;default:return 2}if(1===r||!tb)return tb?32:8;r=0;b===Nb.a.MO&&P&&P.ja(Yc.a.Rwh,!1)&&(r|=2);if(Uf.OutlineElementReader.ZQ(Qa))return Dm.Ic.Yb(le.a.vn,{["Reason"]:ae.a.AO}),2;(null===(ra=null===(ca=Dm.Nl)||void 0===ca?void 0:ca.yd)||void 0===ra?0:ra.TU)&&Dm.Nl.xe&&(Dm.Nl.xe.pI=!0);switch(b){case Nb.a.ZG:Dm.qq.oTa(Qa,
-1,r);break;case Nb.a.MO:Dm.qq.ILc(Qa,1)}B&&as.a.krb&&(B.Hs|=as.a.Tib(h.node,!0));Dm.nSn(P);return 32}}Dm.en=null;Dm.F1e=Id.ImageReader.a4a;Object(m.a)(Dm,"IndentationActor",null,[]);var Em=c(1603);class ql{static get Tk(){return null!=ql.KFg?ql.KFg:ql.KFg=Ma.a.instance.resolve("Box4.IParagraphEditor")}static get Mk(){return null!=ql.UHg?ql.UHg:ql.UHg=Ma.a.instance.resolve("Box4.ITableEditor")}static get Yf(){return Wh.a.instance}static get Ic(){return Nh.a.instance}static ix(){return ql.en||(ql.en=
Ma.a.instance.Ta("Box4.IExternalSelectionManager"))}static Tb(){const b=v.AFrameworkApplication.va;b.ra(Nb.a.Xyj,yc.a.view,(h,r)=>Gg.a.sia(r)?8:32);b.ra(Nb.a.I9,yc.a.view,Em.a.lw);b.ra(Nb.a.I9,yc.a.paragraph,ql.oDa);b.ra(Nb.a.I9,yc.a.table,ql.J2e);b.Xc(Nb.a.I9,1036);b.ra(Nb.a.Lba,yc.a.view,Em.a.lw);b.ra(Nb.a.Lba,yc.a.paragraph,ql.oDa);b.ra(Nb.a.Lba,yc.a.table,ql.J2e);b.Xc(Nb.a.Lba,1036);b.ra(Nb.a.z$,yc.a.view,Em.a.lw);b.ra(Nb.a.z$,yc.a.paragraph,ql.oDa);b.ra(Nb.a.z$,yc.a.table,ql.J2e);b.Xc(Nb.a.z$,
1036);b.ra(Nb.a.hFa,yc.a.view,Em.a.lw);b.ra(Nb.a.hFa,yc.a.paragraph,ql.oDa);b.Xc(Nb.a.hFa,1036);b.ra(Nb.a.kMc,yc.a.view,Em.a.lw);b.ra(Nb.a.kMc,yc.a.paragraph,ql.oDa);b.Xc(Nb.a.kMc,1036);b.ra(Nb.a.rKb,yc.a.view,Em.a.lw);b.ra(Nb.a.rKb,yc.a.paragraph,ql.oDa);b.Xc(Nb.a.rKb,1036);b.ra(Nb.a.Z9c,yc.a.view,Em.a.lw);b.ra(Nb.a.Z9c,yc.a.paragraph,ql.oDa);b.Xc(Nb.a.Z9c,1036);b.ra(Nb.a.$ec,yc.a.view,Em.a.lw);b.ra(Nb.a.$ec,yc.a.paragraph,ql.oDa);b.Xc(Nb.a.$ec,1036);b.ra(Nb.a.E4b,yc.a.view,Em.a.lw);b.ra(Nb.a.E4b,
yc.a.paragraph,ql.oDa);b.Xc(Nb.a.E4b,1036);b.ra(Nb.a.$jc,yc.a.view,Em.a.lw);b.ra(Nb.a.$jc,yc.a.paragraph,ql.oDa);b.Xc(Nb.a.$jc,1036);b.ra(Nb.a.a9b,yc.a.view,Em.a.lw);b.ra(Nb.a.a9b,yc.a.paragraph,ql.oDa);b.Xc(Nb.a.a9b,1036)}static J2e(b,h,r,B){let P=!0;if(!h)return 8;Rh.TableReader.BDi(h)?ql.Yf.CDi(h)?(ql.Ic.Yb(le.a.vn,{["Reason"]:ae.a.cF}),P=!1):ql.ix()&&ql.ix().instance&&ql.ix().instance.SU(h)&&(ql.Ic.Yb(le.a.vn,{["Reason"]:ae.a.P1a}),P=!1):(ql.Ic.Yb(le.a.vn,{["Reason"]:ae.a.Ogf}),P=!1);if(1===r||
!P)return P?32:8;h=h.node;switch(b){case Nb.a.I9:ql.Mk.oE(h,1);break;case Nb.a.Lba:ql.Mk.oE(h,2);break;case Nb.a.z$:ql.Mk.oE(h,3)}B&&as.a.krb&&(B.Hs|=2);return 32}static oDa(b,h,r,B,P){let ca=!0;h.contextId!==yc.a.paragraph?ca=!1:ql.Yf.M4a(h)?(ql.Ic.Yb(le.a.vn,{["Reason"]:ae.a.cF}),ca=!1):ql.ix()&&ql.ix().instance&&ql.ix().instance.SU(h)&&(ql.Ic.Yb(le.a.vn,{["Reason"]:ae.a.P1a}),ca=!1);if(1===r||!ca)return ca?32:8;h=h.node;r=ke.ParagraphReader.Lx(h);switch(b){case Nb.a.I9:case Nb.a.$ec:ql.Tk.oE(h,
1===r&&ql.p1d(P)?6:1);break;case Nb.a.Lba:case Nb.a.E4b:ql.Tk.oE(h,2===r&&ql.p1d(P)?1:2);break;case Nb.a.z$:case Nb.a.$jc:ql.Tk.oE(h,3===r&&ql.p1d(P)?1:3);break;case Nb.a.hFa:case Nb.a.a9b:ql.Tk.oE(h,6===r&&ql.p1d(P)?1:6);break;case Nb.a.rKb:ql.Tk.oE(h,11);break;case Nb.a.kMc:ql.Tk.oE(h,7);break;case Nb.a.Z9c:ql.Tk.oE(h,13)}B&&as.a.krb&&(B.Hs|=as.a.Tib(h));return 32}static p1d(b){let h=!1;null!==b&&Object.getType(b)===Object&&b.hasOwnProperty("InContextSet")&&(h=b.InContextSet);return!h}}ql.en=null;
Object(m.a)(ql,"JustificationActor",null,[]);const SB=()=>{const b=v.AFrameworkApplication.va;b.ra(Nb.a.save,yd.a.frame,PA);b.ra(Nb.a.sync,yd.a.frame,$y)},$y=(b,h,r)=>{if(1===r)return 32;v.AFrameworkApplication.va.processAction(Nb.a.s4b,2);Eb.App.si.hle();return 32},PA=(b,h,r)=>{if(1===r)return 2===Eb.App.za.mode?32:8;v.AFrameworkApplication.va.processAction(Nb.a.s4b,2);if(2!==Eb.App.za.mode)return 32;Eb.App.si.khj(null,null);return 32};class sw{constructor(){this.activateRibbonTab=(b,h,r,B,P)=>{Eb.App.Hv.fJ.Uee(P.toString());
return 32};this.U_m=(b,h,r,B,P)=>{v.AFrameworkApplication.fqa("Microsoft.Office.Web.SessionSettings.IWacWordTransformToWebPageSettings");Eb.App.Hv.fJ.lFi(1,P.toString());return 32};this.Bvn=(b,h)=>{if(h.contextId!==yd.a.frame)return 2;appChrome.onRibbonModeToggle();return 32}}Tb(){const b=v.AFrameworkApplication.va;b.ra(Nb.a.activateRibbonTab,yc.a.view,this.activateRibbonTab);b.Xc(Nb.a.activateRibbonTab,5);b.ra(Nb.a.mFi,yc.a.view,this.U_m);b.ra(Nb.a.Ymg,yd.a.frame,this.Bvn)}static get instance(){return null!=
sw.ZBg?sw.ZBg:sw.ZBg=sw.fm()}static fm(){return new sw}}Object(m.a)(sw,"RibbonActor",null,[]);var qh=c(571);class xt{constructor(b,h){this.Qm=null;this.NRo=(r,B,P,ca,ra)=>{let Qa;ca=B.view;if(!ca.ue)return xt.Ic.Yb(le.a.ef,{["Reason"]:ae.a.cMb}),8;Qa=r===Nb.a.undo?this.ug.lY:this.ug.CQa;if(1===P)return Gg.a.sia(B)&&Gg.a.Mcc()?8:Qa?32:8;if(!Qa)return t.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",r===Nb.a.undo?"undo":"redo"),this.MKa.value.WDj(),xt.Ic.Yb(le.a.ef,{["Reason"]:ae.a.HRo}),
2;B=new cg.GraphTransaction(3);B.Db(ca.ed);B.rge();r=r===Nb.a.undo?this.ug.undo():this.ug.Dja();B.dispose();ra&&Ny.GrippersManager.instance.ZSb(ra.Rx);if(r)return 32;xt.Ic.Yb(le.a.f7b,{["Reason"]:ae.a.JRi});return 8};this.Jma=b;this.MKa=h}get ug(){return this.Qm||(this.Qm=this.Jma())}Tb(){const b=v.AFrameworkApplication.va,h=this.NRo;b.fb(Nb.a.undo,yc.a.view,h,1028);b.fb(Nb.a.Dja,yc.a.view,h,1028)}static get instance(){return null!=xt.JBg?xt.JBg:xt.JBg=xt.fm()}static fm(){const b=Ma.a.instance;return new xt(()=>
b.resolve("Box4.IUndoManager"),b.Ve("Box4.ICoauthCashTelemetry"))}static get Ic(){return Nh.a.instance}}Object(m.a)(xt,"UndoActor",null,[]);class yq{constructor(){this.W=null}get name(){return"Box4.Actors"}wc(b){this.W=b;(new uu).wc(b)}init(){var b=this.W.resolve("Box4.Actors.ClipboardActor");Object(Hx.a)()&&this.W.resolve("Box4.Actors.PageColorActor").Tb();b.Tb();b.E5();Ii();dt.instance.Tb();ff.Tb();Dm.Tb();ql.Tb();this.W.resolve("Box4.Actors.TouchInputActor").Tb();rw.instance.Tb();this.W.resolve("Box4.ISelectAllHandlers").Tb();
SB();this.W.resolve("Box4.Actors.ProofingActor").Tb();sw.instance.Tb();(b=this.W.Oa("Box4.IFeatureHelper"))?b.pq.continueWith(()=>{this.c$i()}):this.c$i();qh.a.Tb(Eb.App.lVa);this.W.resolve("Box4.Actors.TextFormattingActor").Tb();xt.instance.Tb();this.W.resolve("Box4.Actors.AccessibilityActor").X6f();this.W.resolve("Box4.IClipboardCommands");this.W.resolve("Box4.Actors.PasteFloatieEventManager");Eb.App.za.updateCommandUI()}c$i(){this.W.resolve("Box4.Actors.StyleContextMenuActor").Tb();this.W.resolve("Box4.Actors.StyleActor").Tb()}dispose(){}static main(){L.a.instance.Gc(new yq)}}
Object(m.a)(yq,"Box4ActorsPackage",null,[1,2]);class TB extends ni{constructor(b,h,r,B){super(b);this.joa=r;this.y7a=B;this.Osg=0;this.YA=h.rSa("UserAction","WordOnlineAddToDictionary")}ufg(b){this.oNd=this.joa.Boa(b);if(!this.KVk())return!1;const h=this.oNd.errorDetails.token;this.y7a.wqh(h);if(!this.y7a.Lbd(h))return t.ULS.sendTraceTag(541618644,375,10,"[Add to Dictionary]: Unable to save word to roaming dictionary."),!1;t.ULS.sendTraceTag(541618645,375,50,"[Add to Dictionary]: Starting ProofingWholeDocument operation.");
this.YA.start();this.transaction=new cg.GraphTransaction(15);this.transaction.Db(b.node);return!0}Mae(b){this.$Nb(b.node);return!0}D4c(b){this.$Nb(b);return!0}Nae(b){this.$Nb(b.node)}Dlg(b){this.transaction.dispose();this.oNd.errorDetails.Arb(b.actionId);this.y7a.gbg("unused corelation id.");this.YA.stop();t.ULS.sendTraceTag(541618646,375,50,String.format("[Add to Dictionary]: Actual errors removed: {0}. Duration in milliseconds: {1}. Type: {2}",this.Osg,this.YA.oi,this.oNd.errorDetails.proofingType));
return!0}qmc(b,h){const r=b.role;return super.qmc(b,h)||9===r||10===r||13===r||7===r||8===r}$Nb(b){if(b){var h=this.joa.E4(b,r=>this.y7a.Lbd(r.errorDetails.token));this.joa.fpb(b,h,!0);this.Osg+=h.length}}KVk(){var b,h;return null!==(h=null===(b=this.oNd)||void 0===b?void 0:b.errorDetails)&&void 0!==h&&h.token?!0:(t.ULS.sendTraceTag(541618647,375,10,"[Add to Dictionary]: Was not able to get the token from the error range."),!1)}}Object(m.a)(TB,"AddToDictionaryCallbackSteps",ni,[]);class Zw{constructor(b,
h,r,B,P,ca,ra){this.oc=b;this.mb=h;this.VP=r;this.joa=B;this.eq=P;this.y7a=ca;this.tKn=ra;this.Fnm=(Qa,tb,Mb,Zb,jc,Gc)=>{const Uc=new TB(this.VP,this.eq,this.joa,this.y7a);return new Vy(Qa,tb,Mb,Zb,jc,Gc,Uc,this.oc,this.mb,this.VP,"AddToDictionaryThroughProofingWholeDocumentOperation")}}Tb(){this.oc.HT(Nb.a.addToDictionary,yc.a.view,this.Fnm,1124);this.tKn.WXn(this.y7a)}}Object(m.a)(Zw,"PersonalDictionaryOrchestrator",null,[]);class UB{get name(){return"Box4.PersonalDictionary"}wc(b){this.container=
b;b.register(Zw,"Box4.PersonalDictionary.PersonalDictionaryOrchestrator").ha().Ud(()=>new Zw(v.AFrameworkApplication.va,Bh.a.instance,hr.a.instance,b.resolve("Box4.Proofing.IErrorRangeEditor"),b.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("IRoamingDictionary"),b.resolve("Box4.Proofing.ProofingCheckOperator")))}init(){this.container.resolve("Box4.PersonalDictionary.PersonalDictionaryOrchestrator").Tb()}dispose(){}static main(){ij.a.get_instance().pk(7,()=>{L.a.instance.Gc(new UB)})}}
Object(m.a)(UB,"PersonalDictionaryPackage",null,[1,2]);var qo=c(177);class yt{constructor(b,h,r,B,P,ca){this.OBa=this.R$a=this.eW=null;this.lIc=(ra,Qa,tb,Mb,Zb)=>this.TCi(Qa,tb,Zb,!1)?32:8;this.UK=(ra,Qa,tb,Mb,Zb)=>{if(!({Ay:ra}=this.rqj(Qa,tb,Zb,!0)).returnValue)return ra;t.ULS.sendTraceTag(594899719,340,50,"Cell shading color is selected from Standard/Theme colors.");Zb=this.Emk.nva(Qa.node,Zb);this.GCn(Qa.node,Zb);this.kQ();return 32};this.qCb=(ra,Qa,tb,Mb,Zb)=>{if(!({Ay:ra}=this.rqj(Qa,tb,Zb,
!1)).returnValue)return ra;this.CCn(Qa.node);return 32};this.ALn=(ra,Qa,tb,Mb,Zb)=>{if(1===tb)return 32;if(!Qa||!Qa.view.ue)return 2;ra=Qa.view.mb;if(!ra)return 2;ra=ra.qg;if(!ra)return 2;ra=yt.ah.pR(ra,16);if(!ra||!ra.length)return 2;Qa=null;for(tb=0;tb<ra.length;tb++){Mb=ra.getContext(tb);if(!Mb||Mb.contextId!==yc.a.Hw)return 2;const jc={};this.Kmi(Mb,jc);if(jc.CellShading)if(Qa&&Qa!==jc.CellShading){Qa=null;break}else Qa=jc.CellShading;else{Qa=null;break}}Zb.CellShading=Qa;return 32};this.jOb=
(ra,Qa,tb,Mb,Zb)=>1===tb?32:this.Kmi(Qa,Zb);this.FNb=(ra,Qa,tb,Mb,Zb)=>{if(1===tb)return 32;ra=Qa.contextId===yc.a.view?this.hCa.rTd(Qa):this.ktf(Qa);tb={};Qa=null;32===v.AFrameworkApplication.va.Qb(Nb.a.jOb,2,tb)&&tb&&(Qa=tb.CellShading);tb="";Qa&&(tb=Wi.a.eF(Qa)||"");this.opj.WPb=tb;this.YXc&&this.v1.Hoe(tb);ra=this.opj.fPc(ra,Eb.App.xCb);if(!ra)return 8;Zb.MenuItems=ra;t.ULS.sendTraceTag(592996034,340,50,"Cell Shading dropdown menu is opened.");return 32};this.gja=(ra,Qa,tb,Mb,Zb)=>{if(1===tb)return 32;
Eb.App.za.dismissFloatie();v.AFrameworkApplication.va.Qb(Nb.a.jOb,2,Zb);this.R$a=new Xt.a("Shading",Nb.a.Xkc);this.R$a.Rlc(Zb&&Zb.CellShading?Zb.CellShading:0);return 32};this.EUk=(ra,Qa,tb,Mb,Zb)=>{if(1===tb)return 32;v.AFrameworkApplication.va.Qb(Nb.a.F$,2,Zb);this.v1.w_a(Zb)||t.ULS.sendTraceTag(594899717,340,50,"Color selected from Recent Colors section. Menu: {0}","Shading");return 32};this.ga=b;this.Emk=h;this.NKe=r;this.hCa=B;this.Vd=P;this.Aq=ca}get v1(){return null!=this.sGg?this.sGg:this.sGg=
Ma.a.instance.Oa("Box4.UI.RecentColorsSectionHandler")}get opj(){this.eW||(this.eW=new $u.a("Shading"),this.dGa(this.eW));return this.eW}dGa(b){b.nX(2,Nb.a.qCb);b.nX(3,Nb.a.F$);b.nX(4,Nb.a.F$);b.SAb(this.NKe,1)}Tb(){this.ga.ra(Nb.a.FNb,yc.a.view,this.FNb);this.ga.ra(Nb.a.FNb,yc.a.Hw,this.FNb);this.ga.Xc(Nb.a.FNb,1126);this.ga.ra(Nb.a.lIc,yc.a.view,qh.a.jPc);this.ga.ra(Nb.a.lIc,yc.a.Hw,this.lIc);this.ga.Xc(Nb.a.lIc,1028);this.ga.ra(Nb.a.F$,yc.a.view,qh.a.jPc);this.ga.ra(Nb.a.F$,yc.a.Hw,this.UK);this.ga.Xc(Nb.a.F$,
1028);this.ga.ra(Nb.a.qCb,yc.a.view,qh.a.jPc);this.ga.ra(Nb.a.qCb,yc.a.Hw,this.qCb);this.ga.Xc(Nb.a.qCb,1028);this.ga.ra(Nb.a.jOb,yc.a.view,this.ALn);this.ga.ra(Nb.a.jOb,yc.a.Hw,this.jOb);this.ga.Xc(Nb.a.jOb,1124);this.ga.ra(Nb.a.Xkc,yc.a.view,qh.a.jPc);this.ga.ra(Nb.a.Xkc,yc.a.Hw,this.EUk);this.ga.Xc(Nb.a.Xkc,1028);this.ga.ra(Nb.a.EZf,yc.a.view,this.gja);this.ga.Xc(Nb.a.EZf,1028)}kQ(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>
{const b=Ma.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}rqj(b,h,r,B){return this.TCi(b,h,r,B)?{returnValue:2===h,Ay:32}:(2==h&&qh.a.recordQosError("CellShadingButtonClickNoResponse",["TableInteractionFailed"],ae.a.gBl),{returnValue:!1,Ay:8})}TCi(b,h,r,B){return b.contextId!==yc.a.Hw||2===h&&(B&&!r||!b.node)?!1:!0}GCn(b,h){const r=new cg.GraphTransaction(15);r.Db(b);this.Wnj(b);b.properties.setValue(Pd.a.UK,
h);r.dispose()}CCn(b){const h=new cg.GraphTransaction(15);h.Db(b);this.Wnj(b);b.properties.removeProperty(Pd.a.UK);h.dispose()}ktf(b){return b.contextId!==yc.a.Hw?null:(b=yt.hi.su(b.node))?b:null}Wnj(b){if(this.Vd&&this.Vd.xg&&(b=Object(Ra.a)(HA.TableCellNode,b))){const h=b.oV();this.Aq.X9c(b,h)}}Kmi(b,h){if(b.contextId!==yc.a.Hw)return 8;(b=b.node)&&b.hasProperty(Pd.a.UK)&&(h.CellShading=b.getValue(Pd.a.UK));return 32}static SQl(){return new yt(v.AFrameworkApplication.va,qi.a.instance,Hs.a.instance,
si.PageReader.instance,Ma.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ma.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get hi(){return qo.PageNavigator.instance}static get ah(){return null!=yt.Sxg?yt.Sxg:yt.Sxg=An.ContextSetEditor.instance}static get instance(){return null!=yt.dDg?yt.dDg:yt.dDg=yt.SQl()}get YXc(){null==this.OBa&&(v.AFrameworkApplication.oe("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.OBa=v.AFrameworkApplication.K?
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",!1):!1);return this.OBa}}Object(m.a)(yt,"CellShadingActor",null,[]);class $x{constructor(){this.W=null}get name(){return"Box4.CellShading"}wc(b){this.W=b}init(){const b=this.W.Oa("Box4.IFeatureHelper");b?b.pq.continueWith(()=>{this.wn()}):this.wn()}wn(){yt.instance.Tb();Eb.App.za.updateCommandUI()}dispose(){}}Object(m.a)($x,"CellShadingPackage",null,[1,2]);var et;(function(b){b[b.none=
0]="none";b[b.REo=1]="style1";b[b.SEo=2]="style2";b[b.TEo=3]="style3";b[b.UEo=4]="style4";b[b.VEo=5]="style5";b[b.bullet=6]="bullet";b[b.invalid=42]="invalid"})(et||(et={}));Object(m.b)("ListStyle",et);const Zt={[et.REo]:{[1]:"disc",[0]:"decimal"},[et.SEo]:{[1]:"circle",[0]:"lower-alpha"},[et.TEo]:{[1]:"square",[0]:"lower-roman"},[et.UEo]:{[0]:"upper-alpha"},[et.VEo]:{[0]:"upper-roman"},[et.bullet]:{[1]:"bullet"}};var vu;(function(b){b[b.number=0]="number";b[b.bullet=1]="bullet";b[b.lim=13]="lim";
b[b.nil=14]="nil";b[b.any=15]="any";b[b.noList=16]="noList";b[b.invalid=42]="invalid"})(vu||(vu={}));Object(m.b)("ListType",vu);var QA=c(1643);class Lo{constructor(b,h){this.YB=this.SZc=null;this.levelText=b;this.font=h}get Dae(){return this.levelText}get listStyle(){return 6}get yw(){return"left"}}Object(m.a)(Lo,"ListMarkerBullet",null,[513]);class wi{static get Qn(){return null!=wi.fEg?wi.fEg:wi.fEg=Ma.a.instance.resolve("Box4.List.IListEditor")}static get Jd(){return wi.Hf||(wi.Hf=Ma.a.instance.resolve("Box4.List.IListReader"))}static set Jd(b){wi.Hf=
b}static get Bj(){return null!=wi.CBg?wi.CBg:wi.CBg=Ma.a.instance.resolve("Box4.IInsertionPointFormatting")}static ix(){return wi.en||(wi.en=Ma.a.instance.Ta("Box4.IExternalSelectionManager"))}static get ah(){return An.ContextSetEditor.instance}static get Yf(){return Wh.a.instance}static get Ic(){return Nh.a.instance}static get tq(){return Ym.a.getInstance()}static get qad(){return null!=wi.ZGg?wi.ZGg:wi.ZGg=Ma.a.instance.Oa("Box4.List.ISingleLevelListEditor")}static Tb(){const b=v.AFrameworkApplication.va;
b.ra(Nb.a.rD,yc.a.view,wi.GGc);b.ra(Nb.a.rD,yc.a.LP,wi.Uma);b.Xc(Nb.a.rD,1036);b.ra(Nb.a.LL,yc.a.view,wi.GGc);b.ra(Nb.a.LL,yc.a.LP,wi.Uma);b.Xc(Nb.a.LL,1036);b.ra(Nb.a.Cda,yc.a.view,wi.GGc);b.ra(Nb.a.Cda,yc.a.LP,wi.Uma);b.Xc(Nb.a.Cda,1036);b.ra(Nb.a.w2e,yc.a.view,cd.ActionManager.Of);b.ra(Nb.a.eFh,yc.a.view,cd.ActionManager.Of);b.ra(Nb.a.pJf,yc.a.view,wi.b6n);b.ra(Nb.a.g2e,yc.a.view,cd.ActionManager.Of);b.ra(Nb.a.x2e,yc.a.view,cd.ActionManager.Of);b.ra(Nb.a.Ekg,yc.a.view,cd.ActionManager.Of);b.ra(Nb.a.Fxj,
yc.a.view,cd.ActionManager.Of);b.ra(Nb.a.Gne,yc.a.view,cd.ActionManager.Of)}static b6n(){QA.a.uej();return 32}static GGc(b,h,r,B,P){var ca,ra,Qa;if(!h.view.ue)return 2;const tb=wi.Ic.Fp(Nb.a.GGc);B.Hs=42;B.PC=42;const Mb={[$r.a.fKa]:5796,[$r.a.eKa]:5797};var Zb=h.view;if(wi.ah.ZDa(wi.fxm,Zb.mb.qg))return wi.Ic.Yb(le.a.ef,{["Reason"]:ae.a.y$e}),tb.end(),8;if(wi.ah.ZDa(wi.F1e,Zb.mb.qg))return wi.Ic.Yb(le.a.ef,{["Reason"]:ae.a.IJc}),tb.end(),8;if(wi.ah.xAa(ke.ParagraphReader.OU,Zb.mb.qg))return wi.Ic.Yb(le.a.ef,
{["Reason"]:ae.a.AO}),tb.end(),8;if(wi.Yf.vcc(Zb.mb.qg))return wi.Ic.Yb(le.a.ef,{["Reason"]:ae.a.cF}),tb.end(),8;if(null===(ra=null===(ca=wi.ix())||void 0===ca?void 0:ca.instance)||void 0===ra?0:ra.SU(h))return wi.Ic.Yb(le.a.ef,{["Reason"]:ae.a.P1a}),tb.end(),8;if(1===r)return tb.end(),32;P||(P=new fd.DictionaryPropertySet);ca=null;if(2===r){ca=new cg.GraphTransaction(15);ca.Db(h.view.ed);wi.yYc=!1;ra=Uy.OutlineElementGeneralizer.Aha(Zb.mb.ib,!1);if(!ra)return ca.dispose(),wi.Ic.Yb(le.a.moa,{["Reason"]:ae.a.XNd}),
tb.end(),8;1<ra.length&&P.setValue(Yc.a.KQi,null);const jc=P.ja(Yc.a.OJ,-1),Gc=P.ja(Yc.a.MA,-1);null===(Qa=wi.qad)||void 0===Qa?void 0:Qa.hXk(ra);if(Qa=wi.Cro(jc,Gc,ra))P.setValue(Yc.a.MA,16),P.setValue(Yc.a.eSa,0);if(!xe.SelectionEditor.Ze(Zb.mb.qg)&&!Qa&&0<ra.length&&jc){Zb=new Ad.GraphIterator;Qa=Array(ra.length);for(let Uc=0;Uc<ra.length;Uc++)Zb.set(ra.getContext(Uc).node),Qa[Uc]=wi.Jd.vw(Zb);wi.Bro(Qa,P)&&(Zb=new fd.DictionaryPropertySet,Zb.setValue(Yc.a.MA,16),Zb.setValue(Yc.a.eSa,0),Ym.a.DY&&
(Zb.setValue(lh.a.cqa,"clean-list-before-apply-new-list-style"),Zb.setValue(lh.a.Jia,P.ja(lh.a.cqa,"unknown")+"@"+P.ja(lh.a.Jia,"undefined"))),$r.a.Kqa(b,h,r,B,Zb,Mb,11),v.AFrameworkApplication.va.processAction(Nb.a.Fxj,2),t.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),wi.yYc=!0)}Zb=new Ad.GraphIterator;Zb.set(ra.getContext(0).node);Zb=wi.Jd.vw(Zb);wi.n6m(jc,Gc,Zb,ra.length)}b=$r.a.Kqa(b,h,r,B,P,Mb,11);32===b&&P.ja(Yc.a.Rwh,!1)&&(b=$r.a.Kqa(Nb.a.MO,h,r,B,P,Mb,
11));ca&&ca.dispose();tb.end();return b}static Bro(b,h){let r=null;var B=!1;for(let P=b.length-1;0<=P&&(r?(B=b[P],B=-1!==h.ja(Yc.a.OJ,-3)?B?r.listType!==B.listType||r.listStyle!==B.listStyle:!0:B?r.listType!==B.listType:!0):r=b[P],!B);P--);return r&&(b=!1,B||(b=h.ja(Yc.a.MA,42),h=h.ja(Yc.a.OJ,-3),b=b!==r.listType||0<h),B||b)?!0:!1}static n6m(b,h,r,B){0>=B||wi.yYc||(b?r?(r=r.listType,-1===b&&h===r?(v.AFrameworkApplication.va.processAction(Nb.a.Gne,2),t.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):
0<b&&(!h||1===h)&&(v.AFrameworkApplication.va.processAction(h?Nb.a.g2e:Nb.a.x2e,2),t.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",h?"Bullet":"Numbering"))):(v.AFrameworkApplication.va.processAction(h?Nb.a.g2e:Nb.a.x2e,2),wi.uOo(),t.ULS.sendTraceTag(39715534,393,50,"List Actions: Apply {0} List Style",h?"Bullet":"Numbering")):(v.AFrameworkApplication.va.processAction(Nb.a.Gne,2),t.ULS.sendTraceTag(39715533,393,50,"List Actions: Clean List Style - None list style")))}static Cro(b,
h,r){if(-1!==b&&b||!r.length)return!1;b=new Ad.GraphIterator;let B=null;for(let P=r.length-1;0<=P&&!(b.set(r.getContext(P).node),B=wi.Jd.vw(b));P--);return B&&h===B.listType?!0:!1}static Uma(b,h,r,B,P){var ca;if(h.contextId!==yc.a.LP)return 2;var ra=h.clone().Iig();if(wi.Yf.M4a(ra))return wi.Ic.Yb(le.a.vn,{["Reason"]:ae.a.cF}),2;const Qa=new Ad.GraphIterator;Qa.set(h.node);xe.SelectionEditor.zu(Qa);if(!Uf.OutlineElementReader.Eh(Qa))return 2;if(1===r)switch(b){case Nb.a.rD:return 32;case Nb.a.LL:return 32;
case Nb.a.Cda:return 32;default:return 2}if(Uf.OutlineElementReader.ZQ(Qa))return wi.Ic.Yb(le.a.vn,{["Reason"]:ae.a.AO}),2;h=wi.Jd.vw(Qa);var tb;Ym.a.DY&&(tb=Object.freeze(null===h||void 0===h?void 0:h.clone()));let Mb=P;if(!Mb)return 8;b===Nb.a.LL||b===Nb.a.rD||b===Nb.a.Cda?(Mb=wi.Qn.xNc(b,Mb),ra=Vp.a.c0(Mb.getValue(Yc.a.MA),Mb.getValue(Yc.a.eSa))):ra=null;wi.$0(b,Mb);wi.Wko(ra,Mb);let Zb=!1;b===Nb.a.rD&&Mb&&(Mb.hasProperty(Mc.a.pv)&&(ra.levelText=Mb.ja(Mc.a.pv,"")),Mb.hasProperty(Pd.a.font)&&(ra.font=
Mb.ja(Pd.a.font,"")),Mb.hasProperty(Yc.a.ymf)&&(Zb=Mb.ja(Yc.a.ymf,!1)));wi.Fmo(Mb,Qa);ra=wi.Qn.Uma(Mb,Qa,ra,Zb);if(!ra.returnValue)return wi.Ic.Yb(le.a.vn,{["Reason"]:ae.a.sLf}),2;ra=ra.txa;Ym.a.DY&&wi.tSn(P,tb,ra);2===r&&(r=P.ja(Yc.a.MA,-1),ra&&-1!==r&&((tb=P.ja(Mc.a.ks,"Invalid MultiLevel Type"),b===Nb.a.LL&&t.ULS.sendTraceTag(540313232,393,50,"toggleNumberedList Info - {0}",JSON.stringify({["commandSource"]:(null===P||void 0===P?void 0:P.CommandSource)||"ribbon/keyboard",["autonumberedListsEnabled"]:!0,
["listStyle"]:et[null==(null===h||void 0===h?void 0:h.listStyle)?null===ra||void 0===ra?void 0:ra.listStyle:null===h||void 0===h?void 0:h.listStyle],["listType"]:vu[null==(null===h||void 0===h?void 0:h.listType)?null===ra||void 0===ra?void 0:ra.listType:null===h||void 0===h?void 0:h.listType],["cleared"]:16===(null===ra||void 0===ra?void 0:ra.listType)})),h)?ra.listType&&1!==ra.listType||wi.yYc||(v.AFrameworkApplication.va.processAction(Nb.a.Ekg,2),t.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",
r?"Bullet":"Numbering",tb)):16===ra.listType?(v.AFrameworkApplication.va.processAction(Nb.a.eFh,2),t.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",r?"Bullet":"Numbering",tb)):ra.listType&&1!==ra.listType||wi.yYc||(v.AFrameworkApplication.va.processAction(Nb.a.w2e,2),t.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",r?"Bullet":"Numbering",tb))),(b=pc.FocusManager.instance())&&b.currentScope&&b.currentScope.name===Qi.AppFrame.hra&&b.kD(Dd.AFrame.In));
B.Hs=ra.listType;B.PC=ra.listStyle;(null===(ca=v.AFrameworkApplication.K)||void 0===ca?0:ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&Zu.a.instance.h7a("List");return 32}static tSn(b,h,r){var B,P,ca,ra,Qa,tb,Mb,Zb;const jc=new Map;jc.set("actionCallSource",b.ja(lh.a.cqa,"unknown"));jc.set("actionCallSourceTrigger",b.ja(lh.a.Jia,"undefined"));jc.set("fromListType",vu[null!==(B=null===h||void 0===h?void 0:h.listType)&&void 0!==B?B:16]);jc.set("fromListStyle",et[null!==
(P=null===h||void 0===h?void 0:h.listStyle)&&void 0!==P?P:0]);jc.set("fromListMarkerType",null!==(Qa=k(null!==(ca=null===h||void 0===h?void 0:h.listStyle)&&void 0!==ca?ca:0,null!==(ra=null===h||void 0===h?void 0:h.listType)&&void 0!==ra?ra:16))&&void 0!==Qa?Qa:"undefined");jc.set("fromLevelText",(null===h||void 0===h?0:h.Yoa)?h.levelText:"undefined");jc.set("toListType",null!==(tb=vu[null===r||void 0===r?void 0:r.listType])&&void 0!==tb?tb:"undefined");jc.set("toListStyle",null!==(Mb=et[null===r||
void 0===r?void 0:r.listStyle])&&void 0!==Mb?Mb:"undefined");jc.set("toListMarkerType",null!==(Zb=k(null===r||void 0===r?void 0:r.listStyle,null===r||void 0===r?void 0:r.listType))&&void 0!==Zb?Zb:"undefined");jc.set("toLevelText",(null===r||void 0===r?0:r.Yoa)?r.levelText:"undefined");va.Health.instance.recordKpiUsage(gk.a.$lb.b2m,0,gk.a.yB,jc)}static Fmo(b,h){var r=new Ad.GraphIterator;r.kd(h);(h=r.Ub(2))&&ke.ParagraphReader.Xb(h)&&(r=Bh.a.instance.ib.lb)&&r.Pa&&r.Pa.node===h&&xe.SelectionEditor.P0d(r)&&
(wi.hjo(b),wi.fjo(b))}static Wko(b,h){h.hasProperty(Mc.a.ks)&&b.nhe(h.getValue(Mc.a.ks));h.hasProperty(lh.a.OQ)&&(b.OQ=h.getValue(lh.a.OQ));h.hasProperty(Mc.a.pv)&&(b.levelText=h.getValue(Mc.a.pv));b.OJ=h.ja(Yc.a.OJ,-1);let r=null;b.Ppa&&(r=wi.r3l(b,h));b.Ppa&&r?wi.Amo(b,r):(b.Ppa?t.ULS.sendTraceTag(589091597,393,15,"List marker is null, falling back to default list info.List Style {0}, List multi level type {1}, List Ordered : {2}",b.OJ,b.ks,b.Lz):t.ULS.sendTraceTag(589091596,393,50,"User has not selected a style choosing default properties"),
wi.Who(b))}static Who(b){if(b.Lz)b.mWd&&-1===b.OJ||(b.levelText="%1.",b.propertySet.hasProperty(Pd.a.k5)||b.I$(0,1));else if(1===b.listType)b.mWd&&-1===b.OJ||(b.font=gk.a.tLc,b.levelText=gk.a.wKd,b.propertySet.hasProperty(Pd.a.k5)||b.I$(1,6));else return;b.yw="left"}static Amo(b,h){1===b.ks?wi.qlo(b,h):wi.Gjo(b,h)}static qlo(b,h){(b.YB=h.YB)?b.n6=h.YB.n6:h.YB||t.ULS.sendTraceTag(588022422,393,15,"Multi level def info is null for list markerList Style {0}, List multi level type {1}, List Ordered : {2}",
b.OJ,b.ks,b.Lz)}static Gjo(b,h){b.levelText=h.levelText;b.Lz?b.I$(0,h.listStyle):(b.font=h.font,b.I$(1,1));b.yw=h.yw}static r3l(b,h){let r=null;2===b.ks?r=b.Lz?Ma.a.instance.Oa("Box4.ListMarkerGallery.ListMarkerNumberingLoader"):Ma.a.instance.Oa("Box4.ListMarkerGallery.ListMarkerBulletLoader"):1===b.ks&&(r=Ma.a.instance.Oa("Box4.ListMarkerGallery.ListMarkerMultilevelLoader"));let B=r.WKb.value;const P=b.OJ+"";P in B||(B=r.K9,t.ULS.sendTraceTag(588391454,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in default list marker dictionary",
P,b.ks,b.Lz));if(!(P in B)){t.ULS.sendTraceTag(588391455,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in document list marker dictionary",P,b.ks,b.Lz);if(h.hasProperty(Pd.a.font))return t.ULS.sendTraceTag(588391456,393,50,"User creating new list marker for List styleId {0} List Multi level type {1} and List Ordered : {2}",P,b.ks,b.Lz),b=h.ja(Pd.a.font,""),new Lo(F.a.fromCharCode(parseInt(P)),b);t.ULS.sendTraceTag(588391457,393,15,"List styleId {0} List Multi level type {1} and List Ordered : {2} not found in any dictionary",
P,b.ks,b.Lz)}return B[P]}static fjo(b){wi.Bj.hasProperty(Pd.a.fontColor)&&b.setValue(Pd.a.fontColor,wi.Bj.fontColor())}static hjo(b){wi.Bj.hasProperty(Pd.a.fontSize)&&b.setValue(Pd.a.fontSize,wi.Bj.fontSize())}static $0(b,h){b=b===Nb.a.rD?0:b===Nb.a.LL?1:b===Nb.a.Cda?2:-1;h=h.ja(Yc.a.OJ,-1);t.ULS.sendTraceTag(22923024,324,50,"ListType: {0}, ListStyleId: {1}",b,h)}static uOo(){const b=Ma.a.instance.Ta("Common.ISystemInitiatedFeedback");if(b){var h=v.AFrameworkApplication.K.mc("WordDefaultToEditFloodgateDelayInMilliseconds",
6E4);b.execute(r=>{window.setTimeout(()=>{r.logActivity("WordListsExperience","WordListsExperienceFloodgateIsEnabled")},h)})}else t.ULS.sendTraceTag(554796489,301,15,"Word lists floodgate instance SystemInitiatedFeedback was null")}}wi.fxm=Id.ImageReader.UWc;wi.F1e=Id.ImageReader.a4a;wi.Hf=null;wi.en=null;wi.yYc=!1;Object(m.a)(wi,"ListActor",null,[]);class tw{constructor(){this.WKb=new pf.a(()=>this.Cbf());this.K9={}}x4h(b){return b}}Object(m.a)(tw,"AListMarkerGalleryLoader",null,[524]);var zt=c(1400),
Jx=c(443);class Mn extends tw{constructor(){super();this.Swb=new De.a(Pa.a.ih())}x4h(b){Mn.QQ||this.Ugo();b in Mn.QQ&&(b=Mn.QQ[b]);return b}Cbf(){const b={};b["0"]=new Lo(Box4Intl.Box4Strings.L_ListStyleNone,zt.a.uui);b["1"]=new Lo(String.fromCharCode(61623),"Symbol");b["2"]=new Lo(String.fromCharCode(111),"Courier New");b["3"]=new Lo(String.fromCharCode(61607),"Wingdings");b["4"]=new Lo(String.fromCharCode(9643),"Courier New");b["5"]=new Lo(String.fromCharCode(61611),"Wingdings");b["6"]=new Lo(String.fromCharCode(61614),
"Symbol");b["7"]=new Lo(String.fromCharCode(61483),"Symbol");b["8"]=new Lo(String.fromCharCode(61485),"Symbol");b["9"]=new Lo(String.fromCharCode(9830),"Courier New");b["10"]=new Lo(String.fromCharCode(61664),"Symbol");b["11"]=new Lo(String.fromCharCode(61558),"Wingdings");b["12"]=new Lo(String.fromCharCode(61656),"Wingdings");b["13"]=new Lo(String.fromCharCode(61514),"Wingdings");b["14"]=new Lo(String.fromCharCode(61516),"Wingdings");b["15"]=new Lo(String.fromCharCode(61692),"Wingdings");b["16"]=
new Lo(String.fromCharCode(61691),"Wingdings");b["17"]=new Lo(String.fromCharCode(61553),"Wingdings");return b}toe(b){b&&b.length&&this.L5e(b)}m2f(){if(this.K9){var b=Jx.a(this.K9),h=b.length;for(let r=0;r<h;r++){const B=this.K9[b[r]];this.Swb.add(B.levelText+"_"+B.font)}}}L5e(b){this.m2f();for(const h of b)if(h&&!h.Lz&&h.Yoa&&h.dTc&&(b=h.levelText+"_"+h.font,!this.Swb.contains(b))){const r=Jx.a(this.K9).length+Jx.a(this.WKb.value).length+"";this.K9[r]=new Lo(h.levelText,h.font);this.Swb.add(b)}}Ugo(){Mn.QQ=
{};Mn.QQ["Symbol 0x00b7"]=Box4Intl.Box4Strings.L_SolidBullet;Mn.QQ["Courier New 0x006f"]=Box4Intl.Box4Strings.L_HollowBullet;Mn.QQ["Wingdings 0x00a7"]=Box4Intl.Box4Strings.L_SmallBlackSquare;Mn.QQ["Courier New 0x25ab"]=Box4Intl.Box4Strings.L_SmallWhiteSquare;Mn.QQ["Wingdings 0x00ab"]=Box4Intl.Box4Strings.L_Star;Mn.QQ["Symbol 0x00ae"]=Box4Intl.Box4Strings.L_RightArrow;Mn.QQ["Symbol 0x002b"]=Box4Intl.Box4Strings.L_PlusSign;Mn.QQ["Symbol 0x002d"]=Box4Intl.Box4Strings.L_Hyphen;Mn.QQ["Courier New 0x2666"]=
Box4Intl.Box4Strings.L_BlackDiamond;Mn.QQ["Symbol 0x00e0"]=Box4Intl.Box4Strings.L_WhiteDiamond;Mn.QQ["Wingdings 0x0076"]=Box4Intl.Box4Strings.L_BlackDiamondWithMinusX;Mn.QQ["Wingdings 0x00d8"]=Box4Intl.Box4Strings.L_3DRightwards;Mn.QQ["Wingdings 0x004a"]=Box4Intl.Box4Strings.L_SmilingFace;Mn.QQ["Wingdings 0x004c"]=Box4Intl.Box4Strings.L_frowningFace;Mn.QQ["Wingdings 0x00fc"]=Box4Intl.Box4Strings.L_CheckMark;Mn.QQ["Wingdings 0x00fb"]=Box4Intl.Box4Strings.L_BallotScriptX;Mn.QQ["Wingdings 0x0071"]=Box4Intl.Box4Strings.L_ShadowedWhiteSquare}}
Mn.QQ=null;Object(m.a)(Mn,"ListMarkerBulletLoader",tw,[]);class zq{constructor(){this.styleAtLevel=this.textAtLevel=null}}Object(m.a)(zq,"InfoAtLevel",null,[]);class Hv{constructor(b){this.YB=b}get font(){return"Calibri"}get listStyle(){return 42}get yw(){return"left"}get Dae(){return this.YB?this.AHn():this.CHn()}get SZc(){return this.YB?this.BHn():null}get levelText(){return""}BYl(b){switch(b){case 1:return"1";case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}AHn(){let b=
"";for(let h=0;3>h;h++)b+=this.HRc(h);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',Hv.Mpf(),b)}BHn(){const b=[];for(let h=0;3>h;h++)b.push(Object.assign(new zq,{textAtLevel:this.mfi(h),styleAtLevel:this.Gfm(h)}));return b}CHn(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',Hv.Npf(),Box4Intl.Box4Strings.L_ListStyleNone)}mfi(b){b=this.YB.TZc[b];for(let h=0;9>h;h++)b=F.a.replaceAll(b,"%"+(h+1),this.BYl(this.YB.ZKb[h]));return b}Gfm(b){const h=
{};h.fontFamily=6===this.YB.ZKb[b]?this.YB.fFa[b]:this.font;return h}HRc(b){const h=this.mfi(b),r=new Sys.StringBuilder;6===this.YB.ZKb[b]&&r.append(String.format("font-family:{0};",this.YB.fFa[b]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',
b,r.toString(),h)}static Mpf(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static Npf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(m.a)(Hv,"ListMarkerMultilevel",null,[513]);var Sz=c(1412);class av extends tw{constructor(){super()}Cbf(){const b=new Sz.a,h={};h["0"]=new Hv(null);h["1"]=new Hv(b.Zaf());h["2"]=new Hv(b.Pbf("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),
[1,2,3,1,2,3,1,2,3]));h["3"]=new Hv(b.ALh([61558,61656,61607,61623,9830,61656,61607,61623,9830],"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";")));return h}toe(){}}Object(m.a)(av,"ListMarkerMultilevelLoader",tw,[]);var hp=c(140);class Sn{constructor(b,h){this.YB=null;this.levelText=b;this.Rqd=h}get font(){return"Calibri"}get listStyle(){return this.Rqd}get yw(){switch(this.Rqd){case 3:case 5:return"right";default:return"left"}}get Dae(){switch(this.Rqd){case 1:return this.yic("1",
"2","3");case 2:return this.yic("a","b","c");case 3:return this.yic("i","ii","iii");case 4:return this.yic("A","B","C");case 5:return this.yic("I","II","III");case 0:return this.DHn();default:return this.yic("1","2","3")}}get SZc(){const b=[],h={};h.fontFamily=hp.FontUtils.cEa(this.font);switch(this.Rqd){case 1:return b.push(Object.assign(new zq,{textAtLevel:this.eY("1"),styleAtLevel:h})),b.push(Object.assign(new zq,{textAtLevel:this.eY("2"),styleAtLevel:h})),b.push(Object.assign(new zq,{textAtLevel:this.eY("3"),
styleAtLevel:h})),b;case 2:return b.push(Object.assign(new zq,{textAtLevel:this.eY("a"),styleAtLevel:h})),b.push(Object.assign(new zq,{textAtLevel:this.eY("b"),styleAtLevel:h})),b.push(Object.assign(new zq,{textAtLevel:this.eY("c"),styleAtLevel:h})),b;case 3:return b.push(Object.assign(new zq,{textAtLevel:this.eY("i"),styleAtLevel:h})),b.push(Object.assign(new zq,{textAtLevel:this.eY("ii"),styleAtLevel:h})),b.push(Object.assign(new zq,{textAtLevel:this.eY("iii"),styleAtLevel:h})),b;case 4:return b.push(Object.assign(new zq,
{textAtLevel:this.eY("A"),styleAtLevel:h})),b.push(Object.assign(new zq,{textAtLevel:this.eY("B"),styleAtLevel:h})),b.push(Object.assign(new zq,{textAtLevel:this.eY("C"),styleAtLevel:h})),b;case 5:return b.push(Object.assign(new zq,{textAtLevel:this.eY("I"),styleAtLevel:h})),b.push(Object.assign(new zq,{textAtLevel:this.eY("II"),styleAtLevel:h})),b.push(Object.assign(new zq,{textAtLevel:this.eY("III"),styleAtLevel:h})),b;case 0:return null;default:return b.push(Object.assign(new zq,{textAtLevel:this.eY("1"),
styleAtLevel:h})),b.push(Object.assign(new zq,{textAtLevel:this.eY("2"),styleAtLevel:h})),b.push(Object.assign(new zq,{textAtLevel:this.eY("3"),styleAtLevel:h})),b}}yic(b,h,r){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',Sn.Mpf(),this.HRc(b),this.HRc(h),this.HRc(r))}DHn(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',Sn.Npf(),Box4Intl.Box4Strings.L_ListStyleNone)}HRc(b){b=this.eY(b);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',
b)}eY(b){return F.a.replaceAll(this.levelText,"%1",b)}static Mpf(){const b=new Sys.StringBuilder;b.append("padding-left: 2pt; ");b.append("font-size: 9pt; ");return b}static Npf(){const b=new Sys.StringBuilder;b.append("text-align: center; ");b.append("margin-top: 22%; ");b.append("font-size: 12pt; ");return b}}Object(m.a)(Sn,"ListMarkerNumbering",null,[513]);class Iv extends tw{constructor(){super();this.Swb=new De.a(Pa.a.ih())}XUm(b){b=b.match(RegExp("%[1-9]","g"));return!!b&&1===b.length}Cbf(){const b=
{};b["0"]=new Sn(Box4Intl.Box4Strings.L_ListStyleNone,0);b["1"]=new Sn("%1.",5);b["2"]=new Sn("%1.",4);b["3"]=new Sn("%1.",1);b["4"]=new Sn("%1.",2);b["5"]=new Sn("%1.",3);b["6"]=new Sn("%1)",5);b["7"]=new Sn("%1)",4);b["8"]=new Sn("%1)",1);b["9"]=new Sn("%1)",2);b["10"]=new Sn("%1)",3);b["11"]=new Sn("(%1)",5);b["12"]=new Sn("(%1)",4);b["13"]=new Sn("(%1)",1);b["14"]=new Sn("(%1)",2);b["15"]=new Sn("(%1)",3);return b}toe(b){b&&b.length&&this.L5e(b)}m2f(){if(this.K9){var b=Jx.a(this.K9),h=b.length;
for(let r=0;r<h;r++){const B=this.K9[b[r]];this.Swb.add(B.levelText+"_"+B.listStyle)}}}L5e(b){this.m2f();for(const h of b)if(h&&h.Lz&&h.Yoa&&this.XUm(h.levelText)&&h.listStyle&&(b=zt.a.mnf(h.levelText))){const r=b+"_"+h.listStyle;if(!this.Swb.contains(r)){const B=Jx.a(this.K9).length+Jx.a(this.WKb.value).length+"";this.K9[B]=new Sn(b,h.listStyle)}this.Swb.add(r)}}}Object(m.a)(Iv,"ListMarkerNumberingLoader",tw,[]);class ay{constructor(){this.W=null}get name(){return"Box4.ListMarker"}init(){wi.Tb()}dispose(){}wc(b){this.W=
b;this.W.ia("Box4.ListMarkerGallery.ListMarkerBulletLoader",()=>new Mn).ha();this.W.ia("Box4.ListMarkerGallery.ListMarkerNumberingLoader",()=>new Iv).ha();this.W.ia("Box4.ListMarkerGallery.ListMarkerMultilevelLoader",()=>new av).ha()}static main(){L.a.instance.Gc(new ay)}}Object(m.a)(ay,"Box4ListMarkerPackage",null,[1,2]);class ss{static get Vg(){return Pe.a.Kx(ss.Xm,Box4Intl.Box4Strings.L_DefineNewBulletFont,Box4Intl.Box4Strings.L_DefineNewBulletCharacterCode,"")}}ss.Xm="<div class='DefineNewBulletDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='DefineNewBulletFontPlaceholder'></div> </div> <div class='normal' id='ListMarkerTable'> <div id='DefineNewBulletTableContainer' class='DefineNewBulletTableContainer' style='height: 195px; overflow-x: hidden; overflow-y: scroll;'></div> </div> <div class='WACDialogRow' id='CharacterCode'> <label id='CharacterCodeLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogRow' id='CharacterCodeValue'> <label id='CharacterCodeValueLabel' class='WACDialogLabel' >{2}</label> </div>";
Object(m.a)(ss,"DefineNewBulletDialogHtml",null,[]);class ir extends Pe.a{constructor(b,h,r,B){super();this.Gyc=this.PJe=this.TYb=this.MYb=null;this.yxb=0;this.cHc=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];this.Pri=!0;this.Hjl=P=>{if(this.MYb&&P.target!==this.MYb){const ca=this.focusManager.at();ca&&ca.hk&&(ca.hk.gz(P.target),this.MYb=P.target)}this.gun(P.target.id)};this.M1m=P=>{P=P.yf;if(!this.FEi(P))return!1;this.focusManager.at().hk.gz(P);P.focus();return!0};this.N1m=P=>{var ca=
P.yf;if(!this.FEi(ca))return!1;var ra=ca.id;ra=parseInt(ra.substr(ra.lastIndexOf("_")+1))-this.yxb;if(P.Hb.ctrlKey||P.Hb.altKey||P.Hb.keyCode>=se.a.eUb&&P.Hb.keyCode<=se.a.fUb)return!1;const Qa=P.Hb.keyCode;if(P.eventName===pd.a.gi){P=-1;if(Qa===Sys.UI.Key.enter)return this.focusManager.at().hk.gz(ca),ca.focus(),this.XVi(ca.id),this.hide(),!0;Qa===Sys.UI.Key.up?P=ra-17:Qa===Sys.UI.Key.down?P=ra+17:Qa===Sys.UI.Key.left?P=v.AFrameworkApplication.isRtl?ra+1:ra-1:Qa===Sys.UI.Key.right&&(P=v.AFrameworkApplication.isRtl?
ra-1:ra+1);0<=P&&(ca=this.Zbi(ir.J6b+"_"+(P+this.yxb)))&&ca.focus()}return!0};this.Gjl=P=>{1===P&&this.XVi(this.TYb);this.hide()};this.Gu=b;this.focusManager=h;this.ga=r;this.XS=!1;B&&(b=B.indexOf(","),-1!==b&&(B=B.substring(0,b)));this.fontName=B;this.yg="DefineNewBulletDialog";this.Vg=ss.Vg;this.ze(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.ze(0,CommonUIStrings.l_DialogClose);this.Uh(Box4Intl.Box4Strings.L_SymbolSingle,this.Gjl,null);this.Faa=!1;this.jIa();document.getElementById(ir.pPd).focus()}jIa(){this.focusManager.at().scope.nr(pc.FocusManager.instance().WW);
this.focusManager.at().scope.nr(pc.FocusManager.instance().XW);this.focusManager.at().scope.bindAction(pc.FocusManager.instance().WW,Nb.a.HKd);this.focusManager.at().scope.bindAction(pc.FocusManager.instance().XW,Nb.a.GKd)}V9(){this.FEd(ir.pPd,"DefineNewBulletFontPlaceholder",Nb.a.FKd.toString(),Nb.a.nOb.toString(),Nb.a.$3c.toString(),Box4Intl.Box4Strings.L_FontName,"100px");this.zNk()}KL(){super.KL();document.getElementById(this.qj("WACDialogPanel")).style.width="auto"}FEd(b,h,r,B,P,ca,ra){r=mi.c(b,
r,!0,!0,B,P,F.a.zf(ca),!0,ra);this.kJd(b,h,r,"Medium")}zNk(){const b=document.getElementById(ir.J6b);b&&(b.innerHTML=this.O8h(),this.N9i(b))}N9i(b){if(b=b.getElementsByClassName("DefineNewBulletTableCell"))for(let h=0;h<b.length;h++)He.a.addHandler(b[h],pd.a.focus,this.Hjl)}nWo(){var b=document.getElementById(ir.J6b);if(b){let h=this.fontName;const r=zt.a.xDf(this.fontName);r&&61472!==this.yxb||!r&&32!==this.yxb?(b.innerHTML=this.O8h(),this.N9i(b)):(b=b.getElementsByTagName("table"))&&1===b.length&&
h&&(h=this.Fph(h),b[0].style.fontFamily=h)}}gun(b){this.Jmj(this.TYb,!1);this.TYb=b;this.Jmj(b,!0);if((b=document.getElementById("CharacterCodeValueLabel"))&&this.TYb){let h=parseInt(this.TYb.substr(this.TYb.lastIndexOf("_")+1));-1!==h&&(h-=61472===this.yxb?61440:0,b.innerText=F.a.iJ(h,4))}}Jmj(b,h){(b=this.Zbi(b))&&(h?b.setAttribute("selected","true"):b.removeAttribute("selected"))}Zbi(b){const h=document.getElementById(ir.J6b);return h?h.querySelector("#"+b):null}cna(){const b=document.getElementById(ir.J6b);
b&&(this.PJe||(this.PJe=this.M1m,this.Qq.ob(pd.a.click,b,this.PJe)),this.Gyc||(this.Gyc=this.N1m,this.ge.ob(pd.a.gi,b,this.Gyc),this.ge.ob(pd.a.ru,b,this.Gyc),this.ge.ob(pd.a.yh,b,this.Gyc)));super.cna()}FEi(b){return b.classList.contains("DefineNewBulletTableCell")}XVi(b){if(b){b=b.split("_");const h=new fd.DictionaryPropertySet;h.setValue(Yc.a.OJ,parseInt(b[1]));h.setValue(Pd.a.font,this.fontName);h.setValue(Yc.a.MA,1);Ym.a.DY&&(h.setValue(lh.a.cqa,"command-ui"),h.setValue(lh.a.Jia,"define-new-bullet-dialog"));
this.ga.Qb(Nb.a.rD,2,h)}this.focusManager.EL(this.gL,!0)}O8h(){const b=new Sys.StringBuilder,h=zt.a.xDf(this.fontName);let r=this.fontName;r=this.Fph(r);b.append(String.format('<table class="DefineNewBulletTable" style="font-family: {0};">',r));h?(this.yxb=61472,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61472" title="0x0020" tabindex="0">\uf020</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61473" title="0x0021" tabindex="0">\uf021</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61474" title="0x0022" tabindex="0">\uf022</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61475" title="0x0023" tabindex="0">\uf023</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61476" title="0x0024" tabindex="0">\uf024</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61477" title="0x0025" tabindex="0">\uf025</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61478" title="0x0026" tabindex="0">\uf026</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61479" title="0x0027" tabindex="0">\uf027</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61480" title="0x0028" tabindex="0">\uf028</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61481" title="0x0029" tabindex="0">\uf029</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61482" title="0x002a" tabindex="0">\uf02a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61483" title="0x002b" tabindex="0">\uf02b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61484" title="0x002c" tabindex="0">\uf02c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61485" title="0x002d" tabindex="0">\uf02d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61486" title="0x002e" tabindex="0">\uf02e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61487" title="0x002f" tabindex="0">\uf02f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61488" title="0x0030" tabindex="0">\uf030</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61489" title="0x0031" tabindex="0">\uf031</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61490" title="0x0032" tabindex="0">\uf032</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61491" title="0x0033" tabindex="0">\uf033</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61492" title="0x0034" tabindex="0">\uf034</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61493" title="0x0035" tabindex="0">\uf035</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61494" title="0x0036" tabindex="0">\uf036</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61495" title="0x0037" tabindex="0">\uf037</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61496" title="0x0038" tabindex="0">\uf038</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61497" title="0x0039" tabindex="0">\uf039</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61498" title="0x003a" tabindex="0">\uf03a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61499" title="0x003b" tabindex="0">\uf03b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61500" title="0x003c" tabindex="0">\uf03c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61501" title="0x003d" tabindex="0">\uf03d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61502" title="0x003e" tabindex="0">\uf03e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61503" title="0x003f" tabindex="0">\uf03f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61504" title="0x0040" tabindex="0">\uf040</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61505" title="0x0041" tabindex="0">\uf041</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61506" title="0x0042" tabindex="0">\uf042</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61507" title="0x0043" tabindex="0">\uf043</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61508" title="0x0044" tabindex="0">\uf044</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61509" title="0x0045" tabindex="0">\uf045</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61510" title="0x0046" tabindex="0">\uf046</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61511" title="0x0047" tabindex="0">\uf047</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61512" title="0x0048" tabindex="0">\uf048</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61513" title="0x0049" tabindex="0">\uf049</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61514" title="0x004a" tabindex="0">\uf04a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61515" title="0x004b" tabindex="0">\uf04b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61516" title="0x004c" tabindex="0">\uf04c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61517" title="0x004d" tabindex="0">\uf04d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61518" title="0x004e" tabindex="0">\uf04e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61519" title="0x004f" tabindex="0">\uf04f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61520" title="0x0050" tabindex="0">\uf050</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61521" title="0x0051" tabindex="0">\uf051</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61522" title="0x0052" tabindex="0">\uf052</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61523" title="0x0053" tabindex="0">\uf053</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61524" title="0x0054" tabindex="0">\uf054</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61525" title="0x0055" tabindex="0">\uf055</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61526" title="0x0056" tabindex="0">\uf056</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61527" title="0x0057" tabindex="0">\uf057</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61528" title="0x0058" tabindex="0">\uf058</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61529" title="0x0059" tabindex="0">\uf059</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61530" title="0x005a" tabindex="0">\uf05a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61531" title="0x005b" tabindex="0">\uf05b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61532" title="0x005c" tabindex="0">\uf05c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61533" title="0x005d" tabindex="0">\uf05d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61534" title="0x005e" tabindex="0">\uf05e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61535" title="0x005f" tabindex="0">\uf05f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61536" title="0x0060" tabindex="0">\uf060</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61537" title="0x0061" tabindex="0">\uf061</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61538" title="0x0062" tabindex="0">\uf062</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61539" title="0x0063" tabindex="0">\uf063</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61540" title="0x0064" tabindex="0">\uf064</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61541" title="0x0065" tabindex="0">\uf065</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61542" title="0x0066" tabindex="0">\uf066</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61543" title="0x0067" tabindex="0">\uf067</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61544" title="0x0068" tabindex="0">\uf068</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61545" title="0x0069" tabindex="0">\uf069</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61546" title="0x006a" tabindex="0">\uf06a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61547" title="0x006b" tabindex="0">\uf06b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61548" title="0x006c" tabindex="0">\uf06c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61549" title="0x006d" tabindex="0">\uf06d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61550" title="0x006e" tabindex="0">\uf06e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61551" title="0x006f" tabindex="0">\uf06f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61552" title="0x0070" tabindex="0">\uf070</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61553" title="0x0071" tabindex="0">\uf071</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61554" title="0x0072" tabindex="0">\uf072</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61555" title="0x0073" tabindex="0">\uf073</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61556" title="0x0074" tabindex="0">\uf074</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61557" title="0x0075" tabindex="0">\uf075</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61558" title="0x0076" tabindex="0">\uf076</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61559" title="0x0077" tabindex="0">\uf077</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61560" title="0x0078" tabindex="0">\uf078</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61561" title="0x0079" tabindex="0">\uf079</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61562" title="0x007a" tabindex="0">\uf07a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61563" title="0x007b" tabindex="0">\uf07b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61564" title="0x007c" tabindex="0">\uf07c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61565" title="0x007d" tabindex="0">\uf07d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61566" title="0x007e" tabindex="0">\uf07e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61567" title="0x007f" tabindex="0">\uf07f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61568" title="0x0080" tabindex="0">\uf080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61569" title="0x0081" tabindex="0">\uf081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61570" title="0x0082" tabindex="0">\uf082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61571" title="0x0083" tabindex="0">\uf083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61572" title="0x0084" tabindex="0">\uf084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61573" title="0x0085" tabindex="0">\uf085</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61574" title="0x0086" tabindex="0">\uf086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61575" title="0x0087" tabindex="0">\uf087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61576" title="0x0088" tabindex="0">\uf088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61577" title="0x0089" tabindex="0">\uf089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61578" title="0x008a" tabindex="0">\uf08a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61579" title="0x008b" tabindex="0">\uf08b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61580" title="0x008c" tabindex="0">\uf08c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61581" title="0x008d" tabindex="0">\uf08d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61582" title="0x008e" tabindex="0">\uf08e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61583" title="0x008f" tabindex="0">\uf08f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61584" title="0x0090" tabindex="0">\uf090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61585" title="0x0091" tabindex="0">\uf091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61586" title="0x0092" tabindex="0">\uf092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61587" title="0x0093" tabindex="0">\uf093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61588" title="0x0094" tabindex="0">\uf094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61589" title="0x0095" tabindex="0">\uf095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61590" title="0x0096" tabindex="0">\uf096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61591" title="0x0097" tabindex="0">\uf097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61592" title="0x0098" tabindex="0">\uf098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61593" title="0x0099" tabindex="0">\uf099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61594" title="0x009a" tabindex="0">\uf09a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61595" title="0x009b" tabindex="0">\uf09b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61596" title="0x009c" tabindex="0">\uf09c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61597" title="0x009d" tabindex="0">\uf09d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61598" title="0x009e" tabindex="0">\uf09e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61599" title="0x009f" tabindex="0">\uf09f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61600" title="0x00a0" tabindex="0">\uf0a0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61601" title="0x00a1" tabindex="0">\uf0a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61602" title="0x00a2" tabindex="0">\uf0a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61603" title="0x00a3" tabindex="0">\uf0a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61604" title="0x00a4" tabindex="0">\uf0a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61605" title="0x00a5" tabindex="0">\uf0a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61606" title="0x00a6" tabindex="0">\uf0a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61607" title="0x00a7" tabindex="0">\uf0a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61608" title="0x00a8" tabindex="0">\uf0a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61609" title="0x00a9" tabindex="0">\uf0a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61610" title="0x00aa" tabindex="0">\uf0aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61611" title="0x00ab" tabindex="0">\uf0ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61612" title="0x00ac" tabindex="0">\uf0ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61613" title="0x00ad" tabindex="0">\uf0ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61614" title="0x00ae" tabindex="0">\uf0ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61615" title="0x00af" tabindex="0">\uf0af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61616" title="0x00b0" tabindex="0">\uf0b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61617" title="0x00b1" tabindex="0">\uf0b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61618" title="0x00b2" tabindex="0">\uf0b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61619" title="0x00b3" tabindex="0">\uf0b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61620" title="0x00b4" tabindex="0">\uf0b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61621" title="0x00b5" tabindex="0">\uf0b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61622" title="0x00b6" tabindex="0">\uf0b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61623" title="0x00b7" tabindex="0">\uf0b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61624" title="0x00b8" tabindex="0">\uf0b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61625" title="0x00b9" tabindex="0">\uf0b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61626" title="0x00ba" tabindex="0">\uf0ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61627" title="0x00bb" tabindex="0">\uf0bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61628" title="0x00bc" tabindex="0">\uf0bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61629" title="0x00bd" tabindex="0">\uf0bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61630" title="0x00be" tabindex="0">\uf0be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61631" title="0x00bf" tabindex="0">\uf0bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61632" title="0x00c0" tabindex="0">\uf0c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61633" title="0x00c1" tabindex="0">\uf0c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61634" title="0x00c2" tabindex="0">\uf0c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61635" title="0x00c3" tabindex="0">\uf0c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61636" title="0x00c4" tabindex="0">\uf0c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61637" title="0x00c5" tabindex="0">\uf0c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61638" title="0x00c6" tabindex="0">\uf0c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61639" title="0x00c7" tabindex="0">\uf0c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61640" title="0x00c8" tabindex="0">\uf0c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61641" title="0x00c9" tabindex="0">\uf0c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61642" title="0x00ca" tabindex="0">\uf0ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61643" title="0x00cb" tabindex="0">\uf0cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61644" title="0x00cc" tabindex="0">\uf0cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61645" title="0x00cd" tabindex="0">\uf0cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61646" title="0x00ce" tabindex="0">\uf0ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61647" title="0x00cf" tabindex="0">\uf0cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61648" title="0x00d0" tabindex="0">\uf0d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61649" title="0x00d1" tabindex="0">\uf0d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61650" title="0x00d2" tabindex="0">\uf0d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61651" title="0x00d3" tabindex="0">\uf0d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61652" title="0x00d4" tabindex="0">\uf0d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61653" title="0x00d5" tabindex="0">\uf0d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61654" title="0x00d6" tabindex="0">\uf0d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61655" title="0x00d7" tabindex="0">\uf0d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61656" title="0x00d8" tabindex="0">\uf0d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61657" title="0x00d9" tabindex="0">\uf0d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61658" title="0x00da" tabindex="0">\uf0da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61659" title="0x00db" tabindex="0">\uf0db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61660" title="0x00dc" tabindex="0">\uf0dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61661" title="0x00dd" tabindex="0">\uf0dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61662" title="0x00de" tabindex="0">\uf0de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61663" title="0x00df" tabindex="0">\uf0df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61664" title="0x00e0" tabindex="0">\uf0e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61665" title="0x00e1" tabindex="0">\uf0e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61666" title="0x00e2" tabindex="0">\uf0e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61667" title="0x00e3" tabindex="0">\uf0e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61668" title="0x00e4" tabindex="0">\uf0e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61669" title="0x00e5" tabindex="0">\uf0e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61670" title="0x00e6" tabindex="0">\uf0e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61671" title="0x00e7" tabindex="0">\uf0e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61672" title="0x00e8" tabindex="0">\uf0e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61673" title="0x00e9" tabindex="0">\uf0e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61674" title="0x00ea" tabindex="0">\uf0ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61675" title="0x00eb" tabindex="0">\uf0eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61676" title="0x00ec" tabindex="0">\uf0ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61677" title="0x00ed" tabindex="0">\uf0ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61678" title="0x00ee" tabindex="0">\uf0ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61679" title="0x00ef" tabindex="0">\uf0ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61680" title="0x00f0" tabindex="0">\uf0f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61681" title="0x00f1" tabindex="0">\uf0f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61682" title="0x00f2" tabindex="0">\uf0f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61683" title="0x00f3" tabindex="0">\uf0f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61684" title="0x00f4" tabindex="0">\uf0f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61685" title="0x00f5" tabindex="0">\uf0f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61686" title="0x00f6" tabindex="0">\uf0f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61687" title="0x00f7" tabindex="0">\uf0f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61688" title="0x00f8" tabindex="0">\uf0f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61689" title="0x00f9" tabindex="0">\uf0f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61690" title="0x00fa" tabindex="0">\uf0fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61691" title="0x00fb" tabindex="0">\uf0fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61692" title="0x00fc" tabindex="0">\uf0fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61693" title="0x00fd" tabindex="0">\uf0fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61694" title="0x00fe" tabindex="0">\uf0fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61695" title="0x00ff" tabindex="0">\uf0ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>')):
(this.yxb=32,b.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_32" title="0x0020" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_33" title="0x0021" tabindex="0">!</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_34" title="0x0022" tabindex="0">"</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_35" title="0x0023" tabindex="0">#</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_36" title="0x0024" tabindex="0">$</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_37" title="0x0025" tabindex="0">%</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_38" title="0x0026" tabindex="0">&amp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_39" title="0x0027" tabindex="0">\'</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_40" title="0x0028" tabindex="0">(</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_41" title="0x0029" tabindex="0">)</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_42" title="0x002a" tabindex="0">*</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_43" title="0x002b" tabindex="0">+</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_44" title="0x002c" tabindex="0">,</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_45" title="0x002d" tabindex="0">-</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_46" title="0x002e" tabindex="0">.</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_47" title="0x002f" tabindex="0">/</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_48" title="0x0030" tabindex="0">0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_49" title="0x0031" tabindex="0">1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_50" title="0x0032" tabindex="0">2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_51" title="0x0033" tabindex="0">3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_52" title="0x0034" tabindex="0">4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_53" title="0x0035" tabindex="0">5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_54" title="0x0036" tabindex="0">6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_55" title="0x0037" tabindex="0">7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_56" title="0x0038" tabindex="0">8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_57" title="0x0039" tabindex="0">9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_58" title="0x003a" tabindex="0">:</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_59" title="0x003b" tabindex="0">;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_60" title="0x003c" tabindex="0">&lt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61" title="0x003d" tabindex="0">=</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_62" title="0x003e" tabindex="0">&gt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_63" title="0x003f" tabindex="0">?</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_64" title="0x0040" tabindex="0">@</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_65" title="0x0041" tabindex="0">A</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_66" title="0x0042" tabindex="0">B</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_67" title="0x0043" tabindex="0">C</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_68" title="0x0044" tabindex="0">D</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_69" title="0x0045" tabindex="0">E</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_70" title="0x0046" tabindex="0">F</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_71" title="0x0047" tabindex="0">G</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_72" title="0x0048" tabindex="0">H</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_73" title="0x0049" tabindex="0">I</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_74" title="0x004a" tabindex="0">J</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_75" title="0x004b" tabindex="0">K</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_76" title="0x004c" tabindex="0">L</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_77" title="0x004d" tabindex="0">M</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_78" title="0x004e" tabindex="0">N</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_79" title="0x004f" tabindex="0">O</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_80" title="0x0050" tabindex="0">P</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_81" title="0x0051" tabindex="0">Q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_82" title="0x0052" tabindex="0">R</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_83" title="0x0053" tabindex="0">S</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_84" title="0x0054" tabindex="0">T</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_85" title="0x0055" tabindex="0">U</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_86" title="0x0056" tabindex="0">V</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_87" title="0x0057" tabindex="0">W</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_88" title="0x0058" tabindex="0">X</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_89" title="0x0059" tabindex="0">Y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_90" title="0x005a" tabindex="0">Z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_91" title="0x005b" tabindex="0">[</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_92" title="0x005c" tabindex="0">\\</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_93" title="0x005d" tabindex="0">]</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_94" title="0x005e" tabindex="0">^</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_95" title="0x005f" tabindex="0">_</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_96" title="0x0060" tabindex="0">`</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_97" title="0x0061" tabindex="0">a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_98" title="0x0062" tabindex="0">b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_99" title="0x0063" tabindex="0">c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_100" title="0x0064" tabindex="0">d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_101" title="0x0065" tabindex="0">e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_102" title="0x0066" tabindex="0">f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_103" title="0x0067" tabindex="0">g</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_104" title="0x0068" tabindex="0">h</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_105" title="0x0069" tabindex="0">i</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_106" title="0x006a" tabindex="0">j</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_107" title="0x006b" tabindex="0">k</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_108" title="0x006c" tabindex="0">l</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_109" title="0x006d" tabindex="0">m</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_110" title="0x006e" tabindex="0">n</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_111" title="0x006f" tabindex="0">o</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_112" title="0x0070" tabindex="0">p</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_113" title="0x0071" tabindex="0">q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_114" title="0x0072" tabindex="0">r</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_115" title="0x0073" tabindex="0">s</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_116" title="0x0074" tabindex="0">t</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_117" title="0x0075" tabindex="0">u</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_118" title="0x0076" tabindex="0">v</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_119" title="0x0077" tabindex="0">w</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_120" title="0x0078" tabindex="0">x</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_121" title="0x0079" tabindex="0">y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_122" title="0x007a" tabindex="0">z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_123" title="0x007b" tabindex="0">{</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_124" title="0x007c" tabindex="0">|</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_125" title="0x007d" tabindex="0">}</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_126" title="0x007e" tabindex="0">~</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_127" title="0x007f" tabindex="0">\u007f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_128" title="0x0080" tabindex="0">\u0080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_129" title="0x0081" tabindex="0">\u0081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_130" title="0x0082" tabindex="0">\u0082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_131" title="0x0083" tabindex="0">\u0083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_132" title="0x0084" tabindex="0">\u0084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_133" title="0x0085" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_134" title="0x0086" tabindex="0">\u0086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_135" title="0x0087" tabindex="0">\u0087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_136" title="0x0088" tabindex="0">\u0088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_137" title="0x0089" tabindex="0">\u0089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_138" title="0x008a" tabindex="0">\u008a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_139" title="0x008b" tabindex="0">\u008b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_140" title="0x008c" tabindex="0">\u008c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_141" title="0x008d" tabindex="0">\u008d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_142" title="0x008e" tabindex="0">\u008e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_143" title="0x008f" tabindex="0">\u008f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_144" title="0x0090" tabindex="0">\u0090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_145" title="0x0091" tabindex="0">\u0091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_146" title="0x0092" tabindex="0">\u0092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_147" title="0x0093" tabindex="0">\u0093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_148" title="0x0094" tabindex="0">\u0094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_149" title="0x0095" tabindex="0">\u0095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_150" title="0x0096" tabindex="0">\u0096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_151" title="0x0097" tabindex="0">\u0097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_152" title="0x0098" tabindex="0">\u0098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_153" title="0x0099" tabindex="0">\u0099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_154" title="0x009a" tabindex="0">\u009a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_155" title="0x009b" tabindex="0">\u009b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_156" title="0x009c" tabindex="0">\u009c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_157" title="0x009d" tabindex="0">\u009d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_158" title="0x009e" tabindex="0">\u009e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_159" title="0x009f" tabindex="0">\u009f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_160" title="0x00a0" tabindex="0">&nbsp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_161" title="0x00a1" tabindex="0">\u00a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_162" title="0x00a2" tabindex="0">\u00a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_163" title="0x00a3" tabindex="0">\u00a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_164" title="0x00a4" tabindex="0">\u00a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_165" title="0x00a5" tabindex="0">\u00a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_166" title="0x00a6" tabindex="0">\u00a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_167" title="0x00a7" tabindex="0">\u00a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_168" title="0x00a8" tabindex="0">\u00a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_169" title="0x00a9" tabindex="0">\u00a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_170" title="0x00aa" tabindex="0">\u00aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_171" title="0x00ab" tabindex="0">\u00ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_172" title="0x00ac" tabindex="0">\u00ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_173" title="0x00ad" tabindex="0">\u00ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_174" title="0x00ae" tabindex="0">\u00ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_175" title="0x00af" tabindex="0">\u00af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_176" title="0x00b0" tabindex="0">\u00b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_177" title="0x00b1" tabindex="0">\u00b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_178" title="0x00b2" tabindex="0">\u00b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_179" title="0x00b3" tabindex="0">\u00b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_180" title="0x00b4" tabindex="0">\u00b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_181" title="0x00b5" tabindex="0">\u00b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_182" title="0x00b6" tabindex="0">\u00b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_183" title="0x00b7" tabindex="0">\u00b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_184" title="0x00b8" tabindex="0">\u00b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_185" title="0x00b9" tabindex="0">\u00b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_186" title="0x00ba" tabindex="0">\u00ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_187" title="0x00bb" tabindex="0">\u00bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_188" title="0x00bc" tabindex="0">\u00bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_189" title="0x00bd" tabindex="0">\u00bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_190" title="0x00be" tabindex="0">\u00be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_191" title="0x00bf" tabindex="0">\u00bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_192" title="0x00c0" tabindex="0">\u00c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_193" title="0x00c1" tabindex="0">\u00c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_194" title="0x00c2" tabindex="0">\u00c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_195" title="0x00c3" tabindex="0">\u00c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_196" title="0x00c4" tabindex="0">\u00c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_197" title="0x00c5" tabindex="0">\u00c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_198" title="0x00c6" tabindex="0">\u00c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_199" title="0x00c7" tabindex="0">\u00c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_200" title="0x00c8" tabindex="0">\u00c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_201" title="0x00c9" tabindex="0">\u00c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_202" title="0x00ca" tabindex="0">\u00ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_203" title="0x00cb" tabindex="0">\u00cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_204" title="0x00cc" tabindex="0">\u00cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_205" title="0x00cd" tabindex="0">\u00cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_206" title="0x00ce" tabindex="0">\u00ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_207" title="0x00cf" tabindex="0">\u00cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_208" title="0x00d0" tabindex="0">\u00d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_209" title="0x00d1" tabindex="0">\u00d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_210" title="0x00d2" tabindex="0">\u00d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_211" title="0x00d3" tabindex="0">\u00d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_212" title="0x00d4" tabindex="0">\u00d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_213" title="0x00d5" tabindex="0">\u00d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_214" title="0x00d6" tabindex="0">\u00d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_215" title="0x00d7" tabindex="0">\u00d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_216" title="0x00d8" tabindex="0">\u00d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_217" title="0x00d9" tabindex="0">\u00d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_218" title="0x00da" tabindex="0">\u00da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_219" title="0x00db" tabindex="0">\u00db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_220" title="0x00dc" tabindex="0">\u00dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_221" title="0x00dd" tabindex="0">\u00dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_222" title="0x00de" tabindex="0">\u00de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_223" title="0x00df" tabindex="0">\u00df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_224" title="0x00e0" tabindex="0">\u00e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_225" title="0x00e1" tabindex="0">\u00e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_226" title="0x00e2" tabindex="0">\u00e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_227" title="0x00e3" tabindex="0">\u00e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_228" title="0x00e4" tabindex="0">\u00e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_229" title="0x00e5" tabindex="0">\u00e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_230" title="0x00e6" tabindex="0">\u00e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_231" title="0x00e7" tabindex="0">\u00e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_232" title="0x00e8" tabindex="0">\u00e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_233" title="0x00e9" tabindex="0">\u00e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_234" title="0x00ea" tabindex="0">\u00ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_235" title="0x00eb" tabindex="0">\u00eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_236" title="0x00ec" tabindex="0">\u00ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_237" title="0x00ed" tabindex="0">\u00ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_238" title="0x00ee" tabindex="0">\u00ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_239" title="0x00ef" tabindex="0">\u00ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_240" title="0x00f0" tabindex="0">\u00f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_241" title="0x00f1" tabindex="0">\u00f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_242" title="0x00f2" tabindex="0">\u00f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_243" title="0x00f3" tabindex="0">\u00f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_244" title="0x00f4" tabindex="0">\u00f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_245" title="0x00f5" tabindex="0">\u00f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_246" title="0x00f6" tabindex="0">\u00f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_247" title="0x00f7" tabindex="0">\u00f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_248" title="0x00f8" tabindex="0">\u00f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_249" title="0x00f9" tabindex="0">\u00f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_250" title="0x00fa" tabindex="0">\u00fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_251" title="0x00fb" tabindex="0">\u00fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_252" title="0x00fc" tabindex="0">\u00fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_253" title="0x00fd" tabindex="0">\u00fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_254" title="0x00fe" tabindex="0">\u00fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_255" title="0x00ff" tabindex="0">\u00ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>'));
b.append("</table>");return b.toString()}Fph(b){b&&-1!==b.indexOf(" ")&&(b="'"+b+"'");return b}kJd(b,h,r,B){h=document.getElementById(h);this.Gu.t_a(b,r);r=this.Gu.ZFb(b,B);h.appendChild(r);this.Gu.Pqa(b)}dispose(){this.XS||(this.Gu.gZ(ir.pPd),this.XS=!0);super.dispose()}}ir.pPd="DefineNewBulletFontStyleComboBox";ir.J6b="DefineNewBulletTableContainer";Object(m.a)(ir,"DefineNewBulletDialog",Pe.a,[]);class $w{eRc(){return Nb.a.I1m}GRc(){return Nb.a.I1f}}Object(m.a)($w,"ListMarkerGalleryBulletCommands",
null,[514]);class bv{eRc(){return Nb.a.K1m}GRc(){return Nb.a.IEn}}Object(m.a)(bv,"ListMarkerGalleryMultilevelCommands",null,[514]);class az{eRc(){return Nb.a.L1m}GRc(){return Nb.a.J1f}}Object(m.a)(az,"ListMarkerGalleryNumberingCommands",null,[514]);class wu{constructor(b,h,r,B,P){this.jBa=this.qMa=null;this.VQh=ca=>{if(!this.jBa)return 2;if(this.jBa.focusManager.at().hk.l4.id.startsWith(ir.J6b)){let ra=null;ca===Nb.a.HKd?ra=this.jBa.X_a:ca===Nb.a.GKd&&(ra=document.getElementById(ir.pPd));if(!ra)return 2;
this.jBa.focusManager.at().hk.gz(ra);ra.focus()}else if(ca===Nb.a.HKd)this.jBa.focusManager.at().egc();else if(ca===Nb.a.GKd)this.jBa.focusManager.at().cgc();else return 2;return 32};this.AHi=(ca,ra)=>{ca=null;ra.view.ue&&(ca=ra.view);return ca&&ca.mb?32:(Qc.b(17887427,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",ra.toString()),8)};this.C_m=(ca,ra,Qa)=>{var tb;return 1===Qa?32:2===Qa?((null===(tb=v.AFrameworkApplication.K)||
void 0===tb?0:tb.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&Zu.a.instance.h7a("ListDefine"),ca=this.Q$b(ra),ca=pn.FormattingReader.Yr(ca).cache.FG,this.jBa=new ir(this.Skk,pc.FocusManager.instance(),v.AFrameworkApplication.va,ca),32):8};this.$3c=(ca,ra,Qa,tb,Mb)=>{if(1===Qa)return 32;if(2===Qa&&!Mb)return 8;if(this.jBa.Pri){for(ca=0;ca<zt.a.cHc.length;ca++)hp.FontUtils.rDj(zt.a.cHc[ca]);this.jBa.Pri=!1}Am.a.OXd(ra);Mb.PopulationXML=hp.FontUtils.c4h(Am.a.Gie,Am.a.Mmf,
Nb.a.FKd);return 32};this.HEn=(ca,ra,Qa,tb,Mb)=>{ca=ra.contextId===yc.a.LP;if(1===Qa||!ca)return ca?32:8;if(2===Qa&&!Mb)return 8;Mb.MenuItems=this.hak.v3l();return 32};this.Fjl=(ca,ra,Qa,tb,Mb)=>{if(1===Qa)return 32;if(2===Qa){ca=Object(Ra.a)(24,Mb);if(!ca||!ca.vd)return 8;this.jBa.fontName=ca.vd.fontName;this.jBa.nWo();return 32}return 8};this.ga=b;this.Hf=B.resolve("Box4.List.IListReader");this.s7=h;this.Skk=r;switch(this.s7){case 0:b=B.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader");this.qMa=
new $w;break;case 1:b=B.resolve("Box4.ListMarkerGallery.ListMarkerNumberingLoader");this.qMa=new az;break;case 2:b=B.resolve("Box4.ListMarkerGallery.ListMarkerMultilevelLoader");this.qMa=new bv;break;default:b=B.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader"),this.qMa=new $w}P=this.Hf?this.Hf.i3l(P):null;b.toe(P);this.hak=new zt.a(h,b,P,!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.UJb)}Tb(){this.ga.ra(this.qMa.GRc(),yc.a.view,Eb.App.lVa.TLh(11));this.ga.ra(this.qMa.GRc(),yc.a.LP,
this.HEn);this.ga.Xc(this.qMa.GRc(),1124);this.s7||(this.ga.fb(Nb.a.rKf,yc.a.view,this.C_m,1028),this.ga.fb(Nb.a.$3c,yc.a.view,this.$3c,1124),this.ga.fb(Nb.a.FKd,yc.a.view,this.Fjl,1028),this.ga.fb(Nb.a.HKd,yd.a.frame,this.VQh,64),this.ga.fb(Nb.a.GKd,yd.a.frame,this.VQh,64));this.ga.ra(this.qMa.eRc(),yc.a.view,this.AHi);this.ga.ra(this.qMa.eRc(),yc.a.LP,this.AHi);this.ga.Xc(this.qMa.eRc(),1124)}Q$b(b){return this.MQd(b).Pa}MQd(b){let h=null;b=b.view;return b?h=xe.SelectionEditor.Jj(b.mb.ib.J(0),!1,
!1):h}}Object(m.a)(wu,"ListMarkerGalleryActor",null,[465]);class Jl{constructor(){this.Ef=this.W=null}get name(){return"Box4.ListMarkerGallery"}init(){if(hb.InteractiveViewManager.instance){var b=hb.InteractiveViewManager.instance;b.xe&&(this.Ef=b.xe.ed,this.NWn())}}dispose(){}wc(b){this.W=b}NWn(){(new wu(v.AFrameworkApplication.va,1,this.W.resolve("Common.IStandaloneRootController").pea,this.W,this.Ef)).Tb();(new wu(v.AFrameworkApplication.va,0,this.W.resolve("Common.IStandaloneRootController").pea,
this.W,this.Ef)).Tb();(new wu(v.AFrameworkApplication.va,2,this.W.resolve("Common.IStandaloneRootController").pea,this.W,this.Ef)).Tb()}static main(){L.a.instance.Gc(new Jl)}}Object(m.a)(Jl,"Box4ListMarkerGalleryPackage",null,[1,2]);var VB=c(427),Tz=c(492),xu=c(452),mg=c(128);const yu=b=>{b.element.style.top=""};var ft=c(719);class bz{constructor(b,h,r){this.FH=!1;this.uab=0;this.ffa=this.P$g=null;this.Cl=b;this.Vlk=h;this.wt=r;this.l7=b.ownerDocument.createElement("div");this.htmlElement.className=
"WACBusinessBar";(this.Pw=!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.tL)&&!this.wt.ggf&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");this.htmlElement.id="WACBusinessBar";Z.a.Cj&&Sys.UI.DomElement.addCssClass(this.htmlElement,"FireFox")}get htmlElement(){return this.l7}get visible(){return this.FH}set_visible(b){if(this.FH!==b)return(this.FH=b)?this.x3e():this.MLc(),b}dispose(){this.visible&&this.MLc();dc.a.U_(this.htmlElement);this.Cl=this.l7=null}esj(b,h){const r=
b.htmlElement||b.createElement();h===this.htmlElement.childNodes.length?this.htmlElement.appendChild(r):this.htmlElement.insertBefore(r,this.htmlElement.childNodes[h]);b.Jej();this.uab+=b.htmlElement.clientHeight;var B=this.htmlElement.childNodes,P=b.Vsh,ca=Object(z.a)(this,this.Pkn,"onAfterShowEntry");mg.WacAirSpace.zV(r,"Shared_BasicClass");var ra=new xu.a(r);ra.Nua(0,1);const Qa=new Tz.a(r);Qa.lDa(r.clientTop-30,r.clientTop);P?(mg.WacAirSpace.Wmb(ra,null,null),mg.WacAirSpace.Wmb(Qa,null,ca)):(mg.WacAirSpace.animate(ra,
null,null),mg.WacAirSpace.animate(Qa,null,ca));for(h+=1;h<B.length;h++)ca=B[h],mg.WacAirSpace.zV(ca,"Shared_BasicClass"),ra=new Tz.a(ca),ra.lDa(ca.clientTop-r.clientHeight,ca.clientTop),P?mg.WacAirSpace.Wmb(ra,null,null):mg.WacAirSpace.animate(ra,null,null);b.Awo();this.set_visible(!0)}Ooi(b){const h=b.htmlElement;if(dc.a.adc(h)){this.uab-=b.htmlElement.clientHeight;var r=h.parentNode.children;b=b.Vsh;var B=Object(z.a)(this,this.Ikn,"onAfterHideEntry");mg.WacAirSpace.zV(h,"Shared_BasicClass");var P=
new VB.a(h);P.Nua(1,0);b?mg.WacAirSpace.Wmb(P,null,B):mg.WacAirSpace.animate(P,null,B);B=!1;for(P=0;P<r.length;P++){if(B){const ca=r[P];mg.WacAirSpace.zV(ca,"Shared_BasicClass");const ra=new Tz.a(ca);ra.lDa(ca.clientTop,-h.clientHeight);b?mg.WacAirSpace.Wmb(ra,null,yu):mg.WacAirSpace.animate(ra,null,yu)}B||r[P]!==h||(B=!0)}}}Pkn(b){b.element.style.top="";v.AFrameworkApplication.ua.B1c()}Ikn(b){b.element.parentNode.removeChild(b.element);this.htmlElement.hasChildNodes()||this.set_visible(!1);v.AFrameworkApplication.ua.B1c()}x3e(){""===
this.Cl.style.top.trim()&&(this.Cl.style.top=this.Cl.offsetTop+"px");this.htmlElement.style.left=this.Cl.style.left;this.htmlElement.style.top=this.Cl.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility="visible";var b=Sys.UI.DomElement.getBounds(this.htmlElement);this.P$g=this.Cl.style.top;this.uab=b.height;this.Joe();v.AFrameworkApplication.ua.E_(Object(z.a)(this,this.onResize,"onResize"));He.a.addHandler(this.htmlElement,pd.a.Qfe,He.a.r4b);this.ffa=Object(z.a)(this,
this.aEa,"contextMenuHandler");v.AFrameworkApplication.ua.bAa.ob(this.htmlElement,this.ffa,null);if(pc.FocusManager.lK()){var h=pc.FocusManager.instance();b=h.fe(ft.a.nOa);b.parent=Dd.AFrame.Ap;const r=new $e.DOMFocusListing(()=>this.htmlElement);r.Rm(1);r.Rm(2);r.Rm(8);h.ina(()=>this.htmlElement,b,r);h=h.getRegion(ft.a.nOa);h.ITa();h.BP=!0;h.A0a=!0;const B=v.AFrameworkApplication.ua.wx;b.u_a(()=>{B.fx(ft.a.nOa)});B.JT(ft.a.nOa);(r.xha||v.AFrameworkApplication.K.$("ReactBusinessBarIsEnabled"))&&B.$I(ft.a.nOa)}}MLc(){this.Irj()&&
(this.Cl.style.top=this.P$g);this.htmlElement.style.visibility="hidden";v.AFrameworkApplication.ua&&(pc.FocusManager.lK()&&pc.FocusManager.instance().i7a(ft.a.nOa),this.ffa&&(v.AFrameworkApplication.ua.bAa.sc(this.htmlElement,this.ffa),this.ffa=null));He.a.removeHandler(this.htmlElement,pd.a.Qfe,He.a.r4b)}Joe(){if(this.Irj()&&this.visible){var b=this.Cl,h=this.uab+this.Vlk;const r=dc.a.iN(b.style.top);mg.WacAirSpace.zV(b,"Shared_BasicClass");b=new Tz.a(b);b.lDa(r,h);mg.WacAirSpace.animate(b,null,
null)}}Irj(){return!this.Pw&&!this.wt.ggf}onResize(){const b=this.wt.entries.length,h=Sys.UI.DomElement.getBounds(this.htmlElement).height;let r;for(let B=0;B<b;++B)r=this.wt.entries[B],r.htmlElement&&r.Jej();this.uab=Sys.UI.DomElement.getBounds(this.htmlElement).height;h!==this.uab&&this.Joe()}aEa(){return!0}}Object(m.a)(bz,"BusinessBarDom",null,[1094,9]);var zu;(function(b){b[b.none=0]="none";b[b.corruptPage=1]="corruptPage";b[b.currentPageStatus=2]="currentPageStatus";b[b.documentMarkedAsFinal=
3]="documentMarkedAsFinal";b[b.documentSigned=4]="documentSigned";b[b.fileAccess=5]="fileAccess";b[b.kickoutWithDataLoss=6]="kickoutWithDataLoss";b[b.lostSession=7]="lostSession";b[b.malformedHyperlinkUris=8]="malformedHyperlinkUris";b[b.odt=9]="odt";b[b.readonlyRecommended=10]="readonlyRecommended";b[b.saveReplaySuccess=11]="saveReplaySuccess";b[b.saveReplayFailed=12]="saveReplayFailed";b[b.unsupportedObjects=13]="unsupportedObjects";b[b.word11Compat=14]="word11Compat";b[b.unsupportedBrowser=15]=
"unsupportedBrowser";b[b.applicationNotification=16]="applicationNotification";b[b.skypeDocChatFailed=17]="skypeDocChatFailed";b[b.showDialogInNewWindowInfo=18]="showDialogInNewWindowInfo";b[b.sessionExpired=19]="sessionExpired";b[b.irmPolicyDescription=20]="irmPolicyDescription";b[b.policyWarningMessage=21]="policyWarningMessage";b[b.thirdPartyAddinDisabled=22]="thirdPartyAddinDisabled";b[b.gdprPrivacyNotice=23]="gdprPrivacyNotice";b[b.datacenterDecommissionWarning=24]="datacenterDecommissionWarning";
b[b.graphMergePrompt=25]="graphMergePrompt";b[b.readOnlyDocument=26]="readOnlyDocument";b[b.dictationSilence=27]="dictationSilence";b[b.autoSensitivityLabel=28]="autoSensitivityLabel";b[b.recommendedSensitivityLabel=29]="recommendedSensitivityLabel";b[b.dictationDebugInfo=30]="dictationDebugInfo";b[b.oneNoteCovid19Message=31]="oneNoteCovid19Message";b[b.citationStylePrompt=32]="citationStylePrompt";b[b.oneNoteViewModeMessage=33]="oneNoteViewModeMessage";b[b.oneNotePrintImagesDownloading=34]="oneNotePrintImagesDownloading";
b[b.oneNotePagePrintReady=35]="oneNotePagePrintReady";b[b.irmPolicyCausedFeatureDisabled=36]="irmPolicyCausedFeatureDisabled";b[b.mandatoryLabel=37]="mandatoryLabel";b[b.policyTip=38]="policyTip";b[b.minorVersionLimit=39]="minorVersionLimit";b[b.testEntry1=40]="testEntry1";b[b.testEntry2=41]="testEntry2";b[b.testEntry3=42]="testEntry3";b[b.testEntry4=43]="testEntry4";b[b.testEntry5=44]="testEntry5";b[b.testEntry6=45]="testEntry6";b[b.testEntry7=46]="testEntry7"})(zu||(zu={}));Object(m.b)("BusinessBarId",
zu);class Au{constructor(b,h=0,r=null,B=null){this.E2g=this.VSg=!1;this.j_b=null;this.dB=[];this.qWa=B||new bz(b,h,this);this.QBm(r)}QBm(b){if(b){this.j_b={};b=b.ranking;for(let h=0;h<b.length;h++)this.j_b[zu[b[h]]]=h}}dispose(){this.qWa.dispose();Xo.a.Pag(this.dB);this.dB=null}get htmlElement(){return this.qWa.htmlElement}get visible(){return this.qWa.visible}get ggf(){return this.VSg}set ggf(b){this.VSg=b}get rHf(){return this.E2g}set rHf(b){this.E2g=b}get entries(){return this.dB}set entries(b){this.dB=
b}BY(b){for(let h=0;h<this.dB.length;h++)if(this.dB[h].id===b)return!0;return!1}sA(b,h=!1,r=null,B=null,P=null){b.SK=this;let ca=this.a1l(b.id);h&&!this.j_b&&(ca=0);ca<Au.DLb&&(this.qWa.esj(b,ca),this.dB.length>=Au.DLb&&this.qWa.Ooi(this.dB[Au.DLb-1]),this.qWa.Joe());Array.insert(this.dB,ca,b);t.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",zu[b.id],void 0===b.B0a||null===b.B0a?"":b.B0a);b.errorCode&&v.AFrameworkApplication.mN(b.errorCode,r,B,P)}removeEntry(b){const h=
Array.indexOf(this.dB,b);-1!==h&&h<Au.DLb&&(this.dB.length>Au.DLb&&this.qWa.esj(this.dB[Au.DLb],Au.DLb),this.qWa.Ooi(b),this.qWa.Joe());Array.remove(this.dB,b);b.SK=null;b.dispose()}a1l(b){if(!this.j_b||0===b)return this.dB.length;b=this.j_b[zu[b]];if(void 0===b||null===b)return this.dB.length;for(let h=0;h<this.dB.length;h++)if(b<this.j_b[zu[this.dB[h].id]])return h;return this.dB.length}}Au.DLb=2;Object(m.a)(Au,"BusinessBar",null,[1073,9,1074]);class Uz{create(b,h,r){return new xh.a(b,h,r)}}Object(m.a)(Uz,
"Factory",null,[1093]);class RA{static f4k(b,h){b.register(Au,"CommonUI.BusinessBar").as("CommonUI.IBusinessBar").ha().Ud(()=>new Au(h.value,0,b.Oa("CommonUI.IBusinessBarRankProvider")));b.register(Uz,"CommonUI.BusinessBarEntry.Factory").as("CommonUI.IBusinessBarEntryFactory").ha()}}Object(m.a)(RA,"CommonUIComponentConfiguration",null,[]);var gt=c(1019);class jr extends gt.a{constructor(){super()}static get instance(){return jr._instance||jr.NBf()}static NBf(){jr._instance=new jr;return jr._instance}}
jr._instance=null;Object(m.a)(jr,"ReactRootManager",gt.a,[319,320]);class cz extends ah.a{constructor(){super()}get ControlType(){return 3}}Object(m.a)(cz,"CompoundButtonProps",ah.a,[]);class SA{constructor(b,h,r,B,P,ca,ra){this.OW=h;this.bCc=b;this.R0g=h.CLm;this.pYb=h.RXc;this.sGe=ca;this.Mnd=B;this.Nnd=P;this.Hnd=r;this.yK=ra;this.Ibb=new Fe.a;this.Ibb.Z(1,"SpellingIssue_16x16x32");this.Ibb.Z(2,"GrammarIssue_16x16x32");this.Ibb.Z(3,"WritingIssue_16x16x32");this.Ibb.Z(4,null);this.Ibb.Z(0,null)}create(b,
h,r){h=Object(Ra.a)(bp.a,h);if(!h)return t.ULS.sendTraceTag(25007833,375,15,"Expect EditorServiceErrorDetails."),"";const B=new Sys.StringBuilder;b=this.zbi(b);this.SKc(B,h,r,b);this.xbf(B,h);this.Mdl(B,h,b);return B.toString()}jDb(b,h,r){const B=Object(Ra.a)(bp.a,h);if(!B)return t.ULS.sendTraceTag(39188232,375,15,"Expect EditorServiceErrorDetails."),[];h=[];b=this.zbi(b);this.hcf(h,B,r,b);this.ybf(h,B);this.Ndl(h,B,b);for(r=0;r<h.length;r++)h[r].Id=`${qs.RVh}_${r}`;return h}SKc(b,h,r,B=null){h.errorType?
1===h.errorType&&(this.b8b(h)||b.append(this.H5e(h,r,B))):b.append(this.bCc.build())}hcf(b,h,r,B=null){h.errorType?1===h.errorType&&(this.b8b(h)||b.push(this.wNk(h,r,B))):b.push(this.bCc.vzh())}xbf(b,h){const r=new Sys.StringBuilder;this.btj(h)?r.append(mi.a("btnIgnoreAllSpellingError",(2===h.errorType?Nb.a.PJa:Nb.a.cpa).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.b8b(h)||r.append(mi.a("btnIgrnoreSpellingError",this.vai(h.errorType).toString(),Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,
null));this.htj(h)&&(this.OW.rxi&&r.append(mi.a("btnDoNotCheckForThisIssue",Nb.a.bEb.toString(),Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),r.append(mi.a("btnGrammarOptions",Nb.a.bob.toString(),F.a.zf(Box4Intl.Box4Strings.l_GrammarOptions),null)));r.isEmpty()||(b.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),b.append(r.toString()),b.append("</Controls></MenuSection>"))}ybf(b,h){const r=Object.assign(new di.a,{ControlList:[]});if(this.btj(h)){var B=rs.QB()?
Object.assign(new ah.a,{ExternalId:"btnIgnoreAllSpellingErrorForAL",Command:Nb.a.cpa,LabelText:Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors}):Object.assign(new ah.a,{ExternalId:2===h.errorType?"UnknownAllSpellingError":"IgnoreAllSpellingError"});r.ControlList.push(B)}else this.b8b(h)||(B=Object.assign(new ah.a,{ExternalId:"btnIgrnoreSpellingError",Command:this.vai(h.errorType).toString(),LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),r.ControlList.push(B));this.htj(h)&&(this.OW.rxi&&
(h=Object.assign(new ah.a,{ExternalId:"DoNotCheckForThisIssue"}),r.ControlList.push(h)),h=Object.assign(new ah.a,{ExternalId:"GrammerSettingsContext"}),r.ControlList.push(h));b.push(r)}zbi(b){if(!this.yK)return null;b=this.yK.language(this.yK.Yr(b.Pa));return lj.a.tg(b)?lj.a.tg(b).name:null}vai(b){return 2===b?Nb.a.PJa:this.OW.xOm?Nb.a.Swm:Nb.a.kxa}Mdl(b,h,r=null){if(this.Vfg(h)){var B=F.a.zf(h.Ft.CategoryTitle);B=mi.m(qs.Dic,fb.a.Rma,this.Ibb.J(h.proofingType),""!==B?B:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,
[b.toString()],this.Mnd,this.Nnd);B=mi.d("cgProofingOuter",[B]);b.clear();b.append(mi.g("msProofingOuter",B,"Menu16",void 0,void 0,r,"ariaLabelledById"));t.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",h.proofingType,h.typeId)}}Ndl(b,h,r=null){if(this.Vfg(h)){var B=F.a.zf(h.Ft.CategoryTitle);r=Object.assign(new wg.a,{ExternalId:String.format("{0}_{1}",qs.Dic,h.proofingType),Command:fb.a.Rma.toString(),Image16by16Class:this.Ibb.J(h.proofingType),LabelText:""!==
B?B:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:r,Menu:Object.assign(new $f.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.AOl(h),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});r.Menu.MenuSectionList.push(...b);Array.clear(b);B=Object.assign(new di.a,{ControlList:[]});B.ControlList.push(r);b.push(B);t.ULS.sendTraceTag(39188234,375,50,"Show 2-level context menu of type {0}, critique id {1}",
h.proofingType,h.typeId)}}H5e(b,h,r=null){const B=this.aXl(b);var P=[];let ca=!1;var ra=b.Ft.Suggestions;if(ra)if(ra=ra.slice(0,Math.min(3,ra.length)),this.R0g&&(ca=!Rl.a.any(ra,Qa=>!Qa||!Qa.Description)),1!==ra.length||ra[0].Action){let Qa=0,tb=null;ca&&(tb="font-weight: bold;");for(const Mb of ra){if(!Mb)continue;ra=null;let Zb="";const jc=F.a.zf(Mb.Text);ca&&(ra=this.i6h(Mb.Description),Zb=this.h6h(Mb.Description));P.push(mi.a("btnCorrectWord"+Qa,h[Qa].toString(),jc,null,null,null,null,null,tb,
null,ra,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,B,jc),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.gKh(b.token)),"ariaDescribedById",Zb));Qa++}}else h=F.a.zf(ra[0].Text),P.push(mi.a("btnCorrectWord0",Nb.a.PJa.toString(),h,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,B,h)));h="Menu16";
0<P.length?ca&&(h="Menu16DescriptionEnabled"):P=[mi.a("btnNoSuggestions",Nb.a.PJa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)];return mi.g("msUnknownWord",mi.d(null,P),h,B,this.C4l(b),r,"ariaLabelledById")}wNk(b,h,r=null){var B=1!==b.proofingType&&0!==b.proofingType?b.Ft.ExplanationTitle:"";B=Object.assign(new di.a,{Title:B,Lang:r,ControlList:[]});let P=!1;var ca=b.Ft.Suggestions;if(ca)if(ca=ca.slice(0,Math.min(3,ca.length)),this.R0g&&(P=!Rl.a.any(ca,ra=>!ra||!ra.Description)),1!==ca.length||
ca[0].Action){let ra=0;for(const Qa of ca){if(!Qa)continue;ca=null;let tb="";P&&(ca=this.i6h(Qa.Description),tb=this.h6h(Qa.Description));if(ra>=h.length)break;ca?(ca=Object.assign(new cz,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",ra,b.proofingType),Command:h[ra].toString(),LabelText:Qa.Text,Description:ca,Lang:r,AriaDescription:tb}),B.ControlList.push(ca)):(ca=Object.assign(new ah.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",ra,b.proofingType),Command:h[ra].toString(),
LabelText:Qa.Text,Lang:r,RoleInMenu:"menuitem"}),B.ControlList.push(ca));ra++}}else b=ca[0],b=Object.assign(new ah.a,{ExternalId:"NoSuggestion",Command:Nb.a.PJa.toString(),LabelText:b.Text}),B.ControlList.push(b);0>=B.ControlList.length&&B.ControlList.push(Object.assign(new ah.a,{ExternalId:"btnNoSuggestions",Command:Nb.a.PJa.toString(),LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));return B}aXl(b){return F.a.zf(0!==b.proofingType?b.Ft.ExplanationTitle:"")}C4l(b){return this.Vfg(b)?null:this.Ibb.J(b.proofingType)}Vfg(b){return this.pYb&&
2!==b.errorType&&(1!==b.errorType||!this.b8b(b))}btj(b){return this.sGe&&!!b.errorType&&1===b.proofingType&&!this.b8b(b)}AOl(b){return 1===b.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,b.token,this.gKh(b.token)):""}htj(b){return this.OW.x0d&&this.pYb&&1===b.errorType&&(2===b.proofingType||3===b.proofingType)}b8b(b){return!!b.errorType&&!!this.Hnd&&this.Hnd.contains(b.token,b.lcid)}i6h(b){return""===b?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):
b}h6h(b){return""!==b?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,b):""}gKh(b){let h="";if(b){let r;for(r=0;r<b.length-1;r++)h=h+b.charAt(r)+",";h+=b.charAt(r)}return h}}Object(m.a)(SA,"EditorServiceProofingContextMenuCreator",null,[]);class by{get ranking(){return[24,23,7,6,19,1,5,9,22,2,4,3,10,8,14,13,11,12,15,16,17,18,20,21,36,25,26,27,28,29,30,31,32,33,34,35,37,40,41,42,43,44,45,46]}}Object(m.a)(by,"BusinessBarRankProvider",null,[466]);class Vz{constructor(){this.W=
null}get name(){return"Wonca.UI"}wc(b){this.W=b;b.ia("CommonUI.IBusinessBarRankProvider",()=>new by).ha();RA.f4k(b,new pf.a(()=>Eb.App.za.hha));b.ia("Box4.UI.EditorServiceProofingContextMenuCreator",()=>new SA(b.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"),b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),b.resolve("Box4.Proofing.IIgnoreAllKeywords"),v.AFrameworkApplication.Oca,v.AFrameworkApplication.Ns,v.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),b.resolve("Box4.IFormattingReader"))).ha();
b.ia("CommandUI.ReactRootManager",()=>jr.instance).as("Common.IReactRootManager").ha()}init(){this.W.resolve("Wonca.IRibbonUserFactory");this.W.resolve("CommonUI.IBusinessBar")}dispose(){}static main(){L.a.instance.Gc(new Vz)}}Object(m.a)(Vz,"WoncaUIPackage",null,[1,2]);class cy{constructor(b){this.SN=this.fAc=null;this.An=b}get key(){return"BOOKMARK"}get $w(){return WordEditorIntl.WordEditorStrings.L_Bookmark}get m4(){return this.SN}reset(b){this.SN=b.node}GJa(b){let h=null;v.AFrameworkApplication.oe("bookmarks-core-ex;bookmarks-core-ex-cf");
if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)){if(this.fAc&&this.An.Owi(b,this.m4,this.fAc))return h=Object.assign(new qu.a,{$G:this.key,contentObject:this.fAc}),{returnValue:!0,hG:h};this.fAc=null;if(!this.m4.hasBookmark)return{returnValue:!1,hG:h};const r=new Ad.GraphIterator;r.set(this.m4.Yi());this.An.W0c(r);if(this.An.OIm(r)){let B=r.Rd();for(;B;){if(this.An.Owi(b,this.m4,B))return this.fAc=B,h=Object.assign(new qu.a,
{$G:this.key,contentObject:B,description:this.Vib()}),{returnValue:!0,hG:h};B=r.Oj()}}}return{returnValue:!1,hG:h}}Vib(){return null}}Object(m.a)(cy,"BookmarkDetailsProvider",null,[414,415]);class TA{constructor(b,h,r,B,P=null){this.o0g=this.Zh=!1;this.Vrd=this.wtd=null;this.eUi=(ca,ra)=>{ca=ra.node;1074135152!==ca.Qc?t.ULS.sendTraceTag(24155018,324,10,"node.RuntimeClassId = {0}",ca.Qc):(t.ULS.sendTraceTag(24155019,324,50,"OnBookmarkContainerNodeLoaded: Refreshing out of date bookmarks"),this.tXh(!0))};
this.lA=r;this.ti=B;this.Cx=h;this.bNg=b;this.CS=P}get ox(){return this.Cx.value}initialize(){this.c7f();this.Zh=!0}tXh(b=!1){if(!this.Zh)return t.ULS.sendTraceTag(24262273,324,10,"BookmarkGraphManager not initialized"),!1;if(!b&&this.o0g)return!0;let h=!1;this.ti.ie(()=>{this.wtd={};this.Vrd={};if(this.ox){const r=new Ad.GraphIterator;r.set(this.ox);if(this.wfn(r)){if(r.Ub(1)){do this.Stk(r.currentNode);while(r.Mf(1))}h=this.o0g=!0}}},"BGM:EBGL");return h}Bwa(b){return this.tXh()?b in this.Vrd?this.Vrd[b]:
null:null}dispose(){this.Zh?this.ESo():t.ULS.sendTraceTag(24262275,324,50,"BookmarkGraphManager not initialized")}wfn(b){if(this.lA.IP(b))return(b=b.Ub(30))||t.ULS.sendTraceTag(24691921,324,10,"Graph does not contain BookmarkContainer"),b;t.ULS.sendTraceTag(24691922,324,15,"Unable to move to Page Manifest");return null}c7f(){t.ULS.sendTraceTag(24691923,324,50,"Registering OnBookmarkContainerNodeLoaded");this.bNg.prh(this.eUi)}ESo(){t.ULS.sendTraceTag(24691924,324,50,"Unregistering OnBookmarkContainerNodeLoaded");
this.bNg.Ybj(this.eUi)}Stk(b){var h,r,B,P;b?(this.oph(null!==(r=this.CS.xfb.get(null===(h=b.id)||void 0===h?void 0:h.toString()))&&void 0!==r?r:V.a.nil,b),this.oph(null!==(P=this.CS.M3b.get(null===(B=b.id)||void 0===B?void 0:B.toString()))&&void 0!==P?P:V.a.nil,b),(h=b.properties.ja(Mc.a.At,null))&&(this.Vrd[h]=b)):t.ULS.sendTraceTag(24155022,324,50,"Node is null")}oph(b,h){b===V.a.nil?t.ULS.sendTraceTag(24155023,324,50,"paraNodeId is null"):(b=b.toString(),b in this.wtd||(this.wtd[b]=new mb.a),b=
this.wtd[b],b.contains(h)||b.add(h))}}Object(m.a)(TA,"BookmarkGraphManager",null,[664]);var LC=c(818),WB=c(1135);class ax{create(){return new WB.a}}Object(m.a)(ax,"BookmarkContainerNodeFactory",null,[404]);class UA{constructor(b,h,r,B=null){this.Srn=(P,ca)=>{this.An.bXi(ca)};this.XXf=(P,ca)=>{var ra=this.U_h(ca.clone);P=ca.original.Mc;const Qa=new Sb.a;for(const tb of ra)ra=tb.xn.toString(),Qa.nb(ra)||(Qa.add(ra,!0),(ra=P.Eb(tb.xn))&&!ra.anchor&&(ra=this.An.IFb(tb.xn)),ra?ra.anchor?this.i8k(ra,ca.clone):
t.ULS.sendTraceTag(573673488,324,15,String.format("BookmarkNode ObjId:{0} Id:{1} as no anchor",ra.id,ra.ja(Mc.a.DBb,-1))):t.ULS.sendTraceTag(573673487,324,15,"BookmarkNode null"))};this.YXf=(P,ca)=>{P=ca.clone;ca=this.U_h(P);this.An.C6c(P,ca)};this.qA=h;this.An=r;this.BXj=B||new ax}init(){LC.a.IUn(Object(z.a)(this.An,this.An.dVf,"onAfterFullBookmarkRangeDeleted"));this.qA.t0e(this.Srn);bt.a.s0e(this.XXf);bt.a.mCd(this.YXf)}U_h(b){const h=new mb.a;for(let r=0;r<b.qa.length;r++){const B=b.qa.J(r);if(B.$g)for(let P=
0;P<B.$g.length;P++)h.add(B.$g.J(P))}return h}i8k(b,h){var r=h.Yi().xd;r=fp.b(b,r,!0);h=Ad.GraphIterator.eb(h);this.mwl(h);h.Ub(30);h.O3(r,1,b.id);h.Aj(r)}mwl(b){if(b.zb(25)&&b.jd(25)&&!b.Jt(30)){const h=this.BXj.create(1074135152);b.Bf(h,30)}}}Object(m.a)(UA,"BookmarksEventHandler",null,[]);var Gp=c(206),yr=c(256),cv=c(395),bx=c(1190),VA=c(130),Wz=c(1080);class Dj{create(){return new Wz.a}}Object(m.a)(Dj,"BookmarkNodeFactory",null,[404]);class At{constructor(b,h){this.Iba=b;this.LXj=h}get EOb(){return this.LXj}}
Object(m.a)(At,"FoundBookmarkRangeObject",null,[508]);class Jv{constructor(b,h,r,B,P,ca,ra,Qa=null,tb,Mb=null){this.e3="_";this.eNg=40;this.Okk=" ";this.Cx=b;this.lA=h;this.Md=r;this.BJe=B;this.Lc=P;this.gb=ca;this.hb=ra;this.KXj=Qa||new Dj;this.CS=Mb}yRc(b,h){return b?this.CS.xfb.get(null===h||void 0===h?void 0:h.toString()):this.CS.M3b.get(null===h||void 0===h?void 0:h.toString())}get ox(){return this.Cx.value}get hKa(){return this.BJe.value}AZe(b,h){if(!h||!h.Pa||!h.Tc)return t.ULS.sendTraceTag(36471765,
3029,15,"There is no selection"),!1;const r=h.Pa.node,B=h.Tc.node,P=Gp.a.Wib(h,!0);h=Gp.a.Wib(h,!1);return this.KFc(b,P,h,r,B)}KFc(b,h,r,B,P,ca=!1){t.ULS.sendTraceTag(545642374,3029,50,String.format("removeExisting value is: {0}",ca));const ra=this.Bwa(b);if(ra)if(ca)this.O$i(ra);else return t.ULS.sendTraceTag(36471764,3029,50,"Unable to add bookmark because name already exists"),!1;if(!B||!P)return t.ULS.sendTraceTag(591730833,3029,50,"Missing Paragraph info while adding bookmark"),!1;ca=this.Lc.Pc(15);
ca.Db(this.hKa);b=this.lrk(b);if(!b)return!1;this.hrk(B,h,b,P,r);ca.dispose();return!0}Bwa(b){t.ULS.shipAssertTag(34936482,3029,!!b);return this.X_h(h=>b===h.properties.ja(Mc.a.At,null))}IFb(b){return b&&b!==V.a.nil?this.X_h(h=>b.equals(h.id)):(t.ULS.sendTraceTag(543424735,3029,10,"Unable to find BookmarkNode when node id is null"),null)}dVf(b){const h=this.IFb(b);h?(t.ULS.sendTraceTag(36844636,3029,50,String.format("Removing bookmark {0}",b.toString())),this.N$i(h),this.B6c(h)):t.ULS.sendTraceTag(36569436,
3029,15,"Unable to find BookmarkNode for full bookmark range deletion")}Cwa(b,h){var r;const B=null!==(r=this.yRc(h,b.id))&&void 0!==r?r:V.a.nil;if(B===V.a.nil)return t.ULS.sendTraceTag(36218377,3029,10,"ParaId not on Bookmark"),new At(null,2);r=this.ox.xd.Eb(B);return r?r.isConnected?this.getBookmarkRange(r,b,h):(t.ULS.sendTraceTag(36766421,3029,50,"Paragraph not loaded"),new At(null,3)):(t.ULS.sendTraceTag(36766420,3029,10,"Unable to get paragraph from object space"),new At(null,2))}bXi(b){const h=
this.aFl(b);h[Symbol.iterator]().next().done||this.sfn(b,h)}C6c(b,h){const r=new mb.a;let B=0,P=!1;for(const ca of h)ca&&ca.Lb.$g?(B++,ca.Lb.$g.remove(ca),0<=ca.qe&&ca.qe<b.ye.length&&(ca.Lb.cp||(P=!0),r.add(ca.qe))):t.ULS.sendTraceTag(36569441,3029,15,"BookmarkRangeObject to remove is null");b.Zqa(r);t.ULS.sendTraceTag(36844637,3029,50,String.format("Removed {0} bookmark anchors | idsToRemove: {1}",B,r.count));P&&!b.ye.length&&b.ye.append(yr.CharacterPropertiesEditor.aN,1024)}jQd(b=!1){t.ULS.sendTraceTag(559228943,
3029,50,"Fetching bookmarks with includeHidden: {0}",b);const h=new mb.a,r=Ad.GraphIterator.eb(this.ox);if(null!==this.W0c(r)){var B=r.Wp();t.ULS.sendTraceTag(559228944,3029,50,"Bookmarks count: {0}",B);if(0<B)for(B=r.Rd();null!==B;){const P=B.ja(Mc.a.At,"");F.a.af(P)||(b?h.add(B):P.startsWith(this.e3)||h.add(B));B=r.Oj()}}!b&&0<h.count&&t.ULS.sendTraceTag(556889755,3029,50,"User Bookmarks count: {0}",h.count);return h}Qrm(){return this.ox?this.m5k():!1}m5k(){t.ULS.sendTraceTag(524321506,3029,50,
"Finding bookmarks with includeHidden: {0}",!1);const b=Ad.GraphIterator.eb(this.ox);if(null!==this.W0c(b)&&0<b.Wp())for(var h=b.Rd();null!==h;){h=h.ja(Mc.a.At,"");if(!F.a.af(h)&&!h.startsWith(this.e3))return!0;h=b.Oj()}return!1}kei(b){var h=this.Bwa(b);const r=new mb.a;if(h){b=this.yRc(!0,h.id);h=this.yRc(!1,h.id);var B=this.ox.xd.Eb(b);B&&r.add(B);if(b.equals(h))return r;b=B;do(b=B=this.gb.Xf(b,!1,!1,!0))&&r.add(B);while(B&&!B.id.equals(h))}else t.ULS.sendTraceTag(553927448,3029,10,"bookmark not exist with the {0}",
b);return r}M$i(b){if(null===b)return t.ULS.sendTraceTag(559228951,3029,50,"Cannot remove bookmark as id is null"),!1;b=this.IFb(b);return this.O$i(b)}tPl(b){let h="";const r=b.id;b=b.characterData.split(this.Okk);for(let B=0;3>B&&B<b.length;B++)h+=this.e3+b[B];h.length>this.eNg&&(h=h.substring(0,this.eNg));return this.wNj(h,r)}wNj(b,h){const r=this.jQd(!0),B=[];let P;for(let ra=0;ra<r.count;ra++){var ca=r.J(ra);P=ca.ja(Mc.a.At,"");ca=this.yRc(!0,ca.id);P.startsWith(b)&&!h.equals(ca)&&B.push(P)}return 0<
B.length?(B.sort((ra,Qa)=>ra.localeCompare(Qa,void 0,{numeric:!0})),(h=B[B.length-1].substring(b.length+1))?b+this.e3+(parseInt(h)+1):b+this.e3+1):b}lli(b){F.a.af(b)?t.ULS.sendTraceTag(544777296,3029,10,"Cannot navigate to bookmark as name is null"):(b=this.Bwa(b),null===b?t.ULS.sendTraceTag(544777297,3029,10,"No bookmark with given name exists"):(b=this.Cwa(b,!0))?(b=og.SelectionFactory.ne(b.Iba.paragraph,b.Iba.Lb.cp))&&this.hb.Ac(b):t.ULS.sendTraceTag(544777298,3029,10,"No start found for bookmark. Document is corrupted"))}O$i(b){if(!b)return t.ULS.sendTraceTag(559228888,
3029,15,"Could not find bookmark node with given id"),!1;t.ULS.sendTraceTag(559228889,3029,50,String.format("Removing bookmark {0}",b.id));const h=this.Lc.Pc(15);h.Db(this.hKa);this.N$i(b);this.B6c(b);h.dispose();return!0}DRd(b,h){if(!b||0>h)return t.ULS.sendTraceTag(545118153,3029,10,String.format("Got null paragraph or negative cp value")),null;let r=null;const B=new mb.a,P=new mb.a;var ca=b.qa;for(var ra=0;ra<ca.length;ra++){var Qa=ca.J(ra);if(Qa.cp>h||Qa.cp===h&&0<B.count)break;if(Qa.$g){var tb=
Qa.$g;if(2===tb.length&&tb.J(0).xn.equals(tb.J(1).xn)&&Qa.cp===h){B.add(tb.J(0).xn.toString());break}for(let Mb=0,Zb=tb.length;Mb<Zb;Mb++){Qa=tb.J(Mb);const jc=b.Mc.Eb(Qa.xn).ja(Mc.a.At,"");F.a.af(jc)||jc.startsWith(this.e3)||(Qa.Oc?B.add(Qa.xn.toString()):B.contains(Qa.xn.toString())?B.remove(Qa.xn.toString()):P.add(Qa.xn.toString()))}}}0<B.count&&(r=b.Mc.Eb(V.a.If(B.J(B.count-1))));if(!r)for(h=ke.ParagraphReader.Xf(b,!0);h&&!r;){for(ca=0;ca<h.qa.length;ca++)if(ra=h.qa.J(ca),ra.$g){ra=ra.$g;for(let Mb=
0,Zb=ra.length;Mb<Zb;Mb++)tb=ra.J(Mb),Qa=b.Mc.Eb(tb.xn).ja(Mc.a.At,""),F.a.af(Qa)||Qa.startsWith(this.e3)||(tb.Oc?P.contains(tb.xn.toString())?P.remove(tb.xn.toString()):B.add(tb.xn.toString()):B.contains(tb.xn.toString())?B.remove(tb.xn.toString()):P.add(tb.xn.toString()))}0<B.count?r=h.Mc.Eb(V.a.If(B.J(B.count-1))):h=ke.ParagraphReader.Xf(h,!0)}return r}nUo(b,h){if(null===b)return t.ULS.sendTraceTag(525111647,3029,10,"Bookmark node is null"),!1;if(this.PIm(h)||this.wsl(h))return!1;const r=this.Lc.Pc(15);
r.Db(this.hKa);this.mUo(b,h);r.dispose();return!0}X_h(b){if(!this.ox)return t.ULS.sendTraceTag(34936483,3029,10,"PageNode is null"),null;const h=new Ad.GraphIterator;h.set(this.ox);if(!this.W0c(h))return t.ULS.sendTraceTag(34936512,3029,10,"Unable to move to BookmarkContainer"),null;if(!h.Ub(1))return null;do{const r=h.currentNode;if(b(r))return r}while(h.Mf(1));return null}getBookmarkRange(b,h,r){for(let B=0;B<b.qa.length;B++){const P=b.qa.J(B);if(P.$g)for(let ca=0;ca<P.$g.length;ca++){const ra=
P.$g.J(ca);if(ra.xn.equals(h.id)&&r===ra.Oc)return new At(ra,0)}}t.ULS.sendTraceTag(36729310,3029,15,"paragraph {0} did not contain bookmarkNode id:{1}, isStart: {2} ({3}), had {4} chps | Path: {5}",b.id,h.ja(Mc.a.DBb,-1),r,h.id,b.qa.length,this.DJ(b));return new At(null,1)}W0c(b){if(this.lA.IP(b))return b=b.Ub(30),t.ULS.shipAssertTag(34936513,3029,!!b,"Graph does not contain BookmarkContainer"),b;t.ULS.sendTraceTag(34936514,3029,15,"Unable to move to Page Manifest");return null}aFl(b){const h=new Sb.a;
for(let r=0;r<b.qa.length;r++){const B=b.qa.J(r);if(B.$g)for(let P=0;P<B.$g.length;P++){const ca=B.$g.J(P),ra=ca.xn.toString();h.nb(ra)?(t.ULS.shipAssertTag(36218379,3029,ca.Oc!==h.J(ra).Oc),h.remove(ra)):h.add(ra,ca)}}return h.values}sfn(b,h){this.C6c(b,h);this.Wen(b,h)}Wen(b,h){let r=ke.ParagraphReader.Xf(b,!1,!0);b=ke.ParagraphReader.Xf(b,!0,!0);r||b?(r||this.Sxh(h,!0)&&t.ULS.sendTraceTag(36320843,3029,15,"No next paragraph but have start bookmarks to move, falling back to prev paragraph."),b||
this.Sxh(h,!1)&&t.ULS.sendTraceTag(36320844,3029,15,"No prev paragraph but have end bookmarks to move, falling back to next paragraph."),r=r||b,b=b||r,this.QPi(r,h,0,!0),this.QPi(b,h,b.qa.last.cp,!1)):t.ULS.sendTraceTag(36218381,3029,15,"Both paragraphs are null.")}Sxh(b,h){for(const r of b)if(h===r.Oc)return!0;return!1}QPi(b,h,r,B){const P=new mb.a;r=this.Vof(b,r);for(const ca of h)ca.Oc===B&&(r?(h=this.nrk(b,B,r,ca.xn))&&P.add(h):t.ULS.shipAssertTag(36218382,3029,!0,"Null chp. isStart={0}",B));
P.count&&(b.Wl(),this.Bqg(b,P),t.ULS.sendTraceTag(36844638,3029,50,String.format("Added {0} bookmark anchors | isStart: {1}",P.count,B)))}nrk(b,h,r,B){const P=this.IFb(B);return P?this.BZe(b,h,r,P):(t.ULS.sendTraceTag(40445218,3029,15,String.format("BookmarkNode {0} null while trying to add range",B)),null)}BZe(b,h,r,B){var P;if(!B)return t.ULS.sendTraceTag(591730834,3029,10,String.format("BookmarkNode null while trying to add range")),null;if(!r)return t.ULS.sendTraceTag(543424736,3029,10,String.format("Chp null while trying to add range")),
null;r.$g||(r.$g=new cv.a(r));const ca=new bx.a(r,null,B.id,h);r.$g.add(ca);(h?this.CS.xfb:this.CS.M3b).set(null===(P=B.id)||void 0===P?void 0:P.toString(),b.id);return ca}Bqg(b,h){if(h){t.ULS.sendTraceTag(36218384,3029,50,"BookmarksToUpdate.Count:{0}",h.count);h.Sc((r,B)=>r.qe-B.qe);for(let r=0;r<h.count;r++){const B=h.J(r);B.qe?b.ye.uY(B.qe-1,1024):b.ye.lpa(B.qe,1024);b.ye.vq.Z(B.qe,yr.CharacterPropertiesEditor.aN);b.ye.nt.Z(B.qe,yr.CharacterPropertiesEditor.YR)}}else t.ULS.shipAssertTag(36218383,
3029,!1,"Null BookmarksToUpdate.")}Vof(b,h){if(!b||!b.qa||!b.qa.last)return null;t.ULS.shipAssertTag(36471766,3029,h<=b.qa.last.cp,"Cp to split at greater than last Chp.Cp in paragraph");if(b.qa.last.cp===h){var r=b.qa.length-1;if(!b.qa.J(r).formatting)for(var B=r-1;0<=B;B--){var P=b.qa.J(B);if(P.formatting){this.Md.qZ(b,r,h,P.formatting);break}}return b.qa.last}r=null;for(B=0;B<b.qa.length;B++){P=b.qa.J(B);if(P.cp>=h){if(P.cp>h||!P.formatting)this.Md.qZ(b,B,h,r),P=b.qa.J(B);P.$g||(P.$g=new cv.a(P));
t.ULS.shipAssertTag(36471768,3029,P!==b.qa.last);return P}P.formatting&&(r=P.formatting)}return null}lrk(b){const h=new Ad.GraphIterator;h.set(this.ox);if(!this.W0c(h))return t.ULS.sendTraceTag(36471769,3029,10,"Unable to move to BookmarkContainer"),null;b=this.P9k(b);h.O3(b,1,null);h.Aj(b);return b}P9k(b){const h=this.KXj.create(1074135153);h.setValue(Mc.a.At,b);h.setValue(Mc.a.DBb,jd.a.GF());return h}B6c(b){if(b&&b.anchor){t.ULS.sendTraceTag(36729311,3029,100,"Removed bookmark with id:{0}, ({1})",
b.ja(Mc.a.DBb,-1),b.id);var h=new Ad.GraphIterator;h.set(b);h.zb(64);h.zg()}}DJ(b){const h=[];let r=0;for(;b.anchor.Vp&&7!==b.type;)h[r]=VA.a[b.type],b=b.anchor.Vp.us.node,r++;h[r]=VA.a[b.type];return h.join(" ")}mUo(b,h){b.setValue(Mc.a.At,h)}N$i(b){const h=this.Cwa(b,!0).Iba;b=this.Cwa(b,!1).Iba;if(h&&b&&h.paragraph===b.paragraph){let r;this.C6c(h.paragraph,(r=new mb.a,r.add(h),r.add(b),r))}else{if(h){let r;this.C6c(h.paragraph,(r=new mb.a,r.add(h),r))}if(b){let r;this.C6c(b.paragraph,(r=new mb.a,
r.add(b),r))}}}hrk(b,h,r,B,P){if(h=this.BZe(b,!0,this.Vof(b,h),r)){b.Wl();var ca;this.Bqg(b,(ca=new mb.a,ca.add(h),ca));(r=this.BZe(B,!1,this.Vof(B,P),r))?(B.Wl(),this.Bqg(b,(ca=new mb.a,ca.add(r),ca))):t.ULS.sendTraceTag(520646733,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark end range is null")}else t.ULS.sendTraceTag(520646734,3029,10,"FullBookmarkManager.addBookmarkAnchorsInParagraph: Bookmark start range is null")}lei(b,h){var r;if(!b)return null;h=null!==(r=this.yRc(h,
b.id))&&void 0!==r?r:V.a.nil;return b.Mc.Eb(h)?b.Mc.Eb(h):null}OIm(b){return!!b&&64===b.Xe}J_f(b){var h;if(0===b.T$)return!1;for(let r=0;r<(null===(h=b.qa)||void 0===h?void 0:h.length);r++){const B=b.qa.J(r);if(null!=B.$g)for(let P=0;P<B.$g.length;P++){const ca=B.$g.J(P),ra=b.Mc.Eb(ca.xn).SPa();if(!F.a.af(ra)&&!ra.startsWith(this.e3)&&ca.Oc)return!0}}return!1}X5h(b){var h;const r=[];if(0===b.T$)return r;for(let B=0;B<(null===(h=b.qa)||void 0===h?void 0:h.length);B++){const P=b.qa.J(B);if(null!=P.$g)for(let ca=
0;ca<P.$g.length;ca++){const ra=P.$g.J(ca),Qa=b.Mc.Eb(ra.xn),tb=Qa.SPa();F.a.af(tb)||tb.startsWith(this.e3)||!ra.Oc||r.push(Qa)}}return r}Huo(b){return b.ja(Mc.a.SG,!1)}PIm(b){return F.a.af(b)?(t.ULS.sendTraceTag(559228948,3029,50,"bookmark name is null or empty"),!0):!1}wsl(b){return null!==this.Bwa(b)?(t.ULS.sendTraceTag(559228949,3029,50,"Not updating bookmark name as a bookmark node with same name exists."),!0):!1}W5h(b,h,r){return this.getBookmarkRange(b,h,r).Iba}Owi(b,h,r){if(this.Huo(r)||this.gOm(r))return!1;
const B=this.lei(r,!0),P=this.lei(r,!1);if(B&&P&&this.gb.BXc(h,B,P)){if(h!==B&&h!==P)return!0;const ca=this.W5h(B,r,!0);if(ca&&(B!==h||ca.Lb.cp<=b)&&(r=this.W5h(P,r,!1))&&(P!==h||r.Lb.cp>=b))return!0}return!1}gOm(b){b=null===b||void 0===b?void 0:b.ja(Mc.a.At,"");return!F.a.af(b)&&b.startsWith(this.e3)?!0:!1}}Object(m.a)(Jv,"FullBookmarkManager",null,[460]);class Kv{constructor(){this.Mue=this.Sq=this.W=null}get name(){return"WordEditor.Bookmark"}wc(b){this.W=b;this.Sq=this.W.resolve("Box4.INotebookManager").Il;
const h=new Jv(new pf.a(()=>Eb.App.za.jb.Zc),qo.PageNavigator.instance,this.W.resolve("Box4.ICharacterPropertiesEditor"),new pf.a(()=>Eb.App.za.jb.rc.ed),Il.a.instance,this.W.resolve("Box4.IParagraphReader"),this.W.resolve("Box4.SelectionManager"),null,null,this.W.resolve("Box4.BookmarkParagraphMapping"));this.W.ia("WordEditor.Bookmark.FullBookmarkManager",()=>h).as("WordEditor.Bookmark.IBookmarkManager").ha();this.W.ia("WordEditor.Bookmark.BookmarksEventHandler",()=>new UA(this.Sq.Ue(12),this.W.resolve("WordEditor.ITableEditor"),
this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).ha();ub.App.HLj&&(this.Mue=new TA(this.Sq.Ue(64),new pf.a(()=>Eb.App.za.jb.Zc),qo.PageNavigator.instance,Wq.a.instance,this.W.resolve("Box4.BookmarkParagraphMapping")),this.W.ia("WordEditor.Bookmark.BookmarkGraphManager",()=>this.Mue).as("WordEditor.Bookmark.IBookmarkGraphManager").ha())}init(){this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{this.wn()})}dispose(){this.Mue.dispose()}wn(){t.ULS.sendTraceTag(36209186,324,50,"Registering paragraph events");
this.W.resolve("WordEditor.Bookmark.BookmarksEventHandler").init();t.ULS.sendTraceTag(24691930,324,50,"Finish registering paragraph events");this.PUn(this.W.Ta("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("WordEditor.Bookmark.FullBookmarkManager"))}PUn(b,h){b&&b.execute(r=>{r.D5(new cy(h))})}static main(){L.a.instance.Gc(new Kv)}}Object(m.a)(Kv,"BookmarkPackage",null,[1,2]);var Uo=c(886),cx=c(1072),Lv=c(1567),zr=c(1424);class dx extends zr.a{constructor(b){super();this.Qnk=b}get index(){return 3}run(){this.Qnk()}bK(){this.QY()}}
Object(m.a)(dx,"FootnoteEndnoteGraphUpdateTracker",zr.a,[]);class Rd{constructor(){this.Kmd=null}get name(){return"WordEditor.FootnoteEndnoteInteractive"}wc(){}init(){Rd.Zb.pq.continueWith(()=>{this.wn()})}wn(){Uo.a.tib=Lv.a.instance;this.Tzf()}dispose(){}Tzf(){this.Kmd=new dx(()=>{Lv.a.instance.Yu()});cx.a.lde(Object(z.a)(this.Kmd,this.Kmd.bK,"setUpdateNeeded"));Si.GraphTransactionManager.instance.nra(this.Kmd,3)}static get Zb(){return Ma.a.instance.resolve("Box4.IFeatureHelper")}}Object(m.a)(Rd,
"PackageManager",null,[1,2]);var Is=c(777),xi=c(204),dz=c(536),Hp=c(473),ex=c(1670);class dy extends Vw{constructor(){super()}get $w(){return null}getTitle(b){b=b.Foa();if(!b||!dz.a.instance.xpa(b))return"";const h=new Sys.StringBuilder,r=dz.a.instance.G4(b);h.append(1===r?WordEditorIntl.WordEditorStrings.l_FootnoteContentTitle:WordEditorIntl.WordEditorStrings.l_EndnoteContentTitle);h.append(" ");h.append(dz.a.instance.S9b(b));return h.toString()}}Object(m.a)(dy,"FootnoteEndnoteBaseDetailsProvider",
Vw,[]);class WA extends dy{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE"}get vh(){return 7}}Object(m.a)(WA,"FootnoteEndnoteDetailsProvider",dy,[]);var ey=c(1626),$t=c(1644),uw=c(1717);class ez extends dy{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE_REFMARK"}get vh(){return 10}}Object(m.a)(ez,"FootnoteEndnoteRefMarkDetailsProvider",dy,[]);class fy{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc,Uc,od,Od,ze,de){this.Rsi=(ee,je,ue,Qf,Jg)=>{Qf=je.view;if(!Qf.features.Ske||this.xD.Jwi)return 8;
const Ql=Qf.mb.qg;if(!Ql)return 2;if(this.Ok.$_(Ql))return 8;Qf=ee===qb.a.insertFootnote?1:0;var Fm=this.MQd(je);if(!Fm)return t.ULS.sendTraceTag(3683158,308,10,"We expected a selection here."),8;je=!0;Fm=Fm.Pa;Jg&&Jg.Kdc&&Jg.vGa&&(Fm=Jg.vGa,je=!Jg.keepCurrentFocus);if(1===ue&&Gg.a.sia(Ql)||!Fm||!xe.SelectionEditor.Ze(Fm)||this.gQg.instance&&this.gQg.instance.vPm(Fm)||Tg.a.Ixa(Fm,!0))return 8;if(1===ue)return 32;2===ue&&(ue=this.yT.Zf("UserAction","InsertFootnoteEndnote"),ee=this.H3j.fEm(Fm,Qf,ee),
Jg&&Jg.Kdc&&(Jg.hSi=ee),je&&this.n9d(ee,!0,!0),ue.stop(),this.Vd.Zs(6));return 32};this.pgc=(ee,je,ue)=>{const Qf=je.view;if(ee===qb.a.l8a||ee===qb.a.wqb){if(!Qf.features.Ske)return 8}else if(!Qf.features.tkg)return 8;if(!Qf.mb.qg)return 2;je=this.Q$b(je);return je?ee!==qb.a.l8a&&ee!==qb.a.wqb||this.ELa.lsm(je.node,ee===qb.a.l8a?1:0)?1===ue?32:2===ue&&32===this.ga.Qb(qb.a.p4,2,!0)?(this.ga.Qb(qb.a.WSf,2,ee),32):8:8:2};this.uIl=(ee,je,ue,Qf,Jg)=>{if(1===ue)return 32;if(2===ue){ee=this.Qdm(je);if(!ee)return 8;
ue=je=null;switch(Jg){case qb.a.G5d:ue=ee.Tc;je=this.pXb.AVd(ue,1);break;case qb.a.F5d:ue=ee.Tc;je=this.pXb.AVd(ue,0);break;case qb.a.I5d:ue=ee.Pa;je=this.pXb.Bli(ue,1);break;case qb.a.H5d:ue=ee.Pa;je=this.pXb.Bli(ue,0);break;case qb.a.l8a:ue=ee.Pa;(je=this.pXb.AVd(ue,1,!0))||(je=this.ELa.$9h(ue.node,1));break;case qb.a.wqb:ue=ee.Pa,(je=this.pXb.AVd(ue,0,!0))||(je=this.ELa.$9h(ue.node,0))}if(je)this.n9d(je);else{if(!this.gu.rc)return 8;(Jg=So.d(ue.node,ue.cpBegin))&&7===Jg.vh&&this.ELa.Eij(Jg)}}return 32};
this.Swo=(ee,je,ue,Qf,Jg)=>1===ue?32:2===ue?(t.ULS.shipAssertTag(4520066,308,!!Jg),t.ULS.shipAssertTag(4520067,308,!!Jg.F0a),ee=Jg.F0a,t.ULS.shipAssertTag(4520068,308,this.GE.xpa(ee)),this.n9d(ee,Jg.mie)?32:8):32;this.Two=(ee,je,ue,Qf,Jg)=>{if(1===ue)return 32;2===ue&&(ee=Jg.footnoteEndnoteNode,Jg=Jg.xIl)&&(this.cta.Y7b(),je=this.GE.flb(ee),Jg.title=this.GE.AZl(ee)+(je?WordEditorIntl.WordEditorStrings.l_FootnoteTooltipInstruction:WordEditorIntl.WordEditorStrings.l_EndnoteTooltipInstruction));return 32};
this.m6a=(ee,je,ue,Qf,Jg)=>2===ue?(t.ULS.shipAssertTag(4520069,308,!!Jg),t.ULS.shipAssertTag(4520070,308,!!Jg.F0a),t.ULS.shipAssertTag(4520071,308,ke.ParagraphReader.Xb(Jg.F0a)),ee=this.GE.B2a(Jg.F0a),this.n9d(ee,Jg.mie)?32:8):32;this.Rio=(ee,je,ue)=>{2===ue&&this.xD.kZ();return 32};this.wpl=(ee,je,ue,Qf,Jg)=>{if(1===ue)return 32;if(2===ue)return void 0!==Jg&&null!==Jg?this.xD.Rff(Jg,Jg):this.xD.Rff(),32;t.ULS.sendTraceTag(4520072,308,10,"{0}",{["Error"]:"FootnoteEndnoteControl not dismissed"});return 8};
this.P_m=(ee,je,ue)=>{ee=this.Q$b(je);return ee&&xe.SelectionEditor.Ze(ee)?1===ue?32:2===ue?(ue=0<this.ep.F4(ee.node).Wt,this.xD.gbf(),this.xD.dialog.Wjb=ue,32):8:(t.ULS.sendTraceTag(4743179,308,10,"Expected an IP context here."),8)};this.sIl=(ee,je,ue)=>1===ue?32:2===ue?(this.xD.dialog.Wjb=!1,32):8;this.LLn=(ee,je,ue,Qf,Jg)=>this.y2h(ee,ue,Jg);this.JLn=(ee,je,ue,Qf,Jg)=>1===ue?32:this.xD.dialog&&this.xD.dialog.fontName?(Jg[dh.a.Value]=this.xD.dialog.fontName,32):this.W_j.vPa(Nb.a.nOb.toString(),
Jg,null)?32:8;this.rIl=(ee,je,ue)=>1===ue?32:2===ue?(this.xD.dialog.Wjb=!0,32):8;this.KLn=(ee,je,ue,Qf,Jg)=>this.y2h(ee,ue,Jg);this.pIl=(ee,je,ue)=>{if(1===ue)return 32;if(2===ue){ee=this.Q$b(je);if(!ee)return t.ULS.sendTraceTag(51512524,308,10,"Selected graph node context is null"),8;je=this.GE.B2a(ee.node);this.GE.xpa(je)&&(ue=this.Lc.Pc(15),ue.Db(je),this.cGj(ee),this.ELa.Euh(je,this.xD.dialog),ue.dispose());this.xD.D7c();return 32}return 8};this.oIl=(ee,je,ue)=>{if(1===ue)return 32;if(2===ue){ee=
this.Q$b(je);if(!ee)return t.ULS.sendTraceTag(51512525,308,10,"Selected graph node context is null"),8;je=this.GE.B2a(ee.node);this.GE.xpa(je)&&(ue=this.Lc.Pc(15),ue.Db(je),this.cGj(ee),this.ELa.WEk(je,this.xD.dialog),ue.dispose());this.xD.D7c();return 32}return 8};this.qIl=(ee,je,ue)=>1===ue?32:2===ue?(this.xD.D7c(),32):8;this.mIl=(ee,je,ue,Qf,Jg)=>{if(1===ue)return 32;if(2===ue){ee=Object(Ra.a)(24,Jg);if(!ee||!ee.vd)return 8;this.xD.dialog.fontName=ee.vd.fontName;return 32}return 8};this.nIl=(ee,
je,ue,Qf,Jg)=>{if(1===ue)return 32;if(2===ue){ee=Object(Ra.a)(24,Jg);if(!ee||!ee.vd)return 8;this.xD.dialog.oXb=ee.vd;return 32}return 8};this.ga=b;this.gu=h;this.W_j=r;this.ld=B;this.GE=P;this.H3j=ca;this.ELa=ra;this.cta=Qa;this.xD=tb;this.ep=Mb;this.pXb=Zb;this.Lc=jc;this.Ok=Gc;this.Ib=Uc;this.yT=od;this.Vd=Od;this.KUj=ze;this.gQg=de}cGj(b){(b=pn.FormattingReader.Yr(b))?(this.xD.dialog.fontName||(this.xD.dialog.fontName=b.cache.FG),-1===this.xD.dialog.fontSize&&(this.xD.dialog.oXb=b.cache.fontSize)):
t.ULS.sendTraceTag(587790277,308,10,"UpdateFontAndFontSize: Received null formatting object.")}y2h(b,h,r){return 1===h&&this.xD.dialog?32:2===h&&this.xD.dialog?(r[Ui.a.On]=b===qb.a.z4f?this.xD.dialog.Wjb:!this.xD.dialog.Wjb,32):8}Tb(){Eb.App.instance.eqi([qb.a.G5d,qb.a.F5d,qb.a.I5d,qb.a.H5d,qb.a.WSf,qb.a.l8a,qb.a.wqb,qb.a.p4]);this.ga.fb(qb.a.insertFootnote,yc.a.view,this.Rsi,4);this.ga.fb(qb.a.insertEndnote,yc.a.view,this.Rsi,4);this.ga.ra(qb.a.G5d,yc.a.view,this.pgc);this.ga.ra(qb.a.WSf,yc.a.view,
this.uIl);this.ga.ra(qb.a.F5d,yc.a.view,this.pgc);this.ga.ra(qb.a.I5d,yc.a.view,this.pgc);this.ga.ra(qb.a.H5d,yc.a.view,this.pgc);this.ga.ra(qb.a.l8a,yc.a.view,this.pgc);this.ga.ra(qb.a.wqb,yc.a.view,this.pgc);this.ga.ra(qb.a.osj,yc.a.view,this.Swo);this.ga.fb(qb.a.w2h,yc.a.view,this.rIl,4);this.ga.fb(qb.a.z4f,yc.a.view,this.KLn,100);this.ga.fb(qb.a.x2h,yc.a.view,this.sIl,4);this.ga.fb(qb.a.U5i,yc.a.view,this.LLn,100);this.ga.ra(qb.a.psj,yc.a.view,this.Two);this.ga.fb(qb.a.m6a,yc.a.view,this.m6a,
96);this.ga.fb(qb.a.uPd,yc.a.view,this.Rio,96);this.ga.ra(qb.a.p4,yc.a.view,this.wpl);this.ga.fb(qb.a.AGi,yc.a.view,this.P_m,4);this.ga.fb(qb.a.t2h,yc.a.view,this.pIl,4);this.ga.fb(qb.a.u2h,yc.a.view,this.oIl,4);this.ga.fb(qb.a.v2h,yc.a.view,this.qIl,4);this.ga.fb(qb.a.sPd,yc.a.view,this.mIl,4);this.ga.fb(qb.a.T5i,yc.a.view,this.JLn,100);this.ga.fb(qb.a.tPd,yc.a.view,this.nIl,4);this.ga.fb(qb.a.c4c,yc.a.view,fy.c4c,100);this.ga.fb(qb.a.d4c,yc.a.view,fy.d4c,100)}W6f(){this.KUj.execute(b=>{b.D5(new WA);
b.D5(new ez)})}Q$b(b){b=this.MQd(b);return b?b.Pa:(t.ULS.sendTraceTag(51512526,308,10,"GetCollapsedSelectionFromContext is null"),null)}MQd(b){let h=null;b=b.view;if(!b)return t.ULS.sendTraceTag(3486740,308,10,"We expected a view here."),h;b=b.mb;if(!b)return t.ULS.sendTraceTag(51512527,308,10,"We expected that we have a selection manager here."),h;b=b.ib;if(!b||!b.length)return t.ULS.sendTraceTag(51512528,308,10,"We expected that we have a selection collection here."),h;b=b.J(0);if(!b)return t.ULS.sendTraceTag(51512529,
308,10,"We expected that we have a current selection here."),h;(h=xe.SelectionEditor.Jj(b,!1,!1))||t.ULS.sendTraceTag(3486741,308,10,"We expected a selection here.");return h}Qdm(b){return(b=b.view)?b.mb.ib.J(0):null}n9d(b,h=!0,r=!1){if(b){this.cta.Y7b();var B=b.roa;if(B){var P=B.Lb,ca=og.SelectionFactory.lJ(P.paragraph,P.cp,P.cp+1);P=this.gu.rc;if(!P)return!1;this.ld.oea(P,ca);P.Apb=150;P.E1();b=new Hp.a(b,h);ca=xi.a.Y9b(B,P);B=B.Swa(P,ca);if(!B)return t.ULS.sendTraceTag(570529814,308,15,"FootnoteEndnote presenter is null"),
!1;r||B.element?this.xD.bhg(b):(this.xD.bhg(new Hp.a(b.F0a,!1)),h&&(h=new Me.a(2,1,10,()=>{this.xD.kZ()}),this.Ib.Wb(h)));return!0}}return!1}static rZl(){return new fy(v.AFrameworkApplication.va,Eb.App.za.jb,Ma.a.instance.resolve("Box4.IGeneralCuiUser"),hb.InteractiveViewManager.instance,dz.a.instance,$t.a.instance,ey.a.instance,Lv.a.instance,ex.FootnoteEndnoteControlManager.instance,Ma.a.instance.resolve("Box4.IParagraphIndentationReader"),uw.a.instance,new Il.a,Wh.a.instance,Wg.a.instance,v.AFrameworkApplication.ua.Lq,
Ma.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ma.a.instance.Ta("Box4.Accessibility.IAccessibilityContextManager"),Ma.a.instance.Ta("Box4.IContentControlReader"))}static qZl(){return fy.rZl()}static c4c(b,h,r,B,P){if(1===r)return 32;if(2===r&&!P)return 8;Am.a.OXd(h);P.PopulationXML=hp.FontUtils.c4h(Am.a.Gie,Am.a.Mmf,qb.a.sPd);return 32}static d4c(b,h,r,B,P){if(1===r)return 32;if(2===r&&!P)return 8;P.PopulationXML=hp.FontUtils.d4h(qb.a.tPd);return 32}}Object(m.a)(fy,
"FootnoteEndnoteActor",null,[618]);class fx extends zr.a{constructor(b){super();this.rXe=b}get index(){return 1}run(){this.rXe()}bK(){this.QY()}}Object(m.a)(fx,"FootnoteEndnoteControlUpdateTracker",zr.a,[]);var dv=c(354);class XB extends dv.a{constructor(b,h,r,B,P,ca,ra,Qa){super(b,h,r,B);this.kt=()=>{this.tdd(this.Cb)};this.BI=b.container;this.ew=document.createElement("div");b.container.appendChild(this.ew);this.aH(this.ew);this.thk=P;this.Ho.execute(tb=>{tb.fZ(this.kt)});this.ILa=ca;this.GK=ra;
this.MI=Qa;this.ILa.execute(tb=>{tb.tfg(this.nc,this.BI)});this.MI&&(this.BI.style.backgroundColor=this.GK.w$b())}dispose(){super.dispose();this.Ho.instance&&this.Ho.instance.OTa(this.kt)}get Ho(){return null!=this.PAg?this.PAg:this.PAg=Ma.a.instance.Ta("Common.IZoomManager")}pC(b){this.BI.classList.add("FootnoteEndnoteViewElement");this.tdd(b.currentNode)}tdd(b){this.Ho.instance&&(this.Ho.instance.afd(this.ew),this.ew.style.width=Math.round(100/this.Ho.instance.nj)+"%");this.thk(b)}}Object(m.a)(XB,
"FootnoteEndnoteViewElement",dv.a,[]);class YB{constructor(){this._initialized=!1;this.$id=this.UBe=this.W=null;this.zIl=(b,h,r,B)=>b.x4a?new XB(b,h,r,B,P=>{ex.FootnoteEndnoteControlManager.instance.l5n(P)},this.W.Ta("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Eb.App.instance&&Eb.App.instance.dD):null}get name(){return"WordEditor.FootnoteEndnote"}wc(b){this.W=b}init(){this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>
{this.wn()})}wn(){Cm.WordSectionNavigator.instance.ZSf=Object(z.a)(ey.a.instance,ey.a.instance.rgn,"navigateToWordSectionNodeWithFootnoteEndnote");Is.a.ifg(this.zIl);ex.FootnoteEndnoteControlManager.instance.bind(Eb.App.za.tE);this.UBe=fy.qZl();this.UBe.Tb();this.UBe.W6f();Eb.App.za.updateCommandUI();this.Tzf();this._initialized=!0}dispose(){this._initialized&&(this._initialized=!1,ex.FootnoteEndnoteControlManager.instance.dispose())}Tzf(){this.$id=new fx(()=>{ex.FootnoteEndnoteControlManager.instance.udd()});
cx.a.lde(Object(z.a)(this.$id,this.$id.bK,"setUpdateNeeded"));Si.GraphTransactionManager.instance.nra(this.$id,3)}}Object(m.a)(YB,"PackageManager",null,[1,2]);class Xz{constructor(b,h,r,B){this.hb=h;this.Cfa=B}get bookmarkManager(){return this.Cfa.value}mPm(b){return ub.App.HLj?b.startsWith(F.a.ufb):!1}tpm(b){try{this.upm(b)}catch(h){t.ULS.sendTraceTag(24691935,324,10,String.format("Error parsing bookmark url. Error: {0}",h.message))}}Vng(b){return{returnValue:!1,z7f:b,wFb:""}}upm(b){if(this.bookmarkManager){b=
b.split("/");var h=this.bookmarkManager.Bwa(b[b.length-1]);h&&h.anchor?(b=this.bookmarkManager.Cwa(h,!0).Iba,h=this.bookmarkManager.Cwa(h,!1).Iba,b||h?b?this.Fnj(b):(t.ULS.sendTraceTag(35992277,324,50,"Start Anchor is missing for Bookmark"),this.Fnj(h)):(t.ULS.sendTraceTag(35992276,324,50,"Bookmark has no anchors, jumping to end"),this.qFi(!1))):(t.ULS.sendTraceTag(35992275,324,15,"Cannot find bookmark node"),this.qFi(!0))}}qFi(b){b=og.SelectionFactory.ro(Eb.App.za.jb.Zc.Y7h(),b);this.hb.Ac(b)}Fnj(b){b.paragraph&&
b.Lb?(b=og.SelectionFactory.ne(b.paragraph,b.Lb.cp),b.Svi=!0,this.hb.Ac(b)):t.ULS.shipAssertTag(35992279,324,!0,"bookmark's Paragraph or Containing Properties are missing")}}Object(m.a)(Xz,"InternalLinkManager",null,[461]);class Lr{get name(){return"WordEditor.InternalLinks"}init(){}dispose(){}wc(b){b.ia("WordEditor.InternalLinks.InternalLinkManager",()=>new Xz(new pf.a(()=>b.Oa("WordEditor.Bookmark.IBookmarkGraphManager")),b.resolve("Box4.ISelectionManager"),b.resolve("Box4.IFeatureHelper"),new pf.a(()=>
b.Oa("WordEditor.Bookmark.IBookmarkManager")),b.resolve("Box4.BookmarkParagraphMapping"))).as("Box4.IInternalLinkManager").ha()}static main(){L.a.instance.Gc(new Lr)}}Object(m.a)(Lr,"WordEditorInternalLinksPackage",null,[1,2]);class au{constructor(b){this.nMa=null;this.checkAndDeleteEphemeralOutline=h=>{h=h.customData;if(h.anchor){kh.a.mark(4763);var r=Ad.GraphIterator.eb(h);if(r.zb(8)&&r.jd(8)&&r.PCj(h)===h){if(Yg.OutlineReader.isEmpty(r)){let B=!1;for(let P=0;P<Bh.a.instance.ib.length;P++){const ca=
Bh.a.instance.ib.J(P);for(let ra=0;ra<ca.length;ra++)if(ca.J(ra).node===h){B=!0;break}}B||this.BRh(r)}kh.a.mark(4764)}}};au.FK=b}zJd(b){if(!au.Hi.k0d(b))return null;b.Ub(1)&&(b.currentNode.ol(8,!0),b.uc());const h=au.FK.kdl();au.Hi.isRtl(b.currentNode)?h.setValue(Pd.a.hr,11):h.setValue(Pd.a.hr,9);b.Bf(h,1);b.Aj(h);return h}rko(b){if(this.nMa&&b!==this.nMa){const h=new Me.a(2,1,0,this.checkAndDeleteEphemeralOutline,120);h.customData=this.nMa;v.AFrameworkApplication.lc.Wb(h)}this.nMa=b}BRh(b){this.nMa===
b.currentNode&&(this.nMa=null);const h=new cg.GraphTransaction(7);h.St(b);b.zg();h.dispose()}yEh(){if(this.nMa&&this.nMa.anchor){const b=Ad.GraphIterator.eb(this.nMa);b.Ip()&&Yg.OutlineReader.xWc(b)&&this.BRh(b);this.nMa=null}}static get Hi(){return si.PageReader.instance}}au.FK=null;Object(m.a)(au,"PageContentEditor",null,[1247]);var vw=c(1186),Aq=c(641);class Yz extends St{constructor(){super()}Qqj(b,h,r,B,P){let ca=!1,ra=!0;xe.SelectionEditor.Ze(P)&&(h=fg.ListItemReader.lg(b)&&h,P=Uf.OutlineElementReader.KA(b,
P,!1)&&!Uf.OutlineElementReader.KA(b,P,!0),h&&r.H6e(b,B)&&(ca=!0),Eb.App.zd.Uo&&(P||h&&!ca)&&(ra=!1));return{Pqj:ra,cLj:ca}}}Object(m.a)(Yz,"CursorMoveValidator",St,[]);class ro{constructor(b,h,r,B,P){this.gE=P;this.UNe=b;this.d7=B;this.ata=h;this.rh=r}get Qd(){return null!=this.NIg?this.NIg:this.NIg=Ma.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Ej(){return null!=this.yIg?this.yIg:this.yIg=Ma.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get qc(){return null!=
this.nKg?this.nKg:this.nKg=Ma.a.instance.resolve("Box4.Styles.IWACStyleReader")}get $s(){return this.d7.value}get Pf(){return this.rh.value}get dr(){return this.ata}mnm(b){const h=window.performance.now(),r=new vo.ScriptSharpLegacyMap,B=new lo.a,P=new vo.ScriptSharpLegacyMap;if(b&&b.jx){var ca=null;for(let ra=0;ra<b.length;ra++){const Qa=b.getContext(ra);ca=ca||ro.hi.su(Qa.node);let tb;if(!({groupId:tb}=this.zPo(Qa.node,ca)).returnValue)continue;let Mb;r.nb(tb)||(Mb=[],r.add(tb,Mb));Mb=r.J(tb);Mb.push(Qa)}for(const ra of Qo.toArray(r.keys))b=
r.J(ra),ca=new Ad.GraphIterator,ca.set(b[0].node),({cfj:b,jt:ca}=this.ata.XOo(ca)).returnValue?(r.Z(ra,b),P.add(ra,ca)):B.add(ra)}t.ULS.sendTraceTag(589592455,338,50,String.format("GroupGraphNodeContextForIndenationDuration: {0} ms;",window.performance.now()-h));return{returnValue:r,pnm:B,onm:P}}bCb(b){return this.nTk(b)}m4b(b){return this.LSk(b)}hFd(b,h,r=!0){return Ad.GraphIterator.lca(()=>{var B=!1;if(fg.ListItemReader.lg(b))return this.H6e(b,h,r);B||(ig.OutlineElementNavigator.Ee(b),B=ke.ParagraphReader.oh(b)||
Rh.TableReader.isTable(b),ig.OutlineElementNavigator.Yd(b),B=B&&this.lTk(b,h));return B})}H6e(b,h,r=!0){return Ad.GraphIterator.lca(()=>{const B=Uf.OutlineElementReader.xFa(b),P=Yg.OutlineReader.YX(b.currentNode);if(r?!this.PQm(b,h):!this.QQm(b,h))return!1;var ca=Ad.GraphIterator.eb(b.currentNode);if(0<h&&ca.zb(14)){ca.jd(16);var ra=ca.currentNode;const Qa=Ah.TableCellReader.nvf(ca);ca.jd(14);const tb=ca.currentNode;ca=up.a.OM(ra,tb,Mc.a.oS,Mc.a.Aa,0);ra=up.a.OM(ra,tb,Mc.a.IV,Mc.a.Ba,0);ca=xg.a.Wy(ca,
0);ra=xg.a.Wy(ra,0);return B+P<Qa-ca-ra}return!0})}lTk(b,h){const r=Uf.OutlineElementReader.xFa(b);var B=Uf.OutlineElementReader.IG(b);if(0<h){h=Yg.OutlineReader.YX(b.currentNode);B=0;const {Ko:Qa,marginLeft:tb,marginRight:Mb}=ro.pTd(b.currentNode);var P=Ad.GraphIterator.eb(b.currentNode);ig.OutlineElementNavigator.Ee(b);if(Rh.TableReader.isTable(b)){B=Rh.TableReader.Hha(b);var ca=0;for(var ra of B)ca+=ra;B=xg.a.Wy(xg.a.nf(ca,0),0)}ig.OutlineElementNavigator.Yd(b);return P.zb(14)?(P.jd(16),ra=P.currentNode,
b=Ah.TableCellReader.nvf(P),P.jd(14),ca=P.currentNode,P=up.a.OM(ra,ca,Mc.a.oS,Mc.a.Aa,0),ra=up.a.OM(ra,ca,Mc.a.IV,Mc.a.Ba,0),P=xg.a.Wy(P,0),ra=xg.a.Wy(ra,0),r+h<b-P-ra-B):r+h<Qa-tb-Mb-B}return 0<r-B}oTa(b,h){this.A_i(b,-1*Math.abs(h))}ILc(b,h){this.A_i(b,Math.abs(h))}mnl(b,h,r,B,P){let ca=ro.lPi;if(h>=ro.lPi){ca=h-=r;const ra=B*P,Qa=Math.abs(ra),tb=Math.abs(h)%Qa;tb&&(ca=0>ca?0>B?ca+tb:ca-(Qa-tb):0<B?ca-tb:ca+(Qa-tb));ca+=ra;ca+=r;ro.j$d&&(r=Uf.OutlineElementReader.F4(b),ca=ro.j$d.d7h(b.currentNode,
h+r,ca+r,P,ca<h)-r)}return ca}jTk(b,h,r){if(!b||!b.length)return!1;h=r?h?-1:1:this.R8h(b[0].node,h);return this.kTk(b,h,r)}qyn(b,h,r){if(!b)return t.ULS.shipAssertTag(589345600,338,!1,"The group of listOEs are null which are sent for indentation."),8;if(!b.length)return t.ULS.shipAssertTag(589345601,338,!!b.length,"The group of listOEs are empty which are sent for indentation."),8;if(!r)return t.ULS.shipAssertTag(589592458,338,!1,"The listIds are null which are sent for indentation."),8;if(!r.length)return t.ULS.shipAssertTag(589592459,
338,!1,"The listIds are empty which are sent for indentation."),8;const B=b[0].node;h=this.R8h(B,h);if(!this.Den(B,r[0],h)||!this.Aen(b,h))return 8;this.$s.r6();return 32}Aen(b,h){for(let r=0;r<b.length;r++){const B=new Ad.GraphIterator;B.set(b[r].node);let P=null;ig.OutlineElementNavigator.Ee(B);if(ke.ParagraphReader.oh(B)){if(P=B.currentNode,!P)return t.ULS.shipAssertTag(589592461,338,!P,"The paraNode is null for the list OE node"),!1}else if(!ke.ParagraphReader.oh(B)&&!Rh.TableReader.isTable(B))return t.ULS.shipAssertTag(589592460,
338,!1,"The content of the listOE is neither a paragraph nor a table node"),!1;B.uc();if(P){if(this.rsm(P)){const ca=P.$D(),ra=Uf.OutlineElementReader.xFa(B);this.Pf.Iza(B,1,ra+h);ca&&this.Ej.DV(P,ca,this.Qd.xg)}Ym.a.getInstance().Ov||P.setValue(Pd.a.NR,new Date)}}return!0}Den(b,h,r){for(let B=0;B<gk.a.f5;B++){const P=this.ata.Mx(b,h,B);if(!P)return t.ULS.shipAssertTag(589345602,338,!1,"The list defs returned is null for listId : {0}",h),!1;const ca=P.getValue(Mc.a.ee);ca&&P.setValue(Mc.a.ee,ca+r)}return!0}rsm(b){return b.hasProperty(Mc.a.ee)||
b.hasProperty(Mc.a.ot)||b.hasProperty(Mc.a.RA)}LSk(b){return this.hFd(b,1,!0)}nTk(b){return this.hFd(b,-1,!0)}R8h(b,h){var r=new Ad.GraphIterator;r.set(b);const B=Uf.OutlineElementReader.xFa(r),P=Uf.OutlineElementReader.IG(r),ca=Uf.OutlineElementReader.F4(r);r=Yg.OutlineReader.YX(b);ro.pTd(b);b=(P?B-P:ca)%r;return h?-1*(b?b:r):r-b>ro.wQh?ro.wQh:r-b}zPo(b,h){let r;const B=new Ad.GraphIterator;B.set(b);b=B.Ub(4).getValue(Mc.a.listID);return({id:r}=this.ata.qoc(b,h)).returnValue?{returnValue:!0,groupId:r}:
{returnValue:!1,groupId:r}}kTk(b,h,r){var B=!1;for(let P=0;P<b.length;P++){B=b[P];const ca=new Ad.GraphIterator;ca.set(B.node);xe.SelectionEditor.zu(ca);if(!Uf.OutlineElementReader.Eh(ca))return ro.Ic.Yb(le.a.ef,{["Reason"]:ae.a.gEb}),!1;if(this.hFd(ca,h,r))B=!0;else return ro.Ic.Yb(le.a.f7b,{["Reason"]:ae.a.Z6e}),!1}return B}A_i(b,h){if(this.hFd(b,h,!0)){var r=!1;if(fg.ListItemReader.lg(b)){var B=new Ad.GraphIterator;B.kd(b);this.dr.HP(B);var P=B.currentNode;B.uc();r=!0;const {listId:ra,listLevel:Qa}=
fg.ListItemReader.AGb(b);var ca=this.Bfm(ra,Qa+h);if(ca)ig.OutlineElementNavigator.Ee(B),ke.ParagraphReader.oh(B)&&ro.uE.aK(ca,B.currentNode,!1),B.uc();else{ca=null;let tb;ig.OutlineElementNavigator.Ee(B);ke.ParagraphReader.oh(B)&&(ca=B.currentNode);B.uc();tb=ca?ca.$D():null;ca||(ig.OutlineElementNavigator.Ee(B),ke.ParagraphReader.oh(B)&&(ca=B.currentNode),B.uc());ca&&(ca.hasProperty(Mc.a.ee)&&ca.removeProperty(Mc.a.ee),ca.hasProperty(Mc.a.ot)&&ca.removeProperty(Mc.a.ot));Ym.a.getInstance().Mz||this.gE.TSb(P,
Qa+h);Ym.a.getInstance().Ov&&this.gE.TSb(ca,Qa+h);Ym.a.getInstance().Mz||P.removeProperty(Mc.a.X0);ca&&tb&&(this.Ej.DV(ca,tb,this.Qd.xg),this.$s.r6());this.HGo(b,P)}}r||(r=Uf.OutlineElementReader.xFa(b),B=Uf.OutlineElementReader.IG(b),P=Yg.OutlineReader.YX(b.currentNode),h=this.mnl(b,r,B,h,P),this.Pf.Iza(b,1,h))}}QQm(b,h){const r=Uf.OutlineElementReader.xFa(b),B=Uf.OutlineElementReader.IG(b),P=Uf.OutlineElementReader.F4(b),{Ko:ca,marginLeft:ra,marginRight:Qa}=ro.pTd(b.currentNode);if(0<h){if(b=ca-
ra-Qa,P&&P+h+Eb.App.BAa>b||r+h+Eb.App.BAa>b)return!1}else if(P&&0>r+h||0>r-B+h)return!1;return!0}PQm(b,h){var r=this.$s.EB(b);const B=r.level+h;if(ls.a.q_m<B||B<ls.a.YFl)return!1;r=this.dr.Mx(b.currentNode,r.listID,B);if(!r)return t.ULS.shipAssertTag(590700875,338,!!r),!1;if(0<h&&r.hasProperty(Mc.a.ee)){h=r.getValue(Mc.a.ee);const {Ko:P,marginLeft:ca,marginRight:ra}=ro.pTd(b.currentNode);if(h+Eb.App.BAa>P-ca-ra)return!1}return!0}Bfm(b,h){const r=this.qc.Cr();for(let B=0;B<r.EO;B++){const P=r.IFa(B);
if(this.dr.mhb(P)&&P.ja(Mc.a.listID,this.$s.H9+1)===b&&P.ja(Mc.a.listLevel,-1)===h)return P}return null}HGo(b,h){ig.OutlineElementNavigator.Ee(b);if(ke.ParagraphReader.oh(b)&&b.currentNode.hasProperty(Mc.a.ee)&&(h=this.dr.g$b(h))){if(h.hasProperty(Mc.a.ot)){var r=h.getValue(Mc.a.ot);this.UNe.Tpb(b.currentNode,r)}h.hasProperty(Mc.a.ee)&&(r=h.getValue(Mc.a.ee),this.UNe.Iza(b,1,r));h.hasProperty(Mc.a.RA)&&(h=h.getValue(Mc.a.RA),this.UNe.jea(b.currentNode,h))}ig.OutlineElementNavigator.Yd(b)}static get uE(){return null!=
ro.OJg?ro.OJg:ro.OJg=Ma.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get j$d(){return null!=ro.aGg?ro.aGg:ro.aGg=Ma.a.instance.Oa("WordEditor.ParagraphIndentationUtility")}static get Tk(){return ro.Ys||(ro.Ys=Ma.a.instance.resolve("Box4.IParagraphEditor"))}static set Tk(b){ro.Ys=b}static get Ic(){return Nh.a.instance}static get Uf(){return Rn.a.instance}static get hi(){return qo.PageNavigator.instance}static pTd(b){var h=Cm.WordSectionNavigator.instance.yL(b);b=ro.Uf.qu(h);const r=ro.Uf.CJ(h);
h=ro.Uf.mL(h);return{Ko:b,marginLeft:r,marginRight:h}}}ro.wQh=Ze.a.Nv(.25);ro.Ys=null;ro.lPi=Ze.a.Nv(-11);Object(m.a)(ro,"OutlineElementIndentationEditor",null,[463,464]);var Zz=c(234),ev;(function(b){b[b.none=0]="none";b[b.character=1]="character";b[b.paragraph=2]="paragraph";b[b.table=3]="table"})(ev||(ev={}));Object(m.b)("StyleTargetType",ev);var ww=c(218);class fz{constructor(b,h){this.hX=null;this.CK=h;this.Hf=b}get Tk(){return null!=this.JFg?this.JFg:this.JFg=Ma.a.instance.resolve("Box4.IParagraphEditor")}get VH(){return null!=
this.jAg?this.jAg:this.jAg=Ma.a.instance.resolve("Box4.IFontStylesGalleryCache")}get jo(){return null!=this.CHg?this.CHg:this.CHg=Ma.a.instance.Oa("Box4.Styles.StyleSettings")}get qn(){return null!=this.BAg?this.BAg:this.BAg=Ma.a.instance.resolve("Box4.IFormattingEditor")}get qc(){return null!=this.qKg?this.qKg:this.qKg=Ma.a.instance.resolve("Box4.Styles.IWACStyleReader")}get Qea(){return this.hX||(this.hX=new Aq.WACStyleSet)}set Qea(b){this.hX=b}get Zb(){return null!=this.Nzg?this.Nzg:this.Nzg=Ma.a.instance.Oa("Box4.IFeatureHelper")}get Qn(){return this.CK.value}get Bj(){return null!=
this.FBg?this.FBg:this.FBg=Ma.a.instance.Oa("Box4.IInsertionPointFormatting")}get m_c(){return this.Hf||(this.Hf=Ma.a.instance.resolve("Box4.List.IListReader"))}get jg(){return null!=this.gxg?this.gxg:this.gxg=Ma.a.instance.resolve("Box4.ICharacterPropertiesEditor")}get Qd(){return null!=this.dJg?this.dJg:this.dJg=Ma.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Ej(){return null!=this.EIg?this.EIg:this.EIg=Ma.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get xR(){return null!=
this.VAg?this.VAg:this.VAg=Ma.a.instance.resolve("Box4.IBox4GraphWriter")}Jfm(b){const h=b.node;var r=this.Bj?this.Bj.I6h():null;if(r&&!r.equals(V.a.nil)){b=h.Mc;if(!b)return null;r=b.Eb(r);if(!r||(r=new ww.a(r),1!==this.qc.LG(r)))return null}else r=pn.FormattingReader.Yr(b),r=pn.FormattingReader.Toa(r);return r}ioo(b,h){const r=this.qc.JB(h);r&&r.oj(this.qc.Ag(b))&&(this.qqg(h,r),this.Bj&&(this.Bj.p7a(),this.Bj.c8a(b,h)))}wEk(b,h){if(h)if(h.vFb&&0<h.vFb.length){let P=new fa.a;for(var r of h.vFb)P.add(r);
if(h.vFi){r=pn.FormattingReader.V4h(b);const ca=[];for(var B of r)B.formatting&&B.formatting.Jn&&ca.push(B.formatting.Jn);if(0<ca.length){B=iw.APropertySet.jbi(ca);r=new fa.a;for(const ra of P)(!B.hasProperty(ra)||h.dZm&&ra===dd.a.cKa)&&r.add(ra);P=r}}this.Tk.sCb(b,!0,P)}else this.Tk.sCb(b,!0);else Qc.b(576582787,3018,15,"Cannot apply alternate formatting strategy as ClearSpecificFormattingProperties is null")}aK(b,h,r,B=!1,P=!1,ca=!1,ra=null,Qa=!1){var tb,Mb,Zb,jc,Gc;(null===(tb=v.AFrameworkApplication.K)||
void 0===tb?0:tb.$("RefactorListCodeIsEnabled"))||(Qa=!1);if(ke.ParagraphReader.Xb(h))if(b)if(this.qc.oda(b.Gl()))if(2!==this.qc.LG(b))t.ULS.shipAssertTag(593506381,324,!1);else{var Uc=this.qc.JB(h);if(Uc)if(tb=this.qc.Ag(b),!tb)t.ULS.shipAssertTag(593506377,324,!1);else{if(Uc.oj(tb)){var od=null,Od=sq.a.instance.J(1)&&!B?h.$D():null;r||((null===ra||void 0===ra?0:ra.CSk)&&(null===(Mb=this.Zb)||void 0===Mb?0:Mb.isFeatureEnabled(101))?(this.wEk(h,ra),zm.a.Xj&&1==ra.vFb.length&&ra.vFb[0]==dd.a.cKa?od=
this.Qn.V7i(od,h):this.UXo(h,b,ra)):(od=this.Qn.V7i(od,h),this.Tk.sCb(h,!0)));this.qqg(h,Uc);P&&(null===Od||void 0===Od?0:Od.hasProperty(gi.a.Vv))&&Od.removeProperty(gi.a.Vv);fg.ListItemReader.qk&&(h.removeProperty(gi.a.Vv),h.RL=null,this.Onj(b,h,od,Qa));(null===(Zb=this.xR)||void 0===Zb?0:Zb.K$)?this.xR.K$(h,gi.a.Vv,b.id):h.properties.setValue(gi.a.Vv,b.id);zm.a.Xj&&(Qa||this.m_c.Aca(h))&&(null===(jc=this.Zb)||void 0===jc?0:jc.isFeatureEnabled(101))&&this.RFj(h,b,ra);h.RL=b;h.hJa=null;for(r=0;r<
h.qa.length;r++)h.qa.J(r).formatting&&h.qa.J(r).formatting.QIb();fg.ListItemReader.qk||this.Onj(b,h,od,Qa);(null===(Gc=this.jo)||void 0===Gc?0:Gc.B9)&&null!=this.VH&&this.VH.cmc(tb);B||!Od||ca||this.Ej.DV(h,Od,this.Qd.xg);fg.ListItemReader.qk&&this.m_c.mhb(b)&&this.Qn.r6()}}else t.ULS.shipAssertTag(593506379,324,!1)}else t.ULS.shipAssertTag(593506382,324,!1);else t.ULS.shipAssertTag(593506383,324,!1);else t.ULS.shipAssertTag(593506384,324,!1)}Onj(b,h,r,B){this.m_c.mhb(b)&&(r||(r=new Ad.GraphIterator,
r.set(h),r.qd(),ig.OutlineElementNavigator.Yd(r)),B||fg.ListItemReader.lg(r)||(h.Cg(Mc.a.ee,Mc.a.hN,Mc.a.RA,Mc.a.p1,Mc.a.dTa,Mc.a.Bw),this.tDd(r,b)))}UXo(b,h,r){const B=this.m_c.Aca(b),P=this.m_c.mhb(h);B&&(this.RFj(b,h,r),P||B.removeProperty(Mc.a.X0))}RFj(b,h,r){const B=b.Mc;if(b=this.jg.J1a(b)){var P=null==b.Jn?new Zz.a:b.Jn.clone();Ck.a.cZo(P,h,r&&!r.vFi&&r.vFb?r.vFb:null);P.PGa?h=B.rV(P,!0):(B.Uu(P,null),h=P);b.Yj=h.id}else t.ULS.sendTraceTag(574660761,3018,15,"EOP formatting is null, skipping application on EOP.")}tDd(){}W9c(b,
h){if(h){t.ULS.shipAssertTag(593506371,324,h.isConnected,"paragraphNode not connected");var r=this.qc.JB(h);r?(b=r.JFa(b))?this.qc.oda(b.Gl())?this.aK(b,h,!1,void 0,void 0,void 0,null):t.ULS.shipAssertTag(593506368,324,this.qc.oda(b.Gl())):t.ULS.shipAssertTag(593506369,324,!!b):t.ULS.shipAssertTag(593506370,324,!1,"StyleReader.GetStyleSetFromParagraphNode==null")}else t.ULS.shipAssertTag(593506372,324,!1)}q8e(b,h=!1,r=!1){const B=this.qc.JB(b).oj(Hl.StyleReader.wordStyleIdNormal);this.aK(B,b,h,void 0,
r)}qqg(b,h){(b=fz.hi.su(b))&&h.Lhe(b)}tRh(b){var h=null;if(this.Zb&&this.Zb.isFeatureEnabled(36)){if(!b||!b.count)return t.ULS.sendTraceTag(592221652,3018,10,"No style IDs provided for delete."),!1;if(!h&&(h=Ck.a.Ar(),!h))return t.ULS.sendTraceTag(592221653,3018,15,"Couldn't retreive PageContentNode."),!1;var r=this.Qea.fY(h);if(!r)return t.ULS.sendTraceTag(592221654,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;var B=new Map;B.set("NumberOfStyles",b.count.toString());B.set("Source",
"DeleteStyleAPI");va.Health.instance.recordKpiUsage(yo.a.Spe,0,yo.a.yB,B);B=0;const ra=(new Date).getTime();var P=null;let Qa=null,tb=null,Mb=null;const Zb=this.Zb.isFeatureEnabled(35)&&!0;Zb&&(P=new mb.a,Qa=new mb.a,tb=new mb.a,Mb=new mb.a);for(var ca of b){if(!ca)return t.ULS.sendTraceTag(592221655,3018,50,"Style ID is null."),!1;const jc=r.oj(ca);if(!jc||!this.qc.le(jc,r))return t.ULS.sendTraceTag(592221656,3018,50,"Provided style is null[{0}] or not a custom style [{1}].",!jc,!!jc&&this.qc.le(jc,
r)),!1;const Gc=this.qc.LG(jc);if(2!==Gc&&1!==Gc)return t.ULS.sendTraceTag(592221657,3018,50,"Provided style has style type: {0}.",Gc),!1;const Uc=this.qc.Lwa(jc,r);let od=0;if(Uc){if(!this.qc.le(Uc,r))return t.ULS.sendTraceTag(571074068,3018,15,"Provided custom style's linked style is not a custom style."),!1;od=this.qc.LG(Uc);if(2!==od&&1!==od)return t.ULS.sendTraceTag(592221659,3018,15,"Provided style's target type: {0}, linked style's target type: {1}. ",Gc,od),!1}else t.ULS.sendTraceTag(592221658,
3018,50,"Provided style's linked style is null.");let Od=this.TDb(jc,r);if(!Od)return!1;B++;Zb&&(1===Gc?(Qa.add(ca),Mb.add(jc.id)):(P.add(ca),tb.add(jc.id)));if(Uc){Od=this.TDb(Uc,r);if(!Od)return!1;B++;Zb&&(1===od?(Qa.add(this.qc.Ag(Uc)),Mb.add(Uc.id)):(P.add(this.qc.Ag(Uc)),tb.add(Uc.id)))}}Cj.a.EVc();r=Ck.a.Zuf(r);ca=new cg.GraphTransaction(15);ca.Db(h);Zb&&this.S0n(P,Qa,tb,Mb,h);h.setValue(gi.a.VUa,r);Qc.b(572302817,3018,50,String.format("Style Object Ids - {0}",r));ca.Ige();ca.dispose();h=(new Date).getTime();
P=new Map;P.set("Source","DeleteStyleAPI");P.set("NumberOfStyles",b.count.toString());P.set("TrueStyleCount",B.toString());P.set("ShouldRemoveReferences",(!0).toString());b=Object.assign(new hc.a,{extendedProperties:P,durationMs:h-ra});va.Health.instance.recordKpiSuccess(yo.a.Spe,b);return!0}return!1}S0n(b,h,r,B,P){if(b&&b.count||h&&h.count)if(P){var ca=(new Date).getTime();if(P=this.sWl(P)){for(;P.moveNext();){if(!ke.ParagraphReader.oh(P.iterator))continue;const ra=P.currentNode;this.C0n(ra,b,r);
this.D0n(ra,h,B)}r=(new Date).getTime();t.ULS.sendTraceTag(591148963,3018,50,String.format("RemoveStyleReferences Duration: {0} ms;",r-ca));B=new Map;B.set("Source","DeleteStyleRemoveStylesReferences");B.set("NumberOfStyles",(b.count+h.count).toString());b=Object.assign(new hc.a,{extendedProperties:B,durationMs:r-ca});va.Health.instance.recordKpiSuccess(yo.a.Spe,b)}}else Qc.b(577520338,3018,50,"PageContentNode not provided.");else Qc.b(577520337,3018,50,"No style IDs provided")}C0n(b,h,r){if(h&&h.count&&
b){var B=b.Xy;B&&B.hasProperty(gi.a.Vv)&&r.contains(B.getValue(gi.a.Vv))&&(B.removeProperty(gi.a.Vv),b.Xy=B,b.$D()&&this.Ej.DV(b,b.$D(),this.Qd.xg));(r=this.qc.So(b))&&(r=this.qc.Ag(r))&&h.contains(r)&&this.q8e(b,!0,!0)}}D0n(b,h,r){if(b&&b.qa&&b.qa.length&&h&&h.count)for(let ra=0;ra<b.qa.length;ra++){var B=b.qa.J(ra);if(B&&B.formatting&&(B=B.formatting)&&B.Lb){var P=pn.FormattingReader.Toa(B);P&&(P=this.qc.Ag(P))&&h.contains(P)&&this.qn.h8e(B);if(P=B.Lb.io){var ca=P.Jn;ca&&(ca=ca.clone(),ca.hasProperty(gi.a.qw)&&
r.contains(ca.getValue(gi.a.qw))&&this.LZn(b,ca,P,B));sq.a.instance.J(1)&&(ca=ra===b.qa.length-1?b.characterData.length:b.qa.J(ra+1).cp,this.Ej.kQb(b,B.Lb,B.Lb.cp,ca,P,B,this.Qd.xg))}}}}LZn(b,h,r,B){b&&h&&r&&B&&(b=b.Mc)&&(h.removeProperty(gi.a.qw),h.PGa?h=b.rV(h,!0):b.Uu(h,null),r.Yj=h.id,B.Lb.io=r)}sWl(b){if(!b)return null;b=Ad.GraphIterator.eb(b);return b.Ip()?Ab.a.Gs(b,b.origin):null}TDb(b,h){if(!b)return t.ULS.sendTraceTag(592221660,3018,10,"WACStyle for given style ID is null."),!1;var r=b.Gl();
return this.qc.oda(r)?h.R0n(b)?!0:(r=new Map,r.set("Source","DeleteStyle"),r.set("StyleType",ev[this.qc.LG(b)]),r.set("IsCustomStyle",this.qc.le(b,h).toString()),r.set("IsLinkedStyle",(!!this.qc.Lwa(b,h)).toString()),b=Object.assign(new hc.a,{extendedProperties:r}),va.Health.instance.recordKpiFailure(yo.a.Spe,"UnableToDeleteStyle",!1,!0,b),t.ULS.sendTraceTag(592221662,3018,50,"Couldn't remove style from style set."),!1):(t.ULS.sendTraceTag(592221661,3018,50,"Invalid property set inside WACStyle."),
!1)}ASa(b,h,r,B){if(this.Zb&&this.Zb.isFeatureEnabled(82)){if(!b)return t.ULS.sendTraceTag(591138959,3018,15,"No style IDs provided for delete."),!1;if(!r&&(r=Ck.a.Ar(),!r))return t.ULS.sendTraceTag(591138960,3018,15,"Couldn't retreive PageContentNode."),!1;const ca=this.Qea.fY(r);if(!ca)return t.ULS.sendTraceTag(591138961,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;b=ca.oj(b);if(!b)return t.ULS.sendTraceTag(591138962,3018,50,"Provided style is null[{0}].",!b),!1;var P=this.qc.LG(b);
if(2!==P&&1!==P)return t.ULS.sendTraceTag(591138963,3018,50,"Provided style has style type: {0}.",P),!1;va.Health.instance.recordKpiUsage(yo.a.Esg,0,yo.a.yB,new Map([["Source","ModifyStyleAPI"]]));P=Date.now();const ra=new cg.GraphTransaction(15);let Qa,tb;try{ra.Db(r);if(!(B&&0!=B.length||h&&0!=h.count))return!1;if(B&&0!=B.length&&(Qa=Ck.a.LSd(b),!ca.ull(b,B)))return this.eya("ModifyStyleAPI",b,ca,P,"UnableToDeleteStyleProperties"),!1;if(h&&0!=h.count){const Uc=ca.b_o(b,h);tb=Ck.a.LSd(b);if(!Uc)return this.eya("ModifyStyleAPI",
b,ca,P,"UnableToModifyStyle"),!1}this.Fen(b,r,tb,Qa);Cj.a.EVc();const Mb=Ck.a.Zuf(ca);r.setValue(gi.a.VUa,Mb);Qc.b(572302818,3018,50,String.format("Style Object Ids - {0}",Mb));const Zb=Date.now(),jc=new Map([["Source","ModifyStyleAPI"]]),Gc=Object.assign(new hc.a,{extendedProperties:jc,durationMs:Zb-P});va.Health.instance.recordKpiSuccess(yo.a.Esg,Gc);return!0}finally{ra&&ra.dispose()}}return!1}Fen(b,h,r,B){var P,ca;if(null!==b){var ra;B&&((ra=null===(P=this.Qn)||void 0===P?void 0:P.yoe(h,B,b,!0))||
Qc.b(522856385,3018,50,"Cannot able to remove the pstyle property in list def during modify style."));r&&((ra=null===(ca=this.Qn)||void 0===ca?void 0:ca.yoe(h,r,b,!1))||Qc.b(522856386,3018,50,"Cannot able to modify the pstyle property in list def during modify style."))}}eya(b,h,r,B,P){const ca=Date.now();b=new Map([["Source",b],["StyleType",ev[this.qc.LG(h)]],["IsCustomStyle",this.qc.le(h,r).toString()],["IsLinkedStyle",(!!this.qc.Lwa(h,r)).toString()]]);B=Object.assign(new hc.a,{extendedProperties:b,
durationMs:ca-B});va.Health.instance.recordKpiFailure(yo.a.Esg,P,!1,!0,B)}static get hi(){return qo.PageNavigator.instance}}Object(m.a)(fz,"WACStyleEditor",null,[1142]);class XA extends fz{constructor(b,h,r){super(b,r);this.d7=h}get $s(){return this.d7.value}tDd(b,h){this.$s.tDd(b,h)}}Object(m.a)(XA,"WACStyleEditor",fz,[]);class YA{X7a(b,h){b.properties.setValue(Mc.a.marginTop,h)}V7a(b,h){b.properties.setValue(Mc.a.marginBottom,h)}aka(b,h){b.properties.setValue(Mc.a.marginLeft,h)}W7a(b,h){b.properties.setValue(Mc.a.marginRight,
h)}jeg(b,h){b.properties.setValue(Mc.a.Ko,h)}ieg(b,h){b.properties.setValue(Mc.a.tv,h)}tmj(b,h){b.properties.setValue(Mc.a.IFi,h)}gQb(b,h){b.properties.setValue(dd.a.aF,h)}nho(b,h){b.properties.setValue(dd.a.una,h)}$kc(b,h){b.properties.setValue(dd.a.tG,h)}Mno(b,h){b.properties.setValue(dd.a.separator,h)}}Object(m.a)(YA,"WordSectionEditor",null,[462]);class Mv{get name(){return"WordEditor.OutlineLevelEditors"}wc(b){b.ia("WordEditor.OutlineLevelEditors.WordSectionEditor",()=>new YA).as("Box4.IWordSectionEditor").ha();
v.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&(b.ia("Box4.OutlineLevelEditors.PageContentEditor",()=>new au(b.resolve("Box4.IOutlineEditor"))).as("Box4.Pages.IPageContentEditor").ha(),b.ia("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new ro(Tt.a.mQa,b.resolve("WordEditor.List.IFlatListReader"),b.Ve("Box4.IOutlineElementEditor"),b.Ve("WordEditor.IFlatListEditor"),b.resolve("Box4.List.ListItemEditor"))).as("Box4.IOutlineElementIndentationEditor"),
b.ia("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new ro(Tt.a.mQa,b.resolve("WordEditor.List.IFlatListReader"),b.Ve("Box4.IOutlineElementEditor"),b.Ve("WordEditor.IFlatListEditor"),b.resolve("Box4.List.ListItemEditor"))).as("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"),b.ia("WordEditor.OutlineLevelEditors.CursorMoveValidator",()=>new Yz).as("Box4.List.ICursorMovementValidator").ha(),b.ia("Box4.Styles.WACStyleReader",()=>new vw.a(new Aq.WACStyleSet)).as("Box4.Styles.IWACStyleReader").ha(),
b.ia("WordEditor.OutlineLevelEditors.WACStyleEditor",()=>new XA(b.resolve("Box4.List.IListReader"),b.Ve("WordEditor.IFlatListEditor"),b.Ve("Box4.List.IListEditor"))).as("Box4.Styles.IWACStyleEditor").ha())}init(){}dispose(){}static main(){L.a.instance.Gc(new Mv)}}Object(m.a)(Mv,"WordEditorOutlineLevelEditorsPackage",null,[1,2]);var Bu=c(598),ZB=c(217);class Zm{constructor(b,h){this.Jd=b;this.rh=h;this.UMa=null}khe(b){var h=b.propertySet.ja(Mc.a.listID,0);const r=b.propertySet.ja(Mc.a.listLevel,-1);
if(0<h&&0<=r)this.UMa=b;else{let B=1;const P=b.listStyle;42!==P&&0<P&&(B=P);this.UMa=Vp.a.c0(b.listType,B,null,h,r,void 0,"")}h=new Sz.a;switch(b.n6){case 0:this.UMa.YB=h.Zaf();break;case 2:this.UMa.YB=h.ALh(h.Jzh,h.Izh);break;case 1:this.UMa.YB=h.Pbf(h.FUf,h.GUf)}}jmo(b){b&&(this.UMa=b)}OMh(b){const h=Nh.a.instance.Fp(Nb.a.Ubl);Uf.OutlineElementReader.Eh(b)||(t.ULS.sendTraceTag(508904658,393,15,"PossiblyIncorrectListCreation - createList called with a non OE iterator"),Nh.a.instance.Yb("PossiblyIncorrectListCreation",
{["Reason"]:ae.a.gEb}));fg.ListItemReader.lg(b)&&(t.ULS.sendTraceTag(508904657,393,15,"PossiblyIncorrectListCreation - createList called when OE already has list"),Nh.a.instance.Yb("PossiblyIncorrectListCreation",{["Reason"]:ae.a.r5k}));const r=Uf.OutlineElementReader.AU(b);r&&!r.hasProperty(Mc.a.jwa)&&t.ULS.sendTraceTag(560563602,393,50,"Paragraph has null EOP formatting during creation of list node.");const B=this.Ybl();b.Bf(B,4);r&&(r.ND=B);h.end();return B}Ybl(){return Jo.a.instance.createInstance(393234)}Yda(b){const h=
Nh.a.instance.Fp(Nb.a.Yda);Uf.OutlineElementReader.Eh(b)||Nh.a.instance.Yb("PossiblyIncorrectListRemoval",{["Reason"]:ae.a.gEb});fg.ListItemReader.lg(b)&&(Ym.a.getInstance().Ov?this.oIa(b):this.Laj(b));h.end()}Laj(b){this.Jd.HP(b);b.zg()}Uma(b,h,r,B=!1){const P=Nh.a.instance.Fp(Nb.a.DEk);this.pnj(b,r,B);const ca=b.hasProperty(Yc.a.KQi);var ra=b.ja(Yc.a.nZd,!1);let Qa=!1;1===r.ks&&r.Ppa&&!r.OJ&&(Qa=!0);const tb=r.propertySet.ja(Mc.a.pv,null);tb&&tb===Box4Intl.Box4Strings.L_ListStyleNone&&(1===r.listType?
Qa=r.Ppa&&!r.OJ:r.listType||(Qa=!r.listStyle));if(ra)Qa&&(r.I$(16,0),b.setValue(Yc.a.MA,16),b.setValue(Yc.a.eSa,0));else{ra=this.Jd.vw(h);this.Arj(r,ra,ca,Qa)&&(P.properties.Z("ToggledOff","true"),r.I$(16,0),this.Zko(b));if(!this.L$d(b,h,r,B))return P.end(),t.ULS.sendTraceTag(578331472,393,15,"Failed in performing auto correct numbering."),{returnValue:!1,txa:r};!r.listType&&b.hasProperty(Yc.a.q5a)&&(r.gC=b.getValue(Yc.a.q5a),b.removeProperty(Yc.a.q5a))}if(ca&&(P.properties.Z("MultipleOESelection",
"true"),({txa:r}=this.Iuo(h,r)).returnValue))return P.end(),t.ULS.sendTraceTag(578331473,393,15,"Multiple OE selected and OE is empty as well."),{returnValue:!1,txa:r};this.sAk(h,r,b,B);QA.a.uej();b.hasProperty(lh.a.OQ)&&QA.a.x9k(b.getValue(lh.a.OQ),h,this.Jd);b.setValue(Yc.a.nZd,!0);P.end();return{returnValue:!0,txa:r}}Arj(b,h,r,B){if(B)return!0;if(h){B=b.listType===h.listType;const P=!b.listStyle&&b.gC===gk.a.im;let ca=b.listStyle===h.listStyle&&b.gC===h.gC;b=(!b.Ppa||this.Sag(h,b))&&!r;ca=ca&&
b;return B&&(P||ca)}return!1}Zko(b){b.setValue(Yc.a.MA,16);b.setValue(Yc.a.eSa,0)}Sag(){return!0}pnj(){}L$d(){return!0}Iuo(b,h){return{returnValue:16!==h.listType&&Uf.OutlineElementReader.isEmpty(b,!0),txa:h}}MIc(b){const h=Nh.a.instance.Fp(Nb.a.MIc);ke.ParagraphReader.Xb(b)||Nh.a.instance.Yb("ClearingListFromNonParagraph",{["Reason"]:ae.a.Ngf});const r=new Ad.GraphIterator;r.set(b);r.qd();r.rt(12);ig.OutlineElementNavigator.Yd(r);this.oIa(r);h.end()}merge(b,h,r){const B=Nh.a.instance.Fp(Nb.a.O1m);
Uf.OutlineElementReader.Eh(h)||Nh.a.instance.Yb("PossibleIncorrectMergeOfOEs",{["Reason"]:"SrcIsNotOE"});Uf.OutlineElementReader.Eh(b)||Nh.a.instance.Yb("PossibleIncorrectMergeOfOEs",{["Reason"]:"DestIsNotOE"});fg.ListItemReader.lg(h)&&(B.properties.Z("UseSourceListWithNonlistDestination",r.toString()),r&&fg.ListItemReader.lg(b)&&this.Yda(b),fg.ListItemReader.lg(b)&&!r?this.X4i(h,b):r&&(r=this.Vbi(h),1===r.ks&&r.U7e(!0),this.JGc(b,r),B.properties.Z("MoveListInfoFromSrcToDestOE","true")),this.Yda(h),
B.properties.Z("RemoveListFromSrcOE","true"));B.end();return!0}X4i(){}Vbi(b){return this.Jd.vw(b)}xNc(b,h){h.hasProperty(Yc.a.MA)||(b===Nb.a.rD?h.setValue(Yc.a.MA,1):(b===Nb.a.LL||b===Nb.a.Cda)&&h.setValue(Yc.a.MA,0));h.hasProperty(Yc.a.eSa)||h.setValue(Yc.a.eSa,0);return h}D3b(b,h,r,B,P,ca,ra,Qa){const tb=Nh.a.instance.Fp(Nb.a.D3b),Mb=this.Jd.vw(h);r=Vp.a.c0(0,r,void 0,void 0,void 0,ra);r.gC=B;r.OQ=ca;Mb&&r.$yf(Mb)&&r.gC===Mb.Qu||(B=new cg.GraphTransaction(15),B.St(h),Qa.Gjn(r.listType,r.listStyle,
r.gC,r.levelText,r.OQ)&&(Zm.jg.Ge(P,""),ke.ParagraphReader.Xb(b)&&ZB.a.Bpa(b)&&(h=this.Jd.Aca(b))&&Zm.jg.Hwl(b,h)),B.dispose());tb.end()}yoe(b,h,r,B=!1){if(null===r||null===b||null===h)return!1;b=this.Jd.Mx(b,h.listId,h.listLevel);if(!b)return t.ULS.sendTraceTag(523069061,393,15,"List def not exist when trying to update pStyle Property."),!1;if(B){if(b.hasProperty(gi.a.Vv)){b.getValue(gi.a.Vv)instanceof V.a||t.ULS.sendTraceTag(512267811,393,15,"StyleObject ID already in list def is not ExtendedGuid.");
if(!V.a.Dq(b.getValue(gi.a.Vv),r.id))return t.ULS.sendTraceTag(523069062,393,15,"List def has different pStyle than what we are expecting to remove, thus not removing it."),!1;b.removeProperty(gi.a.Vv);return!0}}else{r=r.id;r instanceof V.a||t.ULS.sendTraceTag(512267810,393,15,"StyleObject ID to be set on list def is not extendedGuid");if(b.hasProperty(gi.a.Vv))return t.ULS.sendTraceTag(523069063,393,15,"List def has different pStyle than what we are expecting to set, thus not setting it."),!1;b.setValue(gi.a.Vv,
r);return!0}return!1}static get M8b(){return null!=Zm.fAg?Zm.fAg:Zm.fAg=Ma.a.instance.Oa("Box4.IFontSlotProvider")}static get jg(){return null!=Zm.Zwg?Zm.Zwg:Zm.Zwg=Ma.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get tq(){return Ym.a.getInstance()}}Object(m.a)(Zm,"ListEditor",null,[676]);var gz=c(824),Nv=c(320);class ts{constructor(b,h,r,B,P,ca){this.Hf=P;this._pageContent=r;this.rxb=Array(ts.f5);this.E0b=Array(ts.f5);this.Dhh=Array(ts.f5);this.PQe=Array(ts.f5);this.Pdh=Array(ts.f5);
this.v3=B;this.TEc=ca;for(B=0;B<ts.f5;B++){var ra=this.Pbi(b,B,r,P);ra?(ca=ra.ja(Pd.a.Z0,gk.a.im),ra=ra.ja(Mc.a.O7c,gk.a.im)):ra=ca=gk.a.im;this.E0b[B]=ca!==gk.a.im?ca:gk.a.yLc;this.PQe[B]=ra===gk.a.im?B-1:ra-1;ts.L9(h)&&(this.Dhh[B]=gk.a.im,this.Pdh[B]=gk.a.im);this.rxb[B]=this.E0b[B]}}Pbi(b,h,r,B){B.t4(r);return Ym.a.getInstance().cWc&&this.TEc?this.Hf.osf(b,h,this.v3,r):this.Hf.fRc(b,h,r.Mc,r)}restart(b){this.rxb[b]=this.E0b[b]}yRi(b){for(var h=0;h<b;h++)this.rxb[h]===this.E0b[h]&&this.rxb[h]++;
for(h=b+1;h<ts.f5;h++)this.PQe[h]>=b&&this.restart(h);return this.rxb[b]++}static L9(b){return!!b&&b.isFeatureEnabled(72)}}ts.f5=9;Object(m.a)(ts,"AWordList",null,[45]);class Ov{constructor(b,h,r,B){this.rcb=new vo.ScriptSharpLegacyMap;this.Hf=b;this.HK=h;this.v3=r;this.TEc=B}vw(b,h){this.rcb.nb(b)||this.rcb.Z(b,new ts(b,h,this.HK,this.v3,this.Hf,this.TEc));return this.rcb.J(b)}ITf(b,h,r){return this.vw(b,r).yRi(h)}}Object(m.a)(Ov,"AListNumberingMap",null,[1317]);class $B extends ts{constructor(b,
h,r,B,P,ca){super(b,h,r,B,P,ca)}j8l(b,h,r,B){B.t4(r);return Ym.a.getInstance().cWc&&this.TEc?this.Hf.H3l(b,h,this.v3):this.Hf.G3l(b,h,this._pageContent.Mc)}LFj(b,h,r){var B=this.j8l(b,h,this._pageContent,this.Hf);B?(b=B.ja(Pd.a.Z0,gk.a.yLc),B=B.ja(Mc.a.O7c,gk.a.im),this.rxb[h]=this.Dhh[h]=this.E0b[h]=b,B!==gk.a.im&&(this.Pdh[h]=this.PQe[h]=B-1)):r&&(B=this.Pbi(b,h,this._pageContent,this.Hf),b=gk.a.yLc,B&&(b=B.ja(Pd.a.Z0,gk.a.yLc)),this.rxb[h]=this.E0b[h]=b)}}Object(m.a)($B,"WordList",ts,[]);class ZA extends Ov{constructor(b){super(b.Jd,
b.pageContentNode,b.cUa,b.VIj);this.hch=new mb.a}h3l(b,h,r){let B;Ym.a.getInstance().HY?{value:B}=this.Hf.xF.Fc(b,B):{value:B}=this.Hf.W0.Fc(b,B);this.rcb.nb(B)||this.rcb.Z(B,new $B(b,r,this.HK,this.v3,this.Hf,this.TEc));if(!this.hch.contains(b))for(this.hch.add(b);h<gk.a.f5;h++)this.rcb.J(B).LFj(b,h,!1);else if(!h)for(h+=1;h<gk.a.f5;h++)this.rcb.J(B).LFj(b,h,!0);return this.rcb.J(B)}ITf(b,h,r){return ts.L9(r)?this.h3l(b,h,r).yRi(h):super.ITf(b,h,r)}}Object(m.a)(ZA,"ListNumberingMap",Ov,[]);class gx{constructor(){this.HSa=
0;this.GKj=!1}}Object(m.a)(gx,"LastNumber",null,[]);var $z=c(846),aA=c(416),bu=c(900);class aC{constructor(){this.startAt=this.$Ta=0}}Object(m.a)(aC,"WordListRestartInfo",null,[]);class tq{constructor(b,h,r,B){this.c6d=!1;this.$s=b;this.Ezi=r;this.Zbc=B;this.Dw=this.$s.EB(h);this.LP=new Ad.GraphIterator;this.LP.kd(h)}static get Jd(){return tq.Hf||(tq.Hf=Ma.a.instance.resolve("Box4.List.IListReader"))}static set Jd(b){tq.Hf=b}static get tq(){return Ym.a.getInstance()}static nEl(b,h,r,B=!1,P=!1){var ca=
h.currentNode;let ra=null,Qa=!1,tb=!1;h=h.lTb();const Mb=Ab.a.gp(h);Mb.moveNext();for(h=Mb.iterator;h.currentNode!==ca;){let jc=tb=Qa=!1;var Zb=tq.Csl(h);if(Uf.OutlineElementReader.Eh(h)&&!Zb){Zb=!1;if(h.Jt(4))if(tq.XSi(h,r,!0,B,P)){if(jc=!0,ra=new tq(b,h,!1,!1),Mb.moveNext(),Mb.iterator===ca&&(Qa=!0),B)break}else Uf.OutlineElementReader.isEmpty(h,!1)||(Zb=!0),tb=!0;else!Uf.OutlineElementReader.isEmpty(h,!1)&&h.Ujb(12)&&(Uf.OutlineElementReader.ZQ(h)||(Zb=!0));!B&&Zb&&ra&&(r.propertySet.hasProperty(Mc.a.listLevel)?
ra.Dw.level=0:ra=null)}jc||Mb.moveNext();h=Mb.iterator}ra&&(ra.Zbc=Qa);if(!ra&&h.Mf(1))for(ca=!0;h.currentNode;){if(Uf.OutlineElementReader.Eh(h)){if(h.Jt(4)&&tq.XSi(h,r,!1,B,P)){ra=new tq(b,h,!0,ca);break}if(!Uf.OutlineElementReader.isEmpty(h,!1))break}if(!h.Mf(1))break;ca=!1}ra&&(ra.c6d=tb);return ra}static Csl(b){var h=b.Ub(2);if(!h)return!1;h=ke.ParagraphReader.oh(b)&&tq.ZRm(h);b.uc();return h}static ZRm(b){return So.a(b,8)}static XSi(b,h,r,B=!1,P=!1){if(!fg.ListItemReader.lg(b)&&(t.ULS.sendTraceTag(508913603,
393,15,"Trying to call oeMatchesInfo for non list item"),fg.ListItemReader.qk))return!1;if(fg.ListItemReader.qk)var ca=fg.ListItemReader.p0(b);else tq.Jd.HP(b),ca=b.currentNode,b.uc();const ra=tq.Jd.dY(ca);(b=h.Lz===ra.Lz)&&h.listStyle&&1!==h.ks&&(b=h.listStyle===ra.listStyle);b&&(h.Ppa&&1!==h.ks||h.Y8b||P)&&(b=tq.TPm(h,ra),h.Lz||(b=b&&h.font===ra.font));if(1===h.ks)if(1===ra.ks&&ra.propertySet.hasProperty(lh.a.Amb))b=h.n6===ra.n6;else return!1;b&&h.Lz&&h.gC!==gk.a.im&&(b=ra.Qu,r&&(B&&1===h.gC&&1===
b||b++),b=h.gC===b);b&&(B||h.Y8b)&&(h=fg.ListItemReader.d3l(h).listId,ca=fg.ListItemReader.bE(ca,{yEa:0}).listId,0<h&&0<ca&&(b=h===ca));return b}static TPm(b,h){h=h.eLf;b.Ppa&&(h=h.replace(RegExp("%\\d"),"%1"));return h.toLocaleLowerCase()===b.eLf.toLocaleLowerCase()}static oEl(b,h,r){var B=h.currentNode;let P=null;const ca=new Ad.GraphIterator,ra=b.Poa(B,r);var Qa=!1;let tb=!1;ca.kd(h);ca.uc();for(ca.Ub(1);ca.currentNode!==B;)tb=Qa=!1,Uf.OutlineElementReader.Eh(ca)&&ca.Jt(4)&&(h=b.EB(ca),tq.YSi(h,
r,!0)?(P=new tq(b,ca,!1,!1),Qa=!0):(tb=!0,h.listID===r.listID&&h.level<=ra.$Ta&&(P=null))),ca.Mf(1);P&&(P.Zbc=Qa);if(!P&&ca.Mf(1))for(B=!0;ca.currentNode;){if(Uf.OutlineElementReader.Eh(ca)&&ca.Jt(4)){Qa=b.EB(ca);if(Qa.listID===r.listID&&Qa.level<=ra.$Ta)break;if(tq.YSi(Qa,r,!1)){P=new tq(b,ca,!0,B);break}}if(!ca.Mf(1))break;B=!1}P&&(P.c6d=tb);return P}static YSi(b,h,r){let B=b.listID===h.listID&&b.level===h.level;B&&h.Qu!==gk.a.im&&(b=b.Qu,r&&b++,B=h.Qu===b);return B}}tq.Hf=null;Object(m.a)(tq,"JoinTargetInfo",
null,[]);class kr{constructor(b,h){this.Dw=null;this.action=b;h&&(this.Dw=h)}static tgc(){return new kr(0)}static DHi(){return new kr(1)}static o1m(b){return new kr(3,b)}static G1m(b){return new kr(2,b)}static r1m(b){return new kr(4,b)}}Object(m.a)(kr,"ApplyListInfoResult",null,[]);class bA{constructor(b,h,r){this.wmc=r;this.Qxn=h;this.Aaa=r-h.Qu;this.W2c=h.listID}get delta(){-1!==this.Aaa&&(this.Aaa=this.wmc-this.Qxn.Qu);return this.Aaa}set delta(b){this.Aaa=b}}Object(m.a)(bA,"ListTransferInfo",
null,[]);class Ao extends Zm{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc){super(b,r,tb);this.gE=Gc;this.hhh=!1;this.Ftc=this.Sjd=this.gWb=null;this.Dje=(Uc,od)=>od.listID===Uc.listID&&od.level===Uc.level;this.azo=(Uc,od,Od)=>od.listID!==Uc.listID&&od.listID!==Od.W2c||od.level!==Uc.level?!1:!0;this.Lan=(Uc,od,Od)=>od.listID===Uc.listID||Od&&od.listID===Od.W2c?!0:!1;this.Dtj=(Uc,od,Od,ze,de)=>{const ee=Uc.ja(Zm.tq.x6,-1);this.Ctj(Uc,od,ee+Od,ze,de)};this.Ctj=(Uc,od,Od,ze,de)=>{Ym.a.getInstance().Mz||
this.gE.Vrb(Uc,ze);od=fg.ListItemReader.qk?od:Uc;Uc=this.DGb(od);od=Ad.GraphIterator.eb(od);od.qd();od.uc();this.FIl(od,Uc,this.Lan,this.nFo,de)};this.bzo=(Uc,od,Od,ze,de)=>{const {Dw:ee,iterator:je}=this.g7b(od,()=>{Ym.a.getInstance().Mz||this.gE.Vrb(Uc,ze);Ym.a.getInstance().Ov&&this.gE.Vrb(od,ze);var ue=fg.ListItemReader.qk?od:Uc;const Qf=this.DGb(ue);ue=Ad.GraphIterator.eb(ue);ue.qd();ue.uc();return{Dw:Qf,iterator:ue}});this.zPd(je,ee,this.Ywj,this.Hke,de)};this.lFo=(Uc,od,Od,ze,de)=>{this.z7i(Uc,
od,Od,ze,de)};this.Hke=(Uc,od,Od,ze)=>{Od.listID=od.listID;ze.Ub(4);const de=this.dr.CGb(ze.currentNode);this.g7b(de,()=>{this.KGc(ze.currentNode,Od,de);ze.uc()})};this.nFo=(Uc,od,Od,ze)=>{fg.ListItemReader.lg(ze)&&(Uc=new Ad.GraphIterator,Uc.kd(ze),Uc.qd(),this.Jd.HP(Uc),this.Cui(ze.currentNode,Uc.currentNode))};this.mFo=(Uc,od,Od,ze,de)=>{Od.listID=od.listID;this.z7i(Uc,od,Od,ze,de);this.Hke(Uc,od,Od,ze,de)};this.Xwj=(Uc,od)=>od.listID===Uc.listID;this.kFo=(Uc,od)=>od.level<=Uc.level;this.Ywj=(Uc,
od,Od)=>od.listID===Od.W2c;this.ep=P;this.ata=b;this.eod=h;this.Lc=B;this.m0f={};this.fak=ca;this.Vd=ra;this.Aq=Qa;this.rd=Mb;this.qz=Zb;this.$u=jc}get L9(){return this.ata.wia}get qRb(){return this.hhh}set qRb(b){this.hhh=b}get dr(){return this.ata}get c6(){return this.$u}get qc(){return this.qz}get jt(){return this.dr.jt}get sq(){return this.dr.sq}get Bua(){return this.dr.Bua}get H9(){return this.dr.H9}set H9(b){this.dr.H9=b}get YRa(){return this.dr.YRa}set YRa(b){this.dr.YRa=b}get qad(){return null!=
this.YGg?this.YGg:this.YGg=Ma.a.instance.Oa("Box4.List.ISingleLevelListEditor")}sAk(b,h,r,B){t.ULS.sendTraceTag(17622210,324,50,"AdjustAndSetLevel is called in WordEditor.");const P=r.ja(Yc.a.nZd,!1);let ca=!1,ra=-1;!P||h.listStyle&&1!==h.ks||(ca=!r.ja(Yc.a.qJf,!1),ra=r.ja(Yc.a.dLf,-1));b=this.JGc(b,h,{vri:ca,U0m:ra,PIl:B,propertySet:r});P||r.setValue(Yc.a.qJf,2===b.action);3===b.action&&!r.hasProperty(Yc.a.dLf)&&b.Dw&&r.setValue(Yc.a.dLf,b.Dw.level)}merge(b,h,r,B=null){const P=fg.ListItemReader.lg(b)||
fg.ListItemReader.lg(h);b=super.merge(b,h,r,B);P&&this.r6();return b}X4i(b,h){this.eUk(b,h)}eUk(b,h){b=this.Jd.hsf(b);const r=this.Jd.hsf(h);-1!==b&&-1!==r&&(b-=r,0<b?this.eod.value.ILc(h,b):0>b&&this.eod.value.oTa(h,b,0))}Laj(b){this.Jd.HP(b);b.zg();sq.a.instance.J(1)&&this.r6()}rNo(b,h,r,B){var P=Ad.GraphIterator.eb(r);P=this.EB(P);this.tNo(P,b,h,r,B)}EB(b){if(!fg.ListItemReader.lg(b)&&(t.ULS.sendTraceTag(508924048,393,15,"Trying to fetch list Ref info for non list item"),fg.ListItemReader.qk))return null;
let h;fg.ListItemReader.qk?h=fg.ListItemReader.p0(b):(this.Jd.HP(b),h=b.currentNode,b.uc());return this.DGb(h)}Qmj(b,h){this.Jd.HP(b);const r=b.currentNode;b.uc();Ym.a.getInstance().Mz||this.gE.Vrb(r,h);b=Uf.OutlineElementReader.AU(b);Ym.a.getInstance().Ov&&this.gE.Vrb(b,h);return this.DGb(fg.ListItemReader.qk?b:r)}DGb(b){var h;const r=new gz.a;fg.ListItemReader.qk&&(b&&ke.ParagraphReader.Xb(b)||t.ULS.sendTraceTag(509141474,393,15,`Paragraph node not sent in getListRefInfoNode. Node sent: ${null===
(h=null===b||void 0===b?void 0:b.constructor)||void 0===h?void 0:h.name}`));h=sq.a.instance.J(1)?fg.ListItemReader.qk?fg.ListItemReader.bE(b)||fg.ListItemReader.EFa(b):this.Jd.hP(b,!1,!0):fg.ListItemReader.bE(b,{yEa:0,QDb:-1});r.listID=h.listId;r.level=h.listLevel;r.X0=fg.ListItemReader.Zyf(b);h=this.QSd(b);r.djo(h);r.Qu=fg.ListItemReader.qVd(b);r.zMc=fg.ListItemReader.Awf(b);return r}mhe(b,h,r=!1){const B=r?null:Uf.OutlineElementReader.AU(b);b=Ym.a.getInstance().Mz?null:this.OMh(b);this.KGc(b,h,
B,r);return b}KGc(b,h,r=null,B=!1){b||Nh.a.instance.Yb("CrashWhenApplyingList",{["Reason"]:"ListNodeIsNull"});!Ym.a.getInstance().Ov||B||r||Qc.b(509364259,393,15,"Apply list info called without para node");h||Nh.a.instance.Yb("CrashWhenApplyingList",{["Reason"]:"RefInfoIsNull"});Ym.a.getInstance().Ov&&r&&!B&&this.gE.ihe(r,h.listID,h.level);Ym.a.getInstance().Mz||(this.gE.ihe(b,h.listID,h.level),h.X0&&b.setValue(Mc.a.X0,!0),Ym.a.getInstance().Ov||null==h.levelText||b.setValue(Mc.a.pv,h.levelText))}QGj(b){this.dr.t4(b);
b=Ao.hi.su(b);let h=b.ja(Mc.a.sq,null);h=h?Array.clone(h):[];b.setValue(Mc.a.sq,h);this.dr.Sbc()}ZEo(b){switch(b){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return 0}}n3l(b){b=b.view;if(!b.mb||!b.mb.ib)return null;b=Uy.OutlineElementGeneralizer.Aha(b.mb.ib,!1);if(1!==b.length)return null;b=Ad.GraphIterator.eb(b.getContext(0).node);if(!fg.ListItemReader.lg(b))if(14===b.Rd().type){const h=fg.ListItemReader.c$h(b.currentNode);h&&b.set(h)}else Qc.b(589177753,
393,15,"Encountered an OE of non list type."),b.uc();b.qd();return b}Ecl(b,h,r,B){const P=b.zJ(),ca=new gz.a;ca.listID=this.hNh(b);this.L9?(ca.I2d=Zm.tq.HY?this.iNh(b):this.ZMh(b),this.B8i(b,ca.listID,ca.I2d)):this.D8i(b,ca.listID);ca.Bmj(h.propertySet,this.RZc(r));this.SMd(b);r=this.Tbi(b,h);for(let Qa=0;9>Qa;Qa++){const tb=new Qz.a;P.xd.Uu(tb);this.C8i(b,this.L9?V.a.nil:tb.id,this.L9?tb.id:V.a.nil);this.osk(tb,h.Lz,Qa);this.xph(tb,r,Qa);var ra=B.ZKb[Qa];ra=6===ra?Vp.a.c0(1,1):Vp.a.c0(0,ra);ra.Kia&&
tb.setValue(Pd.a.k5,ra.Kia);h.gC!==gk.a.im&&Qa===ca.level&&tb.setValue(Pd.a.Z0,h.gC);B.fFa&&B.fFa[Qa]&&tb.setValue(Pd.a.font,B.fFa[Qa]);ra=B.TZc[Qa];t.ULS.shipAssertTag(22127636,338,!!ra);tb.setValue(Mc.a.pv,ra);tb.setValue(Mc.a.vda,B.S1d[Qa]);Nv.a.Zhe(B.n6,tb)}return ca}Ccl(b,h,r){const B=b.zJ(),P=new gz.a;P.listID=this.hNh(b);this.L9?(P.I2d=Zm.tq.HY?this.iNh(b):this.ZMh(b),this.B8i(b,P.listID,P.I2d)):this.D8i(b,P.listID);P.Bmj(h.propertySet,this.RZc(r));if(!h.listStyle)switch(P.level%3){case 0:h.I$(h.listType,
1);break;case 1:h.I$(h.listType,2);break;case 2:h.I$(h.listType,3)}this.SMd(b);r=this.Tbi(b,h);for(let ca=0;9>ca;ca++){const ra=new Qz.a;B.xd.Uu(ra);this.C8i(b,this.L9?V.a.nil:ra.id,this.L9?ra.id:V.a.nil);this.nsk(ra,h.Lz,ca);this.xph(ra,r,ca);2===ca%3&&h.Lz?ra.setValue(Mc.a.vda,"right"):ra.setValue(Mc.a.vda,"left");ca===P.level&&(h.Kia&&ra.setValue(Pd.a.k5,h.Kia),h.gC!==gk.a.im&&ra.setValue(Pd.a.Z0,h.gC),h.Lz?this.Fmj(h,ra,ca):(Ao.Cmj(h,ra),Ao.Emj(h,ra)),Ao.Dmj(h,ra),h.Y8b&&ra.SOa(h.propertySet,
Mc.a.listID,Mc.a.listLevel))}return P}Fmj(b,h,r){b.Ppa?(b=b.levelText,b=F.a.replaceAll(b,"%1","%"+(r+1))):b=b.OVc||b.Yoa?b.levelText:"%"+(r+1)+".";t.ULS.shipAssertTag(22127638,338,!!b);h.setValue(Mc.a.pv,b)}Arj(b,h,r,B){if(b.OVc)return!1;if(1===b.ks)return B;if(B)return!0;if(h){B=b.listType===h.listType;const P=!b.listStyle&&b.gC===gk.a.im;let ca=b.listStyle===h.listStyle&&b.gC===h.gC;b=(!b.Ppa||this.Sag(h,b))&&!r;ca=ca&&b;return B&&(P||ca)}return!1}SMd(b){this.gWb||(this.gWb=b.ja(Mc.a.Xil,null));
this.Sjd||(this.Sjd=b.ja(Mc.a.Wil,null));this.Ftc||(this.Ftc=b.ja(Mc.a.Yil,null))}RZc(b){720>b&&(b=0);return Math.max(0,Math.min(Math.floor(b/720),8))}Y0l(b){return b?this.ep.wU(b).Wt-this.ep.IG(b).Wt:-1}D8i(b,h){const r=b.ja(Mc.a.jt,null),B=r?r.length:0,P=Array(B+1);let ca=0;for(;ca<B;ca++)P[ca]=r[ca];P[ca]=h;b.setValue(Mc.a.jt,P);this.dr.Sbc()}B8i(b,h,r){this.f_e(Mc.a.jt,b,h);if(Zm.tq.HY){this.f_e(dd.a.GSa,b,r);var B=this.dr.NSd(b);B.add(h,r);b.setValue(dd.a.xF,aA.b(Bu.a.Onc(B)))}else this.f_e(Mc.a.Bua,
b,r),B=this.dr.MSd(b),B.add(h,r),b.setValue(Mc.a.W0,aA.b(Bu.a.Onc(B)))}C8i(b,h,r){this.L9?(this.mph(Mc.a.sq,b,r),this.mph(Mc.a.e$,b,h)):(r=(r=b.ja(Mc.a.sq,null))?Array.clone(r):[],r.push(h),b.setValue(Mc.a.sq,r),this.dr.Sbc())}f_e(b,h,r){const B=h.ja(b,null),P=B?B.length:0,ca=Array(P+1);let ra=0;for(;ra<P;ra++)ca[ra]=B[ra];ca[ra]=r;h.setValue(b,ca)}mph(b,h,r){let B=h.ja(b,null);B=B?Array.clone(B):[];B.push(r);h.setValue(b,B)}nsk(b,h,r){var B=r%3+1;const P=h?this.Ftc:this.Sjd;P&&r<P.length?b.setValue(Mc.a.ot,
P[r]):b.setValue(Mc.a.ot,360);B=Vp.a.c0(h?0:1,this.ZEo(B),null,0,r);b.ax(B.propertySet);b.setValue(Mc.a.Z3e,h?-1:-2);h?b.setValue(Mc.a.pv,"%"+(r+1)+"."):(b.setValue(Pd.a.font,this.wVl(r)),b.setValue(Mc.a.pv,String.fromCharCode(this.lVl(r))));Nv.a.hlc(2,b)}osk(b,h,r){const B=h?this.Ftc:this.Sjd;B&&r<B.length?b.setValue(Mc.a.ot,B[r]):b.setValue(Mc.a.ot,360);b.setValue(Mc.a.Z3e,h?-1:-2);Nv.a.hlc(1,b)}lVl(b){switch(b%3){case 0:return 61623;case 1:return 111;case 2:return 61607;default:return 61623}}wVl(b){switch(b%
3){case 0:return"Symbol";case 1:return"Courier New";case 2:return"Wingdings";default:return"Symbol"}}hNh(b){if(this.L9)this.H9<gk.a.g_c&&this.dr.t4(b),this.H9=this.Sci(this.jt,this.H9,gk.a.g_c);else{if(this.H9<gk.a.g_c&&(this.dr.t4(b),this.jt&&this.sq)){b=this.jt.length;for(let h=0;h<b;h++)this.jt[h]>=this.H9&&(this.H9=this.jt[h])}this.H9+=1}return this.H9}ZMh(b){this.YRa<gk.a.WAd&&this.dr.t4(b);return this.YRa=this.Sci(this.Bua,this.YRa,gk.a.WAd)}iNh(b){var h;this.dr.t4(b);do b=Math.floor(Math.random()*
(Ao.sbn-Ao.rPi))+Ao.rPi;while(null===(h=this.dr.fMb)||void 0===h?0:h.includes(b));return b}Sci(b,h,r){if(h<r&&b){r=b.length;for(let B=0;B<r;B++)b[B]>h&&(h=b[B])}h++;return h}S3n(b,h){this.C2h(b,h,1,this.Dje,this.Dtj,null,!1)}R3n(b,h,r){this.GIl(b,h,r,this.Dje,this.Ctj)}PIk(){this.r6()}r6(b=null){var h,r;if(sq.a.instance.J(1)){var B=new Ad.GraphIterator;if(b)if(8===b.type)B.set(b);else{t.ULS.sendTraceTag(592535635,393,15,"Unable to update lists number as cannot navigate to page content node.");return}else B.set(Eb.App.za.jb.Zc),
Ao.hi.iog(B),b=Ao.hi.su(B.currentNode);if(B.zb(7)||B.jd(7)){B=Ab.a.Gs(B,B.origin);var P=new ZA({Jd:this.dr,pageContentNode:b,cUa:null,VIj:!1});for(b=new ZA({Jd:this.dr,pageContentNode:b,cUa:null,VIj:!1});B.moveNext();){var ca=B.iterator;let Qa;if(!Ym.a.getInstance().Mz){if(!ca.Jt(4)&&!ca.Jt(31))continue;this.Jd.RLb(ca);Qa=ca.currentNode;ca.uc();if(!Qa){t.ULS.sendTraceTag(575813713,393,15,"List Node comes out to be null while updating numbering. Iterator Valid {0}",ca.isValid);continue}}const tb=fg.ListItemReader.qk?
fg.ListItemReader.p0(ca)||fg.ListItemReader.Ktf(ca):Qa;if(!this.L9&&!fg.ListItemReader.hHf(tb)&&this.Jd.dY(tb).listType)continue;var ra=void 0;if(fg.ListItemReader.qk){if(!tb){t.ULS.sendTraceTag(509141473,393,50,"Skipping updating list numbers because paraNode not found");continue}ra=fg.ListItemReader.bE(tb)}else ra=this.Jd.hP(Qa,!1,!1);if(this.L9&&ra&&this.Jd.E_d(ra.listId)){t.ULS.sendTraceTag(592535636,393,50,"Skipping updating list numbers for this list id {0}",ra.listId);continue}const Mb=fg.ListItemReader.qk?
tb:Uf.OutlineElementReader.AU(ca);Mb&&(Mb.qa?(null==Mb.qa.last&&t.ULS.sendTraceTag(540374985,393,15,"Unexpected : Encountered last of para character properties null."),this.L9&&this.dr.t4(ca.currentNode),12===Mb.type&&(Mb.Pi&&Mb.Xy.hasProperty(Mc.a.listID)||null===(h=Mb.qa.last)||void 0===h||!h.zi)&&((ca=fg.ListItemReader.qk?fg.ListItemReader.EFa(tb)||fg.ListItemReader.bE(tb):this.Jd.hP(Qa,!0,!0))?this.Hmj(Qa,tb,b,Zm.tq.dqc,ca):t.ULS.shipAssertTag(24475424,376,!0,"The previous number list ID is not found! List Node Type={0}",
Qa.type)),!ra||null!==(r=Mb.qa.last)&&void 0!==r&&r.Mh||!this.Hmj(Qa,tb,P,Zm.tq.x6,ra)||(ra=Qa.getValue(Zm.tq.x6),this.L9&&this.Jd.dY(tb).listType||Qa.setValue(Zm.tq.nsa,ra))):t.ULS.shipAssertTag(24975004,376,!0,"The paragraph node has null CharacterProperties! Skipping."))}}else t.ULS.shipAssertTag(593234060,376,7===B.Xe,"Couldnt reach to page manifest node")}}Hmj(b,h,r,B,P){B||t.ULS.shipAssertTag(571757918,393,!!B,"Prop definition is null");r=r.ITf(P.listId,P.listLevel,this.rd);P=-1;b.hasProperty(B)&&
(P=b.getValue(B));return r===P||this.L9&&!fg.ListItemReader.hHf(h)&&this.Jd.dY(h).listType&&(B!==Zm.tq.dqc||1!==this.Jd.dY(h).listType)?!1:(b.setValue(B,r),!0)}DOm(b,h){let r=!1,B=!0,P=0;const ca=this.EB(b),ra=b.currentNode;b=b.lTb();b=Ab.a.gp(b);for(b.yo(bu.a.k_c,null);b.moveNext();){var Qa=b.iterator.currentNode;if(Qa===ra)break;fg.ListItemReader.lg(Qa)&&(Qa=this.EB(b.iterator),Qa.listID===ca.listID&&(Qa.level>ca.level?(r=!0,P++):Qa.level===ca.level?(B=!1,P=0):Qa.level<=h.$Ta&&(B=!0,P=0)))}return r&&
B&&!0}WCh(b,h){this.Jd.HP(b);const r=b.currentNode;b.uc();const B=this.EB(b);B&&this.dr.j_c(r,B.listID,B.level)&&this.R3n(b.currentNode,B,h)}Vbi(b){const h=this.Jd.vw(b);h.Y8b=!0;this.Jd.HP(b);const r=b.currentNode.ja(Mc.a.listID,0);h.propertySet.setValue(Mc.a.listID,r);b.jd(11);return h}cKf(b,h,r){const B=new Ad.GraphIterator,P=h.currentNode;let ca;var ra=gk.a.im;let Qa=!1,tb=!1,Mb=!1,Zb=null;var jc=h.lTb();jc=Ab.a.gp(jc);for(jc.yo(bu.a.k_c,null);jc.moveNext();){B.kd(jc.iterator);if(B.currentNode===
P)break;Qa=!1;B.Jt(4)&&(ca=this.EB(B),ca.listID===b.listID&&(ca.level===b.level?(this.Jd.HP(B),ra=B.currentNode,B.uc(),ra=ra.ja(Zm.tq.x6,gk.a.im),Qa=!0,Zb=B.Xoc(1),tb=!0):ca.level>b.level?Mb=!0:ca.level<=r.$Ta&&(ra=gk.a.im,Mb=tb=!1)))}!tb&&Mb&&(ra=r.startAt);Qa&&(Qa=h.Xoc(1)===Zb);b=new gx;b.HSa=ra;b.GKj=Qa;return b}N3n(b,h){var r=fg.ListItemReader.p0(b);if(Ao.qTm)this.MXo(r,h);else{b=this.DGb(r);const ca=this.Poa(r,b),ra=this.dr.L2a(r,b);var B=new Ad.GraphIterator;const Qa=ra.Lz;let tb=ca.startAt,
Mb=!1,Zb=!1;t.ULS.shipAssertTag(22127639,338,ra.Yoa,"Info does not have a level Text.");B.set(r);if(B.qd()&&(r=B.bUa()))for(r=Ab.a.gp(r),r.yo(bu.a.k_c,b);r.moveNext();){B=r.iterator.currentNode;if(!fg.ListItemReader.lg(B))continue;var P=this.EB(r.iterator);P.listID===h&&(P=this.Qmj(r.iterator,b.listID));if(P.listID!==b.listID)continue;const jc=r.iterator.Ub(4);jc&&r.iterator.uc();P.level>b.level?(this.dr.j_c(jc,b.listID,P.level)&&this.Cui(B,jc),Zb=!0):(P.level<=ca.$Ta?(tb=ca.startAt,Zb=Mb=!1):(P=
r.iterator,this.Jd.HP(P),Zm.tq.Ov||P.currentNode.setValue(Mc.a.pv,ra.eLf),{tco:Mb,HSa:tb}=this.Q3n(Qa,Zb,Mb,P,tb,B)),Ao.oGm(r))}}}MXo(b,h){const r=this.DGb(b),B=new Ad.GraphIterator;B.set(b);if(B.qd()&&(b=B.bUa())){b=Ab.a.gp(b);for(b.yo(bu.a.k_c,r);b.moveNext();)fg.ListItemReader.lg(b.iterator.currentNode)&&this.EB(b.iterator).listID===h&&this.Qmj(b.iterator,r.listID);t.ULS.sendTraceTag(509200585,393,50,"Single level List is inflated successfully.")}}Cui(b,h){t.ULS.shipAssertTag(22819227,338,!!b&&
!!h);h.setValue(Ld.a.xHi,V.a.create().toString())}Q3n(b,h,r,B,P,ca){b?(h&&!r&&P++,ig.OutlineElementNavigator.Yd(B),this.WCh(B,P),P++,r=!0,B.Ub(2),$z.a.iGf(B.currentNode)&&B.currentNode.ol(4,!0)):(B.currentNode.removeProperty(Zm.tq.x6),ig.OutlineElementNavigator.Yd(B));ca.ol(4,!0);(b=B.ko(16))&&b.ol(8,!0);return{tco:r,HSa:P}}Poa(b,h){const r=Nh.a.instance.Fp(Nb.a.Poa),B=new aC;(b=this.dr.Mx(b,h.listID,h.level))?(B.$Ta=b.ja(Mc.a.O7c,h.level-1),B.startAt=b.ja(Pd.a.Z0,1)):Nh.a.instance.Yb("PossiblyIncorrectListRestartValue",
{["Reason"]:"listPropsIsNull"});r.end();return B}Iel(b){const h=Jo.a.instance.createInstance(1074135151);b.Bf(h,31)}J0n(b){b.Ub(31)&&b.zg()}tNo(b,h,r,B,P){const ca=this.mhe(h,b,!0);h=this.dr.L2a(h.currentNode,b);h.listType||(ca.setValue(Zm.tq.x6,b.Qu),ca.setValue(Zm.tq.nsa,b.zMc),this.Wcj(ca,b,r?B:P));switch(h.listType){case 0:r="Numbering";break;case 1:r="Bullet";break;default:r="Invalid List Type"}v.AFrameworkApplication.va.processAction(Nb.a.pJf,2);t.ULS.sendTraceTag(38544079,393,50,"List Actions : Join List - {0}",
r);Ym.a.getInstance().Mz||this.gE.ihe(ca,b.listID,b.level)}Faj(b){var h=this.qc.So(b);h?this.qc.Ag(h)===Hl.StyleReader.wordStyleIdListParagraph&&(h=this.qc.JB(b),this.c6.aK(h.oj(Hl.StyleReader.wordStyleIdNormal),b,!0,!1,!1,this.qRb)):t.ULS.shipAssertTag(8271188,315,!1)}Uko(b){if(this.qc.Ag(this.qc.So(b))===Hl.StyleReader.wordStyleIdNormal){const h=this.qc.JB(b);this.c6.aK(h.oj(Hl.StyleReader.wordStyleIdListParagraph),b,!0,!0,void 0,void 0,void 0,!0)}b.Cg(Mc.a.ee,Mc.a.hN,Mc.a.RA,Mc.a.p1,Mc.a.ot,Mc.a.mja);
b.setValue(Mc.a.dTa,0)}VUk(b,h){const r=b.getValue(Mc.a.listID),B=b.getValue(Mc.a.listLevel);for(let ca=0;9>ca;ca++){const ra=this.dr.Mx(b,r,ca);if(!ra)return Nh.a.instance.Yb("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),null;var P=h.ZKb[ca];P=6===P?Vp.a.c0(1,1):Vp.a.c0(0,P);P.Kia&&ra.setValue(Pd.a.k5,P.Kia);ra.hasProperty(Pd.a.font)&&ra.removeProperty(Pd.a.font);h.fFa&&h.fFa[ca]&&ra.setValue(Pd.a.font,h.fFa[ca]);P=h.TZc[ca];t.ULS.shipAssertTag(22127641,338,!!P);ra.setValue(Mc.a.pv,
P);ra.setValue(Mc.a.ks,Nv.a.igc);Nv.a.Zhe(h.n6,ra);ra.setValue(Mc.a.vda,h.S1d[ca]);ra.Cg(Mc.a.O7c,Pd.a.Z0);this.QGj(b)}b=new gz.a;b.listID=r;b.level=B;return b}TUk(b,h,r,B){if(B)return this.VUk(b,B);B=b.getValue(Mc.a.listID);const P=b.getValue(Mc.a.listLevel),ca=this.dr.Mx(b,B,P);if(!ca)return Nh.a.instance.Yb("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),h&&t.ULS.sendTraceTag(588022420,393,15,"List def is null for List Style {0}, List type {1}, ListId {2} and level {3}",h.listStyle,
h.listType,B,P),null;h.Y8b&&(ca instanceof iw.APropertySet?ca.SOa(h.propertySet,Mc.a.listID,Mc.a.listLevel):t.ULS.sendTraceTag(527991759,393,15,"ListDefintion was not an instance of APropertySet, it is an instance of {0}",null===ca||void 0===ca?void 0:ca.constructor.name));var ra=ca.ja(Mc.a.ks,null);ra&&ra===Nv.a.igc&&this.SUk(b,B);if(!h.listStyle){ra=0;if(-1!==r){for(ra+=P-r;0>ra;)ra+=3;ra%=3}switch(ra){default:r=1;break;case 1:r=2;break;case 2:r=3}h.I$(h.listType,r)}h.Kia&&ca.setValue(Pd.a.k5,h.Kia);
h.Lz?(this.Fmj(h,ca,P),ca.hasProperty(Pd.a.font)&&ca.removeProperty(Pd.a.font)):(Ao.Cmj(h,ca),Ao.Emj(h,ca));Ao.Dmj(h,ca);ca.Cg(Mc.a.O7c,Pd.a.Z0,Mc.a.LXc);this.QGj(b);b=new gz.a;b.listID=B;b.level=P;return b}SUk(b,h){let r;for(let B=0;9>B;B++){r=this.dr.Mx(b,h,B);if(!r){t.ULS.sendTraceTag(588022421,393,15,"List def is null for List id {0}, List level {1}",h,B);break}r.setValue(Mc.a.ks,Nv.a.VWd);r.removeProperty(lh.a.Amb)}}lhe(b,h){const r=Nh.a.instance.Fp(Nb.a.lhe);this.eod.value||Nh.a.instance.Yb("PossibleIncorrectListIndentation",
{["Reason"]:"IOutlineElementIndentationEditorIsNull"});this.UMa?(r.properties.Z("PendingListInfo","true"),fg.ListItemReader.lg(b)&&(r.properties.Z("RemoveCurrentListInfo","true"),this.qRb=!0,this.oIa(b),this.eod.value.oTa(b,-1,0),this.qRb=!1),16!==this.UMa.listType&&this.JGc(b,this.UMa,{vri:!0,oKl:!0}),this.UMa=null):h||(r.properties.Z("CurrentlyUnderPastedList","true"),this.oIa(b,{waj:!0}));r.end()}iie(b,h){var r;if(fg.ListItemReader.lg(b))return!1;b.Ub(2);var B=$p.a.pJk;const P=[!0,!1].map(ca=>
ke.ParagraphReader.Xf(b.currentNode,ca,void 0,!1));b.uc();for(let ca=0;ca<P.length;ca++){const ra=P[ca];if(ra&&!ZB.a.Bpa(ra))for(const Qa of B)if(Qa.test(ra.characterData))return B=null===(r=Qa.exec(ra.characterData))||void 0===r?void 0:r[0],this.KSn(h,ca?"nextPara":"prevPara",B),!1}return!0}KSn(b,h,r){const B=new Map;B.set("CurrentAutoListPreventedAutoListText",b);B.set("UndoAutoListPreferenceFoundIn",h);B.set("UndoAutoListPreferenceAutoListText",r);va.Health.instance.recordKpiUsage(gk.a.$lb.iZn,
0,gk.a.yB,B)}Xuo(b,h){return b&&h}Gaj(b){for(let h=0;h<b.count;h++){const r=Ad.GraphIterator.eb(b.J(h));r.Ip();this.Yda(r)}b.clear()}P3n(b){fg.ListItemReader.lg(b)&&this.r6()}V7i(b,h){b=new Ad.GraphIterator;b.set(h);b.qd();ig.OutlineElementNavigator.Yd(b);b.Tjb(h)||Nh.a.instance.Yb("PossibleLossOfDirectFormatting",{["Reason"]:"OeDoesNotContainParagraph"});this.oIa(b);return b}zko(b,h,r){this.rh.Iza(b,h,r,!0)}Hko(b){b.I$(1,1)}tDd(b,h){const r=Nh.a.instance.Fp(Nb.a.oFk);if(this.qc.oda(h.Gl())){if(fg.ListItemReader.lg(b)&&
this.oIa(b),h=this.dr.bci(h)){r.properties.Z("EarlyReturn","False");this.dr.L2a(b.currentNode,h);var B=tq.oEl(this,b,h);if(B)B=this.Gmj(b,B,!0);else{B=this.OMh(b);var P=this.zPd(b,h,this.Xwj,this.lFo);if(P){const ca=this.EB(P);if(ca.listID===h.listID&&ca.level<h.level&&this.Jd.vw(P).Lz){const ra=this.Poa(P.currentNode,ca);ca.Qu===(ra.startAt===gk.a.im?1:ra.startAt)&&(ca.zMc=ca.Qu,this.Wcj(B,ca,P.currentNode))}}P=this.Poa(B,h);b=this.cKf(h,b,P);b=b.HSa!==gk.a.im?b.HSa+1:P.startAt===gk.a.im?1:P.startAt;
Ym.a.getInstance().Mz||this.KGc(B,h,null,!0);B.setValue(Zm.tq.x6,b);B.setValue(Zm.tq.nsa,b)}Ym.a.getInstance().Mz||B.setValue(Mc.a.X0,!0);r.end()}}else Nh.a.instance.Yb("PossiblyIncorrectListStyle",{["Reason"]:"StyleContainerNotValid"})}Wcj(b,h,r){this.dr.j_c(b,h.listID,h.level)&&this.S3n(r,h)}AFk(b,h,r){if(!fg.ListItemReader.lg(h)&&(t.ULS.sendTraceTag(508952674,393,15,"Iterator sent is not pointing to a List OE: applyNewListDefinition"),fg.ListItemReader.qk))return;const B=h.Ub(4);h.uc();(h=Uf.OutlineElementReader.AU(h))||
Qc.b(509386772,393,15,"Encountered a list node but paragraph node is not present");b=this.gNh(b,r,0,null);this.KGc(B,b,h);return b}gNh(b,h,r,B=null){b=B?this.Ecl(b,h,r,B):this.Ccl(b,h,r);Zm.tq.Ov||(h.Yoa?(h=h.levelText,B||(h=h.replace("%1","%"+(b.level+1))),b.levelText=h):(t.ULS.sendTraceTag(22127642,338,15,"desiredInfo does not have a levelText. Replacing with an emtpy string."),b.levelText=""));return b}Qpg(b,h,r,B=null){if(fg.ListItemReader.lg(b)){var P=b.Ub(4);b.uc();var ca=Uf.OutlineElementReader.AU(b);
this.g7b(ca,()=>{this.KGc(P,h.Dw,ca,r);this.bUh(P,h,r,B)})}else t.ULS.sendTraceTag(587747659,393,15,"List node received is null : skipping join list action.")}Gmj(b,h,r,B=null){const P=Uf.OutlineElementReader.AU(b);return this.g7b(P,()=>{const ca=this.mhe(b,h.Dw,r);this.bUh(ca,h,r,B);return ca})}bUh(b,h,r,B=null){if(this.dr.L2a(b,h.Dw).Lz){const P=new Ad.GraphIterator;P.set(b);P.qd();P.uc();const ca=this.IGl(P,h,B);b=this.zGl(P,b,h,r,B,ca);this.FGl(h,r,B,ca,b)}}IGl(b,h,r){if(h.Ezi)h=h.LP;else{let B,
P;r?(B=this.Ywj,P=this.Hke):h.Zbc?(B=this.Xwj,P=this.Hke):(B=this.kFo,P=this.mFo);h=this.zPd(b,h.Dw,B,P,r)}!h&&r&&(r=new Ad.GraphIterator,r.kd(b),r.wSc()&&fg.ListItemReader.lg(r)&&(h=r));return h}zGl(b,h,r,B,P,ca){B?(P?b=P.wmc:(ca=this.Poa(h,r.Dw),r=this.cKf(r.Dw,b,ca),b=r.HSa!==gk.a.im?r.HSa+1:ca.startAt===gk.a.im?1:ca.startAt),h.setValue(Zm.tq.x6,b),h.setValue(Zm.tq.nsa,b)):(b=gk.a.im,this.Alo(h,ca,r));return b}FGl(b,h,r,B,P){if(B){var ca=!1,ra=this.EB(B),Qa=ra.level===b.Dw.level,tb=!!r&&ra.listID===
r.W2c;(ra.listID===b.Dw.listID||tb)&&Qa&&(Qa=this.Poa(B.currentNode,ra),tb=Qa.startAt===gk.a.im?1:Qa.startAt,ra.Qu===tb+1&&(ca=h?P===tb:this.DOm(B,Qa)));if(!ca||r)r?(h=r.delta,P=this.azo,ca=this.bzo):(h=1,P=this.Dje,ca=this.Dtj),ra=new Ad.GraphIterator,ra.set(B.currentNode),ra.qd(),this.Jd.HP(ra),ra.uc(),this.C2h(B.currentNode,b.Dw,h,P,ca,r)}}Alo(b,h,r){let B=null;h&&(B=this.EB(h));if(B&&B.listID===r.Dw.listID&&B.level===r.Dw.level){const P=this.Jd.vw(h),ca=P.Qu;b.setValue(Zm.tq.x6,ca);b.setValue(Zm.tq.nsa,
ca);P.propertySet.setValue(Mc.a.listID,B.listID);P.propertySet.setValue(Mc.a.listLevel,B.level);if(!r.Zbc||r.c6d)r.Ezi&&!r.c6d&&(this.Jd.HP(h),b=h.currentNode,ig.OutlineElementNavigator.Yd(h)),b.setValue(Zm.tq.nsa,b.getValue(Zm.tq.x6))}else h=r.Dw.Qu+1,b.setValue(Zm.tq.x6,h),b.setValue(Zm.tq.nsa,h)}JGc(b,h,{vri:r=!1,U0m:B=-1,PIl:P=!1,oKl:ca=!1}={}){return h&&16!==h.listType?Ad.GraphIterator.lca(()=>{if(!Uf.OutlineElementReader.Eh(b))return t.ULS.sendTraceTag(578331469,393,15,"Iterator not pointing to OE in apply list info word."),
kr.tgc();const ra=Uf.OutlineElementReader.AU(b);return ra&&So.a(ra,8)?(t.ULS.sendTraceTag(578331470,393,15,"Returning from apply list info word as its a page break."),kr.tgc()):sq.a.instance.J(1)&&(null===ra||void 0===ra?0:ra.qa.last.Mh)?(t.ULS.sendTraceTag(578331471,393,15,"User applied list to para with deleted EOP."),kr.tgc()):this.g7b(ra,()=>{var Qa=Ao.hi.su(b.currentNode);const tb=h.YB,Mb=this.infoAtLevel(b,h);var Zb=b.Ub(4);if(Zb)return b.uc(),Qa=this.Ouh(Mb,Zb,B,tb),Qa.Dw=this.EB(b),Qa;this.J0n(b);
Zb=h.propertySet.ja(Mc.a.listID,-1);const jc=this.g3l(Zb,ca),Gc=this.Y0l(ra),Uc=this.X1l(h,b,Mb,ca,P,r);this.ejo(Uc,Mb);ra&&this.Uko(ra);return null==Uc||P||Mb.Lz!==this.Jd.L2a(b.currentNode,Uc.Dw).Lz?this.Bsl(Mb,jc,Uc,b.currentNode)?this.qFk(b,Mb,jc,Gc,tb):this.pFk(b,Mb,Qa,Gc,tb,jc,Zb):(Mb.listStyle||(Uc.Zbc=!0),this.rFk(jc,Uc,b))})}):(h||t.ULS.sendTraceTag(509650391,393,15,"applyListInfo was called with info = "+h),this.oIa(b))}qFk(b,h,r,B,P){r=this.J3l(h,r,B);b=this.mhe(b,r);return this.Ouh(h,
b,-1,P)}X1l(b,h,r,B,P,ca){var ra;P=b.tnb?new tq(this,Ad.GraphIterator.eb(b.tnb),!1,!0):tq.nEl(this,h,r,B,P);if(!P)return null;ca?(P.Dw.level=this.j1l(h,r,B),this.lGl(h,P)):P.Dw&&(null===(ra=b.propertySet)||void 0===ra?0:ra.hasProperty(Mc.a.listLevel))&&(P.Dw.level=b.propertySet.getValue(Mc.a.listLevel));return P}g3l(b,h){return h&&0<b&&b+""in this.m0f?this.m0f[b+""]:-1}J3l(b,h,r){var B,P;const ca=new gz.a;ca.listID=h;ca.level=null!==(P=null===(B=b.propertySet)||void 0===B?void 0:B.wf(Mc.a.listLevel))&&
void 0!==P?P:this.RZc(r);b.propertySet&&b.Yoa&&!Zm.tq.Ov&&(ca.levelText=b.levelText.replace("%1","%"+(ca.level+1)));return ca}Ouh(b,h,r,B){b=this.TUk(h,b,r,B);return kr.o1m(b)}rFk(b,h,r){let B=null;0<b&&(B=new bA(0,h.Dw,-1),B.W2c=b,B.delta=-1);this.Gmj(r,h,!1,B);return kr.G1m(h.Dw)}pFk(b,h,r,B,P,ca,ra){const Qa=Uf.OutlineElementReader.F4(b);0<Qa&&(B+=Qa);r=this.gNh(r,h,B,P);this.LXo(ca,ra,r);b=this.mhe(b,r);Zm.tq.Mz||h.listType||(h=h.gC,h===gk.a.im&&(h=1),b.setValue(Zm.tq.x6,h),b.setValue(Zm.tq.nsa,
h));return kr.r1m(r)}oIa(b,{waj:h=!1}={}){return Ad.GraphIterator.lca(()=>{if(!Uf.OutlineElementReader.Eh(b))return t.ULS.sendTraceTag(509678220,393,15,"Iterator not pointing to OE in remove list info word."),kr.tgc();const r=Uf.OutlineElementReader.AU(b);if(sq.a.instance.J(1)&&(null===r||void 0===r?0:r.qa.last.Mh))return t.ULS.sendTraceTag(509678219,393,15,"User tried to remove list from para with deleted EOP."),kr.tgc();const B=b.Ub(4);return B?r?this.g7b(r,()=>{var P;this.Faj(r);this.T_n(r);r.ND=
null;this.Jd.E_d(fg.ListItemReader.qk?fg.ListItemReader.bE(r,{yEa:0}).listId:B.ja(Mc.a.listID,0))?(B.M$c=!1,b.zg(),Ym.a.getInstance().Ov&&this.gE.Yda(r)):b.uc();h||this.Vho(b);b.Ub(4)&&(B.M$c=!1,b.zg(),Ym.a.getInstance().Ov&&this.gE.Yda(r));(this.Vd.xg&&!this.qRb||!this.Vd.xg&&r.Pi)&&(!r.Pi||(null===(P=r.Xy)||void 0===P?0:P.hasProperty(Mc.a.listID)))&&this.Iel(b);return kr.DHi()}):(t.ULS.sendTraceTag(509211404,393,15,"OutlineElement has listNode but no paraNode during removeListInfo"),B.M$c=!1,b.zg(),
kr.DHi()):kr.tgc()})}Vho(b){const h=Ao.hi.su(b.currentNode),r=Uf.OutlineElementReader.xFa(b),B=Uf.OutlineElementReader.IG(b),P=Uf.OutlineElementReader.F4(b);this.SMd(h);this.rh.Iza(b,1,Math.max(0,r+(P||-1*B)-this.Ftc[0]))}g7b(b,h){let r=null;sq.a.instance.J(1)&&b&&(r=b.$D());h=h();sq.a.instance.J(1)&&!this.qRb&&(b&&r&&this.Aq.DV(b,r,this.Vd.xg),this.r6());return h}T_n(b){b.hasProperty(Mc.a.ee)&&b.removeProperty(Mc.a.ee);b.hasProperty(Mc.a.RA)&&b.removeProperty(Mc.a.RA);b.hasProperty(Mc.a.ot)&&b.removeProperty(Mc.a.ot)}infoAtLevel(b,
h){if(!h)return null;const r=h.YB;if(1===h.ks){if(h.Ppa&&!h.OJ||!h.U7e(!1))return h;b=Uf.OutlineElementReader.xFa(b);const B=this.RZc(b),P=r.ZKb[B];b=Vp.a.z8(h.propertySet,h.propertySet);6===P?b.I$(1,1):b.I$(0,P);b.nhe("multilevel");b.levelText=r.TZc[B];r.fFa&&r.fFa[B]&&(b.font=r.fFa[B]);b.yw=r.S1d[B];b.n6=r.n6;b.J2d=h.J2d}else b=h;return b}ejo(b,h){null!==b&&void 0!==b&&b.Dw&&(h.levelText=b.Dw.levelText,h.Lz||(h.font=b.Dw.font))}j1l(b,h,r){let B=Uf.OutlineElementReader.xFa(b);const P=Uf.OutlineElementReader.F4(b);
0<P?B+=P:(b=Uf.OutlineElementReader.IG(b),0<b&&(B-=b));h=h.propertySet.ja(Mc.a.listLevel,-1);return r&&0<=h?h:this.RZc(B)}lGl(b,h){if(!this.dr.L2a(b.currentNode,h.Dw).listType){const r=this.Poa(b.currentNode,h.Dw);b=this.cKf(h.Dw,b,r);h.Dw.zMc=h.Dw.Qu=b.HSa===gk.a.im?r.startAt-1:b.HSa;h.Zbc=b.GKj}}LXo(b,h,r){0>=b?this.m0f[h+""]=r.listID:r.listID=b}Bsl(b,h,r,B){if(0>=h)return!1;const P=(ca,ra)=>ca.length!==ra.length||ca.some((Qa,tb)=>Qa!==ra[tb]);if(r)return h=this.Jd.L2a(B,r.Dw),b.Lz!==h.Lz||P(b.Kia,
h.Kia);r=b.propertySet.ja(Mc.a.listLevel,-1);return 0<=r&&(h=this.dr.Mx(B,h,r))&&(h=h.ja(Pd.a.k5,null))&&b.Kia?P(h,b.Kia):!1}S_n(b,h){var r,B;const P=!!h&&ke.ParagraphReader.Xb(h);let ca=0,ra=0;P&&(ca=this.ep.wU(fg.ListItemReader.qk?h:this.Jd.nsf(b)).Wt,ra=this.ep.IG(h).Wt);P&&this.Faj(h);null!==(r=Ym.a.getInstance())&&void 0!==r&&r.Mz||(b.Ub(4),b.zg());(null===(B=Ym.a.getInstance())||void 0===B?0:B.Ov)&&this.gE.Yda(h);P&&this.rh.Iza(b,1,ca-ra)}Yba(b,h,r,B=-1,P=!1,ca=null,ra=!1){t.ULS.sendTraceTag(17622211,
324,50,"'Continue Existing List' is selected from Context Menu.");const Qa=Nh.a.instance.Fp(Nb.a.Yba),tb=this.Lc.Pc(15);tb.St(b);let Mb=null,Zb=0;({NYm:Mb,mjn:Zb,returnValue:B}=this.OEl(b,h,B,Mb,Zb,P,ca));if(!Mb||ra&&(1===r||0>r-Mb.Dw.Qu||2<r-Mb.Dw.Qu))return tb.dispose(),Qa.end(),!1;for(;0<Zb;)b.wSc(),Zb--;this.HXo(b,h,B,Mb);tb.dispose();Qa.end();return!0}HXo(b,h,r,B){for(;b.wSc();){var P=fg.ListItemReader.p0(b);if(P&&(P=this.DGb(P),P.listID===h.listID)){h=new bA(0,h,r);Ym.a.getInstance().Ov?this.Qpg(b,
B,P.X0,h):this.Qpg(b,B,!0,h);break}}}OEl(b,h,r,B,P,ca=!1,ra=null){for(var Qa;b.zVd();){if(b.Jt(4)){const tb=this.EB(b),Mb=this.Jd.vw(b);if(Mb.listType!==ra.listType){P++;continue}if(ca&&Mb.listStyle!==ra.listStyle||!ca&&h.level<tb.level){P++;continue}-1===r&&(r=tb.Qu+1);B=null;if(h.level===tb.level||ca)null===(Qa=this.qad)||void 0===Qa?void 0:Qa.lBf(b),B=new tq(this,b,!1,!1);ca&&tb.level!==h.level&&b.Jt(4)&&(b.Ub(4).setValue(Mc.a.listLevel,tb.level),b.uc());break}P++}return{returnValue:r,NYm:B,mjn:P}}I3l(b){b=
fg.ListItemReader.p0(b);return this.QSd(b)}QSd(b){let h;sq.a.instance.J(1)&&(h=fg.ListItemReader.qk?fg.ListItemReader.bE(b)||fg.ListItemReader.EFa(b):this.Jd.hP(b,!1,!0));return this.Jd.Mx(b,h.listId,h.listLevel)}startNewList(b,h,r){t.ULS.sendTraceTag(17622212,324,50,"'Start New List' is selected from Context Menu.");if(h){var B=Nh.a.instance.Fp(Nb.a.startNewList),P=this.Lc.Pc(15);P.St(b);var ca=Vp.a.c0(0,h.listStyle,null,0,h.propertySet.ja(Mc.a.listLevel,-1));if(fg.ListItemReader.qk)({listId:ra,
listLevel:Qa}=fg.ListItemReader.AGb(b,{yEa:0,QDb:-1}));else{b.Ub(4);var ra=b.currentNode.ja(Mc.a.listID,0);var Qa=b.currentNode.ja(Mc.a.listLevel,-1);b.uc()}ca.J2d=ra;var tb=h.propertySet.ja(Mc.a.ee,0);0<tb&&ca.propertySet.setValue(Mc.a.ee,tb);-1===ca.propertySet.ja(Mc.a.listLevel,-1)&&ca.propertySet.setValue(Mc.a.listLevel,Qa);1===h.ks&&((Qa=new Sz.a,ra=h.Wji(b.currentNode,ra),ra)?1===ra&&(ca.nhe(Nv.a.igc),ca.YB=Qa.Pbf(Qa.FUf,Qa.GUf),ca.n6=ca.YB.n6):(ca.nhe(Nv.a.igc),ca.YB=Qa.Zaf(),ca.n6=ca.YB.n6));
h.Joa()&&1>r&&(r=1);ca.gC=r;ra=new fd.DictionaryPropertySet;ra=this.xNc(Nb.a.LL,ra);Qa=Uf.OutlineElementReader.AU(b);h=this.EB(b);if(tb=this.I3l(b))ca.levelText=tb.ja(Mc.a.pv,""),ca.OJ=42,ca.yw=tb.ja(Mc.a.vda,"left");this.S_n(b,Qa);({txa:ca}=this.Uma(ra,b,ca,!0));b.Ub(4);22!==b.currentNode.type&&63!==b.currentNode.type&&t.ULS.sendTraceTag(587851671,393,15,"Graph node {0} is not list node.",b.currentNode.type);Ym.a.getInstance().Mz||this.gE.TSb(b.currentNode,h.level);Ym.a.getInstance().Ov&&this.gE.TSb(Qa,
h.level);b.uc();ca=new tq(this,b,!1,!1);r=new bA(1,h,r);this.Qpg(b,ca,!!Ym.a.getInstance().Ov,r);P.dispose();B.end()}else t.ULS.sendTraceTag(51242764,324,50,"'Start New List' has no current ListInfo")}SGf(b){if(!b)return!1;const h=b.Ub(2);h&&b.uc();return sq.a.instance.J(1)&&h&&12===h.type&&h.qa&&h.qa.last&&h.qa.last.Mh?!0:!1}L$d(b,h,r,B){return this.fak.L$d(b,h,r,B)}Sag(b,h){if(!b||!h)return!1;const r=b.propertySet.ja(Mc.a.pv,null);h=h.propertySet.ja(Mc.a.pv,null);if(!r||!h)return!1;const B=b.propertySet.ja(Pd.a.font,
null);b=b.propertySet.ja(Pd.a.font,null);return r===h&&B===b}pnj(b,h,r){r||h.listType||(h.gC=b.ja(Pd.a.Z0,gk.a.im))}Tbi(b,h){if(!h)return null;const r=Array(9),B=h.J2d;if(!this.$Pm(h,b)||1>B)return null;for(h=0;9>h;h++){const P=this.Jd.Mx(b,B,h);if(null===P||void 0===P?0:P.hasProperty(Mc.a.ee))r[h]=P.getValue(Mc.a.ee);else return null}return r}$Pm(b,h){if(!b)return!1;const r=b.propertySet.ja(Mc.a.listLevel,-1);b=b.propertySet.ja(Mc.a.ee,-1);if(0>r||0>b)return!1;this.SMd(h);return b!==this.gWb[r]}xph(b,
h,r){b&&b.setValue(Mc.a.ee,h?h[r]:this.gWb&&r<this.gWb.length?this.gWb[r]:720*(r+1))}C2h(b,h,r,B,P,ca=null,ra=!1){const Qa=new Ad.GraphIterator,tb=this.Poa(b,h);Qa.set(b);Qa.qd();b=nm.a.Gs(Qa,Qa.lTb());b.yo(bu.a.k_c,null);let Mb=-1;for(;b.moveNext();){if(!fg.ListItemReader.lg(Qa))continue;const Zb=this.EB(Qa),jc=Uf.OutlineElementReader.AU(Qa);this.Jd.HP(Qa);const Gc=Qa.currentNode;Qa.uc();if(B!==this.Dje||Zb.listID===h.listID){if(ra){if(-1!==Mb&&Mb>Zb.level)break;if(-1===Mb)Mb=Zb.level;else if(Zb.level!==
Mb)continue}else{if(Zb.level<=tb.$Ta)break;if(!B(h,Zb,ca))continue}P(Gc,jc,r,h.listID,ca)}}}GIl(b,h,r,B,P){const ca=new Ad.GraphIterator,ra=this.Poa(b,h);ca.set(b);ca.qd();if(fg.ListItemReader.lg(ca)){b=this.EB(ca);var Qa=Uf.OutlineElementReader.AU(ca);this.Jd.HP(ca);var tb=ca.currentNode;ca.uc();b.level<=ra.$Ta||B(h,b,null)&&P(tb,Qa,r,h.listID,null)}}FIl(b,h,r,B,P=null){const ca=new Ad.GraphIterator;ca.kd(b);B(b,h,this.EB(ca),ca,0);this.zPd(b,h,r,B,P)}zPd(b,h,r,B,P=null){let ca=new Ad.GraphIterator;
const ra=this.Poa(b.currentNode,h);let Qa=null,tb=0;var Mb=new Ad.GraphIterator;Mb.kd(b);Mb.zb(10);const Zb=Ab.a.Gs(Mb,Mb.origin);for(Zb.moveNext();Zb.moveNext();)if(Qa=null,ca=Zb.iterator,1===ca.role&&(Qa=Zb.currentNode,ca.Jt(4)&&(Mb=this.EB(ca),r(h,Mb,P))))if(Mb.level>h.level)B(b,h,Mb,ca,tb),tb++;else if(Mb.level===h.level||Mb.level<=ra.$Ta)break;return Qa?ca:null}z7i(b,h,r,B,P){b=this.Poa(b.currentNode,r);b.$Ta>=h.level&&this.WCh(B,b.startAt+P)}static get qTm(){null==Ao.kvd&&(v.AFrameworkApplication.K?
(v.AFrameworkApplication.oe("i75ig452;a229j208"),Ao.kvd=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveRedundantRenumberingForListActions",!1)):Ao.kvd=!1);return Ao.kvd}static get hi(){return qo.PageNavigator.instance}static Cmj(b,h){h.setValue(Pd.a.font,b.Ppa||b.OVc||b.dTc?b.font:"Symbol")}static Emj(b,h){b=b.Ppa||b.OVc||b.Yoa?b.levelText:gk.a.wKd;t.ULS.shipAssertTag(22127637,338,!!b);h.setValue(Mc.a.pv,b)}static Dmj(b,h){b=b.propertySet.ja(Mc.a.vda,"left");h.setValue(Mc.a.vda,
b)}static oGm(b){b=b.iterator.parentNode;const h=Ad.GraphIterator.eb(b);b&&Uf.OutlineElementReader.OGf(h,null)&&b.ol(8,!0)}}Ao.sbn=2147450879;Ao.rPi=1;Ao.kvd=null;Object(m.a)(Ao,"FlatListEditorCssVersion",Zm,[675,676]);class $A{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc){this.dr=b;this.ryn=h;this.Pf=r;this.Zr=B;this.SA=P;this.k1m=ca;this.Qd=ra;this.Ej=Qa;this.y1m=tb;this.Zb=Mb;this.qc=Zb;this.uE=jc;this.gE=Gc}create(){return new Ao(this.dr,this.ryn,this.Pf,this.Zr,this.SA,this.k1m,this.Qd,this.Ej,
this.y1m,this.Zb,this.qc,this.uE,this.gE)}}Object(m.a)($A,"FlatListEditorFactory",null,[]);class aB{constructor(){this.startAt=this.listLevel=this.listId=0;this.tnb=null}}Object(m.a)(aB,"ListAutoCorrectionRefInfo",null,[]);class bB{constructor(b,h){this.E$j=b;this.Hf=h}L$d(b,h,r,B){if(!b.hasProperty(Yc.a.q5a))return!0;h=Ad.GraphIterator.eb(h.currentNode);xe.SelectionEditor.zu(h);let P=!0;if(!r.listType&&!B){23===h.Xe&&h.EJ(1);B=b.ja(Yc.a.q5a,1);if(1<B){var ca=new Ad.GraphIterator;ca.kd(h);ca.zb(10);
ca=Ab.a.gp(ca.origin);B=this.NEl(ca,B,r,h.currentNode);r.tnb||(P=!1)}b.setValue(Yc.a.q5a,B)}return P}NEl(b,h,r,B){const P=new mb.a;for(;b.moveNext()&&b.iterator.currentNode!==B;){const ca=b.iterator;if(!ca.Jt(4))continue;const ra=this.E$j.value.EB(ca),Qa=this.Hf.vw(ca);this.pLn(P,ra);Qa.listType===r.listType&&Qa.listStyle===r.listStyle&&(0>h-ra.Qu||2<h-ra.Qu||P.add(Object.assign(new aB,{listId:ra.listID,listLevel:ra.level,tnb:ca.currentNode,startAt:ra.Qu+1})))}0<P.count&&(h=P.J(P.count-1).startAt,
r.tnb=P.J(P.count-1).tnb);return h}pLn(b,h){let r=0;for(;r<b.count;){const B=b.J(r);B.listId===h.listID&&B.listLevel>=h.level?b.removeAt(r):r++}}}Object(m.a)(bB,"ListAutoCorrector",null,[663]);class gy{constructor(b,h,r,B,P){this.x8a=(ca,ra,Qa)=>{var tb;ca=fg.ListItemReader.qk?fg.ListItemReader.xQc(ra):this.IKc(ra);if(!ca||this.$s.SGf(ca))return 8;ra=this.$s.EB(ca);if(1===ra.Qu||this.aXc(ra.level))return 8;ra=null===(tb=this.Jd)||void 0===tb?void 0:tb.vw(ca);if(!ra||this.Szi(ra))return 8;if(1===Qa)return 32;
this.$s.startNewList(ca,ra,1);return 32};this.w8a=(ca,ra,Qa)=>{ca=fg.ListItemReader.qk?fg.ListItemReader.xQc(ra):this.IKc(ra);if(!ca||this.$s.SGf(ca))return 8;ra=this.$s.EB(ca);if(this.aXc(ra.level))return 8;const tb=this.Jd.vw(ca);if(!tb||this.Szi(tb))return 8;if(1===Qa)return 32;this.RLc.Y5l(ca.currentNode,ra.Qu,this.Jd,this.$s,this.mVa);return 32};this.Yba=(ca,ra,Qa)=>{ca=fg.ListItemReader.qk?fg.ListItemReader.xQc(ra):this.IKc(ra);if(!ca||this.$s.SGf(ca))return 8;ra=this.$s.EB(ca);if(1!==ra.Qu||
this.aXc(ra.level))return 8;if(1===Qa)return 32;Qa=this.Jd.vw(ca);return this.$s.Yba(ca,ra,Qa.gC,-1,!1,Qa)?32:8};this.Mqb=(ca,ra,Qa,tb,Mb)=>{ca=fg.ListItemReader.qk?fg.ListItemReader.xQc(ra):this.IKc(ra);if(!ca)return 8;ra=this.$s.EB(ca);if(this.aXc(ra.level))return 8;if(1===Qa)return 32;Qa=this.Jd.vw(ca);this.$s.startNewList(ca,Qa,Mb);return 32};this.Agb=(ca,ra,Qa,tb,Mb)=>{ca=fg.ListItemReader.qk?fg.ListItemReader.xQc(ra):this.IKc(ra);if(!ca)return 8;ra=this.$s.EB(ca);return this.aXc(ra.level)?8:
1===Qa?32:this.$s.Yba(ca,ra,ra.Qu,Mb)?32:8};this.oc=b;this.Jd=r;this.$s=B;this.RLc=P}aXc(b){return 0>b}Tb(){this.oc.ra(Nb.a.x8a,yc.a.LP,this.x8a);this.oc.ra(Nb.a.x8a,yc.a.Uc,this.x8a);this.oc.ra(Nb.a.x8a,yc.a.view,this.x8a);this.oc.Xc(Nb.a.x8a,12);this.oc.ra(Nb.a.w8a,yc.a.LP,this.w8a);this.oc.ra(Nb.a.w8a,yc.a.Uc,this.w8a);this.oc.ra(Nb.a.w8a,yc.a.view,this.w8a);this.oc.Xc(Nb.a.w8a,12);this.oc.ra(Nb.a.Yba,yc.a.LP,this.Yba);this.oc.ra(Nb.a.Yba,yc.a.Uc,this.Yba);this.oc.ra(Nb.a.Yba,yc.a.view,this.Yba);
this.oc.Xc(Nb.a.Yba,12);this.oc.ra(Nb.a.Mqb,yc.a.LP,this.Mqb);this.oc.ra(Nb.a.Mqb,yc.a.Uc,this.Mqb);this.oc.ra(Nb.a.Mqb,yc.a.view,this.Mqb);this.oc.Xc(Nb.a.Mqb,12);this.oc.ra(Nb.a.Agb,yc.a.LP,this.Agb);this.oc.ra(Nb.a.Agb,yc.a.Uc,this.Agb);this.oc.ra(Nb.a.Agb,yc.a.view,this.Agb);this.oc.Xc(Nb.a.Agb,12)}get mVa(){return Ma.a.instance.resolve("Common.IStandaloneRootController").pea}IKc(b){return this.$s.n3l(b)}Szi(b){return 1===(null===b||void 0===b?void 0:b.listType)}}Object(m.a)(gy,"ListContextMenuSectionActor",
null,[]);var om=c(601);class cA{static get w1m(){return Pe.a.Kx(cA.Xm,Box4Intl.Box4Strings.l_StartNewListDialog,Box4Intl.Box4Strings.l_ContinueFromPreviousList,Box4Intl.Box4Strings.l_SetValueTo)}}cA.Xm="<div class='WACDialogRow' id='StartNewList'> <input type='radio' id='ListRadioStartNew' name='ListRadioBox' class='WACDialogRadio' alt='{0}' title='{0}'></input> <label id='StartNewList' class='WACDialogLabel' for='ListRadioStartNew' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='ContinuePreviousList'> <input type='radio' id='ListRadioContinue' name='ListRadioBox' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ContinueFromPreviousList' class='WACDialogLabel' for='ListRadioContinue' >{1}</label> </div> <div class='WACDialogRow' id='SpinnerRow'> <div class='WACDialogGroupBox' id='ListStartAtSpinnerBox'> <label id='ListStartAtNumber' class='DialogSpinnerLabel' >{2}</label> <br/> <div id='SetListStartSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(m.a)(cA,"ListSetStartValueDialogHtml",null,[]);class Cu extends Pe.a{constructor(b,h,r,B,P){super();this.Dsd=this.oxe=this.Vsd=this.WTe=null;this.jze=!0;this.XS=!1;this.Bcb=0;this.Puj=[Nb.a.Xdg,Nb.a.Pig,Nb.a.H4f];this.Zno=(ca,ra)=>{ca=ra[Pi.a.Number];this.xaa=Number.isInteger(ra[Pi.a.Number])&&ca>=this.Bcb?ca:this.Bcb};this.Wem=(ca,ra)=>{this.xaa=this.xaa>=this.Bcb?this.xaa:this.Bcb;ra[Pi.a.Number]=this.xaa;ra[Pi.a.UnitType]=0};this.Xko=(ca,ra)=>{if(1===ca){var Qa=ra.ListRadioStartNew,tb=ra.ListRadioContinue,
Mb=Ad.GraphIterator.eb(this.Ef);Mb.qd();ra=this.$s.EB(Mb);ca=this.Hf.vw(Mb);if(Qa)this.$s.startNewList(Mb,ca,this.xaa);else if(tb)if(this.jze)this.$s.Yba(Mb,ra,this.jNe,-1,!1,ca);else{Qa=!0;for(tb=null;Mb.FJ();)if(fg.ListItemReader.lg(Mb)){tb=new tq(this.$s,Mb,!1,!1);break}if(!tb||this.$s.EB(Mb).Qu>=this.xaa)Qa=!1;Qa?(Mb=Ad.GraphIterator.eb(this.Ef),Mb.qd(),this.$s.Yba(Mb,ra,this.jNe,this.xaa,!1,ca)):(this.dispose(),this.JIa(CommonUIStrings.l_ErrorDialogMessage,this.v1m))}}};this.v1m=()=>{new Cu(this.Ef,
this.jNe,this.Hf,this.$s,this.Gd)};this.Oun=()=>{document.getElementById(Cu.EHi).style.visibility="visible"};this.fnn=()=>{document.getElementById(Cu.EHi).style.visibility="hidden"};this.yg="ListSetStartValueDialog";this.Vg=cA.w1m;this.Ef=b;this.xaa=h;this.Hf=r;this.jNe=h;this.d7=B;h=new Ad.GraphIterator;b?(h.set(b),h.qd(),Uf.OutlineElementReader.Eh(h)||ig.OutlineElementNavigator.Yd(h),fg.ListItemReader.lg(h)&&(h.Ub(4),b=h.currentNode,22===b.type&&(this.Hf.dY(b).Joa()?this.Bcb=1:this.Bcb=0))):this.Bcb=
1;this.Gd=P;this.Uh(Box4Intl.Box4Strings.l_SetNumberingValueList,this.Xko,{["ListRadioStartNew"]:!0,["ListRadioContinue"]:!1});this.jze&&(this.WTe=document.getElementById("ListRadioStartNew"),this.Vsd=this.Oun,this.oxe=document.getElementById("ListRadioContinue"),this.Dsd=this.fnn,He.a.addHandler(this.WTe,"click",this.Vsd),He.a.addHandler(this.oxe,"click",this.Dsd));for(const ca of this.Puj)Object(om.a)(ca,this.Zno,this.Wem);this.Gd.Hm()}get $s(){return this.d7}dispose(){if(!this.XS){for(const b of this.Puj)Object(om.b)(b);
this.jze&&(this.Vsd&&He.a.removeHandler(this.WTe,"click",this.Vsd),this.Dsd&&He.a.removeHandler(this.oxe,"click",this.Dsd));this.Gd.gZ("ListStartSpinner");super.dispose();this.XS=!0}}iOk(){const b=mi.l("none",this.Bcb+"","100","1");return mi.j(Cu.FHi,Nb.a.Xdg,Nb.a.H4f,Box4Intl.Box4Strings.l_SetValueTo,[b],null,Nb.a.Pig)}pBb(b){const h=document.getElementById(Cu.FHi);this.Gd.t_a("ListStartSpinner",b);b=this.Gd.ZFb("ListStartSpinner","Medium");h.appendChild(b)}V9(){const b=this.iOk();this.pBb(b)}}Cu.FHi=
"SetListStartSpinnerContainer";Cu.EHi="ListStartAtSpinnerBox";Object(m.a)(Cu,"ListSetStartValueDialog",Pe.a,[]);class xw{Y5l(b,h,r,B,P){new Cu(b,h,r,B,P)}static get instance(){return xw._instance||(xw._instance=new xw)}}xw._instance=null;Object(m.a)(xw,"ListDialogFactory",null,[662]);class dA{constructor(b,h,r){this.d7=b;this.Hf=h;this.Lc=r}lBf(b){t.ULS.shipAssertTag(40420184,393,Uf.OutlineElementReader.Eh(b));if(fg.ListItemReader.lg(b)){const h=this.Hf.vw(b);h.ks||this.azm(b,h)}}hXk(b){for(let h=
0;h<b.length;h++){const r=new Ad.GraphIterator;r.set(b.getContext(h).node);this.lBf(r)}}azm(b,h){const r=qo.PageNavigator.instance.su(b.currentNode),B=this.d7.EB(b),P=this.Lc.Pc(15);P.St(b);h=this.d7.AFk(r,b,h);this.d7.N3n(b,B.listID);P.dispose();this.Hf.L2a(b.currentNode,h)}}Object(m.a)(dA,"SingleLevelListEditor",null,[661]);var hy=c(311);class eA{H4i(b,h,r,B,P,ca){return b?v.AFrameworkApplication.va.Nf(b,h,r,!0,P,ca):8}}Object(m.a)(eA,"ListContextManager",null,[1298]);class us extends eA{constructor(b){super();
us.Twc=b}H4i(b,h,r,B,P,ca){if(!b||!b.length)return 8;let ra;const Qa=({pnm:b,onm:ra}=us.qq.mnm(b)).returnValue;let tb=1;for(const Zb of Qa.keys){var Mb=b.contains(Zb);const jc=Qa.J(Zb);us.qq.jTk(Qa.J(Zb),this.AIc(h),Mb)?Mb?(t.ULS.sendTraceTag(575213851,393,50,"List Actions: {0} lists, with change in level",this.AIc(h)?"Promote":"Demote"),Mb=v.AFrameworkApplication.va.Nf(hy.a.kEa(jc),h,r,B,P,ca)):(t.ULS.sendTraceTag(575213852,393,50,"List Actions: {0} lists, without change in level",this.AIc(h)?"Promote":
"Demote"),Mb=us.qq.qyn(Qa.J(Zb),this.AIc(h),ra.J(Zb))):(t.ULS.sendTraceTag(575213850,393,50,"List Actions: Tried to {0} lists, but unable to indent",this.AIc(h)?"Promote":"Demote"),Mb=8);tb=cd.ActionManager.H0c(tb,Mb)}return tb}AIc(b){return b===Nb.a.ZG?!0:!1}static get qq(){return us.Twc||(us.Twc=Ma.a.instance.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))}}us.Twc=null;Object(m.a)(us,"WordEditorListContextManager",eA,[]);class Oq{get name(){return"WordEditor.ListEditors"}wc(b){v.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&
(b.ia("WordEditor.ListEditors.IListAutoCorrector",()=>new bB(b.Ve("WordEditor.IFlatListEditor"),b.resolve("Box4.List.IListReader"))).ha(),b.ia("WordEditor.IFlatListEditor",()=>(new $A(b.resolve("WordEditor.List.IFlatListReader"),b.Ve("Box4.IOutlineElementIndentationEditor"),b.resolve("Box4.IOutlineElementEditor"),new Il.a,b.resolve("Box4.IParagraphIndentationReader"),b.resolve("WordEditor.ListEditors.IListAutoCorrector"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,
b.resolve("Box4.List.IListFormattingEditor"),b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.Styles.IWACStyleReader"),b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.List.ListItemEditor"))).create()).ha(),b.ia("Box4.List.IListEditor",()=>b.resolve("WordEditor.IFlatListEditor")).ha(),b.ia("Box4.List.ISingleLevelListEditor",()=>new dA(b.resolve("WordEditor.IFlatListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.Graph.IGraphTransactionFactory"))).ha(),b.ia("Box4.ListEditors.WordEditorListContextManager",
()=>new us(b.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))).as("Box4.ListEditors.IListContextManager"))}init(){(new gy(v.AFrameworkApplication.va,new Tp.a,Oq.Jd,Oq.$s,xw.instance)).Tb();const b=v.AFrameworkApplication.va;b.fb(Nb.a.H4f,yc.a.view,om.d,96);b.fb(Nb.a.Pig,yc.a.view,om.c,96);b.fb(Nb.a.Xdg,yc.a.view,om.c,96)}dispose(){}static get Jd(){return null!=Oq.vEg?Oq.vEg:Oq.vEg=Ma.a.instance.resolve("Box4.List.IListReader")}static get $s(){return null!=Oq.Zzg?Oq.Zzg:
Oq.Zzg=Ma.a.instance.resolve("WordEditor.IFlatListEditor")}static main(){L.a.instance.Gc(new Oq)}}Object(m.a)(Oq,"WordEditorListEditorsPackage",null,[1,2]);var fA=c(1718),lr=c(506),cB=c(2069);class hx extends mc.a{constructor(b,h,r,B,P,ca){super(b,h);this.styleId=null;this.Fh=0;this.dSa=null;this.characterData=r;this.paragraphNode=B;this.listMarker=P;this.k9=ca}}Object(m.a)(hx,"HeadingText",mc.a,[]);var hz=c(351),mn=c(1040);class cj{constructor(b,h,r,B,P,ca,ra){this.h_g=!0;this.w6g=0;this.$kh=8;this.lja=
null;this.aum=Qa=>{if(Qa.$r)return!0;Qa=Qa.role;return 1===Qa||2===Qa||4===Qa};this.y$j=b;this.lA=h;this.we=r;this.Hf=B;this.bG=P;this.E6=ca;this.AJe=ra}get ox(){return this.y$j.value}get bBf(){return this.h_g}set bBf(b){this.h_g=b}get oLb(){return this.w6g}set oLb(b){this.w6g=b}get aTb(){return this.$kh}set aTb(b){this.$kh=b}async H_l(){var b=this.AJe.value;if(!isNullOrUndefined(b)&&b.Ny)return b=await this.v8l(),this.l2f(b,!0);b=this.lja;return isNullOrUndefined(b)?null:Promise.resolve(this.l2f(b,
!0))}I_l(){return this.l2f([],!1)}l2f(b,h){const r=window.performance.now(),B=this.eai();if(!B)return null;const P=new mb.a;let ca=0;for(;B.moveNext();){var ra=B.iterator;if(11===ra.Xe){const Qa=this.Hf.nsf(ra),tb=ig.OutlineElementNavigator.Ee(ra,!0);h&&b[ca]&&b[ca].ParaId===ke.ParagraphReader.tR(tb)&&ca++;ig.OutlineElementNavigator.Yd(ra);if(!tb||!ke.ParagraphReader.Xb(tb)||tb.Gr||""===tb.characterData||"\ufffc"===tb.characterData)continue;const Mb=this.fSd(tb);Mb&&(Qa&&(Mb.listMarker=this.bG.Bmb(Qa,
!1).J9,ra=this.Hf.vw(ra),1===ra.listType&&ra.dTc&&(Mb.dSa=ra.font)),h&&(b[ca-1]&&b[ca-1].ParaId===ke.ParagraphReader.tR(tb)?Mb.Fh=ca:Mb.Fh=ca+1),P.add(Mb))}}t.ULS.sendTraceTag(591963592,3019,50,String.format("GetHeadingsDataForToc Duration: {0} ms;",window.performance.now()-r));return P}v8l(){const b=new Hf.a;var h=cB.a.Vba(v.AFrameworkApplication.rootQuerySignature,null);const r=new Ln.a;r.Jq=h;r.status=mn.a.requestReady;this.aek=window.performance.now();h=this.E6.Fha(0,()=>{if(2!=r.statusCode||
null==r.Mj||0==r.Mj.length||null==r.Mj[0]){const B=String.format("GetPageEndsOperation Failed with status code: {0};",r.statusCode);b.setException(Error.create(B));t.ULS.sendTraceTag(543802465,3019,10,B)}else b.Dg(r.Mj[0].PageEnds),t.ULS.sendTraceTag(543802466,3019,50,String.format("GetPageEndsDuration Duration: {0} ms;",window.performance.now()-this.aek))});h.IH(r);h.jU();return jh.b(b.task)}dai(){const b=this.eai();if(!b)return-1;let h=0;for(;b.moveNext();){const r=b.iterator;if(11===r.Xe){const B=
ig.OutlineElementNavigator.Ee(r,!0);ig.OutlineElementNavigator.Yd(r);B&&ke.ParagraphReader.Xb(B)&&!B.Gr&&""!==B.characterData&&"\ufffc"!==B.characterData&&this.fSd(B)&&h++}}return h}eai(){if(!this.ox)return t.ULS.sendTraceTag(591000526,3019,10,"PageNode is null"),null;var b=this.lA.jP(this.ox);if(!b)return t.ULS.sendTraceTag(591963593,3019,10,"pageContentNode is null."),null;b=Ad.GraphIterator.eb(b);if(!b.Ip())return t.ULS.sendTraceTag(591963594,3019,10,"Failed to root at PageContent."),null;b=Ab.a.Gs(b,
b.origin);b.yo(this.aum,null);return b}fSd(b){var h;return null!==(h=this.dlm(b))&&void 0!==h?h:this.O8l(b)}dlm(b){if(!zm.a.Xj)return this.elm(b);if(!this.XXm(b))return null;var h=Object(hz.c)(9);h=Object(hz.a)(h);h=[...ke.ParagraphReader.Lkf(b,h)];if(0===h.length)return null;const r=ke.ParagraphReader.Koa(b)+1;return this.AIh(b,h,r)}O8l(b){var h,r,B,P;if(!zm.a.Xj)return this.C_l(b);var ca=Object(hz.c)(9);ca=Object(hz.a)(ca);const ra=ke.ParagraphReader.MRc(b),Qa=this.we.JB(b),{cum:tb,UFl:Mb}=this.rgm(ra,
Qa,ca);ca=null!==(P=null!==(r=null===(h=Mb.linkedStyle)||void 0===h?void 0:h.k9)&&void 0!==r?r:null===(B=Mb.qw)||void 0===B?void 0:B.k9)&&void 0!==P?P:10;return this.DJb(ca-1)?this.AIh(b,tb,ca):null}AIh(b,h,r){var B;if(!this.DJb(r-1))return null;const {cCj:P,bCj:ca}=this.EOo(b,h);return 0===P.length?null:(h=null===(B=ke.ParagraphReader.TUd(b,P))||void 0===B?void 0:B.trim())&&""!=h?new hx(ca.Bd,ca.endCp,h,b,null,r):null}rgm(b,h,r){const B=[];let P={linkedStyle:null,qw:null},ca=null,ra=null;for(const Qa of b)if(ca=
Qa.d4.formatting?this.E_l(h,Qa.d4):ca,b=r(Qa)){if(!ra&&b){ra=ca;if(!ra)break;P=ca}else if(!this.cOm(ca,ra))break;B.push(Qa)}return{cum:B,UFl:P}}EOo(b,h){var r;let B=-1,P;for(P=0;P<h.length;P++){var ca=h[P],ra=b.characterData.substring(ca.d4.cp,ca.cpEnd),Qa=null===ra||void 0===ra?void 0:ra.trimStart();if(Qa){B=ca.d4.cp+(ra.length-Qa.length);break}}if(-1===B)return{cCj:[],bCj:{Bd:-1,endCp:-1}};ca=-1;for(ra=h.length;0<ra;ra--){Qa=h[ra-1];const tb=b.characterData.substring(Qa.d4.cp,Qa.cpEnd),Mb=null===
tb||void 0===tb?void 0:tb.trimEnd();if(Mb){ca=Qa.cpEnd-(tb.length-Mb.length);break}}return{cCj:null!==(r=h.slice(P,ra))&&void 0!==r?r:[],bCj:{Bd:B,endCp:ca}}}cOm(b,h){return null==b&&null==h&&b===h?!0:null==b||null==h?!1:h.linkedStyle&&b.linkedStyle&&h.linkedStyle.k9===b.linkedStyle.k9||h.qw&&b.qw&&h.qw.kDh==b.qw.kDh?!0:!1}E_l(b,h){h=pn.FormattingReader.Toa(h.formatting);b=this.G_l(b,h);h=this.D_l(h);return b||h?{linkedStyle:b,qw:h}:null}G_l(b,h){b=this.we.Lwa(h,b);if(!b)return null;h=b.ja(Mc.a.Oi,
9);return this.G$c(h)?{Dmp:b.id,k9:h+1}:null}D_l(b){var h;b=this.we.Ag(b);if(!b||!Ck.a.A1d(b))return null;const r=null!==(h=Ck.a.X9b(b))&&void 0!==h?h:"0";h=Number.parseInvariant(r);return this.DJb(h-1)?{kDh:b,k9:h}:null}elm(b){const h=ke.ParagraphReader.Koa(b);if(this.G$c(h))return new hx(0,b.characterData.length,b.characterData,b,null,h+1);if(this.DJb(h)){var r=this.we.So(b);r=this.we.Ag(r);if(Ck.a.iKb(r))return new hx(0,b.characterData.length,b.characterData,b,null,h+1)}return null}C_l(b){var h;
let r=h=null,B=-1;var P=-1,ca=this.we.JB(b);for(let Qa=0;Qa<b.qa.length;Qa++)if(h=b.qa.J(Qa),h.formatting){var ra=pn.FormattingReader.Toa(h.formatting);const tb=this.we.Ag(ra);if(!r&&(r=tb,P=(P=Ck.a.X9b(r))?Number.parseInvariant(P):0,!this.DJb(P-1)))break;ra=(ra=this.we.Lwa(ra,ca))?ra.ja(Mc.a.Oi,9):9;B=-1===B?ra:B;if(!(this.G$c(ra)&&B===ra||Ck.a.A1d(tb)&&r===tb))break}h=h.cp;ca=b.characterData.substring(0,h);return this.G$c(B)?new hx(0,h,ca,b,null,B+1):Ck.a.A1d(r)?new hx(0,h,ca,b,null,P):null}XXm(b){const h=
ke.ParagraphReader.Koa(b);if(!this.DJb(h))return!1;if(this.G$c(h))return!0;b=this.we.So(b);b=this.we.Ag(b);return Ck.a.iKb(b)?!0:!1}G$c(b){return this.bBf&&this.DJb(b)}DJb(b){return b>=this.oLb&&b<=this.aTb}}Object(m.a)(cj,"StyleBasedDocumentHeadings",null,[639]);var MC=c(1030);class gA{constructor(){this.startTime=0}}Object(m.a)(gA,"TocCallbackData",null,[]);class ht{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb){this.sqg=(jc,Gc,Uc)=>{const od=Gc.node;if(!od)return t.ULS.sendTraceTag(36705296,324,10,"Context node is null in UpdateTableOfContentsHandler."),
2;if(12!==od.type)return t.ULS.sendTraceTag(36705297,324,10,"Context node is not a paragraph in UpdateTableOfContentsHandler."),2;if(!od.Gr)return 2;if(1===Uc)return kc.SessionStatusManager.instance.Zj?8:32;this.rd&&this.rd.isFeatureEnabled(120)?this.rEc.gWo(od).then(Od=>{Od||this.qIj(od)}):this.qIj(od);return 32};this.K_o=jc=>{jc=window.performance.now()-jc.startTime;t.ULS.sendTraceTag(574408796,3019,50,String.format("UpdateTOC Duration: {0} ms;",jc));jc=Object.assign(new hc.a,{durationMs:jc});va.Health.instance.recordKpiSuccess(ht.$Lj,
jc);ht.b9a()};this.tti=(jc,Gc,Uc,od,Od)=>{if(ke.ParagraphReader.Xb(Gc.node)&&Gc.node.Gr)return 2;if(1===Uc)return kc.SessionStatusManager.instance.Zj?8:32;if(Gc.contextId!==yc.a.Uc||this.Ok.x9(Gc)||!ke.ParagraphReader.Xb(Gc.node))return 32;this.Vd.Zs(17);(null===Od||void 0===Od?0:Od.resolve)?this.rEc.LLh(Gc,Od.resolve):this.rEc.LLh(Gc);return 32};this.A8f=(jc,Gc,Uc)=>{jc=Gc.node;if(!jc)return t.ULS.sendTraceTag(39358978,324,10,"Context node is null in RemoveTableOfContentsHandler."),2;if(12!==jc.type)return t.ULS.sendTraceTag(39358979,
324,10,"Context node is not a paragraph in RemoveTableOfContentsHandler."),2;if(!jc.Gr)return 2;if(1===Uc)return kc.SessionStatusManager.instance.Zj?8:32;Uc=null;jc.isConnected&&(Uc=MC.a.p$b(jc,!0),Uc.boc(jc));Gc=new Ad.GraphIterator;Gc.set(jc);Gc.zb(8);Gc.jd(8);const od=this.Lc.Pc(15);od.St(Gc);this.rEc.s_n(jc)?(od.dispose(),Uc&&Uc.normalize(),ht.b9a()):(Uc&&Uc.cancel(),od.dispose(),t.ULS.sendTraceTag(556565975,3019,10,"Failed to remove TOC."));return 32};this.ga=b;this.mhd=h;this.Yc=B;this.Lc=P;
this.Ok=ca;this.rEc=ra;this.Vd=Qa;this.rd=tb;this.UWg=Mb;this.VI=Zb}Tb(){this.ga.ra(Nb.a.WSb,yc.a.paragraph,this.sqg);this.ga.ra(Nb.a.WSb,yc.a.Fd,this.sqg);this.ga.ra(Nb.a.WSb,yc.a.Uc,this.sqg);this.ga.Xc(Nb.a.WSb,1028);this.ga.ra(qb.a.CCf,yc.a.Uc,this.tti);this.ga.Xc(qb.a.CCf,1028);this.ga.ra(qb.a.Q6c,yc.a.paragraph,this.A8f);this.ga.ra(qb.a.Q6c,yc.a.Fd,this.A8f);this.ga.ra(qb.a.Q6c,yc.a.Uc,this.A8f);this.ga.Xc(qb.a.Q6c,1028)}qIj(b){va.Health.instance.recordKpiUsage(ht.$Lj,1,ht.yB,null);const h=
this.LOl(b),r=new gA;r.startTime=window.performance.now();this.mhd.Njj(h,Mc.a.ypg,this.Fjm(this.L8l(b)),this.K_o,null,r);this.rEc.JVk()}kQj(b){if(null!=b&&b.Gr)if(null==this.UWg.instance)t.ULS.sendTraceTag(539628835,3019,10,"Page Number Finder instance is null.");else{var h=this.UWg.instance.fei();b=this.GEl(b);var r=!1;1===this.VI.nu&&(r=!0);0!=b&&h!=b&&(h=[Object.assign(new ha.a,{name:"TOCPageNo",string:b}),Object.assign(new ha.a,{name:"HeadingPageNo",string:h}),Object.assign(new ha.a,{name:"isMainView",
string:r})],Ke.a("TOCPageNoMismatch",!0,void 0,h))}}GEl(b){for(let h=0;h<b.qa.length;h++){const r=b.qa.J(h);if(null!=r.Hc)for(let B=0;B<r.Hc.length;B++){const P=r.Hc.J(B);if(1===P.uf&&P.MU.trim().startsWith("PAGEREF"))return parseInt(b.characterData.substr(r.cp,b.characterData.length-r.cp))}}return 0}L8l(b){return b?b.ja(Mc.a.DN,null):(t.ULS.sendTraceTag(38638673,324,10,"Node is null in GetParaIdForUpdate."),null)}LOl(b){return this.Yc.Eoa(b,7,7).Ub(35)}Fjm(b){const h=[];h.push(b+",TOC,0");return h}static b9a(){v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.$("WordEditorTOCFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ma.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("InsertTOCInWordWeb","WordEditorTOCFloodgateIsEnabled")})},ht.xEa)}}ht.xEa=5E3;ht.$Lj="WordUpdateTOC";ht.yB="wwaengidc";Object(m.a)(ht,"TableOfContentsActor",null,[640]);class bC{}Object(m.a)(bC,"FieldData",null,[]);class iy extends bC{constructor(){super();this.trb=null}}Object(m.a)(iy,"TOCFieldData",bC,[]);class cC{constructor(b,
h,r,B,P,ca=null){this.eum=b;this.At=h;this.Fh=r;this.Qwj=B;this.listMarker=P;this.dSa=ca}}Object(m.a)(cC,"TOCHeadingData",null,[]);class dC{constructor(b,h){this.gXa=b;this.An=h}async fai(b){this.gXa.bBf=b.cBf;this.gXa.oLb=b.oLb;this.gXa.aTb=b.aTb;return this.gXa.H_l()}vPl(b){if(b=this.uPl(b))return this.An.Bwa(b)}uPl(b){const h=b.qa.length;for(let r=0;r<h;r++){const B=b.qa.J(r);if(B.hyperlink&&B.hyperlink.bda&&B.hyperlink.url.startsWith(F.a.ufb))return B.hyperlink.url.substr(B.hyperlink.url.indexOf("_Toc"))}return null}yde(b){(b=
this.vPl(b))&&this.An.dVf(b.id)}sgm(){return this.gXa.dai()}K3i(b,h){const r=new iy,B=new mb.a;for(const P of b){b=this.qgm(P,h);if(!b)return null;B.add(b)}r.trb=B;return r}qgm(b,h){let r;if(h&&(r=this.N9k(b),!r))return t.ULS.sendTraceTag(591184344,3019,10,"Unable to create bookmark for Table of Contents"),null;h=oi.AParagraphNode.UP(b.characterData.trim());const B=this.iim(b.k9);return new cC(h,r,b.Fh,B,b.listMarker,b.dSa)}N9k(b){const h=String.format("{0}{1}","_Toc",jd.a.GF());return this.An.KFc(h,
b.Ec,b.end,b.paragraphNode,b.paragraphNode)?h:null}iim(b){return String.format("toc {0}",b)}}Object(m.a)(dC,"TOCDataManager",null,[638]);class jy{Bhg(){const b=Object.assign(new Tf.StandardDialog,{Kt:v.AFrameworkApplication.cda,Cd:0,XIa:!1});b.BV(1);b.jka(WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogTitle,WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogMessage,()=>{})}static get instance(){return null!=jy.NCg?jy.NCg:jy.NCg=new jy}}Object(m.a)(jy,"TOCDialogHelper",null,[]);var iz=c(179),Pv=c(496),
yw=c(239),eC=c(151);class jz{constructor(b,h,r,B,P,ca,ra){this.Chg=b;this.jlb=h;this.cBf=r;this.oLb=B;this.aTb=P;this.LAb=ca;this.ndd=[];this.MU=ra}toString(){return"showPageNumber:"+this.Chg+"  isHyperlink:"+this.jlb+" includeOutlineLevels:"+this.cBf+" lowerOutlineLevel:"+this.oLb+" upperOutlineLevel:"+this.aTb+" addContentControl:"+this.LAb+" unsupportedSwitches:"+this.ndd.toString()}}Object(m.a)(jz,"TOCSettings",null,[]);class yi{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc,Uc,od,Od,ze,de,ee){this.M_g=
"TOC";this.xkf=this.cye=this.iWe=null;this.Q8a=b;this.rh=h;this.AD=r;this.$u=B;this.qz=P;this.Ok=ca;this.hb=ra;this.Md=Qa;this.Jjh=tb;this.De=Mb;this.gWe=Zb;this.$o=Gc;this.XI=Uc;this.Wn=od;this.Lc=Od;this.Ib=ze;this.Mg=de;this.gb=ee}static get WVo(){if(null!=yi.Zzd)return yi.Zzd;v.AFrameworkApplication.oe("i430a979-t;a1f4j306-c");yi.Zzd=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateEmptyTOCFormattingRunId",!1);return yi.Zzd}get uVc(){return this.M_g}set uVc(b){this.M_g=
b}get urb(){this.iWe||(this.iWe=this.N8h());return this.iWe}N8h(){return new jz(!0,!0,!0,0,8,!0,this.uGn())}async LLh(b,h){Ke.a(yi.Efl);const r=window.performance.now();if(this.gb.Xb(b.node))if(this.Ok.x9(b))t.ULS.shipAssertTag(592233794,3019,!1,"We can't insert table of contents, current insertion point is in locked range"),yi.jSa("IP is in locked range");else{var B=await this.Q8a.fai(this.urb);if(B){var P=new Me.a(2,1,0,()=>{this.Gfl(b,B,this.urb.jlb,r);h&&h()});this.Ib.Wb(P)}else t.ULS.sendTraceTag(592233795,
3019,10,"Failed to create table of contents."),yi.jSa("Failed to get TOC data")}else t.ULS.shipAssertTag(592233793,3019,!1,"We can't insert table of contents, current context is not paragraph context"),yi.jSa("Context should be paragraph")}Gfl(b,h,r,B=0){let P;try{if(0==B&&(B=window.performance.now()),this.q_h(b.node)){var ca=new Ad.GraphIterator;ca.set(b.node);ca.zb(7);ca.jd(7);P=this.Lc.Pc(15);P.St(ca);var ra=this.Q8a.K3i(h,r);ra||yi.jSa("Failed to prepare TOC Field data");var Qa=ra.trb?ra.trb.count:
0;if(Qa){h=null;var tb;for(r=0;r<Qa;r++){const Gc=ra.trb.J(r);if(!({CDb:tb}=this.qti(b,h,r,Qa,Gc,Zb?Zb.toString():void 0)).returnValue){yi.jSa("Failed to populate new TOC paragraph");return}if(0==r){var Mb=tb.currentNode;var Zb=ke.ParagraphReader.tR(Mb)}h=tb}if(this.urb.LAb&&!this.Saf(Mb.id,h.Gn.id))yi.jSa("Failed to add content control block");else{var jc=window.performance.now()-B;Ke.a(yi.pcf,!0,jc)}}else if(this.gWe.Bhg(),this.jal(b)){const Gc=window.performance.now()-B;Ke.a(yi.pcf,!0,Gc)}}else yi.jSa("Failed to fetch style set")}catch(Gc){yi.jSa(String.format("{0} {1}",
Gc.message,Gc.stack))}finally{P&&P.dispose()}}q_h(b){this.cye=this.qz.JB(b);return this.cye?!0:(t.ULS.sendTraceTag(592233796,3019,15,"Failed to fetch style set"),!1)}static cHa(b){b=[Object.assign(new ha.a,{name:yi.I_o,string:b})];Ke.a(yi.uqg,!1,void 0,b)}static MNf(b){b=[Object.assign(new ha.a,{name:yi.Z0n,string:b})];Ke.a(yi.qbj,!1,void 0,b)}static jSa(b){b=[Object.assign(new ha.a,{name:yi.Ffl,string:b})];Ke.a(yi.pcf,!1,void 0,b)}async gWo(b){const h=this.qii(b);if(null==h)yi.cHa("Cannot update TOC when firstTocPara = null");
else{var r=this.ugm(h);if(0<r.ndd.length)return this.q8m(r.ndd),!1;Ke.a(yi.H_o);var B=window.performance.now(),P=await this.Q8a.fai(r);if(!P)return t.ULS.sendTraceTag(559248668,3019,10,"Failed to get data for TOC update."),yi.cHa("Failed to fetch TOC data"),!1;b=new Me.a(1,1,0,()=>{this.J_o(h,P,r,B)});this.Ib.Wb(b);return!0}}J_o(b,h,r,B=0){let P;try{if(null==b)yi.cHa("Attempt to update TOC when firstTocPara = null");else{0==B&&(B=window.performance.now());var ca=new Ad.GraphIterator;ca.set(b);ca.zb(7);
ca.jd(7);P=this.Lc.Pc(15);P.St(ca);var ra=this.Q8a.K3i(h,r.jlb);if(null==ra)yi.cHa("Attempt to update TOC when tocFieldData = null");else{var Qa;if(({f7e:Qa}=this.Maj(b,r)).response){t.ULS.sendTraceTag(559018207,3019,50,String.format("Attempting to update TOC with settings: {0}",r.toString()));var tb=ra.trb?ra.trb.count:0;if(this.q_h(b)){var Mb;this.fBi(b)&&(this.pbj(b),(b=this.gb.Xf(b,!1,!0))&&(Mb=b.ja(Mc.a.Wc,null).toString()));var Zb=b.ja(Mc.a.DN,null);h=Zb;Mb=null!==Mb&&void 0!==Mb?Mb:Zb;if(tb){for(var jc=
0,Gc;b.Gr&&h==Zb&&jc<tb;){const Od=ra.trb.J(jc);r.jlb&&this.Q8a.yde(b);if(!this.k_o(b,jc,tb,Od,r)){t.ULS.sendTraceTag(559248669,3019,10,"Failed to Update TOC Paragraph.");yi.cHa("Failed to update TOC paragraph");return}b.setValue(Mc.a.DN,Mb);jc++;Gc=b;b=this.gb.Xf(Gc,!1,!0);if(!b){h=null;break}this.mBi(b)&&this.obj(b);h=b.ja(Mc.a.DN,null)}h==Zb&&this.q8f(b);var Uc;if(({dKf:Uc}=this.Huk(ra,jc,tb,Gc,Mb)).response)if(r.LAb&&!this.Saf(Qa,Uc.id))yi.cHa("Failed to add content control block");else{var od=
window.performance.now()-B;Ke.a(yi.uqg,!0,od)}else yi.cHa("Failed to add new paragraph")}else this.gWe.Bhg(),this.E_o(b,r.LAb,Qa,r.MU,Mb)&&(jc=window.performance.now()-B,Ke.a(yi.uqg,!0,jc))}else yi.cHa("Failed to fetch style set")}else yi.cHa("Failed to remove Content Control")}}}catch(Od){yi.cHa(String.format("{0} {1}",Od.message,Od.stack))}finally{P&&P.dispose()}}Huk(b,h,r,B,P){let ca=new Ad.GraphIterator;for(ca.set(B);h<r;){B=b.trb.J(h);if(!({CDb:B}=this.qti(null,ca,h,r,B,P)).returnValue)return{dKf:ca.currentNode,
response:!1};ca=B;h++}return{dKf:ca.currentNode,response:!0}}Maj(b,h){var r;let B,P;const ca=null===(r=null===b||void 0===b?void 0:b.qa)||void 0===r?void 0:r.first.Jb;if(ca&&0<ca.length)if(b=b.qa.first.Jb.J(0),b.Jf){r=b.contentControlNode.getValue(Mc.a.Zw);B=this.Mg.Gq(b.contentControlNode.id,!0);P=this.Mg.Gq(b.contentControlNode.id,!1);if(0!=this.$o.VOb(r))return t.ULS.sendTraceTag(558952907,3019,10,"Failed to release content control"),{response:!1,f7e:B,ICh:P};h.LAb=!0}else t.ULS.sendTraceTag(528537613,
3019,15,"Content control is not block type"),h.LAb=!1;else h.LAb=!1;return{response:!0,f7e:B,ICh:P}}E_o(b,h,r,B,P){t.ULS.sendTraceTag(559018209,3019,50,"Updating old TOC to empty TOC");this.Q8a.yde(b);const ca=this.dRd(b);if(!this.T2i(ca,h,r,B))return yi.cHa("Failed to populate empty TOC."),!1;if(h=this.gb.Xf(b,!1,!0))r=b.ja(Mc.a.DN,null),B=h.ja(Mc.a.DN,null),r==B&&this.q8f(h);b.setValue(Mc.a.DN,P);return!0}T2i(b,h,r,B){this.Md.Ge(b,WordEditorIntl.WordEditorStrings.L_EmptyTOCText);b=b.node;this.fQi(b);
const P=b.qa.first;this.De.HL(P.formatting,!0);this.cbf(b,0,1,B);yi.WVo&&P.Ofg&&b.ye.vq.Z(P.formatting.qe,yr.CharacterPropertiesEditor.aN);return h&&r&&!this.Saf(r,b.id)?!1:!0}dRd(b){b.qa.reset();b.yOa();const h=new iz.a(b,0);h.formatting=new eC.a(h,V.a.nil);h.Ph=!0;b.qa.add(h);return Ue.a.createTextRange(b,0,b.characterData.length)}fBi(b){if(ke.ParagraphReader.oP(b)){var h=b.qa.last.Hc;if(!h||!h.length)return!1;if(4<=h.length){b=0===h.J(h.length-4).uf;const r=1===h.J(h.length-3).uf&&h.J(h.length-
3).MU.trim().startsWith(this.uVc),B=2===h.J(h.length-2).uf;h=5===h.J(h.length-1).uf;return b&&r&&B&&h}}return!1}mBi(b){if(ke.ParagraphReader.oP(b)){var h=b.qa.first.Hc;if(!h||!h.length)return!1;if(2<=h.length)return b=4===h.J(0).uf,h=3===h.J(1).uf,b&&h}return!1}pbj(b){const h=b.qa.last.Hc,r=h.J(h.length-4),B=h.J(h.length-3),P=h.J(h.length-2),ca=h.J(h.length-1);h.remove(r);h.remove(B);h.remove(P);h.remove(ca);b.removeProperty(Mc.a.DN)}obj(b){const h=b.qa.first.Hc,r=h.J(0),B=h.J(1);h.remove(r);h.remove(B);
b.removeProperty(Mc.a.DN)}q8f(b){if(b){var h=b.ja(Mc.a.DN,null),r=b.ja(Mc.a.Wc,null).toString(),B=h;r==h&&this.fBi(b)&&(this.pbj(b),(b=this.gb.Xf(b,!1,!0))&&(B=b.ja(Mc.a.DN,null)));r=new Ad.GraphIterator;r.set(b);r.zb(8);t.ULS.sendTraceTag(559018210,3019,50,"Attempting to remove TOC paragraphs");for(var P;b&&b.Gr&&B==h&&P!=b;){if(this.mBi(b)){this.obj(b);break}this.Q8a.yde(b);this.Wn.Yd(r);B=this.Wn.ns(r,!1,!0);this.rh.kza(b);if(!B)return null;P=b;r.Ub(2);B=(b=r.currentNode)?b.ja(Mc.a.DN,null):null}return b}}ugm(b){var h=
b.qa,r=h?h.length:0,B=null;b=new jz(!0,!1,!1,0,8,!0,void 0);for(let P=0;P<r&&(B=this.tgm(h.J(P)),b.MU=B,B=this.mdm(B),B[0]!==this.uVc);P++);h=B?B.length:0;for(r=1;r<h;r++)switch(B[r]){case "\\h":b.jlb=!0;break;case "\\u":b.cBf=!0;break;case "\\o":this.Ulo(B[r+1],b)&&r++;break;case "\\z":break;case "\\n":b.Chg=!1;b.ndd.push(B[r]);break;default:b.ndd.push(B[r])}return b}Ulo(b,h){return b&&(b=b.match(RegExp('^"([0-9])-([0-9])"$')))&&3===b.length?(h.oLb=Number.parseInvariant(b[1])-1,h.aTb=Number.parseInvariant(b[2])-
1,!0):!1}s_n(b){try{Ke.a(yi.Y0n);const h=window.performance.now(),r=this.qii(b);if(null==r){yi.MNf("Attempt to remove TOC when firstTocPara = null");return}let B,P,ca;const ra=this.N8h();if(!({f7e:B,ICh:P}=this.Maj(r,ra)).response)return yi.MNf("Failed to remove content control"),!1;if(void 0==B&&void 0==P)ca=this.q8f(r);else{ca=r.Mc.Eb(B);const tb=new Ad.GraphIterator;tb.set(ca);tb.zb(8);b=!1;let Mb;for(;!b&&ca&&Mb!=ca;){ca.id.equals(P)&&(b=!0);ca&&ca.Gr&&this.Q8a.yde(ca);this.Wn.Yd(tb);const Zb=
this.Wn.ns(tb,!1,!0);this.rh.kza(ca);if(!Zb){ca=null;break}tb.Ub(2);Mb=ca;ca=tb.currentNode}}ca&&this.T0c(ca);const Qa=window.performance.now()-h;Ke.a(yi.qbj,!0,Qa)}catch(h){yi.MNf(String.format("{0} {1}",h.message,h.stack))}return!0}T0c(b){b=Ue.a.Rc(b,0);b=new Rg.Selection([b],!0);this.hb.Ac(b)}Saf(b,h){return this.$o.Pma(b,h,null,yi.sUh,!0).returnValue?(t.ULS.sendTraceTag(573653840,3019,10,"Failed to create content control block for table of contents."),!1):!0}JVk(){this.Q8a.sgm()||this.gWe.Bhg()}qii(b){if(!b.Gr)return t.ULS.sendTraceTag(528320659,
3019,15,"Cannot get TOC Begin Paragraph. Para is not in TOC"),null;b=b.ja(Mc.a.DN,null);return this.XI.V8l(b)}q8m(b){b.length&&(b=[Object.assign(new ha.a,{name:"UnsupportedSwitches",string:b.toString()})],Ke.a("UnsupportedTocInstruction",void 0,void 0,b))}tgm(b){const h=(b=b.Hc)?b.length:0;for(let r=0;r<h;r++)if(1===b.J(r).uf&&b.J(r).MU.trim().startsWith(this.uVc))return b.J(r).MU.trim();return null}mdm(b){const h=[];if(!b)return h;b=b.split(" ");return b.length?b:h}jal(b){b=this.jNh(b,null,!0,void 0).returnValue;
if(!b)return yi.jSa("Failed to create paragraph"),!1;const h=Ue.a.Rc(b,0);if(!this.T2i(h,!0,b.id,this.urb.MU))return yi.jSa("Failed to populate empty TOC"),!1;t.ULS.sendTraceTag(575447938,3019,50,"Created an empty table of contents.");return!0}jNh(b,h,r,B){let P,ca;r&&b?(P=this.Aal(b),ca=P.currentNode,B=ke.ParagraphReader.tR(ca).toString()):h&&(P=this.$5l(h),ca=this.rh.NH(P));if(!ca)return t.ULS.sendTraceTag(592233798,3019,15,"Failed to insert paragraph for table of contents"),{returnValue:null,CDb:P};
ca.setValue(Mc.a.DN,B);return{returnValue:ca,CDb:P}}uGn(){const b=new Sys.StringBuilder(this.uVc);b.append(" \\o \\z \\u");b.append(" \\h");return b.toString()}KGn(b){const h=new Sys.StringBuilder("PAGEREF ");h.append(b);this.urb.jlb&&h.append(" \\h");return h.toString()}$5l(b){b.qd();this.Wn.Yd(b);return this.rh.npa(b,!1)}Aal(b){const h=new Ad.GraphIterator;h.set(b.node);h.qd();this.Wn.Yd(h);let r=this.Tci(h);const B=!b.cpBegin;if(Uf.OutlineElementReader.isEmpty(h,!0))return this.$si(r);if(B)return this.rh.My(r,
!0,!1),this.rh.S$(h,r,b,!1,!1,!1),b=this.Tci(r),this.$si(b);r=this.rh.npa(h);this.rh.S$(h,r,b,!1,!1,!0);b=this.rh.npa(h);this.rh.xQb(b.currentNode,!1);this.rh.NH(b);this.Wn.Ee(b);return b}Tci(b){const h=new Ad.GraphIterator;h.kd(b);h.qd();return h}$si(b){this.rh.My(b,!0,!0);this.rh.xQb(b.currentNode,!1);this.Wn.Ee(b);return b}fQi(b){const h=b.qa;1===h.length&&(h.first.Ph=!1,b.QMd().Ph=!0)}k_o(b,h,r,B,P){const ca=this.dRd(b);this.Md.Ge(ca,"");this.X2i(b,B,P);this.cbf(b,h,r,P.MU);return P.jlb&&!this.fF(b,
B.At)?!1:!0}qti(b,h,r,B,P,ca){h=({CDb:b}=this.jNh(b,h,0==r,ca)).returnValue;if(!h)return{returnValue:!1,CDb:b};this.X2i(h,P,this.urb);this.cbf(h,r,B,this.urb.MU);return this.urb.jlb&&!this.fF(h,P.At)?{returnValue:!1,CDb:b}:{returnValue:!0,CDb:b}}X2i(b,h,r){this.JDm(b,h.eum,h.listMarker,h.Qwj,h.dSa);this.Jjh.kFm(b,b.characterData.length);r.Chg&&this.CEm(b,h);this.fQi(b);this.ooo(b,h.Qwj)}w3l(b,h){if(!b)return 0;const r=yi.jim();return 4<b.length?r.J(h)+.5*Math.floor(b.length/3):r.J(h)}JDm(b,h,r,B,
P){r&&this.ZDm(b,r,B);r=Ue.a.Rc(b,b.characterData.length);this.Md.Ge(r,h);P&&(b=b.qa.nh(0),this.De.$ja(b.formatting,P))}ZDm(b,h,r){r=this.w3l(h,r);const B=Ue.a.Rc(b,0);this.Md.Ge(B,h);this.Jjh.$Dm(b,h.length,r)}CEm(b,h){var r=Ue.a.Rc(b,b.characterData.length);this.Md.Ge(r,h.Fh.toString());r=b.qa.nh(b.characterData.length-h.Fh.toString().length);h=this.KGn(h.At);this.VQa(b,r,0,2,h);this.VQa(b,r,1,2,h);this.VQa(b,r,2,2,h);r=b.qa.nh(b.characterData.length);this.VQa(b,r,3,2,h)}ooo(b,h){h=this.cye.oj(h);
this.$u.aK(h,b,!0)}cbf(b,h,r,B){const P=b.qa.first,ca=b.qa.last;h?this.VQa(b,P,4,1,B):(this.VQa(b,P,0,1,B),this.VQa(b,P,1,1,B),this.VQa(b,P,2,1,B));h===r-1?this.VQa(b,ca,3,1,B):this.VQa(b,ca,5,1,B)}VQa(b,h,r,B,P=null){r=new Pv.a(h,null,r,B,!0,!1,!1,P);h.Hc||(h.Hc=new yw.a(h));h.Hc.add(r);b.Wl();this.mgl(r,b)}mgl(b,h){b.qe?h.ye.uY(b.qe-1,2):h.ye.lpa(b.qe,2);h.ye.vq.Z(b.qe,yr.CharacterPropertiesEditor.aN);h.ye.nt.Z(b.qe,yr.CharacterPropertiesEditor.YR)}fF(b,h){b=Ue.a.createTextRange(b,0,b.characterData.length);
return this.AD.fF(b,h,!1,!1,!1,!0)?!0:(t.ULS.sendTraceTag(592233799,3019,50,"Failed to create hyperlink for table of contents entries"),!1)}static jim(){yi.qua||(yi.qua=new Sb.a,yi.qua.Z("toc 1",1),yi.qua.Z("toc 2",1.5),yi.qua.Z("toc 3",2),yi.qua.Z("toc 4",2.5),yi.qua.Z("toc 5",3),yi.qua.Z("toc 6",3.5),yi.qua.Z("toc 7",4),yi.qua.Z("toc 8",4.5),yi.qua.Z("toc 9",5));return yi.qua}}yi.qua=null;yi.sUh="Table of Contents";yi.Efl="CreateTocClient";yi.pcf="CreateTocSuccess";yi.Ffl="CreateTocFailureCause";
yi.H_o="UpdateTocClient";yi.uqg="UpdateTocSuccess";yi.I_o="UpdateTocFailureCause";yi.Y0n="RemoveTocClient";yi.qbj="RemoveTocSuccess";yi.Z0n="RemoveTocFailureCause";yi.Zzd=null;Object(m.a)(yi,"TOCField",null,[449,450]);var zw=c(644);class hA{constructor(b,h){this.hBa=b;this.vKa=h}kFm(b,h){if(ke.ParagraphReader.Xb(b)&&!(0>h)){var r=Rn.a.k4b(b);r=new zw.a(r,4,1,1);this.hBa.VXd(b,r);b=Ue.a.Rc(b,h);this.vKa.iYd(b)}}$Dm(b,h,r){var B=Am.a.GM/2;const P=b.qa.bjb(h);B=pn.FormattingReader.ao(P.formatting,Pd.a.fontSize,
2*B)/2;r=new zw.a(Ze.a.Nv(B/36)*r,1,0,1);this.hBa.VXd(b,r);b=Ue.a.Rc(b,h);this.vKa.iYd(b)}}Object(m.a)(hA,"TOCTabUtility",null,[498]);class fC{constructor(){this.W=null}get name(){return"WordEditor.TableOfContents"}wc(b){this.W=b;this.W.ia("WordEditor.AutoSaveParamsUpdateService",()=>new fA.a(this.W.resolve("Box4.Graph.IGraphIteratorFactory"),lr.a.mR)).ha();this.W.ia("WordEditor.TableOfContents.StyleBasedDocumentHeadings",()=>new cj(new pf.a(()=>Eb.App.za.jb.Zc),qo.PageNavigator.instance,this.W.resolve("Box4.Styles.IWACStyleReader"),
this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IListMarkerUtility"),new ut.a,new pf.a(()=>Eb.App.za.jb.rc))).as("WordEditor.TableOfContents.IDocumentHeadings").ha();this.W.ia("WordEditor.TableOfContents.TOCDataManager",()=>new dC(this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings"),this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).as("Box4.ITOCDataManager").ha();this.W.ia("WordEditor.TableOfContents.TOCTabUtility",()=>new hA(this.W.resolve("WordEditor.ICustomTabStopUtility"),
this.W.resolve("Box4.IBlobEditor"))).as("WordEditor.TableOfContents.ITOCTabUtility").ha();this.W.ia("WordEditor.TableOfContents.TOCField",()=>new yi(this.W.resolve("Box4.ITOCDataManager"),this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.IHyperlinkEditor"),this.W.resolve("Box4.Styles.IWACStyleEditor"),this.W.resolve("Box4.Styles.IWACStyleReader"),Wh.a.instance,this.W.resolve("Box4.ISelectionManager"),this.W.resolve("Box4.ICharacterPropertiesEditor"),this.W.resolve("WordEditor.TableOfContents.ITOCTabUtility"),
this.W.resolve("Box4.IFormattingEditor"),jy.instance,this.W.resolve("Box4.IFeatureHelper"),this.W.resolve("WordEditor.ContentControl.IContentControlManager"),this.W.Oa("WordEditor.ParagraphWordIdMapping"),this.W.resolve("Box4.IOutlineElementNavigator"),Il.a.instance,v.AFrameworkApplication.lc,this.W.resolve("Box4.ContentControlParagraphMapping"),b.resolve("Box4.IParagraphReader"))).as("WordEditor.TableOfContents.ITOCField").ha();this.W.ia("WordEditor.TableOfContents.TableOfContentsActor",()=>new ht(v.AFrameworkApplication.va,
this.W.resolve("WordEditor.AutoSaveParamsUpdateService"),this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.Graph.IGraphIteratorFactory"),Il.a.instance,Wh.a.instance,this.W.resolve("WordEditor.TableOfContents.ITOCField"),this.W.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.W.resolve("Box4.IFeatureHelper"),this.W.Ta("WordEditor.IPageNumberFinder"),b.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.TableOfContents.ITableOfContentsActor").ha()}init(){this.W.resolve("WordEditor.TableOfContents.ITableOfContentsActor").Tb()}dispose(){}}
Object(m.a)(fC,"PackageManager",null,[1,2]);class Ip{constructor(b,h,r,B,P,ca,ra,Qa){this.uTa=(tb,Mb,Zb,jc,Gc)=>{if(!({Ay:tb}=this.qqb(Mb,Zb,Gc,!0,!0)).returnValue)return tb;this.Iyd.rMh(Gc,Mb.node);return 32};this.$ya=(tb,Mb,Zb,jc,Gc)=>this.Xmi(Mb,Zb,jc,Gc,!0);this.JNb=(tb,Mb,Zb,jc,Gc)=>{if(!({Ay:tb}=this.qqb(Mb,Zb,Gc,!1,!0)).returnValue)return tb;this.Iyd.pcl(Gc,Mb.node);t.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");return 32};this.Xma=(tb,Mb,Zb,jc,Gc)=>{if(!({Ay:jc}=this.qqb(Mb,Zb,Gc,!1,
!0)).returnValue)return 2==Zb&&8==jc&&qh.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],ae.a.NEb),jc;const Uc=Mb.node;let od=null;(od=tb===Nb.a.Xma?this.Iyd.zTb(Gc[qg.a.SourceControlId],Uc):this.Ex.AUd(Uc,Gc))?(this.K$d(Uc,()=>{this.FAd.CQb(od,Uc)}),this.kQ(),jc=32):(qh.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],ae.a.NEb),jc=8);tb===Nb.a.Xma&&32===jc&&t.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");t.ULS.shipAssertTag(0,
324,32===jc);return jc};this.Rua=(tb,Mb,Zb,jc,Gc)=>this.Xmi(Mb,Zb,jc,Gc,!1);this.wle=(tb,Mb,Zb,jc,Gc)=>$r.a.Kqa(tb,Mb,Zb,jc,Gc,{},14);this.tCb=(tb,Mb,Zb,jc,Gc)=>{if(!({Ay:tb}=this.qqb(Mb,Zb,Gc,!1,!1)).returnValue)return tb;const Uc=Mb.node;this.K$d(Uc,()=>{this.FAd.vZk(Uc)});return 32};this.Ex=b;this.Iyd=h;this.ga=r;this.FAd=B;this.Lc=P;this.gA=ca;this.J9j=Qa}Tb(){this.hjc(Eb.App.lVa.ULh())}hjc(b){this.ga.ra(Nb.a.uTa,yc.a.view,b);this.ga.ra(Nb.a.uTa,yc.a.table,this.uTa);this.ga.Xc(Nb.a.uTa,1127);
this.ga.ra(Nb.a.Xma,yc.a.view,this.wle);this.ga.ra(Nb.a.Xma,yc.a.table,this.Xma);this.ga.Xc(Nb.a.Xma,1030);this.ga.ra(Nb.a.NQ,yc.a.table,this.Xma);this.ga.ra(Nb.a.Rua,yc.a.view,this.wle);this.ga.ra(Nb.a.Rua,yc.a.table,this.Rua);this.ga.Xc(Nb.a.Rua,1038);this.ga.ra(Nb.a.$ya,yc.a.view,b);this.ga.ra(Nb.a.$ya,yc.a.table,this.$ya);this.ga.Xc(Nb.a.$ya,1127);this.ga.ra(Nb.a.JNb,yc.a.view,b);this.ga.ra(Nb.a.JNb,yc.a.table,this.JNb);this.ga.Xc(Nb.a.JNb,1126);this.ga.ra(Nb.a.tCb,yc.a.view,this.wle);this.ga.ra(Nb.a.tCb,
yc.a.table,this.tCb);this.ga.Xc(Nb.a.tCb,1028)}kQ(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ma.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}Xmi(b,h,r,B,P){if(!({Ay:ca}=this.qqb(b,h,B,P,!0)).returnValue)return 2==h&&8==ca&&qh.a.recordQosError("TableStyleOptionButtonClickNoResponse",["TableInteractionFailed"],
ae.a.hBl),ca;b=b.node;h=this.Ex.q0(b);var ca=B[qg.a.On];const ra=Ip.Ngm(B.MenuItemId);P?B[qg.a.On]=Ip.duo(h,ra):(this.lGk(h,ra,ca,b),r.Hs=ra,r.PC=ca?0:1,t.ULS.shipAssertTag(0,324,!!ra));return 32}K$d(b,h){const r=this.Lc.Pc(15);try{r.Db(b),this.gA.p7a(),h()}finally{r&&r.dispose()}}qqb(b,h,r,B,P){return this.cWm(b,h,r,B,P)?{returnValue:B||2===h,Ay:32}:{returnValue:!1,Ay:8}}cWm(b,h,r,B,P){if(b.contextId!==yc.a.table)return!1;if(B||2===h)if(P&&!r||!Object(Ib.a)(pl.TableNode,b.node)||this.J9j(b.node))return!1;
return!0}lGk(b,h,r,B){const P=(512===h||1024===h?!r:r)?b|h:b&~h;P!==b&&this.K$d(B,()=>{this.FAd.Kza(P,B)})}static tD(){Ip.beb[Ip.OFl]=32;Ip.beb[Ip.FFl]=128;Ip.beb[Ip.f_m]=64;Ip.beb[Ip.YZm]=256;Ip.beb[Ip.OJk]=512;Ip.beb[Ip.NJk]=1024}static duo(b,h){b=!!(b&h);if(512===h||1024===h)b=!b;return b}static Ngm(b){let h=0;b in Ip.beb&&(h=Ip.beb[b]);return h}}Ip.OFl="buttonFirstRow";Ip.FFl="buttonFirstColumn";Ip.f_m="buttonLastRow";Ip.YZm="buttonLastColumn";Ip.OJk="buttonBandedRow";Ip.NJk="buttonBandedColumn";
Ip.beb={};Object(m.a)(Ip,"TableStyleActor",null,[]);Ip.tD();var Aw=c(783),cu=c(404);class dB extends cu.a{constructor(){super();this.TableStyles=this.TableCellStyles=null;this.columns=0}}Object(m.a)(dB,"TableGalleryButtonProps",cu.a,[]);class Du extends dB{constructor(){super()}get Type(){return 6}}Object(m.a)(Du,"TableStyleGalleryButtonProps",dB,[]);class Bw{}Bw.fin=2147483647;Object(m.a)(Bw,"TableStyleUtil",null,[]);class Ar{constructor(b,h,r){this.s8e="Clear";this.LEb=null;this.Qlk=b;this.we=h;
this.Ex=r;this.Oca=v.AFrameworkApplication.Oca;this.Ns=v.AFrameworkApplication.Ns}I1a(){}Vsk(b,h){this.I1a(b);const r=this.e5h(b),B=r.length;if(!(0>=B)){var P=Bw.fin,ca=null;for(let tb=0;tb<B;tb++){var ra=r[tb],Qa=this.Ex.bhm(ra);P!==Qa&&(P=Object.assign(new di.a,{Id:"msMoreTableStyles"+Qa,Title:this.chm(Qa),ControlList:[]}),ca=Object.assign(new Sg.a,{Type:6,Id:"galleryMoreTableStyles"+Qa,ExternalGalleryId:"TableStylesGallery",Width:Ar.Wjg,ElementDimensions:"Size64by48",GalleryItems:[]}),this.LEb&&
(ca.ExternalId=this.LEb[Qa.toString()]),P.ControlList.push(ca),h.MenuSectionList.push(P),P=Qa);Qa=this.we.uR(ra);ra=Ar.klg+tb;Qa=Object.assign(new Du,{Id:ra,ExternalId:ra,Command:Nb.a.Xma.toString(),QueryCommand:Nb.a.uTa.toString(),LabelText:Qa?F.a.zf(Qa):"",Alt:Qa,VerticalCenterAlign:"true"});Qa.TableCellStyles=this.IUd(ra,b);Qa.TableStyles=this.$Rc(ra,b);ca&&ca.GalleryItems.push(Qa)}}}Usk(b){const h=Object.assign(new di.a,{Id:"msMoreTableStyleCommands",DisplayMode:"Menu16",ControlsId:"ctrlMoreTableStyleCommands",
ControlList:[]}),r=Object.assign(new ah.a,{Id:"fseaClearTableFormatting",Command:Nb.a.tCb.toString(),LabelText:F.a.zf(this.s8e),Alt:F.a.zf(this.s8e),Image16by16:this.Ns,Image16by16Class:we.getImageClassWithCluster(this.Oca,Ar.uZk),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});h.ControlList.push(r);b.MenuSectionList.push(h)}rMh(b,h){this.I1a(h);const r=b[qg.a.SourceControlId];var B=this.zTb(r,h);if(B){var P=this.Ex.qF(h);P=P?this.we.Ag(P):null;var ca=this.we.uR(B);B=this.we.Ag(B);b[Ui.a.Alt]=
ca;b[Ui.a.On]=B===P;h=Object.assign(new Du,{Id:r,ExternalId:r,Command:Nb.a.Xma.toString(),QueryCommand:Nb.a.uTa.toString(),TableCellStyles:this.IUd(r,h),TableStyles:this.$Rc(r,h),Alt:ca});b[Ui.a.GalleryButtonProps]=h}else b[Ui.a.InnerHTML]=null,b[Ui.a.Alt]=null,b[Ui.a.On]=!1,b[Ui.a.GalleryButtonProps]=null}IUd(b,h){this.I1a(h);return(b=this.zTb(b,h))?this.Qlk.B6h(b,h):null}$Rc(b,h){this.I1a(h);return this.zTb(b,h),null}pcl(b,h){b.MenuItems=this.w5l(h)}w5l(b){const h=Object.assign(new $f.a,{Id:"menuMoreTableStyles",
MenuSectionList:[]});this.Vsk(b,h);this.Usk(h);return h}zTb(b,h){return b?b.startsWith(Ar.klg)?this.ywf(parseInt(b.substr(Ar.klg.length)),h):this.y7n(parseInt(b.substr(Ar.SHo.length)),h):null}}Ar.klg="buttonTableStyleMenu";Ar.SHo="buttonTableStyleRibbon";Ar.Wjg=7;Ar.uZk="ClearTableStyle_16x16x32";Object(m.a)(Ar,"ATableStyleRibbonControl",null,[503]);class iA extends Ar{constructor(b,h,r){super(null,h,r);this.Rih=b}rMh(b,h){this.I1a(h);const r=b[qg.a.SourceControlId];var B=this.zTb(r,h);if(B){var P=
this.Ex.qF(h);P=P?this.we.Ag(P):null;var ca=this.we.uR(B);B=this.we.Ag(B);b[Ui.a.Alt]=ca;b[Ui.a.On]=B===P;h=Object.assign(new Du,{Id:r,ExternalId:r,Command:Nb.a.Xma.toString(),QueryCommand:Nb.a.uTa.toString(),TableCellStyles:this.IUd(r,h),TableStyles:this.$Rc(r,h),Alt:ca});b[Ui.a.GalleryButtonProps]=h}else b[Ui.a.InnerHTML]=null,b[Ui.a.Alt]=null,b[Ui.a.On]=!1,b[Ui.a.GalleryButtonProps]=null}IUd(b,h){this.I1a(h);return(b=this.zTb(b,h))?this.Rih.B6h(b,h,5,5):null}$Rc(b,h){this.I1a(h);return this.zTb(b,
h),null}}Object(m.a)(iA,"ATableStyleRibbonControlVariableSizePreviews",Ar,[]);var gC=c(1486),lD=c(1123);class fv{constructor(b,h,r,B){this.MPl=(P,ca)=>this.getBorder(P,this.A2.NM(ca));this.LPl=(P,ca)=>this.getBorder(P,this.A2.dP(ca));this.qz=b;this.xy=h;this.Fzb=r;this.A2=B;this.PXj=new pf.a(()=>this.KPl());this.F$a=new pf.a(()=>this.JPl())}KPl(){const b={},h=v.AFrameworkApplication.isRtl;b.top="border-top";b.left=h?"border-right":"border-left";b.bottom="border-bottom";b.right=h?"border-left":"border-right";
b.insideHorizontal="border-bottom";b.insideVertical=h?"border-left":"border-right";return b}JPl(){const b={};b[Eg.a.yDa]=Eg.a.Afb;b[Eg.a.Afb]=Eg.a.Afb;b[Eg.a.S_a]=Eg.a.S_a;return b}m$k(b,h,r,B){const P=new lD.a;P.rowCount=r;P.fgb=B;P.WUa=this.Fzb.igm(b);P.Ja=b.ja(Mc.a.Ja,1);P.Ia=b.ja(Mc.a.Ia,1);P.tableLook=h;P.qle=1;return P}B6h(b,h,r,B){if(!this.qz.Ag(b)||!Object(Ib.a)(102,b)||!Object(Ib.a)(Qt.a,h))return null;const P=this.xy.q0(h);r=this.m$k(b,P,r,B);B=[];for(r.rowIndex=0;r.rowIndex<r.rowCount;r.rowIndex++)this.Zuk(b,
h,r,B);return B}$Rc(){return null}kia(){}Zuk(b,h,r,B){r.rbc=!r.rowIndex;for(r.cellIndex=0;r.cellIndex<r.fgb;r.cellIndex++)this.wrk(b,h,r,B)}wrk(b,h,r,B){h=this.Fzb.r3k(r,this.Fzb.mpf(r),h,b);const P={};var ca=this.xy.bpf(b,h,Pd.a.fontColor,!0,bl.a.fL(),"None");P.color=ca?ca:"inherit";ca=this.xy.bpf(b,h,Pd.a.UK,!0,bl.a.fL(),"None");P["background-color"]=ca?ca:"inherit";this.Avk(r,b,h,P);B.push(P)}Avk(b,h,r,B){b=this.Fzb.VPa(b);this.FBd(5,b,h,r,B);this.FBd(3,b,h,r,B);this.FBd(0,b,h,r,B);this.FBd(4,
b,h,r,B)}FBd(b,h,r,B,P){h=this.KWl(b,h,r,B);h!==Eg.a.oG&&(P[this.PXj.value[gC.a[b]]]=h)}KWl(b,h,r,B){let P=Eg.a.oG;if(({fna:P}=this.IJa(B,b,1,h,this.LPl,P)).returnValue)return P;({fna:P}=this.IJa(r,b,3,h,this.MPl,P));return P}IJa(b,h,r,B,P,ca){return this.A2.tqj(r,h,B)&&(ca=P(b,h))!==Eg.a.oG||!h&&({fna:ca}=this.IJa(b,1,r,B,P,ca)).returnValue||4===h&&({fna:ca}=this.IJa(b,2,r,B,P,ca)).returnValue?{returnValue:!0,fna:ca}:{returnValue:ca!==Eg.a.oG,fna:ca}}getBorder(b,h){let r="",B,P;({borderStyle:B,borderWidth:P}=
this.OPl(b,h));if(B===Eg.a.S_a)return r;r=String.format(Eg.a.rEd,P,B,this.xQd(b,h));return r.trim()}xQd(b,h){if(!h)return Eg.a.N_;b=this.xy.aOc(b,h.color,Wi.a.auto);return b!==Wi.a.auto?Wi.a.eF(b):Eg.a.N_}OPl(b,h){var r=Eg.a.Zua;let B=Eg.a.pG+Eg.a.U3b;if(!h)return{borderStyle:r,borderWidth:B};r=this.xy.aOc(b,h.style,Eg.a.S_a);b=this.xy.aOc(b,h.size,Eg.a.pG);B=this.NPl(r,b)+Eg.a.U3b;r=this.EPl(r);return{borderStyle:r,borderWidth:B}}NPl(b,h){let r=2;b===Eg.a.R3b&&h<Eg.a.ena&&(r=1);return r}EPl(b){return this.F$a.value[b]||
Eg.a.S3b}static fhm(){return new fv(Ma.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ma.a.instance.resolve("WordEditor.IWACTableStyleReader"),Pu.a.instance,Eg.a.instance)}static get instance(){return null!=fv.WBg?fv.WBg:fv.WBg=fv.fhm()}}Object(m.a)(fv,"TableStylePreviewGenerator",null,[504]);var ix;(function(b){b[b.dfp=0]="background1";b[b.Btp=1]="text1";b[b.efp=2]="background2";b[b.Ctp=3]="text2";b[b.accent1=4]="accent1";b[b.accent2=5]="accent2";b[b.accent3=6]="accent3";b[b.accent4=7]="accent4";
b[b.accent5=8]="accent5";b[b.accent6=9]="accent6";b[b.hyperlink=10]="hyperlink";b[b.Cjp=11]="followedHyperlink";b[b.Ugp=12]="dark1";b[b.wmp=13]="light1";b[b.Vgp=14]="dark2";b[b.xmp=15]="light2";b[b.none=16]="none";b[b.max=17]="max"})(ix||(ix={}));Object(m.b)("ThemeColor",ix);class vs{constructor(b){this.uZb=b}HNl(b,h,r){let B;({v7i:h,dxh:B}=this.dbm(h));b=[];const P=[];for(let ra=0;16>ra;ra++){if(!(ix[ra]in r.Pzb))continue;const Qa=ra,tb=String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,
WoncaIntl.WoncaStrings[B[Qa]],this.j2l(ra));var ca=h[Qa];ca=ca&4278190080|(ca&255)<<16|ca&65280|(ca&16711680)>>>16;P.push(Object.assign(new Gq.a,{Color:Qa.toString(),DisplayColor:"#"+F.a.iJ(ca,6),Alt:F.a.zf(tb)}));b[b.length]=ra}return{returnValue:P,YJo:b}}j2l(b){switch(b){case 0:return Box4Intl.Box4Strings.l_ThemeLabel1;case 1:return Box4Intl.Box4Strings.l_ThemeLabel2;case 2:return Box4Intl.Box4Strings.l_ThemeLabel3;case 3:return Box4Intl.Box4Strings.l_ThemeLabel4;case 4:return Box4Intl.Box4Strings.l_ThemeLabel5;
case 5:return Box4Intl.Box4Strings.l_ThemeLabel6;case 6:return Box4Intl.Box4Strings.l_ThemeLabel7;case 7:return Box4Intl.Box4Strings.l_ThemeLabel8;case 8:return Box4Intl.Box4Strings.l_ThemeLabel9;case 9:return Box4Intl.Box4Strings.l_ThemeLabel10;default:return""}}dbm(b){let h=null,r=null;b=this.uZb(b);if(!b)return{v7i:h,dxh:r};h=b.properties.ja(Mc.a.orb,null);r=b.properties.getValue(Mc.a.cme).split(" ");return{v7i:h,dxh:r}}static hhm(){return new vs(Object(z.a)(vs.hi,vs.hi.su,"navigateToPageContentNode"))}static get hi(){return qo.PageNavigator.instance}static get instance(){return null!=
vs.oCg?vs.oCg:vs.oCg=vs.hhm()}}Object(m.a)(vs,"TableStyleThemeHelper",null,[544]);var Cw=c(902);class Tn{constructor(b,h){this.iVe={};this.Pzb={};this.we=b;this.Ex=h}$if(b,h){const r=this.iVe[ix[h]];return r&&r.length?r:this.zLl(b,h)}Oai(b,h,r){if(h=this.$if(h,r))for(b=this.we.Ag(b),r=0;r<h.length;r++)if(this.we.Ag(h[r])===b)return r;return-1}kia(){this.iVe={};this.Pzb={}}zLl(b,h){const r=[];this.Pzb={};b=this.Ex.WRc(b);this.iDd(r,this.Pzb,0,h,b);this.iDd(r,this.Pzb,1,h,b);this.iDd(r,this.Pzb,2,h,
b);this.iDd(r,this.Pzb,3,h,b);return this.iVe[ix[h]]=r}iDd(b,h,r,B,P){const ca=P.EO;for(let ra=0;ra<ca;ra++){const Qa=P.IFa(ra);if(3!==this.we.LG(Qa))continue;const tb=this.Ex.ahm(Qa),Mb=this.Ex.OUd(Qa);h[ix[Mb]]=!0;tb!==r||Mb!==B&&16!==Mb||this.we.Ag(Qa)===Cw.a.dMb||(b[b.length]=Qa)}}static Skm(){return new Tn(Ma.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ma.a.instance.resolve("WordEditor.IWACTableStyleReader"))}static ggl(){return Tn.Skm()}}Object(m.a)(Tn,"WACTableStyleRibbonList",null,[542]);
class Dw extends iA{constructor(b,h,r,B,P){super(b,h,r);this.VVb=4;this.czd=[];this.IGm=()=>{this.S1b.kia();this.Rih.kia()};this.Rlk=P;this.S1b=B;this.s8e=WordEditorIntl.WordEditorStrings.L_BtnClearTableFormatting;this.zEn()}h$k(b,h){b.MenuItems=this.IKl(h)}zEn(){this.LEb={};this.LEb["0"]="CustomTableStyles";this.LEb["1"]="PlainTableStyles";this.LEb["2"]="GridTableStyles";this.LEb["3"]="ListTableStyles"}IKl(b){const h=Object.assign(new $f.a,{Id:"menuTableTheme"});h.MenuSectionList=[];if(this.sVm(b))return h;
const r=Object.assign(new di.a,{Id:"msTableStyleTheme",ControlsId:"ctrlTableStyleThemeColors",ControlList:[]}),B=Object.assign(new Aw.a,{Id:"clrTableStyleTheme",ExternalId:"TableStyleThemeColorPicker",Command:qb.a.efb.toString(),QueryCommand:qb.a.zOb.toString(),Width:Dw.ZJo});B.Colors=({YJo:this.czd}=this.Rlk.HNl(this.czd,b,this.S1b)).returnValue;r.ControlList.push(B);h.MenuSectionList.push(r);return h}I1a(b){if(b=this.Ex.qF(b))b=this.Ex.OUd(b),16!==b&&(this.VVb=b)}e5h(b){return this.S1b.$if(b,this.VVb)}ywf(b,
h){h=this.S1b.$if(h,this.VVb);return 0>b||b>=h.length?null:h[b]}y7n(b,h){var r=this.Ex.qF(h);r=this.S1b.Oai(r,h,this.VVb);r=-1!==r?Math.floor(r/Ar.Wjg)*Ar.Wjg:0;return this.ywf(r+b,h)}chm(b){switch(b){case 0:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesCustom;case 2:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesGrid;case 3:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesList;case 1:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesPlain;default:return""}}sVm(b){this.I1a(b);
return 0>=this.e5h(b).length}C_o(b,h){if(!b||!h)return null;b=parseInt(b[cb.Color]);var r=this.Ex.qF(h);const B=this.Ex.OUd(r);if(B===b)return null;if(16===B)return this.VVb=b,null;r=this.S1b.Oai(r,h,B);this.VVb=b;return this.ywf(r,h)}snl(b){b=this.Ex.qF(b);b=this.Ex.OUd(b);if(16!==b)for(let h=0;h<this.czd.length;h++)if(this.czd[h]===b)return h;return-1}SAb(b){b.DZe(this.IGm,2)}static ghm(){return new Dw(fv.instance,Ma.a.instance.resolve("Box4.Styles.IWACStyleReader"),Ma.a.instance.resolve("WordEditor.IWACTableStyleReader"),
Tn.ggl(),vs.instance)}static get instance(){return null!=Dw.TCg?Dw.TCg:Dw.TCg=Dw.ghm()}}Dw.ZJo=4;Object(m.a)(Dw,"TableStyleRibbonControls",iA,[502,503]);var jx=c(1583);class Ew extends Ip{constructor(b,h,r,B,P,ca,ra,Qa){super(b,h,r,B,P,ca,ra,Qa);this.ric=(tb,Mb,Zb,jc,Gc)=>{if(!({Ay:tb}=this.qqb(Mb,Zb,Gc,!1,!0)).returnValue)return tb;this.mlg.h$k(Gc,Mb.node);return 32};this.efb=(tb,Mb,Zb,jc,Gc)=>{if(!({Ay:tb}=this.qqb(Mb,Zb,Gc,!1,!0)).returnValue)return 2==Zb&&8==tb&&qh.a.recordQosError("TableStyleColorButtonClickNoResponse",
["TableInteractionFailed"],ae.a.iBl),tb;const Uc=Mb.node,od=this.mlg.C_o(Gc,Uc);od&&this.K$d(Uc,()=>{this.FAd.CQb(od,Uc)});return 32};this.zOb=(tb,Mb,Zb,jc,Gc)=>{if(!({Ay:tb}=this.qqb(Mb,Zb,Gc,!0,!0)).returnValue)return tb;Gc[cb.IndexColorSelected]=this.mlg.snl(Mb.node);return 32}}hjc(b){super.hjc(b);this.ga.ra(qb.a.efb,yc.a.view,this.wle);this.ga.ra(qb.a.efb,yc.a.table,this.efb);this.ga.Xc(qb.a.efb,1030);this.ga.ra(qb.a.ric,yc.a.view,b);this.ga.ra(qb.a.ric,yc.a.table,this.ric);this.ga.Xc(qb.a.ric,
1126);this.ga.ra(qb.a.zOb,yc.a.view,b);this.ga.ra(qb.a.zOb,yc.a.table,this.zOb);this.ga.Xc(qb.a.zOb,1127)}get mlg(){return this.Iyd}static $gm(){return new Ew(Ma.a.instance.resolve("WordEditor.IWACTableStyleReader"),Dw.instance,v.AFrameworkApplication.va,jx.a.instance,new Il.a,Ma.a.instance.resolve("Box4.IInsertionPointFormatting"),Ma.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Object(z.a)(Wh.a.instance,Wh.a.instance.Plb,"isTableNodeInLockedRange"))}static get instance(){return null!=
Ew.cCg?Ew.cCg:Ew.cCg=Ew.$gm()}}Object(m.a)(Ew,"TableStyleActor",Ip,[]);class hC{constructor(){this.W=null}get name(){return"WordEditor.TableStyle"}wc(b){this.W=b;this.W.ia("Box4.TableEditors.ITableStylePreviewGeneratorVariableSize",()=>fv.instance).ha();this.W.ia("Box4.TableEditors.IWACTableStyleEditor",()=>jx.a.instance).ha()}init(){this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{this.wn()})}wn(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(111)&&(Ew.instance.Tb(),Dw.instance.SAb(Hs.a.instance),
Eb.App.za.updateCommandUI())}dispose(){}}Object(m.a)(hC,"TableStylePackage",null,[1,2]);var iC=window.WordEditorHeaderToolbarData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Toolbar",attrs:{Id:"WordEditorHeaderToolbar",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageSideArrow:"IMGMAP@we@SubmenuFlyoutArrow_13x13x32",
Scale:"true",Size:"OneRow",TeamId:"WAC",TextDirection:"STR@L_RibbonOptionTextDirection",Title:"STR@L_HeaderToolbarLabel",LabelText:"STR@L_HeaderToolbarLabel"},children:[{name:"Docks",attrs:{Id:"HeaderToolbarButtonDocks"},children:[{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockLeft",Alignment:"Left"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsLeft"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarSectionsFlyout",Command:"0x2F9A3D80",QueryCommand:"0x978B3323",PopulateDynamically:"true",
PopulateOnlyOnce:"false",PopulateQueryCommand:"0xF9833D60",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarFirstPageButton",LabelText:"STR@L_HeaderToolbarFirstPageButton",Command:"0xC95FE689",QueryCommand:"0xA99F5B15",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarEvenPagesButton",LabelText:"STR@L_HeaderToolbarEvenPagesButton",Command:"0xD9BEF8F8",QueryCommand:"0xF04337C4",TogglesWhenExecuted:"false",DisplayMode:"Medium",
Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOddPagesButton",LabelText:"STR@L_HeaderToolbarOddPagesButton",Command:"0xE58D2847",QueryCommand:"0x732475F7",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOtherPagesButton",LabelText:"STR@L_HeaderToolbarOtherPagesButton",Command:"0x91C2D5C5",QueryCommand:"0x4B388351",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}}]}]},{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockRight",
Alignment:"Right"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsRight"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarOptions",Command:"0x568463EB",LabelText:"STR@L_HeaderToolbarOptions"},children:[{name:"Menu",attrs:{Id:"HeaderFooterToolbarMenu"},children:[{name:"MenuSection",attrs:{Id:"HeaderToolbarOptionsSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarOptionsControl"},children:[{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonAllPages",
MenuItemId:"HeaderToolbarButtonAllPages",Image32by32:"IMGMAP@box42@HeaderAndFooter_32x32x32",Command:"0xF56DFAEA",QueryCommand:"0x7B6FA1F6",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarAllPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstPage",MenuItemId:"HeaderToolbarButtonFirstPage",Image32by32:"IMGMAP@we@DifferentFirstPage_32x32x32",Command:"0x3284B693",QueryCommand:"0x51527973",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstPage"}},{name:"ToggleButton",
attrs:{Id:"HeaderToolbarButtonEvenOddPages",MenuItemId:"HeaderToolbarButtonEvenOddPages",Image32by32:"IMGMAP@we@DifferentEvenOddPages_32x32x32",Command:"0x3DB867BD",QueryCommand:"0xE8BBEA49",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarEvenOddPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstEvenOddPages",MenuItemId:"HeaderToolbarButtonFirstEvenOddPages",Image32by32:"IMGMAP@we@DifferentFirstEvenOddPages_32x32x32",Command:"0x8FF03DBF",QueryCommand:"0x2799C44F",TogglesWhenExecuted:"false",
LabelText:"STR@L_HeaderToolbarFirstEvenOddPages"}}]}]},{name:"MenuSection",attrs:{Id:"HeaderToolbarDeleteSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarDeleteControl"},children:[{name:"Button",attrs:{Id:"HeaderToolbarButtonRemovePageNumbers",MenuItemId:"HeaderToolbarButtonRemovePageNumbers",Image32by32:"IMGMAP@we@WordRemovePageNumbers_32x32x32",Command:"0xF3612A1B",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_RemovePageNumbers"}},{name:"Button",
attrs:{Id:"HeaderToolbarButtonDelete",MenuItemId:"HeaderToolbarButtonDelete",Image32by32:"IMGMAP@we@RemoveHeadersAndFooters_32x32x32",Command:"0x3CD9B935",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarRemoveHeadersAndFooters"}}]}]}]}]}]}]}]}]}]},mD=c(1477);class gv{constructor(b,h){this.SLa=b;this.cBa=h}fXn(b){this.SLa.lCd(b)}VDa(b){this.cBa.VDa(b)}UQb(b,h){return this.cBa.UQb(b,h)}TQb(b,h){return this.cBa.TQb(b,h)}Zme(b,h,r){this.cBa.Zme(b,h,r)}}Object(m.a)(gv,
"ClientPaginationHeaderFooterBridge",null,[637]);class NC{constructor(b,h){this.nm=b;this.ga=h;this.Waa=new Pp.a;this.Xaa=new Pp.a}VDa(b){b=Ad.GraphIterator.eb(b);if(b.Ip()&&b.Wp()){b.Rd();do 10===b.Xe&&this.F1f(b.currentNode),b.It();while(8!==b.Xe)}}UQb(b,h){var r=this.bHb(h);if(!this.Waa.nb(r))return t.ULS.sendTraceTag(573400388,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+r),!1;h=this.Waa.J(r);t.ULS.shipAssertTag(573400389,336,this.Xaa.nb(r),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");
r=this.Xaa.J(r);return this.uzf(h,b,r)}TQb(b,h){var r=this.bHb(h);if(!this.Waa.nb(r))return t.ULS.sendTraceTag(573400390,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+r),!1;h=this.Waa.J(r);t.ULS.shipAssertTag(573400391,336,this.Xaa.nb(r),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");r=this.Xaa.J(r);return this.lmf(h,b,r)}Zme(b,h,r){h=this.xvf(h,r);this.ga.Qb(b?qb.a.vpe:qb.a.wed,
2,h)}xvf(b,h){h=this.nm.hGb(h);if(!h)return t.ULS.sendTraceTag(573400392,3009,15,"Header footer container node expected not to be null."),0;h=this.nm.Yha(h);const r=1===b;b=!(b%2);return 1===h?1:2===h?r?2:1:3===h?b?3:4:r?2:b?3:4}F1f(b){if(10===b.type){var h=new Pp.a,r=this.nm.hGb(b);t.ULS.shipAssertTag(573400393,336,!!r,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var B=this.nm.Yha(r);b=this.bHb(b);this.lqg(b,B);this.kqg(b,
h);r=Ad.GraphIterator.eb(r);if(r.Wp()){r.Rd();do b=r.currentNode,B=this.nm.MQc(b),b=this.nm.xoi(b),h.add(B,b),r.It();while(36===r.Xe)}}}lqg(b,h){this.Xaa.nb(b)?this.Xaa.Z(b,h):this.Xaa.add(b,h)}kqg(b,h){this.Waa.nb(b)?this.Waa.Z(b,h):this.Waa.add(b,h)}bHb(b){t.ULS.shipAssertTag(573400395,336,10===b.type,"Expected node of type Outline but received node of type "+b.type);return b.ja(Mc.a.Vja,0)}uzf(b,h,r){const B=1===h;h=!(h%2);switch(r){case 2:if(B){if(b.nb(2))return b.J(2)}else if(b.nb(0))return b.J(0);
break;case 3:if(h){if(b.nb(1))return b.J(1)}else if(b.nb(0))return b.J(0);break;case 4:if(B){if(b.nb(2))return b.J(2)}else if(h){if(b.nb(1))return b.J(1)}else if(b.nb(0))return b.J(0);break;case 1:if(b.nb(0))return b.J(0)}return!1}lmf(b,h,r){const B=1===h;h=!(h%2);switch(r){case 2:if(B){if(b.nb(5))return b.J(5)}else if(b.nb(3))return b.J(3);break;case 3:if(h){if(b.nb(4))return b.J(4)}else if(b.nb(3))return b.J(3);break;case 4:if(B){if(b.nb(5))return b.J(5)}else if(h){if(b.nb(4))return b.J(4)}else if(b.nb(3))return b.J(3);
break;case 1:if(b.nb(3))return b.J(3)}return!1}}Object(m.a)(NC,"ClientPaginationPageAdornmentContentManager",null,[636]);class ky{constructor(b,h,r,B,P,ca){this.n4k=ra=>{1===ra&&this.zE.JE&&(ra=this.Yc.Eoa(this.zE.JE,8,8),this.nm.HSk(ra)?this.Tkl(ra):this.Xvo())};this.yRo=ra=>{1===ra&&this.ga.Qb(Nb.a.openInClient,2,!1)};this.zE=b;this.nm=h;this.Yc=r;this.Lc=B;this.ewc=P;this.ga=ca}mwo(){const b=new Tf.StandardDialog;b.Cd=1;b.ze(1,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogRemoveAllButton);
b.BV(0);b.rv(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogMessage,0,this.n4k)}Tkl(b){b.jd(8);const h=this.Lc.Pc(15);h.set(b.Gn.xj);this.ewc.sZn(b);this.zE.dismiss();h.dispose();t.ULS.sendTraceTag(4214792,317,50,"{0}",{["RemovedHeadersAndFooters"]:!0})}Xvo(){const b=new Tf.StandardDialog;b.Cd=1;b.ze(1,Box4Intl.Box4Strings.L_OpenInWord);b.ze(0,CommonUIStrings.l_Close);b.BV(0);b.rv(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarCantDeleteContent,
0,this.yRo);t.ULS.sendTraceTag(4214793,317,50,"{0}",{["CouldntRemoveHeadersAndFooters"]:!0})}}Object(m.a)(ky,"DeleteHeaderFooterDialog",null,[]);class ly{constructor(b,h,r,B,P){this.nm=b;this.Yc=h;this.Lc=r;this.ewc=B;this.ga=P}create(b){return new ky(b,this.nm,this.Yc,this.Lc,this.ewc,this.ga)}}Object(m.a)(ly,"DeleteHeaderFooterDialogFactory",null,[635]);class jA{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb){this.Eaa=null;this.Wmg=(Zb,jc,Gc,Uc,od)=>{var Od=this.Bwf(jc);return Od?1===Gc?32:(Gc=this.control)?
(jc=this.Lc.Pc(15),jc.Db(Od),jc.Uj=Zb,Gc.hca?this.ga.processAction(qb.a.iU,2):(Od=this.WXh(Od),Uc.Hs=Od?1:0,Uc=Zb!==qb.a.wed,(Zb=this.mrf(Zb,od))&&Gc.Fza(Zb),this.ga.Qb(qb.a.DLd,2,Uc)),jc.dispose(),32):8:8};this.oef=(Zb,jc,Gc)=>{if(1===Gc)return 32;this.G0j.create(this.control).mwo();return 32};this.WLn=(Zb,jc,Gc,Uc,od)=>1===Gc?32:(Zb=this.control)?(od[qg.a.On]=Zb.hca,32):8;this.hqb=(Zb,jc,Gc,Uc,od)=>{if(1===Gc||!this.control.hca)return 32;jc=this.cai(Zb,od);Gc=jA.Fki(this.control.JE);Uc=this.Lc.Pc(15);
Uc.Db(Gc);Uc.Uj=Zb;Zb=this.Yc.Ek();Zb.set(Gc);this.TLa.Yif(Zb.currentNode,jc);this.nm.PLb(Zb);this.ewc.$nj(Zb,jc);Uc.dispose();return 32};this.Fza=(Zb,jc,Gc,Uc,od)=>{if(1===Gc)return 32;Zb=this.mrf(Zb,od);this.control.hca&&this.control.Fza(Zb);return 32};this.nge=(Zb,jc,Gc,Uc,od)=>{if(1===Gc)return 32;Zb=this.Ugi(Zb,od);Uc.Hs=Zb;jc=this.Bwf(jc);if(!jc)return 8;Uc=this.Yc.Ek();Uc.set(jc);Uc.zb(8);Uc.rt(8);if(!this.Zk.Efn(Uc,Zb))return 8;this.nm.PLb(Uc);this.control.pha(Uc.currentNode);return 32};this.G1f=
(Zb,jc,Gc,Uc,od)=>{if(1===Gc)return 32;Zb=this.Zmk.Ael(this.Bwf(jc));od.PopulationXML=Zb;return 32};this.ece=(Zb,jc,Gc,Uc,od)=>{Zb=this.cai(Zb,od);jc=this.control.JE;Gc=this.nm.Yha(jc);od[qg.a.On]=Zb===Gc;1===Zb&&(od[qg.a.LabelText]=this.Hli(jc)?WordEditorIntl.WordEditorStrings.L_HeaderToolbarEntireSection:WordEditorIntl.WordEditorStrings.L_HeaderToolbarAllPages);return 32};this.jbe=(Zb,jc,Gc,Uc,od)=>{if(1===Gc||!this.control.hca)return 32;jc=this.control.JE;void 0!==jc&&null!==jc&&(jc=this.nm.Yha(jc),
Zb=this.mrf(Zb,od),Gc=this.control.XVb,od[qg.a.Visible]=this.$Io(Zb,jc),od[qg.a.On]=Zb===Gc);return 32};this.kMn=(Zb,jc,Gc,Uc,od)=>{if(1===Gc||!this.control.hca)return 32;Zb=this.control.JE;void 0!==Zb&&null!==Zb&&this.UEn(Zb,od);return 32};this.vLn=(Zb,jc,Gc,Uc,od)=>{if(1===Gc||!this.control.hca)return 32;Zb=this.Ugi(Zb,od);jc=this.control.JE;Gc=0;void 0!==jc&&null!==jc&&(Gc=jc.getValue(Mc.a.Vja));od[qg.a.On]=Zb===Gc;return 32};this.iU=(Zb,jc,Gc)=>{if(1===Gc)return 32;this.control.dismiss();return 32};
this.BWd=()=>32;this.DLd=(Zb,jc,Gc,Uc,od)=>{if(1===Gc)return 32;this.control.show(od);return 32};this.kmb=(Zb,jc,Gc,Uc,od)=>{if(1===Gc)return 32;if(!od)return 8;jc=od.F0a;if(!jc||!jc.isConnected)return 8;Zb=this.nm.b1c(jc);if(!({isHeader:Gc,Vlg:jc}=this.nm.$ii(jc)).returnValue)return 8;this.control.pha(Zb);this.control.Fza(jc);this.control.show(Gc,od.mie);return 32};this.ga=b;this.nm=h;this.ewc=r;this.TLa=B;this.Zk=P;this.Yc=ca;this.Lc=ra;this.Zmk=Qa;this.h5j=tb;this.G0j=Mb}get control(){return this.Eaa}set control(b){this.Eaa=
b}Tb(){this.ga.ra(qb.a.YXd,yc.a.view,this.Wmg);this.ga.fb(qb.a.E4f,yc.a.application,this.WLn,96);this.ga.ra(qb.a.vpe,yc.a.view,this.Wmg);this.ga.ra(qb.a.wed,yc.a.view,this.Wmg);this.ga.fb(qb.a.BWd,yc.a.view,this.BWd,64);this.ga.ra(qb.a.DLd,yc.a.view,this.DLd);this.ga.fb(qb.a.iU,yc.a.application,this.iU,96);this.ga.fb(qb.a.kmb,yc.a.application,this.kmb,96);this.ga.fb(qb.a.fgo,yc.a.view,this.Fza,96);this.ga.ra(qb.a.mkj,yc.a.view,this.Fza);this.ga.ra(qb.a.okj,yc.a.view,this.Fza);this.ga.ra(qb.a.nkj,
yc.a.view,this.Fza);this.ga.ra(qb.a.pkj,yc.a.view,this.Fza);this.ga.fb(qb.a.yjo,yc.a.view,this.hqb,100);this.ga.fb(qb.a.Zlj,yc.a.view,this.hqb,4);this.ga.fb(qb.a.Ylj,yc.a.view,this.hqb,4);this.ga.fb(qb.a.Wlj,yc.a.view,this.hqb,4);this.ga.fb(qb.a.Xlj,yc.a.view,this.hqb,4);this.ga.ra(qb.a.nge,yc.a.view,this.nge);this.ga.ra(qb.a.Mcg,yc.a.view,this.nge);this.ga.fb(qb.a.G1f,yc.a.view,this.G1f,96);this.ga.fb(qb.a.oef,yc.a.view,this.oef,4);this.ga.fb(qb.a.F5i,yc.a.view,this.jbe,97);this.ga.fb(qb.a.H5i,yc.a.view,
this.jbe,97);this.ga.fb(qb.a.G5i,yc.a.view,this.jbe,97);this.ga.fb(qb.a.I5i,yc.a.view,this.jbe,97);this.ga.fb(qb.a.Y5i,yc.a.view,this.ece,97);this.ga.fb(qb.a.X5i,yc.a.view,this.ece,97);this.ga.fb(qb.a.V5i,yc.a.view,this.ece,97);this.ga.fb(qb.a.W5i,yc.a.view,this.ece,97);this.ga.fb(qb.a.QLn,yc.a.view,this.kMn,97);this.ga.fb(qb.a.a4f,yc.a.view,this.vLn,97)}WXh(b){const h=this.nm.hGb(b),r=this.nm.Yha(h);b=this.TLa.Yif(b,r);this.control.pha(h);return b}cai(b,h){switch(b){case qb.a.Zlj:case qb.a.Y5i:b=
1;break;case qb.a.Ylj:case qb.a.X5i:b=2;break;case qb.a.Wlj:case qb.a.V5i:b=3;break;case qb.a.Xlj:case qb.a.W5i:b=4;break;default:b=h}return b}mrf(b,h){switch(b){case qb.a.mkj:case qb.a.F5i:b=1;break;case qb.a.okj:case qb.a.H5i:b=2;break;case qb.a.nkj:case qb.a.G5i:b=3;break;case qb.a.pkj:case qb.a.I5i:b=4;break;case qb.a.vpe:case qb.a.wed:b=h;break;case qb.a.YXd:b=0;break;default:b=h}return b}Ugi(b,h){return b===qb.a.Mcg||b===qb.a.a4f?parseInt(h.MenuItemId):h}Bwf(b){return this.Zk.g9(b.ik)}$Io(b,
h){switch(h){case 1:return!1;case 2:return 1===b||2===b;case 4:return 4===b||2===b||3===b;case 3:return 4===b||3===b}return!0}UEn(b,h){const r=this.Hli(b);if(h[en.a.Visible]=r)b=this.Zk.Gki(this.h5j(b)),b=String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,b),h[en.a.LabelText]=b}Hli(b){const h=this.Yc.Ek();h.set(b);h.zb(8);h.rt(8);return 1<this.Zk.Vvf(h)}static Fki(b){const h=new Ad.GraphIterator;h.set(b);h.zb(10);return Cm.WordSectionNavigator.R8n(h)}}Object(m.a)(jA,
"HeaderFooterActor",null,[]);var qk=c(804),my=c(715);class eB{constructor(b,h,r,B,P){this.eck=b;this.nm=h;this.Zk=r;this.Yc=B;this.ga=P}JXh(b,h){this.nm.PLb(b);h=this.Vwl(b,h);b.uc();return h}Yif(b,h){b=this.Yc.Eoa(b,8,8);let r=!1;this.Zk.GPa(b,B=>{const P=this.Yc.Ek();P.set(B);r=(B=this.JXh(P,h))||r;return B});return r}Vwl(b,h){if(3!==this.ga.mode)return!1;let r=!1;h=my.a.cff(h);for(let B=0;B<h.length;++B)r=this.eck.Uwl(b,h[B])||r;return r}}eB.xjl=1;Object(m.a)(eB,"HeaderFooterInserter",null,[628]);
class Xq{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb){this.Zfh=this.XSg=!1;this.JE=null;this.lGe=!1;this.XVb=0;this.vMb=()=>{this.lGe=!0};this.P6=b;b.bind(this);this.pXe=B;this.f1j=tb;this.H9g=P;this.Vck=ca;this.sbb=ra;this.header=h;this.footer=r;this.header.Ifl();this.P6.Qz();this.vVe=eB.xjl;this.TLa=Qa;Xq.ga=Mb;this.QN=Zb}get hca(){return this.XSg}show(b=!0,h=!0){this.hca||(this.lIj(),this.ulj(!0),this.header.uUn(),this.f1j(),this.VCo(),v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.Npa&&
(Hh.c()?appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new qk.a,{state:0,disablePopover:!0}))):t.ULS.sendTraceTag(509384032,3023,15,"Showing header/footer overlay and appChrome is not ready")));(this.Zfh=h)&&this.H9g(b)}dismiss(b=!1){this.hca&&(this.Vck(b),this.ulj(!1),this.YDb(),this.XVb=0,this.eEo(),v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.Npa&&(Hh.c()?appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new qk.a,{disablePopover:!1}))):t.ULS.sendTraceTag(509384031,
3023,15,"Dismissing header/footer overlay and appChrome is not ready")))}ulj(b){this.XSg=b;Xq.ga.processAction(Nb.a.Imf,2);this.P6.G1(b);this.header.G1(b);this.footer.G1(b);this.pXe()}pha(b){this.JE!==b&&(this.JE=b,this.header.pha(b),this.footer.pha(b),this.XVb=0,this.hqb(this.sbb.Yha(b)))}YDb(){this.JE&&(this.header.fhb(),this.footer.fhb(),this.JE=null)}update(){this.hca&&this.RSb()}RSb(){this.JE&&(this.sbb.ysl(this.JE)&&this.sbb.Ptm(this.JE)?this.lIj():this.dismiss())}lIj(){const b=this.sbb.Yha(this.JE);
b!==this.vVe&&this.hqb(b)}hqb(b){this.vVe=b;this.Fza(this.Fhm(b))}Fhm(b){switch(b){case 2:return 2;case 3:return 3;case 4:return 2}return 1}Fza(b,h=!0){this.XVb!==b&&(this.TLa.Yif(this.JE,this.vVe),this.header.lkj(b),this.header.swh(Qi.AppFrame.Lca),this.footer.lkj(b),this.footer.swh(Qi.AppFrame.rca),this.XVb=b,this.hca&&this.Zfh&&this.Cxl(h))}Cxl(b){this.H9g(b);b?this.header.setInitialSelection():this.footer.setInitialSelection()}dispose(){this.P6.daa();this.header.dispose();this.footer.dispose()}VCo(){this.QN.dGc(this.vMb);
this.lGe=!1}eEo(){this.QN.Pde(this.vMb);this.lGe&&Xq.ga.processAction(qb.a.BWd,2)}static Bpl(){Xq.ga.Qb(fb.a.ckb,2,!0);Xq.ga.processAction(qb.a.p4,2)}}Xq.ga=null;Object(m.a)(Xq,"HeaderFooterControl",null,[660,9]);class kA{constructor(b,h,r,B,P){this.pXe=b;this.sbb=h;this.TLa=r;this.ga=B;this.QN=P}create(b,h,r,B,P){return new Xq(b,h,r,this.pXe,B,P,this.sbb,this.TLa,Xq.Bpl,this.ga,this.QN)}}Object(m.a)(kA,"Factory",null,[634]);class uq{constructor(){this.Eaa=null}get control(){return this.Eaa}set control(b){this.Eaa=
b}unf(b){return this.vnf(this.control.JE,this.control.XVb,b.isHeader,b)}vnf(b,h,r,B){return()=>{if(!b.isConnected)return null;this.control.pha(b);this.control.Fza(h);this.control.show(r);return B}}dismiss(){this.Eaa.hca&&this.Eaa.dismiss()}}Object(m.a)(uq,"HeaderFooterControlLauncher",null,[]);var lA=c(1174),kz=c(657),it=c(251),gg=c(826);class u{constructor(b,h,r){this.Tnc=null;const B=h?"Header":"Footer";this.Nr=b.ownerDocument.createElement("div");this.Nr.id=h?"HeaderPane":"FooterPane";this.Nr.classList.add(u.Stm,
B);this.pAb=(new gg.a(this.Nr,"WACViewPanel_"+B)).uI;this.Nr.appendChild(this.pAb);b.appendChild(this.Nr);h&&(this.Tnc=b.ownerDocument.createElement("div"),this.Tnc.classList.add(u.Xtm),this.Nr.appendChild(this.Tnc));this.HLg=r.G8l(this.Nr)}bind(){}G1(b){b?this.HLg.zCk():this.HLg.BCk()}LKk(b){b.yBb(this.pAb)}}u.Xtm="HeaderToolbarContainer";u.Stm="HeaderFooterPane";Object(m.a)(u,"PaneControlDom",null,[672]);class C{constructor(b,h,r,B,P){this.zE=this.Tq=null;this.UWi=()=>{this.zE.dismiss(!0);if(this.YWb){const ca=
new wh.a(!0);this.YWb.gIa(ca)}return!0};this.aC=ca=>{ca.Hb.preventDefault();return!1};this.Nr=b.ownerDocument.createElement("div");this.Nr.id=C.IJh;this.Nr.className=C.IJh;this.i_=B;this.YWb=P;this.voi=new u(this.Nr,!0,h);this.mdl(this.Nr);this.s2h=new u(this.Nr,!1,h);this.G1(!1);b.appendChild(this.Nr)}mdl(b){this.Tq=b.ownerDocument.createElement("div");this.Tq.id=C.Fyn;this.Tq.className=C.Dyn;this.Tq.tabIndex=0;this.Tq.setAttribute(Se.a.uh,Se.a.X3);this.Tq.setAttribute(Se.a.xga,WordEditorIntl.WordEditorStrings.L_HeaderFooterOverlayAccessibleText);
b.appendChild(this.Tq)}bind(b){this.zE=b}G1(b){if(!b&&this.i_){var h=new wh.a(!0);this.i_.gIa(h)}!b&&this.YWb&&(h=new wh.a(!0),this.YWb.gIa(h));this.Nr.style.display=b?"":"none";this.voi.G1(b);this.s2h.G1(b)}Sio(){this.Tq.focus()}Qz(){ii.a.instance.ob(pd.a.click,this.Tq,this.UWi);sf.a.instance.ob(pd.a.Wx,this.Nr,this.aC)}daa(){ii.a.instance.sc(pd.a.click,this.Tq,this.UWi);sf.a.instance.sc(pd.a.Wx,this.Nr,this.aC)}}C.IJh="HeaderFooterControl";C.Fyn="HeaderFooterOverlay";C.Dyn="EditingSurfaceOverlay HeaderFooterOverlay";
Object(m.a)(C,"HeaderFooterControlDom",null,[659]);class U{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb){this.P6=null;this.sa=new Pc.a;this.zE=this.swd=null;this.SWf=Zb=>{this.G$(Zb);this.sa.raiseEvent("OnShowEventKey")};this.RWf=Zb=>{this.Fk&&(this.swd=new lA.a(this.Fk));this.Vb.oLc(Qi.AppFrame.Lca);this.Vb.oLc(Qi.AppFrame.rca);this.kea(Zb);this.sa.raiseEvent("OnDismissEventKey")};this.Y9d=()=>{this.swd&&(this.swd.dispose(),this.swd=null)};this.Vb=b;this.lp=h;this.uah=r;this.J5j=B;this.Oek=P;this.ga=ca;
this.tQg=kz.a.create();this.tUg=Jb.KeyInputManager.ic(se.a.Ss,0);this.YZ=Jb.KeyInputManager.ic(se.a.l2,0);this.Pkk=Jb.KeyInputManager.ic(se.a.ZJa,0);this.hM=ra;this.Ca=Qa;this.i_=tb;this.YWb=Mb;this.Fk&&this.Fk.tga(this.Y9d)}vrh(b){this.sa.addHandler("OnShowEventKey",b)}Z1n(b){this.sa.removeHandler("OnShowEventKey",b)}lCd(b){this.sa.addHandler("OnDismissEventKey",b)}Sbj(b){this.sa.removeHandler("OnDismissEventKey",b)}get Fk(){const b=this.hM.value;return b?b.Zi?b:(t.ULS.sendTraceTag(25474004,317,
10,"_lazyPageView.Value is not a page view in HeaderFooterControlOwner."),null):(t.ULS.sendTraceTag(25474003,317,10,"_lazyPageView.Value is null in HeaderFooterControlOwner."),null)}get control(){return this.zE}get I6k(){return this.tQg}bind(b){this.zE=this.P4k(b);this.tQg.instance=this.zE}P4k(b){this.P6=new C(b,this.Oek.value,this.Ca,this.i_,this.YWb);b=this.uah.value.create(this.ga,this.P6.voi,!0,Qi.AppFrame.Lca);const h=this.uah.value.create(this.ga,this.P6.s2h,!1,Qi.AppFrame.rca);this.zE=this.J5j.value.create(this.P6,
b,h,this.SWf,this.RWf);this.IBf();this.JT();return this.control}IBf(){var b=3===this.ga.mode?Qi.AppFrame.VD:Qi.AppFrame.cjc;const h=this.Vb.fe(Qi.AppFrame.Lca);h.parent=b;this.Vb.QZe(Qi.AppFrame.Lca);const r=this.Vb.fe(Qi.AppFrame.rca);r.parent=b;this.Vb.QZe(Qi.AppFrame.rca);b=this.Vb.fe(it.a.SHb);b.parent=Dd.AFrame.Ap;b.pga(()=>{this.P6.Sio()});b.bindAction(this.tUg,qb.a.iU);b.bindAction(this.YZ,qb.a.iU);b.bindAction(this.Pkk,qb.a.iU);h.bindAction(this.YZ,qb.a.iU);r.bindAction(this.YZ,qb.a.iU)}JT(){this.lp.JT(Qi.AppFrame.Lca);
this.lp.JT(it.a.v3a);this.lp.JT(Qi.AppFrame.rca);this.lp.JT(it.a.SHb)}G$(b){this.lp.$I(Qi.AppFrame.Lca);this.lp.$I(it.a.v3a);this.lp.$I(Qi.AppFrame.rca);this.lp.$I(it.a.SHb);this.lp.fx(Dd.AFrame.In);this.Vb.zFc(Qi.AppFrame.Lca);this.Vb.zFc(Qi.AppFrame.rca);b?this.Vb.mg(Qi.AppFrame.Lca):this.Vb.mg(Qi.AppFrame.rca)}kea(b){this.lp.fx(Qi.AppFrame.Lca);this.lp.fx(it.a.v3a);this.lp.fx(Qi.AppFrame.rca);this.lp.fx(it.a.SHb);this.lp.$I(Dd.AFrame.In);(b||this.Vb.currentScope&&(this.Vb.currentScope.name===Qi.AppFrame.Lca||
this.Vb.currentScope.name===it.a.v3a||this.Vb.currentScope.name===Qi.AppFrame.rca||this.Vb.currentScope.name===it.a.SHb))&&this.Vb.mg(Dd.AFrame.In)}dispose(){const b=this.Vb.fe(it.a.SHb);b.nr(this.tUg);b.nr(this.YZ);this.Vb.fe(Qi.AppFrame.Lca).nr(this.YZ);this.Vb.fe(Qi.AppFrame.rca).nr(this.YZ);this.Fk&&this.Fk.a7c(this.Y9d);this.control.dispose()}}Object(m.a)(U,"HeaderFooterControlOwner",null,[632,633]);var na=c(1121);class Na{constructor(b,h,r,B,P,ca,ra,Qa){this.sba=b;this.Llk=h;this.Jve=r;this.om=
B;this.pek=P;this.ikk=ca;this.y5j=ra;Na.rh=Qa}xDm(b,h){this.Llk(b,1,3,null,!1);this.sba.Khe(Cw.a.dMb,1696,b.currentNode);this.Jve(b,0,this.om?3:1,h);this.Jve(b,1,2,h);this.Jve(b,2,this.om?1:3,h);this.pek(b);this.ikk(b,!1,!0,null);this.y5j(b,h)}static get uE(){return null!=Na.LJg?Na.LJg:Na.LJg=Ma.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get Tk(){return null!=Na.SFg?Na.SFg:Na.SFg=Ma.a.instance.resolve("Box4.IParagraphEditor")}static bho(b,h,r){Kf.moveToCellContent(b,0,h);ig.OutlineElementNavigator.Ee(b);
Na.uE.W9c(Box4Intl.Box4Strings.L_StyleWordHeader,b.currentNode);Na.Tk.oE(b.currentNode,r);h||Na.Tk.qq.Iza(b,1,-115);2===h&&Na.Tk.qq.nQb(b.currentNode,1,-115);Kf.returnToContainingTable(b)}static wjo(b,h){ig.OutlineElementNavigator.Ee(b);Na.uE.W9c(h?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,b.currentNode);ig.OutlineElementNavigator.Yd(b)}static RQl(){return(b,h,r)=>{Na.bho(b,h,r)}}static k_l(){return(b,h)=>{Na.wjo(b,h)}}static Kgm(b){return(h,r,B,P,ca)=>b.lEa(h,
r,B,P,ca)}static Bem(){return(b,h,r,B,P)=>Na.rh.My(b,h,r,B,P)}}Na.rh=null;Object(m.a)(Na,"HeaderFooterDefaultTableInserter",null,[630]);class jb{constructor(b,h,r,B){this.nm=b;this.ptd=h;this.Yc=r;this.Zk=B}$nj(b,h){b.Gn.properties.setValue(Mc.a.Pyf,2===h||4===h);b.zb(8);b.$dd(8).properties.setValue(Mc.a.jWd,3===h||4===h)}sZn(b){this.Zk.GPa(b,h=>{const r=this.Yc.Ek();r.set(h);this.nm.PLb(r);this.$nj(r,1);this.tZn(r);return!0})}tZn(b){for(;b.Rd();)b.zg()}}Object(m.a)(jb,"HeaderFooterEditor",null,[629]);
var Tb=c(1128);class Ac extends zr.a{constructor(b){super();this.rXe=b}get index(){return 0}run(){this.rXe()}Otm(b,h){h.property===Mc.a.Pyf&&this.bK()}$yn(b,h){h.property===Mc.a.jWd&&this.bK()}bK(){this.QY()}}Object(m.a)(Ac,"ControlUpdateNeededTracker",zr.a,[]);class Vc{constructor(b,h,r,B,P,ca){this.bab=null;this.K5j=r;this.Ymd=h;this.FXb=b;this.Eek=B;this.PMa=ca}start(){this.FXb.bind(Eb.App.za.tE);this.Ymd.control=this.FXb.control;this.Ymd.Tb();this.K5j.control=this.FXb.control;this.Eek.value.create(this.FXb.control,
Object(z.a)(this.Ymd,this.Ymd.WXh,"ensureSectionHeaderFooterAttachedToControl")).Tb();this.vvm()}vvm(){this.bab=new Ac(()=>{this.FXb.control.update()});const b=Eb.App.si.Il;b.Ue(35).Eo(Object(z.a)(this.bab,this.bab.Otm,"headerFooterContainerNodePropertyChanged"));b.Ue(8).Eo(Object(z.a)(this.bab,this.bab.$yn,"pageContentNodePropertyChanged"));Tb.a.lde(Object(z.a)(this.bab,this.bab.bK,"setUpdateNeeded"));Si.GraphTransactionManager.instance.nra(this.bab,3)}dispose(){this.FXb.dispose();this.PMa.vTh()}}
Object(m.a)(Vc,"HeaderFooterManager",null,[]);class Fd{constructor(b,h,r,B){this.Zk=b;this.nm=h;this.dck=r;this.wye=B}Uwl(b,h){let r=!1;const B=my.a.Ssf(h);b.Jt(B)||(this.IDm(b,h),this.wye.wDm(b.currentNode,h),r=!0);return r}IDm(b,h){const r=this.dck.create(1074135123),B=b.currentNode.ja(Mc.a.Vja,0);r.properties.setValue(Mc.a.Vja,B);r.properties.setValue(Mc.a.Kac,h);h=my.a.Ssf(h);b.Bf(r,h)}}Object(m.a)(Fd,"HeaderFooterNodeLevelInserter",null,[626]);var xd=c(227),Md=c(388);class Je extends xd.a{constructor(b,
h,r){super(b,h,"","");this.Nxb=null;this.Goi=Je.uQh;this.wTc=[];this.KDe=r}get $A(){return!0}get cssClass(){return"cui-herodock"}Im(){this.nUn();super.Im()}pPa(){for(const b of this.wTc)b.PMd();super.pPa()}PBo(){let b,h,r;b=[];h=[];r=[];for(let B=0;B<this.wTc.length;B++){const P=this.wTc[B];P.visible?b.length<this.Goi?b.push(P):Object(Ib.a)(Md.FlyoutAnchor,P)?Array.addRange(h,P.JTl()):h.push(P):r.push(P)}return{cMo:b,Byn:h,PGm:r}}ldl(b){if(!b||!b.length)return null;const h=new pe.Menu(this.root,this.id+
"OverflowMenu",null,null,null),r=new im.a(this.root,this.id+"OverflowMenuSection",null,null,{DisplayMode:"Menu20",ShowSeperator:"false",Scrollable:"true"},h);for(const B of b)r.Bf(B.cR("Menu20"));h.Bf(r);return h}nUn(){this.$qa();this.Nc=qf.a.MTa(this.Nc);this.VC();var b;({cMo:r,Byn:b,PGm:B}=this.PBo());for(var h of r){var r=h.cR("Medium20");r.enabled=!0;this.n2b(r,this.children.count);this.Nc.appendChild(r.Nc);r.hoa()}if(b=this.ldl(b))this.Nxb?this.Nxb.menu=b:(h=this.id+"OverflowMenuLauncher",r=
{},r.Image20by20=this.KDe.OverflowMenuImage20by20,r.Image20by20Class=this.KDe.OverflowMenuImage20by20Class,r.PopulateDynamically="false",r.HideDefaultArrow="true",r.Alt=this.KDe.OverflowMenuTooltip,r.Command="798637440",r.Id=h,this.Nxb=new Md.FlyoutAnchor(this.root,h,r,b)),b=this.Nxb.cR("Small20"),b.enabled=!0,this.n2b(b,this.children.count),this.Nc.appendChild(b.Nc),b.hoa();if(v.AFrameworkApplication.K.$("FixHeroDockNotPollingInvisibleComponentsIsEnabled"))for(const P of B){var B=P.cR("Medium20");
this.Bf(B);B.hoa()}}dispose(){this.Nxb&&(this.Nxb.dispose(),this.Nxb=null);for(const b of this.wTc)b.dispose();this.$qa();super.dispose()}set $A(b){super.$A=b}}Je.uQh=4;Object(m.a)(Je,"HeroDock",xd.a,[]);var uf=c(608);class Hg extends uf.a{constructor(){super();this.Rke=this.tRm=this.GDo=!1;this.dbn=v.AFrameworkApplication.sGf?1:Je.uQh}}Object(m.a)(Hg,"ToolbarBuildOptions",uf.a,[]);var Ye=c(44),Bg=c(882),Ti=c(723);class Om extends xd.a{constructor(b,h,r){super(b,h,"","");this.Tqc=r.Alignment;this.CTg=
r.ScalingDirection===Ye.a.YOj}Im(){this.mwa();this.qX(this.Nc);super.Im()}qX(b){for(let h of this.children){h.VC();switch(this.Tqc){case Ye.a.bre:qf.a.ag(h.Nc,"cui-toolbar-button-left");break;case Ye.a.S9a:qf.a.ag(h.Nc,"cui-toolbar-button-center");break;case Ye.a.YTb:qf.a.ag(h.Nc,"cui-toolbar-button-right");break;default:throw Error.argumentOutOfRange(this.Tqc);}h.visible&&b.appendChild(h.Nc);h.hoa()}}WO(b){if(!Object(Ib.a)(sn.a,b))throw Error.create("Only children of type ControlComponent can be added to a ButtonDock.");
}get cssClass(){switch(this.Tqc){case Ye.a.bre:return"cui-toolbar-buttondock alignleft";case Ye.a.S9a:return"cui-toolbar-buttondock aligncenter";case Ye.a.YTb:return"cui-toolbar-buttondock alignright";default:throw Error.argumentOutOfRange(this.Tqc);}}get $A(){return!0}get alignment(){return this.Tqc}kac(){let b=0;if(this.alignment===Ye.a.S9a)for(let h of this.children){const r=h;r.visible&&(b+=r.Nc.offsetWidth)}else b=this.Nc.offsetWidth;return b}yUd(){let b=null;if(this.alignment===Ye.a.S9a)for(let h of this.children){if(h.visible){b=
Sys.UI.DomElement.getBounds(h.Nc);break}}else b=Sys.UI.DomElement.getBounds(this.Nc);return b?0===this.root.U1?b.x:b.x+b.width:0}ERd(){let b=null;if(this.alignment===Ye.a.S9a){if(0<this.children.count){const h=this.children.yqf(this.children.count-1);for(;h.Zmb();){const r=h.get_current();if(r.visible){b=Sys.UI.DomElement.getBounds(r.Nc);break}}}}else b=Sys.UI.DomElement.getBounds(this.Nc);return b?0===this.root.U1?b.x+b.width:b.x:0}Sif(){for(let b of this.children){const h=b;if(!Object(Ib.a)(sn.a,
h)||h.control.visible)h.visible=!0}}$ao(b){const h=this.children.toArray(),r=new Ti.a;let B=this.CTg?0:h.length-1;const P=this.children.count,ca=this.root.YUa;for(;this.kac()>=b&&!(B>=P||0>B);){const ra=h[B];ca&&Object(Ib.a)(sn.a,ra)&&ra.control.visible&&(r.add(ra),ra.Huh());B+=this.CTg?1:-1}for(let ra of r)ra.saj(),ra.visible=!1}set $A(b){super.$A=b}}Object(m.a)(Om,"ButtonDock",xd.a,[]);class Di extends Bk.a{constructor(b,h,r,B,P,ca,ra=!1){super(b,h,ca);this.Usa=this.HZ=this.yma=null;this.rLe=!1;
this.V4a=B;this.Rke=P;this.szd=0;nf.c(h.Size)||(h.Size===Ye.a.Eug||r.options.tRm?this.szd=0:h.Size===Ye.a.FRj&&(this.szd=1));this.$mk=ra}get YUa(){return!0}Bf(b){super.Bf(b);Object(Ib.a)(Om,b)&&!this.rLe&&(b.alignment===Ye.a.bre?(this.yma&&this.eeg(),this.yma=b):b.alignment===Ye.a.S9a?(this.HZ&&this.eeg(),this.HZ=b):b.alignment===Ye.a.YTb&&(this.Usa&&this.eeg(),this.Usa=b))}eeg(){this.rLe=!0;this.Usa=this.HZ=this.yma=null}Qpb(b,h){b=this.cQc(b);nf.c(b)||b.visible===h||(b.visible=h,this.refresh())}Im(){super.Im();
this.g9i(!0)}g9i(b){const h=this.root.QCb;nf.c(this.Nc)&&this.Jfl();this.Nc=qf.a.MTa(this.Nc);this.xTc&&this.Nc.appendChild(this.xTc);for(let r of this.children)r.visible&&(r.VC(),this.Nc.appendChild(r.Nc),r.hoa());this.HZ&&b&&this.rwl();h&&h.kZ();this.dirty=!1}rwl(){if(this.HZ.visible&&this.HZ.children.count&&(this.Tuh(0,0),this.xsl(this.yma,this.HZ,this.Usa))){let b=0,h=0;const r=this.yma?this.yma.kac():0,B=this.Usa?this.Usa.kac():0;if(0<B||0<r)B>r?(b=0,h=B-r):(b=r-B,h=0);this.Tuh(b,h)}}xsl(b,h,
r){let B=!1;0===this.root.U1?(b&&(B=b.ERd()>h.yUd()),!B&&r&&(B=h.ERd()>r.yUd())):(b&&(B=b.ERd()<h.yUd()),!B&&r&&(B=h.ERd()<r.yUd()));return B}Tuh(b,h){0===this.U1?(this.HZ.Nc.style.marginLeft=b+"px",this.HZ.Nc.style.marginRight=h+"px"):(this.HZ.Nc.style.marginRight=b+"px",this.HZ.Nc.style.marginLeft=h+"px")}Jfl(){this.VC()}wu(){this.mUh(()=>{Es.a.prototype.wu.call(this)})}Pqa(b){b=this.cQc(b);nf.c(b)||this.mUh(Object(z.a)(b,b.Hm,"pollForStateAndUpdate"))}mUh(b){this.jgc=this.S5a=!1;b();if(this.S5a||
this.jgc)this.$mk||this.refresh(),this.scale()}WO(b){if(!Object(Ib.a)(Je,b)&&!Object(Ib.a)(Om,b))throw Error.create("Only children of type ButtonDock and HeroDock can be added to a Toolbar");if(Object(Ib.a)(Om,b)&&b.alignment===Ye.a.S9a)for(let h of this.children)if(h.alignment===Ye.a.S9a)throw Error.create("Can't add a centered buttondock because one is already present.");}get cssClass(){let b="cui-toolbar-toolbar ";0===this.szd?(b+="cui-toolbar-onerow ",v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.D9||
(b+="UITextTranformUpperCase ")):1===this.szd&&(b+="cui-toolbar-singledock ");return b+super.cssClass}get Zva(){return"div"}get A$(){return 26}get rAj(){return this.wO}set rAj(b){this.wO=b}V9k(b){b=b[Ye.a.Jw];return new Om(this.root,b.Id,b)}VC(){super.VC();this.Nc.setAttribute("role","toolbar");this.properties.Title&&this.Nc.setAttribute("title",this.properties.Title)}VJa(b){return this.root&&this.root.gjc(b)?!0:!1}Vio(){this.oUa()}scale(){super.scale();if(!qf.a.hs(this.properties.Scale)||this.rLe)return!1;
nf.c(this.yma)||(this.yma.visible=!0,this.yma.Sif());nf.c(this.HZ)||(this.HZ.visible=!0,this.HZ.Sif());nf.c(this.Usa)||(this.Usa.visible=!0,this.Usa.Sif());this.g9i(!1);const b=this.Nc.offsetWidth,h=nf.c(this.yma)?0:this.yma.kac(),r=nf.c(this.HZ)?0:this.HZ.kac(),B=nf.c(this.Usa)?0:this.Usa.kac();B+r+h>=b&&(B+h>=b?(this.Loi(this.HZ),B>=b?(this.Loi(this.yma),this.ibg(this.Usa,b)):this.ibg(this.yma,b-B)):this.ibg(this.HZ,b-B-h));this.S5a=!1;this.Im();return!1}Loi(b){b&&(b.visible=!1)}ibg(b,h){b&&b.$ao(h)}}
Object(m.a)(Di,"Toolbar",Bk.a,[848]);class Jp extends Di{constructor(b,h,r,B,P=!1){super(b,h,r,!1,!1,B,P);this.i5g=!0}get A$(){return 7}get cssClass(){return Jp.HDo+" "+super.cssClass}static get HDo(){let b="cui-statusbar";v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.D9||(b+=" UISmallFont UITextTranformUpperCase");return b}}Object(m.a)(Jp,"StatusBar",Di,[]);var jt=c(484);class zi extends jt.a{constructor(){super();this.toolbar=null;this.Z0d=!1}}Object(m.a)(zi,"ToolbarBuildContext",jt.a,
[]);class kx extends We.Builder{constructor(b,h,r,B){super(b,h,Fj.Task.A4(r),B);if(nf.c(h))throw Error.create("Toolbar placeholder DOM element is null or undefined.");}get toolbar(){return this.root}pfg(b){this.root=b}get hng(){return this.options}tPk(){const b=new zi,h=new Bg.a;h.id="toolbar";h.H5c=1;h.handler=Object(z.a)(this,this.ztn,"onReturnToolbarData");h.data=b;this.Pva.pfe(h)}ztn(b){this.pfg(this.vPk(b.a5c,b.UJc));this.toolbar.rAj=this;this.toolbar.Im();this.placeholder.appendChild(this.toolbar.Nc);
qf.a.ag(this.placeholder,"loaded");this.$ua.continueWith(()=>{this.$ua.result.tMb(this.toolbar)},11)}vPk(b,h){var r=Ye.a.Nha(b,Ye.a.sSj);nf.c(r)&&(r=Ye.a.Nha(b,Ye.a.MRj),h.Z0d=!0);if(nf.c(r))throw Error.create("No toolbar element was present in the data");b=new Ye.a(r);r=v.AFrameworkApplication.K.$("ToolbarScalingRedundancyEliminationIsEnabled");h.Z0d?this.pfg(new Jp(b.attributes[Ye.a.id],b.attributes,this,this.iba,r)):this.pfg(new Di(b.attributes[Ye.a.id],b.attributes,this,this.hng.GDo,this.hng.Rke,
this.iba,r));this.toolbar.iva=this.options.iva;this.toolbar.Voe=!0;this.toolbar.Im();b=Ye.a.ww(Ye.a.Nha(b.node,Ye.a.GOj));h=this.aNk(b,h);for(const B of h)this.toolbar.Bf(B);return this.toolbar}aNk(b,h){const r=[];for(let B=0;B<b.length;B++)this.ARa(b[B])||Array.add(r,this.CNk(b[B],h));return r}CNk(b,h){const r=Ye.a.qRc(b);let B=null;r===Ye.a.cNj?B=this.jNk(b,h):r===Ye.a.mPj&&(B=this.$Nk(b,h));return B}$Nk(b,h){var r=new Ye.a(b);r=new Je(this.root,r.attributes[Ye.a.id],b[Ye.a.Jw]);r.Goi=this.hng.dbn;
b=Ye.a.Nha(b,Ye.a.wsb);b=Ye.a.ww(b);const B=[];for(let ca=0;ca<b.length;ca++){var P=b[ca];this.ARa(P)||(P=this.Gga(P,h),Array.add(B,P))}r.wTc=B;return r}jNk(b,h){new Ye.a(b);const r=this.toolbar.V9k(b);b=Ye.a.Nha(b,Ye.a.wsb);b=Ye.a.ww(b);for(let B=0;B<b.length;B++){if(this.ARa(b[B]))continue;const P=this.uPk(b[B],h);r.Bf(P)}return r}uPk(b,h){var r=new Ye.a(b);const B=r.name;r=r.attributes[Ye.a.Upc];let P;P=h.Z0d?"Small14":"Small";switch(B){case Ye.a.button:return b=this.Gga(b,h),b.cR(nf.b(r)?P:r);
case Ye.a.cFa:return P=h.Z0d?"Medium14":"Medium",b=this.Gga(b,h),b.cR(nf.b(r)?P:r);case Ye.a.label:return b=this.Gga(b,h),b.cR(nf.b(r)?P:r);case Ye.a.separator:return b=this.Gga(b,h),b.cR("Small");case Ye.a.toggleButton:return b=this.Gga(b,h),b.cR(nf.b(r)?P:r);default:throw Error.create("Invalid control type.");}}}Object(m.a)(kx,"ToolbarBuilder",We.Builder,[]);var Bt=c(1492);class Ct{constructor(b,h,r,B,P,ca){this.znb=()=>{this.toolbar.Hm()};this.BI=b;b=new vl.CuiHelper(Nd.a.V_a,WordEditorIntl.WordEditorStrings,
null,null,[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings]);B=new Hg;B.gH={};ca=3!==ca.mode;B.gH.HeaderToolbarControlsRight=ca;B.gH.HeaderToolbarButtonDockRight=ca;B.gH.HeaderToolbarButtonRemovePageNumbers=ca;P=new kx(B,this.BI,this,P);P.Pva=new Bt.a(Ct.Ytm,b);P.tPk();this.Ima=P.toolbar;r.execute(ra=>{this.toolbar.JF=ra});this.toolbar.refresh();this.toolbar.Hm();this.Nh=h;h.z_a(this.znb)}get toolbar(){return this.Ima}dispose(){this.Nh.wjc(this.znb);this.toolbar&&(this.toolbar.dispose(),this.Ima=null)}refresh(){this.toolbar.refresh()}setFocus(){this.toolbar.Vio()}Apl(){this.toolbar.o4()}tMb(){}}
Ct.Ytm="WordEditorHeaderToolbarData";Object(m.a)(Ct,"HeaderFooterToolbar",null,[657,658]);class Eu{constructor(b,h,r,B,P){this.Nh=b;this.Lxe=h;this.rd=r;this.iba=B;this.ga=P}create(b){return new Ct(b,this.Nh,this.Lxe,this.rd,this.iba,this.ga)}}Object(m.a)(Eu,"Factory",null,[627]);class lx{constructor(b,h){this.Yc=b;this.Zk=h}Ael(b){return'<Menu Id="HeaderToolbarSectionMenu"><MenuSection Id="HeaderToolbarSectionSection" DisplayMode="Menu16"><Controls Id="HeaderToolbarSectionControls">'+this.zel(b)+
"</Controls></MenuSection></Menu>"}VZl(b){const h=this.Yc.Ek();h.set(b);h.zb(8);h.jd(8);return h}zel(b){if(!b)return"";let h="";b=this.VZl(b);this.Zk.GPa(b,r=>{const B=this.Zk.Gki(r);r=r.getValue(Mc.a.Vja);h+=mi.k(r.toString(),r.toString(),qb.a.Mcg.toString(),qb.a.a4f.toString(),String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,B));return!0});return h}}Object(m.a)(lx,"HeaderFooterToolbarGenerator",null,[625]);var lz=c(125);class fB extends dv.a{constructor(b,h,r,B,P,
ca,ra,Qa){super(b,h,r,B);this.kt=()=>{this.tdd(this.Cb)};this.BI=b.container;this.ew=document.createElement("div");this.aH(this.ew);this.nCa=P;this.ILa=ca;this.Ho.execute(tb=>{tb.fZ(this.kt)});this.GK=ra;if(this.MI=Qa)this.BI.style.backgroundColor=this.GK.w$b()}dispose(){super.dispose();this.Ho.instance&&this.Ho.instance.OTa(this.kt)}get Ho(){return null!=this.LAg?this.LAg:this.LAg=Ma.a.instance.Ta("Common.IZoomManager")}pC(b){this.BI.classList.add("HeaderFooterViewElement");this.ew.classList.add("HeaderFooterViewContent");
this.tdd(b.currentNode)}q6(b){this.ew.parentNode&&this.ew.parentNode===this.BI||(this.BI.appendChild(this.ew),this.ILa.instance&&this.ILa.instance.tfg(this.nc,this.BI));super.q6(b)}QSb(b){lz.a.ie(()=>{lz.a.prototype.QSb.call(this,b);this.zFj();this.ILa.instance&&this.ILa.instance.EEj(this.nc,this.ew.style.paddingLeft,this.ew.style.paddingTop)},"HFVE:UFO")}tdd(b){this.Ho.instance&&this.Ho.instance.afd(this.ew);this.zFj();b=this.nCa.S$b(b);this.ew.style.paddingLeft=b.A5b+"px";this.ew.style.width=b.TJc+
"px";this.ILa.instance&&this.ILa.instance.EEj(this.nc,this.ew.style.paddingLeft,this.ew.style.paddingTop)}zFj(){if(this.Ho.instance){this.ew.style.paddingTop="";var b=Sm.a.AB(this.ew);b.paddingTop&&(b=dc.a.iN(b.paddingTop),this.ew.style.paddingTop=Math.round(b/this.Ho.instance.nj)+"px")}}}Object(m.a)(fB,"HeaderFooterViewElement",dv.a,[]);class mz{constructor(b,h,r,B){this.nCa=b;this.ILa=h;this.GK=r;this.MI=B}create(b,h,r,B){return new fB(b,h,r,B,this.nCa,this.ILa,this.GK,this.MI)}}Object(m.a)(mz,
"Factory",null,[624]);var Fw=c(352),Gw=c(198),mA=c(989),jC=c(586);class nz extends Fw.a{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc,Uc,od,Od,ze,de){super(h,ca,ra,Qa,tb,Gw.a.Jpi,Mb,Zb,jc,Gc,Uc,od,Od,ze,de);this.isHeader=this.isHeader=b;this.kZa=P;this.kZa.Dbd=this;B(this);this.Vid=r;this.sBa=document.createElement("div");this.sBa.setAttribute("Unselectable","on");this.sBa.setAttribute("hideselection","hideselection");this.sBa.setAttribute("style","outline:none;");this.sBa.innerText=WordEditorIntl.WordEditorStrings.l_HeaderFooterNoContentAvailableMessage;
this.sBa.tabIndex=0;this.features.srj=!0;this.features.N6e=!0}get zFf(){return!0}uwf(){const b=this.Vid.unf(this);return mA.ViewReference.mF(this,b)}Uff(b){Object(Ib.a)(nz,b)||this.Vid.dismiss()}get yzf(){return"WordEditor"+(this.isHeader?"Header":"Footer")+"HiddenLabel"}RRc(){return jC.a.DPi}onResize(){super.onResize();this.kZa.VXh()}YE(b,h=null){this.sBa.parentNode&&this.sBa.parentNode.removeChild(this.sBa);super.YE(b,h);this.kZa.IXh(this.ed.xj)}detach(){this.kZa.UXh();super.detach();this.sBa.parentNode||
this.container.insertBefore(this.sBa,this.container.firstChild)}R9c(){this.mv?super.R9c():this.sBa.focus()}EPd(){this.onResize()}}Object(m.a)(nz,"HeaderFooterView",Fw.a,[653,107,59,60,9,108,109,110,111]);class nA{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc,Uc,od,Od){this.Vid=b;this.Qok=h;this.Pok=r;this.gu=B;this.ld=P;this.Jma=ca;this.ga=ra;this.LXa=Qa;this.mua=tb;this.J7=Mb;this.vpk=Zb;this.Zt=jc;this.jz=Gc;this.Qf=Uc;this.Ah=od;this.Oid=Od}create(b,h){return new nz(b,h,this.Vid,this.Qok,this.Pok(),
this.gu,this.ld,this.Jma,this.ga,this.LXa,this.mua,this.J7,this.vpk,this.Zt,this.jz,this.Qf,this.Ah,this.Oid)}}Object(m.a)(nA,"Factory",null,[623]);class jq{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc,Uc,od,Od,ze,de){this.oah=!1;this.shh="SourceControlId";this.pKo=1;this.qKo=1E3;this.Gbe=(ee,je,ue,Qf,Jg)=>{if(1===ue)return 32;this.Cmd(Jg[this.shh]);Jg[Ui.a.Text]=this.MNe.rzn(this.Wcb.oIb);return 32};this.VLn=(ee,je,ue,Qf,Jg)=>{if(1===ue)return 32;Jg[qg.a.On]=this.Wcb.oIb;return 32};this.nym=(ee,
je,ue,Qf,Jg)=>{if(1===ue)return 32;this.Wcb.kXo(Jg[qg.a.On]);return 32};this.Qaj=(ee,je,ue)=>{if(1===ue)return 32;if(this.Eaa){je=jq.hi.su(je.view.ed);ue=Ad.GraphIterator.eb(je);const Qf=this.Vd.Q_a();try{const Jg=this.Lc.Pc(15);try{Jg.Db(je),Jg.Uj=ee,Rn.a.instance.GPa(ue,Ql=>{this.SZb.N6c(Ql,this.IUl,this.hko);return!0})}finally{Jg&&Jg.dispose()}}finally{Qf&&Qf.dispose()}}return 32};this.e4c=(ee,je,ue,Qf,Jg)=>{if(1===ue)return 32;Jg.MenuItems=this.Gek.value;this.oah?this.Wcb.r6n():this.oah=!0;return 32};
this.DEm=(ee,je,ue,Qf,Jg)=>{if(1===ue)return 32;const Ql=this.Cmd(Jg[this.shh]);if(this.Eaa){je=jq.hi.su(je.view.ed);ue=Ad.GraphIterator.eb(je);Qf=this.Lc.Pc(15);try{Qf.Db(je);Qf.Uj=ee;let Fm=null;const Kp=this.je.Zf("UserAction","InsertPageNumber");Rn.a.instance.GPa(ue,nv=>{this.Eaa.hca||this.g2j(nv);Fm=this.LNe.BEm(nv,Ql,this.Wcb.oIb)||Fm;return!0});Kp.stop();if(!Fm)return 8;this.Zwo(Fm,Ql)}finally{Qf&&Qf.dispose()}this.Vd.Zs(12)}return 32};this.qzn=()=>32;this.Hxo=(ee,je,ue,Qf,Jg)=>{if(1===ue)return 32;
2===ue&&this.PMa.showCallout(Jg);return 32};this.Gxo=(ee,je,ue,Qf,Jg,Ql)=>this.fTe.create(ee,je,ue,Qf,Jg,Ql);this.Dpl=(ee,je,ue)=>{if(1===ue)return 32;this.PMa.vTh();return 32};this.Rvo=ee=>{v.AFrameworkApplication.va.Rqa(null,qb.a.Xsj,ee.customData,null)};this.IUl=ee=>{const je=Bh.a.instance.ib.lb;let ue=-1;for(const Qf of je)if(Qf.node===ee){ue=Qf.cpBegin;break}return{returnValue:ue,I_d:xe.SelectionEditor.Pl(je)}};this.hko=(ee,je)=>{ee=og.SelectionFactory.ne(ee,je);Bh.a.instance.Ac(ee)};this.ga=
b;this.Lc=h;this.Ib=r;this.Wcb=B;this.Eaa=P;this.nm=ca;this.MNe=ra;this.LNe=Qa;this.SZb=tb;this.PMa=Mb;this.hb=Zb;this.fTe=jc;this.je=Gc;this.Vd=Uc;this.Cmd=od;this.g2j=de;this.Gek=new pf.a(()=>this.Wcb.A8l())}Tb(){this.ga.fb(qb.a.e4c,yc.a.view,this.e4c,100);this.ga.fb(qb.a.d0i,yc.a.view,this.qzn,68);this.ga.fb(qb.a.gti,yc.a.view,this.DEm,4);this.ga.fb(qb.a.oIb,yc.a.view,this.nym,4);this.ga.fb(qb.a.N6c,yc.a.view,this.Qaj,4);this.ga.fb(qb.a.q0n,yc.a.view,this.Qaj,4);this.ga.fb(qb.a.C4f,yc.a.application,
this.VLn,97);this.ga.fb(qb.a.Gbe,yc.a.application,this.Gbe,97);this.ga.fb(qb.a.Wsj,yc.a.view,this.Hxo,4);this.ga.HT(qb.a.Xsj,yc.a.view,this.Gxo,100);this.ga.fb(qb.a.Cpl,yc.a.view,this.Dpl,4)}Zwo(b,h){const r=b.Lb.paragraph;if(r){var B=this.nm.b1c(r);B&&this.Eaa.pha(B)}B=this.Eaa.hca;this.Eaa.show(4>h);r&&this.xjo(r)&&(this.Fno(b,r),this.Jvk(b,B))}xjo(b){let h;if(!({isHeader:h,Vlg:b}=this.nm.$ii(b)).returnValue)return!1;this.Eaa.Fza(b,h);return!0}Fno(b,h){b=og.SelectionFactory.ne(h,b.Lb.cp);this.hb.Ac(b)}Jvk(b,
h){h=new Me.a(2,1,h?this.pKo:this.qKo,this.Rvo);h.customData=b;this.Ib.Wb(h)}static get hi(){return qo.PageNavigator.instance}}Object(m.a)(jq,"PageNumbersActor",null,[652]);class pi{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc){this.ga=b;this.Ib=h;this.Wcb=r;this.MNe=B;this.LNe=P;this.SZb=ca;this.PMa=ra;this.fTe=Qa;this.nm=tb;this.Vd=Mb;this.Cmd=Zb;this.Znk=jc;this.iga=Gc}create(b,h){return new jq(this.ga,new Il.a,this.Ib,this.Wcb,b,this.nm,this.MNe,this.LNe,this.SZb,this.PMa,Bh.a.instance,this.fTe,
Eb.App.za.Lq,this.Vd,this.Cmd,this.Znk,this.iga,h)}}Object(m.a)(pi,"Factory",null,[622]);var kt=c(1992),ny;(function(b){b[b.small=0]="small";b[b.mediumSmall=1]="mediumSmall";b[b.medium=2]="medium";b[b.large=3]="large"})(ny||(ny={}));Object(m.b)("ModalCalloutSize",ny);var mx;(function(b){b[b.topCenter=0]="topCenter";b[b.topJustified=1]="topJustified";b[b.topLeft=2]="topLeft";b[b.topRight=3]="topRight";b[b.bottomCenter=4]="bottomCenter";b[b.bottomLeft=5]="bottomLeft";b[b.bottomRight=6]="bottomRight"})(mx||
(mx={}));Object(m.b)("BeakLocation",mx);class oz{constructor(b,h,r){this.oKo=1;this.gQe=!1;this.d0b=null;this.TVn=()=>{this.hb.Ww(this.Sqa);this.gQe=!0;this.d0b=null};this.Sqa=(B,P)=>{if(B=P.yl.lb)1<B.length||!B.length?B=!0:(B=B.Pa,B=B.cpEnd-B.cpBegin,B=1<B||!B),B&&this.d1j()};this.Ib=b;this.hb=h;this.d1j=r}Qz(){this.Ivk()}daa(){this.gQe?(this.hb.hZ(this.Sqa),this.gQe=!1):this.d0b&&(this.Ib.ff(this.d0b),this.d0b=null)}Ivk(){this.d0b=new Me.a(2,1,this.oKo,this.TVn);this.Ib.Wb(this.d0b)}}Object(m.a)(oz,
"CalloutDismissManager",null,[]);class Qv{constructor(b,h,r,B){this.dismiss=()=>{this.aI&&(this.iuc.daa(),this.O0c.dismiss())};this.O0c=b;this.Xo=B;this.iuc=new oz(h,r,this.dismiss)}get aI(){return this.O0c.aI}show(){if(!this.aI){const b=document.createElement("div");b.classList.add(Qv.pzn);b.innerText=WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText;this.O0c.content=b;this.O0c.show();this.Xo&&this.Xo.sendNotification(WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText,!0);this.iuc.Qz()}}dispose(){this.dismiss();
this.O0c.dispose()}static vcl(b,h){h=kt.a.WMh(Qd.a.getElementBounds(b.targetElement),h,Eb.App.za.tE,ny.small);h.Bga=Qv.Oof(b);h.Kt=!1;return h}static Oof(b){let h=mx.bottomCenter;Object(Ib.a)(653,b.view)&&b.view.isHeader&&(h=mx.topCenter);return h}}Qv.pzn="PageNumbersCalloutControl";Object(m.a)(Qv,"PageNumbersCallOutControl",null,[651]);class pz{constructor(b,h,r){this.pT=null;this.hT=!1;this.dismiss=()=>{this.aI&&this.pT&&al.UISurfaces.LM().then(B=>{this.iuc.daa();B.removeNotification(this.pT);this.hT=
!1;return null},B=>{t.ULS.sendTraceTag(593352339,383,15,"Failed to GetNotificationsAPIAsync: {0}",B);return null})};this.Cl=b;this.iuc=new oz(h,r,this.dismiss)}get aI(){return this.hT}show(){this.aI||al.UISurfaces.LM().then(b=>{const h=b.callout(Object.assign(new Sr.a,{target:this.Cl,content:WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText})),r=Object.assign(new rd.a,{telemetryId:"PageNumbersCallout",onShow:()=>{this.hT=!0},expirationOptions:Object.assign(new Wd.a,{displayTimeoutSeconds:7,
onExpire:()=>{this.dismiss()}})});this.pT=b.addNotification(h,r);this.iuc.Qz();return null},b=>{t.ULS.sendTraceTag(593352340,383,15,"Failed to GetNotificationsAPIAsync: {0}",b);return null})}}Object(m.a)(pz,"ReactPageNumbersCallOutControl",null,[651]);class oA{constructor(b,h,r){this.hb=h;this.Ib=b;this.Xo=r}create(b,h){if(v.AFrameworkApplication.ua.Kb&&v.AFrameworkApplication.ua.Kb.HRa)return new pz(h.targetElement,this.Ib,this.hb);b=Qv.vcl(h,b);return new Qv(b,this.Ib,this.hb,this.Xo,v.AFrameworkApplication.ua.aQ)}}
Object(m.a)(oA,"Factory",null,[621]);class du{constructor(b,h){this.zE=null;this.Fek=b;this.Xi=h}get control(){return this.zE}showCallout(b){this.control&&this.control.aI&&this.control.dismiss();this.zE=this.LGn(b);this.control.show()}vTh(){this.control&&(this.control.dismiss(),this.zE=null)}LGn(b){const h=this.Xi.yoa();this.zE=this.Fek.value.create(h,b);return this.control}}Object(m.a)(du,"PageNumbersCalloutControlManager",null,[620]);var pA=c(769);class qA extends cu.a{constructor(){super();this.Text=
null}get Type(){return 7}}Object(m.a)(qA,"PageNumberGalleryButtonProps",cu.a,[]);const Rv=(b,h,r)=>{b=b.Ek();b.set(r);h.PLb(b);return b};class Js{constructor(b,h,r){this.VEe=!1;this.iga=h;this.om=r}get oIb(){return this.VEe}A8l(){const b=Object.assign(new $f.a,{Id:"menuPageNumbersDropDown",MenuSectionList:[]});b.MenuSectionList.push(this.qtk());b.MenuSectionList.push(this.fuk());b.MenuSectionList.push(this.Iuk());return b}kXo(b){this.VEe=b;this.e9i()}r6n(){this.VEe=!1;const b={};b[Js.Zqi]="CheckboxModel";
this.iga(b);this.e9i()}qtk(){const b=Object.assign(new di.a,{Id:"msIncludePageCount",ControlsId:"ctrlIncludePageCount",Title:F.a.zf(WordEditorIntl.WordEditorStrings.L_PageNumbersSectionHeaderForAdd),ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new pA.a,{Id:Js.oym,Command:qb.a.oIb.toString(),QueryCommand:qb.a.C4f.toString(),LabelText:F.a.zf(WordEditorIntl.WordEditorStrings.L_IncludePageCount),Alt:F.a.zf(WordEditorIntl.WordEditorStrings.L_IncludePageCountAlt),KeyTip:CommonUIStrings.l_IncludePageCountKeytip,
UseUncheckedImage:!0,CloseMenuWhenExecuted:!1});b.ControlList.push(h);return b}fuk(){const b=Object.assign(new di.a,{Id:"msPageNumbersPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),h=Object.assign(new Sg.a,{Id:"galleryPageNumbersPosition",ExternalId:"PageNumbers",ExternalGalleryId:"InsertPageNumberGallery",Type:7,Width:3,ElementDimensions:"Size61by75",GalleryItems:[]});if(this.om){for(var r=3;1<=r;r--)h.GalleryItems.push(this.frf(r));for(r=6;4<=r;r--)h.GalleryItems.push(this.frf(r))}else for(r=
1;6>=r;r++)h.GalleryItems.push(this.frf(r));b.ControlList.push(h);return b}Iuk(){const b=Object.assign(new di.a,{Id:"msRemovePageNumbers",ControlsId:"ctrlRemovePageNumbers",DisplayMode:"Menu16",ControlList:[]}),h=Object.assign(new ah.a,{Id:"btnRemovePageNumber",Command:qb.a.N6c.toString(),LabelText:F.a.zf(WordEditorIntl.WordEditorStrings.L_RemovePageNumbers),Alt:F.a.zf(WordEditorIntl.WordEditorStrings.L_RemovePageNumbersAlt),Image16by16:v.AFrameworkApplication.Ns,Image16by16Class:we.getImageClass("WordRemovePageNumbers_16x16x32"),
KeyTip:CommonUIStrings.l_RemovePageNumbersKeytip});b.ControlList.push(h);return b}frf(b){const h=Js.n_f+b.toString();var r=Object,B=r.assign,P=new qA,ca=qb.a.gti.toString(),ra=qb.a.Gbe.toString(),Qa=F.a,tb=Qa.zf;let Mb="";switch(b){case 1:Mb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopLeftAlt;break;case 2:Mb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopCenterAlt;break;case 3:Mb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopRightAlt;break;case 4:Mb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomLeftAlt;
break;case 5:Mb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomCenterAlt;break;case 6:Mb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomRightAlt}return B.call(r,P,{Id:h,Command:ca,QueryCommand:ra,Alt:tb.call(Qa,Mb)})}e9i(){const b={};for(let h=1;6>=h;h++)b[Js.n_f+h.toString()]="PageNumberGalleryButtonModel";b[Js.Zqi]="CheckboxModel";this.iga(b)}static B8l(b){return b?parseInt(b.substr(Js.n_f.length)):1}}Js.oym="btnIncludePageCount";Js.Zqi="IncludePageCount";Js.n_f="btnPageNumbersPosition";
Object(m.a)(Js,"PageNumbersControl",null,[619]);class cs{constructor(b,h,r,B,P=null,ca=null,ra=null,Qa=null){this.w_l=(tb,Mb)=>{const Zb=new Vh.a;tb=4>tb;switch(Mb){case 1:case 2:Zb.add(tb?0:3);break;case 3:case 4:Zb.add(tb?0:3),Zb.add(tb?1:4)}return Zb};this.mTl=(tb,Mb,Zb)=>{var jc=Rv(this.Yc,this.nm,tb);this.nm.QLb(jc,Zb);let Gc=this.v_j(jc,Mb);if(Gc)this.SZb.sbj(Gc);else{jc=Rv(this.Yc,this.nm,tb);this.nm.QLb(jc,Zb);jc.Rd();if(Uf.OutlineElementReader.Eh(jc)&&(ig.OutlineElementNavigator.Ee(jc),ke.ParagraphReader.oh(jc))){jc=
jc.currentNode;const Uc=this.eji(Mb);ke.ParagraphReader.Lx(jc)===Uc&&this.SZb.sbj(jc)&&(Gc=jc)}Gc||(jc=Rv(this.Yc,this.nm,tb),this.nm.QLb(jc,Zb),this.BL.Fkb(jc,null,!0),Gc=ig.OutlineElementNavigator.Ee(jc),this.oE(Mb,Gc))}return Gc};this.nTl=(tb,Mb)=>{let Zb=null;tb.Ub(1);if(Uf.OutlineElementReader.Eh(tb)&&(tb.Ub(2),Rh.TableReader.isTable(tb))){var jc=tb.currentNode;if(3===Rh.TableReader.hh(jc)){let Gc=0;jc=Rh.TableReader.Pn(jc);switch(Mb){case 1:case 4:Gc=jc?2:0;break;case 2:case 5:Gc=1;break;case 3:case 6:Gc=
jc?0:2}Kf.moveToCellContent(tb,0,Gc);tb.currentNode&&Uf.OutlineElementReader.Eh(tb)&&(tb=ig.OutlineElementNavigator.Ee(tb),ke.ParagraphReader.Xb(tb)&&(Zb=tb))}}return Zb};this.ZNm=(tb,Mb)=>{const Zb=Rv(this.Yc,this.nm,tb);tb=Zb.currentNode.ja(Mc.a.Vja,0);this.nm.QLb(Zb,Mb);Mb=Zb.currentNode.ja(Mc.a.Vja,0);return tb===Mb};this.Yc=b;this.Hek=h;this.SZb=r;this.nm=B;this.fwc=P||this.w_l;this.w_j=ca||this.mTl;this.v_j=ra||this.nTl;this.I8j=Qa||this.ZNm}get BL(){return null!=this.UEg?this.UEg:this.UEg=
Ma.a.instance.resolve("Box4.IOutlineEditor")}BEm(b,h,r){var B=Rv(this.Yc,this.nm,b).Gn;B=this.nm.Yha(B);B=this.fwc(h,B);let P=null;for(let ra=0;ra<B.length;ra++){var ca=B.eg(ra);this.I8j(b,ca)&&(ca=this.w_j(b,h,ca),P=this.Hek.euk(ca,r)||P)}return P}oE(b,h){cs.c6.W9c(4>b?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,h);cs.Tk.oE(h,this.eji(b))}eji(b){let h=1;switch(b){case 1:case 4:h=1;break;case 2:case 5:h=2;break;case 3:case 6:h=3}return h}static get Tk(){return null!=
cs.QFg?cs.QFg:cs.QFg=Ma.a.instance.resolve("Box4.IParagraphEditor")}static get c6(){return null!=cs.nHg?cs.nHg:cs.nHg=Ma.a.instance.resolve("Box4.Styles.IWACStyleEditor")}}Object(m.a)(cs,"PageNumbersInserter",null,[512]);var Sv=c(893),nx=c(901);class lt{constructor(b,h,r=null,B=null,P=null){this.q9k=(ca,ra)=>{ca=Ue.a.Rc(ca,ke.ParagraphReader.textLength(ca));const Qa=ca.node.Mc;return Qa?lt.jg.hia(ca,tb=>{tb=nx.a.getInstance(tb);this.cJd(tb,15,Qa,ra);this.cJd(tb,47,Qa,ra);this.cJd(tb,16,Qa);this.cJd(tb,
17,Qa);return tb}):null};this.fFm=(ca,ra)=>{ca=Ue.a.Rc(ca,ke.ParagraphReader.textLength(ca));lt.jg.Ge(ca,ra)};this.Lc=b;this.qtd=r||WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.Fxe=B||this.q9k;this.gjh=P||this.fFm}euk(b,h){const r=this.Lc.Pc(15);r.Db(b);var B=ke.ParagraphReader.text(b),P=!1;0<B.length&&" "!==B.charAt(B.length-1)&&(P=!0);if(h){h=String.format(this.qtd,"#","$");P&&(h=" "+h);P=h.indexOf("#");B=h.indexOf("$");t.ULS.shipAssertTag(4256717,309,-1!==P,"{0}",
{["PageNumberIndex"]:P});t.ULS.shipAssertTag(4256718,309,-1!==B,"{0}",{["PageCountIndex"]:B});t.ULS.shipAssertTag(4256719,309,P!==B,"{0}",{["PageNumberIndex"]:P,["PageCountIndex"]:B});let Qa;let tb;if(P<B){var ca=P;Qa=B;var ra=Sv.a.uQc(0);tb=Sv.a.uQc(1)}else ca=B,Qa=P,ra=Sv.a.uQc(1),tb=Sv.a.uQc(0);this.DCf(b,h,0,ca);ra=this.Fxe(b,ra);this.DCf(b,h,ca+1,Qa);ca=this.Fxe(b,tb);this.DCf(b,h,Qa+1,h.length);b=P<B?ra:ca}else P&&this.gjh(b," "),b=this.Fxe(b,Sv.a.uQc(0));r.dispose();return b}cJd(b,h,r,B=null){const P=
new Qz.a;P.setValue(Pd.a.Z$,!0);P.setValue(Mc.a.UEb,1);P.setValue(Mc.a.Qs,h);switch(h){case 15:P.setValue(Mc.a.MRa,!0);P.setValue(Mc.a.UX,B);break;case 47:P.setValue(Mc.a.UX,B);break;case 17:P.setValue(Mc.a.$Jb,!0)}h=r.Uu(P,V.a.create());this.bvk(b,h)}bvk(b,h){b.Hua(h,V.a.nil,oi.AParagraphNode.RC,null)}DCf(b,h,r,B){h=h.substring(r,B);0<h.length&&this.gjh(b,h)}static get jg(){return lt.Md||(lt.Md=Ma.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set jg(b){lt.Md=b}}lt.Md=null;Object(m.a)(lt,
"PageNumbersNodeLevelInserter",null,[510]);class Bq{rzn(b){return Bq.V$l(b)}static V$l(b){return String.format(b?WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount:WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewText,Bq.U_i,Bq.U_i)}}Bq.U_i="1";Object(m.a)(Bq,"PageNumbersPositionPreviewGenerator",null,[509]);class rA{constructor(){this.WPg=String.format(WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount,"\ufffc","\ufffc");this.PZj=this.WPg.length}ktm(b){let h=
b.characterData.lastIndexOf("\ufffc");return-1!==h&&h+1===ke.ParagraphReader.textLength(b)?{returnValue:!0,h4c:h}:{returnValue:!1,h4c:-1}}Urm(b){let h=b.characterData.lastIndexOf(this.WPg);return-1!==h&&h+this.PZj===ke.ParagraphReader.textLength(b)?{returnValue:!0,h4c:h}:{returnValue:!1,h4c:-1}}Ksm(b){return So.a(b,9)?!0:!1}}Object(m.a)(rA,"PageNumbersReader",null,[511]);class hv{constructor(b,h,r,B,P,ca=null,ra=null){this.p0n=(Qa,tb,Mb,Zb)=>{Qa=Rv(this.Yc,this.nm,Qa);this.nm.QLb(Qa,tb);tb=nm.a.Qp(Qa);
for(Qa=!1;tb.moveNext();){const jc=tb.currentNode;if(ke.ParagraphReader.Xb(tb.currentNode)&&So.a(tb.currentNode,9)){Qa=!0;let Gc;const Uc=({I_d:Gc}=Mb(jc,Gc)).returnValue;let od=Uc;od=this.SZn(jc,od);od=this.K0n(jc,od);-1<Uc&&(od===Uc&&Gc||Zb(jc,od))}}Qa&&this.Vd.Zs(12)};this.Yc=b;this.nm=h;this.NNe=r;this.Vd=B;this.dCc=P;this.fwc=ca||my.a.cff;this.Xgk=ra||this.p0n;this.qtd=WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.GWg=String.format(this.qtd,"#","$");this.$6j=this.GWg.indexOf("#");
this.Z6j=this.GWg.indexOf("$");this.cCe=String.format(this.qtd,"\ufffc","\ufffc");this.zWg=this.cCe.length}N6c(b,h,r){var B=Rv(this.Yc,this.nm,b).Gn;B=this.nm.Yha(B);B=this.fwc(B);for(const P of B)this.Xgk(b,P,h,r)}sbj(b){if(this.NNe.Ksm(b)){let h=-1;if(({h4c:h}=this.NNe.Urm(b)).returnValue&&this.wDh(b,h)||({h4c:h}=this.NNe.ktm(b)).returnValue&&this.sVk(b,h))return!0}return!1}K0n(b,h){var r=b.qa.length;for(let P=0;P<r;P++){var B=b.qa.J(P);B.blob&&9===B.blob.vh&&(B=B.cp,r=Ue.a.createTextRange(b,B,
B+1),this.dCc(r,""),r=b.qa.length,P--,h=this.lsh(h,B,1))}return h}SZn(b,h){let r=b.characterData.indexOf(this.cCe);for(;-1!==r;)this.wDh(b,r)&&(h=this.lsh(h,r,this.zWg)),r=b.characterData.indexOf(this.cCe);return h}sVk(b,h){const r=b.qa.nh(h);return r&&r.blob&&9===r.blob.vh?(b=Ue.a.createTextRange(b,h,h+1),this.dCc(b,""),!0):!1}wDh(b,h){const r=b.qa.nh(h+this.$6j),B=b.qa.nh(h+this.Z6j);return r&&r.blob&&9===r.blob.vh&&B&&B.blob&&9===B.blob.vh?(b=Ue.a.createTextRange(b,h,h+this.zWg),this.dCc(b,""),
!0):!1}lsh(b,h,r){-1<b&&b>h&&(h=b-h,b=h>r?b-r:b-h);return b}}Object(m.a)(hv,"PageNumbersRemover",null,[507]);class oy{constructor(b,h){this.Zsb=this.Ysb=null;this.Nr=b;this.Ib=h}zCk(){this.Nr.style.display="";this.Ysb||(this.Zsb&&(this.Ib.ff(this.Zsb),this.Zsb=null),this.Ysb=new Me.a(0,1,10,()=>{this.Nr.classList.add("Displayed");this.Ysb=null}),this.Ib.Wb(this.Ysb))}BCk(){this.Nr.classList.remove("Displayed");this.Zsb||(this.Ysb&&(this.Ib.ff(this.Ysb),this.Ysb=null),this.Zsb=new Me.a(0,1,200,()=>
{this.Nr.style.display="none";this.Zsb=null}),this.Ib.Wb(this.Zsb))}}Object(m.a)(oy,"PaneControlAnimationHelper",null,[545]);class py{constructor(b){this.Ib=b}G8l(b){return new oy(b,this.Ib)}}Object(m.a)(py,"PaneControlAnimationHelperFactory",null,[506]);class sA{constructor(b,h,r,B,P,ca,ra,Qa,tb=!1){this.RKg=this.Ima=this.Zmd=null;this.Rtm=()=>{this.Gv.sendNotification(this.RKg+" "+WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText,!0)};this.ga=b;this.P6=h;this.P6.bind(this);
this.kGe=r;this.Rta=P;this.mWe=ra;this.Vb=Qa;this.zod=tb;this.qfa=ca.value.create(r,B);this.P6.LKk(this.qfa);this.YZ=Jb.KeyInputManager.ic(se.a.l2,0)}get Gv(){return null!=this.uwg?this.uwg:this.uwg=Ma.a.instance.resolve("Common.Utils.IAriaNotifier")}G1(b){this.P6.G1(b);this.Ima&&!b&&this.Ima.Apl()}pha(b){this.Zmd!==b&&(this.fhb(),this.Zmd=b)}lkj(b){if(this.Zmd){var h=this.Rta.E2a(this.Zmd,my.a.v_l(b,this.kGe));this.zod?(this.RKg=this.J4h(b,this.kGe),this.qfa.jQb(Se.a.FDd)):this.MTo(b);h&&this.y3e(h)}}swh(b){this.zod&&
this.Vb&&(b=this.Vb.fe(b))&&b.Q3(this.Rtm)}J4h(b,h){let r="";switch(b){case 1:r=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessage;break;case 2:r=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessageForReadOnly:
WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessage;break;case 3:r=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessage;
break;case 4:r=3!==this.ga.mode?h?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessageForReadOnly:h?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessage}return r}MTo(b){this.qfa.ylj(this.J4h(b,this.kGe),Se.a.FDd)}setInitialSelection(){this.qfa.R9c()}y3e(b){this.fhb();this.qfa.YE(b,b.xj)}fhb(){this.qfa.detach()}Ifl(){this.Ima=
this.mWe.value.create(this.P6.Tnc);this.Eqo(this.Ima)}Eqo(b){if(this.Vb){const h=this.Vb.fe(it.a.v3a);h.parent=Dd.AFrame.Ap;h.pga(()=>{b.setFocus();this.Poo()});h.bindAction(this.YZ,qb.a.iU)}}Poo(){if(this.Vb){var b=this.Vb.fe(it.a.v3a);const h=new $e.DOMFocusListing(()=>this.P6.Tnc);h.Ija=!0;h.Rm(1);this.Vb.Gfb(this.P6.Tnc,b,h);b=this.Vb.getRegion(it.a.v3a);b.ITa();b.BP=!0;h.xha&&h.gz(h.xha)}}dispose(){void 0!==this.Ima&&null!==this.Ima&&(this.Vb.fe(it.a.v3a).nr(this.YZ),this.Ima.dispose())}uUn(){void 0!==
this.Ima&&null!==this.Ima&&this.Ima.refresh()}}Object(m.a)(sA,"PaneControl",null,[543]);class ws{constructor(b,h,r,B){this.nm=b;this.M5j=h;this.mWe=r;this.Vb=B}create(b,h,r,B){return new sA(b,h,r,B,this.nm,this.M5j,this.mWe,this.Vb,v.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}}Object(m.a)(ws,"Factory",null,[505]);var ox=c(1119);class qz extends Dv.a{constructor(b,h,r,B,P,ca,ra,Qa,tb){super();this.init(b);this.Rl("ShowCalloutForPageNumberOperation");this.TUj=Qa;
this.zkb(this.TUj,h,B,P,ca);this.nz=0;this.Vcb=ca;this.PMa=ra;this.Nh=tb;1===this.behavior&&(this.ur=32,this.tra())}get Svl(){if(null!=this.Byg)var b=this.Byg;else{var h;b=this.Byg=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.EndOperationOnFailureIsEnabled",!1)}return b}run(){var b=this.Nh.jb.iu;if(!this.nz){var h=xi.a.Y9b(this.Vcb,b);this.Vcb.jTc(b,h)?this.Vcb.Swa(b,h).element&&(this.nz=1):this.Svl&&(this.nz=2)}1===this.nz&&(h=xi.a.Y9b(this.Vcb,
b),h=this.Vcb.Swa(b,h),b=new ox.a(h.element,b),this.PMa.showCallout(b),this.nz=2);2===this.nz&&(this.ur=32,this.tra())}}Object(m.a)(qz,"ShowCalloutForPageNumberOperation",Dv.a,[]);class mt{constructor(b,h,r){this.PMa=b;this.ga=h;this.oUb=r}create(b,h,r,B,P,ca){return new qz(b,h,r,B,P,ca,this.PMa,this.ga,this.oUb)}}Object(m.a)(mt,"Factory",null,[499]);class Mr{get BL(){return null!=this.SEg?this.SEg:this.SEg=Ma.a.instance.resolve("Box4.IOutlineEditor")}wc(b){b.ia("WordEditor.HeaderFooter.HeaderFooterManager",
()=>new Vc(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlOwner"),b.resolve("WordEditor.HeaderFooter.HeaderFooterActor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),b.Ve("WordEditor.HeaderFooter.IPageNumbersActorFactory"),b.resolve("WordEditor.IHeaderFooterViewElementFactory"),b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),b.resolve("Box4.IFeatureHelper"))).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterView.Factory",()=>new nA(b.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),
mD.a.d$e,()=>b.resolve("WordEditor.SectionAlignedViewRepositioner"),Eb.App.za.jb,hb.InteractiveViewManager.instance,()=>b.resolve("Box4.IUndoManager"),v.AFrameworkApplication.va,b.resolve("Box4.IInteractiveEventNotifier"),b.Ta("Box4.ITextMetricsAdapter"),b.resolve("Box4.IRotatingCoordinateConverter"),b.Ta("Common.IZoomManager"),b.Oa("Box4.IContentControlViewElementManager"),b.Oa("Box4.CpConversionManagerImpl"),b.Oa("Box4.ContentControlConfigSettings"),b.Oa("Box4.IContentControlReader"),b.Oa("Box4.IContentControlBoundaryNavigator"))).as("WordEditor.HeaderFooter.IHeaderFooterViewFactory").ha();
b.ia("WordEditor.HeaderFooter.HeaderFooterViewElement.Factory",()=>new mz(b.resolve("Box4.SectionAlignedViewPositionProvider"),b.Ta("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),b.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Eb.App.instance&&Eb.App.instance.dD)).as("WordEditor.IHeaderFooterViewElementFactory").ha();b.ia("WordEditor.HeaderFooter.HeaderFooterToolbar.Factory",()=>new Eu(ub.App.nn,b.Ta("Box4.IGeneralCuiUser"),b.resolve("Box4.IFeatureHelper"),ub.App.nn,
v.AFrameworkApplication.va)).as("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory").ha();b.ia("WordEditor.HeaderFooter.PaneControl.Factory",()=>new ws(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.Ve("WordEditor.HeaderFooter.IHeaderFooterViewFactory"),b.Ve("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory"),pc.FocusManager.instance())).as("WordEditor.HeaderFooter.IPaneControlFactory").ha();b.ia("WordEditor.HeaderFooter.HeaderFooterControl.Factory",()=>new kA(()=>{Eb.App.za.updateCommandUI()},
b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),v.AFrameworkApplication.va,b.resolve("Box4.ContentEditableViewEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlFactory").ha();b.ia("WordEditor.HeaderFooter.PageNumbersActor.Factory",()=>new pi(v.AFrameworkApplication.va,Wg.a.instance,b.resolve("WordEditor.HeaderFooter.PageNumbersControl"),b.resolve("WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator"),b.resolve("WordEditor.HeaderFooter.PageNumbersInserter"),
b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),b.resolve("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Js.B8l,Object(z.a)(Eb.App.za,Eb.App.za.Jdd,"updateRibbonControl"),Object(z.a)(Eb.App.za,Eb.App.za.jH,"updateRibbonControls"))).as("WordEditor.HeaderFooter.IPageNumbersActorFactory").ha();
b.ia("WordEditor.HeaderFooter.HeaderFooterControlLauncher",()=>new uq).ha();b.ia("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory",()=>new py(Wg.a.instance)).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterControlOwner",()=>new U(pc.FocusManager.instance(),Eb.App.za.wx,b.Ve("WordEditor.HeaderFooter.IPaneControlFactory"),b.Ve("WordEditor.HeaderFooter.IHeaderFooterControlFactory"),b.Ve("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory"),v.AFrameworkApplication.va,new pf.a(()=>Eb.App.za.jb.rc),
v.AFrameworkApplication.K,b.resolve("Box4.IPasteFloatieEventSource"),b.resolve("Box4.IExternalContentFloatieEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent").ha();b.ia("WordEditor.HeaderFooter.HeaderFooterEditor",()=>new jb(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),si.PageReader.instance,new Tp.a,Rn.a.instance)).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator",()=>new lx(new Tp.a,Rn.a.instance));b.ia("WordEditor.HeaderFooter.HeaderFooterActor",
()=>new jA(v.AFrameworkApplication.va,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),b.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),Rn.a.instance,new Tp.a,new Il.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator"),jA.Fki,b.resolve("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory"))).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter",()=>new Na(jx.a.instance,Na.Kgm(b.resolve("Box4.ITableEditor")),
Na.RQl(),v.AFrameworkApplication.isRtl,ig.OutlineElementNavigator.Yd,Na.Bem(),Na.k_l(),b.resolve("Box4.IOutlineElementEditor")));b.ia("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter",()=>new na.a(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new Tp.a,h=>this.BL.Fkb(h,null,na.a.jgg),v.AFrameworkApplication.isRtl,Object(z.a)(b.resolve("Box4.IOutlineElementEditor"),b.resolve("Box4.IOutlineElementEditor").xQb,"setRtlSimple"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter"),
b.resolve("Box4.Styles.IWACStyleEditor")));b.ia("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter",()=>new Fd(Rn.a.instance,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooterNodeFactory"),b.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter"))).ha();b.ia("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory",()=>new ly(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new Tp.a,new Il.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),
v.AFrameworkApplication.va)).ha();b.ia("WordEditor.HeaderFooter.HeaderFooterInserter",()=>new eB(b.resolve("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),Rn.a.instance,new Tp.a,v.AFrameworkApplication.va)).ha();b.ia("WordEditor.HeaderFooter.PageNumbersControl",()=>new Js(Object(z.a)(Eb.App.za,Eb.App.za.Jdd,"updateRibbonControl"),Object(z.a)(Eb.App.za,Eb.App.za.jH,"updateRibbonControls"),v.AFrameworkApplication.isRtl)).ha();b.register(Bq,
"WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator").ha();b.ia("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter",()=>new lt(new Il.a,b.resolve("Box4.IFeatureHelper"))).ha();b.ia("WordEditor.HeaderFooter.PageNumbersInserter",()=>new cs(new Tp.a,b.resolve("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter"),b.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).ha();b.ia("WordEditor.HeaderFooter.PageNumbersReader",()=>new rA).ha();
b.ia("WordEditor.HeaderFooter.PageNumbersRemover",()=>new hv(new Tp.a,b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),b.resolve("WordEditor.HeaderFooter.PageNumbersReader"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Object(z.a)(Mr.jg,Mr.jg.Ge,"replaceTextRange"))).ha();b.ia("WordEditor.HeaderFooter.PageNumbersCalloutControlManager",()=>new du(b.Ve("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory"),Eb.App.za)).as("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager").ha();
b.ia("WordEditor.HeaderFooter.PageNumbersCallOutControl.Factory",()=>new oA(Wg.a.instance,Bh.a.instance,b.resolve("Common.Utils.IAriaNotifier"))).as("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory").ha();b.ia("WordEditor.HeaderFooter.ShowCalloutForPageNumberOperation.Factory",()=>new mt(b.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),v.AFrameworkApplication.va,Eb.App.za)).as("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory").ha();b.ia("WordEditor.HeaderFooter.ClientPaginationPageAdornmentContentManager",
()=>new NC(b.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),v.AFrameworkApplication.va)).as("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager").ha();b.ia("WordEditor.HeaderFooter.ClientPaginationHeaderFooterBridge",()=>new gv(b.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),b.resolve("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager"))).as("WordEditor.IClientPaginationHeaderFooterBridge").ha()}static get jg(){return null!=Mr.Ywg?Mr.Ywg:
Mr.Ywg=Ma.a.instance.resolve("Box4.ICharacterPropertiesEditor")}}Object(m.a)(Mr,"HeaderFooterComponentConfiguration",null,[2]);class Hw{constructor(){this.bnd=this.W=null}get name(){return"WordEditor.HeaderFooter"}wc(b){this.W=b;(new Mr).wc(b)}init(){this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{this.wn()})}wn(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(111)&&(this.bnd=this.W.resolve("WordEditor.HeaderFooter.HeaderFooterManager"),this.bnd.start(),this.W.resolve("WordEditor.IClientPaginationHeaderFooterBridge"))}dispose(){this.bnd&&
this.bnd.dispose()}static main(){L.a.instance.Gc(new Hw)}}Object(m.a)(Hw,"PackageManager",null,[1,2]);var Dt=c(328),mr=c(497);class Iw{constructor(b,h){this.Qf=b;this.km=h}create(){return new mr.a(this.Qf.instance,this.km.instance)}}Object(m.a)(Iw,"ContentControlNodeFactory",null,[404]);var gB=c(1719),ai=c(385),px=c(1079);class tA{create(){return new px.a}}Object(m.a)(tA,"ContentControlContainerNodeFactory",null,[404]);var $m=c(189),rz=c(391),sz=c(246),hB=c(1134);const tz=b=>b?(b=b.ja(Mc.a.POa,null))&&
b.includes($m.a.JQh):!1;class qx{constructor(b,h,r,B,P,ca,ra){this.Voa=b;this.Pf=h;this.jg=r;this.Sga=B;this.Eea=P;this.qn=ca;this.O5k=ra;this.wln=(Qa,tb)=>{zm.a.nda&&(Qa=tb.node,tb=Ad.GraphIterator.eb(Qa),tb.zb(7)&&(tb=tb.jd(54)))&&(tb=tb.getValue(Mc.a.contentControlNode),Qa=Qa.id,1==(null===tb||void 0===tb?void 0:tb.length)&&Qa.equals(tb[0])&&(Qa=this.Voa.J8h(),this.HRh(Qa)))};this.jWf=(Qa,tb)=>{if(zm.a.nda)for(const Mb of tb.NPh)tz(Mb.contentControlNode)||(Qa=Mb.contentControlNode.ja(Mc.a.POa,
null),this.HRh(Qa))}}get qEf(){return v.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled")}init(){this.Sga.C9i(this.jWf);this.O5k.rO(this.wln)}HRh(b){const h=this.Voa.tGb();h&&b&&this.Voa.tHb(h,b)&&(b=new cg.GraphTransaction(7),b.St(h),h.zg(),b.dispose())}BKc(){const b=new hB.a;b.setValue(Mc.a.tmm,!0);var h=(h=Bb.a.create())?h.toString().replace(RegExp("-","g"),"").toUpperCase():null;b.setValue(Mc.a.nac,h);b.setValue(Mc.a.H5k,this.qEf);h=Bb.a.create();b.setValue(Mc.a.jli,
h);return b}SOk(b){const h=b.currentNode.getValue(Mc.a.jli);b.Bf(new rz.a,1);b.iY();b.currentNode.setValue(Mc.a.tUh,h);b.Bf(this.Pf.Jgb(),1);b.iY();return this.Pf.NH(b)}joo(b){var h=this.Voa.Prf();h.zb(7);if(h.uc()&&h.sQa(0,B=>8==B.type)){h=h.currentNode;const B=(new Aq.WACStyleSet).fY(h);if(B){var r=B.oj($m.a.d1f);if(!r&&(r=this.suk(h),t.ULS.sendTraceTag(508952736,368,50,`Placeholder text style is not in document. Adding new style succeeded: ${!!r}`),!r))return;b=Ue.a.createTextRange(b,0,ke.ParagraphReader.textLength(b));
this.Eea.rX(b,P=>{this.qn.Iga(P);this.qn.c8a(P,r)})}}}Gcl(b){var h=this.Voa.Prf();const r=this.BKc();h.Bf(r,29);h.iY();h=this.SOk(h);this.jg.Ge(Ue.a.Rc(h,0),b,!1,!1);this.joo(h);return r}m_k(b){const h=this.Voa.tGb();this.Voa.tHb(h,b);b=this.BKc();const r=this.Voa.Prf();r.Bf(b,29);r.Aj(b);fp.a(h.currentNode,r.currentNode,!1);return b}UYo(b,h){const {f$d:r,$ni:B}=this.Voa.IYl(b);if(r){var P=Ue.a.createTextRange(r,0,ke.ParagraphReader.textLength(r));this.jg.Ge(P,h,!1,!1);B&&this.pll(b);this.CXo(b)}}pll(b){const h=
this.Voa.tGb();if(h&&b&&this.Voa.tHb(h,b))for(h.Rd(),b=h.Wp(),--b;0<b;b--)h.rF(b),h.zg()}CXo(b){const h=this.Voa.tGb();this.Voa.tHb(h,b)&&h.currentNode.setValue(Pd.a.NR,new Date)}suk(b){const h=new ww.a(new sz.a);h.setValue(gi.a.la,"Placeholder Text");h.setValue(gi.a.na,1);h.setValue(Mc.a.ma,"PlaceholderText");h.setValue(dd.a.oa,99);h.setValue(Mc.a.pa,"Default Paragraph Font");h.setValue(Mc.a.yn,!0);h.setValue(Pd.a.fontColor,8421504);return Ck.a.OFc([h],b)?h:null}}Object(m.a)(qx,"GlossaryEditor",
null,[424]);class uA{constructor(b,h,r,B,P){this.Sga=b;this.lJh=h;this.NCb=r;this.UJ=B;this.Ej=P;this.F5k=new tA;this.yln=(ca,ra)=>{this.UJ.ie(()=>{if(ra){ra.Ro.selectedContentControls||(ra.Ro.selectedContentControls={});var Qa=ra.Ro.selectedContentControls,tb=ra.jUa;if(tb&&tb.length){var Mb=tb[0];tb=tb[tb.length-1];Mb=this.Sga.zpf(Ue.a.Rc(Mb.node,Mb.Wj),Ue.a.Rc(tb.node,tb.vp),!1);for(const Zb of Mb)zm.a.Hx&&Zb.contentControlNode.ja(Mc.a.QU,!1)||(Qa[Zb.contentControlNode.id.toString()]=!0)}}},"CC:OnBeforeCopy")};
this.XXf=(ca,ra)=>{this.UJ.ie(()=>{if(ra){var Qa=ra.clone,tb=ra.original;try{const Mb=ra.Ro.selectedContentControls,Zb=this.Sga.Iof(tb,0,tb.characterData.length,!0,!0,!1);for(const jc of Zb){const Gc=jc.me.toString();Mb[Gc]?jc.zp&&!this.$7k(jc.contentControlNode,Qa,Mb)&&(t.ULS.sendTraceTag(521172763,368,10,String.format("Cannot clone ContentControlNode id:{0} under the clipboard tree",Gc)),this.R7f(Qa,jc.me)):this.R7f(Qa,jc.me)}}catch(Mb){t.ULS.sendTraceTag(521171974,307,10,"onParagraphCopy operation failed: {0}",
Mb.toString()),this.lJh.qZn(Qa)}}},"CC:onParagraphCopy")};this.YXf=(ca,ra)=>{this.UJ.ie(()=>{if(ra){var Qa=ra.clone,tb=ra.original;try{const Mb=this.Sga.Iof(Qa,0,tb.characterData.length);ra.Ro.ccObjectIdMapping||(ra.Ro.ccObjectIdMapping={});const Zb=ra.Ro.ccObjectIdMapping;for(let jc=0;jc<Mb.count;jc++){const Gc=Mb.J(jc),Uc=Gc.me.toString();if(this.jTm(Gc))if(Gc.Oc){const od=tb.Yi().xd.Eb(Uc),Od=this.U9l(Gc),ze=this.d_k(od,Od.Q0i,Od.Csi,Qa.Yi().xd);Zb[Uc]=ze.id;this.NCb.yFj(Zb[Uc],Qa.id,null);this.Ej.Ffc(ze)}else this.NCb.yFj(Zb[Uc],
null,Qa.id);Zb[Uc]?(Gc.me=Zb[Uc],Gc.fv=null):this.R7f(Qa,Gc.me)}}catch(Mb){t.ULS.sendTraceTag(520414297,307,10,"onParagraphPaste operation failed: {0}",Mb.toString())}}},"CC:onParagraphPaste")}}init(){bt.a.Swk(this.yln);bt.a.s0e(this.XXf);bt.a.mCd(this.YXf)}JRl(b){if(!b.zb(25)||!b.jd(25))return null;if(!b.Jt(25)){const h=this.F5k.create(1074135144);b.Bf(h,25)}return b.Ub(25)}$7k(b,h,r){var B=b.ja(Mc.a.t8,null);const P=Ad.GraphIterator.eb(h);h=h.Yi().xd;r=B&&r[B.toString()]?h.Eb(B):this.JRl(P);if(!r)return t.ULS.sendTraceTag(521172765,
368,10,String.format("Cannot get parent node of the cloned content control node id:{0}",b.id.toString())),null;B=fp.b(b,h,!0);Ad.GraphIterator.eb(r).O3(B,26,b.id);54!==r.type&&B.setValue(Mc.a.t8,r.id);zm.a.Hx&&ai.a.HCf(null,B);return B}R7f(b,h){this.lJh.Ckl(new mb.a([b]),h)}jTm(b){var h=b.Lb.paragraph.Mc;if(!h)return t.ULS.sendTraceTag(520152150,368,10,String.format("Cannot get containing object space of the cloned content control node id:{0}",b.me.toString())),!1;h=h.Eb(b.fv);if(!h)return t.ULS.sendTraceTag(520152149,
368,10,String.format("Cannot get property set of the cloned content control node id:{0}",b.me.toString())),!1;b=h.getValue(Mc.a.Qs);return 38===b||39==b}pQl(b,h){var r,B=b.qa.J(b.qa.length-1);let P=b.characterData.length;B=(null===(r=null===B||void 0===B?void 0:B.Jb)||void 0===r?void 0:r.length)||0;b.id.equals(h.Lb.paragraph.id)&&(P=h.Lb.cp,B=h.Lb.Jb.AJ(h.me,h.Oc));return this.Sga.Jof(b,0,P,0,B)}U9l(b){let h=null,r=b.Lb.paragraph;const B={};for(;r;){const P=this.pQl(r,b);for(let ca=P.count-1;0<=ca;ca--){const ra=
P.J(ca);if(!ra.zp)continue;const Qa=ra.me.toString();if(ra.Oc){if(!B[Qa])return{Q0i:ra.contentControlNode,Csi:h}}else B[Qa]=!0,h||(h=ra.contentControlNode)}r=ke.ParagraphReader.Xf(r,!0,!0)}return{Q0i:null,Csi:h}}d_k(b,h,r,B){let P;h?P=this.NCb.Fwa(h):(P=this.NCb.Gwa(),h=P.currentNode);B=fp.b(b,B,!0);B.Hg(Mc.a.Zw,jd.a.GF());54!==h.type&&B.setValue(Mc.a.t8,h.id);P.ZH(B,r,26);zm.a.nda&&!tz(b)&&this.NCb.j_k(b,B);return B}}Object(m.a)(uA,"ContentControlCCP",null,[]);var iB=c(729);class uz{constructor(b,
h,r,B){this.Md=b;this.Qf=h;this.gb=r;this.Mg=B}get xY(){return!!this.Qf.instance&&this.Qf.instance.xY}get cJb(){return!!this.Qf.instance&&this.Qf.instance.cJb}Fua(b,h,r,B,P,ca=$m.a.PDb,ra=$m.a.D6b,Qa=null,tb=$m.a.Wdf,Mb=-1){(b=this.tRc(b,r))?(b.Jb||(b.Jb=new Dt.a(b)),this.bsk(h,b.Jb,B,P,ca,ra,Qa,tb,Mb)):t.ULS.sendTraceTag(17585366,368,15,"Unable to get a ChP at expected cp, which should not happen")}rRh(b,h,r){if(b){new mb.a;for(let P=0;P<b.count;P++){var B=this.vpf(b.J(P),h,!1);for(const ca of B)this.TZn(ca,
r)}}}Bkl(b,h){this.rRh(b,h,!0)}Ckl(b,h){this.rRh(b,h,!1)}Ge(b,h,r){this.Md.Ge(b,h,r===Nb.a.T$c)}tRc(b,h){var r=Ue.a.Rc(b,h);this.Md.t8a(r);for(r=0;r<b.qa.length;r++){const B=b.qa.J(r);if(B.cp>h)break;if(B.cp===h)return B}return null}bsk(b,h,r,B,P=$m.a.PDb,ca=$m.a.D6b,ra=null,Qa=$m.a.Wdf,tb=-1){const Mb=h.Lb.paragraph;b=new iB.a(h.Lb,!0,!0,!0,null,b,B,r,P,ca,ra,Qa,null,this.Mg);if(!this.xY||-1>=tb||tb>h.length)tb=h.length;h.insert(b,tb);Mb.Wl();b.qe?Mb.ye.uY(b.qe-1,512):Mb.ye.lpa(b.qe,512);Mb.ye.vq.Z(b.qe,
yr.CharacterPropertiesEditor.aN);Mb.ye.nt.Z(b.qe,yr.CharacterPropertiesEditor.YR)}vpf(b,h,r){const B=new mb.a;for(let P=0;P<b.qa.length;P++){const ca=b.qa.J(P);if(ca.Jb)for(let ra=0;ra<ca.Jb.length;ra++)if(ca.Jb.J(ra).me.equals(h)&&(B.add(ca.Jb.J(ra)),r))return B}return B}qdd(b,h,r){if(this.cJb&&b){var B=b.node,P=b.Wj,ca=b.vp,ra=this.O7h(B,P,h,!0);h=this.O7h(B,ca,h,!1);r?-1!==ra&&ra++:-1!==h&&h++;P||-1===ra||(ra=Math.max(ra,this.gb.Mv(B)));ca===this.gb.textLength(B)&&-1!==h&&(h=Math.min(h,this.gb.gv(B)));
b.Fb=ra;b.Sb=h}}O7h(b,h,r,B){return(b=(b=b.qa.nh(h))?b.Jb:null)&&b.length?b.AJ(r,B):-1}TZn(b,h){b&&b.Lb.Jb&&(h?b.Lb.Jb.remove(b):b.Lb.Jb.ara(b),h=b.Lb.paragraph,0<=b.qe&&b.qe<h.ye.length&&(b.Lb.cp||1!==h.ye.length||(h.ye.uY(0,512),h.ye.vq.Z(1,yr.CharacterPropertiesEditor.aN),h.ye.nt.Z(1,yr.CharacterPropertiesEditor.YR)),h.ye.removeAt(b.qe,512)),h.Wl())}qZn(b){const h=b.qa;if(h){var r=new mb.a;for(let B=0;B<h.length;B++){const P=h.J(B);if(P&&P.Jb){for(let ca=0;ca<P.Jb.length;ca++)r.add(P.Jb.J(ca).qe);
P.Jb=null}}b.Zqa(r)}}aSo(b,h,r){if(!(0>h||0>r))for(this.Md.t8a(Ue.a.Rc(b,h)),this.Md.t8a(Ue.a.Rc(b,r)),h=b.qa.zca(h),r=b.qa.zca(r),--r;r>h;r--){const B=b.qa.J(r);B.OEf?b.qa.removeAt(r):B.formatting=null}}}Object(m.a)(uz,"ContentControlChpManager",null,[434]);class kC{constructor(b,h,r,B,P){this.gb=b;this.Lo=h;this.Ah=r;this.rd=B;this.Mg=P}xof(b){if(!b||!xe.SelectionEditor.Ze(b))return null;if(!b.cpBegin){const h=this.S5h(b.node,b.Fb,!0);if(h)return h}return b.cpBegin===this.gb.textLength(b.node)?
this.S5h(b.node,b.Fb-1,!1):null}mPl(b,h){b=this.IMh(b,h);return this.xof(b)}S5h(b,h,r){return b.qa&&b.qa.length?(b=r?b.qa.first.Jb:b.qa.last.Jb)&&0<=h&&h<b.length&&b.J(h).Jf&&b.J(h).Oc===r&&this.$Df(b.J(h))?b.J(h):null:null}Jrf(b){if(!b||!xe.SelectionEditor.nv(b))return null;var h=this.Lo.aRd(b,b);b=0<h.count?h.J(h.count-1):null;return b&&!b.Jf&&this.$Df(b)?(h=1<h.count?h.J(h.count-2):null)&&!h.Jf&&this.$Df(h)?null:b:null}$Df(b){if(!b)return!1;var h=this.iei(b);if(!h)return!1;if(b.Oc)var r=b;else r=
h,h=b;var B=this.gb.textLength(b.Lb.paragraph);if(r.Lb.cp||h.Lb.cp!==B||!r.zp||r.Txa||!h.zp||h.Txa)return!1;r=r.Lb.Jb;h=h.Lb.Jb;for(B=0;B<r.length&&!r.J(B).me.equals(b.me);B++)if(!r.J(B).Oc)return!1;for(r=h.length-1;0<=r&&!h.J(r).me.equals(b.me);r--)if(h.J(r).Oc)return!1;return!0}Wcd(b){b=this.xof(b);this.uId(b,!1)}vDj(b,h){b=this.IMh(b,h);this.Wcd(b)}JJa(b){b=this.Jrf(b);return this.uId(b,!0)?b:null}LIm(b,h){b=this.xof(b);return!!b&&b.me.equals(h)}lcc(b,h,r){b=this.mPl(b,h);return!!b&&b.me.equals(r)}KFf(b,
h){b=this.Jrf(b);return!!b&&b.me.equals(h)}uId(b,h){if(!b)return!1;const r=this.iei(b);return this.RJh(b,h)&&(!r||this.RJh(r,h))}RJh(b,h){if(!b||b.Jf===h)return!1;var r=this.Lo.zne(b.Lb.paragraph,b.Oc);const B=b.Lb.Jb;-1!==r||b.Oc||(r=B.length);const P=h===b.Oc?1:-1;r+=h?P:0;b=B.AJ(b.me,b.Oc)+P;if(r===b||0<P!==b>r)return t.ULS.shipAssertTag(24933847,368,r!==b,"Stopping content control inline block conversion since we can't find a correct range to convert. begin: {0}, end: {1}, step: {2}",r,b,P),t.ULS.shipAssertTag(24933848,
368,0<P===b>r,"Stopping content control inline block conversion or we'll trap in infinite loop. begin: {0}, end: {1}, step: {2}",r,b,P),!1;for(var ca=r;ca!==b;ca+=P){var ra=B.J(ca);B.ara(ra);ra.Jf=h;B.oFm(ra,ca);this.oXo(B.J(ca))}if(this.L0)for(B.Lb.paragraph.Wl(),ca=r;ca!==b;ca+=P)ra=B.J(ca),ra.paragraph.ye.vq.Z(ra.qe,yr.CharacterPropertiesEditor.aN),ra.paragraph.ye.nt.Z(ra.qe,yr.CharacterPropertiesEditor.YR);h||this.WZo(B,r,b,P);t.ULS.sendTraceTag(24933849,368,50,"Converted {0} content control(s) to {1}",
Math.abs(b-r),h?"block":"inline");return!0}ITd(b){return b.Oc&&this.Mg.Gq(b.contentControlNode.id,!0).equals(b.Lb.paragraph.id)?38:!b.Oc&&this.Mg.Gq(b.contentControlNode.id,!1).equals(b.Lb.paragraph.id)?39:b.Jf&&b.Oc?40:b.Jf&&!b.Oc?41:!b.Jf&&b.Oc?38:39}oXo(b){const h=b.Lb.paragraph.Mc;if(h){var r=h.Eb(b.fv),B=b.contentControlNode;if(r){r=r.clone();r.setValue(Mc.a.sIf,b.Jf);const P=this.ITd(b);r.setValue(Mc.a.Qs,P);h.Uu(r,null);b.fv=r.id}B&&B.setValue(Mc.a.u9,b.Jf)}}iei(b){if(b.Lb.cp&&b.Lb.cp!==this.gb.textLength(b.Lb.paragraph)||
!b.Lb.paragraph.qa||!b.Lb.paragraph.qa.length)return null;const h=b.Oc?b.Lb.paragraph.qa.last:b.Lb.paragraph.qa.first;if(!h.Jb)return null;b=h.Jb.AJ(b.me,!b.Oc);return-1===b?null:h.Jb.J(b)}WZo(b,h,r,B){var P=b.J(h).contentControlNode;if(P){var ca=b.J(h).Oc;P=this.Mg.Gq(P.id,ca);if(!P.equals(V.a.nil))if(b.Lb&&b.Lb.paragraph&&b.Lb.paragraph.id.equals(P)){for(h+=B;h!==r;h+=B){const ra=b.J(h).contentControlNode;if(!ra)return;this.Mg.sE(ra.id,P,ca)}0<=r&&r<b.length&&b.J(r).Jf&&this.gIf(b.J(r))&&(b=b.J(r).contentControlNode)&&
this.Mg.sE(b.id,P,ca)}else t.ULS.shipAssertTag(24933851,368,!1,"Start/End object of innermost content control is not the paragraph which holds the content control.")}}gIf(b){return b.zp&&!b.Txa}IMh(b,h){if(!b||!this.Ah)return null;const r=h?Ue.a.Rc(b,0):Ue.a.tw(b);b=this.Ah.fr(b,h);r.Sb=r.Fb=b;return r}get L0(){return this.rd.isFeatureEnabled(31)}}Object(m.a)(kC,"ContentControlConverter",null,[433]);var Et;(function(b){b[b.Q9o=0]="BoundingBox";b[b.Qcp=1]="Tags";b[b.qap=2]="Hidden";b[b.xbp=3]="NumberOfContentControlAppearance"})(Et||
(Et={}));Object(m.b)("ContentControlAppearance",Et);var rx=c(1645);class qy{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb){this.Wab=this.DCa=this.Vkd=this.Oxd=this.vsd=null;this.Zka=this.fk=this.XAc=this._id=0;this.wWb=this.fud=this.Jyd=this._title=this.XAa=null;this.wpd=this.vpd=this.g3g=this.mvd=this.qxc=this.mxc=this.mkd=!1;this.x4g=null;this.Jf=!1;this.Pid=null;this.ji=r;this.Cx=h;this.Tg=B;this.qr=P;this.km=ca;this.J2=ra;this.pfa=Qa;this.kga=tb;this.zAb=Mb;this.Mg=Zb;b?(this.vsd=b.id,this.Pid=b,this.oU(!1)):
this._id=jd.a.GF()}get rj(){return this.ji.value}get id(){this.oU();return this._id}set id(b){this._id=b;this.isValid()&&(this.contentControlNode.setValue(Mc.a.Zw,this._id),this.vZ())}get parentId(){this.oU();return this.XAc}set parentId(b){this.XAc=b}get title(){this.oU();return this._title}set title(b){this._title=b;this.isValid()&&(this.contentControlNode.setValue(Mc.a.tgb,this._title),this.vZ(),this.sdd(h=>{h.title=this._title?this._title:$m.a.PDb}))}get tag(){this.oU();return this.Jyd}set tag(b){this.Jyd=
b;this.isValid()&&(this.contentControlNode.setValue(Mc.a.wgb,this.Jyd),this.vZ())}get type(){this.oU();return this.fk}set type(b){this.fk=b;this.isValid()&&(this.contentControlNode.setValue(Mc.a.xgb,rx.a[this.fk]),this.vZ())}get appearance(){this.oU();return this.Zka}set appearance(b){if(b&&1!==b&&2!==b)throw Error.argumentUndefined("The appearance value is undefined enum.");this.Zka=b;this.isValid()&&(this.contentControlNode.setValue(Mc.a.ugb,Et[this.Zka].toLowerCase()),this.vZ(),this.sdd(h=>{h.appearance=
Et[this.Zka].toLowerCase()}))}get color(){this.oU();return this.XAa}set color(b){if(b&&16777215>=b)this.XAa=b,this.isValid()&&(this.contentControlNode.setValue(Mc.a.NJc,this.XAa),this.vZ(),this.sdd(h=>{h.color=this.XAa}));else throw Error.argumentOutOfRange("The color value is out of range.");}get placeholderText(){this.oU();return this.fud}set placeholderText(b){this.fud=b;zm.a.nda&&this.Tg.gGj(b,this.Pid)&&(this.vZ(),this.NJ&&this.km.hBb(this,!0))}get KLd(){this.oU();return this.wWb}set KLd(b){this.wWb=
b;this.isValid()&&(this.contentControlNode.setValue(Mc.a.MCb,this.wWb),this.vZ())}get Agf(){this.oU();return this.mkd}set Agf(b){b&&(this.mkd=b,this.isValid()&&(this.contentControlNode.setValue(Mc.a.fId,this.mkd),this.vZ()))}get removeWhenEdited(){this.oU();return this.mvd}set removeWhenEdited(b){if(b&&!this.nia)throw Error.invalidOperation("Cannot set RemoveWhenEdited to true property if the content control is undeletable.");this.mvd=b;this.isValid()&&(this.contentControlNode.setValue(Mc.a.oJh,this.mvd),
this.vZ())}get nia(){this.oU();return this.mxc}set nia(b){if(!b&&this.removeWhenEdited)throw Error.invalidOperation("Cannot set IsDeletable property to false if the content control RemoveWhenEdited property is true.");this.mxc=b;this.isValid()&&(this.contentControlNode.setValue(Mc.a.x5b,this.mxc),this.sdd(h=>{h.bL=this.mxc}),this.vZ())}get isEditable(){this.oU();return this.qxc}set isEditable(b){this.qxc=b;this.isValid()&&(this.contentControlNode.setValue(Mc.a.OCb,this.qxc),this.sdd(h=>{h.editable=
this.qxc}),this.vZ())}get isSupported(){this.oU();return this.g3g}get oTm(){return this.isSupported&&11!==this.type&&10!==this.type}get zWm(){this.oU();return this.wWb&&"table of contents"===this.wWb.toLowerCase()?!0:!1}get e0d(){this.oU();return this.vpd}set e0d(b){this.vpd=b;this.isValid()&&(this.contentControlNode.setValue(Mc.a.rJh,this.vpd),this.vZ())}get udc(){this.oU();return this.wpd}set udc(b){this.wpd=b;this.isValid()&&(this.contentControlNode.setValue(Mc.a.sJh,this.wpd),this.vZ())}get NJ(){return this.contentControlNode.ja(Mc.a.u8,
!1)}set NJ(b){this.isValid()&&this.contentControlNode.setValue(Mc.a.u8,b)}get yu(){this.oU();return this.Oxd}set yu(b){this.Oxd=b}get Dz(){this.oU();return this.Vkd}set Dz(b){this.Vkd=b}get objectId(){return this.vsd}set objectId(b){this.vsd=b;this.Pid=this.rj.Eb(this.vsd)}get start(){this.YHj();return this.DCa}set start(b){this.DCa=b}get end(){this.YHj();return this.Wab}set end(b){this.Wab=b}get contentControlNode(){return this.Pid}WAn(b){for(let h=0;3>h;++h)if(Et[h].toLowerCase()===b)return h;return 0}vZ(){const b=
this.start.node;b&&b.setValue(Pd.a.NR,new Date)}Fdd(){this._id=this.contentControlNode.ja(Mc.a.Zw,0);this.Zka=this.WAn(this.contentControlNode.ja(Mc.a.ugb,null));this.XAa=this.contentControlNode.ja(Mc.a.NJc,null);this._title=this.contentControlNode.ja(Mc.a.tgb,null);this.Jyd=this.contentControlNode.ja(Mc.a.wgb,null);this.Jf=this.contentControlNode.ja(Mc.a.u9,!1);this.mxc=this.contentControlNode.ja(Mc.a.x5b,!1);this.qxc=this.contentControlNode.ja(Mc.a.OCb,!1);this.g3g=this.contentControlNode.ja(Mc.a.Rga,
!1);this.wWb=this.contentControlNode.ja(Mc.a.MCb,null);this.mkd=this.contentControlNode.ja(Mc.a.fId,!1);this.Oxd=this.Mg.Gq(this.contentControlNode.id,!0);this.Vkd=this.Mg.Gq(this.contentControlNode.id,!1);this.wpd=this.contentControlNode.ja(Mc.a.sJh,!1);this.vpd=this.contentControlNode.ja(Mc.a.rJh,!1);this.mvd=this.contentControlNode.ja(Mc.a.oJh,!1);this.fk=Object(rx.b)(this.contentControlNode.ja(Mc.a.xgb,"RichText"));let b=null;try{const h=this.contentControlNode.ja(Mc.a.t8,V.a.nil);if(V.a.Dq(h,
V.a.nil))this.XAc=0;else if(b=this.rj.Eb(h))this.XAc=b.ja(Mc.a.Zw,0)}catch(h){this.XAc=0}this.TYo()}TYo(){if(this.zAb){var b=this.contentControlNode.ja(Mc.a.POa,"");if((b=this.pfa.tki(b))&&0<b.length){this.fud=this.c5h(b.Pa,b.Tc);return}}this.fud=(b=this.Tg.Gwa())&&b.currentNode?b.currentNode.ja(Mc.a.OJc,null):null}oU(b=!0){if(!b||this.isValid())b=this.contentControlNode.ja(Pd.a.lastModifiedTime,new Date(0)),this.x4g!==b?(t.ULS.sendTraceTag(520734535,368,50,"Last Modified Time was used to update Properties"),
this.Fdd(),this.x4g=b):t.ULS.sendTraceTag(520734534,368,50,"Last Modified was NOT used but updateProperties would run if Last Modified was removed.")}VZo(b,h){this.Oxd=b;this.Vkd=h;this.Mg.sE(this.contentControlNode.id,b,!0);this.Mg.sE(this.contentControlNode.id,h,!1)}YHj(){if(this.contentControlNode){var b=this.yu,h=this.Dz;if(!b||!h||b.equals(V.a.nil)||h.equals(V.a.nil))t.ULS.sendTraceTag(17330978,368,10,"StartObjectId/EndObjectId are not initialized before trying to update Start/End contexts.");
else if(b=this.Tg.voa(b,!0),h=this.Tg.voa(h,!1),b&&h)if(b.isConnected&&h.isConnected||t.ULS.sendTraceTag(37777626,368,10,"StartParaNode/EndParaNode are not connected."),this.Jf)b=Ue.a.create(b),this.qr.qdd(b,this.objectId,!0),this.start=b,b=Ue.a.create(h),this.qr.qdd(b,this.objectId,!0),this.end=b;else{let r=h=-1;if(b.qa){for(let B=0;B<b.qa.length&&(-1===h||-1===r);B++){const P=b.qa.J(B);if(P.Jb)for(let ca=0;ca<P.Jb.length&&(-1===h||-1===r);ca++){const ra=P.Jb.J(ca);V.a.Dq(ra.me,this.objectId)&&(ra.Oc?
h=P.cp:r=P.cp)}}0<=h&&0<=r&&(b=Ue.a.HO(h,r,!1,b),this.qr.qdd(b,this.objectId,!0),this.start=this.end=b)}}}}getText(){let b="";var h=this.start;const r=this.end;if(!h||!r)return b;this.Jf?b=this.c5h(h,r):(h=ke.ParagraphReader.text(h.node).substring(h.cpBegin,r.cpEnd),b+=oi.AParagraphNode.UP(h));return b}isValid(){return!!this.contentControlNode&&this.contentControlNode.isConnected}Qhe(b){return this.kga?this.km.coj(this,b)?0:2:2}clear(){return this.kga?this.km.coj(this,"")?0:2:2}V6h(){const b=new mb.a;
var h=this.contentControlNode.ja(Mc.a.contentControlNode,[]);for(const r of h)if(!V.a.Dq(r,V.a.nil)){h=this.ji.value.Eb(r);try{b.add(this.J2.aDb(h,this.Cx,this.ji,this.Tg,this.qr,this.km,this.pfa,this.kga,this.zAb))}catch(B){}}return b}Vnf(){const b=new mb.a;this.U4h(this,b);return b}U4h(b,h){b=b.V6h();if(b.count)for(const r of b)h.add(r),this.U4h(r,h)}lF(b=!1){const h=new mb.a;if(this.Jf){var r=this.km.sU(this.start,this.end);for(var B of r)r=Ue.a.create(B),this.qr.qdd(r,this.objectId,b),h.add(r)}else B=
this.start.clone(),this.qr.qdd(B,this.objectId,b),h.add(B);return h}sdd(b){const h=this.km.sU(this.start,this.end);for(let r=0;r<h.count;r++){const B=this.qr.vpf(h.J(r),this.objectId,!1);if(B){for(let P=0;P<B.count;P++)b(B.J(P));h.J(r).jk()}}}c5h(b,h){const r=new Sys.StringBuilder;h=this.km.sU(b,h);for(const B of h)B.id.equals(b.node.id)||r.append("\r"),r.append(ke.ParagraphReader.Uda(B));return r.toString()}}Object(m.a)(qy,"ContentControl",null,[448]);class nt{constructor(b){this.Mg=b}aDb(b,h,r,
B,P,ca,ra,Qa,tb){return new qy(b,h,r,B,P,ca,this,ra,Qa,tb,this.Mg)}}Object(m.a)(nt,"ContentControlFactory",null,[431]);class sx{constructor(b,h,r,B,P){this.ji=b;this.qr=h;this.wmk=r;this.YW=B;this.Ca=P}pVo(b,h,r){var B,P;if(!(zm.a.I$e&&b&&h&&r))return!1;const ca=b.contentControlNode;if(!ca)return!1;var ra=ca.ja(Mc.a.PCb,V.a.nil);ra&&!ra.equals(V.a.nil)?b=this.ji.value.Eb(ra):(b=this.qr.tRc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0),b=null===(B=null===b||void 0===b?void 0:b.formatting)||void 0===
B?void 0:B.Jn,b||(b=new Zz.a,this.ji.value.Uu(b,null)),ca.setValue(Mc.a.PCb,b.id));B=this.ji.value.Eb(b.id);ra="boolean"===typeof r&&r;const Qa=null===(P=this.Ca)||void 0===P?void 0:P.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextFormattingOpEnabled",!1);h=this.wmk.brf(ca,B,h,r,Qa?null:ra);h=this.YW.jpe(h);for(const [tb,Mb]of h)b.setValue(tb,Mb);return!0}}Object(m.a)(sx,"ContentControlFormattingManager",null,[430]);var lC=c(940);class Ks{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc){this.Cx=
b;this.ji=h;this.Yc=r;this.Rxb=B;this.m_j=P;this.FK=ca;this.rh=ra;this.gb=Qa;this.Ctd=tb;this.pmd=Mb;this.Mg=Zb;this.RCe=jc;this.pfa=Gc}get ox(){return this.Cx.value}Gwa(){const b=this.Yc.Ek();b.set(this.ox);this.Rxb.IP(b);if(b.Ub(25))return b;this.pmd.instance&&this.pmd.instance.wpa&&t.ULS.sendTraceTag(17040640,368,10,"Content Control root node doesn't exist");t.ULS.sendTraceTag(528537619,368,15,"getContentControlRootIterator() returning null");return null}JQc(b,h,r=!1){this.X7b();const B=new mb.a;
let P;if(b){P=b.Ub(26);if(!P)return B;for(;P&&(!h(P)||(B.add(P),!r));){B.addRange(this.JQc(b,h));if(r&&0<B.count)break;P=b.Mf(26)}b.uc()}return B}x8l(){const b=this.Yc.Ek();b.set(this.Cx.value);this.Rxb.IP(b);return b.currentNode}FRa(b,h,r){let B;B=b.equals(h);B||(B=(b=this.voa(b,r))?b.id.equals(h):!1);return B}OPa(b,h){b=this.pu(b);if(!b)return null;let r=null;for(;55===b.type;){const B=this.Mg.Gq(b.id,h);if(B.equals(r)){b=null;break}else b=this.pu(B);r=B}return b}voa(b,h){return(b=this.OPa(b,h))?
ke.ParagraphReader.Xb(b)?b:h?this.gb.al(b):this.gb.$C(b):null}pRh(b,h=!1){this.uUo(b);this.qRh(b,h)}uUo(b){var h=this.Fwa(b);h=this.Fwa(h.parentNode);h=55===h.currentNode.type?h.currentNode.id:null;let r,B;r=this.pu(this.Mg.Gq(b.id,!0));for(B=this.pu(this.Mg.Gq(b.id,!1));r&&55===r.type;)r=this.pu(this.Mg.Gq(r.id,!0));for(;B&&55===B.type;)B=this.pu(this.Mg.Gq(B.id,!1));r&&B&&this.xFj(r.id,B.id,h,P=>{P=P.ja(Mc.a.EX,V.a.nil);return!P||P.equals(V.a.nil)||b.id.equals(P)})}qRh(b,h=!1){t.ULS.sendTraceTag(528537620,
368,50,"Attempting to delete content control node");var r=this.Fwa(b);const B=this.Fwa(r.parentNode);let P=V.a.nil,ca=V.a.nil;var ra=B.currentNode.ja(Mc.a.contentControlNode,[]);const Qa=new mb.a;for(var tb=0;tb<ra.length;tb++)Qa.add(ra[tb]);if(h){if(54!==B.currentNode.type){P=this.Mg.Gq(B.currentNode.id,!0);ca=this.Mg.Gq(B.currentNode.id,!1);ra=this.pu(P);for(tb=this.pu(ca);ra&&55===ra.type;)P=this.Mg.Gq(ra.id,!0),ra=this.pu(P);for(;tb&&55===tb.type;)ca=this.Mg.Gq(tb.id,!1),tb=this.pu(ca)}ra=this.Fwa(b);
if(ra.Ub(26)){tb=new mb.a;for(tb.add(ra.currentNode);ra.Mf(26);)tb.add(ra.currentNode);for(var Mb of tb)this.qRh(Mb,h)}}else if(P=this.Mg.Gq(b.id,!0),ca=this.Mg.Gq(b.id,!1),h=this.d1l(Qa,b.id),Mb=this.Fwa(b),Mb.Ub(26)){ra=this.Fwa(Mb.currentNode);tb=ra.currentNode;let Zb=b;for(;tb;){const jc=Mb.currentNode;Qa.insert(h++,jc.id);tb=ra.Mf(26);const Gc=this.Fwa(jc);54!==B.currentNode.type?jc.setValue(Mc.a.t8,B.currentNode.id):jc.removeProperty(Mc.a.t8);fp.h(Gc,B,Zb,26);Zb=Gc.currentNode;tb&&(Mb.set(tb),
Mb.e2(this.Gwa().currentNode))}}54!==B.currentNode.type&&(h=this.Mg.Gq(B.currentNode.id,!0),Mb=this.Mg.Gq(B.currentNode.id,!1),h.equals(b.id)&&this.Mg.sE(B.currentNode.id,P,!0),Mb.equals(b.id)&&this.Mg.sE(B.currentNode.id,ca,!1));r.zg();t.ULS.sendTraceTag(528537621,368,50,"Disconnected nodeToDelete");this.remove(Qa,b.id);ra=Array(Qa.count);for(r=0;r<Qa.count;r++)ra[r]=Qa.J(r);B.currentNode.setValue(Mc.a.contentControlNode,ra);lC.a.aHa(b.id)}ask(b,h,r,B,P,ca,ra=null){let Qa;if(h){var tb=this.pu(h.objectId);
Qa=this.Fwa(tb)}else Qa=this.Gwa(),tb=Qa.currentNode;const Mb=this.m_j.create(1074135145);ra&&Mb.properties.ax(ra.properties);54!==tb.type&&Mb.setValue(Mc.a.t8,tb.id);ra?Qa.AIb(Mb,r,26,ra.id):Qa.ZH(Mb,r,26);zm.a.LCb?(this.ZHj(b,Mb.id,P,!0),this.ZHj(b,Mb.id,ca,!1)):(this.Mg.sE(Mb.id,P,!0),this.Mg.sE(Mb.id,ca,!1));b.Jf&&(h&&(r=this.Mg.Gq(tb.id,!0),ra=this.Mg.Gq(tb.id,!1),r.equals(P)&&this.Mg.sE(tb.id,Mb.id,!0),ra.equals(ca)&&this.Mg.sE(tb.id,Mb.id,!1)),this.xFj(P,ca,Mb.id,Zb=>{Zb=Zb.ja(Mc.a.EX,V.a.nil);
const jc=h?h.objectId:null;return!Zb||Zb.equals(V.a.nil)||Zb.equals(jc)}));P=this.Fwa(Mb);ca=Array(B.count);for(tb=B.count-1;0<=tb;tb--)ca[tb]=B.J(tb).objectId,r=this.pu(B.J(tb).objectId),r=this.Fwa(r),r.currentNode.setValue(Mc.a.t8,Mb.id),fp.h(r,P,null,26);0<ca.length&&Mb.setValue(Mc.a.contentControlNode,ca);Ks.Zb.isFeatureEnabled(38)&&(b.KLd&&Mb.setValue(Mc.a.MCb,b.KLd),b.Agf&&Mb.setValue(Mc.a.fId,!0));return Mb}ZHj(b,h,r,B){12===this.pu(r).type?this.Mg.sE(h,r,B):(this.Mg.pqg(h,r,B),this.Mg.sE(h,
B?b.start.node.id:b.end.node.id,B))}Xho(b,h,r,B,P){b.setValue(Mc.a.u9,h);b.setValue(Mc.a.x5b,!0);b.setValue(Mc.a.OCb,!0);b.setValue(Mc.a.Zw,r);b.setValue(Mc.a.ugb,Et[0]);b.setValue(Mc.a.Rga,!0);b.setValue(Mc.a.xgb,rx.a[P]);B&&b.setValue(Mc.a.wrb,B);b.setValue(Mc.a.y5b,0)}yFj(b,h=null,r=null){h&&this.Mg.sE(b,h,!0);r&&this.Mg.sE(b,r,!1)}FRh(b){if(!b||!b.count||!b.J(0))return null;const h=this.Mtf(b);for(let r=0;r<b.count;r++)this.rh.kza(b.J(r));return h}Mtf(b){if(!b||!b.J(0))return null;const h=this.Yc.Ek();
h.set(b.J(0));h.qd();h.uc();return h.FJ()?h.currentNode:null}I9l(b){const h=this.Yc.Ek();h.set(b);h.qd();h.uc();h.uc();return h}yph(b,h,r){const B=new mb.a;for(let P=0;P<r;P++){h=this.FK.Fkb(b,h,!0,null);if(!h||!b.Rd())return null;const ca=b.currentNode;b.uc();b.uc();B.add(ca)}return B}gac(b){const h=this.Yc.Ek();h.set(b);for(h.zb(7);h.uc();)switch(h.currentNode.type){case 8:case 16:case 36:case 40:return h.currentNode.id}return null}Wdi(b){const h=this.Yc.Ek();h.set(b);h.qd();return(b=h.bUa())?b.id:
null}Qrf(b){const h=this.Yc.Ek();h.set(b);return h.zb(7)?h:null}pu(b){return this.ji.value.Eb(b)}X7b(){if(!Ks.E0g){var b=this.Gwa();b&&this.Ing(b);Ks.E0g=!0}}NUa(b){return this.Ctd.NUa(b)}xAk(b,h){const r=this.Yc.Ek();r.set(b.node);const B=this.Yc.Ek();B.set(h.node);r.qd();B.qd();const P=this.Yc.Ek();P.set(r.currentNode);const ca=this.Yc.Ek();ca.set(B.currentNode);const ra=Kf.returnToLowestCommonTableCell(r,B);return ra?(P.qd(),ca.qd(),{returnValue:({ul:b}=this.nCb(P,!0,ra,b)).returnValue&&({ul:h}=
this.nCb(ca,!1,ra,h)).returnValue,Pad:b,fNc:h}):{returnValue:({ul:b}=this.nCb(r,!0,null,b)).returnValue&&({ul:h}=this.nCb(B,!1,null,h)).returnValue,Pad:b,fNc:h}}nCb(b,h,r,B){let P=null,ca=b.jd(16);for(;ca!==r;){if(h&&Ah.TableCellReader.qyi(b)||!h&&Ah.TableCellReader.$Ff(b))P=b.jd(14);else return{returnValue:!1,ul:B};ca=b.jd(16)}P&&(B=Ue.a.create(P));return{returnValue:!0,ul:B}}Ing(b){if(b.Ub(26)){for(this.Ing(b);b.Mf(26);)this.Ing(b);b.uc()}}remove(b,h){for(let r=0;r<b.count;r++)if(b.J(r).toString()===
h.toString()){b.removeAt(r);break}}Fwa(b){const h=this.Yc.Ek();h.set(b);h.e2(this.Gwa().currentNode);return h}d1l(b,h){for(let r=0;r<b.count;r++)if(b.J(r).equals(h))return r;return-1}xFj(b,h,r,B){b=this.VSl(b,h);for(h=0;h<b.count;h++)B(b.J(h))&&(r?b.J(h).setValue(Mc.a.EX,r):b.J(h).removeProperty(Mc.a.EX),this.pmd.instance&&this.pmd.instance.wwi&&b.J(h).ol(16,!0))}VSl(b,h){const r=new mb.a;var B=this.pu(b);const P=this.pu(h);if(!B||!P)return r;const ca=({OZc:ra}=this.kQd(B,P)).returnValue;B=ra[ca];
if(14===B.type)r.add(B);else if(15===B.type&&1<=ca){const Qa=ra[ca-1];1===Rh.TableReader.gg(Qa)&&r.add(Qa)}var ra=Ad.GraphIterator.eb(ca>=ra.length-1?B:ra[ca+1]);ra.zb(7);for(B=Ab.a.Gs(ra,B);B.moveNext()&&B.currentNode!==P;)14===B.currentNode.type&&r.add(B.currentNode);if(!V.a.Dq(h,b)&&14===P.type)for(ra=Ad.GraphIterator.eb(P),B=Ab.a.Gs(ra,P);B.moveNext();)14===B.currentNode.type&&r.add(B.currentNode);return r}kQd(b,h){b=this.Hib(b);h=this.Hib(h);let r=0;for(;r<b.length&&r<h.length&&b[r]===h[r];++r);
return{returnValue:0<r?r-1:r,OZc:b,rag:h}}Hib(b){const h=[];h.push(b);b=Ad.GraphIterator.eb(b);for(b.zb(7);b.uc();)h.push(b.currentNode);h.reverse();return h}static get Zb(){return null!=Ks.ezg?Ks.ezg:Ks.ezg=Ma.a.instance.Oa("Box4.IFeatureHelper")}BKc(b,h,r=!1){b=this.RCe.instance.Gcl(b);r?(r=$m.a.kjl,b.setValue(Mc.a.nac,r)):r=b.ja(Mc.a.nac,null);h.setValue(Mc.a.POa,r)}j_k(b,h){this.y2i(b)&&(b=b.ja(Mc.a.POa,null),b=this.RCe.instance.m_k(b).ja(Mc.a.nac,null),h.setValue(Mc.a.POa,b))}gGj(b,h){if(!this.y2i(h))return!1;
var r=h.ja(Mc.a.POa,null);r?tz(h)?this.BKc(b,h):this.RCe.instance.UYo(r,b):(r=this.pfa.J8h())?h.setValue(Mc.a.POa,r):this.BKc(b,h,!0);return!0}y2i(b){if(!b)return!1;var h=b.getValue(Mc.a.xgb);if(!h)return!1;h=Object(rx.b)(h);b=b.getValue(Mc.a.MCb);return(0==h||1==h)&&b!==yi.sUh}}Ks.E0g=!1;Object(m.a)(Ks,"ContentControlGraphManager",null,[428]);class eu{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb){this.dxe=Mb;this.Yka=null;this.zRm=(Zb,jc)=>{if(this.xY)return this.ARm(Zb,jc);if(!Zb||!Zb.count)return t.ULS.sendTraceTag(17356048,
368,15,"The GNC list should not be null or empty"),!1;let Gc=!0;switch(jc){case 0:jc=this.jL(Zb.J(0),Zb.J(Zb.count-1),1);if((Zb=this.jL(Zb.J(0),Zb.J(Zb.count-1),3))&&0<Zb.count){if(!Zb.J(0).isSupported||!Zb.J(0).isEditable){Gc=!1;break}for(Zb=Zb.J(0);Zb;)this.G6c(jc,Zb.id),Zb=this.getById(Zb.parentId)}if(jc)for(var Uc of jc)if(!Uc.isSupported||!Uc.isEditable){Gc=!1;break}break;case 1:if(Zb.J(0).contextId!==yc.a.Uc){t.ULS.sendTraceTag(17356049,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.Inserting");
Gc=!1;break}(jc=this.jL(Zb.J(0),Zb.J(0),1))&&0<jc.count&&(Gc=!1);break;case 2:if(Zb.J(0).contextId!==yc.a.Uc){t.ULS.sendTraceTag(17424994,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary");Gc=!1;break}(jc=this.jL(Zb.J(0),Zb.J(0),3))&&0<jc.count&&(Gc=!1);break;case 3:case 4:jc=this.uSd(Zb.J(0),!0);Uc=this.uSd(Zb.J(Zb.count-1),!1);if(!jc||!Uc){t.ULS.sendTraceTag(17356050,368,15,"The GNC list is not supported for ApiOperation.Clearing or ApiOperation.Replacing");
Gc=!1;break}if((jc=this.jL(jc,jc,3))&&0<jc.count){Gc=!1;break}if((jc=this.jL(Uc,Uc,3))&&0<jc.count){Gc=!1;break}if(jc=this.km.jL(Zb.J(0),Zb.J(Zb.count-1),1))for(const od of jc)if(!od.nia){Gc=!1;break}break;default:Gc=!1}return Gc};eu.Cx=b;eu.ji=h;this.Tg=r;this.qr=B;this.km=P;this.J2=ca;this.pfa=ra;this.Qf=Qa;this.Lo=tb}get iRa(){return!!this.Qf.instance&&this.Qf.instance.iRa}get wpa(){return!!this.Qf.instance&&this.Qf.instance.wpa}get yZd(){return!!this.Qf.instance&&this.Qf.instance.yZd}get xY(){return!!this.Qf.instance&&
this.Qf.instance.xY}get BZd(){return!!this.Qf.instance&&this.Qf.instance.BZd}cJb(){return!!this.Qf.instance&&this.Qf.instance.cJb}Pma(b,h,r=null,B=null,P=!1){if(!this.iRa)return{returnValue:2,id:0};b=this.Tg.voa(b,!0);h=this.Tg.voa(h,!1);if(!b||!h)return{returnValue:2,id:0};b=Ue.a.create(b);h=Ue.a.create(h);return this.koh(b,h,r,B,P,0,!1)}grk(b,h,r=0,B=!1){return this.iRa&&b&&h?this.koh(b,h,null,null,!1,r,B):{returnValue:2,id:0}}v_a(b,h=null,r=0,B=!1){let P=0;if(!this.iRa)return{returnValue:2,id:P};
const ca=this.J2.aDb(h,eu.Cx,eu.ji,this.Tg,this.qr,this.km,this.pfa,this.iRa,this.yZd);ca.type=r;ca.start=b;ca.end=b;ca.yu=b.node.id;ca.Dz=b.node.id;ca.Jf=!1;return this.km.lph(ca,h,B)?(P=ca.id,{returnValue:0,id:P}):{returnValue:2,id:P}}$rk(b,h=null){if(!this.iRa||!this.NNm(b))return{returnValue:2,id:0};var r=b.J(0).contextId===yc.a.Vc?b.J(1):b.J(0);const B=b.J(b.count-1);if(this.p$e(b,yc.a.paragraph)||this.p$e(b,yc.a.Vc)){b=r.node.id;let P=B.node.id;const ca=b.equals(P);r=this.km.evj(r,!0);void 0!==
r&&null!==r&&(b=r,P=ca?b:P);this.km.evj(B,!1);h.setValue(Mc.a.u9,!0);return this.Pma(b,P,h)}return r!==B||r.contextId!==yc.a.Fd&&r.contextId!==yc.a.Uc?{returnValue:2,id:0}:(h.setValue(Mc.a.u9,!1),this.v_a(r,h))}getById(b){if(!this.wpa)return null;const h=this.Tg.JQc(this.Tg.Gwa(),r=>r.getValue(Mc.a.Zw)===b,!0);return 0<h.count?this.km.qR(h.J(0)):null}getByTitle(b){if(!this.wpa)return null;const h=this.Tg.JQc(this.Tg.Gwa(),B=>B.ja(Mc.a.tgb,null)===b,!1),r=new mb.a;for(const B of h)r.add(this.km.qR(B));
return r}getByTag(b){if(!this.wpa)return null;const h=this.Tg.JQc(this.Tg.Gwa(),B=>B.ja(Mc.a.wgb,null)===b,!1),r=new mb.a;for(const B of h)r.add(this.km.qR(B));return r}jL(b,h,r,B=!1){return this.wpa?this.xY?this.km.xoa(b,h,r):this.km.jL(b,h,r,B):null}sU(b,h){return this.km.sU(b,h)}gNl(){if(!this.wpa)return null;const b=this.Tg.JQc(this.Tg.Gwa(),()=>!0,!1),h=new mb.a;for(const r of b)h.add(this.km.qR(r));return h}VOb(b){if(!this.iRa)return t.ULS.sendTraceTag(528537618,368,15,"Cannot release content control, isContentControlWriteEnabled = false"),
2;b=this.getById(b);return this.km.hza(b)?0:2}rkl(b){if(!this.iRa)return 2;b=this.getById(b);return this.km.deleteContentControl(b)?0:2}rsk(b){this.km.C9i(b)}AKk(b){this.Yka=b;this.Yka.kXn(this.zRm)}iTl(b){if(!this.cJb())return null;let h;var r=b.lF();h=this.uSd(r.J(r.count-1),!1);r=this.qr.tRc(r.J(r.count-1).node,h.cpBegin).Jb;b=this.qhm(r,b);if(-1===b)return null;h.Fb=b;h.Sb=h.Fb;return h}ARm(b,h){if(!b||!b.count)return t.ULS.sendTraceTag(21031131,368,15,"The GNC list should not be null or empty"),
!1;switch(h){case 0:return this.XLm(b);case 3:case 4:case 6:return this.zTm(b,6===h);case 1:case 2:case 5:return 1!==b.count||b.J(0).contextId!==yc.a.Uc?(t.ULS.sendTraceTag(21031132,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary"),!1):this.ozi(b.J(0),5===h,!1);default:return!1}}XLm(b){const h=this.km.xoa(b.J(0),b.J(b.count-1),3);if(h&&0<h.count){var r=h.J(0);if(!r.isSupported||!r.isEditable)return!1}b=this.km.xoa(b.J(0),b.J(b.count-1),
1);for(r=0;h&&r<h.count;r++)this.G6c(b,h.J(r).id);if(b)for(const B of b)if(!B.isSupported||!B.isEditable)return!1;return!0}zTm(b,h){var r=b.J(0),B=b.J(b.count-1),P=r.Wj,ca=B.vp;if(-1===P||-1===ca)return!1;P=this.Lo.b9(r.node,P,r.Fb);ca=this.Lo.b9(B.node,ca,B.Sb);var ra=-1,Qa=Math.min(P.count,ca.count);for(--Qa;0<=Qa;Qa--){const tb=P.J(Qa).me,Mb=ca.J(Qa).me;if(tb.equals(Mb)){ra=Qa;break}}if(-1<ra&&(Qa=this.km.qR(P.J(ra).contentControlNode),!Qa.isEditable||!Qa.isSupported||Qa.NJ&&!this.zLm(Qa,b)))return!1;
r=this.km.xoa(r,B,1);for(B=0;B<=ra;B++)this.G6c(r,this.km.qR(P.J(B).contentControlNode).id);for(B=ra+1;B<P.count;B++){Qa=this.km.qR(P.J(B).contentControlNode);if(!Qa.isEditable||!Qa.nia||!Qa.isSupported||Qa.NJ)return!1;this.G6c(r,Qa.id)}for(P=ra+1;P<ca.count;P++){ra=this.km.qR(ca.J(P).contentControlNode);if(!ra.isEditable||!ra.nia||!ra.isSupported||ra.NJ)return!1;this.G6c(r,ra.id)}if(r)for(const tb of r)if(!tb.isSupported||!tb.nia)return!1;return h&&(b=this.uSd(b.J(0),!0))?this.ozi(b,!0,!0):!0}zLm(b,
h){h=this.Lo.E9l(h.J(0),h.J(h.count-1));return!!b&&!!h&&b.objectId.equals(h.me)}ozi(b,h,r){return(b=this.km.xoa(b,b,3))&&0<b.count&&(b=b.J(0),!b.isSupported||!b.isEditable||!this.BZd&&h&&!b.Jf||!r&&b.NJ||zm.a.k1f&&h&&1===b.type)?!1:!0}uSd(b,h){if(!b)return null;let r=null;switch(b.contextId){case yc.a.paragraph:r=h?Ue.a.Rc(b.node,0):Ue.a.tw(b.node);break;case yc.a.Vc:r=Ue.a.tw(b.node);break;case yc.a.Fd:r=h?Ue.a.Rc(b.node,b.cpBegin):Ue.a.Rc(b.node,b.cpEnd);break;case yc.a.Uc:r=b}r&&(r.Sb=r.Fb=h?b.Fb:
b.Sb);return r}G6c(b,h){if(b)for(const r of b)if(r.id===h){b.remove(r);break}}qhm(b,h){if(!b)return-1;let r=-1;for(let B=0;B<b.length;B++)if(b.J(B).me.equals(h.objectId)&&!1===b.J(B).Oc){r=B;if(h.Jf&&0<B&&b.J(B-1).Jf&&!b.J(B-1).Oc)return-1;break}return r}NNm(b){if(void 0===b||null===b)return!1;for(let h=0;h<b.count;h++){const r=b.J(h).contextId;if(r!==yc.a.paragraph&&r!==yc.a.Vc&&r!==yc.a.Fd&&r!==yc.a.Uc||0<h&&h<b.count-1&&r===yc.a.Fd&&(b.J(h).cpBegin||b.J(h).cpEnd!==b.J(h).node.characterData.length))return!1}return b.J(0).contextId===
yc.a.Vc&&1===b.count||this.p$e(b,yc.a.Uc)&&1<b.count?!1:!0}p$e(b,h){for(const r of b)if(r.contextId===h)return!0;return!1}koh(b,h,r=null,B=null,P=!1,ca=0,ra=!1){let Qa=0;var tb=h.node;let Mb=Ue.a.create(b.node);tb=Ue.a.create(tb);if(zm.a.LCb){if(!({Pad:Mb,fNc:tb}=this.dxe.hEh(Mb,tb)).success)return{returnValue:2,id:Qa}}else if(!({Pad:Mb,fNc:tb}=this.Tg.xAk(Mb,tb)).returnValue)return{returnValue:2,id:Qa};const Zb=this.J2.aDb(r,eu.Cx,eu.ji,this.Tg,this.qr,this.km,this.pfa,this.iRa,this.yZd);Zb.type=
ca;Zb.start=b;Zb.end=h;Zb.yu=Mb.node.id;Zb.Dz=tb.node.id;Zb.Jf=!0;Zb.KLd=B;Zb.Agf=P;return this.km.lph(Zb,r,ra)?(Qa=Zb.id,{returnValue:0,id:Qa}):{returnValue:2,id:Qa}}}eu.Cx=null;eu.ji=null;Object(m.a)(eu,"ContentControlManager",null,[427]);var tx=c(632),OC=c(146),Fu=c(193);class jB extends Sys.EventArgs{constructor(b){super();this.NPh=b}}Object(m.a)(jB,"ContentControlChangeEventArgs",Sys.EventArgs,[]);var PC=c(1513);class QC{constructor(){this.VRi=0;this.U0i=null}}Object(m.a)(QC,"BypassIfNodeOfTypeAndParentMatchingConditionFilterData",
null,[]);const ry=b=>!(null===b||void 0===b?0:b.length),fu=b=>null==b?!1:[...b].some(h=>h.Oc),mC=b=>null==b?!1:[...b].some(h=>!h.Oc);class Nr{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc,Uc,od,Od,ze,de,ee,je,ue,Qf,Jg,Ql,Fm){this.Ej=Ql;this.vch=[];this.IPe=[];this.Cx=b;this.ji=h;this.Tg=r;this.qr=B;this.J2=P;this.De=tb;this.qz=Mb;this.hb=ca;this.NE=ra;this.hCa=Qa;this.pfa=Uc;this.zAb=od;this.kga=Zb;this.CI=jc;this.ga=Gc;this.Lo=Od;this.Qf=ze;this.Ah=de;this.gb=ee;this.Lc=je;this.Plh=ue;this.rd=Qf;
this.Mg=Jg;this.CI&&(this.CI.addHandler(tx.a.UOb,Object(z.a)(this,this.CYi,"onShowingPlaceholder")),this.CI.addHandler(tx.a.Lde,Object(z.a)(this,this.KXi,"onRemoveWhenEdited")),Fm.execute(Kp=>{this.LE=Kp}))}get ox(){return this.Cx.value}get rj(){return this.ji.value}get xY(){return!!this.Qf.instance&&this.Qf.instance.xY}get L0(){return!!this.rd&&this.rd.isFeatureEnabled(31)}dispose(){this.CI&&(this.CI.removeHandler(tx.a.UOb,Object(z.a)(this,this.CYi,"onShowingPlaceholder")),this.CI.removeHandler(tx.a.Lde,
Object(z.a)(this,this.KXi,"onRemoveWhenEdited")))}jL(b,h,r,B=!1){if(this.xY)return this.xoa(b,h,r);if(!b||!h)return null;const P=this.Tg.voa(b.node.id,!0);var ca=this.Tg.voa(h.node.id,!1);if(!P||!ca)return null;b=b.contextId===yc.a.Vc?b:Ue.a.Rc(P,-1===b.cpBegin?0:b.cpBegin);h=h.contextId===yc.a.Vc?h:Ue.a.Rc(ca,-1===h.cpEnd?ca.characterData.length:h.cpEnd);ca=null;switch(r){case 0:ca=this.tXl(b,h);break;case 1:ca=this.O9l(b,h);break;case 3:ca=this.Bei(b,h,B);break;case 2:ca=this.sim(b,h);break;case 4:ca=
this.zpf(b,h,!1)}return ca}xoa(b,h,r){if(!b||!h||b.contextId!==yc.a.Vc&&(b=this.SJh(b,!0),!b)||h.contextId!==yc.a.Vc&&(h=this.SJh(h,!1),!h))return null;let B=null;switch(r){case 0:B=this.uXl(b,h);break;case 1:B=this.P9l(b,h);break;case 3:B=this.Cei(b,h);break;case 2:B=this.tim(b,h);break;case 4:B=this.zpf(b,h,!0)}return B}SJh(b,h){var r=this.Tg.voa(b.node.id,h);if(!r)return null;h?(h=-1===b.cpBegin?0:b.cpBegin,b=b.Fb):(h=-1===b.cpEnd?r.characterData.length:b.cpEnd,b=b.Sb);r=Ue.a.Rc(r,h);r.Fb=b;r.Sb=
b;return r}tXl(b,h){const r=new mb.a;if(b.contextId===yc.a.Vc||h.contextId===yc.a.Vc||b.equals(h))return r;const B=new lo.a,P=this.LFb(b,b),ca=this.LFb(h,h);for(let ra=0;ra<P.count;ra++)if(P.J(ra).Oc)for(let Qa=0;Qa<ca.count;Qa++)ca.J(Qa).Oc||P.J(ra).me.equals(ca.J(Qa).me)&&(!P.J(ra).Jf||this.Tg.FRa(P.J(ra).me,b.node.id,!0)&&this.Tg.FRa(ca.J(Qa).me,h.node.id,!1))&&this.CBd(r,B,P.J(ra).me);return r}uXl(b,h){const r=new mb.a;if(b.contextId===yc.a.Vc||h.contextId===yc.a.Vc||b.equals(h)&&b.Fb===b.Sb||
-1===b.Fb||-1===h.Sb)return r;var B=b.node.qa.nh(b.cpBegin),P=h.node.qa.nh(h.cpEnd);B&&B.Jb&&0<B.Jb.length&&b.Fb<=B.Jb.length&&P&&P.Jb&&0<P.Jb.length&&h.Sb<=P.Jb.length&&(b=b.Fb,h=h.Sb,b===B.Jb.length&&b--,0<h&&h--,B=B.Jb.J(b),P=P.Jb.J(h),B.Oc&&!P.Oc&&V.a.Dq(B.me,P.me)&&B.zp&&P.zp&&(P=B.contentControlNode)&&r.add(this.qR(P)));return r}O9l(b,h){const r=new mb.a,B=new lo.a,P=this.LFb(b,h);for(let ca=0;ca<P.count;ca++)this.CBd(r,B,P.J(ca).me);b=this.Bei(b,h,!1,!1);for(const ca of b)B.contains(ca.objectId)||
(r.add(ca),B.add(ca.objectId));return r}P9l(b,h){const r=new mb.a,B=new lo.a,P=this.Hof(b,h);for(let ca=0;ca<P.count;ca++)this.GZe(r,B,P.J(ca));b=this.Cei(b,h);for(const ca of b)B.contains(ca.objectId)||(r.add(ca),B.add(ca.objectId));return r}Bei(b,h,r,B=!0){const P=new mb.a;b.equals(h)&&(r=!1);const ca=new lo.a;let ra=!1;b=this.LFb(null,b,!0,r);h=this.LFb(h,null,r,!0);for(r=b.count-1;0<=r;r--){for(let Qa=0;Qa<h.count&&!(b.J(r).me.equals(h.J(Qa).me)&&(b.J(r),this.CBd(P,ca,b.J(r).me)&&(ra=!this.Tg.pu(b.J(r).me).ja(Mc.a.t8,
null),B||ra)));Qa++);if(0<P.count&&(B||ra))break}return P}Cei(b,h){const r=new mb.a,B=new lo.a,P=b.node;var ca=h.node;const ra=h.contextId===yc.a.Vc?ca.characterData.length:h.cpEnd;b=this.Lo.b9(P,b.contextId===yc.a.Vc?P.characterData.length:b.cpBegin,b.Fb);h=this.Lo.b9(ca,ra,h.Sb);ca=b.count>h.count?h.count:b.count;for(--ca;0<=ca;ca--)b.J(ca).me.equals(h.J(ca).me)&&this.GZe(r,B,b.J(ca));return r}sim(b,h){const r=new mb.a;let B=new lo.a;const P=this.LFb(b,h);let ca=0,ra=null;if(b.equals(h))return r;
for(b=0;b<P.count;b++)!P.J(b).Oc||P.J(b).Jf&&!this.Tg.FRa(P.J(b).me,P.J(b).Lb.paragraph.id,!0)?P.J(b).Oc||P.J(b).Jf&&!this.Tg.FRa(P.J(b).me,P.J(b).Lb.paragraph.id,!1)||(ca--,0>ca?(ca=0,B=new lo.a):!ca&&ra&&P.J(b).me.equals(ra)&&this.CBd(r,B,ra)):(ca||(ra=P.J(b).me),ca++);return r}tim(b,h){const r=new mb.a;if(b.equals(h)&&b.Fb===h.Sb)return r;let B=new lo.a;b=this.Hof(b,h);h=0;let P=null;for(let ca=0;ca<b.count;ca++){const ra=b.J(ca);!ra.Oc||ra.Jf&&!this.Tg.FRa(ra.me,ra.Lb.paragraph.id,!0)?ra.Oc||
ra.Jf&&!this.Tg.FRa(ra.me,ra.Lb.paragraph.id,!1)||(h--,0>h?(h=0,B=new lo.a):!h&&P&&ra.me.equals(P.me)&&this.GZe(r,B,P)):(h||(P=ra),h++)}return r}zpf(b,h,r){const B=new mb.a;b=r?this.Hof(b,h):this.LFb(b,h);h=0;for(r=0;r<b.count;r++){var P=b.J(r);P.zp&&(P.Oc?h++:(h--,0>h?h=0:(P=this.qR(P.contentControlNode))&&B.add(P)))}return B}LFb(b,h,r=!0,B=!0){const P=new mb.a,ca=this.sU(b,h);if(!ca.count)return P;let ra,Qa,tb,Mb;for(let Zb=0;Zb<ca.count;Zb++){ra=0;Qa=ca.J(Zb).characterData.length;tb=Mb=!0;if(b&&
ca.J(Zb).id.equals(b.node.id)){if(b.contextId===yc.a.Vc)continue;0<=b.cpBegin&&(ra=b.cpBegin)}h&&ca.J(Zb).id.equals(h.node.id)&&0<=h.cpEnd&&(Qa=h.cpEnd);Zb||(tb=r);Zb!==ca.count-1||h&&h.contextId===yc.a.Vc||(Mb=B);P.addRange(this.Iof(ca.J(Zb),ra,Qa,tb,Mb))}return P}Hof(b,h){const r=new mb.a,B=this.sU(b,h);let P,ca,ra;for(let tb=0;tb<B.count;tb++){const Mb=B.J(tb);if(Mb.qa.length){var Qa=Mb.qa.J(Mb.qa.length-1);P=0;ca=Mb.characterData.length;ra=0;Qa=Qa&&Qa.Jb?Qa.Jb.length:0;b&&Mb.id.equals(b.node.id)&&
(P=b.Wj,ra=b.Fb);h&&Mb.id.equals(h.node.id)&&(ca=h.vp,Qa=h.Sb);r.addRange(this.Jof(Mb,P,ca,ra,Qa))}}return r}Iof(b,h,r,B=!0,P=!0,ca=!0){const ra=new mb.a;b=b.qa;for(let Qa=0;Qa<b.length;Qa++){if(b.J(Qa).cp<h)continue;if(b.J(Qa).cp>r)break;const tb=b.J(Qa);if(tb.Jb&&0<tb.Jb.length&&(tb.cp!==h||B)&&(tb.cp!==r||P))for(let Mb=0;Mb<tb.Jb.length;Mb++){const Zb=tb.Jb.J(Mb);(ca||Zb.Oc)&&ra.add(Zb)}}return ra}Jof(b,h,r,B,P){const ca=new mb.a;b=b.qa;for(let ra=0;ra<b.length;ra++){if(b.J(ra).cp<h)continue;if(b.J(ra).cp>
r)break;const Qa=b.J(ra);if(Qa.Jb&&0<Qa.Jb.length){let tb=0,Mb=Qa.Jb.length;Qa.cp===h&&-1!==B&&(tb=B);for(Qa.cp===r&&-1!==P&&(Mb=P);tb<Mb&&tb<Qa.Jb.length;tb++)ca.add(Qa.Jb.J(tb))}}return ca}CBd(b,h,r){let B=null;if(h.contains(r)||!(B=this.rj.Eb(r)))return!1;b.add(this.qR(B));h.add(r);return!0}GZe(b,h,r){let B=null;!h.contains(r.me)&&(B=r.contentControlNode)&&(b.add(this.qR(B)),h.add(r.me))}rCj(b,h){let r,B=!1;r=({q6a:h,p6a:b,y$c:B}=this.sCj(b,h,!1,B)).returnValue||B;B&&(r=r||({q6a:h,p6a:b,y$c:B}=
this.sCj(h,b,!0,B)).returnValue);return{returnValue:r,q6a:h,p6a:b}}sCj(b,h,r,B){let P,ca;if(r)return P=ca=null,{returnValue:!1,q6a:ca,p6a:P,y$c:!1};let ra=!1;ca=b;P=h;const Qa=b.cpBegin,tb=h.cpEnd;B=!1;var Mb=r?this.Y4h(h):this.wNl(b);let Zb=!1,jc=!1,Gc=0,Uc=0;for(const od of Mb)for(Mb=0;Mb<od.qa.length;Mb++){const Od=od.qa.J(Mb);!jc&&od.id.equals(h.node.id)&&(jc=!0);if(!Zb&&(od.id.equals(h.node.id)&&-1!==tb&&Od.cp>tb||jc&&!od.id.equals(h.node.id)))if(Zb=!0,Gc!==Uc)ra=!0;else return{returnValue:!1,
q6a:ca,p6a:P,y$c:B};if((!od.id.equals(b.node.id)||Od.cp>=Qa||-1===Qa)&&Od.Jb)for(let ze=0;ze<Od.Jb.length;ze++){const de=Od.Jb.J(ze),ee=this.rj.Eb(de.me);if(!ee.getValue(Mc.a.u9)||(!de.Oc||this.Tg.FRa(this.Mg.Gq(ee.id,!0),od.id,!0))&&(de.Oc||this.Tg.FRa(this.Mg.Gq(ee.id,!1),od.id,!1))){de.Oc?Gc++:Gc--;if(ra&&Gc===Uc)return{q6a:ca,p6a:P}=this.w$k(b.node,od,b.cpBegin,Od.cp),{returnValue:!0,q6a:ca,p6a:P,y$c:B};!r&&Gc<Uc&&(B=!0,Uc--)}}}return{returnValue:ra,q6a:ca,p6a:P,y$c:B}}w$k(b,h,r,B){let P;h.id.equals(b.id)?
b=0<r||B<ke.ParagraphReader.textLength(h)?P=Ue.a.createTextRange(h,r,B):P=Ue.a.create(h):(P=0<r?Ue.a.createTextRange(b,r,ke.ParagraphReader.textLength(b)):Ue.a.create(b),b=B<ke.ParagraphReader.textLength(h)?Ue.a.createTextRange(h,0,B):Ue.a.create(h));return{q6a:P,p6a:b}}M5l(b){const h=b.cpBegin,r=this.Y4h(b);for(let P=r.count-1;0<=P;P--){const ca=r.J(P);for(let ra=ca.qa.length-1;0<=ra;ra--){const Qa=ca.qa.J(ra);if((!ca.id.equals(b.node.id)||Qa.cp<=h||-1===h&&!Qa.cp)&&Qa.Jb){var B=Qa.Jb.length-1;for((Qa.cp===
h||-1===h&&!Qa.cp)&&this.xY&&ca.id.equals(b.node.id)&&(B=b.Fb-1);0<=B;B--){const tb=Qa.Jb.J(B),Mb=this.rj.Eb(tb.me);if(tb.Oc){if(Mb.getValue(Mc.a.u9)&&!this.Tg.FRa(this.Mg.Gq(Mb.id,!0),ca.id,!0))continue;return null}if(!Mb.getValue(Mc.a.u9)||this.Tg.FRa(this.Mg.Gq(Mb.id,!1),ca.id,!1))return this.qR(Mb)}}}}return null}qR(b){if(!b)return null;this.Tg.X7b();return this.J2.aDb(b,this.Cx,this.ji,this.Tg,this.qr,this,this.pfa,this.kga,this.zAb)}sU(b,h){b=this.X4h(b,h,Nr.sGb(12));if(!b)return null;h=new mb.a;
for(const r of b)h.add(r);return h}uNl(b,h){const r=Nr.R1l();return this.X4h(Ue.a.create(b.node),Ue.a.create(h.node),r)}X4h(b,h,r){if(!r||!b&&!h)return null;if(b&&h&&(b.equals(h)||b.node.id.equals(h.node.id))){var B=b.node;if(B&&r(B)){var P;return P=new mb.a,P.add(B),P}}B=Object.assign(new QC,{VRi:35,U0i:r});b=b?b.node:null;h=h?h.node:null;P=this.$cm(b,h);if(!P)return null;h=this.AAk(h,r,Nr.aAh,B);return this.qNl(b,h,P,r,Nr.aAh,B)}$cm(b,h){return(b=b?this.tbi(b):this.tbi(h))?b.jd(35):this.Tg.x8l()}AAk(b,
h,r,B){if(!b)return null;h(b)||(h=this.rNl(b,h,r,B),h.count&&(b=h.J(h.count-1)));return b}qNl(b,h,r,B,P,ca){b?(b=Ad.GraphIterator.eb(b),b.zb(7),r=Ab.a.Gs(b,r)):r=Ab.a.gp(r);P&&r.yo(P,ca);for(P=new mb.a;r.moveNext()&&(B(r.currentNode)&&P.add(r.currentNode),!h||!r.currentNode.id.equals(h.id)););return P}rNl(b,h,r,B){b=Ab.a.gp(b);r&&b.yo(r,B);for(r=new mb.a;b.moveNext();)h(b.currentNode)&&r.add(b.currentNode);return r}tbi(b){b=Ad.GraphIterator.eb(b);return b.zb(35)?b:null}Oni(b,h){b=this.sU(b,h);for(const r of b)if((b=
this.Tg.Qrf(r))&&b.aia(4))return!0;return!1}lph(b,h=null,r=!1){if(!b)return!1;let B=b.start;var P=b.end;if(!xe.SelectionEditor.nv(B)&&B.contextId!==yc.a.paragraph||!xe.SelectionEditor.nv(P)&&P.contextId!==yc.a.paragraph||!this.xY&&({q6a:B,p6a:P}=this.rCj(b.start,b.end)).returnValue||this.xY&&!({start:B,end:P}=this.VSk(B,P)).returnValue)return!1;b.start=B;b.end=P;const ca=this.eMm(B,P);if(this.xY){var ra=this.xoa(b.start,b.end,3);var Qa=this.xoa(b.start,b.end,2)}else ra=this.jL(b.start,b.end,3),Qa=
this.jL(b.start,b.end,2);const tb=ra&&0<ra.count?ra.J(0):null,Mb=Qa&&0<Qa.count?Qa.J(0):null;if(r)return this.lWc(b,0,ra)?!0:!1;if(this.lWc(b,0,ra)){r=(r=Object(Ra.a)(qy,this.M5l(b.start)))?this.Tg.pu(r.objectId):null;Qa=this.Tg.ask(b,tb,r,Qa,b.yu,b.Dz,h);this.Ej.Ffc(Qa);if(b.Jf)for(P=this.sU(b.start,b.end),r=0;r<P.count;r++)if(this.xY){ra=tb?tb.objectId:null;const Zb=this.Zai(ra,P.J(r),!0);this.qr.Fua(P.J(r),Qa.id,0,!0,!0,void 0,void 0,void 0,void 0,Zb);ra=this.Zai(ra,P.J(r),!1);this.qr.Fua(P.J(r),
Qa.id,P.J(r).characterData.length,!0,!1,void 0,void 0,void 0,void 0,ra)}else this.qr.Fua(P.J(r),Qa.id,0,!0,!0),this.qr.Fua(P.J(r),Qa.id,P.J(r).characterData.length,!0,!1);else this.xY?(r=-1===B.Fb?0:B.Fb,this.qr.Fua(b.start.node,Qa.id,B.cpBegin,!1,!0,void 0,void 0,void 0,void 0,r),this.qr.Fua(b.end.node,Qa.id,P.cpEnd,!1,!1,void 0,void 0,void 0,void 0,ca?r+1:P.Sb)):(this.qr.Fua(b.start.node,Qa.id,b.start.cpBegin,!1,!0),this.qr.Fua(b.start.node,Qa.id,b.start.cpEnd,!1,!1));h||this.Tg.Xho(Qa,b.Jf,b.id,
this.Tg.gac(this.Tg.pu(b.yu)),b.type);1===b.type&&this.qr.aSo(b.start.node,B.Wj,B.vp);b.objectId=Qa.id;h=this.Tg.Gwa().currentNode;h.hasProperty(Mc.a.OJc)||h.setValue(Mc.a.OJc,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder);zm.a.nda&&this.Tg.gGj(WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,Qa);tb&&this.qHj(tb.contentControlNode,b);Mb&&this.qHj(Qa,Mb);ca&&this.ga.Qb(Nb.a.T$c,2,b.id);PC.a.mJh()&&this.LE&&this.LE.fireEvent(3,{node:Qa});return!0}return!1}deleteContentControl(b){if(!this.lWc(b,
3))return t.ULS.sendTraceTag(528537614,368,15,"Invalid content control to delete"),!1;if(this.Ej.Tcd(b.contentControlNode))return!0;b.NJ&&(b.NJ=!1);const h=this.hb.ib.lb;b=b.lF();const r=new Rg.Selection(b.toArray(),!0);let B=!1;this.hb.JPb(()=>{this.hb.Ac(r);if(32===this.ga.processAction(Nb.a.PH,2)){if(this.Plh.instance){const P=this.Plh.instance.Hci(h,r,this.hb.ib.lb);this.hb.STo(new OC.SelectionCollection([P],0))}B=!0}});return B}hza(b,h=!1,r=!1){if(this.lWc(b,2)){if(b.NJ)return t.ULS.sendTraceTag(528537615,
368,15,"Attempting to delete content control showing placeholder"),this.deleteContentControl(b);const B=zm.a.xr?b.contentControlNode:this.Tg.pu(b.objectId);let P=new mb.a;h&&(P=b.Vnf());P.add(b);if(r||!this.Ej.Tcd(b.contentControlNode)){B&&B.anchor&&this.Tg.pRh(B,h);for(const ca of P)b=this.sU(ca.start,ca.end),this.qr.Bkl(b,ca.objectId);this.H6i(P)}t.ULS.sendTraceTag(528537616,368,50,"Successfully released content control.");return!0}t.ULS.sendTraceTag(528537617,368,15,"Invalid content control to release.");
return!1}coj(b,h){if(this.lWc(b,1)){let Qa=!1;h||(Qa=!0,{vto:r,returnValue:h}=this.VGb(b),r&&this.Tg.Gwa().currentNode.setValue(Mc.a.OJc,h));var r=b.V6h().toArray();for(var B=0;B<r.length;B++)this.hza(r[B],!0);r=this.LBo(h);if(b.Jf){B=this.sU(b.start,b.end);if(!B.count)return!1;if(1===B.count&&v.AFrameworkApplication.ou)this.qr.Ge(Ue.a.createTextRange(B.J(0),0,B.J(0).characterData.length),h);else{var P=this.Tg.I9l(B.J(0));h=B.J(0).o9b();B=this.Tg.FRh(B);B=this.Tg.yph(P,B,r.length);for(P=0;P<B.count;P++){this.qr.Ge(Ue.a.createTextRange(B.J(P),
0,0),r[P]);for(var ca=0;ca<h.count;ca++)this.qr.Fua(B.J(P),h.J(ca),0,!0,!0),this.qr.Fua(B.J(P),h.J(h.count-ca-1),B.J(P).characterData.length,!0,!1)}b.VZo(B.J(0).id,B.J(B.count-1).id);r=this.NE.ne(B.J(0),0);this.hb.Ac(r)}}else{P=0;1<r.length&&t.ULS.sendTraceTag(17585367,368,15,"New text being set to an inline content control should not contain multiple paragraphs");h=b.start;B=h.node;for(var ra=0;ra<B.qa.length&&h.contextId===yc.a.Fd;ra++)if(ca=B.qa.J(ra),ca.cp===h.cpBegin&&ca.blob){P++;for(ra+=1;ra<
B.qa.length;ra++)if(ca=B.qa.J(ra),ca.cp>h.cpBegin&&ca.cp<=h.cpEnd)if(ca.blob)P++;else break;else if(ca.cp>h.cpEnd)break;break}if(0<P&&P+h.cpBegin<h.cpEnd)B=Ue.a.createTextRange(h.node,h.cpBegin,h.cpBegin+P),h=Ue.a.createTextRange(h.node,h.cpBegin+P,h.cpEnd),this.qr.Ge(h,r[0]),this.qr.Ge(B,"");else if(0<P&&P+h.cpBegin===h.cpEnd)for(this.qr.Ge(b.start,r[0]),r=0;r<B.qa.length;r++){if(P=B.qa.J(r),P.cp===h.cpBegin){P.blob=null;break}}else v.AFrameworkApplication.ou?(r=r.join(" "),this.qr.Ge(b.start,r)):
this.qr.Ge(b.start,r[0])}this.hBb(b,Qa);let tb;this.XNn((tb=new mb.a,tb.add(b),tb));return!0}return!1}hBb(b,h){const r=this.qr.tRc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);if(r){const B=this.Tg.pu(b.objectId);if(h){h=this.qz.JB(b.start.node);let P=h.oj($m.a.d1f);P||(P=h.JFa($m.a.IDn));P&&(this.De.Iga(r.formatting),this.De.c8a(r.formatting,P));B&&(b.NJ=!0)}else B&&b.NJ&&(this.Z7n(b,r),b.NJ=!1)}else t.ULS.sendTraceTag(17585368,368,15,"Unable to get a ChP at starting Ip of Content Control")}Z7n(b,
h){b=this.Tg.pu(b.objectId);let r=null;b&&(r=b.ja(Mc.a.PCb,V.a.nil));this.De.Iga(h.formatting);r&&!r.equals(V.a.nil)&&(b=this.ji.value.Eb(r),h.formatting=b)}VGb(b){let h=!1;b=b.placeholderText;this.rVm(b)&&(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,h=!0);return{returnValue:b,vto:h}}YYn(b,h=!0){this.kga&&(h&&this.UYn(b),this.bZn(b))}ZYn(b){if(this.kga&&(b=this.jL(b,b,4)))for(const h of b)this.hza(h,!1)}ann(b,h){if(h&&!b.Oc&&(this.Tg.X7b(),(b=b.Lb.paragraph.Mc.Eb(b.me))&&b.anchor)){this.Tg.pRh(b);
b=this.J2.aDb(b,this.Cx,this.ji,this.Tg,this.qr,this,this.pfa,this.kga,this.zAb);let r;this.H6i((r=new mb.a,r.add(b),r))}}KXi(b,h){this.Tg.X7b();b=this.Tg.pu(h.me);const r=this.qR(b);if(r&&r.isValid()&&r.removeWhenEdited){const B=this.Lc.Pc(7);B.Db(b);this.hza(r,!1);h.state=2;B.dispose()}}CYi(b,h){this.Tg.X7b();b=this.Tg.pu(h.me);this.fKm(b)&&(b=b.ja(Mc.a.Zw,0),this.ga&&(this.ga.Qb(Nb.a.T$c,2,b),Nr.Qd.p1e()))}fKm(b){return b&&b.isConnected&&!b.ja(Mc.a.u8,!1)?zm.a.xr?this.AZd(b)&&!b.Wu:this.AZd(b):
!1}AZd(b){b=this.J2.aDb(b,this.Cx,this.ji,this.Tg,this.qr,this,this.pfa,this.kga,this.zAb);if(!b.isValid())return!1;if(b.Jf){if(b.yu.toString()===b.Dz.toString()){var h=this.Tg.pu(b.yu);if(!h)return t.ULS.shipAssertTag(22828291,368,!1,"Block content control is connected but its start node is null"),!1;if(12===h.type&&1===h.qa.length)return this.xwi(h.qa.J(0),b.objectId)}}else{h=b.start;if(!h)return t.ULS.shipAssertTag(22828292,368,!1,"Inline content control is connected but its start context is null"),
!1;if(h.cpBegin===h.cpEnd)return h=this.Tg.pu(b.yu).qa.nh(h.cpBegin),this.xwi(h,b.objectId)}return!1}xwi(b,h){b=b?b.Jb:null;if(!b)return!1;const r=b.AJ(h,!0);return-1<r&&r+1<b.length&&b.J(r+1).me.toString()===h.toString()}C9i(b){this.IPe.push(b)}evj(b,h){if(void 0===b||null===b||b.contextId!==yc.a.Fd)return null;b=Ue.a.Rc(b.node,h?b.cpBegin:b.cpEnd);return 0<b.cpBegin&&b.cpBegin<ke.ParagraphReader.textLength(b.node)?this.Tg.NUa(b):null}select(b,h){if(b&&!b.equals(V.a.nil)){var r=this.Tg.pu(b);if(r&&
55===r.type){r=this.qR(r);if(r.Jf)r=this.nPl(r);else{r=r.start;zm.a.Xj&&(r.contextId=yc.a.Fd);if(!r)return;r=this.NE.Zn(r)}if(r&&r.length)return this.dlj(r.Pa,b,h,!0,!0),this.dlj(r.Tc,b,h,!1,!1),this.hb.Ac(r),r}}}uco(b,h){if(!xe.SelectionEditor.Ze(b)||b.Fb!==b.Sb)return!1;const r=b.Fb;return-1===r?!1:(b=this.Lo.p2a(b.node,b.cpBegin,r,!h))&&h===b.Oc?(h=this.qR(b.contentControlNode),this.select(b.me,!h.isEditable),!0):!1}nPl(b){var h=this.Tg.OPa(b.yu,!0);b=this.Tg.OPa(b.Dz,!1);if(!h||!b)return null;
h=this.uNl(Ue.a.create(h),Ue.a.create(b));if(!h||!h.count)return null;b=new mb.a;for(let r=0;r<h.count;r++){let B;if(12===h.J(r).type)B=r===h.count-1?Ue.a.createTextRange(h.J(r),0,ke.ParagraphReader.textLength(h.J(r))):Ue.a.create(h.J(r)),this.Ah&&(B.Fb=this.Ah.fr(B.node,!0),B.Sb=this.Ah.fr(B.node,!1));else if(15===h.J(r).type)B=Fu.TableNodeContext.create(h.J(r));else continue;b.add(B)}return new Rg.Selection(b.toArray(),!0)}uho(b){if(b&&!b.equals(V.a.nil)&&(this.Tg.X7b(),(b=this.Tg.pu(b))&&55===
b.type&&b.isConnected)){var h=b.ja(Mc.a.u8,!1);b.setValue(Mc.a.u8,!1);h&&this.YTn(b)}}YTn(b){var h=this.Mg.Gq(b.id,!0);h.equals(V.a.nil)||(h=this.Tg.voa(h,!0))&&(b=this.qr.vpf(h,b.id,!0))&&0<b.count&&(b=b.J(0),h=b.Lb,h.formatting=b.nR?b.nR.vf(h):new eC.a(h,V.a.nil))}w$i(b){if(b=this.W7h(b))for(const h of b)this.Ej.Kfg()&&(h.NJ=!1),this.hza(h,!1)}T7h(b){const h=new mb.a;if(b=this.W7h(b))for(const r of b)h.add(r.contentControlNode);return h}$Yn(b){if(b&&(11===b.type||14===b.type||15===b.type||16===
b.type)){var h=this.gb.al(b),r=this.gb.$C(b);if(this.Ah&&h&&r){b=this.Ah.fr(h,!0);const B=this.Ah.fr(r,!1);h=Ue.a.create(h);r=Ue.a.create(r);h.Fb=b;r.Sb=B;if(b=this.xoa(h,r,4))for(const P of b)this.hza(P,!1)}}}xNl(b){var h=this.Mg.Gq(b.id,!0,b.loading);b=this.Mg.Gq(b.id,!1,b.loading);if(h.equals(V.a.nil)||b.equals(V.a.nil))return new mb.a;h=this.Tg.voa(h,!0);b=this.Tg.voa(b,!1);return h&&b?this.sU(Ue.a.create(h),Ue.a.create(b))||new mb.a:new mb.a}OPa(b,h){return this.Tg.OPa(b,h)}yrf(b,h){if(b&&55===
b.type&&(b=this.qR(b),b=h?b.start:b.end)){const r=Ue.a.Rc(b.node,h?b.Wj:b.vp);r.Fb=r.Sb=(h?b.Fb:b.Sb)+(h?-1:1);return r}return null}fTl(b){return(b=this.qR(b))?b.start:null}dlj(b,h,r,B,P){if((b.contextId===yc.a.Fd||b.contextId===yc.a.Uc||b.contextId===yc.a.paragraph)&&(P=b.node.qa.nh(P?b.Wj:b.vp))&&P.Jb)for(let ca=0;ca<P.Jb.length;ca++){const ra=P.Jb.J(ca);if(ra.me.equals(h)&&ra.zp)if(B&&ra.Oc){b.Fb=r?ca:ca+1;break}else if(!B&&!ra.Oc){b.Sb=r?ca+1:ca;break}}}XNn(b){for(let h=0;h<this.vch.length;++h)(0,this.vch[h])(this,
new jB(b))}H6i(b){for(let h=0;h<this.IPe.length;++h)(0,this.IPe[h])(this,new jB(b))}bZn(b){b=Ue.a.create(b);if(b=this.jL(b,b,4))for(const h of b)h.Jf||this.hza(h,!1)}UYn(b){if(b=b.o9b())for(let r=0;r<b.count;r++){var h=this.Tg.pu(b.J(0));h=this.J2.aDb(h,this.Cx,this.ji,this.Tg,this.qr,this,this.pfa,this.kga,this.zAb);this.hza(h)}}wNl(b){return this.sU(b,null)}lWc(b,h,r=null){let B=!0;try{if(!b)return t.ULS.sendTraceTag(529106507,368,50,"Content Control is null"),!1;t.ULS.sendTraceTag(529106508,368,
50,String.format("Content control change type: {0}, isSupported: {1}, isDeletable: {2}",h,b.isSupported,b.nia));if(!zm.a.xr&&this.hCa&&sq.a.instance.J(1)&&this.hCa.LR(this.Cx.value))return t.ULS.sendTraceTag(529106509,368,50,"Content Control Change Invalid because track changes is enabled"),!1;if(this.BRm(h)&&this.CRm(h)&&!this.gKm(b))return!1;if(!r){const ra=this.D9l(b);ra&&(r=new mb.a,r.add(ra))}var P=this.Tg.Wdi(b.start.node);const ca=this.Tg.Wdi(b.end.node);if(P&&ca&&!P.equals(ca)||!P&&ca||P&&
!ca)return!1;P=!0;if(r&&0<r.count){if(!r.J(0).isSupported)return!1;P=r.J(0).isEditable}switch(h){case 0:B=this.FHm(b,P);break;case 1:B=(this.L0||!this.A_d(b))&&b.isSupported&&b.isEditable&&this.wvh(b)&&this.Awi(b);v.AFrameworkApplication.ou||(B=B&&!this.Oni(b.start,b.end));break;case 2:const ra=b.zWm?!0:b.isSupported;B=(this.L0||!this.A_d(b))&&ra&&b.nia&&P;t.ULS.sendTraceTag(529106510,368,50,"True");break;case 3:B=b.isSupported&&b.nia&&P&&this.wvh(b)&&this.Awi(b)&&!this.Oni(b.start,b.end)}}catch(ca){t.ULS.sendTraceTag(17413646,
368,15,"Exception was caught in IsContentControlValid. OperationType: "+h+", Exception: "+ca),B=!1}return B}CRm(b){return!(v.AFrameworkApplication.ou&&1===b)}BRm(b){return!(this.xY&&(!b||2===b||3===b))}FHm(b,h){if(zm.a.k1f)return this.GHm(b,h);let r=!0;if(!this.L0&&this.A_d(b))r=!1;else if(this.xY)this.xY?b.Jf||xe.SelectionEditor.nv(b.start)||b.start.contextId===yc.a.Vc?b.Jf&&(b.start.contextId!==yc.a.paragraph&&b.start.contextId!==yc.a.Vc||b.end.contextId!==yc.a.paragraph&&b.end.contextId!==yc.a.Vc)&&
(r=!1):r=!1:r=h?this.Qvi(b):!1;else if(!(b.Jf||-1!==b.start.cpBegin&&-1!==b.end.cpEnd&&b.start.equals(b.end)))r=!1;else if(b.Jf&&(b.start.contextId!==yc.a.paragraph||b.end.contextId!==yc.a.paragraph||b.start.equals(b.end)&&!ke.ParagraphReader.textLength(b.start.node)))r=!1;else if(b.start.contextId===yc.a.Uc||b.end.contextId===yc.a.Uc||b.start.contextId===yc.a.Vc||b.end.contextId===yc.a.Vc)r=!1;return r}GHm(b,h){return(this.L0||!this.A_d(b))&&this.HHm(b)&&this.PNm(b)&&h&&!this.iPm(b)&&this.Qvi(b)?
!0:!1}PNm(b){var h;const r=b.start,B=r.contextId,P=null===(h=b.end)||void 0===h?void 0:h.contextId;return b.Jf?B!==yc.a.paragraph&&B!==yc.a.Vc||P!==yc.a.paragraph&&P!==yc.a.Vc?!1:!0:xe.SelectionEditor.nv(r)||B===yc.a.Vc?!0:!1}W7h(b){if(!b||!b.length)return null;const h=b[0];b=b[b.length-1];this.Ah&&(this.gb.vm(h)&&12===h.node.type&&(h.Fb=this.Ah.fr(h.node,!0)),this.gb.vm(b)&&12===b.node.type&&(b.Sb=this.Ah.fr(b.node,!1)));return this.xoa(h,b,4)}wvh(b){b=b.Vnf();for(const h of b)if(!h.isSupported||
!h.nia)return!1;return!0}gKm(b){if(this.rCj(b.start,b.end).returnValue)return!1;const h=this.jL(b.start,b.end,2);if(!h)return!0;for(const r of h)if(!r.objectId.equals(b.objectId)&&(r.Jf&&(r.start.node.id.equals(b.start.node.id)&&(-1===b.start.cpBegin||!b.start.cpBegin)||r.end.node.id.equals(b.end.node.id)&&(-1===b.end.cpEnd||b.end.cpEnd===ke.ParagraphReader.textLength(r.end.node)))||!r.Jf&&(b.start.node.id.equals(r.start.node.id)&&(-1!==b.start.cpBegin?r.start.cpBegin===b.start.cpBegin:!r.start.cpBegin)||
b.end.node.id.equals(r.end.node.id)&&(-1!==b.end.cpEnd?r.end.cpEnd===b.end.cpEnd:r.end.cpEnd===ke.ParagraphReader.textLength(b.end.node)))))return!1;return!0}Awi(b){if(b.Jf){var h=this.Tg.pu(b.yu),r=this.Tg.pu(b.Dz);let B=null;if(12===h.type&&12===r.type){h=this.Tg.gac(h);h=this.Tg.pu(h);r=this.Tg.gac(r);r=this.Tg.pu(r);if(!h||!r)return!1;16===h.type&&16===r.type&&h.id.equals(r.id)&&(B=h)}b=this.sU(b.start,b.end);if(!b.count)return!1;for(const P of b)if(b=this.Tg.gac(P),b=this.Tg.pu(b),!b||!(16!==
b.type||B&&b.id.equals(B.id)))return!1}return!0}A_d(b){return b.Jf?!1:(b=b.start.node)?!b.ja(Mc.a.glb,!0):!0}HHm(b){return 1!==b.type?!0:b.yu.equals(b.Dz)&&ke.ParagraphReader.Xb(b.start.node)&&!this.Vsm(b)?!0:!1}Vsm(b){const h=b.start;var r=h.node;const B=r.qa;if(b.Jf){if(r.Ms||r.Xoa||r.hasBookmark)return!0;for(var P of B)if(this.Tni(P))return!0;return!1}b=h.Wj;r=h.vp;let ca=P=null;for(const ra of B.hFi(b,r))if(!(ra.cp<b))if(ra.cp===b)P=ra;else if(ra.cp===r)ca=ra;else if(this.Tni(ra))return!0;return this.Wsm(h,
P,ca)?!0:!1}Tni(b){return ry(b.Jb)&&ry(b.Te)&&ry(b.$g)&&ry(b.Hc)&&null==b.hyperlink&&!b.Cm&&null==b.blob?!1:!0}Wsm(b,h,r){if(null==h&&null==r)return!1;const B=b.Fb;b=b.Sb;return null!=h&&(h.Jb&&B<h.Jb.length||null!=h.blob)||null!=r&&r.Jb&&0<b||null!=h&&null!=r&&(fu(h.Te)&&mC(r.Te)||fu(h.$g)&&mC(r.$g)||!ry(h.Hc)&&!ry(r.Hc)&&[...h.Hc].some(P=>0===P.uf)&&[...r.Hc].some(P=>3===P.uf)||null!=h.hyperlink&&r.Cm)?!0:!1}iPm(b){var h,r;return(null!==(r=null===(h=this.jL(b.start,b.end,3))||void 0===h?void 0:
h.toArray())&&void 0!==r?r:[]).some(B=>1===B.type)?!0:!1}Qvi(b){if(!b.Jf)return!0;var h=this.Tg.pu(b.yu);b=this.Tg.pu(b.Dz);if(Ah.TableCellReader.Uxa(h)||Ah.TableCellReader.Uxa(b)||dl.a.Spa(h)||dl.a.Spa(b))return!1;h=this.Tg.gac(h);h=this.Tg.pu(h);b=this.Tg.gac(b);b=this.Tg.pu(b);return h&&b&&(16!==h.type&&16!==b.type||h.id.equals(b.id))?!0:!1}D9l(b){if(!b)return null;b=this.Tg.pu(b.objectId);if(!b)return null;b=b.ja(Mc.a.t8,V.a.nil);return b.equals(V.a.nil)?null:(b=this.Tg.pu(b))?this.qR(b):null}Y4h(b){return this.sU(null,
b)}LBo(b){return(b||"").split(RegExp("\r\n|\r|\n"))}rVm(b){return b&&""!==b?!1:!0}Zai(b,h,r){h=h.qa.nh(r?0:h.characterData.length);if(!h)return t.ULS.sendTraceTag(21018849,368,15,"Unable to get a ChP at expected cp, which should not happen"),0;if(!h.Jb||!h.Jb.length)return 0;if(!b)return r?0:h.Jb.length;for(let B=0;B<h.Jb.length;B++){const P=h.Jb.J(B);if(V.a.Dq(P.me,b)&&P.Oc===r)return r?B+1:B}return r?0:h.Jb.length}VSk(b,h){var r=b.node,B=h.node,P=b.contextId===yc.a.paragraph?0:b.cpBegin,ca=h.contextId===
yc.a.paragraph?ke.ParagraphReader.textLength(B):h.cpEnd;r=this.Lo.b9(r,P,b.Fb);B=this.Lo.b9(B,ca,h.Sb);ca=!r||!r.count;P=!B||!B.count;if(ca&&P)return{returnValue:!0,start:b,end:h};if(ca)return{returnValue:this.yne(b,B.J(B.count-1).me,!0),start:b,end:h};if(P)return{returnValue:this.yne(h,r.J(r.count-1).me,!1),start:b,end:h};if(r.count===B.count)return r=r.J(r.count-1),B=B.J(B.count-1),{returnValue:r.me.equals(B.me),start:b,end:h};r=(ca=r.count<B.count)?B.J(B.count-1):r.J(r.count-1);return{returnValue:ca?
this.yne(b,r.me,!0):this.yne(h,r.me,!1),start:b,end:h}}yne(b,h,r){var B=b.node;let P;if(r){P=b.contextId===yc.a.paragraph?0:b.cpBegin;var ca=b.Fb}else P=b.contextId===yc.a.paragraph?ke.ParagraphReader.textLength(B):b.cpEnd,ca=b.Sb;B=B.qa.nh(P);if(-1===ca||!B||!B.Jb||!B.Jb.length)return!1;B=B.Jb;if(r)for(r=ca;r<B.length;r++){ca=B.J(r);if(!ca.Oc)break;if(ca.me.equals(h))return b.Fb=r+1,!0}else for(r=ca-1;0<=r;r--){ca=B.J(r);if(ca.Oc)break;if(ca.me.equals(h))return b.Sb=r,!0}return!1}eMm(b,h){return this.cHk(b,
h)&&b.Fb===b.Sb&&(b.contextId===yc.a.Uc||b.contextId===yc.a.paragraph&&!b.node.characterData.length)}cHk(b,h){return b.equals(h)&&b.Fb===h.Fb&&b.Sb===h.Sb}qHj(b,h){if(b&&h.Jf){var r=this.Mg.Gq(b.id,!0),B=this.Tg.voa(h.yu,!0);r.equals(B?B.id:null)&&this.Mg.sE(b.id,h.objectId,!0);r=this.Mg.Gq(b.id,!1);B=this.Tg.voa(h.Dz,!1);r.equals(B?B.id:null)&&this.Mg.sE(b.id,h.objectId,!1)}}static get Qd(){return null!=Nr.MIg?Nr.MIg:Nr.MIg=Ma.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static sGb(b){return h=>
h.type===b}static R1l(){return b=>12===b.type||15===b.type}static aAh(b,h){return b.Xe===h.VRi||b.parentNode&&h.U0i(b.parentNode)?!1:!0}}Object(m.a)(Nr,"ContentControlOperator",null,[425,9,426]);class vz{constructor(b,h,r){this.Yc=b;this.Cx=h;this.Rxb=r}tki(b){const h=this.tGb();return h&&b&&this.tHb(h,b)?this.Mkm(h):null}tHb(b,h,r=!1){if(!b||!h)return!1;do{var B=b.currentNode;if(!B)break;B=B.ja(Mc.a.nac,null);if(B===h||r&&B&&B.includes(h))return!0}while(b.Mf(29));return!1}Mkm(b){var h=b.Ub(1);b.uc();
b=b.EJ(1);if(!h||!b)return null;h=og.SelectionFactory.Cel(h,b);b=xe.SelectionEditor.Jj(h,!1,!1);return zm.a.nda&&!b?null:og.SelectionFactory.Gy(h,b.Tc)}tGb(){const b=this.Yc.Ek();b.set(this.Cx.value);this.Rxb.IP(b);return b.Ub(28)&&b.Ub(29)?b:null}Prf(){const b=this.Yc.Ek();b.set(this.Cx.value);this.Rxb.IP(b);return b.Ub(28)?b:null}IYl(b){var h=this.tGb();if(!h||!b||!this.tHb(h,b,!1))return null;h.Rd();b=1<h.Wp();h.Rd();h.Rd();h=h.currentNode;return ke.ParagraphReader.Xb(h)?{f$d:h,$ni:b}:{f$d:null,
$ni:b}}J8h(){const b=this.tGb();return this.tHb(b,$m.a.JQh,!0)?b.currentNode.getValue(Mc.a.nac):null}}Object(m.a)(vz,"GlossaryNavigator",null,[374]);class kB{constructor(b,h,r,B,P,ca){this.qr=b;this.Tg=h;this.km=r;this.gb=B;this.sh=P;this.kga=ca}t9c(b,h,r){if(!this.kga)return 1;if(!({tableNode:P}=this.uIf(b)).returnValue||!this.sh.wDi(P,h)||this.t$i(b,h))return 2;var B=this.sh.Z4h(h);var P=B.J(0).o9b();P&&P.count||(P=new mb.a,P.add(b.objectId));b=this.Tg.FRh(B);r=r.split("\n");h=Object(Ra.a)(Ad.GraphIterator,
this.Tg.Qrf(h));h=this.Tg.yph(h,b,r.length);for(b=0;b<h.count;++b){B=h.J(b);this.qr.Ge(Ue.a.createTextRange(B,0,0),r[b]);for(let ca=0;ca<P.count;++ca)this.qr.Fua(B,P.J(ca),0,!0,!0),this.qr.Fua(B,P.J(P.count-ca-1),B.characterData.length,!0,!1)}return 0}t$i(b,h){if(!this.kga)return 1;let r;if(!({tableNode:r}=this.uIf(b)).returnValue||!this.sh.wDi(r,h))return 2;h=this.sh.Z4h(h);if(0<h.count&&(h=this.km.jL(Ue.a.create(h.J(0)),Ue.a.create(h.J(h.count-1)),2)))for(const B of h)if(B.id!==b.id&&!this.km.hza(B,
!0))return 2;return 0}bec(b){if(!this.kga||!({tableNode:r}=this.uIf(b)).returnValue)return!1;b=b.Vnf();for(var h of b)if(!h.nia||!h.isSupported)return!1;if(this.sh.XJm(r))return!1;var r=Object(Ra.a)(Ad.GraphIterator,this.Tg.Qrf(r));h=new mb.a;this.gb.rjb(r,!0,!1,h);for(const B of h)if(0<B.ja(Mc.a.UEb,0)||this.gb.U2a(B).Tx)return!1;return!0}uIf(b){let h=null;return b&&b.yu.toString()===b.Dz.toString()&&b.isValid()&&b.isEditable&&b.isSupported?(h=this.Tg.pu(b.yu))&&14===h.type?{returnValue:!0,tableNode:h}:
{returnValue:!1,tableNode:null}:{returnValue:!1,tableNode:h}}}Object(m.a)(kB,"TableContentControlEditor",null,[373]);class lB{XJm(b){let h=!1;const r=new Ad.GraphIterator;r.set(b);Kf.forEachCellInTable(r,B=>{if(!Ah.TableCellReader.hg(B)){let P=xk.OutlineNavigator.S9(B);for(;P;){if(Uf.OutlineElementReader.Iac(B))return h=!0,!1;P=B.Ti(1)}}return!0});return h}wDi(b,h){const r=new Ad.GraphIterator;r.set(h);return Ah.TableCellReader.Uxa(h)&&r.zb(14)&&r.jd(14).id===b.id?!0:!1}Z4h(b){const h=new mb.a,r=
new Ad.GraphIterator;r.set(b);b=new mb.a;ke.ParagraphReader.rjb(r,!0,!1,b);for(const B of b)h.add(B);return h}}Object(m.a)(lB,"TableReader",null,[372]);class ux{constructor(){this.km=null}get name(){return"WordEditor.ContentControl"}init(){v.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled")&&(Dt.a.FTa(Object(z.a)(Ma.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator"),Ma.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator").ann,"onContentControlRangeChanged")),
this.km=Ma.a.instance.Oa("WordEditor.ContentControl.IContentControlOperator"),Ma.a.instance.resolve("WordEditor.ContentControl.ContentControlCCP").init(),Ma.a.instance.resolve("WordEditor.ContentControl.GlossaryEditor").init())}dispose(){this.km&&(this.km.dispose(),this.km=null)}wc(b){b.ia("WordEditor.ContentControl.Perf.IPerfLogger",()=>new gB.a(Qd.a.$e)).ha();b.ia("WordEditor.ContentControl.ContentControlFactory",()=>new nt(Ma.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlFactory").ha();
b.ia("WordEditor.ContentControlNodeFactory",()=>new Iw(Ma.a.instance.Ta("Box4.ContentControlConfigSettings"),Ma.a.instance.Ta("Box4.ContentControl.IContentControlOperator"))).ha();b.ia("WordEditor.ContentControl.ContentControlGraphManager",()=>new Ks(new pf.a(()=>Eb.App.za.jb.Zc),new pf.a(()=>Eb.App.za.jb.Zc.xd),new Tp.a,qo.PageNavigator.instance,Ma.a.instance.resolve("WordEditor.ContentControlNodeFactory"),Ma.a.instance.resolve("Box4.IOutlineEditor"),Ma.a.instance.resolve("Box4.IOutlineElementEditor"),
Ma.a.instance.resolve("Box4.IParagraphReader"),Ma.a.instance.resolve("WordEditor.IParagraphSplitHelper"),Ma.a.instance.Ta("Box4.ContentControlConfigSettings"),Ma.a.instance.resolve("Box4.ContentControlParagraphMapping"),Ma.a.instance.Ta("WordEditor.ContentControl.GlossaryEditor"),Ma.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"))).as("WordEditor.ContentControl.IContentControlGraphManager").ha();b.ia("WordEditor.ContentControl.GlossaryNavigator",()=>new vz(new Tp.a,new pf.a(()=>
Eb.App.za.jb.Zc),qo.PageNavigator.instance)).as("WordEditor.ContentControl.IGlossaryNavigator").ha();b.ia("WordEditor.ContentControl.ContentControlOperator",()=>new Nr(new pf.a(()=>Eb.App.za.jb.Zc),new pf.a(()=>Eb.App.za.jb.Zc.xd),Ma.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Ma.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),Ma.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),Bh.a.instance,Ma.a.instance.resolve("Box4.ISelectionFactory"),
si.PageReader.instance,Ma.a.instance.resolve("Box4.IFormattingEditor"),Ma.a.instance.resolve("Box4.Styles.IWACStyleReader"),v.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"),Ma.a.instance.Oa("Box4.IContentControlDataChangedManager"),v.AFrameworkApplication.va,Ma.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),v.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),Ma.a.instance.resolve("Box4.IContentControlChpHelper"),Ma.a.instance.Ta("Box4.ContentControlConfigSettings"),
Ma.a.instance.Oa("Box4.IContentControlReader"),Ma.a.instance.resolve("Box4.IParagraphReader"),Ma.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),Ma.a.instance.Ta("Box4.Actors.IVirtualSelectionMerger"),Ma.a.instance.resolve("Box4.IFeatureHelper"),Ma.a.instance.resolve("Box4.ContentControlParagraphMapping"),Ma.a.instance.resolve("Box4.TrackChange.ITrackChangeEditor"),Ma.a.instance.Ta("WordEditor.Extension.RichApiEventManager"))).as("Box4.ContentControl.IContentControlOperator").as("WordEditor.ContentControl.IContentControlOperator").ha();
b.ia("WordEditor.ContentControl.ContentControlManager",()=>new eu(new pf.a(()=>Eb.App.za.jb.Zc),new pf.a(()=>Eb.App.za.jb.Zc.xd),Ma.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Ma.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Ma.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Ma.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),Ma.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),
Ma.a.instance.Ta("Box4.ContentControlConfigSettings"),Ma.a.instance.resolve("Box4.IContentControlChpHelper"),Ma.a.instance.resolve("Box4.IContentControlAroundTableChecker"))).as("WordEditor.ContentControl.IContentControlManager").ha();b.ia("WordEditor.ContentControl.ContentControlChpManager",()=>new uz(Ma.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ma.a.instance.Ta("Box4.ContentControlConfigSettings"),Ma.a.instance.resolve("Box4.IParagraphReader"),Ma.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlChpManager").ha();
b.ia("WordEditor.ContentControl.GlossaryEditor",()=>new qx(Ma.a.instance.resolve("WordEditor.ContentControl.GlossaryNavigator"),Ma.a.instance.resolve("Box4.IOutlineElementEditor"),Ma.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ma.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Ma.a.instance.resolve("Box4.TextFormattingHelper"),Ma.a.instance.resolve("Box4.IFormattingEditor"),Eb.App.si.Il.Ue(55))).as("WordEditor.ContentControl.IGlossaryEditor").ha();b.ia("WordEditor.ContentControl.TableContentControlEditor",
()=>new kB(Ma.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),Ma.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),Ma.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Ma.a.instance.resolve("Box4.IParagraphReader"),new lB,v.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"))).as("WordEditor.ContentControl.ITableContentControlEditor").ha();v.AFrameworkApplication.K.$("WordEditorContentControlInlineBlockConversionIsEnabled")&&
b.ia("Box4.ContentControlConverter",()=>new kC(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IContentControlChpHelper"),b.resolve("Box4.IContentControlReader"),b.resolve("Box4.IFeatureHelper"),b.resolve("Box4.ContentControlParagraphMapping"))).as("Box4.IContentControlConverter").ha();b.ia("WordEditor.ContentControl.ContentControlCCP",()=>new uA(b.resolve("WordEditor.ContentControl.ContentControlOperator"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlGraphManager"),
b.resolve("WordEditor.ContentControl.Perf.IPerfLogger"),b.resolve("Box4.TrackChange.ITrackChangeEditor"))).ha();b.ia("WordEditor.ContentControl.ContentControlFormattingManager",()=>new sx(new pf.a(()=>Eb.App.za.jb.Zc.xd),Ma.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),Ma.a.instance.resolve("Box4.Actors.TextFormattingActor"),Ma.a.instance.resolve("Box4.TextFormattingHelper"),v.AFrameworkApplication.K)).as("WordEditor.ContentControl.IContentControlFormattingManager").ha()}static main(){L.a.instance.Gc(new ux)}}
Object(m.a)(ux,"ContentControlPackage",null,[1,2]);var mB=c(1429),wz=c(507),sy=c(1790),nB=c(790);class vx{constructor(b){this.contextualIntentInvocationSource=10;this.contextualIntentInvocationSource=b}}Object(m.a)(vx,"UxManagerMenuActionTelemetryData",null,[]);class Ft extends Sys.EventArgs{constructor(b,h,r){super();this.definition=b;this.source=h;this.Y2k=r}}Object(m.a)(Ft,"MenuDidCloseEventArgs",Sys.EventArgs,[]);class gu extends Sys.EventArgs{constructor(b,h){super();this.definition=b;this.source=
h}}Object(m.a)(gu,"MenuDidOpenEventArgs",Sys.EventArgs,[]);class oB{constructor(b,h,r,B,P,ca,ra=!1,Qa=null,tb=null,Mb=null,Zb=!1,jc=null,Gc=!1,Uc=!0,od=null,Od=!1,ze=10){this.target=this.container=this.menu=null;this.isDismissed=!1;this.j2c=this.X1c=this.wZh=this.onScroll=this.onResize=this.k1=this.tya=this.JHa=this.documentElement=this.kS=this.editingElement=null;this.isFocused=!1;this.wLd=null;this.x0f=this.UEf=!1;this.Koe=null;this.sae=0;this.paragraphNode=b;this.cpBegin=h;this.cpEnd=r;this.definition=
B;this.pqk=P;this.WRa=ca;this.fPa=ra;this.Qrj=Qa;this.Una=tb;this.hostServices=Mb;this.pwo=Zb;this.H_i=jc;this.csj=Gc;this.zpl=Uc;this.wZh=od;this.showDictationCommandUx=Od;this.source=ze}}Object(m.a)(oB,"UxManagerState",null,[]);var ty=c(1646);class eo{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb){this.Vb=b;this.hb=h;this.bA=r;this.ld=B;this.ge=P;this.Ib=ca;this.Xi=ra;this.tk=Qa;this.YI=tb;this.fVb=Mb;this.hTe=!1;this._state=this.f2g=null;this.shouldIgnoreFocusEvent=Zb=>{var jc;return this.ld.yd.Ny&&!this.ld.yd.TU&&
Zb===(null===(jc=this.ld.xe)||void 0===jc?void 0:jc.editingElement)};this.sa=new Pc.a;this.sxd=new Sb.a;this.jCd((Zb,jc)=>{eo.u6m(r,jc.definition,jc.source)});this.Lqh((Zb,jc)=>{eo.t6m(r,jc.definition,jc.source,jc.Y2k)});this.Vb.fe(eo.iPd).eI=!0;v.AFrameworkApplication.va.ra(qb.a.dMc,yc.a.view,this.dMc.bind(this))}jCd(b){this.sa.addHandler(eo.yPf,b)}J8f(b){this.sa.removeHandler(eo.yPf,b)}vOn(b,h){this.sa.raiseEvent(eo.yPf,new gu(b,h))}Lqh(b){this.sa.addHandler(eo.xPf,b)}u1n(b){this.sa.removeHandler(eo.xPf,
b)}uOn(b,h,r){this.sa.raiseEvent(eo.xPf,new Ft(b,h,r))}t_o(b){var h;if(!b.isDismissed&&b.kS){var r=ty.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(r&&r.length){r=ty.b(r);var B=Qd.a.getElementBounds(b.kS);r.width||r.height?r.x+r.width<B.x||r.x>B.x+B.width||r.y+r.height<B.y||r.y>B.y+B.height?this.dismiss():(B=b.target,B.style.left=r.x+"px",B.style.top=r.y+"px",B.style.width=r.width+"px",B.style.height=r.height+"px",null===(h=b.menu)||void 0===h?void 0:h.updatePosition(),b.menu||t.ULS.sendTraceTag(512255777,
341,50,"Menu is null so can't update position")):(t.ULS.sendTraceTag(50968328,341,15,"Unable to obtain valid updated anchor for UX"),this.dismiss())}else t.ULS.sendTraceTag(50968327,341,15,"Unable to obtain updated anchor for UX"),this.dismiss()}}z6i(b){b.isDismissed||b.Koe||(b.Koe=new Me.a(2,1,1,()=>{b.Koe=null;this.t_o(b)},147),this.Ib.Wb(b.Koe))}JHa(b,h){!b.isDismissed&&b.zpl&&0<h.$J.length&&(this.dismiss(),t.ULS.sendTraceTag(594363728,341,50,"Menu dismissed from selection change (possibly typing)"))}VBk(b){return!!b&&
b.id===eo.sqk}tya(b,h){if(b.isDismissed||!h||!h.Hb)return!1;h=h.Hb;const r=h.keyCode,B=!b.isFocused&&!!b.menu,P=h.altKey||h.ctrlKey||h.shiftKey;let ca=!1;r===se.a.l2?(this.dismiss(),t.ULS.sendTraceTag(594363727,341,50,"Dismiss menu from keyboard"),ca=!0):r!==se.a.Ss&&r!==se.a.Iw||!B||P||!this.VBk(b.definition)?r!==se.a.csb&&r!==se.a.gpc||!B||P||(this.Z3f(b),b.menu?(b.menu.focus(),ca=!0,t.ULS.sendTraceTag(594363725,341,50,"Focus menu from keyboard")):t.ULS.sendTraceTag(576582676,341,50,"Began focus menu from keyboard but dismissed before completion")):
(b.menu.executeDefaultAction(),t.ULS.sendTraceTag(594363726,341,50,"Default action from keyboard"),ca=!0);ca&&(h.preventDefault(),h.stopPropagation());return ca}X1c(b,h){if(b.isDismissed||!b.menu)return t.ULS.sendTraceTag(512255776,341,50,"Could not Badge ID Invoke. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.menu),!1;b.menu.invokeBadgeId(h);t.ULS.sendTraceTag(526463882,341,50,"Badge ID action from dictation correction voice command");return!0}j2c(b,h){if(b.isDismissed||!b.menu)return t.ULS.sendTraceTag(512255775,
341,50,"Could not action from string. menu is dismissed: {0}, null menu: {1}",b.isDismissed,!b.menu),!1;b.menu.executeActionFromString(h);t.ULS.sendTraceTag(526463883,341,50,"Execute action from dictation correction voice command as string");return!0}k1(b,h){if(b.isDismissed||!h||!h.Hb||!b.menu)return t.ULS.sendTraceTag(512255774,341,50,"Could not perform onMouseMove. menu is dismissed: {0}, null mouseEvent: {1}, null mouseEvent.innerEvent: {2}, null menu: {3}",b.isDismissed,!h,!(null===h||void 0===
h?0:h.Hb),!b.menu),!1;const r=b.target;b=b.menu.getElementBounds();var B=h.Hb;h=B.clientX;B=B.clientY;r&&eo.C2i(h,B,Qd.a.getElementBounds(r),16)||b&&eo.C2i(h,B,eo.oMk(b),4)||this.dismiss();return!1}mqo(b){var h=ty.c(b.paragraphNode,b.cpBegin,b.cpEnd);if(!h||!h.length)return!1;h=ty.a(h,"OfficeContextualTarget");if(!h)return!1;b.container=eo.vKc();b.target=h;b.editingElement=this.ld.xe.editingElement;b.kS=this.ld.yd.container;b.documentElement=document.documentElement;b.JHa=(r,B)=>{this.JHa(b,B)};b.tya=
r=>this.tya(b,r);b.k1=r=>this.k1(b,r);b.onScroll=()=>{this.z6i(b)};b.onResize=()=>{this.z6i(b)};b.showDictationCommandUx&&(b.X1c=r=>this.X1c(b,r),b.j2c=r=>this.j2c(b,r),this.fVb&&this.fVb.execute(r=>{r.Glo(b.X1c);r.Ilo(b.j2c)}));document.body.appendChild(b.container);document.body.appendChild(b.target);this.hb.Ww(b.JHa);this.Xi.E_(b.onResize);this.ge.ob(pd.a.lG,b.editingElement,b.tya);b.fPa&&this.tk.ob(pd.a.Ada,b.documentElement,b.k1);He.a.addHandler(b.kS,"scroll",b.onScroll);b.WRa||this.Z3f(b);return!0}zHb(b,
h){const r=!!b.menu;this.uOn(b.definition,b.source,h);b.container&&document.body.removeChild(b.container);b.target&&document.body.removeChild(b.target);b.isFocused&&this.Vb.currentScope.name===eo.iPd&&this.Vb.gS(eo.iPd);b.JHa&&this.hb.hZ(b.JHa);b.tya&&b.editingElement&&this.ge.sc(pd.a.lG,b.editingElement,b.tya);this.fVb&&this.fVb.execute(B=>{b.showDictationCommandUx&&(B.B6n(),B.C6n());B.qmj(!1,b.showDictationCommandUx)});b.k1&&b.documentElement&&b.fPa&&this.tk.sc(pd.a.Ada,b.documentElement,b.k1);
b.onScroll&&b.kS&&He.a.removeHandler(b.kS,"scroll",b.onScroll);b.onResize&&this.Xi.$da(b.onResize);b.menu=null;b.container=null;b.target=null;b.isDismissed=!0;b.editingElement=null;b.documentElement=null;b.kS=null;b.JHa=null;b.tya=null;b.k1=null;b.onScroll=null;b.onResize=null;b.X1c=null;b.j2c=null;r&&b.Una&&(b.UEf?b.x0f=!0:b.Una(b.wLd))}n3a(b,h){var r;if(!h)return!1;switch(h.actionType){case Ko.b.Toggle:if(h.objectFulfillment===eo.yLo)return this.hTe=!this.hTe,this.Tpg(),this.$Lc(b),!0;if(h.objectFulfillment===
eo.CLo)return{value:r}=this.sxd.Fc(h.suggestionGroup.type,!1),this.sxd.Z(h.suggestionGroup.type,!r),this.$Lc(b),!0;break;case Ko.b.GiveFeedback:if(sy.a.mLm(null===(r=h.suggestionGroup)||void 0===r?void 0:r.type)||nB.a.yVm(h.objectName))break;this.focus();this.Tpg();this.$Lc(b);return!0;case Ko.b.RevealSuggestions:this.$Lc(b)}b.UEf=!0;h=b.pqk.executeAction(h,b.paragraphNode,b.cpBegin,b.cpEnd);b.UEf=!1;h&&this.$Lc(b);b.x0f&&(b.x0f=!1,b.Una(b.wLd),b.wLd=null);return h}$Lc(b){b.k1&&b.documentElement&&
b.fPa&&(this.tk.sc(pd.a.Ada,b.documentElement,b.k1),b.fPa=!1)}iuo(b,h){return b.id===wz.a.Heb?!1:!(0<=b.positionInSet&&0<b.setSize)&&!h}oDj(b){var h;if(this.mqo(b)){var r=1;v.AFrameworkApplication.K.$("RenderMultipleSuggestionGroupsInBranfordIsEnabled")&&(r=3);var B=!1;0<(null===(h=b.definition.suggestionGroups)||void 0===h?void 0:h.length)&&(B=b.definition.suggestionGroups[0].type,B=this.sxd.nb(B)?this.sxd.J(B):b.pwo);h=!1;v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FooterIconsInContextualCardIsEnabled",
!1)&&(h=!0);r={containerElement:b.container,targetElement:b.target,definition:b.definition,onAction:P=>this.n3a(b,P),onDismiss:P=>{this.zHb(b,P)},keepCurrentFocus:b.WRa,preventDismissOnScroll:!0,preventDismissOnResize:!0,showSnippet:this.hTe,showDescription:B,showEditorButton:b.csj,showEditorBranding:this.iuo(b.definition,b.csj),hostServices:b.hostServices,maxSuggestionGroupNumber:r,renderFooterIcons:h,shouldIgnoreFocusEvent:this.shouldIgnoreFocusEvent,keyboardHandlerTarget:b.wZh,showDictationCommandUx:b.showDictationCommandUx,
editingElement:b.editingElement};b.H_i&&b.H_i(r);this.bA.createContextualUi(r).then(P=>{this.vOn(b.definition,b.source);b.menu=P;t.ULS.sendTraceTag(512255773,341,50,"Menu was opened");b.Qrj&&b.Qrj();this.fVb&&9!==b.source&&this.fVb.execute(ca=>ca.qmj(!0,b.showDictationCommandUx))}).catch(P=>{this.zHb(b,{wep:mB.a.Unknown});t.ULS.sendTraceTag(50631187,341,10,"Failed to show menu. Error: {0}",P)});0<b.sae&&t.ULS.sendTraceTag(50968329,341,50,"Needed {0} tries to obtain updated anchor for UX",b.sae)}else 5<
++b.sae?(t.ULS.sendTraceTag(50968330,341,15,"Unable to obtain initial anchor for UX after maximum tries -- giving up"),this.dismiss()):this.Ib.Wb(new Me.a(2,1,Math.pow(3,b.sae),()=>{b.isDismissed||this.oDj(b)},146))}get eE(){return!!this._state&&!this._state.isDismissed}set dhe(b){this.f2g=b}get sQm(){return this.f2g}npg(b,h){this.eE&&(this._state.cpBegin=b,this._state.cpEnd=h)}get definition(){return this.eE?this._state.definition:null}set definition(b){this.eE&&(this._state.definition=b,this._state.menu&&
this._state.menu.setDefinition(b))}focus(){this.eE&&this._state.menu&&(this._state.isFocused||this.Z3f(this._state),this._state.menu.focus())}Tpg(){this.eE&&this._state.menu&&this._state.menu.updatePosition()}Z3f(b){this.Vb.EL(eo.iPd,!1);b.isFocused=!0}kka(b,h,r,B,P,ca=null,ra=null,Qa=null,tb=!1,Mb=null,Zb=!1,jc=!0,Gc=null,Uc=!1,od=10){if(!h||this._state&&!this._state.isDismissed)return!1;let Od,ze;if(!({paragraphNode:ze,start:b,end:Od}=eo.ZOo(b)).returnValue)return!1;this._state=new oB(ze,b,Od,h,
r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc,Uc,od);this.oDj(this._state);return!0}iQb(b){this._state&&(this._state.wLd=b)}dMc(b,h,r){if(1===r)return this.eE?32:0;this.eE&&this.dismiss();return 32}dismiss(){var b;this._state&&(this._state.isDismissed=!0,null===(b=this._state.menu)||void 0===b?void 0:b.dismiss())}static u6m(b,h,r){r=new vx(r);b.logAction({actionType:Ko.b.SessionStart,engagement:Ko.a.Try,objectName:eo.Myj,objectId:h.id,data:r});if(h.suggestionGroups)for(const B of h.suggestionGroups)b.logAction({actionType:Ko.b.Presented,
engagement:Ko.a.See,objectName:B.type,objectId:B.id,data:r})}static t6m(b,h,r,B){r=new vx(r);b.logAction({actionType:Ko.b.SessionEnd,engagement:Ko.a.None,objectName:eo.Myj,objectId:h.id,data:r},B)}static vKc(){const b=document.createElement("div");b.id="OfficeContextualContainer";return b}static oMk(b){return new Sys.UI.Bounds(b.left,b.top,b.width,b.height)}static C2i(b,h,r,B){const P=r.y-B,ca=r.x+r.width+B,ra=r.y+r.height+B;return r.x-B<=b&&b<=ca&&P<=h&&h<=ra}static ZOo(b){let h,r;if(!b||!ke.ParagraphReader.Xb(b.node)||
b.contextId!==yc.a.Uc&&b.contextId!==yc.a.Fd&&b.contextId!==yc.a.paragraph)return{returnValue:!1,paragraphNode:null,start:-1,end:-1};r=b.node;b.contextId!==yc.a.paragraph?(h=b.cpBegin,b=b.cpEnd):(h=0,b=r.characterData.length);return{returnValue:!0,paragraphNode:r,start:h,end:b}}qfc(){this.YI&&this.YI.execute(b=>{b.logActivity("WordWebEditorSeen",null)})}}eo.sqk="ActionSet";eo.Myj="IntentGroup";eo.iPd="CanvasContextualUxReact";eo.yLo="Context";eo.CLo="Description";eo.yPf="MenuDidOpen";eo.xPf="MenuDidClose";
Object(m.a)(eo,"UxManager",null,[]);class Cq{constructor(){this.W=null}get name(){return"WordEditor.CanvasContextualProvider"}wc(b){this.W=b}init(){this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{this.wn()})}wn(){v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");const b=v.AFrameworkApplication.K.$("EditorGoalsEnabled"),h=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AIFeedbackSkittleEnabled",!0)&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FA000000029.AiFeedbackEnabled",
!1);(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(63)||ko.a.qRa()||v.AFrameworkApplication.K.$("RewriteIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))&&(v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasContextual"):this.W.resolve("Common.IDynamicScriptLoaderProvider").dA.loadScript("canvasContextual")).then(()=>{this.W.ia("CanvasContextual.ICanvasContextualController",
()=>canvasContextual.FactoryGlobal.getWordContextualControllerInstance({uiCulture:v.AFrameworkApplication.uiCulture,dataCulture:v.AFrameworkApplication.dataCulture,isRightToLeft:v.AFrameworkApplication.isRtl,ulsLogger:new Pl.a,dimeCallback:async()=>{this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").launchUpsellExperience("editorinword")},loadUpsellDependencies:async()=>{this.W.Ta("Common.IInProductMessagingUIManager").execute(r=>{r.UHi()})},getSoftPaywallData:()=>this.W.resolve("WordEditor.EditorUpsell.ISoftPaywallData"),
getPremiumPreviewCritiquesList:()=>this.W.resolve("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),logSystemInitiatedFeedback:async r=>{this.W.Ta("Common.ISystemInitiatedFeedback").execute(B=>B.logActivity(r,null))}})).ha();this.W.ia("WordEditor.CanvasContextualProvider.UxManager",()=>new eo(pc.FocusManager.instance(),this.W.resolve("Box4.ISelectionManager"),this.W.resolve("CanvasContextual.ICanvasContextualController"),hb.InteractiveViewManager.instance,Jb.KeyInputManager.instance,v.AFrameworkApplication.lc,
v.AFrameworkApplication.ua,v.AFrameworkApplication.ua.X1,this.W.Ta("Common.ISystemInitiatedFeedback"),this.W.Ta("WordEditor.DictationCommands.CorrectionCommandUxStateManager"))).ha();this.W.resolve("CanvasContextual.ICanvasContextualController");this.W.resolve("WordEditor.CanvasContextualProvider.UxManager");b&&(this.W.ia("CanvasContextual.IEditorInitializer",()=>canvasContextual.FactoryGlobal.getEditorInitializerInstance({uiCulture:v.AFrameworkApplication.uiCulture,ulsLogger:new Pl.a})).ha(),this.W.resolve("CanvasContextual.IEditorInitializer").init(),
this.W.ia("CanvasContextual.ISkittleControllerV2",()=>canvasContextual.FactoryGlobal.getSkittleControllerV2Instance({ulsLogger:new Pl.a})).ha(),this.W.resolve("CanvasContextual.ISkittleControllerV2"),h&&(this.W.ia("CanvasContextual.IAIFeedbackSkittleController",()=>canvasContextual.FactoryGlobal.getAIFeedbackSkittleControllerInstance({ulsLogger:new Pl.a})).ha(),this.W.resolve("CanvasContextual.IAIFeedbackSkittleController")))}).catch(r=>{t.ULS.sendTraceTag(50422751,341,10,"CanvasContextualProvider - Failed to load Canvas Contextual script. Error: {0}",
r)})}dispose(){}static main(){L.a.instance.Gc(new Cq)}}Object(m.a)(Cq,"PackageManager",null,[1,2]);class Tv{constructor(b,h,r,B){this.VDm=(P,ca,ra)=>{P=null;ca.view.ue&&(P=ca.view);if(!P||!P.mb)return 8;if(!this.LI.PFf())return 2;if(1===ra)return 32;this.jfk.S$k();return 32};this.yNi=(P,ca,ra)=>{let Qa=null;ca.view.ue&&(Qa=ca.view);if(!Qa||!Qa.mb)return 8;if(!this.LI.PFf())return 2;if(1===ra)return 32;if(1!==this.LI.R$b(this.hb.ib,!0).count)return 2;ca=new cg.GraphTransaction(15);try{if(ca.Db(Qa.ed),
!this.LI.bQo(P===qb.a.XOf))return 8}finally{ca&&ca.dispose()}return 32};this.ga=b;this.hb=h;this.LI=r;this.jfk=B}Tb(){this.ga.ra(qb.a.aYd,yc.a.view,this.VDm);this.ga.ra(qb.a.XOf,yc.a.view,this.yNi);this.ga.ra(qb.a.zNi,yc.a.view,this.yNi)}}Object(m.a)(Tv,"IntelligentPlaceholderActor",null,[]);class nD{constructor(){this.xrc=new Sb.a;this.qid=new Sb.a}krk(b,h){let r;({value:r}=this.xrc.Fc(b,r)).returnValue||this.xrc.Z(b,r=new fa.a);r.add(h)}Qrk(b,h){this.qid.nb(b)&&t.ULS.sendTraceTag(50954435,323,15,
"Comment ID already exists for bookmark");this.qid.Z(b,h)}irk(b,h,r){this.krk(b,h);this.Qrk(h,r)}wPl(b){let h;return({value:h}=this.xrc.Fc(b,h)).returnValue?h:null}rSl(b){let h;return({value:h}=this.qid.Fc(b,h)).returnValue?h:null}e1n(b){let h;if(({value:h}=this.xrc.Fc(b,h)).returnValue){for(const r of h)this.qid.remove(r);this.xrc.remove(b)}else t.ULS.sendTraceTag(50954436,323,15,"No bookmarks found for user ID")}}Object(m.a)(nD,"IntelligentPlaceholderAtMentionManager",null,[442]);var pB=c(1698);
class AD extends pB.a{constructor(b,h){super(b,h)}get key(){return"FOLLOW UP"}get $w(){return WordEditorIntl.WordEditorStrings.L_IntelligentPlaceholder}trj(b){return!b.ja(Mc.a.SG,!1)}Vib(){return Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress}}Object(m.a)(AD,"IntelligentPlaceholderDetailsProvider",pB.a,[]);var uy=c(1843),lE=c(2063),mE=c(1847);class oD{constructor(){this.$Aa=""}Xca(b){this.$Aa+=b}zCf(b){this.$Aa+=b}bCf(b){this.$Aa+=b}insertImage(b){this.$Aa+=b}Ssi(b){this.$Aa+=b}}Object(m.a)(oD,
"PlainTextFormatCreator",null,[875]);var BD=c(1637),xz=c(2062);c(327);var RC=c(1697),pD=c(1534);class iv{constructor(){this.cuc=new Sb.a}contains(b){return this.cuc.nb(iv.FJf(b))}add(b){this.cuc.Z(iv.FJf(b),b)}remove(b){this.cuc.remove(iv.FJf(b))}bSo(b){for(const h of b.cuc)this.add(h.value)}rZh(){const b=new mb.a;for(const h of this.cuc)b.add(h.value.Lj);return b}static FJf(b){return b.Lj.toString()}}Object(m.a)(iv,"CommentRangeSet",null,[]);class f extends Sys.EventArgs{constructor(b){super();this.commentNode=
b}}Object(m.a)(f,"OnFollowUpEventArgs",Sys.EventArgs,[]);class w extends f{constructor(b,h){super(b);this.GDn=h}}Object(m.a)(w,"OnCreateEventArgs",f,[]);class E extends f{constructor(b,h){super(b);this.rTm=h}}Object(m.a)(E,"OnResolveEventArgs",f,[]);var X=c(220);class ja{}ja.hre="MentionExperienceDegraded";Object(m.a)(ja,"AtMentionsConstants",null,[]);class Ha{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb){this.A0c=b;this.fIk=h;this.Obd=r;this.sFd=B;this.mb=P;this.Nl=ca;this.tYd=ra;this.Uti=Qa;this.Gv=tb;
this.w3b=Mb;this.iTa=null;this.mtn=(Zb,jc,Gc)=>{t.ULS.sendTraceTag(41178053,323,50,"@ mention selected, callback to replace text");Zb=this.tYd.U3a(Zb,Gc.displayName,Gc.email,Gc.id);this.ariaNotify(String.format(WordEditorIntl.WordEditorStrings.L_AtMentionsSuggestionSelected,jc),!0);Zb?t.ULS.sendTraceTag(558113739,323,50,"Successfully inserted at mentions"):this.w3b.logKpiFailure("LPPWordEditorKPI","FailedToInsertAtMention",{isInternal:!0},{name:ja.hre,isInternal:!0})};this.$rn=(Zb,jc)=>{t.ULS.sendTraceTag(50954434,
323,50,"Permissions received for entity");jc&&this.w3b.Tv(qb.a.XTk);this.tYd.bqm(Zb.id,jc)};this.Rnn=()=>{this.Nl.yd.Ny&&!this.Nl.yd.TU&&this.Nl.xe.lhf?this.lCh=!0:(this.A0c.reset(),t.ULS.sendTraceTag(41178054,323,50,"People picker dismissed off canvas"))};this.Bun=()=>{t.ULS.sendTraceTag(41178055,323,50,"People picker shown on canvas");this.muk()};this.Zrn=(Zb,jc,Gc,Uc=new Map)=>{Uc=Object.assign(new hc.a,{extendedProperties:Uc});this.w3b.logKpiFailure("LPPWordEditorKPI",Zb,{isIntentional:jc,isInternal:Gc,
additionalValues:Uc},{name:ja.hre,errorNameOverride:"LPPFailedToInsertAtMention",isIntentional:jc,isInternal:Gc,additionalValues:Uc})};(b=Ma.a.instance.Oa("Box4.IEditStateEventManager"))&&b.addHandler(X.a.Kua,this.b8n.bind(this))}p0d(){return!!this.iTa}b8n(){this.p0d()&&this.lCh&&(this.iTa.updateInputText(this.pZc,!1),this.lCh=!1)}ariaNotify(b,h){this.Gv.sendNotification(b,h)}muk(){const b=this.Nl.xe.editingElement;if(b){var h=b.getAttribute(Se.a.VGc);b.setAttribute(Se.a.VGc,h?h.toString()+" PeoplePickerAutomationID":
"PeoplePickerAutomationID")}else t.ULS.sendTraceTag(51218125,323,15,"Cannot find editing element")}w0n(){const b=this.Nl.xe.editingElement;if(b){var h=b.getAttribute(Se.a.VGc);h?(h=h.toString().split(" "),Array.remove(h,"PeoplePickerAutomationID"),h.length?b.setAttribute(Se.a.VGc,h.join(" ")):b.removeAttribute(Se.a.VGc)):t.ULS.sendTraceTag(51218127,323,50,"No aria-controls when dismissing picker?")}else t.ULS.sendTraceTag(51218126,323,15,"Cannot find editing element")}OXk(){this.w0n();this.iTa&&this.iTa.updateInputText("a",
!0);const b=document.getElementById("PeoplePicker");b&&document.body.removeChild(b);this.iTa=null;this.Uti.Alj(!0)}kde(){this.A0c.r7f(()=>{this.OXk()});this.A0c.i7f((b,h)=>{this.pZc=b;if(this.iTa)1<this.pZc.length&&"@"===this.pZc.trimEnd()?(this.w3b.Tv(qb.a.WTk),this.A0c.reset()):this.iTa.updateInputText(this.pZc,!1);else if(this.w3b.logKpiUsage("LPPWordEditorKPI",0),this.w3b.Tv(qb.a.Own),(b=this.p0l(h))&&b.height){h=b.y;const r=b.height,B=document.createElement("div");B.id="PeoplePicker";B.style.position=
"absolute";B.style.top=h-5+"px";B.style.left=b.x+"px";B.style.height=r+10+"px";document.body.appendChild(B);this.fIk.createPeoplePicker({editingElementId:this.Nl.xe.editingElement.id,containerElement:B,automationID:"PeoplePickerAutomationID",onReplaceTextCallback:this.mtn,onPermissionsReceivedCallback:this.$rn,onDismiss:this.Rnn,onShow:this.Bun,onFailure:this.Zrn}).then(P=>{P.updateInputText(this.pZc,!1);this.iTa=P;this.Uti.Alj(!1)})}});this.A0c.j7f(b=>{if(this.iTa)this.iTa.onKeyDown(b.Hb.rawEvent)})}p0l(b){var h=
this.mb.ib;if(!h)return null;h=h.lb;if(!h)return null;h=h.Pa;if(!h)return null;h=h.node;if(!h)return null;h=Object(Ra.a)(133,h);if(!h)return null;h=Object(Ra.a)(181,h.zj(this.Nl.yd.$b));if(!h)return null;h=Object(Ra.a)(117,h);if(!h)return null;let r=null;try{r=this.Obd.O_(this.sFd.r9b(2,b),h,!1,!1,!1,!1)}catch(B){t.ULS.sendTraceTag(41178056,323,15,"Failed to get ip bounds due to exception {0}, will use fallback value.",B)}return r}}Object(m.a)(Ha,"WordEditorAtMentionsHandler",null,[406]);var eb=c(1525);
class xb{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc,Uc,od){this.ga=b;this.Yc=h;this.SMa=r;this.hb=B;this.kq=P;this.Md=ca;this.AD=ra;this.pod=Qa;this.Vd=tb;this.Aq=Mb;this.HWj=jc;this.ji=Gc;this.Lc=Zb;this.sa=new Pc.a;this.Sg=Uc;this.mMg=od;pD.a.k0e((Od,ze)=>{this.SG(ze.commentNode,!0)&&this.sa.raiseEvent(xb.c2c)})}arh(b){this.sa.addHandler(xb.GUi,b)}Cyk(b){this.sa.addHandler(xb.SXi,b)}iyk(b){this.sa.addHandler(xb.Qqn,b)}k0e(b){this.sa.addHandler(xb.c2c,b)}SG(b,h){let r=b.ja(Mc.a.SG,!1);h&&(r=r&&
!b.ja(Mc.a.Rba,!1));return r}mdc(b){return this.kq.mdc(b)}h7l(b){for(const h of b)for(const r of h)if(xb.UIf(r.contextId))return r.node.Mc;return null}udm(b,h,r){const B=new iv,P=b.Mc;for(let ca=0;ca<b.qa.length;ca++){const ra=b.qa.J(ca);if(ra.cp>=h)break;if(ra.Te&&ra.Te.length)for(let Qa=0;Qa<ra.Te.length;Qa++){const tb=ra.Te.J(Qa);this.SG(P.Eb(tb.Lj),r)&&(tb.Oc?B.add(tb):B.remove(tb))}}return B}vdm(b,h,r,B){const P=new iv,ca=b.Mc;for(let ra=0;ra<b.qa.length;ra++){const Qa=b.qa.J(ra);if(Qa.cp>r)break;
if(Qa.Te&&Qa.Te.length)for(let tb=0;tb<Qa.Te.length;tb++){const Mb=Qa.Te.J(tb);this.SG(ca.Eb(Mb.Lj),B)&&(Mb.Oc?Qa.cp<r&&P.add(Mb):Qa.cp<=h&&P.remove(Mb))}}return P}Ygi(b,h){let r;const B=b.node;b.contextId!==yc.a.paragraph?(r=b.cpBegin,b=b.cpEnd):(r=0,b=B.characterData.length);return r===b?this.udm(B,r,h):this.vdm(B,r,b,h)}TRc(b,h){return xb.UIf(b.contextId)?this.Ygi(b,h).rZh():new mb.a}R$b(b,h){const r=new iv;for(const B of b)for(const P of B)xb.UIf(P.contextId)&&r.bSo(this.Ygi(P,h));return r.rZh()}PFf(){var b=
this.hb.ib;if(!b||1!==b.length||1!==b.J(0).length)return!1;b=b.J(0).Pa.node;return ke.ParagraphReader.Xb(b)&&!ke.ParagraphReader.uva(b)&&this.kq.Xkb(this.ga,!0)?!0:!1}Usi(b,h){if(!this.PFf())return null;if(this.kq.asm())return t.ULS.sendTraceTag(592761861,323,15,"Placeholder insertion failed because of draft comment"),null;let r=!1;var B=this.hb.ib.J(0).Pa;B.contextId===yc.a.Uc?(b=b?xe.SelectionEditor.j0(B,!1):null)&&b.Yw&&b.Pa.contextId===yc.a.Fd?this.hb.Ac(b):(this.Md.Ge(B,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText+
" ",!0),this.hb.Ac(og.SelectionFactory.lJ(B.node,B.cpBegin,B.cpBegin+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText.length))):r=!0;this.Sg.SDb||uy.a.instance.VUc();b=this.kq.lDb(this.hb.ib.lb);if(!b)return null;this.mdc(b)&&this.mMg.Tv(fb.a.qHa,{succeeded:!0,g9a:29});var P=this.Yc.Rf(b);const ca=P.Ub(1);if(!ca||393229!==ca.Qc)return null;P=P.Ub(2);if(!P||393230!==P.Qc)return null;this.jpg(b.Mc,b.id);this.sa.raiseEvent(xb.GUi,new w(b,h));r&&(h=B.node,B=B.contextId!==yc.a.paragraph?
B.cpEnd:h.characterData.length,this.hb.Ac(og.SelectionFactory.lJ(h,B,B)));return b}aYd(b){return!!this.Usi(!0,b)}hVc(b,h,r,B,P,ca){if(0>h)return!1;B="@"+B;const ra=B+" ",Qa=new cg.GraphTransaction(15);try{Qa.Db(b);this.Md.Ge(Ue.a.createTextRange(b,h,r),ra);this.Vd.xg&&(this.Aq.v8e(b,h,h+B.length),this.Aq.wra(b,h+B.length,h+ra.length,1));const tb=this.AD.fF(Ue.a.createTextRange(b,h,h+B.length),"mailto:"+P,!1,!0,!1);if(!tb)return!1;const Mb=tb.mw;if(!Mb)return t.ULS.sendTraceTag(51217483,323,15,"Insertion of IntelligentPlaceholderWithMention failed"),
!1;this.hb.Ac(og.SelectionFactory.lJ(b,h,h+B.length));const Zb=this.Usi(!1,2);if(!Zb)return!1;ca&&this.pod.irk(ca,Mb,Zb.id);this.hb.Ac(og.SelectionFactory.ne(b,h+ra.length))}finally{Qa&&Qa.dispose()}return!0}U3a(b,h,r,B){const P=this.hb.qg;return xe.SelectionEditor.Ze(P)?this.hVc(P.node,P.cpBegin-b,P.cpBegin,h,r,B):!1}u$l(b){if(1===b.length&&b.J(0).Yw&&(b=b.J(0).Pa,b.contextId===yc.a.Uc&&ke.ParagraphReader.Xb(b.node))){const h=b.node;for(let r=0;r<h.qa.length;r++){const B=h.qa.J(r);if(B.cp===b.cpBegin){b=
B.PTd(!0,!0);if(0<b.length)return b[0].Lj;break}}}return null}XCb(b,h,r){return this.kq.oKc(b,h,r).returnValue}mQd(b,h,r,B,P){let ca=!1;const ra=b.characterData;if(h>=ra.length||r>ra.length||r<h)return{returnValue:!1,KPa:ca};let Qa=h,tb=null;for(let Zb=0;Zb<b.qa.length;Zb++){const jc=b.qa.J(Zb),Gc=jc.cp;if(!(Gc<h)){if(jc.Cm&&tb)try{const Uc=ra.substring(Qa,Gc),od=new lE.a;od.fullName=Uc.startsWith("@")?Uc.substr(1):Uc;RC.a(tb,od);const Od=new mE.a;RC.b(tb,Od);P&&(Od.contentId=this.HWj.onf());B.bCf(Uc,
od,Od);ca=!0;tb=null;Qa=Gc}catch(Uc){var Mb=Object.assign(new hc.a,{extendedProperties:new Map});Mb.extendedProperties.set("exception",Uc.message);this.mMg.logKpiFailure("LPPWordEditorKPI","FailedToRenderAtMention",{isInternal:!0,additionalValues:Mb},{name:ja.hre,isInternal:!0,additionalValues:Mb})}Gc<=r&&!tb&&(Mb=Math.min(Gc,r),Mb>Qa&&B.Xca(ra.substring(Qa,Mb)),Qa=Gc);jc.hyperlink&&jc.hyperlink.PG&&(tb=jc.hyperlink);if(Gc>=r)break}}return{returnValue:!0,KPa:ca}}j5h(b,h,r,B,P=-1){var ca=!1,ra=b.Eb(h),
Qa=b.Eb(eb.k(ra));ra=b.Eb(eb.h(ra));P=0<P?P:Number.MAX_VALUE;b=this.XCb(Qa,h,!0);h=this.XCb(ra,h,!1);if(-1===b||-1===h)return{returnValue:!1,KPa:ca};if(Qa===ra)return this.mQd(Qa,b,h,r,B);const tb=this.SMa.Hna(Qa,!1,!1);if(!tb)return{returnValue:!1,KPa:ca};Qa=new mb.a;let Mb=0;do Qa.add(tb.ex),Mb+=tb.ex.characterData.length;while(tb.ex!==ra&&tb.h9()&&Mb<P);for(P=0;P<Qa.count;P++)if(ca=Qa.J(P),ra=ca.characterData,P)if(P===Qa.count-1){if(!({KPa:ca}=this.mQd(ca,0,h,r,B)).returnValue)return{returnValue:!1,
KPa:ca}}else{if(!({KPa:ca}=this.mQd(ca,0,ra.length,r,B)).returnValue)return{returnValue:!1,KPa:ca};r.Xca("\n")}else{if(!({KPa:ca}=this.mQd(ca,b,ra.length,r,B)).returnValue)return{returnValue:!1,KPa:ca};r.Xca("\n")}return{returnValue:!0,KPa:ca}}lQd(b,h){const r=new oD;return this.j5h(b,h,r,!1,-1).returnValue?r.$Aa:null}KNd(b,h){var r=b.Eb(h);if(!r)return null;b=b.Eb(eb.h(r));if(!b)return null;h=this.XCb(b,h,!1);if(-1===h)return null;r=b.characterData;if(h>=r.length||!F.a.pda(r.charAt(h))){r=this.Lc.Pc(15);
try{r.Db(b),this.Md.Ge(Ue.a.Rc(b,h)," ")}finally{r&&r.dispose()}}return og.SelectionFactory.ne(b,h+1)}jpg(b,h){const r=b.Eb(h),B=new BD.a;this.j5h(b,h,B,!0).returnValue&&(B.Xca("\n"),this.kq.pFj(r,B.Aaa),this.sa.raiseEvent(xb.Uvn))}ldo(b,h){for(const r of b){if(r.contains(h))return!0;for(const B of r)for(const P of h)if(B.node===P.node&&B.Wj>=P.Wj)return!0}return!1}oRh(b,h,r,B,P){const ca=this.hb.ib.clone(),ra=new Ev.a(Eb.App.za.jb.rc);b=og.SelectionFactory.ne(b,h);r=Ue.a.Rc(r,B);b=og.SelectionFactory.Gy(b,
r);this.hb.Ac(b);r=!this.ldo(ca,b);return 32===this.ga.Nf(ra,Nb.a.PH,2,!0,null,null)?(r?this.hb.mZ(ca):P!==V.a.nil&&(P=this.KNd(this.ji.value,P),this.hb.Ac(P)),!0):!1}$Zn(b,h){var r=b.Eb(h);const B=b.Eb(eb.k(r));b=b.Eb(eb.h(r));if(B===b){r=" "+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText;var P=B.characterData.indexOf(r);-1!==P&&this.oRh(B,P,b,P+r.length,h)}}yRh(b,h,r){var B=b.Eb(h);if(!B)return!1;const P=b.Eb(eb.k(B));b=b.Eb(eb.h(B));B=this.XCb(P,h,!0);const ca=this.XCb(b,
h,!1);if(-1===B||-1===ca||!this.oRh(P,B,b,ca,V.a.nil))return!1;r&&this.IRh(h);return!0}IRh(b){this.kq.m8f(b,!0)}bQo(b){var h=this.h7l(this.hb.ib);if(!h)return!1;const r=this.R$b(this.hb.ib,!0);if(1!==r.count)return!1;const B=h.Eb(r.J(0));if(b)h=this.yRh(h,r.J(0),!1);else{const P=eb.k(B),ca=eb.h(B);V.a.Dq(P,ca)||t.ULS.sendTraceTag(592487139,323,15,"User attempted to resolve comment that spans more than 1 paragraph");this.s7k(r.J(0));h.Eb(P).ol(16,!0);h=!0}h&&(B.setValue(Mc.a.Rba,!0),this.sa.raiseEvent(xb.SXi,
new E(B,b)));return h}ixh(b,h){b=this.R$b(this.hb.ib,!1);h.Ro[xb.iTh]=!!b.count}ZVi(b,h){if(h.Ro[xb.iTh]&&ke.ParagraphReader.Xb(h.clone)&&(h=h.clone,b=h.Mc)&&(h=Ue.a.createTextRange(h,0,h.characterData.length),h=this.TRc(h,!1),h.count))for(const r of h)(h=b.Eb(r))&&h.setValue(Mc.a.SG,!1)}cUl(b,h,r){let B;const P=({FIc:tb}=this.kq.oKc(h,r,!0)).returnValue;r=({FIc:B}=this.kq.oKc(h,r,!1)).returnValue;let ca=null,ra=-1,Qa=-1;for(;tb<B;tb++){const Mb=h.qa.J(tb);if(Mb.hyperlink&&Mb.hyperlink.PG&&Mb.hyperlink.mw===
b){ca=Mb.hyperlink;ra=Mb.cp;break}}if(!ca||ra<P)return{returnValue:!1,dLh:ra,cLh:Qa};for(b=tb;b<h.qa.length;b++){var tb=h.qa.J(b);if(tb.cp>r)break;if(tb.HU){Qa=tb.cp;break}}return{returnValue:-1!==Qa,dLh:ra,cLh:Qa}}b0n(b){var h=this.pod.rSl(b);if(h){var r=null;Eb.App.za&&(r=Eb.App.za.jb.Zc.xd);if(r){var B=r.Eb(h);h=r.Eb(eb.k(B));var P=r.Eb(eb.h(B));if(h!==P)t.ULS.sendTraceTag(50954439,323,10,"Mention bookmark has no associated comments");else if(({dLh:b,cLh:P}=this.cUl(b,h,B.id)).returnValue){var ca=
new cg.GraphTransaction(7);try{ca.Db(h);const ra=Ue.a.createTextRange(h,b,P);this.Md.Ge(ra,"");this.jpg(r,B.id)}finally{ca&&ca.dispose()}this.hb.ib&&0<this.hb.ib.length?(r=this.hb.ib.J(0).Pa,r.node===h?t.ULS.sendTraceTag(50954441,323,50,"Moving from cp {0} to {1}",r.cpBegin,b):t.ULS.sendTraceTag(50954442,323,50,"Moving selection to a different node")):t.ULS.sendTraceTag(50954443,323,50,"Unable to find selection start after deleting mention");this.hb.Ac(og.SelectionFactory.ne(h,b))}else t.ULS.sendTraceTag(50954440,
323,15,"Unable to compute hyperlink CPs for bookmark")}else t.ULS.sendTraceTag(50954438,323,15,"Unable to find object space for removing mention")}else t.ULS.sendTraceTag(50954437,323,15,"Mention bookmark has no associated comments")}bqm(b,h){if(!h){h=this.pod.wPl(b);if(!h){t.ULS.sendTraceTag(50954444,323,15,"No bookmarks found for userId");return}for(const r of h)this.b0n(r)}this.pod.e1n(b)}mNl(){uy.a.instance.VUc();const b=new mb.a;for(const r of this.kq.u1e)if(r.$q!==xz.a.beingCreated){var h=V.a.If(r.objectId);
h=this.ji.value.Eb(h);this.SG(h,!0)&&b.add(h)}return b}Lco(b){b=this.kq.zuf(b);this.hb.Ac(b)}s7k(b){b?this.ji.value.Eb(b).setValue(Mc.a.SG,!1):t.ULS.sendTraceTag(594043491,323,10,"The given intelligent placeholder guid is null")}static UIf(b){return b===yc.a.Fd||b===yc.a.Uc||b===yc.a.paragraph}}xb.iTh="DisableNestedIntelligentPlaceholder";xb.GUi="CreateIntelligentPlaceholder";xb.SXi="ResolveIntelligentPlaceholder";xb.Uvn="UpdateIntelligentPlaceholder";xb.c2c="DeleteIntelligentPlaceholder";xb.Qqn=
"MentionAddedToFollowUpEventKey";Object(m.a)(xb,"IntelligentPlaceholderEditor",null,[439,440,441]);class Pb{constructor(b,h,r,B){this.qta=!1;this.zs=!0;this.ge=null;this.jOa=P=>{if(!this.zs||!this.PSk(P,this.hb.ib))return!1;P.Hb.preventDefault();P.Hb.stopPropagation();this.ld.yd&&this.ld.yd.sNc(!1);P=this.KNd(this.hb.ib);if(!P)return!1;this.hb.Ac(P);return!0};this.ld=b;this.ji=h;this.hb=r;this.o7=B}qfb(b,h){this.qta||(b.zxa?(this.rfb(h),this.qta=!0):b.sga(()=>{this.qta||(this.rfb(h),this.qta=!0)}))}dispose(){this.ge&&
this.ge.sc(pd.a.lG,this.ld.xe.editingElement,this.jOa)}rfb(b){this.ge=b;this.ld.yd.Zi&&this.ge.ob(pd.a.lG,this.ld.xe.editingElement,this.jOa)}PSk(b,h){if(b.Hb.keyCode!==se.a.Iw&&b.Hb.keyCode!==se.a.Ss||1!==h.length||!h.J(0).Yw)return!1;var r=this.o7.R$b(h,!0);if(1!==r.count)return!1;const B=h.J(0).Pa.node;if(!ke.ParagraphReader.Xb(B))return!1;b=this.o7.XCb(B,r.J(0),!0);r=this.o7.XCb(B,r.J(0),!1);return h.J(0).Pa.cpBegin<b||h.J(0).Pa.cpEnd>r?!1:!0}KNd(b){b=this.o7.R$b(b,!0);if(1!==b.count)return null;
b=b.J(0);return this.o7.KNd(this.ji.value,b)}Alj(b){this.zs=b}}Object(m.a)(Pb,"IntelligentPlaceholderKeyboardListener",null,[438,9]);class rc{constructor(b,h){this.NFm=r=>{1===r&&this.ga.processAction(fb.a.qHa,2);2===r&&(this.Peh.instance?this.Peh.instance.uoc("https://go.microsoft.com/fwlink/?linkid=2154656")&&F.a.xP("https://go.microsoft.com/fwlink/?linkid=2154656")&&window.open("https://go.microsoft.com/fwlink/?linkid=2154656","_blank"):t.ULS.sendTraceTag(556794450,323,15,"IntelligentPlaceholderPhaseOut Dialog's SafeLinkManager was not ready"));
r=[Object.assign(new ha.a,{name:"DialogResult",int64:r})];Ke.d(qb.a.c2h,void 0,void 0,void 0,void 0,void 0,r)};this.ga=b;this.Peh=h}S$k(){const b=new Tf.StandardDialog;b.Cd=11;b.ze(1,WordEditorIntl.WordEditorStrings.L_TryIt);b.ze(2,WordEditorIntl.WordEditorStrings.L_LearnMore);b.rv(WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsHeader,WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsContent,0,this.NFm);Ke.a("FollowUpsPhaseOutDialogShown")}}Object(m.a)(rc,"IntelligentPlaceholderPhaseOutDialogManager",
null,[]);var Sc=c(1503);class sd{constructor(b,h,r,B,P,ca){this.D7=this.EOe=null;this.t5=()=>{this.D7||(this.D7=new Me.a(3,1,0,()=>{this.D7=null;this.aWd(this.hb.ib)},130),this.Ib.Wb(this.D7))};this.Lc=b;this.LI=h;this.hb=r;this.Ib=B;this.aXe=P;this.ji=ca;this.W2=new If.a;this.Pq=new Sc.a;this.Gah=new De.a(this.W2);this.LI.arh((ra,Qa)=>{this.tuk(Qa.commentNode)})}tuk(b){b=b.id;const h=this.Yei(this.ji.value,b);h&&this.Pq.Z(b,h)}Yei(b,h){const r=b.Eb(h);return!r||this.LI.mdc(r)?null:this.LI.lQd(b,
h)}kNk(b){const h=new Sc.a;var r=this.LI.R$b(b,!0);if(!r)return h;b=this.ji.value;for(const B of r)(r=this.Yei(b,B))&&h.Z(B,r);return h}m8f(b){if(this.EOe){const h=this.Lc.Pc(15);try{h.Db(this.aXe()),this.LI.IRh(this.EOe)}finally{h&&h.dispose()}}this.EOe=b?this.LI.u$l(b):null}Dqm(b){const h=this.ji.value;if(b=b?this.kNk(b):new Sc.a){var r=new De.a(this.W2),B=new De.a(this.W2);sd.gXl(this.Pq,b,r,B);for(var P of r)this.Pq.Z(P,b.J(P));for(const ca of B)if(r=this.Pq.J(ca),B=this.LI.lQd(h,ca),this.Pq.remove(ca),
B&&(b=P=!1,Pa.a.sSc().equals(B,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?(b=!0,r=!1):r=-1<B.indexOf(WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?P=!0:!Pa.a.sSc().equals(r,B),r||P||b)){B=this.Lc.Pc(15);try{B.Db(this.aXe()),b?this.LI.yRh(h,ca,!0):(P&&this.LI.$Zn(h,ca),r&&this.LI.jpg(h,ca))}finally{B&&B.dispose()}}}}u9l(b){const h=new De.a(this.W2);for(const r of b)for(const B of r)b=B.node,ke.ParagraphReader.Xb(b)&&h.add(b.id);return h}Vom(b){var h=
this.ji.value;const r=b?this.u9l(b):new De.a(this.W2);if(r){b=new mb.a;for(const ca of this.Gah)if(!r.contains(ca)){var B=h.Eb(ca);if(B){B=B.qa;for(let ra=0;ra<B.length;ra++){const Qa=B.J(ra).Te;if(Qa)for(let tb=0;tb<Qa.length;tb++){var P=Qa.J(tb);P.Oc&&(P=h.Eb(P.Lj))&&P.ja(Mc.a.qEi,!1)&&V.a.Dq(ca,eb.h(P))&&this.LI.mdc(P)&&b.add(P)}}}}this.Gah=r;if(b.count){h=this.Lc.Pc(7);try{h.Db(this.aXe());for(const ca of b)ca.Cg(Mc.a.qEi)}finally{h&&h.dispose()}}}}aWd(b){this.m8f(b);this.Dqm(b);this.Vom(b)}aCh(){this.D7&&
(this.Ib.ff(this.D7),this.D7=null)}qMb(){if(this.D7||this.ji.pzf)this.aCh(),this.aWd(null)}fC(){this.hb.Ww(this.t5);v.AFrameworkApplication.qI(()=>{this.qMb()})}dispose(){this.hb.hZ(this.t5);this.aCh()}static gXl(b,h,r,B){for(const P of h){const ca=P.key;b.nb(ca)||r.add(ca)}for(const P of b)b=P.key,h.nb(b)||B.add(b)}}Object(m.a)(sd,"IntelligentPlaceholderSelectionCache",null,[9]);var Yd;(function(b){b[b.unknown=0]="unknown";b[b.contextMenu=1]="contextMenu";b[b.atMention=2]="atMention";b[b.Ftp=3]=
"textGesture";b[b.paste=4]="paste";b[b.p8o=5]="workItemIntent";b[b.Ufp=6]="characterTrigger"})(Yd||(Yd={}));Object(m.b)("IntelligentPlaceholderCreation",Yd);class te{constructor(b,h,r,B){this.pBa=b;this.Qm=h;this.cVb=r;this.Cx=B}uie(b){return b&&b.Mc&&b.Mc.id.equals(this.Cx.value.xd.id)?!0:!1}Lqj(b){return this.uie(b)&&b.ja(Mc.a.SG,!1)?!0:!1}R6m(){this.cVb.execute(b=>{b.logAction({actionType:Ko.b.SessionStart,engagement:Ko.a.Offer,objectName:te.nnc})})}k3d(b,h){const r=2==h&&this.uie(b);if(this.Lqj(b)||
r){var B=b.getValue(Mc.a.hF);this.cVb.execute(P=>{P.logAction({actionType:Ko.b.Created,engagement:Ko.a.None,objectName:te.nnc,objectId:B.toString(),objectFulfillment:Yd[h]})})}}M4m(b){if(this.Lqj(b)){var h=b.getValue(Mc.a.hF);this.cVb.execute(r=>{r.logAction({actionType:Ko.b.Deleted,engagement:Ko.a.None,objectName:te.nnc,objectId:h.toString()})})}}r7m(b,h){if(this.uie(b)){var r=b.getValue(Mc.a.hF);this.cVb.execute(B=>{B.logAction({actionType:Ko.b.Resolved,engagement:Ko.a.None,objectName:te.nnc,objectId:r.toString(),
objectFulfillment:h?"RemoveText":"KeepText"})})}}l8m(b){b===qb.a.aYd&&this.cVb.execute(h=>{h.logAction({actionType:Ko.b.Deleted,engagement:Ko.a.None,objectName:te.nnc,objectFulfillment:te.UIo})})}s6m(b){if(this.uie(b)){var h=b.getValue(Mc.a.hF);this.cVb.execute(r=>{r.logAction({actionType:Ko.b.Modified,engagement:Ko.a.None,objectName:te.nnc,objectId:h.toString(),objectFulfillment:"MentionInserted"})})}}jKk(){this.R6m();this.pBa.arh((b,h)=>{this.k3d(h.commentNode,h.GDn)});this.pBa.Cyk((b,h)=>{this.r7m(h.commentNode,
h.rTm)});this.pBa.iyk((b,h)=>{this.s6m(h.commentNode)});this.Qm.M2b((b,h)=>{this.l8m(h.actionId)});pD.a.k0e((b,h)=>{this.M4m(h.commentNode)})}}te.nnc="IntelligentPlaceholder";te.UIo="Undo";Object(m.a)(te,"IntelligentPlaceholderTelemetry",null,[]);class Ge{constructor(){this.o7=this.eqd=this.Iwd=this.W=null}get name(){return"WordEditor.IntelligentPlaceholder"}wc(b){this.W=b;b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager",()=>new rc(v.AFrameworkApplication.va,b.Ta("Common.App.SafeLinks.ISafeLinksManager"))).ha();
b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderAtMentionManager",()=>new nD).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager").ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderEditor",()=>new xb(v.AFrameworkApplication.va,new Tp.a,b.resolve("Box4.IParagraphIteratorFactory"),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.Comments.IWordEditorCommentModel"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.IHyperlinkEditor"),
b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IAtMentionHyperlinkConfigurator"),new pf.a(()=>Eb.App.za.jb.Zc.xd),b.resolve("WordEditor.Comments.CommentsSettings"),this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEventSource").ha();
b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor",()=>new Tv(v.AFrameworkApplication.va,b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),b.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager"))).ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache",()=>new sd(b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),
b.resolve("Box4.ISelectionManager"),v.AFrameworkApplication.lc,()=>Eb.App.za.jb.rc.ed,new pf.a(()=>Eb.App.za.jb.Zc.xd))).ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener",()=>new Pb(hb.InteractiveViewManager.instance,new pf.a(()=>Eb.App.za.jb.Zc.xd),b.resolve("Box4.ISelectionManager"),b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener").ha();b.ia("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry",
()=>new te(b.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),b.resolve("Box4.IUndoManager"),b.Ta("CanvasContextual.ICanvasContextualController"),new pf.a(()=>Eb.App.za.jb.Zc))).ha()}init(){this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{this.wn()})}wn(){const b=this.W.resolve("Box4.IFeatureHelper");this.W.Ta("WordEditor.CanvasContextualProvider.UxManager");this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor").Tb();this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry").jKk();
this.o7=this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor");bt.a.Uwk(Object(z.a)(this.o7,this.o7.ixh,"beforeIntelligentPlaceholderPaste"));bt.a.mCd(Object(z.a)(this.o7,this.o7.ZVi,"onIntelligentPlaceholderPaste"));this.Iwd=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache");b.isFeatureEnabled(98)||this.Iwd.fC();this.eqd=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener");this.eqd.qfb(Eb.App.za.jb,
Jb.KeyInputManager.instance);this.HWn(this.W.Ta("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}dispose(){this.Iwd&&this.Iwd.dispose();this.eqd&&this.eqd.dispose();this.o7&&(bt.a.l1n(Object(z.a)(this.o7,this.o7.ixh,"beforeIntelligentPlaceholderPaste")),bt.a.U1n(Object(z.a)(this.o7,this.o7.ZVi,"onIntelligentPlaceholderPaste")))}HWn(b,h,r){b&&b.execute(B=>{B.D5(new AD(h,r))})}static main(){L.a.instance.Gc(new Ge)}}
Object(m.a)(Ge,"PackageManager",null,[1,2]);var Df=window.FindReplaceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FindReplaceTaskPane",Title:"STR@L_NavigationPaneTitle",Width:"300"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupNavControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Medium",TextAlign:"Left"},
children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnHeadings",Command:"0xD0FBCB6A",LabelText:"STR@L_NavigationPaneHeadingsSubtitle"}},{name:"Button",attrs:{Id:"btnFind",Command:"0x7EC3CC8E",LabelText:"STR@L_Find"}},{name:"Button",attrs:{Id:"btnReplace",Command:"0x8358F6C1",LabelText:"STR@L_Replace"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"TwoRow"},children:[{name:"Row",attrs:{Id:"SearchBoxPlaceholder",DisplayMode:"Medium"}},
{name:"Row",attrs:{Id:"RowFindFilters",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelFilters",Command:"0x2F9A3D80",QueryCommand:"0x5E7080C7"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupReplaceInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"ReplacePlaceholder",DisplayMode:"Medium"}}]}]},{name:"Group",attrs:{Id:"GroupReplaceControls",IsStretched:"false"},children:[{name:"Section",
attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"RowReplaceButtons",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonReplace",Command:"0x3F2E19EE",LabelText:"STR@L_Replace"}},{name:"Button",attrs:{Id:"ButtonReplaceAll",Command:"0x69D75659",LabelText:"STR@L_ReplaceAll"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},
children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelSummary",Command:"0x2F9A3D80",QueryCommand:"0x7F7A1460"}}]}]}]},{name:"Section",attrs:{Type:"OneRow",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{Id:"RowFindButtons",DisplayMode:"Small"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonFindPrevious",Alt:"STR@L_FindPrevious",Command:"0x4457C7F4",QueryCommand:"0x89A9BD2C",Image16by16:"IMGMAP@we@UpArrow_16x16x32",LabelText:"STR@L_FindPrevious"}},
{name:"Button",attrs:{Id:"ButtonFindNext",Alt:"STR@L_FindNext",Command:"0xB28AED00",Image16by16:"IMGMAP@we@DownArrow_16x16x32",QueryCommand:"0x8CA2CFB8",LabelText:"STR@L_FindNext"}}]}]}]}]},{name:"Group",attrs:{Id:"FindResultsPlaceholder",IsStretched:"true"}},{name:"Group",attrs:{Id:"GroupOutOfSyncResultsNotification",IsStretched:"false"}}]}]}]},Yf=c(2112),Pg=c(1987),wd=c(2070);class ve{}ve.GBo="Search_16x16x32";ve.yBo="ClosePaneGlyph_16x16x32";Object(m.a)(ve,"SearchBoxIcons",null,[]);var li=c(2073),
Ei=c(2074),mh=c(2072);class Ch{constructor(){this.HVg=null}get key(){return"FIND_HIT"}get $w(){return WordEditorIntl.WordEditorStrings.l_FindHitContentTitle}reset(b){this.HVg=b.node.fQa()}GJa(b){let h=null;for(const r of this.HVg)if(r.Ec<=b&&b<r.end)return h=Object.assign(new qu.a,{$G:this.key,contentObject:r}),{returnValue:!0,hG:h};return{returnValue:!1,hG:h}}}Object(m.a)(Ch,"FindHitDetailsProvider",null,[414,415]);var el=c(1669),Nl=c(1606),yj=c(1649);class hi{constructor(b,h,r,B,P,ca,ra,Qa=null,
tb=null){this.rm=null;this.find=(Mb,Zb,jc,Gc,Uc)=>1===jc?32:void 0===Uc||null===Uc?8:Uc.length?this.njg(Uc):(this.T6e(wd.a.initial),32);this.findInDocument=(Mb,Zb,jc,Gc,Uc)=>this.Zsj(qb.a.xqb,Mb,Zb,jc,Gc,Uc);this.vDl=(Mb,Zb,jc,Gc,Uc)=>this.Zsj(qb.a.zqb,Mb,Zb,jc,Gc,Uc);this.B0h=(Mb,Zb,jc)=>1===jc?32:this.njg(this.Bo.cQa());this.b5c=(Mb,Zb,jc,Gc,Uc)=>{Mb=!this.Bo.yG;Uc[Sj.a.Image16by16Class]=Mb?we.getImageClass(ve.GBo):we.getImageClass(ve.yBo);Uc[Sj.a.LabelText]=Mb?WordEditorIntl.WordEditorStrings.L_SearchFilterTooltip:
WordEditorIntl.WordEditorStrings.l_SearchFilterCancelTooltip;Uc[Sj.a.ApplyLabelTextToControlOnly]=!0;Uc[Sj.a.EnsureControlRoleIsButton]=!0;Uc[Sj.a.On]=!1;return 32};this.zEl=(Mb,Zb,jc)=>{if(1===jc)return 32;this.tli(!1);return 32};this.KEl=(Mb,Zb,jc)=>{if(1===jc)return 32;this.tli(!0);return 32};this.K4f=(Mb,Zb,jc,Gc,Uc)=>{Uc[pj.a.Visible]=this.Bo.ftj;return 32};this.U4f=(Mb,Zb,jc,Gc,Uc)=>{Uc[pj.a.Visible]=this.Bo.ftj;return 32};this.wVd=(Mb,Zb,jc,Gc,Uc)=>{if(1===jc)return 32;this.eB.R7c.zli(Uc);
return 32};this.cancelSearch=(Mb,Zb,jc)=>{if(1===jc)return 32;this.T6e(wd.a.initial);return 32};this.$Ic=(Mb,Zb,jc)=>{if(1===jc)return 32;this.T6e(wd.a.initial);this.Bo.kC(!1);return 32};this.clearSearch=(Mb,Zb,jc)=>{if(1===jc)return this.uJm(Mb===fb.a.oFh);this.Bo.clearSearch();return 32};this.noe=(Mb,Zb,jc)=>{if(1===jc)return 32;switch(Mb){case fb.a.Ykf:this.Bo.matchCase=!this.Bo.matchCase;break;case fb.a.plf:this.Bo.matchWholeWord=!this.Bo.matchWholeWord}return this.njg(this.Bo.cQa())};this.pbe=
(Mb,Zb,jc,Gc,Uc)=>{Uc[qg.a.On]=this.Bo.matchCase;return 32};this.rbe=(Mb,Zb,jc,Gc,Uc)=>{Uc[qg.a.On]=this.Bo.matchWholeWord;return 32};this.v4f=(Mb,Zb,jc,Gc,Uc)=>{Mb=this.Bo.matchCase;Zb=this.Bo.matchWholeWord;jc="";Mb&&Zb?jc=String.format(WordEditorIntl.WordEditorStrings.l_FindMultipleFiltersLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):Mb?jc=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase):
Zb&&(jc=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));Uc[$h.a.Value]=jc;Uc[$h.a.Visible]=Mb||Zb;return 32};this.Qic=(Mb,Zb,jc,Gc,Uc)=>{Mb=this.Bo.g3;Zb="";switch(this.Bo.yG){case wd.a.startSearch:Zb=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case wd.a.searching:Zb=Mb?this.duf(WordEditorIntl.WordEditorStrings.l_SummarySomeResults):WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case wd.a.searchComplete:Zb=
this.duf(WordEditorIntl.WordEditorStrings.l_SummaryAllResults);break;case wd.a.tooManyResults:Zb=this.duf(this.Bo.HGa?WordEditorIntl.WordEditorStrings.l_SummaryAllResults:WordEditorIntl.WordEditorStrings.l_SummarySomeResults);break;case wd.a.noMatchesFound:Zb=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case wd.a.replaceAllInProgress:Zb=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgress;break;case wd.a.replaceAllComplete:Zb=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}Uc[$h.a.Value]=
Zb;return 32};this.qbe=(Mb,Zb,jc,Gc,Uc)=>{Uc&&(Uc.CommandValueId=this.Bo.cQa());return 32};this.replace=(Mb,Zb,jc,Gc,Uc)=>{if(1===jc)return this.zHf()?32:8;if(!this.zHf())return 8;Mb=this.Bo.YGb();"string"===typeof Uc&&Uc&&(Mb=Uc);t.ULS.sendTraceTag(6033813,312,50,"Replace Called");Ke.a("NavigationPaneReplace");Uc=this.Myb.replace(Mb);this.Bo.Ago(Uc);return 32};this.replaceAll=(Mb,Zb,jc,Gc,Uc)=>{if(1===jc)return this.yTm()?32:8;Mb=this.Bo.YGb();"string"===typeof Uc&&Uc&&(Mb=Uc);Ke.a("NavigationPaneReplace");
this.rm=this.je.Zf("UserAction","ReplaceAll");this.Bo.m8(wd.a.replaceAllInProgress);t.ULS.sendTraceTag(4065348,312,50,"Replace All started feedback indicated to user.");yj.a.Y3n(this.Bo.cQa(),this.Bo.YGb());this.Myb.replaceAll(Mb,this.ktn);return 32};this.ktn=(Mb,Zb)=>{this.rm&&(this.rm.stop(),this.rm=null);t.ULS.sendTraceTag(4065349,312,50,"{0}",{["ReplaceAll Complete.ReplaceCount"]:Mb,["TotalCount"]:Zb});yj.a.V3n(Mb,Zb);this.Bo.m8(wd.a.replaceAllComplete)};this.S5i=(Mb,Zb,jc,Gc,Uc)=>{Zb=!1;if(!Uc)return 8;
this.Bo.lj.isVisible&&(Zb=Mb===qb.a.v5c===this.Bo.ORc());Mb!==qb.a.v5c||this.M2g||(Zb=!1);Uc[qg.a.On]=Zb;return 32};this.w4f=(Mb,Zb,jc,Gc,Uc)=>{if(!Uc||!this.Bo.lj.isVisible)return 32;Uc[qg.a.On]=this.Bo.HGa;return 32};this.y4f=(Mb,Zb,jc,Gc,Uc)=>{if(!Uc)return 32;Uc.currentFindReplaceViewType=this.Bo.yG;return 32};this.bMn=(Mb,Zb,jc,Gc,Uc)=>{if(1===jc)return 32;Mb=Uc[qg.a.On];Uc&&(Uc[qg.a.On]=this.Bo.lj.isVisible);Mb&&!Uc[qg.a.On]&&(hi.JBj(),Ke.a("NavigationPaneCrossClick"));return 32};this.R8a=(Mb,
Zb,jc,Gc,Uc)=>{const od=this.Bo.lj.isVisible;t.ULS.sendTraceTag(42501021,367,50,"Visibility: {0}",od);return od?this.$Ic(Mb,Zb,jc,Gc,Uc):this.Xlc(Mb,Zb,jc,Gc,Uc)};this.Xlc=(Mb,Zb,jc,Gc,Uc)=>{if(1===jc)return kc.SessionStatusManager.instance.cD?32:8;if(2===jc){v.AFrameworkApplication.fqa("AutoDetectedHeadingsIsEnabled");hi.JBj();this.E5();el.FindReplaceUIManager.AQk(Mb,Uc,this.Bo.lj.isVisible);Zb=!0;Mb===qb.a.amc&&void 0!==Uc&&null!==Uc&&(Zb=Uc);this.Bo.kC(!0,Zb);Uc=mh.a.initial;switch(Mb){case qb.a.Ylc:t.ULS.sendTraceTag(42501022,
367,50,"");Uc=mh.a.headings;break;case qb.a.xqb:Uc=mh.a.find;break;case qb.a.zqb:Uc=mh.a.replace;break;case qb.a.amc:Uc=mh.a.intelligentPlaceholder;break;case qb.a.R8a:Uc=this.Bo.v6b,Uc||(t.ULS.sendTraceTag(42501023,367,50,""),Uc=mh.a.headings)}this.Bo.slo(Uc,Zb);return 32}return 8};this.vHa=()=>{this.Bo.yG&&!this.Bo.HGa&&t.ULS.sendTraceTag(5007322,312,50,"App closed when find is in progress.")};this.ga=b;this.Bo=h;this.eB=r;this.Myb=B;this.M2g=P;this.je=ra;tb&&tb(1,this.vHa,null);this.HLa=Qa}E5(){}Tb(){this.ga.fb(qb.a.j5f,
yc.a.view,this.bMn,96);this.ga.ra(qb.a.R8a,yc.a.view,this.R8a);this.ga.ra(qb.a.Ylc,yc.a.view,this.Xlc);this.ga.ra(qb.a.xqb,yc.a.view,this.Xlc);this.ga.ra(Nb.a.clf,yc.a.view,this.find);this.ga.ra(fb.a.findInDocument,yc.a.view,this.findInDocument);this.ga.ra(Nb.a.blf,yc.a.view,this.B0h);this.ga.fb(fb.a.CLn,yc.a.view,this.b5c,97);this.ga.ra(Nb.a.GTf,yc.a.view,this.zEl);this.ga.ra(Nb.a.D2f,yc.a.view,this.KEl);this.ga.fb(Nb.a.K4f,yc.a.view,this.K4f,97);this.ga.fb(Nb.a.U4f,yc.a.view,this.U4f,97);this.ga.ra(qb.a.wVd,
yc.a.view,this.wVd);this.ga.ra(Nb.a.s4b,yc.a.view,this.cancelSearch);this.ga.ra(fb.a.clearSearch,yc.a.view,this.clearSearch);this.ga.ra(fb.a.oFh,yc.a.application,this.clearSearch);this.ga.ra(qb.a.$Ic,yc.a.view,this.$Ic);this.ga.ra(fb.a.Ykf,yc.a.view,this.noe);this.ga.ra(fb.a.plf,yc.a.view,this.noe);this.ga.fb(fb.a.pbe,yc.a.view,this.pbe,97);this.ga.fb(fb.a.rbe,yc.a.view,this.rbe,97);this.ga.fb(qb.a.v4f,yc.a.view,this.v4f,97);this.ga.fb(qb.a.Qic,yc.a.view,this.Qic,97);this.ga.fb(qb.a.w4f,yc.a.view,
this.w4f,97);this.ga.fb(qb.a.y4f,yc.a.view,this.y4f,97);this.ga.fb(qb.a.x4f,yc.a.view,this.S5i,97);Object(Nl.b)()&&this.ga.fb(qb.a.qbe,yc.a.view,this.qbe,96);this.M2g&&(this.ga.fb(qb.a.zqb,yc.a.view,this.Xlc,1028),this.ga.fb(qb.a.v5c,yc.a.view,this.S5i,97),this.ga.fb(qb.a.replace,yc.a.view,this.replace,1028),this.ga.fb(qb.a.replaceAll,yc.a.view,this.replaceAll,1028),v.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",
!1)&&this.ga.fb(fb.a.jlf,yc.a.view,this.vDl,1028));this.ga.ra(qb.a.amc,yc.a.view,this.Xlc)}W6f(){this.HLa&&this.HLa.execute(b=>{b.D5(new Ch)})}Zsj(b,h,r,B,P,ca){if(1===B)return kc.SessionStatusManager.instance.cD?32:8;if(void 0===ca||null===ca)return 8;this.Xlc(b,r,2,P,ca);b=this.Bo;b.vdg(ca.CommandValueId);Object(Nl.b)()&&("MatchCase"in ca&&(b.matchCase=ca.MatchCase),"MatchWholeWord"in ca&&(b.matchWholeWord=ca.MatchWholeWord));return this.B0h(h,r,B,P,ca)}njg(b){if(void 0===b||null===b||!b.length)return 32;
b=li.a.createQuery(b,this.HLn);if(void 0===b||null===b)return t.ULS.sendTraceTag(4069067,312,10,"InvalidQuery"),8;this.eB.find(b);return 32}get HLn(){let b=Ei.a.none;this.Bo.matchCase&&(b|=Ei.a.matchCase);this.Bo.matchWholeWord&&(b|=Ei.a.wholeWordOnly);return b}tli(b){this.Bo.v6b!==mh.a.headings&&this.Bo.g3&&(b?this.eB.R7c.xmm():this.eB.R7c.vli())}T6e(b){this.Bo.yG&&(this.Bo.HGa||t.ULS.sendTraceTag(5007321,312,50,"User action resulting in cancelling find operation in progress."),this.eB.g0a(),this.Bo.m8(b))}uJm(b){return this.Bo.yG===
wd.a.replaceAllInProgress||b&&!this.Bo.yG?8:32}duf(b){return String.format(b,this.Bo.sjd,this.Bo.g3)}zHf(){return this.Bo.ORc()&&0<this.Bo.g3}yTm(){return this.zHf()&&this.Bo.HGa}static JBj(){null!=v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("NavPaneFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ma.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("NavPaneUsed","NavPaneFloodgateIsEnabled")})},hi.xEa)}static iYl(b,h,r,B){return new hi(v.AFrameworkApplication.va,
b,h,r,B,pc.FocusManager.instance(),Eb.App.za.Lq,Ma.a.instance.Ta("Box4.Accessibility.IAccessibilityContextManager"),Object(z.a)(v.AFrameworkApplication.ua.aQ,v.AFrameworkApplication.ua.aQ.ob,"registerHandler"))}static hYl(b,h,r,B){return hi.iYl(b,h,r,B)}}hi.xEa=5E3;Object(m.a)(hi,"FindReplaceActor",null,[]);var ok=c(911),qj=function(){function b(){this._map=new Map}Object.defineProperty(b.prototype,"first",{get:function(){return this.xK},set:function(h){this.xK=h},enumerable:!1,configurable:!0});
Object.defineProperty(b.prototype,"last",{get:function(){return this.ZXa},enumerable:!1,configurable:!0});b.prototype.length=function(){return this._map.size};b.prototype.get=function(h){return this._map.get(h)};b.prototype.insert=function(h,r){this.removeItem(h);r={key:h,pV:this.ZXa,next:void 0,data:r};this.first||(this.first=r);this.ZXa&&(this.ZXa.next=r);this.ZXa=r;this._map.set(h,r)};b.prototype.insertAfter=function(h,r,B){h=this._map.get(h);if(!h)return!1;B={key:r,pV:h,next:h.next,data:B};var P=
h.next;P&&(P.pV=B);h.next=B;this._map.set(r,B);return!0};b.prototype.insertBefore=function(h,r,B){h=this._map.get(h);if(!h)return!1;B={key:r,pV:h.pV,next:h,data:B};var P=h.pV;P&&(P.next=B);h.pV=B;this._map.set(r,B);return!0};b.prototype.removeItem=function(h){var r=this._map.get(h);r&&(this.first===r&&(this.first=r.next),this.ZXa===r&&(this.ZXa=r.pV),r.pV&&(r.pV.next=r.next),r.next&&(r.next.pV=r.pV),this._map.delete(h))};return b}();class gj{constructor(){this.type="heading"}}Object(m.a)(gj,"NavPaneHeadingItem",
null,[]);class dk{constructor(){this.type="bookmark"}}Object(m.a)(dk,"NavPaneBookmarkItem",null,[]);class Eh{constructor(b,h,r,B,P,ca,ra){this.gb=b;this.hb=h;this.Vb=r;this.An=B;this.lV=P;this.bG=ca;this.N5j=ra;this.$Ya=0;this.psd=new Map;this.HYg=!1;this.OAa=new Map}get headingsReady(){return this.HYg}set headingsReady(b){this.HYg=b}get gOb(){return this.$Ya}get h$(){this.WZb&&0!=this.WZb.length()||(this.WZb=this.DGn());return this.WZb}set h$(b){this.WZb=b}get Bkc(){return this.Bik}set Bkc(b){this.Bkc&&
(this.Bkc.isSelected=!1);b.isSelected=!0;this.Bik=b}Gsf(b,h){return"bookmark"===b.type?b.text:h.id.toString()}DGn(){const b=new qj;if(!this.lV)return b;this.psd=new Map;let h;const r=[];for(const B of this.lV.paragraphs()){const P=this.Qci(B,r);null===P||void 0===P?void 0:P.forEach(ca=>{(h=this.Gei(ca,r))&&"heading"===h.type&&h.indentLevel<ca.indentLevel&&(1>=h.indentLevel?(h.isCollapsed=!1,ca.isHidden=!1):(h.isCollapsed=!0,ca.isHidden=!0));b.insert(this.Gsf(ca,B),ca)})}return b}Gei(b,h){return"heading"===
b.type?1<h.length?h[h.length-2]:void 0:0<h.length?h[h.length-1]:void 0}Vpg(b){var h;let r=ke.ParagraphReader.Koa(b),B=!1;9===r&&this.OAa.has(b.id.toString())&&(r=this.OAa.get(b.id.toString()),B=!0);const P=null===(h=this.h$.get(b.id.toString()))||void 0===h?void 0:h.data;if(P){if(P.indentLevel===r){h=oi.AParagraphNode.UP(b.characterData.trim());b=this.An.value.J_f(b);if(h!==P.text||P.hasBookmark!==b)return P.text=h,P.hasBookmark=b,!0;!B&&P.isPurelyADH&&(P.isPurelyADH=!1,--this.$Ya);return!1}this.n4c();
return!0}if(9===r)return this.fIm(b)?(this.n4c(),!0):!1;this.n4c();return!0}fIm(b){var h;const r=this.An.value.X5h(b);b=null!==(h=this.psd.get(b.id.toString()))&&void 0!==h?h:0;if(b!==r.length)return!0;for(h=0;h<b;++h)if(!this.h$.get(r[h].SPa()))return!0;return!1}Xkl(b){if(this.h$.get(b.id.toString())||this.An.value.J_f(b))return this.n4c(),!0;this.OAa.has(b.id.toString())&&(this.OAa.delete(b.id.toString()),--this.$Ya);return!1}n4c(){const b=new qj;this.$Ya=0;if(this.lV){this.psd=new Map;var h=[],
r,B;for(const P of this.lV.paragraphs()){const ca=this.Qci(P,h);null===ca||void 0===ca?void 0:ca.forEach(ra=>{var Qa=this.Gsf(ra,P);B=this.Gei(ra,h);this.o8n(Qa,ra,B);b.insert(Qa,ra);"heading"===(null===r||void 0===r?void 0:r.type)&&(Qa=r,Qa.indentLevel>=ra.indentLevel&&(Qa.isCollapsed=void 0));r=ra})}}this.h$=b}o8n(b,h,r){var B,P;if(b=null===(B=this.WZb.get(b))||void 0===B?void 0:B.data)b.isSelected&&(h.isSelected=!0,this.Bkc=h),h.isHidden=b.isHidden;if(r){if(B=null===(P=this.WZb.get(this.Gsf(r,
r.paragraphNode)))||void 0===P?void 0:P.data)r.isCollapsed=B.isCollapsed;r.isCollapsed?h.isHidden=!0:r.isHidden?(r.isCollapsed=!0,h.isHidden=!0):(r.isCollapsed=!1,h.isHidden=!1)}}Qci(b,h){var r=ke.ParagraphReader.Koa(b),B=!this.AFf(b);const P=this.bOm(r)&&B?!0:!1;B=this.OAa.has(b.id.toString())&&B;const ca=[];if(P)ca.push(this.wMh(b,r,!1,h));else if(B)this.$Ya+=1,this.NNc&&(r=this.OAa.get(b.id.toString()),ca.push(this.wMh(b,r,!0,h)));else{let ra=0;this.An.value.X5h(b).forEach(Qa=>{const tb=new dk;
tb.text=Qa.SPa();tb.isSelected=!1;tb.bookmarkManager=this.An;tb.indentLevel=0<h.length?h[h.length-1].indentLevel+1:0;ra+=1;ca.push(tb)});this.psd.set(b.id.toString(),ra)}return ca}wMh(b,h,r,B){var P,ca;const ra=new gj;ra.text=oi.AParagraphNode.UP(b.characterData.trim());ra.indentLevel=h;ra.paragraphNode=b;ra.isSelected=!1;ra.isPurelyADH=r;ra.listMarker=this.Wsf(b);ra.hasBookmark=this.An.value.J_f(b);for(b=null===(P=B[B.length-1])||void 0===P?void 0:P.indentLevel;b&&b>=h;)B.pop(),b=null===(ca=B[B.length-
1])||void 0===ca?void 0:ca.indentLevel;(!b||b<h)&&B.push(ra);return ra}AFf(b){return this.gb.Xb(b)&&0===this.gb.textLength(b,9)}Ezl(b){(b=this.h$.get(b))&&(1==b.data.isCollapsed?this.ktj(b):this.Lum(b))}onClickHeading(b){var h;this.Bkc=b=null===(h=this.h$.get(b))||void 0===h?void 0:h.data;h=og.SelectionFactory.ne(b.paragraphNode,0);this.hb.Ac(h);this.Vb.mg(Dd.AFrame.In)}onClickBookmark(b){var h;this.Bkc=b=null===(h=this.h$.get(b))||void 0===h?void 0:h.data;this.An.value.lli(b.text);this.Vb.mg(Dd.AFrame.In)}onShareHeadingClick(b){var h;
v.AFrameworkApplication.oe("NavPaneShareHeadingLink-tf;NavPaneShareHeadingLink-cf");Ke.a("CreateHeadingLinkThroughNavPane",!0,void 0);if(b=null===(h=this.h$.get(b))||void 0===h?void 0:h.data)h=b.paragraphNode.getValue(Mc.a.Wc),this.N5j.value.xMh(h)}fpg(b,h){const r=b.id.toString(),B=this.OAa.has(r);if(!B||this.OAa.get(r)!==h){this.OAa.set(r,h);if(this.NNc)return this.Vpg(b);B||this.h$.get(r)||(this.$Ya+=1)}return!1}pkl(b){const h=b.id.toString(),r=this.OAa.has(h);if(r){this.OAa.delete(h);if(this.NNc)return this.Vpg(b);
r&&!this.h$.get(h)&&--this.$Ya}return!1}tLo(b){this.NNc=b;this.n4c()}Fpg(b){var h;const r=null===(h=this.h$.get(b.id.toString()))||void 0===h?void 0:h.data;if(!r)return!1;b=this.Wsf(b);if(r.listMarker===b)return!1;this.VTo();return!0}TKd(b){var h;b=null===(h=this.h$.get(b.id.toString()))||void 0===h?void 0:h.data;if(!b||void 0===b.listMarker)return!1;b.listMarker=void 0;return!0}ktj(b){var h=b.data;1==h.isCollapsed&&(h.isCollapsed=!1);h=h.indentLevel;b=b.next;let r;for(;b&&b.data.indentLevel>h;)r=
b,b=r.next,r.data.isHidden=!1,"heading"==r.data.type&&(b=r.data.isCollapsed?this.Ozo(r):this.ktj(r));return b}Lum(b){var h=b.data;h.isCollapsed=!0;h=h.indentLevel;b=b.next;let r;for(;b&&b.data.indentLevel>h;)r=b,b=r.next,r.data.isHidden=!0}Ozo(b){const h=b.data.indentLevel;for(b=b.next;b&&b.data.indentLevel>h;)b=b.next;return b}bOm(b){return 0<=b&&8>=b}VTo(){let b=this.h$.first;for(;b;){if("heading"===b.data.type){const h=b.data;h.listMarker=this.Wsf(h.paragraphNode)}b=b.next}}Wsf(b){var h;if(b.ND instanceof
ok.a)return this.kkm(null===(h=this.bG.Bmb(b.ND))||void 0===h?void 0:h.J9)}kkm(b){for(let h=0;h<(null===b||void 0===b?void 0:b.length);)return 128<=b.charCodeAt(h)?void 0:b}}Object(m.a)(Eh,"NavPaneHeadingsManager",null,[]);var pq=c(1607);class Ud{constructor(){this.Myb=this.eB=this.svc=this.Gld=this.W=null}get name(){return"WordEditor.FindReplace"}wc(b){this.W=b;const h=new Eh(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.ISelectionManager"),pc.FocusManager.instance(),b.Ve("WordEditor.Bookmark.IBookmarkManager"),
b.resolve("Box4.IParagraphCollection"),b.resolve("Box4.IListMarkerUtility"),b.Ve("WordEditor.Actors.HeadingsActor"));this.W.ia("WordEditor.FindReplace.NavPaneHeadingsManager",()=>h).as("WordEditor.FindReplace.NavPaneHeadingsManager").ha()}init(){Ud.Zb.pq.continueWith(()=>{this.wn()})}wn(){if(Eb.App.xsg){const b=Eb.App.Wpe;this.svc=el.FindReplaceUIManager.getInstance(b);this.eB=Pg.FindManager.createInstance(this.svc,Yf.a.instance,pq.a.instance,!0);this.Myb=this.eB.fPb;this.Gld=hi.hYl(this.svc,this.eB,
this.Myb,b);this.Gld.Tb();this.Gld.E5();this.Gld.W6f();Eb.App.za.updateCommandUI()}}dispose(){this.svc&&this.svc.dispose()}static get Zb(){return null!=Ud.$yg?Ud.$yg:Ud.$yg=Ma.a.instance.resolve("Box4.IFeatureHelper")}}Object(m.a)(Ud,"FindReplacePackageManager",null,[1,2]);class d{constructor(){}onf(){return"_@_"+Bb.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+"Z"}PWo(b,h,r,B){h.Cgo(b,B);h.hm(b,Pd.a.Z$,!0);h.hm(b,Mc.a.MRa,!0);h.hm(b,Mc.a.UX,d.u_h(r));h.hm(b,Mc.a.Qs,15)}mAk(b,h,
r,B){const P=b.bJd(B);h.hm(P,Pd.a.Z$,!0);h.hm(P,Mc.a.Qs,47);h.hm(P,Mc.a.UX,d.u_h(r));b=b.bJd(B);h.hm(b,Pd.a.Z$,!0);h.hm(b,Mc.a.Qs,16);return[P.Yj,b.Yj]}WKl(b,h,r){b=b.bJd(r);h.hm(b,Pd.a.Z$,!0);h.hm(b,Mc.a.$Jb,!0);return b.Yj}static u_h(b){return String.format(' HYPERLINK "{0}"',b)}}Object(m.a)(d,"AtMentionHyperlinkConfigurator",null,[407]);class n{constructor(b,h,r){this.TBa=b;this.hb=h;this.fni=this.Evi=this.uGe=!1;this.GMb=this.GMb.bind(this);this.HMb=this.HMb.bind(this);this.RMb=this.RMb.bind(this);
r&&r.execute(B=>{this.HWa=B});Jr.a.TDd.Spf.then(B=>{this.fni=!0;this.Evi=B.isSuccess})}kde(){this.TBa.i7f(this.GMb);this.TBa.j7f(this.HMb);this.TBa.r7f(this.RMb)}p0d(){return!1}GMb(b,h,r){var B,P;h=Date.now();if(this.HWa)if(this.fni&&!this.Evi)t.ULS.sendTraceTag(512369951,3034,10,"ContextIQUserInitHandler::onInputCallback - AugLoop Auth Token is not valid.");else{var ca=null===(P=null===(B=this.hb.ib)||void 0===B?void 0:B.lb)||void 0===P?void 0:P.Tc;ca?(B=ca.node,ke.ParagraphReader.Xb(B)?(P=ke.ParagraphReader.text(B),
0>r||r>P.length?t.ULS.sendTraceTag(540340298,3034,50,"ContextIQUserInitHandler::onInputCallback - Position of the @ was not within the bounds of the paragraph."):1<b.length&&"@"===b.trimEnd()?(Ke.c(qb.a.q6k,!0,void 0,void 0,void 0,void 0),this.TBa.reset()):(this.uGe?this.HWa.rXo():(this.uGe=!0,this.HWa.Pyo(ca)),this.HWa.npg(r,r+b.length),b=P.substring(0,r)+b,this.HWa.Bnf(B,b,r,h))):t.ULS.sendTraceTag(540541835,3034,10,"ContextIQUserInitHandler::onInputCallback - Current node is not a paragraph.")):
t.ULS.sendTraceTag(540541834,3034,10,"ContextIQUserInitHandler::onInputCallback - Failed to get the current selection context.")}else t.ULS.sendTraceTag(537776153,3034,10,"ContextIQUserInitHandler::onInputCallback - ContextIQIntentProvider is not available yet.")}HMb(b){if(this.HWa)this.HWa.onKeyDown(b)}RMb(){this.uGe=!1;this.HWa&&this.HWa.WFh()}}Object(m.a)(n,"ContextIQUserInitHandler",null,[406]);var A=c(1679);class T{constructor(){this.bA=null}get name(){return"WordEditor.AtMentions"}wc(b){this.W=
b;b.ia("Box4.IAtMentionHyperlinkConfigurator",()=>new d(b.resolve("Box4.IFeatureHelper"))).ha();const h={crewAlias:T.oNj,featureName:T.XOj,topLevelKpiName:T.tSj,vetoPillar:7};b.ia("WordEditor.AtMentions.IFeatureUsageAndHealthLogger",()=>new Nt.a(va.Health.instance,new Iq.a,h)).as("WordEditor.AtMentions.IFeatureUsageAndHealthLogger").ha()}init(){this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{this.wn()})}dispose(){}wn(){this.W.Ta("Common.App.People.IExternalPeopleAPI").execute(b=>{b.atMentionsEnabledAsync().then(h=>
{v.AFrameworkApplication.K.$("ConsumerMentionsHostIsEnabled")&&(h=h&&v.AFrameworkApplication.K.$("WordEditorConsumerCanvasMentionsIsEnabled"));(h||A.a.vfd())&&this.j2m()})});this.W.resolve("Box4.IAtMentionHyperlinkConfigurator")}j2m(){(v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasAtMentions"):this.W.resolve("Common.IDynamicScriptLoaderProvider").dA.loadScript("canvasAtMentions")).then(()=>{v.AFrameworkApplication.K.Nn(()=>{this.dVn()})})}dVn(){const b=
{peopleAPI:this.W.resolve("Common.App.People.IExternalPeopleAPI"),localizationDetails:{isRightToLeft:v.AFrameworkApplication.isRtl,appLocale:Sys.CultureInfo.CurrentCulture.name},useLPP:!0,isTestEnv:this.mWm()};this.bA=canvasAtMentions.FactoryGlobal.getWordAtMentionsControllerInstance(b);this.W.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(h=>{h.isFeatureEnabled("MsoContextIq",!1).then(r=>{r&&A.a.wfd()||!r&&A.a.vfd()?(A.a.WDf=!r,this.W.ia("WordEditor.AtMentions.IWordEditorAtMentionsHandler",
()=>new n(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.W.resolve("Box4.ISelectionManager"),this.W.Ta("WordEditor.CanvasContextual.ContextIQIntentProvider"))).ha()):this.W.ia("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new Ha(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.bA,this.W.resolve("Box4.ITextMetricsAdapter"),this.W.resolve("Box4.ICaretPositionManager"),this.W.resolve("Box4.ISelectionManager"),hb.InteractiveViewManager.instance,this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),
this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener"),this.W.resolve("Common.Utils.IAriaNotifier"),this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).ha();this.W.resolve("WordEditor.AtMentions.IWordEditorAtMentionsHandler").kde()})})}mWm(){var b,h;const r=null!==(b=v.AFrameworkApplication.sessionStartInfoSettings.Ring)&&void 0!==b?b:"-1";b=null!==(h=v.AFrameworkApplication.sessionStartInfoSettings.WACDatacenter)&&void 0!==h?h:"";return r===
T.bNj&&b===T.aNj}}T.bNj="-4";T.aNj="DC2";T.oNj="webasynccollabeng";T.XOj="AtMentions";T.tSj="AtMentionsFeatureUsage";Object(m.a)(T,"PackageManager",null,[1,2]);var da=c(1715),Ba=c(1413);class gb{constructor(b,h,r,B){this.ga=b;this.Je=h;this._augLoopRuntimeManager=r;this.hpk=B;this.pua=0;this.VAd=this.o0b=!1;this.hOg=this.Bdh=this.QKe=this.Cdh=0;this.Ltb=null;this.C1j=new Map([["ReferencesSmartLookUp",!0],["SmartLookupSynonyms",!0],["SmartLookupContextMenu",!0],["SmartLookupDictionary",!0],["ChangePicture",
!0]]);this.o0j=[{id:`${qs.Dic}_${1}`},{id:`${qs.Dic}_${2}`},{id:`${qs.Dic}_${3}`},{id:Ba.a.nKd},{id:Ba.a.KId},{id:Ba.a.E$d},{id:Ba.a.B$d}];this.uVj=[{id:"OpenCopilotCompose"},{id:"NewComment",count:2},{id:"CreatePullQuote"},{id:"DeleteBookmarkContextMenu"},{id:"EditBookmarkNameContextMenu"},{id:"EditIllustration"},{id:"Draw"},{id:"CreateHeadingLink"},{id:"RemoveContentControl"},{id:"ReviewDesignerSuggestion"}];this.lid=new Map;this.P7j=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdaptiveContextMenuIsEnabled",
!1);this.dbk=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.AcmMaximumSuggestions",8);this.GYj=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CanvasContextFeature",!1);this.Je.ob(this,da.SearchSuggestionAnnotation.getTypeName());(v.AFrameworkApplication.K.$("IsO365CommercialHost")||v.AFrameworkApplication.K.$("IsO365ConsumerHost"))&&this.lid.set("InsertLink","InsertLinkFlyout");this.lid.set("GraphicsEditor","");this.TEj();this.Tb(this.ga)}QIn(b,
h){const r=Date.now();this.QKe&&1250>r-this.QKe||this.Mxb||(this.QKe=r,this.Ltb=b,this.Lxd=this.gfm(h),this.e7n(),this.s5n())}KB(b,h){if(b.annotationType===da.SearchSuggestionAnnotation.getTypeName()&&b.content&&h===wr.a.getTypeName()&&(h=Date.now(),b=b.content,this.Mxb&&this.Mxb===b.correlationId)){window.clearTimeout(this.pua);this.Mxb=void 0;var r=this.o0b,B=this.D4l(b),P=B&&0<B.length;P&&(this.eYo(B),this.VAd&&(r=!1));r&&this.Qcj();h={["description"]:"[Zero term context menu] augloop response latency",
["correlationId"]:b.correlationId,["requestPreparationTime"]:this.Bdh,["canvasContextRetrievalTime"]:this.hOg,["networkTime"]:b.networkTime,["executionTime"]:b.executionTime,["updateTime"]:Date.now()-h,["latencyMs"]:h-this.Cdh,["containsZTM"]:P,["shouldFallBack"]:this.o0b,["fallBack"]:r};t.ULS.sendTraceTag(572057625,1303,50,JSON.stringify(h))}}D4l(b){const h=this.getSuggestions(b.intentSuggestions,da.IntentIds.ZeroTermMenu,da.ObjectSemantic.GenericSuggestions,da.ObjectSchemaType.RankedSuggestion);
return 1===h.length?h[0]:b.menuSuggestions}getSuggestions(b,h,r,B){return Array.isArray(b)?b.filter(P=>P.intent===h&&P.result.semantic===r&&P.result.type===B).map(P=>P.result.value):[]}Tb(b){b.fb(fb.a.sKi,yc.a.application,this.t5n.bind(this),96)}gfm(b){const h=[],r=new Map,B=Date.now();for(const P of b){if(!P)continue;b=[];const ca={itemsMetadata:new Sb.a};for(let ra=0;ra<P.ControlList.length;ra++){const Qa=P.ControlList[ra];if(Qa&&!Qa.ExternalId)continue;b.push(Qa.ExternalId);const tb={timeStamp:B,
source:"FallbackZeroTermMenu",confidenceScore:-1};ca.itemsMetadata[Qa.ExternalId]=tb;r.set(Qa.ExternalId,tb)}h.push(appChrome.api.menuSection(b,P.Title,P.Lang,P.Id,ca))}return{sections:h,commands:r}}nBj(b){return this.lid.has(b)?this.lid.get(b):b}SJa(b){const h={};for(const r of b)b=this.nBj(r.suggestion),appChrome.selectors.isControlDefined(b)&&(h[b]=appChrome.selectors.getModelType(b));Eb.App.za.HPd(h)}LJm(b){return!appChrome.selectors.isControlDefined(b)||appChrome.selectors.isControlDisabled(b)?
!1:this.C1j.has(b)?this.Lxd.commands.has(b):!0}GOh(b){return appChrome.actions.updateMenu("ZeroTermContextMenu",b,null,null,null,null,{menuTargetType:this.Ltb})}Dib(b=!1){b=b?Tm.a.instance.pvc:Tm.a.instance.Dib();const h=[],r=Date.now();for(const B of b)B.commandId&&h.push({Id:B.commandId,TimeElapsedSinceClick:(r-B.timeStamp)/1E3,ContentType:B.contentType,CommandSurface:B.commandSurface,InputMethod:B.Rx});return h}VPc(){const b=Tm.a.instance.VPc(),h=[],r=Date.now();for(const B of b)B.controlId&&h.push({Id:B.controlId,
TimeElapsedSinceClick:(r-B.timeStamp)/1E3,ContentType:B.contentType,CommandSurface:B.commandSurface,InputMethod:B.Rx});return h}Qof(){const b={semantic:da.ObjectSemantic.CanvasContext,type:da.ObjectSchemaType.WordCanvasContext,value:{contentType:this.Ltb}};if(this.GYj){const h=Date.now(),r=this.hpk.Qof(Bh.a.instance.ib.lb);r&&r.value.contentType&&(b.value=r.value);this.hOg=Date.now()-h}return b}c8h(){const b=this.VPc(),h=this.Dib(),r=this.Dib(!0),B=[];B.push({semantic:da.ObjectSemantic.ControlIdHistory,
type:da.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:da.SequenceType.ControlId,Sequence:b}});B.push({semantic:da.ObjectSemantic.CommandIdHistory,type:da.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:da.SequenceType.CommandId,Sequence:h}});B.push({semantic:da.ObjectSemantic.FilteredCommandIdHistory,type:da.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:da.SequenceType.CommandId,Sequence:r}});B.push(this.Qof());return B}TEj(){this._augLoopRuntimeManager.getSession().then(b=>
this.hhd=b).catch(()=>{this.hhd=void 0})}s5n(){const b=Date.now(),h=this.c8h(),r=[da.IntentIds.ZeroTermMenu,da.IntentIds.Logging];this.Bdh=Date.now()-b;this.axj(r,h,"ContextualMenu")}t5n(b,h,r){2===r&&(b=this.c8h(),this.axj([da.IntentIds.Logging],b,"Floatie"));return 32}axj(b,h,r){if(0===b.length||0===h.length)t.ULS.sendTraceTag(556892510,1303,15,"No search suggestion al workflow will be activated");else{var B=new da.SearchSuggestionSignal({correlationId:this.gRd("ACM"),intents:b,contextObjects:h,
entryPoint:r});this.o0b=0<=b.indexOf(da.IntentIds.ZeroTermMenu);this.Cdh=Date.now();this.Mxb=B.correlationId;this.pua=window.setTimeout(()=>{this.ptn(B.correlationId)},750);h=new wr.l({parentPath:["Signal",da.SearchSuggestionSignal.getTypeName()],items:[{id:Bb.a.create().toString(),body:B}]});this.hhd&&!this.hhd.isClosed?this.hhd.submitOperation(h):(this._augLoopRuntimeManager.submitOperation({operation:h}),this.TEj());t.ULS.sendTraceTag(574441286,1303,50,JSON.stringify({["description"]:"[Zero term context menu] search suggestion al workflow invocation",
["correlationId"]:B.correlationId,["shouldFallBack"]:this.o0b,["intents"]:b}))}}gRd(b){const h=Bb.a.create().toString();appChrome.api.setOfeCorrelationId(b,h);return h}ptn(b){this.Mxb&&this.Mxb===b&&(this.Mxb=void 0,this.o0b&&this.Qcj(),t.ULS.sendTraceTag(572057624,1303,15,JSON.stringify({["description"]:"[Zero term context menu] augloop request timeout",["correlationId"]:b,["shouldFallBack"]:this.o0b})))}Qcj(){const b=this.GOh(this.Lxd.sections);appChrome.api.dispatch(b);this.MHh()}MHh(){this.VAd=
!0}i_n(b){var h,r;const B=[],P=new Map;if(!b||0===b.length)return B;for(const ca of b){if(!ca||!ca.controlIds||0===ca.controlIds.length)continue;b={controlIds:[],id:ca.id,title:ca.title,lang:ca.lang,data:{itemsMetadata:new Sb.a}};const ra="CommandsZTM"===ca.id;for(const Qa of ca.controlIds){if(P.has(Qa))continue;if(ra&&b.controlIds.length>=this.dbk)break;const tb=null===(r=null===(h=ca.data)||void 0===h?void 0:h.itemsMetadata)||void 0===r?void 0:r[Qa];P.set(Qa,tb);b.controlIds.push(Qa);tb&&(b.data.itemsMetadata[Qa]=
tb)}0<b.controlIds.length&&B.push(b)}return B}e7n(){this.VAd=!1;if(this.P7j){const b=[appChrome.actions.updateControlHiddenState("ContextMenu",!0),appChrome.actions.updateControlEnabledDisabledState("ZeroTermContextMenu",!1)];appChrome.api.dispatch(b)}}eYo(b){this.VAd||(b=this.TLl(b),0<b.length&&appChrome.api.dispatch(b))}TLl(b){const h=[];let r=[];var B=this.Q9l();B&&0<B.length&&r.push(...B);(B=this.OKl())&&r.push(B);Array.isArray(b)&&0<b.length&&(b=this.Dva(b))&&(b.id="CommandsZTM",r.push(b));(b=
this.EKl())&&r.push(b);r=this.i_n(r);if(0===r.length)return[];h.push(this.GOh(r));this.MHh();return h}Q9l(){var b,h;const r=null===(b=this.Lxd)||void 0===b?void 0:b.sections.filter(B=>{var P;return null===(P=B.id)||void 0===P?void 0:P.startsWith(qs.RVh)});for(const B of r)if(null===(h=B.data)||void 0===h?0:h.itemsMetadata)for(const P in B.data.itemsMetadata)B.data.itemsMetadata[P].source="PassThroughZeroTermMenu";return r}OKl(){const b=this.b4h(this.o0j,"DefaultZeroTermMenu");return this.Dva(b)}EKl(){const b=
this.b4h(this.uVj,"AdvertizedZeroTermMenu");return this.Dva(b)}b4h(b,h){const r=[];for(const B of b)B&&this.nuo(B)&&this.Lxd.commands.has(B.id)&&r.push({suggestion:B.id,rankingScore:-1,suggestionSource:h});return r}nuo(b){if("number"!==typeof(null===b||void 0===b?void 0:b.count))return!0;if(0===b.count)return!1;b.count--;return!0}Dva(b){const h=[],r={itemsMetadata:new Sb.a},B=Date.now();this.SJa(b);for(const P of b)b=this.nBj(P.suggestion),this.LJm(b)&&(h.push(b),r.itemsMetadata[b]={timeStamp:B,source:P.suggestionSource,
confidenceScore:P.rankingScore});return 0<h.length?appChrome.api.menuSection(h,null,null,null,r):null}}Object(m.a)(gb,"AugLoopSearchSuggestionManager",null,[265,368]);class Rb{constructor(){this.W=null}get name(){return"WordEditor.ContextualSearch"}wc(b){this.W=b;this.W.ia("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager",()=>new gb(v.AFrameworkApplication.va,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),augLoop.ALFactoryGlobal.getAugLoopRuntimeManager(),this.W.resolve("Box4.CanvasContext.ICanvasContextProvider"))).as("WordEditor.ContextualSearch.ISearchSuggestionManager").ha()}init(){this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>
{Jr.a.ml().then(()=>{this.start()})})}start(){this.W.resolve("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager")}dispose(){}static main(){L.a.instance.Gc(new Rb)}}Object(m.a)(Rb,"PackageManager",null,[1,2]);var tc=c(438),Oc=c(959);class nd extends Oc.a{constructor(){super();this.documentUrl=this.scripts=null}}Object(m.a)(nd,"BootMessage",Oc.a,[]);var Gd=c(1075);class fe{constructor(){this.KQ=null;this.Wqn=b=>{if(b.target===this.KQ)if(void 0===b.data||null===b.data)t.ULS.sendTraceTag(50739143,
3007,10,"WebWorker: The received message did not have any data.");else try{if("string"===typeof b.data){const h=H.a(b.data);this.Oke(h.api)?this.Ugd.J(h.api).Q4d(h.method,h):t.ULS.sendTraceTag(50739144,3007,10,"WebWorker: The received message contained an unsupported API.")}}catch(h){t.ULS.sendTraceTag(50739145,3007,10,"WebWorker: Error routing a message received from a worker thread. Exception: {0}",h)}};this.Ugd=new Fe.a}hJf(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",
!1)}create(b,h){let r=!1;try{this.KQ=new Worker(b);this.KQ.onmessage=this.Wqn;const B=Object.assign(new nd,{api:0,method:0,scripts:h,documentUrl:document.URL});this.postMessage(B);this.hJf()&&Gd.a.bUj(this.KQ);r=!0}catch(B){t.ULS.sendTraceTag(50442775,3007,10,"WebWorker: Error creating worker. Exception: {0}",B)}return r}postMessage(b){try{const h=H.c(b);this.KQ.postMessage(h)}catch(h){t.ULS.sendTraceTag(50442776,3007,10,"WebWorker: Error sending a message to worker thread. Exception: {0}",h)}}Oke(b){return this.Ugd.nb(b)}Oqk(b,
h){this.Oke(b)&&t.ULS.sendTraceTag(50442777,3007,10,"WebWorker: We're overwriting an existing API in the collection.  ApiId: {0}",b);this.Ugd.Z(b,h)}lOl(b){return this.Oke(b)?this.Ugd.J(b):null}}Object(m.a)(fe,"WebWorker",null,[1167]);class be{constructor(){this.Psg=[]}igl(b,h){if(h){var r=v.AFrameworkApplication.Sz(b.Whj,7),B=[];for(let P=0;P<b.DRb.length;P++){let ca;switch(b.DRb[P].format){case 5:case 6:ca=tc.a.aHb(b.DRb[P].name);break;default:ca=b.DRb[P].name}B.push(v.AFrameworkApplication.Sz(ca,
b.DRb[P].format))}try{const P=URL.createObjectURL(new Blob(["importScripts('"+r+"');"],{type:"application/javascript"})),ca=new fe;if(ca.create(P,B))for(this.Psg.push(ca),r=0;r<b.Nke.length;r++){const ra=h.A9k(ca,b.Nke[r]);ra&&ca.Oqk(b.Nke[r],ra)}}catch(P){t.ULS.sendTraceTag(50442778,3007,10,"Exception caught when creating a new worker. Exception: {0}",P.message)}}else t.ULS.sendTraceTag(42824902,3007,10,"CreateWebWorker: ApiFactory parameter was null.")}}Object(m.a)(be,"WebWorkerCollection",null,
[]);class Ae{constructor(b,h){this.GYe=new be;if(b){b=b.create();for(let r=0;r<b.length;r++)this.GYe.igl(b[r],h)}else t.ULS.sendTraceTag(50442779,3007,10,"WebWorkerRouter: configFactory parameter was null.")}sendMessage(b,h,...r){let B=!1;for(let ca=0;ca<this.GYe.Psg.length;ca++){var P=this.GYe.Psg[ca];P.Oke(b)&&((P=P.lOl(b))?B=P.callMethod(h,r)||B:t.ULS.sendTraceTag(50442780,3007,10,"WebWorkerRouter: Failed to get an Api that is supported by the web worker. ApiId: {0}",b))}B||t.ULS.sendTraceTag(50442781,
3007,10,"WebWorkerRouter: A SendMessage did not find a worker to succesfully send the message to. ApiId: {0}, MethodId: {1}",b,h)}}Object(m.a)(Ae,"WebWorkerRouter",null,[1131]);class Re extends Oc.a{constructor(){super();this.LocalCobaltClusterId=this.LocalCobaltMachineId=this.LocalCobaltSessionId=this.sessionID=this.sessionStartInfoSettings=this.appSettings=null;this.LocalCobaltSessionHasBackup=!1;this.SettingsRoutedToServer=this.WaciiEnabledRequests=0;this.WacClusterId=null}}Object(m.a)(Re,"SettingsMessage",
Oc.a,[]);class Ce{constructor(b){this.KQ=b}}Object(m.a)(Ce,"WebWorkerApiMain",null,[]);class Fg extends Ce{constructor(b){super(b)}hJf(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",!1)}callMethod(b,h){if(!h)return t.ULS.sendTraceTag(591972375,3007,10,"InitializeWorkerApiMain: InitializeSettings called with a null methodParams value."),!1;if(1===b)return this.hSk(h);t.ULS.sendTraceTag(591972376,3007,10,"InitializeWorkerApiMain: Unknown method called.  MethodId: {0}",
b);return!1}Q4d(b,h){switch(b){case 14:this.mpm(h);break;default:t.ULS.sendTraceTag(591972377,3007,10,"InitializeWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}hSk(b){if(2!==b.length)return t.ULS.sendTraceTag(591972378,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters.  Param Count: {0}",b.length),!1;if("object"!==typeof b[0]||"object"!==typeof b[1])return t.ULS.sendTraceTag(587343010,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters. Param[0] is Dictionary: {0}, Param[1] is Dictionary: {1}",
"object"===typeof b[0],"object"===typeof b[1]),!1;b=Object.assign(new Re,{api:0,method:1,appSettings:b[0],sessionStartInfoSettings:b[1],sessionID:v.AFrameworkApplication.userSessionId,LocalCobaltSessionId:Gh.a.instance.zP,LocalCobaltMachineId:Gh.a.instance.Cmb,LocalCobaltClusterId:Gh.a.instance.bLb,LocalCobaltSessionHasBackup:Gh.a.instance.dqa,WaciiEnabledRequests:Gh.a.instance.Qka,SettingsRoutedToServer:Gh.a.instance.sfg,WacClusterId:v.AFrameworkApplication.He.xZ});this.KQ.postMessage(b);return!0}mpm(b){this.hJf()&&
b&&b.result&&(t.ULS.sendTraceTag(555877916,3007,15,"Receive initialize finished message"),this.j1o())}async j1o(){try{const b=await new Gd.a.cUj.WorkerUtilsTestClass(10);await b.Dh(5);15==await b.counter?t.ULS.sendTraceTag(555877917,3007,50,"WorkerUtils testing successfully"):t.ULS.sendTraceTag(555877918,3007,15,"WorkerUtils testing failed")}catch(b){t.ULS.sendTraceTag(555877919,3007,10,"WorkerUtils failed with exception: {0}",b.message)}}}Object(m.a)(Fg,"InitializeWorkerApiMain",Ce,[]);class Yh extends Oc.a{constructor(){super();
this.mockDataEnabled=!1;this.requestEndpoint=this.rootQuerySignature=null;this.appMode=Vk.a.none;this.activityFeedIsEnabled=!1;this.api=2;this.method=4}}Object(m.a)(Yh,"CatchUpNetworkRequestWorkerRequestMessage",Oc.a,[]);class zl extends Ce{constructor(b,h){super(b);this.iIc=h}callMethod(b,h){if(4===b)return b=Object.assign(new Yh,{rootQuerySignature:h[0],requestEndpoint:h[1],appMode:h[2],activityFeedIsEnabled:h[3]}),this.KQ.postMessage(b),!0;t.ULS.sendTraceTag(592189584,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unknown method called.  MethodId: {0}",
b);return!1}Q4d(b,h){switch(b){case 5:t.ULS.sendTraceTag(592189585,3012,50,"CatchUpNetworkRequestWorkerExternalApi: Message received for method: {0}",b);this.iIc.Xgo(h);break;default:t.ULS.sendTraceTag(592189586,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unsupported Method sent to the Api.  MethodId: {0}",b)}}}Object(m.a)(zl,"CatchUpNetworkRequestWorkerExternalApi",Ce,[]);class Al extends Oc.a{constructor(){super();this.context=this.textPredictionConfig=this.prediction=this.paragraphContent=
null}}Object(m.a)(Al,"LocalInferenceMessage",Oc.a,[]);class gn{constructor(){this.prediction=this.context=null}}Object(m.a)(gn,"LocalInferenceOutput",null,[]);class Bo{constructor(){this.modelFilesUrl=this.settings=this.scriptDirectory=null}}Object(m.a)(Bo,"TextPredictionConfig",null,[]);class kq{constructor(){this.extendedRankLimit=0;this.dynamicTemporaryInDocModelNGramToken=3}}Object(m.a)(kq,"TextPredictionSettings",null,[]);class Pm{constructor(){this.nGramOrder=0;this.modelFilesUrl=null}}Object(m.a)(Pm,
"TextPredictionDynamicPayload",null,[]);class xl extends Ce{constructor(b,h){super(b);this.opk=h}callMethod(b,h){if(!h)return t.ULS.sendTraceTag(575959325,3008,10,"LocalInferenceWorkerApiMain: LocalInference called with a null methodParams value."),!1;switch(b){case 8:return this.nSk(h);case 7:return this.iSk(h);case 9:return this.mSk(h);case 10:return this.jSk(h);case 13:return this.kSk(h);case 14:return this.lSk(h);default:return t.ULS.sendTraceTag(575959326,3008,10,"LocalInferenceWorkerApiMain: Unknown method called.  MethodId: {0}",
b),!1}}Q4d(b,h){switch(b){case 9:this.tqm(h);break;default:t.ULS.sendTraceTag(575959822,3007,10,"LocalInferenceWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}}tqm(b){b&&b.prediction&&(b=Object.assign(new gn,{prediction:b.prediction,context:b.context}),this.opk.Ewh().aJn(b))}iSk(b){if(1>b.length)return t.ULS.sendTraceTag(575959823,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceAddContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Al,{api:4,method:7,paragraphContent:b,textPredictionConfig:this.getConfig()});this.KQ.postMessage(b);return!0}nSk(b){if(1>b.length)return t.ULS.sendTraceTag(575959824,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceRemoveContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Al,{api:4,method:8,paragraphContent:b});this.KQ.postMessage(b);
return!0}mSk(b){if(2>b.length)return t.ULS.sendTraceTag(575959825,3008,10,"LocalInferenceWorkerApiMain: callLocalInferencePredict called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;var h=b[0];b=b[1];h=Object.assign(new Al,{api:4,method:9,paragraphContent:b,context:h});this.KQ.postMessage(h);return!0}jSk(b){if(1>b.length)return t.ULS.sendTraceTag(570782293,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceInit called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",
b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Al,{api:4,method:10,textPredictionConfig:this.getConfig(b)});this.KQ.postMessage(b);return!0}kSk(b){if(1>b.length)return t.ULS.sendTraceTag(556827920,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,"object"===typeof b[0]),!1;b=b[0];b=Object.assign(new Al,{api:4,method:13,textPredictionConfig:this.l9h(b)});this.KQ.postMessage(b);return!0}lSk(b){if(1>
b.length)return t.ULS.sendTraceTag(541733787,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",b.length,Object(Ib.a)(Object,b[0])),!1;b=b[0];b=Object.assign(new Al,{api:4,method:14,textPredictionConfig:this.l9h(b)});this.KQ.postMessage(b);return!0}getConfig(b=null){return Object.assign(new Bo,{scriptDirectory:v.AFrameworkApplication.a6+"/intelligence/",settings:Object.assign(new kq,{extendedRankLimit:0}),modelFilesUrl:b})}l9h(b=
null){return Object.assign(new Bo,{scriptDirectory:v.AFrameworkApplication.a6+"/intelligence/",settings:Object.assign(new kq,{dynamicTemporaryInDocModelNGramToken:b.nGramOrder}),modelFilesUrl:b.modelFilesUrl})}}Object(m.a)(xl,"LocalInferenceWorkerApiMain",Ce,[]);class Vl extends Ce{constructor(b){super(b);v.AFrameworkApplication.qI(()=>{this.qMb()})}callMethod(b){t.ULS.sendTraceTag(591689869,3008,10,"ShutdownWorkerApiMain: CallMethod not supported on this API.  MethodId: {0}",b);return!1}Q4d(b){t.ULS.sendTraceTag(591689870,
3007,10,"ShutdownWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",b)}qMb(){const b=Object.assign(new Oc.a,{api:3,method:6});this.KQ.postMessage(b)}}Object(m.a)(Vl,"ShutdownWorkerApiMain",Ce,[]);class hl{constructor(b){this.container=b}A9k(b,h){let r=null;switch(h){case 0:r=new Fg(b);break;case 2:r=new zl(b,this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"));break;case 3:r=new Vl(b);break;case 4:r=new xl(b,this.container.resolve("Box4.WordPrediction.IWordPredictionAugLoop"));
break;default:t.ULS.sendTraceTag(50442782,3008,10,"WordWebWorkerApiFactory: CreateApi was passed an unsupported ApiId. ApiId: {0}",h)}return r}}Object(m.a)(hl,"WordWebWorkerApiFactory",null,[444]);var mk=c(323);class Vo{constructor(b,h){this.name=b;this.format=h}}Object(m.a)(Vo,"ImportedScript",null,[]);class uj{constructor(){this.Nke=this.DRb=this.Whj=null}}Object(m.a)(uj,"WebWorkerConfig",null,[]);var ds=c(1469);class SC{constructor(b){this.sih=[];this.T8j=b;if(v.AFrameworkApplication.K){b=v.AFrameworkApplication.K.$("AppChromeOverrideIsCombinedBundle")||
v.AFrameworkApplication.K.$("IsCombinedBundleEnabled");const r=v.AFrameworkApplication.K.kb("ContentBaseUrl")?6:5;var h=v.AFrameworkApplication.K.kb("AppScriptBaseName");const B=b?"":".";if(h){const P=b?"":"{0}";h+=`${B}${P}worker.js`;this.sih.push(new Vo(`MicrosoftAjax${b?"":"DS"}.${P}js`,r),new Vo(h,r))}else t.ULS.sendTraceTag(558465106,3008,10,"WordWebWorkerConfigFactory: Failed to get AppScriptBaseName. Worker JS is not loaded")}else t.ULS.sendTraceTag(558465107,3008,10,"WordWebWorkerConfigFactory: AFrameworkApplication.appSettingsManager do not exist. Worker JS is not loaded")}create(){const b=
[],h=Object.assign(new uj,{Whj:"workerboot",DRb:this.sih,Nke:[0,2,3,4]});this.T8j&&this.QLm()&&h.DRb.push(new Vo("intelligence/edge-inference-web.js",5));b.push(h);return b}QLm(){return(new mk.a("arrowFunction",()=>{try{Object(ds.a)("const sum = (a, b) => a + b")}catch(b){return!1}return!0},!1)).isSupported()}}Object(m.a)(SC,"WordWebWorkerConfigFactory",null,[367]);class qB{constructor(){this.Ca=this.W=null}get name(){return"WordEditor.Workers"}init(){const b=this.W.resolve("Box4.Workers.IWebWorkerRouter");
b.sendMessage.apply(b,[0,1].concat([this.Ca.appSettings,v.AFrameworkApplication.sessionStartInfoSettings]))}dispose(){}wc(b){this.W=b;this.Ca=this.W.resolve("Common.IAppSettingsManager");const h=this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextPredictionEdge",!1);b.ia("Box4.Workers.WebWorkerRouter",()=>new Ae(new SC(h),new hl(b))).as("Box4.Workers.IWebWorkerRouter").ha()}static main(){L.a.instance.Gc(new qB)}}Object(m.a)(qB,"WordEditorWorkersPackage",null,[1,2]);var yz=c(1194);class nC{constructor(){this.Gvd=
[]}pgi(b,h){let r=-1,B=null;B=P=>{P?h(this.Gvd[r]):(++r,r<this.Gvd.length?this.Gvd[r].o4b(b,B):h(null))};B(!1)}o4b(b,h){this.pgi(b,r=>{h(!!r)})}Jjc(b,h,r){this.pgi(b,B=>{if(!B)throw Error.invalidOperation("ResolveUrl called without checking CanResolveUrl");B.Jjc(b,h,r)})}Lph(b){this.Gvd.push(b)}}Object(m.a)(nC,"CompositeExternalContentURLResolver",null,[445,446]);var rB=c(1464);class wx extends rB.a{constructor(){super();this.Thumbnail=this.Author=this.Title=this.MediaType=null;this.Height=this.Width=
0;this.ProviderName=this.IFrameHtml=null}}Object(m.a)(wx,"ExternalContentEmbedResponse",rB.a,[]);var aF=c(1480),jv=c(1872),nE=c(1871),bF=c(1382),CD=c(722),vA=c(501),sB=c(166),TC=c(874),xx;(function(b){b[b.autoCorrect=0]="autoCorrect";b[b.externalComponentPaste=1]="externalComponentPaste";b[b.externalHyperlinkPaste=2]="externalHyperlinkPaste";b[b.xip=3]="externalContentFloatieConversion"})(xx||(xx={}));Object(m.b)("ExternalContentConversionContext",xx);class Zg{constructor(){this.DKb=this.CKb=null;
this.$jf=new bF.ExternalContentEmbedRetriever;this.hDc=!0;this.dvc=this.uo=this.Rpi=this.Qpi=this.Yl=this.As=null;this.picturePasteRequestSucceeded=()=>{t.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")};this.eic=()=>{t.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")};null!=Zg.loa&&Zg.loa.e8h()}get OQb(){return this.hDc}set OQb(b){this.hDc=b}G6e(b,h){let r=!1;if(b){switch(b.contextId){case yc.a.Uc:r=!h;break;case yc.a.Fd:r=
!0}r&&!TC.a(b.node)&&(r=!1)}return r}FXm(b){const h=b.startsWith(Tg.a.Fic),r=b.startsWith(Tg.a.S4c),B=b.startsWith(Tg.a.fbe);return(h||r||B)&&Tg.a.RRa(b)}y7i(){this.uo=V.a.create();Zg.qf.mDb(this.uo,4);Zg.qf.C5(this.uo,0,Zg.qf.so());this.DIb(this.CKb,3,this.DKb,!0)}UQa(b,h,r){this.uo=V.a.create();Zg.qf.mDb(this.uo,r?0:2);Zg.qf.C5(this.uo,0,Zg.qf.so());this.dvc();this.DIb(b,r?0:2,h)}D$d(b,h){this.uo=V.a.create();Zg.qf.mDb(this.uo,1);Zg.qf.C5(this.uo,0,Zg.qf.so());this.DIb(b,1,h)}$Xd(b,h,r,B){if(!b||
!b.isConnected||!Id.ImageReader.Mt(b))return null;const P=new CD.a;P.setValue(gi.a.fbc,r);P.setValue(gi.a.NQa,h);P.E0a=this.Qpi;P.$w=this.Rpi;P.providerName=B;P.$4a=1===r;Ad.GraphIterator.eb(b).Bf(P,2);this.f0c(P);return P}t9i(b){this.dvc=b}Vre(b,h){const r=Zg.N1.T6b(h)||0;h=Zg.N1.j1a(h)||0;const B=b.Width/b.Height;1<=B?(b.Width=r,b.Height=r/B):(b.Height=h,b.Width=h/B)}nug(b,h,r){if(null!=b&&null!=h&&!F.a.af(r)){var B=Zg.G1c.v$b(r);v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoTitleOnInsertionWithDialog",
!1)?B.Ara=!1:B.Ara=!0;B.hideFloatie=!0;this.Vre(b,h.node);this.Hbc(b,h,!1,!1,B,r)}}zjb(b){return b?b.Se:0}org(b,h,r){let B=null;const P=b.node;if(!ke.ParagraphReader.Xb(P)||!P.isConnected)return{returnValue:!1,asa:B};if(r)return{returnValue:!0,asa:b};r=b.cpBegin;const ca=b.cpEnd,ra=ke.ParagraphReader.text(P);if(0<=r&&ca<=ra.length&&ra.substring(r,ca)===h)return{returnValue:!0,asa:b};const Qa=ra.indexOf(h);return 0<=Qa?(B=Ue.a.createTextRange(P,Qa,Qa+h.length),{returnValue:!0,asa:B}):0<=r&&ca<=ra.length&&
this.Hac(b)?{returnValue:!0,asa:b}:{returnValue:!1,asa:B}}Hac(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=Ue.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=Tg.a.Ez(h,!1);if(1===h.length){h=h[0];const r=ke.ParagraphReader.text(b.node).substring(h.cpBegin,h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==r)return!0}return!1}YIf(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}b9a(b,h){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$(h)&&
window.setTimeout(()=>{const r=Ma.a.instance.Ta("Common.ISystemInitiatedFeedback");r&&r.execute(B=>{B.logActivity(b,h)})},Zg.xEa)}Cqf(b,h){const r=!F.a.p8(h);switch(b){case 1:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;break;default:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}DIb(b,
h,r,B=!1){if(this.FXm(r)){var P=Zg.G1c.v$b(r);if(P)if(this.YIf(P)){t.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent");b=Object(Ra.a)(Ue.a,b);var ca=!h;this.G6e(b,ca)?this.FWc(r)?(h=1===h,B=this.ZYl(b),P.hideFloatie=!0,this.Hbc(B,b,ca,h,P,r)):this.j2f(b,h,P,r,B):Zg.qf.kR(this.uo,2,"URL inserted in Non-Embedable context",Zg.qf.so())}else t.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),Zg.qf.kR(this.uo,2,"Size provided is not valid for OEmbed",
Zg.qf.so())}else t.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),Zg.qf.kR(this.uo,2,"URL inserted is not valid for ExternalContent",Zg.qf.so())}ZYl(b){const h=new wx;h.Width=Zg.N1.T6b(b.node)||0;h.Height=Zg.N1.j1a(b.node)||0;h.Title="Fluid Component";h.MediaType="fluid";return h}FWc(b){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=Zg.N9&&Zg.N9.qDi(b)}j2f(b,h,r,B,P){const ca=
!h,ra=1===h,Qa=Zg.N1.T6b(b.node)||0,tb=Zg.N1.j1a(b.node)||0,Mb=aF.a.l$e(r.Iqg,!0,Qa,tb);this.F_c(b,B,h,!0);this.$jf.vDh(Mb,Zb=>{Zg.qf.C5(this.uo,4,Zg.qf.so());Zg.qf.A9c(this.uo,this.zjb(Zb.data));if(Zb=this.p2f(Zb)){t.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var jc=sB.q(Zb.MediaType);Zg.qf.Xce(this.uo,7,jc);jc=b;({asa:jc}=this.org(b,B,ra)).returnValue?(this.F_c(jc,B,h,!1),null==r.width?0<Qa&&Zb.Width>Qa&&(t.ULS.sendTraceTag(591681426,
324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),Zb.Width=Qa):(t.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),Zb.Width=this.ned(r.width,Zb.Width,Qa)),null==r.height?0<tb&&Zb.Height>tb&&(t.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),Zb.Height=tb):(t.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),
Zb.Height=this.ned(r.height,Zb.Height,tb)),Zg.loa.cab||P?this.Hbc(Zb,jc,ca,ra,r,B):(this.CKb=b,this.DKb=B,this.zKc(B))):(t.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),Zg.qf.kR(this.uo,2,"No conversion as the context is no longer valid for the external content conversion",Zg.qf.so()));ra&&this.q0a(jc.node)}else ra&&this.q0a(b.node),Zg.qf.kR(this.uo,1,"URL not oEmbedable",Zg.qf.so())},Zb=>{Zg.qf.C5(this.uo,
4,Zg.qf.so());Zg.qf.A9c(this.uo,this.zjb(Zb.data));ra&&this.q0a(b.node);t.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Zb.data.se);Zg.qf.kR(this.uo,2,"ExternalContentEmbedRequest failed",Zg.qf.so())},Zb=>{ra&&this.q0a(b.node);t.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Zb)},this.uo)}ned(b,h,r){!b&&0<r&&h>r||b>r?(t.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),
h=r):b>r?h=r:b&&b<r&&(h=b);return h}Hbc(b,h,r,B,P,ca){this.Yl=Bb.a.create();b.Width=b.Width/b.Height*(b.Height-(vA.a.vTc+vA.a.c4))+2*vA.a.c4;const ra=new cg.GraphTransaction(15);ra.Db(h.node);ra.Uj=qb.a.UQa;const Qa=this.Hac(h);null!=P.Ara&&!P.Ara||B||Qa||(b.Title=""===P.title||P.title?P.title:b.Title,!b.Title&&""!==b.Title)||(h=this.ECf(h,ra,b.Title,ca,r));if(h){B&&(h=this.uef(h));var tb=this.rJd(h,B);if(tb){r=sB.q(b.MediaType);var Mb=this.ZTd(b,r);this.Qpi=b.IFrameHtml;this.Rpi=b.Title;if(tb=this.lCf(tb,
Mb,ra,B,ca,r,b.ProviderName))ra.eHa(this.Yl,1),ra.dispose(),this.CKb=h,this.DKb=ca,this.XZf(P,b,tb),this.Y1f(ca,B||P.hideFloatie,Qa,r,b.Title,b.ProviderName)}else ra.dispose(),t.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),Zg.qf.kR(this.uo,2,"Could not create IP context on splitting the paragraph",Zg.qf.so())}else Zg.qf.kR(this.uo,2,"GraphNodeContext is null",Zg.qf.so())}ZTd(b,h){const r=new fd.DictionaryPropertySet;
Zg.qP.xae(r,b.Width,b.Height);b=this.Bqf(h,b.Title);r.setValue(Pd.a.imageAltText,b);r.setValue(Mc.a.IU,jd.a.GF());r.setValue(Mc.a.imageType,oo.other);return r}lCf(b,h,r,B,P,ca,ra){if(!b)return null;b=Zg.qP.dYd(b,h);if(!b)return r.dispose(),t.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),Zg.qf.kR(this.uo,2,"The anchored image could not be inserted",Zg.qf.so()),null;r=b.node;P=this.$Xd(r,P,ca,ra);Zg.qf.Kpg(this.uo,P.id);B||this.ndg(r);
return r}XZf(b,h,r){F.a.p8(b.thumbnailUrl)||(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(Zg.qf.C5(this.uo,8,Zg.qf.so()),t.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.ILd(r,h.Thumbnail))}Y1f(b,h,r,B,P,ca){h||this.zKc(b);this.b9a("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");this.D9d("IsHyperlinkWithNonURLDisplayText",r,ca);this.ariaNotify(B,P);Zg.qf.C5(this.uo,5,Zg.qf.so())}D9d(b,h,r){t.ULS.sendTraceTag(591267585,
324,50,"OtelLogging: ExternalContent transaction successfully completed");ea.a.sendTelemetryEvent(Object.assign(new ka.a,{name:"Office.Word.Online.ExternalContent.OEmbedInsertions",dataFields:[Object.assign(new ha.a,{name:b,bool:h}),Object.assign(new ha.a,{name:"ProviderName",string:r})]}))}ariaNotify(b,h){this.OQb&&Zg.Gv&&(b=this.Cqf(b,h),Zg.Gv.sendNotification(b,!0))}ECf(b,h,r,B,P){if(P){if((P=Tg.a.Ez(b,!1))&&1!==P.length)return h.dispose(),t.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),
null;Zg.hp.iS(P[0].paragraph,P[0].hyperlink)}return this.y9f(b,r,B)}uef(b){const h=b.node,r=ke.ParagraphReader.text(h);return 0<r.length&&!r.trim().length?(b=Ue.a.createTextRange(h,0,r.length),Zg.jg.Ge(b,""),Ue.a.Rc(h,0)):b}rJd(b,h){return h?b:this.xrf(b)}xrf(b){const h=ke.ParagraphReader.text(b.node),r=Ad.GraphIterator.eb(b.node);if(r.qd()){b=Ue.a.Rc(b.node,b.cpEnd);ig.OutlineElementNavigator.Yd(r);const B=Zg.Pf.npa(r);Zg.rh.S$(r,B,b,!0,!0,!0,!0);""!=h&&Zg.rh.My(r,!1,!0);r.Rd();return Ue.a.Rc(r.currentNode,
0)}return null}p2f(b){if(!({group:b}=kl.a.d2(b.data.se)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}y9f(b,h,r){const B=b.cpBegin+h.length;Zg.jg.Ge(b,h);b=Ue.a.createTextRange(b.node,b.cpBegin,B);Zg.hp.fF(b,r,!1);return b}Bqf(b,h){const r=!F.a.p8(h);switch(b){case 1:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,
h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}ILd(b,h){b.Yi().contentReplicator.forceOutbound(()=>{this.n2f(h,b)},()=>{t.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}f0c(b){b=Ad.GraphIterator.eb(b);b.zb(12);b.jd(12);b.Gn.ZQ=!0}q0a(b){b.$hc=null}ndg(b){b=Ad.GraphIterator.eb(b);b.zb(11)&&(b.jd(11),b.qd()&&b.Oj()&&b.Rd()&&ke.ParagraphReader.Xb(b.currentNode)&&(b=og.SelectionFactory.ne(b.currentNode,
0),Bh.a.instance.Ac(b)))}F_c(b,h,r,B){const P=b.cpBegin,ca=b.cpEnd;b=ke.ParagraphReader.text(b.node).trim();P||b!==h&&""!==b?P?ca===b.length?t.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",xx[r],B):0<P&&ca<b.length&&t.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
xx[r],B):t.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",xx[r],B):t.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",xx[r],B)}zKc(b){this.$6b();const h=new mw.a(1,v.AFrameworkApplication.isRtl);h.M3c=b;Zg.Whb.S5c(h)}$6b(){const b=
new wh.a(!0);Zg.i$.gIa(b)}n2f(b,h){if(b=this.ztf(b,h))h=Array(1),h[0]=b,b=jv.a.construct(h,!1,v.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.As.zr:null),h=this.qcf(),this.Jpb(h,b)}ztf(b,h){if(!h)return t.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.As=h.Yi();(new Ad.GraphIterator).set(h);if(!h.anchor||!h.anchor.Vp||!h.anchor.Vp.us)return t.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),
null;var r=h.anchor.Vp.us.node;if(!r)return t.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),null;r=r.ja(lh.a.QJ,ie.a.Pt);const B=h.getValue(Pd.a.$K),P=xg.a.nf(Id.ImageReader.ZC(h.properties),0),ca=xg.a.nf(Id.ImageReader.WH(h.properties),1);return nE.a.construct(h.id.toString(),b,h.ja(Pd.a.imageAltText,""),P,ca,h.ja(Mc.a.sY,""),r,h.ja(Mc.a.IU,0),h.ja(Mc.a.tia,!1),h.ja(lh.a.iha,-1),h.ja(Mc.a.Dmb,Box4Intl.Box4Strings.l_Picture),h.ja(Pd.a.Lxa,
!1),B,h.ja(Mc.a.runId,1),h.ja(Mc.a.Wc,0))}Jpb(b,h){v.AFrameworkApplication.He.mj(b,2,H.c(h),{},!1,2,this.picturePasteRequestSucceeded,this.eic,null,void 0,void 0,void 0,void 0,"26");t.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}qcf(){let b=ia.a.f9b("PicturePaste.ashx");v.AFrameworkApplication.K&&!v.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(b=ia.a.No(b,fi.a.fileId,this.As.zr));b=ia.a.No(b,fi.a.cellId,this.As.Gm.toString());this.Yl||
(this.Yl=Bb.a.create(),t.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=ia.a.No(b,fi.a.JX,this.Yl.toString());b=ia.a.No(b,fi.a.classId,(393233).toString());this.As.TH&&(b=ia.a.No(b,fi.a.TH,this.As.TH));b=ia.a.No(b,fi.a.jsb,"1");b=ia.a.No(b,Xg.a.imageType,oo.other.toString());b=Gh.a.instance.O_e(b);b=ia.a.No(b,fi.a.Yua,this.As.contentReplicator.Pu.toString());b=ia.a.No(b,fi.a.Xhc,"0");return b=ia.a.No(b,fi.a.oTb,"1")}static get Whb(){return null!=
Zg.Jyg?Zg.Jyg:Zg.Jyg=Ma.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get loa(){Zg.uBa||(Zg.uBa=Ma.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return Zg.uBa}static get i$(){return null!=Zg.cGg?Zg.cGg:Zg.cGg=Ma.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get Gv(){return null!=Zg.wwg?Zg.wwg:Zg.wwg=Ma.a.instance.resolve("Common.Utils.IAriaNotifier")}static get N1(){return null!=Zg.cHg?Zg.cHg:Zg.cHg=Ma.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get qP(){return null!=
Zg.vBg?Zg.vBg:Zg.vBg=Ma.a.instance.resolve("WordEditor.IImageEditor")}static get Pf(){return Zg.rh||(Zg.rh=Ma.a.instance.resolve("Box4.IOutlineElementEditor"))}static get hp(){return null!=Zg.nBg?Zg.nBg:Zg.nBg=Ma.a.instance.resolve("Box4.IHyperlinkEditor")}static get jg(){return null!=Zg.fxg?Zg.fxg:Zg.fxg=Ma.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get qf(){return null!=Zg.Syg?Zg.Syg:Zg.Syg=Ma.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}static get G1c(){return null!=
Zg.PEg?Zg.PEg:Zg.PEg=Ma.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}static get N9(){return null!=Zg.IEg?Zg.IEg:Zg.IEg=Ma.a.instance.resolve("Fluid.Host.LoopComponentManager")}}Zg.rh=null;Zg.xEa=5E3;Zg.uBa=null;Object(m.a)(Zg,"ExternalContentEditor",null,[363]);var Jw=c(263),fo=c(1232);class cF{constructor(b,h){this.cab=!0;this.j6a=r=>{if(null!=r.result)return r.result.Value;t.ULS.sendTraceTag(556376794,324,15,"onRegister get convertExternalContentIsEnabled settings options from Roaming Service failed.");
return this.cab};this.CHa=r=>{r.Io||r.Gi?t.ULS.sendTraceTag(559153884,324,15,"Load to get convertExternalContentIsEnabled settings options from Roaming Service failed."):(this.kAh(r.result),t.ULS.sendTraceTag(559437389,324,50,"Load to get convertExternalContentIsEnabled settings options from Roaming Service successfully"));return this.cab};this.Ev=b;this.LK=h}e8h(){const b=new Hf.a;this.tCi()&&this.LK?this.LK.c7a(Jw.a.ZJc).CWRCo(this.j6a,0).CWRCo(this.CHa,8):b.Dg(this.cab)}j2(b){this.LK&&this.LK.j2(Jw.a.ZJc,
new fo.a(Jw.a.ZJc,b))}vao(b){this.tCi()&&(this.Ev.gka("saveConvertExternalContentIsEnabled",b.toString()),t.ULS.sendTraceTag(559437386,324,50,"Try to save convertExternalContentIsEnabled settings value to Roaming Service."),this.kAh(b),this.j2(b))}tCi(){const b=v.AFrameworkApplication.K.$("IsAnonymousUser");if(v.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(b)t.ULS.sendTraceTag(559437387,324,50,"User is anonymous ");else return!0;return!1}kAh(b){this.cab=b}}Object(m.a)(cF,"ExternalContentSettingInfo",
null,[453]);var bG=c(1165);class dF{constructor(){this.thumbnail=this.author=this.title=this.mediaType=this.url=null;this.height=this.width=0;this.type=null;this.showFloatie=!1}}Object(m.a)(dF,"FluidComponentProperties",null,[]);class cG{constructor(){this.loopType=this.$w=this.E0a=this.url=null;this.mediaType=0;this.ULi=null}}Object(m.a)(cG,"IFrameProps",null,[]);class Kl{static get N1(){return null!=Kl.aHg?Kl.aHg:Kl.aHg=Ma.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get qP(){return Kl.Vj||
(Kl.Vj=Ma.a.instance.resolve("WordEditor.IImageEditor"))}static get Gv(){return null!=Kl.vwg?Kl.vwg:Kl.vwg=Ma.a.instance.resolve("Common.Utils.IAriaNotifier")}static get hp(){return null!=Kl.hBg?Kl.hBg:Kl.hBg=Ma.a.instance.resolve("Box4.IHyperlinkEditor")}static get Pf(){return null!=Kl.iFg?Kl.iFg:Kl.iFg=Ma.a.instance.resolve("Box4.IOutlineElementEditor")}static get jg(){return null!=Kl.dxg?Kl.dxg:Kl.dxg=Ma.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static RRa(b){const h=b.startsWith(Tg.a.Fic),
r=b.startsWith(Tg.a.S4c),B=b.startsWith(Tg.a.fbe);return(h||r||B)&&Tg.a.RRa(b)}static G6e(b,h){let r=!1;if(b){switch(b.contextId){case yc.a.Uc:r=!h;break;case yc.a.Fd:r=!0}r&&!TC.a(b.node)&&(r=!1)}return r}static Hac(b){if(!b||b.cpBegin>=b.cpEnd)return!1;var h=Ue.a.createTextRange(b.node,b.cpBegin,b.cpEnd);h=Tg.a.Ez(h,!1);if(1===h.length){h=h[0];const r=ke.ParagraphReader.text(b.node).substring(h.cpBegin,h.cpEnd).trim();if(b.cpEnd===h.cpEnd&&h.hyperlink.url!==r)return!0}return!1}static Bqf(b,h){const r=
!F.a.p8(h);switch(b){case 1:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}static f0c(b){b=Ad.GraphIterator.eb(b);b.zb(12);b.jd(12);b.Gn.ZQ=!0}static ZTd(b,h,r,B){const P=
new fd.DictionaryPropertySet;Kl.qP.xae(P,h,b);b=Kl.Bqf(B,r);P.setValue(Pd.a.imageAltText,b);P.setValue(Mc.a.IU,jd.a.GF());P.setValue(Mc.a.imageType,oo.other);return P}static $Xd(b,h,r){if(!b||!b.isConnected||!Id.ImageReader.Mt(b))return null;const B=new CD.a;B.setValue(gi.a.fbc,h.mediaType);B.setValue(gi.a.NQa,h.url);B.setValue(Yc.a.loopComponentType,h.loopType);B.E0a=h.E0a;B.$w=h.$w;B.providerName=r;B.$4a=1===h.mediaType;B.createMode=h.ULi;Ad.GraphIterator.eb(b).Bf(B,2);Kl.f0c(B);return B}static rJd(b,
h){return h?b:Kl.xrf(b)}static xrf(b){const h=ke.ParagraphReader.text(b.node),r=Ad.GraphIterator.eb(b.node);if(r.qd()){b=Ue.a.Rc(b.node,b.cpEnd);ig.OutlineElementNavigator.Yd(r);const B=Kl.Pf.npa(r);Kl.Pf.S$(r,B,b,!0,!0,!0,!0);""!=h&&Kl.Pf.My(r,!1,!0);r.Rd();return Ue.a.Rc(r.currentNode,0)}return null}static ndg(b){b=Ad.GraphIterator.eb(b);b.zb(11)&&(b.jd(11),b.qd()&&b.Oj()&&b.Rd()&&ke.ParagraphReader.Xb(b.currentNode)&&(b=og.SelectionFactory.ne(b.currentNode,0),Bh.a.instance.Ac(b)))}static Cqf(b,
h){const r=!F.a.p8(h);switch(b){case 1:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;break;default:b=r?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,h):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return b}static ariaNotify(b,h){Kl.Gv&&(b=Kl.Cqf(b,
h),Kl.Gv.sendNotification(b,!0))}static D9d(b,h,r,B=""){t.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");ea.a.sendTelemetryEvent(Object.assign(new ka.a,{name:r,dataFields:[Object.assign(new ha.a,{name:b,bool:h}),Object.assign(new ha.a,{name:"ProviderName",string:B})]}))}}Object(m.a)(Kl,"ExternalContentHelper",null,[]);var UC=c(744);class oE{constructor(){this.Yl=this.As=null}ILd(b,h,r){b.Yi().contentReplicator.forceOutbound(()=>{this.n2f(h,b,r)},
()=>{t.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}n2f(b,h,r){if(b=this.ztf(b,h))h=Array(1),h[0]=b,r=jv.a.construct(h,r,v.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.As.zr:null),b=this.qcf(),this.Jpb(b,r)}ztf(b,h){if(!h)return t.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.As=h.Yi();(new Ad.GraphIterator).set(h);if(!h.anchor||!h.anchor.Vp||
!h.anchor.Vp.us)return t.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var r=h.anchor.Vp.us.node;if(!r)return t.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),null;r=r.ja(lh.a.QJ,ie.a.Pt);const B=h.getValue(Pd.a.$K),P=xg.a.nf(Id.ImageReader.ZC(h.properties),0),ca=xg.a.nf(Id.ImageReader.WH(h.properties),1);return nE.a.construct(h.id.toString(),b,h.ja(Pd.a.imageAltText,
""),P,ca,h.ja(Mc.a.sY,""),r,h.ja(Mc.a.IU,0),h.ja(Mc.a.tia,!1),h.ja(lh.a.iha,-1),h.ja(Mc.a.Dmb,Box4Intl.Box4Strings.l_Picture),h.ja(Pd.a.Lxa,!1),B,h.ja(Mc.a.runId,1),h.ja(Mc.a.Wc,0))}Jpb(b,h){v.AFrameworkApplication.He.mj(b,2,H.c(h),{},!1,2,this.picturePasteRequestSucceeded.bind(this),this.eic.bind(this),null,void 0,void 0,void 0,void 0,"26");t.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}picturePasteRequestSucceeded(){t.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")}eic(){t.ULS.sendTraceTag(592996168,
324,10,"Picture paste request for External Content failed.")}qcf(){let b=ia.a.f9b("PicturePaste.ashx");v.AFrameworkApplication.K&&!v.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(b=ia.a.No(b,fi.a.fileId,this.As.zr));b=ia.a.No(b,fi.a.cellId,this.As.Gm.toString());this.Yl||(this.Yl=Bb.a.create(),t.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));b=ia.a.No(b,fi.a.JX,this.Yl.toString());b=ia.a.No(b,fi.a.classId,(393233).toString());
this.As.TH&&(b=ia.a.No(b,fi.a.TH,this.As.TH));b=ia.a.No(b,fi.a.jsb,"1");b=ia.a.No(b,Xg.a.imageType,oo.other.toString());b=Gh.a.instance.O_e(b);b=ia.a.No(b,fi.a.Yua,this.As.contentReplicator.Pu.toString());b=ia.a.No(b,fi.a.Xhc,"0");return b=ia.a.No(b,fi.a.oTb,"1")}}Object(m.a)(oE,"ExternalContentThumbnailHelper",null,[]);class yx extends oE{constructor(){super(...arguments);this.uo=null}static get qf(){return null!=yx.Ryg?yx.Ryg:yx.Ryg=Ma.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler")}ZJj(b,
h,r){return Kl.RRa(h)?Kl.G6e(b,r)?!0:(yx.qf.kR(this.uo,2,"URL inserted in Non-Embedable context",yx.qf.so()),!1):(t.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),yx.qf.kR(this.uo,2,"URL inserted is not valid for ExternalContent",yx.qf.so()),!1)}}Object(m.a)(yx,"AbstractExternalContentEditor",oE,[363]);var pE=c(1192),Gu=c(1195);class ot extends yx{constructor(b){super();ot.mYa=b;this.AMf()}AMf(){this.Yqg&&Gu.a.AMf(ot.mYa.M8h())}static get Tk(){return null!=
ot.HFg?ot.HFg:ot.HFg=Ma.a.instance.resolve("Box4.IParagraphEditor")}Dal(b,h){h=this.rci(b,h);this.Qsi(h,b,5)}UQa(b,h,r){if(this.ZJj(b,h,r)){var B=this.rci(b,null);B.url=h;this.Qsi(B,b,r?0:2)}}D$d(b,h){this.UQa(b,h,!1)}Qsi(b,h,r){this.Yl=Bb.a.create();const B=new cg.GraphTransaction(15);B.Db(h.node);B.Uj=qb.a.FDm;const P=Kl.Hac(h),ca=sB.q(b.mediaType),ra=Kl.ZTd(b.height,b.width,b.title,ca);h=this.GWo(h,1==r);(h=Kl.Vj.dYd(h,ra))?(h=h.node,Kl.$Xd(h,{url:b.url,mediaType:ca,$w:b.title,loopType:b.type,
ULi:r},void 0)||t.ULS.sendTraceTag(538817433,324,50,"insertFluidComponentCore: Iframe node is null"),B.eHa(this.Yl,1),B.dispose(),this.ILd(h,b.thumbnail,!1),this.AFn(P,ca,b.type)):t.ULS.sendTraceTag(538817432,324,50,"insertFluidComponentCore: insertPictureResult is null")}GWo(b,h){Kl.jg.Ge(b,"");return Kl.rJd(b,h)}AFn(b,h,r){Kl.D9d("IsHyperlinkWithNonURLDisplayText",b,"Office.Word.Online.ExternalContent.FluidComponent");Kl.ariaNotify(h,this.BOl(r))}BOl(b){switch(b){case UC.a.CheckList:return"Checklist Component";
case UC.a.TaskAssignment:return"Task List Component";case UC.a.Poll:return"Poll Component";default:return"Fluid Component"}}rci(b,h){const r=new dF;r.width=Kl.N1.T6b(b.node)||0;sB.j()?r.height=null!=ot.mYa&&ot.mYa.K8h(h)||Kl.N1.j1a(b.node)||0:r.height=null!=ot.mYa&&ot.mYa.K8h(h)+2*vA.a.c4||Kl.N1.j1a(b.node)||0;r.title="Fluid Component";r.mediaType="fluid";r.type=h;r.thumbnail=this.$Yl();r.url=null!=ot.mYa&&"https://fa000000096.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2210.23001/en-us_web/assets/fallback.jpg";
return r}$Yl(){return ot.mYa.M8h()}get Yqg(){return null!=this.xJg?this.xJg:this.xJg=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.useUpdatedFluidThumbailEnabledV3",!1)}static FWc(b){v.AFrameworkApplication.oe("2cejb611;b0jjh576");return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=ot.mYa&&ot.mYa.qDi(b)&&pE.a.kXk(b)}}Object(m.a)(ot,"FluidComponentEditor",yx,[]);class eF{get kAl(){return null!=this.Iyg?
this.Iyg:this.Iyg=Ma.a.instance.resolve("Wonca.ExternalContent.IExternalContentEditor")}get cPd(){return null!=this.aAg?this.aAg:this.aAg=Ma.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}uFn(b,h){b&&(ot.FWc(h)?this.cPd.UQa(b,h,!0):this.kAl.UQa(b,h,!0))}}Object(m.a)(eF,"PostHyperlinkAutoCorrectStrategy",null,[451]);class nr{o4b(b,h){h(nr.FFn.test(b))}Jjc(b,h){b.startsWith("https")||(b=b.replace("http","https"));b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen='' sandbox='allow-scripts allow-same-origin'></iframe>",
960,960,b);b=Object.assign(new wx,{OperationId:0,StatusCode:0,MediaType:"rich",Height:960,Width:960,Thumbnail:nr.thumbnailUrl,Title:"Power BI",IFrameHtml:b});h(b)}}nr.FFn=RegExp("^https?:\\/\\/(app|msit).powerbi.com\\/view\\?r=[^\\/]+$","i");nr.thumbnailUrl="https://www.onenote.com/Images/oembed_powerbi_defaultthumbnail.png";Object(m.a)(nr,"PowerBIURLResolver",null,[445,446]);class Pq{constructor(b){this.dlh=b}o4b(b,h){let r=!1;try{if(Pq.GVm(b)){const B=this.dlh.v$b(b);r=null!=B.width&&null!=B.height&&
!!B.thumbnailUrl&&!!B.title&&null!=B.Ara}}catch(B){}h(r)}Jjc(b,h){var r=this.dlh.v$b(b);b=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' style='border:none' allowfullscreen='true' allow='accelerometer; autoplay; battery; camera; clipboard-write; encrypted-media; fullscreen; gyroscope; picture-in-picture; sync-xhr; wake-lock; screen-wake-lock; web-share' sandbox='allow-downloads allow-forms allow-modals allow-pointer-lock allow-popups allow-presentation allow-scripts allow-same-origin'></iframe>",
r.width,r.height,b);r=Object.assign(new wx,{Height:r.height,IFrameHtml:b,MediaType:"rich",OperationId:0,StatusCode:0,Thumbnail:r.thumbnailUrl,Title:r.title,Width:r.width});h(r)}static GVm(b){for(const h of Pq.OFo)if(b.startsWith(h))return!0;return!1}static x8(){return new Pq(Ma.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser"))}}Pq.OFo=["https://wedge.wedge:9090/","https://wedgecomponents.azurewebsites.net/"];Object(m.a)(Pq,"WedgeComponentExperimentsURLResolver",null,[445,
446]);var tB=c(887);let kv=!1;class an{static Nsj(b){an.Tzi||an.addEventListener();const h=Ma.a.instance.Ta("Common.ISystemInitiatedFeedback");h&&h.execute(r=>{r.logActivity(b,null)})}static addEventListener(){window.addEventListener(an.vGo,an.uGo,!0);an.Tzi=!0}static LZk(){const b=window.document.getElementById("LoopComponent");null===b||void 0===b?void 0:b.click();kv=!0}}an.EIo="LoopsTeachingCalloutOnInsertTabActivity";an.Z8m="LoopHomeTabFlightActivity";an.vGo="switchToInsertTabAndClickLoopButtonEvent";
an.Tzi=!1;an.uGo=()=>{var b,h;appChrome.api.dispatch(appChrome.actions.setCurrentTab("Insert"));const r=null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.mc("WordLoopsTUIButtonDropdownDelayInMs",50);b=new Me.a(0,1,r,()=>{an.LZk()});null===(h=v.AFrameworkApplication.lc)||void 0===h?void 0:h.Wb(b)};Object(m.a)(an,"FluidComponentsTUIHelper",null,[]);class qE{constructor(b,h,r){this.ga=b;this.x3j=h;this.Ok=r;this.$1g=!1;this.t6g=1E3;this.u6g=15E3;this.lTe=this.cTe=!0;this.lTe=!!v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowLoopComponentSurveyEnabled",!1);this.t6g=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.LoopComponentDropdownFocusTime",1E3);this.u6g=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.NotUseLoopComponentSurveyTriggerTime",15E3)}Tb(){this.ga.fb(qb.a.Wsi,yc.a.Uc,this.bEm.bind(this),1028);this.ga.fb(qb.a.iae,yc.a.Uc,
this.iae.bind(this),1028);this.ga.fb(qb.a.oVc,yc.a.Uc,this.pCf.bind(this),1028);this.ga.fb(qb.a.aVc,yc.a.Uc,this.pCf.bind(this),1028);this.ga.fb(qb.a.hYd,yc.a.Uc,this.pCf.bind(this),1028);this.ga.fb(qb.a.TGi,yc.a.Uc,this.WPj.bind(this),1028)}bEm(){return 32}iae(b,h,r){if(2!==r)return 32;this.lTe&&(this.ibj(),this.fOo());return 32}pCf(b,h,r){var B,P,ca;if(1===r){if(!this.d_d(b)||!tB.a.xyi())return t.ULS.sendTraceTag(508937180,324,50,"Loops feature is disabled as it is not supported"),2;(null===(B=
v.AFrameworkApplication.K)||void 0===B?0:B.getBooleanFeatureGate("Microsoft.Office.WordOnline.isLoopsTUIEnabled",!1))&&an.Nsj(an.EIo);if(!h.el||!xe.SelectionEditor.Ze(h)||(null===(P=this.Ok)||void 0===P?0:P.$_(h))||(null===(ca=this.Ok)||void 0===ca?0:ca.via(h)))return 2;if(h&&h.node&&TC.a(h.node))return 32}else if(2===r)return this.x3j.Dal(h,qE.YYl(b)),this.ibj(),32;return 2}fOo(){if(null!=Ua.a.instance.getItem("LoopComponentSurveyShowed")||kv)this.cTe=!1;if(this.cTe){let b=this.qci();window.setTimeout(()=>
{b&&"hidden"!==b.visibility&&(this.$1g=!0)},this.t6g);this.Vgk=window.setTimeout(()=>{const h=Ma.a.instance.Ta("Common.ISystemInitiatedFeedback");this.$1g&&h&&h.execute(r=>{(b=this.qci())&&"hidden"===b.visibility&&!kv&&(t.ULS.sendTraceTag(508941015,324,50,"Triggering not use loop component survey"),r.$Ia("WordLoopFeedbackSurvey",null),this.cTe=!1,Ua.a.instance.setItem("LoopComponentSurveyShowed","true"))})},this.u6g)}}qci(){var b,h;let r=null;try{const B=document.getElementById("Ribbon-LoopComponentDropdown");
B&&(r=Sm.a.AB(null===(h=null===(b=B.parentNode)||void 0===b?void 0:b.parentNode)||void 0===h?void 0:h.parentNode))}catch(B){t.ULS.sendTraceTag(508941014,324,10,"Loop component dropdown get parent and parent get exception "+(null!=B?B.toString():""))}return r}ibj(){this.lTe&&window.clearTimeout(this.Vgk)}d_d(b){return b===qb.a.aVc||b===qb.a.oVc?pE.a.d_d():!0}WPj(b,h,r){2===r&&F.a.xP("https://go.microsoft.com/fwlink/?linkid=2194838")&&Eb.App.Qag.uoc("https://go.microsoft.com/fwlink/?linkid=2194838");
return 32}static YYl(b){switch(b){case qb.a.oVc:return UC.a.TaskAssignment;case qb.a.aVc:return UC.a.CheckList;case qb.a.hYd:return UC.a.Poll;default:return null}}}Object(m.a)(qE,"FluidComponentsActor",null,[]);class Ej extends yx{constructor(){super();this.DKb=this.CKb=null;this.$jf=new bF.ExternalContentEmbedRetriever;this.dvc=null;null!=Ej.loa&&Ej.loa.e8h()}y7i(){this.uo=V.a.create();Ej.qf.mDb(this.uo,4);Ej.qf.C5(this.uo,0,Ej.qf.so());this.DIb(this.CKb,3,this.DKb,!0)}UQa(b,h,r){this.uo=V.a.create();
Ej.qf.mDb(this.uo,r?0:2);Ej.qf.C5(this.uo,0,Ej.qf.so());this.dvc();this.DIb(b,r?0:2,h)}D$d(b,h){this.uo=V.a.create();Ej.qf.mDb(this.uo,1);Ej.qf.C5(this.uo,0,Ej.qf.so());this.DIb(b,1,h)}t9i(b){this.dvc=b}Vre(b,h){const r=Ej.N1.T6b(h)||0;h=Ej.N1.j1a(h)||0;const B=b.Width/b.Height;1<=B?(b.Width=r,b.Height=r/B):(b.Height=h,b.Width=h/B)}nug(b,h,r){if(null!=b&&null!=h&&!F.a.af(r)){var B=Ej.G1c.v$b(r);v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveOnlineVideoTitleOnInsertionWithDialog",
!1)?B.Ara=!1:B.Ara=!0;B.hideFloatie=!0;this.Vre(b,h.node);this.Hbc(b,h,!1,!1,B,r)}}zjb(b){return b?b.Se:0}org(b,h,r){let B=null;const P=b.node;if(!ke.ParagraphReader.Xb(P)||!P.isConnected)return{returnValue:!1,asa:B};if(r)return{returnValue:!0,asa:b};r=b.cpBegin;const ca=b.cpEnd,ra=ke.ParagraphReader.text(P);if(0<=r&&ca<=ra.length&&ra.substring(r,ca)===h)return{returnValue:!0,asa:b};const Qa=ra.indexOf(h);return 0<=Qa?(B=Ue.a.createTextRange(P,Qa,Qa+h.length),{returnValue:!0,asa:B}):0<=r&&ca<=ra.length&&
Kl.Hac(b)?{returnValue:!0,asa:b}:{returnValue:!1,asa:B}}YIf(b){return null==b.width&&null==b.height||null!=b.width&&null!=b.height&&0<b.width&&0<b.height?!0:!1}b9a(b,h){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$(h)&&window.setTimeout(()=>{const r=Ma.a.instance.Ta("Common.ISystemInitiatedFeedback");r&&r.execute(B=>{B.logActivity(b,h)})},Ej.xEa)}DIb(b,h,r,B=!1){if(this.ZJj(b,r,!h)){var P=Ej.G1c.v$b(r);P&&(this.YIf(P)?(t.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent"),
this.j2f(b,h,P,r,B)):(t.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),Ej.qf.kR(this.uo,2,"Size provided is not valid for OEmbed",Ej.qf.so())))}}j2f(b,h,r,B,P){const ca=!h,ra=1===h,Qa=Ej.N1.T6b(b.node)||0,tb=Ej.N1.j1a(b.node)||0,Mb=aF.a.l$e(r.Iqg,!0,Qa,tb);this.F_c(b,B,h,!0);this.$jf.vDh(Mb,Zb=>{Ej.qf.C5(this.uo,4,Ej.qf.so());Ej.qf.A9c(this.uo,this.zjb(Zb.data));if(Zb=this.p2f(Zb)){t.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");
var jc=sB.q(Zb.MediaType);Ej.qf.Xce(this.uo,7,jc);jc=b;({asa:jc}=this.org(b,B,ra)).returnValue?(this.F_c(jc,B,h,!1),null==r.width?0<Qa&&Zb.Width>Qa&&(t.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),Zb.Width=Qa):(t.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),Zb.Width=this.ned(r.width,Zb.Width,Qa)),null==r.height?0<tb&&Zb.Height>tb&&(t.ULS.sendTraceTag(591681427,
324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),Zb.Height=tb):(t.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),Zb.Height=this.ned(r.height,Zb.Height,tb)),Ej.loa.cab||P?this.Hbc(Zb,jc,ca,ra,r,B):(this.CKb=b,this.DKb=B,this.zKc(B))):(t.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),
Ej.qf.kR(this.uo,2,"No conversion as the context is no longer valid for the external content conversion",Ej.qf.so()));ra&&this.q0a(jc.node)}else ra&&this.q0a(b.node),Ej.qf.kR(this.uo,1,"URL not oEmbedable",Ej.qf.so())},Zb=>{Ej.qf.C5(this.uo,4,Ej.qf.so());Ej.qf.A9c(this.uo,this.zjb(Zb.data));ra&&this.q0a(b.node);t.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Zb.data.se);Ej.qf.kR(this.uo,2,"ExternalContentEmbedRequest failed",Ej.qf.so())},Zb=>{ra&&this.q0a(b.node);
t.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Zb)},this.uo)}ned(b,h,r){!b&&0<r&&h>r||b>r?(t.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),h=r):b>r?h=r:b&&b<r&&(h=b);return h}Hbc(b,h,r,B,P,ca){this.Yl=Bb.a.create();b.Width=b.Width/b.Height*(b.Height-(vA.a.vTc+vA.a.c4))+2*vA.a.c4;const ra=new cg.GraphTransaction(15);ra.Db(h.node);ra.Uj=qb.a.UQa;const Qa=Kl.Hac(h);null!=P.Ara&&!P.Ara||
B||Qa||(b.Title=""===P.title||P.title?P.title:b.Title,!b.Title&&""!==b.Title)||(h=this.ECf(h,ra,b.Title,ca,r));if(h){B&&(h=this.uef(h));var tb=Kl.rJd(h,B);if(tb){r=sB.q(b.MediaType);var Mb=Kl.ZTd(b.Height,b.Width,b.Title,r);(tb=this.lCf(tb,Mb,B,{url:ca,E0a:b.IFrameHtml,$w:b.Title,mediaType:r},b.ProviderName))?(ra.eHa(this.Yl,1),ra.dispose(),this.CKb=h,this.DKb=ca,this.XZf(P,b,tb),this.Y1f(ca,B||P.hideFloatie,Qa,r,b.Title,b.ProviderName)):ra.dispose()}else ra.dispose(),t.ULS.sendTraceTag(590455041,
324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),Ej.qf.kR(this.uo,2,"Could not create IP context on splitting the paragraph",Ej.qf.so())}else Ej.qf.kR(this.uo,2,"GraphNodeContext is null",Ej.qf.so())}lCf(b,h,r,B,P){if(!b)return null;b=Ej.qP.dYd(b,h);if(!b)return t.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),Ej.qf.kR(this.uo,2,"The anchored image could not be inserted",Ej.qf.so()),
null;b=b.node;B=Kl.$Xd(b,B,P);Ej.qf.Kpg(this.uo,B.id);r||Kl.ndg(b);return b}XZf(b,h,r){F.a.p8(b.thumbnailUrl)||(h.Thumbnail=b.thumbnailUrl);h.Thumbnail&&h.Thumbnail.length&&(Ej.qf.C5(this.uo,8,Ej.qf.so()),t.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.ILd(r,h.Thumbnail,!1))}Y1f(b,h,r,B,P,ca){h||this.zKc(b);this.b9a("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");Kl.D9d("IsHyperlinkWithNonURLDisplayText",r,"Office.Word.Online.ExternalContent.OEmbedInsertions",
ca);Kl.ariaNotify(B,P);Ej.qf.C5(this.uo,5,Ej.qf.so())}ECf(b,h,r,B,P){if(P){if((P=Tg.a.Ez(b,!1))&&1!==P.length)return h.dispose(),t.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;Kl.hp.iS(P[0].paragraph,P[0].hyperlink)}return this.y9f(b,r,B)}uef(b){const h=b.node,r=ke.ParagraphReader.text(h);return 0<r.length&&!r.trim().length?(b=Ue.a.createTextRange(h,0,r.length),Kl.jg.Ge(b,""),Ue.a.Rc(h,0)):b}p2f(b){if(!({group:b}=
kl.a.d2(b.data.se)).returnValue)return null;b=b.Responses[0];return b.StatusCode?null:b}y9f(b,h,r){const B=b.cpBegin+h.length;Kl.jg.Ge(b,h);b=Ue.a.createTextRange(b.node,b.cpBegin,B);Kl.hp.fF(b,r,!1);return b}q0a(b){b.$hc=null}F_c(b,h,r,B){const P=b.cpBegin,ca=b.cpEnd;b=ke.ParagraphReader.text(b.node).trim();P||b!==h&&""!==b?P?ca===b.length?t.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
xx[r],B):0<P&&ca<b.length&&t.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",xx[r],B):t.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",xx[r],B):t.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
xx[r],B)}zKc(b){this.$6b();const h=new mw.a(1,v.AFrameworkApplication.isRtl);h.M3c=b;Ej.Whb.S5c(h)}$6b(){const b=new wh.a(!0);Ej.i$.gIa(b)}static get Whb(){return null!=Ej.Kyg?Ej.Kyg:Ej.Kyg=Ma.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get loa(){Ej.uBa||(Ej.uBa=Ma.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return Ej.uBa}static get i$(){return null!=Ej.dGg?Ej.dGg:Ej.dGg=Ma.a.instance.resolve("Box4.IPasteFloatieEventSource")}static get N1(){return null!=
Ej.bHg?Ej.bHg:Ej.bHg=Ma.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior")}static get qP(){return null!=Ej.uBg?Ej.uBg:Ej.uBg=Ma.a.instance.resolve("WordEditor.IImageEditor")}static get G1c(){return null!=Ej.OEg?Ej.OEg:Ej.OEg=Ma.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser")}}Ej.xEa=5E3;Ej.uBa=null;Object(m.a)(Ej,"ExternalContentEditorV2",yx,[]);class rE{constructor(){this.rd=this.W=null}get name(){return"WordEditor.ExternalContent"}get Zb(){return this.rd?
this.rd:this.rd=this.W.resolve("Box4.IFeatureHelper")}wc(b){var h;this.W=b;b.ia("WordEditor.ExternalContent.ExternalContentSizeBehavior",()=>new yz.a(Rn.a.instance,Cm.WordSectionNavigator.instance)).as("WordEditor.ExternalContent.IExternalContentSizeBehavior").ha();b.ia("WordEditor.ExternalContent.PostHyperlinkAutoCorrectStrategy",()=>new eF).as("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy").ha();b.ia("WordEditor.ExternalContent.ExternalContentSettingInfo",()=>new cF(b.resolve("Box4.IRoamingServiceRequestManager"),
b.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.ExternalContent.IExternalContentSettingInfo").ha();v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)?(b.ia("WordEditor.ExternalContent.ExternalContentEditorV2",()=>new Ej).as("Wonca.ExternalContent.IExternalContentEditor").ha(),b.ia("WordEditor.ExternalContent.FluidComponentEditor",()=>new ot(b.resolve("Fluid.Host.LoopComponentManager"))).ha(),b.ia("WordEditor.ExternalContent.FluidComponentsActor",
()=>new qE(v.AFrameworkApplication.va,b.resolve("WordEditor.ExternalContent.FluidComponentEditor"),Wh.a.instance)).ha(),(null===(h=v.AFrameworkApplication.K)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isLoopsHomeTUIEnabled",!1))&&an.Nsj(an.Z8m)):b.ia("WordEditor.ExternalContent.ExternalContentEditor",()=>new Zg).as("Wonca.ExternalContent.IExternalContentEditor").ha()}init(){this.Zb.pq.continueWith(()=>{this.wn()});v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",
!1)&&this.W.resolve("WordEditor.ExternalContent.FluidComponentsActor").Tb()}dispose(){}tal(){const b=new nC;this.KWh()&&b.Lph(Pq.x8());b.Lph(new nr);return b}wn(){null==v.AFrameworkApplication.K||v.AFrameworkApplication.K.$("IOEmbedOverridesURLParserCrashFixIsEnabled")||this.W.ia("WordEditor.ExternalContent.OEmbedQueryParamsOverridesURLParser",()=>new bG.a).as("WordEditor.ExternalContent.IOEmbedOverridesURLParser").ha();this.KWh()&&(this.W.ia("WordEditor.ExternalContent.IWordExternalContentURLResolver",
()=>this.tal()).as("WordEditor.ExternalContent.IWordExternalContentURLResolver").ha(),this.W.resolve("WordEditor.ExternalContent.IWordExternalContentURLResolver"))}KWh(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableInnerRingWEdgeExperimentsOEmbedURLResolver",!1)}static main(){L.a.instance.Gc(new rE)}}Object(m.a)(rE,"ExternalContentPackage",null,[1,2]);var uB;(function(b){b[b.invalid=-1]="invalid";b[b.clear=0]="clear";b[b.left=1]="left";b[b.start=2]="start";
b[b.center=3]="center";b[b.right=4]="right";b[b.end=5]="end";b[b.decimal=6]="decimal";b[b.ffp=7]="bar";b[b.HSa=8]="num"})(uB||(uB={}));Object(m.b)("TabStopValues",uB);class Wp{}Wp.GQh=8;Wp.Cjl=1;Wp.S8="wwaengidc";Wp.kpiName="WordRuler";Wp.precision=.0625;Wp.zHo=1;Wp.B1o="ShowHideRuler";Object(m.a)(Wp,"Constants",null,[]);var DD=c(768);class Ls{static N$b(b,h){if(!Ls.dYc)return null;switch(b){case "Left":return r=>{const B=r.rulerCanvasProps;r=r.indents;return{OKb:0,CPb:B.scale-(B.margins[1].value+
r[2].value+Math.max(r[0].value,r[1].value)+8*B.precision)}};case "Right":return r=>{const B=r.rulerCanvasProps;r=r.indents;return{OKb:0,CPb:B.scale-(r[2].value+(B.margins[0].value+Math.max(r[0].value,r[1].value))+8*B.precision)}};case "MoveTableColumn":return()=>{let r=0,B=0;if(0===h){var P={};32===Ls.oc.Qb(Nb.a.Sic,2,P)&&(r=Ze.a.Yz(P.MinIndent),B=Ze.a.Yz(P.MaxIndent))}else P={Fo:h-1},32===Ls.oc.Qb(Nb.a.Ric,2,P)&&(r=Ze.a.Yz(P.MinResize),B=Ze.a.Yz(P.MaxResize));return{OKb:r,CPb:B}};case "Top":return r=>
{r=r.rulerCanvasProps;return{OKb:0,CPb:r.scale-(r.margins[1].value+8*r.precision)}};case "Bottom":return r=>{r=r.rulerCanvasProps;return{OKb:0,CPb:r.scale-(r.margins[0].value+8*r.precision)}}}return null}static lUd(b){if(!Ls.dYc)return null;switch(b){case "FirstLineIndent":case "HangingIndent":case "LeftIndent":return h=>{var r=h.rulerCanvasProps,B=h.indents,P=h.ipContextIndex;h=r.margins;var ca=r.scale;r=r.precision;if("MoveTableColumn"!==h[0].type){P=h[0].value;h=h[1].value+B[2].value;var ra=P;
"LeftIndent"===b&&(ra+=Math.max(B[0].value,B[1].value));B=-1*P;r=ca-(ra+h+8*r)}else{ca=0;for(ra=0;ra<=P;ra++)ca+=h[ra].value;ra=0;if("LeftIndent"===b){ra=B[0].value;const Qa=B[1].value;ca+=Math.max(ra,Qa);ra=Math.max(ra,Qa)}h=h[P+1].value;ra+=B[2].value;B=-1*ca;r=h-ra-r}return{OKb:B,CPb:r}};case "RightIndent":return h=>{var r=h.rulerCanvasProps,B=h.indents,P=h.ipContextIndex,ca=r.margins;h=r.scale;r=r.precision;if("MoveTableColumn"!==ca[0].type){var ra=ca[0].value;ca=ca[1].value;P=B[0].value;var Qa=
B[1].value;B=-1*ca;h-=ra+ca+Math.max(P,Qa)+8*r}else{ra=0;for(Qa=0;Qa<=P;Qa++)ra+=ca[Qa].value;ca=ca[P+1].value;P=B[0].value;Qa=B[1].value;B=-1*(h-ra-ca);h=ca-Math.max(P,Qa)-r}return{OKb:B,CPb:h}}}return null}static Rcm(){return b=>{var h=b.rulerCanvasProps,r=b.indents,B=b.ipContextIndex,P=h.margins;b=h.precision;h=h.scale;"MoveTableColumn"!==P[0].type?(B=P[0].value,P=P[1].value+r[2].value,r=Math.min(r[0].value,r[1].value)+b,b=h-(B+P+b)):(h=r[2].value,P=P[B+1].value,r=Math.min(r[0].value,r[1].value)+
b,b=P-(h+b));return{OKb:r,CPb:b}}}static get oc(){return null!=Ls.owg?Ls.owg:Ls.owg=v.AFrameworkApplication.va}static get dYc(){null==this.dcb&&(v.AFrameworkApplication.Oia("WoRul910;WoRul910cf"),this.dcb=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RulerPropertyBoundaryIsEnabled",!1):!1);return this.dcb}}Ls.dcb=null;Object(m.a)(Ls,"RulerPropertyBoundaryHelper",null,[]);var VC=c(936),Gt=c(1501),ED=c(1074),dG=c(1258),eG=c(1259);class vy{constructor(b,
h,r,B,P,ca){this.kyn="OutlineContainer";this.Tnk="UpdateCustomTabFailed";this.Eyb="ReadRulerPropertiesFailed";this.Xnk="UpdateIndentFailed";this.Rkh="UpdateMarginFailed";this.v8d=ra=>{ra.button===Sys.UI.MouseButton.rightButton&&this.yRe.show(new Sys.UI.Point(ra.clientX,ra.clientY),2)};this.NHj=()=>{this.FVa()};this.kn=b;this.yZb=h;this.ga=r;this.yRe=B;this.pz=P;this.oT=ca;this.IWb=null;this.Pw=!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.tL;this.TWi=this.g8d.bind(this);this.CZi=this.kt.bind(this);
this.MHj=this.FVa.bind(this)}fC(){this.z_e();this.Rph();this.yZb.Il.Ue(10).Eo(this.TWi);He.a.addHandler(this.gYe,pd.a.scroll,this.NHj);this.kn.execute(h=>{h.fZ(this.CZi)});const b=[this.mtf(),document.getElementById(Qi.AppFrame.yed),document.getElementById("PageContentContainer")];this.IWb?this.IWb.register(b,this.MHj):ED.a(Gt.a.appChromeLazyReady,()=>{appChrome.getResizeObserver().then(h=>{this.IWb=h.createResizeObserver();this.IWb.register(b,this.MHj);return null})});Eb.App.za.aJ.registerBoundingWindowRectsChanged("documentPanel",
(h,r)=>{"undefined"!==r&&this.s9a([1,0])})}mtf(){return 1===this.oT.nu?this.Mek:this.jek}get gYe(){return document.getElementById(Qi.AppFrame.TVa)}get jek(){const b=document.getElementsByClassName(this.kyn);return b&&0<b.length?b[0]:null}get Mek(){var b=this.pz.cFb;if(!b)return null;b=this.eco(ke.ParagraphReader.tR(b));return VC.a.gei(b)}eco(b){return 0<b?document.querySelector("div.PagesContainer p[paraid='"+b+"']"):null}get UN(){return this.kn&&this.kn.instance?this.kn.instance.nj:Wp.Cjl}e$b(){const b=
{};return 32!==this.ga.Qb(Nb.a.cIa,2,b)?(t.ULS.sendTraceTag(529065947,dG.a.msoulscat_Wac_WordRuler,eG.a.warning,"Unable to read page properties for Ruler"),Cl.recordQosError(this.Eyb,[Cl.Yfa],"Unable to read page properties for Ruler"),null):b}dispose(){this.Joi();this.yZb.Il.Ue(10).jS(this.TWi);He.a.removeHandler(this.gYe,pd.a.scroll,this.NHj);this.kn.execute(b=>{b.OTa(this.CZi)});this.IWb&&this.IWb.dispose();Eb.App.za.aJ.unregisterBoundingWindowRectsChanged("documentPanel",(b,h)=>{"undefined"!==
h&&this.s9a([1,0])})}get sAi(){null==vy.LGe&&(vy.LGe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&v.AFrameworkApplication.K.$("RulerThemingIsEnabled"):!1);return vy.LGe}}vy.LGe=null;Object(m.a)(vy,"ARuler",null,[278]);var fF=c(294);class pt extends vy{constructor(b,h,r,B,P,ca,ra){super(b,h,r,P,ca,ra);this.yP="HorizontalRuler";this.cOj="CustomTabModificationFromRuler";
this.EPj="IndentModificationFromRuler";this.gre="MarginModificationFromRuler";this.cZg=this.bZg=this._tabStops=null;this.snn=(Qa,tb,Mb)=>{if(!(Qa>=this._tabStops.length)){Qa=this._tabStops[Qa];var Zb="Modify"===Mb?this.ga.Qb(qb.a.bgc,2,{["tabStop"]:Qa,["value"]:Ze.a.Nv(tb)}):this.ga.Qb(qb.a.f7a,2,Qa);if(32===Zb){tb=1;var jc=String.format("Custom tab modified using ruler. Operation: {0}. CustomTab: {1}",Mb,uB[Qa.xea]);t.ULS.sendTraceTag(591213271,3014,50,jc)}else tb=0,jc=String.format("Unable to modify custom tab using ruler. Operation: {0}. CustomTab: {1}",
Mb,uB[Qa.xea]),t.ULS.sendTraceTag(591213272,3014,15,jc),Cl.recordQosError(this.Tnk,[Cl.Yfa],"Unable to modify custom tab using ruler");Ke.a(this.cOj,32===Zb,void 0,[Object.assign(new ha.a,{name:"Operation",string:Mb}),Object.assign(new ha.a,{name:"TabType",int64:uB[Qa.xea]})]);Mb=new Map;Mb.set("Command","OnCustomTabChange");Mb.set("Source",this.yP);Mb.set("Response",jc);va.Health.instance.recordKpiUsage(Wp.kpiName,tb,Wp.S8,Mb)}};this.Kpn=(Qa,tb)=>{var Mb=new DD.a;Mb.unit=1;Mb.value=Ze.a.Nv(tb);tb=
8;switch(Qa){case "FirstLineIndent":tb=this.ga.Qb(Nb.a.T9c,2,Mb);break;case "HangingIndent":tb=this.ga.Qb(Nb.a.U9c,2,Mb);break;case "LeftIndent":tb=this.ga.Qb(Nb.a.J3a,2,Mb);break;case "RightIndent":tb=this.ga.Qb(Nb.a.I3a,2,Mb)}let Zb;32===tb?(Mb=1,Zb=String.format("Indents set using Ruler. Indent: {0}",Qa),t.ULS.sendTraceTag(592517017,3014,50,Zb)):(Mb=0,Zb=String.format("Unable to set indent using Ruler. Indent: {0}",Qa),t.ULS.sendTraceTag(592496523,3014,15,Zb,Qa),Cl.recordQosError(this.Xnk,[Cl.Yfa],
"Unable to set indent using Ruler."));Ke.a(this.EPj,32===tb,void 0,[Object.assign(new ha.a,{name:"Type",string:Qa})]);Qa=new Map;Qa.set("Command","OnIndentChange");Qa.set("Source",this.yP);Qa.set("Response",Zb);va.Health.instance.recordKpiUsage(Wp.kpiName,Mb,Wp.S8,Qa)};this.BXf=(Qa,tb,Mb)=>{let Zb;Zb="Left"===Qa?this.ga.Qb(Nb.a.aka,2,Ze.a.Nv(tb)):"Right"===Qa?this.ga.Qb(Nb.a.W7a,2,Ze.a.Nv(tb)):Mb?this.ga.Qb(Nb.a.ole,2,{["columnIndex"]:Mb-1,["width"]:Ze.a.Nv(tb)}):this.ga.Qb(Nb.a.slc,2,Ze.a.Nv(tb));
32===Zb?(tb=1,Mb=String.format("Margins set using Ruler. Margin: {0}",Qa),t.ULS.sendTraceTag(592517018,3014,50,Mb)):(tb=0,Mb=String.format("Unable to set margins using Ruler. Margin: {0}",Qa),t.ULS.sendTraceTag(592496524,3014,15,Mb),Cl.recordQosError(this.Rkh,[Cl.Yfa],"Unable to set margins using Ruler."));Ke.a(this.gre,32===Zb,void 0,[Object.assign(new ha.a,{name:"Type",string:Qa})]);Qa=new Map;Qa.set("Command","OnMarginChange");Qa.set("Source",this.yP);Qa.set("Response",Mb);va.Health.instance.recordKpiUsage(Wp.kpiName,
tb,Wp.S8,Qa)};this.oNa=B;this.sr={}}get GU(){return this.bZg}get TFa(){return this.cZg}renderRuler(){this.GU.classList.remove("HideWACHorizontalRulerContainer");this.GU.classList.add("ShowWACHorizontalRulerContainer");var b=this.e$b();if(b){var h=this.BXf,r=this.Kpn,B=this.snn,P=this.Ncd(),ca=this.jCj(),ra=this.iCj();P&&ca&&ra||(this.sr.disabled=!0);this.sr.onIndentChange=r;this.sr.onMarginChange=h;this.sr.onTabChange=B;this.FVa();b=xg.a.Qi(b.Ko,0);this.TFa.style.width=(b*this.UN).toString()+"px";
return this.oNa().then(Qa=>{Qa.renderRuler(this.TFa,this.sr)})}}iCj(){const b=[];var h={};if(32!==this.ga.Qb(qb.a.kOb,2,h))return t.ULS.sendTraceTag(589651997,3014,15,"Unable to read paragraph tabs for Ruler"),Cl.recordQosError(this.Eyb,[Cl.Yfa],"Unable to read paragraph tabs for Ruler"),!1;var r=h.customTabs;if(!r||0>=r.length)return this.sr.tabs=b,!0;this._tabStops=r;h="";for(const B of r){switch(B.xea){case 1:h="LeftTab";break;case 4:h="RightTab";break;case 3:h="CenterTab";break;case 6:h="DecimalTab";
break;case 7:h="BarTab"}r=xg.a.D6a(B.jJa,0);b.push({["type"]:h,["value"]:r,["getRulerPropertyBoundary"]:Ls.Rcm()})}this.sr.tabs=b;return!0}s9a(b){var h;if(this.GU){this.GU.classList.add("ShowWACHorizontalRulerContainer");"disabled"in this.sr&&delete this.sr.disabled;for(const r of b)switch(r){case 0:b=this.jCj();const B=this.iCj();b&&B||(this.sr.disabled=!0);break;case 1:this.Ncd()||(this.sr.disabled=!0)}if(null===(h=this.pz.lb)||void 0===h?0:h.EWc)this.sr.disabled=!0;this.oNa().then(r=>{r.renderRuler(this.TFa,
this.sr);return null})}}Ncd(){const b={};var h=this.e$b();if(!h)return!1;b.scale=Ze.a.Yz(h.Ko);b.precision=Wp.precision;b.rulerType="Horizontal";if(!this.Fwn())return this.sr.ipContextIndex=0,this.sr.permittedUnits=Wp.GQh,h=[{["type"]:"Left",["value"]:Ze.a.Yz(h.marginLeft),["getRulerPropertyBoundary"]:Ls.N$b("Left",0)},{["type"]:"Right",["value"]:Ze.a.Yz(h.marginRight),["getRulerPropertyBoundary"]:Ls.N$b("Right",1)}],b.margins=h,this.sr.rulerCanvasProps=b,!0;var r={};h={};var B=this.ga.Qb(Nb.a.C5c,
2,r);const P=this.ga.Qb(Nb.a.xOb,2,h);if(32!==B||32!==P)return t.ULS.sendTraceTag(589651998,3014,15,"Unable to read table properties for Ruler"),Cl.recordQosError(this.Eyb,[Cl.Yfa],"Unable to read table properties for Ruler"),!1;r=r.ColumnWidths;B=h.TablePosition;if(!B||!r||0>=r.length)return t.ULS.sendTraceTag(589632533,3014,15,"Cannot show table properties on the ruler as they are null"),Cl.recordQosError(this.Eyb,[Cl.Yfa],"Cannot show table properties on the ruler as they are null"),!1;h=Array(r.length+
1);h[0]={["type"]:"MoveTableColumn",["value"]:Ze.a.Yz(B.x/this.UN),["getRulerPropertyBoundary"]:Ls.N$b("MoveTableColumn",0)};for(B=0;B<r.length;B+=1)h[B+1]={["type"]:"MoveTableColumn",["value"]:Ze.a.Yz(r[B]),["getRulerPropertyBoundary"]:Ls.N$b("MoveTableColumn",B+1)};this.sr.ipContextIndex=this.Hgm();this.sr.permittedUnits=Wp.zHo;b.margins=h;this.sr.rulerCanvasProps=b;return!0}jCj(){var b={};if(32!==this.ga.Qb(Nb.a.U6a,2,b))return t.ULS.sendTraceTag(592496522,3014,15,"Unable to read paragraph indentation for Ruler"),
Cl.recordQosError(this.Eyb,[Cl.Yfa],"Unable to read paragraph indentation for Ruler"),!1;const h={type:"FirstLineIndent"};h.getRulerPropertyBoundary=Ls.lUd("FirstLineIndent");const r={type:"HangingIndent"};r.getRulerPropertyBoundary=Ls.lUd("HangingIndent");const B={type:"RightIndent"};B.getRulerPropertyBoundary=Ls.lUd("RightIndent");const P={type:"LeftIndent"};P.getRulerPropertyBoundary=Ls.lUd("LeftIndent");this.sr.rtl=b.isRtl;b=b.Lt;h.value=1===b.specialIndentType?Ze.a.Yz(b.sea+b.OB):2===b.specialIndentType?
Ze.a.Yz(b.OB-b.sea):Ze.a.Yz(b.OB);r.value=Ze.a.Yz(b.OB);P.value=Ze.a.Yz(b.OB);B.value=Ze.a.Yz(b.jpa);this.sr.indents=[h,r,B,P];return!0}Rph(){He.a.addHandler(this.GU,pd.a.Wx,this.v8d)}Joi(){this.GU&&(this.GU.classList.remove("ShowWACHorizontalRulerContainer"),this.GU.classList.add("HideWACHorizontalRulerContainer"),He.a.removeHandler(this.GU,pd.a.Wx,this.v8d));this.oNa().then(b=>{b.dispose(this.TFa);return null})}kt(){this.PHj();this.FVa();this.s9a([1,0])}g8d(b,h){b=h.property;if(b===Mc.a.Ko||b===
Mc.a.marginLeft||b===Mc.a.marginRight)this.PHj(),this.FVa(),this.s9a([1])}PHj(){var b=this.e$b();b&&(b=xg.a.Qi(b.Ko,0),this.TFa.style.width=Math.round(b*this.UN).toString()+"px")}FVa(){window.requestAnimationFrame(()=>{var b=this.mtf();b&&(b=Qd.a.getElementBounds(b),v.AFrameworkApplication.isRtl?this.TFa.style.marginRight=(window.document.documentElement.clientWidth-b.x-b.width).toString()+"px":this.TFa.style.marginLeft=b.x.toString()+"px")})}Hgm(){const b=Ad.GraphIterator.eb(this.pz.cFb);if(b.zb(14))return b.jd(16),
ou.a(b,!0);t.ULS.sendTraceTag(557110540,3014,15,"Unable to read table column index for Ruler");Cl.recordQosError(this.Eyb,[Cl.Yfa],"Unable to read table column index for Ruler");return 0}Fwn(){let b=!0;const h=this.pz.lb.IO();if(null===h)return t.ULS.sendTraceTag(557065614,3014,15,"Unable to get Context Iterator for the Ruler"),Cl.recordQosError(this.Eyb,[Cl.Yfa],"Unable to get Context Iterator for the Ruler"),!1;for(;h.moveNext()&&b;){const r=Ad.GraphIterator.eb(h.current.node);r.qd();b=b&&Rh.TableReader.lx(r)}return b}z_e(){if(!this.TFa&&
!this.GU){this.bZg=document.createElement("div");this.GU.id=pt.Z5j;this.GU.className=pt.Y5j;this.GU.setAttribute(Se.a.xga,WordEditorIntl.WordEditorStrings.L_Ruler);this.GU.setAttribute(Se.a.uh,Se.a.Xvh);this.GU.classList.add("HideWACHorizontalRulerContainer");if(this.sAi){var b=v.AFrameworkApplication.K.kb("ModernUxExperimentPreferenceCookieName");const h=v.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");Hc.a.uca(b,!h)&&this.GU.classList.add(pt.wbk)}this.cZg=document.createElement("div");
this.TFa.className=pt.X5j;this.TFa.id=pt.$5j;this.GU.appendChild(this.TFa);b=null;this.Pw&&((b=Object(fF.a)("EditorBars"))&&b.appendChild(this.GU),this.GU.classList.add("regionComposer"));b||(b=document.getElementById(Qi.AppFrame.yed),b.insertBefore(this.GU,b.firstChild))}}static gF(){return new pt(Ma.a.instance.Ta("Common.IZoomManager"),Eb.App.si,v.AFrameworkApplication.va,al.UISurfaces.Ngi,Ma.a.instance.resolve("WordEditor.IRulerContextMenu"),Gp.a.instance,Ma.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=
pt.QCg?pt.QCg:pt.QCg=pt.gF()}}pt.Z5j="WACHorizontalRulerContainer";pt.Y5j="WACHorizontalRulerContainer";pt.$5j="WACHorizontalRuler";pt.X5j="WACHorizontalRuler";pt.wbk="ModernUxWACHorizontalRulerContainer";Object(m.a)(pt,"HorizontalRuler",vy,[]);var sE=c(960);class Ht extends vy{constructor(b,h,r,B,P,ca,ra){super(b,h,r,P,ca,ra);this.yP="VerticalRuler";this.gre="MarginModificationFromRuler";this.Jlh=this.Ilh=null;this.BXf=(Qa,tb)=>{let Mb=8;"Top"===Qa?Mb=this.ga.Qb(Nb.a.X7a,2,Ze.a.Nv(tb)):"Bottom"===
Qa&&(Mb=this.ga.Qb(Nb.a.V7a,2,Ze.a.Nv(tb)));let Zb;32===Mb?(tb=1,Zb=String.format("Margins set using Ruler. Margin: {0}",Qa),t.ULS.sendTraceTag(529065945,3014,50,Zb)):(tb=0,Zb=String.format("Unable to set margins using Ruler. Margin: {0}",Qa),t.ULS.sendTraceTag(529065946,3014,15,Zb),Cl.recordQosError(this.Rkh,[Cl.Yfa],"Unable to set margins using Ruler."));Ke.a(this.gre,32===Mb,void 0,[Object.assign(new ha.a,{name:"Type",string:Qa})]);Qa=new Map;Qa.set("Command","OnMarginChange");Qa.set("Source",
this.yP);Qa.set("Response",Zb);va.Health.instance.recordKpiUsage(Wp.kpiName,tb,Wp.S8,Qa)};this.oNa=B;this.sr={}}get p2(){return this.Ilh}get dKa(){return this.Jlh}renderRuler(){this.p2.classList.remove("HideWACVerticalRulerContainer");this.p2.classList.add("ShowWACVerticalRulerContainer");var b=this.e$b();if(b){var h=this.BXf;this.Ncd()||(this.sr.disabled=!0);this.sr.onMarginChange=h;this.FVa();b=xg.a.Qi(b.tv,1);this.dKa.style.height=(b*this.UN).toString()+"px";this.oNa().then(r=>{r.renderRuler(this.dKa,
this.sr);return null})}}s9a(b){var h;if(this.p2){this.p2.classList.add("ShowWACVerticalRulerContainer");"disabled"in this.sr&&delete this.sr.disabled;for(const r of b)switch(r){case 1:this.Ncd()?this.FVa():this.sr.disabled=!0}if(null===(h=this.pz.lb)||void 0===h?0:h.EWc)this.sr.disabled=!0;this.oNa().then(r=>{r.renderRuler(this.dKa,this.sr);return null})}}Ncd(){const b={},h=this.e$b();if(!h)return!1;b.scale=Ze.a.Yz(h.tv);b.precision=Wp.precision;b.rulerType="Vertical";this.sr.ipContextIndex=0;this.sr.permittedUnits=
Wp.GQh;b.margins=[{["type"]:"Top",["value"]:Ze.a.Yz(h.marginTop),["getRulerPropertyBoundary"]:Ls.N$b("Top",0)},{["type"]:"Bottom",["value"]:Ze.a.Yz(h.marginBottom),["getRulerPropertyBoundary"]:Ls.N$b("Bottom",1)}];this.sr.rulerCanvasProps=b;return!0}Rph(){this.z_e();He.a.addHandler(this.p2,pd.a.Wx,this.v8d)}Joi(){this.p2&&(this.p2.classList.remove("ShowWACVerticalRulerContainer"),this.p2.classList.add("HideWACVerticalRulerContainer"),He.a.removeHandler(this.p2,pd.a.Wx,this.v8d));this.oNa().then(b=>
{b.dispose(this.dKa);return null})}kt(){this.LHj();this.FVa();this.s9a([1])}g8d(b,h){b=h.property;if(b===Mc.a.tv||b===Mc.a.marginTop||b===Mc.a.marginBottom)this.LHj(),this.FVa(),this.s9a([1])}LHj(){var b=this.e$b();b&&(b=xg.a.Qi(b.tv,1),this.dKa.style.height=Math.round(b*this.UN).toString()+"px")}FVa(){window.requestAnimationFrame(()=>{var b=this.mtf();if(b){const h=Qd.a.getElementBounds(b);this.dKa.style.height=h.height.toString()+"px";b=this.wim(b);this.dKa.style.marginTop=b+"px"}})}wim(b){b=b.getBoundingClientRect().y;
const h=this.gYe.getBoundingClientRect().y;return b-h}z_e(){if(!this.dKa&&!this.p2){this.Ilh=document.createElement("div");this.p2.id=Ht.Kok;this.p2.className=Ht.Jok;this.p2.setAttribute(Se.a.xga,WordEditorIntl.WordEditorStrings.L_Ruler);this.p2.setAttribute(Se.a.uh,Se.a.Xvh);this.p2.classList.add("HideWACVerticalRulerContainer");if(this.sAi){var b=v.AFrameworkApplication.K.kb("ModernUxExperimentPreferenceCookieName");const h=v.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");Hc.a.uca(b,
!h)&&Sys.UI.DomElement.addCssClass(this.p2,Ht.xbk)}this.Jlh=document.createElement("div");this.dKa.className=Ht.Iok;this.dKa.id=Ht.Lok;this.p2.appendChild(this.dKa);b=document.getElementById(Qi.AppFrame.yed);b.insertBefore(this.p2,b.firstChild)}}static gF(){return new Ht(Ma.a.instance.Ta("Common.IZoomManager"),Eb.App.si,v.AFrameworkApplication.va,al.UISurfaces.Ngi,Ma.a.instance.resolve("WordEditor.IRulerContextMenu"),Gp.a.instance,Ma.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=
Ht.PCg?Ht.PCg:Ht.PCg=Ht.gF()}}Ht.Kok="WACVerticalRulerContainer";Ht.Jok="WACVerticalRulerContainer";Ht.Lok="WACVerticalRuler";Ht.Iok="WACVerticalRuler";Ht.xbk="ModernUxWACVerticalRulerContainer";Object(m.a)(Ht,"VerticalRuler",vy,[]);class Cl{constructor(b,h,r,B,P,ca,ra,Qa,tb){this.ODe=this.mGe=!1;this.yP="RulerActor";this.Ieh=null;this.Kpa=!1;this.XYj="ClearAllTabStopsFailed";this.Ugh="ShowHideRulerFailed";this.ZHe=null;this.kGd=(Mb,Zb,jc)=>{if(1===jc)return 32;Mb=this.ga.processAction(qb.a.WOb,2,
null);32===Mb?(jc=1,Zb=String.format("Clear all tab stops from ruler"),t.ULS.sendTraceTag(591213266,3014,50,Zb)):(jc=0,Zb=String.format("Unable to clear all tab stop from ruler"),t.ULS.sendTraceTag(591213267,3014,15,Zb),Cl.recordQosError(this.XYj,[Cl.Yfa],Zb));const Gc=new Map;Gc.set("Command","ClearAllTabStops");Gc.set("Source",this.yP);Gc.set("Response",Zb);va.Health.instance.recordKpiUsage(Wp.kpiName,jc,Wp.S8,Gc);return Mb};this.dVc=(Mb,Zb,jc)=>{if(1===jc)switch(Mb){case qb.a.X3e:case qb.a.Odf:return 2;
default:return 32}Zb=this.yRe.Abm();switch(Mb){case qb.a.aLf:var Gc=1;break;case qb.a.sag:Gc=4;break;case qb.a.n7e:Gc=3;break;default:return t.ULS.sendTraceTag(591213268,3014,15,"Tried to insert bar or decimal tab stop."),2}Mb=new zw.a(Zb,Gc,0,1);Mb=this.ga.Qb(qb.a.s9c,2,Mb);32===Mb?(jc=1,Zb=String.format("Insert Custom Tab Stop from Ruler. Tab: {0}. Value: {1}",uB[Gc],Zb.toString()),t.ULS.sendTraceTag(591213269,3014,50,Zb)):(jc=0,Zb=String.format("Unable to set custom tab stop from ruler. Tab: {0}. Value: {1}",
uB[Gc],Zb.toString()),t.ULS.sendTraceTag(591213270,3014,15,Zb));Gc=new Map;Gc.set("Command","InsertCustomTabStopRuler");Gc.set("Source",this.yP);Gc.set("Response",Zb);va.Health.instance.recordKpiUsage(Wp.kpiName,jc,Wp.S8,Gc);return Mb};this.jRb=(Mb,Zb,jc,Gc,Uc)=>this.mGe||1===jc&&Gg.a.sia(Zb.ik)?8:this.Kpa?this.zTc(Mb,Zb,jc,Gc,Uc):this.eyo(Zb,jc);this.m$n=()=>{this.Kpa?t.ULS.sendTraceTag(574128526,3014,50,"Ruler was already enabled"):(appChrome.api.dispatch(appChrome.actions.setCurrentTab("View")),
32!==this.ga.processAction(Nb.a.jRb,2)?(t.ULS.sendTraceTag(574128527,3014,50,"Ruler could not be enabled"),Cl.recordQosError(this.Ugh,[Cl.Yfa],"Ruler could not be enabled")):t.ULS.sendTraceTag(573190796,3014,50,"Ruler was enabled from teaching callout"))};this.zTc=(Mb,Zb,jc)=>{if(1===jc||!this.Kpa)return 32;this.Kpa=!1;this.zRe.ohj(!1);this.Cbb.dispose();this.G1d()&&this.mgf();this.OHj();t.ULS.sendTraceTag(593351623,3014,50,"Ruler is disabled");Mb=new Map;Mb.set("Command","HideRuler");Mb.set("Source",
this.yP);Mb.set("Response","");va.Health.instance.recordKpiUsage(Wp.kpiName,1,Wp.S8,Mb);return 32};this.Vbe=(Mb,Zb,jc,Gc,Uc)=>{if(1===jc)return 32;Uc&&(Uc[qg.a.On]=this.Kpa);return 32};this.Ozm=Mb=>{this.Kpa=Mb.result};this.RHb=()=>{this.mGe=!1};this.yoi=()=>{this.mGe=!0};this.ga=b;this.Cbb=h;this.UXe=r;this.oUb=B;this.yRe=P;this.zRe=ca;Cl.Zk=Qa;this.SLa=ra;this.oT=tb;this.SLa.vrh(this.yoi);this.SLa.lCd(this.RHb)}initialize(){this.Tb();this.Ieh=this.m$n;window.addEventListener("TurnRulerOnAction",
this.Ieh,!0);return this.zRe.Qcm().continueWith(this.Ozm,8)}Tb(){this.ga.ra(Nb.a.jRb,yc.a.view,this.jRb);this.ga.fb(Nb.a.Vbe,yc.a.view,this.Vbe,96);this.ga.ra(qb.a.X3e,yc.a.view,this.dVc);this.ga.ra(qb.a.n7e,yc.a.view,this.dVc);this.ga.ra(qb.a.kGd,yc.a.view,this.kGd);this.ga.ra(qb.a.Odf,yc.a.view,this.dVc);this.ga.ra(qb.a.zTc,yc.a.view,this.zTc);this.ga.ra(qb.a.aLf,yc.a.view,this.dVc);this.ga.ra(qb.a.sag,yc.a.view,this.dVc);sE.a.fd.addHandler(sE.a.Z7d,this.L2c.bind(this));this.oT.XAb(this.nZf)}isi(){this.Kpa&&
(this.Cbb.fC(),this.Cbb.renderRuler(),this.G1d()&&this.Ocj())}Ocj(){this.UXe.fC();this.UXe.renderRuler()}mgf(){this.UXe.dispose()}G1d(){return this.PEi()&&this.isPaginatedView()}PEi(){null==this.ZHe&&null!=v.AFrameworkApplication.K&&(this.ZHe=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.VerticalRulerEnabled",!1));return this.ZHe}wVa(){this.Kpa||Ma.a.instance.Ta("Common.ISystemInitiatedFeedback").execute(b=>{b.logActivity("TurnRulerOnActivity",null)})}yX(){this.SLa.Z1n(this.yoi);
this.SLa.Sbj(this.RHb);this.Kpa&&(this.Cbb.dispose(),this.G1d()&&this.mgf())}OHj(){if(this.oUb){const b={};b[Wp.B1o]="ToggleButtonModel";this.oUb.jH(b)}}eyo(b,h){if(!Cl.Zk.g9(b.ik))return t.ULS.sendTraceTag(574375060,3014,15,"Cannot show ruler. Word Section Node not found."),Cl.recordQosError(this.Ugh,[Cl.Yfa],"Cannot show ruler. Word Section Node not found."),8;if(1===h)return 32;this.Kpa=!0;this.zRe.ohj(!0);this.isi();this.OHj();t.ULS.sendTraceTag(593351624,3014,50,"Ruler is enabled");b=new Map;
b.set("Command","ShowRuler");b.set("Source",this.yP);b.set("Response","");va.Health.instance.recordKpiUsage(Wp.kpiName,1,Wp.S8,b);return 32}isPaginatedView(){return 1===this.oT.nu}L2c(b,h){switch(h.documentMode){case "View":this.Kpa&&(this.ga.processAction(Nb.a.jRb,2),this.ODe=!0);break;case "Edit":this.ODe&&(this.ga.processAction(Nb.a.jRb,2),this.ODe=!1)}}nZf(b,h){if(Cl.instance.Kpa&&Cl.instance.PEi())switch(h.hnb){case 1:Cl.instance.Ocj();break;case 0:Cl.instance.mgf()}}static recordQosError(b,
h,r){const B=Object.assign(new hc.a,{extendedProperties:new Map});r&&B.extendedProperties.set("exception",r);va.Health.instance.recordQosError(b,h,!1,!0,!1,!1,B)}static gF(){return new Cl(v.AFrameworkApplication.va,pt.instance,Ht.instance,Eb.App.za,Ma.a.instance.resolve("WordEditor.IRulerContextMenu"),Ma.a.instance.Oa("WordEditor.Ruler.IRulerSettingInfo"),Ma.a.instance.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),Rn.a.instance,Ma.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return null!=
Cl.RBg?Cl.RBg:Cl.RBg=Cl.gF()}}Cl.Zk=null;Cl.Yfa="RulerInteractionFailed";Object(m.a)(Cl,"RulerActor",null,[]);class wA{constructor(b,h){this.yCc=null;this.j6a=r=>r.result?r.result.Value.toString():"";this.CHa=r=>{r.Io||r.Gi?(t.ULS.sendTraceTag(591541278,3014,15,"Failed to get ruler is enabled settings options from Roaming Service."),this.yCc=!1):(r=r.result,""===r&&v.AFrameworkApplication.K&&(r=v.AFrameworkApplication.K.kb("RulerDefaultOn")),this.yCc="true"===r.toLowerCase(),t.ULS.sendTraceTag(591541279,
3014,50,"Load to get ruler is enabled settings options from Roaming Service successfully."));return this.yCc};this.Ev=b;this.LK=h}Qcm(){const b=new Hf.a;if(null==this.yCc){if(this.xCi())return this.LK.c7a(Jw.a.s8c).CWRCo(this.j6a,0).CWRCo(this.CHa,8);b.Dg(!1)}else b.Dg(this.yCc);return b.task}j2(b){this.LK.j2(Jw.a.s8c,new fo.a(Jw.a.s8c,b))}ohj(b){this.xCi()&&(this.Ev.gka("saveRulerIsEnabled",b.toString()),t.ULS.sendTraceTag(591541276,3014,50,"Try to save ruler settings value to Roaming Service."));
this.j2(b)}xCi(){const b=v.AFrameworkApplication.K.$("IsAnonymousUser");if(v.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(b)t.ULS.sendTraceTag(591541277,3014,50,"User is anonymous ");else return!0;return!1}}Object(m.a)(wA,"RulerSettingInfo",null,[402]);class lv{constructor(){this.w_g=this.W=null}get name(){return"WordEditor.Ruler"}wc(b){this.W=b;t.ULS.sendTraceTag(578110851,3014,50,"Word ruler package is configured.")}init(){this.W.ia("WordEditor.Ruler.RulerSettingInfo",()=>new wA(this.W.resolve("Box4.IRoamingServiceRequestManager"),
this.W.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.Ruler.IRulerSettingInfo").ha();this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{this.wn()});this.w_g=Cl.instance.initialize();t.ULS.sendTraceTag(578110852,3014,50,"Word ruler package is initialized")}wn(){this.w_g.continueWith(()=>{Cl.instance.isi();Cl.instance.wVa()});t.ULS.sendTraceTag(578110853,3014,50,"InitializeRuler is called")}dispose(){Cl.instance.yX();t.ULS.sendTraceTag(578110854,3014,50,"Word ruler package is disposed")}}
Object(m.a)(lv,"PackageManager",null,[1,2]);class vB{constructor(){this.ubc=this.X2b=null}}Object(m.a)(vB,"CreatePickerCustomizationDictionaryOptions",null,[918]);class WC{}WC.Vg="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(m.a)(WC,"InsertMediaM365DialogHtml",null,[]);class Kw{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,
jc,Gc,Uc,od,Od,ze){this.LO=ze;this.fab=null;this.YEf=this.Xpd=!1;this.Tsj=de=>{if(de.rawEvent&&(de=de.rawEvent.data))try{const ee=Sys.Serialization.JavaScriptSerializer.deserialize(de,!0),je=ee.MessageId?ee.MessageId.toString():null;ee&&je&&(je===M.a.insertImage||je===M.a.gCf)&&this.sAc.start(je===M.a.insertImage?this.Rbb:this.I_g)}catch(ee){}};this.YVo=(de,ee,je,ue,Qf)=>{if(1===je)return 32;this.v2g?de=CommonUIStrings.l_OneDriveName:""!==this.mnd?de=this.mnd:(de=CommonUIStrings.l_HostGeneric,t.ULS.sendTraceTag(20509841,
352,15,"InsertMediaActor::UpdateEntryPoints : Do not have host name, use generic name instead."));Qf[pj.a.LabelText]=de;return 32};this.aWo=(de,ee,je,ue,Qf)=>{if(1===je)return 32;if(!v.AFrameworkApplication.NFf())return Qf[pj.a.Visible]=!1,32;this.v2g?de=String.format(CommonUIStrings.l_ChangePictureFromHost,CommonUIStrings.l_OneDriveName):""!==this.mnd?de=String.format(CommonUIStrings.l_ChangePictureFromHost,this.mnd):(de=CommonUIStrings.l_ChangePictureFromHostGeneric,t.ULS.sendTraceTag(577835747,
352,15,"InsertMediaActor::UpdateEntryPointsForChangePictureHostButton : Do not have host name, use generic name instead."));Qf[pj.a.LabelText]=de;return 32};this.ZVo=(de,ee,je,ue,Qf)=>{if(1===je)return 32;v.AFrameworkApplication.K.$("InsertOnlinePictureEnabled")||(Qf[pj.a.Visible]=!1);return 32};this.$Vo=(de,ee,je,ue,Qf)=>{if(1===je)return 32;v.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled")||(Qf[pj.a.Visible]=!1);return 32};this.fje=(de,ee,je)=>{var ue;ee=this.Pwc.value.Hga(ee);
if(1===je)return ee&&this.Qbb.bPm?32:8;if(2!==je||!ee)return 8;(null===(ue=v.AFrameworkApplication.K)||void 0===ue?0:ue.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&Zu.a.instance.h7a("PictureBing");this.fab=Bb.a.create();t.ULS.sendTraceTag(7165725,352,50,"InsertMediaActor::ShowInsertPictureFromSearchDialog : Show dialog.");de=this.z1l(de,this.fab);de=this.KZe(de);de=this.jod.YQc(de);de.correlationId=this.fab;de.yCf=this.J_g;de.mqa=1;return this.dje(de,CommonUIStrings.L_PictureInsertTitle,
this.Rbb)};this.lxo=(de,ee,je)=>{de=32===this.ga.Nf(ee,Nb.a.insertHyperlink,1,!1,null,null);if(1===je)return de&&this.Qbb.mzi?32:8;if(2!==je||!de)return 8;t.ULS.sendTraceTag(21612190,352,50,"InsertMediaActor::ShowInsertOneDriveFileDialog : ShowInsertMediaDialog dialog.");return this.dje(this.H_g.getInstance(),Box4Intl.Box4Strings.l_InsertOneDriveFile,this.I_g)};this.Esj=(de,ee,je)=>{de=this.Pwc.value.Hga(ee);if(1===je)return de&&this.Qbb.MFf?32:8;if(2!==je||!de)return 8;t.ULS.sendTraceTag(17838539,
352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : ShowInsertMediaDialog dialog.");return this.dje(this.H_g.getInstance(),CommonUIStrings.L_PictureInsertTitle,this.Rbb)};this.bje=(de,ee,je)=>{var ue;ee=this.Pwc.value.Hga(ee);if(1===je)return ee&&this.Qbb.dPm?32:8;if(2!==je||!ee)return 8;t.ULS.sendTraceTag(587532180,352,50,"InsertMediaActor::ShowInsertM365PictureFromSearchDialog : Show dialog.");(null===(ue=v.AFrameworkApplication.K)||void 0===ue?0:ue.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",
!1))&&Zu.a.instance.h7a("PictureStock");this.fab=Bb.a.create();je=v.AFrameworkApplication.K.$("StockImagesFreemiumExperienceIsEnabled")&&this.yI.isFreemiumUpsellEnabled();je=this.Xpd?1:je?0:-1;de=this.m4l(de,this.fab,je);de=this.jod.YQc(de);de.Vg=WC.Vg;de.correlationId=this.fab;de.mqa=2;de.yCf=this.J_g;de.Bba=this.yI;de.lJj=je;return this.dje(de,CommonUIStrings.L_PictureInsertTitle,this.Rbb)};this.gje=(de,ee,je)=>{var ue;ee=this.Pwc.value.Hga(ee);de=Ma.a.instance.Oa("Common.App.SharedFilePicker.ISharedFilePicker");
if(1===je)return ee&&!this.Qbb.MFf&&de&&de.WHf()?32:8;if(2!==je||!ee||!de)return 8;t.ULS.sendTraceTag(553734720,352,50,"InsertMediaActor::showInsertPictureFromSharedPicker : Show dialog.");(null===(ue=v.AFrameworkApplication.K)||void 0===ue?0:ue.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&Zu.a.instance.h7a("PictureOneDrive");this.fab=Bb.a.create();je=Kw.Elh;ue=!1;v.AFrameworkApplication.OFf()&&(ue=this.iMl());ee=new vB;ee.X2b=ue;ee.ubc=!0;je=de.lbf(CommonUIStrings.L_ImageUploadButtonText,
"Select Images",!0,!1,!0,je,"Insert Media",1,ee);de.MRd(je).then(Qf=>{if(null!=Qf&&0<Qf.length){const Jg=[];for(let Ql=0;Ql<Qf.length;Ql++){const Fm=Qf[Ql][G.a.s2i],Kp=Qf[Ql][G.a.r2i],nv={};nv.Extension=Fm;nv.OriginalUrl=Kp;nv.caption=Fm;Jg.push(nv)}this.Rbb.WQa=Nb.a.P_;this.Rbb.T3a(Jg)}});return 32};this.eje=(de,ee,je)=>{var ue;const Qf=this.Pwc.value.Hga(ee);ee=Ma.a.instance.Oa("Common.App.SharedFilePicker.ISharedFilePicker");if(1===je)return Qf&&ee&&ee.WHf()?32:8;if(2!==je||!Qf||!ee)return 8;je=
Ma.a.instance.Oa("Common.App.PhoneLink.IPhoneLinkManager");null!=je&&je.aCl(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",!1));t.ULS.sendTraceTag(526951881,352,50,"InsertMediaActor::showInsertPictureFromMobileDevice : Show dialog.");(null===(ue=v.AFrameworkApplication.K)||void 0===ue?0:ue.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&Zu.a.instance.h7a("PictureMobile");this.fab=Bb.a.create();
ue=Kw.Elh;je=new vB;je.X2b=!0;je.ubc=!0;ue=ee.lbf(CommonUIStrings.L_ImageUploadButtonText,CommonUIStrings.L_ImageUploadingTitle,!0,!1,!0,ue,"InsertPictureFromMobile",3,je);ee.MRd(ue).then(Jg=>{if(null!=Jg&&0<Jg.length){var Ql=[];const Fm=de===Nb.a.eYd;let Kp=!1;const nv=v.AFrameworkApplication.K.kb("PhoneLinkServiceEndpoint");for(let fD=0;fD<Jg.length;fD++){const AB=Jg[fD][G.a.s2i],XD=Jg[fD][G.a.r2i],Cz={};Cz.Extension=AB;Cz.OriginalUrl=XD;Cz.caption=AB;Ql.push(Cz);Kp||(Kp=-1!==Cz.OriginalUrl.indexOf(nv))}this.Rbb.WQa=
Nb.a.P_;this.Rbb.T3a(Ql);Ql={};Ql.InsertImageCount=Jg.length;Kp&&Ke.c(Fm?Nb.a.cEm:Nb.a.UUk,void 0,void 0,void 0,void 0,void 0,Ql)}});return 32};this.sAc=B;this.Ysd=P;this.jod=ra;this.H_g=Qa;this.k3=tb;this.ga=b;this.Pwc=ca;this.v2g=Gc;this.mnd=od;this.Qbb=r;this.Rbb=Mb;this.I_g=Zb;this.J_g=Od;(this.yI=jc)&&this.yI.isFeatureEnabled("MsoPremiumStockImages",!1).catch(de=>t.ULS.sendTraceTag(577249666,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",
de)).then(de=>{(this.Xpd=de)||this.yI.gza("MsoPremiumStockImages",()=>{this.Xpd=!0;t.ULS.sendTraceTag(577249667,352,50,"InsertMediaActor::Constructor - License state changed to premium")});return null})}Tb(){(this.Qbb.MFf||this.Qbb.mzi)&&this.Qbb.cPm&&this.HGn();this.GWn();this.FWn();this.ga.fb(Nb.a.cDh,yc.a.view,this.Esj,1284);this.ga.fb(Nb.a.M5i,yc.a.view,this.aWo,1124);this.ga.fb(Nb.a.sCf,yc.a.view,this.Esj,1284);this.ga.fb(Nb.a.F4f,yc.a.view,this.YVo,1124);this.ga.fb(Nb.a.kEm,yc.a.view,this.lxo,
1284)}GWn(){this.ga.fb(Nb.a.insertOnlinePicture,yc.a.view,this.fje,1284);this.ga.fb(Nb.a.bYd,yc.a.view,this.bje,1284);this.ga.Jja("word_insertOnlinePictures",Nb.a.insertOnlinePicture,yc.a.view,this.fje,b=>{Eb.App.za.Poc(b,Object(z.a)(new Ba.a,(new Ba.a).NFb,"getCommandById"))});this.ga.Jja("word_insertOnlinePictures",Nb.a.bYd,yc.a.view,this.bje,b=>{Eb.App.za.Poc(b,Object(z.a)(new Ba.a,(new Ba.a).NFb,"getCommandById"))});this.ga.fb(Nb.a.w7e,yc.a.view,this.fje,1284);this.ga.fb(Nb.a.y7e,yc.a.view,this.gje,
1284);this.ga.Jja("word_insertOnlinePictures",Nb.a.y7e,yc.a.view,this.gje);this.ga.fb(Nb.a.z7e,yc.a.view,this.bje,1284);this.ga.fb(Nb.a.K5i,yc.a.view,this.ZVo,1284);this.ga.fb(Nb.a.L5i,yc.a.view,this.$Vo,1284);this.ga.Jja("word_insertOnlinePictures",Nb.a.w7e,yc.a.view,this.fje);this.ga.Jja("word_insertOnlinePictures",Nb.a.z7e,yc.a.view,this.bje);this.ga.fb(Nb.a.uCf,yc.a.view,this.gje,1284);this.ga.Jja("word_insertOnlinePictures",Nb.a.uCf,yc.a.view,this.gje,b=>{Eb.App.za.Poc(b,Object(z.a)(new Ba.a,
(new Ba.a).NFb,"getCommandById"))})}FWn(){v.AFrameworkApplication.OFf()&&(this.ga.fb(Nb.a.eYd,yc.a.view,this.eje,1284),this.ga.fb(Nb.a.x7e,yc.a.view,this.eje,1284),this.ga.Jja("mso_insertMobileDevicePictures",Nb.a.eYd,yc.a.view,this.eje,b=>{Eb.App.za.Poc(b,Object(z.a)(new Ba.a,(new Ba.a).NFb,"getCommandById"))}),this.ga.Jja("mso_insertMobileDevicePictures",Nb.a.x7e,yc.a.view,this.eje,b=>{Eb.App.za.Poc(b,Object(z.a)(new Ba.a,(new Ba.a).NFb,"getCommandById"))}))}HGn(){v.AFrameworkApplication.ua.get_element().appendChild(this.Ysd.Q1a);
He.a.addHandler(this.Ysd.Q1a.contentWindow,"message",this.Tsj);this.YEf=!0}z1l(b,h){let r=0;v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb&&5===v.AFrameworkApplication.ua.Kb.yk&&(r=12);const B=lj.a.tg(v.AFrameworkApplication.lcid);return String.format(v.AFrameworkApplication.K.appSettings.WordInsertPictureServiceEndpoint,b===Nb.a.insertOnlinePicture?1:0,v.AFrameworkApplication.lcid,B?B.name:"en-us",v.AFrameworkApplication.buildVersion,h,r,v.AFrameworkApplication.K.kb("UserId"))}dje(b,h,
r){try{return b.cje(h,r,void 0),t.ULS.sendTraceTag(7185476,352,50,"InsertMediaActor::ShowInsertPictureDialog : ShowInsertMediaDialog dialog success."),32}catch(B){return t.ULS.sendTraceTag(7165726,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",B.toString()),this.Ep(hh.a.noPictureSpecified,CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ClipartCannotConnect),8}}m4l(b,h,r){if(Nb.a.bYd===b)return b=this.k3.kzh(v.AFrameworkApplication.K.kb("InsertOnlineM365PictureEndpoint"),
h.toString(),1,r),this.KZe(b);b=this.k3.kzh(v.AFrameworkApplication.K.kb("InsertOnlineM365PictureEndpoint"),h.toString(),0,r);return this.KZe(b)}Ep(b,h,r){const B=new Tf.StandardDialog(!0);B.Kt=v.AFrameworkApplication.cda;B.Cd=0;B.ze(1,CommonUIStrings.l_DialogClose);B.vx(b,h,r,()=>{})}iMl(){const b=Ma.a.instance.Oa("Common.App.PhoneLink.IPhoneLinkManager");return null!=b?b.sQl():!1}dispose(){this.YEf&&this.Ysd.Q1a.contentWindow&&(He.a.removeHandler(this.Ysd.Q1a.contentWindow,"message",this.Tsj),this.YEf=
!1)}KZe(b){return this.LO&&this.LO.mJ?(b=new Xa.QueryStringBuilder(b),b.Be("theme","4"),b.toString()):b}}Kw.Elh=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(m.a)(Kw,"InsertMediaActor",null,[9]);var wy=c(974);class Ij extends wy.a{constructor(b,h){super(b,ia.a.getOrigin(h))}aq(b,h){this.isEnabled()&&this.zba(this.J8a)&&(this.Fv(b),this.eC(b,h))}}Object(m.a)(Ij,"InsertMediaCrossDocumentMessenger",wy.a,[297,62,9]);class gF{getInstance(b,h){return new Ij(b,h)}}Object(m.a)(gF,"InsertMediaCrossDocumentMessengerFactory",
null,[296]);var fG=c(776);class FD{}FD.Vg="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(m.a)(FD,"InsertMediaDialogHtml",null,[]);var qD;(function(b){b[b.OK=0]="OK";b[b.cancel=1]="cancel";b[b.error=2]="error";b[b.open=3]="open"})(qD||(qD={}));Object(m.b)("HubbleAction",qD);var oC;(function(b){b[b.unknown=0]="unknown";b[b.kfp=1]=
"bing";b[b.Zap=2]="M365";b[b.ilp=3]="icons";b[b.oneDrive=4]="oneDrive";b[b.ebc=5]="hubble"})(oC||(oC={}));Object(m.b)("InsertMediaProviders",oC);class GD extends Pe.a{constructor(b,h,r,B=null,P=!1){super(!1,!1,P);this.uy=null;this.fvc=!1;this.V_c=this.b1=null;this.g6e="KeepFocusDiv";this.QEd="KeepFocusStartDiv";this.correlationId=null;this.mqa=0;this.Bba=this.yCf=null;this.lJj=0;this.HJe=null;this.Xpn=()=>{this.b1&&(this.b1.style.visibility="visible",window.setTimeout(()=>{if(this.jj){const ca=this.jj.getElementById(this.QEd);
ca&&ca.focus()}},0))};this.rda=ca=>{ca.keyCode===Sys.UI.Key.tab&&(ca.target.id!==this.g6e||ca.shiftKey?ca.target.id===this.QEd&&ca.shiftKey&&(ca.preventDefault(),this.jj.getElementById(this.g6e).focus()):(ca.preventDefault(),this.jj.getElementById(this.QEd).focus()))};this.lUi=()=>{t.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message.");this.FEb(this.X_a);this.Kpb(1)};this.LWf=()=>{this.uy&&(t.ULS.sendTraceTag(7135755,352,100,"OnGetCustomHeaders : Got message."),this.uy.sendMessage(M.a.nlj,
{["CustomHeaders"]:""}))};this.DVi=()=>{this.uy&&(t.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this.uy.sendMessage(M.a.Pno,{["SessionId"]:v.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))};this.AVi=()=>{this.uy&&(t.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this.uy.sendMessage(M.a.Wgo,{["CID"]:""}))};this.uqn=()=>{this.Bba&&(t.ULS.sendTraceTag(577249665,352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),
this.Bba.launchUpsellExperience("stockimages"))};if(!b)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");this.kod=b;this.mWb="";this.k3=r;this.Wta=[];this.jud=h;this.Vg=B||FD.Vg;this.yg="InsertMediaDialog"}get telemetryEventName(){return"InsertM365Images"}async cje(b,h){this.mWb=b;this.fvc=!1;this.showDialog(this.mWb,null);this.b1=this.K9b(this.qj("insertmediaframe"));if(!this.b1)throw this.FEb(this.X_a),Error.invalidOperation("Couldn't get InsertMediaIframe.");
b=document.createElement("div");b.setAttribute("Id",this.QEd);b.setAttribute("tabindex","0");b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","-1000px");this.b1.parentNode.insertBefore(b,this.b1.parentNode.firstChild);b=document.createElement("div");b.setAttribute("Id",this.g6e);b.setAttribute("tabindex","0");this.b1.parentNode.appendChild(b);b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","10000px");$addHandler(this.dff,
"keydown",this.rda);this.b1.src=this.kod;this.b1.style.width="100%";this.b1.style.height="100%";this.b1.frameBorder="0";v.AFrameworkApplication.K.$("ShowInsertMediaIframeWhenIframeIsReady")&&Z.a.Cj?(this.b1.style.visibility="hidden",this.V_c=this.Xpn,He.a.addHandler(this.b1,"load",this.V_c)):this.b1.style.visibility="visible";this.K9b(this.qj("WACDialogButtonPanel")).style.display="none";this.K9b(this.qj("WACDialogTitleText")).style.display="none";2===this.mqa&&(this.K9b(this.qj("WACDialogTitlePanel")).style.display=
"none",this.K9b(this.qj("WACDialogBodyPanel")).style.padding="0");pc.FocusManager.instance().at().scope.eI=!0;this.uy=this.jud.getInstance(this.b1.contentWindow,this.kod);this.uy.zba("https://osiziwuspersimmon002.blob.core.windows.net");this.uy.zba("https://osizewuspersimmon001.blob.core.windows.net");this.uy.zba("https://osizpscuspersimmon000.blob.core.windows.net");this.uy.zba("https://cdn.hubblecontent.msit.osi.office.net");this.uy.zba("https://cdn.hubblecontent.osi.office.net");this.uy.aq(M.a.aph,
r=>{this.ATi(r,Object(z.a)(h,h.T3a,"insertMediaCallback"))});this.uy.aq(M.a.insert,r=>{this.K7d(r,Object(z.a)(h,h.T3a,"insertMediaCallback"))});this.uy.aq(M.a.vph,r=>{this.QWi(r)});this.uy.aq(M.a.D8h,this.LWf);this.uy.aq(M.a.getSessionId,this.DVi);this.uy.aq(M.a.l6h,this.AVi);this.uy.aq(M.a.lFd,this.lUi);2!==this.mqa||this.lJj||(this.uy.aq(M.a.V_m,this.uqn),this.HJe=this.Bba.gza("MsoPremiumStockImages",r=>{t.ULS.sendTraceTag(577249664,352,50,"OnCompleteM365Upsell: upsell completed from stock images");
this.uy.sendMessage(M.a.i0o,{["LicenseTier"]:r.toString()})}));this.Kpb(3)}dispose(){this.Bba&&this.HJe&&this.Bba.ojc("MsoPremiumStockImages",this.HJe);this.uy&&(this.uy.dispose(),this.uy=null);this.V_c&&(He.a.removeHandler(this.b1,"load",this.V_c),this.V_c=null);super.dispose()}ATi(b,h){t.ULS.sendTraceTag(7135752,352,100,"OnAddItem : Got message.");if(b=this.k3.kBn(b))this.Wta.push(b),this.fvc&&(h(this.Wta),this.fvc=!1)}Ep(){const b=new Tf.StandardDialog(!0);b.Kt=v.AFrameworkApplication.cda;b.Cd=
0;b.ze(1,CommonUIStrings.l_DialogOk);b.rv(CommonUIStrings.l_ImageUploadFailedTitle,CommonUIStrings.l_InsertPictureMaxLimitExceeded,2,()=>{})}Kpb(b){if(2===this.mqa){const r=v.AFrameworkApplication.K.kb("InsertMediaDialogAriaTenantNameSpace");if(r&&""!==r){var h=[];h.push(Object.assign(new ha.a,{name:"InsertedFiles",int64:this.Wta.length}));h.push(Object.assign(new ha.a,{name:"MediaDetails",string:JSON.stringify(this.Wta)}));h.push(Object.assign(new ha.a,{name:"DialogResult",string:qD[b]}));h.push(Object.assign(new ha.a,
{name:"DialogMode",string:this.zci()}));h.push(Object.assign(new ha.a,{name:"CorrelationId",string:this.correlationId.toString()}));h.push(Object.assign(new ha.a,{name:"Provider",string:oC[this.mqa]||"Unknown"}));ea.a.sendTelemetryEvent(Object.assign(new ka.a,{name:String.format("{0}.{1}",r,this.telemetryEventName),dataFields:h}))}}}zci(){return 3===this.mqa?"Icons":5===this.mqa?"ExternalContent":"Images"}K9b(b){const h=document.getElementById(b);if(!h)throw Error.invalidOperation(String.format("Couldn't get {0}.",
b));return h}K7d(b,h){t.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.FEb(this.X_a);h?this.Wta&&50<this.Wta.length?(this.Ep(),this.Kpb(0),t.ULS.sendTraceTag(578140104,352,10,"InsertMediaDialog: User tried to insert {0} images using {1}",this.Wta.length,oC[this.mqa])):this.Wta&&0<this.Wta.length?(h(this.Wta),this.Kpb(0),t.ULS.sendTraceTag(578140105,352,50,"InsertMediaDialog: User inserted {0} images using {1}",this.Wta.length,oC[this.mqa])):(t.ULS.sendTraceTag(23078422,352,15,"Empty search result."),
this.fvc=!0,h(this.Wta),this.Kpb(2)):this.Kpb(2)}QWi(b){b&&b.Values&&(b=b.Values,delete b.m_Origin,delete b.m_Source,delete b.m_ReceivedTime,t.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+b.eventName||!1),ea.a.sendOtelEvent(Object.assign(new fG.a,{otelEvent:b})))}}Object(m.a)(GD,"InsertMediaDialog",Pe.a,[295,9]);class hF{constructor(b,h){this.iFe=b;this.k3=h}YQc(b,h=!1){return new GD(b,this.iFe,this.k3,FD.Vg,h)}getInstance(){throw Error.notImplemented();}}Object(m.a)(hF,"InsertMediaDialogFactory",
null,[293]);class iF{constructor(b,h,r){this.Yvi=!1;this.correlationId=null;this.mqa=0;this.yCf=null;this.d6j=b;this.LEc=[];this.nnd=h;this.qih=r.split(";")}async cje(b,h){Array.clear(this.LEc);b=this.d6j.value;b.zba(this.nnd);b.Fv(h.KTc);this.Yvi||(b.eC(h.KTc,r=>{this.K7d(r,h)}),this.Yvi=!0);t.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");b.sendMessage(h.POh,{["FileExtensionFilterList"]:this.qih})}jwk(b){Array.contains(this.LEc,b)||
this.LEc.push(b)}K7d(b,h){t.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");b=h.Z0i(b);const r=[];for(let B=0;B<b.length;B++){const P=b[B];h.XZd(P,this.qih)?r.push(P):this.jwk(h.qgi(P))}r&&r.length?h.T3a(r):t.ULS.sendTraceTag(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.LEc.length&&(h=this.LEc.join(", "),t.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",h),
this.Myo(h))}Myo(b){const h=new Tf.StandardDialog;h.Cd=0;h.FV(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,b),null)}dispose(){}}Object(m.a)(iF,"InsertMediaFromHostManager",null,[295,9]);class jF{constructor(b){this.m7j=b}YQc(){throw Error.notImplemented();}getInstance(){return this.m7j}}Object(m.a)(jF,"InsertMediaFromHostManagerFactory",null,[292,293]);class HD{constructor(){this.Q1a=document.createElement("iframe");this.Q1a.src="about:blank";
this.Q1a.style.visibility="hidden";this.Q1a.style.position="absolute";this.Q1a.style.zIndex="-100"}}Object(m.a)(HD,"InsertMediaFromHostOneDriveHostFrame",null,[294]);class kF extends wy.a{constructor(b,h){super(b,"*"===h?h:ia.a.getOrigin(h));this.doh(M.a.insertImage);this.doh(M.a.gCf)}mee(){}}Object(m.a)(kF,"InsertMediaFromOneDriveCrossDocumentMessenger",wy.a,[61,62,9]);class ID{}Object(m.a)(ID,"OnlineMediaSearchResult",null,[]);class XC{kzh(b,h,r,B){const P=lj.a.tg(v.AFrameworkApplication.lcid).name,
ca=v.AFrameworkApplication.buildVersion,ra=F.a.RQ(v.AFrameworkApplication.K.kb("UserId")).toString();if(-1!==b.indexOf("exp=")){const Qa=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertOnlineM365ExperimentEnabled",!1)?1:0;v.AFrameworkApplication.oe("ShIns226;ShIns226cf");return String.format(b,v.AFrameworkApplication.lcid,P,ca,h,XC.fse,ra,B,r,Qa)}return String.format(b,v.AFrameworkApplication.lcid,P,ca,h,XC.fse,ra,B,r)}kBn(b){if(!b||!b.Values)return null;b=b.Values;
if(!b)return null;let h="";"sourceProvider"in b&&(h=b.sourceProvider||"");return Object.assign(new ID,{Action:b.action||"",Caption:b.caption||"",ContentType:b.contenttype||"",Type:b.extension||"",PageUrl:b.pageUrl||"",OriginalUrl:b.sourceUrl||"",ContentProvider:h,ThumbnailUrl:b.thumbnailUrl||"",LicenseUrl:b.licenseUrl||"",LicenseDisplayName:b.licenseDisplayName||"",Height:b.height||0,Width:b.width||0,SvgContent:b.svgContent||"",Html:b.html||"",ProviderName:b.providerName||""})}lBn(b){const h=[];if(!b||
!b.Values||!b.Values.Items)return h;b=b.Values.Items;for(let B=0;B<b.length;B++){var r=b[B];r&&(r=Object.assign(new ID,{Type:r.Extension||"",OriginalUrl:r.SourceUrl||"",Caption:r.caption,Height:r.Height||0,Width:r.Width||0}),h.push(r))}return h}f0f(b){const h=[];for(let B=0;B<b.data.files.length;B++){var r=b.data.files[B];r&&(r=Object.assign(new ID,{ContentType:r.itemType||"",Type:r.extension||"",OriginalUrl:r.urls&&r.urls.open?r.urls.open:"",Height:r.photo?r.photo.height:0,Width:r.photo?r.photo.width:
0}),h.push(r))}return h}XZd(b,h){if(!b)return!1;for(let r=0;r<h.length;r++)if(0<=b.toLowerCase().indexOf(h[r]))return!0;return!1}CGn(b){let h="";if(b)for(let r=0;r<b.length;r++){const B=b[r];B&&(h+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',B.OriginalUrl,B.Width,B.Height))}return h}}XC.fse=0;Object(m.a)(XC,"InsertMediaHelper",null,[291]);class tE{constructor(b,h,r,B,P){this.bPm=b;this.MFf=h;this.mzi=r;this.cPm=B;this.dPm=P}}Object(m.a)(tE,"InsertMediaSettingsManager",null,[]);
class uE{constructor(b){this.$wc=Nb.a.insertHyperlink;this.ga=b}get WQa(){return this.$wc}set WQa(b){this.$wc=b}T3a(b){try{t.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length);for(let h=0;h<b.length;h++)this.ga.Qb(this.WQa,2,b[h]);t.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",b.length)}catch(h){t.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",
h.toString())}}}Object(m.a)(uE,"InsertOneDriveFileHandler",null,[271]);class xy extends uE{constructor(b){super(b)}get POh(){return M.a.gCf}get KTc(){return M.a.DDm}Z0i(b){return b&&b.Values&&"Items"in b.Values?b.Values.Items:null}qgi(){Qc.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");return""}XZd(){return!0}$4i(b,h,r){b=r(b);b.length&&(r={},r.Items=b,h.sendMessage(this.KTc,r))}a1i(b){const h=[];for(let r=0;r<b.data.files.length;r++){const B=
b.data.files[r];if(B){const P={};P.DisplayText=String.format("{0}{1}",B.name,B.extension);P.Url=this.XFl([B.urls.viewInBrowser,B.urls.open,B.urls.download]);h.push(P)}}return h}XFl(b){for(let h=0;h<b.length;h++)if(b[h]&&""!==b[h])return b[h];t.ULS.sendTraceTag(21764229,352,10,"None of the URLs we received are valid");return""}}Object(m.a)(xy,"InsertOneDriveFileHelper",uE,[270,271]);class It{constructor(b,h,r){this.$wc=Nb.a.P_;this.Xo=null;this.ga=b;this.k3=h;this.ega=r}get oc(){return this.ga}get Gv(){return this.Xo||
(this.Xo=Ma.a.instance.resolve("Common.Utils.IAriaNotifier"))}get WQa(){return this.$wc}set WQa(b){this.$wc=b}T3a(b){try{t.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",b.length);const h=this.k3.CGn(b);let r=2;if(h&&0<h.length){const B=new fd.DictionaryPropertySet;B.setValue(Yc.a.NP,h);B.setValue(Yc.a.P4,!0);if(this.ega){const P=this.ega.Qad();P.m3b("insertOnlineImage");B.setValue(Yc.a.jva,P)}r=this.ga.Qb(this.WQa,2,B)}t.ULS.sendTraceTag(21612224,
352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",b.length,32===r,""===h)}catch(h){t.ULS.Vz(21612225,352,10,h,"InsertImageFromHostHelper::InsertMediaCallback : Exception")}}}Object(m.a)(It,"InsertOnlineImageHandler",null,[271]);class Oj extends It{constructor(b,h,r=null){super(b,h,r)}get POh(){return M.a.insertImage}get KTc(){return M.a.RDm}Z0i(b){return this.k3.lBn(b)}qgi(b){return b.Type}XZd(b,h){return this.k3.XZd(b.Type,h)}a1i(b){return this.k3.f0f(b)}$4i(b,
h,r){r=r(b);if(r.length){b=[];for(let B=0;B<r.length;B++){const P=r[B],ca={};ca.Extension=P.Type;ca.SourceUrl=P.OriginalUrl;ca.caption=P.Type;ca.SourceUrl=P.OriginalUrl;ca.Width=P.Width;ca.Height=P.Height;b.push(ca)}r={};r.Items=b;h.sendMessage(this.KTc,r)}}}Object(m.a)(Oj,"InsertOnlineImageHelper",It,[270,271]);class lF{constructor(b,h){this.Yub=b;this.jud=h}start(b){this.Yub.start({mode:"open",select:"multi",lightbox:"white"},(h,r)=>{this.processResponse(h,r,b)})}processResponse(b,h,r){t.ULS.sendTraceTag(22090009,
352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",b);b&&h&&h.data&&h.data.files&&0<h.data.files.length?(b=this.jud.getInstance(window.frames[0].parent,window.document.URL),r.$4i(h,b,B=>r.a1i(B))):t.ULS.sendTraceTag(22090010,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : No media to insert.")}}Object(m.a)(lF,"OneDriveFilePickerHelperV5",null,[269]);class mF{constructor(){this.iod=this.W=null}get name(){return"Box4.Media"}wc(b){this.W=
b;b.ia("Box4.Media.InsertMediaFromHostOneDriveHostFrame",()=>new HD).as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").ha();const h=new tE(Boolean.parse(v.AFrameworkApplication.K.appSettings.InsertOnlinePictureEnabled||"false"),v.AFrameworkApplication.NFf(),!1,v.AFrameworkApplication.Qgg(),v.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled"));b.ia("Box4.Media.OneDriveFilePickerHelperV5",()=>new lF(b.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5"),b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"))).as("Box4.Media.IOneDriveFilePickerHelper").ha();
b.ia("Box4.Media.InsertMediaActor",()=>new Kw(v.AFrameworkApplication.va,v.AFrameworkApplication.K,h,b.resolve("Box4.Media.IOneDriveFilePickerHelper"),b.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),new pf.a(()=>Ma.a.instance.resolve("Box4.Images.IImageEditor")),b.resolve("Box4.Media.IInsertMediaDialogFactory"),b.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),b.resolve("Box4.Media.InsertMediaHelper"),b.resolve("Box4.Media.InsertOnlineImageHelper"),b.resolve("Box4.Media.InsertOneDriveFileHelper"),
b.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),v.AFrameworkApplication.VJb,v.AFrameworkApplication.bqa,v.AFrameworkApplication.Jvm,v.AFrameworkApplication.K.appSettings.InsertPictureTelemetryEndpoint,b.resolve("Box4.IDarkModeState"))).ha();b.ia("Box4.Media.InsertMediaDialogFactory",()=>new hF(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),b.resolve("Box4.Media.InsertMediaHelper"))).as("Box4.Media.IInsertMediaDialogFactory").ha();b.ia("Box4.Media.InsertMediaFromHostManagerFactory",
()=>new jF(b.resolve("Box4.Media.InsertMediaFromHostManager"))).as("Box4.Media.IInsertMediaFromHostManagerFactory").ha();b.ia("Box4.Media.InsertMediaFromHostManager",()=>new iF(new pf.a(()=>{if(v.AFrameworkApplication.Qgg()){var r=Ma.a.instance.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").Q1a;r=new kF(r.contentWindow,"*")}else r=v.AFrameworkApplication.pY;return r}),v.AFrameworkApplication.Qgg()?ia.a.getOrigin(window.document.URL):ia.a.getOrigin(v.AFrameworkApplication.NNb),v.AFrameworkApplication.K.appSettings.ImageFetcherSupportedExtensions)).ha();
b.register(gF,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").ha();b.register(XC,"Box4.Media.InsertMediaHelper").ha();b.ia("Box4.Media.InsertOnlineImageHelper",()=>new Oj(v.AFrameworkApplication.va,b.resolve("Box4.Media.InsertMediaHelper"),b.resolve("Common.Utils.Telemetry.ITelemetry"))).ha();b.ia("Box4.Media.InsertOneDriveFileHelper",()=>new xy(v.AFrameworkApplication.va)).ha()}init(){this.iod=this.W.resolve("Box4.Media.InsertMediaActor");
this.iod.Tb()}dispose(){this.iod&&this.iod.dispose()}}Object(m.a)(mF,"MediaPackage",null,[1,2]);var nF=c(348);class zz{constructor(){this.G9n="getAddinShortcutsPreference";this.H9n="saveAddinShortcutsPreference";this.I9n="{0}RoamingServiceHandler.ashx?action={1}&{2}";this.NMl=6E4;this.W5d=this.Ona=this.P$=null}ygi(b){return String.format(this.I9n,v.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",b,v.AFrameworkApplication.em)}executeRequest(b,h,r,B,P=null){return zz.TQ.C2b(b,
h,P,null,r,B,!1,null,this.NMl)}saveSetting(b,h,r,B,P){return this.phj(b,h,r,null,B,P)}startBatchUpdateScope(){this.W5d=[]}saveShortcutInfoArrayBatch(b,h,r){this.Kao(r,b,h)}Kao(b,h,r){const B={action:"",addinId:"",ownerType:0};B.timestamp=(new Date).toUTCString();const P=this.getShortcutInfoArray(h.toString(),r.toString());b?(B.shortcutInfoArray=b,this.JZe(h,r,b)):P&&(B.shortcutInfoArray=P);b={};b[h.toString()]=B;h=new nF.a(r.toString(),b);this.W5d.push(h)}commitBatchUpdateScope(){return this.P$c()?
this.Mao().then(()=>{this.a4b();return Promise.resolve(!0)}):this.Oao().then(()=>{this.a4b();return Promise.resolve(!0)})}Mao(){return this.getSetting().then(b=>{let h=null;if(b&&!({Gt:h}=H.d(b)).returnValue)return t.ULS.sendTraceTag(522739852,0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);h||(h={});for(const r of this.W5d){(b=h[r.key])||(b={});const B=r.value;for(const P of kb.a.gP(B))b[P]=B[P];h[r.key]=b}this.P$=h;try{return localStorage.setItem("AddinShortcutPreferenceData",
H.c(h)),Promise.resolve(!0)}catch(r){return t.ULS.sendTraceTag(522739853,0,10,"SaveSettingToLocalStorageBatch failed",r),Promise.resolve(!1)}})}Oao(){return this.Ifo().then(b=>this.yfe(b))}Ifo(){return this.Euf().then(b=>{let h=null;b&&(({Gt:h}=H.d(b)).returnValue||t.ULS.sendTraceTag(522739854,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));h||(h={});for(const r of this.W5d){(b=h[r.key])||(b={});const B=r.value;for(const P of kb.a.gP(B))b[P]=
B[P];h[r.key]=b}this.P$=h;return H.c(h)})}saveShortcutInfoArray(b,h,r){return this.phj(0,"","",r,b,h)}phj(b,h,r,B,P,ca){const ra=this.P$c(),Qa={};Qa.action=r;Qa.addinId=h;Qa.ownerType=b;Qa.timestamp=(new Date).toUTCString();h=this.getShortcutInfoArray(P.toString(),ca.toString());0===b&&B?(Qa.shortcutInfoArray=B,this.JZe(P,ca,B)):h&&(Qa.shortcutInfoArray=h);b={};b[P.toString()]=Qa;P=new nF.a(ca.toString(),b);return ra?this.Lao(P):this.Nao(P)}Lao(b){return this.getSetting().then(h=>{let r=null;if(h&&
!({Gt:r}=H.d(h)).returnValue)return t.ULS.sendTraceTag(522739855,0,10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),Promise.resolve(!1);r||(r={});r[b.key]=b.value;this.P$=r;try{return localStorage.setItem("AddinShortcutPreferenceData",H.c(r)),Promise.resolve(!0)}catch(B){return t.ULS.sendTraceTag(522739856,0,10,"SaveSettingToLocalStorage failed",B),Promise.resolve(!1)}})}Nao(b){return this.Hfo(b).then(h=>this.yfe(h))}Hfo(b){return this.Euf().then(h=>{let r=null;h&&
(({Gt:r}=H.d(h)).returnValue||t.ULS.sendTraceTag(522739857,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));r||(r={});r[b.key]=b.value;this.P$=r;return H.c(r)})}saveSettings(b){this.P$=H.a(b);this.a4b();return this.P$c()?this.shj(b):this.yfe(b)}shj(b){try{return localStorage.setItem("AddinShortcutPreferenceData",b),Promise.resolve(!0)}catch(h){return t.ULS.sendTraceTag(522739858,0,10,"SaveSettingToLocalStorage failed",h),Promise.resolve(!1)}}yfe(b){const h=
{};h.Wac=b;const r=H.c(h);return new Promise(B=>{try{if(void 0===r||null===r||!r.length||1E6<=r.length)B(!1);else{var P=this.executeRequest(this.ygi(this.H9n),2,"SaveAddinShortcutsPreferenceRequest","38",r);P.continueWith(()=>{if(P.Io||P.Gi)t.ULS.sendTraceTag(522739859,0,10,"SaveAddinShortcutsPreference: Request failure"),B(!1);else{var ca=P.result;void 0!==ca.args&&null!==ca.args&&void 0!==ca.args.data&&null!==ca.args.data&&ca.args.data.Se===qa.a.Zz?B(!0):B(!1)}})}}catch(ca){t.ULS.sendTraceTag(522739860,
0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",ca.toString()),B(!1)}})}getSetting(){const b=this.P$c();return this.P$?Promise.resolve(H.c(this.P$)):b?this.lem():this.Euf()}P$c(){const b=v.AFrameworkApplication.K.$("IsAnonymousUser"),h=v.AFrameworkApplication.K.$("IsRoamingServiceEnabled");return b||!h}lem(){try{const b=localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(b)}catch(b){return t.ULS.sendTraceTag(522739861,0,10,"GetSettingFromLocalStorage failed",b),
Promise.resolve("")}}Euf(){return new Promise((b,h)=>{try{const r=this.executeRequest(this.ygi(this.G9n),1,"GetSettingRequest","37");r.continueWith(()=>{if(r.Io||r.Gi)t.ULS.sendTraceTag(522739862,0,10,"GetSettingFromRoaming : Request failure");else{let P="";var B=r.result;B&&B.args&&B.args.data?B.args.data.Se!==qa.a.Zz?t.ULS.sendTraceTag(522739864,0,10,"GetSettingFromRoaming : Received error response {0}",B.args.data.Se):B.args.data.se?(B=H.a(B.args.data.se),B.Wac&&(P=B.Wac)):t.ULS.sendTraceTag(522739865,
0,10,"GetSettingFromRoaming : ResponseData is null"):t.ULS.sendTraceTag(522739863,0,10,"GetSettingFromRoaming : Data is null");b(P)}})}catch(r){t.ULS.sendTraceTag(522739866,0,10,"GetSettingFromRoaming Exception handling request {0}",r.toString()),h("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(b){const h=this.P$c(),r=this;return this.getSetting().then(B=>{let P=null;B&&(P=H.a(B));if(!P)return t.ULS.sendTraceTag(522739867,0,50,"savedRoamingSetting is empty and nothing to clear "),
Promise.resolve(!0);for(const ca of kb.a.gP(P)){B=P[ca.toString()];for(const ra of kb.a.gP(B)){const Qa=B[ra];if(Qa.addinId===b)delete B[ra.toString()];else if(0===Qa.ownerType&&Qa.shortcutInfoArray){const tb=Qa.shortcutInfoArray,Mb=new mb.a;for(let Zb=0;Zb<tb.length;++Zb)tb[Zb].addinId!==b&&Mb.add(tb[Zb]);Qa.shortcutInfoArray=Mb.toArray()}}kb.a.count(B)||delete B[ca]}r.P$=P;r.XZn(b);return h?r.shj(H.c(P)):r.yfe(H.c(P))})}a4b(){if(this.P$){this.Ona=null;const r=this.P$;for(let B in r){var b=B;const P=
r[B];for(let ca in P){var h=ca;const ra=P[ca];ra.shortcutInfoArray&&this.JZe(parseInt(h),parseInt(b),ra.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.getSetting().then(b=>{let h=null;if(b&&!({Gt:h}=H.d(b)).returnValue)return t.ULS.sendTraceTag(522739868,0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),Promise.resolve(!1);this.P$=h;this.a4b();return Promise.resolve(!0)})}getShortcutsPreferenceInfoByAddinId(b,h,r){return this.P$&&
(r=this.P$[r])&&(h=r[h])&&h.addinId===b?h:null}getShortcutInfoArray(b,h){return this.P$&&(h=this.P$[h])&&(b=h[b])&&b.shortcutInfoArray?b.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(b,h,r){this.saveShortcutInfoArrayBatch(parseInt(b),parseInt(h),r)}setShortcutInfoArray(b,h,r){return this.saveShortcutInfoArray(parseInt(b),parseInt(h),r).then(()=>{this.a4b();return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(b,h){if(!this.Ona)return Promise.resolve(!0);var r=this.Ona[b];if(!r)return Promise.resolve(!0);
var B=r[h];r=B.modifiers;B=B.keyCode;const P=this.getShortcutInfoArray(r.toString(),B.toString());if(!P||!P.length)return Promise.resolve(!0);let ca=0;for(const ra of P){if(ra.addinId===b&&ra.action===h)break;++ca}if(ca>=P.length)return Promise.resolve(!0);P.splice(ca,1);return this.saveShortcutInfoArray(r,B,P).then(()=>{this.a4b();return Promise.resolve(!0)})}JZe(b,h,r){this.Ona||(this.Ona={});for(const B of r){r=B.addinId;const P=B.action;let ca=this.Ona[r];ca||(ca={});const ra={};ra.modifiers=
b;ra.keyCode=h;ca[P]=ra;this.Ona[r]=ca}}XZn(b){b in this.Ona&&delete this.Ona[b]}isActionCustomized(b,h){return this.Ona&&(b=this.Ona[b])&&b[h]?!!b[h]:!1}getShortcutByCustomizedAction(b,h){return this.Ona&&(b=this.Ona[b])?b[h]:null}getShortcutsPreferenceMappingTable(){return this.P$}static instance(){zz.O0e||(t.ULS.sendTraceTag(522739851,0,50,"AddinShortcutsPreferenceSettingHelper"),zz.O0e=new zz,zz.TQ=v.AFrameworkApplication.He);return zz.O0e}}zz.O0e=null;zz.TQ=null;Object(m.a)(zz,"AddinShortcutsPreferenceSettingHelper",
null,[]);class oF{constructor(b,h){this.kjd=null;new mb.a;this.B1g=!0;this.Fmd=b;this.GXg=h}a0e(b){this.GXg.addHandler("GoalChangedEvent",b)}Min(){this.GXg.raiseEvent("GoalChangedEvent")}kEf(b,h){return this.kjd&&this.B1g?b in this.kjd?this.kjd[b]:"Formality"===h&&this.Fmd.vuf().formality?!1:!0:!0}Bho(b,h){h===this.Fmd.vuf().formality&&(this.kjd=b,this.Min())}EWo(b){this.B1g=b}}Object(m.a)(oF,"GoalChangeSource",null,[307,308,309]);var YC=c(1E3),vE=c(932),gG=c(709);class pF{constructor(b,h,r,B,P,ca){this.MLa=
h;this.BBa=r;this.Je=b;this.mB=B;this.Eg=P;this.n5j=ca;this.BBa.mJb()&&this.initialize()}initialize(){return this.mB.ml().then(()=>{this.Je.ob(this,YC.a.getTypeName());this.Je.addHandler(this,vE.a.getTypeName())}).catch(b=>{this.Eg.sendTraceTag(528274563,2252,10,"EnsureAugLoopRuntimeManager threw exception when registering to GoalsAnnotation.",b)})}KB(b,h){if(h===re.a.getTypeName()||h===gG.a.getTypeName())if(!b||!b.content)this.Eg.sendTraceTag(528274564,2252,10,"Handled annotation is invalid");else if(Ee.a.getTypeNameFor(b.content)===
YC.a.getTypeName()||Ee.a.getTypeNameFor(b.content)===vE.a.getTypeName())if(Ee.a.getTypeNameFor(b.content)===YC.a.getTypeName()){var r=b.content;this.Eg.sendTraceTag(528274565,2252,50,"Goal annotation received with formality goal: {0}",r.critiqueConfiguration.formalityGoal);this.MLa.Bho(r.critiqueConfiguration.mapping,r.critiqueConfiguration.formalityGoal)}else if(Ee.a.getTypeNameFor(b.content)===vE.a.getTypeName())if(b=b.content,b.features){for(r of b.features)if("Goals"===r.featureName){this.n5j.EWo(!!r.supportType);
return}this.Eg.sendTraceTag(528274567,2252,10,"No goals feature in multilingualFeaturesAnnotation")}else this.Eg.sendTraceTag(528274566,2252,10,"MultilingualFeaturesAnnotation.Features is null")}}Object(m.a)(pF,"GoalsAnnotationHandler",null,[265]);class qF{constructor(b){this.Ca=b}mJb(){return this.Ca.$("EditorGoalsEnabled")}}Object(m.a)(qF,"GoalsGate",null,[264]);var hG=c(1198),wE=c(1199),xE=c(884);class Uv{}Uv.xKd=0;Uv.CKd="1.0";Uv.settingType="Goals";Object(m.a)(Uv,"GoalsConstants",null,[]);var yE=
c(1089);class JD{constructor(b,h,r,B,P){this.b_b=null;this.Myi=!1;this.gbh=b;this.Hmd=h;this.Eg=r;this.BBa=B;this.SCe=P;this.BBa.mJb()?this.iQn():this.BBa.mJb()&&this.ocg(Uv.xKd,Uv.CKd)}iQn(){new Promise(b=>{this.gbh.Nei(Uv.settingType,h=>{this.jQn(h)?(this.ocg(this.b_b.formality,this.b_b.version),b(this.b_b)):(this.ocg(Uv.xKd,Uv.CKd),b(null))})})}jQn(b){this.Myi=!0;if(!b||!b.nqb)return this.Eg.sendTraceTag(528274529,2252,50,"No persisted goal is registered."),!1;b=b.nqb.properties;var h=b.getValue(Mc.a.Fti);
h=parseInt(h);b=b.getValue(Mc.a.Gti);if(!this.Hmd.yrg(b))return this.Eg.sendTraceTag(528274530,2252,10,"Trying to read unsupported persisted formality goal version. Goal version {0}",b),!1;this.b_b=b=Object.assign(new yE.a,{formality:h,version:b});this.Eg.sendTraceTag(528274531,2252,50,"Persisted goal received with formality goal: {0} and version: {1}",b.formality,b.version);return!0}ocg(b,h){b=Object.assign(new xE.a,{formality:b,version:h});this.SCe.Pjj(b)}G8o(b){if(this.Hmd.yrg(b.version)){var h=
hG.a.Yal(b.version,b.formality.toString());this.gbh.Bph(Object.assign(new wE.a,{nqb:h,settingType:Uv.settingType}))?this.b_b=b:this.Eg.sendTraceTag(528274561,2252,10,"Write persisted goal failed.")}else this.Eg.sendTraceTag(528274560,2252,10,"Trying to write unsupported formality goal version. Goal version {0}",b.version)}Ebi(){this.Myi||this.Eg.sendTraceTag(528274562,2252,10,"Trying to get persisted goal that is not read yet.");return this.b_b}}Object(m.a)(JD,"GoalsPersistenceHandler",null,[263]);
class rF{constructor(b,h,r,B){this.Eg=b;this.TCe=h;this.Hmd=r;this.BBa=B;this.Gmd=Object.assign(new yE.a,{formality:Uv.xKd,version:Uv.CKd});this.XSe=this.BBa.mJb()}vuf(){this.XSe&&(this.XSe=!1,this.TCe.Ebi()&&(this.Gmd=this.TCe.Ebi()));return this.Gmd}vno(b){this.XSe=!1;this.Hmd.yrg(b.version)?(this.BBa.mJb()&&this.TCe.G8o(b),this.Gmd=b):(this.Eg.sendTraceTag(528274528,2252,10,"Unsupported formality goal version. Goal version {0}",b.version),this.Gmd=Object.assign(new yE.a,{formality:Uv.xKd,version:Uv.CKd}))}}
Object(m.a)(rF,"GoalsProvider",null,[261,262]);class xA{constructor(b,h,r,B){this.Je=b;this.mB=h;this.YV=r;this.Eg=B}Pjj(b){b=Object.assign(new re.a,{parentPath:["Signal",xE.a.getTypeName()],items:[Object.assign(new cf.a,{body:b})]});this.NMd(b)}NMd(b){this.mB.ml().then(()=>{this.fZe(b)}).catch(h=>{this.Eg.sendTraceTag(528274526,2250,10,"EnsureAugLoopRuntimeManager threw exception.",h)})}fZe(b){this.Je.activateAnnotation(YC.a.getTypeName(),xA.c3b).then(()=>{this.YV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Ef.a,
{operation:b}))}).catch(h=>{this.Eg.sendTraceTag(528274527,2250,10,"Activating GoalsAnnotation threw exception.",h)})}}xA.c3b="GoalSelected";Object(m.a)(xA,"GoalsSignalSender",null,[260]);class yy{constructor(){yy.TXe=new RegExp(yy.Gok)}yrg(b){return!!b.match(yy.TXe)&&1===b.match(yy.TXe).length}}yy.Gok="[0-9]+[.]?[0-9]*";yy.TXe=null;Object(m.a)(yy,"GoalsValidator",null,[259]);class wB{constructor(){this.W=null}get name(){return"WordEditor.Goals"}init(){this.W.resolve("WordEditor.Goals.GoalsAnnotationHandler")}dispose(){}wc(b){this.W=
b;this.W.ia("WordEditor.Goals.GoalsValidator",()=>new yy).as("WordEditor.Goals.IGoalsValidator").ha();this.W.ia("WordEditor.Goals.IGoalsGate",()=>new qF(this.W.resolve("Common.IAppSettingsManager"))).ha();this.W.ia("WordEditor.Goals.GoalsProvider",()=>new rF(this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.GoalsPersistenceHandler"),this.W.resolve("WordEditor.Goals.IGoalsValidator"),this.W.resolve("WordEditor.Goals.IGoalsGate"))).as("WordEditor.Goals.IGoalReader").as("WordEditor.Goals.IGoalUpdater").ha();
this.W.ia("WordEditor.Goals.GoalChangeSource",()=>new oF(this.W.resolve("WordEditor.Goals.IGoalReader"),new Pc.a)).as("WordEditor.Goals.IGoalChangeSource").as("WordEditor.Goals.IGoalCritiqueConfiguration").as("WordEditor.Goals.IGoalsFeatureSupport").ha();this.W.ia("WordEditor.Goals.GoalsPersistenceHandler",()=>new JD(this.W.resolve("Box4.PersistenceSettingsManager"),this.W.resolve("WordEditor.Goals.IGoalsValidator"),this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.IGoalsGate"),
this.W.resolve("WordEditor.Goals.IGoalSelectedSignalSender"))).as("WordEditor.Goals.IGoalsPersistenceHandler").ha();this.W.ia("WordEditor.Goals.GoalsAnnotationHandler",()=>new pF(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.Goals.IGoalCritiqueConfiguration"),this.W.resolve("WordEditor.Goals.IGoalsGate"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.IGoalsFeatureSupport"))).as("WordEditor.Goals.GoalsAnnotationHandler").ha();
this.W.ia("WordEditor.Goals.GoalsSignalSender",()=>new xA(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.W.resolve("Common.IUlsWrapper"))).as("WordEditor.Goals.IGoalSelectedSignalSender").ha()}static main(){L.a.instance.Gc(new wB)}}Object(m.a)(wB,"WordEditorGoalsPackage",null,[1,2]);var Az=c(759),xB=c(410);class yB{constructor(){this.annotation=null;this.languages=new De.a(Pa.a.ih())}}
Object(m.a)(yB,"CritiqueCountWrapper",null,[]);class Hu{constructor(){this.Hsa=new Sb.a}hRd(){return this.Hsa}cri(b,h,r,B){if(this.Hsa.nb(r)){this.Hsa.J(r).annotation.count+=h;r=this.Hsa.J(r).languages;for(var P of B)r.add(P)}else P=V.a.create().toString(),b=Object.assign(new xB.a,{id:P,categoryName:b,count:h}),this.Hsa.add(r,Object.assign(new yB,{annotation:b,languages:B}))}}Hu.Ii=389;Object(m.a)(Hu,"BaseCritiquesByTypeCounter",null,[249]);class sF extends Hu{constructor(b){super();this.Jyb=new fa.a;
this.Bxe=new fa.a;this.EAd=b}Onm(b){const h=b.annotation;if(h&&Az.a(Ee.a.getTypeNameFor(h.content))){const r=h.content;if(b.opType===re.a.getTypeName()){this.EAd.g1n(h.parentPath,r);b=r.M_.state;if(60!==b&&70!==b)return this.Jyb.contains(h.id)&&this.Jyb.remove(h.id),this.Bym(h.id,r),!0;this.Jyb.add(h.id)}else if(b.opType===Jq.a.getTypeName())if(this.Jyb.contains(h.id))this.Jyb.remove(h.id);else return this.XPh(r.typeId,h.id)}return!1}Nnm(b){if((b=b.annotation)&&Az.a(Ee.a.getTypeNameFor(b.content))){const h=
b.content,r=h.M_.state;if((60===r||70===r)&&!this.Jyb.contains(b.id))return this.Jyb.add(b.id),this.XPh(h.typeId,b.id)}return!1}Bym(b,h){this.Bxe.add(b);b=new De.a(Pa.a.ih());h.language&&b.add(h.language);this.cri(h.categoryName,1,h.typeId,b)}XPh(b,h){if(!this.Bxe.contains(h))return!1;if(!this.Hsa.nb(b))return t.ULS.sendTraceTag(589866503,Hu.Ii,15,"Unable to decrement the count for critique category {0}. Reason : {1}",b,"Category not found in CritiqueCountsByCategory dictionary"),!1;if(0>=this.Hsa.J(b).annotation.count)return t.ULS.sendTraceTag(589866504,
Hu.Ii,15,"Unable to decrement the count for critique category {0}. Reason : {1}",b,"Current count is less than or equal to 0"),!1;this.Bxe.remove(h);this.Hsa.J(b).annotation.count--;return!0}}Object(m.a)(sF,"AlCritiquesByTypeCounter",Hu,[253,249]);var pC=c(1021);class qt extends zr.a{constructor(b,h,r,B,P,ca,ra,Qa,tb){var Mb;super();this.Je=b;this.EAd=h;this.pte=r;this.HSg=B;this.MLa=P;this.Mta=ca;this.ti=ra;this.Paa=this.ZQg=!1;this.kMe=new Sb.a;this.mon=(Zb,jc)=>{this.EAd.Qom(jc)&&(this.Paa=!0,
this.QY())};this.hln=(Zb,jc)=>{this.pte.Onm(jc)&&this.ZPb()};this.TUi=()=>{this.ZPb()};this.mVf=(Zb,jc)=>{this.pte.Nnm(jc)&&this.ZPb()};this.Dnb=()=>{this.ZPb()};this.ZPb=()=>{let Zb=!1;this.ti.ie(()=>{var jc=this.hUl();const Gc=new mb.a;for(const Uc of jc)jc=Object.assign(new pC.a,{id:Uc.id,parentPath:Jr.a.dEb,content:Uc,annotationType:Ee.a.getTypeNameFor(Uc)}),Gc.add(jc),Zb||(Zb=0<Uc.count);this.Je.Aho(Gc)},"CC:SATH");!this.ZQg&&Zb&&(ea.a.sendTelemetryEvent({...(new ka.a),name:"Office.Word.Online.Editor.CritiquesAvailable"}),
this.ZQg=!0)};this.DKm=(Zb,jc,Gc)=>{const Uc=!this.MLa||this.MLa.kEf(Zb,Gc);Zb=this.Mta&&this.Mta.instance?this.Mta.instance.jEf(Zb,Gc,jc.substr(1,jc.length-2)):!0;return Uc&&Zb};null===Qa||void 0===Qa?void 0:Qa.a0e(this.Dnb);tb.nra(this,7);null===(Mb=this.Mta)||void 0===Mb?void 0:Mb.execute(Zb=>{Zb.z0e(this.ZPb)})}get index(){return 3}run(){this.Paa&&(this.ZPb(),this.Paa=!1)}vXi(){this.ZPb()}L8k(b){let h=0;if(({value:h}=this.kMe.Fc(b.categoryName,0)).returnValue)if(h!==b.count)this.kMe.Z(b.categoryName,
b.count);else return!1;else this.kMe.add(b.categoryName,b.count);return!0}hUl(){const b=new Sb.a;var h=this.EAd.hRd();const r=this.pte.hRd();this.opg(b,h);this.opg(b,r);this.HSg&&(h=this.HSg.hRd(),this.opg(b,h));h=new mb.a;for(const B of b.values)this.L8k(B)&&h.add(B);return h}opg(b,h){for(const P of h){h=P.value.annotation;const ca=P.key;var r=this.Gfo(P.value.languages);if(!b.nb(h.categoryName)){var B=V.a.create().toString();B=Object.assign(new xB.a,{id:B,categoryName:h.categoryName,count:0,countsByTypeId:{}});
b.add(h.categoryName,B)}this.DKm(ca,r,h.categoryName)&&(r=b.J(h.categoryName),r.count+=h.count,r.countsByTypeId[ca]=(r.countsByTypeId[ca]?r.countsByTypeId[ca]:0)+h.count)}}Gfo(b){const h=[];let r=0;for(const B of b)h[r++]=B;return H.c(h)}}Object(m.a)(qt,"CritiquesCounter",zr.a,[251,252]);class Lk{constructor(b){this.O2=b}hRd(){const b=new Sb.a,h=new De.a(Pa.a.ih()),r=Object.assign(new xB.a,{id:"a8f8d183-1cc4-4f3c-8483-23ae2e6d092b",categoryName:"Did you say?",count:this.O2.Ysc.count});b.add("33ab9b0e-2399-4300-a09f-ec2dbfcbf96e",
Object.assign(new yB,{annotation:r,languages:h}));return b}}Object(m.a)(Lk,"DictationCritiquesByTypeCounter",null,[250,249]);class zE extends Hu{constructor(b){super();this.L$a=new Sb.a;this.Je=b}Qom(b){const h=Jr.a.DTd(b.nodeId);if(!Jr.a.af(h)){if(b.Phb&&b.Phb.length){let r=null;for(const B of b.Phb)B.errorDetails.z4a()||(b=this.p8h(B),Jr.a.af(b)||(r||(r=new Sb.a),r.nb(b)||r.add(b,new mb.a),r.J(b).add(B)));this.YPh(h);r?this.wlo(h,r):this.L$a.remove(h)}else{if(!this.L$a.nb(h))return!1;this.YPh(h);
this.L$a.remove(h)}return!0}return!1}g1n(b,h){var r;if(({value:r}=this.L$a.Fc(b,r)).returnValue)for(const P of r)if(b=P.value,0<b.count&&this.Jpf(b.J(0))===h.categoryName)for(r=b.count-1;0<=r;r--){var B=b.J(r).end-b.J(r).Ec;b.J(r).Ec===h.range.start&&B===h.range.length&&(B=this.p8h(b.J(r)),this.Hsa.nb(B)&&(B=this.Hsa.J(B).annotation,B.count=Math.max(0,B.count-1)),b.removeAt(r))}}YPh(b){if(this.L$a.nb(b))for(const r of this.L$a.J(b)){var h=r.key;b=r.value;this.Hsa.nb(h)&&(h=this.Hsa.J(h).annotation,
h.count=Math.max(0,h.count-b.count))}}wlo(b,h){const r=new Sb.a,B=new Sb.a;for(const P of h){h=P.key;B.add(h,new De.a(Pa.a.ih()));for(const ca of P.value){const ra=ca.end-ca.Ec,Qa=this.Jpf(ca);this.UVk(b,Qa,ca.Ec,ra)?t.ULS.sendTraceTag(589866513,Hu.Ii,50,"Canvas annotation category {0} for parent path {1} in range (start {2},length {3}) already received from AL. Skipping this",h,b,ca.Ec,ra):(r.nb(h)||r.add(h,new mb.a),r.J(h).add(ca),B.J(h).add(this.jUl(ca)))}}this.L$a.Z(b,r);for(const P of this.L$a.J(b))0<
P.value.count&&(b=this.Jpf(P.value.J(0)),this.cri(b,P.value.count,P.key,B.J(P.key)))}p8h(b){let h=null;b&&(b=Object(Ra.a)(247,b.errorDetails))&&b.Ft&&(h=b.Ft.TypeId);return h}Jpf(b){let h=null;b&&(b=Object(Ra.a)(247,b.errorDetails))&&b.Ft&&(h=b.Ft.CategoryTitle);return h}jUl(b){let h="";b&&b.errorDetails&&(h=lj.a.tg(b.errorDetails.lcid).name);return h}UVk(b,h,r,B){if((b=this.Je.gof(b))&&0<b.count)for(const P of b)if(b=Ee.a.getTypeNameFor(P.content),P&&Az.a(b)&&(b=P.content,b.categoryName===h&&b.range.start===
r&&b.range.length===B))return!0;return!1}}Object(m.a)(zE,"WacCritiquesByTypeCounter",Hu,[248,249]);class KD{constructor(){this.W=null}get name(){return"WordEditor.CritiqueCounts"}wc(b){this.W=b}init(){var b=this.W.resolve("Common.IAppSettingsManager");if(b.$("AugLoopOperationsAreEnabled")){this.W.ia("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter",()=>new zE(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"))).ha();this.W.ia("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter",()=>
new sF(this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.W.resolve("Common.IAppSettingsManager"))).ha();var h=b.$("DictationCorrectionsInEditorPaneIsEnabled");h&&this.W.ia("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter",()=>new Lk(this.W.resolve("Box4.DictationCorrections.IDictationCorrectionManager"))).ha();this.W.ia("WordEditor.CritiqueCounts.ICritiquesCounter",()=>new qt(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),
this.W.resolve("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter"),this.W.Oa("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter"),this.W.Oa("WordEditor.Goals.IGoalCritiqueConfiguration"),this.W.Ta("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),Wq.a.instance,this.W.Oa("WordEditor.Goals.IGoalChangeSource"),this.W.resolve("Box4.Graph.IGraphTransactionManager"))).ha();b=this.W.resolve("WordEditor.CritiqueCounts.ICritiquesCounter");this.W.resolve("Box4.Proofing.IErrorRangeEditor").grh(b.mon);
this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").vxk(b.hln);this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").Tqh(b.mVf);h&&(h=this.W.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),h.Bqh(b.TUi),h.Cqh(b.TUi))}}dispose(){}static main(){L.a.instance.Gc(new KD)}}Object(m.a)(KD,"WordEditorCritiqueCountsPackage",null,[1,2]);class AE{get name(){return"WordEditor.GraphicsEditor"}wc(){}init(){}dispose(){}static main(){L.a.instance.Gc(new AE)}}Object(m.a)(AE,"PackageManager",
null,[1,2]);var iG=window.PasteFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.PasteFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"PasteOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",
attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PasteFloatie.FlyoutAnchor",LabelText:"(Ctrl)",Image16by16:"IMGMAP@we@Paste_16x16x32",Alt:"STR@L_PasteOptionsWithCtrl",DisplayMode:"Medium",TemplateAlias:"Paste"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msPasteOptionsButtons",Title:"STR@L_PasteOptions",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",
Command:"0x5FA36C32",QueryCommand:"0x57455F86",Image16by16:"IMGMAP@we@PasteSourceFormatting_16x16x32",Alt:"STR@L_PasteWithSourceTheme",LabelText:"STR@L_PasteWithSourceTheme"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0x8E28DB06",QueryCommand:"0x8A0031FF",Image16by16:"IMGMAP@we@PasteTextOnly_16x16x32",Alt:"STR@L_PasteTextOnly",LabelText:"STR@L_PasteTextOnly"}},{name:"ToggleButton",attrs:{Id:"floatie.gbFormatWithDesignerButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",
Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteFormatWithDesignerTooltipUnavailable",LabelText:"STR@L_PasteFormatWithDesigner"}},{name:"ToggleButton",attrs:{Id:"floatie.gbMatchDocumentFormattingButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteMatchDocumentFormattingTooltipUnavailable",LabelText:"STR@L_PasteMatchDocumentFormatting"}},{name:"ToggleButton",attrs:{Id:"floatie.gbUseSmartPasteButton",Command:"0x7a781ebb",
QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteUseSmartPasteTooltipUnavailable",LabelText:"STR@L_PasteUseSmartPaste"}}]}]}]}]}]}]}]}]}]}]}]};class tF{constructor(b){this.V1j={};this.Vb=b;this.Tyb=new Ng.a}vPa(b,h){const r=this.Vb.zic,B=parseInt(b);return b&&B!==cd.ActionManager.Uhf?this.Tyb.nb(r)?(b=this.Tyb.J(r).tac(B,h,2),32===b||1===b):!1:!1}NGa(b){const h=parseInt(b),r=this.Vb.zic;return b&&h!==cd.ActionManager.Uhf?this.Tyb.nb(r)?32===this.Tyb.J(r).tac(h,
this.V1j,1):!1:!0}f$i(b,h){this.Tyb.Z(b,h)}Bqj(b){b=parseInt(b);const h=this.Vb.zic;return!!h&&!!this.Tyb.J(h)&&this.Tyb.J(h).KJm(b)}}Object(m.a)(tF,"NonCanvasCuiUser",null,[882,244]);var zy=c(1225),yA=c(47),qC;(function(b){b[b.UnspecifiedGallery=0]="UnspecifiedGallery";b[b.CharacterCodeGallery=1]="CharacterCodeGallery";b[b.FontStyleGallery=2]="FontStyleGallery";b[b.InkThicknessGallery=3]="InkThicknessGallery";b[b.IconGallery=4]="IconGallery";b[b.ListGallery=5]="ListGallery";b[b.TableStyleGallery=
6]="TableStyleGallery";b[b.PageNumberGallery=7]="PageNumberGallery";b[b.ChangeColorsGallery=8]="ChangeColorsGallery"})(qC||(qC={}));Object(m.b)("GalleryType",qC);class hu{constructor(){this.title=this.style=this.hidden=this.disabled=null}}Object(m.a)(hu,"CommonGalleryButtonProps",null,[]);class LD extends hu{constructor(){super();this.tableStyles=this.tableCellStyles=null;this.columns=0}}Object(m.a)(LD,"AdditionalTableStyleGalleryButtonProps",hu,[]);class uF extends LD{constructor(){super()}}Object(m.a)(uF,
"AdditionalChangeColorsGalleryButtonProps",LD,[]);class vF extends hu{constructor(){super();this.character=null}}Object(m.a)(vF,"AdditionalCharacterCodeGalleryButtonProps",hu,[]);class rC extends hu{constructor(){super();this.previewStyleLabel=this.styleDisplayName=null}}Object(m.a)(rC,"AdditionalFontStyleGalleryButtonProps",hu,[]);class Xp{constructor(){this.selectedId=this.sections=this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=null;this.galleryType="TableStyleGallery"}}Object(m.a)(Xp,
"AdditionalGalleryProperties",null,[]);class BE extends hu{constructor(){super();this.largePreviewIconStyle=this.largeFullIconStyle=this.keytip=this.previewIconStyle=this.fullIconStyle=this.label=this.icon=null}}Object(m.a)(BE,"AdditionalIconButtonProperties",hu,[]);class wF extends hu{constructor(){super();this.styleDisplayName=null}}Object(m.a)(wF,"AdditionalInkThicknessGalleryButtonProps",hu,[]);class xF extends hu{constructor(){super();this.ariaLabel=this.infoAtLevel=null}}Object(m.a)(xF,"AdditionalListGallerButtonProps",
hu,[]);class yF extends hu{constructor(){super();this.text=null}}Object(m.a)(yF,"AdditionalPageNumberGalleryButtonProps",hu,[]);var zx=c(1154);const Br=(b,h)=>{var r=appChrome.selectors.getActiveControlStates();if(r=Object(Ra.a)(Object,r[b])){if((b=Object(Ra.a)(String,r.value))&&b===h)return!1;b=Object(Ra.a)(String,r.selectedKey);if(!h&&!b)return!1;if(b){r=Array.isArray(r.options)?r.options:null;let B=null;for(let P=0;P<r.length;P++){const ca=Object(Ra.a)(Object,r[P]);if(Object(Ra.a)(String,ca.key)===
b){B=ca;break}}if(B&&Object(Ra.a)(String,B.text)===h)return!1}}return!0},CE=(b,h,r,B)=>{if(0<(B&2)){B=[];switch(h){case "ToggleButtonModel":case "InkButtonModel":B.push(MD(b,r[qg.a.On]));break;case "CheckboxModel":B.push(appChrome.actions.toggleCheckbox(b,r[qg.a.On]));break;case "ComboBoxModel":if(v.AFrameworkApplication.K&&(v.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",
!1))&&!Br(b,r[dh.a.Value]))break;(h=r[dh.a.Key])?B.push(appChrome.actions.updateComboBoxKey(b,h,r[dh.a.Value])):B.push(appChrome.actions.updateComboBoxValue(b,r[dh.a.Value]));break;case "FontPickerModel":B.push(appChrome.actions.updateFontPickerSelectedFont(b,r[zx.a.SelectedFont]));break;case "SplitButtonModel":B.push(MD(b,r[Sj.a.On]));break;case "SpinButtonModel":B.push(appChrome.actions.updateSpinButton(b,r[Pi.a.Number],Ze.a.I0a(r[Pi.a.UnitType]),r[Pi.a.Text],r[Pi.a.MaxValue],r[Pi.a.Alt]));break;
case "ColorPickerModel":B.push(appChrome.actions.updateColorPickerSelectedColor(b,r[cb.IndexColorSelected]));break;case "PageNumberGalleryButtonModel":B.push(appChrome.actions.updatePageNumberGalleryButtonText(b,r[Ui.a.Text]));break;case "CompoundButtonModel":r[qg.a.Description]&&B.push(appChrome.actions.updateCompoundButtonDescription(b,r[qg.a.Description]));qg.a.On in r&&B.push(MD(b,r[qg.a.On]));break;case "SliderModel":r.snapToStep?B.push(appChrome.actions.updateSliderSelectedValue(b,r[Jn.Value])):
B.push(appChrome.actions.updateSliderValue(b,r[Jn.Value],r[Jn.MinValue]||0,r[Jn.MaxValue],r[Jn.Text]));break;case "FlyoutAnchorModel":en.a.ImageIsVisible in r&&B.push(appChrome.actions.hideFlyoutAnchorIcon(b,!r[en.a.ImageIsVisible]));qg.a.On in r&&B.push(MD(b,r[qg.a.On]));break;case "InputBoxModel":B.push(appChrome.actions.updateInputBoxValue(b,r[Vi.a.Text]))}h=B;var P=Object(Ra.a)(String,r[ll.a.iconColor]);void 0!==P&&null!==P&&h.push(appChrome.actions.updateIconColor(b,P));zF(b,r,B);h=B;(P=Object(Ra.a)(Object,
r[ll.a.IconSet]))&&h.push(appChrome.actions.setControlIconSet(b,P));h=B;P=Object(Ra.a)(String,r[ll.a.customTooltip]);void 0!==P&&null!==P&&h.push(appChrome.actions.setControlCustomTooltip(b,P));b=B;(r=Array.isArray(r[ll.a.F6f])?r[ll.a.F6f]:null)&&b.push.apply(b,r);return B}return null},zB=(b,h)=>appChrome.actions.updateControlEnabledDisabledState(b,h),MD=(b,h)=>appChrome.actions.toggleButton(b,h),zF=(b,h,r)=>{h=Object(Ra.a)(String,h[ll.a.Icon]);void 0!==h&&null!==h&&r.push(appChrome.actions.setControlIcon(b,
h))};class sC{constructor(b,h,r,B){this.sl=B;this.Uta=b;this.mA=h;this.K_b=r;this.Wxc={}}EEn(b,h,r,B,P=null){const ca=b.ExternalGalleryId||b.ExternalId;var ra=b.ExternalId;B.push(ca);if(appChrome.selectors.isControlDefined(ca))b.GalleryStyle&&Hh.d("setGalleryStyles")&&h.push(appChrome.actions.setGalleryStyles(ca,b.GalleryStyle));else{if(4!==b.Type)return;r.push(appChrome.api.createGalleryModel(ca,Object.assign(new Xp,{columns:b.Width,sections:[appChrome.api.gallerySection([],ra)],styles:b.GalleryStyle,
galleryType:"IconGallery"})))}r=0;B=!!v.AFrameworkApplication.K&&(v.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1));if(Hh.d("setGallerySections")&&b.GallerySections&&0<b.GallerySections.length){ra=[];const tb=[],Mb=[],Zb={};for(var Qa of b.GallerySections){ra.push(appChrome.api.gallerySection([],Qa.SectionId,Qa.Title));0===r&&Qa.GalleryButtons&&0<Qa.GalleryButtons.length&&
(r=Qa.GalleryButtons[0].Type);B&&this.cfi(Qa.GalleryButtons,P,Zb);const jc=this.TZe(tb,Qa.GalleryButtons,Zb);tb.push.apply(tb,this.Ftf(jc,ca,Qa.SectionId,!1,r,P,!0,Zb));Mb.push.apply(Mb,jc)}h.push(appChrome.actions.setGallerySections(ca,ra));h.push.apply(h,tb);h.push.apply(h,this.grf(ca,qC[r],Mb,null,5===b.Type,!0,null,Zb))}else b.GalleryItems&&0<b.GalleryItems.length&&(r=b.GalleryItems[0].Type),Qa=B?this.cfi(b.GalleryItems,P,null):null,h.push.apply(h,this.Ftf(this.TZe(h,b.GalleryItems,Qa),ca,ra,
!1,r,P,!1,Qa))}U$l(b,h){const r=[];let B=null,P=!1;if(!b)return null;const ca=this.Uta.X3c(this.mA,b.commandId,h);r.push(zB(b.externalUxCommand,!ca));if(b.previewControlIds){const tb=[];for(let Mb=0;Mb<b.previewControlIds.length;Mb++){var ra={},Qa=b.previewControlIds[Mb];ra.SourceControlId=Qa;const Zb=this.sl.getCommandByExternalUxId(Qa);this.RTd(Zb||b,ra);ra[Ui.a.On]&&(B=ra.SourceControlId,ra[Ui.a.HighlightOn]&&(P=!0));zF(Qa,ra,r);if(ra=Object(Ra.a)(cu.a,ra[Ui.a.GalleryButtonProps]))tb.push(ra),
ca&&(Qa=this.Uta.X3c(this.mA,ra.Command,h),ra.IsDisabled=!Qa)}0<tb.length&&r.push.apply(r,this.Ftf(this.TZe(r,tb),b.externalUxCommand,b.externalUxCommand,!0,tb[0].Type));r.push(appChrome.actions.updateGallerySelectedId(b.externalUxCommand,B));P&&(t.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",B),r.push(appChrome.actions.highlightSelectedFontStyle(B)))}return r}TZe(b,h,r=null){const B=[],P=[];for(let ra=0;ra<h.length;ra++){const Qa=h[ra],tb=nf.b(Qa.ExternalId)?
Qa.Id:Qa.ExternalId;B.push(tb);const Mb=r&&r[tb]?r[tb].result:-1;switch(Qa.Type){case 1:var ca=Qa;P.push(appChrome.api.createCharacterCodeGalleryButtonModel(tb,Object.assign(new vF,{disabled:-1!==Mb?1>(Mb&1):ca.IsDisabled,character:ca.Character,style:ca.Style,title:ca.Alt})));break;case 2:ca=Qa;P.push(appChrome.api.createFontStylesGalleryButtonModel(tb,Object.assign(new rC,{disabled:-1!==Mb?1>(Mb&1):ca.IsDisabled,styleDisplayName:ca.LabelText,style:ca.Style,title:ca.Alt,previewStyleLabel:ca.PreviewStyleLabel})));
break;case 3:ca=Qa;P.push(appChrome.api.createInkThicknessGalleryButtonModel(tb,Object.assign(new wF,{disabled:-1!==Mb?1>(Mb&1):ca.IsDisabled,styleDisplayName:ca.LabelText,style:ca.Style,title:ca.Alt})));break;case 4:ca=Qa;P.push(appChrome.api.createIconGalleryButtonModel(tb,Object.assign(new BE,{disabled:-1!==Mb?1>(Mb&1):ca.IsDisabled,icon:[ca.Icon],fullIconStyle:ca.FullIconStyle,previewIconStyle:ca.PreviewIconStyle,largePreviewIconStyle:ca.LargePreviewIconStyle,label:ca.LabelText,title:ca.Alt})));
break;case 5:ca=Qa;P.push(appChrome.api.createListGalleryButtonModel(tb,Object.assign(new xF,{disabled:-1!==Mb?1>(Mb&1):ca.IsDisabled,infoAtLevel:ca.LevelInfo,ariaLabel:ca.Alt})));break;case 6:ca=Qa;P.push(appChrome.api.createTableStyleGalleryButtonModel(tb,Object.assign(new LD,{disabled:-1!==Mb?1>(Mb&1):ca.IsDisabled,tableCellStyles:ca.TableCellStyles,tableStyles:ca.TableStyles,title:ca.Alt,columns:ca.columns})));break;case 8:ca=Qa;P.push(appChrome.api.createChangeColorsGalleryButtonModel(tb,Object.assign(new uF,
{disabled:-1!==Mb?1>(Mb&1):ca.IsDisabled,tableCellStyles:ca.TableCellStyles,tableStyles:ca.TableStyles,title:ca.Alt})));break;case 7:ca=Qa,P.push(appChrome.api.createPageNumberGalleryButtonModel(tb,Object.assign(new yF,{disabled:-1!==Mb?1>(Mb&1):ca.IsDisabled,text:ca.Text,title:ca.Alt})))}this.sl.addCommandToMaps(Object.assign(new yA.a(tb,Qa.Command),{queryCommandId:Qa.QueryCommand,menuItemId:Qa.MenuItemId}))}b.push(appChrome.actions.addControls(P));return B}Ftf(b,h,r,B,P,ca=null,ra=!1,Qa=null){const tb=
[];B?tb.push(appChrome.actions.populateGalleryItems(h,b)):(this.Wxc[h]=!1,ra||(B=!0,appChrome.selectors.isControlDefined(h)&&(B=appChrome.selectors.getGalleryState(h),B=B.disableIndividualButtons?B.disableIndividualButtons:!0),tb.push.apply(tb,this.grf(h,qC[P],b,null,5===P,B,ca,Qa))),tb.push(appChrome.actions.updateGallerySectionItems(h,r,b)));return tb}QZl(b){return this.grf(b.ExternalUxId,b.galleryType,b.items,b.sections,b.isListGallery,b.disableIndividualButtons?b.disableIndividualButtons:!0)}grf(b,
h,r,B,P,ca=!0,ra=null,Qa=null){const tb=[];if(b in this.Wxc){if(this.Wxc[b])return delete this.Wxc[b],tb;this.Wxc[b]=!0}let Mb=null,Zb=-1;if(r)({J3h:Zb,returnValue:Mb}=this.Toh(h,r,tb,ca,ra,Qa));else if(B)for(const jc of B)(r=({J3h:Zb}=this.Toh(h,jc.galleryButtons,tb,ca,null,Qa)).returnValue)&&(Mb=r);tb.push(appChrome.actions.updateGallerySelectedId(b,Mb));ca&&tb.push(zB(b,!1));P&&0<Zb&&tb.push(appChrome.actions.updateListGalleryTextDirection(b,2===Zb));return tb}bfi(b,h=null){const r={},B={};B.SourceControlId=
b;B.Location=h;b=this.sl.getCommandByExternalUxId(b);if(!b)return r.result=-1,r.props=B,r;b=this.RTd(b,B);r.result=b;r.props=B;return r}cfi(b,h=null,r=null){r||(r={});for(const B of b)b=nf.b(B.ExternalId)?B.Id:B.ExternalId,r[b]=this.bfi(b,h);return r}Toh(b,h,r,B,P=null,ca=null){let ra,Qa=null;ra=-1;let tb=!1;for(const Zb of h){var Mb=this.NZl(b);h=ca&&ca[Zb]&&-1!==ca[Zb].result?ca[Zb]:this.bfi(Zb,P);const jc=h.result;h=h.props;B&&r.push(zB(Zb,1>(jc&1)));(Mb=CE(Zb,Mb,h,jc))&&r.push.apply(r,Mb);h[Ui.a.On]&&
(Qa=Zb,h[Ui.a.HighlightOn]&&h[Ui.a.HighlightOn]&&(tb=!0));void 0!==h[ll.a.labelText]&&null!==h[ll.a.labelText]&&(Mb=this.sl.getCommandByExternalUxId(Zb),r.push(appChrome.actions.setControlLabel(Mb.externalUxCommand,h[ll.a.labelText])));h[Ui.a.IsRtl]&&0>ra&&(ra=h[Ui.a.IsRtl])}tb&&(t.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",Qa),r.push(appChrome.actions.highlightSelectedFontStyle(Qa)));return{returnValue:Qa,J3h:ra}}NZl(b){switch(b){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";
case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}RTd(b,h){h.MenuItemId=b.menuItemId;return this.Uta.Oqa(this.mA,this.K_b,
b.commandId,b.queryCommandId,h)}}Object(m.a)(sC,"ReactGalleryPoller",null,[]);var rD=c(699),mv=c(664),Iu=c(1724),DE=c(770),Ms=c(1725);class tC{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;this.isSubscriber=!1;this.previewFontFamily=null}}Object(m.a)(tC,"PopulateFontPickerDataProps",null,[]);var sD=c(285),Ju=c(1888);class Ku{constructor(){this.iconSet=null;this.hidden=this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null;
this.shouldTakeFocus=!1}}Object(m.a)(Ku,"CommonOptionalButtonProperties",null,[]);class Ay extends Ku{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=this.hideLabel=!1;this.lang=null;this.dismissHostingSurfaceOnExecute=!1}}Object(m.a)(Ay,"OptionalButtonProperties",Ku,[]);class EE extends Ku{constructor(){super();this.ariaDescription=this.lang=this.roleInMenu=this.styles=this.commandValueId=null}}Object(m.a)(EE,"OptionalCompoundButtonProperties",Ku,[]);class Vv extends Ku{constructor(){super();
this.onRetryCommandId=this.retryButtonTitle=this.ariaDescription=this.label=null}}Object(m.a)(Vv,"OptionalErrorViewProperties",Ku,[]);class ZC extends Ku{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=!1;this.roleInMenu=null}}Object(m.a)(ZC,"OptionalFlyoutAnchorProperties",Ku,[]);class Wv extends Ku{constructor(){super();this.isBanner=null}}Object(m.a)(Wv,"OptionalLabelProperties",
Ku,[]);class zA extends Ku{constructor(){super();this.commandValueId=this.actionCommandValueId=this.actionText=this.actionId=this.details=this.links=this.description=this.actionCommandId=this.commandId=this.secondaryLabel=this.label=null}}Object(m.a)(zA,"OptionalMultipActionButtonProperties",Ku,[]);class ND extends Ay{constructor(){super();this.styles=this.secondaryText=null;this.flipIconInRtl=!1}}Object(m.a)(ND,"OptionalPersonaButtonProperties",Ay,[]);class Yq extends Ku{constructor(){super();this.toggled=
!1;this.roleInMenu=null;this.toggleUsingIcon=!1}}Object(m.a)(Yq,"OptionalToggleButtonProperties",Ku,[]);var FE=c(1727),AF=c(1726),$C=c(477);class aD{constructor(){this.QGh=this.actions=null;this.KKj=!1}}Object(m.a)(aD,"PopulateActions",null,[]);class Of{Shi(b,h){switch(h){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(b);case "ToggleButtonModel":return this.Oam(b);case "InkButtonModel":return this.Nam(b);case "GalleryModel":return appChrome.selectors.getGalleryState(b);case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(b);
case "SliderModel":return appChrome.selectors.getSliderState(b)}return{}}Oam(b){const h={};h[qg.a.On]=appChrome.selectors.getButtonToggleState(b);return h}Nam(b){const h={};h[qg.a.On]=Hh.i("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(b):appChrome.selectors.getButtonToggleState(b);return h}}Object(m.a)(Of,"ReactStatePropsSelector",null,[]);class bD{constructor(b,h,r,B,P){this.Uta=b;this.mA=h;this.K_b=r;this.sl=B;this.BUe={};this.Fgk=new Of;this.Dyb=P}guj(b){const h=b.populationProps.populateQueryCommandId;
return b.populationProps.populateOnlyOnce&&h in this.BUe}obm(b,h,r=null){const B=[],P={};if(!this.guj(b)){const ca=b.populationProps.populateQueryCommandId,ra={};ra.MenuId=b.externalUxCommand;ra.IsShadowMenuOpen=this.isShadowMenuOpen(r);if(0<(this.Uta.Oqa(this.mA,this.K_b,ca,ca,ra,this.x1l(r))&1))if("FontPickerModel"===h)this.BUe[ca]=!0,B.push(bD.A$l(b,ra)),P[b.externalUxCommand]="FontPickerModel";else if(ra.MenuItems)switch(this.BUe[ca]=!0,h){case "ComboBoxModel":B.push(bD.y$l(b,ra));P[b.externalUxCommand]=
"ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":B.push.apply(B,this.aki(b.externalUxCommand,h,ra.MenuItems,P,r&&"location"in r?r.location:null))}}return Object.assign(new aD,{actions:B,QGh:P,KKj:this.isShadowMenuOpen(r)})}Bci(b,h,r,B,P,ca,ra,Qa,tb=null){let Mb=null;const Zb=[];nf.c(b.Title)||(Mb=b.Title);for(let jc=0;jc<b.ControlList.length;jc++){const Gc=Object(Ra.a)(rq.a,b.ControlList[jc]);
if(!Gc||Gc.ExternalId)ca&&this.iSl(Gc,ca),h.push.apply(h,this.z$l(Gc,ra,Zb,P,r,B,tb))}return Qa?appChrome.api.menuSection(Zb,Mb,b.Lang):null}aki(b,h,r,B,P=null){const ca=[],ra=[],Qa=[],tb=[];for(var Mb=0;Mb<r.MenuSectionList.length;Mb++){var Zb=Object(Ra.a)(di.a,r.MenuSectionList[Mb]);Zb&&(Zb=this.Bci(Zb,ca,b,h,tb,B,ra,r.UpdateDynamically,P),r.UpdateDynamically&&Qa.push(Zb))}Mb=null;r.MenuFooterSection&&(Mb=this.Bci(r.MenuFooterSection,ca,b,h,tb,B,ra,r.UpdateDynamically,P));r.UpdateDynamically&&ca.push(appChrome.actions.updateMenu(b,
Qa,r.Title,r.AriaLabel,r.ShouldAutoOpen,r.AriaRoleDescription,r.MenuTargetDescriptor,Mb,r.IsFlexLayout));0<ra.length&&ca.splice(0,0,appChrome.actions.addControls(ra));0<tb.length&&Hh.d("setStatefulSplitButtonMruBypassControls")&&ca.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(b,tb));return ca}iSl(b,h){switch(b.ControlType){case 1:case 3:h[b.ExternalId]=1===b.ControlType?"ButtonModel":"CompoundButtonModel";break;case 2:h[b.ExternalId]="ToggleButtonModel";break;case 6:h[b.ExternalId]=
"CheckboxModel";break;case 7:h[b.ExternalId]="ColorPickerModel";b=Object(Ra.a)(Aw.a,b);b.McuLayout&&(h[b.McuExternalId]="ColorPickerModel");break;case 9:h[b.ExternalId]="FlyoutAnchorModel"}}z$l(b,h,r,B,P,ca,ra=null){const Qa=[];switch(b.ControlType){case 14:v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutBannerEnabled",!1)&&(B=Object(Ra.a)(DE.a,b),null!=B.IsBanner&&B.IsBanner&&this.mEn(Object(Ra.a)(DE.a,b),Qa,h,r));break;case 1:case 3:b=Object(Ra.a)(ah.a,b);this.oEn(b,
Qa,h,r);b.MenuItemsStatefulData&&Hh.d("setStatefulSplitButtonMenuItemsStatefulData")&&Qa.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(P,b.MenuItemsStatefulData));break;case 2:this.ZEn(Object(Ra.a)($C.a,b),Qa,h,r);break;case 6:this.pEn(Object(Ra.a)(pA.a,b),Qa,h,r);break;case 4:this.SEn(Object(Ra.a)(Zj,b),Qa,h,r);break;case 7:this.rEn(Object(Ra.a)(Aw.a,b),Qa,h,r);break;case 12:this.yEn(Object(Ra.a)(Iu.a,b),Qa,h,r);break;case 13:this.PEn(Object(Ra.a)(Ms.a,b),Qa,h,r);break;case 9:b=
Object(Ra.a)(wg.a,b);this.AEn(b,Qa,h,r);"StatefulSplitButtonModel"===ca&&B.push(b.ExternalId);break;case 8:this.Dyb.EEn(Object(Ra.a)(Sg.a,b),Qa,h,r,ra)}return Qa}mEn(b,h,r,B){B.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.IconName&&0<b.IconName.length&&h.push(appChrome.actions.setControlIcon(b.ExternalId,b.IconName))):(h=null,b.IconName&&0<b.IconName.length&&(h=new Ju.a(b.IconName)),r.push(appChrome.api.createLabelModel(b.ExternalId,
b.LabelText,b.Id,Object.assign(new Wv,{isBanner:b.IsBanner,iconSet:h?h.iconSet:null}))))}oEn(b,h,r,B){B.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),b.Description&&h.push(appChrome.actions.updateCompoundButtonDescription(b.ExternalId,b.Description)),b.CommandValueId&&h.push(appChrome.actions.setButtonCommandValueId(b.ExternalId,b.CommandValueId)),this.OCd()&&((r=this.hQa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,
(new Ju.a(r)).iconSet)),b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,b.Alt)))):(b.Description||Object(Ib.a)(cz,b)?r.push(appChrome.api.createCompoundButtonModel(b.ExternalId,b.LabelText,b.Description,Object.assign(new EE,{iconSet:(new Ju.a(this.hQa(b))).iconSet,keytip:b.KeyTip,roleInMenu:b.RoleInMenu,ariaDescription:b.AriaDescription,customTooltip:b.LabelText!==b.Alt?b.Alt:null}))):(B=b.DismissHostingSurfaceOnExecute,r.push(appChrome.api.createButtonModel(b.ExternalId,
b.LabelText,Object.assign(new Ay,{iconSet:(new Ju.a(this.hQa(b))).iconSet,keytip:b.KeyTip,supportsPreview:!!b.CommandPreviewId&&!!b.CommandRevertId,customTooltip:b.LabelText!==b.Alt?b.Alt:null,commandValueId:b.CommandValueId,shouldTakeFocus:b.ShouldTakeFocus,dismissHostingSurfaceOnExecute:void 0!==B&&null!==B?B:!0})))),this.sl.addCommandToMaps(Object.assign(new yA.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand,commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));
b.Lang&&Hh.d("setControlLanguage")&&h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}pEn(b,h,r,B){B.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.OCd()&&((r=this.hQa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Ju.a(r)).iconSet)),b.IsChecked&&h.push(appChrome.actions.toggleButton(b.ExternalId,b.IsChecked)),b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,
b.Alt)))):(r.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new Yq,{iconSet:(new Ju.a(this.hQa(b))).iconSet,keytip:b.KeyTip,toggled:b.IsChecked,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null,toggleUsingIcon:!!b.CheckedImageClass}))),this.sl.addCommandToMaps(Object.assign(new yA.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}yEn(b,h,r,B){B.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?
(b.Label&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.Label)),b.IconName&&0<b.IconName.length&&h.push(appChrome.actions.setControlIcon(b.ExternalId,b.IconName))):(h=null,b.IconName&&0<b.IconName.length&&(h=new Ju.a(b.IconName)),r.push(appChrome.api.createErrorViewModel(b.ExternalId,Object.assign(new Vv,{label:b.Label,retryButtonTitle:b.RetryButtonTitle,onRetryCommandId:b.OnRetryCommandId,ariaDescription:b.AriaDescription,iconSet:h?h.iconSet:null}))))}PEn(b,h,r,B){B.push(b.ExternalId);
appChrome.selectors.isControlDefined(b.ExternalId)?(r={},b.Label&&(r.label=b.Label),b.SecondaryLabel&&(r.secondaryLabel=b.SecondaryLabel),b.Details&&(r.details=b.Details),b.Description&&(r.description=b.Description),b.iconSet&&(r.iconSet=b.iconSet),b.Links&&(r.links=b.Links),b.CommandValueId&&(r.commandValueId=b.CommandValueId),b.ActionCommandValueId&&(r.actionCommandValueId=b.ActionCommandValueId),b.ActionCommandId&&(r.actionCommandId=b.ActionCommandId),b.CommandId&&(r.commandId=b.CommandId),h.push(appChrome.actions.updateMultiActionButton(b.ExternalId,
r))):(r.push(appChrome.api.createMultiActionButtonModel(b.Id,Object.assign(new zA,{label:b.Label,secondaryLabel:b.SecondaryLabel,actionText:b.ActionText,description:b.Description,iconSet:b.iconSet,links:b.Links,details:b.Details,actionId:b.ActionId,commandId:b.CommandId,actionCommandId:b.ActionCommandId||b.ActionId,commandValueId:b.CommandValueId,actionCommandValueId:b.ActionCommandValueId||b.CommandValueId}))),b.CommandIdMapped&&this.sl.addCommandToMaps(new yA.a(b.CommandId,b.CommandIdMapped)),b.ActionIdMapped&&
this.sl.addCommandToMaps(new yA.a(b.ActionId,b.ActionIdMapped)))}ZEn(b,h,r,B){B.push(b.ExternalId);appChrome.selectors.isControlDefined(b.ExternalId)?(b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.OCd()&&((r=this.hQa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Ju.a(r)).iconSet)),v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&b.LabelText!==b.Alt&&h.push(appChrome.actions.setControlCustomTooltip(b.ExternalId,
b.Alt)))):(v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?r.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new Yq,{iconSet:(new Ju.a(this.hQa(b))).iconSet,iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null}))):r.push(appChrome.api.createToggleButtonModel(b.ExternalId,b.LabelText,Object.assign(new Yq,{iconSet:(new Ju.a(this.hQa(b))).iconSet,
iconColor:b.IconColor,keytip:b.KeyTip,fullDescriptionLabel:b.Description,roleInMenu:b.AriaLabel}))),this.sl.addCommandToMaps(Object.assign(new yA.a(b.ExternalId,b.Command),{menuItemId:b.MenuItemId,queryCommandId:b.QueryCommand})))}SEn(b,h,r,B){B.push(b.ExternalId);B=this.b$l(b);appChrome.selectors.isControlDefined(b.ExternalId)?b.LabelText&&h.push(appChrome.actions.setPersonaButtonCoauthor(b.ExternalId,B,b.LabelText)):Hh.a("createPersonaButtonModel")&&r.push(appChrome.api.createPersonaButtonModel(b.ExternalId,
B,b.LabelText,Object.assign(new ND,{role:b.RoleInMenu,fullDescriptionLabel:b.AriaDescription,iconSet:{["default"]:"doughboywhiteglyph_20"}})))}AEn(b,h,r,B){B.push(b.ExternalId);if(appChrome.selectors.isControlDefined(b.ExternalId))b.LabelText&&h.push(appChrome.actions.setControlLabel(b.ExternalId,b.LabelText)),this.OCd()&&((r=this.hQa(b))&&0<r.length&&h.push(appChrome.actions.setControlIconSet(b.ExternalId,(new Ju.a(r)).iconSet)),void 0!==b.ImageIsVisible&&null!==b.ImageIsVisible&&h.push(appChrome.actions.hideFlyoutAnchorIcon(b.ExternalId,
!b.ImageIsVisible)),void 0!==b.Toggled&&null!==b.Toggled&&h.push(appChrome.actions.toggleButton(b.ExternalId,b.Toggled)));else{B=!(void 0===b.ImageIsVisible||null===b.ImageIsVisible)&&!b.ImageIsVisible;const P=!(void 0===b.Toggled||null===b.Toggled)&&b.Toggled;r.push(appChrome.api.createFlyoutAnchorModel(b.ExternalId,b.LabelText,Object.assign(new ZC,{iconSet:(new Ju.a(this.hQa(b))).iconSet,keytip:b.KeyTip,hideIcon:B,toggled:P,roleInMenu:b.AriaLabel,customTooltip:b.LabelText!==b.Alt?b.Alt:null})));
this.sl.addCommandToMaps(Object.assign(new yA.a(b.ExternalId,b.Command),{queryCommandId:b.QueryCommand,populationProps:new rD.a(b.PopulateQueryCommand,b.PopulateOnlyOnce)}))}b.Menu&&h.push.apply(h,this.aki(b.ExternalId,"FlyoutAnchorModel",b.Menu,null));b.Lang&&h.push(appChrome.actions.setControlLanguage(b.ExternalId,b.Lang))}rEn(b,h,r,B){b.McuLayout&&B.push(b.McuExternalId);B.push(b.ExternalId);B=0;appChrome.selectors.isControlDefined(b.ExternalId)?b.McuLayout&&(B=this.Fgk.Shi(b.ExternalId,"ColorPickerModel").columnCount):
(b.McuLayout&&(r.push(appChrome.api.createColorPickerModel(b.McuExternalId,b.Width)),this.sl.addCommandToMaps(Object.assign(new yA.a(b.McuExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})),B=b.Width),r.push(appChrome.api.createColorPickerModel(b.ExternalId,b.Width)),this.sl.addCommandToMaps(Object.assign(new yA.a(b.ExternalId,b.Command),{commandPreviewId:b.CommandPreviewId,commandRevertId:b.CommandRevertId})));r=[];const P=[];for(let ca=0;ca<b.Colors.length;ca++){const ra=
b.Colors[ca];ca<B?r.push(appChrome.api.colorPickerCell(ra.Color,ra.DisplayColor,ra.Alt)):P.push(appChrome.api.colorPickerCell(ra.Color,ra.DisplayColor,ra.Alt))}0<r.length&&h.push(appChrome.actions.populateColorPickerCells(b.McuExternalId,r));h.push(appChrome.actions.populateColorPickerCells(b.ExternalId,P));b.SelectedColorId&&(0<r.length&&h.push(appChrome.actions.updateColorPickerSelectedColor(b.McuExternalId,b.SelectedColorId)),h.push(appChrome.actions.updateColorPickerSelectedColor(b.ExternalId,
b.SelectedColorId)))}hQa(b){return b.Image32by32Class?this.sl.I9h(b.Image32by32Class):b.Image16by16Class?this.sl.I9h(b.Image16by16Class):b.ExternalImageId}b$l(b){return b?Object.assign(new AF.a,{displayName:b.DisplayName,personaCoinColor:b.ImageBackColor,isUnauthenticatedSender:b.IsAnonymous,identifiers:Object.assign(new FE.a,{PersonaType:"User",Smtp:b.PersonaId})}):null}x1l(b){let h=2;b&&"inputMethod"in b&&b.inputMethod&&(h=b.inputMethod);return h}isShadowMenuOpen(b){return!!b&&b.isShadowRendering}OCd(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",
!1)}static A$l(b,h){return appChrome.actions.populateFontPickerDataAsync(new Promise((r,B)=>{Ma.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(P=>{P.isFeatureEnabled(sD.a.QKb,!1).then(ca=>{let ra=h.fonts;ca||P.isFreemiumUpsellEnabled()||(ra=Rl.a.msg(ra,Qa=>Qa.fontType!==sD.a.g2f));ca=Object.assign(new tC,{commandId:b.externalUxCommand,fonts:ra,isSubscriber:ca,mruList:h.mruList,initialPinnedFontKeys:h.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});
r(ca)}).catch(B)})}))}static y$l(b,h){const r=[];for(let B=0;B<h.MenuItems.MenuSectionList.length;B++){const P=h.MenuItems.MenuSectionList[B];P.Title&&r.push(appChrome.api.comboBoxHeader("Header-"+B.toString(),P.Title));for(let ca=0;ca<P.ControlList.length;ca++){const ra=Object(Ra.a)(mv.a,P.ControlList[ca]);ra&&r.push(appChrome.api.comboBoxItem(ra.MenuItemId,ra.LabelText,ra.Styles,ra.CommandValueId,ra.AriaLabel,ra.Data,ra.Disabled))}B<h.MenuItems.MenuSectionList.length-1&&r.push(appChrome.api.comboBoxDivider("Divider-"+
B.toString()))}return appChrome.actions.populateComboBoxOptions(b.externalUxCommand,r)}}Object(m.a)(bD,"ReactPopulateQueryCommandPoller",null,[]);class uC{constructor(b,h,r,B,P){this.sl=r;this.Uta=b;this.mA=h;this.K_b=B;this.Dyb=P}nbm(b,h,r){const B=[];if(this.ZJm(h))b=this.mfm(b,h,r),void 0!==b&&null!==b&&B.push.apply(B,b);else if(b){var P=this.RTd(b,r);ll.a.visible in r&&B.push(appChrome.actions.updateControlHiddenState(b.externalUxCommand,!r[ll.a.visible]));B.push(zB(b.externalUxCommand,1>(P&1)));
void 0!==r[ll.a.labelText]&&null!==r[ll.a.labelText]&&B.push(appChrome.actions.setControlLabel(b.externalUxCommand,r[ll.a.labelText]));void 0!==h&&null!==h&&(P=CE(b.externalUxCommand,h,r,P),void 0!==P&&null!==P&&B.push.apply(B,P),"PeopleWell"===h&&this.nuk(b.externalUxCommand,r,B))}return B}ZWl(b,h,r){const B=[];switch(h){case "FlyoutAnchorModel":var P=appChrome.selectors.getFlyoutAnchorMenuItems(b);break;case "SplitButtonModel":var ca=appChrome.selectors.getSplitButtonState(b);if(ca=this.sl.getCommandByExternalUxId(ca.command))r=
this.Uta.X3c(this.mA,ca.commandId,r),B.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(b,!r)),B.push(zB(b,!1));return B;default:return null}h=!1;for(ca in P)if(P=this.sl.getCommandByExternalUxId(ca),nf.c(P))h=!0;else if(r.SourceControlId=P.externalUxCommand,this.Uta.X3c(this.mA,P.commandId,r))return B.push(zB(b,!1)),B;B.push(zB(b,!h));return B}mfm(b,h,r){switch(h){case "PreviewGalleryModel":return this.Dyb.U$l(b,r);case "GalleryModel":return this.Dyb.QZl(r)}return null}ZJm(b){return"GalleryModel"===
b||"PreviewGalleryModel"===b}RTd(b,h){h.MenuItemId=b.menuItemId;return this.Uta.Oqa(this.mA,this.K_b,b.commandId,b.queryCommandId,h)}nuk(b,h,r){const B=h[en.a.LabelTextUserGeneratedPlaceholderReplacements];h=h[en.a.LabelText];B&&0<B.length&&(h=String.format.apply(null,[h].concat(B)));r.push(this.Ejm(b,h))}Ejm(b,h){return appChrome.actions.updatePeopleWell(this.QRl(b),h)}QRl(b){const h=[];var r={};b=this.sl.getCommandByExternalUxId(b).populationProps.populateQueryCommandId;this.Uta.Oqa(this.mA,this.K_b,
"1285265560",b,r);r=r.MenuItems;if(!r)return h;r=r.MenuSectionList[0];for(b=0;b<r.ControlList.length;b++){const B=r.ControlList[b],P={};P.name=B.Alt;P.id=B.MenuItemId;P.description=B.Description;P.color=B.ImageBackColor;P.joinTime=B.JoinTimeInMS;P.imageUrl=B.ImageUrl;P.activeStatus=B.ActiveStatus;P.isAnonymous=B.IsAnonymous;P.canJump=B.CanJump;P.upn=B.Upn;h.push(P)}return h}}Object(m.a)(uC,"ReactQueryCommandPoller",null,[]);var BF=c(1141);class OD{constructor(b,h,r){this.sl=b;this.mA=h;b=new BF.a;
this.Zkk=new Of;this.Dyb=new sC(b,this.mA,r,this.sl);this.Dch=new bD(b,this.mA,r,this.sl,this.Dyb);this.sch=new uC(b,this.mA,this.sl,r,this.Dyb)}DFa(){const b=[];if(!Hh.c())return b;b.push.apply(b,this.Cjm());var h=this.ZVl();if(0<h.length)b.push.apply(b,h);else if(h=appChrome.selectors.getActiveControlIds(),Object.keys(h).length){const r=this.$Vl();for(const B of r)b.push(appChrome.actions.updateControlEnabledDisabledState(B,!0)),delete h[B];b.push.apply(b,this.hVd(h))}return b}Y3c(b,h){Hh.c()&&
(b=this.hVd(b,h),appChrome.api.dispatch(b))}B1f(b,h,r=null){if(!nf.c(b)&&b.populationProps&&!this.Dch.guj(b)){b=this.Dch.obm(b,h,r);if(!b.KKj){let B;(B=b.actions).push.apply(B,this.hVd(b.QGh,Hh.g(r)))}if(0<b.actions.length)return appChrome.api.dispatch(b.actions),!0}return!1}hVd(b,h=0){const r=[],B={};if(Hh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&""!==appChrome.selectors.getSelectedTabId())for(var P of appChrome.selectors.getActiveGroupIds())for(var ca of appChrome.selectors.getVisibleControlsInGroup(P))B[ca]=
!0;for(let ra in b)P=ra,ca=b[ra],0===h&&B[P]&&(h=2),r.push.apply(r,this.Bjm(P,ca,h));return r}Bjm(b,h,r=0){const B=[],P=this.sl.getCommandByExternalUxId(b);let ca={};appChrome.selectors.isControlDefined(b)&&(ca=this.Zkk.Shi(b,h));ca[zy.a.g9a]=r;nf.c(P)?(ca.ExternalUxId=b,(b=this.sch.ZWl(b,h,ca))&&0<b.length&&B.push.apply(B,b)):(ca.MenuItemId=P.menuItemId,ca.SourceControlId=b);B.push.apply(B,this.sch.nbm(P,h,ca));return B}Cjm(){const b=[],h=!!v.AFrameworkApplication.K&&(v.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")||
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1)),r=appChrome.selectors.getContextualTabIds();let B=[];h&&(B=appChrome.selectors.getActiveContextualTabIds());for(let ca=0;ca<r.length;ca++){var P=this.sl.jvf(r[ca]);if(P){P=this.mA.NGa(P);let ra=!0;h&&(ra=0<=Array.indexOf(B,r[ca]));h&&ra===P||b.push(appChrome.actions.activateDeactivateContextualTab(r[ca],P))}}return b}ZVl(){var b=appChrome.selectors.getSelectedTabId();const h=[],r=this.sl.jvf(b);
r&&(this.mA.NGa(r)||h.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(b,!0)));return h}$Vl(){var b=appChrome.selectors.getActiveGroupIds();const h=[];for(const r of b)if(b=this.sl.h_l(r))for(const B of b)this.mA.NGa(B.commandId)||((b=B.externalUxCommandIds)||(b=appChrome.selectors.getVisibleControlsInGroup(B.externalUxGroupId)),h.push.apply(h,b));return h}}Object(m.a)(OD,"ReactRibbonRootPoller",null,[866]);class Bz{constructor(b,h,r=null){this.mA=this.QBa=this.odb=null;this.r_b=
h;b.UNa(this);this.JF=r}get Zpa(){this.QBa||(this.QBa=new Date,this.QBa.setTime(0));return this.QBa}set Zpa(b){this.QBa=b}get A$(){return 2}get JF(){return this.mA}set JF(b){this.mA=b}get ajc(){this.odb||(this.odb=new OD(this.r_b,this.JF,this.A$));return this.odb}kgb(){const b=document.activeElement;dc.a.isEditable(b)&&b.blur()}executeCommand(b,h,r,B,P,ca,ra,Qa=2){nf.c(this.JF)||(P=new Rr.a,P.CommandLocation=Qa,P.InvocationMethod=B,P.CommandTabName=r,h[zy.a.g9a]=Qa,this.JF.vPa(b,h,P,ca,ra),this.v4m(b,
h))}DFa(){return nf.c(this.JF)?[]:this.ajc.DFa()}Hm(){const b=this.DFa();0<b.length&&(this.Zpa=new Date,appChrome.api.dispatch(b))}Ddd(){Hh.c()&&this.ajc.Y3c({PeopleWell:"PeopleWell"},18)}udd(){}v4m(b,h){try{const r=Ma.a.instance.Oa("Common.ISystemInitiatedFeedback");if(r&&h){const B=h.SourceControlId||h.launcherId||h.LegacyId||h.NewContextId;let P=(B?"_"+B:"")+(h.SqmControlId?"_"+h.SqmControlId:"");P=P.length?P:"_"+b;r.UMf("Ribbon"+P)}}catch(r){t.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+
(r?r.toString():""))}}}Object(m.a)(Bz,"ReactRibbonRoot",null,[555,867]);var cD=c(1651);class PD{constructor(b){this.hYe=this.qDe=!1;this.aab=null;this.bOg=!1;this.lQ=null;this.pta=!1;this.OPe=b;sf.a.instance.ob(pd.a.Wx,this.bQc(),Object(z.a)(this,this.enn,"onContextualUIMouseDown"));(b=Ma.a.instance.Ta("Common.IActionContextProvider"))&&b.execute(h=>{this.lQ=h});v.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&v.AFrameworkApplication.ua.Kb.MJ?ij.a.get_instance().pk(16,
()=>{this.Y4?this.initializeContextualUI(this.bQc()):ij.a.get_instance().pk(7,()=>{this.initializeContextualUI(this.bQc())})}):ij.a.get_instance().pk(7,()=>{this.initializeContextualUI(this.bQc())})}get M0(){return this.pta}get Y4(){return v.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&v.AFrameworkApplication.ua.Kb.MJ?ij.a.get_instance().isCompleted(16)&&ij.a.get_instance().isCompleted(7):ij.a.get_instance().isCompleted(7)}TSk(){if(this.bOg)return!0;try{return Promise.resolve(null),
this.bOg=!0}catch(b){return!1}}Eog(b){if(!this.Y4||this.hYe)return this.PNf("Unable to launch contextual ui because ribbon hasn't loaded yet"),!0;if(!this.TSk())return this.PNf("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(v.AFrameworkApplication.LLd||""!==v.AFrameworkApplication.ou)if(!v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.enableRibbonForCA",!1)||"DocGen"===v.AFrameworkApplication.ou||"ContentAssemblyView"===v.AFrameworkApplication.ou)return this.PNf("Unable to launch contextual ui because the feature to show contextual ui is disabled"),
!0;this.hYe=!0;let h=fb.a.Kg;switch(b){case 1:h=fb.a.showContextMenu;break;case 0:h=fb.a.showFloatie;break;case 2:h=fb.a.Tlc}window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.hYe=!1;Ke.c(h)},0)});return!1}uki(b){return al.UISurfaces.q2a().then(h=>{if(appChrome.api.isSmallDevice()&&h.getBlockedSmallScreenFloatieGroupList){h=h.getBlockedSmallScreenFloatieGroupList();const r=[];for(const B of b)Array.contains(h,B)||r.push(B);return r}return b})}showFloatie(b,h,r,B=null){this.Eog(0)||this.uki(h).then(P=>
{if(0>=P.length)return null;this.vfg(P).then(()=>{const ca={};ca.target=b;al.UISurfaces.q2a().then(ra=>{appChrome.api.dispatch(ra.showFloatie(ca,r,void 0,this.vsf(),B));this.pta=!0;v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogFloatieMenuContextIsEnabled",!1)&&v.AFrameworkApplication.va&&v.AFrameworkApplication.va.processAction(fb.a.sKi,2);return null})});return null})}showContextMenu(b,h,r=null,B=null){this.Eog(1)||this.Zrj(b,h,r,B)}Zrj(b,h,r=null,B=null){this.vfg(null).then(()=>
{const P={};P.target=b;B&&(P.directionalHint=B);al.UISurfaces.q2a().then(ca=>{appChrome.api.dispatch(ca.showContextMenu(P,h,r,void 0,this.vsf()));return null})})}Slc(b,h,r,B=null){this.Eog(2)||this.uki(h).then(P=>{0>=P.length?this.Zrj(b,r,B):this.vfg(P).then(()=>{const ca={};ca.target=b;const ra={};ra.target=b;al.UISurfaces.q2a().then(Qa=>{appChrome.api.dispatch(Qa.showContextualUI(ca,ra,r,void 0,B,this.vsf()));this.pta=!0;return null})});return null})}PNf(b){t.ULS.sendTraceTag(561394519,340,15,b)}eMc(){this.Y4&&
al.UISurfaces.isLoaded()&&al.UISurfaces.q2a().then(b=>{appChrome.api.dispatch(b.hideContextMenu());return null})}dismissFloatie(){this.Y4&&al.UISurfaces.isLoaded()&&al.UISurfaces.q2a().then(b=>{this.pta=!1;appChrome.api.dispatch(b.hideFloatie());return null})}Z6b(){this.Y4&&al.UISurfaces.isLoaded()&&al.UISurfaces.q2a().then(b=>{appChrome.api.dispatch(b.hideContextualUI());this.pta=!1;return null})}initializeContextualUI(b){return al.UISurfaces.q2a().then(h=>{this.qDe||(h.initializeContextualUI(b),
this.qDe=!0);return null})}vfg(b){if(!this.qDe)return this.initializeContextualUI(this.bQc()).then(()=>{this.setActiveFloatieGroups(b);return null});this.setActiveFloatieGroups(b);return Promise.resolve(null)}setActiveFloatieGroups(b){if(b&&b.length){var h=[];h.push(appChrome.actions.setActiveFloatieGroups(b));appChrome.api.dispatch(h);var r=[];al.UISurfaces.q2a().then(B=>{r.push.apply(r,this.OPe.ajc.hVd(B.selectors.getFloatieOnlyControlsMap(),9));0<r.length&&appChrome.api.dispatch(r);return null})}}bQc(){if(this.aab)return this.aab;
this.aab=cD.a("div");this.aab.id="ReactContextualUIDiv";this.aab.style.position="absolute";this.aab.style.zIndex="1001";document.body.insertBefore(this.aab,document.body.firstChild);return this.aab}enn(b){b.Hb&&b.Hb.target&&"input"===b.Hb.target.tagName.toLowerCase()&&pc.FocusManager.instance().kD("ribbon");return!1}vsf(){return this.lQ?this.lQ.contentType:"Unknown"}}Object(m.a)(PD,"ReactContextualUILauncher",null,[868]);class bi extends uf.a{constructor(){super()}}Object(m.a)(bi,"FloatieBuildOptions",
uf.a,[]);class QD extends jt.a{constructor(){super()}}Object(m.a)(QD,"FloatieBuildContext",jt.a,[]);var CF=c(653);class Pj extends We.Builder{constructor(b,h,r){super(b,h,r,null);if(nf.c(h))throw Error.create("Floatie placeholder DOM element is null or undefined.");}get floatie(){return this.root}Ipo(b){this.root=b}JNk(){const b=new QD,h=new Bg.a;h.H5c=1;h.handler=Object(z.a)(this,this.wtn,"onReturnFloatieData");h.data=b;this.Pva.pfe(h)}wtn(b){this.KNk(b.a5c,b.UJc);this.floatie.z1h=this;this.floatie.Im();
this.floatie.Nc.style.display="none";this.placeholder.appendChild(this.floatie.Nc);this.$ua.continueWith(()=>{this.$ua.result.tMb(this.floatie)},11);Dh.a.instance.ob(pd.a.pointerDown,this.floatie.Nc,Object(z.a)(this.floatie,this.floatie.gD,"onPointerDown"))}KNk(b,h){b=Ye.a.Nha(b,Ye.a.ZOj);if(nf.c(b))throw Error.create("No floatie element was present in the data");b=new Ye.a(b);this.Ipo(new Vt(b.attributes[Ye.a.id],b.attributes));b=Ye.a.Nha(b.node,Ye.a.Sqe);this.C5e(b,h)}C5e(b,h){b=Ye.a.ww(b);for(let r=
0;r<b.length;r++){if(this.ARa(b[r]))continue;const B=this.J5e(b[r],h);this.floatie.Bf(B)}}J5e(b,h){var r=new Ye.a(b);b=new CF.Group(this.floatie,r.attributes[Ye.a.id],r.attributes[Ye.a.gWa],r.attributes[Ye.a.Tpc],r.attributes[Ye.a.bWa],!1,r.name===Ye.a.uSj,!1,r.attributes);r=Ye.a.ww(r.node);for(let B=0;B<r.length;B++)b.Bf(this.JEd(r[B],h));return b}JEd(b,h){b=new Ye.a(b);var r=b.attributes[Ye.a.id];b=Ye.a.ww(b.node);var B=2;2===b.length&&(B=3);r=new Lj.a(this.floatie,r,B,2,1);for(B=0;B<b.length;B++){const ca=
new Ye.a(b[B]);var P=Ye.a.Nha(ca.node,Ye.a.wsb);P=Ye.a.ww(P);this.P5e(r.iUd(B+1),P,ca.attributes[Ye.a.id],h)}return r}P5e(b,h,r,B){for(r=0;r<h.length;r++){if(this.ARa(h[r]))continue;const P=new Ye.a(h[r]),ca=this.Gga(h[r],B);ca&&b.Bf(ca.cR(P.attributes[Ye.a.Upc]))}}}Object(m.a)(Pj,"FloatieBuilder",We.Builder,[]);class tD{constructor(b,h){this.Bv=null;this.z1k=b;this.Lxe=h;this.Con=this.t7d.bind(this)}get floatie(){return this.Bv}mgb(b,h,r){h=new vl.CuiHelper(Nd.a.V_a,Box4Intl.Box4Strings,null,null,
h);const B=new bi;B.gH=r||{};B.gH.floatieshadingColor=!1;const P=new Pj(B,document.body,this.z1k.fgj);P.Pva=new Bt.a(b,h);P.JNk();this.Lxe.execute(ca=>{P.floatie.JF=ca});P.floatie.dXn(this.Con);P.floatie.rWn(()=>[]);this.Bv=P.floatie;return this.floatie}}Object(m.a)(tD,"AFloatieInitializer",null,[]);class GE extends tD{constructor(b,h,r,B){super(h,r);this.s1f=()=>{this.floatie.Hm()};this.Nh=b;this.JI=B}mgb(b,h,r){if(b=super.mgb(b,h,r))b.xic=!0,b.Cae=!0,b.preventDismissOnScroll=!0;this.Nh.z_a(this.s1f);
return b}PUc(b,h,r=null){this.JI.pxh(()=>this.mgb(b,h,r))}t7d(){this.floatie.xic=!0}}Object(m.a)(GE,"PasteFloatieInitializer",tD,[]);var RD=c(823);class Ax{Lza(b,h){this.vTk&&this.gwo(b,h,Ax.BPf,Ax.lb)}gwo(b,h,r,B){switch(r){case 1:case 6:case 2:case 3:case 4:Ax.shf.show(B,b,h)}}DOi(){switch(Ax.BPf){case 5:case 1:return!0;default:return!1}}ohl(){return Ax.BPf}get vTk(){return 1!==Eb.App.za.state}static get shf(){return null!=Ax.yyg?Ax.yyg:Ax.yyg=Ma.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static E4l(b){if(!b)return 0;
if(2===Eb.App.za.mode){const h=b.Pa.node,r=Ad.GraphIterator.eb(h);r.Ip();return wm.e(r.currentNode)?2:v.AFrameworkApplication.rTb||!Ix.isEmbeddedFileNode(h)||Ix.isInvalid(h)?Gg.a.sOm(b.Pa)||Gg.a.fFf(b.Pa)?6:1:3}return 4}static get lb(){return Bh.a.instance.ib.lb}static get BPf(){return Ax.E4l(Ax.lb)}}Object(m.a)(Ax,"SelectionContextMenuProvider",null,[1188]);var SD=c(1868);class TD{constructor(b,h){this.Cae=this.xic=!1;this.nTc=!0;this.$L=b;this.sl=h}get isVisible(){return this.$L.M0}get controls(){return null}dismissFloatie(){this.$L.dismissFloatie();
return!0}Gif(){}k8a(b,h,r,B,P=null){this.$L.showFloatie(Object.assign(new SD.a,{x:b.x,y:b.y}),this.Onf(r),r,P)}gGb(){return new Sys.UI.Bounds(0,0,0,0)}o4(){return this.dismissFloatie()}Onf(){return[]}}Object(m.a)(TD,"ReactFloatie",null,[304,305]);class DF{constructor(b){this.rjd=null;this.$L=b}dispose(){}o4(){this.$L.Z6b();return!0}showContextMenu(b,h){this.vqb(b,h.clientPoint,h.kg)}vqb(b,h,r){this.i8a(b,new Sys.UI.Bounds(h.x,h.y,0,0),r);t.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",
b)}i8a(b,h,r,B=null){this.rjd?this.$L.Slc(Object.assign(new SD.a,{x:h.x,y:h.y}),this.rjd.Onf(r),r,b):this.$L.showContextMenu(Object.assign(new SD.a,{x:h.x,y:h.y}),r,b,B);this.rjd=null}Tlc(b,h,r,B){this.rjd=Object(Ra.a)(TD,r);B.Lza(b,h);return!0}M5b(){}}Object(m.a)(DF,"ReactContextMenuController",null,[710,9]);var EF=c(464);class FF{constructor(){this.Sja=this.text=this.spa=null}}Object(m.a)(FF,"BusinessBarButtonData",null,[]);class HE{constructor(){this.text=this.spa=null}}Object(m.a)(HE,"BusinessBarLinkData",
null,[]);var GF=c(247);class UD{constructor(b,h,r,B){this.qVg=this.ISg=this.Fab=this.IQg=null;this.wt=b;this.SAa=h;this.ga=r;this.Ca=B}O0f(){this.tIc();this.uIc();this.J4b()}uIc(){}tIc(){const b=Eb.App.za.jb.Zc;b&&(this.IQg=this.u9a(this.IQg,1,2===Eb.App.za.mode&&b.fEf,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}JXm(){return v.AFrameworkApplication.ua&&1===v.AFrameworkApplication.ua.mode}J4b(){let b=null;const h=Eb.App.za.jb.activeSection;if(h){const r=h.Y2c;GF.a.fZd(r)?22===r?b=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:
19===r||20===r?b=Z.a.vi?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===r?b=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===r?b=Z.a.vi?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===r&&(b=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):GF.a.loi(h.m_a)||Eb.App.Dm||this.JXm()||(b=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.qVg=this.u9a(this.qVg,5,!!b,b)}ssj(b,h,r,
B){b=this.SAa.create(null,b,null);b.closeable=!0;b.id=23;b.image=3;b.QBd(h,()=>{Qd.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+r)});B&&(b.Kga=B);this.wt.sA(b,!0)}Vwo(b,h,r){this.ssj(b,h,r,null)}gxo(b){b=this.SAa.create(null,b,null);b.closeable=!0;b.id=20;this.wt.sA(b)}rwo(){var b=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,h=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;this.Fab||(this.Fab=this.SAa.create(b,h,null),this.Fab.closeable=!0,this.Fab.id=27,this.wt.sA(this.Fab))}uum(){this.Fab&&
(this.Fab=this.u9a(this.Fab,27,!1,""))}ghg(b){this.ISg=this.u9a(this.ISg,30,!0,b)}u9a(b,h,r,B,P=!1,ca="",ra=null,Qa=null,tb=null){r?b?b.message=B:(b=this.SAa.create(ca,B,null),b.id=h,b.closeable=P,ra&&b.addButton(ra.text,ra.spa,ra.Sja),Qa&&b.QBd(Qa.text,Qa.spa),tb&&(b.Kga=tb),this.wt.sA(b,!1)):b&&(this.wt.removeEntry(b),b=null);return b}CZe(b){this.wt.sA(b,void 0)}}Object(m.a)(UD,"BusinessBarController",null,[318]);class AA extends UD{constructor(b,h,r,B){super(b,h,r,B);this.uta=null}Rrf(b,h,r=null,
B=null,P=null,ca=2){if(this.uta)return null;this.uta=this.SAa.create(h,r||"",null);this.uta.id=6;this.uta.image=ca;this.uta.Y_d=!1;b&&(this.uta.errorCode=b);this.uta.closeable=!1;h=v.AFrameworkApplication.MF&&this.Ca.$("ShowFeedbackButtonOnKickoutBusinessBar");B?(this.uta.addButton(B,P,""),h&&this.uta.Vph(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.eli(b)})):h&&this.uta.addButton(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.eli(b)},"");this.wt.sA(this.uta,void 0,null,null,null);return this.uta}eli(b){t.ULS.sendTraceTag(36471966,
338,15,"Feedback given after kickout: {0}",{["ErrorCode"]:b});this.ga.Qb(fb.a.giveFeedback,2,{["ErrorCode"]:b})}static get Hi(){return si.PageReader.instance}}Object(m.a)(AA,"BusinessBarController",UD,[317,318]);class vC{static get VSi(){const b=F.a.Gj(lj.a.tg(v.AFrameworkApplication.lcid).name);return String.format("https://r.office.microsoft.com/r/rlidWebOpenDocumentDetails?clid={0}",b)}}Object(m.a)(vC,"OdtUtils",null,[]);class VD extends AA{constructor(b,h,r,B){super(b,h,r,B);this.vtb=this.Xvc=
this.D6g=this.NNa=this.J6g=this.ehh=null;this.aak="https://go.microsoft.com/fwlink/?linkid=2134357"}O0f(){super.O0f();this.OWk()}uIc(){const b=Eb.App.za.jb.Zc;if(b){var h=Eb.App.S0;if(Eb.App.Fs||Eb.App.Dm||h&&v.AFrameworkApplication.ov)this.ehh=this.u9a(this.ehh,4,AA.Hi.T4a(b),Box4Intl.Box4Strings.l_BusinessBarSigned,!0),this.J6g=this.u9a(this.J6g,3,AA.Hi.J4a(b),Box4Intl.Box4Strings.l_BusinessBarMarkedAsFinal,!0),this.D6g=this.u9a(this.D6g,8,AA.Hi.t5k(b),Box4Intl.Box4Strings.l_BusinessBarContainsMalformedHyperlinkUris,
!0),AA.Hi.lKb(b)?this.NNa||(this.NNa=this.SAa.create(Box4Intl.Box4Strings.l_BusinessBarCompatTitle,Box4Intl.Box4Strings.l_BusinessBarCompatMessage,null),this.NNa.id=14,this.NNa.closeable=!0,this.NNa.image=3,this.NNa.addButton(Box4Intl.Box4Strings.L_LearnMore,Qi.AppFrame.B0m,""),this.wt.sA(this.NNa,!1)):this.NNa&&(this.wt.removeEntry(this.NNa),this.NNa=null)}}OWk(){if(ub.App.wXc){const b=vC.VSi,h=this.SAa.create(Box4Intl.Box4Strings.l_BusinessBarODTDocumentTitle,Box4Intl.Box4Strings.l_BusinessBarODTDocument,
null);h.id=9;h.closeable=!0;h.wtk(b);this.wt.sA(h,!0)}}Wwo(b,h){if(Eb.App.za.jb.Zc){const r=new FF;r.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptSendButton;r.spa=()=>{b()};const B=new HE;B.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptPrivacyLinkText;B.spa=()=>{Qd.a.openWindow(4,v.AFrameworkApplication.privacyUrl)};this.Xvc=this.u9a(this.Xvc,25,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptMessage,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptTitle,
r,B,()=>{h()})}}Cum(){this.Xvc&&(this.Xvc=this.u9a(this.Xvc,25,!1,""))}Zvo(){if(Eb.App.za.jb.Zc){const b=new HE;b.text=WordEditorIntl.WordEditorStrings.L_CitationStyleLearnMore;b.spa=()=>{Qd.a.openWindow(4,this.aak)};this.vtb||(this.vtb=this.SAa.create(WordEditorIntl.WordEditorStrings.L_CitationStylePromptTitle,WordEditorIntl.WordEditorStrings.L_CitationStylePromptText,null),this.vtb.id=32,this.vtb.closeable=!0,this.vtb.image=3,this.vtb.QBd(b.text,b.spa),this.wt.sA(this.vtb,!1))}}BY(b){return this.wt.BY(b)}sA(b,
h){this.wt.sA(b,h)}}Object(m.a)(VD,"BusinessBarController",AA,[316,317,318]);class dD{constructor(){this.menuTargetType=null}}Object(m.a)(dD,"MenuTargetDescriptor",null,[]);var Bx=c(579);class Jj extends Bx.a{constructor(b,h,r,B=!1,P,ca=null,ra){super();this.cae=(Qa,tb,Mb,Zb,jc)=>{if(1===Mb)return 32;Qa=jc.Rx;jc=jc.vd;tb=Object.assign(new $f.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]});this.qcl(tb,Qa,jc.IsShadowMenuOpen);jc.MenuItems=tb;return 32};this.uKn=h;this.Cn=r;this.Rdb=
ca;this.UGe=B;this.Tb(b);this.w$a=ra;Jj.AZa[1]=Nb.a.$je;Jj.AZa[2]=Nb.a.BVd;Jj.AZa[3]=Nb.a.Cke}get Ptl(){return Ba.a.nKd}get Otl(){return Ba.a.KId}get Qtl(){return Ba.a.E$d}get qhf(){return Ba.a.i1i}Tb(b){b.fb(Nb.a.E1f,yc.a.application,this.cae,96);b.fb(Nb.a.R2i,yc.a.application,this.cae,96)}show(b,h,r){let B=null,P=new Sys.UI.Bounds(0,0,0,0);const ca=this.zam(b);if(ca&&(b=b.Pa.node)&&(b=b.te(hb.InteractiveViewManager.instance.yd.$b))){P=Wx.a.Wq(b,ca.end);if(v.AFrameworkApplication.isRtl&&P.x>h.x||
!v.AFrameworkApplication.isRtl&&P.x+P.width<h.x||P.y+P.height<h.y)P=Wx.a.Wq(b,ca.end-1);h.x=P.x+(v.AFrameworkApplication.isRtl?0:P.width);h.y=P.y+P.height;B=6}Bx.a.i8a("ContextMenu",new Sys.UI.Bounds(h.x,h.y,P.width,P.height),r,B)}v0(b,h){return this.iad(b)||Jj.rIc(Nb.a.mergeCells)||Jj.rIc(Nb.a.eJa)||this.Shg(b)||this.Urj(b,h)||Jj.Jsj()||Jj.xsj(b).returnValue}iad(b){return 2===Eb.App.za.mode&&this.nXc(b)}SKc(b,h,r=null){if(rs.QB()&&2===Eb.App.za.mode){h=this.w$a.YJh(b.Pa);if(!h||!this.MTm()&&!this.iVm(h.errorDetails))return;
h=h.errorDetails}else{if(!this.iad(b))return;h=this.Bfi(b)}var B=lj.a.tg(h.lcid);const P=B?B.name:"UNKNOWN";B=Object(Ib.a)(bp.a,h)?h.typeId:"";t.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",h.errorType,h.proofingType,B,P);if(b=this.uKn.$5b(b,h))r.push.apply(r,b),this.V7m(h,B)}iVm(b){return b&&(1===b.proofingType||2===b.proofingType)}MTm(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RightClickALV2Refinement",
!1)}V7m(b,h){const r=Jj.AZa[b.proofingType];r&&(v.AFrameworkApplication.va.processAction(r,2),t.ULS.sendTraceTag(527799885,375,50,"AEditSurfaceContextMenu: Logging command {0}, typeId {1}, proofingType {2}, ALV2 flight {3}.",r,h,b.proofingType,rs.QB()))}Bfi(b){return this.Cn.Boa(b.Pa).errorDetails}nXc(b){return this.Cn.Wfe(b)}L9b(){return null}iJd(){}zam(b){return this.nXc(b)?this.Cn.Boa(b.Pa):(b=this.L9b(b))?new mc.a(b.Pp,b.cpEnd):null}Shg(b){if(2!==Eb.App.za.mode||!b)return!1;b=hy.a.kEa(b.toArray());
return!!Jj.ah.WT(b,14)}ntj(b,h){return 2===h||3===h&&!this.nXc(b)}Urj(b,h){return 3!==h||this.nXc(b)}X9k(){const b=[];b.push(Object.assign(new ah.a,{ExternalId:this.Ptl}));b.push(Object.assign(new ah.a,{ExternalId:this.Otl}));b.push(Object.assign(new ah.a,{ExternalId:this.Qtl}));return b}wdl(){const b=[];this.UGe&&b.push(Object.assign(new ah.a,{ExternalId:this.qhf}));return b}static get Jd(){return null!=Jj.uEg?Jj.uEg:Jj.uEg=Ma.a.instance.resolve("Box4.List.IListReader")}static get ah(){return An.ContextSetEditor.instance}static get rOm(){null==
Jj.oGe&&(Jj.oGe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("HyperlinkContextMenuOnEOPFixIsEnabled"):!1);return Jj.oGe}static get Z0c(){null==Jj.Hsb&&(Jj.Hsb=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return Jj.Hsb}static get Gua(){null==Jj.haa&&(Jj.haa=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Jj.haa}static rIc(b){return 32===v.AFrameworkApplication.va.processAction(b,
1)}static Jsj(){return 2===Eb.App.za.mode&&!!Eb.App.Hv.fJ&&Eb.App.Hv.fJ.cYc(Nb.a.p9d.toString())}static Lsj(b){if(1!==b.length||!b.Pa.el)return!1;b=Ad.GraphIterator.eb(b.Pa.node);b.zb(11);b.uc();return b.Jt(4)&&!Jj.Jd.vw(b).listType?!0:!1}static xsj(b){let h=!1,r=!1;if(!b)return{returnValue:!1,Yjb:h,WTc:r};if(Jj.Z0c)return Jj.fxo(b,r);if(!(b.Yw||Jj.rOm&&2===b.length&&b.Tc.contextId===yc.a.Vc))return{returnValue:!1,Yjb:h,WTc:r};b=b.Pa.clone();h=32===v.AFrameworkApplication.va.Nf(b,Nb.a.n6a,1,!0,null,
null);r=32===v.AFrameworkApplication.va.Nf(b,Nb.a.insertHyperlink,1,!0,null,null);return{returnValue:h||r,Yjb:h,WTc:r}}static fxo(b,h){let r;h=b.Pa.clone();r=Jj.Gua&&So.l(h);let B=!r&&32===v.AFrameworkApplication.va.Nf(h,Nb.a.n6a,1,!0,null,null);if(b.Yw||2===b.length&&b.Tc.contextId===yc.a.Vc)h=!r&&32===v.AFrameworkApplication.va.Nf(h,Nb.a.insertHyperlink,1,!0,null,null);else{h=!0;const P=b.length;for(let ca=0;ca<P;ca++){const ra=b.J(ca).clone();if(ra.contextId===yc.a.paragraph||ra.contextId===yc.a.Fd)(r=
Jj.Gua&&So.l(ra))||(h=32===v.AFrameworkApplication.va.Nf(ra,Nb.a.insertHyperlink,1,!0,null,null)&&h);else if(ra.contextId!==yc.a.Vc)return h=B=!1,{returnValue:!1,Yjb:B,WTc:h}}}return{returnValue:B||h,Yjb:B,WTc:h}}static ZSd(b){const h=Object.assign(new di.a,{ControlList:[]});for(const r of b)h.ControlList.push(Object.assign(new ah.a,{ExternalId:r}));return h}static nF(b){const h=[];for(const r of b)h.push(Object.assign(new ah.a,{ExternalId:r}));return h}}Jj.oGe=null;Jj.Hsb=null;Jj.haa=null;Jj.AZa=
[];Object(m.a)(Jj,"AEditSurfaceContextMenu",Bx.a,[]);var jG=c(602),HF=c(873),eD=c(1797);class WD{static I$l(b,h,r){h=[];r.ZGn.$5b(r.yNl(b),h);return h}static SVl(b,h,r){const B=[];if(r.iad(b))return B;ko.a.qRa()&&!Z.a.gt||r.jff.iJd(b,null,h,B);return B}static Vem(b,h,r){const B=[];r.SKc(b,h,B);return B}}Object(m.a)(WD,"ContextMenuSectionHelper",null,[]);class Yp{static FVl(b,h,r){h=[];r.$ml(b)&&h.push(Object.assign(new ah.a,{ExternalId:"ReviewDesignerSuggestion",LabelText:r.Ybm(b)}));return h}static N4l(){return Jj.rIc(Nb.a.mergeCells)?
Jj.nF(["MergeCells"]):Jj.rIc(Nb.a.eke)?Jj.nF(["SplitCells"]):[]}static Gim(b,h,r){h=[];if(!r.Gh.OIh(b))return h;b=r.Gh.Iji(b);h.push(Object.assign(new ah.a,{ExternalId:"AcceptChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,WordEditorIntl.WordEditorStrings.L_AcceptChange,b)}));h.push(Object.assign(new ah.a,{ExternalId:"RejectChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,WordEditorIntl.WordEditorStrings.L_RejectChange,
b)}));return h}static FQl(b,h,r){return v.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&b&&b.Pa&&b.Pa.node&&r.Ic&&r.Ic.SRi(b.Pa.node)?Jj.nF(["ShowCatchUpActivitiesForParagraph"]):[]}static zWl(b){return Wo.vwo(b)?Jj.nF(["Draw"]):Wo.Bsj(b)?Jj.nF(["EditIllustration"]):[]}static Clm(b){return Wo.Uyo(b)?[Object.assign(new wg.a,{ExternalId:"WrapTextMenu"})]:[]}static $Td(b,h,r){return r.qnl(b)?Jj.nF(["CreatePullQuote"]):[]}static getContentControls(b,h,r){return r.Zml()?Jj.nF(["RemoveContentControl"]):
[]}static oSl(){return Jj.nF(["NewComment"])}static ZQl(b){const h=[];!Wo.Rhg(b)&&Wo.thg(b)&&kc.SessionStatusManager.instance.cD&&b.bI&&h.push(Object.assign(new wg.a,{ExternalId:"ChangePictureMenu",QueryCommand:"QueryChangePictureHostButton"}));return h}static D1l(b,h,r){h=[];!Wo.Rhg(b)&&Wo.thg(b)&&kc.SessionStatusManager.instance.cD&&(t.ULS.sendTraceTag(39188235,1303,50,"Showing Insights context menu option"),b.bI&&!v.AFrameworkApplication.K.$("ChangePicturesIsEnabled")?h.push(...Jj.nF(["ChangePicture"])):
h.push(...r.ybl().ControlList),(b=Wo.abi())&&0<b.length&&(r=r.kfl(b),null!=r&&h.push(...r.ControlList)));return h}static wam(){return Jj.Jsj()?Jj.nF(["SetProofingLanguage"]):[]}static hcm(b,h,r){return r.LTm&&r.cyo(b)?Jj.nF(["Rewrite"]):[]}static m3l(b){return Jj.Lsj(b)?Jj.nF(["StartNewList","ContinueNumbering","SetNumberingValue"]):[]}static m9l(){return Wo.$sj()?Jj.nF(["ParagraphOptions"]):[]}static w0l(b){return Wo.Bsj(b)?Jj.nF(["EditIllustration"]):[]}static Mem(b){return Wo.Rhg(b)?Jj.nF(["ShowSmartLookupPane"]):
[]}static Rim(b){return Wo.Psj(b)?Jj.nF(["ModernTranslatorSplitButton"]):[]}static F_l(b,h,r){h=[];if(b.Yw){const B=b.Pa;if(B.contextId===yc.a.paragraph||B.contextId===yc.a.Uc||B.contextId===yc.a.Fd){b=b.Pa.node;if(!r.ij.Xb(b)||b.Gr||""===b.characterData)return h;r.Fgf.fSd(b)&&h.push(...Jj.nF(["CreateHeadingLink"]))}}return h}static getBookmark(b,h,r){h=[];if(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)&&b.Yw){const B=b.Pa;(xe.SelectionEditor.Ze(B)||
xe.SelectionEditor.d4a(B))&&r.GLk.DRd(b.Pa.node,b.Pa.cpBegin)&&(h.push(...Jj.nF(["DeleteBookmarkContextMenu"])),h.push(...Jj.nF(["EditBookmarkNameContextMenu"])))}return h}static Qha(b){let h=!1,r=!1;const B=[];({Yjb:h,WTc:r}=Jj.xsj(b)).returnValue&&(h?r?B.push(...Jj.nF(["EditHyperlink","SelectHyperlink","OpenHyperlink","CopyHyperlink","RemoveHyperlink"])):B.push(...Jj.nF(["OpenHyperlink"])):r&&(v.AFrameworkApplication.K.$("IsO365CommercialHost")||v.AFrameworkApplication.K.$("IsO365ConsumerHost")?
B.push(...Jj.nF(["InsertLinkFlyout"])):B.push(...Jj.nF(["InsertLink"]))));return B}static KRl(b,h,r){const B=[];if(!r.Urj(b,h))return B;2===Eb.App.za.mode?(B.push(...r.X9k()),B.push(...r.wdl()),3===h&&r.nXc(b)&&B.push(Object.assign(new ah.a,{ExternalId:"Delete"}))):(!v.AFrameworkApplication.cZ&&!v.AFrameworkApplication.EF||v.AFrameworkApplication.uEb)&&B.push(Object.assign(new ah.a,{ExternalId:"Copy"}));return B}static aof(b,h,r){return r.Shg(b)&&r.ntj(b,h)?Jj.nF(["EditTableAltText"]):[]}static ebi(b,
h,r){return r.jnl(b)?Jj.nF(["ShowIntentSuggestion"]):[]}static Mgm(b,h,r){const B=[];r.Shg(b)&&!r.ntj(b,h)&&(B.push(Object.assign(new wg.a,{ExternalId:"InsertTableMenu"})),B.push(Object.assign(new wg.a,{ExternalId:"DeleteTableMenu"})),B.push(Object.assign(new wg.a,{ExternalId:"SelectTableMenu"})));return B}static Sgm(b,h,r){return r.vyo(b)?Jj.nF(["UpdateTableOfContents"]):[]}static kXl(b){return Wo.Bwo(b)?Jj.nF(["ShowHideEquationToolsPane"]):[]}static LTl(b,h,r){return r.iwo?Jj.nF(["OpenCopilotCompose"]):
[]}}Object(m.a)(Yp,"ContextMenuSectionItemHelper",null,[]);class Wo extends Jj{get ij(){return this.gb}get Fgf(){return this.gXa}constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc,Uc,od,Od,ze,de,ee=!1,je=null,ue=null,Qf,Jg,Ql,Fm){super(b,h,r,ee,void 0,je,Qf);this.gLd=Fm;this.WOe=this.lQ=null;this.AYg=!1;this.Jfe=new Map;this.lD={};this.Omb={};this.ga=b;this.K=B;this.Gh=P;this.OW=Qa;this.NI=tb;this.Un=Mb;this.mok=!!je;this.jff=Zb;this.ZGn=jc;this.rSg=Od;this.pla=ze;this.GLk=de;this.gXa=Ql;this.gb=Jg;od&&
od.execute(Kp=>{this.afh=Kp});Gc&&Gc.execute(Kp=>{this.WOe=Kp});this.Ic=ra;this.Zu=Uc;ue&&ue.execute(Kp=>{this.lQ=Kp});this.Fzm();this.WEn();this.cCl();this.VEn()}get qhf(){return this.mok?Ba.a.B$d:super.qhf}zuo(){const b=ub.App.nn.jb.rc.mb.ib.lb;return this.iad(b)&&2!==this.Bfi(b).errorType}v0(b,h){return super.v0(b,h)||Wo.$sj()||Jj.Lsj(b)||Wo.thg(b)||Wo.Psj(b)}qcl(b,h,r){const B=[];let P=null;try{P=ub.App.nn.jb.rc.mb.ib.lb}catch(ca){t.ULS.sendTraceTag(576481226,341,15,"Selection was not initialized in time for ContextMenu Population");
return}this.KEn(P,h,B,this.zTl(P));b.MenuSectionList.push(...B);this.ilo(b);!r&&this.afh&&this.afh.QIn(b.MenuTargetDescriptor.menuTargetType,B)}zTl(b){return Jj.rIc(Nb.a.mergeCells)?iu.xvg:b.EWc?iu.Wtg:b.bI?iu.Mug:b.Rdc()?iu.Rtg:Wo.EEf&&b.l4a?iu.Ltg:iu.aug}zbl(b){b=Wo.Nbl(b);return Object.assign(new ah.a,{ExternalId:"SmartLookupContextMenu",LabelText:b})}lfl(b){return(b=Wo.$Nj(b))?Object.assign(new ah.a,{ExternalId:"SmartLookupSynonyms",LabelText:b}):null}ybl(){const b=Object.assign(new di.a,{ControlList:[]}),
h=Wo.abi();b.ControlList.push(this.zbl(h));return b}kfl(b){const h=Object.assign(new di.a,{ControlList:[]});if(b&&0<b.length){b=this.lfl(b);if(null==b)return null;h.ControlList.push(b)}return h}lec(b){return b.bI||2<b.length||!b.length||2===b.length&&!xe.SelectionEditor.Lk(b.Tc)||1===b.length&&xe.SelectionEditor.Lk(b.Tc)?!1:this.XIf(b.Pa)}XIf(b){return ke.ParagraphReader.Xb(b.node)?""!==ke.ParagraphReader.text(b.node).trim():!1}vyo(b){var h=Ad.GraphIterator.eb(b.Pa.node);h=Object(Ra.a)(jG.a,h.currentNode);
return b.bI?!1:!!h&&h.Gr}cCl(){v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.Zu.execute(b=>{b.isFeatureEnabled(HF.a.cRi,!1).then(h=>{h||t.ULS.sendTraceTag(592995265,341,50,"Rewrite license missing, skip creating context menu item");this.AYg=h;return null})}):t.ULS.sendTraceTag(592995266,341,50,"Rewrite flight not enabled, skip creating context menu item")}get LTm(){v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");
return this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1)?this.AYg:!1}cyo(b){if(!this.lec(b)||b.l4a||b.Rdc())return!1;b=b.Pa;if(ke.ParagraphReader.vm(b)||xe.SelectionEditor.Ze(b)||xe.SelectionEditor.vl(b)){b=this.NI.zFa(b);b||(b=v.AFrameworkApplication.lcid);switch(b&1023){case 9:return!0;case 10:if(this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))return!0}return!1}}jnl(b){if(1!==
b.length||Z.a.gt)return!1;const h=ko.a.qRa();if(h&&this.zuo()||rs.QB()&&!this.w$a.YJh(b.Pa))return!1;const r=Wo.Zb.isFeatureEnabled(63);return b.J(0).contextId===yc.a.Uc&&(h||r)&&0<this.Un.ZQc(b.J(0),0).count||h&&this.L9b(b)?!0:!1}$ml(b){return 1===b.length&&this.rSg.GA(b.Pa.node).uia}Ybm(b){var h,r;const B=null===(h=this.gLd)||void 0===h?void 0:h.CU(null===(r=null===b||void 0===b?void 0:b.Pa)||void 0===r?void 0:r.node);return eD.a.Cji(B)}get Lv(){return null!=this.kyg?this.kyg:this.kyg=Ma.a.instance.Oa("WordEditor.Designer.IDesignerTaskPane")}get S7k(){return null!=
this.Txg?this.Txg:this.Txg=Ma.a.instance.Oa("WordEditor.Copilot.Compose.CopilotComposeIndicatorActor")}qnl(b){if(!this.pla.ixi()||!this.Lv||this.Lv.isVisible||!(1===b.length||2===b.length&&xe.SelectionEditor.Lk(b.Tc))||b.Vlb||!xe.SelectionEditor.vl(b.Pa)&&b.Pa.contextId!==yc.a.paragraph||b.HCi()||this.rSg.GA(b.Pa.node).uia)return!1;const h=ke.ParagraphReader.text(b.Pa.node),r=b.Pa.contextId===yc.a.paragraph?0:b.Pa.cpBegin,B=b.Pa.contextId===yc.a.paragraph?h.length:b.Pa.cpEnd-r;return 1>B||1500<B||
F.a.af(F.a.jza(h.substr(r,B)))||1!=as.a.Tib(b.Pa.node)?!1:!0}Zml(){return 32==this.ga.processAction(Nb.a.F6c,1)}L9b(b){return this.jff.L9b(b)}iJd(b,h,r,B=null){this.iad(b)||this.jff.iJd(b,h,r,B)}yNl(b){return this.WOe?this.WOe.zNl(b):[]}ilo(b){const h=this.lQ?this.lQ.contentType:"Unknown";b.MenuTargetDescriptor=Object.assign(new dD,{menuTargetType:h})}static get Zb(){return null!=Wo.Ezg?Wo.Ezg:Wo.Ezg=Ma.a.instance.resolve("Box4.IFeatureHelper")}static get EEf(){if(null!=Wo.vDg)var b=Wo.vDg;else{var h;
b=null===(h=v.AFrameworkApplication.K)||void 0===h?void 0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddDrawCommandInContextMenu",!1);b=Wo.vDg=b}return b}static thg(b){return v.AFrameworkApplication.E0&&!b.l4a&&Ma.a.instance.resolve("Box4.Insights.IBox4InsightsSelection").nXm()}static aUd(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=F.a.Kz(b,h)?h-1:h),b=b.length>h?b.substr(0,h).trim()+"...":b);return b}static Nbl(b){let h=WordEditorIntl.WordEditorStrings.L_ContextMenuSmartLookup;
(b=Wo.aUd(b))&&0<b.length&&(h=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSmartLookup,b));return h}static $Nj(b){b=Wo.aUd(b);return null!=b&&0<b.length?String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSynonyms,b):null}static abi(){const b=(new Vq.a).getSelectedText();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static Bsj(b){const h=Wo.Zb.isFeatureEnabled(50);return!b.MJc&&h&&!Z.a.gt&&(b.l4a||h&&!Wo.EEf&&b.bI)}static vwo(b){const h=Wo.Zb.isFeatureEnabled(50);
return!b.MJc&&h&&!Z.a.gt&&Wo.EEf&&b.bI}static Rhg(b){return v.AFrameworkApplication.K.$("WordEditorSmartLookupIsEnabled")&&!b.Rdc()}static Psj(b){return v.AFrameworkApplication.K.$("LanguageTranslationIsEnabled")&&!b.l4a&&!b.Rdc()}static Bwo(b){return b.ICi()&&v.AFrameworkApplication.ua.Kb.VXc}static $sj(){return 2===ub.App.nn.mode}static Uyo(b){return b.bI}get iwo(){var b,h;return null!==(h=null===(b=this.S7k)||void 0===b?void 0:b.SOm)&&void 0!==h?h:!1}KEn(b,h,r,B){this.Omb[B].forEach(P=>{const ca=
Object.assign(new di.a,{ControlList:[]}),ra=ca.ControlList;P.forEach(Qa=>{Qa instanceof Un?r.push(...this.Jfe.get(Qa)(b,h,this)):ra.push(...this.lD[Qa](b,h,this))});(null===ra||void 0===ra?0:ra.length)&&r.push(ca)})}VEn(){this.Jfe.set(Un.UTb,WD.I$l);this.Jfe.set(Un.Mqe,WD.SVl);this.Jfe.set(Un.Bre,WD.Vem)}WEn(){this.lD[Ig.xsb]=Yp.KRl;this.lD[Ig.Fre]=Yp.Mgm;this.lD[Ig.Gre]=Yp.Sgm;this.lD[Ig.Lqe]=Yp.FVl;this.lD[Ig.fre]=Yp.N4l;this.lD[Ig.xqe]=Yp.aof;this.lD[Ig.Yqe]=Yp.D1l;this.lD[Ig.Ffd]=Yp.ebi;this.lD[Ig.Xqe]=
Yp.w0l;this.lD[Ig.Are]=Yp.Mem;this.lD[Ig.Ire]=Yp.Rim;this.lD[Ig.mre]=Yp.wam;this.lD[Ig.pre]=Yp.hcm;this.lD[Ig.Hfd]=Yp.m3l;this.lD[Ig.Kfd]=Yp.m9l;this.lD[Ig.nre]=Yp.$Td;this.lD[Ig.rfd]=Yp.getContentControls;this.lD[Ig.ese]=Yp.Clm;this.lD[Ig.Nqe]=Yp.zWl;this.lD[Ig.Eqe]=Yp.ZQl;this.lD[Ig.Hre]=Yp.Gim;this.lD[Ig.Dqe]=Yp.FQl;this.lD[Ig.pfd]=Yp.getBookmark;this.lD[Ig.Tqe]=Yp.F_l;this.lD[Ig.Vqe]=Yp.Qha;this.lD[Ig.vsb]=Yp.oSl;this.lD[Ig.Ffd]=Yp.ebi;this.lD[Ig.Oqe]=Yp.kXl;this.lD[Ig.ytg]=Yp.LTl}Fzm(){const b=
[Ig.fre,Ig.xqe,Ig.Fre];this.Omb[iu.xvg]=[[Ig.xsb],b,[Ig.vsb],[Un.UTb],[Ig.rfd]];this.Omb[iu.Mug]=[[Ig.xsb],[Ig.Eqe,Ig.Nqe,Ig.ese],b,[Ig.vsb],[Un.UTb]];this.Omb[iu.Rtg]=[[Ig.Oqe],[Ig.Hfd,Ig.Kfd],[Ig.pfd,Ig.vsb],[Un.UTb]];this.Omb[iu.aug]=[[Ig.Ffd],[Ig.Lqe],[Un.Bre],[Un.Mqe],[Ig.xsb],[Ig.Yqe,Ig.Xqe,Ig.Are,Ig.Ire],[Ig.mre,Ig.pre,Ig.Kfd],[Ig.ytg],[Ig.Hfd],b,[Ig.rfd],[Ig.Vqe,Ig.pfd,Ig.Tqe,Ig.vsb],[Ig.nre],[Ig.Hre],[Ig.Dqe],[Ig.Gre],[Un.UTb]];this.Omb[iu.Wtg]=[[Ig.xsb],[Ig.vsb]];this.Omb[iu.Ltg]=[[Ig.xsb],
[Ig.Xqe]];this.Omb[iu.UPj]=[[Ig.Ffd],[Ig.Lqe],[Un.Bre],[Un.Mqe],[Ig.xsb],[Ig.Eqe],[Ig.Nqe],[Ig.ese],[Ig.Yqe],[Ig.Are],[Ig.Ire],[Ig.mre],[Ig.pre],[Ig.Oqe],[Ig.Hfd],[Ig.Kfd],[Ig.Vqe],[Ig.fre],[Ig.xqe],[Ig.Fre],[Ig.pfd],[Ig.Tqe],[Ig.vsb],[Ig.nre],[Ig.rfd],[Ig.Hre],[Ig.Dqe],[Ig.Gre],[Un.UTb]]}}Object(m.a)(Wo,"EditSurfaceContextMenu",Jj,[]);var iu;(function(b){b[b.xvg=1]="TABLE_MULTI_CELL";b[b.aug=2]="GENERIC";b[b.Mug=3]="PICTURE";b[b.Rtg=4]="EQUATION";b[b.UPj=5]="LEGACY";b[b.Wtg=6]="FLUID";b[b.Ltg=7]=
"DRAWING"})(iu||(iu={}));Object(m.b)("Scenarios",iu);class Un{}Un.UTb=new Un;Un.Mqe=new Un;Un.Bre=new Un;Object(m.a)(Un,"Sections",null,[]);var Ig;(function(b){b[b.Ffd=1]="INTENT_SUGGESTION";b[b.xsb=2]="ESSENTIALS";b[b.Yqe=3]="INSIGHT";b[b.Xqe=4]="ILLUSTRATION";b[b.Are=5]="SMART_LOOKUP";b[b.Ire=6]="TRANSLATE";b[b.mre=7]="PROOFING";b[b.pre=8]="REWRITE_SUGGESTIONS";b[b.Hfd=9]="LISTS";b[b.Kfd=10]="PARAGRAPH_OPTIONS";b[b.fre=11]="MERGE_SPLIT_CELLS";b[b.xqe=12]="ALT_TEXT";b[b.Vqe=13]="HYPERLINK";b[b.pfd=
14]="BOOKMARK";b[b.Tqe=15]="HEADING_LINK";b[b.vsb=16]="COMMENT";b[b.nre=17]="PULL_QUOTE";b[b.ese=18]="WRAP_TEXT";b[b.Nqe=19]="DRAW";b[b.Hre=20]="TRACK_CHANGE";b[b.Dqe=21]="CATCHUP_ACTIVITIES";b[b.Gre=22]="TABLE_OF_CONTENTS";b[b.Lqe=23]="DESIGNER_REVIEW";b[b.Fre=24]="TABLE_ITEMS";b[b.Eqe=25]="CHANGE_PICTURE";b[b.Oqe=26]="EQUATION_TOOLS";b[b.rfd=27]="CONTENT_CONTROL";b[b.ytg=28]="COPILOT_COMPOSE"})(Ig||(Ig={}));Object(m.b)("SectionItem",Ig);class gD extends Bx.a{constructor(b,h,r){super();this.Cl=null;
this.lae=(B,P,ca,ra,Qa)=>{if(1===ca)return 32;B=[];P=[];this.Auo()&&P.push("InsertTabStopMenuSplitButton");this.kuo()&&P.push("ClearAllTabStops");P.push("HideRuler");B.push(gD.ZSd(P));P=Object.assign(new $f.a,{ExternalId:"RulerContextMenu",UpdateDynamically:!0,MenuSectionList:[]});P.MenuSectionList.push(...B);Qa.MenuItems=P;return 32};this.ga=b;this.kn=h;this.pz=r;this.Tb()}get Cbb(){return document.getElementById("WACHorizontalRuler")}get UN(){return this.kn&&this.kn.instance?this.kn.instance.nj:
1}get target(){return this.Cl}show(b,h){this.Cl=b;Bx.a.vqb("RulerContextMenu",b,h);t.ULS.sendTraceTag(592307397,3014,50,"Ruler Context menu invoked.");b=new Map;b.set("Command","Show");b.set("Source",gD.yP);b.set("Response","Ruler Context menu invoked.");va.Health.instance.recordKpiUsage(gD.kpiName,1,gD.S8,b)}Abm(){var b=0,h=(this.target.x-Qd.a.Eof(this.Cbb))/this.UN;h=xg.a.Wy(h,0);var r={},B=this.pz.cFb,P=Ad.GraphIterator.eb(B);P.qd();if(!Rh.TableReader.lx(P))return 32===this.ga.Qb(Nb.a.cIa,2,r)&&
(b=r.marginLeft),h-b;b={};P={};r=this.ga.Qb(Nb.a.C5c,2,b);var ca=this.ga.Qb(Nb.a.xOb,2,P);if(32!==r||32!==ca)return t.ULS.sendTraceTag(559252943,3014,15,"Unable to read table properties for Ruler Context Menu"),h;b=b.ColumnWidths;ca=P.TablePosition;if(!ca||!b||0>=b.length)return t.ULS.sendTraceTag(559252944,3014,15,"Queried table properties are null or do not exist"),h;r=0;P=Ad.GraphIterator.eb(B);P.zb(14)&&(P.jd(16),r=ou.a(P,!0));B=ca.x/this.UN;for(P=0;P<r;P++)B+=b[P];return h-B}Tb(){this.ga.fb(qb.a.lae,
yc.a.application,this.lae,96)}Auo(){var b={},h={},r=this.ga.Qb(Nb.a.cIa,2,b),B=this.ga.Qb(Nb.a.U6a,2,h);if(32===r&&32===B){B=h.Lt;r=xg.a.Qi(B.jpa,0);B=1===B.specialIndentType?xg.a.Qi(B.OB,0):xg.a.Qi(B.OB-B.sea,0);const P=xg.a.Qi(b.marginLeft,0);b=xg.a.Qi(b.marginRight,0);const ca=Qd.a.Eof(this.Cbb),ra=Qd.a.c6h(this.Cbb);h.isRtl?(h=ca+this.UN*Math.max(b,b+r),r=ra-this.UN*Math.max(P,P+B)):(h=ca+this.UN*Math.max(P,P+B),r=ra-this.UN*Math.max(b,b+r));if(this.target.x>=h&&this.target.x<=r)return!0}return!1}kuo(){var b=
{};if(32!==this.ga.Qb(qb.a.kOb,2,b)||!b)return!1;b=b.customTabs;return!b||0>=b.length?!1:!0}static ZSd(b){const h=Object.assign(new di.a,{ControlList:[]});for(const r of b)h.ControlList.push(Object.assign(new ah.a,{ExternalId:r}));return h}}gD.S8="wwaengidc";gD.kpiName="WordRuler";gD.yP="RulerContextMenu";Object(m.a)(gD,"RulerContextMenu",Bx.a,[258]);let BB;class Qq{static get qc(){return null!=Qq.UJg?Qq.UJg:Qq.UJg=Ma.a.instance.resolve("Box4.Styles.IWACStyleReader")}static get uE(){return null!=
Qq.MJg?Qq.MJg:Qq.MJg=Ma.a.instance.resolve("Box4.Styles.IWACStyleEditor")}static get Bj(){return null!=Qq.DBg?Qq.DBg:Qq.DBg=Ma.a.instance.resolve("Box4.IInsertionPointFormatting")}static m5i(b,h,r){if(1===h)return(b?Qq.mTk(r):Qq.KSk(r))?32:8;(b=Qq.Ofm(b,r))&&Qq.DFk(b,r);return 32}static DFk(b,h){const r=new cg.GraphTransaction(15);r.Db(h);Qq.Bj.p7a();Qq.uE.aK(b,h,!1);r.dispose()}static mTk(b){b=Qq.qc.So(b);return!!b&&Qq.qc.Ag(b)!==Hl.StyleReader.wordStyleIdHeading1}static KSk(b){b=Qq.qc.So(b);return!!b&&
Qq.qc.Ag(b)!==Hl.StyleReader.KTb}static Ofm(b,h){const r=Qq.qc.So(h);return r?Qq.qc.JB(h).oj(Qq.Mfm(b,Qq.qc.Ag(r))):null}static Mfm(b,h){h=Qq.headingsList.indexOf(h);b=b?h-1:h+1;return 0<=b&&b<Qq.headingsList.count?Qq.headingsList.J(b):null}}Qq.headingsList=(BB=new mb.a,BB.add(Hl.StyleReader.wordStyleIdHeading1),BB.add(Hl.StyleReader.wordStyleIdHeading2),BB.add(Hl.StyleReader.wordStyleIdHeading3),BB.add(Hl.StyleReader.HTb),BB.add(Hl.StyleReader.ITb),BB.add(Hl.StyleReader.JTb),BB.add(Hl.StyleReader.Apc),
BB.add(Hl.StyleReader.Bpc),BB.add(Hl.StyleReader.KTb),BB);Object(m.a)(Qq,"NavigationPaneEditor",null,[]);class IF extends Bx.a{constructor(){super();this.l4=null;this.cae=(b,h,r,B,P)=>{if(1===r)return 32;b=new Sys.StringBuilder;b.append(String.format('<Menu Id="{0}">',"mnuNavPaneWordEditor"));b.append('<MenuSection Id="msWordEditorHeadings" DisplayMode="Menu16"><Controls>');b.append(Bx.a.T3h("promoteHeading",qb.a.Sae,"LeftArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_PromoteHeadingText));b.append(Bx.a.T3h("demoteHeading",
qb.a.bLd,"RightArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_DemoteHeadingText));b.append("</Controls></MenuSection></Menu>");P.PopulationXML=b.toString();return 32};this.Sae=(b,h,r)=>Qq.m5i(!0,r,this.l4.Cb);this.bLd=(b,h,r)=>Qq.m5i(!1,r,this.l4.Cb)}show(b){IF.Zh||(this.M5b(),IF.Zh=!0);Bx.a.showContextMenu("mnuNavPaneWordEditor",b)}M5b(){const b={PopulateDynamically:"true",PopulateOnlyOnce:"false"};b.PopulateQueryCommand=""+qb.a.Z2i;b.Command=""+fb.a.Rma;Bx.a.t$k(b);v.AFrameworkApplication.va.ra(qb.a.Z2i,
yc.a.application,this.cae);v.AFrameworkApplication.va.ra(qb.a.Sae,yc.a.view,this.Sae);v.AFrameworkApplication.va.ra(qb.a.bLd,yc.a.view,this.bLd)}}IF.Zh=!1;Object(m.a)(IF,"WordEditorNavigationPaneContextMenu",Bx.a,[257]);var Cx=c(282),wC=c(1495),iM=c(453),jM=c(757),kG=c(1209),$G=c(1723),aH=c(1017),xC=c(702);class lG{constructor(){this.t9=this.fzi=!1;this.eSb=xC.a.none;this.yw=0;this.N9a=1}}Object(m.a)(lG,"WrapTextPropertiesData",null,[]);class Wl extends kG.a{constructor(b=null){super(b);this.gfh=
new $G.a;this.Fmh=new lG;this.Iih=new aH.a;this.nDe=!1;this.gqi=h=>{const r=new Cx.a;r.TEa=!0;r.qM=h;return r};this.F1=()=>{const h=new Cx.a;h.OHb=!1;h.qM=Nb.a.cIa;h.vd=this.gfh;h.Edc=!0;h.zia=!0;return h};this.k6i=()=>{const h=new Cx.a;h.OHb=this.nDe;this.nDe=!0;h.qM=Nb.a.V6a;h.vd=this.Iih;h.Edc=!0;h.zia=!0;return h};this.Ued=()=>{const h=new Cx.a;h.OHb=!1;h.qM=qb.a.Wic;h.vd=this.Fmh;h.Edc=!0;h.zia=!0;return h};this.gXd=(h,r)=>{const B=new Cx.a;B.vd=new fd.DictionaryPropertySet;switch(h){case qb.a.nUc:B.vd.setValue(Yc.a.rkb,
r[Pi.a.Number]);break;case qb.a.gUc:B.vd.setValue(Yc.a.okb,r[Pi.a.Number]);break;case qb.a.hUc:B.vd.setValue(Yc.a.pkb,r[Pi.a.Number]);break;case qb.a.iUc:B.vd.setValue(Yc.a.qkb,r[Pi.a.Number])}return B};this.SLn=()=>{const h=new Cx.a;h.vd=new fd.DictionaryPropertySet;h.zia=!0;return h}}initialize(){super.initialize();this.nd.Z(qb.a.qKf,wC.a.Ckb);this.nd.Z(qb.a.vKf,wC.a.Ckb);this.nd.Z(qb.a.xKf,wC.a.Ckb);this.nd.Z(qb.a.E4f,Wl.rTa);this.nd.Z(qb.a.v5c,Wl.rTa);this.nd.Z(qb.a.x4f,Wl.rTa);this.nd.Z(fb.a.AOb,
Wl.rTa);this.nd.Z(Nb.a.Dbe,this.F1);this.nd.Z(Nb.a.Cbe,this.F1);this.nd.Z(Nb.a.Bbe,this.F1);this.nd.Z(Nb.a.Fbe,this.F1);this.nd.Z(Nb.a.Ebe,this.F1);this.nd.Z(Nb.a.Abe,this.F1);this.nd.Z(Nb.a.Mbe,this.F1);this.nd.Z(Nb.a.Lbe,this.F1);this.nd.Z(Nb.a.Kbe,this.F1);this.nd.Z(Nb.a.Hbe,this.F1);this.nd.Z(Nb.a.Ibe,this.F1);this.nd.Z(Nb.a.Jbe,this.F1);this.nd.Z(Nb.a.R4f,this.F1);this.nd.Z(Nb.a.Q4f,this.F1);this.nd.Z(Nb.a.g4f,this.F1);this.nd.Z(Nb.a.i4f,this.F1);this.nd.Z(Nb.a.h4f,this.F1);this.nd.Z(Nb.a.f4f,
this.F1);this.nd.Z(Nb.a.Y7a,Wl.M$m);this.nd.Z(Nb.a.vUa,Wl.xzn);this.nd.Z(Nb.a.Ppb,Wl.f1k);this.nd.Z(Nb.a.Xma,Wl.rTa);this.nd.Z(Nb.a.JNb,Wl.rTa);this.nd.Z(Nb.a.uTa,Wl.rTa);this.nd.Z(Nb.a.Rua,Wl.rTa);this.nd.Z(Nb.a.$ya,Wl.rTa);this.nd.Z(qb.a.e4c,Wl.rTa);this.nd.Z(qb.a.sPd,wC.a.hmf);this.nd.Z(qb.a.tPd,this.B4h);this.Zm.Z(qb.a.c4c,wC.a.ePa);this.Zm.Z(qb.a.d4c,wC.a.ePa);this.nd.Z(Nb.a.AQb,wC.a.O1a);this.nd.Z(Nb.a.zQb,wC.a.O1a);this.nd.Z(Nb.a.dqb,wC.a.O1a);this.nd.Z(Nb.a.c5f,this.FF);this.nd.Z(Nb.a.a5f,
this.FF);this.nd.Z(Nb.a.b5f,this.FF);this.nd.Z(Nb.a.JL,Wl.kKn);this.Zm.Z(qb.a.nce,Wl.A6c);this.Zm.Z(qb.a.oce,Wl.A6c);this.Zm.Z(qb.a.pce,Wl.A6c);this.Zm.Z(qb.a.lce,Wl.A6c);this.Zm.Z(qb.a.mce,Wl.A6c);this.nd.Z(qb.a.nce,this.Ued);this.nd.Z(qb.a.oce,this.Ued);this.nd.Z(qb.a.pce,this.Ued);this.nd.Z(qb.a.lce,this.Ued);this.nd.Z(qb.a.mce,this.Ued);this.nd.Z(qb.a.jqe,Wl.Jpc);this.nd.Z(qb.a.kqe,Wl.Jpc);this.nd.Z(qb.a.lqe,Wl.Jpc);this.nd.Z(qb.a.mqe,Wl.Jpc);this.nd.Z(qb.a.nqe,Wl.Jpc);this.nd.Z(qb.a.oqe,Wl.Jpc);
this.nd.Z(qb.a.WIa,Wl.V8b);this.nd.Z(qb.a.qsj,Wl.V8b);this.nd.Z(qb.a.rsj,Wl.V8b);this.nd.Z(qb.a.Zie,Wl.V8b);this.nd.Z(qb.a.$ie,Wl.V8b);this.nd.Z(qb.a.V$c,Wl.V8b);this.nd.Z(qb.a.Pob,this.SLn);this.nd.Z(qb.a.f5c,Wl.bQd);this.nd.Z(qb.a.tbe,Wl.bQd);this.nd.Z(qb.a.ube,Wl.bQd);this.nd.Z(qb.a.vbe,Wl.bQd);this.nd.Z(qb.a.nUc,this.gXd);this.nd.Z(qb.a.gUc,this.gXd);this.nd.Z(qb.a.hUc,this.gXd);this.nd.Z(qb.a.iUc,this.gXd);this.nd.Z(Nb.a.cpa,this.gqi);this.nd.Z(Nb.a.bEb,this.gqi);this.nd.Z(qb.a.Nob,Wl.Nob);this.nd.Z(qb.a.hje,
wC.a.O1a);this.nd.Z(Nb.a.g5f,this.k6i);this.nd.Z(Nb.a.h5f,this.k6i)}clearCache(){super.clearCache();this.nDe=!1;this.gfh=new $G.a;this.Fmh=new lG;this.Iih=new aH.a}Ppf(){const b=super.Ppf();b.pDa=Wl.pDa;b.K_a=Wl.K_a;return b}static get Wyn(){return null!=Wl.sFg?Wl.sFg:Wl.sFg=Ma.a.instance.Oa("WordEditor.IPageCommandStringBuilder")}static get Wz(){Wl.iua||(Wl.iua=Ma.a.instance.Oa("WordEditor.ITableBorderManager"));return Wl.iua}static rTa(b,h){b=new Cx.a;b.vd=h;return b}static H9c(b,h,r){h[qg.a.Description]=
b?b.J$m(r):null}static pDa(b,h){const r=Object(Ra.a)($G.a,b.vd),B=Object(Ra.a)(iM.a,b.vd),P=Object(Ra.a)(lG,b.vd),ca=Object(Ra.a)(aH.a,b.vd);let ra=!0;const Qa=Wl.Wyn;switch(b.dob){default:ra=kG.a.pDa(b,h);break;case Nb.a.Dbe:h[ll.a.Icon]=r.Jxa?"PageMarginsLandscapeNormal_48":"PageMarginsPortraitNormal_48";h[qg.a.On]=!r.xLb;Wl.H9c(Qa,h,0);break;case Nb.a.Cbe:h[ll.a.Icon]=r.Jxa?"PageMarginsLandscapeNarrow_48":"PageMarginsPortraitNarrow_48";h[qg.a.On]=1===r.xLb;Wl.H9c(Qa,h,1);break;case Nb.a.Bbe:h[ll.a.Icon]=
r.Jxa?"PageMarginsLandscapeModerate_48":"PageMarginsPortraitModerate_48";h[qg.a.On]=2===r.xLb;Wl.H9c(Qa,h,2);break;case Nb.a.Fbe:h[ll.a.Icon]=r.Jxa?"PageMarginsLandscapeWide_48":"PageMarginsPortraitWide_48";h[qg.a.On]=3===r.xLb;Wl.H9c(Qa,h,3);break;case Nb.a.Ebe:h[ll.a.Icon]=r.Jxa?"PageMarginsLandscapeOffice2003_48":"PageMarginsPortraitOffice2003_48";h[qg.a.On]=4===r.xLb;Wl.H9c(Qa,h,4);break;case Nb.a.Abe:h[ll.a.Icon]=r.Jxa?"PageMarginsLandscapeCustom_48":"PageMarginsPortraitCustom_48";h[qg.a.On]=
5===r.xLb;break;case Nb.a.Mbe:h[qg.a.On]=!r.gNb;h[qg.a.Description]=Qa?Qa.k3c(0):null;break;case Nb.a.Lbe:h[qg.a.On]=1===r.gNb;h[qg.a.Description]=Qa?Qa.k3c(1):null;break;case Nb.a.Kbe:h[qg.a.On]=2===r.gNb;h[qg.a.Description]=Qa?Qa.k3c(2):null;break;case Nb.a.Hbe:h[qg.a.On]=3===r.gNb;h[qg.a.Description]=Qa?Qa.k3c(3):null;break;case Nb.a.Ibe:h[qg.a.On]=4===r.gNb;h[qg.a.Description]=Qa?Qa.k3c(4):null;break;case Nb.a.Jbe:h[qg.a.On]=5===r.gNb;break;case Nb.a.R4f:h[qg.a.On]=!r.Jxa;break;case Nb.a.Q4f:h[qg.a.On]=
r.Jxa;break;case Nb.a.g4f:h[qg.a.On]=1===r.jJc;break;case Nb.a.i4f:h[qg.a.On]=2===r.jJc;break;case Nb.a.h4f:h[qg.a.On]=3===r.jJc;break;case Nb.a.f4f:h[qg.a.On]=0===r.jJc;break;case Nb.a.c5f:h[qg.a.On]=B.Lt?!B.Lt.specialIndentType:!1;break;case Nb.a.a5f:h[qg.a.On]=B.Lt?1===B.Lt.specialIndentType:!1;h[pj.a.Image16by16Class]=B.isRtl?we.getImageClass("IndentSpecialFirstLineRTL_Server_16x16x32"):we.getImageClass("IndentSpecialFirstLine_Server_16x16x32");break;case Nb.a.b5f:h[qg.a.On]=B.Lt?2===B.Lt.specialIndentType:
!1;h[pj.a.Image16by16Class]=B.isRtl?we.getImageClass("IndentSpecialHangingRTL_Server_16x16x32"):we.getImageClass("IndentSpecialHanging_Server_16x16x32");break;case qb.a.nce:h[qg.a.On]=1===P.N9a;break;case qb.a.oce:h[qg.a.On]=8===P.N9a;break;case qb.a.pce:h[qg.a.On]=9===P.N9a;break;case qb.a.lce:h[qg.a.On]=3===P.N9a;break;case qb.a.mce:h[qg.a.On]=4===P.N9a;break;case qb.a.Pob:h[qg.a.On]=b.vd.ja(Yc.a.Fxa,!1);break;case qb.a.Nob:h[dh.a.IsFreeForm]=!0;h[dh.a.Value]=b.vd[$h.a.Value];break;case Nb.a.g5f:h[Ui.a.On]=
Wl.Wz.$5h(h.MenuItemId)===ca.lineStyle;break;case Nb.a.h5f:h[Ui.a.On]=Wl.Wz.a6h(h.MenuItemId)===ca.a_c}return ra}static M$m(b,h){b=5;switch(h.MenuItemId){case "buttonMarginsNormal":b=0;break;case "buttonMarginsNarrow":b=1;break;case "buttonMarginsModerate":b=2;break;case "buttonMarginsWide":b=3;break;case "buttonMarginsOffice2003":b=4}h=new Cx.a;h.vd=b;return h}static xzn(b,h){b=5;switch(h.MenuItemId){case "buttonSizeLetter":b=0;break;case "buttonSizeLegal":b=1;break;case "buttonSizeExecutive":b=
2;break;case "buttonSizeA4":b=3;break;case "buttonSizeA5":b=4}h=new Cx.a;h.vd=b;return h}static f1k(b,h){b=0;switch(h.MenuItemId){case "buttonOneColumn":b=1;break;case "buttonTwoColumns":b=2;break;case "buttonThreeColumns":b=3}h=new Cx.a;h.vd=b;return h}static Nob(){const b=new Cx.a;b.qM=qb.a.Nob;b.vd={};b.zia=!0;b.Edc=!0;return b}static Jpc(b,h){const r=new Cx.a;r.vd=new fd.DictionaryPropertySet;let B=1;switch(b){case qb.a.mqe:B=1;break;case qb.a.nqe:B=8;break;case qb.a.oqe:B=9;break;case qb.a.kqe:B=
3;break;case qb.a.lqe:B=4}r.vd.setValue(Yc.a.N9a,B);r.vd.setValue(Yc.a.cJa,h[qg.a.SourceControlId]);return r}static V8b(b,h,r){b=new Cx.a;b.vd=r.InvocationMethod;return b}static kKn(b,h){b=new Cx.a;b.vd=h;return b}static A6c(){const b=new jM.a;b.qM=qb.a.Wic;return b}static bQd(){const b=new Cx.a;b.vd=new fd.DictionaryPropertySet;b.TXc=!0;return b}static K_a(b,h){let r=!0;switch(b.dob){case qb.a.f5c:b=b.vd.ja(Yc.a.rkb,0);h[Pi.a.Number]=b;h[Pi.a.UnitType]=7;break;case qb.a.tbe:b=b.vd.ja(Yc.a.okb,0);
h[Pi.a.Number]=b;h[Pi.a.UnitType]=7;break;case qb.a.ube:b=b.vd.ja(Yc.a.pkb,0);h[Pi.a.Number]=b;h[Pi.a.UnitType]=7;break;case qb.a.vbe:b=b.vd.ja(Yc.a.qkb,0);h[Pi.a.Number]=b;h[Pi.a.UnitType]=7;break;default:r=kG.a.K_a(b,h)}return r}}Wl.iua=null;Object(m.a)(Wl,"CuiActionBridge",kG.a,[]);class bH extends Pe.a{constructor(b){super();this.C1k=CommonUIStrings.l_AccHelpDialogCommandsHeaderText;this.mro=CommonUIStrings.l_AccHelpDialogShortcutHeaderText;this.jLd=this.azb=this.V6=this.rYa=this.NSe=null;this.Vb=
b;this.Vg="<div id='AccessibilityHelpDialogBody'></div>";this.yg="AAccessibilityHelpDialog";this.Cd=6;this.ze(0,CommonUIStrings.l_DialogClose)}get iff(){return null}get gie(){this.NSe||(this.NSe=this.TAm());return this.NSe}get qHo(){return 300}get OPi(){return"https://go.microsoft.com/fwlink/p/?LinkId=325036"}get NPi(){return CommonUIStrings.l_AccHelpDialogMoreHelpLinkText}get Y0a(){return this.Vb.at()}nUa(b){super.nUa(b);this.vEn()}GUa(){this.showDialog(this.dialogTitle,Object(z.a)(this,this.Mpk,
"accHelpDialogResultHandler"));this.jIa();this.setFocus()}setFocus(){this.V6?(this.azb=this.V6.tBodies[0].firstChild,this.I1(this.azb)):this.mH&&"none"!==this.mH.style.display?this.I1(this.mH):this.I1(this.aA)}cna(){this.ge.ob(pd.a.gi,this.jLd,Object(z.a)(this,this.$mh,"accHelpDialogKeydownHandler"));if(this.V6){this.ge.ob(pd.a.yh,this.V6,Object(z.a)(this,this.nyj,"tableOnKeyUpHandler"));const b=this.V6.tBodies[0].children;for(let h=0;h<b.length;h++)if(He.a.addHandler(b[h],pd.a.focus,Object(z.a)(this,
this.ugj,"rowOnFocusHandler")),He.a.addHandler(b[h],pd.a.blur,Object(z.a)(this,this.tgj,"rowOnBlurHandler")),Z.a.gt){const r=b[h].children;for(let B=0;B<r.length;B++)He.a.addHandler(r[B],pd.a.focus,Object(z.a)(this,this.OCh,"cellOnFocusHandler"))}}super.cna()}ehb(){this.ge&&(this.ge.sc(pd.a.gi,this.jLd,Object(z.a)(this,this.$mh,"accHelpDialogKeydownHandler")),this.V6&&this.ge.sc(pd.a.yh,this.V6,Object(z.a)(this,this.nyj,"tableOnKeyUpHandler")));if(this.V6){const b=this.V6.tBodies[0].children;for(let h=
0;h<b.length;h++)if(He.a.removeHandler(b[h],pd.a.focus,Object(z.a)(this,this.ugj,"rowOnFocusHandler")),He.a.removeHandler(b[h],pd.a.blur,Object(z.a)(this,this.tgj,"rowOnBlurHandler")),Z.a.gt){const r=b[h].children;for(let B=0;B<r.length;B++)He.a.removeHandler(r[B],pd.a.focus,Object(z.a)(this,this.OCh,"cellOnFocusHandler"))}}super.ehb()}jIa(){this.Y0a.scope.nr(this.Vb.WW);this.Y0a.scope.nr(this.Vb.XW);this.Y0a.scope.bindAction(this.Vb.WW,fb.a.vFc);this.Y0a.scope.bindAction(this.Vb.XW,fb.a.uFc)}Tqm(b){if(!this.Y0a.hk||
!this.Y0a.hk.l4)return 2;var h=this.Y0a.hk.l4;if(this.V6&&(h===this.aA&&b===fb.a.vFc||h===this.rYa&&b===fb.a.uFc))this.I1(this.azb);else if(h.id.startsWith("SelectableTableRow"))h=null,b===fb.a.vFc?h=this.rYa:b===fb.a.uFc&&(h=this.aA),h&&this.I1(h);else if(b===fb.a.vFc)this.Y0a.egc();else if(b===fb.a.uFc)this.Y0a.cgc();else return 2;return 32}ugj(b){b.target.setAttribute(Se.a.ifb,Se.a.xp);Sys.UI.DomElement.removeCssClass(this.azb,"inactiveRowSelection");this.azb=b.target}tgj(b){b.target.removeAttribute(Se.a.ifb);
Sys.UI.DomElement.addCssClass(b.target,"inactiveRowSelection")}OCh(b){(b=b.target.parentNode)&&b!==this.azb&&this.I1(b)}nyj(b){return b.Hb.keyCode===se.a.Ss?(b.Hb.stopPropagation(),!0):!1}$mh(b){if(!b.Hb)return!1;const h=b.Hb.keyCode;if(b.eventName===pd.a.gi){b=this.g1l(this.azb);let r=-1;const B=kb.a.count(this.gie)-1;h===Sys.UI.Key.down?r=b<B?b+1:0:h===Sys.UI.Key.up?r=0<b?b-1:B:h===Sys.UI.Key.home?r=0:h===Sys.UI.Key.end&&(r=B);-1!==r&&this.I1(this.V6.tBodies[0].children[r])}return!0}Mpk(){}vEn(){this.jLd=
document.getElementById("AccessibilityHelpDialogBody")||this.hq;this.hfl();this.Kel();this.xcl()}hfl(){if(this.iff){var b=document.createElement("div");b.className="WACDialogSubtitle";var h=document.createElement("span");h.innerText=this.iff;b.appendChild(h);this.tla.appendChild(b)}}Kel(){if(this.gie&&!kb.a.isEmpty(this.gie)){this.V6=document.createElement("table");this.V6.className="SelectableDialogTable";var b=document.createElement("thead"),h=document.createElement("tr");h.setAttribute(Se.a.uh,
Se.a.ZGc);b.appendChild(h);var r=dc.a.xKc(14,this.C1k);h.appendChild(r);r=dc.a.xKc(14,this.mro);h.appendChild(r);this.V6.appendChild(b);b=document.createElement("tbody");h=0;r=this.gie;for(let ca in r){var B=ca,P=r[ca];const ra=document.createElement("tr");ra.tabIndex=0;ra.setAttribute(Se.a.uh,Se.a.ZGc);ra.id="SelectableTableRow"+h++;B=dc.a.xKc(15,B);ra.appendChild(B);P=dc.a.xKc(15,P);ra.appendChild(P);b.appendChild(ra)}b.style.maxHeight=this.qHo+"px";this.V6.appendChild(b);this.jLd.appendChild(this.V6)}}xcl(){if(this.NPi&&
this.OPi){var b=document.createElement("div");b.className="WACDialogLearnMoreLinkContainer";this.rYa=document.createElement("a");this.rYa.innerText=this.NPi;this.rYa.href=this.OPi;this.rYa.target="_blank";this.rYa.id=this.qj("AccessibilityHelpDialogLink");this.rYa.className=Dd.AFrame.w1e;b.appendChild(this.rYa);this.Kc.insertBefore(b,this.Kc.lastChild)}}g1l(b){return Number.parseInvariant(b.id.substr(18))}z_(b,h,r,B=null){b&&h&&r&&(r=B?String.format(r,B):r,b[h]=r)}Jhi(b,h){return Z.a.fl?h:b}}Object(m.a)(bH,
"AAccessibilityHelpDialog",Pe.a,[963]);class YD extends bH{constructor(b){super(b)}get dialogTitle(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWETitle}get iff(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWESubtitle}TAm(){const b=this.Jhi(CommonUIStrings.l_AccHelpDialogCtrlKey,CommonUIStrings.l_AccHelpDialogCommandKey),h=this.Jhi(CommonUIStrings.l_AccHelpDialogWindowsKey,CommonUIStrings.l_AccHelpDialogCtrlKey),r={};this.z_(r,CommonUIStrings.l_AccHelpDialogAccHelpCommand,CommonUIStrings.l_AccHelpDialogAccHelpShortcut);
this.z_(r,CommonUIStrings.l_AccHelpDialogLandmarkRegionsCommand,CommonUIStrings.l_AccHelpDialogLandmarkRegionsShortcut,b);this.z_(r,CommonUIStrings.l_AccHelpDialogTellMeCommand,CommonUIStrings.l_AccHelpDialogTellMeShortcut);this.z_(r,CommonUIStrings.l_AccHelpDialogAccessKeysCommand,CommonUIStrings.l_AccHelpDialogAccessKeysShortcut,h);this.z_(r,CommonUIStrings.l_AccHelpDialogTooltipToggle,CommonUIStrings.l_AccHelpDialogTooltipToggleShortcut,b);this.z_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteShortcut,b);this.z_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteShortcut,b);this.z_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentShortcut);this.z_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerShortcut,
b);this.z_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleShortcut,b);this.z_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptShortcut,b);this.z_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectShortcut,b);this.z_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousShortcut,b);this.z_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextShortcut,b);this.z_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogGraphicFirstCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogGraphicFirstShortcut,b);v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&this.z_(r,CommonUIStrings.l_AccHelpDialogOpenDialogMenuCommand,
CommonUIStrings.l_AccHelpDialogOpenDialogMenuShortcut);v.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&this.z_(r,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsShortcut);(YD.Zb&&YD.Zb.isFeatureEnabled(63)||ko.a.qRa())&&this.z_(r,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestion,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionShortcut);return r}static get Zb(){return null!=YD.rzg?
YD.rzg:YD.rzg=Ma.a.instance.Oa("Box4.IFeatureHelper")}}Object(m.a)(YD,"AccessibilityHelpDialog",bH,[]);var cI=c(333);class mG{static get Vg(){return Pe.a.Kx(mG.Xm,WordEditorIntl.WordEditorStrings.l_StyleName,WordEditorIntl.WordEditorStrings.l_BadStyleName)}}mG.Xm="<div class='normal' id='text'> <label id='IntroLabel' class='WACDialogLabel' for='styleText' >{0}</label> <input type='text' id='styleText' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div> <div class='normal' id='text'> <div class='WACDialogError' id='badStyleError' role='alert'>{1}</div> </div>";
Object(m.a)(mG,"ApplyStylesDialogHtml",null,[]);class IE extends Pe.a{constructor(b,h){super();this.BH=null;this.TDc=!1;this.mAb=this.x$a=this.nAc=this.qAc=this.iEc=null;this.iGk=(r,B)=>{if(this.qh.mv){if(r){r=B.styleList;B=B.styleText;if(-1===r||F.a.eh(B)!==F.a.eh(this.BH[r]))r=this.cii(B);B=this.BH[r];r=this.qc.Cr();B=this.qc.Ag(r.JFa(B));v.AFrameworkApplication.va.Nf(this._context,Nb.a.NQ,2,!1,new cI.a,B)}this.qh.d6()}};this.lvn=r=>{this.TDc?(this.TDc=!1,this.validate()):"value"===r.rawEvent.propertyName&&
(this.TDc=!0,this.r_.value!==this.iEc&&(this.iEc=this.r_.value,this.Pwh()))};this.Aqn=()=>{-1!==this.Ama.selectedIndex&&(Z.a.V4&&(this.TDc=!0),this.iEc=this.BH[this.Ama.selectedIndex],this.r_.value=this.BH[this.Ama.selectedIndex],this.validate())};this.onKeyDown=r=>{Z.a.eK?r.keyCode!==se.a.qC&&r.keyCode!==se.a.k2||this.x$a||this.mAb||(this.mAb=new Me.a(0,1,1,this.v2o),v.AFrameworkApplication.lc.Wb(this.mAb)):Z.a.V4&&r.keyCode===se.a.qC&&(this.TDc=!0)};this.XG=()=>{this.x$a||(this.x$a=new Me.a(0,1,
1,this.JIk),v.AFrameworkApplication.lc.Wb(this.x$a));this.mAb&&(v.AFrameworkApplication.lc.ff(this.mAb),this.mAb=null)};this.JIk=()=>{this.x$a=null;this.Pwh()};this.v2o=()=>{this.mAb=null;this.validate()};this._context=b;this.rd=h;this.yg="ApplyStylesDialog";this.qh=this._context.view;this.Yuf();b=this.bFo();h="";this.BH.length>b&&(h=this.BH[b]);h={["styleText"]:h,["styleList"]:b};this.Vg=mG.Vg;this.Uh(WordEditorIntl.WordEditorStrings.l_ApplyStyles,this.iGk,h);this.Ama=document.getElementById("styleList");
this.Q1f();this.Ama.selectedIndex=b;this.r_=document.getElementById("styleText");this.r_.focus();this.r_.select();this.Nsd=this.Aqn;He.a.addHandler(this.Ama,"change",this.Nsd);this.Msd=this.onKeyDown;He.a.addHandler(this.r_,"keydown",this.Msd);Z.a.V4?(this.qAc=this.lvn,He.a.addHandler(this.r_,"propertychange",this.qAc),this.iEc=this.BH[b]):(this.nAc=this.XG,He.a.addHandler(this.r_,"keypress",this.nAc))}get qc(){return null!=this.VJg?this.VJg:this.VJg=Ma.a.instance.resolve("Box4.Styles.IWACStyleReader")}bFo(){var b=
this.qh.mb;if(!b||!b.ib)return Qc.b(579216408,3018,15,"Unable to retrieve valid SelectionCollection"),0;b=b.ib.lb;if(!b)return Qc.b(579216409,3018,15,"CurrentSelection is null"),0;ke.ParagraphReader.vm(b.Pa)&&(b=xe.SelectionEditor.Jj(b,!0,!1));b=b.Pa;if(!b||!xe.SelectionEditor.nv(b))return Qc.b(579216410,3018,15,"Received invalid nodeContext, null={0}",!b),0;var h=pn.FormattingReader.Yr(b);(h=pn.FormattingReader.Toa(h))||(h=this.qc.So(b.node));if(!h)return 0;b=this.qc.uR(h);b=Array.indexOf(this.BH,
b);0>b&&(b=0);return b}Q1f(){const b=this.BH.length;for(let h=0;h<b;h++){const r=document.createElement("OPTION");r.value=h.toString();r.text=this.BH[h];this.Ama.add(r,null)}}Yuf(){var b=Ck.a.Ar();if(b){b=(new Aq.WACStyleSet).fY(b);var h=b.EO,r=this.rd.isFeatureEnabled(111)&&!!this.qc.Ig;this.BH=[];for(let B=0;B<h;B++){const P=b.IFa(B);if(this.qc.isHidden(P))continue;const ca=this.qc.LG(P);if(!r){if(3===ca)continue}else if(3===ca&&this.qc.Ag(P)===Cw.a.dMb)continue;Array.add(this.BH,this.qc.uR(P))}this.BH.sort(IE.m3k)}else Qc.b(577644352,
3018,15,"Couldn't find PageContentNode")}dispose(){this.qAc&&He.a.removeHandler(this.r_,"propertychange",this.qAc);this.Msd&&He.a.removeHandler(this.r_,"keydown",this.Msd);this.Nsd&&He.a.removeHandler(this.Ama,"change",this.Nsd);this.nAc&&He.a.removeHandler(this.r_,"keypress",this.nAc);this.x$a&&v.AFrameworkApplication.lc.ff(this.x$a);this.x$a=this.nAc=this.Ama=this.r_=this.Msd=this.qAc=this.Nsd=null;super.dispose()}Pwh(){var b=this.r_.value,h=this.Mym(b);const r=-1===h?b:this.BH[h];b=b.length;const B=
r.length;this.iEc=r;this.r_.value=r;this.Ama.selectedIndex=h;B>b&&(Z.a.eK?this.r_.setSelectionRange(b,B):Z.a.V4&&(h=this.r_.createTextRange(),h.collapse(!0),h.moveStart("character",b),h.moveEnd("character",B-b),h.select()));this.validate();this.r_.focus()}Mym(b){let h=0,r=this.BH.length,B=-1;for(b=F.a.eh(b);h<r;){const P=Math.floor((h+r)/2),ca=IE.L9e(b,this.BH[P]);if(!ca){B=P;break}0<ca?h=P+1:r=P}if(B>h)for(;!IE.L9e(b,this.BH[B-1])&&(B--,B!==h););return B}validate(){const b=-1===this.cii(this.r_.value),
h=document.getElementById("badStyleError");b?(h.style.display="inline-block",h.innerText=WordEditorIntl.WordEditorStrings.l_BadStyleName):(h.style.display="none",h.innerText="");return!b}cii(b){b=F.a.eh(b);const h=this.BH.length;for(let r=0;r<h;r++)if(b===F.a.eh(this.BH[r]))return r;return-1}static L9e(b,h){const r=Math.min(b.length,h.length);b=F.a.eh(b);h=F.a.eh(h);for(let B=0;B<r;B++){const P=F.a.charCodeAt(b,B),ca=F.a.charCodeAt(h,B);if(P!==ca)return P-ca}return b.length<=h.length?0:1}static m3k(b,
h){return IE.L9e(b,h)}}Object(m.a)(IE,"ApplyStylesDialog",Pe.a,[]);var JE=c(319);class dI extends Tf.StandardDialog{constructor(b){super();this.Ev=b;this.nwo()}nwo(){this.Cd=1;this.BV(1);this.ze(1,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogOKText);this.rv(Box4Intl.Box4Strings.l_DeleteSavedStylesDialogTitleText,Box4Intl.Box4Strings.l_DeleteSavedStylesDialogMessageText,1,this.Def.bind(this))}Def(b){1===b&&this.Ev.gka("saveWordUserPreferenceSaveStyleSetting","{}").continueWith(h=>{h.Gi?Qc.b(524834400,
3018,10,"DeleteSavedSytles: Task Faulted.Exception:{0} Stack:{1}",h.exception,h.exception.stack):(this.a7n(),Qc.b(524834399,3018,50,"User deleted saved styles via UI."))},8)}a7n(){JE.a.asb="{}"}}Object(m.a)(dI,"DeleteSavedStylesConfirmationDialog",Tf.StandardDialog,[]);class eI extends Tf.StandardDialog{constructor(b,h){super();this.Def=P=>{if(1===P){P=new Map;P.set("Source","DeleteStyleConfirmationDialog");P.set("Action","DeleteStyle");va.Health.instance.recordKpiUsage(yo.a.CAa,0,yo.a.yB,P);var ca=
Ck.a.Ar();P=new cg.GraphTransaction(15);P.Db(ca);P.Uj=Nb.a.TDb;this.uE.tRh(this.$hh)?Qc.b(578359694,3018,50,"User deleted a style via UI."):(ca=new Map,ca.set("Source","DeleteStyleConfirmationDialog"),ca.set("Action","DeleteStyle"),ca=Object.assign(new hc.a,{extendedProperties:ca}),va.Health.instance.recordKpiFailure(yo.a.CAa,"DeleteStyleFailed",!1,!0,ca),Qc.b(578359695,3018,50,"User tried to delete a style via UI, but we were unable to delete it."));P.dispose()}};h||Qc.b(590128417,3018,10,"styleId is null");
let r=null,B=null;if(this.qh=b.view)B=this.qh.mb;B&&(r=B.ib.lb.Pa);r?(b=r.node)?(this.HK=this.hi.su(b))?(this.$hh=new mb.a,this.$hh.add(h),this.owo(h)):Qc.b(590128448,3018,10,"_pageContenNode is null."):Qc.b(590128419,3018,10,"node is null."):Qc.b(590128418,3018,10,"nodeContext is null.")}get uE(){return null!=this.KJg?this.KJg:this.KJg=Ma.a.instance.resolve("Box4.Styles.IWACStyleEditor")}get qc(){return null!=this.bKg?this.bKg:this.bKg=Ma.a.instance.resolve("Box4.Styles.IWACStyleReader")}get hi(){return null!=
this.GFg?this.GFg:this.GFg=qo.PageNavigator.instance}owo(b){const h=(new Aq.WACStyleSet).fY(this.HK);h?((b=h.oj(b))||Qc.b(590128450,3018,10,"Style set doesn't contain style with given ID"),b=this.qc.uR(b),this.Cd=4,this.BV(2),this.rv(CommonUIStrings.l_DefaultDialogTitle,String.format(WordEditorIntl.WordEditorStrings.l_DeleteStyleConfirmationDialogMessage,b),0,this.Def)):Qc.b(590128449,3018,10,"Can't retrieve style set from page content node")}}Object(m.a)(eI,"DeleteStyleConfirmationDialog",Tf.StandardDialog,
[]);class nG{static get Vg(){return Pe.a.Kx(nG.Xm)}}nG.Xm="<div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div>";Object(m.a)(nG,"DeleteStyleDialogHtml",null,[]);class fI extends Pe.a{constructor(b){super();this.HK=this.BH=null;this.sll=(h,r)=>{this.qh.mv&&(h?(h=r.styleList,-1!==h&&(h=this.BH[h],r=this.qc.Cr(),h=this.qc.Ag(r.JFa(h)),this.RLc.rll(this._context,h),this.qh.d6())):this.qh.d6())};this._context=b;this.yg="DeleteStyleDialog";this.Cd=
1;this.ze(1,WordEditorIntl.WordEditorStrings.l_DeleteStyleDialogButton);this.qh=this._context.view;this.Yuf();this.Vg=nG.Vg;this.Uh(WordEditorIntl.WordEditorStrings.l_DeleteStyle,this.sll,{["styleList"]:0});this.Ama=document.getElementById("styleList");this.Q1f();this.Ama.selectedIndex=0;this.Ama.focus()}get qc(){return null!=this.XJg?this.XJg:this.XJg=Ma.a.instance.resolve("Box4.Styles.IWACStyleReader")}get RLc(){return null!=this.myg?this.myg:this.myg=Ma.a.instance.resolve("WordEditor.UI.IDialogFactory")}Q1f(){const b=
this.BH.length;for(let h=0;h<b;h++){const r=document.createElement("OPTION");r.value=h.toString();r.text=this.BH[h];this.Ama.add(r,null)}}Yuf(){if(this.HK=Ck.a.Ar()){var b=(new Aq.WACStyleSet).fY(this.HK),h=b.EO;this.BH=[];for(let B=0;B<h;B++){const P=b.IFa(B);if(!this.qc.isHidden(P)&&this.qc.le(P,b)){var r=this.qc.LG(P);if(2===r||1===r)P.hasProperty(Mc.a.linkedStyle)&&2!==r||(r=P.ja(Mc.a.VK,null))&&0<r.length||this.BH.push(this.qc.uR(P))}}this.BH.sort()}else Qc.b(578650370,3018,15,"PageContentNode is null")}}
Object(m.a)(fI,"DeleteStyleDialog",Pe.a,[]);var kM=c(781);class gI{constructor(b){this.customData=null;this.ZO=b}}Object(m.a)(gI,"PropertySetChangedState",null,[]);class hI{static DIn(b,h,r){if(b&&h){var B=new gI(h),P=(ca,ra,Qa)=>{r.CIn(ca,ra,Qa,B)};b=new kM.a(h,b);b.tCd=P;b.NFd=P;b.Tde=P;b.Aic()}}}Object(m.a)(hI,"PropertySetChangedManager",null,[]);class iI{constructor(b){this.cNa=b}CIn(b,h,r,B){const P=this.cNa[b.id.toString()];P&&P(b,h,r,B)}}Object(m.a)(iI,"PropertyChangedProcessor",null,[]);const oG=
(b,h,r)=>{const B=Gp.a.instance.cFb;if(B){const P=new cg.GraphTransaction(15);P.Db(B);hI.DIn(b,h,new iI(r));P.dispose()}};class pG{static get Vg(){return Pe.a.Kx(pG.Xm,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTop,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeft,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottom,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRight)}}pG.Xm="<div class='WACDialogRow' id='RowMargins'> <div class='WACDialogGroupBox' id='MarginsDialogTopLeftBox'> <div class='WacDialogLabels' id='MarginsDialogTopLeftLabels'> <label id='MarginsDialogMarginTop' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='MarginsDialogMarginLeft' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogTopLeftSpinners'> <div id='MarginsDialogMarginTopSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginLeftSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> <div class='WACDialogGroupBox MarginsDialogRightChunk' id='MarginsDialogBottomRightBox'> <div class='WacDialogLabels' id='MarginsDialogBottomRightLabels'> <label id='MarginsDialogMarginBottom' class='DialogSpinnerLabel' >{2}</label> <br/> <label id='MarginsDialogMarginRight' class='DialogSpinnerLabel' >{3}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogBottomRightSpinners'> <div id='MarginsDialogMarginBottomSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginRightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> </div>";
Object(m.a)(pG,"MarginsDialogHtml",null,[]);class or{static get x5(){return null!=or.tFg?or.tFg:or.tFg=Ma.a.instance.Oa("WordEditor.IPageCommands")}static I$m(b,h,r){or.x5&&null!==r&&or.x5.ohe(0,r)}static E$m(b,h,r){or.x5&&null!==r&&or.x5.ohe(3,r)}static G$m(b,h,r){or.x5&&null!==r&&or.x5.ohe(1,r)}static H$m(b,h,r){or.x5&&null!==r&&or.x5.ohe(2,r)}static Gzn(b,h,r){or.x5&&null!==r&&or.x5.vUa(0,r)}static hzn(b,h,r){or.x5&&null!==r&&or.x5.vUa(1,r)}static g1k(b,h,r){or.x5&&null!==r&&(b==dd.a.aF?or.x5.xge(0,
r):b==dd.a.tG?or.x5.xge(1,r):b==dd.a.una?or.x5.xge(2,r):b==dd.a.separator&&or.x5.xge(3,r))}}Object(m.a)(or,"PageLevelPropertyChangedHandlers",null,[]);const jI=[qb.a.O2c,qb.a.N2c,qb.a.q9d,qb.a.r9d,qb.a.zbe,qb.a.wbe,qb.a.xbe,qb.a.ybe];class BA extends Pe.a{constructor(b,h,r,B,P){super();this.pPc=(ca,ra)=>{var Qa=BA.P4c(ca);ca=Eb.App.Mia;this.Kp.hasProperty(Qa)?(Qa=this.Kp.getValue(Qa),ra[Pi.a.Number]=Ze.a.F9a(Qa,ca)):ra[Pi.a.Number]=0;ra[Pi.a.UnitType]=ca};this.m9c=(ca,ra)=>{this.Kp.setValue(BA.P4c(ca),
Ze.a.MJa(ra[Pi.a.Number],ra[Pi.a.UnitType]));this.Gu.Hm()};this.K$m=ca=>{let ra=!1;1===ca&&(Math.abs(this.Kp.getValue(Mc.a.marginTop))+Math.abs(this.Kp.getValue(Mc.a.marginBottom))+Eb.App.BAa<=this.vua.getValue(Mc.a.tv)&&this.Kp.getValue(Mc.a.marginLeft)+this.Kp.getValue(Mc.a.marginRight)+Eb.App.BAa<=this.vua.getValue(Mc.a.Ko)?oG(this.JBa,this.Kp,BA.H$b()):ra=!0);this.dispose();ra&&this.JIa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage,this.F$m)};this.F$m=()=>{Ma.a.instance.resolve("WordEditor.UI.IDialogFactory").TMh(this.JBa,
this.vua,this.q7)};this.yg="MarginsDialog";this.vua=h.clone();this.JBa=b.clone();this.Kp=b.clone();this.q7=r;this.nW=!1;this.Gu=P;this.Vg=pG.Vg;r&&(this.xtc=wp.a.pSb);this.Uh(WordEditorIntl.WordEditorStrings.L_PageMargins,this.K$m,null);this.UUc();this.fUe=document.getElementById("DialogMarginTopSpinner");this.I1(this.fUe)}V9(){this.HEd("MarginsDialogMarginTopSpinnerContainer","DialogMarginTopSpinner",qb.a.O2c,qb.a.zbe,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTopAlt);this.HEd("MarginsDialogMarginBottomSpinnerContainer",
"DialogMarginBottomSpinner",qb.a.N2c,qb.a.wbe,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottomAlt);this.HEd("MarginsDialogMarginLeftSpinnerContainer","DialogMarginLeftSpinner",qb.a.q9d,qb.a.xbe,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeftAlt);this.HEd("MarginsDialogMarginRightSpinnerContainer","DialogMarginRightSpinner",qb.a.r9d,qb.a.ybe,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRightAlt)}UUc(){for(const b of jI)Object(om.a)(b,this.m9c,this.pPc);this.Gu.Pqa("DialogMarginTopSpinner");
this.Gu.Pqa("DialogMarginBottomSpinner");this.Gu.Pqa("DialogMarginLeftSpinner");this.Gu.Pqa("DialogMarginRightSpinner")}dispose(){for(const b of jI)Object(om.b)(b);this.Gu.gZ("DialogMarginTopSpinner");this.Gu.gZ("DialogMarginBottomSpinner");this.Gu.gZ("DialogMarginLeftSpinner");this.Gu.gZ("DialogMarginRightSpinner");super.dispose()}HEd(b,h,r,B,P){r=BA.jOk(h,r,B,P);this.pBb(r,b,h)}pBb(b,h,r){h=document.getElementById(h);this.Gu.t_a(r,b);b=this.Gu.ZFb(r,"Medium");h.appendChild(b)}static H$b(){return BA.cNa||
(BA.cNa=BA.Z5b())}static Z5b(){const b={};b[Mc.a.marginTop.id.toString()]=or.I$m;b[Mc.a.marginBottom.id.toString()]=or.E$m;b[Mc.a.marginLeft.id.toString()]=or.G$m;b[Mc.a.marginRight.id.toString()]=or.H$m;return b}static jOk(b,h,r,B){let P=!0;if(h===qb.a.O2c||h===qb.a.N2c)P=!1;return mi.j(b,h,r,B,[BA.lOk(P),BA.kOk(P)])}static lOk(b){return mi.l("inch",b?"0":"-22","22",".1")}static kOk(b){return mi.l("centimeter",b?"0":"-55.8","55.8","1")}static P4c(b){let h=null;switch(b){case qb.a.O2c:case qb.a.zbe:h=
Mc.a.marginTop;break;case qb.a.N2c:case qb.a.wbe:h=Mc.a.marginBottom;break;case qb.a.q9d:case qb.a.xbe:h=Mc.a.marginLeft;break;case qb.a.r9d:case qb.a.ybe:h=Mc.a.marginRight}return h}}BA.cNa=null;Object(m.a)(BA,"MarginsDialog",Pe.a,[]);class qG{static get Vg(){return Pe.a.Kx(qG.Xm,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidth,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeight)}}qG.Xm="<div class='WACDialogRow' id='RowPapeSize'> <div class='WacDialogLabels' id='PaperSizeDialogLabels'> <label id='PaperSizeDialogWidth' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='PaperSizeDialogHeight' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='PaperSizeDialogSpinners'> <div id='PaperSizeDialogWidthSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='PaperSizeDialogHeightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(m.a)(qG,"PaperSizeDialogHtml",null,[]);const kI=[qb.a.u9d,qb.a.t9d,qb.a.Obe,qb.a.Nbe];class Jt extends Pe.a{constructor(b,h,r,B,P){super();this.pPc=(ca,ra)=>{var Qa=this.P4c(ca);ca=Eb.App.Mia;this.Kp.hasProperty(Qa)?(Qa=this.Kp.getValue(Qa),ra[Pi.a.Number]=Ze.a.F9a(Qa,ca)):ra[Pi.a.Number]=0;ra[Pi.a.UnitType]=ca};this.m9c=(ca,ra)=>{this.Kp.setValue(this.P4c(ca),Ze.a.MJa(ra[Pi.a.Number],ra[Pi.a.UnitType]));this.Gu.Hm()};this.Tzn=ca=>{let ra=!1;1===ca&&(this.Kp.getValue(Mc.a.tv)>=Eb.App.BAa+this.vua.getValue(Mc.a.marginTop)+
this.vua.getValue(Mc.a.marginBottom)&&this.Kp.getValue(Mc.a.Ko)>=Eb.App.BAa+this.vua.getValue(Mc.a.marginLeft)+this.vua.getValue(Mc.a.marginRight)?oG(this.JBa,this.Kp,Jt.H$b()):ra=!0);this.dispose();ra&&this.JIa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage,this.Szn)};this.Szn=()=>{Ma.a.instance.resolve("WordEditor.UI.IDialogFactory").xNh(this.JBa,this.vua,this.q7)};this.yg="PaperSizeDialog";this.vua=h.clone();this.JBa=b.clone();this.Kp=b.clone();this.q7=r;this.nW=!1;this.Gu=P;this.Vg=qG.Vg;
r&&(this.xtc=wp.a.pSb);this.Uh(WordEditorIntl.WordEditorStrings.l_PaperSizeDialogTitle,this.Tzn,null);this.UUc();this.fUe=document.getElementById("DialogWidthSpinner");this.I1(this.fUe)}V9(){this.rzh("PaperSizeDialogWidthSpinnerContainer","DialogWidthSpinner",qb.a.u9d,qb.a.Obe,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidthAlt);this.rzh("PaperSizeDialogHeightSpinnerContainer","DialogHeightSpinner",qb.a.t9d,qb.a.Nbe,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeightAlt)}UUc(){for(const b of kI)Object(om.a)(b,
this.m9c,this.pPc);this.Gu.Pqa("DialogWidthSpinner");this.Gu.Pqa("DialogHeightSpinner")}dispose(){for(const b of kI)Object(om.b)(b);this.Gu.gZ("DialogWidthSpinner");this.Gu.gZ("DialogHeightSpinner");super.dispose()}rzh(b,h,r,B,P){r=Jt.AOk(h,r,B,P);this.pBb(r,b,h)}pBb(b,h,r){h=document.getElementById(h);this.Gu.t_a(r,b);b=this.Gu.ZFb(r,"Medium");h.appendChild(b)}P4c(b){let h=null;switch(b){case qb.a.t9d:case qb.a.Nbe:h=Mc.a.tv;break;case qb.a.u9d:case qb.a.Obe:h=Mc.a.Ko}return h}static H$b(){return Jt.cNa||
(Jt.cNa=Jt.Z5b())}static Z5b(){const b={};b[Mc.a.Ko.id.toString()]=or.Gzn;b[Mc.a.tv.id.toString()]=or.hzn;return b}static AOk(b,h,r,B){return mi.j(b,h,r,B,[Jt.COk(),Jt.BOk()])}static COk(){return mi.l("inch",Jt.ruj,Jt.UZm,Jt.iAo)}static BOk(){return mi.l("centimeter",Jt.ruj,Jt.TZm,Jt.hAo)}}Jt.ruj="0";Jt.UZm="22";Jt.iAo=".1";Jt.hAo="1";Jt.TZm="55.8";Jt.cNa=null;Object(m.a)(Jt,"PaperSizeDialog",Pe.a,[]);const lM=RegExp("[{|}|;|\\\\]"),lI=b=>{if(!b)return"";const h=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogDefaultStyle,
r=b.EO;let B;for(B=1;B<=r;B++){const P=h+B;if(!(b.Zhi(P)||b.BUd(P)||b.Zhi(P+"Char")||b.BUd(P+"Char")))break}return h+B};class mI extends Pe.a{constructor(b,h,r,B,P){var ca,ra,Qa,tb;super(!1,!1,!0);this.context=b;this.oc=h;this.X8=r;this.qc=B;this.hi=P;this.qNd=null;this.C7i=(Mb,Zb)=>{if(this.ke.mv){if(0!==Mb){Mb="string"===typeof Zb.styleText?Zb.styleText:null;Zb=this.$ad;var jc=Mb;const Gc=F.a.jza(jc);let Uc=null;if(0===Gc.length)Uc=WordEditorIntl.WordEditorStrings.l_StyleNameEmpty;else if(253<jc.length)Uc=
WordEditorIntl.WordEditorStrings.l_StyleNameOverMaxLength;else if(lM.test(jc))Uc=WordEditorIntl.WordEditorStrings.l_StyleNameRestrictedCharacters;else if(Zb.Ffm(jc)||Zb.BUd(Gc))Uc=WordEditorIntl.WordEditorStrings.l_StyleNameAlreadyExists;(Zb=Uc)?(this.qNd=Zb,Zb=lI(this.$ad),Mb=this.YFb(Mb,Zb),this.qNd=null,this.nW=!1,this.hide(),this.Uh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.C7i,Mb),this.nW=!0):(this.hide(),Zb=new Map,Zb.set("Source","ReactCreateNewStyleDialog"),Zb.set("Action","CreateStyle"),
va.Health.instance.recordKpiUsage(yo.a.CAa,0,yo.a.yB,Zb),this.b_e(Mb)||(Mb=new Map,Mb.set("Source","ReactCreateNewStyleDialog"),Mb.set("Action","CreateStyle"),Mb=Object.assign(new hc.a,{extendedProperties:Mb}),va.Health.instance.recordKpiFailure(yo.a.CAa,"CreateStyleFailed",!1,!0,Mb)))}else this.hide();this.ke.d6()}};this.yg="CreateNewStyleDialog";this.ke=b.view;(b=null===(tb=null===(Qa=null===(ra=null===(ca=this.ke)||void 0===ca?void 0:ca.mb)||void 0===ra?void 0:ra.ib)||void 0===Qa?void 0:Qa.lb)||
void 0===tb?void 0:tb.Pa)?(ca=b.node)?(this.pageContentNode=this.hi.su(ca))?(this.$ad=(new Aq.WACStyleSet).e9h(this.pageContentNode),(this.$Lb=this.X8.kOd(b))?(ca=this.$Lb.ja(Pd.a.fontSize,22),16>ca?Qc.b(593078050,3018,50,"Font size less than 8pt in create new style dialog preview"):52>=ca?Qc.b(593078049,3018,50,"Font size between 8pt and 26pt in create new style dialog preview"):90>=ca?Qc.b(593078048,3018,50,"Font size between 26pt and 45 pt in create new style dialog preview"):Qc.b(593078047,3018,
50,"Font size more than 45pt in create new style dialog preview"),this.B8f(this.$Lb),this.pageContentNode&&this.$Lb&&(this.Faa=!1,ca=lI(this.$ad),ca=this.YFb(ca,ca),this.Uh(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,this.C7i,ca))):Qc.b(592737758,3018,10,"_newStyleProperties is null.")):Qc.b(592737757,3018,10,"_pageContenNode is null."):Qc.b(592725466,3018,10,"node is null."):Qc.b(556917206,3018,10,"nodeContext is null.")}B8f(b){b.Cg(gi.a.Vv,gi.a.qw,...yo.a.Ica())}YFb(b,h){const r=52<=this.$Lb.ja(Pd.a.fontSize,
Am.a.GM),B=Cj.a.Opf(this.$Lb,"97%",26,!1,!0,r);B["padding-left"]="5px";r||(B["line-height"]="40px");b={["styleNameLabel"]:WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogName,["previewWindowLabel"]:WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogParagraphPreview,["styleName"]:b,["previewContainerText"]:h,["getPreviewStyle"]:()=>B};this.qNd&&(b.errorMessage=this.qNd);return{["id"]:this.yg,["bodyControls"]:b}}b_e(b){const h=new cg.GraphTransaction(15);h.Db(this.pageContentNode);h.Uj=Nb.a.nDb;
const r=Ck.a.b_e(b,Ck.a.Ffi(this.$Lb),null,this.pageContentNode);r&&(Qc.b(593078046,3018,50,"User created linked style"),this.$ad=(new Aq.WACStyleSet).e9h(this.pageContentNode),b=F.a.jza(F.a.rY(b)),b=this.$ad.BUd(b),this.oc.Nf(this.context,Nb.a.NQ,2,!1,new cI.a,this.qc.Ag(b)));h.dispose();return r}}Object(m.a)(mI,"ReactCreateNewStyleDialog",Pe.a,[]);class uD extends Pe.a{constructor(b,h=!1,r){super(!1,!1,h);let B=h=this.yK=null;this.yg=uD.id;this.qh=b.view;this.An=r;this.qh&&(B=this.qh.mb);B&&B.ib&&
B.ib.lb&&(h=B.ib.lb.Pa);h?(b=h.node)?(this.HK=uD.hi.su(b))||t.ULS.sendTraceTag(539762890,3029,10,"_pageContenNode is null"):t.ULS.sendTraceTag(539762889,3029,10,"node is null"):t.ULS.sendTraceTag(539762888,3029,10,"nodeContext is null")}f2o(b){var h=RegExp("^(?!\\p{N})[\\p{L}\\p{N}\\p{Mc}\\p{Mn}_]{1,40}$","gu"),r=this.dNl();const B=""===F.a.jza(b),P=b.length>uD.Van;r=r.includes(b);h=h.test(b);b=b.startsWith("_");let ca=null;if(B||P||r||b||!h)ca=B?WordEditorIntl.WordEditorStrings.l_BookmarkNameEmpty:
P?WordEditorIntl.WordEditorStrings.l_BookmarkNameOverMaxLength:b?WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters:h?WordEditorIntl.WordEditorStrings.l_BookmarkNameAlreadyExists:WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters;return ca}QIm(b,h){return b?b===h:!1}static get hi(){return qo.PageNavigator.instance}dNl(){const b=this.An.jQd(!1),h=[];for(let r=0;r<b.count;r++){const B=b.J(r).ja(Mc.a.At,"");h.push(B)}return h}}uD.id="BookmarkEditDialog";uD.Van=40;Object(m.a)(uD,
"AEditBookmarkDialog",Pe.a,[]);class nI extends uD{constructor(b,h,r){super(b,!0,r);this.MAe=null;this.uXa="wwaengidc";this.$xc="ReactCreateEditBookmarkNameDialog";this.P3g="EditBookmarkName";this.vta="EditBookmarkNameDialog";this.Lue=h;this.An=r;this.HK&&(this.Faa=!1,b=this.YFb(h.properties.ja(Mc.a.At,null)),this.Uh(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.E7i.bind(this),b))}E7i(b,h){if(this.qh.mv){if(b){b="string"===typeof h.BookmarkText?h.BookmarkText:null;var r;this.Lue.hasProperty(Mc.a.At)?
r=this.Lue.getValue(Mc.a.At):t.ULS.sendTraceTag(528880847,3029,10,"Bookmark name not found");h=this.f2o(b);this.QIm(b,r)?(t.ULS.sendTraceTag(528880848,3029,50,"User did not update existing bookmark's name, dismissing edit bookmark dialog"),this.hide()):h?(this.MAe=h,r=this.YFb(b),this.MAe=null,this.nW=!1,this.hide(),this.Uh(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.E7i.bind(this),r),this.nW=!0):(this.hide(),r=new Map,r.set("Source",this.$xc),r.set("Action",this.P3g),va.Health.instance.recordKpiUsage(this.vta,
0,this.uXa,r),this.LUk(b)||(r=new Map,r.set("Source",this.$xc),r.set("Action",this.P3g),r=Object.assign(new hc.a,{extendedProperties:r}),va.Health.instance.recordKpiFailure(this.vta,"Unable to edit bookmark",!1,!0,r)))}else this.hide();this.qh.d6()}}LUk(b){b=F.a.jza(F.a.rY(b));try{const h=this.An.nUo(this.Lue,b);if(h)t.ULS.sendTraceTag(539762886,3029,50,"Updated bookmark name to name specified by user");else return t.ULS.sendTraceTag(525111646,3029,10,"Error updating bookmark name to name specified by user"),
h}catch(h){return t.ULS.sendTraceTag(539762887,3029,10,"Error updating bookmark name to name specified by user",h.Message),!1}}YFb(b){const h={};h.bookmarkValue=b;h.errorMessage=this.MAe;h.bookmarkTextLabel=WordEditorIntl.WordEditorStrings.l_EditBookmarkDialogLabelName;return{["id"]:this.yg,["bodyControls"]:h}}}Object(m.a)(nI,"ReactEditBookmarkNameDialog",uD,[]);var mM=c(413);const rG=(b,h,r)=>{const B=[];if(b.length!==h.length||r&&r.length!==h.length)return B;for(let P=0;P<b.length;P++){const ca=
{};ca.key=h[P];ca.text=b[P];ca.type="AppComboBoxItem";r&&(ca.ariaLabel=r[P]);B[P]=ca}return B},yC=(b,h,r,B,P)=>({["unitType"]:b,["unitPlaceholder"]:F.a.T$d(h),["minValue"]:r,["maxValue"]:B,["step"]:P}),cH=()=>({["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}),oI=(b,h,r)=>{let B=!1;b.hasProperty(h)&&b.hasProperty(r)?(r=b.getValue(r),1===r?(b=Number.NaN,h=5,B=!0):(b=b.getValue(h),h=2===r?
4:5)):(b=Number.NaN,h=Eb.App.EGa?4:5);return{pmc:b,i9a:h,dcc:B}};class pI{constructor(){this.Kuj=this.x0i=this.v0i=this.Yzn=this.G_f=!1}}Object(m.a)(pI,"Box4PropertySetChangedState",null,[]);class Qm{static get zbc(){return null!=Qm.yBg?Qm.yBg:Qm.yBg=Ma.a.instance.Oa("Box4.IIndentationCommands")}static get sFi(){return null!=Qm.SDg?Qm.SDg:Qm.SDg=Ma.a.instance.Oa("Box4.IJustificationCommands")}static get W5(){return null!=Qm.gHg?Qm.gHg:Qm.gHg=Ma.a.instance.Oa("Box4.ISpacingCommands")}static WYm(b,
h,r){Qm.sFi&&r&&(null===h||11!==r||10!==h&&9!==h)&&Qm.sFi.oE(r)}static e1m(b,h,r){Qm.W5&&r&&Qm.W5.mD(r)}static w6k(b,h,r){h!=r&&Qm.W5.blc(r)}static gZm(b,h,r){h!=r&&Qm.W5.F9c(r)}static G4o(b,h,r){h!=r&&Qm.W5.g$c(r)}static eZm(b,h,r){h!=r&&Qm.W5.E9c(r)}static C0i(b,h,r,B){Qm.W5&&void 0!==r&&null!==r&&(b=Qm.HPc(B),!b.G_f&&B.ZO.hasProperty(Yc.a.Khc)&&B.ZO.hasProperty(Yc.a.Lhc)&&(h=B.ZO.getValue(Yc.a.Lhc),B=B.ZO.getValue(Yc.a.Khc),b.G_f=!0,Qm.W5.mea(1,h,B)))}static B0i(b,h,r,B){Qm.W5&&void 0!==r&&null!==
r&&(b=Qm.HPc(B),!b.Yzn&&B.ZO.hasProperty(Yc.a.Ihc)&&B.ZO.hasProperty(Yc.a.Jhc)&&(h=B.ZO.getValue(Yc.a.Jhc),B=B.ZO.getValue(Yc.a.Ihc),b.G_f=!0,Qm.W5.mea(0,h,B)))}static u0i(b,h,r,B){Qm.zbc&&void 0!==r&&null!==r&&(b=Qm.HPc(B),!b.v0i&&B.ZO.hasProperty(Yc.a.QHa)&&B.ZO.hasProperty(Yc.a.RHa)&&(h=B.ZO.getValue(Yc.a.RHa),B=B.ZO.getValue(Yc.a.QHa),b.v0i=!0,Qm.zbc.bnj(1,h,B)))}static w0i(b,h,r,B){Qm.zbc&&void 0!==r&&null!==r&&(b=Qm.HPc(B),!b.x0i&&B.ZO.hasProperty(Yc.a.nob)&&B.ZO.hasProperty(Yc.a.oob)&&(h=B.ZO.getValue(Yc.a.oob),
B=B.ZO.getValue(Yc.a.nob),b.x0i=!0,Qm.zbc.bnj(0,h,B)))}static Gig(b,h,r,B){Qm.zbc&&void 0!==r&&null!==r&&(b=Qm.HPc(B),!b.Kuj&&B.ZO.hasProperty(Yc.a.LUa)&&B.ZO.hasProperty(Yc.a.MUa)&&(h=0,B.ZO.hasProperty(Yc.a.X5)&&(h=B.ZO.getValue(Yc.a.X5)),r=B.ZO.getValue(Yc.a.MUa),B=B.ZO.getValue(Yc.a.LUa),b.Kuj=!0,Qm.zbc.Ihe(h,r,B)))}static HPc(b){b.customData||(b.customData=new pI);return b.customData}}Object(m.a)(Qm,"ParagraphLevelPropertyChangedHandlers",null,[]);class vD{constructor(){this.cNa=null}W8l(b){const h=
{};h.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"};var r=yC("Point",5,0,1584,1),B=yC("Line",4,0,327,1),P=[r,B];B=cH();var ca=[Box4Intl.Box4Strings.L_SpinnerAuto];r=[""];({pmc:Qa,i9a:ra,dcc:tb}=oI(b,Yc.a.Lhc,Yc.a.Khc));var ra={["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,
["unitType"]:Ze.a.I0a(ra),["validUnits"]:P,["numberFormatInfo"]:B,["validReservedValues"]:ca};tb?ra.reservedValue=ca[0]:ra.value=isNaN(Qa)?"":Qa;h.beforeSpacingSpinButtonProps=ra;({pmc:Qa,i9a:ra,dcc:tb}=oI(b,Yc.a.Jhc,Yc.a.Ihc));P={["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:Ze.a.I0a(ra),["validUnits"]:P,["numberFormatInfo"]:B,["validReservedValues"]:ca};
tb?P.reservedValue=ca[0]:P.value=isNaN(Qa)?"":Qa;h.afterSpacingSpinButtonProps=P;if(ca=P=b.hasProperty(Yc.a.xa))ca=vD.n5a.zGb(b),ca=b.hasProperty(Yc.a.xa)&&b.hasProperty(Yc.a.o5a)&&2===b.getValue(Yc.a.o5a)?!jd.a.Cxa(ca,1)&&!jd.a.Cxa(ca,1.5)&&!jd.a.Cxa(ca,2):!1;if(P){var Qa=vD.n5a.zGb(b);P=0;var tb=!1;b.hasProperty(Yc.a.xa)&&b.hasProperty(Yc.a.o5a)||(tb=!0);tb||(2!==b.getValue(Yc.a.o5a)&&(tb=!0),P=Qa,1>P&&(tb=!0));tb?P="":(Qa="multiple",ca||(jd.a.Cxa(P,1)?Qa="1.00":jd.a.Cxa(P,1.5)?Qa="1.50":jd.a.Cxa(P,
2)&&(Qa="2.00")),P=Qa)}else P=null;Qa={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,["options"]:rG([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],["1.00","1.50",
"2.00","multiple"]),["allowFreeForm"]:!1};P?Qa.selectedKey=P:Qa.defaultSelectedKey="";h.lineSpacingComboBoxProps=Qa;P=0;Qa=!1;b.hasProperty(Yc.a.xa)&&b.hasProperty(Yc.a.o5a)&&2===b.getValue(Yc.a.o5a)&&ca&&(P=vD.n5a.zGb(b),Qa=!0,1>P&&(P=Number.NaN));b=[yC("none",0,1,132,.5)];b={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,["unitType"]:"none",["validUnits"]:b,
["numberFormatInfo"]:B,["validReservedValues"]:r};Qa?b.value=P:b.reservedValue=r[0];h.atSpinButtonProps=b;return h}H$b(){return this.cNa||(this.cNa=this.Z5b())}Z5b(){const b={};b[Yc.a.xa.id.toString()]=Qm.e1m;b[Yc.a.Jhc.id.toString()]=Qm.B0i;b[Yc.a.Ihc.id.toString()]=Qm.B0i;b[Yc.a.Lhc.id.toString()]=Qm.C0i;b[Yc.a.Khc.id.toString()]=Qm.C0i;return b}static get n5a(){return null!=vD.aEg?vD.aEg:vD.aEg=Ma.a.instance.resolve("Box4.ILineSpacingHelper")}}Object(m.a)(vD,"ReactParagraphDialog",null,[]);const qI=
b=>1===b||2===b||3===b||6===b||10===b||11===b||9===b||7===b||13===b,dH=(b,h,r,B)=>{let P=Eb.App.Mia;b.hasProperty(h)&&b.hasProperty(r)&&!B?(h=b.getValue(h),b=b.getValue(r),h?2===b?P=2:h=Ze.a.F9a(h,P):Eb.App.EGa&&(P=2)):(h=Number.NaN,Eb.App.EGa&&(P=2));return{pmc:h,i9a:P}},nM=b=>{let h="0";b.hasProperty(Yc.a.X5)&&(b=b.getValue(Yc.a.X5),(1===b||2===b||!b)&&(1===b?h="1":2===b?h="2":b||(h="0")));return h},rI=(b,h)=>{if(h.hasProperty(Yc.a.X5)&&2===h.getValue(Yc.a.X5)&&h.hasProperty(Yc.a.MUa)&&h.hasProperty(Yc.a.LUa)&&
b.hasProperty(Yc.a.RHa)&&b.hasProperty(Yc.a.QHa)){var r=b.getValue(Yc.a.RHa),B=b.getValue(Yc.a.QHa);r=(new Lq.a(B,r)).Wt;B=h.getValue(Yc.a.MUa);h=h.getValue(Yc.a.LUa);h=(new Lq.a(h,B)).Wt;b.setValue(Yc.a.RHa,r+h);b.setValue(Yc.a.QHa,1)}},sI=b=>{const h=b.getValue(Yc.a.RHa);b=b.getValue(Yc.a.QHa);return(new Lq.a(b,h)).Wt},tI=b=>{const h=b.getValue(Yc.a.oob);b=b.getValue(Yc.a.nob);return(new Lq.a(b,h)).Wt},uI=(b,h)=>h.hasProperty(Yc.a.RHa)&&h.hasProperty(Yc.a.QHa)&&h.hasProperty(Yc.a.oob)&&h.hasProperty(Yc.a.nob)&&
b.hasProperty(Mc.a.marginLeft)&&b.hasProperty(Mc.a.marginRight)&&b.hasProperty(Mc.a.Ko),oM=b=>b.hasProperty(Yc.a.r3c)?b.getValue(Yc.a.r3c):!1,pM=b=>b.hasProperty(dd.a.keepWithNext)?b.getValue(dd.a.keepWithNext):!1,qM=b=>b.hasProperty(dd.a.widowControl)?b.getValue(dd.a.widowControl):!1,rM=b=>b.hasProperty(dd.a.keepTogether)?b.getValue(dd.a.keepTogether):!1;class vI extends Pe.a{constructor(b,h,r,B){super(!1,!1,!0);this.Emh=null;this.fAn=()=>{Ma.a.instance.resolve("Box4.UI.IBox4DialogFactory").BJd(this.JBa,
this.vua,this.q7)};this.hAn=(tb,Mb)=>{if(Mb&&(1===tb||2===tb)){if(Mb.alignmentComboBoxProps){var Zb=parseInt(Mb.alignmentComboBoxProps.selectedKey);isNaN(Zb)||qI(Zb)&&this.Kp.setValue(Yc.a.yw,Zb)}var jc=Mb.bySpinButtonProps;Zb=!!jc&&""!==jc.value;var Gc=Mb.didChangeSpecialIndentationComboBoxValue;if(Mb.specialIndentationComboBoxProps){var Uc=parseInt(Mb.specialIndentationComboBoxProps.selectedKey);1!==Uc&&2!==Uc&&Uc||!(Uc||Gc||Zb)||this.Kp.setValue(Yc.a.X5,Uc)}if(jc){Uc=jc.value;jc=Ze.a.QOa(jc.unitType.toLowerCase());
let od;0<=Uc||(Uc=0);2===jc?od=2:(od=1,Uc=Ze.a.MJa(Uc,jc));if(Zb||Gc)this.Kp.setValue(Yc.a.MUa,Uc),this.Kp.setValue(Yc.a.LUa,od)}Mb.beforeTextSpinButtonProps&&(Gc=Mb.beforeTextSpinButtonProps,Zb=Ze.a.QOa(Gc.unitType.toLowerCase()),Gc=""===Gc.value?Number.NaN:Gc.value,isNaN(Gc)||(Uc=Gc,2===Zb?jc=2:(jc=1,Uc=Ze.a.MJa(Gc,Zb)),this.Kp.setValue(Yc.a.RHa,Uc),this.Kp.setValue(Yc.a.QHa,jc)));Mb.afterTextSpinButtonProps&&(Gc=Mb.afterTextSpinButtonProps,Zb=Ze.a.QOa(Gc.unitType.toLowerCase()),Gc=""===Gc.value?
Number.NaN:Gc.value,isNaN(Gc)||(Uc=Gc,2===Zb?jc=2:(jc=1,Uc=Ze.a.MJa(Gc,Zb)),this.Kp.setValue(Yc.a.oob,Uc),this.Kp.setValue(Yc.a.nob,jc)));Mb.beforeSpacingSpinButtonProps&&(Zb=Mb.beforeSpacingSpinButtonProps,Gc=Ze.a.QOa(Zb.unitType.toLowerCase()),Uc=Zb.reservedValue,""!==Zb.value&&(Uc===Box4Intl.Box4Strings.L_SpinnerAuto?(Gc=1,Zb=0):(Gc=4===Gc?2:4,Zb=Zb.value),this.Kp.setValue(Yc.a.Lhc,Zb),this.Kp.setValue(Yc.a.Khc,Gc)));Mb.afterSpacingSpinButtonProps&&(Zb=Mb.afterSpacingSpinButtonProps,Gc=Ze.a.QOa(Zb.unitType.toLowerCase()),
Uc=Zb.reservedValue,""!==Zb.value&&(Uc===Box4Intl.Box4Strings.L_SpinnerAuto?(Gc=1,Zb=0):(Gc=4===Gc?2:4,Zb=Zb.value),this.Kp.setValue(Yc.a.Jhc,Zb),this.Kp.setValue(Yc.a.Ihc,Gc)));if(Mb.atSpinButtonProps||Mb.lineSpacingComboBoxProps)if(Zb=Mb.atSpinButtonProps.value,1<Zb)this.Kp.setValue(Yc.a.xa,Zb),this.Kp.setValue(Yc.a.o5a,2);else if(Zb=Mb.lineSpacingComboBoxProps.selectedKey)Zb="1.00"===Zb?1:"1.50"===Zb?1.5:"2.00"===Zb?2:0,Zb=1<=Zb?Zb:1,this.Kp.setValue(Yc.a.xa,Zb),this.Kp.setValue(Yc.a.o5a,2);Mb.contextualSpacingCheckboxProps&&
this.Kp.setValue(Yc.a.r3c,Mb.contextualSpacingCheckboxProps.checked);Mb.keepWithNextCheckboxProps&&this.Kp.setValue(dd.a.keepWithNext,Mb.keepWithNextCheckboxProps.checked);Mb.widowOrphanCheckboxProps&&this.Kp.setValue(dd.a.widowControl,Mb.widowOrphanCheckboxProps.checked);Mb.keepTogetherCheckboxProps&&this.Kp.setValue(dd.a.keepTogether,Mb.keepTogetherCheckboxProps.checked);rI(this.JBa,this.JBa);rI(this.Kp,this.JBa);Mb="";Zb=this.vua;Gc=this.Kp;if(Uc=uI(Zb,Gc))Uc=Gc.hasProperty(Yc.a.MUa)&&Gc.hasProperty(Yc.a.LUa);
Uc?(Uc=Gc.getValue(Yc.a.MUa),jc=Gc.getValue(Yc.a.LUa),Uc=(new Lq.a(jc,Uc)).Wt,Zb=sI(Gc)+tI(Gc)+Zb.getValue(Mc.a.marginRight)+Zb.getValue(Mc.a.marginLeft)+Uc+Eb.App.BAa<=Zb.getValue(Mc.a.Ko)):Zb=uI(Zb,Gc)?sI(Gc)+tI(Gc)+Zb.getValue(Mc.a.marginRight)+Zb.getValue(Mc.a.marginLeft)+Eb.App.BAa<=Zb.getValue(Mc.a.Ko):!0;Zb?oG(this.JBa,this.Kp,this.ulm(this.JSe?this.JSe.Z5b():{})):Mb=""!==Mb?Mb:Box4Intl.Box4Strings.l_ParaIndentSetFailedMessage;this.dispose();""!==Mb?this.JIa(Mb,this.fAn):2===tb&&(Ke.c(qb.a.Ulc,
!0,"Custom Tab Stop Dialog was opened via Paragraph Dialog"),this.ga.Qb(qb.a.Ulc,2,null))}};this.JBa=b.clone();this.Kp=b.clone();this.vua=h.clone();this.q7=r;this.ga=B;this.JSe=new vD;b=this.JSe.W8l(this.Kp);h=yC("Inch",3,-11,22,.1);r=yC("Inch",3,0,22,.1);var P=yC("Centimeter",1,-27.94,55.88,1);B=yC("Centimeter",1,0,55.88,1);var ca=yC("Character",2,-316.8,316.8,.5),ra=yC("Character",2,0,316.8,.5);h=[h,P,ca];B=[r,B,ra];r=cH();b.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,
["forId"]:"GeneralGroup"};P=[Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified,Box4Intl.Box4Strings.l_ParagraphDialogAlignDistributed];ca=["1","2","3","6","7"];let Qa=5;ra=this.Kp.hasProperty(Yc.a.yw)?this.Kp.getValue(Yc.a.yw):0;if(10===ra||9===ra)ra=11;if(v.AFrameworkApplication.lcid===lj.a.tg("AR-SA").LCID||11===ra)b.isKashidaSupported=!0,P[Qa]=Box4Intl.Box4Strings.l_ParagraphDialogAlignKashida,
ca[Qa]="11",Qa=6;if(v.AFrameworkApplication.lcid===lj.a.tg("TH-TH").LCID||13===ra)b.isThaiSupported=!0,P[Qa]=Box4Intl.Box4Strings.l_ParagraphDialogAlignThaiDistributed,ca[Qa]="13";P={["type"]:"AppComboBoxProps",["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,["showLabel"]:!0,["options"]:rG(P,ca),["allowFreeForm"]:!1};qI(ra)?P.selectedKey=ra.toString():P.defaultSelectedKey="";b.alignmentComboBoxProps=
P;b.paginationLabelProps={["type"]:"AppLabelProps",["id"]:"PaginationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogPagination,["forId"]:"PaginationGroup"};ra={["type"]:"AppCheckboxInternalProps",["id"]:"KeepWithNextCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepWithNext,["checked"]:pM(this.Kp)};b.keepWithNextCheckboxProps=ra;ra={["type"]:"AppCheckboxInternalProps",["id"]:"WidowOrphanCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogWidowOrphan,["checked"]:qM(this.Kp)};
b.widowOrphanCheckboxProps=ra;ra={["type"]:"AppCheckboxInternalProps",["id"]:"KeepTogetherCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepTogether,["checked"]:rM(this.Kp)};b.keepTogetherCheckboxProps=ra;b.indentationLabelProps={["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};P=nM(this.Kp);ra="0"===P;b.specialIndentationComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,["showLabel"]:!0,["options"]:rG([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["selectedKey"]:P,["allowFreeForm"]:!1};ca=Eb.App.Mia;P=0;({pmc:P,i9a:ca}=dH(this.Kp,Yc.a.MUa,Yc.a.LUa,ra));B={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,["unitType"]:Ze.a.I0a(ca),["validUnits"]:B,["numberFormatInfo"]:r};B=this.JQb(P,B);b.bySpinButtonProps=B;ra=Eb.App.Mia;B=0;({pmc:B,i9a:ra}=dH(this.Kp,Yc.a.RHa,Yc.a.QHa,!1));ra={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:Ze.a.I0a(ra),["validUnits"]:h,["numberFormatInfo"]:r};
ra=this.JQb(B,ra);b.beforeTextSpinButtonProps=ra;ra=Eb.App.Mia;B=0;({pmc:B,i9a:ra}=dH(this.Kp,Yc.a.oob,Yc.a.nob,!1));h={["type"]:"AppSpinButtonProps",["id"]:"AfterTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRight,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRightAlt,["unitType"]:Ze.a.I0a(ra),["validUnits"]:h,["numberFormatInfo"]:r};h=this.JQb(B,h);b.afterTextSpinButtonProps=h;h={["id"]:"ParagraphDialog",["bodyControls"]:b};r={["type"]:"AppCheckboxInternalProps",
["id"]:"ContextualSpacingCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogContextualSpacing,["checked"]:oM(this.Kp)};b.contextualSpacingCheckboxProps=r;h.dialogButtonsOption=9;b=mM.a.isSharedUxGateEnabled("SharedOnline.ChangeGate.DialogButtonSpacingFix");h.secondaryActionButtonProps={["id"]:"tabStopOptionsButton",["type"]:"AppButtonProps",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogTabStopOptions,["positionInFooter"]:b?"left":void 0};h.styles={["root"]:{["#tabStopOptionsButton"]:{["float"]:b?
void 0:"left",["margin-left"]:"0"}}};this.Uh(Box4Intl.Box4Strings.l_ParagraphDialogTitle,this.hAn,h)}ulm(b){return this.Emh||(this.Emh=this.ucf(b))}ucf(b){b[Yc.a.yw.id.toString()]=Qm.WYm;b[Yc.a.QHa.id.toString()]=Qm.u0i;b[Yc.a.RHa.id.toString()]=Qm.u0i;b[Yc.a.nob.id.toString()]=Qm.w0i;b[Yc.a.oob.id.toString()]=Qm.w0i;b[Yc.a.X5.id.toString()]=Qm.Gig;b[Yc.a.LUa.id.toString()]=Qm.Gig;b[Yc.a.MUa.id.toString()]=Qm.Gig;b[Yc.a.r3c.id.toString()]=Qm.w6k;b[dd.a.keepWithNext.id.toString()]=Qm.gZm;b[dd.a.widowControl.id.toString()]=
Qm.G4o;b[dd.a.keepTogether.id.toString()]=Qm.eZm;return b}JQb(b,h){h.value=isNaN(b)?"":b;return h}}Object(m.a)(vI,"WordReactParagraphDialog",Pe.a,[]);class Lw extends Pe.a{constructor(b,h,r,B){super(!1,!1,!0);this.d1k=()=>{this.RLc.ILh(this.Mri,this.mpe,this.HYc)};this.e1k=(P,ca)=>{ca&&1===P&&(ca.columnsCountSpinButtonProps&&this.JY.setValue(dd.a.aF,ca.columnsCountSpinButtonProps.value),ca.columnsWidthSpinButtonProps&&(P=ca.columnsWidthSpinButtonProps,this.JY.setValue(dd.a.tG,[Ze.a.MJa(P.value,Ze.a.QOa(P.unitType.toLowerCase()))])),
ca.columnsSpacingSpinButtonProps&&(P=ca.columnsSpacingSpinButtonProps,this.JY.setValue(dd.a.una,Ze.a.MJa(P.value,Ze.a.QOa(P.unitType.toLowerCase())))),ca.columnsLineBetweenCheckboxProps&&this.JY.setValue(dd.a.separator,ca.columnsLineBetweenCheckboxProps.checked),this.h1k()&&(ca=Lw.mEd,this.gHk()?oG(this.Mri,this.JY,this.H$b):ca=ca!==Lw.mEd?ca:Box4Intl.Box4Strings.l_ColumnsDialogFailMessage,this.dispose(),ca!==Lw.mEd&&this.JIa(ca,this.d1k)))};this.h1k=()=>this.JY.hasProperty(dd.a.aF)&&this.JY.hasProperty(dd.a.tG)&&
this.JY.hasProperty(dd.a.una)&&this.JY.hasProperty(dd.a.separator);this.AQd=(P,ca,ra)=>Math.floor((P-(ca-1)*ra)/ca);this.Nof=(P,ca,ra)=>1==ca?0:Math.floor((P-ca*ra)/(ca-1));this.TAk=(P,ca,ra,Qa)=>{const tb=P/ca;ra<Lw.omc?(ra=Lw.omc,Qa=this.Nof(P,ca,ra)):ra>tb&&(ra=tb,Qa=this.Nof(P,ca,ra));return[ra,Qa]};this.PAk=(P,ca,ra,Qa)=>{const tb=(P-Lw.omc*ca)/(ca-1);0>Qa?(Qa=0,ra=this.AQd(P,ca,Qa)):Qa>tb&&(Qa=tb,ra=this.AQd(P,ca,Qa));return[ra,Qa]};this.MJa=(P,ca)=>Ze.a.MJa(P,Ze.a.QOa(ca));this.VKc=(P,ca,ra,
Qa,tb)=>({["unitType"]:P,["unitPlaceholder"]:F.a.T$d(ca),["minValue"]:ra,["maxValue"]:Qa,["step"]:tb});this.Mri=b.clone();this.JY=b.clone();this.mpe=h.clone();this.job=this.mpe.getValue(Mc.a.Ko)-this.mpe.getValue(Mc.a.marginLeft)-this.mpe.getValue(Mc.a.marginRight);this.ELb=Math.floor(this.job/Lw.omc);this.HYc=r;this.RLc=B;this.yg=Lw.id;b={};b.getUnitValue=3==Eb.App.Mia?Ze.a.Yz:Ze.a.xVa;b.getCalculatedWidthValue=this.AQd;b.getCalculatedSpacingValue=this.Nof;b.twipsFromValueAndUnits=this.MJa;b.adjustWidthForLimits=
this.TAk;b.adjustSpacingForLimits=this.PAk;b.pageContentWidth=this.job;b.maxColumnCount=this.ELb;b.columnsLabelProps={["type"]:"AppLabelProps",["id"]:"ColumnsSection",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogTitle,["forId"]:"ColumnsGroup"};b.columnsCountSpinButtonProps=this.$Rl();b.columnsWidthSpinButtonProps=this.dSl();b.columnsSpacingSpinButtonProps=this.bSl();b.columnsLineBetweenCheckboxProps=this.aSl();b={["id"]:"ColumnsDialog",["bodyControls"]:b};this.Uh(Box4Intl.Box4Strings.l_ColumnsDialogTitle,
this.e1k.bind(this),b)}$Rl(){var b=[this.VKc("None",0,1,this.ELb,1)];const h=this.Muf(dd.a.aF);b={["type"]:"AppSpinButtonProps",["id"]:"columnsCountSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogCount,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogCountAlt,["unitType"]:Ze.a.I0a(0),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};
return b=this.JQb(h,b)}dSl(){var b=[this.VKc("Inch",3,.5,Ze.a.Yz(this.job),.1),this.VKc("Centimeter",1,1.27,Ze.a.xVa(this.job),1)];const h=Eb.App.Mia,r=this.Muf(dd.a.tG);b={["type"]:"AppSpinButtonProps",["id"]:"columnsWidthSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogWidth,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogWidthAlt,["unitType"]:Ze.a.I0a(h),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,
["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.JQb(r,b)}bSl(){var b=[this.VKc("Inch",3,0,Ze.a.Yz(this.job-2*Lw.omc),.1),this.VKc("Centimeter",1,0,Ze.a.xVa(this.job-2*Lw.omc),1)];const h=Eb.App.Mia,r=this.Muf(dd.a.una);b={["type"]:"AppSpinButtonProps",["id"]:"columnsSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogSpacingAlt,["unitType"]:Ze.a.I0a(h),["validUnits"]:b,["numberFormatInfo"]:{["negativeSign"]:"-",
["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}};return b=this.JQb(r,b)}aSl(){const b=this.JY.getValue(dd.a.separator);return{["type"]:"AppCheckboxInternalProps",["id"]:"columnsLineBetweenCheckbox",["label"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetween,["customTooltip"]:Box4Intl.Box4Strings.l_ColumnsDialogLineBetweenAlt,["checked"]:b}}get H$b(){return null!=this.SAg?this.SAg:this.SAg=(()=>this.ucf())()}ucf(){const b=
{};b[dd.a.aF.id.toString()]=b[dd.a.tG.id.toString()]=b[dd.a.una.id.toString()]=b[dd.a.separator.id.toString()]=or.g1k;return b}gHk(){const b=this.JY.getValue(dd.a.tG),h=this.JY.getValue(dd.a.aF),r=this.JY.getValue(dd.a.una);let B=0;for(let P=0;P<h;P++)B+=b[0];if(h<=this.ELb&&(h-1)*r+B<=this.job)return!0;t.ULS.sendTraceTag(509723422,336,15,"Invalid inputs for Columns Dialog - does not fit in page content space.  Count: {0}, Width: {1}, Spacing: {2}",h,b[0],r);return!1}Muf(b){if(this.JY.hasProperty(b)){if(b==
dd.a.aF)return this.JY.getValue(b);if(b==dd.a.tG){var h=Eb.App.Mia;b=this.JY.getValue(dd.a.una);const r=this.JY.getValue(dd.a.aF);return Ze.a.F9a(this.AQd(this.job,r,b),h)}if(b==dd.a.una){if(1==this.JY.getValue(dd.a.aF))return 0;h=Eb.App.Mia;b=this.JY.getValue(b);return Ze.a.F9a(b,h)}}return 0}JQb(b,h){h.value=isNaN(b)?Lw.mEd:b;return h}}Lw.id="ColumnsDialog";Lw.mEd="";Lw.omc=720;Object(m.a)(Lw,"WordReactColumnsDialog",Pe.a,[]);class wI{F9k(b){new IE(b,Ma.a.instance.resolve("Box4.IFeatureHelper"))}Jcl(b,
h){new mI(b,h,Ma.a.instance.resolve("Box4.IFormattingReader"),Ma.a.instance.resolve("Box4.Styles.IWACStyleReader"),qo.PageNavigator.instance)}Jtl(b,h,r){new nI(b,h,r)}TMh(b,h,r){new BA(b,h,r,Ma.a.instance.resolve("WordEditor.IPageCommands"),Ma.a.instance.resolve("Common.IStandaloneRootController").pea)}xNh(b,h,r){new Jt(b,h,r,Ma.a.instance.resolve("WordEditor.IPageCommands"),Ma.a.instance.resolve("Common.IStandaloneRootController").pea)}ILh(b,h,r){new Lw(b,h,r,Ma.a.instance.resolve("WordEditor.UI.IDialogFactory"))}Z8k(b){return new YD(b)}BJd(b,
h,r){new vI(b,h,r,v.AFrameworkApplication.va)}mll(){const b=Ma.a.instance.Oa("Box4.IRoamingServiceRequestManager");null==b?Qc.b(524834398,3018,10,"Roaming service not resolved."):new dI(b)}rll(b,h){new eI(b,h)}Eef(b){return new fI(b)}}Object(m.a)(wI,"DialogFactory",null,[255,256]);class JF extends Pe.a{constructor(b,h){super(!1,!1,!0);this.hUh="DoNotCheckSpellingCheckbox";this.wUh="DocumentChoiceGroup";this.tjd=0;this.JFi="LanguageList";this.documentContext="DocumentContext";this.jr="RangeContext";
this.pko=(r,B)=>{const P=Nh.a.instance.Fp(Nb.a.umj);if(1!==r)P.properties.Z("canceled","true");else{r=B[this.JFi].replace(JF.Tug,"");var ca=parseInt(r),ra=Boolean.parse(B[this.hUh]);B=B[this.wUh];B===this.documentContext?this.iqd.eio(ca,ra):this.iqd.uno(ca,ra);P.properties.Z("PreviousLCID",this.tjd.toString());P.properties.Z("ChangedLCID",ca.toString());P.properties.Z("NoProof",ra.toString());this.T3g.oko(ca,this.tjd);Ke.d(Nb.a.umj,!0,void 0,void 0,void 0,void 0,[Object.assign(new ha.a,{name:"SelectedLcid",
string:r}),Object.assign(new ha.a,{name:"NoProof",string:ra.toString()}),Object.assign(new ha.a,{name:"Context",string:B})]);Eb.App.za.updateCommandUI(!0)}P.end()};this.T3g=h;this.iqd=b}vhg(){const b=Array(2);b[0]={["key"]:this.jr,["text"]:WordEditorIntl.WordEditorStrings.l_SelectedText};b[1]={["key"]:this.documentContext,["text"]:WordEditorIntl.WordEditorStrings.l_CurrentDocument};const h={showDocumentChoiceGroup:!0};h.markSelectedText=Box4Intl.Box4Strings.l_MarkSelectedText;h.documentChoiceGroupProps=
{["id"]:this.wUh,["defaultSelectedKey"]:this.sVl(),["label"]:WordEditorIntl.WordEditorStrings.l_ChangeProofingLanguage,["options"]:b};this.tjd=({yKn:this.Z_j}=this.iqd.qdm()).returnValue;h.languageListPropsProvider=this.n2l();h.spellingCheckboxProps={["id"]:this.hUh,["checked"]:!this.Z_j,["label"]:WordEditorIntl.WordEditorStrings.l_DoNotCheckSpellingOrGrammar};this.Uh(Box4Intl.Box4Strings.l_Language,this.pko,{["id"]:"LanguageDialog",["bodyControls"]:h})}sVl(){return this.iqd.Ze()?this.documentContext:
this.jr}n2l(){return()=>{let b,h;const r=({selectedIndex:b,fvj:h}=this.T3g.m2l(this.tjd)).returnValue;for(let B=0;B<r.length&&B<h;B++)r[B].value=JF.Tug+r[B].value;return{["id"]:this.JFi,["items"]:r,["selectedLanguageIndex"]:b,["applyBorderIndex"]:h}}}}JF.Tug="recent-";Object(m.a)(JF,"ReactLanguageDialog",Pe.a,[254]);class xI extends tD{constructor(b,h,r,B){super(h,r);this.s1f=()=>{this.floatie.Hm()};this.Nh=b;this.JI=B}mgb(b,h,r){if(b=super.mgb(b,h,r))b.xic=!0,b.Cae=!0,b.preventDismissOnScroll=!0;
this.Nh.z_a(this.s1f);return b}PUc(b,h,r=null){this.JI.pxh(()=>this.mgb(b,h,r))}t7d(){this.floatie.xic=!0}}Object(m.a)(xI,"ExternalContentFloatieInitializer",tD,[]);class yI{ENb(){Cl.instance.Kpa&&(pt.instance.s9a([1,0]),Cl.instance.G1d()&&Ht.instance.s9a([1]))}}Object(m.a)(yI,"RulerUser",null,[246]);class zI{constructor(){this.whitelistedControlIds=null}}Object(m.a)(zI,"StatusBarProps",null,[]);class KF{constructor(b,h,r=!0){this.sa=new Pc.a;this.Wud=!1;this.QPe=null;this.iga=h.jH;this.iUe=h.$vj;
r?ij.a.get_instance().pk(7,()=>{this.uzh(b,h)}):this.uzh(b,h)}uzh(b,h){const r={};r.StatusBarBuildStartTime=Date.now();window.setTimeout(()=>{r.FirstTimeoutCallbackExecutionStartTime=Date.now();Wq.a.instance.ie(()=>{al.UISurfaces.qfm().then(B=>{r.StatusBarApiResolutionTime=Date.now();const P=Object.assign(new zI,{whitelistedControlIds:h.whitelistedControlIds});B.initializeNewStatusBar(b,P,this.iUe);this.QPe=B;this.Wud=!0;r.ReactStatusBarInitializedTime=Date.now();window.setTimeout(()=>{r.SecondTimeoutCallbackExecutionStartTime=
Date.now();Wq.a.instance.ie(()=>{const ca=[];if(h.gH){const ra=h.gH;for(let Qa in ra)ca.push(appChrome.actions.updateControlHiddenState(Qa,ra[Qa]));appChrome.api.dispatch(ca)}r.PollingStartTime=Date.now();this.ENb();r.PollingEndTime=Date.now();t.ULS.sendTraceTag(509748573,813,50,JSON.stringify(r))},"RSB:I2")},0);v.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.RaiseReactStatusBarInitializedEvent")&&this.NOn();return null}).catch(()=>{t.ULS.sendTraceTag(51656736,
324,10,"Failed to load React Status Bar API");return null})},"RSB:I1");if(h.Hra&&b){KF.mYg||(v.AFrameworkApplication.va.ra(fb.a.bwj,yd.a.frame,Object(z.a)(this,this.cwj,"statusBarTabAction")),v.AFrameworkApplication.va.ra(fb.a.awj,yd.a.frame,Object(z.a)(this,this.cwj,"statusBarTabAction")),KF.mYg=!0);const B=wp.a.MXd(h.Hra,h.Klj,b,!1);B.eI=!0;this.djc(B,fb.a.bwj,fb.a.awj)}},0)}ENb(){this.Wud&&this.iga&&window.setTimeout(()=>{this.iga(this.QPe.selectors.getStatusBarControlsMap(this.iUe),7)},0)}Qpb(b,
h){this.Wud&&window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(b,h))},0)}nV(b){this.Wud&&this.iga&&window.setTimeout(()=>{const h=this.QPe.selectors.getStatusBarControlsMap(this.iUe);if(h[b]){const r={};r[b]=h[b];this.iga(r,7)}},0)}djc(b,h,r){const B=Jb.KeyInputManager.ic(se.a.Iw,0),P=Jb.KeyInputManager.ic(se.a.Iw,4);b.nr(B);b.nr(P);b.bindAction(B,h);b.bindAction(P,r)}cwj(){return 4}NOn(){this.sa&&(this.sa.raiseEvent("RSBIE"),this.sa.dispose(),this.sa=null)}}
KF.mYg=!1;Object(m.a)(KF,"ReactStatusBar",null,[]);class AI{constructor(){this.whitelistedControlIds=this.gH=this.jH=null;this.IXm=!1;this.Klj=this.Hra=this.$vj=null}}Object(m.a)(AI,"ReactStatusBarInitOptions",null,[]);var ZD=c(446);class BI{constructor(b,h,r,B,P){this.r_b=this.dNa=this.Ca=null;this.ODo=()=>{const ca=Eb.App.za.Hp.getRegion(Qi.AppFrame.Hra);ca&&ca.uQf()};this.srm=(ca,ra,Qa,tb,Mb)=>{if(!Mb)return t.ULS.sendTraceTag(572135558,306,10,String.format("{0}","actionData is null for visibility toggle")),
8;if(1===Qa)return 32;Mb&&2===Mb.length&&this.dNa&&this.dNa.Qpb(Mb[0],Mb[0]);return 32};this.Ndd=ca=>{Eb.App.za.jH(ca)};this.ga=B;Wq.a.instance.ie(()=>{this.Ca=P;this.r_b=this.dNa=null;const ca={};v.AFrameworkApplication.gtj||(ca[ZD.a.f$n]=!0);ca.GiveFeedback=!v.AFrameworkApplication.MF;this.Ca.$("OfficeOnlineInGallatinTextVisible")||(ca.CenterStatusLabel=!0);ca[ZD.a.T_i]=!0;this.Ca.$("WPMPackageIsEnabled")&&this.Ca.$("WPMStatusBarLabelIsEnabled")||(ca[ZD.a.Ssg]=!0);this.Ca.$("AddInCommandsIsEnabled")||
(ca[ZD.a.mtk]=!0);this.Ca.$("WordEditorShowOcsConnectionStatus")||(ca[ZD.a.NUf]=!0);ca[ZD.a.m5o]=!0;this.Ca.$("ReadingTimeIsEnabled")||(ca[ZD.a.S7i]=!0);window.setTimeout(()=>{this.XBm(b,ca)},0)},"SBU:I")}Tb(){this.ga.fb(Nb.a.uke,yc.a.application,this.srm,96)}XBm(b,h){this.r_b=Ma.a.instance.Oa("WordEditor.WordEditorReactCommandDefinitionMapping");const r={};for(const P in h){var B=h[P];r[this.Rtf(P)]=B}this.dNa=new KF(b,Object.assign(new AI,{gH:r,jH:this.Ndd,IXm:!1,$vj:"WordEditorStatusBar",Hra:Qi.AppFrame.Hra,
Klj:this.ODo}))}Rtf(b){let h="";if(this.r_b){const r=this.r_b.Dqf(b);r&&0<r.count&&(h=r.J(0))}return h&&""!==h?h:b}ENb(){this.dNa&&this.dNa.ENb()}Qpb(b,h){this.dNa&&this.dNa.Qpb(this.Rtf(b),h)}nV(b){this.dNa&&this.dNa.nV(this.Rtf(b))}dispose(){}}Object(m.a)(BI,"StatusBarUser",null,[245,9]);var CI=c(1084);class eH{constructor(b){this.ga=b;this.ga.ra(fb.a.t7c,yd.a.frame,Object(z.a)(this,this.t7c,"reportFileMenuPageSwitch"));this.ga.ra(fb.a.sdj,yd.a.frame,cd.ActionManager.Of)}t7c(b,h,r,B,P){this.ga.processAction(this.ZXl(P[CI.a.T9d]),
2);return 32}}Object(m.a)(eH,"FileMenuSQMInformation",null,[909]);class DI extends eH{constructor(b){super(b);this.EVn()}EVn(){this.ga.ra(fb.a.L9f,yd.a.frame,cd.ActionManager.Of);this.ga.ra(fb.a.mdj,yd.a.frame,cd.ActionManager.Of);this.ga.ra(fb.a.M9f,yd.a.frame,cd.ActionManager.Of);this.ga.ra(fb.a.ndj,yd.a.frame,cd.ActionManager.Of);this.ga.ra(fb.a.odj,yd.a.frame,cd.ActionManager.Of);this.ga.ra(fb.a.N9f,yd.a.frame,cd.ActionManager.Of);this.ga.ra(fb.a.pdj,yd.a.frame,cd.ActionManager.Of);this.ga.ra(fb.a.qdj,
yd.a.frame,cd.ActionManager.Of);this.ga.ra(fb.a.rdj,yd.a.frame,cd.ActionManager.Of);this.ga.ra(fb.a.Sdj,yd.a.frame,cd.ActionManager.Of);this.ga.ra(fb.a.Tdj,yd.a.frame,cd.ActionManager.Of);this.ga.ra(fb.a.vdj,yd.a.frame,cd.ActionManager.Of);this.ga.ra(fb.a.wdj,yd.a.frame,cd.ActionManager.Of)}ZXl(b){switch(b){case "menuJewelAbout":case "FileAboutPage":return fb.a.L9f;case "tabHome":case "FileHomePage":return v.AFrameworkApplication.oe("1ba3i132;45gid285"),fb.a.mdj;case "menuJewelInfo":case "FileInfoPage":return fb.a.M9f;
case "menuJewelNew":case "FileNewPage":return fb.a.ndj;case "menuJewelOpen":case "FileOpenPage":return fb.a.odj;case "menuJewelPrint":case "FilePrintPage":return fb.a.N9f;case "menuJewelSaveAs":case "FileSaveAsPage":return fb.a.pdj;case "menuJewelShare":case "FileSharePage":return fb.a.qdj;case "menuJewelTransform":case "FileTransformPage":return fb.a.rdj}return fb.a.sdj}}Object(m.a)(DI,"WordEditorFileMenuSQMInformation",eH,[]);var EI=c(1082);class fH{constructor(b){this.ga=b;this.ga.ra(fb.a.u7c,
yd.a.frame,Object(z.a)(this,this.u7c,"reportTabSwitch"));this.ga.ra(fb.a.Ndj,yd.a.frame,cd.ActionManager.Of);this.ga.ra(fb.a.Pdj,yd.a.frame,cd.ActionManager.Of)}u7c(b,h,r,B,P){this.ga.processAction(this.kcm(P[EI.a.Nkg]),2);return 32}}Object(m.a)(fH,"RibbonSQMInformation",null,[863]);class FI extends fH{constructor(b){super(b);this.VXn()}VXn(){this.ga.ra(fb.a.Edj,yd.a.frame,cd.ActionManager.Of);this.ga.ra(fb.a.Gdj,yd.a.frame,cd.ActionManager.Of);this.ga.ra(qb.a.P9f,yd.a.frame,cd.ActionManager.Of);
this.ga.ra(fb.a.Hdj,yd.a.frame,cd.ActionManager.Of);this.ga.ra(fb.a.Idj,yd.a.frame,cd.ActionManager.Of);this.ga.ra(qb.a.Jdj,yd.a.frame,cd.ActionManager.Of);this.ga.ra(qb.a.Kdj,yd.a.frame,cd.ActionManager.Of);this.ga.ra(qb.a.Ldj,yd.a.frame,cd.ActionManager.Of);this.ga.ra(qb.a.Mdj,yd.a.frame,cd.ActionManager.Of);this.ga.ra(qb.a.Q9f,yd.a.frame,cd.ActionManager.Of);this.ga.ra(qb.a.Odj,yd.a.frame,cd.ActionManager.Of);this.ga.ra(fb.a.Qdj,yd.a.frame,cd.ActionManager.Of);this.ga.ra(qb.a.Rdj,yd.a.frame,cd.ActionManager.Of);
this.ga.ra(qb.a.Fdj,yd.a.frame,cd.ActionManager.Of)}kcm(b){switch(b){case "tabAddins":case "Addins":return fb.a.Edj;case "tabHome":case "Home":return fb.a.Hdj;case "tabInsert":case "Insert":return fb.a.Idj;case "tabDeveloper":case "Developer":return fb.a.Gdj;case "tabPageLayout":case "Layout":return qb.a.Jdj;case "tabReferences":case "References":return qb.a.Mdj;case "tabReview":case "Review":return qb.a.Q9f;case "tabView":case "View":return fb.a.Qdj;case "Table":case "TableLayout":case "ContextualTabs.Tables.Design":case "ContextualTabs.Tables.Layout":return qb.a.Odj;
case "tabMailings":case "Mailings":return qb.a.Kdj;case "tabWordDesign":case "Design":return qb.a.Rdj;case "tabHelp":case "Help":return qb.a.P9f;case "ctabPictureTools":case "Picture":return qb.a.Ldj;case "Copilot":return qb.a.Fdj}return fb.a.Pdj}}Object(m.a)(FI,"WordEditorRibbonSQMInformation",fH,[]);class GI{constructor(b=null,h=null,r=null){this.gH=b||{};this.$Bj=h||[];this.dCj=r||{}}}Object(m.a)(GI,"RibbonTrimmingProperties",null,[]);class HI{constructor(b,h,r){this.Pva=b;this.gH=h;this.oJf=r}}
Object(m.a)(HI,"ReactRibbonJewelProperties",null,[]);class II{constructor(){v.AFrameworkApplication.va.ra(fb.a.bSa,yd.a.frame,Object(z.a)(this,this.LPn,"reactFileMenuOpenFromTellMe"))}LPn(b,h,r,B,P){if(1===r)return 32;v.AFrameworkApplication.Oia("54hi9858;4f638686");if(!P)return 32;b=P.SourceControlId;17!==P.UILocation||"New"!==b&&"Open"!==b||(P=[],Hh.d("setFileMenuSelectedPage")&&("New"===b&&v.AFrameworkApplication.ua?2===v.AFrameworkApplication.ua.Kb.yk?P.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):
P.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===b&&v.AFrameworkApplication.ua&&(2===v.AFrameworkApplication.ua.Kb.yk?P.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):P.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),P.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(P));return 32}zGi(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}DTa(){return!1}I2i(){}RTh(){}}Object(m.a)(II,"ReactFileMenu",
null,[306]);class JI{dbf(){const b=new II,h=[];h.push(appChrome.actions.updateFileMenuExpandedValue(!1));h.push(appChrome.actions.updateFileMenuDisabledValue(!1));appChrome.api.dispatch(h);return b}}Object(m.a)(JI,"ReactFileMenuFactory",null,[298]);class KE{constructor(b,h,r,B=!1){this.znc=b;this.y1g=this.znc.u4a;this.B6d=Ma.a.instance.Oa("Common.IOfficeTrialExperience");this.vLb=Ma.a.instance.Oa("Common.IMacOfficeOffer");KE.tve=!1;this.iSm=B;this.ga=h;this.Vb=r}get oc(){return this.ga}get focusManager(){return this.Vb}W2e(){return this.y1g&&
!!this.B6d&&!!this.vLb}UVa(b,h){this.znc.Nn(()=>{t.ULS.sendTraceTag(5878046,340,50,"Full app settings are ready");this.y1g=!0;this.Cjf(b,h)});Ma.a.instance.Ta("Common.IOfficeTrialExperience").execute(r=>{t.ULS.sendTraceTag(5878049,340,50,"IOfficeTrialExperience object is ready");this.B6d=r;this.Cjf(b,h)});Ma.a.instance.Ta("Common.IMacOfficeOffer").execute(r=>{t.ULS.sendTraceTag(5878050,340,50,"IMacOfficeOffer object is ready");this.vLb=r;this.Cjf(b,h)})}Cjf(b,h){KE.tve||(this.W2e()?(t.ULS.sendTraceTag(5878051,
340,50,"ExecuteCallbackWhenReady: ready"),b(this,h),KE.tve=!0):t.ULS.sendTraceTag(5878080,340,100,"ExecuteCallbackWhenReady: not ready yet"))}}KE.tve=!1;Object(m.a)(KE,"RibbonDependencies",null,[784]);class gH{constructor(b,h,r){this.nvb=b;this.ga=h;this.Vb=r}}Object(m.a)(gH,"WoncaRibbonUserFactory",null,[709]);class KI{constructor(b,h){this.Hwe=b;this.Z1b=h}jqb(b){this.Hwe.jqb(b);this.Z1b&&this.Z1b.jqb(b)}D9c(b){this.Hwe.D9c(b);this.Z1b&&this.Z1b.D9c(b)}Qdd(b){this.Hwe.Qdd(b);this.Z1b&&this.Z1b.Qdd(b)}}
Object(m.a)(KI,"RibbonCommandTrimmer",null,[268]);var sM=c(1257),tM=c(1172);class LI{constructor(b,h){this.Ca=b;this.F_b=h}jqb(b){Z.a.vi&&6>Z.a.B3a&&(b.fseaInsertPicture=!0);this.Ca.$("InsertSymbolIsEnabled")||(b.grpInsertSymbols=!0);this.Ca.$("ClipartInsertEnabled")||(b.fseaInsertClipart=!0);this.Ca.$("UIDiscoverabilityEnabled")||(b.jbtnAccessibilityHelp=!0);tB.a.LAi()||(b.InsertLoopComponentsForConsumers=!0);const h=this.Ca.$("InsertOnlinePictureEnabled"),r=v.AFrameworkApplication.NFf();h||(b.fseaInsertOnlinePicture=
!0,b.fseaFlyInsertOnlinePictureFromSearch=!0);r?b.fseaInsertPictureFromOneDrive=!0:(b.fseaFlyInsertOnlinePictureFromHost=!0,b.fseaInsertOnlinePictureFromHost=!0);r&&h?(b.fseaInsertOnlinePicture=!0,b.fseaInsertOnlinePictureFromHost=!0):b.flyOnlinePicture=!0;v.AFrameworkApplication.OFf()||(b.InsertPictureFromMobileDevice=!0,b.ChangePictureFromMobileDevice=!0);v.AFrameworkApplication.joc&&(b.btnOpenInClient=!0);v.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&v.AFrameworkApplication.K.$("DisablePrint")&&
this.koc(b)}D9c(b){b.menuJewel=!0;v.AFrameworkApplication.MF||(b.jbtnGiveFeedback=!0)}koc(b){b.faPrint=!0;b.jbtnSaveACopy=!0;b.jbtnSaveAsToHost=!0;b.jbtnSaveToSharePoint=!0;b.jbtnDownloadACopy=!0;b.jbtnDownloadAsPdf=!0;b.jbtnDownloadAsOdt=!0;b.jbtnPrintToPdf=!0;b.jbtnDirectPrint=!0}Qdd(b){delete b.menuJewel;v.AFrameworkApplication.privacyUrl||(b.jbtnPrivacy=!0);v.AFrameworkApplication.r7c||(b.jbtnReportAbuse=!0);v.AFrameworkApplication.Qle||(b.jbtnTermsOfUse=!0);v.AFrameworkApplication.rOd||(b.jbtnFileSharing=
!0);v.AFrameworkApplication.ipb||(b.jbtnShareRWC=!0);v.AFrameworkApplication.Kkf||v.AFrameworkApplication.Qqg||(b.jbtnVersion=!0);this.F_b.B6d&&this.F_b.B6d.Ujn||(b.btnjTryOffice=!0,b.btnjTryOfficeForWordEditor=!0);this.F_b.vLb&&this.F_b.vLb.mto||(b.btnjTryMacOffice=!0,b.btnjTryMacOfficeForWordEditor=!0);v.AFrameworkApplication.joc?(b.btnjOpenInClient=!0,b.btnjEditInClient=!0):b[Eb.App.Fs?"btnjOpenInClient":"btnjEditInClient"]=!0;v.AFrameworkApplication.zOo&&(b.jbtnDownloadACopy=!0,b.jbtnDownloadAsPdf=
!0,b.jbtnDownloadAsOdt=!0);v.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&v.AFrameworkApplication.K.$("DisablePrint")?this.koc(b):v.AFrameworkApplication.K.$("DirectPrintIsEnabled")?b.jbtnPrintToPdf=!0:b.jbtnDirectPrint=!0;v.AFrameworkApplication.EF&&(this.koc(b),b.faShare=!0);if(v.AFrameworkApplication.cZ||Z.a.NRa||!v.AFrameworkApplication.LTc&&!v.AFrameworkApplication.Bkf&&!v.AFrameworkApplication.Oqg)b.jbtnFileEmbed=!0;sM.a.lym()||(b.btnjClose=!0);v.AFrameworkApplication.VJb?(b.jbtnVersion=
!0,t.ULS.sendTraceTag(594629315,3005,15,"Word external version history menu item for OneDriveConsummer trimmed.")):v.AFrameworkApplication.F1d()||(b.btnjVersionHistory=!0);b.jbtnVersion&&b.btnjVersionHistory&&b.btnjOpenInClient&&b.btnjEditInClient&&(b.faInfo=!0);v.AFrameworkApplication.P5f||(b.faOpen=!0);b.jbtnFileSharing&&b.jbtnFileEmbed&&b.jbtnShareRWC&&(b.faShare=!0);b.AboutInformationMenuSectionDiagnostics=!this.Ca.$("DiagnosticsInfoInJewelAboutMenuIsEnabled");b.btnjTryOffice&&b.btnjTryMacOffice&&
b.jbtnTermsOfUse&&b.jbtnPrivacy&&b.AboutInformationMenuSectionDiagnostics&&(b.faAbout=!0);b.jbtnHelp&&b.jbtnGiveFeedback&&b.jbtnReportAbuse&&(b.faHelp=!0);b.btnjClose&&(b.msJewelSecondary=!0);const h=!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.ZBi;if(b.faOpen&&b.faNew||!h)b.faHome=!0;if(v.AFrameworkApplication.cL||".ODT"===Eb.App.eOc.toUpperCase()||!v.AFrameworkApplication.K.$("WordEditorAppsForOfficeRibbonIsEnabled")||!tM.a.PCd||v.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled"))b.faGetAddinsFromBackstage=
!0}}Object(m.a)(LI,"WoncaCommandTrimmer",null,[268]);var uM=c(1020);c(439);var vM=c(1083),wM=c(1171);class MI{constructor(b,h){this.V2=this.zK=null;this._clientId=b;this.iba=h}Rxl(){if(!nf.c(this.V2))return this.V2;this.Pif();this.V2.style.display="block";this.iba&&this.iba.E_(Object(z.a)(this,this.onResize,"onResize"));return this.V2}onResize(){this.yza()}yza(){this.vif()?(document.getElementById("application").style.minWidth="0px",(new wM.a(this.V2,null,v.AFrameworkApplication.isRtl)).cbo(this.V2)):
v.AFrameworkApplication.ua.Kb.MJ||vM.a.dbo(this.V2,v.AFrameworkApplication.isRtl)}vif(){return v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("EnhancedMobileViewIsEnabled"):!1}Pif(){if(nf.c(this.zK)){var b;({sTc:b}=wp.a.Ocd(!v.AFrameworkApplication.nY)).returnValue?(this.zK=cD.a("div"),this.zK.className=wp.a.mAl,this.zK.id=vl.CuiHelper.PNd,b.appendChild(this.zK),this.Iif(),v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.C9&&!v.AFrameworkApplication.nY&&this.Jif(),this.Qxl()):v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.$("ReactHeaderCrashLogs")&&t.ULS.sendTraceTag(509116637,340,50,"HeaderSkeleton.EnsureHeaderDom: Couldn't ensure header dom since HeaderPanel doesn't exist")}}Qxl(){nf.c(this.V2)&&(this.V2=cD.a("div"),this.V2.className=wp.a.kng,this.V2.style.display="none",this.zK.appendChild(this.V2))}Iif(){Sys.UI.DomElement.addCssClass(this.zK,wp.a.nAl);v.AFrameworkApplication.isRtl&&cD.b(this.zK,"cui-rtl")}Jif(){Sys.UI.DomElement.addCssClass(this.zK,"FlexBoxLayout")}}Object(m.a)(MI,"HeaderSkeleton",
null,[]);var LE=c(626);class hH{constructor(){this.xqc=null}yQo(){this.xqc||(this.xqc=Ma.a.instance.Oa("Common.App.AccountSwitching.IAccountSwitching"))||t.ULS.sendTraceTag(589050651,1300,10,"Unable to resolve IAccountSwitching")}jMl(){this.yQo();return this.xqc?this.xqc.getCustomAuthConfig():null}static LKm(){return v.AFrameworkApplication.K.$("UiHostSupportsCustomAuthConfig")}}Object(m.a)(hH,"ReactSharedHeaderAccountSwitchingUtils",null,[]);class iH{constructor(){this.tKb=this.cultureName=null}}
Object(m.a)(iH,"HeaderCultureInfo",null,[]);var sG=c(1652);class NI{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=null}}Object(m.a)(NI,"SearchInitializationSettings",null,[]);var ME=c(295);class OI{constructor(){this.saveStatus=this.documentTitle=null;this.isVersionHistoryEnabled=!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.hideDocumentTitleInput=!1;this.getCalloutAppProps=this.onFirstRender=
this.onGetSuggestedTitle=this.documentExtension=null;this.isShared=!1}}Object(m.a)(OI,"DocumentTitleAppProps",null,[]);class PI{constructor(){this.documentExtension=this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=!1;this.renameDisableReason=this.message=this.onMove=null;this.openBreadcrumbsInNewTab=!1}}Object(m.a)(PI,"DocumentTitleCalloutAppProps",null,[]);class QI{constructor(){this.language=
this.culture=this.userID=this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showDiscoverPremiumButton=this.showMeControl=this.showAppLauncher=this.isConsumer=!1;this.documentTitleAppProps=this.controls=this.assetsContainerOverride=null;this.showGoPremiumControl=this.enableSearchControl=this.showSearchControl=this.showChatControl=!1;this.onFlexPaneClose=this.onFlexPaneOpen=this.getTokenRequestDictionary=this.signOutLink=this.signInLink=null;
this.enableTheming=!1;this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=this.showRibbonToggle=this.showWorkflowButton=this.enableVanillaSearchBox=!1;this.shellAuthProviderConfigPromise=null;this.enableUpdatedRUMReporting=!1}}Object(m.a)(QI,"HeaderAppProps",null,[]);class RI{constructor(){this.workflowButton=this.ribbonToggleId=null}}Object(m.a)(RI,"HeaderControls",null,[]);class SI{constructor(){this.command=
this.label=null}}Object(m.a)(SI,"WorkflowButtonAppProps",null,[]);var tG;(function(b){b[b.none=0]="none";b[b.readOnly=1]="readOnly";b[b.insufficientPermission=2]="insufficientPermission";b[b.incompatibleEditorsPresent=3]="incompatibleEditorsPresent";b[b.editorsPresent=4]="editorsPresent";b[b.notSupported=5]="notSupported"})(tG||(tG={}));Object(m.b)("RenameDisableReason",tG);class TI{constructor(b=""){this.Abg=this.documentTitleAppProps=this.Qsg=null;this.$kk=""!==b?b:Bd.a.Z5}ebm(b){const h=Ma.a.instance.Oa("Common.IExternalUICommandDefinitionMapping").NFb(b);
if(h&&0<h.length)return h[0].externalUxCommand;t.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",b));return null}Cwf(){if(!this.Qsg){const b=LE.a();if(b){const h=this.ebm(b.command);h&&(this.Qsg=Object.assign(new SI,{command:h,label:b.label}))}}return this.Qsg}ITl(){return Object.assign(new RI,{workflowButton:this.Cwf()})}Wnn(){ij.a.get_instance().nI(17)}onMove(){const b={};b.MoveButtonClickedTime=new Date;v.AFrameworkApplication.va.Qb(fb.a.OLb,
2,b)}Ebm(b){switch(b){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}iWl(){let b=null,h=null;var r=Ma.a.instance.Oa("Common.IRenameProps");r?(r=r.ggi(),0!==r&&(b=this.Ebm(r),h=tG[r])):t.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new PI,{breadcrumbBrandName:v.AFrameworkApplication.Js.breadcrumbBrandName,
breadcrumbBrandUrl:v.AFrameworkApplication.Js.breadcrumbBrandUrl,breadcrumbFolderName:v.AFrameworkApplication.Js.breadcrumbFolderName,breadcrumbFolderUrl:v.AFrameworkApplication.Js.breadcrumbFolderUrl,hideDocumentTitleInput:v.AFrameworkApplication.ua.Kb.yum,isVersionHistoryEnabled:this.Cuo(),documentExtension:F.a.Mha(v.AFrameworkApplication.fileName),isMoveEnabled:32===v.AFrameworkApplication.va.processAction(fb.a.OLb,1),onMove:Object(z.a)(this,this.onMove,"onMove"),message:b,renameDisableReason:h,
openBreadcrumbsInNewTab:v.AFrameworkApplication.K.$("OpenLinksInNewWindow")})}h9h(){if(!this.documentTitleAppProps){const b=v.AFrameworkApplication.Js.xz;this.documentTitleAppProps=Object.assign(new OI,{documentTitle:v.AFrameworkApplication.NLd?b:F.a.yJ(b),onFirstRender:Object(z.a)(this,this.Wnn,"onDocumentTitleFirstRender"),getCalloutAppProps:Object(z.a)(this,this.iWl,"getDocumentFlyoutProperties"),isShared:!1})}return this.documentTitleAppProps}Cuo(){return!!v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.XCi}mso(){return!!v.AFrameworkApplication.ua&&
v.AFrameworkApplication.ua.Kb.WCi}juo(){const b=!LE.b()&&!v.AFrameworkApplication.hideHeader&&!v.AFrameworkApplication.Czf&&(v.AFrameworkApplication.K.$("SkypeWebControlIsEnabled")||v.AFrameworkApplication.K.$("TeamsChatIsEnabled"));t.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",b);return b}D6k(b){appChrome.getHeaderApi().then(h=>{h.setNavBarData(b.result);return null});t.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")}SUn(b=!1){appChrome.getHeaderApi().then(h=>
{const r=Ma.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");h.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});h.setHeaderCommandHandler("OnFullyLoaded",()=>{this.onFullyLoaded()});h.setHeaderCommandHandler("OnFlexPaneOpen",B=>{r.onFlexPaneOpen(B)});h.setHeaderCommandHandler("OnFlexPaneClose",B=>{r.onFlexPaneClose(B)});h.setHeaderCommandHandler("SetCookie",B=>Hc.a.set(B.cookieName,B.value));h.setHeaderCommandHandler("GetCookie",B=>this.KTl(B));h.setHeaderCommandHandler("QueryWorkflowButtonSettings",
Object(z.a)(this,this.Cwf,"getWorkflowButtonAppProps"));b||(h.setHeaderCommandHandler("QueryDocumentTitleAppProps",Object(z.a)(this,this.h9h,"getDocumentTitleAppProps")),h.setHeaderCommandHandler("OnDocumentTitleReducerReady",()=>{this.Xnn();return null}));sG.a.K0d()&&h.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(z.a)(this,this.Sgi,"getSearchInitializationSettings"))})}Xnn(){Ma.a.instance.Ta("Common.App.SaveStatus.ISaveStatusUIHandler").execute(b=>{b.Wrb(!1,v.AFrameworkApplication.va.mode)})}KTl(b){b=
Hc.a.get(b);void 0!==b&&null!==b&&0<b.length&&(b=decodeURIComponent(b));return b}cgm(){return ME.AppChromeOverrideUtilities.isEnabled?ME.AppChromeOverrideUtilities.FTd("suiteux-shell",!1):this.$kk+v.AFrameworkApplication.Tja+"suiteux-shell"}onFirstRender(){Ma.a.instance.Ta("Common.App.O365Shell.IO365ShellActor").execute(b=>{b.ero.continueWith(Object(z.a)(this,this.D6k,"continueShellServiceDataAsync"),3)});ij.a.get_instance().nI(15)}onFullyLoaded(){ij.a.get_instance().nI(16)}Wha(b=!1){a:{try{var h=
lj.a.tg(v.AFrameworkApplication.lcid);if(h){var r=Object.assign(new iH,{cultureName:h.name,tKb:h.tKb});break a}}catch(B){t.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+v.AFrameworkApplication.lcid.toString())}r=Object.assign(new iH,{cultureName:"en-us",tKb:"en"})}h=Ma.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");r=Object.assign(new QI,{appName:CommonUIStrings.l_AppNameShort,culture:r.cultureName,language:r.tKb,isConsumer:!v.AFrameworkApplication.Tqg,
showAppLauncher:LE.h(),showMeControl:LE.g(),hideUserName:v.AFrameworkApplication.GWd,defaultDocumentTitleToLeft:v.AFrameworkApplication.qQh,assetsContainerOverride:this.cgm(),controls:this.ITl(),documentTitleAppProps:b?null:this.h9h(),showDocumentTitleControl:!b,showWorkflowButton:!!this.Cwf(),showChatControl:this.juo(),showGoPremiumControl:LE.i(),showDiscoverPremiumButton:LE.f(),enableSearchControl:sG.a.hUm(),onFlexPaneOpen:Object(z.a)(h,h.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(z.a)(h,
h.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.mso(),testTraffic:v.AFrameworkApplication.K.$("SharedHeaderTestTrafficIsEnabled"),onFirstRender:Object(z.a)(this,this.onFirstRender,"onFirstRender"),onFullyLoaded:Object(z.a)(this,this.onFullyLoaded,"onFullyLoaded"),enableUpdatedRUMReporting:v.AFrameworkApplication.nso()});!v.AFrameworkApplication.rTb||v.AFrameworkApplication.cig?(r.userDisplayName=v.AFrameworkApplication.userName,r.emailAddress=v.AFrameworkApplication.K.kb("UserPrincipalName"),
r.userID=v.AFrameworkApplication.K.kb("Puid")||"",r.signOutLink=v.AFrameworkApplication.cig):v.AFrameworkApplication.signInUrl&&(r.signInLink=v.AFrameworkApplication.signInUrl);sG.a.K0d()&&(h=this.Sgi(),r.loadTellMeResources=h.loadTellMeResources,r.getTokenRequestDictionary=h.getTokenRequestDictionary,r.enableVanillaSearchBox=v.AFrameworkApplication.K.$("VanillaSearchUxInHeaderIsEnabled"),r.userRing=h.userRing);hH.LKm()&&(h=new hH,r.shellAuthProviderConfigPromise=Object(z.a)(h,h.jMl,"getAccountSwitchingConfig"));
this.SUn(b);v.AFrameworkApplication.oe("1fb8i225;405dc927;4057j379;7eb0a923;82d02276;c29b9277;bcge5509;d960a232");return r}Sgi(){if(!this.Abg){const b=new sG.a;let h=v.AFrameworkApplication.K.kb("Microsoft365Ring");h&&h.length||(h="generalAudience");this.Abg=Object.assign(new NI,{loadTellMeResources:b.f3m(),getTokenRequestDictionary:Object(z.a)(b,b.pim,"getTokenRequestDict"),userRing:h})}return this.Abg}}Object(m.a)(TI,"ReactSharedHeaderPropsHelper",null,[952]);class jH{constructor(){this.label=this.value=
null}}Object(m.a)(jH,"TextInfoSectionField",null,[]);var LF=c(950),xM=c(1235);class kH{constructor(){this.commandId=0;this.externalUxCommand=null}}Object(m.a)(kH,"CommandDefinition",null,[]);class UI{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=this.getDoNothingCommand=this.getCommandByExternalUxId=null}}Object(m.a)(UI,"CommandDefinitionMapping",null,[]);const yM=b=>Object.assign(new UI,{getCommandByExternalUxId:h=>{const r=b.getCommandByExternalUxId(h);return r?Object.assign(new kH,
{commandId:parseInt(r.commandId),externalUxCommand:r.externalUxCommand}):Object.assign(new kH,{externalUxCommand:h})},getDoNothingCommand:()=>parseInt(fb.a.Kg),addCommandToMaps:Object(z.a)(b,b.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(z.a)(b,b.addIconToMap,"addIconToMap"),addTabToMap:Object(z.a)(b,b.addTabToMap,"addTabToMap")});var zM=c(1407);class VI{}Object(m.a)(VI,"RibbonInitState",null,[]);var WI=c(415),AM=c(1344);class XI{constructor(){}flatten(b){const h=[];for(const r of b)h.push.apply(h,
r);return h}}Object(m.a)(XI,"ReactAsyncDispatcher",null,[]);var BM=c(1692);class YI{constructor(b,h){this.ukk=b;this.wZj=h}}Object(m.a)(YI,"ReactExecuteCommandContext",null,[]);class By{}By.Trigger="FontTrigger";By.Name="FontName";By.Action="FontAction";By.Level="FontLevel";By.IsPinned="FontIsPinned";Object(m.a)(By,"FontPickerLogProperties",null,[]);class ZI{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb=null,Zb=null){this.f_=null;this.tgh=!1;this.DAe=[];this.pjd=-1;this.Tyd=!1;this.Flk=0;this.zsc=null;this.cch=
!1;this.Uid=null;this.n6g=!1;this.Vfa=b;this.odb=h;this.lRe=Object(Ra.a)(867,b);this.sl=r;this.Vb=B;P&&(this.f_=new BM.a(P,B));this.Whk=ca;this.T2j=ra;this.rp=Mb;this.ga=Qa;this.Dwb={};this.Ca=tb;this.gwg=Zb;tb&&(tb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",!1)||tb.$("EnqueueTasksWhenTaskMgrIsYielding"))&&Xk.a.instance.aDd.CWR(()=>this.tgh=!0);tb&&(b=this.Ca.kb("CommandControlIdPairsForLoggingOverride")||"")&&0<=b.trim().length&&({Gt:this.zsc}=H.d(b));
this.zsc||(this.zsc={})}get Yfe(){return!!window.appChrome&&!!appChrome.selectors}Shj(){-1!==this.pjd&&window.clearTimeout(this.pjd);this.pjd=window.setTimeout(()=>{for(this.pjd=-1;0<this.DAe.length;){if(Wg.a.instance.Rv){this.Shj();break}const b=this.DAe.shift();b&&this.executeCommand(b.ukk,b.wZj)}},0)}executeCommand(b,h){if(Wg.a.instance.Rv){if(this.tgh){this.DAe.push(new YI(b,h));this.Shj();return}t.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",
b,h.modelType,kb.a.toJSON(h.payload));if(this.Ca.$("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(h){const r=this.sl.getCommandByExternalUxId(b),B=h.modelType;this.gwg&&this.gwg.x4m(b,h);r?this.Yyl(b,r,B,h):this.Zyl(b,B,h);this.QVk(h);this.lOo(h);this.r$m(b,h)}}Zyl(b,h,r){switch(h){case "GalleryModel":case "PreviewGalleryModel":this.SYh(r,b);break;case "ButtonModel":this.Tyl(r,b)}}OYo(b,h,r,B,P){if(r.payload)switch(r.payload.type){case "CoauthorMenuPayload":b.MenuItemId=r.payload.coauthorId;
break;case "ButtonPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=r.payload.commandValueId;b.TerminalParentControlId=r.payload.terminalParentControlId;this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutListViewEnabled",!1)?(h=!0,nf.c(r.payload.dismissHostingSurfaceOnExecute)||(h=r.payload.dismissHostingSurfaceOnExecute),h&&this.e4()):this.e4();break;case "ButtonPreviewPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=r.payload.commandValueId;P=h.commandPreviewId;break;
case "ButtonRevertPreviewPayload":b.MenuItemId=h.menuItemId;b.CommandValueId=r.payload.commandValueId;P=h.commandRevertId;break;default:b.MenuItemId=h.menuItemId}else b.MenuItemId=h.menuItemId;b.SourceControlId=B;return P}PYo(b,h,r){if(h.payload)switch(h.payload.type){case "MenuOpenPayload":b=this.sl.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;break;case "MenuClosePayload":b=this.sl.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":r.CommandId=
h.payload.executedControl;r.ControlId=h.payload.executedControl;r.ParentControlId=h.payload.parentControl;r.CloseAllMenus=!0;this.e4();break;case "TellMeSearchResultChangePayload":r.Value=h.payload.searchText;break;case "SmartLookupPayload":r.CommandValueId=h.payload.selectionContextJson}return b}Yyl(b,h,r,B){var P=this.uEn(B,r),ca=h.commandId;const ra={},Qa={};switch(r){case "SplitButtonModel":if(this.RSc(B.payload,Object(z.a)(this,this.TZo,"updateSplitButtonMenuState"),P))return;ra.MenuItemId=h.menuItemId;
this.Veg(B,ra);break;case "StatefulSplitButtonModel":if(this.RSc(B.payload,Object(z.a)(this,this.ZZo,"updateStatefulSplitButtonMenuState"),P))return;r=B.payload.statefulData;P=B.payload.statefulMode;"color"===P?ra.Color=r:"icon"===P&&(r=this.sl.getCommandByExternalUxId(r))&&(ra.MenuItemId=r.menuItemId);break;case "FileMenu":ra.MenuItemId=h.menuItemId;ra.SourceControlId=b;B.payload&&"FileMenuPageSwitchPayload"===B.payload.type&&this.Zom(ca,B.payload,b);break;case "TellMe":ca=this.PYo(ca,B,ra);ra.SourceControlId=
b;ra.Location=B.payload.location;break;case "ButtonModel":B.payload&&"TabSwitchPayload"===B.payload.type?this.Wqm(ra,B):ca=this.OYo(ra,h,B,b,ca);break;case "CompoundButtonModel":ra.MenuItemId=h.menuItemId;ra.CommandValueId=B.payload.commandValueId;ra.SourceControlId=b;this.Veg(B,ra);this.e4();break;case "ToggleButtonModel":case "InkButtonModel":ra.MenuItemId=h.menuItemId;ra.SourceControlId=b;this.Veg(B,ra);this.e4();break;case "FontPickerModel":switch(B.payload.type){case "MenuOpenPayload":ca=this.sl.getCommandByExternalUxId("FontPickerMenuOpen").commandId;
ra[zx.a.FontPickerId]=B.payload.launcherId;break;case "MenuClosePayload":ca=this.sl.getCommandByExternalUxId("FontPickerMenuClose").commandId;ra[zx.a.FontPickerId]=B.payload.launcherId;break;case "FontPickerFontSelectedPayload":r=B.payload.font;P=null;"string"===typeof r?(P=hp.FontUtils.FSa(r),ra.CommandValueId=P,P=hp.FontUtils.yJd(P)):(r.data?(ra.CommandValueId=r.data.fontToApply,ra.MenuItemId=r.data.themeIndex,ra[zx.a.Formatting]=r.data):ra.CommandValueId=r.name,P=r);ra.SourceControlId=b;ra[zx.a.RequestUpdateMru]=
P;Qa[By.Name]=B.payload.nameToLog?B.payload.nameToLog:"string"===typeof r?hp.FontUtils.uZd(r)?"*"+r:hp.FontUtils.MEf(r)?"[EF]":"[MF]":"";Qa[By.IsPinned]=B.payload.isPinned;Qa[By.Level]=B.payload.level;this.kNf();break;case "FontPickerFontInfoRequestedPayload":ra.CommandValueId=B.payload.font.name;ra[zx.a.Trigger]=B.payload.trigger;Qa[By.Trigger]=B.payload.trigger;Qa[By.Name]=B.payload.nameToLog;this.kNf();break;case "FontPickerFontPinningPayload":r=B.payload.isPinned;ra.CommandValueId=B.payload.fontKey;
ra[zx.a.IsPinned]=r;Qa[By.Name]=B.payload.nameToLog;Qa[By.Action]=r?"pin":"unpin";Qa[By.Level]=B.payload.level;this.kNf();break;default:return}break;case "ComboBoxModel":var tb=B.payload.type;switch(tb){case "MenuOpenPayload":case "MenuPopulatePayload":this.Ilc(B.payload.launcherId,P)&&(ca={},ca[B.payload.launcherId]=r,this.odb.Y3c(ca,Hh.g(B.payload)),this.Dwb[b]=new Date);return;case "MenuClosePayload":return;case "ComboBoxPayload":case "ComboBoxPreviewPayload":r=B.payload.newValue;if(!r)return;
r.value?(ra[dh.a.Value]=r.value,ra[dh.a.IsFreeForm]=!0):(ra[dh.a.Value]=r.text,ra.MenuItemId=r.key,ra.CommandValueId=r.commandValueId);"ComboBoxPreviewPayload"===tb&&(ca=h.commandPreviewId);break;case "ComboBoxRevertPreviewPayload":ca=h.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(B.payload.type){case "ZeroTermContextMenuClosePayload":r=kb.a.gP(B.payload);for(tb of r)ra[tb]=B.payload[tb];break;default:this.RSc(B.payload,Object(z.a)(this,this.kWo,"updateFlyoutAnchorMenuState"),
P),ra.launcherId=B.payload.launcherId}break;case "InkFlyoutAnchorModel":this.RSc(B.payload,Object(z.a)(this,this.nXo,"updateInkFlyoutAnchorMenuState"),P);ra.launcherId=B.payload.launcherId;break;case "ColorPickerModel":switch(B.payload.type){case "ColorPickerPayload":ra[cb.Color]=B.payload.selectedColorId;ra.colorRGB=B.payload.color;break;case "ColorPickerPreviewPayload":ca=h.commandPreviewId;ra[cb.Color]=B.payload.selectedColorId;break;case "ColorPickerRevertPreviewPayload":ca=h.commandRevertId;
break;default:return}break;case "SpinButtonModel":ra[Pi.a.Number]=B.payload.value;ra[Pi.a.UnitType]=Ze.a.QOa(B.payload.unitType.toLowerCase());ra[Pi.a.Text]=B.payload.reservedValue;break;case "SliderModel":ra[Jn.Value]=B.payload.value;break;case "InsertTableModel":ra[rj.a.Rows]=B.payload.rows;ra[rj.a.Columns]=B.payload.columns;break;case "CheckboxModel":ra[qg.a.On]=B.payload.checked;ra.MenuItemId=h.menuItemId;ra.TerminalParentControlId=B.payload.terminalParentControlId;break;case "PreviewGalleryModel":if(this.RSc(B.payload,
Object(z.a)(this,this.aZo,"updatePreviewGalleryMenuState"),P)){ra.launcherId=B.payload.launcherId;break}this.SYh(B,b);return;case "DocumentTitleModel":switch(B.payload.type){case "DocumentTitleRenamePayload":ra.getNewDocumentTitle=B.payload.getNewDocumentTitle;break;case "MenuOpenPayload":ca={};ca[B.payload.launcherId]=r;this.odb.Y3c(ca,Hh.g(B.payload));this.Dwb[b]=new Date;return;case "MenuClosePayload":return;default:return}break;case "MRUCompoundButtonModel":ra.MenuItemId=B.payload.url;this.n5m(B.payload.pageId);
break;case "NewBlankDocumentModel":case "CustomTemplateModel":ra.MenuItemId=B.payload.assetId;ra.SourceControlId=b;v.AFrameworkApplication.K.$("BackstagePremiumTemplateExperienceEnabled")&&(ra.IsPremium=B.payload.isPremium||!1);this.o5m(B.payload.pageId);break;case "CoauthorGallery":ra.RenderTime=B.triggerTime;break;case "PeopleWell":ra.RenderTime=B.triggerTime;break;case "SyncStatus":ra.SourceControlId=b;break;case "InputBoxModel":ra.Text=B.payload.newValue;break;case "PersonaButtonModel":ra.CommandValueId=
B.payload.commandValueId;this.dqm(B.payload);break;case "MultiActionButtonModel":ra.CommandValueId=B.payload.commandValueId;ra.Href=B.payload.href;ra.SourceControlId=b;ra.Type=B.payload.type;ra.TerminalParentControlId=B.payload.terminalParentControlId;this.e4();break;default:return}ca&&!this.isShadowMenuOpen(B.payload)&&(B.payload&&"terminalParentControlId"in B.payload&&(ra.ParentMenuId=B.payload.terminalParentControlId),ra.CommandValueId||(ra.CommandValueId=ra.MenuItemId),h.legacyControlId&&(ra.LegacyId=
h.legacyControlId),ra.SourceControlId||(ra.SqmControlId=b),this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&ra.launcherId&&(h=this.sl.getCommandByExternalUxId(ra.launcherId))&&(ra.launcherCommandId=parseInt(h.commandId)),B.payload&&!nf.c(B.payload.PRIReadinessCheck)&&(ra.PRIReadinessCheck=B.payload.PRIReadinessCheck,this.cch=!0),B.payload&&!nf.c(B.payload.shouldTakeFocus)&&(ra[zy.a.DUa]=B.payload.shouldTakeFocus),h=this.$Ze(B,ra),nf.c(B.triggerTime)||
(Qa.TriggerTime=B.triggerTime),B.payload&&!nf.c(B.payload.userActionKey)&&(Qa.userActionKey=B.payload.userActionKey),this.idg(Qa,B,b,ca),this.lRe.executeCommand(ca,ra,this.getSelectedTabId(),h,!0,()=>{this.rQf(ra,b)},Qa,Hh.g(B.payload)))}idg(b,h,r,B){if(this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableControlIdLoggingInUserActions",!1)&&r&&B&&h.payload){const P=!nf.c(h.payload.launcherId);r=this.ahj(this.U6l(P?h.payload.launcherId:r,B),B,!1);b.ControlId=r;const ca=h.payload.inputMethod,
ra=h.payload.location;nf.c(ca)||nf.c(ra)||this.F4m(1===ca,2===ca||3===ca||4===ca,P||"TabSwitchPayload"===h.payload.type,r,ra)}this.Ca&&this.Ca.$("TerminalParentControlIdLoggingInUserActionsIsEnabled")&&h.payload&&"terminalParentControlId"in h.payload&&(b.TerminalParentControlId=this.ahj(h.payload.terminalParentControlId,B,!0))}F4m(b,h,r,B,P){this.Uid||(this.Uid={});const ca=[];P=xj.a.c9("UILocation",P,2);Array.add(ca,P);if(P=this.getSelectedTabId())P=xj.a.c9("Tab",P,2),Array.add(ca,P);this.Uid[B]||
(this.Uid[B]=1,h?r?this.pfc("DistinctUserInitiatedNavigationalCommand",ca):this.pfc("DistinctUserInitiatedTerminalCommand",ca):b&&this.pfc("DistinctUserInitiatedKeyboardCommand",ca));h?r?this.pfc("UserInitiatedNavigationalCommand",ca):this.pfc("UserInitiatedTerminalCommand",ca):b&&this.pfc("UserInitiatedKeyboardCommand",ca)}pfc(b,h){Ke.b(b,null,0,!0,0,h)}ahj(b,h,r){if(RegExp("^[a-zA-Z0-9_]*$").test(b))return b;t.ULS.sendTraceTag(510247689,207,15,r?"CommandId: "+h+" has a parentControlId that is non-alphanumeric and may need to be changed":
"CommandId: "+h+" has a controlId that is non-alphanumeric and may need to be changed");return"MalformedId"}U6l(b,h){h=parseInt(h);h=cd.ActionManager.l9e(h)||cd.ActionManager.yba(h)||"";return!nf.c(h)&&h in this.zsc?this.zsc[h]:100<b.length?"":b}kNf(){this.rp&&this.rp.execute(b=>{b.UMf("ModernFontPickerExperience")})}$Ze(b,h){let r=2;b.payload&&"inputMethod"in b.payload&&b.payload.inputMethod&&(r=b.payload.inputMethod,h[zy.a.Rx]=r);return r}rQf(b,h){const r=Object(Ra.a)(Dd.AFrame,v.AFrameworkApplication.ua);
if(this.Vb&&this.Rqj(b)){if(!this.Vb.currentScope&&r){let B="null";if(b){const P=b.Value;delete b.Value;B=kb.a.toJSON(b);nf.c(P)||(b.Value=P)}t.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",h,B,r.x7a)}this.Vb.$lf()}(this.Vb&&this.Vb.currentScope&&this.Vb.currentScope.name!==Dd.AFrame.Vqa&&r&&this.Vb.currentScope.name!==r.x7a||this.Rqj(b))&&this.s0k(b)}Rqj(b){return!!b&&
!nf.c(b[zy.a.DUa])&&b[zy.a.DUa]}s0k(b){zy.a.Rx in b&&1===b[zy.a.Rx]&&LF.ShyRibbon.Tfb(1,0)}Wqm(b,h){Hh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.CloseMenuOnUnmount")&&this.e4();this.Vfa.Hm();if(this.Whk&&this.ga){const r={};r[EI.a.Nkg]=h.payload.tabId;this.ga.Qb(fb.a.u7c,2,r,this.gY(h));nf.c(h.payload.inputMethod)||(this.ga.processAction(fb.a.Ndj,2),this.Tyd||this.yyo(h.payload.tabId))}h=h.payload.tabId;b.NewContextId=h;b.NewContextCommand=this.sl.jvf(h);
t.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+h);if(this.rp&&h){const r=h+"TabSwitchActivity";this.rp.execute(B=>{B.UMf(r)})}}RSc(b,h,r){const B=b.type;return"MenuClosePayload"===B?!0:"MenuOpenPayload"===B?(h(b,r),!0):!1}dqm(b){b=b.type;"MenuOpenPayload"===b?v.AFrameworkApplication.nbd=!0:"MenuClosePayload"===b&&(v.AFrameworkApplication.nbd=!1)}uEn(b,h){if(!b.payload||!b.payload.launcherId||"MenuOpenPayload"!==b.payload.type&&"MenuPopulatePayload"!==b.payload.type)return!1;const r=
b.payload.launcherId,B=this.sl.getCommandByExternalUxId(r);return B&&B.populationProps?((b=this.odb.B1f(B,h,b.payload))&&r in this.Dwb&&delete this.Dwb[r],b):!1}kWo(b,h){const r=b.launcherId;this.Ilc(r,h)&&(h=appChrome.selectors.getFlyoutAnchorMenuItems(r),this.Ooc(h,r,Hh.g(b)))}nXo(b,h){const r=b.launcherId;this.Ilc(r,h)&&(h=Hh.i("getInkFlyoutAnchorMenuItems")?appChrome.selectors.getInkFlyoutAnchorMenuItems(r):appChrome.selectors.getFlyoutAnchorMenuItems(r),this.Ooc(h,r,Hh.g(b)))}aZo(b,h){const r=
b.launcherId;this.Ilc(r,h)&&(h=appChrome.selectors.getPreviewGalleryMenuItems(r),this.Ooc(h,r,Hh.g(b)))}TZo(b,h){const r=b.launcherId;this.Ilc(r,h)&&(h=appChrome.selectors.getSplitButtonMenuItems(r),this.Ooc(h,r,Hh.g(b)))}ZZo(b,h){const r=b.launcherId;this.Ilc(r,h)&&(h=appChrome.selectors.getStatefulSplitButtonMenuItems(r),this.Ooc(h,r,Hh.g(b)))}getSelectedTabId(){return this.Yfe?appChrome.selectors.getSelectedTabId():null}Ooc(b,h,r){this.odb.Y3c(b,r);this.Dwb[h]=new Date}Ilc(b,h){let r=!0;b in this.Dwb&&
(r=this.Dwb[b].getTime()<this.Vfa.Zpa.getTime());return r&&!h&&this.Yfe}SYh(b,h){const r={};var B=b.payload.selectedGalleryId;const P=this.sl.getCommandByExternalUxId(B);if(P){r.SourceControlId=B;r.MenuItemId=P.menuItemId;r.SqmControlId=h;P.legacyControlId&&(r.LegacyId=P.legacyControlId);b.payload&&!nf.c(b.payload.shouldTakeFocus)&&(r[zy.a.DUa]=b.payload.shouldTakeFocus);this.z9l(b.payload,r);(B=this.gY(b))||(B={});this.idg(B,b,h,P.commandId);const ca=this.$Ze(b,r);this.lRe.executeCommand(P.commandId,
r,this.getSelectedTabId(),ca,!0,()=>{this.rQf(r,h)},B,Hh.g(b.payload))}}Tyl(b,h){const r=this.sl.getCommandByExternalUxId(h);if(r){const B={};B.SourceControlId=h;B.MenuItemId=h;B.SqmControlId=h;b.payload&&!nf.c(b.payload.shouldTakeFocus)&&(B[zy.a.DUa]=b.payload.shouldTakeFocus);let P=this.gY(b);P||(P={});this.idg(P,b,h,r.commandId);const ca=this.$Ze(b,B);this.lRe.executeCommand(r.commandId,B,this.getSelectedTabId(),ca,!1,()=>{this.rQf(B,h)},P,Hh.g(b.payload))}}z9l(b,h){"CharacterGalleryPayload"===
b.type&&(h.MenuItemId=b.character)}Veg(b,h){b.payload&&"toggled"in b.payload&&(h[qg.a.On]=b.payload.toggled)}r$m(b,h){if("MenuOpen"===b){if(this.f_&&!("isShadowRendering"in h.payload&&h.payload.isShadowRendering))this.f_.onMenuOpen()}else if("MenuClose"===b&&this.f_)this.f_.onMenuClose()}e4(){this.f_&&this.f_.TVf()}gY(b){let h=null;nf.c(b.triggerTime)||(h={},h.TriggerTime=b.triggerTime);return h}Zom(b,h,r){if(this.T2j&&this.ga){const B={};B[CI.a.T9d]=r;this.ga.Qb(fb.a.t7c,2,B)}this.Ooc(h.pageControlIdMap,
b,Hh.g(h))}o5m(b){if(this.ga)switch(b){case "FileHomePage":this.ga.processAction(fb.a.Sdj,2);break;case "FileNewPage":this.ga.processAction(fb.a.Tdj,2)}}n5m(b){if(this.ga)switch(b){case "FileHomePage":this.ga.processAction(fb.a.vdj,2);break;case "FileOpenPage":this.ga.processAction(fb.a.wdj,2)}}isShadowMenuOpen(b){return!!b&&"MenuOpenPayload"===b.type&&b.isShadowRendering}yyo(b){if(v.AFrameworkApplication.K.$("TellMeHelpCoachMarkActivityEnabled")&&"Help"===b)this.rp.execute(h=>{h.logActivity("TellMeHelpCoachMarkActivity",
null)}),this.Tyd=!0;else{if(v.AFrameworkApplication.K.$("TellMe3TabSwitchCoachMarkActivityEnabled")&&(this.rp.execute(h=>{h.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),3===++this.Flk)){this.Tyd=!0;return}v.AFrameworkApplication.K.$("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.ga.processAction(fb.a.mRb,2)&&(this.Tyd=!0)}}QVk(b){b&&b.payload&&b.payload.PRIReadinessCheck&&!this.cch&&appChrome.PRIToastManager.dismissToast()}lOo(b){!this.n6g&&this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ToolBarFloodGate1",
!1)&&(b=Hh.g(b.payload),31===b||14===b||15===b||2===b)&&(window.requestAnimationFrame(()=>{window.setTimeout(()=>{const h=Ma.a.instance.Ta("Common.ISystemInitiatedFeedback");h&&h.execute(r=>{r.logActivity("SingleLineToolBarFPS","SingleLineToolBarFloodgateSurveyIsEnabled")})},0)}),this.n6g=!0)}}Object(m.a)(ZI,"ReactExecuteCommandHandler",null,[]);class $I{constructor(){this.fileMenu=null}get Xrb(){return 0}get A5a(){return 0}get nHa(){return!1}yza(){}gAj(){}g0(){return!1}Mlj(){}o4(){return!1}VJa(b){return this.fileMenu&&
this.fileMenu.DTa(b)?!0:!1}get rka(){return!1}Qpb(){}FZd(){return!1}get rId(){return null}set rId(b){}Cga(){}jca(){}nwf(){return null}pPa(){}refresh(){}get controls(){return null}gjc(){return!1}kgb(){}Hm(){}get JF(){return null}set JF(b){}udd(){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}Object(m.a)($I,"ReactRibbonExternal",null,[554,480,555]);class aJ{constructor(b,h,r,B){this.Vb=b;this.ga=h;this.Ylh=r;this.G_b=B}initialize(){this.ga.ra(fb.a.b8c,yd.a.frame,Object(z.a)(this,
this.Qfj,"ribbonMoveForwardAction"));this.ga.ra(fb.a.a8c,yd.a.frame,Object(z.a)(this,this.Pfj,"ribbonMoveBackwardAction"));this.ga.ra(fb.a.Vee,yd.a.frame,Object(z.a)(this,this.Mfj,"ribbonEscAction"));var b=wp.a.MXd(this.G_b,null,this.Ylh,!1);b.eI=!0;this.djc(b,fb.a.b8c,fb.a.a8c);b.bindAction(Jb.KeyInputManager.ic(se.a.YJa,0),fb.a.Vee);b=this.Vb.fe(Dd.AFrame.Vqa);b.eI=!0;this.djc(b,fb.a.t1a,fb.a.t1a);sf.a.instance.ob(pd.a.Wx,this.Ylh,Object(z.a)(this,this.Ctn,"onRibbonMouseDown"));b=Rp.a.instance;
Hh.a("enterKeytipMode")&&b.Llo(this.G_b,()=>{appChrome.api.enterKeytipMode(!1)});Hh.a("exitKeytipMode")&&b.Hlo(this.G_b,()=>{appChrome.api.exitKeytipMode();LF.ShyRibbon.Tfb(1,0)});v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.Npa&&(b=Object(Ra.a)(pc.FocusManager,this.Vb))&&b.Uxk(Object(z.a)(this,this.Gon,"onFocusScopeChanged"))}Gon(b,h){if((b=Object(Ra.a)(Dd.AFrame,v.AFrameworkApplication.ua))&&h.zRi&&v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.Npa){const r=appChrome.selectors.getShyState();
r.isActive&&h.zRi.name===b.x7a&&LF.ShyRibbon.Tfb(r.state,1)}}Qfj(){return 4}Pfj(){return 4}Mfj(){Hh.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.Npa&&appChrome.selectors.getShyState().isActive&&LF.ShyRibbon.Tfb(1,0),this.Vb.mg(Dd.AFrame.In));return 4}djc(b,h,r){const B=Jb.KeyInputManager.ic(se.a.Iw,0),P=Jb.KeyInputManager.ic(se.a.Iw,4);b.nr(B);b.nr(P);b.bindAction(B,h);b.bindAction(P,r)}Ctn(b){b.Hb&&b.Hb.target&&"input"!==b.Hb.target.tagName.toLowerCase()&&
b.Hb.preventDefault();return!1}dispose(){this.ga.Wv(fb.a.b8c,yd.a.frame,Object(z.a)(this,this.Qfj,"ribbonMoveForwardAction"));this.ga.Wv(fb.a.a8c,yd.a.frame,Object(z.a)(this,this.Pfj,"ribbonMoveBackwardAction"));this.ga.Wv(fb.a.Vee,yd.a.frame,Object(z.a)(this,this.Mfj,"ribbonEscAction"))}}Object(m.a)(aJ,"ReactRibbonFocusManager",null,[9]);class zC{constructor(b,h,r,B,P,ca,ra,Qa=null,tb=!0,Mb=null,Zb=null){this.ebb=this.Qzd=this.Ewe=this.Vfa=null;this.Vfh=[];this.Tvd=null;this.jNa=b;this.cLe=h;this.G_b=
r;this.Vb=B;this.ga=P;this.sl=ca;this.Vfa=Mb?Mb:new Bz(jr.instance,this.sl);this.Uxc=ra;this.keh=new $I;this.kNa=Qa;this.YSe=tb;new XI;this.vVg=Zb;ij.a.get_instance().pk(7,Object(z.a)(this,this.ano,"setRibbonPostInteractiveReady"));ij.a.get_instance().pk(7,Object(z.a)(this,this.w7m,"logRibbonLoadedActivity"));ij.a.get_instance().pk(19,Object(z.a)(this,this.c4m,"logAppLoadedActivity"));ij.a.get_instance().pk(7,Object(z.a)(this,this.iYn,"registerSubComponentReporting"));ij.a.get_instance().pk(7,Object(z.a)(this,
this.uNn,"queueSettingsDependentActions"))}initialize(b,h,r=null){this.YSe||this.nI(5);r?r.then(()=>{this.Icj()}).catch(()=>t.ULS.sendTraceTag(561394319,340,10,"Failed to load the resources for the Ribbon")):WI.a.Tbd(WI.a.Tbd(Fj.Task.WAA(this.cIi(b),this.bIi(zC.MZj)),()=>this.bIi(zC.eWj)),()=>this.cIi(h)).continueWith(()=>{this.Icj()},11)}dispose(){this.DRo();this.ebb&&this.ebb.RTh();this.Tvd&&this.Tvd.dispose();for(const b of this.Vfh)ij.a.get_instance().iYk(b);v.AFrameworkApplication.va.Wv(fb.a.d5n,
yd.a.frame,cd.ActionManager.Of)}bIi(b){return Ma.a.instance.resolve("Common.ISharedDependencyLoader").ifc(v.AFrameworkApplication.Sz(b,2))}cIi(b){return""===b?Fj.Task.A4(!0):Ma.a.instance.resolve("Common.ISharedDependencyLoader").ifc(v.AFrameworkApplication.Sz(b,3))}$Bm(){(this.kNa||this.Uxc)&&appChrome.api.dispatch(this.Uji());this.apo();Hh.a("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(v.AFrameworkApplication.a6);this.Vfa.Hm()}Icj(){this.$Bm();this.YSe&&(appChrome.renderAppChrome(this.jNa,
Hh.e()),this.nI(10));this.hoh();this.D5e();this.YSe&&this.nI(5);this.bsi()}bsi(){this.Vb&&this.ga&&this.G_b&&(this.Tvd=new aJ(this.Vb,this.ga,this.jNa,this.G_b),this.Tvd.initialize())}get $7c(){return this.keh}setCommandDefinitionMapping(){if(Hh.a("setCommandDefinitionMapping")){const b=yM(this.sl);appChrome.api.setCommandDefinitionMapping(b)}}registerOnShyRibbonStateChange(){v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.Npa&&Hh.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((b,
h)=>{0===h&&this.oic()})}hoh(){this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const b=Object(Ra.a)(Bz,this.Vfa);this.Ewe=new ZI(this.Vfa,b.ajc,this.sl,this.Vb,this.cLe,Ma.a.instance.Oa("Common.IRibbonSQMInformation"),Ma.a.instance.Oa("Common.IFileMenuSQMInformation"),v.AFrameworkApplication.va,v.AFrameworkApplication.K,Ma.a.instance.Ta("Common.ISystemInitiatedFeedback"),null);this.HKk();this.Vnm()}HKk(){this.Qzd=appChrome.api.bindCommandHandler((b,h)=>{this.Ewe.executeCommand(b,
h)})}DRo(){this.Qzd&&(this.Qzd(),this.Qzd=null)}apo(){appChrome.api.initializeLogger(new Pl.a)}DFa(){return this.Vfa?this.Vfa.DFa():[]}oic(){Wq.a.instance.ie(()=>{let b=null;Wq.a.instance.ie(()=>{b=this.DFa()},"RB:GA");b&&0<b.length&&(this.Vfa.Zpa=new Date,Wq.a.instance.ie(()=>{appChrome.api.dispatch(b)},"RB:DA"));this.ebb&&Wq.a.instance.ie(()=>{this.ebb.I2i()},"RB:J")},"RB:PFSU")}Ddd(){this.Vfa.Ddd()}tMb(){}uqk(b){b=[appChrome.actions.activateDeactivateContextualTab(b,!0),appChrome.actions.setCurrentTab(b)];
appChrome.api.dispatch(b)}setCurrentTab(b){b=[appChrome.actions.setCurrentTab(b)];appChrome.api.dispatch(b)}Uji(){var b=v.AFrameworkApplication.K;const h=[];b.$("EnableTellMeForOneLineRibbonIsEnabled")?b.$("OcpsIsEnabled")&&Ma.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(r=>{r.isFeatureEnabled("ConnectedServices",!0).then(B=>{B&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",!1));return null})}):h.push(appChrome.actions.updateControlHiddenState("TellMeControl",
!0));h.push.apply(h,this.U9h());b=new zM.a(this.sl);this.kNa.gH&&(AM.a.COo(this.kNa.gH),h.push.apply(h,b.eQd(this.kNa.gH)));if(this.kNa.$Bj)for(const r of this.kNa.$Bj)h.push(appChrome.actions.updateGallerySectionHiddenState(r.I3h,r.rrp,r.cup));h.push.apply(h,b.K4h(this.kNa.dCj));return h}U9h(){const b=[];if(this.Uxc&&this.Uxc.gH){const r=this.Uxc.gH;for(let B in r){var h=r[B];const P=this.sl.Dqf(B);if(P)for(let ca of P)b.push(appChrome.actions.updateControlHiddenState(ca,h))}}return b}SJa(b){b&&
this.Vfa.ajc.Y3c(b,0)}B1f(b){this.Vfa.ajc.B1f(this.sl.getCommandByExternalUxId(b),appChrome.selectors.getModelType(b),{inputMethod:0})}Upl(){const b=v.AFrameworkApplication.K.$("ShareMenuIsEnabled")?"ShareMenu":"Share",h=v.AFrameworkApplication.K.appSettings;h&&appChrome.api.dispatch(this.OZo(b,"Shared"===(h.SharingStatus||"")))}uNn(){v.AFrameworkApplication.K.Nn(()=>{this.Upl()})}OZo(b,h){return appChrome.actions.updateSharingStatusIndicator(b,h)}nI(b){ij.a.get_instance().nI(b);this.Vfh.push(b)}ano(){Hh.d("updateRibbonInitializationState")&&
appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new VI,{postRibbonInteractiveReady:!0})))}D5e(){this.Uxc&&this.vVg&&(this.ebb=this.vVg.dbf(),this.keh.fileMenu=this.ebb)}T_m(b,h){this.ebb&&this.ebb.zGi(b,h)}oag(b,h,r){if(1===r)return 32;this.rnj(!0);this.oic();v.AFrameworkApplication.ua.updateCommandUI();return 32}pag(b,h,r){if(1===r)return 32;this.rnj(!1);this.mno();this.oic();v.AFrameworkApplication.ua.updateCommandUI();return 32}Mng(b,h,r){if(1===r)return 32;
(b=Ma.a.instance.Ta("Common.ISystemInitiatedFeedback"))&&b.execute(B=>{B.logActivity("DefaultFileOpenPreferenceOn",null)});return 32}mno(){Hc.a.PIa(v.AFrameworkApplication.K.kb("IsSimplifiedRibbonOnCookieName"),"true",Hc.a.hHa)}rnj(b){Hc.a.PIa(v.AFrameworkApplication.K.kb("ReactRibbonMLRPreferenceCookieName"),b.toString(),Hc.a.hHa)}w7m(){if(v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.Ir){const b=Ma.a.instance.Ta("Common.ISystemInitiatedFeedback");"SingleLine"===appChrome.selectors.getRibbonMode()?
(b.execute(h=>{h.logActivity("SingleRibbonModeActivity",null)}),v.AFrameworkApplication.fqa("d79fg304;61jba833;h856e313;f5i2f477;d613b829;da9b1202")):"Multiline"===appChrome.selectors.getRibbonMode()&&(b.execute(h=>{h.logActivity("MultiRibbonModeActivity",null)}),v.AFrameworkApplication.fqa("69a7h198;dfd7j584"));v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultToMLR",!1)&&Ma.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(h=>
{h.isFreemiumUpsellEnabled()&&v.AFrameworkApplication.fqa("5fjej882;e0jjh200")})}}xhg(){const b=Ma.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("SingleLineToolBarOptOut",null)});return 32}c4m(){this.ga.ra(fb.a.Mng,yd.a.frame,Object(z.a)(this,this.Mng,"triggerModeSwitcherTUI"));this.ga.fb(fb.a.xhg,yd.a.frame,Object(z.a)(this,this.xhg,"showMultilineRibbonFromToolbar"),96);const b=Hc.a.uca(v.AFrameworkApplication.K.kb("VNextStyleOptOutCookieName"),!1);window.setTimeout(()=>
{const h=Ma.a.instance.Ta("Common.ISystemInitiatedFeedback");h&&(v.AFrameworkApplication.K.$("Fluent2StyleIsEnabled")?(h.execute(r=>{r.logActivity("VNextStylesOn",null)}),h.execute(r=>{r.logActivity("Fluent2StyleEnabledFPS","Fluent2StyleFloodgateSurveyIsEnabled")})):v.AFrameworkApplication.K.$("Fluent2StyleFGOnlyIsEnabled")&&b&&h.execute(r=>{r.logActivity("Fluent2StyleOptOutFPS","Fluent2StyleFloodgateSurveyIsEnabled")}))},5E3)}iYn(){ij.a.get_instance().pk(19,()=>{appChrome.api.setAsyncRequestStatus("appBoot",
!1)});const b=appChrome.api.getRibbonSubComponentMappings();for(let r in b){var h=r;const B=b[r];if(B)for(const P of B)v.AFrameworkApplication.va.l0(P)?appChrome.api.reportRibbonSubComponentBehaviorMapped(h):v.AFrameworkApplication.va.Elo(P,this.Ycl(h));else appChrome.api.reportRibbonSubComponentBehaviorMapped(h)}}Ycl(b){return()=>{appChrome.api.reportRibbonSubComponentBehaviorMapped(b)}}Vnm(){if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",
!1)&&Hh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&v.AFrameworkApplication.aic.iZe){const b=v.AFrameworkApplication.aic.iZe,h=v.AFrameworkApplication.aic.Hnh;h.payload||(h.payload={});const r=h.payload.launcherId?h.payload.launcherId:b;zC.Sfj.nb(r)?zC.Sfj.J(r)():"StatefulSplitButtonModel"===h.modelType?appChrome.PRIToastManager.dismissToast():(h.payload.PRIReadinessCheck=!0,this.Ewe.executeCommand(b,h))}}}zC.MZj="common";zC.eWj=
"appChrome";zC.Sfj=new xM.a(Pa.a.sSc());Object(m.a)(zC,"ReactRibbonUser",null,[769,657,9]);class lH extends zC{constructor(b,h,r,B,P,ca,ra,Qa,tb=null,Mb=!0,Zb=null,jc=null){super(b,h,B,P,ca,ra,Qa,tb,Mb,Zb,jc);this.vmd=null;this.nvb=r;this.nvb.execute(Gc=>{this.vmd=Gc});this.nvb.execute(Gc=>{this.Vfa.JF=Gc})}DFa(){return this.vmd?(this.vmd.clearCache(),super.DFa()):[]}tMb(b){if(!b)throw Error.argumentNull();this.nvb.execute(h=>{b.JF=h})}}Object(m.a)(lH,"ReactRibbonUser",zC,[]);var CM=c(1014);class MF extends lH{constructor(b,
h,r,B,P,ca,ra,Qa,tb,Mb=!0,Zb=null,jc=null){super(h,b.q4,B,Qi.AppFrame.hra,P.focusManager,P.oc,ra,Qa,tb,Mb,Zb,jc);if(void 0===b||null===b)throw Error.argumentNull("hostingAppFrame");this.aEe=b;this.iba=ca;P.UVa(()=>{this.vZo();v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayUIComponentsUntilAfterRibbon",!1)?ij.a.get_instance().pk(7,()=>{this.Sri()}):this.Sri()},null)}get sEf(){return!!v.AFrameworkApplication.K.appSettings.BootActivityNavigationId}Sri(){this.bbl();
this.dbf();this.UUn()}vZo(){this.jNa.classList.add("FlexBoxLayout");this.aEe.yoa().classList.add("cui-exth");this.aEe.yoa().classList.add("FlexBoxLayout");this.aEe.yoa().classList.add("ScrollableRibbon")}bbl(){v.AFrameworkApplication.nY||this.jfl()}jfl(){if(!v.AFrameworkApplication.nY){var b=(new MI(MF.Uhk,this.iba)).Rxl(),h=wp.a.MXd(Qi.AppFrame.FQa,null,b,!0);h.eI=!0;this.djc(h,fb.a.b8c,fb.a.a8c);h.bindAction(Jb.KeyInputManager.ic(se.a.YJa,0),fb.a.Vee);ED.a(1,()=>{this.s3n(b)})}}s3n(b){const h=new TI;
appChrome.renderSharedHeader(b,h.Wha()).then(this.Sff.bind(this))}paj(){v.AFrameworkApplication.ua.Kb.VCi?appChrome.getHeaderApi().then(b=>{document.getElementById(v.AFrameworkApplication.Yhb).classList.remove("Placeholder");return b.dismissPlaceholder()}):(new CM.a).Sff()}Sff(){this.sEf&&v.AFrameworkApplication.fqa("Microsoft.Office.Web.SessionSettings.IWacWordImprovedDeepLinkLoadSettings");this.sEf&&v.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?(ij.a.get_instance().pk(12,this.paj.bind(this),
11),t.ULS.sendTraceTag(42316515,338,50,"DismissFastViewHeader was delayed to AppInitializationStatus.CommentRendered phase")):this.paj()}djc(b,h,r){const B=Jb.KeyInputManager.ic(se.a.Iw,0),P=Jb.KeyInputManager.ic(se.a.Iw,4);b.nr(B);b.nr(P);b.bindAction(B,h);b.bindAction(P,r)}dbf(){const b=!!this.kNa&&"FileMenu"in this.kNa.dCj;v.AFrameworkApplication.ua.Kb.GRa&&!b&&ED.a(1,this.R2n.bind(this))}R2n(){const b=[];if(v.AFrameworkApplication.K.$("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var h=[Object.assign(new jH,
{label:CommonUIStrings.L_DiagnosticsSessionId,value:v.AFrameworkApplication.userSessionId}),Object.assign(new jH,{label:CommonUIStrings.L_DiagnosticsBuild,value:v.AFrameworkApplication.buildVersion})];b.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",h))}b.push.apply(b,this.U9h());h=document.createElement("div");document.body.appendChild(h);appChrome.renderFileMenu(h,b)}UUn(){this.ga.ra(fb.a.cVa,yc.a.view,this.cVa.bind(this));this.ga.ra(fb.a.oag,yc.a.view,this.oag.bind(this));
this.ga.ra(fb.a.pag,yc.a.view,this.pag.bind(this))}activateRibbonTab(b){this.uqk(b)}oic(){ij.a.get_instance().isCompleted(7)&&this.vmd&&(kh.a.mark(4893),Cj.a.$Yo(),super.oic(),kh.a.mark(4894))}cVa(b,h,r,B,P){if(2===P[zy.a.Rx]){if(r=Object(Ra.a)(Ev.a,h))B=Object(Ra.a)(Fw.a,r.view);else return t.ULS.sendTraceTag(38549528,338,10,"Context is not a valid ViewContext. It is a {0}, the actionId is: {1}, the actionData is: {2}",Object.getTypeName(h),b,kb.a.join(P," ",":")),8;if(B&&""!==B.uJ)Gg.a.sia(h)&&
Gg.a.Mcc()||(this.Vb.mg(B.uJ),appChrome.selectors.getShyState().isActive&&LF.ShyRibbon.Tfb(0,1));else return t.ULS.sendTraceTag(38549529,338,10,"Context is not a valid InteractiveView. It is a {0}, the actionId is: {1}, the actionData is: {2}, it is a view type of: {3}",Object.getTypeName(r.view),b,kb.a.join(P," ",":"),this.L1l(r.view)),8}return 32}L1l(b){return b?"is ContentEditableView: "+b.$j+" is Editing View: "+b.Bxa+" is HtmlView: "+b.x4a+" is InteractiveView: "+b.ue+" is NavigationPaneView: "+
b.LQm+" is PageView: "+b.Zi+" is WordNavigationPaneHeadingsView "+b.N1d:"null view"}}MF.Uhk="WACRibbon";Object(m.a)(MF,"ReactRibbonUser",lH,[768,769,657,9]);class bJ extends MF{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc,Uc=null,od,Od){super(b,h,r,B,P,ca,ra,Qa,tb,!1,Mb,Uc);this.rCk=()=>{this.rp&&this.rp.execute(ze=>{ze.logActivity("WordShyRibbon",null)});return 32};this.nBm=()=>{Sh.a.instance.pf(nh.a.zCm,(new Date).getTime());appChrome.getLazyRibbonInitializationActions().then(ze=>{var de;this.kNa&&
ze.push.apply(ze,this.Uji());(this.Jgh||this.Kgh)&&this.Rdb&&ze.push.apply(ze,this.IQl());ze.push(appChrome.actions.setControlCustomTooltip(Ba.a.A0m,CommonUIStrings.l_LoopsLearnMoreTooltip));var ee=null===(de=v.AFrameworkApplication.K)||void 0===de?void 0:de.kb("ReactShyRibbonPreferenceCookieName");de=Hc.a.get(ee);this.wqo(de);v.AFrameworkApplication.K.$("IsO365ConsumerHost")&&appChrome.api.isSmallDevice()&&!appChrome.api.isVerySmallDevice()&&v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.MJ&&
""===de&&v.AFrameworkApplication.oe("66h8i182;1ha8c781");ze.push.apply(ze,this.DFa());ze.push(appChrome.actions.setControlBehaviorAttached(!0));const je=Ma.a.instance.resolve("WordEditor.IModeSwitcherControl");de=je.o1l();v.AFrameworkApplication.oe("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&(ee=appChrome.selectors.getModeSwitcherMode())&&ee!==de.activeMode&&t.ULS.sendTraceTag(527778651,
306,15,`ModeSwitcher was initially rendered in the incorrect mode. Expected: ${de.activeMode}, Actual: ${ee}`);v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsSingleLineToolbarEnabled",!1)&&(ee=wp.a.MXd(it.a.Vtj,null,document.getElementById("WACToolbarContainer"),!1),ee.eI=!0,this.DQn(ee,fb.a.b8c,fb.a.a8c));"Suggest"===de.activeMode||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)&&"View"===de.activeMode?
appChrome.getUpdateAppModeAndTabsActions(de,!0).then(ue=>{appChrome.api.dispatch(ze.concat(ue));je.mOi();this.gsi()}):(ze.push(appChrome.actions.updateModeSwitcher(de)),appChrome.api.dispatch(ze),je.mOi(),this.gsi())})};this.Rdb=Zb;this.Jgh=jc;this.Kgh=Gc;this.rp=Ma.a.instance.Ta("Common.ISystemInitiatedFeedback");this.Ib=od;this.oCe=Od}yCm(){t.ULS.sendTraceTag(587232785,306,50,"InitializeWordRibbon was reached");ij.a.get_instance().nI(5);const b=this.sEf&&v.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?
12:10;ij.a.get_instance().pk(b,this.nBm,11);v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnablePenMinutes",!1)&&this.luk()}luk(){this.Ib.Wb(new Me.a(5,1,0,()=>{this.oCe.execute(b=>{b.imo()})}))}IQl(){const b=[];this.Jgh&&(b.push(appChrome.actions.setButtonSecondaryText(Ba.a.nKd,this.Rdb.lvm)),b.push(appChrome.actions.setButtonSecondaryText(Ba.a.KId,this.Rdb.kvm)),b.push(appChrome.actions.setButtonSecondaryText(Ba.a.E$d,this.Rdb.mvm)));this.Kgh&&b.push(appChrome.actions.setButtonSecondaryText(Ba.a.B$d,
this.Rdb.nvm));return b}wqo(b){var h;b&&(null===(h=v.AFrameworkApplication.ua)||void 0===h?0:h.Kb.Npa)?this.rp.execute(r=>{r.logActivity("OptInShyRibbonNormalScreenActivity",null)}):appChrome.api.isSmallDevice()&&!b&&this.rp.execute(r=>{r.logActivity("NonOptInShyRibbonSmallScreenActivity",null)});v.AFrameworkApplication.va.fb(fb.a.Ssh,yd.a.frame,this.rCk,96)}DQn(b,h,r){const B=Jb.KeyInputManager.ic(se.a.Iw,0),P=Jb.KeyInputManager.ic(se.a.Iw,4);b.nr(B);b.nr(P);b.bindAction(B,h);b.bindAction(P,r)}gsi(){v.AFrameworkApplication.aic.CRo();
this.hoh();this.D5e();this.bsi();ij.a.get_instance().nI(7);Sh.a.instance.oga(nh.a.AGc,nh.a.s9n,(new Date).getTime())}SJa(b){if(b){const h=this.V$h();try{super.SJa(b)}finally{null===h||void 0===h?void 0:h.dispose()}}}DFa(){const b=this.V$h();try{return super.DFa()}finally{null===b||void 0===b?void 0:b.dispose()}}V$h(){var b;let h=void 0;const r=null===(b=Eb.App.si)||void 0===b?void 0:b.Il;r&&(h=new cg.GraphTransaction(Eb.App.Kxi()&&Eb.App.FFf?0:2),h.set(r));return h}}Object(m.a)(bJ,"ReactRibbonUser",
MF,[]);class cJ extends gH{constructor(b,h,r,B,P,ca,ra,Qa){super(b,h,r);this.UGe=v.AFrameworkApplication.K.$("PasteWithOptionsFromRibbon")&&Z.a.S4;this.sl=P;this.OPe=ca;this.Ib=ra;this.oCe=Qa}oel(b,h){const r=new KE(v.AFrameworkApplication.K,this.ga,this.Vb,this.UGe),B=new uM.a(r);return this.Pel(b,h,B,r)}Pel(b,h,r,B){var P=new KI(new LI(v.AFrameworkApplication.K,B),r);r=this.WBm(P);const ca={};P.jqb(ca);P=!Z.a.S4;const ra=Z.a.Fr||Z.a.Cj;var Qa=Z.a.fl;v.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&
(Qa=Z.a.vi||Qa);Qa=new RD.a(Qa);b=new bJ(b,h,WordEditorIntl.WordEditorStrings,this.nvb,B,b,this.sl,r,new GI(ca),this.OPe,Qa,P,ra,new JI,this.Ib,this.oCe);b.yCm();return b}WBm(b){const h={};b.D9c(h);b.Qdd(h);return new HI(null,h,"jewelWordEditor")}}Object(m.a)(cJ,"WordEditorRibbonUserFactory",gH,[]);class mH{constructor(b,h){this.mA=b;this.isd=h}vPa(b,h,r,B=null,P=null){return this.isd.Bqj(b)?this.isd.vPa(b,h,r,B,P):this.mA.vPa(b,h,r,B,P)}NGa(b,h=null){return this.isd.Bqj(b)?this.isd.NGa(b):this.mA.NGa(b,
h)}}Object(m.a)(mH,"RootCuiUser",null,[244]);class dJ extends mH{constructor(b,h){super(b,h)}clearCache(){this.mA.clearCache()}}Object(m.a)(dJ,"WordGeneralCuiUser",mH,[243,244]);var DM=c(1482);class uG{static getSelectedText(){const b=(new Vq.a).wuf();return b.neighborhood.substr(b.mentionStart,b.mentionLength)}static aUd(b){b=b?b.trim():null;let h=20;b&&0<b.length&&(b.length>h&&(h=F.a.Kz(b,h)?h-1:h),b=b.length>h?b.substr(0,h).trim()+"...":b);return b}}Object(m.a)(uG,"SearchUtils",null,[]);class Xv extends TD{constructor(b,
h,r){super(b,r);this.zI=h}Onf(b){const h=[];var r=Bh.a.instance.ib.lb;const B=!!this.zI&&this.zI.cYc(Nb.a.q7e.toString()),P=!!this.zI&&this.zI.cYc(Nb.a.yOb.toString()),ca=!B&&!r.l4a&&Xv.K7a.DOi(),ra=!(v.AFrameworkApplication.ou&&Xv.nzi)&&(!!this.zI&&this.zI.cYc(fb.a.qHa.toString())||!!uy.a.instance&&(3===uy.a.instance.mode||2===uy.a.instance.mode)),Qa=r.ICi()&&v.AFrameworkApplication.ua.Kb.VXc;var tb=!1;if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",
!1)){tb=!!r&&(r.Yw||2===r.length&&xe.SelectionEditor.Lk(r.Tc));var Mb=uG.getSelectedText();tb=tb&&0<Mb.length&&60>Mb.length}b=(Mb=3===b||Z.a.vi||v.AFrameworkApplication.Emf)&&Xv.shf.v0(r,b);r=Xv.nzi&&r&&1===r.length&&r.J(0).contextId===yc.a.Uc;Mb&&h.push(this.sl.Kwa("ClipboardGroup")[0].externalUxGroupId);ca&&(h.push(this.sl.Kwa("TextFormattingGroup")[0].externalUxGroupId),h.push(this.sl.Kwa("StylesGroup")[0].externalUxGroupId));tb&&h.push(this.sl.Kwa("DefineGroup")[0].externalUxGroupId);B&&h.push(this.sl.Kwa("PictureToolsGroup")[0].externalUxGroupId);
P&&h.push(this.sl.Kwa("TableToolsGroup")[0].externalUxGroupId);Qa&&h.push(this.sl.Kwa("EquationToolsGroup")[0].externalUxGroupId);ra&&h.push(this.sl.Kwa("CommentGroup")[0].externalUxGroupId);r&&h.push(this.sl.Kwa("ContentAssemblyGroup")[0].externalUxGroupId);b&&h.push(this.sl.Kwa("ContextMenuGroup")[0].externalUxGroupId);DM.a.uwi&&Xv.lLm&&h.push(this.sl.Kwa("DesignerGroup")[0].externalUxGroupId);return h}static get shf(){return null!=Xv.xyg?Xv.xyg:Xv.xyg=Ma.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu")}static get K7a(){return null!=
Xv.MGg?Xv.MGg:Xv.MGg=Ma.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static PUc(b,h,r,B){b.DKk(()=>Xv.mgb(h,r,B))}static mgb(b,h,r){return new Xv(b,h,r)}static get lLm(){null===this.QFe&&(v.AFrameworkApplication.oe("DesignerInContextMenuConsumerExp;DesignerInContextMenuConsumerExpCf"),this.QFe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerInContextMenuConsumerExpIsEnabled",!1):!1);return this.QFe}static get nzi(){null!==
this.wGe||"Templatization"!==v.AFrameworkApplication.ou&&"ContentAssemblyEdit"!==v.AFrameworkApplication.ou||(v.AFrameworkApplication.oe("insertSnippetTreatment;insertSnippetControl"),this.wGe=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertSnippetActionForCA",!1):!1);return this.wGe}}Xv.QFe=null;Xv.wGe=null;Object(m.a)(Xv,"WordReactFloatie",TD,[]);class nH{constructor(){this.efa=this.JDc=this.W=null}get name(){return"WordEditor.UI"}init(){var b;
this.W.resolve("WordEditor.UI.BusinessBarController").O0f();const h=Eb.App.Hv.fJ,r=Eb.App.za;Xv.PUc(r,this.W.resolve("Common.IReactContextualUILauncher"),h,this.W.resolve("Common.IExternalUICommandDefinitionMapping"));this.efa=this.W.Oa("Box4.IContextMenuController");const B=new GE(r,h,this.W.Ta("Box4.IGeneralCuiUser"),this.W.resolve("Box4.UI.PasteFloatieManager")),P={"floatie.gbFormatWithDesignerButton":!0,"floatie.gbMatchDocumentFormattingButton":!0,"floatie.gbUseSmartPasteButton":!0};switch(null===
(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",0)){case 1:P["floatie.gbFormatWithDesignerButton"]=!1;break;case 2:P["floatie.gbMatchDocumentFormattingButton"]=!1;break;case 3:P["floatie.gbUseSmartPasteButton"]=!1}B.PUc("PasteFloatieData",null,P);this.W.resolve("WordEditor.UI.CuiActionBridge").initialize();(new xI(r,h,this.W.Ta("Box4.IGeneralCuiUser"),this.W.resolve("Box4.UI.ExternalContentFloatieManager"))).PUc("ExternalContentFloatieData",
[WordEditorIntl.WordEditorStrings],{});this.W.resolve("Box4.IGeneralCuiUser");ij.a.get_instance().pk(7,()=>{this.JDc=this.W.resolve("WordEditor.UI.StatusBarUser");this.JDc.Tb()})}dispose(){this.JDc&&(this.JDc.dispose(),this.JDc=null);this.efa&&(this.efa.dispose(),this.efa=null)}wc(b){this.W=b;b.ia("WordEditor.UI.BusinessBarController",()=>new VD(b.resolve("CommonUI.IBusinessBar"),b.resolve("CommonUI.IBusinessBarEntryFactory"),v.AFrameworkApplication.va,v.AFrameworkApplication.K)).as("WordEditor.IBusinessBarController").as("Wonca.IBusinessBarController").as("Box4.IBusinessBarController").ha();
let h=Z.a.fl;v.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(h=Z.a.vi||h);b.ia("Box4.UI.ShortcutHintMapping",()=>new RD.a(h));const r=Z.a.Fr||Z.a.Cj,B=v.AFrameworkApplication.K.$("PasteWithOptionsFromContextMenu")&&(Z.a.S4||r),P=v.AFrameworkApplication.K.$("CatchUpActivityIsEnabled");b.ia("Box4.UI.AugLoopProofingErrorDetailHelper",()=>new rs(Ma.a.instance.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),Ma.a.instance.resolve("Box4.Intent.IIntentRangeEditor"),new Pc.a)).ha();
b.ia("WordEditor.UI.EditSurfaceContextMenu",()=>new Wo(v.AFrameworkApplication.va,b.resolve("Box4.UI.IProofingContextMenuSectionFactory"),b.resolve("Box4.Proofing.IErrorRangeEditor"),v.AFrameworkApplication.K,b.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,P?b.Ta("WordEditor.CatchUpActivity.ActivityAnnouncementManager").instance:null,b.resolve("Box4.Proofing.IProofingFeatureConfiguration"),b.resolve("Box4.ILanguageReader"),
b.Oa("Box4.Intent.IIntentRangeEditor"),b.resolve("Box4.DictationCorrections.IDictationCorrectionContextMenuManager"),b.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder"),b.Ta("Box4.IPresenceDataManager"),b.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),b.Ta("WordEditor.ContextualSearch.ISearchSuggestionManager"),b.resolve("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader"),b.resolve("WordEditor.Designer.IDesignerControl"),b.resolve("WordEditor.Bookmark.FullBookmarkManager"),
B,r?b.resolve("Box4.UI.ShortcutHintMapping"):null,Ma.a.instance.Ta("Common.IActionContextProvider"),Ma.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"),b.resolve("Box4.IParagraphReader"),b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),b.Oa("WordEditor.Designer.Review.IReviewTraverser"))).as("Box4.UI.AEditSurfaceContextMenu").ha();b.ia("Box4.ISelectionContextMenuProvider",()=>new Ax).ha();b.ia("WordEditor.UI.CuiActionBridge",()=>new Wl(v.AFrameworkApplication.K)).as("Box4.UI.CuiActionBridge").ha();
b.ia("WordEditor.UI.DialogFactory",()=>new wI).as("WordEditor.UI.IDialogFactory").as("Box4.UI.IBox4DialogFactory").ha();b.ia("Common.NonCanvasCuiUser",()=>new tF(pc.FocusManager.instance())).as("Common.INonCanvasCuiUser").ha();b.ia("WordEditor.UI.WordGeneralCuiUser",()=>new dJ(b.resolve("Box4.IGeneralCuiUser"),b.resolve("Common.INonCanvasCuiUser"))).ha();b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ia("WordEditor.UI.StatusBarUser",()=>new BI(Eb.App.za.xjg,b.Ta("Box4.IGeneralCuiUser"),b.resolve("Box4.IFeatureHelper"),
v.AFrameworkApplication.va,v.AFrameworkApplication.K,Eb.App.za)).as("WordEditor.IStatusBarUser").ha();b.ia("WordEditor.IWordEditorNavigationPaneContextMenu",()=>new IF).ha();const ca=b.resolve("WordEditor.UI.WordGeneralCuiUser");b.ia("CommandUI.ReactRibbonRoot",()=>new Bz(jr.instance,b.resolve("Common.IExternalUICommandDefinitionMapping"),ca)).ha();const ra=b.Ta("WordEditor.UI.WordGeneralCuiUser");b.ia("WordEditor.UI.WordEditorRibbonUserFactory",()=>new cJ(ra,v.AFrameworkApplication.va,pc.FocusManager.instance(),
b.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),b.resolve("Common.IExternalUICommandDefinitionMapping"),b.resolve("CommandUI.ReactRibbonRoot"),v.AFrameworkApplication.lc,b.Ta("Common.App.PenMinutesManager.IPenMinutesManager"))).as("Wonca.IRibbonUserFactory").ha();b.ia("WordEditor.UI.ReactLanguageDialog",()=>new JF(b.resolve("Box4.UI.ILanguageEditor"),b.resolve("Box4.UI.ILanguageListHelper"))).as("Box4.UI.ILanguageDialog");b.ia("WordEditor.UI.WordEditorRibbonSQMInformation",()=>
new FI(v.AFrameworkApplication.va)).as("Common.IRibbonSQMInformation").ha();b.ia("WordEditor.UI.WordEditorFileMenuSQMInformation",()=>new DI(v.AFrameworkApplication.va)).as("Common.IFileMenuSQMInformation").ha();b.ia("WordEditor.UI.RulerUser",()=>new yI).as("WordEditor.IRulerUser");b.ia("WordEditor.UI.RulerContextMenu",()=>new gD(v.AFrameworkApplication.va,Ma.a.instance.Ta("Common.IZoomManager"),Gp.a.instance)).as("WordEditor.IRulerContextMenu").ha();b.ia("Common.IReactContextualUILauncher",()=>new PD(b.resolve("CommandUI.ReactRibbonRoot"),
b.resolve("Common.IExternalUICommandDefinitionMapping"))).ha();b.ia("Box4.IContextMenuController",()=>new DF(b.resolve("Common.IReactContextualUILauncher"))).ha()}static main(){v.AFrameworkApplication.oe("5b6i5792;30d4f535");np.instance.LWh();np.instance.bif();L.a.instance.Gc(new nH,6)}}Object(m.a)(nH,"WordEditorUIPackage",null,[1,2]);var EM=window.ExternalContentFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.ExternalContentFloatie",
ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"ExternalContentOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"ExternalContentFloatie.FlyoutAnchor",LabelText:"STR@L_DisplayAs",Image16by16:"IMAGEPATH@DisplayAs.png",
Alt:"STR@L_DisplayAs",DisplayMode:"Medium",TemplateAlias:"ExternalContent"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msExternalContentOptionsButtons",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0xE188C0F7",QueryCommand:"0xD46B64BD",Image16by16:"IMAGEPATH@EmbeddedContent.png",Alt:"STR@L_EmbeddedContent",
LabelText:"STR@L_EmbeddedContent"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0xE36ACF00",QueryCommand:"0xB5FF507C",Image16by16:"IMGMAP@we@WebInsertHyperlink_16x16x32",Alt:"STR@L_Hyperlink",LabelText:"STR@L_Hyperlink"}}]}]}]}]}]}]}]}]}]}]}]},wD={};wD.Ppc=function(){function b(){return ra()&&(od()||3<=(jc()?Od("version/"):0))}function h(){return 0<=window.navigator.userAgent.indexOf("Windows")}function r(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}
function B(xf){xf=(new RegExp(xf+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var Ai=-1;null!=xf&&2<=xf.length&&(Ai=parseFloat(xf[1]),isNaN(Ai)&&(Ai=-1));return Ai}function P(){eJ||(eJ=!0,fJ=B("Windows Phone"));return 8<=fJ}function ca(){return"function"==typeof navigator.msLaunchUri&&!r()&&!Uc()&&!Qa()}function ra(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function Qa(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function tb(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||
0<=window.navigator.userAgent.indexOf("Trident/")}function Mb(){return tb()?8==window.document.documentMode:!1}function Zb(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function jc(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function Gc(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function Uc(){var xf=window.navigator.userAgent.toLowerCase();return 0<=xf.indexOf("android")&&0<=xf.indexOf("chrome")}function od(){return 3<=(Zb()?Od("firefox/"):
0)}function Od(xf){var Ai=window.navigator.userAgent.toLowerCase(),Kj=Ai.indexOf(xf);return 0<=Kj?parseInt(Ai.substring(Kj+xf.length,Ai.length)):0}function ze(xf,Ai,Kj,Mk,zp){if(Mk&&null!=Ai)Ai();else if(ca())navigator.msLaunchUri(xf,Ai,Kj);else if(!(Gc()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&ra())||Qa())ee(xf,Ai,Kj);else if(Gc()&&zp)a:{try{window.open(xf,"_self")}catch(xs){null!=Kj&&Kj();break a}null!=Ai&&Ai()}else de(xf,
Ai,Kj)}function de(xf,Ai,Kj){var Mk=document.getElementById("OICLinkTag");null==Mk&&(Mk=document.createElement("a"),Mk.id="OICLinkTag",Mk.style.visibility="hidden",Mk.href="",0==(Rq.Options&Cy.SupportsTopTargetNavigation)||Rq.NoBrowserModalDialogs?Mk.target="_blank":Mk.target="_top",document.body.appendChild(Mk),null!=Mk.addEventListener&&Mk.addEventListener("click",function(zp){null!=zp.stopPropagation&&zp.stopPropagation()},!1));try{Mk.href=xf,Mk.dispatchEvent(new MouseEvent("click"))}catch(zp){null!=
Kj&&Kj();return}null!=Ai&&Ai()}function ee(xf,Ai,Kj){var Mk=document.getElementById("OICFrame");null==Mk&&(Mk=document.createElement("iframe"),Mk.className="ObjectInDialog",Mk.style.visibility="hidden",Mk.src="about:blank",document.body.appendChild(Mk),Mk.id="OICFrame");try{Mk.contentWindow.location.href=xf}catch(zp){null!=Kj&&Kj();return}null!=Ai&&Ai()}function je(xf){return 0!=(xf.Options&Cy.SkipProtocolHandler)||Mb()}function ue(xf){return xf===xD.ReadOnly||xf===xD.ReadWrite}function Qf(xf,Ai,
Kj,Mk){var zp;try{var xs=new ActiveXObject("SharePoint.OpenDocuments.4");return(zp=xs.ViewDocument3(window.self,xf,Ai,Mk))?(NE(AC.O14ActiveX),lq.None):lq.Failed}catch(Or){}if(Cy.O14Only===(Kj&Cy.O14Only))return Rq.DescriptiveUnattemptedEnums?lq.O14AttemptFailure:lq.Unattempted;try{return xs=new ActiveXObject("SharePoint.OpenDocuments.3"),(zp=xs.ViewDocument3(window.self,xf,Ai,Mk))?(NE(AC.O12ActiveX),lq.None):lq.Failed}catch(Or){}if(Cy.O12UpOnly===(Kj&Cy.O12UpOnly))return Rq.DescriptiveUnattemptedEnums?
lq.O12UpOnlyFail:lq.Unattempted;try{return xs=new ActiveXObject("SharePoint.OpenDocuments.2"),(zp=ue(Ai)?xs.ViewDocument2(window.self,xf,Mk):xs.EditDocument2(window.self,xf,Mk))?(NE(AC.O11ActiveX),lq.None):lq.Failed}catch(Or){}return Rq.DescriptiveUnattemptedEnums?lq.ActiveXUnattempted:lq.Unattempted}function Jg(xf,Ai,Kj,Mk,zp){xf==Cr.Visio&&Kj==xD.ReadWrite&&(Kj=xD.WriteOnly);Mk=Mk||r()&&!P();if(!Mk){Mk="";if(xf==Cr.PowerPoint){xf=Mk;Mk=Rq.DocumentExtension;Kj=ue(Kj);var xs=new Set([".pot",".potm",
".potx"]),Or=new Set([".pps",".ppsm",".ppsx"]);Kj=Kj&&xs.has(Mk)?"nft|ofc|":Kj&&Or.has(Mk)?"ofv|ofs|t|":!Kj&&Or.has(Mk)?"ofe|ofs|t|":Kj?"ofv|ofc|":"ofe|";Kj=xf+Kj}else Kj=ue(Kj)?Mk+"ofv|ofc|":Mk+"ofe|";Mk=Kj;Rq.NewTelemetryDataIsEnabled&&(Kj=Rq.SessionOrigin?"or|"+Rq.SessionOrigin+"|":"",Kj+=Rq.ClickTime?"ct|"+Rq.ClickTime+"|":"",Kj+=Rq.CorrelationId?"cid|"+Rq.CorrelationId+"|":"",Mk+=Fm(Kj));zp+=Fm(Mk+"u|")}zp+=Fm(Ai);Ai=window.location.href;Kj=Ai.toLowerCase().indexOf("&wdlor=");-1!=Kj?(Kj+=7,xf=
Ai.indexOf("&",Kj),Ai=-1==xf?Ai.substr(Kj):Ai.substring(Kj,xf)):Ai=void 0;if(null!=Ai&&"undefined"!=typeof Ai){Kj="";try{Kj=decodeURIComponent(Ai)}catch(OE){}0<Kj.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Kj)&&(zp=zp+"|f|"+Kj)}return zp}function Ql(xf,Ai,Kj,Mk,zp,xs){var Or=gJ(xf);if(null==Or)return $D(Rq.DescriptiveUnattemptedEnums?lq.ProtocolHandlerIsNull:lq.Unattempted,Rq.Application),!1;xf=Jg(xf,Ai,Kj,Mk,Or);ze(xf,Kp,nv,zp,xs);return!0}function Fm(xf){if(ra()&&
Gc()){var Ai="";try{Ai=decodeURI(xf)}catch(Kj){}if(Ai==xf)return encodeURI(xf)}return xf}function Kp(){NE(AC.ProtocolHandler)}function nv(){Rq.Options|=Cy.SkipProtocolHandler;hJ(Rq,PE,QE)}function fD(){null!=oH&&oH(AC.RoamingProtocolHandler)}function AB(){null!=pH&&pH(lq.ControlNeeded)}function XD(){var xf=document.getElementById("npSharePointPlugin");if(null==xf){xf="application/x-sharepoint";ra()&&3<=(jc()?Od("version/"):0)&&Cz("application/x-sharepoint-webkit",!0)&&(xf="application/x-sharepoint-webkit");
if(!Cz(xf,!0))if(ra()&&Cz("application/officelive",!0))xf="application/officelive";else return null;var Ai=document.createElement("object");Ai.id="npSharePointPlugin";Ai.type=xf;Ai.style.width="0px";Ai.style.height="0px";Ai.style.setProperty("visibility","hidden","");document.body.appendChild(Ai);xf=document.getElementById("npSharePointPlugin")}return xf}function Cz(xf,Ai){var Kj=window.navigator.mimeTypes;if(null==Kj)return!1;xf=Kj[xf];return!xf||Ai&&!xf.enabledPlugin?!1:!0}function vG(xf){try{if(null!=
new ActiveXObject(xf))return!0}catch(Ai){}return!1}function qH(xf){switch(xf){case Cr.OneNote:return"OneNote.Notebook";default:return""}}function gJ(xf){if(xf!=Cr.OneNote&&r()&&!P())return"office:";switch(xf){case Cr.Excel:return"ms-excel:";case Cr.OneNote:return"onenote:";case Cr.PowerPoint:return"ms-powerpoint:";case Cr.Visio:return"ms-visio:";case Cr.Word:return"ms-word:";case Cr.Project:return"ms-project:";case Cr.Publisher:return"ms-publisher:";case Cr.Infopath:return"ms-infopath:";case Cr.Access:return"ms-access:";
default:return""}}function FM(xf){switch(xf){case Cr.Excel:return"root\\office15\\excel.exe";case Cr.PowerPoint:return"root\\office15\\powerpnt.exe";case Cr.Visio:return"root\\office15\\visio.exe";case Cr.Word:return"root\\office15\\winword.exe";case Cr.Project:return"root\\office15\\winproj.exe";case Cr.Publisher:return"root\\office15\\mspub.exe";case Cr.Infopath:return"root\\office15\\infopath.exe";case Cr.Access:return"root\\office15\\msaccess.exe";default:return null}}function hJ(xf,Ai,Kj){Rq=
xf;PE=Ai;QE=Kj;if(xf.DocumentUrl){var Mk=Kj=Ai=xf.DocumentUrl;try{Mk=decodeURIComponent(xf.DocumentUrl)}catch(RE){}try{Kj=encodeURI(xf.DocumentUrl)}catch(RE){}Ai=Ai+""+xf.CorrelationIdForWinClient;Mk+=xf.CorrelationIdForWinClient;Kj+=xf.CorrelationIdForWinClient;xf.Mode===xD.ReadWrite&&Cy.CheckoutRequired===(xf.Options&Cy.CheckoutRequired)&&(xf.Mode=xD.ForceCheckout);Cy.HostIsEditOnly===(xf.Options&Cy.HostIsEditOnly)&&(xf.Mode=xD.WriteOnly);if(je(xf)?0:ra()&&(xf.Application==Cr.OneNote||Cz("application/x-sharepoint-protocolhandler",
!1)||Cz("application/x-sharepoint-webkit-protocolhandler",!1))||ca()||Uc()||!(b()||od()||"ActiveXObject"in window&&!r()||Gc())||15<=wG())Ql(xf.Application,xf.EncodeUrl?Kj:Ai,xf.Mode,xf.Application==Cr.OneNote,xf.SilentExternalHandler,xf.NavigateUsingWindowOpen);else{var zp;if(zp=Mb())a:{var xs=xf.EncodeUrl?Ai:Mk,Or=xf.Mode,OE=qH(xf.Application);try{zp=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,xs,Or,OE);break a}catch(RE){}zp=!1}if(zp)NE(AC.O15ActiveX);else{if(b()||
od()){var Kt=xf.EncodeUrl?Ai:Mk;Mk=xf.Mode;zp=qH(xf.Application);xs=XD();if(null==xs)Kt=Rq.DescriptiveUnattemptedEnums?lq.PluginIsNull:lq.Unattempted;else{Or=!1;try{Or=xs.ViewDocument3(window.self,Kt,Mk,zp)}catch(RE){}if(!Or)try{Or=ue(Mk)?xs.ViewDocument2(window.self,Kt,zp):xs.EditDocument2(window.self,Kt,zp)}catch(RE){}Or?(NE(AC.NpapiPlugin),Kt=lq.None):Kt=lq.Failed}}else{try{Kt=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=Kt&&Kt.SaveSSOCreds()}catch(RE){}Kt=Qf(xf.EncodeUrl?Ai:Mk,xf.Mode,xf.Options,
qH(xf.Application))}if(Kt!=lq.None){if(Mk=xf.CouldUseRoamingApps)iJ||(iJ=!0,jJ=B("Windows NT")),Mk=6.1<=jJ&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(tb()||od()||Gc());if(Mk&&xf.Application!=Cr.OneNote){if(!wD.Ppc.W9o()){$D(lq.ControlNeeded,Rq.Application);return}if(xf.RoamingAppsLauncher){"undefined"==typeof xf.RoamingAppsLauncher||null==xf.RoamingAppsLauncher?$D(Rq.DescriptiveUnattemptedEnums?lq.RoamingLauncherIsNull:lq.Unattempted,Rq.Application):"undefined"==typeof xf.RoamingBitsUrl||
null==xf.RoamingBitsUrl?wD.Ppc.Uap(xf.DocumentUrl,xf.RoamingAppsLauncher,xf.Application,xf.ApplicationParameters,PE,QE):wD.Ppc.VPj(xf.DocumentUrl,xf.RoamingAppsLauncher,xf.RoamingApplicationExe,xf.ApplicationParameters,xf.RoamingPlatform,xf.RoamingBitsUrl,PE,QE);return}if(!xf.ContinueIfLauncherIsNull){$D(lq.LauncherNeeded,Rq.Application);return}}Cy.NoProtocolHandlerFallback==(xf.Options&Cy.NoProtocolHandlerFallback)||je(xf)||tb()||ra()&&!(Rq.DescriptiveUnattemptedEnums?Kt>=lq.O14Unattempted&&Kt<=
lq.DocumentUrlIsNull:Kt==lq.Unattempted)?$D(Kt,Rq.Application):Ql(xf.Application,xf.EncodeUrl?Kj:Ai,xf.Mode,xf.Application==Cr.OneNote,xf.SilentExternalHandler,xf.NavigateUsingWindowOpen)}}}}else $D(Rq.DescriptiveUnattemptedEnums?lq.DocumentUrlIsNull:lq.Unattempted,Rq.Application)}function NE(xf){null!=PE&&PE(xf)}function $D(xf,Ai){"undefined"==typeof Ai&&(Ai=null);null!=QE&&QE(xf,Ai)}function wG(){var xf=0;if(b()||od()||Gc()){var Ai=XD();try{null!=Ai&&(xf=Ai.GetOfficeVersion())}catch(Kj){}}else vG("SharePoint.OpenDocuments.5")?
xf=15:vG("SharePoint.OpenDocuments.4")?xf=14:vG("SharePoint.OpenDocuments.3")?xf=12:vG("SharePoint.OpenDocuments.2")&&(xf=11);return xf}function kJ(){return ra()&&(Cz("application/x-sharepoint",!0)||Cz("application/x-sharepoint-webkit",!0))}var lJ="",mJ="",nJ="",PE,QE,oH,pH,Rq,iJ,jJ,eJ,fJ,xD={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},Cy={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},
lq={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},AC={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},Cr={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,
Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:xD,OpenDocumentOptions:Cy,OpenDocumentFailureType:lq,OpenDocumentControl:AC,OfficeApplication:Cr,EditDocumentInClient:hJ,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=Cr.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=
this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.DocumentExtension=this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:wG,IsO14MacPluginInstalled:kJ,OfferOfficeInDialog:function(){return h()&&11>=wG()},OfferOfficeNoIntrusive:function(){return h()&&15>wG()},OfferMacOffice:function(){return ra()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&
!kJ()},InstallRoamingControl:function(){Zb()?window.InstallTrigger.install({Office:{URL:mJ}}):ee(nJ,null,null)},CanUseRoamingControl:function(){if(ca())return!0;if(Gc())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(Zb()){var xf=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(xf);var Ai=document.createEvent("Events");Ai.initEvent("RoamingOfficeInstalled",!0,!1);xf.dispatchEvent(Ai);
return!!xf.getAttribute("installed")}if(tb())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(Kj){}return!1},InitUrls:function(xf,Ai,Kj){lJ=xf;mJ=Kj;nJ=Ai},LaunchRoamingApps:function(xf,Ai,Kj,Mk,zp,xs){wD.Ppc.VPj(xf,Ai,FM(Kj),Mk,"x86",lJ,zp,xs)},LaunchRoamingApps2:function(xf,Ai,Kj,Mk,zp,xs,Or,OE){var Kt="";null!=Mk&&(Kt+=" "+Mk);null!=xf&&(Kt+=' "'+xf+'"');if(ca()||Gc())oH=Or,pH=OE,Or='office: "'+(xs+'" "')+(Kj+'" "ROAMING"'),Or+=' "'+Ai+'"',Or+=' "'+zp+'"',Or+=
" "+Kt,ze(Or,fD,AB,!1,!1);else if(Zb())xf=document.createElement("RoamingExtensionElement"),xf.setAttribute("cabUrl",xs),xf.setAttribute("app",Kj),xf.setAttribute("licensingEntitlements",Ai),xf.setAttribute("platform",zp),xf.setAttribute("args",Kt),document.documentElement.appendChild(xf),Ai=document.createEvent("Events"),Ai.initEvent("RoamingOfficeLaunch",!0,!1),xf.dispatchEvent(Ai),null!=Or&&Or(AC.RoamingFFExtension);else if(tb()){if(xf=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=
xf)try{xf.HrConfigureSingle(xs,Kj,Ai,zp,Kt),null!=Or&&Or(AC.RoamingActiveX)}catch(RE){}}else null!=OE&&OE(lq.Failed)},ShouldShowDialog:function(){return!r()},NavigateToUrlUsingClickingOnATag:de,OpenDocumentWithProtocolHandler:Ql,OpenDocumentWithProtocolHandlerNoCallBack:function(xf,Ai,Kj,Mk){var zp=gJ(xf);if(null==zp)return $D(Rq.DescriptiveUnattemptedEnums?lq.ProtocolHandlerNoCallbackIsNull:lq.Unattempted,Rq.Application),!1;xf=Jg(xf,Ai,Kj,Mk,zp);ze(xf,null,null,!1,!1);return!0}}}();wD.ClientUtils=
wD.Ppc;var GM=c(1505);class xG{constructor(b,h,r){this.ga=b;this.W8j=h;this.r7=r}Tb(){this.ga.ra(fb.a.tryMacOffice,yd.a.frame,Object(z.a)(this,this.Qvn,"onTryMacOffice"));this.ga.ra(fb.a.WCj,yd.a.frame,Object(z.a)(this,this.oZi,"onTryMacOfficeFromViewer"));this.ga.ra(fb.a.VCj,yd.a.frame,Object(z.a)(this,this.oZi,"onTryMacOfficeFromViewer"))}Qvn(b,h,r,B,P){if(1===r)return 32;P?(b=P.SourceControlId,"btnjTryMacOfficeForWordEditor"===b?Qd.a.wm(ia.a.D2a(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):
"PptJewel.About.TryMacOffice"===b&&Qd.a.wm(ia.a.D2a(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.CGi();return 32}oZi(b,h,r){if(1===r)return 32;switch(b){case fb.a.WCj:Qd.a.wm(ia.a.D2a(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case fb.a.VCj:Qd.a.wm(ia.a.D2a(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}CGi(){Qd.a.wm(xG.K9m,"_blank",void 0,"LaunchMacTrialWindow")}get D$c(){return this.W8j&&Z.a.fl&&!Z.a.cHf&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get mto(){const b=
this.D$c;b||v.AFrameworkApplication.Vl.Pgo();return b}get lto(){return this.D$c}static get K9m(){return ia.a.e9("522401")}}Object(m.a)(xG,"MacOfficeOffer",null,[983]);class yG{constructor(b,h,r){this.ga=b;this.a9j=h;this.yI=null;(this.hAd=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&Ma.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(B=>{this.yI=B});this.r7=r}Tb(){this.ga.ra(fb.a.tryOffice,
yd.a.frame,Object(z.a)(this,this.Rvn,"onTryOffice"));this.ga.ra(fb.a.kog,yd.a.frame,Object(z.a)(this,this.kog,"tryOfficeThroughTellMe"));this.ga.ra(fb.a.aDj,yd.a.frame,Object(z.a)(this,this.bDj,"tryOfficeThroughViewer"));this.ga.ra(fb.a.$Cj,yd.a.frame,Object(z.a)(this,this.bDj,"tryOfficeThroughViewer"))}Rvn(b,h,r,B,P){if(this.hAd&&1===r)return this.isFreemiumUpsellEnabled&&this.E$c?32:8;2===r&&(P?(b=P.SourceControlId,"btnjTryOfficeForWordEditor"===b?Qd.a.wm(ia.a.D2a(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):
"PptJewel.About.TryOffice"===b?Qd.a.wm(ia.a.D2a(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.wKf()):this.wKf());return 32}kog(b,h,r,B,P){if(this.hAd&&1===r)return this.isFreemiumUpsellEnabled&&this.E$c?32:8;2===r&&(P?(b=P.SourceControlId,Qd.a.wm(ia.a.e9("862405")+this.x9l(b),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):Qd.a.wm(ia.a.e9("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}bDj(b,h,r){if(this.hAd&&1===r)return this.isFreemiumUpsellEnabled&&
this.E$c?32:8;if(2===r)switch(b){case fb.a.aDj:Qd.a.wm(ia.a.D2a(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case fb.a.$Cj:Qd.a.wm(ia.a.D2a(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get Ujn(){return this.E$c}get Tjn(){return this.E$c&&MSOJS.ClientUtils.OfferOfficeInDialog()}get E$c(){return this.a9j&&!Z.a.fl}get isFreemiumUpsellEnabled(){let b=!1;this.yI&&(b=this.yI.isFreemiumUpsellEnabled());return b}wKf(b=null){let h=0;b&&(h=b);Qd.a.wm(yG.Y2l(h),"_blank",void 0,"LaunchOfficeOffer")}x9l(b){let h=
0;switch(b){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":h=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":h=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":h=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":h=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":h=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":h=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":h=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":h=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":h=
9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":h=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":h=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":h=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":h=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":h=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":h=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":h=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":h=27;break;
case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":h=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":h=29}return 0===h?"":String.format("&pc={0:D}",h)}static Y2l(b){if(Z.a.vi)switch(b){case 1:return ia.a.e9("393806");case 2:return ia.a.e9("393810");case 3:return ia.a.e9("393809");case 5:return ia.a.e9("393805")}else if(Z.a.OG)switch(b){case 1:return ia.a.e9("521979");case 3:return ia.a.e9("521980");case 5:return ia.a.e9("521978");case 2:return ia.a.e9("522490")}else{if(2===b)return ia.a.e9("517778");
if(1===b)return ia.a.D2a(30)}return ia.a.e9("522402")}}Object(m.a)(yG,"OfficeTrialExperience",null,[982]);class oJ{wc(b){b.register(yG,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").ha().Ud(()=>new yG(v.AFrameworkApplication.va,v.AFrameworkApplication.IGf,v.AFrameworkApplication.lcid));b.register(xG,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").ha().Ud(()=>new xG(v.AFrameworkApplication.va,v.AFrameworkApplication.gAi,v.AFrameworkApplication.lcid))}}
Object(m.a)(oJ,"OpenInClientConfiguration",null,[2]);class pJ{constructor(b=!1,h=!1,r=!1,B=!1,P=!0,ca=!1,ra=!0,Qa=!0,tb=!0,Mb=!1,Zb=!1,jc=!1,Gc=!1,Uc=!1,od=!1,Od=!1,ze=!1,de=!1,ee=null,je=null,ue=null,Qf=null,Jg=null,Ql=null,Fm=null,Kp=null,nv=null){this.wcc=!1;this.Xek=b;this.bfk=h;this.sjk=r;this.qjk=B;this.ljk=P;this.mjk=ca;this.ojk=ra;this.pjk=Qa;this.njk=tb;this.Djk=Mb;this.Yjk=Zb;this.Cjk=jc;this.slk=Gc;this.wjk=Uc;this.k7j=od;this.Rjk=Od;this.Zjk=ze;this.IYj=de;this.ujk=ee;this.Bjk=je;this.rjk=
Jg;this.zjk=ue;this.tjk=Qf;this.yjk=Ql;this.Ajk=Fm;this.vjk=Kp;this.xjk=nv}get j1i(){return this.Xek}get VBn(){return this.bfk}get xqj(){return this.sjk}get wqj(){return this.qjk}get zso(){return this.ljk}get Aso(){return this.mjk}get Cso(){return this.ojk}get Dso(){return this.pjk}get Bso(){return this.njk}get sqb(){return this.wjk}get QCm(){return this.k7j}get drj(){return this.Rjk}get Grj(){return this.Zjk}get ZTk(){return this.IYj}get Aqj(){return this.Djk}get Guo(){return this.Yjk}get Mso(){return this.Cjk}get lxj(){return this.slk}get yqj(){return this.ujk||
Object(z.a)(this,this.Sjc,"returnFalse")}get Lso(){return this.Bjk||Object(z.a)(this,this.Sjc,"returnFalse")}get Kso(){return this.zjk||Object(z.a)(this,this.$$f,"returnTrue")}get Fso(){return this.tjk||Object(z.a)(this,this.$$f,"returnTrue")}get Eso(){return this.rjk||Object(z.a)(this,this.Sjc,"returnFalse")}get Jso(){return this.yjk||Object(z.a)(this,this.$$f,"returnTrue")}get zqj(){return this.Ajk||Object(z.a)(this,this.Sjc,"returnFalse")}get Gso(){return this.vjk||Object(z.a)(this,this.Sjc,"returnFalse")}get Iso(){return this.xjk||
Object(z.a)(this,this.Sjc,"returnFalse")}$$f(){return!0}Sjc(){return!1}}Object(m.a)(pJ,"HtmlTranslatorSettings",null,[341]);class CB{constructor(b,h,r,B,P,ca,ra){this.Yf=b;this.jg=h;this.sX=r;this.ekf=B;this.Ej=P;this.Qd=ca;this.xR=ra}XDm(b,h){var r;b=h.view;h=h.ik;if(!h||!this.Yf.Xxi(h,!0)||this.ekf&&this.ekf.instance&&this.ekf.instance.SU(h))return 2;var B=CB.u8a?!CB.z0.Ixa(h):!0;this.sX&&B&&this.sX.woc(h.node,se.a.Ss,h.cpBegin);B=h.node;(null===(r=this.xR)||void 0===r?0:r.replaceText)&&this.xR.Bdc(B)?
(r=B.qa.v1a(h.cpBegin),this.xR.replaceText(B,r,r,ms.a.WZc)):this.jg.hia(h,P=>new ms.a(P));if(this.Qd.xg){r=new cg.GraphTransaction(15);try{r.Db(h.node),this.Ej.wra(h.node,h.cpBegin,h.cpBegin+1,1)}finally{r&&r.dispose()}}B=h.node;r=h.cpEnd+1;" "===ke.ParagraphReader.text(B).charAt(r)&&(B=Ue.a.createTextRange(B,r,r+1),this.jg.Ge(B,"\u00a0"));h=Ue.a.Rc(h.node,r);b.mb.Ac(og.SelectionFactory.Zn(h));return 32}static get z0(){return null!=CB.oBg?CB.oBg:CB.oBg=Ma.a.instance.resolve("Box4.IHyperlinkStrategy")}static get u8a(){null==
CB.wma&&(CB.wma=v.AFrameworkApplication.K?v.AFrameworkApplication.K.$("SplitHyperlinkFixWithEnterIsEnabled"):!1);return CB.wma}}CB.wma=null;Object(m.a)(CB,"InsertLineBreakStrategy",null,[]);class Yv{static get Pf(){return null!=Yv.aFg?Yv.aFg:Yv.aFg=Ma.a.instance.resolve("Box4.IOutlineElementEditor")}static get ah(){return An.ContextSetEditor.instance}static get Ej(){return null!=Yv.uIg?Yv.uIg:Yv.uIg=Ma.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}static get Qd(){return null!=
Yv.YIg?Yv.YIg:Yv.YIg=Ma.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}static uEm(b,h,r,B,P){if(P&&P.hasProperty(Yc.a.targetObject)){var ca=h.view.ed.Mc.Eb(P.getValue(Yc.a.targetObject));ca=Ue.a.create(ca)}else ca=Yv.ah.WT(h.ik,11);if(!ca)return 8;b=v.AFrameworkApplication.va.Nf(ca,b,r,!0,B,P);if(32===b&&2===r){if(!h.view.ue)return 2;h=h.view;B=h.mb.qg;if(B=Yv.ah.WT(B,11)){r=new Nf.a;r.set(B.node);r.qd();if(P&&P.hasProperty(Yc.a.targetObject))for(P=P.wf(Yc.a.targetObject);!r.currentNode.id.equals(P)&&
r.uc()&&(ig.OutlineElementNavigator.Yd(r),11===r.Xe););ig.OutlineElementNavigator.h1(r,!1,!1);P=xe.SelectionEditor.XEa(r,!0);P=ke.ParagraphReader.Bt(P)?og.SelectionFactory.ne(P,0):og.SelectionFactory.Eq(P);h.mb.Ac(P)}}return b}static cYd(b,h,r,B,P){b=b===Nb.a.kVc;h=h.node;if(P&&P.hasProperty(Yc.a.targetObject)&&!h.id.equals(P.wf(Yc.a.targetObject)))return 2;if(1===r)return 32;r=new Ad.GraphIterator;r.set(h);r.zb(10);Yv.Pf.My(r,b,!0);Yv.Qd.xg&&(r=ig.OutlineElementNavigator.Ee(r),Yv.Ej.HQb(r,1));return 32}}
Object(m.a)(Yv,"InsertOutlineElementStrategy",null,[]);class zG{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb){this.eti=(jc,Gc,Uc)=>{var od,Od;if(null===(od=this.Daa)||void 0===od?0:od.Jqb)return this.Daa.Jqb(Uc,Gc.cpBegin,{Fb:Gc.Fb,Sb:Gc.Sb});od=!Gc.cpBegin;Uc=Gc.cpBegin===ke.ParagraphReader.textLength(Uc);const ze=!(null===(Od=Eb.App.zd)||void 0===Od||!Od.Uo);let de=!0;ze&&od&&!Uc?(de=!1,Od=new Ad.GraphIterator,Od.kd(jc),Od.qd(),this.rh.My(Od,!0,!1)):Od=this.rh.npa(jc);this.rh.S$(jc,Od,Gc,!1,!0,de,!1,
!0);!ze||od||Uc||(jc=An.ContextSetEditor.instance.YQd(Gc),Eb.App.zd.fq.gG(jc));return Od};this.DZ=h;this.h2j=b;this.gA=ca;this.jak=P;this.rh=r;this.$_j=B;this.Ok=ra;this.hb=Qa;this.NE=tb;this.Vsc=Mb;this.Daa=Zb}Ugn(b,h,r,B,P){if(!h.view.ue)return 2;h=h.view;let ca=null;h.Zi&&(ca=h);const ra=h.mb.qg;var Qa=!0;let tb=!1,Mb=null;if(!ra)return 2;const Zb=new cg.GraphTransaction(15);Zb.Db(h.ed);let jc=null;2===r&&(jc=new Nf.a,jc.set(ra.node),jc.qd(),Mb=new Py.a(jc),ig.OutlineElementNavigator.Yd(jc),Qa=
Uf.OutlineElementReader.isEmpty(jc,!1),{Pqj:Qa,cLj:tb}=this.$_j.Qqj(jc,Qa,Tt.a.MGb,-1,ra));b=v.AFrameworkApplication.va.Nf(ra,b,r,!1,B,P);Qa&&32===b&&2===r&&(tb||ig.OutlineElementNavigator.oHa(jc,!1,!xe.SelectionEditor.Ze(ra),!1),tb&&Mb&&Mb.restore(jc),this.gA.freeze(),(r=og.SelectionFactory.ro(jc.currentNode,!0))||t.ULS.sendTraceTag(591958035,324,15,"could not create selection for NewLineView."),h.mb.Ac(r),this.gA.sJa(),this.h2j.ug.tF());ca&&(Qa||ca.E1(),ca.xe&&ca.TU&&(ca.xe.pI=!0));Ny.GrippersManager.instance.ZSb(1);
Zb.dispose();return b}newLine(b,h,r){b=!1;if(Id.ImageReader.Q4(h)||Id.ImageReader.a4a(h))h=this.r7k(h),b=!0;const B=h;if((h=xe.SelectionEditor.Ze(h))&&this.Ok.jh&&!this.Ok.RQm(B))return 2;if(1===r)return 32;const P=B.node,ca=new Ad.GraphIterator;ca.set(P);ca.qd();ig.OutlineElementNavigator.Yd(ca);r=new cg.GraphTransaction(15);r.St(ca);h?(this.Vsc.instance&&this.Vsc.instance.JJa(B),ke.ParagraphReader.Xb(P)&&B.cpBegin===ke.ParagraphReader.textLength(P)&&So.m(B)&&9===ke.ParagraphReader.Koa(P)&&this.gA.p8k(B),
fg.ListItemReader.lg(ca)?this.jak.execute(ca,B,P,this.eti):this.eti(ca,B,P),this.DZ&&this.DZ.woc(P,se.a.Ss,B.cpBegin),b&&(ig.OutlineElementNavigator.ns(ca,!1,!1),b=ca.Ub(2),(b=this.NE.ne(b,0))&&this.hb.Ac(b))):this.rh.My(ca,!0,!0);r.dispose();Eb.App.za&&Eb.App.za.updateCommandUI();return 32}r7k(b){if(Id.ImageReader.Q4(b))var h=Ue.a.Rc(b.node,b.cpBegin);else{h=ke.ParagraphReader.YQ(b.node);var r=h.properties.wf(Mc.a.vq);b=b.node.properties.getValue(Mc.a.runId);r=zG.Hpf(b,r,h.qa);h=Ue.a.Rc(h,r)}return h}static llf(b,
h){let r=0;for(;r<h.length&&!(b<h[r]);)r++;return r}static Hpf(b,h,r){let B=0;b=zG.llf(b,h);let P=0;if(b===h.length)P=r.length-1;else for(;P<r.length;){h=r.J(P);if(h.formatting&&h.formatting.qe===b)break;P++}P<r.length&&(B=r.J(P).cp);return B}}Object(m.a)(zG,"NewLineStrategy",null,[]);class aE{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc,Uc,od,Od){this.Qm=null;this.Jma=b;this.Zkd=ra;this.bsd=new zG(this,h,r,B,P,ca,Qa,Zb,jc,od,Od);this.G_g=new CB(Qa,tb,h,Mb,Gc,Uc,Od)}get ug(){return this.Qm||(this.Qm=
this.Jma())}Tb(){const b=v.AFrameworkApplication.va,h=Object(z.a)(this.bsd,this.bsd.newLine,"newLine");b.fb(Nb.a.enter,yc.a.view,Object(z.a)(this.Zkd.value,this.Zkd.value.cyl,"enterView"),1124);b.fb(Nb.a.Wpj,yc.a.view,Object(z.a)(this.Zkd.value,this.Zkd.value.jro,"shiftEnterView"),1124);b.ra(Nb.a.newLine,yc.a.view,Object(z.a)(this.bsd,this.bsd.Ugn,"newLineView"));b.ra(Nb.a.newLine,yc.a.Uc,h);b.ra(Nb.a.newLine,yc.a.image,h);b.ra(Nb.a.newLine,yc.a.Fd,h);b.ra(Nb.a.newLine,yc.a.X7,h);b.ra(Nb.a.newLine,
yc.a.Ehb,h);b.ra(Nb.a.newLine,yc.a.ink,h);b.ra(Nb.a.newLine,yc.a.paragraph,h);b.ra(Nb.a.newLine,yc.a.iFrame,h);b.ra(Nb.a.newLine,yc.a.unsupportedObject,h);b.Xc(Nb.a.newLine,1124);b.fb(Nb.a.gVc,yc.a.view,Object(z.a)(this.G_g,this.G_g.XDm,"insertLineBreakView"),1028);b.ra(Nb.a.kVc,yc.a.view,Yv.uEm);b.ra(Nb.a.kVc,yc.a.LP,Yv.cYd);b.Xc(Nb.a.kVc,1092)}static get instance(){return null!=aE.rCg?aE.rCg:aE.rCg=aE.fm()}static fm(){return new aE(()=>Ma.a.instance.resolve("Box4.IUndoManager"),Ma.a.instance.Oa("Box4.IAutoCorrectScheduler"),
Ma.a.instance.resolve("Box4.IOutlineElementEditor"),Ma.a.instance.resolve("Box4.List.ICursorMovementValidator"),Ma.a.instance.resolve("Box4.List.ListNewLineStrategy"),Ma.a.instance.resolve("Box4.IInsertionPointFormatting"),Ma.a.instance.Ve("Box4.Actors.IEnterViewStrategy"),Wh.a.instance,Ma.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ma.a.instance.Ta("Box4.IExternalSelectionManager"),Bh.a.instance,Ma.a.instance.resolve("Box4.ISelectionFactory"),Ma.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,
Ma.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ma.a.instance.Ta("Box4.IContentControlConverter"),Ma.a.instance.resolve("Box4.IBox4GraphWriter"))}}Object(m.a)(aE,"EnterActor",null,[]);var rH=c(1410),sH=c(891);class Ek{static get Tk(){return null!=Ek.IFg?Ek.IFg:Ek.IFg=Ma.a.instance.resolve("Box4.IParagraphEditor")}static get W5(){return null!=Ek.fHg?Ek.fHg:Ek.fHg=Ma.a.instance.Oa("Box4.ISpacingCommands")}static get UUa(){return null!=Ek.qHg?Ek.qHg:Ek.qHg=Ma.a.instance.Oa("Box4.Styles.IWACStyleReader")}static get n5a(){return null!=
Ek.cEg?Ek.cEg:Ek.cEg=Ma.a.instance.Oa("Box4.ILineSpacingHelper")}static get Ej(){return null!=Ek.CIg?Ek.CIg:Ek.CIg=Ma.a.instance.Oa("Box4.TrackChange.ITrackChangeEditor")}static get Qd(){return null!=Ek.cJg?Ek.cJg:Ek.cJg=Ma.a.instance.Oa("Box4.TrackChange.ITrackChangeManager")}static Tb(){const b=v.AFrameworkApplication.va;b.ra(Nb.a.iLf,yc.a.view,Em.a.lw);b.Xc(Nb.a.iLf,1028);b.ra(Nb.a.mD,yc.a.view,Em.a.lw);b.ra(Nb.a.mD,yc.a.paragraph,Ek.yDd);b.Xc(Nb.a.mD,1036);b.ra(Nb.a.blc,yc.a.paragraph,Ek.JEk);
b.ra(Nb.a.blc,yc.a.view,Em.a.lw);b.Xc(Nb.a.blc,1036);b.ra(Nb.a.F9c,yc.a.paragraph,Ek.t2e);b.ra(Nb.a.F9c,yc.a.view,Em.a.lw);b.ra(Nb.a.g$c,yc.a.paragraph,Ek.O2e);b.ra(Nb.a.g$c,yc.a.view,Em.a.lw);b.ra(Nb.a.E9c,yc.a.paragraph,Ek.s2e);b.ra(Nb.a.E9c,yc.a.view,Em.a.lw);b.ra(Nb.a.E_e,yc.a.view,Ek.hAk);b.Xc(Nb.a.E_e,1036);b.ra(Nb.a.x8f,yc.a.view,Ek.A2n);b.Xc(Nb.a.x8f,1036);b.ra(Nb.a.D_e,yc.a.view,Ek.gAk);b.Xc(Nb.a.D_e,1036);b.ra(Nb.a.w8f,yc.a.view,Ek.z2n);b.Xc(Nb.a.w8f,1036);b.ra(Nb.a.yUa,yc.a.view,Em.a.lw);
b.ra(Nb.a.yUa,yc.a.paragraph,Ek.yDd);b.Xc(Nb.a.yUa,1036);b.ra(Nb.a.xUa,yc.a.view,Em.a.lw);b.ra(Nb.a.xUa,yc.a.paragraph,Ek.yDd);b.Xc(Nb.a.xUa,1036);b.ra(Nb.a.dke,yc.a.view,Ek.cke);b.ra(Nb.a.dke,yc.a.paragraph,Ek.cke);b.Xc(Nb.a.dke,1028);b.ra(Nb.a.Qig,yc.a.view,Ek.cke);b.ra(Nb.a.Qig,yc.a.paragraph,Ek.cke);b.Xc(Nb.a.Qig,1028);b.ra(Nb.a.Vje,yc.a.view,Em.a.lw);b.ra(Nb.a.Vje,yc.a.paragraph,Ek.evh);b.Xc(Nb.a.Vje,1028);b.ra(Nb.a.Uje,yc.a.view,Em.a.lw);b.ra(Nb.a.Uje,yc.a.paragraph,Ek.evh);b.Xc(Nb.a.Uje,1028)}static evh(b,
h,r,B,P){if(1===r)return 32;b===Nb.a.Vje?b=Nb.a.yUa:b===Nb.a.Uje&&(b=Nb.a.xUa);return Ek.yDd(b,h,r,B,Ek.tBn(P))}static tBn(b){var h=b.indexOf(",");const r=b.substring(0,h);b=b.substring(h+1,b.length);h=new rH.a;h.value=parseFloat(r);h.unit=parseInt(b);return h}static cke(b,h,r,B,P){if(2===r){h=P[Pi.a.Text];r=P[Pi.a.Number];P=P.Increment;B=new rH.a;let ca=!1;""===h||P&&h===Box4Intl.Box4Strings.L_SpinnerAuto?(B.value=0,B.unit=Eb.App.EGa?2:4,ca=!0):r||P||(B.value=0,B.unit=1,ca=!0);ca&&(v.AFrameworkApplication.va.Qb(b===
Nb.a.dke?Nb.a.yUa:Nb.a.xUa,2,B),Eb.App.za.updateCommandUI())}return 32}static yDd(b,h,r,B,P){if(!({Ay:r}=Em.a.bgg(r,h)).returnValue)return r;h=h.node;switch(b){case Nb.a.mD:Ek.Tk.mD(h,new sH.a(2,P));break;case Nb.a.yUa:b=new sH.a(P.unit,P.value);Ek.Tk.Opb(h,b);break;case Nb.a.xUa:b=new sH.a(P.unit,P.value),Ek.Tk.Npb(h,b)}B&&as.a.krb&&(B.Hs|=as.a.Tib(h));return 32}static hAk(b,h,r){if(1===r)return 32;t.ULS.sendTraceTag(588394561,340,50,"Add Space Before Paragraph option is clicked");b=Ek.$hi(h);if(!b)return t.ULS.sendTraceTag(588367186,
3018,10,"No style applied on the paragraph"),8;b=(b=b.ja(Mc.a.Ui,240)/20)?b:Ek.ujl;Ek.W5.mea(1,b,4);return 32}static A2n(b,h,r){if(1===r)return 32;t.ULS.sendTraceTag(588394562,340,50,"Remove Space Before Paragraph option is clicked");Ek.W5.mea(1,0,4);return 32}static gAk(b,h,r){if(1===r)return 32;t.ULS.sendTraceTag(588394563,340,50,"Add Space After Paragraph option is clicked");b=Ek.$hi(h);if(!b)return t.ULS.sendTraceTag(588367187,3018,10,"No style applied on the paragraph"),8;b=b.ja(Mc.a.ta,240)/
20;Ek.W5.mea(0,b?b:12,4);return 32}static z2n(b,h,r){if(1===r)return 32;t.ULS.sendTraceTag(588394564,340,50,"Remove Space After Paragraph option is clicked");Ek.W5.mea(0,0,4);return 32}static t2e(b,h,r,B,P){if(2==r){if("boolean"!==typeof P)return 16;b=h.node;h=null;sq.a.instance.J(1)&&(h=b.$D());Ek.Tk.t2e(b,P);h&&Ek.Ej.DV(b,h,Ek.Qd.xg)}return 32}static O2e(b,h,r,B,P){if(2==r){if("boolean"!==typeof P)return 16;b=h.node;h=null;sq.a.instance.J(1)&&(h=b.$D());Ek.Tk.O2e(b,P);h&&Ek.Ej.DV(b,h,Ek.Qd.xg)}return 32}static s2e(b,
h,r,B,P){if(2==r){if("boolean"!==typeof P)return 16;b=h.node;h=null;sq.a.instance.J(1)&&(h=b.$D());Ek.Tk.s2e(b,P);h&&Ek.Ej.DV(b,h,Ek.Qd.xg)}return 32}static JEk(b,h,r,B,P){if(2==r){if("boolean"!==typeof P)return 16;b=new Map;b.set("Value",P.toString());va.Health.instance.recordKpiUsage(gk.a.$lb.zLo,0,gk.a.yB,b);h=h.node;b=null;sq.a.instance.J(1)&&(b=h.$D());h.hasProperty(Mc.a.sw)&&h.removeProperty(Mc.a.sw);Ek.n5a.eRd(h)!==P&&h.setValue(Mc.a.sw,P);(P=Ek.n5a.k$b(h,!0))&&P.ol(4,!0);(P=Ek.n5a.k$b(h,!1))&&
P.ol(4,!0);b&&Ek.Ej.DV(h,b,Ek.Qd.xg)}return 32}static $hi(b){b=b.view;return b.ue&&(b=b.mb)&&b.ib.lb?Ek.UUa.So(b.ib.lb.Pa.node):null}}Ek.ujl=12;Object(m.a)(Ek,"SpacingActor",null,[]);class qJ{process(){}}Object(m.a)(qJ,"NoOpFormattingViewOperationFinishedStageProcessor",null,[38]);class rJ{constructor(b){this.De=b}ojo(b,h){b&&h&&h.cache&&(this.De.$ja(b,h.cache.FG),this.De.WA(b,h.cache.fontSize))}zGb(){return null}nQa(){return null}V$b(){return null}wU(){return null}}Object(m.a)(rJ,"FormattingStewardBridge",
null,[47]);class sJ{wc(b){b.ia("Box4.Actors.IFormattingViewOperationFinishedStageProcessor",()=>new qJ).ha();b.ia("Box4.Actors.IFormattingStewardBridge",()=>new rJ(b.resolve("Box4.IFormattingEditor"))).ha()}}Object(m.a)(sJ,"WoncaActorsConfiguration",null,[2]);class tJ{constructor(b,h,r,B,P,ca,ra,Qa){this.ga=b;this.ZXj=h;this.YXj=r;this.sNg=B;this.$ek=P;this.Ktd=ca;this.dfk=ra;this.efk=Qa}get oc(){return this.ga}DMk(b){this.oc.Rqa(b,this.ZXj,null,null)}BMk(b){this.oc.Rqa(b,this.YXj,null,null)}P_(b,
h,r){r?this.oc.Rqa(b,this.sNg,h,null):this.oc.Qb(this.sNg,2,h)}YBn(b,h){this.oc.Rqa(b,this.Ktd,h,null)}j$(b,h){this.oc.Rqa(b,this.dfk,h,null)}wob(b,h){this.oc.Rqa(b,this.efk,h,null)}k0f(b,h=!1){const r=new fd.DictionaryPropertySet;r.setValue(Yc.a.NP,b);r.setValue(Yc.a.E1i,!0);r.setValue(Yc.a.o4a,h);this.oc.Qb(this.$ek,2,r)}}Object(m.a)(tJ,"ClipboardCommands",null,[1369]);class uJ{}Object(m.a)(uJ,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",null,[1273]);class vJ{constructor(b){this.ga=b}get oc(){return this.ga}bnj(b,
h,r){let B=0;b?1===b&&(B=Nb.a.J3a):B=Nb.a.I3a;b=new DD.a;b.unit=r;b.value=h;this.oc.Qb(B,2,b)}Ihe(b,h,r){let B=0;1===b?B=Nb.a.zQb:2===b?B=Nb.a.dqb:b||(B=Nb.a.AQb);b=new DD.a;b.unit=r;b.value=h;this.oc.Qb(B,2,b)}}Object(m.a)(vJ,"IndentationCommands",null,[1307]);var AG;(function(b){b[b.unspecified=-1]="unspecified";b[b.none=0]="none";b[b.left=1]="left";b[b.center=2]="center";b[b.right=3]="right";b[b.slp=4]="inner";b[b.outer=5]="outer";b[b.both=6]="both";b[b.Dhp=7]="distribute";b[b.margin=8]="margin";
b[b.Vkp=9]="highKashida";b[b.Mmp=10]="lowKashida";b[b.Xmp=11]="mediumKashida";b[b.Xnp=12]="numTab";b[b.Ltp=13]="thaiDistribute";b[b.start=14]="start";b[b.end=15]="end"})(AG||(AG={}));Object(m.b)("Justification",AG);class wJ{constructor(b){this.lMa={};this.ga=b;this.Bzm()}get oc(){return this.ga}oE(b){b=this.lMa[AG[b]];void 0!==b&&null!==b&&this.oc.processAction(b,2)}Bzm(){this.lMa.left=Nb.a.I9;this.lMa.center=Nb.a.Lba;this.lMa.right=Nb.a.z$;this.lMa.both=Nb.a.hFa;this.lMa.lowKashida=Nb.a.rKb;this.lMa.mediumKashida=
Nb.a.rKb;this.lMa.highKashida=Nb.a.rKb;this.lMa.distribute=Nb.a.kMc;this.lMa.thaiDistribute=Nb.a.Z9c}}Object(m.a)(wJ,"JustificationCommands",null,[1302]);class xJ{constructor(b){this.ga=b}mD(b){this.ga.Qb(Nb.a.mD,2,b)}blc(b){this.ga.Qb(Nb.a.blc,2,b)}F9c(b){this.ga.Qb(Nb.a.F9c,2,b)}g$c(b){this.ga.Qb(Nb.a.g$c,2,b)}E9c(b){this.ga.Qb(Nb.a.E9c,2,b)}mea(b,h,r){this.ga.Qb(b?Nb.a.yUa:Nb.a.xUa,2,Object.assign(new rH.a,{value:h,unit:r}))}}Object(m.a)(xJ,"SpacingCommands",null,[1185]);class yJ{constructor(b,
h,r){this.oc=b;this.PMc=h;this.mul=r;this.Uwn=(B,P,ca)=>{if(1===ca)return this.PMc.I_?32:8;this.PMc.U2m();this.mul().wwo(this.PMc.IWl());return 32}}Tb(){this.oc.fb(Nb.a.bob,yc.a.application,this.Uwn,1028)}}Object(m.a)(yJ,"EditorSettingsUIActor",null,[]);class zJ extends Pe.a{constructor(b,h){super(!1,!1,!0);this.oul=b;this.cSa=h;this.nul=r=>{1!==r?t.ULS.sendTraceTag(527434075,340,50,"Editor Settings closed without changes"):(this.oul.ZTo(),t.ULS.sendTraceTag(578869131,340,50,"Editor Settings updated"))}}async wwo(b){const h=
await this.cSa.RKb;b={["id"]:"SettingsDialog",["uiLanguage"]:v.AFrameworkApplication.uiCulture,["selectedLanguage"]:lj.a.tg(v.AFrameworkApplication.lcid).name,["isGoalActive"]:!1,["isSubscription"]:h.TYc,["editorSettings"]:b};this.Uh(Box4Intl.Box4Strings.l_EditorSettings,this.nul,b);t.ULS.sendTraceTag(578091235,340,50,"Editor settings dialog is opened.")}}Object(m.a)(zJ,"EditorSettingsDialog",Pe.a,[]);class AJ{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc,Uc,od){this.Zxb=this.WAc=this.fsc=null;this.ETe=
0;this.CFe=!1;this.sa=new Pc.a;this.i_d=!1;this.$u=b;this.gA=h;this.De=r;this.Ys=B;this.gb=P;this.Hf=ra;this.Md=Qa;this.Ok=tb;this.rd=Mb;this.Vd=Zb;this.Aq=jc;this.YW=Gc;this.qz=Uc;this.Lo=od}get Qvl(){return this.rd?this.rd.isFeatureEnabled(42):!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled")}get Jmf(){return null!=this.oAg?this.oAg:this.oAg=Ma.a.instance.resolve("Box4.IFormatPainterStrategy")}get DR(){return this.CFe}set DR(b){this.CFe!==b&&(this.CFe=
this.i_d=b,this.sa.raiseEvent("FormatPainterBrushActiveStatusChanged"))}Wwk(b){this.sa.addHandler("FormatPainterBrushActiveStatusChanged",b)}q2i(b){const h=b.Pa;t.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",h.contextId);this.reset();var r=h.node;b=this.xAi(b);if(this.Jmf.sto(h.contextId,b))try{this.Zxb=this.gb.U2a(r)}catch(B){throw t.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",B.message),B;}this.WAc=this.qz.So(r);r=pn.FormattingReader.Yr(h);r.Jn&&(this.fsc=
Object(Ra.a)(Zz.a,r.Jn.clone()));this.ETe=b?yc.a.paragraph:h.contextId}Buh(b){if(b){const r=this.xAi(b);for(let B=0;B<b.length;B++){const P=b.J(B);if(null===P||void 0===P?0:P.el)this.fBb(P,r);else if(0==(null===P||void 0===P?void 0:P.length))t.ULS.sendTraceTag(529089953,354,50,"Attempt to apply format to non-graph-node context: {0}",P);else if(P)for(let ca=0;ca<P.length;ca++){var h=P.getContext(ca);if(null===h||void 0===h?0:h.jx){if(h)for(let ra=0;ra<h.length;ra++)P.addContext(h.getContext(ra))}else(null===
h||void 0===h?0:h.el)?this.fBb(h,r):t.ULS.sendTraceTag(529089954,354,50,"Attempt to apply format to non-graph-node context: {0}",h.contextId)}}}}Fuh(b,h){if(h){var r=b.node,B=r.qa.last,P=this.Md.J1a(r),ca=P.vf(P.Lb);this.Guh(P,h,null);sq.a.instance.J(1)&&this.Aq.kQb(r,B,b.cpBegin,b.cpEnd,ca,P,this.Vd.xg)}}XEk(b,h,r){if(h||r)0<So.g(b).length&&t.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this.YW.rX(b,B=>{this.Guh(B,h,r)})}Guh(b,h,r){this.De.Iga(b);b.Jn&&b.Jn.removeProperty(Pd.a.highlight);
this.De.h8e(b);r&&(r=r.clone(),r.Cg(...yo.a.Ica()),this.ax(b,r.Gl()));this.ax(b,h)}ax(b,h){if(h){var r=b.paragraph.Mc;if(r){var B=b.Jn;B=B?Object(Ra.a)(Qz.a,B.clone()):Zz.a.NOa(1179725);for(const ca of h.xl())if(ca!==Mc.a.mw&&ca!==Mc.a.UX&&ca!==Pd.a.UB&&ca!==Pd.a.T4&&ca!==Mc.a.h4a&&ca!==Pd.a.uL&&ca!==Mc.a.g5a&&ca!==Mc.a.noProof){if(ca===gi.a.qw){var P=h.ja(gi.a.qw,V.a.nil);if(P!==V.a.nil)if(P=r.Eb(P)){if(P=new ww.a(P),P=this.qz.uR(P),P===Box4Intl.Box4Strings.L_StyleWordHyperlink)if(P=this.qz.JB(b.paragraph).JFa(P)){B.SOa(P.Gl(),
...yo.a.Ica());continue}else t.ULS.sendTraceTag(589345875,354,50,"Applied Hyperlink style on formatting is not present in Style Set")}else t.ULS.sendTraceTag(589345876,354,50,"Applied character style on formatting is not present in Object Space")}B.setValue(ca,h.wf(ca))}B.PGa?h=r.rV(B,!0):(r.Uu(B),h=B);b.Yj=h.id}}}xAi(b){return!b.Yw&&b.Tc.contextId!==yc.a.Vc}reset(){this.Zxb=this.WAc=this.fsc=null;this.ETe=yc.a.none}fBb(b,h){if(b.contextId===yc.a.Uc||b.contextId===yc.a.Fd)var r=this.Ok.x9(b);else if(b.contextId===
yc.a.paragraph)r=this.Ok.m0d(b);else if(b.contextId===yc.a.Vc)r=this.Ok.UZd(b);else{t.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",b.contextId);return}t.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",b.contextId);if(r)t.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");else{r=Object(Ra.a)(oi.AParagraphNode,b.node);var B=!1;r&&(B=b.contextId===yc.a.Fd&&!!r&&!b.cpBegin&&b.cpEnd===this.gb.textLength(r));if(h=this.Jmf.vro(this.ETe,
b.contextId,h,B))try{ke.ParagraphReader.Xb(r)?(this.WAc&&this.$u.aK(this.WAc,r,!0),this.Ys.Xuh(r,this.Zxb)):t.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",b.node.type)}catch(P){throw t.ULS.sendTraceTag(22832065,354,10,"ApplyParagraphProperties error: {0}",P.message),P;}B=b;b.contextId===yc.a.paragraph?B=Ue.a.createTextRange(r,0,ke.ParagraphReader.textLength(r)):b.contextId===yc.a.Uc&&(B=this.gA.Auf(b),B=Bh.a.kDb(B));if(B&&B.contextId===
yc.a.Fd){if(zm.a.hId){const P=this.Lo.KTd(B);P&&(B=P)}try{this.XEk(B,this.fsc,h?null:this.WAc)}catch(P){throw t.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",P.message),P;}}if(b.contextId===yc.a.paragraph||b.contextId===yc.a.Vc)h=new Ad.GraphIterator,h.set(r),h.qd(),h.jd(11),B=fg.ListItemReader.lg(h),r=!ke.ParagraphReader.textLength(r),t.ULS.sendTraceTag(22832067,354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",B,r),B?(this.Hf.HP(h),this.Hf.hda(h.currentNode)&&
this.Fuh(b,this.fsc)):this.Qvl&&this.Fuh(b,this.fsc)}}}Object(m.a)(AJ,"FormatPainter",null,[1337]);var HM=c(111);class bE{constructor(b,h,r,B,P,ca,ra,Qa=!1,tb,Mb,Zb){this.Fpd=!1;this.bCe=new ar.a;this.cpm=()=>{this.cT.DR=!1;return 32};this.dpm=(jc,Gc,Uc)=>{jc=!1;if(Gc=this.pz.w4){switch(Gc.contextId){case yc.a.Fd:case yc.a.paragraph:case yc.a.Vc:case yc.a.Uc:jc=!0}jc&&xe.SelectionEditor.vl(Gc)&&So.b(Gc)&&(this.Ad.Yb(le.a.vn,{["Reason"]:ae.a.KJc}),jc=!1);jc&&ke.ParagraphReader.OU(Gc)&&(this.Ad.Yb(le.a.vn,
{["Reason"]:ae.a.AO}),jc=!1)}if(1===Uc||!jc)return jc?32:8;6!==this.ga.MC?(this.cT.DR?t.ULS.sendTraceTag(22832076,354,50,"User deactivated the Format Painter button"):(t.ULS.sendTraceTag(22832075,354,50,"User activated the Format Painter button"),this.cT.q2i(this.pz.lb),this.Fpd||(this.Nh.y_a(this.IFj),(Uc=this.Nh.jb.iu)&&Uc.Zi&&Uc.Fqh(this.HFj),this.Fpd=!0)),this.cT.DR=!this.cT.DR):(t.ULS.sendTraceTag(22832077,354,50,"User picked format from keyboard shortcut"),this.cT.q2i(this.pz.lb),this.cT.DR=
!1);return 32};this.bpm=(jc,Gc,Uc,od,Od)=>{if(6===this.ga.MC||this.cT.DR){t.ULS.sendTraceTag(22832078,354,50,"User applied the Format Painter from command location: {0}",this.ga.MC);jc=this.Nh.Lq.Zf("UserAction","FormatPainterApply");if(bE.Zb&&bE.Zb.TB(115)){Od=Od?Od.KeepBrushActive:!1;Uc=null;this.pz.lb&&2===this.pz.lb.trigger&&(Od=Od||this.cT.i_d,this.cT.i_d&&xe.SelectionEditor.Pl(this.pz.lb)&&(Uc=xe.SelectionEditor.j0(this.pz.lb.Pa,!1)))&&(Uc.trigger=2);this.cT.i_d=!1;if(Od||2!==this.pz.lb.trigger)Gc=
new cg.GraphTransaction(15),Uc&&Uc.Pa?(Gc.set(Uc.Pa.node.xj),this.hb.Ac(Uc)):Gc.set(this.pz.cFb.xj),Uc=og.SelectionFactory.Zn(this.hb.qg),this.cT.Buh(Uc),Gc.dispose();this.cT.DR=Od}else Od=new cg.GraphTransaction(15),Od.set(this.pz.cFb.xj),Gc=og.SelectionFactory.Zn(this.hb.qg),this.cT.Buh(Gc),this.cT.DR=!1,Od.dispose();jc.stop()}return 32};this.IFj=()=>{this.c9d(this.cT.DR)};this.HFj=()=>{this.c9d(this.cT.DR)};this.Nh=b;this.Vb=h;this.ga=r;this.Ad=B;this.pz=P;this.cT=ca;this.hb=ra;this.q8j=Qa;this.ly=
tb;this.zx=Mb;this.h0j=Zb}get yWg(){return Z.a.Nt||Z.a.F0d?"url("+this.z$h()+"), pointer":'url("'+this.z$h()+'"), pointer'}z$h(){return this.zx?this.ly.Hwa(Nd.a.wg("FormatPainterText.cur"),Nd.a.wg("FormatPainterTextDarkMode.cur"),new HM.a(bl.a.fL())):Nd.a.wg("FormatPainterText.cur")}Tb(){const b=this.Vb.fe(Qi.AppFrame.VD);b.bindAction(Jb.KeyInputManager.ic(se.a.YJa,0),Nb.a.Imf);b.bindAction(Jb.KeyInputManager.ic(se.a.Csb,6),Nb.a.JPd);this.q8j||b.bindAction(Jb.KeyInputManager.ic(se.a.Gsb,6),Nb.a.c2a);
this.ga.fb(Nb.a.JPd,yc.a.view,this.dpm,1028);this.ga.fb(Nb.a.c2a,yc.a.view,this.bpm,1028);this.ga.fb(Nb.a.Imf,yc.a.view,this.cpm,1028);this.cT.Wwk(()=>{this.vqg(this.cT.DR)});this.zx&&this.h0j.kCd(()=>{this.c9d(this.cT.DR)})}vqg(b){const h=this.Nh.Lq.Zf("UserAction","FormatPainterUpdateCursor");this.c9d(b);this.Nh.updateCommandUI();h.stop()}GFj(b,h){for(let r=0;r<b.length;r++)this.FFj(b[r],h);(b=this.Nh.jb.iu)&&b.ue&&this.FFj(b.xh.editingElement,h)}FFj(b,h){b.style.cursor=h?this.yWg:""}c9d(b){const h=
document.querySelectorAll(".OutlineElement");if(1<h.length){const r=h[h.length-2].style.cursor===this.yWg;if(this.Nh.jb.isEditingAllowed||this.Nh.jb.Py){if(b&&!r||!b&&r)this.GFj(h,b),this.eGj(b);b||!this.Fpd||this.bCe.count||(this.Nh.Hbj(this.IFj),(b=this.Nh.jb.iu)&&b.Zi&&b.r1n(this.HFj),this.Fpd=!1)}else r&&(this.GFj(h,!1),this.eGj(!1))}}eGj(b){const h=this.Nh.jb.iu;h&&(b?this.bCe.add(h.ed.Vk):this.bCe.remove(h.ed.Vk))}static get Zb(){return null!=bE.jzg?bE.jzg:bE.jzg=Ma.a.instance.Oa("Box4.IFeatureHelper")}}
Object(m.a)(bE,"FormatPainterActor",null,[]);class CA{constructor(b,h,r){this.en=r}cyl(b,h,r,B,P){var ca;if(!({ke:r,selected:ca,Ay:tb,eXc:Qa}=this.Zqj(h,r,!1)).returnValue)return tb;kh.a.mark(5013);var ra=CA.ah.vO(ca);for(let Mb=0;Mb<ra.length;++Mb){if(!ra[Mb].isValid)continue;const Zb=ra[Mb].iterator;Zb.Ip();if(Yg.OutlineReader.mx(Zb))return this.gYh(r,Zb)}var Qa=zm.a.iId&&Qa?Nb.a.gVc:this.fXl();if(ca.jx||xe.SelectionEditor.vl(ca)||ke.ParagraphReader.vm(ca)&&!xe.SelectionEditor.v9(ca)){if(CA.Zb&&
CA.Zb.isFeatureEnabled(25)&&An.ContextSetEditor.instance.Whg(ca).returnValue)return 8;var tb=this.hYh(h,r,b,B,P,Qa)}else if(xe.SelectionEditor.Lk(ca))tb=this.fYh(h,r,b,B,P,Qa);else if(xe.SelectionEditor.Ze(ca)){tb=new Ad.GraphIterator;tb.set(ca.node);tb.zb(10);ra=Tg.a.Ez(ca,!1);if(0<ra.length){if(!ra[0].hyperlink)return t.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",ra[0].cpBegin,ra[0].cpEnd),8;Eb.App.nFb(ra[0].hyperlink.url);return 32}Ah.TableCellReader.P0(tb)&&
(Kf.returnToContainingCell(tb),Ah.TableCellReader.ria(tb)&&(ra=new Ad.GraphIterator,ra.kd(tb),Kf.returnToContainingRow(ra),Yg.OutlineReader.KA(tb,ca,!1)&&dl.a.ryi(ra)&&0>=ca.Fb&&(Qa=Nb.a.kVc,Kf.returnToContainingTable(tb),ig.OutlineElementNavigator.Yd(tb),P||(P=new fd.DictionaryPropertySet),P.Hg(Yc.a.targetObject,tb.currentNode.id))));tb=this.iYh(h,r,b,B,P,Qa)}else xe.SelectionEditor.v9(ca)&&(tb=v.AFrameworkApplication.va.Nf(h,Nb.a.newLine,2,!1,B,P));kh.a.mark(5014);return tb}Zqj(b,h,r){let B=null,
P=null,ca=!1;if(1===h)return{returnValue:!1,ke:B,selected:P,Ay:32,eXc:ca};if(!b.view.ue)return{returnValue:!1,ke:B,selected:P,Ay:2,eXc:ca};B=b.view;P=B.mb.qg;return!P||!CA.Yf.Xxi(P,r)||zm.a.iId&&CA.Yf.via(P,ra=>ca=ra)&&!ca?{returnValue:!1,ke:B,selected:P,Ay:2,eXc:ca}:this.en&&this.en.instance&&this.en.instance.SU(P)?{returnValue:!1,ke:B,selected:P,Ay:4,eXc:ca}:{returnValue:!0,ke:B,selected:P,Ay:2,eXc:ca}}jro(b,h,r,B,P){let ca,ra;if(!({ke:r,selected:ca,Ay:ra}=this.Zqj(h,r,!0)).returnValue)return ra;
const Qa=CA.ah.vO(ca);for(let tb=0;tb<Qa.length;++tb){if(!Qa[tb].isValid)continue;const Mb=Qa[tb].iterator;Mb.Ip();if(Yg.OutlineReader.mx(Mb))return this.gYh(r,Mb)}ca.jx||xe.SelectionEditor.vl(ca)?ra=this.hYh(h,r,b,B,P,Nb.a.gVc):xe.SelectionEditor.Lk(ca)?ra=this.fYh(h,r,b,B,P,Nb.a.gVc):xe.SelectionEditor.Ze(ca)?ra=this.iYh(h,r,b,B,P,Nb.a.gVc):xe.SelectionEditor.v9(ca)&&(ra=v.AFrameworkApplication.va.Nf(h,Nb.a.newLine,2,!1,B,P));return ra}gYh(b,h){b.mb.Ac(og.SelectionFactory.ro(h.currentNode,!1));
return 32}hYh(b,h,r,B,P,ca){const ra=new cg.GraphTransaction(15);ra.Uj=r;ra.Db(h.ed);h=new fd.DictionaryPropertySet;h.setValue(Yc.a.qMc,!0);h=v.AFrameworkApplication.va.Nf(b,Nb.a.PH,2,!0,B,h);32===h&&(h=v.AFrameworkApplication.va.Nf(b,ca,2,!1,B,P));ra.dispose();return h}fYh(b,h,r,B,P,ca){const ra=new cg.GraphTransaction(15);ra.Uj=r;ra.Db(h.ed);h.mb.Ac(xe.SelectionEditor.Jj(h.mb.ib.J(0),!1,!1));b=v.AFrameworkApplication.va.Nf(b,ca,2,!1,B,P);ra.dispose();return b}iYh(b,h,r,B,P,ca){const ra=new cg.GraphTransaction(15,
r);ra.Uj=r;ra.Db(h.ed);b=v.AFrameworkApplication.va.Nf(b,ca,2,!1,B,P);ra.dispose();return b}static get ah(){return An.ContextSetEditor.instance}static get Yf(){return Wh.a.instance}static get Zb(){return null!=CA.fzg?CA.fzg:CA.fzg=Ma.a.instance.Oa("Box4.IFeatureHelper")}}Object(m.a)(CA,"AEnterViewStrategy",null,[1373]);class BJ extends CA{constructor(b,h,r){super(b,h,r)}fXl(){return Nb.a.newLine}}Object(m.a)(BJ,"EnterViewStrategy",CA,[]);class tH{constructor(b){this.yl=this.transaction=null;this.ke=
b;this.WJc=this.zo=0}}Object(m.a)(tH,"SelectAllArguments",null,[]);class hD{constructor(b,h,r){this.bzn=b;this.u0m=h;this.Zr=r;this.Pzl=(B,P,ca)=>P.view.Zi?this.Thb(P,ca,this.Evj):this.xco(P,ca);this.H4c=(B,P)=>P.zo?1===P.zo?(P.ke.mb.S9c(P.yl,B),P.zo=2,!0):2===P.zo?(P.ke.mb.ib.X0a=P.yl.X0a,this.ug.tF(),P.transaction.HIa(B),P.zo=3,P.transaction.dispose(),kh.a.mark(5799),!0):!1:(P.transaction=this.Zr.Pc(2),P.transaction.Db(P.ke.ed),P.zo=1,!0);this.xco=(B,P)=>{if(1===P)return 32;if(!B.view.ue)return 2;
B=B.view;return B.mb&&B.mb.ib&&B.mb.ib.lb?this.Evj(B).inProgress?1:32:8};this.Evj=B=>{v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IQoETinyWinsSelectAllSettings");B.Zi&&t.ULS.sendTraceTag(39098306,324,50,"Progress select all reach top");B=new qv.a(null,this.FJn,new tH(B));B.Rl("SelectAllInOutline");B.run();return B};this.FJn=(B,P)=>{if(!P.zo)return P.yl=og.SelectionFactory.yco(P.ke.mb.ib.lb),P.transaction=this.Zr.Pc(2),P.transaction.Db(P.ke.ed),P.zo=1,!0;if(1===P.zo){if(!P.WJc)return P.ke.mb.Ac(P.yl.J(0),
B),++P.WJc,!0;if(P.WJc<P.yl.length)return P.ke.mb.hvk(P.yl.J(P.WJc),B),++P.WJc,!0;P.zo=2}return 2===P.zo?(P.ke.mb.ib.X0a=P.yl.X0a,this.ug.tF(),P.transaction.HIa(B),P.zo=3,P.transaction.dispose(),!0):!1}}get ug(){return this.u0m.value}Tb(){const b=v.AFrameworkApplication.va;b.ra(Nb.a.Lza,yd.a.frame,hD.Yrj);b.ra(Nb.a.Hfg,yd.a.frame,hD.Yrj);b.fb(Nb.a.Thb,yc.a.view,this.Pzl,2);b.fb(Nb.a.kDa,yc.a.view,Dd.AFrame.Kg,100);b.fb(Nb.a.wQf,yc.a.view,hD.wQf,4)}Thb(b,h,r){if(1===h)return 32;if(!b.view.ue)return 2;
h=b.view;if(!h.mb)return 8;const B=h.mb.ib;if(!B||!B.length)return 8;kh.a.mark(5798);Eb.App.za.jb.isEditingAllowed||Eb.App.za.jb.Py||h.Zi?b=xe.SelectionEditor.Rsf(B):(pc.FocusManager.instance().kD(Dd.AFrame.In),b=og.SelectionFactory.tij(h.ed));if(!b)return 8;B.X0a||t.ULS.sendTraceTag(39098305,324,50,"Progress selection start");r&&this.bzn.EJb(xe.SelectionEditor.A8h(b))?r=r(h):(r=new tH(h),r.yl=b,r=new qv.a(null,this.H4c,r),r.Rl("ExpandSelection"),r.run());return r.inProgress?1:32}static get K7a(){return null!=
hD.LGg?hD.LGg:hD.LGg=Ma.a.instance.resolve("Box4.ISelectionContextMenuProvider")}static wQf(b,h,r){if(1===r)return 32;if(!h.view.ue)return 8;b=h.view;h=og.SelectionFactory.ro(b.root.graphNode,!0);if(!h)return 8;b.mb.Ac(h);return 32}static Yrj(){var b=Eb.App.za.jb.iu;if(!b.ue)return 2;if(b.ue&&1!==Eb.App.za.state){kh.a.mark(4668);var h=b.mb.ib.lb;if(!h&&v.AFrameworkApplication.K.$("ContextMenuOnSelectionFixIsEnabled"))return 2;h=xe.SelectionEditor.PQ(h);let r=h.x,B=h.y+h.height;if(!b.container)return 8;
b=Sys.UI.DomElement.getBounds(b.container);if(h.y<b.y||h.y>b.y+b.height||h.x<b.x||h.x>b.x+b.width)r=b.x,B=b.y;hD.K7a.Lza(new Sys.UI.Point(r,B),1);kh.a.mark(4669)}return 32}}Object(m.a)(hD,"SelectAllHandlers",null,[1191]);class CJ{Qge(){}}Object(m.a)(CJ,"FontNameFormattingStrategyNoop",null,[1338]);var DJ=c(879);class BG{constructor(b,h,r,B,P,ca){this.Qxh=this.Txh=null;this.ps=b;this.Pxh=h;this.tLk=r;this.CLk=B;this.Txh=P;this.Qxh=ca}}Object(m.a)(BG,"BookmarkHighlightContext",null,[]);class EJ extends ag.a{constructor(){super()}get Nca(){return!0}get gkb(){return 5}get A3a(){if(null!=
this.f3)return this.f3;this.f3=[];this.f3.push(new Ci.a(Fk.a.oEd,Fk.a.oEd));this.f3.push(new Ci.a(Fk.a.I4e,Fk.a.I4e));this.f3.push(new Ci.a(Fk.a.wHc,Fk.a.wHc));return this.f3}HHa(b,h){this.Nca&&Wq.a.instance.ie(()=>{const r=this.Dr.mEa;var B=this.Dr.vZc;if(r)if(5===r.type){B=r.HA;if(r.VJ&&r.VJ.ps.includes(b))for(const P of h.dIa("*"))this.Dr.JTa(P);B&&B.ps.includes(b)&&this.Ypb(h,r.action,B,b)}else B&&5===B.type&&3===r.action&&B.HA.ps.includes(b)&&this.Ypb(h,0,B.HA,b)},"BHA:OPHC")}PRa(b){return Object(Ib.a)(BG,
b)}V2a(b,h){if(b)for(const r of b.ps)h.add(r)}Ypb(b,h,r,B){0===h&&b.htmlElement&&Wq.a.instance.ie(()=>{const P=b.dIa("*"),ca=P.length,ra=Fk.a.oEd;var Qa=B.id===r.Txh,tb=B.id===r.Qxh;let Mb=!1;var Zb=0,jc=[];const Gc=Array(ca);for(let Od=0;Od<ca;Od++){var Uc=P[Od];const ze=Te.a(Uc);Gc[Od]=ze;const de=Uc.classList;if(0!=Gc[Od]){const ee=!de.contains(Fk.a.EG),je=Xb.a.Eb(Uc,Fk.a.BBb);je&&jc.push(...je);if(Qa){let ue;if((ue=Xb.a.Eb(Uc,Fk.a.qEd))&&je&&1===ue.length&&1===je.length&&ue[0].equals(je[0]))continue;
ue&&(Zb+=ue.length,1===ze?de.add(Fk.a.I4e):de.add(ra));if(je)for(const Qf of je)this.hZd(r,Qf)&&(Zb--,Mb&&de.add(Fk.a.wHc));0!==Zb&&ee&&de.add(ra)}if(!Qa&&!tb&&r.CLk.has(B.id))if((Uc=Xb.a.Eb(Uc,Fk.a.BBb))&&Mb){de.add(ra);for(const ue of Uc)if(this.hZd(r,ue)){de.add(Fk.a.wHc);break}}else ee&&de.add(ra)}Mb=!de.contains(Fk.a.D1a)}if(tb&&!Qa){Qa=new Set;for(var od of jc)this.hZd(r,od)&&Qa.add(od);Mb=!1;for(jc=0;0!==Qa.size&&jc<ca;jc++){Zb=P[jc];od=Zb.classList;if(0!=Gc[jc])if(tb=!1,Zb=Xb.a.Eb(Zb,Fk.a.BBb)){for(const Od of Zb)this.hZd(r,
Od)&&(Qa.delete(Od),tb=!0);0!==Qa.size&&od.add(ra);Mb&&tb&&od.add(Fk.a.wHc)}else od.contains(Fk.a.EG)||od.add(ra);Mb=!od.contains(Fk.a.D1a)}}},"BHA:SPH")}hZd(b,h){for(const r of b.tLk)if(h.equals(r))return!0;return!1}}Object(m.a)(EJ,"BookmarkHighlightActor",ag.a,[333]);var CG=c(1891),NF;(function(b){b[b.jsonToDocumentXml=0]="jsonToDocumentXml";b[b.documentXmlToJson=1]="documentXmlToJson";b[b.documentXmlToThemeJson=2]="documentXmlToThemeJson";b[b.unsupported=3]="unsupported"})(NF||(NF={}));Object(m.b)("GraphicsEditorConversionRequestType",
NF);var FJ=c(1674);class DG{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb){this.$f=b;this.lA=h;this.gb=P;this.bW=ca;this.Vj=ra;this.je=Qa;this.rd=Mb;this.Ca=tb}gcg(b,h,r,B){const P=b.tnh(h);if(P){var ca=Object(Ib.a)(FJ.a,b),ra=this.je.Zf("WebServiceCall",String.format("SendGraphicsEditorRequest: ClosingDialog = {0} EditingExistingContent = {1}",ca,r)),Qa=h.ik.node,tb=()=>{r||this.removeImage(h.ik,P.getId())};ca=DG.hzh();B=this.Ezh(P.getId().toString(),Qa,B,r);try{b.Lth(B,h)}catch(Mb){t.ULS.sendTraceTag(572872463,
3001,10,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Exception while trying to AppendUrlParameters. Exception: "+Mb.message);this.Ep(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);return}this.$f.mj(ca,2,B.toString(),{},!0,0,Mb=>{t.ULS.sendTraceTag(575522560,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Successfully created GraphicsEditorSession.");b.ehc(Mb,P,()=>{this.Ep(b.fUd())},tb,Qa,h,ra)},Mb=>{const Zb=415===Mb.data.Se;let jc="";Mb&&Mb.data&&Mb.data.Dj&&
"X-CorrelationId"in Mb.data.Dj&&Mb.data.Dj["X-CorrelationId"]&&(jc=Mb.data.Dj["X-CorrelationId"]);b.yqa(`Graphics editor request failed. HttpStatus [${Mb.data.Se}], ResponseData [${Mb.data.se}], CorrelationId [${jc}]`,P,Qa,tb,()=>{this.Ep(Zb?WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError:b.fUd())},ra,Zb)},null)}else this.Ep(b.fUd())}eeo(b,h,r){return new Promise((B,P)=>{var ca=b.ik,ra=null;ra=Oe.a.wGf(ca)?ca.getContext(0).node:ca.node;ca=DG.hzh();ra=this.Ezh(h.toString(),
ra,r,!1);ra.Be(CG.a.daf,NF.documentXmlToThemeJson.toString());this.$f.mj(ca,2,ra.toString(),{},!0,0,Qa=>{t.ULS.sendTraceTag(575522563,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Successfully created.");B(Qa.data.se)},Qa=>{t.ULS.sendTraceTag(575522564,3001,10,`GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Request failed. HttpStatus ${Qa.data.Se}, ResponseData ${Qa.data.se}`);this.Ep(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);P(null)},null)})}Ezh(b,
h,r,B){const P=h.Yi(),ca=new Xa.QueryStringBuilder("WordGraphicsEditorHandler.ashx");v.AFrameworkApplication.nga(ca);ca.Be(CG.a.strict,this.POm(h)?"true":"false");ca.Be(fi.a.nodeId,b);ca.Be(fi.a.cellId,P.Gm.toString());ca.Be(fi.a.fileId,P.zr);ca.Be(fi.a.JX,r.toString());ca.Be(CG.a.yzl,B?"true":"false");if(b=!!this.rd&&this.rd.isFeatureEnabled(50)){ca.Be(Xg.a.u2i,b.toString());if(b=this.rd.isFeatureEnabled(90))ca.Be(Xg.a.mDn,b.toString()),ca.Be(Xg.a.Rwm,"true");this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.PictureTransparency",
!1)&&ca.Be(Xg.a.vDn,"true")}ca.Be(Xg.a.axh,"true");Gh.a.instance.TAb(ca);return ca}POm(b){if(!this.lA)return!1;b=this.lA.su(b);return!!b&&b.wf(Mc.a.iIf)}removeImage(b,h){b.cpBegin===b.cpEnd-1&&this.Vj.qjc(b.node,h,this.gb,this.bW)}Ep(b){const h=new Tf.StandardDialog;h.Cd=0;h.vx(hh.a.ehf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,b,null,b===WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError);Eb.App.za.updateCommandUI()}static hzh(){const b=new Xa.QueryStringBuilder("WordGraphicsEditorHandler.ashx");
v.AFrameworkApplication.nga(b);return b.toString()}}Object(m.a)(DG,"GraphicsEditorRequestManager",null,[331]);class GJ extends Oj{constructor(b,h,r){super(b,h);this.WQa=Nb.a.insertHyperlink;this.X9j=r}T3a(b){null!=b&&0<b.length&&this.oc.Qb(this.WQa,2,b[0])}hNj(b,h,r){const B=lj.a.tg(v.AFrameworkApplication.lcid).name;b=String.format(b,v.AFrameworkApplication.lcid,B,v.AFrameworkApplication.buildVersion,h,XC.fse,r);b+="&flipgrid=1&ted=1";this.X9j&&(b+="&resize_picker=1");v.AFrameworkApplication.K&&
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableStream2Videos",!1)&&(b=new Xa.QueryStringBuilder(b),b.bJ("stream2","1"),v.AFrameworkApplication.K.$("GetCustomHeaderEnabled")&&b.bJ("enablegetcustomheader","1"),b=b.toString());return b}}Object(m.a)(GJ,"InsertHubbleMediaHelper",Oj,[]);class HJ{constructor(b,h,r,B,P,ca,ra){this.ga=b;this.Ca=h;this.jod=r;this.k3=B;this.mld=P;this.Ok=ca;this.ZWj=ra}Tb(){this.ga.fb(qb.a.a_i,yc.a.Uc,this.sxn.bind(this),1028);this.ga.fb(qb.a.bti,
yc.a.Uc,this.mEm.bind(this),1028)}mEm(b,h,r,B,P){if(1!==r){if(null==P)return 16;if(!h.el||!xe.SelectionEditor.Ze(h))return 2;b=this.UWl(P);P=P.OriginalUrl;v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1);this.mld.nug(b,h,P)}return 32}KSj(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("OnlineVideoFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ma.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("OnlineVideoInserted",
"OnlineVideoFloodgateIsEnabled")})},5E3)}UWl(b){const h=new wx;h.MediaType=b.ContentType;h.Height=b.Height;h.Width=b.Width;h.IFrameHtml=b.Html;h.Title=b.Caption;h.Thumbnail=b.ThumbnailUrl;h.ProviderName=b.ProviderName;return h}sxn(b,h,r){var B,P;if(1!==r)h=F.a.RQ(this.Ca.kb("UserId")).toString(),h=this.k3.hNj(this.Ca.appSettings.InsertVideoHubbleEndpoint,Bb.a.create().toString(),h),this.k3.WQa=qb.a.bti,h=this.jod.YQc(h,!0),h.correlationId=Bb.a.create(),h.mqa=5,h.cje(null,this.k3,this.ZWj),ea.a.sendTelemetryEvent(Object.assign(new ka.a,
{name:"Office.Word.Online.OnlineMedia",dataFields:[Object.assign(new ha.a,{name:"ActionId",int64:b})]})),this.KSj();else if(!(h&&h.node&&TC.a(h.node))||(null===(B=this.Ok)||void 0===B?0:B.$_(h))||(null===(P=this.Ok)||void 0===P?0:P.via(h)))return 2;return 32}}Object(m.a)(HJ,"OnlineMediaActor",null,[]);const IM={"https://hubblecontent.osi.office-int.net":"https://osiziwuspersimmon002.blob.core.windows.net","https://hubblecontent.osi.officeppe.net":"https://osizewuspersimmon001.blob.core.windows.net",
"https://hubblecontent.df.osi.office.net":"https://osizpscuspersimmon000.blob.core.windows.net","https://hubblecontent.msit.osi.office.net":"https://cdn.hubblecontent.msit.osi.office.net","https://hubblecontent.osi.office.net":"https://cdn.hubblecontent.osi.office.net"};class iD extends GD{constructor(b,h,r,B=null,P=!1){super(b,h,r,B,P);this.iwc=null;this.LWf=()=>{this.uy&&(t.ULS.sendTraceTag(509092503,352,50,`onGetCustomHeaders : Token available: ${!!iD.LCa} time: ${(new Date).getTime()-this.ki}`),
this.uy.sendMessage(M.a.nlj,{["CustomHeaders"]:iD.LCa||""}))}}get telemetryEventName(){return"Office.Word.Online.OnlineMediaDialog"}HFb(){const b={};b.insertMediaServiceEndpoint=this.kod;b.iFrameId="mediaiframe";return b}async cje(b,h,r){r&&(this.ki=(new Date).getTime(),Date.now()>iD.Ljh&&await this.refreshToken(r));this.mWb=b;this.iwc=h;this.fvc=!1;b={["id"]:"OnlineMediaDialog",["bodyControls"]:this.HFb(),["componentIsVisibleCallback"]:this.WQj.bind(this)};this.Uh(this.mWb,null,b)}WQj(){this.b1=
this.K9b(this.qj("mediaiframe"));let b=this.kod;if(v.AFrameworkApplication.K.$("NewInsertMediaServiceEndpoint")){const h=new URL(b),r=IM[h.protocol+"//"+h.host];r?b=r:t.ULS.sendTraceTag(508937025,352,10,`Target URL: ${h.host} not found`)}this.uy=this.jud.getInstance(this.b1.contentWindow,b);this.uy.aq(M.a.aph,h=>{this.ATi(h,this.iwc.T3a.bind(this.iwc))});this.uy.aq(M.a.insert,h=>{this.K7d(h,this.iwc.T3a.bind(this.iwc))});this.uy.aq(M.a.vph,this.QWi.bind(this));this.uy.aq(M.a.D8h,this.LWf.bind(this));
this.uy.aq(M.a.getSessionId,this.DVi.bind(this));this.uy.aq(M.a.l6h,this.AVi.bind(this));this.uy.aq(M.a.lFd,this.lUi.bind(this));this.Kpb(3)}Kpb(b){const h=[];h.push(Object.assign(new ha.a,{name:"DialogResult",string:qD[b]}));h.push(Object.assign(new ha.a,{name:"DialogMode",string:this.zci()}));h.push(Object.assign(new ha.a,{name:"CorrelationId",string:this.correlationId.toString()}));h.push(Object.assign(new ha.a,{name:"Provider",string:oC[this.mqa]||"Unknown"}));ea.a.sendTelemetryEvent(Object.assign(new ka.a,
{name:this.telemetryEventName,dataFields:h}))}async refreshToken(b){try{const h=await b.OV("Hubble","84a0e9dd-6e58-4aad-82af-ebe485acd09d/.default");h.IsSuccess&&(iD.Ljh=h.Telemetry.expiresOn?1E3*(h.Telemetry.expiresOn-10):0,iD.LCa=h.Token);t.ULS.sendTraceTag(509092504,352,50,`Hubble token requested by: ${"WordInsertMediaDialog"} successful: ${!!iD.LCa} time: ${(new Date).getTime()-this.ki}`)}catch(h){t.ULS.sendTraceTag(508954306,352,10,`Hubble token requested by: ${"WordInsertMediaDialog"} successful: false time: ${(new Date).getTime()-
this.ki} error: ${h} `)}}}iD.Ljh=0;Object(m.a)(iD,"OnlineMediaDialog",GD,[]);class IJ{constructor(b,h){this.iFe=b;this.k3=h}YQc(b,h=!1){return new iD(b,this.iFe,this.k3,null,h)}getInstance(){throw Error.notImplemented();}}Object(m.a)(IJ,"OnlineMediaDialogFactory",null,[332]);class JJ extends Uw{constructor(){super(1,3);this.$L=Ma.a.instance.resolve("Common.IReactContextualUILauncher");this.Wyj=!1}k8a(){v.AFrameworkApplication.va.processAction(qb.a.Wlc,2)}YMd(){this.B1h&&!this.Bv&&(this.Bv=this.CLa())}MNd(){if(this.Bv&&
this.Bv.isVisible){var b=Object(Ra.a)(yn.Control,this.Bv.controls["ExternalContentFloatie.FlyoutAnchor"]);b.behavior.gx(b.Yib(),1,null)}b=document.getElementById("ExternalContentFloatieFlyout");if(null==b)t.ULS.shipAssertTag(555816415,324,!1,"ExternalContentFloatieEventManger.onOnlyKeyPressed: externalContentFloatieUIElement is null.");else{var h=b.getBoundingClientRect();0<h.top&&h.bottom<window.innerHeight&&(h=b.getAttribute(Se.a.GDd)||"",Se.a.xM===h&&b.click())}}M0(){return this.$L.M0}}Object(m.a)(JJ,
"ExternalContentFloatieManager",Uw,[]);class es{constructor(){es.MBm()}get qc(){return null!=this.aKg?this.aKg:this.aKg=Ma.a.instance.resolve("Box4.Styles.IWACStyleReader")}get key(){return"FORMATTING_PARAGRAPH"}get $w(){return null}roc(b){var h=null;if(!ke.ParagraphReader.oh(b))return{returnValue:!1,Bna:h};if((b=this.qc.So(b.currentNode))&&2===this.qc.LG(b)){const r=this.qc.Ag(b);es.JQ.contains(r)&&(h=this.qc.uR(b),h=Object.assign(new Rx.a,{$G:this.key,contentId:b.id,contentObject:h}))}return{returnValue:!!h,
Bna:h}}WFb(b,h){let r=null;h&&b.contentId.equals(h.contentId)||(r=b.contentObject);return r}static MBm(){es.JQ=new lo.a;es.JQ.add(Hl.StyleReader.styleIdHeading1);es.JQ.add(Hl.StyleReader.styleIdHeading2);es.JQ.add(Hl.StyleReader.styleIdHeading3);es.JQ.add(Hl.StyleReader.zRb);es.JQ.add(Hl.StyleReader.abd);es.JQ.add(Hl.StyleReader.bbd);es.JQ.add(Hl.StyleReader.Eke);es.JQ.add(Hl.StyleReader.Dke);es.JQ.add(Hl.StyleReader.wordStyleIdHeading1);es.JQ.add(Hl.StyleReader.wordStyleIdHeading2);es.JQ.add(Hl.StyleReader.wordStyleIdHeading3);
es.JQ.add(Hl.StyleReader.HTb);es.JQ.add(Hl.StyleReader.ITb);es.JQ.add(Hl.StyleReader.JTb);es.JQ.add(Hl.StyleReader.Apc);es.JQ.add(Hl.StyleReader.Bpc);es.JQ.add(Hl.StyleReader.KTb);es.JQ.add(Hl.StyleReader.osb);es.JQ.add(Hl.StyleReader.Ted)}}es.JQ=null;Object(m.a)(es,"ParagraphStyleDetailsProvider",null,[720,415]);class KJ{constructor(b,h,r,B){this.HLa=b;this.N$j=h;this.W$j=r;this.X$j=B}X6f(){this.HLa.execute(b=>{b.kjc(this.N$j.value);b.kjc(new es);b.kjc(this.X$j.value);b.D5(this.W$j.value)})}}Object(m.a)(KJ,
"AccessibilityActor",null,[]);class LJ{constructor(b,h,r){this.ai=null;this.R$c=(B,P,ca)=>{if(1===ca)return 32;this.ai=this.$tc.value.Z8k(this.Vb);if(!this.ai)return t.ULS.sendTraceTag(21233673,334,10,"AccessibilityHelpDialog failed to initialize"),8;this.ai.GUa();return 32};this.anh=B=>this.ai?this.ai.Tqm(B):2;this.ga=b;this.$tc=h;this.Vb=r}Tb(){if(v.AFrameworkApplication.K.$("UIDiscoverabilityEnabled")){var b=Jb.KeyInputManager.ic(se.a.Bsb,5);this.Vb.fe(Dd.AFrame.In).nr(b);this.Vb.fe(Dd.AFrame.Ap).bindAction(b,
fb.a.R$c);this.ga.ra(fb.a.R$c,yd.a.frame,this.R$c);this.ga.ra(fb.a.vFc,yd.a.frame,this.anh);this.ga.ra(fb.a.uFc,yd.a.frame,this.anh)}}}Object(m.a)(LJ,"AccessibilityHelpDialogActor",null,[]);var JM=c(1064),KM=c(1422);class MJ{constructor(b,h){this.C5j=b.mc("WordHangForActionManagerThresholdTime",750);this.ga=h;this.RUj=JM.a.mF(26,5,new KM.a)}eZ(){this.ga.eZ(this)}p5(){}n5(b){const h=+b.endTime-+b.startTime;if(h>this.C5j){let r="";switch(b.behavior){case 1:r="E";break;case 2:r="X";break;case 3:r="A"}(b=
cd.ActionManager.yba(b.actionId))&&b.length||(b="UnknownAction");this.RUj.track(h,b+"_"+r)}}}Object(m.a)(MJ,"ActionHangDetector",null,[33]);var NJ=c(1508);class OJ extends bf{constructor(b,h=null){super(b,void 0,v.AFrameworkApplication.k1a,new qe(b,!1),void 0,void 0,h)}get N5a(){return this.HZd?CommonUIStrings.l_DownloadACopyDialog_CopyALinkText:this.TZd?CommonUIStrings.l_DownloadACopyDialog_EmailALinkText:CommonUIStrings.l_DownLoadACopyDialogMessageWorkOffline}get bfc(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get d_c(){return"DownloadCopyLink"}get buttonText(){return CommonUIStrings.l_DownloadACopyMin}get YKc(){return v.AFrameworkApplication.k1a?
"UIFontDialogTextLarge":null}get HZd(){return"VersionHistory"===this.x6e?!1:1===v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DownloadACopyShareLinkState",0)}get TZd(){return"VersionHistory"===this.x6e?!1:2===v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DownloadACopyShareLinkState",0)}l3d(){t.ULS.sendTraceTag(7690388,324,50,"Download a copy dialog displayed");v.AFrameworkApplication.Oia("t1shrdnl;t2shrdnl;c-shrdnl")}dNf(){t.ULS.sendTraceTag(7690389,
324,50,"Download a copy dialog clicked")}B_c(){t.ULS.sendTraceTag(19462214,324,50,"Download a copy dialog button clicked");v.AFrameworkApplication.va.processAction(fb.a.eVh,2)}}Object(m.a)(OJ,"DownloadACopyDialog",bf,[]);var EG;(function(b){b[b.Unknown=0]="Unknown";b[b.Excel=1]="Excel";b[b.OneNote=2]="OneNote";b[b.PowerPoint=3]="PowerPoint";b[b.Visio=4]="Visio";b[b.Word=5]="Word";b[b.Project=6]="Project";b[b.Publisher=7]="Publisher";b[b.Infopath=8]="Infopath";b[b.Access=9]="Access"})(EG||(EG={}));
Object(m.b)("OfficeApplication",EG);var OF;(function(b){b[b.ReadWrite=0]="ReadWrite";b[b.ReadOnly=1]="ReadOnly";b[b.WriteOnly=2]="WriteOnly";b[b.ForceCheckout=3]="ForceCheckout";b[b.WriteLocalCopy=4]="WriteLocalCopy";b[b.OpenInBrowser=5]="OpenInBrowser"})(OF||(OF={}));Object(m.b)("OpenDocumentMode",OF);class PJ extends Pe.a{constructor(){super(!1,!1,!0)}aNb(){var b={["description"]:"We'd love to understand why you're opening this document in the Desktop App. Why did you decide to leave Word for the web?",
["actionButtonLabel"]:Box4Intl.Box4Strings.l_WordPredictionFeedbackActionLabel};const h=Array(5);h[0]={["key"]:"0",["text"]:"I can't open my document in Word for the web"};h[1]={["key"]:"1",["text"]:"I didn't intend to open this document online"};h[2]={["key"]:"2",["text"]:"Word for the web was glitchy with this document"};h[3]={["key"]:"3",["text"]:"I need features in the Desktop App for this document"};h[4]={["key"]:"4",["text"]:"I prefer the Desktop App"};b.selectionOptions={["id"]:"reasonsList",
["options"]:h};b={["id"]:"OpenInClientFeedbackDialog",["bodyControls"]:b};this.Uh("Send feedback to Microsoft",this.Nlo.bind(this),b);return new Promise(r=>{this.xMe=r})}Nlo(b,h){1===b&&this.dK(h.selectedReason)}dispose(){super.dispose();this.xMe()}dK(b){const h={},r={},B={},P={},ca={};h.appId=2155;h.manifestType="Fps";h.submitTime=(new Date).toISOString();h.source="Client";h.type="Survey";h.clientFeedbackId=Bb.a.create().toString();ca.reason=b;const ra={},Qa={numberOfOptions:5};Qa.selectedRating=
b;ra.rating=[Qa];P.surveySpecificData=JSON.stringify(ra);B.extendedManifestData=JSON.stringify(P);h.application=B;ca.surveyId="4938d2fd-3840-4f39-9073-1b7522395873";h.survey=ca;h.telemetry=this.Y_a();h.web=this.MBb();r["Content-Type"]="application/json";this.Bja(JSON.stringify(h),r)}uM(b,h,r,B){h&&b&&B&&r&&B in h&&(b[r]=h[B])}Y_a(){const b=v.AFrameworkApplication.sessionStartInfoSettings,h={};h.officeBuild=v.AFrameworkApplication.buildVersion;h.featureArea="Open In Desktop App";this.uM(h,b,"audienceGroup",
"AudienceGroup");this.uM(h,b,"osBuild","OsVersion");this.uM(h,b,"platform","Platform");this.uM(h,b,"processSessionId","WACSessionID");return h}MBb(){const b=v.AFrameworkApplication.sessionStartInfoSettings,h={};this.uM(h,b,"browser","Browser");this.uM(h,b,"browserVersion","BrowserVersion");this.uM(h,b,"dataCenter","WACDatacenter");return h}Bja(b,h,r=0){let B=0;3<r||(1===r?B=200:1<r&&(B=200+500*(r-1)),v.AFrameworkApplication.lc.Wb(new Me.a(2,1,B,()=>{v.AFrameworkApplication.He.mj("https://petrol.office.microsoft.com/v1/feedback",
2,b,h,!1,2,()=>{t.ULS.sendTraceTag(512341407,211,50,"Success sending OCV feedback for Open In Client")},()=>{this.Bja(b,h,r+1);t.ULS.sendTraceTag(512341406,211,50,"Failure sending OCV feedback for Open In Client, attempt {0}",r)},null)})))}}Object(m.a)(PJ,"WordOpenInClientFeedbackDialog",Pe.a,[]);var yD=c(1481),QJ=c(1792);const SE=b=>{for(let h=0;h<b.children.length;h++){const r=b.children[h];r.style.position="relative";r.style.top=(r.parentNode.offsetHeight-r.offsetHeight)/2+"px"}},FG=b=>b.Hb.keyCode===
se.a.Ss||b.Hb.keyCode===se.a.ZJa?(b.yf.click(),!0):!1,PF=(b,h,r,B,P,ca,ra)=>{const Qa=document.createElement("a");Qa.className="ProtocolLaunchingDialogButtonAnchor";Qa.className+=" OICDialog";Qa.id=b;Qa.setAttribute(Se.a.uh,Se.a.X3);Qa.style.padding="0";Qa.style.margin="0";B&&RJ(P,h,r,B,Qa);b=document.createElement("span");b.className="ProtocolLaunchingDialogButtonLabel";b.innerText=P;Qa.appendChild(b);Qa.tabIndex=0;ca&&ii.a.instance.ob(pd.a.click,Qa,ca);ra&&Jb.KeyInputManager.instance.ob(pd.a.yh,
Qa,ra);return Qa},RJ=(b,h,r,B,P)=>{var ca=document.createElement("img");ca.alt=b;ca.className=we.getImageClassWithCluster(r,B);ca.src=h;ca.setAttribute(Se.a.uh,Se.a.wz);b=document.createElement("span");b.className="ProtocolLaunchingDialogImg32Container";b.appendChild(ca);ca=document.createElement("span");ca.className="ProtocolLaunchingDialogIconContainer";ca.appendChild(b);P.appendChild(ca)};class GG{static get Vg(){return Pe.a.Kx(GG.Xm,CommonUIStrings.l_OICLaunchDialogTitle)}}GG.Xm="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(m.a)(GG,"OICLaunchDialogHtml",null,[]);class SJ extends Pe.a{constructor(b){super();this.VUb=this.ltb=null;this.XS=!1;this.Lp=b;this.Vg=GG.Vg;this.Cd=5;this.yg="OICLaunchDialog";this.showDialog("",Object(z.a)(this,this.hkn,"oicLaunchDialogResultHandler"));this.smj();this.L5("ProtocolLaunchingDialogTitle");4!==v.AFrameworkApplication.ua.Kb.iPa&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.I1(this.ltb);t.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}V9(){this.ltb=PF("BtnRichClient",this.Lp.mMc,this.Lp.yUc,this.Lp.OAf,CommonUIStrings.l_OICLaunchRichClient,Object(z.a)(this,this.bYi,"onRichClientButtonClick"),FG);document.getElementById("OICLaunchRichClient").appendChild(this.ltb);SE(this.ltb);this.VUb=PF("BtnReturn",this.Lp.mMc,this.Lp.yUc,this.Lp.Jqi,CommonUIStrings.l_OICReturnToOnlineClient,Object(z.a)(this,this.WXi,"onReturnButtonClick"),
FG);document.getElementById("OICReturnToApp").appendChild(this.VUb);SE(this.VUb)}WXi(){this.hide();this.Lp.Kjc();return!0}bYi(){t.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();v.AFrameworkApplication.va.processAction(fb.a.xPb,2);return!0}hkn(){this.Lp.Kjc()}dispose(){this.XS||(this.ltb&&(ii.a.instance.sc(pd.a.click,this.ltb,Object(z.a)(this,this.bYi,"onRichClientButtonClick")),Jb.KeyInputManager.instance.sc(pd.a.yh,this.ltb,FG)),this.VUb&&(ii.a.instance.sc(pd.a.click,
this.VUb,Object(z.a)(this,this.WXi,"onReturnButtonClick")),Jb.KeyInputManager.instance.sc(pd.a.yh,this.VUb,FG)),super.dispose(),this.XS=!0)}}Object(m.a)(SJ,"OICLaunchDialog",Pe.a,[]);class HG{static get Vg(){return Pe.a.Kx(HG.Xm,CommonUIStrings.l_OICDialogTitle)}}HG.Xm="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(m.a)(HG,"ProtocolLaunchingDialogV2Html",null,[]);class TJ extends Pe.a{constructor(b){super();this.UUb=this.pWa=null;this.XS=!1;this.G$a=null;this.Lp=b;this.Vg=HG.Vg;this.Cd=5;this.yg="ProtocolLaunchingDialog";this.xtc="OICRetryDialog";v.AFrameworkApplication.lc.MHb&&v.AFrameworkApplication.lc.restart();v.AFrameworkApplication.lc.Wb(new Me.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(z.a)(this,this.V3f,"protocolLaunchingDialogResultHandler"));this.smj();this.L5("Issues");
this.T1h();t.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}V9(){const b=document.getElementById("Issues");if(b){RJ("",this.Lp.mMc,this.Lp.yUc,this.Lp.OAf,b);const h=document.createElement("span");h.className="WACDialogSectionTitle";h.innerText=5===this.Lp.MZi?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;b.appendChild(h);SE(b);b.style.display="none"}v.AFrameworkApplication.ua.Kb.gli?
(this.UUb=PF("GiveFeedback",this.Lp.mMc,this.Lp.yUc,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(z.a)(this,this.w7d,"onGiveFeedbackClick"),Object(z.a)(this,this.FVi,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.UUb),SE(this.UUb)):document.getElementById("ButtonGiveFeedback").style.display="none";0===v.AFrameworkApplication.ua.Kb.iPa||v.AFrameworkApplication.Hol?document.getElementById("ButtonEdit").style.display="none":(this.pWa=
PF("Edit",this.Lp.mMc,this.Lp.yUc,"",2===v.AFrameworkApplication.ua.Kb.yk?4===v.AFrameworkApplication.ua.Kb.iPa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===v.AFrameworkApplication.ua.Kb.iPa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(z.a)(this,this.gVi,"onEditClick"),Object(z.a)(this,this.jVi,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.pWa),SE(this.pWa));0===v.AFrameworkApplication.ua.Kb.iPa&&
!v.AFrameworkApplication.IGf&&b&&(b.style.display="none")}U1h(){return this.G$a?(this.I1(this.G$a),!0):!1}T1h(){return this.pWa?(this.I1(this.pWa),!0):!1}jVi(b){return this.KVf(b,0)}FVi(b){return this.KVf(b,2)}VXi(b){return this.KVf(b,1)}KVf(b,h){let r=!1;if(b.Hb.keyCode===se.a.Ss||b.Hb.keyCode===se.a.ZJa)b.yf.click(),r=!0;else if(b.Hb.keyCode===Sys.UI.Key.down||b.Hb.keyCode===Sys.UI.Key.up)switch(h){case 1:r=this.T1h();break;case 0:r=this.U1h()}return r}gVi(){this.hide();4===v.AFrameworkApplication.ua.Kb.iPa?
(t.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.Lp.Kjc()):(t.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.Lp.MSc());return!0}w7d(){t.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");return!0}uXf(){EF.Redirect.showHelp("OICFailure");return!0}u8d(){t.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";v.AFrameworkApplication.va.processAction(fb.a.xPb,2);return!0}V3f(){this.Lp.Kjc()}switchToBackupMode(){var b=
document.getElementById("ProtocolLaunchingDialogTitle");if(b){b.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(b=document.getElementById("Issues"))b.style.display="block";(b=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!b.children.length&&(this.G$a=PF("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(z.a)(this,this.u8d,"onRetryOICClick"),Object(z.a)(this,this.VXi,"onRetryOICKeyUp")),b.appendChild(this.G$a),SE(this.G$a),this.pWa||this.U1h())}}dispose(){this.XS||(this.pWa&&
(ii.a.instance.sc(pd.a.click,this.pWa,Object(z.a)(this,this.gVi,"onEditClick")),Jb.KeyInputManager.instance.sc(pd.a.yh,this.pWa,Object(z.a)(this,this.jVi,"onEditKeyUp"))),this.UUb&&(ii.a.instance.sc(pd.a.click,this.UUb,Object(z.a)(this,this.w7d,"onGiveFeedbackClick")),Jb.KeyInputManager.instance.sc(pd.a.yh,this.UUb,Object(z.a)(this,this.FVi,"onGiveFeedbackKeyUp"))),this.G$a&&(ii.a.instance.sc(pd.a.click,this.G$a,Object(z.a)(this,this.u8d,"onRetryOICClick")),Jb.KeyInputManager.instance.sc(pd.a.yh,
this.G$a,Object(z.a)(this,this.VXi,"onRetryOICKeyUp"))),super.dispose(),this.XS=!0)}}Object(m.a)(TJ,"ProtocolLaunchingDialog",Pe.a,[]);class IG extends Tf.StandardDialog{constructor(b){super();this.Lp=b;this.yg="ProtocolLaunchingDialog";v.AFrameworkApplication.lc.MHb&&v.AFrameworkApplication.lc.restart();v.AFrameworkApplication.ua.Kb.gli&&this.Msk(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(z.a)(this,this.w7d,"onGiveFeedbackClick"));IG.kni?(this.Cd=12,this.ze(1,CommonUIStrings.l_CloseFile),
this.ze(2,CommonUIStrings.l_OICDialogContinueHere),this.ze(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.Cd=4,this.ze(1,CommonUIStrings.l_OICDialogContinueHere),this.ze(2,CommonUIStrings.l_OICDialogLaunchAgain));this.Rmb(CommonUIStrings.l_OICDialog2ndTitle,5===this.Lp.MZi?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(z.a)(this,this.V3f,"protocolLaunchingDialogResultHandler"),null)}w7d(b){t.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");
this.pVi(b)}u8d(){t.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");v.AFrameworkApplication.va.processAction(fb.a.xPb,2)}V3f(b){IG.kni?3===b?this.qfj():2===b||0===b?this.continueEditing():1===b&&this.closeDocument():2===b?this.qfj():(1===b||0===b)&&this.continueEditing()}closeDocument(){t.ULS.sendTraceTag(577783557,211,50,"Closing the document");v.AFrameworkApplication.va.Qb(fb.a.close,2,Kg.a)}qfj(){t.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(z.a)(this,this.u8d,
"onRetryOICClick"),0)}continueEditing(){4===v.AFrameworkApplication.ua.Kb.iPa||v.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&1===v.AFrameworkApplication.ua.mode?(t.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.Lp.Kjc()):(t.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.Lp.MSc())}static get kni(){return v.AFrameworkApplication.K.$("OICDialogThreeActions")&&32===v.AFrameworkApplication.va.processAction(fb.a.close,
1)}}Object(m.a)(IG,"StandardProtocolLaunchingDialog",Tf.StandardDialog,[]);class UJ{}Object(m.a)(UJ,"EditDocumentInClientParams",null,[]);class uH{static IVh(b,h,r,B,P,ca,ra=!1,Qa=!1,tb="",Mb=!1,Zb=!1,jc=!1,Gc="",Uc="",od="",Od=!1,ze=""){const de=new UJ;de.DocumentUrl=b;de.DocumentExtension=ze;de.Mode=h;de.Options=r;de.Application=B;de.SilentExternalHandler=ra;de.EncodeUrl=Qa;de.CorrelationIdForWinClient=tb;de.NavigateUsingWindowOpen=Mb;de.DescriptiveUnattemptedEnums=Zb;de.NoBrowserModalDialogs=jc;
de.SessionOrigin=Gc;de.CorrelationId=Uc;de.ClickTime=od;de.NewTelemetryDataIsEnabled=Od;MSOJS.ClientUtils.EditDocumentInClient(de,P,ca)}}Object(m.a)(uH,"ClientUtils",null,[]);var LM=c(548),VJ=c(956);class cE{constructor(b){this.PYa=this.xuc=this.qsc=null;this.Fvc=!1;this.Aze=this.pKe=this.m9g=null;this.Uhd=this.kz=this.Rwd="";this.application=this.mz=0;this.cGo=this.zkg=!1;this.V0o=b&&v.AFrameworkApplication.K.$("OICLaunchDialogIsEnabled");v.AFrameworkApplication.va.l0(fb.a.xPb)||v.AFrameworkApplication.va.ra(fb.a.xPb,
yd.a.frame,Object(z.a)(this,this.G8n,"retryOpenInClientAction"));this.Itj=!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("SilentExternalHandler")}get MZi(){return this.mz}Eoo(b,h="",r=""){this.kz=r||Bb.a.create().toString();this.Rwd=h||LM.a.qdi();this.Uhd=b}G8n(b,h,r){return h.contextId!==yd.a.frame?2:1===r?32:this.xPb()}get options(){let b=0;v.AFrameworkApplication.N5n&&(b|=1);v.AFrameworkApplication.UZi&&(b|=4);this.WFo()&&(b|=64);return b}WFo(){return!(2===this.application&&v.AFrameworkApplication.K.$("IsEmbeddedScenario"))}get mMc(){return v.AFrameworkApplication.Ns}get yUc(){return v.AFrameworkApplication.Oca}get Jqi(){return""}get OAf(){return""}get bGo(){return v.AFrameworkApplication.K.$("OneNoteMobileViewerIsEnabled")}get MJo(){return this.m9g||
(this.m9g=Ma.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.zkg||this.Vyl()}Kjc(){this.cGo||this.cZh()}U7i(b){return this.V0o&&Z.a.vi?(new SJ(this),32):this.KHh(b)}KHh(b){const h=({Erb:b}=this.A_m(b)).returnValue;t.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===h,b);return h}Ec(b,h,r,B,P,ca,ra=""){this.qsc=b;this.Aze=ra;this.xuc=h;this.PYa=ca;this.application=r;this.mz=B;return v.AFrameworkApplication.lVh?(this.wGi(),32):v.AFrameworkApplication.bqa&&
!v.AFrameworkApplication.lpi?(v.AFrameworkApplication.Lhg(),8):this.gxh(P)}get gkn(){return!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}xPb(){this.gkn&&this.e4m();return this.KHh(this.Fvc)}Fjj(){const b=new VJ.a(M.a.openInClient);b.Values["ui-language"]=v.AFrameworkApplication.lcid.toString();b.Values[wy.a.nPh]=v.AFrameworkApplication.userSessionId;return this.PYa.value.send(b)?32:8}e4m(){va.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new hc.a,{inStaging:!0}))}Yeo(b){const h=new VJ.a(M.a.R3o);h.Values["ui-language"]=v.AFrameworkApplication.lcid.toString();h.Values[wy.a.nPh]=v.AFrameworkApplication.userSessionId;h.Values[G.a.Q3o]=b;this.PYa.value.send(h)}A_m(b){this.Fvc=b;this.Yeo(5===this.mz?cE.axn:cE.hxn);return 5===this.mz?this.z_m():this.D_m()}z_m(){this.GGi();return{returnValue:32,Erb:"HostEditUrl,"}}D_m(){let b;var h=b="";v.AFrameworkApplication.Xph&&(h="|f|"+v.AFrameworkApplication.userSessionId);
const r=v.AFrameworkApplication.K.$("IsAssignmentMode")&&v.AFrameworkApplication.K.$("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||v.AFrameworkApplication.NYc||Z.a.NRa,B=v.AFrameworkApplication.K.$("UnattemptedEnumIsEnabled"),P=v.AFrameworkApplication.K.$("NoBrowserModalDialogs");if(v.AFrameworkApplication.va.V5d){var ca=v.AFrameworkApplication.va.gY(3588168074);ca&&this.Eoo(ca.epochClickTime,ca.sessionOrigin,ca.correlationId);this.hLi()}if(v.AFrameworkApplication.z3i){b+="NewOrder,";
ca=8;this.PYa&&this.PYa.value&&this.PYa.value.isEnabled()&&v.AFrameworkApplication.kTb&&(b+="Post,",ca=this.Fjj());if(32===ca)return{returnValue:ca,Erb:b};t.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return v.AFrameworkApplication.Js.c$?(t.ULS.shipAssertTag(5566816,211,!!v.AFrameworkApplication.Js.c$),b+="HostUrl,",{returnValue:v.AFrameworkApplication.ua.cV(!0,v.AFrameworkApplication.Js.c$),Erb:b}):this.qsc?(t.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",
v.AFrameworkApplication.userSessionId),b+="DocUrl,",uH.IVh(this.qsc,this.mz,this.options,this.application,Object(z.a)(this,this.iVi,"onEditInClientSuccess"),Object(z.a)(this,this.hVi,"onEditInClientFailure"),this.Itj,v.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),h,r,B,P,this.Rwd,this.kz,this.Uhd,v.AFrameworkApplication.va.V5d,this.Aze),{returnValue:32,Erb:b}):{returnValue:8,Erb:b}}b+="OldOrder,";if(!this.qsc&&v.AFrameworkApplication.Js.c$)return this.PYa&&this.PYa.value&&this.PYa.value.isEnabled()&&
v.AFrameworkApplication.kTb?(b+="Post,",h=this.Fjj()):(t.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),h=8),32!==h?(t.ULS.shipAssertTag(22595484,211,!!v.AFrameworkApplication.Js.c$),b+="HostUrl,",{returnValue:v.AFrameworkApplication.ua.cV(!0,v.AFrameworkApplication.Js.c$),Erb:b}):{returnValue:h,Erb:b};t.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",v.AFrameworkApplication.userSessionId);b+="DocUrl,";uH.IVh(this.qsc,
this.mz,this.options,this.application,Object(z.a)(this,this.iVi,"onEditInClientSuccess"),Object(z.a)(this,this.hVi,"onEditInClientFailure"),this.Itj,v.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),h,r,B,P,this.Rwd,this.kz,this.Uhd,v.AFrameworkApplication.va.V5d,this.Aze);return{returnValue:32,Erb:b}}R4n(b){v.AFrameworkApplication.Vl.setDw(8981,b)}iVi(b){this.R4n(b);t.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===b&&MSOJS.ClientUtils.ShouldShowDialog()?(this.bGo||this.GGi(),
this.hLi()):this.zkg||this.closeApplication()}hVi(b,h=0){t.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",b,h);if(5===b)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const r=!!this.xuc&&!this.Fvc;let B=0;1===b&&(B=2);6<=b&&13>=b&&(B=1,1===h&&(this.zkg=!0));this.MJo.Tjn?(t.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",B),QJ.a.instance.Xcl(this.Fvc?Object(z.a)(this,this.lTi,"oicErrorDialogHandlerCloseForced"):
Object(z.a)(this,this.mTi,"oicErrorDialogHandlerNoCloseForced"),r?Object(z.a)(this,this.hWi,"onLaunchDownload"):null,this.bTh(!1)?Object(z.a)(this,this.ywm,"iHaveOfficeButtonHandler"):null,B,h)):(t.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",B),QJ.a.instance.Vcl(this.Fvc?Object(z.a)(this,this.lTi,"oicErrorDialogHandlerCloseForced"):Object(z.a)(this,this.mTi,"oicErrorDialogHandlerNoCloseForced"),r?Object(z.a)(this,this.hWi,"onLaunchDownload"):null,B))}}hLi(){try{const b=
[Object.assign(new ha.a,{name:"CorrelationId",string:this.kz}),Object.assign(new ha.a,{name:"SessionOrigin",string:this.Rwd}),Object.assign(new ha.a,{name:"ClickTime",string:this.Uhd}),Object.assign(new ha.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];Ke.a("OpenInClientCompleted",!0,0,b)}catch(b){t.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+b.toString())}}GGi(){v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.vF&&v.AFrameworkApplication.K.$("StandardProtocolDialogIsEnabled")?
new IG(this):new TJ(this)}lTi(){this.closeApplication()}mTi(){this.Kjc()}hWi(){this.wGi()}ywm(){return this.bTh(!0)}bTh(b){const h=(Z.a.ZWc||Z.a.Nt)&&!!v.AFrameworkApplication.qLd;h&&b&&(Qd.a.wm(v.AFrameworkApplication.qLd,"_blank",void 0,"OpenInClient"),this.closeApplication());return h}}cE.hxn="OpenInDesktop";cE.axn="OpenInBrowser";Object(m.a)(cE,"AOpenInClientOperation",null,[]);class vH extends cE{constructor(b,h,r=!1){super(r);this.O6j=b;this.N6j=h}get Jqi(){return this.N6j}get OAf(){return this.O6j}Vyl(){v.AFrameworkApplication.va.Qb(fb.a.close,
2,Kg.a)}cZh(){}gxh(b){return this.U7i(b)}wGi(){t.ULS.shipAssertTag(5566817,211,!!this.xuc);v.AFrameworkApplication.cda?v.AFrameworkApplication.ua.cV(!0,this.xuc):Qd.a.wm(this.xuc,void 0,void 0,"LaunchDownload")}MSc(){v.AFrameworkApplication.ua.Kb.MSc()}}Object(m.a)(vH,"OpenInClientOperation",cE,[]);class WJ extends vH{constructor(){super("Word_32x32x32","EditInWordWebApp_32x32x32",!0);this.cZn=b=>{t.ULS.sendTraceTag(50857160,211,50,"Saving finished. Release lock before open in client");Eb.App.sS.forceOutbound(this.e_i,
this.E3m,b)};this.E3m=b=>{t.ULS.sendTraceTag(50857161,211,15,"Lock release failed.");const h=new Tf.StandardDialog;h.Cd=0;h.vx(hh.a.hSo,CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.l_UnlockFailed,b?this.C3m:this.D3m)};this.C3m=()=>{v.AFrameworkApplication.va.Qb(fb.a.close,2,Kg.c)};this.D3m=()=>{Eb.App.za.refreshDocument(null)};this.e_i=b=>{v.AFrameworkApplication.nbd=!0;t.ULS.sendTraceTag(50857162,211,50,"Saving finished. Ready to OpenWordClient with forceClose: {0}.",b);
this.U7i(b)}}sKk(b){Eb.App.si.X5a.tbc||Eb.App.zd.nC.Jo?(t.ULS.sendTraceTag(50857159,211,15,"Saving skipped due to document loading failure"),this.e_i(b)):lr.a.mR(yD.a.openInWord,!0,this.cZn,null,b)}gxh(b){this.sKk(b);return 32}cZh(){Eb.App.za.refreshDocument(null)}}Object(m.a)(WJ,"OpenInWordOperation",vH,[]);const XJ=(b,h)=>{t.ULS.sendTraceTag(41186076,306,50,"Toggling readonly recommended setting for the document.");b[qg.a.On]=si.PageReader.instance.ov(h);si.PageReader.instance.ov(h)?b[qg.a.Description]=
WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOn:b[qg.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOff},MM=(b,h,r,B,P)=>{if(!Eb.App.za||!Eb.App.za.jb||!v.AFrameworkApplication.Tm.i2a)return 8;h=Eb.App.za.jb.Zc;if(!h)return 8;if(b===Nb.a.ebe&&2===r){b=new cg.GraphTransaction(15);try{b.Db(h),si.PageReader.instance.GLo(h)}finally{b&&b.dispose()}XJ(P,h)}return 32},NM=(b,h,r,B,P)=>{if(!Eb.App.za||!Eb.App.za.jb)return 8;b=Eb.App.za.jb.Zc;if(!b)return 8;P[qg.a.Alt]=v.AFrameworkApplication.Tm.i2a?
"":CommonUIStrings.l_ProtectDocumentToolTip;XJ(P,b);return 32};var OM=c(1127);class YJ extends NJ.a{constructor(b,h){super(b,h);this.t2g=!1;this.qGc=new mb.a("docx doc docm dot dotx odt dotm".split(" "));this.u4d=100;this.OWi=(r,B,P,ca,ra)=>{var Qa;if(B.contextId!==yd.a.frame)return 2;if(!(Eb.App.UIc||v.AFrameworkApplication.Js.c$||v.AFrameworkApplication.kTb||this.t2g))return t.ULS.sendTraceTag(50857163,211,15,"OIC entry is hidden"),this.t2g=!0,8;if(1===P)return kc.SessionStatusManager.instance.Zj?
8:32;let tb=!1;void 0!==ra&&null!==ra&&(tb=ra);if(null===(Qa=v.AFrameworkApplication.K)||void 0===Qa?0:Qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.OpenInClientFeedback",!1))(new PJ).aNb().then(()=>this.$Mb(r,tb));else return this.$Mb(r,tb);return 32};this.$Sb=(r,B,P)=>{if(1==P){if(!OM.a.yGe)return 64}else if(2==P)return Ke.a("OpenFileFromPC"),(r=this.Lel(r))?this.kxo(P,r):2;return 32};this.Qql=r=>{this.S4m();if(!v.AFrameworkApplication.NYc&&v.AFrameworkApplication.ua.Kb.Ufg(fb.a.downloadACopy.toString()))this.Dza(!0,
M.a.download,!0,{});else if(v.AFrameworkApplication.K.$("WordEditorDownloadACopyUiIsEnabled")){let B=v.AFrameworkApplication.jEb,P=null;r&&(r.FileDownloadUrl&&(B=r.FileDownloadUrl.toString()),r.CallSource&&(P=r.CallSource.toString()));new OJ(B,P)}else super.downloadACopy(0,null,2,null,null)};this.xSk=r=>{super.workflow(0,null,2,null,r)};this.YI=Ma.a.instance.Ta("Common.ISystemInitiatedFeedback")}get hCf(){this.F_g||(this.F_g=Ma.a.instance.resolve("Common.IInsertFileUploader"));return this.F_g}Tb(){super.Tb();
this.ga.ra(Nb.a.openInClient,yd.a.frame,this.OWi);v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OICExtendedTelemetryIsEnabled",!1)&&this.ga.Xc(Nb.a.openInClient,12288);var b=this.ga;b.fb(Nb.a.ebe,yc.a.application,MM,4);b.fb(Nb.a.W4f,yc.a.application,NM,96);this.ga.ra(fb.a.DZf,yd.a.frame,this.OWi);this.ga.ra(Nb.a.$Sb,yc.a.view,this.$Sb)}$Mb(b,h){t.ULS.sendTraceTag(50857164,211,50,"OpenInClient begin. Expect saving starting soon.");return(new WJ).Ec(Eb.App.UIc,
v.AFrameworkApplication.jEb,EG.Word,b===fb.a.DZf?OF.OpenInBrowser:OF.WriteOnly,h,new pf.a(()=>this.pY))}dEd(b){return $k.a.instance.eva()?!0:Eb.App.za.ehj(yD.a.closeDocument,Qi.AppFrame.I_k,b)}Lel(b){return b===Nb.a.$Sb?()=>{this.hCf.glo(this.u4d);this.hCf.mgo(this.qGc);this.hCf.showDialog()}:null}kxo(b,h){return 2===b?(h(),32):2}downloadACopy(b,h,r,B,P){if(2===r){if(!v.AFrameworkApplication.jEb&&!v.AFrameworkApplication.ua.Kb.Ufg(fb.a.downloadACopy.toString()))return 8;lr.a.mR(yD.a.downloadACopy,
!0,this.Qql,null,P);this.dre();return 32}return super.downloadACopy(b,h,r,B,P)}dre(){v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadCopyInterceptEnabled",!1)&&null!=this.YI&&(t.ULS.sendTraceTag(509145740,306,50,"DownloadCopyIntercept logged for: DownloadACopy"),this.YI.execute(b=>b.logActivity("DownloadCopyIntercept",null)))}S4m(){v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1)&&null!=this.YI&&
this.YI.execute(b=>b.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled"))}workflow(b,h,r,B,P){return 2===r?(lr.a.mR(yD.a.workflow,!0,this.xSk,null,P),32):super.workflow(b,h,r,B,P)}}Object(m.a)(YJ,"AppFrameCommandUIActor",NJ.a,[]);class ZJ extends Tf.StandardDialog{constructor(){super();this.Cd=0;this.Rmb(CommonUIStrings.l_WheresTheSaveButtonDialogTitle,CommonUIStrings.l_WheresTheSaveButtonDialogMessage,"WheresTheSaveButtonDialogItem_32x32x32",CommonUIStrings.l_WheresTheSaveButtonDialogTitle,
null,null)}}Object(m.a)(ZJ,"WheresTheSaveButtonDialog",Tf.StandardDialog,[]);const PM=(b,h,r)=>{if(1===r)return 32;new ZJ;return 32};var wH=c(550),$J=c(1391);class Ns extends cm.a{constructor(b,h,r,B,P,ca,ra=null){var Qa;super();this.MKf=ra;this.IXj=50;this.JXj=56;this.mBc="px";this.Xte="aria-label";this.yKa="BookmarkIndicator";this.WYg="HighlightBookmarkedContent";this.V5j="HighlightBookmark";this.uXa="wwaengidc";this.ELk="Bookmark_24";this.gb=b;this.ig=r;this.tk=h;this.wW=B;this.hA=P;this.NXj=null===
(Qa=v.AFrameworkApplication.K)||void 0===Qa?void 0:Qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1);this.hA&&this.hA.iCd(this.aC.bind(this));this.MI=ca}Mro(b){if(b.gk){for(const h of b.Xg.hj)if(this.jqj(h))return!0;return!1}return this.jqj(b.htmlElement)}e8a(b){let h=!1;v.AFrameworkApplication.oe("bookmarks-core-ex;bookmarks-core-ex-cf");this.NXj&&Wq.a.instance.ie(()=>{h=this.Mro(b)},"BIA:SCIVE");return h}jqj(b){return Ns.eTe?(b=b.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .BookmarkStart"))&&
0<b.length?!0:!1:!1}R0a(b){const h=[];Wq.a.instance.ie(()=>{const r=b.d0a(0,this.MI?this.JXj:this.IXj,this.zoom);h.push(this.Gna(b.w5,r,b.qpc[0].y-b.L4[0].y))},"BIA:CIs");return h}Gna(b,h,r){const B=b.Fg.ownerDocument,P=Jm.a.createElement(B,un.a.div);P.className=this.MI?Ns.MXj:Ns.Nue;Ns.Nue;P.style.left=h+this.mBc;P.style.top=r+this.mBc;this.MI?(h=Jm.a.createElement(B,un.a.div),Hh.a("renderIcon")&&appChrome.api.renderIcon(this.ELk,h),h.setAttribute("role","img"),h.setAttribute("alt","Bookmark")):
(h=Jm.a.createElement(B,un.a.F3a),h.src=Nd.a.wg(Ns.qhd),h.alt="Bookmark");h.title="Bookmark";h.setAttribute(this.Xte,"Bookmark");P.appendChild(h);b={context:new BG([],P,new Set,new Set,null,null),QUf:b,container:P};this.MI||(this.tk.ob(pd.a.WR,h,this.onMouseEnter),this.tk.ob(pd.a.xL,h,this.wqa));this.ig.nE(pd.a.click,P,this.yHa.bind(this),b);return P}rGd(){const b=Object.assign(new ol.a,{action:1,type:5,HA:null,VJ:this.bfa});this.bfa=null;this.wW.LF(b)}aC(b,h){this.bfa&&(h.L1a.yf.classList.contains("BookmarkHighlightSelected")||
this.rGd())}onMouseEnter(b){if(null==b)return!1;b=b.yf;b.parentElement.classList.add(Ns.dNg);b.src=Nd.a.wg(Ns.GXj);return!0}wqa(b){if(null==b)return!1;b=b.yf;b.parentElement.classList.remove(Ns.dNg);b.src=Nd.a.wg(Ns.qhd);return!0}yHa(b){this.Z6a(this.WYg,this.V5j);if(null==b){var h=new Map;h.set("Source",this.yKa);h=Object.assign(new hc.a,{additionalValues:h});va.Health.instance.recordKpiFailure(this.WYg,"Unable to highlight bookmarked content",!1,!0,h);return!1}h=b.Vo.context;if(Ns.R4a(h,this.bfa))return!0;
h=this.prf(b.Vo.QUf,h,b.Vo.container);b=Object.assign(new ol.a,{action:0,type:5,HA:h,VJ:this.bfa});this.bfa=h;this.wW.LF(b);return!0}prf(b,h,r){h={Rxh:new Set,jNb:new Set,Uxh:null,G4e:null};const B=this.gb.xw(b.Cb,!0,!1),P=[];if(B)for(const ca of B)P.push(ca);this.guk(b,h,P);h=new BG(P,r,h.Rxh,h.jNb,h.Uxh,h.G4e);this.bfa&&this.bfa.ps===P&&(r.className+=String.format(" {0}",Ns.HXj),this.bfa=h);return h}guk(b,h,r){if(b.gk){const P=new Set;for(const ca of b.Xg.hj)ca.querySelectorAll("*").forEach(P.add,
P);b=Array.from(P.values())}else b=Array.prototype.slice.call(b.htmlElement.querySelectorAll("*"),0);let B=[];h.jNb.add(r[0].id);h.Uxh=r[0].id;h.G4e=r[0].id;b.forEach(P=>{const ca=Xb.a.Eb(P,Fk.a.qEd);if(ca)for(const ra of ca)B.push(ra),h.Rxh.add(ra);if(!B.length)return!0;P=Xb.a.Eb(P,Fk.a.BBb);if(!P)return!0;B=$J.a.njc(B,P)});for(b=this.gb.Xf(r[r.length-1],!1,!0);B.length&&b;)h.jNb.add(b.id),h.G4e=b.id,r.push(b),this.MKf.value.zj(b).htmlElement.querySelectorAll("."+Fk.a.F4e).forEach(P=>{(P=Xb.a.Eb(P,
Fk.a.BBb))&&(B=$J.a.njc(B,P))}),b=this.gb.Xf(b,!1,!0)}Z6a(b,h){const r=new Map;r.set("Source",this.yKa);r.set("Action",h);va.Health.instance.recordKpiUsage(b,0,this.uXa,r)}static R4a(b,h){return!!h&&!!b&&b.Pxh===h.Pxh}}Ns.dNg="WordBookmarkIndicatorContainerHovered";Ns.HXj="WordBookmarkIndicatorContainerSelected";Ns.qhd="BookmarkDefault.png";Ns.GXj="BookmarkHover.png";Ns.eTe=!0;Ns.Nue="WordBookmarkIndicatorContainer";Ns.MXj="WordBookmarkSvgIndicatorContainer";Object(m.a)(Ns,"BookmarkIndicatorActor",
cm.a,[330]);class aK{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb=null,Zb=null,jc=null,Gc=null,Uc=null,od=null,Od=null){this.e3="_";this.pue="Bookmark";this.gXj=/^BOOKMARK\d+$/i;this.yKa="BookmarkRibbonOptions";this.DXj="BookmarkFloatieOptions";this.RQg="CreateBookmarkOnRange";this.SQg="CreateBookmarkOnView";this.QQg="CreateBookmarkOnIP";this.Gxe="CreateBookmark";this.uXa="wwaengidc";this.Tgh="ShowHideBookmarksOnDocument";this.eSg="DeleteBookmark";this.F0j="DeleteBookmarkAction";this.dkk="ShowHideBookmarks";
this.Sgh="ShowBookmarksFloatie";this.akk="ShowBookmarksFloatieAction";this.KTg="EditBookmark";this.F1j="EditBookmarkAction";this.K4e="BookmarksUsage";this.HLk="InsertTabSwitchActivity";this.WEm="Insert";this.oUb=b;this.ga=h;this.hb=r;this.An=B;this.Cx=P;this.n7=ca;this.Lc=ra;this.$L=Qa;this.rp=Zb;this.cNg=tb;this.Fe=Mb;this.U6=Uc;this.Wn=jc;this.ld=Gc;this.CS=od;this.Ok=Od}get ox(){return this.Cx.value}Tb(){this.DDf()&&(this.ga.ra(qb.a.TOa,yc.a.view,this.TOa.bind(this)),this.ga.fb(fb.a.cVa,yc.a.application,
this.nOo.bind(this),96),this.ga.ra(qb.a.TOa,yc.a.Fd,this.R9k.bind(this)),this.ga.ra(qb.a.TOa,yc.a.Uc,this.Q9k.bind(this)),this.ga.ra(qb.a.deleteBookmark,yc.a.view,this.deleteBookmark.bind(this)),this.ga.ra(qb.a.nhf,yc.a.view,this.Itl.bind(this)),this.ga.fb(qb.a.Prj,yc.a.view,this.axo.bind(this),1028),this.ga.fb(qb.a.lbe,yc.a.application,this.lbe.bind(this),96),this.ga.fb(qb.a.Pie,yc.a.Uc,this.Pie.bind(this),1028),this.ga.fb(Nb.a.H2d,yc.a.view,this.H2d.bind(this),1028),this.ga.fb(qb.a.LWd,yc.a.view,
this.LWd.bind(this),1028),this.ga.Xc(qb.a.TOa,1028))}nOo(b,h,r,B,P){return P&&P.NewContextId===this.WEm?(this.a3d(this.HLk),32):2}TOa(b,h,r,B,P){var ca,ra;b=this.hb.qg;if(!b||b.contextId===yc.a.X7)return 2;if(1===r)return Gg.a.sia(h)||(null===(ca=this.Ok)||void 0===ca?0:ca.$_(b))||(null===(ra=this.Ok)||void 0===ra?0:ra.via(b))?8:32;h=this.hb.ib.lb;if(!h||this.Fe.Pl(h))return 2;this.J_c(P,"User is trying to create bookmark from UILocation : {0}");this.Z6a(this.SQg,this.Gxe);if(h&&this.An.AZe(this.SPa(),
h))return this.a3d(this.K4e),32;P=new Map;P.set("Source",this.yKa);P=Object.assign(new hc.a,{additionalValues:P});va.Health.instance.recordKpiFailure(this.SQg,"Unable to create bookmark",!1,!0,P);return 8}R9k(b,h,r,B,P){if(1===r)return 32;if(yc.a.Fd!==h.contextId)return 8;this.J_c(P,"User is trying to create bookmark from UILocation : {0}");b=this.hb.ib.lb;if(!b)return 2;this.Z6a(this.RQg,this.Gxe);if(this.An.AZe(this.SPa(),b))return this.a3d(this.K4e),32;b=new Map;b.set("Source",this.yKa);b=Object.assign(new hc.a,
{additionalValues:b});va.Health.instance.recordKpiFailure(this.RQg,"Unable to create bookmark for range",!1,!0,b);return 8}Q9k(b,h,r,B,P){if(1===r)return 32;if(yc.a.Uc!==h.contextId)return 8;this.J_c(P,"User is trying to create bookmark from UILocation : {0}");b=this.hb.ib.lb;if(!b)return 2;this.Fe.Pl(b)&&(h=b.Pa,this.Fe.Llb(h)?(b=this.Fe.j0(h,!1),b||(t.ULS.sendTraceTag(542921105,3029,50,"User is trying to create bookmark at EOP"),b=this.Fe.j0(h,!0))):t.ULS.sendTraceTag(542921106,3029,50,"Selection is not expandable to word. Bookmark will be added on IP"));
this.Z6a(this.QQg,this.Gxe);if(this.An.AZe(this.SPa(),b))return this.a3d(this.K4e),32;b=new Map;b.set("Source",this.yKa);b=Object.assign(new hc.a,{additionalValues:b});va.Health.instance.recordKpiFailure(this.QQg,"Unable to create bookmark for IP",!1,!0,b);return 8}lbe(b,h,r,B,P){1===r&&32;P[qg.a.On]=Ns.eTe;return 32}axo(b,h,r,B,P){if(1===r)return 32;this.Z6a(this.Tgh,this.dkk);(b=P[qg.a.On])||t.ULS.sendTraceTag(556889756,3029,50,"User hides bookmarks annotations on document");Ns.eTe=b;b=qo.PageNavigator.instance.jP(this.ox);
if(null!==b)return this.W5c(b),this.oUb.jH({ShowBookmarks:"CheckboxModel"}),32;b=new Map;b.set("Source",this.yKa);b=Object.assign(new hc.a,{additionalValues:b});va.Health.instance.recordKpiFailure(this.Tgh,"Unable to show/hide bookmark on document",!1,!0,b);return 8}deleteBookmark(b,h,r,B,P){if(this.DDf()){b=this.hb.ib.lb;if(!b)return 2;b=b.Pa;b=this.An.DRd(b.node,b.cpBegin);if(1===r)return b?32:8;this.J_c(P,"User is trying to delete bookmark from UILocation : {0}");this.$L.M0&&(t.ULS.sendTraceTag(545118155,
3029,50,"Dismissing the bookmarks floatie"),this.$L.dismissFloatie());this.Z6a(this.eSg,this.F0j);b||t.ULS.sendTraceTag(545118156,3029,50,"Delete bookmark called for a context where there were no bookmarks.");if(b&&this.An.M$i(b.id))return this.cNg&&this.cNg.rGd(),32;r=new Map;r.set("Source",this.yKa);r=Object.assign(new hc.a,{additionalValues:r});va.Health.instance.recordKpiFailure(this.eSg,"Unable to delete bookmark",!1,!0,r);return 8}return 2}Itl(b,h,r,B,P){b=this.hb.ib.lb;if(!b)return 2;b=b.Pa;
b=this.An.DRd(b.node,b.cpBegin);if(1===r)return b?32:8;this.J_c(P,"User is trying to edit bookmark from UILocation : {0}");this.$L.M0&&(t.ULS.sendTraceTag(539762822,3029,50,"Dismissing the bookmarks floatie"),this.$L.dismissFloatie());this.Z6a(this.KTg,this.F1j);b||t.ULS.sendTraceTag(539762823,3029,50,"Edit bookmark called for a context where there were no bookmarks.");if(b)return this.U6.value.Jtl(h,b,this.An),32;h=new Map;h.set("Source",this.yKa);h=Object.assign(new hc.a,{additionalValues:h});va.Health.instance.recordKpiFailure(this.KTg,
"Unable to edit bookmark",!1,!0,h);return 8}J_c(b,h){b&&b.UILocation&&t.ULS.sendTraceTag(540386525,3029,50,h,b.UILocation)}Pie(b,h,r,B,P){1===r&&32;this.Z6a(this.Sgh,this.akk);if(h.contextId===yc.a.Uc)return b=Array(1),b.push("Bookmarks"),this.$L.showFloatie(P.location,b,1),32;P=new Map;P.set("Source",this.DXj);P=Object.assign(new hc.a,{additionalValues:P});va.Health.instance.recordKpiFailure(this.Sgh,"Unable to show bookmark floatie",!1,!0,P);return 8}H2d(b,h,r,B,P){let ca;return 1===r?(Wq.a.instance.ie(()=>
{ca=this.ga.Nf(h,Nb.a.insertHyperlink,r,!0,B,P);32!==ca&&(ca=this.ga.Nf(h,qb.a.TOa,r,!0,B,P))},"BA:LFE"),ca):8}LWd(b,h,r){var B;if(1===r)return 32;if(b=this.hb.ib.lb){b=b.Pa.node;if(h=this.CZh(b))return h.click(),32;t.ULS.sendTraceTag(539523265,3029,50,"No indicator found in current paragraph.");if(b=this.An.DRd(b,0)){b=this.CS.xfb.get(null===(B=b.id)||void 0===B?void 0:B.toString());B=qo.PageNavigator.instance.jP(this.ox).Mc.Eb(b);if(B=this.CZh(B))return B.click(),32;t.ULS.sendTraceTag(539523266,
3029,50,"No indicator found for the paragraph in previous paragraphs.")}else t.ULS.sendTraceTag(539523267,3029,50,"No bookmark found enclosing the content.")}return 2}CZh(b){let h;b=this.Wn.El(b).zj(this.ld.yd.$b);b.ilb&&(b=b.htmlElement.querySelectorAll("div."+Ns.Nue),0<b.length&&(h=b[0]));return h}W5c(b){const h=wH.b(b);if(h){var r=this.Lc.Pc(2);try{for(r.Db(b);h.moveNext();){if(!ke.ParagraphReader.oh(h.iterator))continue;const B=h.currentNode;this.Dsl(B)&&this.n7.RIb(B,!0)}}finally{r&&r.dispose()}}}Dsl(b){for(let r=
0;r<b.qa.length;r++){const B=b.qa.J(r);if(null!=B.$g)for(let P=0;P<B.$g.length;P++){var h=B.$g.J(P);if(null!=h&&(h=b.Mc.Eb(h.xn).ja(Mc.a.At,""),!F.a.af(h)&&!h.startsWith(this.e3)))return!0}}}SPa(){var b=this.An.jQd(!1);const h=[];for(let r=0;r<b.count;r++){const B=b.J(r).ja(Mc.a.At,"");this.gXj.test(B)&&h.push(B)}return 0<h.length?(h.sort((r,B)=>r.localeCompare(B,void 0,{numeric:!0})),b=parseInt(h[h.length-1].substring(this.pue.length)),this.pue+(b+1)):this.pue+1}Z6a(b,h){const r=new Map;r.set("Source",
this.yKa);r.set("Action",h);va.Health.instance.recordKpiUsage(b,0,this.uXa,r)}a3d(b){this.DDf()&&this.rp&&this.rp.execute(h=>{h.logActivity(b,null)})}DDf(){v.AFrameworkApplication.oe("bookmarks-core-ex;bookmarks-core-ex-cf");return v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)}}Object(m.a)(aK,"BookmarkActor",null,[]);class bK{constructor(b,h,r){this.oc=b;this.Gnl=h;this.Uf=r;this.j9e=this.j9e.bind(this)}Tb(){this.oc.ra(qb.a.qKf,
yc.a.view,this.j9e)}j9e(b,h,r,B,P){return 1===r?32:(b=this.Uf.g9(h.ik))?(P=3===P.Rx,this.Gnl.value.ILh(this.Bam(b),this.rkm(b),P),32):2}Bam(b){const h=new fd.DictionaryPropertySet;h.setValue(dd.a.aF,this.Uf.hh(b));h.setValue(dd.a.tG,this.Uf.Hha(b));h.setValue(dd.a.una,this.Uf.Sib(b));h.setValue(dd.a.separator,this.Uf.rUd(b));return h}rkm(b){const h=new fd.DictionaryPropertySet;h.setValue(Mc.a.marginLeft,this.Uf.CJ(b));h.setValue(Mc.a.marginRight,this.Uf.mL(b));h.setValue(Mc.a.Ko,this.Uf.qu(b));return h}}
Object(m.a)(bK,"ColumnsDialogActor",null,[]);var cK=c(469);class dK{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb){this.$o=b;this.pfa=h;this.De=r;this.qr=B;this.km=P;this.Md=ca;this.Lc=ra;this.we=Qa;this.ga=tb;this.r8j=Mb;this.l_j=Zb}get qEf(){return this.r8j}Tb(){this.ga.fb(Nb.a.T$c,yc.a.view,this.rDm.bind(this),96);this.ga.fb(Nb.a.F6c,yc.a.view,this.F6c.bind(this),4);this.ga.fb(Nb.a.qDd,yc.a.view,this.qDd.bind(this),1028)}qDd(b,h,r,B,P){if(!zm.a.I$e)return 8;b=P.FormattingActionId;P=P.FormattingActionData;
if(!h.view||!h.view.ue)return 2;h=h.view;if(!(b&&P&&h.mb&&h.mb.ib.lb))return 8;h=this.km.T7h(h.mb.ib.lb.toArray());for(const ca of h){h=ca.ja(Mc.a.Zw,0);r=this.$o.getById(h);if(!r)return t.ULS.sendTraceTag(509136987,368,10,"Content control not found by id '"+h+"'."),8;if(!this.l_j.pVo(r,b,P))return t.ULS.sendTraceTag(509136986,368,10,"Content control with id '"+h+"' failed to update formatting."),8}return 32}rDm(b,h,r,B,P){h=this.$o.getById(P);if(!h)return 8;r=h.contentControlNode;if(!r)return 8;
if(r.ja(Mc.a.u8,!1))return 2;B=this.$o.iTl(h);if(!B)return 8;P=this.Lc.Pc(7);P.Db(B.node);if(!this.qEf)return(b=h.placeholderText)||(b=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder),this.Md.Ge(B,b),zm.a.nda?this.km.hBb(h,!0):this.hBb(h),r.setValue(Mc.a.u8,!0),P.dispose(),32;const ca=new fd.DictionaryPropertySet;ca.setValue(Yc.a.vVd,B);var ra=r.ja(Mc.a.POa,"");ra=this.pfa.tki(ra);if(!ra)return this.qr.Ge(B,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,zm.a.xr?b:void 0),
zm.a.nda?this.km.hBb(h,!0):this.hBb(h),r.setValue(Mc.a.u8,!0),P.dispose(),32;ca.setValue(Yc.a.tSc,ra);if(1<ra.length&&!h.Jf)return P.dispose(),8;zm.a.nda?this.ga.Qb(Nb.a.cad,2,{tSc:ra,vVd:B,placeholderText:h.placeholderText}):this.n8k(ca);r.setValue(Mc.a.u8,!0);P.dispose();return 32}F6c(b,h,r){b=h.view.ue?h.view:null;if(!b||!b.mb)return 8;const [B,P]=this.Kdm(b.mb.ib);if(0===B.length)return 8;if(1===r){for(var ca of B){var ra=P.get(ca.parentId);if(this.Bwi(ca,ra))return 32}return 8}if(2===r){r=this.qAo(B,
P);ca=this.Lc.Pc(15);ca.Db(b.ed);for(ra of r)r=P.get(ra.parentId),this.Bwi(ra,r)&&this.$o.VOb(ra.id);ca.dispose();Object(cK.l)()&&Object(cK.o)("RemoveContentControl");return 32}return 2}Kdm(b){var h,r,B=[];for(const ca of b)B.push(...(null!==(h=this.km.xoa(ca.Pa,ca.Tc,1))&&void 0!==h?h:[]));if(0===B.length)return[B,new Map];h=[];for(const ca of b)h.push(...(null!==(r=this.km.xoa(ca.Pa,ca.Tc,3))&&void 0!==r?r:[]));b=new Map(B.map(ca=>[ca.id,ca]));if(0===h.length)return[B,b];const P=new Map(h.map(ca=>
[ca.id,ca]));B=B.filter(ca=>!P.has(ca.id));b=new Map([...b,...P]);return 0==B.length?[[h[0]],b]:[B,b]}hBb(b){const h=this.qr.tRc(b.start.node,0<=b.start.cpBegin?b.start.cpBegin:0);if(h){if(b=this.we.JB(b.start.node).oj($m.a.d1f))this.De.Iga(h.formatting),this.De.c8a(h.formatting,b)}else t.ULS.sendTraceTag(20492441,368,15,"Unable to get a ChP at starting Ip of Content Control")}n8k(b){this.ga.Qb(Nb.a.cad,2,b)}Bwi(b,h){return b.nia&&b.oTm&&(!h||h.isEditable)}qAo(b,h){const r=(B,P)=>null==B||null==P||
B.id===P.id?!1:B.id===P.parentId||r(h.get(B.parentId),P);return b.slice().sort((B,P)=>r(B,P)?1:r(P,B)?-1:0)}}Object(m.a)(dK,"ContentControlActor",null,[]);class QF{constructor(b){this.ga=b;this.primaryButtonText="Count me in";this.secondaryButtonText="Cancel";this.nAk=["We are gauging interest in a feature that would let you","customize your ribbon in Word on the web. Click below","to vote or comment on this idea, as well as follow it","status updates. Thank you."];this.UKo="Interested in this feature?"}Tb(){this.ga.ra(qb.a.udf,
yc.a.view,this.IVc.bind(this))}IVc(b,h,r){2===r&&(Object(Ke.c)(qb.a.udf),b=new Tf.StandardDialog,b.Cd=4,b.ze(1,this.primaryButtonText),b.ze(2,this.secondaryButtonText),b.IFc(this.nAk,null),b.rv(this.UKo,null,0,this.fca));return 32}fca(b){1===b&&(Object(Ke.a)("CountMeIn_CustomizeRibbon",!0),F.a.xP(QF.LIj)&&Qd.a.wm(QF.LIj))}}QF.LIj="https://feedbackportal.microsoft.com/feedback/idea/974fe330-6613-ed11-b83e-000d3a4d92e4";Object(m.a)(QF,"CustomizeRibbonActor",null,[]);var DB=c(1095);class xH extends Pe.a{constructor(b,
h,r){super(!1,!1,!0);this.r5g=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,DB.a.s1e,DB.a.r1e,DB.a.t1e];this.uWj=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,DB.a.HBk,DB.a.GBk,DB.a.JBk];this.vLg=[Box4Intl.Box4Strings.l_CustomTabDialogAlignLeft,Box4Intl.Box4Strings.l_CustomTabDialogAlignCenter,Box4Intl.Box4Strings.l_CustomTabDialogAlignRight];this.Ulc=()=>{new xH(this.ga,this.aVe,this.Ltc)};this.l1l=()=>{const B=[];for(const P of this.aVe)B.push(this.h6(P));return B};this.XZo=B=>{const P=
new Set;this.mfa="";for(const ca of B)if(""!==ca.position){const ra=this.udi(ca.position);if(0>ra||22<ra){this.mfa=Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds;break}if(P.has(ra)){this.mfa=Box4Intl.Box4Strings.l_CustomTabDialogMultipleTabStopsSamePosition;break}else this._tabStops.push(this.iLo(ca)),P.add(ra)}else{this.mfa=Box4Intl.Box4Strings.l_CustomTabDialogEmptyPosition;break}""!==this.mfa&&(this._tabStops=[],this.aVe=B)};this.Ghl=(B,P)=>{try{if(1===B){if(""!==this.mfa)throw Error.create(this.mfa);
P.DefaultTabStop&&(this.Ltc=DB.a.Eag(P.DefaultTabStop),this.k2o(this.Ltc));if(32!==this.ga.Qb(qb.a.NSb,2,{["tabStops"]:this._tabStops,["defaultTabStopLength"]:Ze.a.Nv(this.Ltc)}))throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogSaveError);}}catch(ca){this.JIa(ca.message,this.Ulc)}};this.ga=b;this.aVe=h;this._tabStops=[];this.Ltc=r;this.mfa="";b={["id"]:"CustomTabDialog",["bodyControls"]:this.HFb()};this.Uh(Box4Intl.Box4Strings.l_CustomTabDialogTitle,this.Ghl,b)}h6(b){return{["position"]:b.position,
["alignment"]:b.alignment,["leader"]:b.leader}}udi(b){return Math.floor(100*parseFloat(b))/100}iLo(b){return new zw.a(Ze.a.Nv(this.udi(b.position)),DB.a.zgm(b.alignment),DB.a.xgm(b.leader),1)}k2o(b){if(0>b||22<b)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds);var h={};if(32===this.ga.Qb(Nb.a.cIa,2,h)){var r=h.marginLeft;const B=xg.a.Qi(h.marginRight,0);r=xg.a.Qi(r,0);h=xg.a.Qi(h.Ko,0);if(xg.a.Tca(b,0,!1)>=h-B-r)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopMarginIndentCheck);
}}HFb(){return{["getInitState"]:this.l1l,["updateState"]:this.XZo,["validPositions"]:this.Khi(-Infinity,Infinity,"Position"),["validAlignments"]:this.o7h(this.vLg,this.vLg,null,"Alignment"),["validLeaders"]:this.o7h(this.r5g,this.r5g,this.uWj,"Leader"),["defaultTabStopSpinButtonProps"]:this.Khi(.01,22,"DefaultTabStops"),["defaultTabStopLength"]:this.Ltc,["DefaultTabStop"]:"DefaultTabStop",["addButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogAddButton,["clearAllButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogClearAllButton,
["positionHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogPosition,["alignmentHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogAlignment,["leaderHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogLeader,["defaultTabStopText"]:Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStops,["addNewTabStopHeader"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopHeader,["addNewTabStopDescription"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopDescription,["deleteButtonTooltip"]:Box4Intl.Box4Strings.l_CustomTabDialogDeleteButtonTooltip}}Khi(b,
h,r){return{["type"]:"AppSpinButtonProps",["id"]:"CustomTabDialogSpinButtonPosition",["label"]:r,["unitType"]:"Inch",["validUnits"]:[yC("Inch",3,b,h,.1)],["numberFormatInfo"]:cH()}}o7h(b,h,r,B){return{["type"]:"AppComboBoxProps",["id"]:"CustomTabDialogComboBox",["label"]:B,["options"]:rG(b,h,r)}}}Object(m.a)(xH,"CustomTabDialog",Pe.a,[]);class eK{constructor(b,h,r){this.bgc=(B,P,ca,ra,Qa)=>{if(2!==ca)return 8;if(!Qa)return 16;B=Qa.tabStop;Qa=Qa.value;if(!B)return 16;Ke.c(qb.a.bgc);Qa=new zw.a(Qa,
B.xea,B.aqa,B.Okg);P=P.node;this.hBa.f7a(P,B);this.hBa.VXd(P,Qa);return 32};this.s9c=(B,P,ca,ra,Qa)=>{if(2===ca){if(!Qa)return 16;this.hBa.VXd(P.node,Qa);return 32}return 8};this.kOb=(B,P,ca,ra,Qa)=>{B=this.hBa.O7i(P.node);if(!("customTabs"in Qa))return Qa.customTabs=B,32;P=Qa.customTabs;if(!P||0>=P.length||!B||0>=B.length)return Qa.customTabs=null,32;ca=[];for(const tb of P)for(const Mb of B)if(Mb.jJa===tb.jJa&&Mb.Okg===tb.Okg&&Mb.xea===tb.xea){ca.push(tb);break}Qa.customTabs=ca;return 32};this.f7a=
(B,P,ca,ra,Qa)=>{if(2===ca){if(!Qa)return 16;Ke.c(qb.a.f7a);this.hBa.f7a(P.node,Qa);return 32}return 8};this.WOb=(B,P)=>{this.hBa.WOb(P.node);return 32};this.NSb=(B,P,ca,ra,Qa)=>{if(2===ca){if(!Qa)return 16;B=Qa.tabStops;ca=Qa.defaultTabStopLength;P=P.node;ra=!1;const tb=this.hBa.W3n(P,B);Qa.defaultTabStopLengthSaved||(ra=this.FK.Yho(P,ca),Qa.defaultTabStopLengthSaved=!0);tb&&Ke.d(qb.a.NSb,!0,void 0,void 0,void 0,void 0,[Object.assign(new ha.a,{name:"Custom Tab Stops Count",string:B.length.toString()})]);
if(null==ra)return t.ULS.sendTraceTag(571479714,3015,15,"Could not set Default Tab Stop Length."),16;ra&&(this.d7c&&this.d7c.Lui(),this.Qd.Zs(11,Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopTrackingAlert),Ke.d(qb.a.NSb,!0,void 0,void 0,void 0,void 0,[Object.assign(new ha.a,{name:"Default Tab Stop Length",string:ca.toString()})]));return 32}return 8};this.$rj=(B,P,ca)=>{if(2!==ca)return 8;B={};if(32!==this.ga.Qb(qb.a.YX,2,B))return t.ULS.sendTraceTag(572072071,3015,15,"Could not read Default Tab Stop Length."),
16;P={};if(32!==this.ga.Qb(Nb.a.cIa,2,P))return t.ULS.sendTraceTag(572072072,3015,15,"Could not read Section Properties."),16;B=DB.a.Eag(Ze.a.Yz(B.defaultTabStop));ca={};ca.defaultTabStopLength=B;ca.sectionPropertiesData=P;if(32!==this.ga.Qb(qb.a.vrg,2,ca))return t.ULS.sendTraceTag(572072073,3015,15,"Could not validate Paragraphs against indents and default tab stop."),16;if(!ca.isParagraphValid)return t.ULS.sendTraceTag(572072074,3015,15,"Could not open Custom Tab Stop Dialog since all selected paragraphs failed validation."),
this.hBa.JIa(Box4Intl.Box4Strings.l_CustomTabDialogIndentError),8;P={};if(32!==this.ga.Qb(qb.a.kOb,2,P))return t.ULS.sendTraceTag(572072075,3015,15,"Could not read Custom Tab Stops."),16;(P=P.customTabs)||(P=[]);P=DB.a.ygm(P);new xH(this.ga,P,B);Ke.c(qb.a.Ulc,!0);return 32};this.dSm=(B,P,ca,ra,Qa)=>{if(2!==ca)return 8;if(!Qa)return 16;if(Qa.isParagraphValid)return 32;ca={};if(32!==this.ga.Nf(P,Nb.a.U6a,2,!1,null,ca))return 16;B=Qa.sectionPropertiesData;P=Qa.defaultTabStopLength;var tb=ca.Lt;ra=tb.jpa;
tb=1===tb.specialIndentType?tb.OB:tb.OB-tb.sea;const Mb=B.marginLeft,Zb=B.marginRight;ca.isRtl?(ca=xg.a.Qi(Math.max(Zb,Zb+ra),0),ra=xg.a.Qi(Math.max(Mb,Mb+tb),0)):(ca=xg.a.Qi(Math.max(Mb,Mb+tb),0),ra=xg.a.Qi(Math.max(Zb,Zb+ra),0));B=xg.a.Qi(B.Ko,0);P=xg.a.Tca(P,0,!1);Qa.isParagraphValid=P<B-ca-ra;return 32};this.ga=b;this.hBa=h;this.FK=r}get Qd(){return null!=this.HIg?this.HIg:this.HIg=Ma.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get d7c(){return null!=this.vGg?this.vGg:
this.vGg=Ma.a.instance.Oa("WordEditor.Actors.RenderParagraphsContainingTabs")}Tb(){const b=r=>Uy.OutlineElementGeneralizer.Aha(r.ib,!0),h=Eb.App.lVa.wKc(b,!0);this.ga.ra(qb.a.kOb,yc.a.view,Eb.App.lVa.wKc(b,!1));this.ga.fb(qb.a.kOb,yc.a.paragraph,this.kOb,96);this.ga.ra(qb.a.f7a,yc.a.view,h);this.ga.fb(qb.a.f7a,yc.a.paragraph,this.f7a,96);this.ga.ra(qb.a.WOb,yc.a.view,h);this.ga.fb(qb.a.WOb,yc.a.paragraph,this.WOb,96);this.ga.ra(qb.a.s9c,yc.a.view,h);this.ga.fb(qb.a.s9c,yc.a.paragraph,this.s9c,96);
this.ga.ra(qb.a.bgc,yc.a.view,h);this.ga.fb(qb.a.bgc,yc.a.paragraph,this.bgc,96);this.ga.ra(qb.a.NSb,yc.a.view,h);this.ga.fb(qb.a.NSb,yc.a.paragraph,this.NSb,96);this.ga.ra(qb.a.vrg,yc.a.view,h);this.ga.fb(qb.a.vrg,yc.a.paragraph,this.dSm,96);this.ga.ra(qb.a.Ulc,yc.a.view,this.$rj);this.ga.ra(qb.a.rti,yc.a.view,this.$rj)}}Object(m.a)(eK,"CustomTabActor",null,[]);var QM=c(121),JG=c(628);class fK{constructor(b,h,r,B,P,ca,ra,Qa,tb){this.ga=b;this.wAd=r;this.DKa=(this.m0b=P)&&B;this.Bn=ca;this.yT=ra;
this.i0j=Qa;this.zx=tb;this.$Lg=h;this.$Lg.getBooleanFeatureGate("Microsoft.Office.WordOnline.DoNotSetDarkModeStateInDarkModeActor",!1)?(this.HNf(!0),this.$Mf(!0)):(this.m0b&&Hh.a("isSharedUXDarkModeOn")?(this.Bn.mJ=appChrome.api.isSharedUXDarkModeOn(),this.HNf(!0)):this.Bn.mJ=!1,this.DKa?this.$Mf(!0):this.Bn.aVa=!1);v.AFrameworkApplication.qI(()=>{this.qMb()});this.DKa&&Hh.a("dispatch")&&appChrome.api.dispatch(this.Exj([]))}Tb(){this.DKa&&(this.ga.ra(qb.a.ALo,yc.a.view,this.Uhl.bind(this)),this.ga.ra(qb.a.q$c,
yc.a.view,this.q$c.bind(this)),this.ga.fb(qb.a.y5c,yc.a.view,this.y5c.bind(this),96));this.m0b&&(this.ga.ra(qb.a.r$c,yc.a.view,this.r$c.bind(this)),this.ga.fb(qb.a.Zbe,yc.a.view,this.Zbe.bind(this),96))}KGm(b){if(!this.Yso(b))return!1;const h=Il.a.instance.Pc(2);try{h.Db(b.root);const r=Ad.GraphIterator.eb(b.root.graphNode),B=nm.a.Qp(r);for(;B.moveNext();){const P=Object(Ra.a)(QM.a,B.currentNode);P&&P.pL(b.$b,20,!0)}}finally{h&&h.dispose()}return!0}Yso(b){return b&&b.root&&b.mv?b.Zi||b.zFf||b.Cyi||
b.$j:!1}Q5n(){let b=!1;this.wAd.forEach(h=>{this.KGm(h)&&(b=!0)});return b}BLo(){t.ULS.sendTraceTag(570566656,3023,50,"Toggle Dark Mode for canvas fishbowl to {0} mode",this.Bn.mJ?"dark":"light");return this.Bn.mJ?JG.a.PFc(1):JG.a.Y$i(1)}Umg(){const b=this.Bn.k8;t.ULS.sendTraceTag(571524678,3023,50,"Toggle canvas Dark Mode to {0} mode",b?"dark":"light");if(!this.Q5n()||(b?!JG.a.PFc(0):!JG.a.Y$i(0)))return!1;this.i0j.AOn(b);return!0}Exj(b){b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",
!this.Bn.mJ));b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackgroundStatusBar",this.oii(!0)));try{WordRibbonStrings?b.push(appChrome.actions.setControlCustomTooltip("DarkModeSwitchBackgroundStatusBar",this.Bn.aVa?WordRibbonStrings.DarkModeSwitchBackgroundTooltipDark:WordRibbonStrings.DarkModeSwitchBackgroundTooltipLight)):t.ULS.sendTraceTag(527283228,3023,10,"Trying to access WordRibbonStrings when it's undefined")}catch(h){t.ULS.sendTraceTag(527282835,3023,10,h)}return b}Uhl(){return this.Umg()?
32:8}r$c(b,h,r){if(1===r)return 32;b=this.yT.Zf("UserAction","sharedUXDarkModeToggle");if(Hh.a("toggleSharedUXDarkMode"))t.ULS.sendTraceTag(571524677,3023,50,"Requesting to toggle Dark Mode for the Shared UX."),appChrome.api.toggleSharedUXDarkMode(),Hh.a("isSharedUXDarkModeOn")?this.Bn.mJ=appChrome.api.isSharedUXDarkModeOn():this.Bn.mJ=!this.Bn.mJ,t.ULS.sendTraceTag(529388308,3023,50,"User in new ribbonMode: {0}",this.Bn.mJ);else return 8;appChrome.getHeaderApi().then(B=>{B.hasOwnProperty("refreshThemeOverride")&&
B.refreshThemeOverride()});this.BLo()||t.ULS.sendTraceTag(561553416,3023,15,"Failed to toggle Dark mode for Fishbowl");this.DKa&&!this.Bn.aVa&&(this.Umg()||t.ULS.sendTraceTag(561553417,3023,15,"Failed to toggle Dark mode for Canvas"));h={};h.DarkModeToggle=appChrome.selectors.getModelType("DarkModeToggle");Eb.App.za.jH(h);appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.Bn.mJ));this.DKa&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",
!this.Bn.mJ));b.stop();t.ULS.sendTraceTag(555885377,3023,50,"{0}",b.oi);Ke.b(this.Bn.mJ?"DarkModeOn":"DarkModeOff");return 32}q$c(b,h,r){if(1===r)return 32;b=this.yT.Zf("UserAction","sharedUXDarkModeSwitchBackground");t.ULS.sendTraceTag(561088148,3023,50,"Requesting to toggle Dark Mode for the switch background UX.");this.Bn.aVa=!this.Bn.aVa;if(!this.Umg())return 8;h={};h.DarkModeSwitchBackground=this.zx?"ButtonModel":"ToggleButtonModel";Eb.App.za.jH(h);b.stop();t.ULS.sendTraceTag(555885378,3023,
50,"{0}",b.oi);t.ULS.sendTraceTag(529388309,3023,50,"User in new canvasMode: {0}",this.Bn.aVa);Ke.b(this.Bn.aVa?"DarkCanvasOff":"DarkCanvasOn");return 32}Zbe(b,h,r,B,P){if(1===r)return 32;if(!P)return 2;Hh.a("isSharedUXDarkModeOn")&&(this.Bn.mJ=appChrome.api.isSharedUXDarkModeOn());P&&(P[qg.a.On]=this.Bn.mJ);return 32}y5c(b,h,r,B,P){if(1===r)return 32;if(!P)return 2;!this.zx&&P&&(P[qg.a.On]=this.Bn.aVa);b=[];b.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.Bn.mJ));
this.DKa&&this.Exj(b);b.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackground",this.oii(!1)));appChrome.api.dispatch(b);return 32}oii(b){const h={};this.Bn.aVa?b?h["default"]="MoonMonochromatic_16":(h["default"]="MoonMonochromatic_20",h.icon32="MoonMonochromatic_32"):b?h["default"]="SunMonochromatic_16":(h["default"]="SunMonochromatic_20",h.icon32="SunMonochromatic_32");return h}qMb(){this.m0b&&this.HNf(!1);this.DKa&&this.$Mf(!1)}HNf(b){var h;t.ULS.sendTraceTag(561088149,3023,50,"Shared dark mode state. IsBoot: {0}; State: {1}; DefaultOn: {2}",
b,this.Bn.mJ?"dark":"light",this.Bn.wEa);b&&this.Bn.mJ!=(null===(h=this.$Lg)||void 0===h?void 0:h.$("DarkModeIsOn"))&&t.ULS.sendTraceTag(522303360,3023,15,"Inconsistent dark mode value is found during boot. Dark mode toggle: {0}. DefaultOn: {1}.",this.Bn.mJ?"dark":"light",this.Bn.wEa)}$Mf(b){t.ULS.sendTraceTag(561088150,3023,50,"Canvas dark mode state. IsBoot: {0}; State: {1}; DarkCanvasPreferred: {2}",b,this.Bn.k8?"dark":"light",this.Bn.Thl)}}Object(m.a)(fK,"DarkModeActor",null,[]);var gK=c(1619),
RM=c(530);class KG{constructor(){this.Height=this.Width=0}static construct(b,h){const r=new KG;r.Width=b;r.Height=h;return r}}Object(m.a)(KG,"ViewportInfo",null,[]);class yH extends Fn.a{constructor(){super();this.ContractVersion=0;this.World=this.EnhancementId=this.DocumentContent=null;this.ScalingFactor=0;this.MobileViewportInfo=this.DesktopViewportInfo=null;this.MinParagraphCount=0;this.ContentCulture=null}nl(){return RM.a.swayPreview}static construct(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb){const jc=new yH;
jc.ContractVersion=b;jc.DocumentContent=h;jc.EnhancementId=r;jc.World=B;jc.ScalingFactor=P;jc.DesktopViewportInfo=KG.construct(ca,ra);jc.MobileViewportInfo=KG.construct(Qa,tb);jc.MinParagraphCount=Mb;jc.ContentCulture=Zb;return jc}}Object(m.a)(yH,"SwayPreviewRequest",Fn.a,[]);var SM=c(600);class zD{static get Vg(){return Pe.a.Kx(Eb.App.instance&&Eb.App.instance.M1d?zD.Jnl:zD.Xm,WordEditorIntl.WordEditorStrings.L_DigitalPrintLearnMore,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogStyleLabel,
WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogPreviewLabel,zD.W$n,WordEditorIntl.WordEditorStrings.l_SavingStatus)}}zD.W$n=Nd.a.wg("progress.gif");zD.Xm="<div class='WACDialogRow digitalPrintDialogWrapper UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
zD.Jnl="<div class='WACDialogRow digitalPrintDialogWrapper digitalPrintDialogWrapperResize UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper swayGalleryWrapperResize' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper swayPreviewWrapperResize' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
Object(m.a)(zD,"DigitalPrintDialogHtml",null,[]);class Dx{constructor(b,h,r,B){this.fontFamily=b;this.I7n=h;this.fontWeight=r;this.fontStyle=B}}Object(m.a)(Dx,"FontInfo",null,[]);class Os{constructor(b,h,r,B){this.styleName=b;this.title=h;this.TKo=r;this.$tm=B}}Object(m.a)(Os,"StyleVisualInfo",null,[]);class dE extends Pe.a{constructor(b,h,r,B,P=!0){super();this.g7=this.fu=this.Sla=this.n3=this.jnd=this.zih=this.wyd=this.SUe=this.TUe=this.kUe=this.J0b=this.uNa=this.C3=this.a0b=null;this.IXe=this.jQe=
!1;this.Zld=null;this.asl=()=>{this.Ahj(0)};this.$rl=(ca,ra)=>{this.Ahj(ra)};this.hZi=ca=>{this.vbi(ca)===Sys.UI.Key.enter&&(this.LYf(ca),ca.preventDefault(),ca.stopPropagation())};this.yVi=ca=>{((ca=ca.rawEvent.relatedTarget)&&("digitalPrintLearnMoreLink"===ca.id||ca.id===mj.a.pgd)||Z.a.gt)&&this.uNa&&this.oQb(this.uNa)};this.zVi=ca=>{const ra=this.vbi(ca);ra!==Sys.UI.Key.tab&&ra!==Sys.UI.Key.left&&ra!==Sys.UI.Key.right&&ra!==Sys.UI.Key.up&&ra!==Sys.UI.Key.down||this.Sqm(ra)||(ca.preventDefault(),
ca.stopPropagation(),this.Qon(ra))};this.KWf=()=>{this.IXe||(this.IXe=!0,t.ULS.sendTraceTag(25798020,382,50,"User has scrolled styles gallery"),He.a.removeHandler(this.C3,pd.a.scroll,this.KWf))};this.uXf=()=>{t.ULS.sendTraceTag(26005580,382,50,"Learn more click")};this.LYf=ca=>{ca.preventDefault();ca.stopPropagation();v.AFrameworkApplication.va.processAction(Nb.a.$Sh,2);ca.target?(ca="button"===ca.target.tagName.toLowerCase()?ca.target:ca.target.parentNode)&&ca.id!==this.a0b&&(t.ULS.sendTraceTag(25231813,
382,50,"DigitalPrintDialog.OnStyleGalleryItemClick style changed from {0} to {1}",this.a0b,ca.id),this.dDh(ca),this.FNh()):t.ULS.sendTraceTag(24418077,382,10,"DigitalPrintDialog.OnStyleGalleryItemClick e.Target is null!")};this.pol=ca=>{const ra=(new Date).getTime()-this.ASg;Sh.a.instance.pf(nh.a.rol,ra);ca?this.Jeo():(t.ULS.sendTraceTag(25231814,382,50,"DigitalPrintDialog.DigitalPrintDialogHandler Dialog has been closed with the cancel button"),v.AFrameworkApplication.va.processAction(Nb.a.ZSh,2))};
this.Heo=()=>{this.oyo();try{const ca=dE.BUh.EAl(),ra=yH.construct(2,ca,this.a0b,"VerticalWorld",.3,1366,600,330,280,20,dE.BUh.oab.name);v.AFrameworkApplication.He.mj(String.format("{0}/we/GetSwayPreview.ashx?{1}",Eb.App.webServiceBase,v.AFrameworkApplication.rootQuerySignature),2,SM.b(ra),{"Content-Type":"application/json; charset=utf-8","Content-Encoding":"gzip"},!1,2,this.EHn,this.c4i,ra)}catch(ca){t.ULS.sendTraceTag(25268375,382,10,"Failed to generate preview request. Exception: {0}",ca.message)}};
this.EHn=ca=>{var ra=null;({group:ra}=kl.a.d2(ca.data.se)).returnValue?(ra=ra.Responses[0],ra.Succeeded?(this.A3d(ca.data,nh.a.pGo),this.$fb(),this.hnj(this.SUe,ra.PreviewHtml),this.hnj(this.wyd,ra.PreviewHtmlMobile)):this.c4i(null)):t.ULS.sendTraceTag(25231816,382,10,"DigitalPrintDialog.PreviewSuccessCallback Preview response deserialization failed")};this.c4i=()=>{this.pyo();this.TUe.style.background="#E6E6E6";this.zih.style.background="#E6E6E6"};this.Vg=zD.Vg;this.yg="DigitalPrintDialog";t.ULS.sendTraceTag(26005578,
382,50,"Print to Web dialog has been opened and we initiated document force save");this.ogk=WordEditorIntl.WordEditorStrings.L_DigitalPrintTransformSlab;this.mWb=WordEditorIntl.WordEditorStrings.L_DigitalPrintButtonTransform;this.zlk=r;this.nvc=B;this.ze(1,this.ogk);this.Uh(this.mWb,this.pol,null);this.YAm();this.XEo();this.ASg=(new Date).getTime();P&&lr.a.mR(yD.a.digitalPrint,!1,this.asl,this.$rl,null);this.iCm();this.zzm();this.C2m();this.DMf();this.t2m();this.FNh()}get ywa(){return this.Zld}Ahj(b){if(!this.jQe){const h=
(new Date).getTime()-this.ASg;Sh.a.instance.pf(nh.a.qol,h);b?t.ULS.sendTraceTag(25548302,382,15,String.format("We failed to save document with status code {0}",Aj.a[b])):t.ULS.sendTraceTag(25548301,382,50,"We saved document successfully");document.getElementById("digitalPrintSavingDiv").style.display="none";this.X_a.disabled=!1}}YAm(){this.J0b=document.getElementById("digitalPrintStatusMessageDiv");this.kUe=document.getElementById("digitalPrintStatusMessageIconDiv");this.TUe=document.getElementById("swayDesktopPreviewWrapperDiv");
this.SUe=document.getElementById("swayDesktopPreviewHtmlHolder");this.wyd=document.getElementById("swayMobilePreviewHtmlHolder");this.zih=document.getElementById("swayMobilePreviewWrapperDiv");this.C3=document.getElementById("swayGallery");this.C3.setAttribute("tabindex","0");He.a.addHandler(this.C3,pd.a.scroll,this.KWf);this.C3.setAttribute(Se.a.uh,Se.a.Qvh);this.n3=document.getElementById("digitalPrintLearnMoreLink");this.n3.href="https://go.microsoft.com/fwlink/?linkid=871972";He.a.addHandler(this.n3,
pd.a.click,this.uXf);this.Sla=new mb.a;this.jnd=document.getElementById("homeWrapper");this.L5("mainText");document.getElementById("mainText").innerText="OneDriveWOPI"===this.nvc?WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionMSA:WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionAAD}iCm(){this.fu=new mb.a;this.fu.add(new Os("BokehV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBokeh,"swayLightProTitle swayBokehTitle","swayLightProHeading swayBokehHeading"));
this.fu.add(new Os("Regency",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameRegency,"swayVanillaTitle swayRegencyTitle","swayVanillaHeading swayRegencyHeading"));this.fu.add(new Os("PilarV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNamePilar,"swayVanillaTitle swayPilarTitle","swayVanillaHeading swayPilarHeading"));this.fu.add(new Os("Boutique",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBoutique,"swaySwirlTitle swayBoutiqueTitle","swaySwirlHeading swayBoutiqueHeading"));
this.fu.add(new Os("Studio",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStudio,"swaySimplicityTitle swayStudioTitle","swaySimplicityHeading swayStudioHeading"));this.fu.add(new Os("Sierra",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameSierra,"swaySwirlTitle swaySierraTitle","swaySwirlHeading swaySierraHeading"));this.fu.add(new Os("Fete",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFete,"swaySwirlTitle swayFeteTitle","swaySwirlHeading swayFeteHeading"));this.fu.add(new Os("CelestialV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCelestial,"swaySwirlTitle swayCelestialTitle","swaySwirlHeading swayCelestialHeading"));this.fu.add(new Os("TranquilV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameTranquil,"swayVanillaTitle swayTranquilTitle","swayVanillaHeading swayTranquilHeading"));this.fu.add(new Os("Midtown",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMidtown,"swayLightProTitle swayMidtownTitle","swayLightProHeading swayMidtownHeading"));this.fu.add(new Os("Lucent",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameLucent,"swaySimplicityTitle swayLucentTitle","swaySimplicityHeading swayLucentHeading"));this.fu.add(new Os("AerialV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAerial,"swaySwirlTitle swayAerialTitle","swaySwirlHeading swayAerialHeading"));this.fu.add(new Os("StructureV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStructure,"swaySwirlTitle swayStructureTitle","swaySwirlHeading swayStructureHeading"));this.fu.add(new Os("Muse",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMuse,"swayLightProTitle swayMuseTitle","swayLightProHeading swayMuseHeading"));this.fu.add(new Os("Cinema",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCinema,"swaySimplicityTitle swayCinemaTitle","swaySimplicityHeading swayCinemaHeading"));this.fu.add(new Os("MegaV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMega,"swayVanillaTitle swayMegatitle","swayVanillaHeading swayVanillaHeading"));this.fu.add(new Os("ConvergenceV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameConvergence,"swayVanillaTitle swayConvergenceTitle","swayVanillaHeading swayConvergenceHeading"));this.fu.add(new Os("Alloy",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAlloy,"swayLightProTitle swayAlloyTitle","swayLightProHeading swayAlloyHeading"));this.fu.add(new Os("Fluent",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFluent,"swaySimplicityTitle swayFluentTitle","swaySimplicityHeading swayFluentHeading"));this.fu.add(new Os("Aurora",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAurora,"swaySwirlTitle swayAuroraTitle","swaySwirlHeading swayAuroraHeading"));this.fu.add(new Os("Civic",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCivic,"swayLightProTitle swayCivicTitle","swayLightProHeading swayCivicHeading"));this.fu.add(new Os("Reflection",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameReflection,"swaySimplicityTitle swayReflectionTitle","swaySimplicityHeading swayReflectionHeading"))}zzm(){this.g7=
new mb.a;this.g7.add(new Dx("universc","universc","normal","normal"));this.g7.add(new Dx("Miller-Banner_Roman_WebTT","Miller-Banner_Roman_WebTT","normal","normal"));this.g7.add(new Dx("Miller-Banner_Italic_WebTT","Miller-Banner_Italic_WebTT","normal","italic"));this.g7.add(new Dx("Miller-Banner_Bold_Italic_WebTT","Miller-Banner_Bold_Italic_WebTT","bold","italic"));this.g7.add(new Dx("QuireSans-Thin","QuireSans-Thin","extrathin","normal"));this.g7.add(new Dx("Posterama-Regular","Posterama-Regular",
"normal","normal"));this.g7.add(new Dx("Heron_Serif-Regular_WebTT","Heron_Serif-Regular_WebTT","normal","normal"));this.g7.add(new Dx("Benton_Modern-Roman_WebTT","Benton_Modern-Roman_WebTT","normal","normal"));this.g7.add(new Dx("ArialNova","ArialNova","normal","normal"));this.g7.add(new Dx("TisaOffcSerifPro-Thin","TisaOffcSerifPro-Thin","normal","normal"));this.g7.add(new Dx("QuireSans-Regular","QuireSans-Regular","normal","normal"));this.g7.add(new Dx("RockwellNova","RockwellNova","normal","normal"));
this.g7.add(new Dx("SabonNRegLT","SabonNRegLT","normal","normal"));this.g7.add(new Dx("DaytonaThin","DaytonaThin","100","normal"))}C2m(){const b=document.createElement("style");b.setAttribute("type","text/css");let h="";for(const r of this.g7)h+=String.format(this.zlk,r.fontFamily,r.I7n,r.fontWeight,r.fontStyle);b.innerText=h;this.jnd.appendChild(b)}t2m(){const b=document.createElement("style");b.setAttribute("type","text/css");const h=String.format(".{0} {{ background: url({1}) no-repeat; }}","swayPreviewFrameBackground",
Nd.a.wg("SwayPreviewFrame.svg")),r=String.format("@media screen and (-ms-high-contrast: active) {{ .{0} {{ background: url({1}) no-repeat; -ms-high-contrast-adjust: none; }}}}","swayPreviewFrameBackground",Nd.a.wg("SwayPreviewFrameHC.svg"));b.innerText=h+r;Z.a.Fr&&(b.innerText+=".AppRtl .swayGallery { margin-right: -15px; }");this.jnd.appendChild(b)}vbi(b){return b?b.keyCode:window.event.keyCode}hide(){this.B7f();super.hide()}B7f(){if(this.C3&&!this.jQe){for(let b=0;b<this.Sla.count;b++)He.a.removeHandler(this.Sla.J(b),
pd.a.click,this.LYf),He.a.removeHandler(this.Sla.J(b),pd.a.gi,this.hZi);He.a.removeHandler(this.C3,pd.a.gi,this.zVi);He.a.removeHandler(this.C3,pd.a.focus,this.yVi);He.a.removeHandler(this.n3,pd.a.click,this.uXf);this.IXe||He.a.removeHandler(this.C3,pd.a.scroll,this.KWf);this.jQe=!0}}DMf(){const b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",Nd.a.qMk());this.jnd.appendChild(b);for(const h of this.fu)this.tJd(this.C3,h);this.I1(this.C3);
this.dDh(this.C3.firstChild);this.C3.firstChild.focus();He.a.addHandler(this.C3,pd.a.gi,this.zVi);He.a.addHandler(this.C3,pd.a.focus,this.yVi)}tJd(b,h){const r=document.createElement("button");r.className="swayGalleryItem swayClip136x90 swayImageBorderButton";r.setAttribute(Se.a.ifb,Se.a.xM);r.setAttribute("title",h.title);r.setAttribute(Se.a.uh,Se.a.Tvh);r.id=h.styleName;b.appendChild(r);b=document.createElement("img");b.className=String.format("swayPublish_Sway{0}StyleBlank_136x90x32",h.styleName);
b.src=Nd.a.wg("swayPublish.png");b.setAttribute(Se.a.uh,Se.a.wz);b.setAttribute("unselectable","on");b.setAttribute(Se.a.uA,Se.a.xp);b.id=h.styleName+"img";r.appendChild(b);b=document.createElement("label");b.innerText=h.title;b.className=h.TKo;b.setAttribute(Se.a.uA,Se.a.xp);b.setAttribute("unselectable","on");b.setAttribute(Se.a.uh,Se.a.wz);r.appendChild(b);const B=document.createElement("label");B.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintHeadingText;B.className=h.$tm;B.setAttribute(Se.a.uA,
Se.a.xp);b.setAttribute("unselectable","on");B.setAttribute(Se.a.uh,Se.a.wz);r.appendChild(B);He.a.addHandler(r,pd.a.click,this.LYf);He.a.addHandler(r,pd.a.gi,this.hZi);this.Sla.add(r)}Qon(b){const h=this.ywa;this.DHl(b,h,!v.AFrameworkApplication.isRtl)||this.FHl(b,h,!v.AFrameworkApplication.isRtl)||this.AHl(b,h)||this.BHl(b,h)}Sqm(b){return b===Sys.UI.Key.tab?(this.ywa&&this.ywa!==this.uNa&&(this.ywa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.Zld=this.uNa),!0):!1}DHl(b,
h,r){return b===Sys.UI.Key.right&&r||b===Sys.UI.Key.left&&!r?(b=(b=h.nextSibling)||this.C3.firstChild,this.oQb(b),!0):!1}FHl(b,h,r){return b===Sys.UI.Key.left&&r||b===Sys.UI.Key.right&&!r?(b=(b=h.previousSibling)||this.C3.lastChild,this.oQb(b),!0):!1}AHl(b,h){return b===Sys.UI.Key.down?(b=this.Sla.indexOf(h),h=b+2,h<this.Sla.count?(b=this.Sla.J(h))&&this.oQb(b):(h=b%2+1,h=2<=h?0:h,(b=this.Sla.J(h))&&this.oQb(b)),!0):!1}BHl(b,h){b===Sys.UI.Key.up&&(b=this.Sla.indexOf(h),h=b-2,0<=h?(b=this.Sla.J(h))&&
this.oQb(b):(h=b?20+b-1:this.Sla.count-1,(b=this.Sla.J(h))&&this.oQb(b)))}oQb(b){this.ywa&&this.ywa.id!==this.uNa.id&&(this.ywa.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.Zld=b;this.ywa.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonFocused");this.ywa.focus()}XEo(){this.X_a.className="WACDialogButtonNormal swayPrintToWebButton";this.X_a.setAttribute("tabindex","0");this.aA.className="WACDialogButtonNormal swayCancelButton";
this.aA.setAttribute("tabindex","0");this.X_a.disabled=!0}dDh(b){this.ywa&&(this.ywa.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.uNa&&(this.uNa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",this.uNa.setAttribute(Se.a.ifb,Se.a.xM));this.a0b=b.id;this.uNa=b;this.uNa.setAttribute(Se.a.ifb,Se.a.xp);this.Zld=b;this.ywa.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonSelected")}FNh(){Wg.a.instance.Wb(new Me.a(2,
1,50,this.Heo))}hnj(b,h){b.innerHTML=h}Jeo(){t.ULS.sendTraceTag(25231818,382,50,String.format("DigitalPrintDialog.SendPublishRequest Sending publish request for style {0}",this.a0b));v.AFrameworkApplication.va.processAction(Nb.a.aTh,2);const b=String.format("{0}/we/SwayPublish.ashx?{1}&parentSessionId={2}&styleId={3}",Eb.App.webServiceBase,v.AFrameworkApplication.rootQuerySignature,v.AFrameworkApplication.userSessionId,this.a0b);Qd.a.openWindow(4,b)}A3d(b,h){Sh.a.instance.pf(h,+b.aU-+b.$H)}pyo(){var b=
WordEditorIntl.WordEditorStrings.L_DigitalPrintPreviewFailureMessage;this.$fb();this.J0b.innerText=b;this.J0b.style.display="block"}oyo(){this.$fb();this.kUe.style.display="block";this.J0b.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintGeneratingPreview;this.J0b.style.display="block"}$fb(){this.TUe.style.background="";this.wyd.style.background="";dc.a.U_(this.SUe);dc.a.U_(this.wyd);this.J0b.style.display="none";this.kUe.style.display="none"}static get BUh(){return null!=dE.ryg?dE.ryg:dE.ryg=
Ma.a.instance.Oa("Box4.DocumentContentExtractor.IDocumentContentExtractor")}}Object(m.a)(dE,"DigitalPrintDialog",Pe.a,[]);class zH{constructor(b,h){this._context=this.Hk=null;this.Vve=0;this.Rhd=!1;this.rhh=null;this.digitalPrint=(r,B,P,ca,ra)=>{if(1===P)return v.AFrameworkApplication.EF?8:32;this.rhh=ra.SourceControlId;if(v.AFrameworkApplication.K.$("IsAnonymousUser"))return t.ULS.sendTraceTag(34373826,382,50,"DigitalPrintActor.DigitalPrint: Anonymous user tried to click on Print to Web feature."),
this.yqb(WordEditorIntl.WordEditorStrings.L_DigitalPrintSignInNeeded),32;this._context=B;if(zH.zQm())return t.ULS.sendTraceTag(34373828,382,50,"DigitalPrintActor.DigitalPrint: MSA user clicked on Print to Web feature."),this.bbf(),32;switch(this.Vve){case 1:t.ULS.sendTraceTag(34373829,382,50,"DigitalPrintActor.DigitalPrint: AAD user with Sway license clicked again on Print to Web feature.");this.bbf();break;case 2:t.ULS.sendTraceTag(34373830,382,50,"DigitalPrintActor.DigitalPrint: AAD user without Sway license clicked again on Print to Web feature.");
this.yqb(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense);break;case 0:this.Rhd=!1,this.Hk=(new oj.a).create(),this.Hk.message=WordEditorIntl.WordEditorStrings.L_DigitalPrintCheckingSwayLicense,this.Hk.JL(CommonUIStrings.l_DefaultDialogTitle,this.aXk,null),v.AFrameworkApplication.He.mj(String.format("{0}/we/CheckSwayLicense.ashx?{1}",Eb.App.webServiceBase,v.AFrameworkApplication.rootQuerySignature),2,null,null,!1,2,this.cXk,this.bXk,null)}return 32};this.aXk=()=>{this.Rhd=!0;t.ULS.sendTraceTag(34373831,
382,50,"DigitalPrintActor.CheckSwayLicenseCanceled: Canceling license check...")};this.cXk=r=>{if(!this.Rhd){this.Hk.close();var B=null;this.A3d(r.data,nh.a.oGo);({group:B}=kl.a.d2(r.data.se)).returnValue?(r=B.Responses[0],t.ULS.sendTraceTag(34373832,382,50,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization succeeded. HasLicense: {0}, Succeeded: {1}",r.HasLicense,r.Succeeded),r.Succeeded?(this.Vve=r.HasLicense?1:2,2===this.Vve?this.yqb(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense):
this.bbf()):this.yqb(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown)):(t.ULS.sendTraceTag(34373833,382,10,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization failed"),this.yqb(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))}};this.bXk=r=>{this.Rhd||(this.Hk.close(),t.ULS.sendTraceTag(34373834,382,15,"DigitalPrintActor.CheckSwayLicenseFailCallback: CheckSwayLicense request failed!"),this.A3d(r.data,nh.a.nGo),this.yqb(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))};
this.ga=b;this.U6=h}Tb(){v.AFrameworkApplication.cZ?t.ULS.sendTraceTag(26093080,382,50,"Disabling Digital Print button because document has protection."):v.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&v.AFrameworkApplication.K.$("DisablePrint")?t.ULS.sendTraceTag(26093081,382,50,"Disabling Digital Print button because print is disabled."):(this.ga.fb(Nb.a.digitalPrintToSway,yc.a.view,this.digitalPrint,4),this.ga.fb(Nb.a.$Sh,yc.a.view,cd.ActionManager.gR,4),this.ga.fb(Nb.a.aTh,yc.a.view,
cd.ActionManager.gR,4),this.ga.fb(Nb.a.ZSh,yc.a.view,cd.ActionManager.gR,4),this.ga.fb(fb.a.pLd,yc.a.view,cd.ActionManager.gR,4))}bbf(){t.ULS.sendTraceTag(36824994,382,50,"DigitalPrintActor.CreateDigitalPrintDialog: Opening the DigitalPrintDialog. Button {0} clicked.",this.rhh);new dE(this._context,this.ga,v.AFrameworkApplication.K.kb("SwayFontDownloadUrlTemplate"),v.AFrameworkApplication.K.kb("FileSource"))}yqb(b){const h=new Tf.StandardDialog;h.Cd=0;h.jka(CommonUIStrings.l_DefaultDialogTitle,b,
null)}A3d(b,h){Sh.a.instance.pf(h,+b.aU-+b.$H)}static zQm(){return"OneDriveWOPI"===v.AFrameworkApplication.K.kb("FileSource")}}Object(m.a)(zH,"DigitalPrintActor",null,[]);class hK{constructor(){this.qkh=null}xLi(){t.ULS.sendTraceTag(25007841,375,50,"Do not check for this critique type triggered")}nDj(b){if(!b)return t.ULS.sendTraceTag(25007842,375,15,"Error range is null"),!1;if(!this.GEi(b.errorDetails))return!1;this.qkh=Object(Ra.a)(bp.a,b.errorDetails).typeId;return!0}B$c(b){return this.GEi(b)?
Object(Ra.a)(bp.a,b).typeId===this.qkh:!1}GEi(b){if(!b)return t.ULS.sendTraceTag(25007843,375,15,"No ErrorDetails found"),!1;b=Object(Ra.a)(bp.a,b);return b?b.token&&b.typeId?!0:(t.ULS.sendTraceTag(25007873,375,50,"Token is null: {0}",!b.token),!1):(t.ULS.sendTraceTag(25007872,375,50,"ErrorDetails is null"),!1)}}Object(m.a)(hK,"DoNotCheckThisCritiqueTypeStrategy",null,[327]);class iK extends Pe.a{constructor(b,h,r){super(!1,!1,!0);this.oc=b;this.loa=r;this.s1j="DocumentChoiceGroup";this.$Tg="EmbededContent";
this.AZg="HyperLink";this.RIe=r.cab;b={["id"]:"ExternalContentDefaultSettingsDialog",["bodyControls"]:this.HFb()};this.TXj=this.iAl.bind(this);this.ze(1,WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogSave);this.Uh(WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogTitle,this.TXj,b)}HFb(){const b=Array(2);b[0]={["key"]:this.$Tg,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryContent};b[1]={["key"]:this.AZg,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryHyperLink};
const h={};h.documentChoiceGroupProps={["id"]:this.s1j,["defaultSelectedKey"]:this.RIe?this.$Tg:this.AZg,["label"]:WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogDescription,["options"]:b};h.learnMoreLinkText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMore;h.learnMoreURL=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMoreUrl;h.externalContentDefaultSettingsDialogInformationText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogInformation;
return h}iAl(b,h){1===b?(this.RIe!==h.isExternalContentSelected&&(b=h.isExternalContentSelected?qb.a.zPa:qb.a.Xhb,this.oc.processAction(b,2),this.RIe=h.isExternalContentSelected,ea.a.sendTelemetryEvent(Object.assign(new ka.a,{name:"Office.Word.Online.ExternalContent.ExternalContentDefaultSettings",dataFields:[Object.assign(new ha.a,{name:"ActionId",int64:b})]}))),this.loa.vao(h.isExternalContentSelected)):0===b&&t.ULS.sendTraceTag(556565635,324,50,"Cancel Clicked in ExternalContentDefaultSettingsDialog")}}
Object(m.a)(iK,"ExternalContentDefaultSettingsDialog",Pe.a,[]);class Ps{constructor(b,h,r,B,P){this.$L=Ma.a.instance.resolve("Common.IReactContextualUILauncher");this.mtb=qg.a.On;this.Wlc=()=>{const ca=Array(1);ca.push("ExternalContent");var ra=Ma.a.instance.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider").eQa();ra=Object.assign(new SD.a,{x:ra.x,y:ra.y});this.$L.showFloatie(ra,ca,1);return 32};this.VHb=()=>{this.$L.M0&&this.$L.dismissFloatie();return 32};this.R5i=(ca,ra,Qa,tb,Mb)=>
{if(ra="object"===typeof Mb?Mb:null)ca===qb.a.t4f?(ca=Ps.aYa!==qb.a.zPa&&Ps.aYa!==qb.a.Xhb,ra[this.mtb]=Ps.aYa===qb.a.zPa||ca):ca===qb.a.u4f&&(ra[this.mtb]=Ps.aYa===qb.a.Xhb);return 32};this.uZh=(ca,ra,Qa)=>{1!==Qa&&(ca===qb.a.Xhb&&Ps.aYa!==qb.a.Xhb?(t.ULS.sendTraceTag(575813832,324,50,"ExternalContentPasteHyperlinkOption clicked"),this.Qm.undo()&&(ra=new mw.a(1,v.AFrameworkApplication.isRtl),ra.M3c="ExternalContent",Ps.Whb.S5c(ra))):ca===qb.a.zPa&&Ps.aYa!==qb.a.zPa&&(t.ULS.sendTraceTag(575813833,
324,50,"ExternalContentPasteEmbededWebContentOption clicked"),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1),this.SUg.y7i()),Ps.aYa=ca);ea.a.sendTelemetryEvent(Object.assign(new ka.a,{name:"Office.Word.Online.ExternalContent.Floatie",dataFields:[Object.assign(new ha.a,{name:"behavior",string:Qa.toString()}),Object.assign(new ha.a,{name:"ActionId",int64:ca})]}));return 32};this.ga=b;this.Qm=h;this.SUg=B;this.O7j=P;this.SXj=this.jAl.bind(this);
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1);this.SUg.t9i(()=>{this.reset()})}Tb(){this.ga.fb(qb.a.t4f,yc.a.view,this.R5i,97);this.ga.fb(qb.a.u4f,yc.a.view,this.R5i,97);this.ga.fb(qb.a.tZh,yc.a.view,this.SXj,1028);this.ga.fb(qb.a.zPa,yc.a.view,this.uZh,1028);this.ga.fb(qb.a.Xhb,yc.a.view,this.uZh,1028);this.O7j||(this.ga.fb(qb.a.Wlc,yc.a.view,this.Wlc,96),this.ga.fb(qb.a.VHb,yc.a.view,this.VHb,96))}Gwo(b){new iK(this.ga,b,Ps.loa)}jAl(b,h,r){1!==
r&&this.Gwo(Ps.aYa);return 32}static get Whb(){return null!=Ps.Lyg?Ps.Lyg:Ps.Lyg=Ma.a.instance.resolve("Box4.IExternalContentFloatieEventSource")}static get loa(){Ps.uBa||(Ps.uBa=Ma.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return Ps.uBa}reset(){Ps.aYa=null!=Ps.loa?Ps.loa.cab?qb.a.zPa:qb.a.Xhb:qb.a.zPa}}Ps.aYa=qb.a.zPa;Ps.uBa=null;Object(m.a)(Ps,"ExternalContentActor",null,[]);class eE extends Mg{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc){super(b,h,r,B,P,ca,
ra,Qa,tb,Mb,Zb,jc);this.NVc=Gc;this.BNd=!1;this.X_g=null}n6c(){this.BNd||(super.n6c(),this.BNd=!0)}Vne(){this.BNd&&(super.Vne(),eE.NVh&&this.X_g&&eE.NVh.removeHandler(X.a.Kua,this.X_g),this.BNd=!1)}OSb(){if(this.NVc){this.xva.M0&&this.xva.dismissFloatie();const b=new mw.a(0,v.AFrameworkApplication.isRtl);b.location=this.z6a.eQa();this.showFloatie(null,b)}else this.xva.M0&&v.AFrameworkApplication.va.processAction(qb.a.VHb,2),v.AFrameworkApplication.va.processAction(qb.a.Wlc,2);this.hec=!1}dismissFloatie(b){!this.DGe&&
(b&&(this.z6a.QCf(),this.oEj()),this.xva.M0||this.gMa)&&(this.gMa=!b,this.Vne(),this.NVc?this.xva.dismissFloatie():v.AFrameworkApplication.va.processAction(qb.a.VHb,2))}showFloatie(b,h){h||(h=new mw.a(0,v.AFrameworkApplication.isRtl));h.location||(h.location=this.z6a.eQa());if(!h.location)return!1;this.gMa&&(this.gMa=!1,this.n6c());this.NVc?(b=Array(1),b.push("ExternalContent"),this.xva.showFloatie(this.z6a.eQa(),b,1)):v.AFrameworkApplication.va.processAction(qb.a.Wlc,2);return!0}pLc(){if(!this.hec){const b=
new Me.a(3,1,this.SPh,()=>{this.OSb()},196);Wg.a.instance.Wb(b);this.hec=!0}}Nja(){this.NVc?this.xva.M0&&this.xva.dismissFloatie():v.AFrameworkApplication.va.processAction(qb.a.VHb,2);this.pLc()}RPb(){this.NVc?this.xva.M0&&this.xva.dismissFloatie():v.AFrameworkApplication.va.processAction(qb.a.VHb,2);this.pLc()}static get NVh(){return null!=eE.wyg?eE.wyg:eE.wyg=Ma.a.instance.resolve("Box4.IEditStateEventManager")}}Object(m.a)(eE,"ExternalContentFloatieEventManager",Mg,[]);class fE extends nw{constructor(b,
h,r,B,P){super(b,h,r,B,P)}ZAh(){if(!this.hb||!this.hb.ib||!this.hb.ib.lb)return t.ULS.sendTraceTag(575813836,307,15,"Selection is null when we try to calculate external content floatie position"),null;var b=this.hb.ib.lb.Pa,h=!b.cpBegin&&!b.cpEnd;let r=b.node;if(r&&h&&!r.JJ){do r=this.nfi(r);while(r&&!r.JJ&&Object(Ib.a)(oi.AParagraphNode,r)&&!r.characterData.trim().length)}let B="";const P=Object(Ra.a)(oi.AParagraphNode,r);P&&(B=P.characterData.length===b.cpBegin||h?P.characterData.trimEnd():P.characterData.substring(0,
b.cpBegin).trimEnd());h=P?B.length:b.cpBegin;b=Object.assign(new Nz,{Pya:Object(Ra.a)(133,(P?Object(Ra.a)(133,P):Object(Ra.a)(133,r))||b.node),Zhc:h});return this.Tqf(b)}rai(b,h){let r=null;const B=Object(Ra.a)(181,b.Pya.zj(h.$b));if(!B)return null;if(Object(Ib.a)(oi.AParagraphNode,b.Pya)){const P=Object(Ra.a)(oi.AParagraphNode,b.Pya);if(P.ZQ){if(b=Object(Ra.a)(at.a,ke.ParagraphReader.gQa(P)))(b=Object(Ra.a)(181,b.zj(h.$b)))&&(r=b.getBounds()),r&&(r.height+=fE.C1h,r.width-=fE.VGl);return r}h=Object(Ra.a)(117,
B);if(!h)return null;try{if(r=this.lua.O_(b.Zhc,h,0<b.Zhc,!1,!1,!1))r.height+=fE.C1h}catch(ca){t.ULS.sendTraceTag(575813837,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",ca),r=null}}r||(r=B.getBounds());return r}}fE.C1h=65;fE.VGl=100;Object(m.a)(fE,"ExternalContentFloatiePositionProvider",nw,[]);class jK{constructor(b,h,r,B,P,ca){this.U9f=(ra,Qa,tb)=>{if(1===tb)return v.AFrameworkApplication.cZ||v.AFrameworkApplication.EF||v.AFrameworkApplication.Dpa||kc.SessionStatusManager.instance.Zj?
8:32;if(ra===Nb.a.print)ra=1;else if(ra===qb.a.BMc)ra=0;else if(ra===qb.a.bMd)ra=2;else return 8;return this.eao(ra)};this.ga=b;this.U6=h;this.cXb=r;this.a1j=B;this.OSg=P;this.hYj=ca;this.YI=Ma.a.instance.Ta("Common.ISystemInitiatedFeedback")}Tb(){v.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&this.a1j||v.AFrameworkApplication.EF?(document.body.classList.add("WACStopPrinting"),""!==this.OSg&&this.hYj.gxo(this.OSg)):(this.ga.ra(Nb.a.print,yc.a.application,this.U9f),this.ga.ra(qb.a.BMc,yc.a.application,
this.U9f),this.ga.ra(qb.a.bMd,yc.a.application,this.U9f))}eao(b){const h=v.AFrameworkApplication.rootQuerySignature;if(!h||""===h||Eb.App.zd&&Eb.App.zd.nC.Jo)return 8;this.cXb.jZd=!1;this.cXb.LKj.start();lr.a.mR(yD.a.conversion,!0,Object(z.a)(this.cXb,this.cXb.u5n,"requestFileDownload"),Object(z.a)(this.cXb,this.cXb.EMb,"onForceSaveFailed"),b);this.dre();return 32}dre(){v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadCopyInterceptEnabled",!1)&&null!=this.YI&&(t.ULS.sendTraceTag(509145741,
306,50,"DownloadCopyIntercept logged for: DownloadAsPDF"),this.YI.execute(b=>b.logActivity("DownloadCopyIntercept",null)))}}Object(m.a)(jK,"FileDownloadActor",null,[]);class kK extends Cf{constructor(b,h=null,r=null){super(b,!0,h,!1,void 0,r)}get pAf(){return null}get N5a(){return this.IZd?CommonUIStrings.l_DownloadAsPdfDialog_CopyALinkText_EditPermissions:v.AFrameworkApplication.k1a?CommonUIStrings.l_DownLoadACopyDialogMessage:CommonUIStrings.l_PrintDialogDocumentIsPrinting}get bfc(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get ACd(){return null}get IZd(){return"VersionHistory"===
this.x6e?!1:v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DownloadAsPdfCopyLinkEnabled",!1)}l3d(){t.ULS.sendTraceTag(508875466,324,50,"Download as PDF dialog displayed");v.AFrameworkApplication.Oia("tcopypdf;ccopypdf")}}Object(m.a)(kK,"DownloadAsPdfDialog",Cf,[]);class Zv{constructor(){this._url=this.wv=null;this.qZa=this.pZa=0;this.xeb=!1;this.makeRequest=()=>{v.AFrameworkApplication.He.mj(this._url,1,null,null,!0,2,this.QMb,this.yqa,null)};this.QMb=b=>{Zv.C7c();const h=
b.data.Oja;let r=null;if(h)try{r=h.selectSingleNode("/docdata/status")}catch(B){}r&&("InProgress"===r.text&&22>this.pZa++||"ServiceBusy"===r.text&&3>this.qZa++)?this.vIa(1E3*(this.pZa+this.qZa)):this.wv(!0,r?r.text:null,b.data)};this.yqa=b=>{this.xeb?(Zv.sCa||(Zv.kcb=new Date,Zv.sCa=!0,Zv.uT=1),18E4>(new Date).getTime()-Zv.kcb.getTime()?this.retryOnFailure(4<=Zv.uT?2E4:1E3):this.k3a(b.data)):4>Zv.uT?this.retryOnFailure(2E3):this.k3a(b.data)}}send(b,h,r){this._url=b;this.wv=h;this.xeb=r;this.makeRequest(null)}vIa(b){b=
new Me.a(2,1,b,this.makeRequest);v.AFrameworkApplication.lc.Wb(b)}retryOnFailure(b){this.vIa(b);Zv.uT++}k3a(b){this.wv(!1,null,b)}static J8(b,h){(new Zv).send(b,h,!1)}static C7c(){Zv.sCa=!1;Zv.uT=0}}Zv.kcb=null;Zv.sCa=!1;Zv.uT=0;Object(m.a)(Zv,"ClientRequestWithRetry",null,[]);class lK extends bf{constructor(b){super(b,void 0,v.AFrameworkApplication.k1a)}get N5a(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogOdtReady}get bfc(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLinkSuggestion}get d_c(){return"DownloadOdtLink"}get buttonText(){return CommonUIStrings.l_Download}get YKc(){return v.AFrameworkApplication.k1a?
"UIFontDialogTextLarge":null}l3d(){t.ULS.sendTraceTag(7628378,324,50,"ODT download dialog displayed")}dNf(){t.ULS.sendTraceTag(7628379,324,50,"ODT download dialog link clicked")}B_c(){t.ULS.sendTraceTag(19462216,324,50,"ODT download dialog button clicked")}get KZc(){return vC.VSi}get nmb(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLearnMoreLinkText}get bPi(){return!v.AFrameworkApplication.k1a}}Object(m.a)(lK,"DownloadAsOdtDialog",bf,[]);class mK{constructor(b,h){this.dbb=this.i_a=
null;this.o8a=r=>{1===Eb.App.za.state||this.i_a||(this.i_a=(new oj.a).create(),r=r.customData,this.f4m(r),1===r?this.i_a.message=this.pub.fR.isEnabled?v.AFrameworkApplication.k1a?CommonUIStrings.l_DirectPrintPreparingPDF:WordEditorIntl.WordEditorStrings.L_DirectPrintWait:WordEditorIntl.WordEditorStrings.l_PrintPDFWait:r?2===r&&(this.i_a.message=WordEditorIntl.WordEditorStrings.l_ConversionToODTWait):this.i_a.message=WordEditorIntl.WordEditorStrings.l_PrintPDFWait,this.i_a.JL(CommonUIStrings.l_DefaultDialogTitle,
this.cancelButton,null))};this.cancelButton=()=>{this.jZd=!0};this.W9=(r,B,P)=>{this.Cjg("Success. Save and Conversion Complete.");P=new Xa.QueryStringBuilder(P.request.get_url());v.AFrameworkApplication.nga(P);P=P.toString();const ca=this.J5n(P);this.Vna(ca);2!==ca&&this.pub.nIn();!r||B?this.T5(ca):this.jZd?(this.jZd=!1,this.dbb=null):(this.dbb&&v.AFrameworkApplication.lc.ff(this.dbb),this.dbb=null,this.Zpl(P,ca))};this.jZd=!1;this.pub=b;this.LKj=h.rSa("UserAction","WordEditorForceSaveAndPrint")}Vna(b){this.i_a&&
(this.p4m(b),this.i_a.close(),this.i_a=null)}T5(b){if(1!==Eb.App.za.state){this.i5m(b);const h=new Tf.StandardDialog;h.Cd=0;h.ze(1,CommonUIStrings.l_DialogClose);h.vx(0,"",1===b?WordEditorIntl.WordEditorStrings.l_PrintError:WordEditorIntl.WordEditorStrings.l_ConversionError,null,!0)}}cuf(b){switch(b){case 0:return"downloadpdf";case 1:return"printpdf";case 2:return"odt";default:return t.ULS.sendTraceTag(7628383,324,10,"Unknown request PDF type {0}",b),"printpdf"}}u5n(b){var h=v.AFrameworkApplication.rootQuerySignature;
h&&""!==h?(h="WordViewer/request."+this.Zjf(b)+"?"+h+"&type="+this.cuf(b)+"&rndm="+Bb.a.create(),1===b&&this.pub.yvo()&&(h+="&useNamedAction=1"),v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("CustomFontReadModePDFIsEnabled")&&hp.FontUtils.hie()&&(1===b||!b)&&(0<hp.FontUtils.CPh&&(h+="&cfcVer="+hp.FontUtils.CPh),hp.FontUtils.BPh&&(h+="&cfcUrl="+hp.FontUtils.BPh),hp.FontUtils.DPh&&(h+="&cfcEncData="+hp.FontUtils.DPh)),Zv.J8(h,this.W9),this.dbb||(this.dbb=new Me.a(2,1,500,this.o8a),this.dbb.customData=
b,v.AFrameworkApplication.lc.Wb(this.dbb))):(this.Cjg("failed. QuerySignature is empty."),this.T5(b))}Zjf(b){return 2===b?"odt":"pdf"}EMb(){this.Cjg("Failed. force save failed.")}J5n(b){if(0<b.indexOf("&type=downloadpdf"))return 0;if(0<b.indexOf("&type=printpdf"))return 1;if(0<b.indexOf("&type=odt"))return 2;t.ULS.sendTraceTag(7628384,324,10,"Could not get requestType from uri:{0}",b);return 1}Cjg(b){t.ULS.sendTraceTag(7628385,328,50,"stopping the perf counter for forcesave and print. [StoppingReason:{0}]",
b);this.LKj.stop()}Zpl(b,h){const r=new mb.a;r.add("access_token");r.add("access_token_ttl");1!==Eb.App.za.state&&(1===h?this.pub.Rxo(b,r):h?2===h&&new lK(b):new kK(b))}dispose(){}f4m(b){switch(b){case 0:t.ULS.sendTraceTag(38114782,203,50,"Download Attempt: Pdf");break;case 2:t.ULS.sendTraceTag(38114783,203,50,"Download Attempt: Odt");break;case 1:t.ULS.sendTraceTag(38114784,203,50,"Download Attempt: PrintPdf");break;default:t.ULS.sendTraceTag(38114785,203,15,"Download Attempt: {0}",b)}}p4m(b){switch(b){case 0:t.ULS.sendTraceTag(38114786,
203,50,"Download Cancelled: Pdf");break;case 2:t.ULS.sendTraceTag(38114787,203,50,"Download Cancelled: Odt");break;case 1:t.ULS.sendTraceTag(38114816,203,50,"Download Cancelled: PrintPdf");break;default:t.ULS.sendTraceTag(38114817,203,15,"Download Cancelled: {0}",b)}}i5m(b){switch(b){case 0:t.ULS.sendTraceTag(38114818,203,15,"Download Failed: Pdf");break;case 2:t.ULS.sendTraceTag(38114819,203,15,"Download Failed: Odt");break;case 1:t.ULS.sendTraceTag(38114820,203,15,"Download Failed: PrintPdf");break;
default:t.ULS.sendTraceTag(38114821,203,15,"Download Failed: {0}",b)}}}Object(m.a)(mK,"FileDownloadManager",null,[]);class gE{get key(){return"LIST"}get $w(){return Box4Intl.Box4Strings.l_ListContentTitle}roc(b){let h=null;const r=gE.Jd.vw(b);if(!r)return{returnValue:!1,Bna:h};b=this.j3l(b,r);h=Object.assign(new Rx.a,{$G:this.key,contentId:b.listId,contentObject:b});return{returnValue:!0,Bna:h}}WFb(b,h){b=b.contentObject;const r=this.S1l(b.Tx),B=new Vh.a;h?(h=h.contentObject,h.level!==b.level?(B.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,
b.level)),B.add(r)):h.id.equals(b.id)&&h.Tx.listType===b.Tx.listType||B.add(r)):(B.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),B.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,b.level)),B.add(r));return B.toArray().join(" ")}S1l(b){let h="";const r=b.listStyle;if(!b.listType)h=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,b.Qu);else if(1===b.listType)switch(r){case 1:h=this.Kzh;break;case 2:h=this.IPk;break;case 3:h=this.JPk;break;default:h=
this.Kzh}return h}static get Jd(){return null!=gE.pEg?gE.pEg:gE.pEg=Ma.a.instance.resolve("Box4.List.IListReader")}}Object(m.a)(gE,"ListDetailsProvider",null,[720,415]);class nK{constructor(){this.Tx=this.listId=this.id=null;this.level=0}}Object(m.a)(nK,"ListItemInfo",null,[]);class oK extends gE{constructor(b){super();this.d7=b}get Kzh(){return WoncaIntl.WoncaStrings.L_BulletStyle1}get IPk(){return WoncaIntl.WoncaStrings.L_BulletStyle2}get JPk(){return WoncaIntl.WoncaStrings.L_BulletStyle3}j3l(b,
h){const r=this.d7.EB(b);return Object.assign(new nK,{id:b.currentNode.id,listId:new V.a(Bb.a.nil,r.listID),Tx:h,level:r.level+1})}}Object(m.a)(oK,"FlatListDetailsProvider",gE,[]);class pK{constructor(b,h){this.ga=b;this.Hf=h}get qc(){return null!=this.YJg?this.YJg:this.YJg=Ma.a.instance.Oa("Box4.Styles.IWACStyleReader")}Tb(){}}Object(m.a)(pK,"FormattingActor",null,[]);var TM=c(1180),TE=c(1343),UM=c(1731);class qK{constructor(b,h,r,B,P,ca,ra,Qa){this.Gb=b;this.Yik=h;this.Lc=r;this.Cvb=B;this.ap=P;
this.Ca=ca;this.rd=ra;this.N8j=Qa}ehc(b,h,r,B,P,ca,ra){t.ULS.sendTraceTag(574358090,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ra.oi});this.Cvb.then(()=>{this.Yik(b.data.se);t.ULS.sendTraceTag(574358091,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper load success: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ra.oi});ra.stop()})}yqa(b,h,r,B,P,ca,ra){ca.stop();P();ra?(this.PCn(h,r),t.ULS.sendTraceTag(574377989,
3001,15,"{0}",{["message"]:b,["id"]:Id.ImageReader.jQa(h.Gb)})):t.ULS.sendTraceTag(574377990,3001,15,"{0}",{["message"]:b,["id"]:Id.ImageReader.jQa(h.Gb)})}Lth(b,h){b.Be(CG.a.daf,NF.documentXmlToJson.toString());if(this.rd&&this.rd.isFeatureEnabled(50)){var r=this.ap.rn(h.ik);r=this.ap.ui(r);b.Be(Xg.a.Qs,TE.a[r]);5===r&&this.cEk(b,h)}this.N8j&&b.Be(Xg.a.qXd,"true")}tnh(){return new UM.a(this.Gb.id,this.Gb)}fUd(){return WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError}PCn(b,h){const r=
this.Lc.Pc(7,Nb.a.$mm);r.Db(h);b.Gb.setValue(Mc.a.VIh,!0);r.dispose()}cEk(b,h){var r=h.ik;h=this.ap.rn(r);var B=r.node;const P=(r=this.ap.CFa(h,B.Mc,!1))?this.ap.wFa(r):"";if(""===P)throw t.ULS.sendTraceTag(572555911,3001,10,"Could not find original dataBlobId on picture node."),Error.argumentNull("OriginalObjectDataBlobId");B=(B=this.ap.CFa(h,B.Mc,!0))?this.ap.wFa(B):"";b.Be(Xg.a.vhc,P);b.Be(Xg.a.PKj,B);r=r.ja(gi.a.y_h,"");""!==r&&b.Be(Xg.a.extension,r);b.Be(Xg.a.width,this.ap.oF(h).toString());
b.Be(Xg.a.height,this.ap.JG(h).toString());b.Be(Xg.a.U3c,this.ap.vjb(h).toString());r=this.Ca.$("WordEditorImageCropIsEnabled");b.Be(Xg.a.OOh,r.toString());r&&(r=this.ap.yca(h),b.Be(Xg.a.top,r.top.toString()),b.Be(Xg.a.bottom,r.bottom.toString()),b.Be(Xg.a.left,r.left.toString()),b.Be(Xg.a.right,r.right.toString()));r=this.Ca.$("WordEditorImageRotateIsEnabled");b.Be(Xg.a.ogj,r.toString());r&&(b.Be(Xg.a.angle,this.ap.o0(h).toString()),h=this.ap.Goa(h),b.Be(Xg.a.flipH,h.nib?"true":"false"),b.Be(Xg.a.flipV,
h.bFa?"true":"false"));b.Be(Xg.a.rWh,"true")}}Object(m.a)(qK,"GraphicsEditorDocumentXmlToJsonRequestHelper",null,[345]);class rK{constructor(){this.JLa=null}FKk(b){this.JLa=b}teardown(){null!=this.JLa&&(this.JLa.teardown(),this.JLa=null);this.iPe=null}getGraphicData(){return this.JLa?this.JLa.getGraphicData():null}eZn(){null!=this.iPe&&this.setGraphicData(this.iPe)}setGraphicData(b){this.iPe=b;if(this.JLa)try{this.JLa.setGraphicData(b)}catch(h){t.ULS.sendTraceTag(575522530,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: Exception {0} thrown from GraphicHost.",
h.toString())}else t.ULS.sendTraceTag(575522529,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: GraphicHost is null.")}hasEdits(){return this.JLa?this.JLa.hasEdits():!1}}Object(m.a)(rK,"GraphicsEditorGC2HostUser",null,[347]);var VM=c(1732),WM=c(1101),XM=c(1392),YM=c(800),ZM=c(1489),$M=c(1100);class sK{constructor(b){this.preloadScript=this.loadScript=null;this.loadScript=h=>b.loadScript(h);this.preloadScript=h=>{b.preloadScript(h)}}}Object(m.a)(sK,"GC2ScriptLoader",null,[]);class AH{constructor(b,
h,r){this.vwe=b;this._context=h;this.hNa=r}closeEditor(){this.vwe&&(this.vwe(),this.vwe=null)}logActivity(b,h,r,B){Ke.a(b,h,r,B)}logTrace(b,h,r,B){t.ULS.sendTraceTag(575522531,3001,AH.M8m(h),B)}isEnabled(b){const h=v.AFrameworkApplication.K;switch(b){case "EqualSizingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSizingGuide",!1);case "EqualSpacingGuide":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSpacingGuide",!1);case "AdjustHandles":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsAdjustHandles",
!1);case "SpaceFirstLastPara":return h.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextSpaceFirstLastPara",!1);case "ModernFontPicker":return h.$("ModernFontPickerIsEnabled");default:return h.getBooleanFeatureGate(`Microsoft.Office.WordOnline.GC2.${b}`,!1)}}getFontPickerFonts(b){const h=`${Ma.a.instance.resolve("Box4.IFontServiceParser").Z1a}/${"hier_officeFontsPreview.ttf"}`;b("msofp_hier",h);b=hp.FontUtils.tnf(()=>!1,()=>"",!0);return{commandId:"FontPicker",fonts:b.fonts.filter(r=>"premium"!==
r.fontType),mruList:b.mruList,previewFontFamily:"msofp_hier_MSFontService"}}getHealth(){return va.Health.instance}getFonts(b){const h=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernFontPicker",!1),r=h?"msofp_hier":"msofp",B=`${Ma.a.instance.resolve("Box4.IFontServiceParser").Z1a}/${h?"hier_officeFontsPreview.ttf":"flat_officeFontsPreview.ttf"}`;b(r,B);hp.FontUtils.boh();hp.FontUtils.Doh({});b=hp.FontUtils.snf(()=>!1,(P,ca)=>ca).MenuSectionList;h&&0<b.length&&(b.pop(),
b.push(this.M4k()));return b}M4k(){const b=hp.FontUtils.tnf(()=>!1,()=>"").fonts.map((h,r)=>{const B=h.name;h=h.displayName;const P=hp.FontUtils.Qpa(B);return Object.assign(new mv.a,{MenuItemId:hp.FontUtils.pij+r,CommandValueId:B,LabelText:h||B,Styles:{["optionText"]:{["fontFamily"]:h&&!P?"msofp_hier_MSFontService":"'Segoe UI',Tahoma,Sans-Serif;"}},AriaLabel:B})});return Object.assign(new di.a,{Title:CommonUIStrings.l_FontDropdownMenuSectionAll,Id:"AllFontsDropdown",ControlList:b})}getPictureDataFromId(b){const h=
this._context.ik;var r=Id.ImageReader.rn(h);if(this.vOm(r,h,b)&&(r=Id.ImageReader.m6(r,Yc.a.Cqa,""),r.length))return Promise.resolve(r);r=new Xa.QueryStringBuilder("/we/GetImage.ashx?");r.s2b(h.node.Yi().zr);r.Be(Xg.a.pKd,b);v.AFrameworkApplication.nga(r);r.Be(fi.a.jsb,"1");Gh.a.instance.TAb(r);r.Be(Xg.a.QPh,"true");const B=r.toString();return new Promise((P,ca)=>{this.hNa.mj(B,1,null,null,!1,2,ra=>{P(ra.data.se)},ra=>{ca(ra.data.Se.toString())},null)})}getPlaceholders(){const b={};b.PictureDownloading=
Nd.a.wg("progress.gif");b.PictureInvalid=Nd.a.wg("CancelRequest.32x32x32.png");return b}getTheme(){const b=qo.PageNavigator.instance.su(this._context.view.ed).properties.ja(Mc.a.cme,"");return 0===b.length?[]:b.split(" ").map(h=>Eb.App.xCb[h])}static M8m(b){switch(b){case 0:return 10;case 1:return 15;case 2:return 50;case 3:return 100;case 4:return 200;default:return 50}}vOm(b,h,r){const B=h.node.Mc;h=Id.ImageReader.kTd(b,B,!1);b=Id.ImageReader.kTd(b,B,!0);return r===h||r===b}}Object(m.a)(AH,"GraphicsEditorApp",
null,[361]);class tK extends Pe.a{constructor(b,h,r,B,P){super(!1,!1,!0);this.closeEditor=()=>{this.wJh();this.dispose()};this.fca=ca=>{this.wJh(2===ca)};this.ubb=b;this.v5j=h;this.TZg=r;this._context=B;this.hNa=P}Xwo(b){return new Promise((h,r)=>{this.Uh(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle,this.fca,{["id"]:"GraphicsEditorDialog",["bootstrap"]:(B,P)=>this.MLk(P,b),["onload"]:B=>{this.onLoad(B,h,r)},["editorDiscardText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogDiscardChanges,
["editorSaveText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogSave,["onReload"]:()=>{this.ubb.eZn()},["iFrameTitle"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle})})}onLoad(b,h,r){b?(this.ubb.FKk(b),h(b)):(t.ULS.sendTraceTag(573100169,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Null host"),r(null))}MLk(b,h){const r=v.AFrameworkApplication.K,B=$M.a();B.loadScriptWithRetryHandler=b;const P=new AH(this.closeEditor,this._context,this.hNa),ca={["bootConfig"]:Object.assign(new XM.a,
{scriptBaseUrl:ME.AppChromeOverrideUtilities.isEnabled?ME.AppChromeOverrideUtilities.USd(v.AFrameworkApplication.lcid):v.AFrameworkApplication.a6+v.AFrameworkApplication.lcid+"/",isMLRRibbonMode:v.AFrameworkApplication.ua.Kb.Klc,isCombinedBundleEnabled:v.AFrameworkApplication.K.$("IsCombinedBundleEnabled")}),["scriptLoader"]:new sK(new WM.DynamicScriptLoader(B)),["publicPath"]:v.AFrameworkApplication.a6,["appSettings"]:r.appSettings,["logger"]:new Pl.a,["featureGateManager"]:Object.assign(new YM.a,
{getBooleanFeatureGate:Object(z.a)(r,r.getBooleanFeatureGate,"getBooleanFeatureGate"),getIntFeatureGate:Object(z.a)(r,r.getIntFeatureGate,"getIntFeatureGate"),getStringFeatureGate:Object(z.a)(r,r.getStringFeatureGate,"getStringFeatureGate")}),["app"]:P,["resolveScript"]:(ra,Qa)=>ZM.a.resolveScript(ra,Qa),["initialTabId"]:h};r.$("DynamicBundlesIsEnabled")&&(h=v.AFrameworkApplication.K.$("AppChromeOverrideIsCombinedBundle")||v.AFrameworkApplication.K.$("IsCombinedBundleEnabled")?"":"exp/",ca.dynamicBundlesPath=
ME.AppChromeOverrideUtilities.isEnabled?ME.AppChromeOverrideUtilities.tkc+h:r.kb("StaticContentUrl")+h);return new Promise((ra,Qa)=>{b("gc2",v.AFrameworkApplication.Sz("gc2.js",5),"anonymous",5,!1).then(()=>{ra(ca)}).catch(()=>{t.ULS.sendTraceTag(572915794,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Failed To Download Scripts");Qa(null)})})}wJh(b){b=this.ubb.hasEdits()&&!b;this.v5j(b?this.ubb.getGraphicData():null,!!this.TZg,this.TZg,b)}}Object(m.a)(tK,"ReactGraphicsEditorDialog",Pe.a,[]);class uK{constructor(b,
h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc,Uc,od=!1){this.N3h=od;this.Cvb=this._context=null;this.Ywo=(Od,ze,de,ee,je)=>{var ue,Qf,Jg;const Ql=!!je&&Object(Ib.a)(V.a,je);try{if(1===de){const Kp=ze.view;return this.Vj.Hga(ze)&&Kp.features.Tke?32:8}this.h9j=4===(null===je||void 0===je?void 0:je.InputMethod)?!0:!1;Eb.App.instance&&Eb.App.instance.rJb&&(this.N3h||TM.a.Shb(()=>{this.N3h=!0}));t.ULS.sendTraceTag(573100171,3001,50,`Launch Graphics Editor dialog. Existing:${Ql}`);performance.mark("LaunchStart");this._context=
ze;const Fm=new tK(this.ubb,this.VVf,Ql?je:null,ze,this.$f);Od=null;if(Ql&&(null===(ue=v.AFrameworkApplication.K)||void 0===ue?0:ue.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectDrawInDrawingCanvasForPictures",!1))){const Kp=null===(Jg=null===(Qf=ze.view.mb)||void 0===Qf?void 0:Qf.ib)||void 0===Jg?void 0:Jg.lb;if(null===Kp||void 0===Kp?0:Kp.bI)Od="Draw"}this.Cvb=Fm.Xwo(Od).then(()=>{t.ULS.sendTraceTag(559424644,3001,50,`Graphics Editor dialog display success. Existing:${Ql}`)}).catch(()=>
{this.ITh()});if(!Ql){const Kp=AB=>{this.Cvb.then(()=>{this.uYi(AB,!1)})};if(v.AFrameworkApplication.sessionStartInfoSettings&&"Automation"===v.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)return Kp(JSON.stringify({elements:[]})),32;let nv=null;nv=qo.PageNavigator.instance.su(ze.view.ed);const fD=nv.properties.ja(Mc.a.O3h,"");if(0<fD.length)return Kp(fD),32;this.YCe.eeo(ze,V.a.create(),Bb.a.create()).then(AB=>{const XD=this.Lc.Pc(0,Nb.a.FSc);XD.Db(nv);nv.setValue(Mc.a.O3h,AB);XD.dispose();
Kp(AB);return null}).catch(AB=>{t.ULS.sendTraceTag(512521162,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",AB.toString(),Ql);this.ITh()})}return 32}catch(Fm){return t.ULS.sendTraceTag(42328736,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",Fm.toString(),Ql),8}};this.Jom=(Od,ze,de,ee,je)=>{if(!ze.view.features.Tke)return 32;t.ULS.sendTraceTag(574232200,3001,50,"Launch Graphics Editor: DoubleClick");this.JVh(je,ze);return 32};
this.Iom=(Od,ze,de,ee,je)=>{var ue,Qf,Jg;const Ql=ze.view;if(null===(ue=v.AFrameworkApplication.K)||void 0===ue?0:ue.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddDrawCommandInContextMenu",!1))if(ue=null===(Jg=null===(Qf=null===Ql||void 0===Ql?void 0:Ql.mb)||void 0===Qf?void 0:Qf.ib)||void 0===Jg?void 0:Jg.lb,null===ue||void 0===ue||!ue.l4a)return 8;return this.kmi(Od,ze,de,ee,je)};this.kmi=(Od,ze,de)=>{if(1===de)return ze.view.features.Tke?32:8;if(2===de){Od=Id.ImageReader.rn(ze.ik);if(!Od)return 2;
t.ULS.sendTraceTag(574232201,3001,50,"Launch Graphics Editor: ContextMenu");this.JVh(Od,ze);return 32}return 2};this.uYi=(Od,ze=!0)=>{this.ubb.setGraphicData(Od);performance.mark("LaunchEnd");performance.measure("EditorLaunch","LaunchStart","LaunchEnd");Od=performance.getEntriesByName("EditorLaunch");t.ULS.sendTraceTag(559424645,3001,50,`Graphics Editor dialog launched with data successfully set. Existing: ${ze} Duration: ${Od[Od.length-1].duration}`);performance.clearMarks("LaunchStart");performance.clearMarks("LaunchEnd");
performance.clearMeasures("EditorLaunch")};this.VVf=(Od,ze,de,ee)=>{var je;this.ubb.teardown();if(ze&&this._context){var ue=this._context.view.mb.qg,Qf=ue.node;ue.el&&ke.ParagraphReader.Xb(Qf)&&(ue=null===(je=this.I7)||void 0===je?void 0:je.GA(Qf),27==(null===ue||void 0===ue?void 0:ue.role)&&t.ULS.sendTraceTag(541446533,3016,50,"Editing Pull Quote using Graphics Editor. Has edits: {0}; {1}",ee,ee?" Everything deleted: "+(0==(null===Od||void 0===Od?void 0:Od.json.length)):""))}if(ee)if(t.ULS.sendTraceTag(541714E3,
3001,50,"GraphicsEditorActor: close dialog and save"),this._context)if(Od)if(ee=Od.json,je=Od.width,Qf=Od.height,ee.length||ze)if(!ee.length&&ze)if(ze=this._context.ik){ze=ze.node;if(Id.ImageReader.r9(ze)){if(!this.Vj.xZn(ze,new Ad.GraphIterator,Wh.a.instance,gK.DeleteActor.d2b)){t.ULS.sendTraceTag(588817116,3001,10,"Failed to remove anchored image.");return}}else if(!this.Vj.qjc(ze,de,this.gb,this.bW)){t.ULS.sendTraceTag(572363225,3001,10,"Failed to remove inline image.");return}t.ULS.sendTraceTag(572363226,
3001,50,"Graphic removed thru dialog.")}else t.ULS.sendTraceTag(588886034,3001,10,"Context was in invalid state for removing existing content.");else ue=new VM.a(this._context,v.AFrameworkApplication.ua.HQa,!0,this.Vj,this.Ca,qo.PageNavigator.instance),Od=Bb.a.create(),de=new FJ.a(ue,ee,this.oK,this.Qm,Od,Il.a.instance,ze,de,this.Vj,this.ap,je,Qf,this.Ca,this.bW,this.rd,Eb.App.instance.rJb,Eb.App.instance.QAf),this.YCe.gcg(de,this._context,ze,Od),this.Rra(),this.h9j&&this.jOo();else t.ULS.sendTraceTag(541714001,
3001,50,"Empty Json on new content creation when close dialog");else t.ULS.sendTraceTag(577868244,3001,10,"JSON was unexpectedly null and the model did change!");else t.ULS.sendTraceTag(590205069,3001,10,"GraphicsEditorActor: context cannot be null")};this.ga=b;this.Ca=h;this.YCe=r;this.Vj=B;this.oK=P;this.Qm=ca;this.ubb=new rK;this.Lc=Qa;this.gb=tb;this.bW=Mb;this.ap=Zb;this.rd=Gc;this.$f=jc;this.I7=Uc}Tb(){var b;let h=!0;this.Ca.$("GraphicsEditorActorRegistrationUpdateIsEnabled")||(h=this.rd&&this.rd.isFeatureEnabled(50));
h&&!Z.a.gt&&(this.ga.fb(qb.a.Zwf,yc.a.view,this.Ywo,4),this.ga.fb(Nb.a.phf,yc.a.view,this.Jom,4),this.ga.fb(qb.a.LVh,yc.a.view,this.Iom,4),(null===(b=v.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.AddDrawCommandInContextMenu",!1))&&this.ga.fb(qb.a.p7b,yc.a.view,this.kmi,4))}ITh(){const b=new Tf.StandardDialog;b.Cd=0;b.vx(hh.a.ehf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError,null);Eb.App.za.updateCommandUI()}JVh(b,
h){var r=b.ja(lh.a.G5,1);const B=b.ja(gi.a.B0,hg.a.finished);r&&B!==hg.a.uploading?b.ja(Mc.a.VIh,!1)?(h=new Tf.StandardDialog,h.Cd=0,h.vx(hh.a.ehf,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError,null,!0),Eb.App.za.updateCommandUI(),t.ULS.sendTraceTag(521426528,3001,15,"{0}",{["message"]:"Graphic already known to have unsupported properties",["id"]:Id.ImageReader.jQa(b)})):(this.ga.Qb(qb.a.Zwf,2,b.id),this.Cvb||(t.ULS.sendTraceTag(574997639,
3001,10,"GraphicsEditorDialogInitialization promise was null!"),this.Cvb=new Promise(P=>{P(null)})),r=Bb.a.create(),b=new qK(b,this.uYi,Il.a.instance,this.Cvb,this.ap,this.Ca,this.rd,Eb.App.instance.HR(this.ap.ui(b))),this.YCe.gcg(b,h,!0,r)):t.ULS.sendTraceTag(573055959,3001,50,"Graphics Editor launch diverted since Box4 model is not ready!")}Rra(){const b=Ma.a.instance.Ta("Common.ISystemInitiatedFeedback");b?b.execute(h=>{h.logActivity("WordWebDrawing","WordDrawingFloodgateIsEnabled")}):t.ULS.sendTraceTag(572352085,
3001,10,"ISystemInitiatedFeedback was null")}jOo(){const b=Ma.a.instance.Ta("Common.ISystemInitiatedFeedback");b?b.execute(h=>{h.logActivity("WordPenNsatSurvey","WordPenNsatSurveyIsEnabled")}):t.ULS.sendTraceTag(520382472,3001,10,"ISystemInitiatedFeedback was null")}}Object(m.a)(uK,"GraphicsEditorActor",null,[]);var aN=c(520);class vK{constructor(b,h,r){this.uXa="wwaengidc";this.hjd="CreateLinkForHeading";this.O_j="CreateLinkForHeadingAction";this.W1j="\ufffc";this.gXa=b;this.ga=h;this.gb=r}Tb(){this.ga.ra(qb.a.CKc,
yc.a.paragraph,this.ecf.bind(this));this.ga.ra(qb.a.CKc,yc.a.Fd,this.ecf.bind(this));this.ga.ra(qb.a.CKc,yc.a.Uc,this.ecf.bind(this));this.ga.Xc(qb.a.CKc,1028)}ecf(b,h,r){b=h.node;if(1===r)return this.Qzi(b)?32:8;this.rSn(this.hjd,this.O_j);if(!this.Qzi(b))return t.ULS.sendTraceTag(528815444,3029,50,"User is trying to create sharable link for a non-heading text"),8;r=b.getValue(Mc.a.Wc);if(!r)return t.ULS.sendTraceTag(528815445,3029,10,"Word id does not exist for the paragraph"),r=new Map,r.set("Source",
this.hjd),r=Object.assign(new hc.a,{additionalValues:r}),va.Health.instance.recordKpiFailure(this.hjd,"Unable to create sharable link as paragraph id is missing",!1,!0,r),8;this.xMh(r);return 32}xMh(b){b=String.format('{{"{0}":"{1}"}}',aN.a.heading,b);this.ga.Qb(fb.a.V8,2,{["nav"]:btoa(b),["mode"]:"copy"},{["ControlId"]:"CopyLinkToHeading"})}Qzi(b){return!this.gb.Xb(b)||this.gb.Rcc(b)||this.gb.oJb(b)||b.Gr||""===b.characterData||b.characterData===this.W1j||!this.gXa.fSd(b)?!1:!0}rSn(b,h){const r=
new Map;r.set("Source",this.hjd);r.set("Action",h);va.Health.instance.recordKpiUsage(b,0,this.uXa,r)}}Object(m.a)(vK,"HeadingsActor",null,[]);class wK{auo(b){return ke.ParagraphReader.uva(this.R$h(b))}x9c(b,h,r){if(b=ke.ParagraphReader.gQa(this.R$h(b)))h=b.te(h),Object(Ib.a)(328,h)&&(sB.m(b)?h.poo(r):h.x9c())}R$h(b){return b&&b.el&&b?b.node:null}}Object(m.a)(wK,"IFrameFocusStrategy",null,[329]);class xK{constructor(b){this.LCa=null;this.Hnd=b}xLi(){t.ULS.sendTraceTag(25007835,375,50,"Ignore all spelling error triggered")}nDj(b){if(!b)return t.ULS.sendTraceTag(25007836,
375,15,"Error range is null"),!1;if(!b.errorDetails)return t.ULS.sendTraceTag(25007837,375,15,"No error detail found"),!1;if(!b.errorDetails.token)return t.ULS.sendTraceTag(25007838,375,50,"Ignore-all: Token is null and the ErrorDetails type is {0}",Object.getType(b.errorDetails).toString()),!1;this.LCa=F.a.ume(b.errorDetails.token,b.errorDetails.lcid);this.Hnd.add(this.LCa,b.errorDetails.lcid);return!0}B$c(b){return b?b.token?F.a.ume(b.token,b.lcid)===this.LCa:(t.ULS.sendTraceTag(25007840,375,15,
"ErrorDetails Token is null"),!1):(t.ULS.sendTraceTag(25007839,375,15,"ErrorDetails is null during ignore-all operation"),!1)}}Object(m.a)(xK,"IgnoreAllProofingErrorStrategy",null,[327]);var bN=c(1401),cN=c(576),yK=c(537);class zK{constructor(b,h){this.filename=b;this.blob=h}}Object(m.a)(zK,"UploadBlobParameters",null,[]);class AK extends Pk{constructor(b,h,r,B,P,ca,ra,Qa=null){super(b,h,r,null,P,ca,!1);this.q$j="DragAndDrop";this.tVg="FileName";this.wVg=0;this.Ykh=null;this.Zdd=this.m1a=!1;this.DTg=
B;this.Dbh=Qa}get IIj(){return"DragDropInsertImage"}get yP(){return this.q$j}get fileExtension(){return this.tVg}get fileSize(){return this.wVg}get JIj(){return this.Ykh}fbd(b){const h=new zK(this.DTg.name,this.DTg);b.Zwj(h);this.Ykh=b.teb}uwa(b,h){this.Dbh&&this.Dbh();super.uwa(b,h)}srg(b){const h=!!b&&this.Lka(b.name,null)&&this.trg(b,null);b&&(this.tVg=b.name,this.wVg=b.size);h||this.m3d();return h}}Object(m.a)(AK,"DragDropInsertImageUploader",Pk,[]);class Qs{constructor(b,h,r,B,P,ca,ra){this.qUc=
ca;this.nS=ra;this.v4d=this.w4d=this.U4d=this.V4d=0;this.ga=null;this.Wgf=(Qa,tb,Mb)=>{if(Eb.App.tLd)return 8;Qa=tb.node;return 1===Mb?Qa?32:2:2===Mb?(Mb=Id.ImageReader.rn(tb),tb=Id.ImageReader.uRc(Mb,tb.node.Yi().xd,v.AFrameworkApplication.K,v.AFrameworkApplication.ua.HQa),Yt(tb),32):2};this.FEm=(Qa,tb,Mb)=>{var Zb;const jc=this.Vj.Hga(tb);if(2===Mb&&jc){if(Nb.a.BR===Qa||Nb.a.LFd===Qa)v.AFrameworkApplication.bqa?v.AFrameworkApplication.Lhg():((null===(Zb=v.AFrameworkApplication.K)||void 0===Zb?0:
Zb.getBooleanFeatureGate("Microsoft.Office.WordOnline.FrequentlyUsedObjects",!1))&&Zu.a.instance.h7a("PictureLocal"),this.Fdl(tb));return 32}return 1!==Mb||Nb.a.BR!==Qa&&Nb.a.LFd!==Qa?2:jc?32:2};this.EIb=(Qa,tb,Mb,Zb,jc)=>this.Vj.Hga(tb)?1===Mb?32:this.Vj.xCf(tb,jc)?32:2:2;this.Hno=()=>{if(this.hb&&this.hb.ib&&this.hb.ib.lb){const Qa=this.hb.ib.lb.Pa;Qa&&this.hb.Ac(og.SelectionFactory.ne(Qa.node,Qa.cpBegin))}};this.mtl=(Qa,tb,Mb,Zb,jc)=>{t.ULS.sendTraceTag(42530333,307,50,"Drag and drop local content");
if((Qa=jc.DataTransfer)&&Qa.files&&0<Qa.files.length){t.ULS.sendTraceTag(578380440,307,50,String.format("{0} files to drop",Qa.files.length));for(Mb=0;Mb<Qa.files.length;Mb++)Zb=Qa.files[Mb],0<=F.a.eh(Zb.type).indexOf("image")&&this.SDm(Zb,tb)&&(Zb=this.hb.ib.lb.Pa,this.hb.Ac(og.SelectionFactory.ne(Zb.node,Zb.cpBegin+1)));this.lKa();return 32}t.ULS.sendTraceTag(42530334,307,15,"Drag and drop local content not handled");return 2};this.tDn=(Qa,tb,Mb,Zb,jc)=>{if(2===Mb)return v.AFrameworkApplication.va.Nf(tb.ik,
Qa,Mb,!0,Zb,jc);if(!tb.view.ue)return 8;Qa=tb.view;if(!Qa.mb)return 8;Qa=Qs.ah.vO(Qa.mb.qg);return 1===Qa.length&&this.uO(Qa[0])?(this.b7m(),this.QYc||Qs.W0f(!0),32):8};this.xnm=(Qa,tb,Mb)=>{if(!this.uO(tb))return 8;const Zb=Id.ImageReader.rn(tb),jc=Id.ImageReader.oF(Zb),Gc=Id.ImageReader.JG(Zb);Qa=Qa===Nb.a.JVd;t.ULS.sendTraceTag(20459936,322,50,"GrowShrinkImage: {0}",{["IsGrow"]:Qa});if(1===Mb)return this.Hi.N4||Id.ImageReader.B4a(Zb)?2:Qa&&jc<this.w4d&&Gc<this.v4d||!Qa&&jc>this.V4d&&Gc>this.U4d?
32:2;Mb=Qa?1.1:.9;this.setSize(Zb,tb,jc*Mb,Gc*Mb,!0);return 32};this.Jic=(Qa,tb,Mb,Zb,jc)=>{if(!this.ana(tb))return 8;Qa=Id.ImageReader.rn(tb);tb=Id.ImageReader.BFa(Qa);Mb=Id.ImageReader.AFa(Qa);if(0>=tb||0>=Mb)return 2;Qa=Id.ImageReader.oF(Qa)/tb*100;jc.setValue(Yc.a.xUc,Qa);return 32};this.obc=(Qa,tb,Mb,Zb,jc)=>{if(!this.ana(tb))return 8;Qa=Id.ImageReader.rn(tb);if(1===Mb)return this.Hi.N4||Id.ImageReader.B4a(Qa)?2:32;t.ULS.sendTraceTag(20459937,322,50,"Change image scale.");Mb=jc.ja(Yc.a.xUc,-1)/
100;Zb=jc.ja(Yc.a.Dqi,!1);const Gc=jc.ja(Yc.a.KAf,!0);jc=jc.ja(Yc.a.LAf,!0);if(0>=Mb)return Qs.Ic.Yb(le.a.vn,{["Reason"]:ae.a.PIb}),2;const Uc=Id.ImageReader.BFa(Qa),od=Id.ImageReader.AFa(Qa),Od=Id.ImageReader.oF(Qa),ze=Id.ImageReader.JG(Qa);if(0>=Uc||0>=od)return Qs.Ic.Yb(le.a.f2,{["Reason"]:ae.a.PIb}),2;Zb?(Zb=Gc?Mb*Od:Od,Mb=jc?Mb*ze:ze):(Zb=Gc?Mb*Uc:Od,Mb=jc?Mb*od:ze);this.setSize(Qa,tb,Zb,Mb);Eb.App.zd.Uo&&Eb.App.zd.fq.gG(tb.node);this.lKa();return 32};this.pOb=(Qa,tb,Mb,Zb,jc)=>{if(!this.uO(tb))return 8;
Qa=Id.ImageReader.rn(tb);Qa=Id.ImageReader.JG(Qa);if(0>=Qa)return 2;jc.setValue(Yc.a.XFa,Qa);return 32};this.XFa=(Qa,tb,Mb,Zb,jc)=>{if(!this.ana(tb))return 8;Qa=Id.ImageReader.rn(tb);if(1===Mb)return this.Hi.N4||Id.ImageReader.B4a(Qa)?2:32;t.ULS.sendTraceTag(20459938,322,50,"Change image absolute height.");Mb=jc.ja(Yc.a.XFa,0);jc=Id.ImageReader.A4a(Qa);if(0>=Mb)return Qs.Ic.Yb(le.a.vn,{["Reason"]:ae.a.PIb}),2;Zb=Id.ImageReader.BFa(Qa);const Gc=Id.ImageReader.AFa(Qa),Uc=Id.ImageReader.oF(Qa);var od=
Id.ImageReader.JG(Qa);od=Uc/od;if(0>=Zb||0>=Gc)if(Qs.Ic.Yb(le.a.f2,{["Reason"]:ae.a.PIb}),this.Yqj(Qa))return 2;this.setSize(Qa,tb,jc?Mb*od:Uc,Mb);Eb.App.zd.Uo&&Eb.App.zd.fq.gG(tb.node);Eb.App.za.updateCommandUI();return 32};this.qOb=(Qa,tb,Mb,Zb,jc)=>{if(!this.uO(tb))return 8;Qa=Id.ImageReader.rn(tb);Qa=Id.ImageReader.oF(Qa);if(0>=Qa)return 2;jc.setValue(Yc.a.YFa,Qa);return 32};this.YFa=(Qa,tb,Mb,Zb,jc)=>{if(!this.ana(tb))return 8;Qa=Id.ImageReader.rn(tb);if(1===Mb)return this.Hi.N4||Id.ImageReader.B4a(Qa)?
2:32;t.ULS.sendTraceTag(20459939,322,50,"Change image absolute width.");Mb=jc.ja(Yc.a.YFa,0);jc=Id.ImageReader.A4a(Qa);if(0>=Mb)return Qs.Ic.Yb(le.a.vn,{["Reason"]:ae.a.PIb}),2;Zb=Id.ImageReader.BFa(Qa);const Gc=Id.ImageReader.AFa(Qa);var Uc=Id.ImageReader.oF(Qa);const od=Id.ImageReader.JG(Qa);Uc=od/Uc;if(0>=Zb||0>=Gc)if(Qs.Ic.Yb(le.a.f2,{["Reason"]:ae.a.PIb}),this.Yqj(Qa))return 2;this.setSize(Qa,tb,Mb,jc?Mb*Uc:od);Eb.App.zd.Uo&&Eb.App.zd.fq.gG(tb.node);Eb.App.za.updateCommandUI();return 32};this.sOb=
(Qa,tb,Mb,Zb,jc)=>{if(!this.uO(tb))return 8;Qa=Id.ImageReader.rn(tb);Qa=Id.ImageReader.A4a(Qa);jc.setValue(Yc.a.tY,Qa);return 32};this.tY=(Qa,tb,Mb,Zb,jc)=>{if(!this.uO(tb))return 8;Qa=Id.ImageReader.rn(tb);if(1===Mb&&this.Hi.N4)return 2;Eb.App.zd.Uo&&Eb.App.zd.fq.gG(tb.node);jc&&(tb=jc.ja(Yc.a.tY,!0),t.ULS.sendTraceTag(20459968,322,50,"Change image lock aspect ratio."),this.Vj.gmj(Qa,tb),Eb.App.za.updateCommandUI());return 32};this.T6a=(Qa,tb,Mb,Zb,jc)=>{if(!this.uO(tb))return 8;Qa=Id.ImageReader.rn(tb);
Qa=Id.ImageReader.bY(Qa);jc.setValue(Yc.a.mkb,Qa);return 32};this.mkb=(Qa,tb,Mb,Zb,jc)=>{if(!this.uO(tb))return 8;if(1===Mb)return this.Hi.N4?2:32;if(Eb.App.zd.Uo&&(Qa=tb.node.ja(lh.a.QJ,ie.a.Pt),Qa!==ie.a.Pt&&(Qa=Eb.App.zd.fq.kjb(Qa),yK.CoauthLockEditor.getInstance().g8a(Qa))))return Qs.Ic.Yb(le.a.vn,{["Reason"]:ae.a.cF}),2;Qa=Id.ImageReader.rn(tb);jc=jc.ja(Yc.a.mkb,null);this.Vj.Pjo(Qa,tb,jc);t.ULS.sendTraceTag(21297027,322,50,"Change image alt text.");this.Qd.Zs(13);return 32};this.S6a=(Qa,tb,
Mb,Zb,jc)=>{if(!this.uO(tb))return 8;Qa=Id.ImageReader.rn(tb);Qa=Id.ImageReader.iQa(Qa);jc.setValue(Yc.a.sY,Qa);return 32};this.sY=(Qa,tb,Mb,Zb,jc)=>{if(!this.uO(tb))return 8;if(1===Mb)return this.Hi.N4?2:32;if(Eb.App.zd.Uo&&(Qa=tb.node.ja(lh.a.QJ,ie.a.Pt),Qa!==ie.a.Pt&&(Qa=Eb.App.zd.fq.kjb(Qa),yK.CoauthLockEditor.getInstance().g8a(Qa))))return Qs.Ic.Yb(le.a.vn,{["Reason"]:ae.a.cF}),2;Qa=Id.ImageReader.rn(tb);jc=jc.ja(Yc.a.sY,null);this.Vj.Ojo(Qa,tb,jc);t.ULS.sendTraceTag(21297029,322,50,"Change image alt text description.");
this.Qd.Zs(13);return 32};this.G7a=(Qa,tb,Mb)=>{var Zb,jc;if(1===Mb)return 32;if(!tb.view.ue)return t.ULS.sendTraceTag(512267791,322,15,"No interactive view. Action: {0}",Qa),8;tb=tb.view;Mb=null===(jc=null===(Zb=tb.mb)||void 0===Zb?void 0:Zb.ib)||void 0===jc?void 0:jc.J(0);if(!Mb)return t.ULS.sendTraceTag(512267790,322,15,"No selection view. Action: {0}",Qa),8;jc=Mb.Pa;Zb=this.nS.Zf("UserAction",Qa.toString());let Gc;Qa==Nb.a.Gbg?Gc=this.qUc.G7a(jc,2):Qa==Nb.a.Jbg?(Gc=this.qUc.G7a(jc,0),5==Gc&&(Gc=
this.qUc.G7a(jc,2))):Qa==Nb.a.Kbg&&(Gc=this.qUc.G7a(jc,1),5==Gc&&(Gc=this.qUc.G7a(jc,3)));switch(Gc){case 4:jc=32;tb.E1();break;case 5:jc=2;break;default:jc=8}Zb.stop();t.ULS.sendTraceTag(512267789,322,50,"Select image: {0}. Duration: {1}. Action: {2}",Gc,Zb.oi,Qa);return jc};this.Vj=b;this.en=h;this.Qd=r;this.ug=B;this.hb=P;this.rg=Bi.a.getInstance(jk.a)}get Hi(){return si.PageReader.instance}get mca(){return this.en.instance}get oc(){return this.ga}hCm(){this.V4d=xg.a.Ql(1,0);this.U4d=xg.a.Ql(1,
1);this.w4d=xg.a.Ql(1920,0);this.v4d=xg.a.Ql(1280,1)}Tb(b){this.ga=b;const h=this.tDn,r=this.FEm,B=this.EIb,P=this.xnm;b.fb(Nb.a.BR,yc.a.view,r,1284);b.ra(Nb.a.EIb,yc.a.Uc,B);b.ra(Nb.a.Gbg,yc.a.view,this.G7a);b.ra(Nb.a.Jbg,yc.a.view,this.G7a);b.ra(Nb.a.Kbg,yc.a.view,this.G7a);b.ra(Nb.a.EIb,yc.a.image,B);b.Xc(Nb.a.EIb,1284);b.fb(Nb.a.LFd,yc.a.view,r,1284);b.fb(Nb.a.q7e,yc.a.view,h,1028);this.vr(b,Nb.a.JVd,P);this.vr(b,Nb.a.Yhg,P);this.vr(b,Nb.a.Jic,this.Jic);this.vr(b,Nb.a.pOb,this.pOb);this.vr(b,
Nb.a.qOb,this.qOb);this.vr(b,Nb.a.T6a,this.T6a);this.vr(b,Nb.a.S6a,this.S6a);this.vr(b,Nb.a.obc,this.obc);this.vr(b,Nb.a.Xge,this.XFa);this.vr(b,Nb.a.Yge,this.YFa);this.vr(b,Nb.a.B9c,this.mkb);this.vr(b,Nb.a.mQb,this.sY);this.vr(b,Nb.a.sOb,this.sOb);this.vr(b,Nb.a.tY,this.tY);this.vr(b,Nb.a.Wgf,this.Wgf);b.fb(Nb.a.sVh,yc.a.view,this.mtl,4);b.Xc(Nb.a.JVd,4);b.Xc(Nb.a.Yhg,4);b.Xc(Nb.a.Jic,69);b.Xc(Nb.a.pOb,69);b.Xc(Nb.a.qOb,69);b.Xc(Nb.a.sOb,69);b.Xc(Nb.a.T6a,69);b.Xc(Nb.a.S6a,69);b.Xc(Nb.a.tY,4);b.Xc(Nb.a.obc,
4);b.Xc(Nb.a.Xge,4);b.Xc(Nb.a.Yge,4);b.Xc(Nb.a.B9c,4);b.Xc(Nb.a.mQb,4);this.hCm();this.QYc&&Bh.a.instance.Ww(this.sSk)}vr(b,h,r){b.ra(h,yc.a.image,r);b.ra(h,yc.a.hFb,r);b.ra(h,yc.a.Fd,r);b.ra(h,yc.a.X7,r)}Fdl(b){new Pk(b,Wg.a.instance,v.AFrameworkApplication.K,null,this.ug,this.ga)}A2o(b){return this.Hi.N4?(Qs.Ic.Yb(le.a.vn,{["Reason"]:ae.a.compatMode}),!1):this.ga&&3!==this.ga.mode?(Qs.Ic.Yb(le.a.vn,{["Reason"]:ae.a.lBl}),!1):Qs.Yf.$_(b)?(Qs.Ic.Yb(le.a.vn,{["Reason"]:ae.a.cF}),!1):this.mca&&this.mca.SU(b)?
(Qs.Ic.Yb(le.a.vn,{["Reason"]:ae.a.P1a}),!1):!0}yOm(b){const h=Id.ImageReader.rn(b);return h&&5===Id.ImageReader.ui(h)&&this.Ixi(b,h)}Ixi(b,h){(h=!Id.ImageReader.c$b(h)&&!Id.ImageReader.G_d(h))||Qs.Ic.Yb(le.a.vn,{["Reason"]:ae.a.bJh});return h&&this.A2o(b)}SDm(b,h){var r,B;h=new AK(h,Wg.a.instance,v.AFrameworkApplication.K,b,this.ug,this.ga,this.hb,this.Hno);if(h.srg(b))(null===(B=v.AFrameworkApplication.K)||void 0===B?0:B.$("ShouldLogPicturesExtendedHealthKpis"))&&this.rg.logKpiUsage({kpiName:jk.c.ZFa,
kpiType:0});else return(null===(r=v.AFrameworkApplication.K)||void 0===r?0:r.$("ShouldLogPicturesExtendedHealthKpis"))?(b=new Map([["ErrorLevel","info"]]),b=Object.assign(new hc.a,{extendedProperties:b}),this.rg.logKpiFailure({kpiName:jk.c.ZFa,errorName:"PictureDragDropInvalid",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:b},optionalVeto:{name:jk.c.mbc,errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:null}})):va.Health.instance.recordQosError("PictureDragDropInvalid",
["ImageInsertFailed"],!0,!0,!1,!1,null),t.ULS.sendTraceTag(578380439,307,50,"The file is not supported"),!1;new on.a(document.body,Object(z.a)(h,h.l6a,"onUploadFrameInitialized"),Object(z.a)(h,h.Kea,"uploadResponseReceived"),v.AFrameworkApplication.K,!1,void 0,ch.a(v.AFrameworkApplication.K));return!0}uO(b){return this.yOm(b)}ana(b){const h=Id.ImageReader.rn(b);if(!h)return!1;const r=Ma.a.instance.Oa("Box4.IFeatureHelper"),B=Id.ImageReader.ui(h);return 5===B||10===B||48===B||11===B||r&&r.isFeatureEnabled(50)&&
4===B?this.Ixi(b,h):!1}get QYc(){var b;return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsUpdatedTabUpdateEnabled",!1)}sSk(){Qs.W0f(!0)}setSize(b,h,r,B,P=!1){Eb.App.zd.Uo&&Eb.App.zd.fq.gG(h.node);const ca=Id.ImageReader.A4a(b);let ra=1;r>this.w4d?ra=this.w4d/r:r<this.V4d&&(ra=this.V4d/r);let Qa=1;B>this.v4d?Qa=this.v4d/B:B<this.U4d&&(Qa=this.U4d/B);if(ca||P)ra=Math.min(ra,Qa),Qa=Math.min(ra,Qa);1!==ra&&(r*=ra);1!==Qa&&(B*=Qa);this.xgf(b,
h,r,B)}xgf(b,h,r,B){this.Vj.Tno(b,h,r,B)}b7m(){t.ULS.sendTraceTag(20459969,322,50,"PictureTools Tab enabled.")}lKa(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("WordEditorInsertImagesFloodgateIsEnabled")&&window.setTimeout(()=>{const b=Ma.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("WordInsertImageApplied","WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}Yqj(b){const h=Id.ImageReader.BFa(b);b=Id.ImageReader.AFa(b);return 0>=h||0>=b}static get ah(){return An.ContextSetEditor.instance}static get Yf(){return Wh.a.instance}static get Ic(){return Nh.a.instance}}
Qs.W0f=null;Object(m.a)(Qs,"ImageActor",null,[]);var BK=c(1113),ov=c(397),Ex=c(735);class RF{constructor(b,h,r,B,P){this.imagePropertySet=b;this.graphNode=h;this.MMc=r;this.dnm=B;this.MPa=P;if(this.dRa=Eb.App.instance&&Eb.App.instance.dRa())this.tCe=new BK.a(this.Ar(),RF.Qpc);this.rg=Bi.a.getInstance(ov.a)}bha(b){this.KY("crop");if(null===this.imagePropertySet||void 0===this.MMc||void 0===this.MPa)return this.zF("crop","Argument(s) invalid"),!1;const h=this.getGraphicData("crop");if(void 0===h)return!1;
const r=this.MPa.rlm();r.top=b.top;r.left=b.left;r.right=b.right;r.bottom=b.bottom;try{if(!this.CDd(r,h))return this.D_c("crop","Failed to apply and update"),this.zF("crop","Failed to apply and update"),!1}catch(B){return this.D_c("crop",B),this.zF("crop",B.stack?B.stack:B.message?B.message:B.toString()),!1}this.r3d("crop");return!0}rotate(b){this.KY("rotate");if(null===this.imagePropertySet||void 0===this.MMc||void 0===this.MPa)return this.zF("rotate","Argument(s) invalid"),!1;const h=this.getGraphicData("rotate");
if(void 0===h)return!1;b-=this.imagePropertySet.O6a.Cgi();if(0!==b){const r=this.MPa.vlm();r.rotation=b;try{if(!this.CDd(r,h))return this.zF("rotate","Failed to apply and update"),!1}catch(B){return this.D_c("rotate",B),this.zF("rotate",B.stack?B.stack:B.message?B.message:B.toString()),!1}}this.r3d("rotate");return!0}flip(b,h){const r="flip"+(b?"H":"")+(h?"V":"");this.KY(r);if(null===this.imagePropertySet||void 0===this.MMc||void 0===this.MPa)return this.zF(r,"Argument(s) invalid"),!1;const B=this.getGraphicData(r);
if(void 0===B)return!1;const P=this.MPa.slm();P.flip=this.MPa.SYl();P.flip.x=b;P.flip.y=h;try{if(!this.CDd(P,B))return this.zF(r,"Failed to apply and update"),!1}catch(ca){return this.D_c(r,ca),this.zF(r,ca.stack?ca.stack:ca.message?ca.message:ca.toString()),!1}this.r3d(r);return!0}resize(b,h){this.KY("resize");if(null===this.imagePropertySet||void 0===this.MMc||void 0===this.MPa)return this.zF("resize","Argument(s) invalid"),!1;const r=this.getGraphicData("resize");if(void 0===r)return!1;let B=0;
var P=0;({width:B,height:P}=Id.ImageReader.gjb(this.imagePropertySet));b/=B;h/=P;P=this.MPa.wlm();P.scale=this.MPa.Hem();P.scale.width=b;P.scale.height=h;try{if(!this.CDd(P,r))return this.zF("resize","Failed to apply and update"),!1}catch(ca){return this.D_c("resize",ca),this.zF("resize",ca.stack?ca.stack:ca.message?ca.message:ca.toString()),!1}this.r3d("resize");return!0}r3d(b){Ex.a.TIa&&(b=new Map([["Renderer",ov.b.XPd],["Operation",b],["Type",Id.ImageReader.ui(this.imagePropertySet).toString()]]),
this.rg.logKpiSuccess({kpiName:ov.d.iMd,optionalProperties:{additionalValues:{durationMs:void 0,inStaging:void 0,extendedProperties:b},hasImpliedUsage:void 0},blockFutureEmissionDurationInMs:3E5}))}D_c(b,h){Ex.a.TIa&&(b=Object.assign(new hc.a,{extendedProperties:new Map([["Renderer",ov.b.XPd],["Exception",h.message],["Operation",b]])}),h={name:ov.d.zVh,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel",
"warning"),this.rg.logKpiFailure({kpiName:ov.d.iMd,errorName:"DrawingResponseInvalid",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:h}))}static get Qpc(){return Ma.a.instance.Oa("Box4.ICssColorProvider")}getGraphicData(b){try{if(this.dRa){const h=this.tCe.Jvf();return this.imagePropertySet.getGraphicData(h)}return this.imagePropertySet.getGraphicData()}catch(h){this.zF(b,h.stack?h.stack:h.message?h.message:h.toString())}}CDd(b,h){this.MMc.apply(b,h);b=this.imagePropertySet.KFb(h);
if(void 0===b)return!1;this.qUo(b);return!0}qUo(b){const h=new cg.GraphTransaction(15);h.Db(this.graphNode);this.imagePropertySet.setValue(dd.a.nP,b.nP);this.dnm.Bao(b.yZh,b.Xxa,this.imagePropertySet);h.dispose()}Ar(){return qo.PageNavigator.instance.su(this.graphNode)}KY(b){const h=this.lug;h.edit=b;t.ULS.sendTraceTag(509657553,322,50,"{0}",h)}zF(b,h){const r=this.lug;r.message=h;r.edit=b;t.ULS.sendTraceTag(509666444,322,15,"{0}",r)}get lug(){return{["id"]:Id.ImageReader.jQa(this.imagePropertySet),
["type"]:Id.ImageReader.ui(this.imagePropertySet)}}}Object(m.a)(RF,"EditWithGC2Command",null,[]);class LG{Bao(b,h,r){this.E2m(b,h);this.Eao(r)}E2m(b,h){this.RH=Array(4);this.RH[zf.a.left]=b.Dhf;this.RH[zf.a.top]=b.Fhf;this.RH[zf.a.right]=b.Ehf;this.RH[zf.a.bottom]=b.Chf;this.xPa=b.xPa;this.yPa=b.yPa;(this.Xxa=h)&&this.k7k()}Eao(b){b.setValue(dd.a.Zwa,Math.round(this.xPa).toString());b.setValue(dd.a.$wa,Math.round(this.yPa).toString());const h=Array(4);this.RH.forEach((r,B)=>{h[B]=Math.round(r).toString()});
b.setValue(dd.a.xQa,h);b.setValue(dd.a.k4a,this.Xxa)}k7k(){this.mGo();const b=this.xPa/2,h=this.yPa/2;this.xPa%2&&0===this.yPa%2?(--this.RH[zf.a.left],++this.RH[zf.a.top]):this.yPa%2&&0===this.xPa%2&&(++this.RH[zf.a.left],--this.RH[zf.a.top]);this.RH[zf.a.left]+=b-h;this.RH[zf.a.right]-=b-h;this.RH[zf.a.top]+=h-b;this.RH[zf.a.bottom]-=h-b}mGo(){const b=this.xPa;this.xPa=this.yPa;this.yPa=b}}Object(m.a)(LG,"GraphicsExtents",null,[]);var BH=c(1178),CH=c(1179),MG=c(697);class NG{constructor(){this.y4o=
{["PictureBorderWeightZeroPointTwoFive"]:.25,["PictureBorderWeightZeroPointFive"]:.5,["PictureBorderWeightZeroPointSevenFive"]:.75,["PictureBorderWeightOne"]:1,["PictureBorderWeightOnePointFive"]:1.5,["PictureBorderWeightTwoPointTwoFive"]:2.25,["PictureBorderWeightThree"]:3,["PictureBorderWeightFourPointFive"]:4.5};this.Yhl={["PictureBorderStyleSolid"]:0,["PictureBorderStyleDash"]:7,["PictureBorderStyleRoundDot"]:8}}vLo(b,h){if(b){var r=this.GTd(b);h=h.O6a.Sei();b.On=void 0===r?!1:r===h}}uLo(b,h){if(b){var r=
this.j$l(b);h=h.O6a.i$l();b.On=void 0===r||void 0===h?!1:r===h}}static UGb(b,h){return b.O6a.UGb(h)}GTd(b){b=this.y4o[b.SourceControlId];if(void 0!==b)return b=xg.a.aZ(b,0,!1),xg.a.b1f(b)}j$l(b){return this.Yhl[b.SourceControlId]}}Object(m.a)(NG,"Gc2PictureBorderHelper",null,[]);var CK=c(522),dN=c(521),eN=c(1491);class Zq extends Qs{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb){super(b,h,B,ca,ra,Qa,tb);this.p6g=!1;this.OBa=this.sCe=this.cba=null;this.Fw=(Zb,jc,Gc,Uc,od)=>{if(!this.uO(jc))return 8;if(1===
Gc)return this.Hi.N4?2:32;Zb=parseInt(od);t.ULS.sendTraceTag(593372312,322,50,"SetPictureStyle: "+Zb);this.pwd.xNn(jc,Id.ImageReader.rn(jc),Zb);this.y_c(jc);this.lKa();return 32};this.zee=(Zb,jc,Gc)=>{if(!this.uO(jc))return 8;t.ULS.sendTraceTag(593372311,322,50,"Applying Style Reset");Zb=Id.ImageReader.rn(jc);if(1===Gc)return this.Hi.N4?2:32;Gc=Id.ImageReader.H2a(Zb);Gc===Cp.a.rendered?(Gc=new cg.GraphTransaction(15),Gc.Db(jc.node),Id.ImageReader.ncc()?Zb.setValue(Mc.a.yNb,""):this.AK.k_n(Zb),Gc.dispose(),
this.aCc.create(Zb,jc).Fw($d.a.yej),this.y_c(jc)):Gc===Cp.a.alwaysRendered&&this.aCc.create(Zb,jc).Fw($d.a.yej);return 32};this.ipm=(Zb,jc,Gc,Uc,od)=>{if(!this.uO(jc))return 8;Zb=Id.ImageReader.rn(jc);if(1===Gc)return this.Hi.N4||Id.ImageReader.Ycc(Zb)?2:32;od&&(this.AK.fcd(Zb,jc),t.ULS.sendTraceTag(22381021,322,50,"Toggled Image Crop Mode"),Eb.App.za.updateCommandUI());this.lKa();return 32};this.jpm=(Zb,jc,Gc,Uc,od)=>{var Od;if(!this.uO(jc))return 8;if(1===Gc)return this.Hi.N4?2:32;Zb=Id.ImageReader.rn(jc);
if(od){Gc=Id.ImageReader.lZd(Id.ImageReader.rn(jc));t.ULS.sendTraceTag(22381022,322,50,"Applying New Image Cropping, isCanvas: "+Gc);Uc=od.ja(Yc.a.rkb,0);const de=od.ja(Yc.a.okb,0),ee=od.ja(Yc.a.pkb,0);od=od.ja(Yc.a.qkb,0);var ze=Id.ImageReader.yca(Zb);const je=ze.bottom,ue=ze.left,Qf=ze.right;if(Uc===ze.top&&de===je&&ee===ue&&od===Qf)return t.ULS.sendTraceTag(23070480,322,50,"Cropping Properties were the same as before, no need to update."),32;if(this.uFf(Zb)&&(ze=null===(Od=x())||void 0===Od?void 0:
Od.gDb(),(new RF(Zb,jc.node,ze,new LG,y())).bha({top:.001*Uc,bottom:.001*de,left:.001*ee,right:.001*od})))return 32;Gc?(new BH.a(Zb,new CH.a)).Gho(Uc,de,ee,od,this.rnn,jc):this.pwd.mNn(jc,Id.ImageReader.rn(jc),Uc,de,ee,od);this.y_c(jc);Eb.App.za.updateCommandUI()}return 32};this.SVd=(Zb,jc,Gc,Uc,od)=>{if(!this.uO(jc))return 8;Uc=Id.ImageReader.rn(jc);if(1===Gc)return this.Hi.N4||Id.ImageReader.Ycc(Uc)?2:32;if(od){t.ULS.sendTraceTag(22552775,322,50,"Getting New Image Cropping From Spinners on Format Picture Pane");
this.AK.Fxa()||this.AK.fcd(Uc,jc);switch(Zb){case qb.a.nUc:Zb=od.ja(Yc.a.rkb,-1);Gc=0;break;case qb.a.gUc:Zb=od.ja(Yc.a.okb,-1);Gc=1;break;case qb.a.hUc:Zb=od.ja(Yc.a.pkb,-1);Gc=2;break;case qb.a.iUc:Zb=od.ja(Yc.a.qkb,-1);Gc=3;break;default:return 8}this.AK.dXo(Zb,Gc);this.y_c(jc);Eb.App.za.updateCommandUI()}return 32};this.Pob=(Zb,jc,Gc,Uc,od)=>{if(!this.uO(jc))return 8;Id.ImageReader.rn(jc);od&&(Zb=this.AK.Fxa(),od.setValue(Yc.a.Fxa,Zb));return 32};this.Iic=(Zb,jc,Gc,Uc,od)=>{if(!this.uO(jc))return 8;
Zb=Id.ImageReader.rn(jc);if(od){if(this.AK.Fxa())({top:Od,bottom:Gc,left:Zb,right:jc}=this.AK.yUl());else{Uc=xg.a.nf(Id.ImageReader.oF(Zb),0);var Od=xg.a.nf(Id.ImageReader.JG(Zb),1);jc=Id.ImageReader.yca(Zb);const ze=Math.max(jc.top,0);Gc=Math.max(jc.bottom,0);Zb=Math.max(jc.left,0);jc=Math.max(jc.right,0);Uc=1E5*Uc/(1E5-(Zb+jc));const de=1E5*Od/(1E5-(ze+Gc));Od=Math.floor(ze*de/1E5);Gc=Math.floor(Gc*de/1E5);Zb=Math.floor(Zb*Uc/1E5);jc=Math.floor(jc*Uc/1E5)}od.setValue(Yc.a.rkb,Od);od.setValue(Yc.a.okb,
Gc);od.setValue(Yc.a.pkb,Zb);od.setValue(Yc.a.qkb,jc)}return 32};this.vac=(Zb,jc,Gc,Uc,od)=>{if(!this.uO(jc))return 8;if(1===Gc){if(this.Hi.N4)return 2;this.H8m();return 32}Zb=Id.ImageReader.rn(jc);this.AK.Fxa()&&this.AK.fcd(Zb,jc);Zb=od.ja(Yc.a.cJa,"");od=od.ja(Yc.a.N9a,0);t.ULS.sendTraceTag(20459970,322,50,"SetWrapTextAction: {0}",{["Type"]:od,["SourceControlId"]:Zb});switch(od){case 1:this.AK.Moo(jc);break;case 8:this.AK.Uhe(jc,xC.a.square,1);break;case 9:this.AK.Uhe(jc,xC.a.square,3);break;case 3:this.AK.Uhe(jc,
xC.a.none,void 0,!0);break;case 4:this.AK.Uhe(jc,xC.a.none,void 0,!1)}this.lKa();Eb.App.za.updateCommandUI();return 32};this.Wic=(Zb,jc,Gc,Uc,od)=>{if(!this.uO(jc))return 8;Zb=Id.ImageReader.rn(jc);jc=Id.ImageReader.Q4(jc);Gc=Id.ImageReader.t9(Zb);Uc=Id.ImageReader.eac(Zb);Zb=Id.ImageReader.Lx(Zb);return this.kNn(jc,Gc,Uc,Zb,od)?32:8};this.lpm=(Zb,jc,Gc,Uc,od)=>{var Od;if(!this.ana(jc))return 8;Uc=Id.ImageReader.rn(jc);if(1===Gc)return kc.SessionStatusManager.instance.Zj?8:this.Hi.N4||Id.ImageReader.Zcc(Uc)?
2:32;this.AK.Fxa()&&this.AK.fcd(Uc,jc);if(od){const de=od.ja(Yc.a.uUc,0),ee=Id.ImageReader.lZd(Uc);t.ULS.sendTraceTag(22052889,322,50,"SetImageRotateAction: {0}, isCanvas: {1}",de,ee);Gc=Id.ImageReader.o0(Uc);var ze=Id.ImageReader.Goa(Uc);let je=ze.nib;ze=ze.bFa;switch(de){case 0:Gc=od.ja(Yc.a.JU,0);break;case 2:Gc-=90;Gc=mf.c(Gc);break;case 1:Gc+=90;Gc=mf.c(Gc);break;case 4:je=!je;break;case 3:ze=!ze;break;case 5:Gc+=od.ja(Yc.a.JU,0),Gc=mf.c(Gc)}if(this.uFf(Uc))if(od=null===(Od=x())||void 0===Od?
void 0:Od.gDb(),Od=new RF(Uc,jc.node,od,new LG,y()),4===de){if(Od.flip(!0,!1))return 32}else if(3===de){if(Od.flip(!1,!0))return 32}else if(Od.rotate(Gc))return 32;ee?(new BH.a(Uc,new CH.a)).gno(Gc,je,ze,this.Itn,jc):de?this.aCc.create(Uc,jc).nmo(Gc,je,ze):(Od=Bb.a.create(),od=new cg.GraphTransaction(15,Nb.a.m9),od.Db(jc.node),this.AK.Yjo(Uc,Gc),this.pwd.tNn(jc,Id.ImageReader.rn(jc),Gc,Od),od.eHa(Od,1),od.Uj=Zb,od.dispose());this.lKa();this.y_c(jc);Eb.App.za.updateCommandUI()}return 32};this.rOb=
(Zb,jc,Gc,Uc,od)=>{if(!this.uO(jc))return 8;Zb=Id.ImageReader.rn(jc);Zb=Id.ImageReader.o0(Zb);if(0>Zb)return 2;od.setValue(Yc.a.JU,Zb);return 32};this.Itn=(Zb,jc,Gc,Uc)=>{if(Zb){const od=new cg.GraphTransaction(15,Nb.a.m9);od.Db(Uc.node);jc.setValue(Yc.a.fCb,JSON.stringify(Gc));jc.setValue(Yc.a.ft,Zb);this.AK.ahe(jc,Gc.rotationAngle,Gc.Xac,Gc.opc);this.zFb(jc);od.dispose()}};this.qtn=(Zb,jc,Gc,Uc)=>{if(Zb){const od=new cg.GraphTransaction(15);od.Db(Uc.node);jc.setValue(Yc.a.fCb,JSON.stringify(Gc));
jc.setValue(Yc.a.ft,Zb);this.AK.Hge(jc,Gc.Jne,Gc.idd);this.zFb(jc);od.dispose()}};this.rnn=(Zb,jc,Gc,Uc)=>{if(Zb){const od=new cg.GraphTransaction(15);od.Db(Uc.node);jc.setValue(Yc.a.fCb,JSON.stringify(Gc));jc.setValue(Yc.a.ft,Zb);this.AK.Sjo(jc,Math.round(Gc.Kva*MG.a.Mgb),Math.round(Gc.Hva*MG.a.Mgb),Math.round(Gc.Iva*MG.a.Mgb),Math.round(Gc.Jva*MG.a.Mgb));this.zFb(jc);od.dispose()}};this.f4c=(Zb,jc,Gc,Uc,od)=>{var Od,ze;if(!this.ana(jc))return 8;if(1===Gc)return 32;Zb=jc.contextId===yc.a.view?si.PageReader.instance.rTd(jc):
qo.PageNavigator.instance.su(jc.node);if(!Zb)return 8;Gc=Id.ImageReader.rn(jc);(null===(Od=Eb.App.instance)||void 0===Od?0:Od.HR(Id.ImageReader.ui(Gc)))?(null===(ze=Eb.App.instance)||void 0===ze?0:ze.dRa())?(jc=new BK.a(Zb,this.S0k),jc=NG.UGb(Gc,jc.Jvf())):jc=NG.UGb(Gc):jc=this.Oo.UGb(bl.a.vU(jc),Gc);Zq.t2i.WPb=jc;this.YXc&&this.v1.Hoe(jc);jc=Zq.t2i.fPc(Zb,Eb.App.xCb);if(!jc)return 8;od.MenuItems=jc;return 32};this.L$=(Zb,jc,Gc,Uc,od)=>{if(!this.ana(jc))return 8;if((Uc=Id.ImageReader.rn(jc))&&Id.ImageReader.Oy(Uc))return 2;
if(1===Gc)return 32;if(2!==Gc)return 2;if(!od)return t.ULS.sendTraceTag(571287758,322,10,"SetPictureBorderColor: actionData null"),8;Gc=new cg.GraphTransaction(15);Gc.Db(jc.node);const Od=Zq.N8a.nva(jc.node,od);this.Oo.L$(Uc,od,jc,Od);this.zFb(Uc);Gc.dispose();Zb==Nb.a.K9c&&this.v1.w_a(od);this.Xfd();this.lKa();return 32};this.gja=(Zb,jc,Gc)=>{if(!this.ana(jc))return 8;if(1===Gc)return 32;Eb.App.za.dismissFloatie();Zq.R$a=new Xt.a("PictureBorder",Nb.a.K9c);Zq.R$a.Rlc(0);return 32};this.bka=(Zb,jc,
Gc,Uc,od)=>{if(!this.ana(jc))return 8;if(1===Gc)return 32;if((Zb=Id.ImageReader.rn(jc))&&Id.ImageReader.Oy(Zb))return 2;if(!od)return t.ULS.sendTraceTag(571287759,322,10,"SetPictureBorderWeight: actionData null"),8;Gc=new cg.GraphTransaction(15);Gc.Db(jc.node);this.Oo.bka(Zb,od,jc);this.zFb(Zb);Gc.dispose();this.Xfd();this.lKa();return 32};this.$7a=(Zb,jc,Gc,Uc,od)=>{if(!this.ana(jc))return 8;if(1===Gc)return 32;if((Zb=Id.ImageReader.rn(jc))&&Id.ImageReader.Oy(Zb))return 2;if(!od)return t.ULS.sendTraceTag(571287760,
322,10,"SetPictureBorderStyle: actionData null"),8;Gc=new cg.GraphTransaction(15);Gc.Db(jc.node);this.Oo.$7a(Zb,od,jc);this.zFb(Zb);Gc.dispose();this.Xfd();this.lKa();return 32};this.Gde=(Zb,jc,Gc)=>{if(!this.ana(jc))return 8;if(1===Gc)return 32;Zb=Id.ImageReader.rn(jc);Gc=new cg.GraphTransaction(15);Gc.Db(jc.node);Id.ImageReader.Gac(Zb)&&(this.Oo.Gde(Zb),this.zFb(Zb));Gc.dispose();this.Xfd();this.lKa();return 32};this.AK=b;this.aCc=r;this.pwd=P;Zq.Nh=Mb;Qs.W0f=Zq.uDn}get v1(){return null!=this.rGg?
this.rGg:this.rGg=Ma.a.instance.Oa("Box4.UI.RecentColorsSectionHandler")}get Oo(){this.cba||(this.cba=new CK.a);return this.cba}get M3h(){this.sCe||(this.sCe=new NG);return this.sCe}Tb(b){super.Tb(b);this.vr(b,Nb.a.Fw,this.Fw);b.Xc(Nb.a.Fw,4);this.vr(b,Nb.a.zee,this.zee);this.vr(b,qb.a.jqe,this.vac);b.Xc(qb.a.jqe,4);this.vr(b,qb.a.kqe,this.vac);this.vr(b,qb.a.lqe,this.vac);this.vr(b,qb.a.mqe,this.vac);this.vr(b,qb.a.nqe,this.vac);this.vr(b,qb.a.oqe,this.vac);this.vr(b,qb.a.Wic,this.Wic);b.Xc(qb.a.Wic,
101);this.vr(b,qb.a.imageCrop,this.ipm);b.Xc(qb.a.imageCrop,4);this.vr(b,qb.a.Pob,this.Pob);b.Xc(qb.a.Pob,101);this.vr(b,qb.a.pqi,this.jpm);this.vr(b,qb.a.nUc,this.SVd);this.vr(b,qb.a.gUc,this.SVd);this.vr(b,qb.a.hUc,this.SVd);this.vr(b,qb.a.iUc,this.SVd);this.vr(b,qb.a.f5c,this.Iic);b.Xc(qb.a.f5c,101);this.vr(b,qb.a.tbe,this.Iic);b.Xc(qb.a.tbe,101);this.vr(b,qb.a.ube,this.Iic);b.Xc(qb.a.ube,101);this.vr(b,qb.a.vbe,this.Iic);b.Xc(qb.a.vbe,101);this.vr(b,Nb.a.m9,this.lpm);b.Xc(Nb.a.m9,4);this.vr(b,
Nb.a.rOb,this.rOb);b.Xc(Nb.a.rOb,101);this.vr(b,Nb.a.f4c,this.f4c);b.Xc(Nb.a.f4c,4);this.vr(b,Nb.a.L$,this.L$);b.Xc(Nb.a.L$,4);this.vr(b,Nb.a.K9c,this.L$);b.Xc(Nb.a.K9c,4);this.vr(b,Nb.a.FZf,this.gja);b.Xc(Nb.a.FZf,4);this.vr(b,Nb.a.Zya,this.Zya.bind(this));b.Xc(Nb.a.Zya,4);this.vr(b,Nb.a.bka,this.bka);b.Xc(Nb.a.bka,4);this.vr(b,Nb.a.tOb,this.tOb.bind(this));b.Xc(Nb.a.tOb,4);this.vr(b,Nb.a.$7a,this.$7a);b.Xc(Nb.a.$7a,4);this.vr(b,Nb.a.NTf,this.Gde);b.Xc(Nb.a.NTf,4)}xgf(b,h,r,B){var P;t.ULS.sendTraceTag(593372313,
322,50,"Applying New Image Resize, isCanvas: "+Id.ImageReader.lZd(b));this.AK.Fxa()&&this.AK.fcd(b,h);if(this.uFf(b)){const ca=null===(P=x())||void 0===P?void 0:P.gDb();if((new RF(b,h.node,ca,new LG,y())).resize(r,B))return}Id.ImageReader.Oy(b)?(b=Bb.a.create(),P=new cg.GraphTransaction(15),P.Db(h.node),this.pwd.sNn(h,Id.ImageReader.rn(h),r,B,b),P.eHa(b,1),P.dispose()):Id.ImageReader.Olc(b)?(new BH.a(b,new CH.a)).Rmo(r,B,this.qtn,h):(super.xgf(b,h,r,B),this.Qd.Zs(13))}uO(b){if(!b.el)return!1;var h=
b.node;return(h=Eb.App.instance&&Eb.App.instance.rJb?h instanceof tp.a||h instanceof eN.a?h:null:Object(Ra.a)(tp.a,h))&&sB.n(h)?(Qs.Ic.Yb(bN.a.vn,{["Reason"]:cN.a.AO}),!1):super.uO(b)}static uDn(b){b&&!Zq.Fxb&&(Zq.Nh.z_a(Zq.znb),Zq.Fxb=!0)}kNn(b,h,r,B,P){return P?(P.fzi=b,P.t9=h,P.eSb=r,P.yw=B,P.N9a=Zq.Dlm(P),!0):!1}uFf(b){b=Id.ImageReader.ui(b);const h=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EditsWithGC2",!1);return Eb.App.instance&&Eb.App.instance.HR(b)?(v.AFrameworkApplication.oe("editswithgc2;editswithgc2cf"),
h):!1}y_c(b){Eb.App.zd.Uo&&Eb.App.zd.fq.gG(b.node)}H8m(){this.p6g||(t.ULS.sendTraceTag(20459971,322,50,"Wrap Text UI enabled."),this.p6g=!0)}zFb(b){const h=dN.a.instance.qjf(b);this.AK.Zge(b,h[zf.a.left],h[zf.a.right],h[zf.a.top],h[zf.a.bottom])}get S0k(){return null!=this.oxg?this.oxg:this.oxg=Ma.a.instance.Oa("Box4.ICssColorProvider")}Zya(b,h,r,B,P){var ca;if(!this.ana(h))return 8;2===r&&(b=Id.ImageReader.rn(h),(null===(ca=Eb.App.instance)||void 0===ca?0:ca.HR(Id.ImageReader.ui(b)))?this.M3h.vLo(P,
b):this.Oo.HSj(P,b));return 32}tOb(b,h,r,B,P){var ca;if(!this.ana(h))return 8;2===r&&(b=Id.ImageReader.rn(h),(null===(ca=Eb.App.instance)||void 0===ca?0:ca.HR(Id.ImageReader.ui(b)))?this.M3h.uLo(P,b):this.Oo.GSj(P,b));return 32}Xfd(){v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$("PictureBorderFloodgateSurveyIsEnabled")&&window.setTimeout(()=>{const b=Ma.a.instance.Ta("Common.ISystemInitiatedFeedback");b&&b.execute(h=>{h.logActivity("PictureBorderApplied","PictureBorderFloodgateSurveyIsEnabled")})},
5E3)}static get N8a(){return null!=Zq.nIg?Zq.nIg:Zq.nIg=qi.a.instance}static get t2i(){Zq.eW||(Zq.eW=new $u.a("PictureBorder"),Zq.dGa(Zq.eW));return Zq.eW}static Dlm(b){if(b.fzi)b=1;else switch(b.eSb){case xC.a.none:b=b.t9?3:4;break;case xC.a.square:b=1===b.yw?8:3===b.yw?9:2;break;case xC.a.topAndBottom:b=5;break;case xC.a.tight:b=6;break;case xC.a.through:b=7;break;default:b=0}return b}static dGa(b){b.nX(3,Nb.a.L$);b.nX(4,Nb.a.L$);b.nX(5,Nb.a.K9c);b.nX(6,Nb.a.L$);b.SAb(Hs.a.instance,1)}get YXc(){null==
this.OBa&&(v.AFrameworkApplication.oe("RecentColorSelectionBugFix;RecentColorSelectionBugFixCf"),this.OBa=v.AFrameworkApplication.K?v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecentColorSelectionBugFixIsEnabled",!1):!1);return this.OBa}}Zq.Fxb=!1;Zq.eW=null;Zq.R$a=null;Zq.znb=()=>{Zq.Nh.wjc(Zq.znb);Zq.Fxb=!1;if(Hh.c()){var b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Picture")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Picture"))}else t.ULS.sendTraceTag(509445760,
322,50,"appChrome is undefined")};Object(m.a)(Zq,"ImageActor",Qs,[]);class rn{static get Tk(){return null!=rn.LFg?rn.LFg:rn.LFg=Ma.a.instance.resolve("Box4.IParagraphEditor")}static get SA(){return null!=rn.WFg?rn.WFg:rn.WFg=Ma.a.instance.resolve("Box4.IParagraphIndentationReader")}static get q1(){return rn.Tk.qq}static get ug(){return null!=rn.mJg?rn.mJg:rn.mJg=Ma.a.instance.resolve("Box4.IUndoManager")}static Tb(){const b=v.AFrameworkApplication.va;b.ra(Nb.a.dOb,yc.a.view,Em.a.lw);b.ra(Nb.a.dOb,
yc.a.paragraph,rn.Vma);b.Xc(Nb.a.dOb,1036);b.ra(Nb.a.UDb,yc.a.view,Em.a.lw);b.ra(Nb.a.UDb,yc.a.paragraph,rn.Vma);b.Xc(Nb.a.UDb,1036);b.ra(Nb.a.ahb,yc.a.view,Em.a.lw);b.ra(Nb.a.ahb,yc.a.paragraph,rn.Vma);b.Xc(Nb.a.ahb,1036);b.ra(Nb.a.pjc,yc.a.view,Em.a.lw);b.ra(Nb.a.pjc,yc.a.paragraph,rn.Vma);b.Xc(Nb.a.pjc,1036);b.ra(Nb.a.K6c,yc.a.view,Em.a.lw);b.ra(Nb.a.K6c,yc.a.paragraph,rn.Vma);b.Xc(Nb.a.K6c,1036);b.ra(Nb.a.J3a,yc.a.view,Em.a.lw);b.ra(Nb.a.J3a,yc.a.paragraph,rn.Vma);b.Xc(Nb.a.J3a,1036);b.ra(Nb.a.wkb,
yc.a.view,Em.a.lw);b.ra(Nb.a.wkb,yc.a.paragraph,rn.Vma);b.Xc(Nb.a.wkb,1036);b.ra(Nb.a.I3a,yc.a.view,Em.a.lw);b.ra(Nb.a.I3a,yc.a.paragraph,rn.Vma);b.Xc(Nb.a.I3a,1036);b.ra(Nb.a.che,yc.a.view,rn.bke);b.ra(Nb.a.che,yc.a.paragraph,rn.bke);b.Xc(Nb.a.che,1028);b.ra(Nb.a.Odg,yc.a.view,rn.bke);b.ra(Nb.a.Odg,yc.a.paragraph,rn.bke);b.Xc(Nb.a.Odg,1028);b.ra(Nb.a.zQb,yc.a.view,Em.a.lw);b.ra(Nb.a.zQb,yc.a.paragraph,rn.Vma);b.Xc(Nb.a.zQb,1036);b.ra(Nb.a.dqb,yc.a.view,Em.a.lw);b.ra(Nb.a.dqb,yc.a.paragraph,rn.Vma);
b.Xc(Nb.a.dqb,1036);b.ra(Nb.a.AQb,yc.a.view,Em.a.lw);b.ra(Nb.a.AQb,yc.a.paragraph,rn.Vma);b.Xc(Nb.a.AQb,1036);b.ra(Nb.a.Hig,yc.a.view,Em.a.lw);b.Xc(Nb.a.Hig,1028);b.ra(Nb.a.T9c,yc.a.view,Em.a.lw);b.ra(Nb.a.T9c,yc.a.paragraph,rn.Vma);b.Xc(Nb.a.T9c,1036);b.ra(Nb.a.U9c,yc.a.view,Em.a.lw);b.ra(Nb.a.U9c,yc.a.paragraph,rn.Vma);b.Xc(Nb.a.U9c,1036)}static bke(b,h,r,B,P){2===r&&""===P[Pi.a.Text]&&(b=b===Nb.a.che?Nb.a.J3a:Nb.a.I3a,h=new DD.a,h.value=0,h.unit=Eb.App.EGa?2:1,v.AFrameworkApplication.va.Qb(b,2,
h),Eb.App.za.updateCommandUI());return 32}static Vma(b,h,r,B,P){if(!({Ay:r}=Em.a.bgg(r,h)).returnValue)return r;h=h.node;switch(b){case Nb.a.dOb:rn.q1.O3f(h,!0);break;case Nb.a.UDb:rn.q1.O3f(h,!1);break;case Nb.a.ahb:rn.q1.ahb(h);break;case Nb.a.pjc:rn.q1.jea(h,0);break;case Nb.a.K6c:rn.q1.Tpb(h,0);break;case Nb.a.wkb:case Nb.a.J3a:r=new Ad.GraphIterator;r.set(h);r.zb(11);let ca=P.value;P=P.unit;b===Nb.a.wkb&&(ca=(new Lq.a(P,ca)).Wt+rn.SA.IG(h).Wt,P=1);rn.q1.Iza(r,P,ca);break;case Nb.a.I3a:rn.q1.nQb(h,
P.unit,P.value);break;case Nb.a.zQb:P?(b=(new Lq.a(P.unit,P.value)).Wt,rn.q1.jea(h,b)):rn.SA.URd(h).Wt||rn.q1.jea(h,Yg.OutlineReader.YX(h));break;case Nb.a.dqb:P?(b=(new Lq.a(P.unit,P.value)).Wt,rn.q1.Tpb(h,b)):rn.SA.IG(h).Wt||rn.q1.Tpb(h,Yg.OutlineReader.YX(h));break;case Nb.a.AQb:rn.q1.jea(h,0);break;case Nb.a.T9c:b=P;b=(new Lq.a(b.unit,b.value)).Wt;rn.q1.Heg(h,1,b);break;case Nb.a.U9c:b=P,b=(new Lq.a(b.unit,b.value)).Wt,rn.q1.Heg(h,2,b)}rn.ug.tF();B&&as.a.krb&&(B.Hs|=as.a.Tib(h));return 32}}Object(m.a)(rn,
"IndentationActor",null,[]);class DH extends Pe.a{constructor(){super(!1,!1,!0);this.wih="08448f1f-f728-4e12-95f8-f6333cdb269f";this.Lub="Envelopes"}aNb(b=!1){!0===b&&(this.Lub="Labels",this.wih="43f54585-fdbb-4c80-88eb-3251ae40b275");b={["description"]:`Thank you for showing interest! While we are building this feature, we'd love your feedback.\nHow often do you create ${this.Lub.toLowerCase()}?`,["actionButtonLabel"]:Box4Intl.Box4Strings.l_WordPredictionFeedbackActionLabel};const h=Array(5);h[0]=
{["key"]:"4",["text"]:"Daily"};h[1]={["key"]:"3",["text"]:"Weekly"};h[2]={["key"]:"2",["text"]:"Monthly"};h[3]={["key"]:"1",["text"]:"Rarely"};h[4]={["key"]:"0",["text"]:"Never"};b.selectionOptions={["id"]:"reasonsList",["options"]:h};b.textAreaDescription=`Please tell us more about why you create ${this.Lub.toLowerCase()} and the top 3 capabilities you would like to see in ${this.Lub.toLowerCase()} feature?`;b={["id"]:"MailingsDialog",["bodyControls"]:b};this.Uh(`Interested in the ${this.Lub} Feature?`,
this.dlo.bind(this),b);return new Promise(r=>{this.xMe=r})}dlo(b,h){1===b&&this.dK(h.selectedReason,h.reasonDescription)}dispose(){super.dispose();this.xMe()}dK(b,h){const r={},B={},P={},ca={},ra={};r.appId=2155;r.manifestType="Fps";r.submitTime=(new Date).toISOString();r.source="Client";r.type="Survey";r.clientFeedbackId=Bb.a.create().toString();ra.reason=b;const Qa={},tb={numberOfOptions:5};tb.selectedRating=b;Qa.rating=[tb];Qa.comment=[h];ca.surveySpecificData=JSON.stringify(Qa);P.extendedManifestData=
JSON.stringify(ca);r.application=P;ra.surveyId=this.wih;r.survey=ra;r.telemetry=this.Y_a();r.web=this.MBb();B["Content-Type"]="application/json";this.Bja(JSON.stringify(r),B)}uM(b,h,r,B){h&&b&&B&&r&&B in h&&(b[r]=h[B])}Y_a(){const b=v.AFrameworkApplication.sessionStartInfoSettings,h={};h.officeBuild=v.AFrameworkApplication.buildVersion;h.featureArea="Envelopes and Labels";this.uM(h,b,"audienceGroup","AudienceGroup");this.uM(h,b,"osBuild","OsVersion");this.uM(h,b,"platform","Platform");this.uM(h,b,
"processSessionId","WACSessionID");return h}MBb(){const b=v.AFrameworkApplication.sessionStartInfoSettings,h={};this.uM(h,b,"browser","Browser");this.uM(h,b,"browserVersion","BrowserVersion");this.uM(h,b,"dataCenter","WACDatacenter");return h}Bja(b,h,r=0){let B=0;3<r||(1===r?B=200:1<r&&(B=200+500*(r-1)),v.AFrameworkApplication.lc.Wb(new Me.a(2,1,B,()=>{v.AFrameworkApplication.He.mj("https://petrol.office.microsoft.com/v1/feedback",2,b,h,!1,2,()=>{t.ULS.sendTraceTag(508904273,211,50,"Success sending OCV feedback for {0}",
this.Lub)},()=>{this.Bja(b,h,r+1);t.ULS.sendTraceTag(508904272,211,50,"Failure sending OCV feedback for {0}, attempt {1}",this.Lub,r)},null)})))}}Object(m.a)(DH,"MailingsDialog",Pe.a,[]);class DK{constructor(b){this.ga=b}Tb(){this.ga.ra(qb.a.gjf,yc.a.view,this.IVc.bind(this))}IVc(b,h,r){2===r&&(Object(Ke.c)(qb.a.gjf),(new DH).aNb());return 32}}Object(m.a)(DK,"EnvelopesActor",null,[]);class EK{constructor(b){this.ga=b}Tb(){this.ga.ra(qb.a.labels,yc.a.view,this.IVc.bind(this))}IVc(b,h,r){2===r&&(Object(Ke.c)(qb.a.labels),
(new DH).aNb(!0));return 32}}Object(m.a)(EK,"LabelsActor",null,[]);var FK=c(383),fN=c(66),OG=c(419),gN=c(1220);class Dr{constructor(b){this.IYa=this.WCa=this.dAc=null;this.mmh=!1;this.Gae=h=>{if(this.WCa)if(h===fb.a.Fae)pc.FocusManager.instance().getRegion(Dd.AFrame.I6a).egc();else if(h===fb.a.Eae)pc.FocusManager.instance().getRegion(Dd.AFrame.I6a).cgc();else return 2;else return 2;return 32};this._frame=b}dDo(){if(this.mmh)this.FGi();else{const b=Fb.a.create(v.AFrameworkApplication.K.kb("WopiBootstrapUrl"));
b.D_((h,r)=>{r.succeeded?(this.mmh=!0,this.FGi()):t.ULS.sendTraceTag(40436806,323,10,"Failed to download word.boot.js")});Ya.a.PX(b)}}FGi(){if(this.dAc)t.ULS.sendTraceTag(38130908,323,10,"previewPanel: Tried to launch while already running");else{const b=this._frame.dsa;this.WCa=document.createElement("div");b.parentNode.insertBefore(this.WCa,b);this.IYa=previewPanel.FactoryGlobal.getWordDocumentPanel(this,{fileName:v.AFrameworkApplication.K.kb("FileName"),reactRoot:this.WCa});this.IYa.setWebpackPublicPath(v.AFrameworkApplication.a6);
this.IYa.renderDocumentPanel()}}W1l(b){const h={};h.Container=b;h.BootstrapperUrl=v.AFrameworkApplication.K.kb("WopiBootstrapUrl");h.ApplicationUrl=this._frame.gsb;b={};b.HostName=v.AFrameworkApplication.K.kb("FileSource");b.HostSessionId=v.AFrameworkApplication.K.kb("HostSessionId");b.UserId=v.AFrameworkApplication.K.kb("UserId");b.DocumentClickTime=new Date(this._frame.Smb);b.SessionContext="";b.WdParams={};h.SessionInformation=b;b={};b.FileName=v.AFrameworkApplication.K.kb("FileName");b.FileGetUrl=
"";b.ReadOnly=!1;b.BundleInfo={MajorVersion:1,Url:""};h.WopiPrecheckInfo=b;h.ApplicationCustomSettings={WopiFallbackEnabled:!0,appFrameName:"PreviewPanelApplicationFrame",IsCore:!0,InAppDocumentPreview:!0};b={entryPoint:"WordEditorPreviewPanel"};b.userClickTime=this._frame.Smb;h.Diagnostics=b;b={};b.WopiSrc=v.AFrameworkApplication.K.kb("WopiSrc");b.AccessToken=v.AFrameworkApplication.K.kb("AccessToken");b.AccessTokenTtl=v.AFrameworkApplication.K.kb("AccessTokenTtl");h.WopiInfo=b;h.FnOnInitializeSuccess=
r=>{Dr.jX=r;this.IYa.setMaxPage(Dr.jX.GetPageCount());this.IYa.setCurrentPage(Dr.jX.GetCurrentPage());this.IYa.setPageControlVisible(!0);Dr.jX.RegisterEventHandler("PageChanged",B=>{this.IYa.setCurrentPage(B.newPage)});Dr.jX.RegisterEventHandler("BrowserEvent",B=>{27===B.keyCode?this.closeViewer():B.button&&1!==B.button||this.WCa.click()});r=this._frame.Smb-(new Date).getTime();t.ULS.sendTraceTag(38355488,323,50,"previewPanel: Load finished - {0}",r);this.Tb();pc.FocusManager.instance().EL(Dd.AFrame.I6a,
!0);this.buildFocusRegion();this.jIa(pc.FocusManager.instance().fe(Dd.AFrame.I6a));this.WCa.click()};h.FnOnInitializeFailure=(r,B)=>{t.ULS.sendTraceTag(38273185,323,10,"previewPanel: {1}: {0}",r.toString(),B.toString());this.closeViewer()};return h}buildFocusRegion(){const b=pc.FocusManager.instance();var h=b.getRegion(Dd.AFrame.I6a);h=[2,3];const r=b.fe(Dd.AFrame.I6a),B=new $e.DOMFocusListing(()=>this.WCa);B.Ija=!0;for(const P of h)B.Rm(P);h=b.ina(()=>this.WCa,r,B);h.ITa();h.BP=!0;h.A0a=!0;B.gz(B.xha)}Tb(){v.AFrameworkApplication.va.ra(fb.a.Fae,
yd.a.frame,this.Gae);v.AFrameworkApplication.va.ra(fb.a.Eae,yd.a.frame,this.Gae)}jIa(b){b.nr(pc.FocusManager.instance().WW);b.nr(pc.FocusManager.instance().XW);b.bindAction(pc.FocusManager.instance().WW,fb.a.Fae);b.bindAction(pc.FocusManager.instance().XW,fb.a.Eae)}loadViewer(b){b=this.W1l(b);this.dAc=Microsoft.Office.Word.Viewer.InitializeWopiPending(b);this.dAc.Complete(b.WopiInfo)}closeViewer(){pc.FocusManager.instance().gS(Dd.AFrame.I6a);Dr.jX&&(Dr.jX.Dispose(),Dr.jX=null,v.AFrameworkApplication.va.Wv(fb.a.Fae,
yd.a.frame,this.Gae),v.AFrameworkApplication.va.Wv(fb.a.Eae,yd.a.frame,this.Gae));this.dAc&&(this.WCa.parentNode.removeChild(this.WCa),this.WCa=this.dAc=null)}printAction(){t.ULS.sendTraceTag(38355489,323,50,"previewPanel: Print Called");v.AFrameworkApplication.va.processAction(Nb.a.print,2)}downloadPdfAction(){t.ULS.sendTraceTag(38355490,323,50,"previewPanel: Download to PDF Called");v.AFrameworkApplication.va.processAction(qb.a.BMc,2)}downloadCopyAction(){t.ULS.sendTraceTag(38355491,323,50,"previewPanel: Download Copy Called");
v.AFrameworkApplication.va.processAction(fb.a.downloadACopy,2)}zoomInAction(){if(Dr.jX){let b=Dr.jX.GetZoomLevel();b+=.2;Dr.jX.SetZoomLevel(b)}}zoomOutAction(){if(Dr.jX){let b=Dr.jX.GetZoomLevel();b-=.2;Dr.jX.SetZoomLevel(b)}}setPage(b){if(Dr.jX){const h=Dr.jX.GetPageCount();1>b?(Dr.jX.SetCurrentPage(1),this.IYa.setCurrentPage(1)):1<=b&&b<=h?Dr.jX.SetCurrentPage(b):(Dr.jX.SetCurrentPage(h),this.IYa.setCurrentPage(h))}}static getInstance(b){Dr.gPe||(Dr.gPe=new Dr(b));return Dr.gPe}}Dr.jX=null;Dr.gPe=
null;Object(m.a)(Dr,"PreviewPanelActor",null,[]);class mq{static get nKj(){return null!=mq.GJg?mq.GJg:mq.GJg=v.AFrameworkApplication.K.kb("ClassicViewModePreferenceCookieName")}static Tb(b,h){b.fb(Nb.a.readingMode,yd.a.frame,mq.KLj,128);b.ra(Nb.a.cle,yd.a.frame,mq.KLj);mq.VI=h;b.ra(qb.a.DZc,yd.a.frame,mq.DZc);b.ra(qb.a.FZc,yd.a.frame,mq.FZc);b.ra(qb.a.hge,yd.a.frame,mq.hge);b.fb(qb.a.t5c,yd.a.frame,mq.t5c,96);b.fb(qb.a.I5c,yd.a.frame,mq.I5c,96);b.fb(qb.a.Xbe,yd.a.frame,mq.Xbe,96)}static KLj(b,h,r){if(h.contextId!==
yd.a.frame)return 2;h=ub.App.nn;switch(b){case Nb.a.readingMode:if(!h.gsb)return 8;if(1===r)return kc.SessionStatusManager.instance.Zj?8:32;b=(new Date).getTime();Xk.a.instance.JTn(b);h.Smb=b;v.AFrameworkApplication.K.$("InAppDocumentPreviewIsEnabled")?lr.a.mR(yD.a.modeSwitch,!0,mq.eHn,null,h):lr.a.mR(yD.a.modeSwitch,!0,mq.UQi,null,h);return 32;case Nb.a.cle:return 32;default:return 2}}static UQi(b){OG.a()?mq.gkm(b):mq.Gxj(b)}static gkm(b){const h={};h[G.a.Zzf]=mq.nKj;v.AFrameworkApplication.mP().execute(r=>
{r.Fv(M.a.$zf);r.wSo(M.a.$zf);r.eC(M.a.$zf,B=>{mq.AVk(B,b)});r.sendMessage(M.a.b0l,h)})}static AVk(b,h){b.Values[G.a.Zzf]===mq.nKj&&("true"===b.Values[G.a.ypi]?mq.Gxj(h):(mq.NVo(),mq.yGo()))}static NVo(){if("View"!==appChrome.selectors.getModeSwitcherMode()){const b={activeMode:"View"};v.AFrameworkApplication.oe("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)?appChrome.dispatchUpdateAppModeAndTabsAction(b):
appChrome.api.dispatch(appChrome.actions.updateModeSwitcher(b))}}static yGo(){v.AFrameworkApplication.ov=!0;Eb.App.za.W$(1);Eb.App.za.jb.iu&&Eb.App.za.jb.iu.Zi&&Eb.App.za.jb.iu.MBf();v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ClassViewButtonBugFix",!1)&&Eb.App.za.updateCommandUI();gN.MainView.xBj(v.AFrameworkApplication.K)}static Gxj(b){try{const h=new Sb.a;let r,B;v.AFrameworkApplication.HKj?(r=Eb.App.hostUrl,B=3):(r=b.gsb,B=1);b.Smb&&h.add(v.AFrameworkApplication.gQf,
b.Smb.toString());v.AFrameworkApplication.dEf&&h.add(v.AFrameworkApplication.caf,"1");v.AFrameworkApplication.O6e&&h.add(v.AFrameworkApplication.c5k,"1");h.add(FK.a.grg,FK.a.userSessionData);h.add(v.AFrameworkApplication.Iae,v.AFrameworkApplication.userSessionId);const P=v.AFrameworkApplication.K.kb(v.AFrameworkApplication.Dka);P&&h.add(v.AFrameworkApplication.NDj,P);t.ULS.sendTraceTag(573095942,324,100,"Navigate to view mode");OG.b(v.AFrameworkApplication.K)?OG.d("view",h,OG.c):(r=ia.a.tph(r,h),
v.AFrameworkApplication.HKj?Qd.a.wm(r,Qd.a.esa(B),void 0,"AuthenticationLostDuringSession"):Qd.a.openWindow(B,r,!1,void 0,fN.a.ocj))}catch(h){}}static eHn(b){t.ULS.sendTraceTag(38355487,323,50,"previewPanel: init");(v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("previewPanel"):Ma.a.instance.resolve("Common.IDynamicScriptLoaderProvider").dA.loadScript("previewPanel")).catch(()=>{t.ULS.sendTraceTag(38130907,323,10,"previewPanel: Failed to download script");mq.UQi(b)}).then(()=>
{Dr.getInstance(b).dDo()})}static DZc(b,h,r){if(1===r)return 32;mq.VI.mdg(1);Eb.App.za.updateCommandUI();return 32}static FZc(b,h,r){if(1===r)return 32;mq.VI.mdg(0);Eb.App.za.updateCommandUI();return 32}static hge(b,h,r){if(1===r)return 32;mq.VI.mdg(1===mq.VI.nu?0:1);Eb.App.za.updateCommandUI();return 32}static Xbe(b,h,r,B,P){if(1===r)return 32;P[qg.a.On]=1===mq.VI.nu;return 32}static t5c(b,h,r,B,P){if(1===r)return 32;P[qg.a.On]=1===mq.VI.nu;return 32}static I5c(b,h,r,B,P){if(1===r)return 32;P[qg.a.On]=
!mq.VI.nu;return 32}}mq.VI=null;Object(m.a)(mq,"MainViewModeActor",null,[]);class GK{constructor(b,h,r){this.L$m=(B,P,ca,ra,Qa)=>1===ca?32:(B=this.Zk.g9(P.ik))?(Qa=3===Qa.Rx,this.U6.value.TMh(this.Cam(B),this.nHb(B),Qa),32):2;this.ga=b;this.U6=h;this.Zk=r}Tb(){this.ga.ra(qb.a.vKf,yc.a.view,this.L$m);this.ga.fb(qb.a.zbe,yc.a.view,om.d,96);this.ga.fb(qb.a.wbe,yc.a.view,om.d,96);this.ga.fb(qb.a.xbe,yc.a.view,om.d,96);this.ga.fb(qb.a.ybe,yc.a.view,om.d,96);this.ga.ra(qb.a.O2c,yc.a.view,om.c);this.ga.ra(qb.a.N2c,
yc.a.view,om.c);this.ga.ra(qb.a.q9d,yc.a.view,om.c);this.ga.ra(qb.a.r9d,yc.a.view,om.c)}Cam(b){const h=new fd.DictionaryPropertySet;h.setValue(Mc.a.marginTop,this.Zk.Ioa(b));h.setValue(Mc.a.marginBottom,this.Zk.Nwa(b));h.setValue(Mc.a.marginLeft,this.Zk.CJ(b));h.setValue(Mc.a.marginRight,this.Zk.mL(b));return h}nHb(b){const h=new fd.DictionaryPropertySet;h.setValue(Mc.a.Ko,this.Zk.qu(b));h.setValue(Mc.a.tv,this.Zk.GB(b));return h}}Object(m.a)(GK,"MarginsDialogActor",null,[]);class HK{constructor(b,
h,r,B){this.ga=b;this.hd=h;this.RMa=r;this.d0j=B;this.Uyd={Resume:["Contact","Objective","Experience","Skills and Abilities","Education"],LQj:["Summary","Updates","Challenges","Opportunities","What's Next"],LSj:["Highlights","Itinerary","Food","Activities"],qPj:["Introduction","Step 1","Step 2","Step 3"]}}Tb(){this.ga.fb(qb.a.yPi,yc.a.Uc,this.yFk.bind(this),1028);this.ga.fb(qb.a.dQf,yc.a.Uc,this.LGc.bind(this),1028);this.ga.fb(qb.a.bQf,yc.a.Uc,this.LGc.bind(this),1028);this.ga.fb(qb.a.aQf,yc.a.Uc,
this.LGc.bind(this),1028);this.ga.fb(qb.a.eQf,yc.a.Uc,this.LGc.bind(this),1028);this.ga.fb(qb.a.cQf,yc.a.Uc,this.LGc.bind(this),1028)}yFk(){return null===this.hd.instance?2:32}LGc(b,h,r){var B;if(1===r){if(null===(B=v.AFrameworkApplication.K)||void 0===B?0:B.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateForAppWelcomeExp",!1))return 32}else if(2===r){switch(b){case qb.a.dQf:this.ZXd(this.Uyd.Resume);break;case qb.a.bQf:this.ZXd(this.Uyd.LQj);break;case qb.a.eQf:this.ZXd(this.Uyd.LSj);
break;case qb.a.aQf:this.ZXd(this.Uyd.qPj);break;case qb.a.cQf:this.d0j.g8b(P=>{P.$Ia("WordMiniTemplateSurvey",null)})}return 32}return 2}ZXd(b){const h=new cg.GraphTransaction(15);try{const r=Eb.App.za.jb.rc.ed;let B=r,P;for(P=Ab.a.gp(r);P.moveNext();){const ra=P.currentNode;if(ke.ParagraphReader.MWc(ra)&&ke.ParagraphReader.Xb(ra)){B=ra;break}}h.Db(B);const ca=this.hd.instance.WBd(b,B,!0).toArray();this.gJl(ca)}finally{h.dispose()}}gJl(b){for(const h of b)this.RMa.instance.Cba(h.node,4)}}Object(m.a)(HK,
"MiniTemplateActor",null,[]);class EH{constructor(b){this.gcd=(h,r,B)=>{if(1===B)return 32;h=v.AFrameworkApplication.ua;if(!h)return 32;h.fEd();EH.wao(h);return 32};this.ga=b}Tb(){this.ga.ra(qb.a.gcd,yc.a.view,this.gcd)}static wao(b){const h=v.AFrameworkApplication.K.kb("ModernUxExperimentPreferenceCookieName");var r=v.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");r=Hc.a.uca(h,!r);Hc.a.PIa(h,(!r).toString(),Hc.a.hHa);r?t.ULS.sendTraceTag(576075457,340,50,"User is opting out of the modern ux experience"):
t.ULS.sendTraceTag(576075458,340,50,"User is opting in to the modern ux experience");Ke.d(qb.a.gcd,!0,void 0,void 0,void 0,void 0,[Object.assign(new ha.a,{name:"ModernUxExperimentPreference",string:(!r).toString()})]);b.refreshDocument(null)}}Object(m.a)(EH,"ModernUxActor",null,[]);var hN=c(1088),Rs=c(1728);class IK{constructor(b,h,r,B){this.Qje=Ze.a.Nv(1)/6;this.umo=(P,ca,ra,Qa,tb)=>{if(1===ra)return 32;if(ra=this.Uf.g9(ca.ik)){if(0<=tb&&tb<Rs.a.u1.length){ca=new cg.GraphTransaction(15);ca.Db(ra);
ca.Uj=P;P=Rs.a.u1[tb].axb;Qa=Rs.a.u1[tb].Zwb;const Mb=Rs.a.u1[tb]._marginLeft;tb=Rs.a.u1[tb].$wb;this.V9d(P,Qa,this.Uf.GB(ra))&&this.V9d(Mb,tb,this.Uf.qu(ra))?(this.RE.X7a(ra,P),this.RE.V7a(ra,Qa),this.RE.aka(ra,Mb),this.RE.W7a(ra,tb),this.Vd.Zs(11)):this.JIa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage);ca.dispose()}else return 2;return 32}t.ULS.sendTraceTag(520618525,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ik);return 2};this.vmo=(P,ca,ra,Qa,tb)=>{if(1===ra)return 32;if(ra=
this.Uf.g9(ca.ik)){if(0<=tb&&tb<Rs.a.Qqa.length)ca=new cg.GraphTransaction(15),ca.Db(ra),ca.Uj=P,P=(Qa=this.Uf.cXc(ra))?Rs.a.Qqa[tb].Jta:Rs.a.Qqa[tb].QMa,tb=Qa?Rs.a.Qqa[tb].QMa:Rs.a.Qqa[tb].Jta,this.V9d(this.Uf.Nwa(ra),this.Uf.Ioa(ra),tb)&&this.V9d(this.Uf.CJ(ra),this.Uf.mL(ra),P)?(this.RE.jeg(ra,P),this.RE.ieg(ra,tb),this.Vd.Zs(11)):this.JIa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage),ca.dispose();else return 2;return 32}t.ULS.sendTraceTag(520618524,3009,50,"wordSectionNode is null; context.nextContext = {0}",
ca.ik);return 2};this.Qlo=(P,ca,ra,Qa,tb)=>{if(1===ra)return 32;if(ra=this.Uf.g9(ca.ik)){ca=this.Uf.cXc(ra);Qa=new cg.GraphTransaction(15);Qa.Db(ra);Qa.Uj=P;this.RE.tmj(ra,tb);if(tb&&!ca||!tb&&ca){P=this.Uf.qu(ra);tb=this.Uf.GB(ra);this.RE.jeg(ra,tb);this.RE.ieg(ra,P);P=this.Uf.Ioa(ra);tb=this.Uf.Nwa(ra);const Mb=this.Uf.CJ(ra),Zb=this.Uf.mL(ra);ca?(this.RE.X7a(ra,v.AFrameworkApplication.isRtl?Mb:Zb),this.RE.V7a(ra,v.AFrameworkApplication.isRtl?Zb:Mb),this.RE.aka(ra,v.AFrameworkApplication.isRtl?
tb:P),this.RE.W7a(ra,v.AFrameworkApplication.isRtl?P:tb)):(this.RE.X7a(ra,v.AFrameworkApplication.isRtl?Zb:Mb),this.RE.V7a(ra,v.AFrameworkApplication.isRtl?Mb:Zb),this.RE.aka(ra,v.AFrameworkApplication.isRtl?Math.abs(P):tb),this.RE.W7a(ra,v.AFrameworkApplication.isRtl?tb:P));this.Vd.Zs(11)}Qa.dispose();return 32}t.ULS.sendTraceTag(520618523,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ik);return 2};this.rZd=(P,ca,ra)=>{if(1===ra)return 1===this.oT.nu?32:8};this.Ppb=(P,ca,ra,Qa,
tb)=>{if(1===ra)return 32;ra=this.Uf.g9(ca.ik);if(!ra)return t.ULS.sendTraceTag(520618522,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ik),2;ca=new cg.GraphTransaction(15);ca.Db(ra);ca.Uj=P;P=Math.floor(this.Uf.qu(ra)/720);if(0>tb||tb>P)return 2;this.RE.gQb(ra,tb);this.rmd.execute(Mb=>{Mb.logActivity("WordWebColumnsActivity",null)});ca.dispose();return 32};this.Bge=(P,ca,ra,Qa,tb)=>{if(1===ra)return 32;ra=this.Uf.g9(ca.ik);if(!ra)return t.ULS.sendTraceTag(520618521,3009,50,"wordSectionNode is null; context.nextContext = {0}",
ca.ik),2;ca=new cg.GraphTransaction(15);ca.Db(ra);ca.Uj=P;P=tb[0];Qa=this.Uf.qu(ra);if(720>P||P>Qa)return 2;this.RE.$kc(ra,tb);this.rmd.execute(Mb=>{Mb.logActivity("WordWebColumnsActivity",null)});ca.dispose();return 32};this.zge=(P,ca,ra,Qa,tb)=>{if(1===ra)return 32;ra=this.Uf.g9(ca.ik);if(!ra)return t.ULS.sendTraceTag(520618520,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ik),2;ca=new cg.GraphTransaction(15);ca.Db(ra);ca.Uj=P;P=this.Uf.qu(ra);Qa=this.Uf.hh(ra);if(0>tb||tb>(P-
720*Qa)/(Qa-1))return 2;this.RE.nho(ra,tb);this.rmd.execute(Mb=>{Mb.logActivity("WordWebColumnsActivity",null)});ca.dispose();return 32};this.yge=(P,ca,ra,Qa,tb)=>{if(1===ra)return 32;ra=this.Uf.g9(ca.ik);if(!ra)return t.ULS.sendTraceTag(512370310,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ik),2;ca=new cg.GraphTransaction(15);ca.Db(ra);ca.Uj=P;if(null==tb)return 2;this.RE.Mno(ra,tb);this.rmd.execute(Mb=>{Mb.logActivity("WordWebColumnsActivity",null)});ca.dispose();return 32};
this.cIa=(P,ca,ra,Qa,tb)=>{if(P=this.Uf.g9(ca.ik))return tb.marginTop=this.Uf.Ioa(P),tb.marginBottom=this.Uf.Nwa(P),tb.marginLeft=this.Uf.CJ(P),tb.marginRight=this.Uf.mL(P),tb.Ko=this.Uf.qu(P),tb.tv=this.Uf.GB(P),tb.Jxa=this.Uf.cXc(P),tb.aF=this.Uf.hh(P),tb.una=this.Uf.Sib(P),tb.a1k=this.Uf.rUd(P),tb.xLb=this.s4l(tb),tb.gNb=this.D8l(tb),tb.jJc=this.cSl(tb),32;t.ULS.sendTraceTag(520618519,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ik);return 2};this.phe=(P,ca,ra,Qa,tb)=>{if(1===
ra)return 32;if(ra=this.Uf.g9(ca.ik)){ca=new cg.GraphTransaction(15);ca.Db(ra);switch(P){case Nb.a.X7a:this.RE.X7a(ra,tb);break;case Nb.a.V7a:this.RE.V7a(ra,tb);break;case Nb.a.aka:this.RE.aka(ra,tb);break;case Nb.a.W7a:this.RE.W7a(ra,tb)}this.Vd.Zs(11);ca.dispose();return 32}t.ULS.sendTraceTag(520618518,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ik);return 2};this.anj=(P,ca,ra,Qa,tb)=>{if(1===ra)return 32;if(ra=this.Uf.g9(ca.ik)){ca=new cg.GraphTransaction(15);ca.Db(ra);let Mb=
Qa=0;switch(P){case Nb.a.leg:Mb=tb;this.RE.jeg(ra,Mb);Qa=this.Uf.GB(ra);break;case Nb.a.keg:Qa=tb,this.RE.ieg(ra,Qa),Mb=this.Uf.qu(ra)}this.RE.tmj(ra,Qa<Mb);this.Vd.Zs(11);ca.dispose();return 32}t.ULS.sendTraceTag(520618517,3009,50,"wordSectionNode is null; context.nextContext = {0}",ca.ik);return 2};this.RE=b;this.Vd=h;this.oT=r;this.rmd=B}get Uf(){return Rn.a.instance}t4l(b){var h=Eb.App.rGf,r=h?1:3,B=v.AFrameworkApplication.numberFormat;let P=Rs.a.u1[b].axb;var ca=Rs.a.u1[b].Zwb;var ra=Rs.a.u1[b]._marginLeft;
b=Rs.a.u1[b].$wb;P=h?Ze.a.xVa(P):Ze.a.Yz(P);ca=h?Ze.a.xVa(ca):Ze.a.Yz(ca);ra=h?Ze.a.xVa(ra):Ze.a.Yz(ra);b=h?Ze.a.xVa(b):Ze.a.Yz(b);h=F.a.gFa(P,r,B);ca=F.a.gFa(ca,r,B);ra=F.a.gFa(ra,r,B);r=F.a.gFa(b,r,B);B={};B.top=h;B.bottom=ca;B.left=ra;B.right=r;return B}J$m(b){const h=WordRibbonStrings.PageMarginsTop,r=WordRibbonStrings.PageMarginsBottom,B=WordRibbonStrings.PageMarginsLeft,P=WordRibbonStrings.PageMarginsRight;b=this.t4l(b);return[[h,b.top,r,b.bottom],[B,b.left,P,b.right]]}k3c(b){var h=Eb.App.rGf,
r=h?1:3;const B=v.AFrameworkApplication.numberFormat;let P=Rs.a.Qqa[b].Jta;b=Rs.a.Qqa[b].QMa;P=h?Ze.a.xVa(P):Ze.a.Yz(P);b=h?Ze.a.xVa(b):Ze.a.Yz(b);h=F.a.gFa(b,r,B);r=F.a.gFa(P,r,B);return String.format(WoncaIntl.WoncaStrings.L_PageSizeDescription,h,r)}Tb(){const b=v.AFrameworkApplication.va;b.fb(Nb.a.Y7a,yc.a.view,this.umo,4);b.fb(Nb.a.vUa,yc.a.view,this.vmo,4);b.fb(Nb.a.setOrientation,yc.a.view,this.Qlo,4);b.fb(Nb.a.cIa,yc.a.view,this.cIa,96);b.ra(Nb.a.X7a,yc.a.view,this.phe);b.ra(Nb.a.V7a,yc.a.view,
this.phe);b.ra(Nb.a.aka,yc.a.view,this.phe);b.ra(Nb.a.W7a,yc.a.view,this.phe);b.ra(Nb.a.leg,yc.a.view,this.anj);b.ra(Nb.a.keg,yc.a.view,this.anj);b.fb(Nb.a.rZd,yc.a.view,this.rZd,4);b.ra(Nb.a.Ppb,yc.a.view,this.Ppb);b.ra(Nb.a.Bge,yc.a.view,this.Bge);b.ra(Nb.a.zge,yc.a.view,this.zge);b.ra(Nb.a.yge,yc.a.view,this.yge)}V9d(b,h,r){return r>=b+h+Eb.App.BAa}s4l(b){let h=5;for(let r=0;r<Rs.a.u1.length;r++)if(Rs.a.u1[r].axb===b.marginTop&&Rs.a.u1[r].Zwb===b.marginBottom&&Rs.a.u1[r]._marginLeft===b.marginLeft&&
Rs.a.u1[r].$wb===b.marginRight){h=r;break}return h}D8l(b){let h=5;b=new hN.a(Math.min(b.Ko,b.tv),Math.max(b.Ko,b.tv));for(let r=0;r<Rs.a.Qqa.length;r++)if(this.wzn(b,Rs.a.Qqa[r])){h=r;break}return h}cSl(b){let h=0;switch(b.aF){case 1:h=1;break;case 2:h=2;break;case 3:h=3}return h}wzn(b,h){return jd.a.Lvi(b.QMa,Math.max(h.QMa-this.Qje,0),h.QMa+this.Qje)&&jd.a.Lvi(b.Jta,Math.max(h.Jta-this.Qje,0),h.Jta+this.Qje)}JIa(b){if(!mj.a.DM){const h=new Tf.StandardDialog;h.Cd=0;h.FV(CommonUIStrings.l_DefaultDialogTitle,
b,null)}}}Object(m.a)(IK,"PageActor",null,[326]);class JK{constructor(b){this.ga=b}get oc(){return this.ga}ohe(b,h){let r=0;b?1===b?r=Nb.a.aka:2===b?r=Nb.a.W7a:3===b&&(r=Nb.a.V7a):r=Nb.a.X7a;this.oc.Qb(r,2,h)}vUa(b,h){let r=0;1===b?r=Nb.a.keg:b||(r=Nb.a.leg);this.oc.Qb(r,2,h)}xge(b,h){let r=0;switch(b){case 0:r=Nb.a.Ppb;break;case 1:r=Nb.a.Bge;break;case 2:r=Nb.a.zge;break;case 3:r=Nb.a.yge}this.oc.Qb(r,2,h)}}Object(m.a)(JK,"PageCommands",null,[325]);class KK{constructor(b,h,r){this.vzn=(B,P,ca,ra,
Qa)=>1===ca?32:(B=this.Zk.g9(P.ik))?(Qa=3===Qa.Rx,this.U6.value.xNh(this.Dam(B),this.nHb(B),Qa),32):2;this.ga=b;this.U6=h;this.Zk=r}Tb(){this.ga.ra(qb.a.xKf,yc.a.view,this.vzn);this.ga.fb(qb.a.Obe,yc.a.view,om.d,96);this.ga.fb(qb.a.Nbe,yc.a.view,om.d,96);this.ga.ra(qb.a.u9d,yc.a.view,om.c);this.ga.ra(qb.a.t9d,yc.a.view,om.c)}Dam(b){const h=new fd.DictionaryPropertySet;h.setValue(Mc.a.Ko,this.Zk.qu(b));h.setValue(Mc.a.tv,this.Zk.GB(b));return h}nHb(b){const h=new fd.DictionaryPropertySet;h.setValue(Mc.a.marginTop,
Math.abs(this.Zk.Ioa(b)));h.setValue(Mc.a.marginBottom,Math.abs(this.Zk.Nwa(b)));h.setValue(Mc.a.marginLeft,this.Zk.CJ(b));h.setValue(Mc.a.marginRight,this.Zk.mL(b));return h}}Object(m.a)(KK,"PaperSizeDialogActor",null,[]);class UE{constructor(b,h,r){this.ga=b;this.U6=h;this.zW=r}Tb(){this.ga.fb(Nb.a.Sec,yc.a.view,this.iAn.bind(this),1028);this.ga.ra(Nb.a.Sec,yc.a.paragraph,this.gAn.bind(this));this.ga.fb(Nb.a.RMn,yc.a.view,om.d,96);this.ga.fb(Nb.a.SMn,yc.a.view,om.d,96);this.ga.fb(Nb.a.ZLn,yc.a.view,
om.d,96);this.ga.fb(Nb.a.$Ln,yc.a.view,om.d,96);this.ga.fb(Nb.a.rBo,yc.a.view,om.c,96);this.ga.fb(Nb.a.qBo,yc.a.view,om.c,96);this.ga.fb(Nb.a.Axn,yc.a.view,om.c,96);this.ga.fb(Nb.a.Bxn,yc.a.view,om.c,96);this.ga.fb(Nb.a.mxn,yc.a.view,om.c,96);this.ga.fb(Nb.a.pBo,yc.a.view,om.c,96);this.ga.fb(Nb.a.nxn,yc.a.view,om.c,96)}gAn(b,h,r,B,P){if(1===r)return 3===this.ga.mode||2===this.ga.mode?32:8;b=h.node;h=this.JCj(h);P=3===P.Rx;this.U6.value.BJd(this.KRc(b),this.nHb(h),P);return 32}iAn(b,h,r,B,P){b=h.view.mb;
if(!b||UE.Yf.vcc(b.qg))return 8;if(UE.ah.xAa(ke.ParagraphReader.OU,b.qg))return UE.Ic.Yb(le.a.ef,{["Reason"]:ae.a.AO}),8;if(1===r)return 3===this.ga.mode||2===this.ga.mode?32:8;r=b.ib.lb;h=this.JCj(h);P=3===P.Rx;if(1===r.length&&xe.SelectionEditor.Ze(r.J(0)))return r=r.J(0).node,this.U6.value.BJd(this.KRc(r),this.nHb(h),P),32;b=[];for(B=0;B<r.length;B++){const ca=r.J(B);(!B&&xe.SelectionEditor.Lk(ca)||ke.ParagraphReader.vm(ca)||xe.SelectionEditor.vl(ca))&&b.push(ca.node)}if(!b.length)return 8;r=Array(b.length);
for(B=0;B<b.length;B++)r[B]=this.KRc(b[B]);r=iw.APropertySet.jbi(r);this.U6.value.BJd(r,this.nHb(h),P);return 32}KRc(b){const h=new fd.DictionaryPropertySet;h.setValue(Yc.a.yw,ke.ParagraphReader.Lx(b));const r=this.zW.nQa(b);var B=r.lineSpacing;h.setValue(Yc.a.o5a,B.unit);h.setValue(Yc.a.xa,B.value);B=r.beforeSpacing;h.setValue(Yc.a.Khc,B.unit);h.setValue(Yc.a.Lhc,B.value);B=r.afterSpacing;h.setValue(Yc.a.Ihc,B.unit);h.setValue(Yc.a.Jhc,B.value);h.setValue(Yc.a.r3c,r.sw);h.setValue(dd.a.keepWithNext,
ke.ParagraphReader.keepWithNext(b));h.setValue(dd.a.widowControl,ke.ParagraphReader.ypc(b));h.setValue(dd.a.keepTogether,ke.ParagraphReader.keepTogether(b));return h}static get Yf(){return Wh.a.instance}static get ah(){return An.ContextSetEditor.instance}static get Ic(){return Nh.a.instance}}Object(m.a)(UE,"AParagraphDialogActor",null,[]);class LK extends UE{constructor(b,h,r,B,P){super(b,h,r);this.Zk=B;this.ep=P}Tb(){super.Tb();this.ga.fb(Nb.a.Z5i,yc.a.view,om.d,96);this.ga.fb(Nb.a.$5i,yc.a.view,
om.d,96);this.ga.fb(Nb.a.eMn,yc.a.view,om.d,96);this.ga.fb(Nb.a.Gym,yc.a.view,om.c,96);this.ga.fb(Nb.a.Iym,yc.a.view,om.c,96);this.ga.fb(Nb.a.nBo,yc.a.view,om.c,96);this.ga.fb(Nb.a.oBo,yc.a.view,om.c,96);this.ga.fb(Nb.a.uxn,yc.a.view,om.c,96);this.ga.fb(Nb.a.Dxn,yc.a.view,om.c,96);this.ga.fb(Nb.a.Cxn,yc.a.view,om.c,96);this.ga.fb(Nb.a.sBo,yc.a.view,om.c,96);this.ga.fb(Nb.a.TMn,yc.a.view,om.d,96);this.ga.fb(Nb.a.UMn,yc.a.view,om.d,96)}JCj(b){return this.Zk.g9(b.ik)}KRc(b){const h=super.KRc(b);var r=
this.ep.wU(b);const B=this.ep.IG(b);h.setValue(Yc.a.QHa,1);h.setValue(Yc.a.RHa,r.Wt-B.Wt);r=this.ep.$2a(b);h.setValue(Yc.a.nob,r.unit);h.setValue(Yc.a.oob,r.value);b=this.ep.V$b(b);b.specialIndentType&&(h.setValue(Yc.a.X5,b.specialIndentType),h.setValue(Yc.a.LUa,b.unit),h.setValue(Yc.a.MUa,b.value));return h}nHb(b){const h=new fd.DictionaryPropertySet;h.setValue(Mc.a.Ko,this.Zk.qu(b));h.setValue(Mc.a.tv,this.Zk.GB(b));h.setValue(Mc.a.marginTop,Math.abs(this.Zk.Ioa(b)));h.setValue(Mc.a.marginBottom,
Math.abs(this.Zk.Nwa(b)));h.setValue(Mc.a.marginLeft,this.Zk.CJ(b));h.setValue(Mc.a.marginRight,this.Zk.mL(b));return h}}Object(m.a)(LK,"ParagraphDialogActor",UE,[]);class MK extends Sys.EventArgs{constructor(b,h){super();this.node=b;this.Kzi=h}}Object(m.a)(MK,"AfterPasteEventArgs",Sys.EventArgs,[]);class NK{constructor(b){this.LFe=null;this.mld=b}get cPd(){return null!=this.$zg?this.$zg:this.$zg=Ma.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor")}get EZd(){this.LFe||(this.LFe=
!!v.AFrameworkApplication.K&&v.AFrameworkApplication.K.$(Bs.a.aSh));return this.LFe}uJn(b){if(b&&Uf.OutlineElementReader.Eh(b.wwa)&&Uf.OutlineElementReader.Eh(b.fmb)){this.PJn(b);var h=new Nf.a;for(h.kd(b.wwa);h&&h.currentNode;){const r=this.ETd(h),B=ke.ParagraphReader.Xb(r);B&&ke.ParagraphReader.qgb(r)&&this.sJn(r);const P=h.currentNode.id===b.fmb.currentNode.id;B&&this.EZd&&r.xj.Lha(r.type).uce(new MK(r,P));if(P)break;ig.OutlineElementNavigator.ns(h,!1,!1)}}}sJn(b){t.ULS.sendTraceTag(590435214,
307,50,"ProcessParagraphForExternalContent: Processing the pasted the external content (oEmbed) component via external paste flow.");const h=b.$hc;b=Ue.a.Rc(b,0);ot.FWc(h)?this.cPd.D$d(b,h):this.mld.D$d(b,h)}PJn(b){if(b.wwa.currentNode&&b.fmb.currentNode&&b.wwa.currentNode.id===b.fmb.currentNode.id){const h=this.ETd(b.wwa);ke.ParagraphReader.Xb(h)?this.wJn(h,b.$Bn,b.ZBn):t.ULS.sendTraceTag(590955995,307,50,"ProcessSinglePastedHyperlink: No paragraph node pasted.")}}wJn(b,h,r){t.ULS.shipAssertTag(590956771,
307,0<=h);t.ULS.shipAssertTag(590958592,307,0<=r);var B=ke.ParagraphReader.text(b);if(""!==B){var P=Ue.a.createTextRange(b,h,r);P=Tg.a.Ez(P,!1);if(1===P.length){const ca=P[0];P=B.substring(h,r).trim();B=B.substring(ca.cpBegin,ca.cpEnd).trim();h=P===B;P=Ue.a.createTextRange(b,ca.cpBegin,ca.cpEnd);if(ca.hyperlink&&h&&!Tg.a.RRa(B))b=ca.hyperlink.url;else if(h)b=B;else{t.ULS.sendTraceTag(590958596,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because the pasted text is not equal to the pasted hyperlink display text");
return}ot.FWc(b)?this.cPd.UQa(P,b,!1):this.mld.UQa(P,b,!1)}else t.ULS.sendTraceTag(590958597,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because either no hyperlinks or more than one hyperlink got pasted  Hyperlinks pasted = {0}",P.length)}}ETd(b){const h=ig.OutlineElementNavigator.Ee(b);ig.OutlineElementNavigator.Yd(b);return h}}Object(m.a)(NK,"PastedContentsProcessorPostMergeAfterPaste",null,[324]);class FH extends ni{constructor(b,h,r,B,P,ca,ra,Qa){super(B);this.PRe=7;this.jw=
this.Vuc=null;this.sEe=0;this.pEe=b;this.Ok=h;this.Cn=r;this.je=P;this.VUj=ra;this.ZYa=Qa;this.B3=this.je.rSa("UserAction","WordIgnoreAll")}ufg(b){this.pEe.xLi();this.Vuc=this.Cn.Boa(b);this.ZYa.hqi(this.Vuc,null,!1);return this.pEe.nDj(this.Vuc)?(this.B3.start(),this.jw=new cg.GraphTransaction(15),this.jw.Db(b.node),!0):!1}Mae(b){this.$Nb(b.node);return!0}D4c(b){this.$Nb(b);return!0}Nae(b){this.$Nb(b.node)}Dlg(b){this.jw.dispose();this.Vuc.errorDetails.Arb(b.actionId);this.B3.stop();t.ULS.sendTraceTag(19779652,
324,50,String.format("Ignore-all succeeded. Actual ignored errors: {0}. Duration in milliseconds: {1}. Type: {2}",this.sEe,this.B3.oi,this.Vuc.errorDetails.proofingType));return!0}qmc(b,h){if(super.qmc(b,h))return!0;b=b.role;return 9===b||10===b||13===b||7===b||8===b}Dfi(b){if(b&&b.type!==this.PRe){const h=Ad.GraphIterator.eb(b);return h.zb(this.PRe)?h.jd(this.PRe):b}return b}wOm(b,h){return this.pEe.B$c(h.errorDetails)&&!this.Ok.x9(Ue.a.createTextRange(b,h.Ec,h.end))}$Nb(b){if(b){var h=this.Cn.E4(b,
r=>this.wOm(b,r));this.VUj?this.Cn.fpb(b,h,!0):0<h.length&&(b.ol(4,!0),this.Cn.eMb(b));this.sEe+=h.length}}}Object(m.a)(FH,"IgnoreAllCallbackSteps",ni,[]);class OK{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc){this.p5c=(Uc,od,Od,ze,de)=>{if(1===Od)return 32;Uc=this.NI.zFa(od.view.mb.qg);if(Uc=lj.a.tg(Uc))de[pj.a.LabelText]=Uc.displayName;return 32};this.cpa=(Uc,od,Od,ze,de,ee)=>{const je=new FH(this.A6j,this.Ok,this.Cn,this.Fe,this.je,this.OW,0,this.ZYa);return new Vy(Uc,od,Od,ze,de,ee,je,this.ga,
this.hb,this.Fe,"IgnoreAllOperation")};this.bEb=(Uc,od,Od,ze,de,ee)=>{const je=new FH(this.o1j,this.Ok,this.Cn,this.Fe,this.je,this.OW,1,this.ZYa);return new Vy(Uc,od,Od,ze,de,ee,je,this.ga,this.hb,this.Fe,"DoNotCheckThisCritiqueType")};this.ga=b;this.Ok=h;this.hb=r;this.Fe=B;this.Cn=P;this.NI=ca;this.je=ra;this.A6j=Qa;this.o1j=tb;this.pYb=Mb.RXc;this.OW=Mb;this.ZYa=Zb;this.sGe=jc;this.w$a=Gc}Tb(){this.sGe&&(rs.QB()?this.ga.fb(Nb.a.cpa,yc.a.Uc,this.Twm.bind(this),1028):this.ga.HT(Nb.a.cpa,yc.a.view,
this.cpa,1028));this.pYb&&this.ga.HT(Nb.a.bEb,yc.a.view,this.bEb,1028);this.ga.fb(qb.a.p5c,yc.a.view,this.p5c,96)}Twm(b,h,r,B,P){if(1===r)return 32;t.ULS.sendTraceTag(528023773,324,50,"Ignore All error triggered for AL");this.w$a.gyf(P?P:h,null,Ko.b.IgnoreAll);return 32}}Object(m.a)(OK,"ProofingActor",null,[]);var iN=c(1730);class jD{constructor(b,h,r,B,P,ca,ra,Qa,tb){this.Lp=this.pNa=this.Yxd=this.Zxd=null;this.vE=this.Qr=this.Op=0;this.lbb=this.kbb=!1;this.pba=this.mab=this.lab=this.jab=this.nab=
0;this.Zwd=null;this.Yea=this.PW=this.Vq=this.xQ=0;this.Yl=null;this.Pvb=0;this.uYf=Mb=>{var Zb;if(5===this.Pvb){const jc=Object.assign(new hc.a,{extendedProperties:new Map});jc.extendedProperties.set("status",Mb.data.status.toString());jc.extendedProperties.set("httpStatus",Mb.data.Se.toString());(null===(Zb=v.AFrameworkApplication.K)||void 0===Zb?0:Zb.$("ShouldLogPicturesExtendedHealthKpis"))?(Zb={name:jk.c.iXd,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,
additionalValues:jc},jc.extendedProperties.set("ErrorLevel","warning"),this.rg.logKpiFailure({kpiName:jk.c.kbc,errorName:"PictureSwordRequestFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:jc},optionalVeto:Zb})):va.Health.instance.recordQosError("PictureSwordRequestFailed",["ImageEditFailed"],!1,!0,!1,!1,jc)}t.ULS.sendTraceTag(25182720,322,15,"Request failed: {0}. PlaceholderKind: {1}",{["Status"]:Mb.data.status,["HttpStatus"]:Mb.data.Se,["Id"]:Mb.data.id,["ResponseData"]:Mb.data.se},
TE.a[this.Pvb]);this.Pee()};this.Vj=r;this._image=b;this._context=h;this.Qpd=!1;(b=jD.hi.su(h.node))&&b.wf(Mc.a.iIf)&&(this.Qpd=!0);this.Nwc=B.$("ImageDataURLPresentationIsEnabled");this.Cfk=B.$("WordOartPostRequestIsEnabled");this.Ca=B;this.rr=P;this.je=ca;this.Vd=ra;this.Qm=Qa;this.oK=tb;this.rg=Bi.a.getInstance(jk.a);this.uBm();this.t8d=this.ehc.bind(this)}uBm(){this.Lp="";this.Op=Id.ImageReader.oF(this._image);this.Qr=Id.ImageReader.JG(this._image);this.pba=Id.ImageReader.vjb(this._image);this.vE=
Id.ImageReader.o0(this._image);var b=Id.ImageReader.Goa(this._image);this.kbb=b.nib;this.lbb=b.bFa;b=Id.ImageReader.yca(this._image);this.nab=Math.max(b.top,0);this.jab=Math.max(b.bottom,0);this.lab=Math.max(b.left,0);this.mab=Math.max(b.right,0);this.Yl=Bb.a.nil;this.pNa=null;this.Pvb=Id.ImageReader.ui(this._image)}IEd(b,h){return(new iN.a(this.rr,this.Pvb,this.Ca,this.Op,this.Qr,this.vE,this.pba,this.nab,this.jab,this.lab,this.mab,this.kbb,this.lbb,this.Qpd)).build(this._context.node,this._image,
b,h)}resize(b,h){this.Lp="Resize";this.oke();kh.a.mark(this.D$b());this.Op=b;this.Qr=h;this.sendMessage(!1,this.t8d)}Fw(b){this.Lp="Styles";this.oke();kh.a.mark(this.D$b());this.pba=b;this.sendMessage(!1,this.t8d)}nmo(b,h,r){this.Lp="Rotation";this.oke();this.vE=b;this.kbb=h;this.lbb=r;this.sendMessage(!1,this.t8d)}mmo(b,h){this.Lp="SwordRequestManager";this.oke();this.pNa=b;this.vE=h.angle;this.Op=h.width;this.Qr=h.height;this.pba=h.styleId;this.nab=h.top;this.jab=h.bottom;this.lab=h.left;this.mab=
h.right;this.Yl=h.JX;this.sendMessage(!1,this.t8d)}sendMessage(b,h){if(this.Ca.$("WordOartForceOutboundAfterImageSuccessIsEnabled")){var r=this.Ggb(r);const B=Id.ImageReader.Noa(this._image,this.Ca,this.rr);B?Ex.a.bqb(this._image,B,4):this._image.setValue(lh.a.IPa,!0);r.dispose()}this.Pvj(b);kh.a.mark(this.D$b());b=new Xa.QueryStringBuilder(this.IEd(b,!0));this.Nwc&&b.Be(Xg.a.QPh,"true");this.Cfk?(r=new Xa.QueryStringBuilder("WordOart.ashx"),v.AFrameworkApplication.He.mj(r.toString(),2,b.toString(),
{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!0,0,h,this.uYf,null)):v.AFrameworkApplication.He.mj(b.toString(),1,"",null,!0,0,h,this.uYf,null)}Ggb(b){b=this.Yl&&this.Yl!==Bb.a.nil?new cg.GraphTransaction(7,Nb.a.m9):new cg.GraphTransaction(15);b.Db(this._context.node);return b}get lPj(){const b=new cg.GraphTransaction(3);b.Db(this._context.node);return b}Pee(){this.kNc();this.LMd();const b=this.lPj;var h=Id.ImageReader.kFa(this._image,this._context.node.Mc,this.Ca,this.rr);this._image.setValue(lh.a.IPa,
!1);this._image.setValue(Yc.a.oUc,h);this._image.setValue(Yc.a.JU,-1);this._image.setValue(lh.a.G5,1);h=Id.ImageReader.Noa(this._image,this.Ca,this.rr);this.Ca.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&(this._image.removeProperty(Yc.a.W$d),this._image.removeProperty(Yc.a.U$d),h&&Ex.a.bqb(this._image,h,3));b.dispose();jD.Ep();this.pNa&&this.pNa()}Pvj(b){this.je&&(b=String.format("Send Single {0} SWORD Request.",b?"PNG":"XML"),this.Zxd=this.je.Zf("WebServiceCall",b))}kNc(){this.Zxd&&(this.Zxd.stop(),
this.Zxd=null)}oke(){if(this.je){const b=String.format("Send SWORD {0} Request. PlaceholderKind: {1}",this.Lp,TE.a[this.Pvb]);this.Yxd=this.je.Zf("WebServiceCall",b)}}LMd(){this.Yxd&&(this.Yxd.stop(),this.Yxd=null)}static get hi(){return qo.PageNavigator.instance}static Ep(){const b=new Tf.StandardDialog;b.Cd=0;b.vx(hh.a.rDn,Box4Intl.Box4Strings.l_PictureStyleErrorTitle,Box4Intl.Box4Strings.l_PictureStyleError,null);Eb.App.za&&Eb.App.za.updateCommandUI()}}Object(m.a)(jD,"RenderedImageEditOperation",
null,[353]);var GH=c(301),SF=c(510);class PK extends jD{constructor(b,h,r,B,P,ca,ra,Qa,tb){super(b,h,r,B,P,ca,ra,Qa,tb);this.rg=Bi.a.getInstance(ov.a)}sendMessage(b,h){Object(GH.a)(()=>{let r;r=this.Ggb(r);this._image.setValue(lh.a.G5,0);r.dispose()});this.Pvj(b);kh.a.mark(this.D$b());b=new Xa.QueryStringBuilder("WordOart.ashx");this.UZg=this.Djb(!0,!1);b=new SF.a(b.toString(),2,this.Djb(!1,!1),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!1,2,null,null,null,null,null,null,
null,null,null,null,null,null,["Content-Type"],null,"text");v.AFrameworkApplication.He.send(b).fza(h,r=>{this.uYf(r)})}ehc(b){try{var h=JSON.parse(b.data.ZTa);this.u5j=h[Xg.a.ESc];this.dpk=h[Xg.a.width];this.O5j=h[Xg.a.height];this.ELg=h[Xg.a.rGc];this.Guc=Array(4);this.Guc[zf.a.left]=h[Xg.a.vhb];this.Guc[zf.a.right]=h[Xg.a.whb];this.Guc[zf.a.top]=h[Xg.a.xhb];this.Guc[zf.a.bottom]=h[Xg.a.uhb];this.u3g=void 0!==h[Xg.a.Xxa]?"true"===h[Xg.a.Xxa].toLowerCase():null;Object(GH.a)(()=>{this.Fdd();this._context.node.Yi().contentReplicator.forceOutbound(()=>
{this.uFl()},null,null)})}catch(r){Ex.a.TIa&&(b=Object.assign(new hc.a,{extendedProperties:new Map([["Renderer",ov.b.VEa],["Exception",r.message],["Operation",this.Lp]])}),h={name:ov.d.zVh,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel","warning"),this.rg.logKpiFailure({kpiName:ov.d.iMd,errorName:"DrawingResponseInvalid",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:h})),
t.ULS.sendTraceTag(526528851,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",r.message,this.Lp,Id.ImageReader.ui(this._image)),this.Pee()}}H7d(){t.ULS.sendTraceTag(521175366,322,15,"onImageSuccess should not have been called")}Fdd(){let b;b=this.Ggb(b);this._image.setValue(dd.a.nP,this.u5j);this.ELg&&this._image.setValue(dd.a.TCd,this.ELg);this._image.setValue(dd.a.Zwa,this.dpk);this._image.setValue(dd.a.$wa,this.O5j);this._image.setValue(dd.a.xQa,this.Guc);
this.H6j&&this._image.setValue(Yc.a.kIb,this.H6j);Ex.a.bqb(this._image,this.UZg,3);this._image.setValue(Mc.a.shb,this.UZg);this.u3g?this._image.setValue(dd.a.k4a,this.u3g):this._image.removeProperty(dd.a.k4a);this.YXk();b.dispose()}YXk(){this._image.removeProperty(Yc.a.ft);this._image.removeProperty(Yc.a.JU);this._image.removeProperty(Yc.a.W$d);this._image.removeProperty(Yc.a.U$d)}uFl(){this.oK.IIa(this._context);if(this.Yl&&this.Yl!==Bb.a.nil){var b=this._context.node.Yi();const h=new V.a(this.Yl,
1);this.Qm.g5b(b,h)}this.Vd.Zs(13);Ex.a.TIa&&(b=new Map([["Renderer",ov.b.VEa],["Type",Id.ImageReader.ui(this._image).toString()]]),this.rg.logKpiSuccess({kpiName:ov.d.iMd,optionalProperties:{additionalValues:{durationMs:void 0,inStaging:void 0,extendedProperties:b}},blockFutureEmissionDurationInMs:3E5}));this.kNc();this.LMd();kh.a.mark(this.C$b());Object(GH.a)(()=>{let h;h=this.Ggb(h);this._image.setValue(lh.a.G5,1);h.dispose()});this.pNa&&this.pNa()}Djb(b,h){b=new Xa.QueryStringBuilder(this.IEd(b,
h));b.Be(Xg.a.qXd,"true");return b.toString()}D$b(){return 51511}C$b(){return 51512}}Object(m.a)(PK,"RenderedGraphicEditOperation",jD,[]);class QK extends jD{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb){super(b,h,r,B,P,ca,ra,Qa,tb);this.QUg=null;this.H7d=Zb=>{const jc=this.IEd(!0,!1);let Gc;Gc=this.Ggb(Gc);this._image.setValue(Mc.a.sGc,this.Zwd);var Uc=Ma.a.instance.Oa("Box4.IFeatureHelper");if(Ex.a.TIa){const ze=new Map([["Renderer",ov.b.legacy],["Type",Id.ImageReader.ui(this._image).toString()]]);this.rg.logKpiSuccess({kpiName:ov.d.yVh,
optionalProperties:{additionalValues:{durationMs:void 0,inStaging:void 0,extendedProperties:ze}},blockFutureEmissionDurationInMs:3E5})}Uc&&Uc.isFeatureEnabled(50)&&this._image.setValue(Mc.a.QNd,this.QUg);this.Ca.$("WordEditorImageRotateIsEnabled")&&this.Ca.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Vj.ahe(this._image,this.vE,this.kbb,this.lbb);const od=Id.ImageReader.Noa(this._image,this.Ca,this.rr),Od=()=>{od&&Ex.a.bqb(this._image,od,3);Ex.a.bqb(this._image,jc,3);this.Vj.Zge(this._image,
Ze.a.DG(this.xQ),Ze.a.DG(this.PW),Ze.a.DG(this.Vq),Ze.a.DG(this.Yea));this._image.setValue(Mc.a.shb,jc);Id.ImageReader.Oy(this._image)||this._image.setValue(Mc.a.$Fa,Cp.a.rendered);this.Vj.Hge(this._image,this.Op,this.Qr);this.Ca.$("WordEditorImageRotateIsEnabled")&&!this.Ca.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Vj.ahe(this._image,this.vE,this.kbb,this.lbb);2===Zb.data.status&&Id.ImageReader.O0(Zb.data.se)&&(this._image.setValue(Yc.a.ft,Zb.data.se),Zb.data.request&&this._image.setValue(Yc.a.kIb,
Ex.a.VNc("POST"===Zb.data.request.get_httpVerb()?Zb.data.request.get_body():Zb.data.request.get_url())));this.pNa&&this.pNa();this.oK.IIa(this._context);if(this.Yl&&this.Yl!==Bb.a.nil){const ze=this._context.node.Yi(),de=new V.a(this.Yl,1);this.Qm.g5b(ze,de)}this.Vd.Zs(13);this.kNc();this.LMd();kh.a.mark(this.C$b())};if(this.Ca.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Yl&&this.Yl!==Bb.a.nil&&(Uc=this._context.node.Yi())&&Uc.contentReplicator){Gc.dispose();Uc.contentReplicator.forceOutbound(()=>
{let ze;ze=this.Ggb(ze);Od();ze.dispose()},null,null);return}Od();Gc.dispose()};this.rg=Bi.a.getInstance(ov.a);this.pQe=Mb}D$b(){return 51511}C$b(){return 51512}ehc(b){try{var h=JSON.parse(b.data.se);const P=Sys.Net.XMLDOM("string"===typeof h[Xg.a.Rsh]?h[Xg.a.Rsh]:null);this.Zwd="string"===typeof h[Xg.a.UCd]?h[Xg.a.UCd]:null;const ca=Ma.a.instance.Oa("Box4.IFeatureHelper");ca&&ca.isFeatureEnabled(50)&&(this.QUg="string"===typeof h[Xg.a.m8b]?h[Xg.a.m8b]:null);Z.a.gt&&P.setProperty("SelectionNamespaces",
"xmlns:mc='"+$d.a.oCk+"'");const ra=P.selectSingleNode("/mc:AlternateContent");if(!ra)throw ur.a.argument("Alternate content element could not be retrieved!");const Qa=ra.firstChild;if(!Qa)throw ur.a.argument("Alternate content choice element could not be retrieved!");const tb=Qa.firstChild;if(!tb)throw ur.a.argument("Drawing element could not be retrieved!");var r=tb.firstChild;if(!r)throw ur.a.argument("Inline element could not be retrieved!");h=b=null;const Mb=RegExp("effectExtent"),Zb=RegExp("extent");
for(const Gc of r.childNodes)-1!==Gc.nodeName.search(Mb)&&(b=Gc),-1!==Gc.nodeName.search(Zb)&&(h=Gc);if(!b||!h)throw ur.a.argument("Effect extent or extent could not be retrieved!");this.xQ=parseInt(b.selectSingleNode("@l").text);this.PW=parseInt(b.selectSingleNode("@r").text);this.Vq=parseInt(b.selectSingleNode("@t").text);this.Yea=parseInt(b.selectSingleNode("@b").text);const jc=mf.c(this.vE);if(45<=jc&&135>=jc||225<=jc&&315>=jc){const Gc=parseInt(h.selectSingleNode("@cx").text);var B=parseInt(h.selectSingleNode("@cy").text);
r=Gc/2;B/=2;this.xQ-=r-B;this.PW+=r-B;this.Vq-=B-r;this.Yea+=B-r}}catch(P){Ex.a.TIa&&(B=Object.assign(new hc.a,{extendedProperties:new Map([["Renderer",ov.b.legacy],["Exception",P.message],["Operation",this.Lp]])}),r={name:ov.d.ftl,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:B},B.extendedProperties.set("ErrorLevel","warning"),this.rg.logKpiFailure({kpiName:ov.d.yVh,errorName:"DrawingResponseInvalid",optionalProperties:{isIntentional:!1,
isInternal:!0,additionalValues:B},optionalVeto:r}));t.ULS.sendTraceTag(42079129,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",P.message,this.Lp,TE.a[this.pQe]);this.Pee();return}this.sendMessage(!0,this.H7d)}}Object(m.a)(QK,"RenderedDrawingEditOperation",jD,[]);class RK extends jD{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb){super(b,h,r,B,P,ca,ra,Qa,tb);this.cba=null;this.H7d=jc=>{var Gc;const Uc=this.IEd(!0,!1);let od;od=this.Ggb(od);this._image.setValue(Mc.a.yNb,
this.Zwd);const Od=Id.ImageReader.Noa(this._image,this.Ca,this.rr);(null===(Gc=v.AFrameworkApplication.K)||void 0===Gc?0:Gc.$("ShouldLogPicturesExtendedHealthKpis"))&&this.rg.logKpiSuccess({kpiName:jk.c.kbc});const ze=()=>{Od&&Ex.a.bqb(this._image,Od,3);Ex.a.bqb(this._image,Uc,3);this.Vj.Zge(this._image,Ze.a.DG(this.xQ),Ze.a.DG(this.PW),Ze.a.DG(this.Vq),Ze.a.DG(this.Yea));this._image.setValue(Mc.a.shb,Uc);Id.ImageReader.Oy(this._image)||this._image.setValue(Mc.a.$Fa,Cp.a.rendered);this._image.setValue(Mc.a.U3c,
this.pba);this._image.setValue(Yc.a.Lxm,-1);this.rd.isFeatureEnabled(90)&&Id.ImageReader.Gac(this._image)&&this.Oo.Gde(this._image);this._image.setValue(lh.a.IPa,!1);this.Vj.Hge(this._image,this.Op,this.Qr);this.Ca.$("WordEditorImageRotateIsEnabled")&&this.Vj.ahe(this._image,this.vE,this.kbb,this.lbb);this.Ca.$("WordEditorImageCropIsEnabled")&&this.Vj.Kdg(this._image,this.nab,this.jab,this.lab,this.mab);2===jc.data.status&&Id.ImageReader.O0(jc.data.se)&&(this._image.setValue(Yc.a.ft,jc.data.se),jc.data.request&&
this._image.setValue(Yc.a.kIb,Ex.a.VNc("POST"===jc.data.request.get_httpVerb()?jc.data.request.get_body():jc.data.request.get_url())));this.pNa&&this.pNa();this.oK.IIa(this._context);if(this.Yl&&this.Yl!==Bb.a.nil){const de=this._context.node.Yi(),ee=new V.a(this.Yl,1);this.Qm.g5b(de,ee)}this.Vd.Zs(13);this.kNc();this.LMd();kh.a.mark(this.C$b())};if(this.Ca.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Yl&&this.Yl!==Bb.a.nil&&(Gc=this._context.node.Yi())&&Gc.contentReplicator){od.dispose();
Gc.contentReplicator.forceOutbound(()=>{let de;de=this.Ggb(de);ze();de.dispose()},null,null);return}ze();od.dispose()};this.pQe=Mb;this.rd=Zb}D$b(){return 7988}C$b(){return 7989}get Oo(){this.cba||(this.cba=new CK.a);return this.cba}ehc(b){var h;try{const r=b.data.Oja;this.Zwd=b.data.se;Z.a.gt&&r.setProperty("SelectionNamespaces","xmlns:pic='"+$d.a.pDn+"'");const B=r.selectSingleNode("/pic:wordEdit/pic:spPr").nextSibling;this.xQ=parseInt(B.selectSingleNode("@l").text);this.PW=parseInt(B.selectSingleNode("@r").text);
this.Vq=parseInt(B.selectSingleNode("@t").text);this.Yea=parseInt(B.selectSingleNode("@b").text)}catch(r){b=Object.assign(new hc.a,{extendedProperties:new Map});b.extendedProperties.set("exception",r.message);b.extendedProperties.set("operation",this.Lp);(null===(h=v.AFrameworkApplication.K)||void 0===h?0:h.$("ShouldLogPicturesExtendedHealthKpis"))?(h={name:jk.c.iXd,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:b},b.extendedProperties.set("ErrorLevel",
"warning"),this.rg.logKpiFailure({kpiName:jk.c.kbc,errorName:"PictureSwordResponseInvalid",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:b},optionalVeto:h})):va.Health.instance.recordQosError("PictureSwordResponseInvalid",["ImageEditFailed"],!1,!0,!1,!1,b);t.ULS.sendTraceTag(25182691,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",r.message,this.Lp,TE.a[this.pQe]);this.Pee();return}this.kNc();kh.a.mark(this.C$b());this.sendMessage(!0,
this.H7d)}}Object(m.a)(RK,"RenderedPictureEditOperation",jD,[]);class SK{constructor(b,h,r,B,P,ca,ra,Qa){this.Vj=b;this.Ca=h;this.rr=r;this.je=B;this.Vd=P;this.Qm=ca;this.oK=ra;this.rd=Qa}create(b,h){const r=Id.ImageReader.ui(b);return ub.App.instance.HR(r)?new PK(b,h,this.Vj,this.Ca,this.rr,this.je,this.Vd,this.Qm,this.oK):10===r||11===r||48===r||4===r?new QK(b,h,this.Vj,this.Ca,this.rr,this.je,this.Vd,this.Qm,this.oK,r):5===r?new RK(b,h,this.Vj,this.Ca,this.rr,this.je,this.Vd,this.Qm,this.oK,r,
this.rd):null}}Object(m.a)(SK,"Factory",null,[323]);class TK{constructor(){this.rMc=b=>{const h=window.performance.now(),r=Ck.a.Ar();if(r){b=wH.a(b.customData,r);b=Ab.a.Gs(b,r);var B=0,P=new cg.GraphTransaction(3);try{for(P.Db(r);b.moveNext();){if(!ke.ParagraphReader.oh(b.iterator))continue;const ca=b.currentNode;this.SUh(ca)&&(B++,ca.ol(4,!0));const ra=window.performance.now()-h;if(2500<B||100<ra){this.Oyb=null;this.K5c(ca);break}}}finally{P&&P.dispose()}}else Qc.b(570450380,3018,10,"PageContentNode not found")};
this.Oyb=null}Lui(){const b=Ck.a.Ar();this.W5c(b);this.K5c(null)}K5c(b){this.Oyb&&(v.AFrameworkApplication.lc.ff(this.Oyb),this.Oyb=null);this.Oyb=new Me.a(1,1,1,this.rMc,198);this.Oyb.customData=b;v.AFrameworkApplication.lc.Wb(this.Oyb)}W5c(b){const h=wH.b(b);if(h){var r=new cg.GraphTransaction(3);try{for(r.Db(b);h.moveNext();){if(!ke.ParagraphReader.oh(h.iterator))continue;const B=h.currentNode;this.SUh(B)&&B.ol(4,!0)}}finally{r&&r.dispose()}}}SUh(b){b=b.kH;for(const h of b)if(h.ilb)return 0<h.GRb;
return!1}}Object(m.a)(TK,"RenderParagraphsContainingTabs",null,[]);class UK{constructor(b,h){this.hze=!0;this.ttc=null;this.Brl=()=>{this.ttc=null;this.hze=!0;this.qNa&&this.qNa.GVa(!Eb.App.pP())};this.t9a=(r,B,P)=>{if(1===P)return 32;2===P&&(r=!1,Eb.App.pP()?this.hze=!1:this.hze?r=!0:this.F_o(),this.qNa&&this.qNa.GVa(r));return 32};this.ga=b;this.qNa=h}Tb(){this.ga.fb(fb.a.t9a,yc.a.application,this.t9a,1124)}F_o(){this.ttc?v.AFrameworkApplication.lc.ff(this.ttc):this.ttc=new Me.a(4,1,5E3,this.Brl);
v.AFrameworkApplication.lc.Wb(this.ttc)}}Object(m.a)(UK,"SaveStatusActor",null,[]);class VK{get cbg(){return null!=this.FGg?this.FGg:this.FGg=Ma.a.instance.Oa("Box4.ISaveStyleManager")}get $5n(){return this.Z5n||(this.Z5n=Ma.a.instance.Oa("Box4.IResetAndDeleteStyleManager"))}get jo(){return null!=this.AHg?this.AHg:this.AHg=Ma.a.instance.Oa("Box4.Styles.StyleSettings")}constructor(b,h){this.applyStyles=(r,B,P)=>{r=Ck.a.ZJb(B);if(1===P||r)return r?8:32;this.U6.value.F9k(B);return 32};this.nDb=(r,B,
P)=>{r=Ck.a.ZJb(B);if(1===P||r)return r?8:32;this.U6.value.Jcl(B,this.ga);return 32};this.Eef=(r,B,P)=>{r=Ck.a.ZJb(B)||this.Xro();if(1===P||r)return r?8:32;this.U6.value.Eef(B);return 32};this.ga=b;this.U6=h}get qc(){return null!=this.lKg?this.lKg:this.lKg=Ma.a.instance.resolve("Box4.Styles.IWACStyleReader")}Tb(){this.ga.fb(Nb.a.applyStyles,yc.a.view,this.applyStyles,1028);this.ga.fb(Nb.a.nDb,yc.a.view,this.nDb,4);this.ga.fb(Nb.a.TDb,yc.a.view,this.Eef,4);this.ga.fb(Nb.a.bbg,yc.a.view,this.Sao.bind(this),
4);this.ga.fb(Nb.a.s$f,yc.a.view,this.t$f.bind(this),4);this.ga.fb(Nb.a.zef,yc.a.view,this.nll.bind(this),4)}Sao(b,h,r){b=Ck.a.ZJb(h)||this.bso();if(1===r||b)return b?8:32;this.cbg.Rao();return 32}t$f(b,h,r){b=Ck.a.ZJb(h)||this.$ro();if(1===r||b)return b?8:32;this.$5n.t$f();return 32}nll(b,h,r){b=Ck.a.ZJb(h)||this.Wro();if(1===r||b)return b?8:32;this.U6.value.mll();return 32}Wro(){return"{}"===JE.a.asb?!0:!1}$ro(){if(0==JE.a.h5.size)return!0;var b=JE.a.h5;const h=this.qc.Cr();let r=0;for(const B of b.values())b=
h.oj(B),this.qc.le(b,h)||r++;return 0==r?!0:!1}bso(){var b=JE.a.asb,h=JE.a.h5;const r=this.qc.Cr();if(0==h.size)return!0;if(!({Gt:b}=H.d(b)).returnValue)return t.ULS.sendTraceTag(526979992,3017,15,"Received null string during  deserialization: StylesActor."),!0;if(Object.keys(b).length!=h.size)return!1;for(const P of h.values()){h=r.oj(P);var B=b[P];if(null==B)return!1;if(B=Ck.a.CUd(B)){if(h=Ck.a.mQc(h,r),Ck.a.qXc(h,B))return!1}else t.ULS.sendTraceTag(526979993,3017,15,"Received null style during de serialization: StylesActor.")}return!0}Xro(){var b=
Ck.a.Ar();if(!b)return Qc.b(577368330,3018,15,"PageContentNode is null"),!0;b=(new Aq.WACStyleSet).fY(b);const h=b.EO;for(let B=0;B<h;B++){var r=b.IFa(B);if(this.qc.isHidden(r)||!this.qc.le(r,b))continue;const P=this.qc.LG(r);if(2===P||1===P)if(!r.hasProperty(Mc.a.linkedStyle)||2===P)if(r=r.ja(Mc.a.VK,null),!(r&&0<r.length))return!1}return!0}}Object(m.a)(VK,"StylesActor",null,[]);class PG{constructor(b){this.ble=(h,r,B)=>{h=v.AFrameworkApplication.ua;if(1===B)return 1!==h.mode||kc.SessionStatusManager.instance.Zj?
2:32;va.Health.instance.recordKpiUsage("SwitchToClassicViewMode",0,PG.yB,null);const P={};P[G.a.Zzf]=v.AFrameworkApplication.K.kb("ClassicViewModePreferenceCookieName");P[G.a.ypi]="true";v.AFrameworkApplication.mP().execute(ca=>{ca.sendMessage(M.a.rEo,P)});return v.AFrameworkApplication.va.processAction(Nb.a.readingMode,2)};this.ga=b}Tb(){this.ga.ra(qb.a.ble,yc.a.view,this.ble)}}PG.yB="wwaengidc";Object(m.a)(PG,"SwitchToClassicViewModeActor",null,[]);class WK{constructor(b,h,r,B,P,ca,ra,Qa,tb){this.angle=
r;this.styleId=B;this.width=b;this.height=h;this.top=P;this.bottom=ca;this.left=ra;this.right=Qa;this.JX=tb}}Object(m.a)(WK,"SWordData",null,[]);class XK{constructor(b,h){this.Gk=this.i3=this.yq=null;this.EQe=this.wZb=!1;this.xQ=this.PW=this.Yea=this.Vq=this.pba=this.Qr=this.Op=this.vE=0;this.Yl=null;this.W9=()=>{this.EQe=!1;this.wZb&&this.oNc()};this.ap=b;this.aCc=h;this.asi()}asi(){this.PW=this.xQ=this.Yea=this.Vq=this.pba=this.Qr=this.Op=this.vE=-1;this.Yl=Bb.a.nil}oNc(){this.EQe||(this.K2o(),
this.Ydl(),this.wZb=!1)}Ydl(){this.Gk=new WK(this.Op,this.Qr,this.vE,this.pba,this.Vq,this.Yea,this.xQ,this.PW,this.Yl);this.aCc.create(this.i3,this.yq).mmo(this.W9,this.Gk);this.EQe=!0;let b;Object(Ib.a)(3,this.i3)?b=TE.a[Id.ImageReader.ui(this.i3)]:(t.ULS.sendTraceTag(42469523,322,50,"Unable to acquire PlaceholderKind because the image property set isn't of the type which contains information about the PlaceholderKind."),b="generic");t.ULS.sendTraceTag(23171277,322,50,"Sending request to SWord with width: {0}, height: {1}, angle: {2}, style: {3}, top: {4}, bottom: {5}, left: {6}, right: {7}, placeholderKind: {8}",
this.Op,this.Qr,this.vE,this.pba,this.Vq,this.Yea,this.xQ,this.PW,b);this.asi()}K2o(){this.Op=-1!==this.Op?this.Op:this.i3.ja(Yc.a.YFa,-1);this.Qr=-1!==this.Qr?this.Qr:this.i3.ja(Yc.a.XFa,-1);this.Op=-1!==this.Op?this.Op:this.ap.oF(this.i3);this.Qr=-1!==this.Qr?this.Qr:this.ap.JG(this.i3);this.vE=-1!==this.vE?this.vE:this.ap.o0(this.i3);this.pba=-1!==this.pba?this.pba:this.ap.vjb(this.i3);const b=this.ap.yca(this.i3);this.Vq=-1!==this.Vq?this.Vq:b.top;this.Yea=-1!==this.Yea?this.Yea:b.bottom;this.xQ=
-1!==this.xQ?this.xQ:b.left;this.PW=-1!==this.PW?this.PW:b.right}tNn(b,h,r,B){this.yq=b;this.vE=r;this.wZb=!0;this.i3=h;this.Yl=B;this.oNc()}sNn(b,h,r,B,P){this.yq=b;this.wZb=!0;this.i3=h;this.Yl=P;this.i3.setValue(Yc.a.YFa,r);this.i3.setValue(Yc.a.XFa,B);this.oNc()}xNn(b,h,r){this.yq=b;this.wZb=!0;this.i3=h;this.pba=r;this.oNc()}mNn(b,h,r,B,P,ca){this.yq=b;this.Vq=r;this.Yea=B;this.xQ=P;this.PW=ca;this.wZb=!0;this.i3=h;h=b=0;({width:b,height:h}=this.ap.gjb(this.i3));this.Op=b-(P+ca)/1E5*b;this.Qr=
h-(r+B)/1E5*h;this.oNc()}}Object(m.a)(XK,"SWordRequestManager",null,[322]);class TF{constructor(b,h,r,B=null,P=null,ca=null,ra=null,Qa=null,tb=null,Mb=null){this.Qm=null;this.xlh=!1;this.XGo=(Zb,jc,Gc,Uc,od)=>{if(1===Gc)return 32;const Od=Zb===Nb.a.Ifg;if(!jc.view.ue)return 2;const ze=jc.view,de=ze.mb,ee=de.qg;if(!ee||TF.Yf.$_(ee))return 2;if(this.en&&this.en.instance&&this.en.instance.SU(ee))return 4;Zb=null;var je=cd.ActionManager.qya;let ue=!1;var Qf=xe.SelectionEditor.Ze(ee);if(ee.jx){if(de.ib.LJ&&
(je=ee.getContext(0),Zb=new Ad.GraphIterator,Zb.set(je.node),Zb.Ip(),je=Od?Nb.a.Lbg:Nb.a.Ofe),je=this.XUe.VHn(je),je===cd.ActionManager.qya){var Jg=TF.ah.WT(ee,16);Jg?(Od&&(je=Nb.a.J5d),Zb=new Ad.GraphIterator,Zb.set(Jg.node),Zb.qd()):je=Od?Nb.a.ZG:Nb.a.MO}}else if(ee.el)if(Zb=new Ad.GraphIterator,Zb.set(ee.node),xe.SelectionEditor.zu(Zb),Yg.OutlineReader.CRa(ee))je=Od?Nb.a.Lbg:Nb.a.Ofe;else{if(this.nEe&&this.nEe.auo(ee))return this.nEe.x9c(ee,ze.$b,Od),32;Id.ImageReader.b4a(ee)?je=Od?Nb.a.Kbg:Nb.a.Jbg:
(je=Od?this.XUe.Rmm(Zb,ee,je,jc):this.XUe.Qmm(Zb,ee,je,jc),Uf.OutlineElementReader.Eh(Zb)&&ee.contextId===yc.a.Uc&&(ue=Uf.OutlineElementReader.KA(Zb,ee,!1)),Jg=fg.ListItemReader.lg(Zb)&&ue,je!==cd.ActionManager.qya||Ah.TableCellReader.Rpa(Zb)||Jg||(this.xlh||(t.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),this.xlh=!0),v.AFrameworkApplication.va.processAction(Nb.a.vsi,2),this.Tsi(jc)))}else return 2;if(!Od&&je===cd.ActionManager.qya&&Ah.TableCellReader.Rpa(Zb))if(Kf.returnToCell(Zb),
Ah.TableCellReader.vRa(Zb)||Rh.TableReader.dzi(Zb)&&Ah.TableCellReader.$Ff(Zb)){if(je=this.tqk(),!je)return 2}else je=Nb.a.OQi;if(je===cd.ActionManager.qya)return 2;switch(je){case Nb.a.OQi:case Nb.a.J5d:Uc=je===Nb.a.J5d;Qf&&this.w2&&this.DZ&&(Qf=this.w2.Ukf(ee,-1,!0,se.a.Iw))&&this.DZ.Nhj(Qf);Gc=32;Kf.returnToCell(Zb);Kf.moveToNextOrPreviousCell(Zb,Uc)&&(Qf=!0,Uc=!1,Yg.OutlineReader.czf(Zb)||(xk.OutlineNavigator.CQf(Zb,!1),ig.OutlineElementNavigator.Ee(Zb),ke.ParagraphReader.Bt(Zb.currentNode)&&
(Qf=!1,ke.ParagraphReader.textLength(Zb.currentNode)||(Uc=!0)),Uc||Kf.returnToCell(Zb)),Uc?Zb=og.SelectionFactory.ne(Zb.currentNode,0):(Zb=og.SelectionFactory.Eq(Zb.currentNode),!Qf&&xe.SelectionEditor.Lk(Zb.Tc)&&(Qf=Zb.toArray(),Array.removeAt(Qf,Qf.length-1),Zb=new Rg.Selection(Qf,Zb.isForward))),de.Ac(Zb));break;case Nb.a.Lbg:case Nb.a.Ofe:je===Nb.a.Ofe?xk.OutlineNavigator.pQi(Zb,!1):xk.OutlineNavigator.pQi(Zb,!0);de.Ac(og.SelectionFactory.Eq(Zb.currentNode));Gc=32;break;case Nb.a.Had:Gc=v.AFrameworkApplication.va.Nf(jc,
je,Gc,!0,Uc,od);break;default:if(Gc=v.AFrameworkApplication.va.Nf(jc,je,Gc,!0,Uc,od),!ue&&Qf&&(je===Nb.a.ZG||je===Nb.a.MO)){const Ql=xe.SelectionEditor.PQ(de.ib.lb).y;Eb.App.ijc(()=>{this.pfn(de,ze,Ql)})}}32===Gc&&jc.view.ue&&this.ug.tF();return Gc};this.Jma=b;this.XUe=h;this.en=r;this.w2=B;this.DZ=P;this.$Ue=ca;this.vKa=ra;this.rd=Qa;this.Lc=tb;this.nEe=Mb}get ug(){return this.Qm||(this.Qm=this.Jma())}Tb(){const b=v.AFrameworkApplication.va,h=this.XGo;b.fb(Nb.a.tab,yc.a.view,h,1124);b.fb(Nb.a.Ifg,
yc.a.view,h,1124);b.ra(Nb.a.vsi,yc.a.view,cd.ActionManager.Of)}pfn(b,h,r){if(b&&h){var B=b.ib.lb;xe.SelectionEditor.PQ(B).y<r?(h=xe.SelectionEditor.nOc(h,B,!1),h=xe.SelectionEditor.vwa(h,{UA:!1,Ps:!1,WC:!1,rE:!0})):h=xe.SelectionEditor.oOc(h,B,!1);b.Ac(h)}}tqk(){return Nb.a.W3a}Tsi(){}T0c(b,h,r){if(b&&h){var B=b.ib.lb;xe.SelectionEditor.PQ(B).y<r?(h=xe.SelectionEditor.nOc(h,B,!1),h=xe.SelectionEditor.vwa(h,{UA:!1,Ps:!1,WC:!1,rE:!0})):h=xe.SelectionEditor.vwa(B,{UA:!1,Ps:!1,WC:!1,rE:!0});b.Ac(h)}}static get Yf(){return Wh.a.instance}static get ah(){return An.ContextSetEditor.instance}}
Object(m.a)(TF,"TabActor",null,[]);class HH{constructor(b){this.Twc=b}get qq(){return this.Twc}VHn(b){return b}Rmm(b,h,r,B){const P=B.view,ca=P.mb.ib.lb;if(Ah.TableCellReader.Rpa(b))return this.Yyi(b,B)?Nb.a.ZG:Nb.a.J5d;ig.OutlineElementNavigator.Yd(b);if(xe.SelectionEditor.Ze(h))Uf.OutlineElementReader.KA(b,h,!1)&&this.arj(b)?r=Nb.a.dOb:xe.SelectionEditor.hYc(P,ca)&&this.qq.bCb(b)?r=Nb.a.ZG:xe.SelectionEditor.hYc(P,ca)&&(r=Nb.a.ZG);else if(xe.SelectionEditor.vl(h)){if(!this.qq.bCb(b))return r;xe.SelectionEditor.elb(h)?
r=Nb.a.ZG:xe.SelectionEditor.WDi(h)&&(r=this.arj(b)?Nb.a.dOb:Nb.a.ZG)}else this.qq.bCb(b)&&(r=Nb.a.ZG);return r}Qmm(b,h,r,B){if(Ah.TableCellReader.P0(b))return this.Yyi(b,B)?Nb.a.MO:r;ig.OutlineElementNavigator.Yd(b);if(xe.SelectionEditor.Ze(h))Uf.OutlineElementReader.KA(b,h,!1)&&(!fg.ListItemReader.lg(b)&&Uf.OutlineElementReader.isEmpty(b,!1)?r=cd.ActionManager.qya:this.Vro(b)?r=Nb.a.ahb:this.mqj(b)?r=Nb.a.UDb:this.qq.m4b(b)&&(r=Nb.a.MO));else if(xe.SelectionEditor.vl(h)){if(!this.qq.m4b(b))return r;
xe.SelectionEditor.elb(h)?r=Nb.a.MO:xe.SelectionEditor.WDi(h)&&(r=this.mqj(b)?Nb.a.UDb:Nb.a.MO)}else this.qq.m4b(b)&&(r=Nb.a.MO);return r}arj(b){return fg.ListItemReader.lg(b)?!1:0<Uf.OutlineElementReader.F4(b)?!0:!1}mqj(b){if(fg.ListItemReader.lg(b))return!1;const h=Uf.OutlineElementReader.F4(b);b=Yg.OutlineReader.YX(b.currentNode);return h<b?!0:!1}Vro(b){return fg.ListItemReader.lg(b)?!1:0<Uf.OutlineElementReader.IG(b)?!0:!1}static Xr(){return new HH(Tt.a.MGb)}Yyi(b,h){if(this.WSm){h=h.view;const r=
h.mb.ib.lb,B=new Ad.GraphIterator;B.kd(b);ig.OutlineElementNavigator.Yd(B);if(fg.ListItemReader.lg(B)&&xe.SelectionEditor.hYc(h,r))return!0}return!1}get WSm(){var b;v.AFrameworkApplication.oe("egdi3422;7g6fa693");return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.QOEForListInTableIsEnabled",!1)}}Object(m.a)(HH,"TabActorPromoteDemoteStrategy",null,[336]);class hE extends TF{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc){super(b,h,r,B,
P,ca,ra,Qa,tb,Mb);this.g8d=(Uc,od)=>{Uc=od.property;!this.d7c||Uc!==Mc.a.Ko&&Uc!==Mc.a.marginLeft&&Uc!==Mc.a.marginRight||this.d7c.Lui()};this.YX=(Uc,od,Od,ze,de)=>{Uc=Yg.OutlineReader.YX(this.h9l(od));de.defaultTabStop=Uc;return 32};this.yZb=Zb;this.ga=Gc;this.fC();this.ga.ra(qb.a.YX,yc.a.view,this.YX)}get d7c(){return null!=this.uGg?this.uGg:this.uGg=Ma.a.instance.Oa("WordEditor.Actors.RenderParagraphsContainingTabs")}fC(){this.yZb.Il.Ue(10).Eo(this.g8d)}Tsi(b){const h=b.view,r=h.mb;b=r.qg;if(this.vKa&&
this.Lc){var B=this.Lc.Pc(15);B.Db(b.node);b.contextId===yc.a.Fd&&v.AFrameworkApplication.va.processAction(Nb.a.PH,2);this.vKa.iYd(r.qg);B.dispose();var P=xe.SelectionEditor.PQ(r.ib.lb).y;Eb.App.ijc(()=>{this.T0c(r,h,P)})}}h9l(b){return b.view.mb.ib.lb.Pa.node}static get instance(){return null!=hE.bDg?hE.bDg:hE.bDg=hE.fm()}static fm(){return new hE(()=>Ma.a.instance.resolve("Box4.IUndoManager"),HH.Xr(),Ma.a.instance.Ta("Box4.IExternalSelectionManager"),Ma.a.instance.resolve("Box4.IAutoCorrectRules"),
Ma.a.instance.resolve("Box4.IAutoCorrectScheduler"),Ma.a.instance.Oa("Box4.ITabPresenterFactory"),Ma.a.instance.Oa("Box4.IBlobEditor"),Ma.a.instance.Oa("Box4.IFeatureHelper"),Ma.a.instance.Oa("Box4.Graph.GraphTransactionFactory"),Ma.a.instance.Oa("Box4.Actors.IIFrameFocusStrategy"),Eb.App.si,Ma.a.instance.Oa("Box4.ITabRenderer"),v.AFrameworkApplication.va)}}Object(m.a)(hE,"TabActor",TF,[]);class Fx{static get zt(){return null!=Fx.pwg?Fx.pwg:Fx.pwg=Ma.a.instance.resolve("Box4.IAppFrame")}static initialize(){qh.a.Ldc=
Fx.UTm;qh.a.xle=Fx.F5o}static UTm(b){return!Rh.TableReader.MOm(b)}static znb(){Fx.zt.wjc(Fx.znb);Fx.Fxb=!1;const b=appChrome.selectors.getActiveContextualTabIds();"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(b,"Table")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Table"))}static F5o(b){var h,r,B;b&&((null===(h=Gp.a.instance.lb)||void 0===h?0:h.RGa)||(null===(r=Gp.a.instance.lb)||void 0===r?0:r.Pv)||(null===(B=Gp.a.instance.lb)||void 0===B?0:B.Qlb))&&!Fx.Fxb&&(Fx.zt.z_a(Fx.znb),
Fx.Fxb=!0)}}Fx.Fxb=!1;Object(m.a)(Fx,"TableActor",null,[]);var jN=c(924);class IH{nFl(b,h,r,B){return b?this.ODl(h,r,B):this.oFl(h,r,B)}y0h(b,h,r,B,P){return b?this.QEl(h,r,B,P):this.DEl(h,r,B,P)}AEl(b){let h=!1;var r=b.isForward?b.Ne.Tc:b.Ne.Pa;b=new Ad.GraphIterator;b.set(r.node);b.zb(14);r=null;Ah.TableCellReader.gda(b)?Ah.TableCellReader.vJb(b)||(h=!0,r=Kf.moveToNextRow(b)):r=Kf.moveToNextColumn(b);return{returnValue:r,Jfn:h}}LEl(b){var h=b.isForward?b.Ne.Tc:b.Ne.Pa;const r=new Ad.GraphIterator;
r.set(h.node);r.zb(14);h=null;Ah.TableCellReader.ria(r)?Ah.TableCellReader.qia(r)||(h=new Ad.GraphIterator,h.set(b.ADa.node),h.zb(14),b=dl.a.Ls(h),dl.a.Ls(r)>b?(Kf.moveToPreviousRow(r),Kf.moveToLastColumn(r),h=r.currentNode):h=Kf.moveToPreviousRow(r)):h=Kf.moveToPreviousColumn(r);return h}M0h(b,h){var r=b.isForward?b.Ne.Tc:b.Ne.Pa;b=new Ad.GraphIterator;b.set(r.node);b.zb(14);r=null;h?Ah.TableCellReader.qia(b)||(r=Kf.moveToPreviousRow(b)):Ah.TableCellReader.vJb(b)||(r=Kf.moveToNextRow(b));return r}qKb(b,
h,r){for(;Ah.TableCellReader.hg(b);)if(h){if(r&&b.Dxa(1)||!r&&b.Kxa(1))return null;r?Kf.moveToPreviousColumn(b):Kf.moveToNextColumn(b)}else{if(Ah.TableCellReader.Z4(b.currentNode)){const B=new Ad.GraphIterator;B.kd(b);if(this.qKb(B,!0,!0)||this.qKb(B,!0,!1)){b.kd(B);break}}else{if(!r&&Kf.moveToControllingCell(b,2))break;if(r&&Kf.moveToControllingCell(b))break}if(r&&Ah.TableCellReader.qia(b)||!r&&Ah.TableCellReader.vJb(b))return null;r?Kf.moveToPreviousRow(b):Kf.moveToNextRow(b)}return b.currentNode}D8b(b,
h){if(!dl.a.isTableRow(b))return null;b=Ad.GraphIterator.eb(b.currentNode);b.zb(14);let r;const B=Rh.TableReader.RB(b.origin);do r=h?Kf.moveToPreviousRow(b):Kf.moveToNextRow(b);while(B&&r&&dl.a.mRa(b));return r}Ymb(b,h,r,B,P){let ca=null;ig.OutlineElementNavigator.Yd(b);const ra=Uf.OutlineElementReader.isRtl(b.currentNode);if(r)if(Kf.returnToCell(b),h=Ah.TableCellReader.gda(b),r=Ah.TableCellReader.ria(b),P||!ra&&r||ra&&B&&h)Kf.returnToContainingRow(b),(B=this.D8b(b,!0))?ca=og.SelectionFactory.ro(B,
!h):P&&(ig.OutlineElementNavigator.Yd(b),P=new Nf.a,P.kd(b),(b=ig.OutlineElementNavigator.h1(P,!1,!1))&&(ca=og.SelectionFactory.ro(b,!1)));else{do ra?Kf.moveToNextColumn(b):Kf.moveToPreviousColumn(b);while(Ah.TableCellReader.hg(b)&&!Ah.TableCellReader.qia(b));Ah.TableCellReader.hg(b)||(ca=og.SelectionFactory.ro(b.currentNode,!ra))}else Uf.OutlineElementReader.KA(b,h,ra)||xe.SelectionEditor.Ze(h)||Kf.returnToCell(b),ca=og.SelectionFactory.ro(b.currentNode,!ra);return ca}Xmb(b,h,r,B,P){let ca=null;
ig.OutlineElementNavigator.Yd(b);const ra=Uf.OutlineElementReader.isRtl(b.currentNode);if(r)if(Kf.returnToCell(b),r=Ah.TableCellReader.gda(b),h=Ah.TableCellReader.ria(b),P||!ra&&B&&r||ra&&!B&&h)Kf.returnToContainingRow(b),(B=this.D8b(b,!1))?ca=og.SelectionFactory.ro(B,h):(ig.OutlineElementNavigator.Yd(b),B=new Nf.a,B.kd(b),(b=ig.OutlineElementNavigator.ns(B,!1,!1))&&(ca=og.SelectionFactory.ro(b,!0)));else{do ra?Kf.moveToPreviousColumn(b):Kf.moveToNextColumn(b);while(Ah.TableCellReader.hg(b)&&!Ah.TableCellReader.gda(b));
Ah.TableCellReader.hg(b)||(ca=og.SelectionFactory.ro(b.currentNode,ra))}else Uf.OutlineElementReader.KA(b,h,!ra)||xe.SelectionEditor.Ze(h)||Kf.returnToCell(b),ca=og.SelectionFactory.ro(b.currentNode,ra);return ca}}Object(m.a)(IH,"ATableCellSelectionStrategy",null,[1379]);class YK extends IH{constructor(){super()}DEl(b,h,r,B){let P=b.lb,ca=null;if(b.Pv)if(h)if(2===P.Ne.Wia&&!P.isForward&&P.Ne.Tc.equals(P.ADa))P=og.SelectionFactory.UNh(P.ADa.node,!1);else{var ra=({Jfn:b}=this.AEl(P)).returnValue;ra&&
(Ah.TableCellReader.es(ra)&&(ra=Ad.GraphIterator.eb(ra),ra.zb(14),ra=!b&&this.qKb(ra,!0,!1)?ra.currentNode:b||Kf.moveToNextRow(ra)?this.qKb(ra,!1,!1):null),ra&&(ca=og.SelectionFactory.Zn(Fu.TableNodeContext.create(ra),P.isForward)))}else P=b.zea,b=Ad.GraphIterator.eb(P.Ne.Tc.node),b.zb(14),Ah.TableCellReader.BGa(b.currentNode)&&Kf.moveToLastGhostCell(b,2),(ra=Kf.moveToNextColumn(b))?(b=Ah.TableCellReader.Z4(ra),Ah.TableCellReader.es(ra)&&!b&&(ra=Ad.GraphIterator.eb(ra),ra.zb(14),ra=Kf.moveToControllingCell(ra)),
b?P=og.SelectionFactory.ro(P.Ne.Tc.node,!1):ca=og.SelectionFactory.ro(ra,!0)):(ra=P.Ne.Tc.node,ca=og.SelectionFactory.ro(ra,!1));else b=h&&P.isForward||!h&&!P.Tpa?P.Ne.Tc:P.Ne.Pa,dl.a.Spa(b.node)&&(b=Ad.GraphIterator.eb(b.node),(ra=this.D8b(b,!1))?ca=h?og.SelectionFactory.Zn(Fu.TableNodeContext.create(ra),P.isForward):og.SelectionFactory.ro(ra,!0):P=xe.SelectionEditor.Jj(og.SelectionFactory.Eq(b.currentNode),!1,!0));return ca?ca:B?xe.SelectionEditor.C8b(P,!1,h,!0):xe.SelectionEditor.vwa(P,{UA:!h,
Ps:h,WC:r,rE:!0})}QEl(b,h,r,B){let P=b.lb;var ca=null;if(b.Pv)h?1===P.Ne.Wia&&P.isForward&&P.Ne.Pa.equals(P.ADa)||(ca=this.LEl(P),(ca=this.w0h(P,ca))||P.isForward&&(P=P.IOc())):(P=b.zea,ca=og.SelectionFactory.ro(P.Ne.Pa.node,!0));else if(h){var ra=(P.isForward?P.Ne.Tc:P.Ne.Pa).node;b=Ad.GraphIterator.eb(ra);xe.SelectionEditor.zu(b);dl.a.Spa(ra)&&(P.isForward&&1===P.Ne.Wia&&P.Tpa?(ca=dl.a.zB(ra).toArray(),(ca=this.w0h(P,0<=ca.length-2?ca[ca.length-2]:null))||P.isForward&&(P=P.IOc())):(ra=this.D8b(b,
!0))?ca=og.SelectionFactory.Zn(Fu.TableNodeContext.create(ra),P.isForward):P=og.SelectionFactory.ro(b.currentNode,!0))}else ca=xe.SelectionEditor.Jj(P,!0,!1);return ca?ca:B?xe.SelectionEditor.C8b(P,!0,h,!0):xe.SelectionEditor.$Ea(P,{UA:!h,Ps:h,WC:r,rE:!0})}w0h(b,h){if(!h)return null;var r=h;Ah.TableCellReader.es(h)&&(r=Ad.GraphIterator.eb(h),r.zb(14),r=this.qKb(r,!0,!0)?r.currentNode:Ah.TableCellReader.vha(h));return r?og.SelectionFactory.Zn(Fu.TableNodeContext.create(r),b.isForward):null}oFl(b,h,
r){let B=h.lb,P=null;if(h.Pv){var ca=h.GX>h.mJa;if(r)if(2===h.length&&1===h.zea.Ne.Wia&&ca)B=xe.SelectionEditor.Jj(B,!0,!1);else{if(h=this.M0h(B,!0))Ah.TableCellReader.es(h)&&(h=Ad.GraphIterator.eb(h),h.zb(14),h=this.qKb(h,!1,!0)),h&&(P=og.SelectionFactory.Zn(Fu.TableNodeContext.create(h),B.isForward));P||B.isForward&&(B=B.IOc())}else ca&&(B=h.zea)}else h=r&&B.isForward?B.Ne.Tc:B.Ne.Pa,dl.a.Spa(h.node)&&(h=Ad.GraphIterator.eb(h.node),(ca=this.D8b(h,!0))?P=r?og.SelectionFactory.Zn(Fu.TableNodeContext.create(ca),
B.isForward):og.SelectionFactory.ro(ca,!0):r&&(B=og.SelectionFactory.ro(h.currentNode,!0)));return P?P:xe.SelectionEditor.Hgb(b,B,!1,r,r)}ODl(b,h,r){let B=h.lb,P=null;if(h.Pv){const ca=h.GX<h.mJa;if(r)if(2===h.length&&1===h.zea.Ne.Wia&&ca)B=xe.SelectionEditor.Jj(B,!1,!1);else{if(h=this.M0h(B,!1))Ah.TableCellReader.es(h)&&(h=Ad.GraphIterator.eb(h),h.zb(14),h=this.qKb(h,!1,!1)),h&&(P=og.SelectionFactory.Zn(Fu.TableNodeContext.create(h),B.isForward))}else ca&&(B=h.zea)}else h=!r||B.isForward?B.Ne.Tc:
B.Ne.Pa,dl.a.Spa(h.node)&&(h=Ad.GraphIterator.eb(h.node),(h=this.D8b(h,!1))&&(P=r?og.SelectionFactory.Zn(Fu.TableNodeContext.create(h),B.isForward):og.SelectionFactory.ro(h,B.Tpa)));return P?P:xe.SelectionEditor.Hgb(b,B,!0,r,r)}}Object(m.a)(YK,"TableCellSelectionStrategy",IH,[]);class ZK{constructor(b){this.JL=(h,r,B,P,ca)=>{if(1===B)return 32;h=(new oj.a).create();r="";switch(ca.DialogType){case "DirectPrintPreparingPDF":r=CommonUIStrings.l_DirectPrintPreparingPDF;ca=CommonUIStrings.l_DefaultDialogTitle;
break;default:ca=CommonUIStrings.l_DefaultDialogTitle}h.message=r;h.JL(ca,null,null);return 32};this.ga=b}Tb(){this.ga.fb(Nb.a.JL,yc.a.view,this.JL,1028)}}Object(m.a)(ZK,"UIAutomationActor",null,[]);class $K{constructor(b,h,r,B){this.gb=b;this.vKa=h;this.Brc=r;this.h7=B}bog(b,h,r){return this.Brc.MRm(h)?r?!0:b&&this.gb.oh(b)?(b=this.tw(b.currentNode),this.vKa.fti(b),!0):!1:!1}uyf(b,h){return this.Brc.vyl(b,h)}Ayf(b){b&&this.gb.oh(b)&&(b=this.tw(b.currentNode),this.vKa.iYd(b))}tw(b){return Ue.a.tw(b)}K$(b,
h,r){this.h7.q1i&&this.Brc.Cxi(r)&&(this.h7.K$(b,h),b.setValue(Yc.a.Yxi,!0))}khe(){}g_d(b){return this.Brc.g_d(b)}get o0d(){return this.Brc.o0d}mD(){}mea(){}Ihe(){}get wrj(){return!1}}Object(m.a)($K,"WordEditorPasteStewardBridge",null,[321]);class aL{constructor(b){this.sa=new Pc.a;this.chj="WordFileSaveAsButtonClicked";this.H5o=()=>{this.sa.raiseEvent(this.chj,null);return 32};this.ga=b}Tb(){v.AFrameworkApplication.K.$("UseNewCommandForWordFileMenuSaveAs")&&this.ga.ra(qb.a.ILj,yd.a.frame,this.H5o)}Yyk(b){this.sa.addHandler(this.chj,
b)}}Object(m.a)(aL,"WordFileSaveAsActor",null,[]);class bL extends Fp{constructor(){super()}MGc(b,h,r,B,P,ca,ra){return $r.a.bic(h,r,B,P,ca,ra)}}Object(m.a)(bL,"WordIndentationActorExtension",Fp,[]);class JH{constructor(){this.ypd=null}get name(){return"WordEditor.Actors"}init(){var b;hb.InteractiveViewManager.instance.xe.K6b=!0;v.AFrameworkApplication.va.ra(qb.a.C4o,yd.a.frame,PM);this.W.resolve("WordEditor.Actors.DeleteActor").Tb(v.AFrameworkApplication.va);aE.instance.Tb();rn.Tb();mq.Tb(v.AFrameworkApplication.va,
this.W.resolve("WordEditor.IMainViewModeManager"));Ek.Tb();hE.instance.Tb();jN.a.Tb();this.W.resolve("WordEditor.Actors.ModeSwitcherControlActor").Tb(v.AFrameworkApplication.va);this.W.resolve("WordEditor.Actors.ExternalContentActor").Tb();this.W.resolve("WordEditor.OnlineMedia.OnlineMediaActor").Tb();v.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&this.W.resolve("Box4.Actors.FormatPainterActor").Tb();v.AFrameworkApplication.K.$("WordEditorAutoSaveImprovementIsEnabled")&&this.W.resolve("WordEditor.Actors.SaveStatusActor").Tb();
v.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&v.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&(this.OW.x0d=!0);v.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&this.W.resolve("WordEditor.Actors.ModernUxActor").Tb();v.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&this.W.resolve("WordEditor.Actors.SwitchToClassicViewModeActor").Tb();this.W.resolve("WordEditor.Actors.AppFrameCommandUIActor").Tb();
this.W.resolve("Common.IOfficeTrialExperience").Tb();this.W.resolve("Common.IMacOfficeOffer").Tb();this.W.resolve("WordEditor.Actors.MarginsDialogActor").Tb();this.W.resolve("WordEditor.Actors.PaperSizeDialogActor").Tb();this.W.resolve("WordEditor.Actors.ColumnsDialogActor").Tb();this.W.resolve("WordEditor.Actors.FileDownloadActor").Tb();this.W.resolve("WordEditor.Actors.StylesActor").Tb();(null===(b=v.AFrameworkApplication.K)||void 0===b?0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCustomizeRibbonEnabled",
!1))&&this.W.resolve("WordEditor.Actors.CustomizeRibbonActor").Tb();this.W.resolve("WordEditor.Actors.LabelsActor").Tb();this.W.resolve("WordEditor.Actors.EnvelopesActor").Tb();this.W.resolve("WordEditor.Actors.ParagraphDialogActor").Tb();this.W.resolve("WordEditor.Actors.ProofingActor").Tb();this.W.resolve("WordEditor.Actors.PageActor").Tb();this.W.resolve("WordEditor.Actors.DarkModeActor").Tb();this.W.resolve("WordEditor.Actors.ImageActor").Tb(v.AFrameworkApplication.va);this.W.resolve("WordEditor.Actors.FormattingActor").Tb();
this.W.resolve("WordEditor.Actors.UIAutomationActor").Tb();this.W.resolve("WordEditor.Actors.ContentControlActor").Tb();this.W.resolve("WordEditor.Actors.CustomTabActor").Tb();this.W.resolve("WordEditor.Actors.BookmarkActor").Tb();this.W.resolve("WordEditor.Actors.HeadingsActor").Tb();this.W.resolve("Box4.Indicator.IIndicatorManager").GTa(this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"));this.W.resolve("WordEditor.Actors.AccessibilityHelpDialogActor").Tb();this.W.resolve("WordEditor.Actors.AccessibilityActor").X6f();
this.W.resolve("WordEditor.Actors.ISWordRequestManager");this.W.resolve("Box4.Actors.AutoCorrectActor").Tb();this.W.resolve("WordEditor.Actors.DigitalPrintActor").Tb();this.W.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager");this.W.resolve("Box4.Actors.VisiMarkersActor").Tb();this.W.resolve("WordEditor.Actors.ExternalContentFloatieEventManager");this.W.resolve("WordEditor.Actors.ActionHangDetector").eZ();this.W.resolve("WordEditor.Actors.WordFileSaveAsActor").Tb();v.AFrameworkApplication.K.$("GraphicsEditorActorRegistrationUpdateIsEnabled")?
this.DUn():this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Tb();this.wW.b7a(this.EXj);b=this.W.resolve("WordEditor.Bookmark.FullBookmarkManager");v.AFrameworkApplication.oe("bookmarks-core-ex;bookmarks-core-ex-cf");v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)&&b.Qrm()&&Eb.App.za.jb.mXh();v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateForAppWelcomeExp",!1)&&this.W.resolve("WordEditor.Actors.MiniTemplateActor").Tb();
Eb.App.za.updateCommandUI();Fx.initialize()}dispose(){}DUn(){this.rd.pq.isCompleted?this.rd&&this.rd.isFeatureEnabled(50)&&this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Tb():this.rd.pq.continueWith(()=>{this.rd&&this.rd.isFeatureEnabled(50)&&(this.W.resolve("WordEditor.Actors.GraphicsEditorActor").Tb(),Eb.App.za.updateCommandUI())})}get hSm(){if(null==this.ypd)if(this.rd)if(this.rd.pq.isCompleted)this.ypd=this.rd.isFeatureEnabled(3);else return!1;else this.ypd=!1;return this.ypd}wc(b){var h,
r;this.W=b;this.rd=b.Oa("Box4.IFeatureHelper");this.OW=this.W.resolve("Box4.Proofing.IProofingFeatureConfiguration");this.OW.RXc=v.AFrameworkApplication.K.$("WordProofingSecondaryContextualMenuIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorRightClickSecondaryMenuIsEnabled",!1);(new sJ).wc(b);b.ia("Box4.IClipboardCommands",()=>new tJ(v.AFrameworkApplication.va,Nb.a.u5e,Nb.a.DHc,Nb.a.P_,Nb.a.j0f,Nb.a.paste,Nb.a.j$,Nb.a.wob)).ha();b.ia("HtmlImport.IHtmlNormalizerSettings",
()=>{const B=b.resolve("Common.IAppSettingsManager");return new Tx(!0,B.$("SplitHyperlinkFixWithEnterIsEnabled"))}).ha();b.ia("HtmlImport.IHtmlTranslatorSettings",()=>{const B=b.resolve("Common.IAppSettingsManager"),P=ca=>!ca.wcc;return new pJ(B.$("PasteComplexTablesIsEnabled"),!0,!0,!0,void 0,void 0,void 0,void 0,void 0,void 0,!0,void 0,B.$("SupportCloudFontInExternalPasteIsEnabled"),!0,!0,!0,!0,!0,ca=>ca.wcc,()=>!1,P,P,P,P,void 0,()=>this.hSm,ca=>!ca.wcc)}).ha();b.ia("WordEditor.Actors.WordEditorPasteStewardBridge",
()=>new $K(b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobEditor"),b.resolve("Box4.Actors.IBox4PasteStewardUtils"),b.resolve("Box4.IFormattingPropertyTransitStrategy"))).as("Box4.Actors.IBox4PasteStewardBridge").ha();b.ia("WordEditor.Actors.PastedContentsProcessorPostMergeAfterPaste",()=>new NK(b.resolve("Wonca.ExternalContent.IExternalContentEditor"),b.resolve("Box4.IFeatureHelper"))).as("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste").ha();b.ia("Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy",
()=>new uJ).as("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy").ha();b.ia("Box4.IIndentationCommands",()=>new vJ(v.AFrameworkApplication.va)).ha();b.ia("Box4.IJustificationCommands",()=>new wJ(v.AFrameworkApplication.va)).ha();b.ia("Box4.ISpacingCommands",()=>new xJ(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.IPageCommands",()=>new JK(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.StylesActor",()=>new VK(v.AFrameworkApplication.va,b.Ve("WordEditor.UI.IDialogFactory"))).ha();
(null===(h=v.AFrameworkApplication.K)||void 0===h?0:h.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCustomizeRibbonEnabled",!1))&&b.ia("WordEditor.Actors.CustomizeRibbonActor",()=>new QF(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.EnvelopesActor",()=>new DK(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.LabelsActor",()=>new EK(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.DigitalPrintActor",()=>new zH(v.AFrameworkApplication.va,b.Ve("WordEditor.UI.IDialogFactory"))).ha();
b.ia("WordEditor.Actors.FileDownloadManager",()=>new mK(b.resolve("Common.App.DirectPrint.IDirectPrintManager"),new GM.a)).ha();b.ia("WordEditor.Actors.FileDownloadActor",()=>new jK(v.AFrameworkApplication.va,b.Ve("WordEditor.UI.IDialogFactory"),b.resolve("WordEditor.Actors.FileDownloadManager"),v.AFrameworkApplication.K.$("DisablePrint"),v.AFrameworkApplication.K.kb("IrmPolicyDescription"),b.resolve("WordEditor.IBusinessBarController"))).ha();b.ia("WordEditor.Actors.ParagraphDialogActor",()=>new LK(v.AFrameworkApplication.va,
b.Ve("Box4.UI.IBox4DialogFactory"),b.resolve("WordEditor.LineSpacingHelper"),Rn.a.instance,b.resolve("Box4.IParagraphIndentationReader"))).ha();b.ia("WordEditor.Actors.MarginsDialogActor",()=>new GK(v.AFrameworkApplication.va,b.Ve("WordEditor.UI.IDialogFactory"),Rn.a.instance)).ha();b.ia("WordEditor.Actors.ColumnsDialogActor",()=>new bK(v.AFrameworkApplication.va,b.Ve("WordEditor.UI.IDialogFactory"),Rn.a.instance)).ha();b.ia("WordEditor.Actors.ModeSwitcherControlActor",()=>new sE.a(b.Ta("Common.ISystemInitiatedFeedback"),
DJ.a.H9b())).as("WordEditor.IModeSwitcherControl").ha();b.ia("WordEditor.Actors.PaperSizeDialogActor",()=>new KK(v.AFrameworkApplication.va,b.Ve("WordEditor.UI.IDialogFactory"),Rn.a.instance)).ha();b.ia("WordEditor.Actors.IgnoreAllProofingErrorStrategy",()=>new xK(b.resolve("Box4.Proofing.IIgnoreAllKeywords"))).ha();b.register(hK,"WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy").ha();b.ia("WordEditor.Actors.ProofingActor",()=>new OK(v.AFrameworkApplication.va,Wh.a.instance,Ma.a.instance.resolve("Box4.ISelectionManager"),
hr.a.instance,Ma.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),Ma.a.instance.resolve("Box4.ILanguageReader"),Ma.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),Ma.a.instance.resolve("WordEditor.Actors.IgnoreAllProofingErrorStrategy"),Ma.a.instance.resolve("WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy"),this.OW,Ma.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),v.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),Ma.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).ha();
(v.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("editorSettingsManager"):b.resolve("Common.IDynamicScriptLoaderProvider").dA.loadScript("EditorSettingsManager")).then(()=>{const B=b.resolve("Box4.Proofing.IEditorSettingsManagerActor");B.tzm();B.init();b.ia("Box4.Proofing.EditorSettingsUIActor",()=>new yJ(v.AFrameworkApplication.va,b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),()=>new zJ(b.resolve("Box4.Proofing.IEditorSettingsManagerActor"),b.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager")))).ha();
v.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&v.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&this.W.resolve("Box4.Proofing.EditorSettingsUIActor").Tb()});b.ia("WordEditor.Actors.PageActor",()=>new IK(Ma.a.instance.resolve("Box4.IWordSectionEditor"),Ma.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ma.a.instance.resolve("WordEditor.IMainViewModeManager"),Ma.a.instance.Ta("Common.ISystemInitiatedFeedback"))).as("WordEditor.IPageCommandStringBuilder").ha();
b.ia("WordEditor.Actors.DarkModeActor",()=>new fK(v.AFrameworkApplication.va,v.AFrameworkApplication.K,Eb.App.aaa,!!Eb.App.instance&&Eb.App.instance.AGa,!!Eb.App.instance&&Eb.App.instance.kYc,Ma.a.instance.resolve("Box4.IDarkModeState"),Ma.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),Ma.a.instance.resolve("Box4.DarkModeEventsManager"),!!Eb.App.instance&&Eb.App.instance.Hpa)).ha();b.ia("WordEditor.FlatListDetailsProvider",()=>new oK(b.resolve("WordEditor.IFlatListEditor")));
b.ia("WordEditor.Actors.AccessibilityActor",()=>new KJ(b.Ta("Box4.Accessibility.IAccessibilityContextManager"),b.Ve("WordEditor.FlatListDetailsProvider"),b.Ve("WordEditor.TrackChange.TrackChangeCpDetailsProvider"),b.Ve("WordEditor.TrackChange.TrackChangeStructuralDetailsProvider"))).ha();b.ia("WordEditor.Actors.AppFrameCommandUIActor",()=>new YJ(v.AFrameworkApplication.va,b.Ta("Postmessage.IHostPostmessenger"))).ha();b.ia("WordEditor.Actors.ImageActor",()=>new Zq(b.resolve("WordEditor.IImageEditor"),
b.Ta("Box4.IExternalSelectionManager"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("WordEditor.Actors.ISWordRequestManager"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.ISelectionManager"),b.resolve("Box4.Images.ImageNavigator"),b.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("Box4.IAppFrame"),v.AFrameworkApplication.K)).as("Box4.Actors.ImageActor").ha();b.ia("WordEditor.Actors.WordFileSaveAsActor",
()=>new aL(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.RenderedImageEditOperation.Factory",()=>new SK(b.resolve("WordEditor.IImageEditor"),v.AFrameworkApplication.K,v.AFrameworkApplication.ua.HQa,Ma.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.IUndoManager"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),b.resolve("Box4.IFeatureHelper"))).ha();b.ia("WordEditor.Actors.DeleteActor",
()=>new gK.DeleteActor(Ma.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),Ma.a.instance.Ta("Box4.ContentControlConfigSettings"),Ma.a.instance.Ta("Box4.IContentControlEditor"),Ma.a.instance.resolve("Box4.IDynamicRangeEditor"),Ma.a.instance.Ta("WordEditor.Bookmark.IBookmarkManager"),Ma.a.instance.resolve("Box4.IHyperlinkEditor"),Ma.a.instance.resolve("Box4.IHyperlinkStrategy"),Ma.a.instance.resolve("Box4.IParagraphReader"),Ma.a.instance.resolve("Box4.IParagraphIndentationReader"),
Ma.a.instance.resolve("Box4.ICharacterPropertiesEditor"),Ma.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Ma.a.instance.resolve("Box4.ContentControl.ContentControlViewElementManager"))).ha();this.W.ia("WordEditor.Actors.SWordRequestManager",()=>new XK(b.resolve("Box4.Images.IImageReader"),b.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),v.AFrameworkApplication.K)).as("WordEditor.Actors.ISWordRequestManager").ha();b.ia("WordEditor.Actors.TableCellSelectionStrategy",
()=>new YK).as("Box4.ITableCellSelectionStrategy").ha();v.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&b.ia("Box4.Actors.FormatPainter",()=>new AJ(b.resolve("Box4.Styles.IWACStyleEditor"),b.resolve("Box4.IInsertionPointFormatting"),b.resolve("Box4.IFormattingEditor"),b.resolve("Box4.IParagraphEditor"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.List.IListEditor"),b.resolve("Box4.List.IListReader"),b.resolve("Box4.ICharacterPropertiesEditor"),Wh.a.instance,b.resolve("Box4.IFeatureHelper"),
b.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,b.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,b.resolve("Box4.TextFormattingHelper"),b.resolve("Box4.Styles.IWACStyleReader"),b.resolve("Box4.IContentControlChpHelper"))).as("Box4.IFormatPainter").ha();b.ia("Box4.Actors.FormatPainterActor",()=>new bE(Eb.App.za,pc.FocusManager.instance(),v.AFrameworkApplication.va,Nh.a.instance,Gp.a.instance,b.resolve("Box4.IFormatPainter"),b.resolve("Box4.ISelectionManager"),!0,b.resolve("Box4.ICssColorProvider"),
!!Eb.App.instance&&Eb.App.instance.Hpa,b.resolve("Box4.DarkModeEventsManager"))).ha();b.ia("WordEditor.Actors.FormattingActor",()=>new pK(v.AFrameworkApplication.va,b.resolve("Box4.List.IListReader"))).ha();b.ia("WordEditor.Actors.UIAutomationActor",()=>new ZK(v.AFrameworkApplication.va)).ha();b.ia("WordEditor.Actors.SaveStatusActor",()=>new UK(v.AFrameworkApplication.va,b.resolve("Common.App.SaveStatus.ISaveStatusUIHandler"))).ha();b.ia("Box4.Actors.IEnterViewStrategy",()=>new BJ(b.Oa("Box4.IAutoCorrectScheduler"),
b.Ve("Box4.IUndoManager"),b.Ta("Box4.IExternalSelectionManager"))).ha();b.ia("Box4.ISelectAllHandlers",()=>new hD(si.PageReader.instance,b.Ve("Box4.IUndoManager"),b.resolve("Box4.Graph.IGraphTransactionFactory"))).ha();b.ia("WordEditor.Actors.ContentControlActor",()=>new dK(b.resolve("WordEditor.ContentControl.IContentControlManager"),b.resolve("WordEditor.ContentControl.IGlossaryNavigator"),b.resolve("Box4.IFormattingEditor"),b.resolve("WordEditor.ContentControl.IContentControlChpManager"),b.resolve("WordEditor.ContentControl.IContentControlOperator"),
b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.Styles.IWACStyleReader"),v.AFrameworkApplication.va,v.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),b.resolve("WordEditor.ContentControl.IContentControlFormattingManager"))).ha();b.ia("WordEditor.Actors.AccessibilityHelpDialogActor",()=>new LJ(v.AFrameworkApplication.va,b.Ve("WordEditor.UI.IDialogFactory"),pc.FocusManager.instance())).ha();b.ia("Box4.Actors.FontNameFormattingStrategyNoop",
()=>new CJ).as("Box4.Actors.IFontNameFormattingStrategy").ha();b.ia("WordEditor.GraphicsEditor.GraphicsEditorRequestManager",()=>new DG(v.AFrameworkApplication.He,qo.PageNavigator.instance,b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("WordEditor.IImageEditor"),Ma.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),v.AFrameworkApplication.K,b.resolve("Box4.IFeatureHelper"))).as("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager").ha();
b.ia("WordEditor.Actors.GraphicsEditorActor",()=>new uK(v.AFrameworkApplication.va,v.AFrameworkApplication.K,b.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager"),b.resolve("WordEditor.IImageEditor"),b.resolve("Box4.CatchUpActivity.IChangeIdEditor"),b.resolve("Box4.IUndoManager"),b.resolve("Box4.ICharacterPropertiesEditor"),b.resolve("Box4.Graph.IGraphTransactionFactory"),b.resolve("Box4.IParagraphReader"),b.resolve("Box4.IBlobReader"),b.resolve("Box4.Images.IImageReader"),v.AFrameworkApplication.He,
this.rd,b.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).ha();b.ia("WordEditor.Actors.RenderParagraphsContainingTabs",()=>new TK).ha();b.ia("WordEditor.Actors.CustomTabActor",()=>new eK(v.AFrameworkApplication.va,b.resolve("WordEditor.ICustomTabStopUtility"),b.resolve("Box4.IOutlineEditor"))).ha();b.ia("WordEditor.Actors.HeadingsActor",()=>new vK(b.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),v.AFrameworkApplication.va,b.resolve("Box4.IParagraphReader"))).ha();
b.ia("WordEditor.Actors.BookmarkActor",()=>new aK(Eb.App.za,v.AFrameworkApplication.va,Bh.a.instance,b.resolve("WordEditor.Bookmark.FullBookmarkManager"),new pf.a(()=>Eb.App.za.jb.Zc),this.W.resolve("Box4.Indicator.IIndicatorManager"),this.W.resolve("Box4.Graph.IGraphTransactionFactory"),this.W.resolve("Common.IReactContextualUILauncher"),this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"),hr.a.instance,this.W.Ta("Common.ISystemInitiatedFeedback"),b.resolve("Box4.IOutlineElementNavigator"),
hb.InteractiveViewManager.instance,this.W.Ve("WordEditor.UI.IDialogFactory"),this.W.resolve("Box4.BookmarkParagraphMapping"),Wh.a.instance)).ha();b.ia("WordEditor.Actors.BookmarkIndicatorActor",()=>{var B,P;return new Ns(b.resolve("Box4.IParagraphReader"),sf.a.instance,ii.a.instance,this.W.resolve("Box4.Highlight.IHighlightManager"),b.resolve("Box4.IInteractiveEventHandler"),null!==(P=null===(B=Eb.App.instance)||void 0===B?void 0:B.dD)&&void 0!==P?P:!1,new pf.a(()=>Eb.App.za.jb.rc))}).ha();b.ia("Box4.Actors.IIFrameFocusStrategy",
()=>new wK).ha();b.ia("WordEditor.Actors.ExternalContentFloatiePositionProvider",()=>new fE(Bh.a.instance,b.resolve("Box4.ITextMetricsAdapter"),hb.InteractiveViewManager.instance,Qd.a.getElementBounds,b.resolve("Box4.UI.ExternalContentFloatieManager"))).ha();b.ia("WordEditor.Actors.ExternalContentActor",()=>new Ps(v.AFrameworkApplication.va,b.resolve("Box4.IUndoManager"),v.AFrameworkApplication.K,b.resolve("Wonca.ExternalContent.IExternalContentEditor"),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",
!1))).as("WordEditor.Actors.ExternalContentActor").ha();b.ia("Box4.UI.ExternalContentFloatieManager",()=>new JJ).as("Box4.UI.IFloatieManager").ha();b.ia("WordEditor.Actors.ActionHangDetector",()=>new MJ(v.AFrameworkApplication.K,v.AFrameworkApplication.va)).as("WordEditor.Actors.ActionHangDetector").ha();b.ia("WordEditor.Actors.ExternalContentFloatieEventManager",()=>new eE(b.resolve("Box4.UI.ExternalContentFloatieManager"),b.resolve("Box4.IExternalContentFloatieEventSource"),hb.InteractiveViewManager.instance,
Jy.a.instance(),v.AFrameworkApplication.ua,b.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider"),b.resolve("Common.IAppSettingsManager"),b.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),Eb.App.si.Il.Ue(12),b.resolve("Box4.Graph.IGraphTransactionManager"),b.resolve("Common.IReactContextualUILauncher"),b.resolve("Box4.SelectionManager"),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ActionManagerRemovedExternalContentFloatie",!1))).ha();b.ia("Box4.Actors.WordIndentationActorExtension",
()=>new bL).as("Box4.Actors.IIndentationActorExtension").ha();v.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&(v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordModernUxExperimentOneSettings"),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&b.ia("WordEditor.Actors.ModernUxActor",()=>new EH(v.AFrameworkApplication.va)).ha());v.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&b.ia("WordEditor.Actors.SwitchToClassicViewModeActor",
()=>new PG(v.AFrameworkApplication.va)).ha();(new oJ).wc(b);b.ia("WordEditor.OnlineMedia.OnlineMediaDialogFactory",()=>new IJ(b.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),b.resolve("Box4.Media.InsertMediaHelper"))).as("WordEditor.OnlineMedia.OnlineMediaDialogFactory").ha();b.ia("WordEditor.OnlineMedia.InsertHubbleMediaHelper",()=>new GJ(v.AFrameworkApplication.va,b.resolve("Box4.Media.InsertMediaHelper"),!!Eb.App.instance&&Eb.App.instance.M1d)).ha();b.ia("WordEditor.OnlineMedia.OnlineMediaActor",
()=>new HJ(v.AFrameworkApplication.va,v.AFrameworkApplication.K,b.resolve("WordEditor.OnlineMedia.OnlineMediaDialogFactory"),b.resolve("WordEditor.OnlineMedia.InsertHubbleMediaHelper"),b.resolve("Wonca.ExternalContent.IExternalContentEditor"),Wh.a.instance,v.AFrameworkApplication.K.$("GetCustomHeaderEnabled")?Ma.a.instance.resolve("Common.App.OAuth.IOAuthManager"):void 0)).ha();(null===(r=v.AFrameworkApplication.K)||void 0===r?0:r.getBooleanFeatureGate("Microsoft.Office.WordOnline.MiniTemplateForAppWelcomeExp",
!1))&&b.ia("WordEditor.Actors.MiniTemplateActor",()=>new HK(v.AFrameworkApplication.va,b.Ta("WordEditor.Extension.IInsertApiOperations"),b.Ta("WordEditor.Designer.Style.IParagraphDesigner"),DJ.a.H9b())).ha();this.EXj=new EJ;this.wW=this.W.resolve("Box4.Highlight.IHighlightManager")}static main(){L.a.instance.Gc(new JH)}}Object(m.a)(JH,"WordEditorActorsPackage",null,[1,2]);class cL{constructor(b){this.gpd=!1;this.GVi=()=>{this.gpd=!0;this.Ds.Sde(this.GVi)};this.Ds=b;this.Ds.ZAb(this.GVi)}}Object(m.a)(cL,
"GraphFullyConnectedGetter",null,[335]);class Wf{constructor(){this.p5g=Object.assign(new Pp.a,{})}fsk(b,h){let r;const B=b&1023;({value:r}=this.p5g.Fc(B,0)).returnValue||Wf.gmm().contains(B)||t.ULS.sendTraceTag(50942149,338,15,"Culture is not supported. LCID {0}; Key: {1}",b,B);r+=h;this.p5g.Z(B,r);return r}static gmm(){Wf.myd||(Wf.myd=new fa.a,Wf.pc(0),Wf.pc(1),Wf.pc(2),Wf.pc(3),Wf.pc(4),Wf.pc(5),Wf.pc(6),Wf.pc(7),Wf.pc(8),Wf.pc(9),Wf.pc(10),Wf.pc(11),Wf.pc(12),Wf.pc(13),Wf.pc(14),Wf.pc(15),Wf.pc(16),
Wf.pc(17),Wf.pc(18),Wf.pc(19),Wf.pc(20),Wf.pc(21),Wf.pc(22),Wf.pc(23),Wf.pc(24),Wf.pc(25),Wf.pc(26),Wf.pc(27),Wf.pc(28),Wf.pc(29),Wf.pc(30),Wf.pc(31),Wf.pc(32),Wf.pc(33),Wf.pc(34),Wf.pc(35),Wf.pc(36),Wf.pc(37),Wf.pc(38),Wf.pc(39),Wf.pc(40),Wf.pc(41),Wf.pc(42),Wf.pc(43),Wf.pc(44),Wf.pc(45),Wf.pc(46),Wf.pc(47),Wf.pc(48),Wf.pc(49),Wf.pc(50),Wf.pc(51),Wf.pc(52),Wf.pc(53),Wf.pc(54),Wf.pc(55),Wf.pc(56),Wf.pc(57),Wf.pc(58),Wf.pc(59),Wf.pc(60),Wf.pc(61),Wf.pc(62),Wf.pc(63),Wf.pc(64),Wf.pc(65),Wf.pc(66),Wf.pc(67),
Wf.pc(68),Wf.pc(69),Wf.pc(70),Wf.pc(71),Wf.pc(72),Wf.pc(73),Wf.pc(74),Wf.pc(75),Wf.pc(76),Wf.pc(77),Wf.pc(78),Wf.pc(79),Wf.pc(80),Wf.pc(81),Wf.pc(82),Wf.pc(83),Wf.pc(84),Wf.pc(85),Wf.pc(86),Wf.pc(87),Wf.pc(88),Wf.pc(89),Wf.pc(90),Wf.pc(91),Wf.pc(92),Wf.pc(93),Wf.pc(94),Wf.pc(95),Wf.pc(96),Wf.pc(97),Wf.pc(98),Wf.pc(99),Wf.pc(100),Wf.pc(101),Wf.pc(102),Wf.pc(103),Wf.pc(104),Wf.pc(105),Wf.pc(106),Wf.pc(107),Wf.pc(108),Wf.pc(109),Wf.pc(110),Wf.pc(111),Wf.pc(112),Wf.pc(113),Wf.pc(114),Wf.pc(115),Wf.pc(116),
Wf.pc(117),Wf.pc(118),Wf.pc(119),Wf.pc(120),Wf.pc(121),Wf.pc(122),Wf.pc(124),Wf.pc(126),Wf.pc(127),Wf.pc(128),Wf.pc(129),Wf.pc(130),Wf.pc(131),Wf.pc(132),Wf.pc(133),Wf.pc(134),Wf.pc(135),Wf.pc(136),Wf.pc(140),Wf.pc(145),Wf.pc(146),Wf.pc(147));return Wf.myd}static pc(b){Wf.myd.add(b&1023)}}Wf.myd=null;Object(m.a)(Wf,"LanguagePerParagraphModel",null,[]);class dL{constructor(){this.Vgg=!1;this.RFd=this.QFd=this.LTb=0;this.xEi=!0;this.n8o=0}}Object(m.a)(dL,"UpdateWordCountStateResult",null,[]);class eL extends Sys.EventArgs{constructor(b){super();
this.isEnabled=b}}Object(m.a)(eL,"WordCountAvailabilityChangedEventArg",Sys.EventArgs,[]);class fL{constructor(){this.gDh=this.fDh=this.wordCount=-1;this.nEb=this.Jyh=0;this.mEb=1;this.J0i=1033}}Object(m.a)(fL,"WordCountCache",null,[]);class gL extends Sys.EventArgs{constructor(b){super();this.state=b}}Object(m.a)(gL,"WordCountChangedEventArg",Sys.EventArgs,[]);class hL{constructor(){this.xpc=this.IDa=0}}Object(m.a)(hL,"CharsCountResult",null,[]);class iL{constructor(){this.cp=0;this.zpc=null;this.n8=
this.o8=0}}Object(m.a)(iL,"TextChunkResult",null,[]);class jL{constructor(){this.wLj=this.o8=this.n8=this.wordCount=0}}Object(m.a)(jL,"WordCountStateForParagraph",null,[]);class KH{constructor(){this.X$=this.HJ=this.o8=this.n8=this.eS=this.wordCount=0;this.currentNode=null;this.GX=-1;this.cp=0;this.A0f=[];this.mEb=this.nEb=this.W_a=this.v0f=this.w0f=0;this.vI=this.Eyi=!1;this.ssb=new mb.a;this.h5a=new mb.a}}Object(m.a)(KH,"WordCountState",null,[]);class $q{constructor(b,h,r,B,P,ca){this.DCo=1E3;this.sa=
new Pc.a;this.yAb=null;this.Mse=0;this.I3j="\ue000";this.suc=!1;this.dye=this.Txe=this.Fjd=0;this.kRg=this.tRg=null;this.Pxe=this.Oxe=this.Yxe=0;this.Drl=ra=>{this.yAb=null;this.zgf(ra.customData)};this.bG=h;this.T1j=new RegExp(oi.AParagraphNode.RC,"g");this.Jd=b;this.taskManager=B;this.um=r;this.l_a=ca;this.HXa=P.$("WordEditorWordCountPackageImageAndTableCountIsEnabled");this.Eik=P.$("WordEditorWordCountPackageSelectionAdditionalCountsIsEnabled");this.pej()}get fYm(){return!!this.yAb}get gPa(){return this.suc}set gPa(b){this.suc=
b}get pBd(){return this.Mse}set pBd(b){this.Mse=b}get URa(){return!this.Mse}get Ey(){return this.Fjd}get zDb(){return this.Txe}get DDb(){return this.dye}get xhl(){return this.tRg}get Ycf(){return this.kRg}get eLc(){return this.Yxe}get bLc(){return this.Oxe}get m6b(){return this.Pxe}ZAb(b){this.sa.addHandler($q.Qpe,b)}Sde(b){this.sa.removeHandler($q.Qpe,b)}F0e(b){this.sa.addHandler($q.tsg,b)}u2n(b){this.sa.removeHandler($q.tsg,b)}VKd(){this.UKd();this.pej()}pej(){this.Yxe=this.Pxe=this.Oxe=this.dye=
this.Txe=this.Fjd=-1}ief(){this.ske(this.DCo)}Vad(){const b=new KH;b.Eyi=!0;this.UKd();this.zgf(b)}ske(b,h=null){this.URa&&(this.fYm&&(h=null,this.UKd()),h||(h=new KH),b=new Me.a(3,1,b,this.Drl,this.yyj),b.customData=h,this.Bwk(b))}UKd(){this.yAb&&(this.taskManager.ff(this.yAb),this.yAb=null)}zIj(b,h,r,B,P,ca=!0,ra=-1,Qa=-1,tb=-1,Mb=1033){const Zb=new dL;Zb.LTb=r;Zb.QFd=P;Zb.RFd=B;if(!b.cp&&h.Led&&ca&&!this.bgi(h))return $q.Z_o(b,h.Led),Zb.xEi=!0,Zb;B=0<=Qa&&0<=tb?{Bd:Qa,endCp:tb}:void 0;r=this.TMl(h,
B);B&&(Qa=B.Bd,tb=B.endCp);r=0<=tb?r.substring(0,tb):r;tb=0<=Qa&&0<=tb?r.substring(Qa,tb):r;B=b.cp>=Qa?b.cp:Qa;P=b.A0f||[];ca=0<b.w0f?b.w0f:0;let jc=0<b.v0f?b.v0f:0,Gc=[];b.vI=!1;do{this.l_a.update();if(!b.Eyi&&(Zb.LTb+Gc.length/2>$q.l5o||this.l_a.dnb())){let Od;P=(Od=P).concat.apply(Od,Gc);b.cp=B;b.A0f=P;b.v0f=jc;b.w0f=ca;b.GX=ra;b.currentNode=h;this.ske($q.P8o,b);Zb.Vgg=!0;b.vI=!0;return Zb}if((!B||B===Qa)&&0<r.length&&B<r.length){P.push(Oz.a.instance.Hvf(r,B));var Uc=this.bgi(h);if(0<=ra&&!B&&
Uc){b.wordCount+=1;Zb.LTb+=1;const Od=this.Jd.dY(Uc);Uc=this.bG.E1c(Od,Uc);Uc=$q.WId(Uc);b.o8+=Uc.IDa+1;b.n8+=Uc.IDa-Uc.xpc}}Uc=this.Bki(r,B,$q.FXk);B=Uc.cp;let od;Gc=(od=Gc).concat.apply(od,Uc.zpc);ca+=Uc.o8;jc+=Uc.n8}while(-1!==B);b=this.fqk(b,P,Gc,r,tb,Zb.LTb,Zb.QFd,Zb.RFd,h,-1===ra,Mb);Zb.LTb=b.wordCount;Zb.QFd=b.n8;Zb.RFd=b.o8;Zb.n8o=b.wLj;return Zb}kUh(b,h){const r=ke.ParagraphReader.textLength(h,9);if(r){h=So.e(h);var B=0;for(let P=0;P<h.length;P++)if(this.nkb&&5===h[P].vh&&b.HJ++,$q.zro(h[P])){B++;
break}h.length!==r?b.eS++:b.eS+=B}}lqj(b){this.pBd=this.Zro(b.W_a,b.wordCount)?1:0;return!!this.pBd}AZi(b){this.Fjd=b.wordCount;this.Txe=b.HJ;this.dye=b.X$;this.Pxe=b.o8;this.Oxe=b.n8;this.Yxe=b.eS;this.tRg=b.ssb;this.kRg=b.h5a;this.p7i(b)}p7i(b){this.sa.raiseEvent($q.Qpe,new gL(b))}o7i(){this.sa.raiseEvent($q.tsg,new eL(!1))}Zro(b,h){if(Z.a.gt||Z.a.Nt||Z.a.TG)return!1;(h/=2)||(h=1);return(h?b/h:0)>$q.Xan?!0:!1}get nkb(){const b=!this.QOf||1===this.QOf&&this.Eik;return this.HXa&&b}Mci(b,h){let r=
1033,B=0;b=h.Urf(b);h=new Wf;for(let P=0;P<b.length;P++){const ca=h.fsk(b[P].lcid,b[P].end-b[P].Ec);B<ca&&(B=ca,r=b[P].lcid)}return r}fqk(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb){var jc;h=(jc=h).concat.apply(jc,r);r=Oz.a.instance.Dki(h,B);b.wordCount+=r.wordCount;P=$q.WId(P);jc=P.IDa-P.xpc;const Gc=P.IDa;b.n8+=jc;b.o8+=Gc;ca+=r.wordCount;ra+=P.IDa-P.xpc;Qa+=P.IDa;b.W_a+=r.W_a;const {Ftl:Uc,jMo:od}=$q.eqk(h,B);b.nEb+=Uc;b.mEb+=od;b.h5a.add(Zb);b.ssb.add(r.wordCount);Mb&&$q.yQk(Gc,jc,tb,r,Uc,od,Zb);b.cp=0;b.A0f=
[];b=new jL;b.n8=ra;b.o8=Qa;b.wordCount=ca;b.wLj=r.wordCount;return b}TMl(b,h){let r=this.$3n(b);r=ke.ParagraphReader.fib(b,9,r,h);return this.m_n(r)}$3n(b){var h=ke.ParagraphReader.text(b);b=So.e(b);if(0<b.length){h=h.split("");for(let B=0;B<b.length;++B){let P=!0;var r=!0;const ca=b[B];if(1===ca.vh)r=ca,r=22!==r.kind&&2!==r.kind;else if(5===ca.vh)P=!1;else if(7===ca.vh||10===ca.vh)h[ca.Lb.cp]=this.I3j,P=!1;if(P){if(ca.Lb.cp>=h.length)return"";h[ca.Lb.cp]=r?" ":"C"}}h=h.join("")}return h}m_n(b){return b.replace(this.T1j,
"")}Bki(b,h,r){const B=b.length-h<=r;var P=B?b.length:h+r;const ca=new iL;if(P<h)return ca.cp=-1,ca;ca.zpc=Oz.a.instance.Fof(b,h,P);P=$q.WId(b.substr(h,P));ca.o8=P.IDa;ca.n8=P.IDa-P.xpc;if(!ca.zpc.length&&!B)return r===b.length-h?ca:this.Bki(b,h,b.length-h);ca.cp=B||!ca.zpc.length?-1:ca.zpc[ca.zpc.length-1].cp;return ca}Bwk(b){this.yAb=b;this.taskManager.Wb(this.yAb)}bgi(b){if(b=b.ND){const h=this.Jd.dY(b);if(h&&h.Lz)return b}return null}static zro(b){return 11===b.vh}static Z_o(b,h){b.wordCount+=
h.wordCount;b.n8+=h.fDh;b.o8+=h.gDh;b.W_a+=h.Jyh;b.nEb+=h.nEb;b.mEb+=h.mEb;b.h5a.add(h.J0i);b.ssb.add(h.wordCount)}static yQk(b,h,r,B,P,ca,ra){const Qa=new fL;Qa.wordCount=B.wordCount;Qa.gDh=b;Qa.fDh=h;Qa.Jyh=B.W_a;Qa.nEb=P;Qa.mEb=ca;Qa.J0i=ra;r.Led=Qa}static WId(b){const h=b.length,r=new hL;for(let P=0;P<h;P++){var B=b.charCodeAt(P);r.IDa++;if(55296<=B&&56319>=B&&(B=P+1<h?b.charCodeAt(P+1):0,56320<=B&&57343>=B)){P++;continue}F.a.pda(b.charAt(P))&&r.xpc++}return r}static eqk(b,h){let r=0,B=0;for(let P=
0;P<b.length;++P){const ca=b[P],ra=ca.UL;(3===ra||2===ra)&&ca.cp<h.length&&(++r,F.a.Fcc(h.charCodeAt(ca.cp))&&++B)}return{Ftl:B,jMo:r}}}$q.Qpe="wctek";$q.tsg="wcac";$q.P8o=1;$q.FXk=400;$q.l5o=90;$q.Xan=.1;Object(m.a)($q,"WordCountManagerBase",null,[349]);class kL extends $q{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb){super(b,h,r,P,tb,Mb);this.z2h=this.Cyd=this.rma=null;this.xqa=()=>{this.ief()};this.hb=B;this.Ad=ra;this.Oih=Qa;this.NI=Zb;this.hb.Ww(this.xqa);this.hHe=tb.$("ReadingTimeIsEnabled")}get yyj(){return 66}cCm(){if(this.rma)return!0;
if(!this.hb||!this.hb.ib)return this.Ad&&(Eb.App.pZd||v.AFrameworkApplication.Rk?this.Ad.Yb("SelectionWordCountSelectionNullWhenAppExiting",{["Reason"]:"SelectionWordCount triggerred when app is exiting"}):this.Ad.Yb("SelectionWordCountSelectionNullWhenAppAlive")),!1;const b=this.hb.ib.clone();this.rma=b.IO(!0);if(!this.rma||!this.rma.$Y())return this.UKd(),!1;this.Oih&&(this.Cyd=this.Oih.create(h=>b.IO(h),this.um));this.rma.moveNext();return!0}get QOf(){return 1}s6k(b){return b===yc.a.Fd||b===yc.a.paragraph?
!0:this.nkb&&(b===yc.a.hFb||b===yc.a.image||b===yc.a.X7)}zgf(b){this.l_a.reset();if(this.cCm()){for(this.nkb&&this.Cyd&&(this.Cyd.yrl(b,this.l_a)||this.ske(1,b));this.rma.current;){const B=-1===b.GX?0:b.GX;let P=0;var h=this.rma.current;if(!this.s6k(h.contextId)){this.rma.moveNext();continue}if(this.nkb&&Id.ImageReader.b4a(h)){b.HJ++;this.rma.moveNext();continue}if(!ke.ParagraphReader.Xb(h.node)){this.rma.moveNext();continue}const ca=h.node;if(this.gPa&&this.z2h&&this.z2h.B2a(ca))this.rma.moveNext();
else{if(this.nkb&&h.isValid){var r=Ad.GraphIterator.eb(ca);for(r.Ub(6);!r.$r;)Id.ImageReader.Mt(r.currentNode)&&b.HJ++,r.Ti(6)}r=this.hHe?this.Mci(ca,this.NI):1033;h=this.zIj(b,ca,0,0,0,this.l_d(h),B,h.cpBegin,h.cpEnd,r);if(h.xEi&&(P+=1,100<P)){b.GX=B+1;this.ske(1,b);return}if(h.Vgg)return;this.kUh(b,ca);this.rma.moveNext()}}this.Cyd=this.rma=null;this.lqj(b)?(this.Fjd=-1,this.o7i()):this.AZi(b)}}l_d(b){let h=!1;b.contextId===yc.a.paragraph?h=!0:b.contextId===yc.a.Fd&&(h=b.cpEnd-b.cpBegin===b.node.characterData.length);
return h}}Object(m.a)(kL,"SelectionWordCountManager",$q,[]);class QG{constructor(b,h){this.hYb=!1;this.Izb=null;b&&h&&(this.V0b=b(!1),this.Yc=h,this.V0b.moveNext())}yrl(b,h){if(!b||!this.V0b||!this.V0b.current)return!0;do{const r=this.V0b.current;if(r.contextId===yc.a.ay||r.contextId===yc.a.Hw){for(this.Izb||this.lCm(r.node);this.Izb.moveNext();)if(14===this.Izb.currentNode.type&&b.X$++,h.update(),h.dnb())return!1;this.R8k(r,b);this.Izb=null}this.V0b.moveNext()}while(this.V0b.current);return!0}R8k(b,
h){const r=this.Yc.Rf(b.node);r.zb(14);b.contextId===yc.a.ay&&(dl.a.ryi(r)&&(this.hYb=!0),dl.a.M_d(r)&&this.hYb&&(this.hYb=!1,h.X$++));b.contextId===yc.a.Hw&&(Ah.TableCellReader.AWc(r)&&(this.hYb=!0),Ah.TableCellReader.vRa(r)&&this.hYb&&(this.hYb=!1,h.X$++))}lCm(b){this.Izb=Ab.a.gp(b);14===b.type?this.Izb.yo(QG.hOc,b):this.Izb.yo(QG.hOc,null)}static hOc(b){return b.parentNode?!0:!1}}Object(m.a)(QG,"TableCountSelectionTraverser",null,[350]);class lL{constructor(b){this.HXa=b.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}create(b,
h){return this.HXa?new QG(b,h):null}}Object(m.a)(lL,"TableCountSelectionTraverserFactory",null,[334]);class mL extends $q{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb){super(b,h,r,P,tb,Mb);this.n5o=jc=>{if(jc.$r)return!0;jc=jc.role;return 1===jc||2===jc||this.nkb&&6===jc||3===jc||4===jc||5===jc||!this.gPa&&(7===jc||8===jc)};this.ga=B;this.yek=ca;this.pnk=ra;this.TQg=Qa;this.NI=Zb;this.ga.fb(qb.a.uLj,yc.a.application,cd.ActionManager.Of,64);this.ga.fb(qb.a.vLj,yc.a.application,cd.ActionManager.Of,64);this.hHe=
tb.$("ReadingTimeIsEnabled")}get yyj(){return 63}get QOf(){return 0}zgf(b){this.l_a.reset();b.vI=!1;var h=this.yek();si.PageReader.instance.EJb(h)||(this.VKd(),this.o7i());h=this.um.Eoa(h,7,7).currentNode;var r=this.Ibl(b.currentNode,h);h=this.pnk(r,h);h.yo(this.n5o,null);let B=r=0;for(var P=0;h.moveNext();)if(h.currentNode&&this.Jd.hda(h.currentNode)){var ca=this.Jd.dY(h.currentNode);if(ca.Lz){var ra=this.Jd.CGb(h.currentNode);if(ra&&(ra=ra.qa.last,(null===ra||void 0===ra?0:ra.Ph)&&(ub.App.uN&&ra.Mh||
ra.MR)))continue;b.wordCount+=1;if(ca=this.bG.E1c(ca,h.currentNode))ca=$q.WId(ca),b.o8+=ca.IDa+1,b.n8+=ca.IDa-ca.xpc;r+=1;B+=b.o8;P+=b.n8}}else if(this.nkb&&h.currentNode&&Id.ImageReader.Mt(h.currentNode))b.HJ++;else if(this.nkb&&h.currentNode&&Rh.TableReader.KR(h.currentNode))b.X$++;else if(h.currentNode&&ke.ParagraphReader.Xb(h.currentNode)){ca=h.currentNode;ra=this.hHe?this.Mci(ca,this.NI):1033;P=this.zIj(b,ca,r,B,P,!0,-1,-1,-1,ra);if(P.Vgg){b.vI=!0;v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorWordCountPackageImageAndTableCountSettings");
return}this.kUh(b,ca);r=P.LTb;B=P.RFd;P=P.QFd}this.lqj(b)?(this.VKd(),this.S4n(),this.p7i(b)):this.AZi(b)}Ibl(b,h){b?(b=this.TQg(b),b.zb(7)):b=this.TQg(h);return b}S4n(){switch(this.pBd){case 1:this.ga.processAction(qb.a.uLj,2);break;case 2:this.ga.processAction(qb.a.vLj,2)}}}Object(m.a)(mL,"TotalWordCountManager",$q,[]);class nL{constructor(){this.gjj=this.fjj=this.Ybg=this.hjj=this.DAj=this.EAj=this.BAj=this.CAj=0}get NSi(){return this.h$b(this.hjj,this.EAj,"WC")}get hjn(){return this.h$b(this.fjj,
this.BAj,"NumCharsNoSp")}get ijn(){return this.h$b(this.Ybg,this.CAj,"NumCharsWithSp")}get njn(){return this.h$b(this.gjj,this.DAj,"NumParagraphs")}h$b(b,h,r){const B=this.qed(h,r).toLocaleString();return 0<this.Ybg?(b=this.wrg(b,h,r),String.format(WordEditorIntl.WordEditorStrings.L_DocStatsDialogCountString,b.toLocaleString(),B)):B}wrg(b,h,r){b=this.qed(b,r);return b>h?(t.ULS.sendTraceTag(22397767,338,15,"Sel>Total for {0}",r),h):b}qed(b,h){0>b&&t.ULS.sendTraceTag(22397768,338,15,"{0}<0",h);return Math.max(b,
0)}}Object(m.a)(nL,"DocumentStats",null,[]);class RG{static $af(b){return Pe.a.Kx(RG.Xm,WordEditorIntl.WordEditorStrings.L_DocStatsDialogWordsCount,b.NSi,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsNoSpacesCount,b.hjn,WordEditorIntl.WordEditorStrings.L_DocStatsDialogCharsWithSpacesCount,b.ijn,WordEditorIntl.WordEditorStrings.L_DocStatsDialogParagraphsCount,b.njn)}}RG.Xm="<table id='DocumentStatsTable' cellpadding=5 cellspacing=5 role='presentation' width='100%'> <tr role='presentation'> <td> <span id='WordCount' class='WACDialogSpan'>{0}</span> </td> <td style='text-align:right'> <span id='WordCountResult' class='WACDialogSpan'>{1}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharNoSpacesCount' class='WACDialogSpan'>{2}</span> </td> <td style='text-align:right'> <span id='CharNoSpacesCountResult' class='WACDialogSpan'>{3}</span> </td> </tr> <tr role='presentation'> <td> <span id='CharWithSpacesCount' class='WACDialogSpan'>{4}</span> </td> <td style='text-align:right'> <span id='CharWithSpacesCountResult' class='WACDialogSpan'>{5}</span> </td> </tr> <tr role='presentation'> <td> <span id='ParagraphCount' class='WACDialogSpan'>{6}</span> </td> <td style='text-align:right'> <span id='ParagraphCountResult' class='WACDialogSpan'>{7}</span> </td> </tr> </table>";
Object(m.a)(RG,"DocumentStatsDialogHtml",null,[]);class oL extends Pe.a{constructor(b){super();this.XS=!1;this.isl=()=>{};this.eG=b}uwo(){this.yg="DocumentStatsDialog";this.Vg=RG.$af(this.eG);this.Cd=0;this.showDialog(WordEditorIntl.WordEditorStrings.L_DocStatsDialogTitle,this.isl);this.L5("DocumentStatsTable")}V9(){}dispose(){this.XS||(super.dispose(),this.XS=!0)}}Object(m.a)(oL,"DocumentStatsDialog",Pe.a,[]);class pL{constructor(b,h,r,B,P,ca,ra,Qa,tb){this.Phh=this.cwc=this.suc=this.gYb=this.gIe=
!1;this.phc=()=>{this.Poe()};this.Aqa=()=>{this.Poe()};this.foo=()=>{this.Phh=!0;return 32};this.k5f=()=>this.Ds.URa?32:8;this.J5c=(Mb,Zb,jc,Gc,Uc)=>{if(1===jc)return this.Ds.URa?32:8;Uc[qg.a.On]=this.fJf;return 32};this.vme=(Mb,Zb,jc)=>{if(1===jc)return this.Ds.URa?32:8;this.fJf?this.Yol():this.Dvl();Eb.App.za.jH({ShowWordCount:"CheckboxModel"});return 32};this.gmc=(Mb,Zb,jc)=>{if(1===jc)return Gg.a.sia(Zb)?8:this.Ds.URa?32:8;if(this.Phh)return v.AFrameworkApplication.va.processAction(qb.a.m9d,2),
32;Mb=this.je.Zf("UserAction","Show Word Count Dialog");Mb.start();this.Ds.Vad();this.IQ.Vad();this.Ds.Ey!==this.IQ.Ey?t.ULS.sendTraceTag(23188303,338,50,"Open Word Count Dialog with content selected"):t.ULS.sendTraceTag(523072473,338,50,"Open Word Count Dialog without content selected");Zb=this.aal();(new oL(Zb)).uwo();Mb.stop();return 32};this.W4c=(Mb,Zb,jc,Gc,Uc)=>{Uc||t.ULS.sendTraceTag(23652428,338,10,String.format("{0}","actionData is null"));if(1===jc)return 32;if(!this.Ds.URa)return Uc[pj.a.Visible]=
!1,32;Uc[pj.a.Visible]=!0;this.fJf?(Mb=this.Ds.Ey,0>Mb?Mb=WordEditorIntl.WordEditorStrings.l_WordCountCalculating:Mb?(Zb=this.IQ?this.IQ.Ey:-1,Mb=0<Zb?this.Wdm(Mb,Zb):String.format(1===Mb?WordEditorIntl.WordEditorStrings.l_WordCountResultSingularAccurate:WordEditorIntl.WordEditorStrings.l_WordCountResultAccurate,this.ufe(Mb))):Mb=String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultExact,this.ufe(Mb))):Mb=WordEditorIntl.WordEditorStrings.l_WordCountHidden;Uc[pj.a.LabelText]=Mb;return 32};
this.vxe=ra;this.wxe=ca;this.Ds=b;this.IQ=h;this.KDc=r;this.dlk=P;this.IQ.F0e(this.phc);this.Ds.F0e(this.phc);this.IQ.ZAb(this.Aqa);this.Ds.ZAb(this.Aqa);this.je=Qa;this.gPa=B;this.HXa=tb.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}get Xdf(){return!Z.a.U4}Tb(){const b=v.AFrameworkApplication.va;b.ra(qb.a.vme,yc.a.application,this.vme);b.ra(qb.a.gmc,yc.a.view,this.gmc);b.fb(qb.a.J5c,yc.a.application,this.J5c,96);b.fb(qb.a.W4c,yc.a.application,this.W4c,96);b.fb(qb.a.k5f,yc.a.application,
this.k5f,96);b.ra(qb.a.IWh,yc.a.application,this.foo)}get gPa(){return this.suc}set gPa(b){this.suc=b;this.Ds.gPa=b;this.IQ.gPa=b}Dvl(){this.Ds.URa&&(this.Xoj(!0),this.Poe(),this.Ds.Vad())}aal(){const b=new nL;b.EAj=this.Ds.Ey;b.CAj=this.Ds.m6b;b.BAj=this.Ds.bLc;b.DAj=this.Ds.eLc;b.hjj=this.IQ.Ey;b.fjj=this.IQ.bLc;b.Ybg=this.IQ.m6b;b.gjj=this.IQ.eLc;return b}$Wl(){return this.vxe("WACWordCountEnabled",this.Xdf)}Nge(b){this.wxe("WACWordCountEnabled",b?"true":"false",Hc.a.hHa)}get fJf(){this.gYb||(this.gIe=
this.$Wl(),this.gYb=!0);return this.gIe}Xoj(b){this.Nge(b);this.gIe=b;this.gYb=!0}Yol(){this.Ds.VKd();this.IQ.VKd();this.Xoj(!1);this.Poe()}get cK(){return null!=this.jHg?this.jHg:this.jHg=(()=>this.KDc())()}Poe(){this.cwc||(t.ULS.sendTraceTag(23188304,338,50,"Word count document stats: {0}",this.kgl()),this.cwc=!0);this.cK&&this.cK.nV(this.dlk)}kgl(){const b={["words"]:this.Ds.Ey,["charsWithSpaces"]:this.Ds.m6b,["charsWithNoSpaces"]:this.Ds.bLc,["paragraphs"]:this.Ds.eLc};this.HXa&&(b.images=this.Ds.zDb,
b.tables=this.Ds.DDb);return b}ufe(b){try{return b.toLocaleString()}catch(h){t.ULS.sendTraceTag(23652430,338,10,String.format("Error converting count to locale string, error: {1}, stacktrace: {2}",h.toString(),h.stack))}return b.toString()}Wdm(b,h){h>b&&(t.ULS.sendTraceTag(23652432,338,10,String.format("Selection word count is greater than total word count.")),h=b);return String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultOnSelectionAccurate,this.ufe(h),this.ufe(b))}}Object(m.a)(pL,"WordCountActor",
null,[]);class qL extends zr.a{constructor(b,h,r,B){super();this.TY=(P,ca)=>{if(ca.property===Pd.a.wo||ca.property===Pd.a.Sn)P=ca.node,ca=ub.App.nn.jb.rc,ca.mv&&ca.ed&&ca.ed.Mc&&P.Mc&&P.Mc.id===ca.ed.Mc.id&&this.SXh(P)};this.aXi=(P,ca)=>{this.SXh(ca.node)};this.srn=(P,ca)=>{ca.property!==Yc.a.MA&&ca.property!==Mc.a.pv||this.QY()};this.m7d=()=>{this.QY()};this.b3=b;this.Ds=h;this.xq=r;this.HXa=B.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}Qz(){var b=this.xq.Ue(12);b.Eo(this.TY);b.ju(this.aXi);
b.Vw(this.aXi);b=this.xq.Ue(22);b.Eo(this.srn);b.ju(this.m7d);b.Vw(this.m7d);this.HXa&&this.XWn();this.b3.nra(this,7)}XWn(){var b=[19,14];for(const h of b)b=this.xq.Ue(h),b.ju(this.m7d),b.Vw(this.m7d)}get index(){return 1}run(){this.Ds.ief()}SXh(b){b.Led=null;this.QY()}}Object(m.a)(qL,"WordCountAppEventCoordinator",zr.a,[]);class LH{}LH.gqk="AccurateWordCountButton";Object(m.a)(LH,"WordCountConstants",null,[]);class rL{constructor(b,h){this.Ds=b;this.IQ=h}getInstance(b){switch(b){case 1:return this.IQ;
case 0:return this.Ds;default:return this.Ds}}}Object(m.a)(rL,"WordCountManagerFactory",null,[242]);class MH{constructor(){this.W=null}get name(){return"WordEditor.WordCount"}wc(b){this.W=b;const h=this.W.resolve("Common.IAppSettingsManager");this.W.ia("WordEditor.WordCount.ITableCountSelectionTraverserFactory",()=>new lL(h)).ha();this.W.ia("WordEditor.WordCount.IWordCountManagerFactory",()=>{var r=new Cn.a(10,Qd.a.$e);const B=new mL(b.resolve("Box4.List.IListReader"),b.resolve("Box4.IListMarkerUtility"),
new Tp.a,v.AFrameworkApplication.va,v.AFrameworkApplication.lc,()=>ub.App.nn.jb.rc.ed,Ab.a.Gs,Ad.GraphIterator.eb,h,r,Ma.a.instance.resolve("Box4.ILanguageReader"));r=new kL(Ma.a.instance.resolve("Box4.List.IListReader"),Ma.a.instance.resolve("Box4.IListMarkerUtility"),new Tp.a,Bh.a.instance,v.AFrameworkApplication.lc,dz.a.instance,Nh.a.instance,Ma.a.instance.resolve("WordEditor.WordCount.ITableCountSelectionTraverserFactory"),h,r,Ma.a.instance.resolve("Box4.ILanguageReader"));return new rL(B,r)}).ha();
this.W.ia("WordEditor.WordCount.GraphFullyConnectedGetter",()=>new cL(this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0))).as("WordEditor.IGraphFullyConnectedGetter").ha()}init(){const b=Eb.App.za.jb;b.zxa?this.mka():b.sga(()=>{this.mka()})}mka(){if(Eb.App.si){var b=Eb.App.si.Il;if(b){this.W.resolve("WordEditor.IGraphFullyConnectedGetter");var h=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0),r=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(1),
B=Ma.a.instance.resolve("Common.IAppSettingsManager");(new pL(h,r,()=>Ma.a.instance.Oa("WordEditor.IStatusBarUser"),this.bWl(),LH.gqk,Hc.a.PIa,Hc.a.uca,Ma.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),B)).Tb();(new qL(Si.GraphTransactionManager.instance,h,b,B)).Qz();h.ief()}else t.ULS.sendTraceTag(22425994,306,10,"Graph is null. Word Count will not be available")}else t.ULS.sendTraceTag(23967264,306,15,"TheNotebookManager is null. Word Count will not be available")}bWl(){var b=
ub.App.nn.jb;if(!b)return t.ULS.sendTraceTag(22611550,324,10,""),!1;b=b.rc;if(!b)return t.ULS.sendTraceTag(22611552,324,10,""),!1;b=b.ed;return b?b.ja(Mc.a.gPa,!1):(t.ULS.sendTraceTag(22611554,324,10,""),!1)}dispose(){}static main(){L.a.instance.Gc(new MH)}}Object(m.a)(MH,"PackageManager",null,[1,2]);var kN=c(2071);class sL{constructor(b){this.WRe=null;b.Ta("Common.App.SearchCommon.SearchHostRuntime").execute(h=>{this.WRe=h})}vlj(b){this.WRe&&this.WRe.urf().handleDocumentContentAugloopAnnotation(b)}}
Object(m.a)(sL,"DocumentContentExtractionManager",null,[302]);class Oh{}Oh.mAo="mso_smartLookup";Oh.channelId="SmartLookup";Oh.lAo="https://uciserviceintcdnwus.blob.core.windows.net/mirrored/smartlookup/";Oh.tuj="https://uci.edog.cdn.office.net/mirrored/smartlookup/";Oh.uuj="https://uci.cdn.office.net/mirrored/smartlookup/";Oh.kAo="https://hedwigtestserver.blob.core.windows.net/builds/";Oh.jAo="http://localhost:8080/";Oh.wad="current";Oh.suj="next";Oh.Qzn=2;Oh.Ghc=1;Oh.Hhc=CommonUIStrings.L_SmartLookupPaneTitle;
Oh.lC="InsightsTaskPane";Oh.xlg="InsightsTaskPaneData";Oh.oAf="InsightsContentFrame";Oh.width=400;Oh.wdn="ApplicationPropertiesRequest";Oh.Hdn="SelectionRequest";Oh.Cdn="PageRendered";Oh.vdn="ApplicationProperties";Oh.Gdn="Selection";Oh.Jdn="Telemetry";Oh.Idn="TakeFocus";Oh.Bdn="LostFocus";Oh.ydn="Keyboard";Oh.zdn="LegalAgreed";Oh.j8o="WordWac";Oh.Cwn="OneNoteWAC";Oh.a0f="yes";Oh.Kyj="appCorrelationId";Oh.RIo="clientCorrelationId";Oh.Lyj="message";Oh.cHi="Microsoft::Office::Insights::LegalAgreed";
Object(m.a)(Oh,"InsightsConstants",null,[]);var UF=c(1641);class VE{}Object(m.a)(VE,"ActivityContractInfo",null,[]);class Lt{}Object(m.a)(Lt,"BrowserPaneDataField",null,[]);class WE{}Object(m.a)(WE,"BrowserPaneTelemetryEvent",null,[]);class Xl{static Uz(b,h){const r=new WE;r.eventName="Diagnostics";r.isActivity=!1;r.activityContract=Object.assign(new VE,{success:!0});const B=[],P=new Lt;P.name="Message";P.dataType=0;P.value=b;b=new Lt;b.name="Level";b.dataType=0;b.value=Xl.getLevelString(h);Array.add(B,
P);Array.add(B,b);r.dataFields=B;Xl.sendTelemetryEvent(r)}static zjj(b,h){const r=new WE;r.eventName=b;r.isActivity=!1;r.activityContract=Object.assign(new VE,{success:!0});b=[];const B=new Lt;B.name="AppCorrelationId";B.dataType=0;B.value=h;Array.add(b,B);r.dataFields=b;Xl.sendTelemetryEvent(r)}static keo(b,h,r,B,P,ca){const ra=new WE;ra.eventName="LaunchPaneWithError";ra.isActivity=!1;ra.activityContract=Object.assign(new VE,{success:!0});const Qa=[],tb=new Lt;tb.name="IsNetworkConnected";tb.dataType=
0;tb.value=b?"true":"false";b=new Lt;b.name="IsHostruntimeAvailable";b.dataType=0;b.value=h?"true":"false";h=new Lt;h.name="EntryPoint";h.dataType=0;h.value=r;r=new Lt;r.name="RuntimeVersion";r.dataType=0;r.value=B;B=new Lt;B.name="IsFirstRelease";B.dataType=1;B.value=P?"true":"false";P=new Lt;P.name="IsZeroTerm";P.dataType=1;P.value=ca?"true":"false";ca=new Lt;ca.name="IsClientSideRendering";ca.dataType=1;ca.value="false";Array.add(Qa,tb);Array.add(Qa,h);Array.add(Qa,b);Array.add(Qa,r);Array.add(Qa,
B);Array.add(Qa,P);Array.add(Qa,ca);ra.dataFields=Qa;Xl.sendTelemetryEvent(ra)}static acg(b,h,r){const B=new WE;B.eventName="CDNDownloadLatency";B.isActivity=!0;B.activityContract=Object.assign(new VE,{duration:r,success:!0});r=[];const P=new Lt;P.name="CDNHostname";P.dataType=0;P.value=b;b=new Lt;b.name="Filename";b.dataType=0;b.value=h;Array.add(r,P);Array.add(r,b);B.dataFields=r;Xl.sendTelemetryEvent(B,1)}static Gkc(b,h,r,B,P,ca,ra,Qa){const tb=new WE;tb.eventName="LaunchPane";tb.isActivity=!0;
tb.activityContract=Object.assign(new VE,{duration:h,success:!0});h=[];const Mb=new Lt;Mb.name="AppCorrelationId";Mb.dataType=0;Mb.value=b;b=new Lt;b.name="EntryPoint";b.dataType=0;b.value=r;r=new Lt;r.name="IsServerSideRendering";r.dataType=1;r.value="true";const Zb=new Lt;Zb.name="UxVersion";Zb.dataType=0;Zb.value=B;B=new Lt;B.name="FeatureGates";B.dataType=0;B.value=P;P=new Lt;P.name="IsFirstRelease";P.dataType=1;P.value=ca?"true":"false";ca=new Lt;ca.name="IsZeroTerm";ca.dataType=1;ca.value=ra?
"true":"false";ra=new Lt;ra.name="IsClientSideRendering";ra.dataType=1;ra.value=Qa?"true":"false";Array.add(h,Mb);Array.add(h,b);Array.add(h,r);Array.add(h,Zb);Array.add(h,B);Array.add(h,P);Array.add(h,ca);Array.add(h,ra);tb.dataFields=h;Xl.sendTelemetryEvent(tb)}static sendTelemetryEvent(b,h=2){if(b.isFeedbackActivity)Xl.k5m(b.eventName);else{var r=-1<b.eventName.indexOf(Xl.Jyj)?b.eventName:Xl.Jyj+b.eventName,B=Xl.bVl(b.dataFields);b.isActivity?(b=Object.assign(new Uh.a,{name:r,samplingPolicy:h,
dataFields:B,succeeded:b.activityContract.success,durationMs:b.activityContract.duration}),ea.a.sendActivityEvent(b)):(b=Object.assign(new ka.a,{name:r,samplingPolicy:h,dataFields:B}),ea.a.sendTelemetryEvent(b))}}static getLevelString(b){switch(b){case 10:return"Error";case 15:return"Warning";default:return"Info"}}static bVl(b){const h=[];if(b&&0<b.length)for(const r of b)(b=xj.a.c9(r.name,r.value,Xl.N7k(r.dataType)))&&Array.add(h,b);return h}static N7k(b){switch(b){case 0:return 2;case 1:return 1;
case 2:return 3;case 3:return 4;default:return 0}}static k5m(b){const h=Ma.a.instance.Oa("Common.ISystemInitiatedFeedback");h?h.logActivity(b,null):t.ULS.sendTraceTag(540624772,1303,15,"Failed to resolve ISystemInitiatedFeedback.")}}Xl.Jyj="Office.Insights.SmartLookup.";Object(m.a)(Xl,"TelemetryUtils",null,[]);var XE;(function(b){b[b.other=0]="other";b[b.searchBoxSearch=1]="searchBoxSearch";b[b.searchBoxDictionary=2]="searchBoxDictionary";b[b.searchBoxQuickAnswer=3]="searchBoxQuickAnswer";b[b.smartLookupRibbon=
4]="smartLookupRibbon";b[b.smartLookupContextMenu=5]="smartLookupContextMenu";b[b.entity=6]="entity";b[b.dictionary=7]="dictionary";b[b.web=8]="web";b[b.pictures=9]="pictures";b[b.files=10]="files";b[b.bookmarks=11]="bookmarks";b[b.help=12]="help";b[b.chartRecommendation=13]="chartRecommendation";b[b.linkSkill=14]="linkSkill";b[b.searchBoxFindInDocument=15]="searchBoxFindInDocument";b[b.searchBoxEntity=16]="searchBoxEntity";b[b.searchSkill=17]="searchSkill";b[b.controlF=18]="controlF";b[b.ribbonFindButton=
19]="ribbonFindButton";b[b.reuseSlides=20]="reuseSlides";b[b.data=21]="data";b[b.contextMenuDictionary=22]="contextMenuDictionary";b[b.contextMenuSearchSuggestion=23]="contextMenuSearchSuggestion";b[b.contextMenuSynonyms=24]="contextMenuSynonyms";b[b.contextMenuSearchBoxSearch=25]="contextMenuSearchBoxSearch";b[b.searchBoxSearchZeroTerm=26]="searchBoxSearchZeroTerm";b[b.contextMenuSearchZeroTerm=27]="contextMenuSearchZeroTerm";b[b.note=28]="note";b[b.smartLookupAutoLaunch=29]="smartLookupAutoLaunch";
b[b.contextMenuSmartLookupInSubMenu=30]="contextMenuSmartLookupInSubMenu";b[b.dataDisambiguate=31]="dataDisambiguate";b[b.linkFiles=32]="linkFiles";b[b.searchBoxNoteL2=33]="searchBoxNoteL2";b[b.contextMenuLaunchL2Document=34]="contextMenuLaunchL2Document";b[b.actionAI=35]="actionAI";b[b.pasteAsNewSlide=36]="pasteAsNewSlide";b[b.slidesCompression=37]="slidesCompression";b[b.searchBoxGenerateDeck=38]="searchBoxGenerateDeck";b[b.powerPointCopilot=39]="powerPointCopilot";b[b.tellMeService=40]="tellMeService";
b[b.prefetch=99]="prefetch"})(XE||(XE={}));Object(m.b)("EntryPoint",XE);var Mt=c(1566),Gx=c(1581);class pv{static wY(b,h,r,B,P,ca){if(1===r)return kc.SessionStatusManager.instance.cD?32:8;if(P.value.Vuo())return Xl.Uz("Skipping Serplet launch",10),32;h=ca;if(!h)return 8;b=pv.FFb();if(r=h.CommandValueId)try{h=H.a(r)}catch(ra){return t.ULS.sendTraceTag(594044173,1313,15,"SmartLookup application interface [{0}] is not in proper format",r),8}r=h;h.selection||(h.neighborhood?r=Object.assign(new Mt.a,{selection:h}):
(h=P.value.nGb(),r.selection=Object.assign(new Gx.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength})));r.selection.clientDetectedLanguage=P.value.$ai();return pv.i8b(ca,null,r,b,0,P)}static i8b(b,h,r,B,P,ca){const ra={};ra.controlId=b?b.SourceControlId:"shortcut";r&&(ra.entryPoint=XE[r.entryPoint]);t.ULS.sendTraceTag(594044172,1303,50,pv.rU("Show insights",B,ra));h?ca.value.oxo(h,B,P):r&&(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCopilotAddin",
!1)?ca.value.Ivo(r,B):ca.value.pxo(r,B,P));return 32}static rU(b,h,r=null){b={["appCorrelationId"]:h,["message"]:b};if(r)for(let B in r)b[B]=r[B];return H.c(b)}static FFb(){return Bb.a.create().toString()}}Object(m.a)(pv,"InvokingPaneUtils",null,[]);class tL{}Object(m.a)(tL,"LaunchDataInDoc",null,[]);class uL{}Object(m.a)(uL,"LaunchDataPasteAsSlide",null,[]);class vL{}Object(m.a)(vL,"LaunchDataSlidesCompression",null,[]);var ju=c(1556);class NH{constructor(b,h,r,B,P,ca,ra,Qa,tb){this.uuc=this.pnd=
this.aw=null;this.vC=b;this.ga=h||v.AFrameworkApplication.va;this.lp=r;this.Vb=B;this.Q2g=Qa;this.Zzc=P;this.Ca=ca;this.Ib=ra;this.hBm();this.BXa=new pf.a(()=>new Im.a(tb.value,Object(z.a)(this,this.EGb,"getMoreInfoEventReceived")))}Tb(){this.ga.ra(fb.a.pFm,yd.a.frame,Object(z.a)(this,this.mxo,"showInsights"));this.ga.ra(fb.a.qFm,yd.a.frame,Object(z.a)(this,this.nxo,"showInsightsForTellMe"));this.ga.ra(fb.a.definitions,yd.a.frame,Object(z.a)(this,this.kwo,"showDefinitions"));this.ga.ra(fb.a.fef,yd.a.frame,
Object(z.a)(this,this.lwo,"showDefinitionsForTellMe"));this.ga.ra(fb.a.shg,yd.a.frame,Object(z.a)(this,this.shg,"showInsightsForSuggestion"));this.Q2g&&(this.ga.ra(fb.a.q9,yd.a.frame,Object(z.a)(this,this.wY,"invokeSmartLookupPane")),this.ga.ra(fb.a.KVc,yd.a.frame,Object(z.a)(this,this.KVc,"invokeInDocSerplet")),this.ga.ra(fb.a.MVc,yd.a.frame,Object(z.a)(this,this.MVc,"invokeSerpletRibbon")),this.ga.ra(fb.a.LVc,yd.a.frame,Object(z.a)(this,this.LVc,"invokeSerpletContextMenu")),this.ga.ra(fb.a.oDf,
yd.a.frame,Object(z.a)(this,this.oDf,"invokeSerpletTellMeZeroTerm")),this.ga.ra(fb.a.nDf,yd.a.frame,Object(z.a)(this,this.nDf,"invokeSerpletTellMeNotes")),this.ga.ra(fb.a.JYd,yd.a.frame,Object(z.a)(this,this.JYd,"invokeImageSerpletContextMenu")),this.ga.ra(fb.a.NYd,yd.a.frame,Object(z.a)(this,this.NYd,"invokeSynonymsSerpletContextMenu")),this.ga.ra(fb.a.IYd,yd.a.frame,Object(z.a)(this,this.IYd,"invokeDictionarySerpletContextMenu")),this.ga.ra(fb.a.PYd,yd.a.frame,Object(z.a)(this,this.PYd,"invokeZeroTermSerpletContextMenu")),
this.ga.ra(fb.a.HYd,yd.a.frame,Object(z.a)(this,this.HYd,"invokeDefinitionSearchFromFloatie")),this.ga.ra(fb.a.MYd,yd.a.frame,Object(z.a)(this,this.MYd,"invokeSerpletBrowseFiles")),this.ga.ra(fb.a.KYd,yd.a.frame,Object(z.a)(this,this.KYd,"invokeInDocSerpletWithLaunchData")),this.ga.ra(fb.a.ice,yd.a.frame,Object(z.a)(this,this.ice,"queryToggleSerplet")),this.ga.ra(fb.a.bhe,yd.a.frame,Object(z.a)(this,this.bhe,"setInDocSearchParameter")),this.ga.ra(fb.a.mDf,yd.a.frame,Object(z.a)(this,this.mDf,"invokeSerpletSlidesCompression")),
this.ga.ra(fb.a.lDf,yd.a.frame,Object(z.a)(this,this.lDf,"invokeSerpletPasteAsNewSlide")),v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletAutolaunch",!1)&&(this.ga.ra(fb.a.Yui,yd.a.frame,Object(z.a)(this,this.jHm,"invokeSmartLookupPaneConversations")),this.ga.ra(fb.a.FYd,yd.a.frame,Object(z.a)(this,this.FYd,"invokeAutoLaunchSearchRequest"))),this.FVn().continueWith(()=>{v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.updateCommandUI(!0)}))}Moh(){this.ga.fb(fb.a.uGa,
yd.a.frame,Object(z.a)(this,this.uGa,"invokeFilesSerplet"),4);this.ga.fb(fb.a.fDf,yd.a.frame,Object(z.a)(this,this.uGa,"invokeFilesSerplet"),4);this.ga.fb(fb.a.Sui,yd.a.frame,Object(z.a)(this,this.ZGm,"invokeLinkFilesSerplet"),4);if(this.Ca.$("IsTellMeUpSellEnterpriseEnabled")&&this.Ca.$("SmartLookupTokenPrefetchIsEnabled")){const b=Me.a.B8(0,Object(z.a)(this,this.A3i,"prefetchToken"),0,177);this.Ib.Wb(b)}}P_e(){Hh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddEmptyFilesActionWhenUnavailable")&&
(this.ga.ra(fb.a.uGa,yd.a.frame,Object(z.a)(this,this.gDf,"invokeFilesSerpletUnavailable")),this.ga.ra(fb.a.fDf,yd.a.frame,Object(z.a)(this,this.gDf,"invokeFilesSerpletUnavailable")),this.ga.ra(fb.a.Sui,yd.a.frame,Object(z.a)(this,this.gDf,"invokeFilesSerpletUnavailable")))}A3i(b){t.ULS.sendTraceTag(579352786,1303,50,"SmartLookupFiles: Token prefetch initiated, interval={0}, IsRetry={1}",b.interval,!!b.data);this.soc().then(h=>{let r=1;if(h)t.ULS.sendTraceTag(579352787,1303,50,"SmartLookupFiles: Token prefetch succeeded"),
this.tcg("SmartLookupFiles: Token prefetch succeeded",!0),h=6E4*this.Ca.mc("SmartLookupTokenRenewalWaitDurationInMinutes",30);else{t.ULS.sendTraceTag(579352788,1303,50,"SmartLookupFiles: Token prefetch failed");this.tcg("SmartLookupFiles: Token prefetch failed",!1);r=parseInt(b.data||"1");if(r>this.Ca.mc("SmartLookupTokenRenewalRetryThreshold",5)){t.ULS.sendTraceTag(577345097,1303,10,"SmartLookupFiles: Token prefetch max retry count reached");this.tcg("SmartLookupFiles: Token prefetch max retry count reached",
!1);return}h=6E4*this.Ca.mc("SmartLookupTokenRetryWaitDurationInMinutes",10);r++}h=new Me.a(3,1,h,Object(z.a)(this,this.A3i,"prefetchToken"),177);h.data=r.toString();this.Ib.Wb(h)})}tcg(b="",h=!1){this.Zzc.execute(r=>{r&&r.Ekc("PrefetchToken",h,0,"SmartLookup",b)})}soc(){return this.Zzc?new Promise(b=>{this.Zzc.execute(h=>{if(h){var r=Date.now();h.getToken("SmartLookup",this.Ca.kb("SmartLookupShredderServiceEndpoint")).then(B=>{b(!!B&&0<B.length);h.Ekc("TryGetTokenInternal",!!B&&0<B.length,Date.now()-
r,"SmartLookup")})}else b(!1)})}):Promise.resolve(!1)}FVn(){const b=new Hf.a;if(this.Ca.$("BrowserSupportsInsightsPaneSSO"))this.Moh(),b.Dg(!0);else{if(!this.Zzc)return t.ULS.sendTraceTag(587534883,1303,10,"_oAuthManagerFuture not initialized"),b.Dg(!1),this.P_e(),b.task;this.Zzc.execute(h=>{h?h.getToken("SmartLookup",this.Ca.kb("SmartLookupShredderServiceEndpoint")).then(r=>{t.ULS.sendTraceTag(587534913,1303,15,"Token:{0}",!!r&&0<r.length);r&&0<r.length?(this.Moh(),b.Dg(!0)):this.P_e()}):(t.ULS.sendTraceTag(587534912,
1303,10,"Unable to resolve oAuthManager"),b.Dg(!1),this.P_e())})}return b.task}mxo(b,h,r,B,P){if(1===r)return v.AFrameworkApplication.ua&&v.AFrameworkApplication.K.$("OneNoteDelayLoadContextActivationManager")&&!v.AFrameworkApplication.XJc?8:this.vC.value.rzi()?32:8;b=pv.FFb();h=this.vC.value.nGb();return this.Q2g?(h=Object.assign(new Gx.a,{neighborhood:h.neighborhood,mentionStart:h.mentionStart,mentionLength:h.mentionLength}),h=Object.assign(new Mt.a,{selection:h,userIntent:null,entryPoint:0,launchData:Object.assign(new ju.a,
{landingTab:"All"})}),pv.i8b(P,null,h,b,0,this.vC)):pv.i8b(P,h,null,b,0,this.vC)}kwo(b,h,r,B,P){if(1===r)return this.vC.value.rzi()?32:8;b=pv.FFb();h=this.vC.value.nGb();return pv.i8b(P,h,null,b,1,this.vC)}nxo(b,h,r,B,P){return 1===r?32:this.dZh(P,0)}lwo(b,h,r,B,P){return 1===r?32:this.dZh(P,1)}dZh(b,h){const r=pv.FFb(),B=b.CommandValueId;let P;try{P=H.a(B)}catch(ca){return t.ULS.sendTraceTag(6295941,1303,15,pv.rU(String.format("Insights parameters [{0}] is not in proper format.",B),r)),8}return pv.i8b(b,
P,null,r,h,this.vC)}shg(b,h,r,B,P){if(1===r)return 32;if(!P)return 8;b=P.query?P.query:"";h=pv.FFb();r=new UF.a;r.neighborhood=b;r.mentionStart=0;r.mentionLength=b.length;return pv.i8b(P,r,null,h,0,this.vC)}ZGm(b,h,r,B){if(1===r)return kc.SessionStatusManager.instance.cD?32:8;const P=v.AFrameworkApplication.K.$("InsertFileLinkSerpletIsEnabled"),ca=this.vC.value.I2a();return this.wY(b,h,r,B,Object.assign(new Mt.a,{selection:Object.assign(new Gx.a,{neighborhood:ca.neighborhood,mentionStart:0,mentionLength:0}),
launchData:Object.assign(new ju.a,{landingTab:"File"}),entryPoint:P?32:10}))}uGa(b,h,r,B){if(1===r)return kc.SessionStatusManager.instance.cD?32:8;const P=v.AFrameworkApplication.K.$("InvokeReuseSlidesSerpletIsEnabled"),ca=this.vC.value.I2a();return this.wY(b,h,r,B,Object.assign(new Mt.a,{selection:Object.assign(new Gx.a,{neighborhood:ca.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new ju.a,{landingTab:P?"Slide":"File"}),entryPoint:P?20:10}))}gDf(){return 2}KVc(b,h,r,B,P){if(1===
r)return kc.SessionStatusManager.instance.Zj?8:32;const ca=this.vC.value.I2a();P=void 0===P||null===P?18:19;return this.wY(b,h,r,B,Object.assign(new Mt.a,{selection:Object.assign(new Gx.a,{neighborhood:ca.neighborhood,mentionStart:ca.mentionStart,mentionLength:ca.mentionLength}),launchData:Object.assign(new ju.a,{landingTab:"Indoc"}),entryPoint:P}))}KYd(b,h,r,B,P){P=P.CommandValueId;if(!P||P&&this.uuc&&P.query===this.uuc.query&&P.matchCase===this.uuc.matchCase&&P.matchWholeWordOnly===this.uuc.matchWholeWordOnly)return 32;
const ca=this.vC.value.I2a();return this.wY(b,h,r,B,Object.assign(new Mt.a,{selection:Object.assign(new Gx.a,{neighborhood:ca.neighborhood,mentionStart:ca.mentionStart,mentionLength:ca.mentionLength}),launchData:Object.assign(new ju.a,{landingTab:"Indoc",data:Object.assign(new tL,{type:4,query:P.query,matchCase:P.matchCase,matchWholeWord:P.matchWholeWordOnly})}),entryPoint:18}))}ice(b,h,r,B,P){P&&(P[qg.a.On]=this.vC.value.FJb);return 32}bhe(b,h,r,B,P){if(b=P.CommandValueId)this.uuc=b;return 32}jHm(b,
h,r){if(1===r)return kc.SessionStatusManager.instance.cD?32:8;b=this.vC.value.I2a();b=Object.assign(new Mt.a,{selection:Object.assign(new Gx.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new ju.a,{landingTab:"All"})});this.vC.value.p2d(b);return 32}FYd(b,h,r){if(1===r)return kc.SessionStatusManager.instance.cD?32:8;b=this.vC.value.I2a();b=Object.assign(new Mt.a,{selection:Object.assign(new Gx.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,
mentionLength:0}),entryPoint:29,launchData:Object.assign(new ju.a,{landingTab:"All",data:v.AFrameworkApplication.jEb})});h=pv.FFb();this.vC.value.$Pb(b,h);return 32}MVc(b,h,r,B){if(1===r)return kc.SessionStatusManager.instance.cD?32:8;const P=this.vC.value.bbi();return this.wY(b,h,r,B,Object.assign(new Mt.a,{selection:Object.assign(new Gx.a,{neighborhood:P.neighborhood,mentionStart:P.mentionStart,mentionLength:P.mentionLength}),entryPoint:4,launchData:Object.assign(new ju.a,{landingTab:"All"})}))}LVc(b,
h,r,B){return this.wY(b,h,r,B,Object.assign(new Mt.a,{entryPoint:5,launchData:Object.assign(new ju.a,{landingTab:"All"})}))}oDf(b,h,r,B){if(1===r)return kc.SessionStatusManager.instance.cD?32:8;const P=this.vC.value.I2a();return this.wY(b,h,r,B,Object.assign(new Mt.a,{selection:Object.assign(new Gx.a,{neighborhood:P.neighborhood,mentionStart:P.mentionStart,mentionLength:0}),launchData:Object.assign(new ju.a,{landingTab:"All"}),entryPoint:26}))}IYd(b,h,r,B){return 1===r?(b=this.vC.value.nGb())&&0<
b.mentionLength?32:8:this.wY(b,h,r,B,Object.assign(new Mt.a,{entryPoint:22,launchData:Object.assign(new ju.a,{landingTab:"All"})}))}HYd(b,h,r,B){return 1===r?(b=this.vC.value.nGb())&&0<b.mentionLength?32:8:this.wY(b,h,r,B,Object.assign(new Mt.a,{entryPoint:7,launchData:Object.assign(new ju.a,{landingTab:"All"})}))}JYd(b,h,r,B){return this.wY(b,h,r,B,Object.assign(new Mt.a,{launchData:Object.assign(new ju.a,{landingTab:"Image"}),entryPoint:9}))}NYd(b,h,r,B){return this.wY(b,h,r,B,Object.assign(new Mt.a,
{launchData:Object.assign(new ju.a,{landingTab:"All"}),entryPoint:24}))}nDf(b,h,r,B){return this.wY(b,h,r,B,Object.assign(new Mt.a,{launchData:Object.assign(new ju.a,{landingTab:"Notes"}),entryPoint:33}))}PYd(b,h,r,B){if(1===r)return kc.SessionStatusManager.instance.cD?32:8;const P=this.vC.value.I2a();return this.wY(b,h,r,B,Object.assign(new Mt.a,{selection:Object.assign(new Gx.a,{neighborhood:P.neighborhood,mentionStart:P.mentionStart,mentionLength:0}),launchData:Object.assign(new ju.a,{landingTab:"All"}),
entryPoint:27}))}mDf(b,h,r,B,P){if(!P)return 8;const ca=P.url;P=P.selectedSlideIDs;return this.wY(b,h,r,B,Object.assign(new Mt.a,{launchData:Object.assign(new ju.a,{landingTab:"All",data:Object.assign(new vL,{type:6,url:ca,selectedSlideIDs:P})}),entryPoint:37}))}lDf(b,h,r,B,P){if(!P)return 8;const ca=P.Selection;P=P.CurrentDocTitle;return this.wY(b,h,r,B,Object.assign(new Mt.a,{launchData:Object.assign(new ju.a,{landingTab:"All",data:Object.assign(new uL,{type:5,selection:ca,currentDocTitle:P})}),
entryPoint:36}))}wY(b,h,r,B,P){return pv.wY(b,h,r,B,this.vC,P)}MYd(b,h,r){if(1===r)return 32;this.aw||this.BXa.value.lP("Browse File from Search pane",!0);if(!this.pnd||""===this.pnd)return t.ULS.sendTraceTag(558409934,1303,10,"InsightsActor: Failed to get host url to browse files."),8;Qd.a.wm(this.pnd,"_blank",void 0,"BrowseFilesFromSearchPane");return 32}EGb(b){this.aw||3!==b.state||(this.aw=b,this.pnd=this.aw.Rda)}hBm(){const b=this.Vb.fe(Oh.lC);b.parent=Dd.AFrame.Ap;b.pga(Object(z.a)(this,this.Fkc,
"sendIFrameTakeFocusMessage"));this.lp.JT(Oh.lC)}Fkc(){document.activeElement.blur();v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.Dlb||(this.vC.value.Tio(),this.vC.value.ieo())}dispose(){this.vC.value&&this.vC.value.dispose()}}Object(m.a)(NH,"InsightsActor",null,[9]);const OH=b=>{b=b.split("-");return b[b.length-1]},mN=()=>{var b=SG();if(b)return Promise.resolve(b);b=VF().replace("SearchWeb","searchweb");b=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",
!1)?b+Oh.suj+"/":b+Oh.wad+"/";b+="version.json";if(Z.a.zpa)return lN(b);try{const h=new Sys.Net.WebRequest;h.set_httpVerb("GET");h.set_url(b);b={};b.method=h.get_httpVerb();return"function"!==typeof window.fetch?(Xl.Uz("InsightsUtils - Failed to download version.json because fetch API is unavailable.",10),Promise.resolve("")):window.fetch(h.getResolvedUrl(),b).then(r=>r.json()).catch(()=>{Xl.Uz("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(r=>{r=H.b(JSON.stringify(r));
return r.version?r.version:""},r=>{Xl.Uz("InsightsUtils - Failed to deserialize version: "+r.toString(),10);t.ULS.sendTraceTag(591971029,1303,15,"Insights: Failed to deserialize version: "+r.toString());return""}).then(r=>r)}catch(h){return Xl.Uz("InsightsUtils - Failed to download version.json: "+h.toString(),10),t.ULS.sendTraceTag(591984149,1303,50,"Insights: Call to Version JSON failed + "+h.toString()),Promise.resolve("")}},lN=b=>{const h=v.AFrameworkApplication.He;return new Promise(r=>{const B=
new SF.a(b,1,null,null,!0,2,null);h.send(B).fza(P=>{P&&P.data?P.data.se||(Xl.Uz("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+P.data.Se,10),r("")):(Xl.Uz("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",10),r(""));try{const ca=H.b(P.data.se);ca.version&&r(ca.version)}catch(ca){Xl.Uz("InsightsUtils - Failed to deserialize version: "+ca.toString(),10),r("")}},P=>{P&&P.data?Xl.Uz("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+
P.data.Se,10):Xl.Uz("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",10);r("")})})},TG=()=>v.AFrameworkApplication.K.$("SmartLookupEnableLocalOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableLocalOverride",!1),UG=()=>{const b=VF();return TG()||v.AFrameworkApplication.K.kb("SmartLookupPRClientVersion")?b+SG()+"/":v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",
!1)?b+Oh.suj:b+Oh.wad},SG=()=>TG()?"dev":v.AFrameworkApplication.K.kb("SmartLookupPRClientVersion")?v.AFrameworkApplication.K.kb("SmartLookupPRClientVersion").split("/")[1]:v.AFrameworkApplication.K.kb("SmartLookupClientVersion"),PH=b=>{var h=3===v.AFrameworkApplication.ua.Kb.yk?"wordwac":2===v.AFrameworkApplication.ua.Kb.yk?"pptwac":"excelwac";var r=lj.a.tg(v.AFrameworkApplication.lcid);const B=r?r.name:"en-us";r=VF();const P=kD();h="main_ssr_wac.html?appName="+h+"&culture="+B;return"LOCAL"===P?
r+h:r+((""!==b?b:Oh.wad)+"/")+h},nN=b=>VF()+(""!==b?b:Oh.wad)+"/scripts/microsoft.office.smartlookup.host.runtime.js",VF=()=>{switch(kD()){case "LOCAL":return Oh.jAo;case "PR":const b=v.AFrameworkApplication.K.kb("SmartLookupPRClientVersion").split("/");return Oh.kAo+b[0]+"/";case "INT":return Oh.lAo;case "EDOG":return Oh.tuj;default:return Oh.uuj}},oN=()=>{if(!v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletCDNLatencyActivityEnabled",!1))return"";switch(kD()){case "EDOG":return Oh.tuj;
case "PROD":return Oh.uuj;default:return""}},kD=()=>{if(v.AFrameworkApplication.K.$("SmartLookupEnableEdogSourceLocationOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableEdogSourceLocationOverride",!1))return"EDOG";if(v.AFrameworkApplication.K.$("SmartLookupEnableProdSourceLocationOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableProdSourceLocationOverride",!1))return"PROD";if(v.AFrameworkApplication.K.$("SmartLookupEnableIntSourceLocationOverride")||
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableIntSourceLocationOverride",!1))return"INT";if(v.AFrameworkApplication.K.kb("SmartLookupPRClientVersion")&&v.AFrameworkApplication.K.kb("SmartLookupPRIntentSvc"))return"PR";if(TG())return"LOCAL";switch(Object(Ra.a)(String,v.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||""){case "Dogfood":if(v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupSKITeamDogfood",
!1)){let b=v.AFrameworkApplication.K.kb("UserPrincipalName");b=F.a.eh(b);const h=v.AFrameworkApplication.K.rw("SmartLookupINTEnabledForSKITeam")?v.AFrameworkApplication.K.DB("SmartLookupINTEnabledForSKITeam"):[];if(0<=Array.indexOf(h,b))return"INT"}return"EDOG";case "Microsoft":return"EDOG";default:return"PROD"}},wL=()=>{let b;b=v.AFrameworkApplication.K.$("IntentSvcEnableEdogSourceLocationOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableEdogSourceLocationOverride",
!1)?"EDOG":v.AFrameworkApplication.K.$("IntentSvcEnableProdSourceLocationOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableProdSourceLocationOverride",!1)?"PROD":v.AFrameworkApplication.K.$("IntentSvcEnableIntSourceLocationOverride")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableIntSourceLocationOverride",!1)?"INT":kD();const h=v.AFrameworkApplication.K.kb("IntentServiceEndpoint"),r=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcNewEndpointEnabled",
!1);if("PROD"===b&&""!==h)return h+"searchendpointv2/";switch(b){case "LOCAL":return"wss://127.0.0.1:9000/officeaugmentation/searchendpointv2/";case "PR":return v.AFrameworkApplication.K.kb("SmartLookupPRIntentSvc")+"searchendpointv2/";case "INT":return(r?"wss://entity.osi.office-int.net/officeaugmentation/":"wss://augmentation.osi.office-int.net/officeaugmentation/")+"searchendpointv2/";case "EDOG":return(r?"wss://entity.osi.officeppe.net/officeaugmentation/":"wss://augmentation.osi.officeppe.net/officeaugmentation/")+
"searchendpointv2/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpointv2/"}},pN=()=>{const b=kD(),h=v.AFrameworkApplication.K.kb("IntentServiceEndpoint");switch(b){case "LOCAL":case "INT":case "EDOG":return"https://shredder-test.osi.office.net/shredderservice/api/refreshmemory";default:return"PROD"===b&&""!==h?"https://shredder-eu.osi.office.net/shredderservice/api/refreshmemory":"https://shredder.osi.office.net/shredderservice/api/refreshmemory"}};class xL{sendTelemetryEvent(b){Xl.sendTelemetryEvent(b)}}
Object(m.a)(xL,"OtelTelemetrySink",null,[312]);class yL{}Object(m.a)(yL,"ApplicationProperties",null,[]);class zL{constructor(){this.createdDate=this.author=this.filePath=this.docName=null}}Object(m.a)(zL,"CurrentDocumentProperties",null,[]);class AL{}Object(m.a)(AL,"EnterpriseUserInfo",null,[]);class BL{}Object(m.a)(BL,"FeatureGates",null,[]);class QH{constructor(b,h){this.qv=this.Mi=null;this.Vea="Search";this.MMi=!0;this.nAb=h;this.Zu=b;this.Zu.execute(r=>{r.isFeatureEnabled("mso_sendASmile",!0).then(B=>
{this.MMi=B}).catch(B=>{Xl.Uz("SearchHelper - Failed to check if Feedback feature is enabled: "+B.toString(),15)})});b=wL();h=v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1);if(v.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")){this.qv={};const r=this.fem();if(r&&0<r.length)for(let B=0;B<r.length;B++){const P=r[B],ca=this.sem(P);switch(ca.toLowerCase()){case "true":this.qv[P]=
!0;break;case "false":this.qv[P]=!1;break;default:this.qv[P]=ca}}this.qv.EnableInDocumentSearch=h;this.qv.EnableInDocumentSearchReplace=!0;this.qv.EnableInDocumentParamLocalSearch=!0;this.qv.EnableInDocumentQuerySuggest=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1);this.qv.EnableInDocumentQuestionGeneration=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1);this.qv.EnableInDocumentExperiment1=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1);this.qv.EnableInDocumentExperiment2=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",
!1);this.qv.EnableInDocumentExperiment3=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1);this.qv.EnableZeroTermAutoRefresh=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1);this.qv.EnableTap3SZeroTerm=v.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1);this.qv.EnableLocalSearch=!0;this.qv.EnableInDocumentStickyFilters=!0;this.qv.IntentServiceEndpoint=b;this.qv.EnablePDFShredding=v.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1);this.qv.FilterNonPPTFilesForReuseSlides=v.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides");this.qv.UXBundleVersion=SG();this.qv.SmartLookupServicePath=UG();this.qv.EnableAcronymSearch=
!0;this.qv.UseAltAnswerEndpoint1=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1);this.qv.UseAltAnswerEndpoint2=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1);this.qv.UseAltAnswerEndpoint3=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1);this.qv.UseNextUXVersion=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1);this.qv.IgnoreNeighborhoodContext=v.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled");this.qv.ShowDebugInfo="INT"===kD();this.qv.DebugCommands=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
"");this.qv.ChangeGates=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames","");this.qv.QnaInMixSection=!0;this.qv.EnableNoteSearch=v.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1);this.qv.EnableWikiL2=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1);this.qv.EnableFilteringOutRedundantKPE=
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1);this.qv.EnableZeroTermEntitySuggestion=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1);this.qv.RankingModels=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels","");this.qv.EnableClientSideRendering=!0}else this.Mi=new BL,this.Mi.EnableInDocumentSearch=h,this.Mi.EnableInDocumentSearchReplace=
!0,this.Mi.EnableInDocumentParamLocalSearch=!0,this.Mi.EnableInDocumentQuerySuggest=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1),this.Mi.EnableInDocumentQuestionGeneration=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",
!1),this.Mi.EnableInDocumentExperiment1=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1),this.Mi.EnableInDocumentExperiment2=h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1),this.Mi.EnableInDocumentExperiment3=
h&&v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1),this.Mi.EnableZeroTermAutoRefresh=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1),this.Mi.EnableTap3SZeroTerm=v.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1),this.Mi.EnableLocalSearch=!0,this.Mi.EnableInDocumentStickyFilters=!0,this.Mi.IntentServiceEndpoint=b,this.Mi.EnablePDFShredding=v.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1),this.Mi.FilterNonPPTFilesForReuseSlides=v.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides"),this.Mi.UXBundleVersion=SG(),this.Mi.SmartLookupServicePath=UG(),this.Mi.EnableAcronymSearch=
!0,this.Mi.UseAltAnswerEndpoint1=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1),this.Mi.UseAltAnswerEndpoint2=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1),this.Mi.UseAltAnswerEndpoint3=v.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1),this.Mi.UseNextUXVersion=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1),this.Mi.IgnoreNeighborhoodContext=v.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled"),this.Mi.ShowDebugInfo="INT"===kD(),this.Mi.DebugCommands=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
""),this.Mi.ChangeGates=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",""),this.Mi.QnaInMixSection=!0,this.Mi.EnableNoteSearch=v.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1),this.Mi.EnableWikiL2=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1),this.Mi.EnableFilteringOutRedundantKPE=
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1),this.Mi.EnableZeroTermEntitySuggestion=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1),this.Mi.RankingModels=v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",""),this.Mi.EnableClientSideRendering=!0,this.Mi.SharedSerpletFeatureGate1=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate1",
!1),this.Mi.SharedSerpletFeatureGate2=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate2",!1),this.Mi.SharedSerpletFeatureGate3=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate3",!1),this.Mi.SharedSerpletFeatureGate4=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate4",!1),this.Mi.SharedSerpletFeatureGate5=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate5",
!1),this.Mi.SharedSerpletFeatureGate6=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate6",!1),this.Mi.SharedSerpletFeatureGate7=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate7",!1),this.Mi.SharedSerpletFeatureGate8=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate8",!1),this.Mi.SharedSerpletFeatureGate9=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate9",
!1),this.Mi.SharedSerpletFeatureGate10=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1),this.Mi.SharedSerpletFeatureGate11=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate11",!1),this.Mi.SharedSerpletFeatureGate12=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate12",!1),this.Mi.SharedSerpletFeatureGate13=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate13",
!1),this.Mi.SharedSerpletFeatureGate14=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate14",!1),this.Mi.SharedSerpletFeatureGate15=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate15",!1),this.Mi.SharedSerpletFeatureGate16=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate16",!1),this.Mi.SharedSerpletFeatureGate17=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate17",
!1),this.Mi.SharedSerpletFeatureGate18=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate18",!1),this.Mi.SharedSerpletFeatureGate19=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate19",!1),this.Mi.SharedSerpletFeatureGate20=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate20",!1),this.Mi.SharedSerpletFeatureGate21=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate21",
!1),this.Mi.SharedSerpletFeatureGate22=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate22",!1),this.Mi.SharedSerpletFeatureGate23=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate23",!1),this.Mi.SharedSerpletFeatureGate24=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate24",!1),this.Mi.SharedSerpletFeatureGate25=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate25",
!1),this.Mi.SharedSerpletFeatureGate26=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate26",!1),this.Mi.SharedSerpletFeatureGate27=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate27",!1),this.Mi.SharedSerpletFeatureGate28=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate28",!1),this.Mi.SharedSerpletFeatureGate29=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate29",
!1),this.Mi.SharedSerpletFeatureGate30=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate30",!1),this.Mi.SharedSerpletFeatureGate31=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate31",!1),this.Mi.SharedSerpletFeatureGate32=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1),this.Mi.SharedSerpletFeatureGate33=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate33",
!1),this.Mi.SharedSerpletFeatureGate34=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate34",!1),this.Mi.SharedSerpletFeatureGate35=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate35",!1),this.Mi.SharedSerpletFeatureGate36=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate36",!1),this.Mi.SharedSerpletFeatureGate37=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate37",
!1),this.Mi.SharedSerpletFeatureGate38=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate38",!1),this.Mi.SharedSerpletFeatureGate39=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate39",!1),this.Mi.SharedSerpletFeatureGate40=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate40",!1);this.azc=Ma.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager");
this.Imb=QH.isEnterpriseUser();this.mSa=v.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint");this.FOf=ia.a.aY(v.AFrameworkApplication.K.kb("AppCatalogUrl")||"");this.H9m=v.AFrameworkApplication.K.kb("UserPrincipalName");this.Imb&&this.xhi()}sem(b){return v.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline."+b,"")}fem(){const b=v.AFrameworkApplication.K.X1a,h=v.AFrameworkApplication.K.DB("SmartLookupFlightKeywordList"),r=[];if(b&&h&&0<h.length)for(let P in b){var B=
{key:P,value:b[P]};B=B&&B.key?B.key:"";for(let ca=0;ca<h.length;ca++)if(-1<B.toLowerCase().indexOf(h[ca].toLowerCase())){const ra=B.split(".");ra&&4===ra.length&&Array.add(r,ra[ra.length-1])}}return r}Juf(b,h,r,B){return new Promise(P=>{this.cVm().then(ca=>{const ra=new yL;ra.anid="";ra.applicationName=3===v.AFrameworkApplication.ua.Kb.yk?"WORD":"POWERPNT";ra.applicationVersion=v.AFrameworkApplication.buildVersion;ra.appCorrelationId=b?b:pv.FFb();ra.themePlatform="web";ra.lcid=v.AFrameworkApplication.lcid;
ra.launchUtcTime=(new Date).toUTCString();v.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?ra.featureGates=H.c(this.qv):ra.featureGates=H.c(this.Mi);var Qa=lj.a.tg(v.AFrameworkApplication.lcid);Qa=Qa?Qa.name:null;ra.market=OH(Qa);ra.uiLanguage=Qa;ra.sessionId=v.AFrameworkApplication.userSessionId;ra.themeId=r;ra.parentalControl="yes";ra.processorOnlyMode=ca;ra.isEditingAllowed=h.isEditingAllowed();ra.isFeedbackEnabled=this.MMi;ra.isClientSideRendering=18===B||19===B||15===B;ra.disableClipboard=
v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletRestrictCopyWithIRMEnabled",!1)&&v.AFrameworkApplication.EF&&!v.AFrameworkApplication.uEb;ra.accessToken=this.Imb?this.xhi():"";ca=new AL;ca.CountryCode=OH(Qa);ca.ServiceEndpoint=this.mSa;ca.IsGoLocal=v.AFrameworkApplication.K.$("IsGoLocalEnvironment");ca.IsEnabled=this.Imb;ca.IsEnterpriseEnabled=this.Imb;ca.TenantRoot=this.FOf;ca.Upn=this.H9m;Qa=kD();ca.IsEUDB="PROD"===Qa&&""!==v.AFrameworkApplication.K.kb("IntentServiceEndpoint");
ra.enterpriseUserInfo=ca;ca=new zL;ca.filePath=v.AFrameworkApplication.K.kb("EditDocInClientUrl");ca.docName=v.AFrameworkApplication.K.kb("FileName");ca.author=99!==B?h.author():null;ca.createdDate=99!==B?h.createdDate():null;ra.currentDocument=ca;P(ra)})})}cVm(){return new Promise(b=>{this.Zu?this.Zu.execute(h=>{h.isFeatureEnabled(Oh.mAo,!0).then(r=>{b(!r)}).catch(r=>{Xl.Uz("SearchHelper - Failed to load the SmartLookup state from application feature helper: "+r.toString(),10);b(!0)})}):b(!0)})}zCn(b){this.azc&&
this.Imb&&this.$Ud(this.mSa).then(h=>{b(h)})}xhi(){return"Dev Box"===v.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?window.SearchPaneShredderTokenOverride:this.azc?this.azc.mim(this.Vea,this.mSa):""}$Ud(b){return"Dev Box"===v.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride?new Promise(h=>
{h(window.SearchPaneShredderTokenOverride)}):this.azc?this.azc.getToken(this.Vea,b):Promise.resolve("")}URc(){return this.nAb?this.nAb.getVersion():""}NXl(){return v.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?H.c(this.qv):H.c(this.Mi)}static isEnterpriseUser(){const b=v.AFrameworkApplication.K.kb("SovereignEnvironmentName"),h=v.AFrameworkApplication.K.$("IsTellMeUpSellEnterpriseEnabled");return(!b||!b.length)&&h}}Object(m.a)(QH,"SearchHelper",null,[303]);class iE{constructor(){iE._instance=
""}getVersion(){return iE._instance}ppo(b){iE._instance=b}}iE._instance=null;Object(m.a)(iE,"SmartLookupVersion",null,[]);class CL{}Object(m.a)(CL,"ConfigurationProvider",null,[]);class YE{constructor(b){YE._instance=b}urf(){return YE._instance}}YE._instance=null;Object(m.a)(YE,"SearchHostRuntime",null,[]);class RH{constructor(){this.wfa=this.uUb=this.W=null}get name(){return"Common.App.Insights"}wc(b){this.W=b;const h=Db.a.Gp(Ma.a.instance.Ta("Common.IEventEmitter<Common.IGetMoreInfoResult>")),r=
v.AFrameworkApplication.K.$("SmartLookupEnableNativePane")||v.AFrameworkApplication.K.$("SmartLookupIsEnabled");b.register(NH,"Common.App.Insights.InsightsActor").ha().Ud(()=>new NH(b.Ve("Common.App.Insights.IInsightsManager"),v.AFrameworkApplication.va,Rp.a.instance,pc.FocusManager.instance(),b.Ta("Common.App.SearchCommon.ISearchOAuthManager"),v.AFrameworkApplication.K,Wg.a.instance,r,new pf.a(()=>h.result)));b.register(302,"Common.App.Insights.IDocumentContentExtractionManager").ha().Ud(()=>new sL(b));
r&&(b.register(iE,"Common.App.Insights.SmartLookupVersion").ha().Ud(()=>new iE),b.register(303,"Common.App.SearchCommon.ISearchHelper").ha().Ud(()=>new QH(Ma.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),b.Oa("Common.App.Insights.SmartLookupVersion"))))}init(){v.AFrameworkApplication.E0&&(this.uUb=this.W.Oa("Common.App.Insights.InsightsActor"),this.uUb.Tb())}qUn(){if(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RecallRefreshMemory",
!1)){var b=v.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint");this.W.resolve("Common.App.SearchCommon.ISearchHelper").$Ud(b).then(h=>{var r={};r.Authorization="Bearer "+h;h=pN();const B=v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableRC3RefreshMemoryTelemetry",!0);r=new SF.a(h+("?isTelemetryOnly="+B),1,null,r,!0,2,null);v.AFrameworkApplication.He.send(r).fza(()=>{Xl.Uz("InsightsPackage - Refresh Memory API request sent and was successful. isTelemetryOnly="+
B,50)},P=>{Xl.Uz("InsightsPackage - Failed to send refreshmemory API request. Error: "+P.toString(),10)})})}}Vsl(){this.WFm();this.qUn()}WFm(){mN().then(b=>{if(""!==b){const h=this.W.Oa("Common.App.Insights.SmartLookupVersion");h&&h.ppo(b)}this.cMd();this.uUb=this.W.resolve("Common.App.Insights.InsightsActor");b=nN(b);b=Fb.a.create(b);b.D_((h,r)=>{r.succeeded?this.nqo()&&this.prefetchZeroTerm():Xl.Uz("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+r.IF,10);this.uUb.Tb()});
Ya.a.PX(b)})}nqo(){const b=Object.assign(new CL,{channelId:Oh.channelId,approvedOriginPattern:TG()?"^(http)?://(localhost:8080)$":v.AFrameworkApplication.K.kb("SmartLookupApprovedOriginPattern")});var h=this.W.resolve("Common.App.SearchCommon.IDocumentContentExecutor");const r=this.W.resolve("Common.App.SearchCommon.ISerpletExecutor"),B=this.W.resolve("Common.App.SearchCommon.IInsertContentExecutor"),P=new mb.a;h&&P.add(h);r&&P.add(r);B&&P.add(B);h=wL();try{const ca=new xL,ra=SmartLookupHostRuntime.setup(b,
P.toArray(),!0,h,ca);this.W.register(YE,"Common.App.SearchCommon.SearchHostRuntime").ha().Ud(()=>new YE(ra));return!0}catch(ca){return Xl.Uz("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+ca,10),!1}}prefetchZeroTerm(){if(v.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)){var b=Ma.a.instance.Oa("Common.App.SearchCommon.SearchHostRuntime");
if(b){const h=this.W.resolve("Common.App.SearchCommon.ISearchHelper"),r=this.W.resolve("Common.App.SearchCommon.IDocumentHelper");h.Juf(null,r,0,99).then(B=>{b.urf().prefetchZeroTerm(B,v.AFrameworkApplication.userSessionId,UG(),!0,"Indoc",null)})}else Xl.Uz("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",15)}}cMd(){var b=this.W.resolve("Common.App.SearchCommon.ISearchHelper");const h=PH(b.URc());b=b.URc();b=VF()+(""!==b?b:Oh.wad)+"/scripts/microsoft.office.smartlookup.ssr.js";
const r=oN();Z.a.zpa?this.Usl(h,b):(this.Ssl(h,r),this.Tsl(b,r))}Ssl(b,h){const r=new Sys.Net.WebRequest;r.set_httpVerb("GET");const B={};B.method=r.get_httpVerb();r.set_url(b);const P=(new Date).getTime();try{window.fetch(r.getResolvedUrl(),B).then(()=>{""!==h&&Xl.acg(h,b,(new Date).getTime()-P);this.W.Oa("Common.App.Insights.SmartLookupVersion")})}catch(ca){Xl.Uz("InsightsPackage - Failed to prefetch Html file because of HttpException. Error: "+ca.toString(),10)}}Tsl(b,h){var r=new Sys.Net.WebRequest;
r.set_httpVerb("GET");const B={};B.method=r.get_httpVerb();r.set_url(b);let P=-1;if(v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletPrefetchJSOnIdle",!1))r=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletPrefetchDelayInMs",3E5),Wg.a.instance.Wb(new Me.a(5,1,r,()=>{const ca=Fb.a.create(b);ca.e0e(()=>{P=Date.now()});ca.D_((ra,Qa)=>{Qa.succeeded?""!==h&&Xl.acg(h,b,Date.now()-P):Xl.Uz("InsightsPackage - Failed to prefetch JS file.",
10)});Ya.a.PX(ca)}));else{P=Date.now();try{window.fetch(r.getResolvedUrl(),B).then(()=>{""!==h&&Xl.acg(h,b,Date.now()-P)})}catch(ca){Xl.Uz("InsightsPackage - Failed to prefetch JS file because of HttpException. Error: "+ca.toString(),10)}}}Usl(b,h){if(Z.a.zpa){var r=v.AFrameworkApplication.He;b=new SF.a(b,1,null,null,!0,2,null);r.send(b).fza(B=>{B&&B.data?B.data.se?this.W.Oa("Common.App.Insights.SmartLookupVersion"):Xl.Uz("InsightsPackage - Request for Html with ClientRequestManager returned empty ResponseData. StatusCode: "+
B.data.Se,10):Xl.Uz("InsightsPackage - Request for Html with ClientRequestManager returned no Data.",10)},B=>{B&&B.data?Xl.Uz("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. StatusCode: "+B.data.Se,10):Xl.Uz("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. Unknown HTTP Failure.",10)});v.AFrameworkApplication.K.$("SmartLookupPrefetchJSIsEnabled")&&(h=new SF.a(h,1,null,null,!0,2,null),r.send(h).fza(B=>{B&&B.data?B.data.se||Xl.Uz("InsightsPackage - Request for SSR JS with ClientRequestManager returned empty ResponseData. StatusCode: "+
B.data.Se,10):Xl.Uz("InsightsPackage - Request for SSR JS with ClientRequestManager returned no Data.",10)},B=>{B&&B.data?Xl.Uz("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. StatusCode: "+B.data.Se,10):Xl.Uz("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. Unknown HTTP Failure.",10)}))}}dispose(){this.uUb&&this.uUb.dispose()}}Object(m.a)(RH,"InsightsPackage",null,[1,2]);var DL=c(1624);class EL{constructor(){this.documentContentTableName=this.dataCenterEndpoint=
this.documentContentKey=null}}Object(m.a)(EL,"DocumentContentParams",null,[]);var VG=c(1892),FL=c(405),ZE=c(734),ku;(function(b){b.fWa="SearchProvider";b.Z9a="TextSummarization"})(ku||(ku={}));Object(m.b)("WorkflowType",ku);var Mw;(function(b){b.Success="Success";b.pug="Invoked";b.Error="Error"})(Mw||(Mw={}));Object(m.b)("LogType",Mw);var Dy;(function(b){b.YMj="AugloopLateResponse";b.BlockedByPrefilter="BlockedByPrefilter";b.BlockedByQualityCheck="BlockedByQualityCheck";b.BlockedByClassifier="BlockedByClassifier";
b.oug="InvalidAnnotation";b.cSj="StaleAnnotation";b.Timeout="Timeout";b.Other="Other"})(Dy||(Dy={}));Object(m.b)("ErrorReason",Dy);class WF{constructor(b){this.AUh=b;this.tWf=this.tWf.bind(this);this.Wnb=this.Wnb.bind(this);this.GJo=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TextSummarizationRequestTimeout",5E3)}async submitDocumentContentExtractionSignal(){try{this.fco=Date.now();this.Cpb=Bb.a.create().toString();this.log({mK:ku.fWa,logType:Mw.pug,success:!0,correlationId:this.Cpb});
var b=kD().toLowerCase();b="int"===b||"local"===b;await this.activateAnnotation();const h=new wr.l({parentPath:["Signal",VG.SearchProviderSignal.getTypeName()],items:[{id:"SearchProvider",body:new VG.SearchProviderSignal({correlationId:this.Cpb,shouldUseIntEndpoint:b})}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:h});this.lij=window.setTimeout(()=>{this.onError(ku.fWa,Mw.Error,Dy.Timeout)},1500)}catch(h){window.clearTimeout(this.lij),this.onError(ku.fWa,Mw.Error,
Dy.Other,this.C9h(h))}}async generateDocumentSummaryDetails(){try{if(!WF.xYc)return null;this.FJo=Date.now();this.log({mK:ku.Z9a,logType:Mw.pug,success:!0});await this.activateAnnotation();const b=new wr.l({parentPath:["Signal",ZE.GenerateTextSummarySignal.getTypeName()],items:[{id:"TextSummarization",body:new ZE.GenerateTextSummarySignal}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:b});this.gzj=window.setTimeout(()=>{this.onError(ku.Z9a,Mw.Error,Dy.Timeout)},
this.GJo);return new Promise(h=>{this.Mmc=h})}catch(b){window.clearTimeout(this.gzj),this.onError(ku.Z9a,Mw.Error,Dy.Other,this.C9h(b))}}async generateDocumentSummary(){var b;return null===(b=await this.generateDocumentSummaryDetails())||void 0===b?void 0:b.summary}static get xYc(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableDocumentSummarization",!1)}static get gVm(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableVoiceSummarization",
!1)}async activateAnnotation(){if(!this.acc){await Jr.a.ml();var b=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation,h=[b(Object.assign(new FL.a,{annotationType:VG.SearchProviderAnnotation.getTypeName(),handler:this.tWf}))];WF.xYc&&h.push(b(Object.assign(new FL.a,{annotationType:ZE.TextSummaryAnnotation.getTypeName(),handler:this.Wnb})));await Promise.all(h);this.acc=!0}}Wnb(b){var h,r,B;if(this.Mmc)if(this.SAi(b)){if(b=b.items[0],ZE.TextSummaryAnnotation.typeGuard(b.body))if(window.clearTimeout(this.gzj),
b=b.body,b.status!==ZE.Result.Success)this.onError(ku.Z9a,Mw.Error,this.rXl(b),`[TextSummary] workflow failed with status: ${b.status}`);else{this.log({mK:ku.Z9a,logType:Mw.Success,success:!0});var P=null!==b.summary&&""!==b.summary,ca=WF.gVm&&(null===(h=b.tts)||void 0===h?void 0:h.requestStatus)===ZE.TTSStatus.Success&&null!==(null===(r=b.tts)||void 0===r?void 0:r.base64Audio)&&""!==(null===(B=b.tts)||void 0===B?void 0:B.base64Audio);this.Mmc({succeeded:P,summary:P?b.summary:null,audioSucceeded:ca,
audioBase64:ca?b.tts.base64Audio:null});this.Mmc=null}}else this.log({mK:ku.Z9a,logType:Mw.Error,success:!1,pNd:Dy.oug})}tWf(b){if(this.SAi(b)&&(b=b.items[0],VG.SearchProviderAnnotation.typeGuard(b.body)))if(window.clearTimeout(this.lij),(b=b.body)&&(b.docContentKey||b.dataCenterEndpoint||b.documentContentTableName))if(void 0===this.Cpb)this.log({mK:ku.fWa,logType:Mw.Error,pNd:Dy.YMj,success:!1,correlationId:b.correlationId,message:"[SearchProvider] workflow results arrived after timeout",workflowExecutionTime:b.workflowExecutionTime});
else if(this.Cpb!==b.correlationId)this.log({mK:ku.fWa,logType:Mw.Error,pNd:Dy.cSj,success:!1,correlationId:b.correlationId,message:"[SearchProvider] current correlation Id is not the one pending",workflowExecutionTime:b.workflowExecutionTime});else{var h=this.ZLh(b.docContentKey,b.dataCenterEndpoint,b.documentContentTableName);this.log({mK:ku.fWa,logType:Mw.Success,success:!0,correlationId:b.correlationId,workflowExecutionTime:b.workflowExecutionTime});this.Cpb=void 0;this.AUh.vlj(h)}else this.onError(ku.fWa,
Mw.Error,Dy.oug)}rXl(b){switch(b.status){case "BlockedByPrefilter":return Dy.BlockedByPrefilter;case "BlockedByQualityCheck":case "BlockedByPostfilter":return Dy.BlockedByQualityCheck;default:return Dy.Other}}SAi(b){return b&&b.items&&0<b.items.length&&b.items[0].body}log(b){switch(b.mK){case ku.fWa:var h=this.fco;break;case ku.Z9a:h=this.FJo;break;default:h=-1}const r=Date.now(),B=h?r-h:-1;h=[Object.assign(new ha.a,{name:"WorkflowType",string:b.mK}),Object.assign(new ha.a,{name:"LogType",string:b.logType}),
Object.assign(new ha.a,{name:"ErrorReason",string:b.pNd}),Object.assign(new ha.a,{name:"CorrelationId",string:b.correlationId}),Object.assign(new ha.a,{name:"Message",string:b.message}),Object.assign(new ha.a,{name:"WorkflowExecutionTime",int64:b.workflowExecutionTime}),Object.assign(new ha.a,{name:"StartTime",int64:h}),Object.assign(new ha.a,{name:"EndTime",int64:r}),Object.assign(new ha.a,{name:"Duration",int64:B})];Object(Ke.a)("AugloopSearchProviderData",b.success,B,h)}C9h(b){return`Error: ${b}, Message: ${b.message}, Stack: ${b.stack}`}ZLh(b=
"",h="",r=""){return Object.assign(new EL,{documentContentKey:b,dataCenterEndpoint:h,documentContentTableName:r})}onError(b,h,r,B){h={mK:b,logType:h,success:!1,message:B,pNd:r};switch(b){case ku.fWa:if(!this.Cpb)break;h.correlationId=this.Cpb;this.log(h);this.Cpb=void 0;this.mBl();break;case ku.Z9a:if(!this.Mmc)break;this.log(h);this.Mmc(null);this.Mmc=null;break;default:return null}}mBl(){this.AUh.vlj(this.ZLh())}}Object(m.a)(WF,"AugloopSearchProviderManager",null,[]);class WG{constructor(){this.results=
null;this.totalResultCount=0;this.hasTooManyResults=!1}}Object(m.a)(WG,"DocumentContentSearchResults",null,[]);class SH{getAllParagraphsInDocument(){return null}selectRange(){}selectRangeV2(b,h,r,B,P){this.selectRange(h,r,B,P)}selectRangeV3(){}search(){}searchV2(b,h){this.search(b,r=>{h(Object.assign(new WG,{results:r,totalResultCount:r.length,hasTooManyResults:100<r.length}))})}searchWithParam(b,h){this.search(b.query,h)}searchWithParamV2(b,h){this.searchWithParam(b,r=>{h(Object.assign(new WG,{results:r,
totalResultCount:r.length,hasTooManyResults:r.length>b.totalResultLimit}))})}highlight(){}highlightWithParam(b){this.highlight(b.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}generateDocumentSummary(){return Promise.resolve(null)}generateDocumentSummaryDetails(){return Promise.resolve(null)}extractDocumentObjects(){}getAuthorImageUrlFromClient(){return Promise.resolve(null)}getId(){return"DocumentContentExecutor"}}
Object(m.a)(SH,"BaseDocumentContentExecutor",null,[925,276]);var TH=c(2111),GL=c(1485);class XG{constructor(){this.query=null;this.matchWholeWordOnly=this.matchCase=!1;this.totalResultLimit=0}}Object(m.a)(XG,"DocumentContentSearchParams",null,[]);class UH{constructor(){this.subdocumentId=null;this.endParagraphOffset=this.endParagraphIndex=this.startParagraphOffset=this.startParagraphIndex=0}}Object(m.a)(UH,"DocumentSelection",null,[]);class HL{constructor(){this.authorID=this.authorColor=this.authorImageURL=
null}}Object(m.a)(HL,"IAuthorProperties",null,[]);var jE=c(688);class VH{constructor(){this.vOc=this.u9e=0}}Object(m.a)(VH,"CommentFindResultIndexInfo",null,[]);const WH=b=>{b.Ac(xe.SelectionEditor.Jj(b.ib.lb,!0,!1))},IL=b=>{b=TH.a.LTd(b.text[0]).split("\n");return 1===b.length?b[0]:b.join(" ")};class JL{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=this.subdocumentType=
0;this.authorName=this.authorEmail=null}}Object(m.a)(JL,"DocumentContentSearchResult",null,[]);var qN=c(1850);class KL{constructor(){this.authorEmail=this.authorName=this.ZEb=this.z9e=null}}Object(m.a)(KL,"CommentFindResults",null,[]);class LL{constructor(){this.end=this.Ec=0}}Object(m.a)(LL,"FindResultOffset",null,[]);class $v{constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb){this.vve=this.wv=this.yBe=this.eB=null;this.Sjh=0;this.lM=null;this.Esc=new mb.a;this.LPg=null;this.Cu=b;this.gb=h;this.Jdb=r;this.Tfa=
P;this.gXb=ca;this.Zub=ra;this.Yh=Qa;this.ga=tb;this.hb=Mb}X_l(b,h){var r;const B=[];if(12!=b.type)return B;const P=pn.FormattingReader.V4h(b);let ca=null,ra=-1;var Qa=Wi.a.auto;for(let Mb=0;Mb<=P.length;Mb++){let Zb=-1;var tb=Wi.a.auto;Mb<P.length&&(tb=P[Mb],Zb=tb.cp,tb=null===(r=tb.formatting)||void 0===r?void 0:r.cache,tb=(null===tb||void 0===tb?0:tb.IHb)?tb.highlight:(null===tb||void 0===tb?0:tb.DQa)?tb.ux:Wi.a.auto);if(Qa!=tb){if(Qa!=Wi.a.auto){ca||(ca=this.Zub.tFa(b.id));-1==Zb&&(Zb=ca.length);
Qa=this.Jdb.HJd(ca,ra,Zb,"");const jc={};jc.context=Qa.qId;jc.startOffsetInContext=Qa.Iee;jc.endOffsetInContext=Qa.Gee-1;B.push({data:jc,startParagraphIndex:h,endParagraphIndex:h,startOffsetInParagraph:ra,endOffsetInParagraph:Zb-1})}ra=Zb;Qa=tb}}return B}get Sba(){return this.LPg}initialize(){this.eB=Pg.FindManager.createInstance(this,this.Tfa,pq.a.instance,!1,!0)}search(b,h){this.eB.g0a();this.nHf(b)?(this.wv=h,this.lM=new mb.a,b=this.Vbf(b),this.eB.find(b)):h(null)}searchV2(b,h){v.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordCommentsInFindPaneSettings");
this.eB.g0a();if(this.nHf(b)){this.ezi()&&this.ga.Qb(fb.a.bhe,2,{CommandValueId:b});this.vve=h;this.Sjh=b.totalResultLimit;this.lM=new mb.a;b=this.Vbf(b);this.LPg=new Pp.a;this.eB.find(b);h=this.Tfa.p4c(b.text);h=this.Tfa.sNb(h);b=this.gXb.J$b(h.join("|"),b);h=this.Yh.bP();for(let B=0;B<h.length;B++){const P=h[B],ca=IL(P);var r=this.Zub.Njb(ca,b);const ra=this.Zub.Njb(P.author,b);if(!r&&!ra){t.ULS.sendTraceTag(572343620,313,15,"commentTextIsNull: {0}, findRegexIsNull: {1}",!ca,!b);continue}r=ra&&
(!this.pwi||0<ra.length)?ra:r;let Qa="",tb="";ra&&(!this.pwi||0<ra.length)&&(Qa=P.author,tb=P.authorId);for(const Mb of r)r=qN.a.createInstance(Mb.Ec,Mb.end,V.a.If(P.objectId),B,32,!1),this.Esc.add(r),this.Sba.nb(B)||this.Sba.add(B,Object.assign(new KL,{z9e:ca,ZEb:[],authorName:Qa,authorEmail:tb}))}}else h(null)}get r0h(){null==this.yBe&&(this.yBe=Pg.FindManager.createInstance(this,this.Tfa,pq.a.instance));return this.yBe}ezi(){var b;return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:
b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}$cc(){var b;return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocNoteSearchOnWac",!1)}get pwi(){var b;return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentsInFindPaneFix",!1)}highlight(b){var h=this.nHf(b);b=h?this.Vbf(b):null;var r={};this.ezi()&&this.ga.Qb(qb.a.j5f,
2,r);if(r[qg.a.On]){if(h){h={};r={};var B={};this.ga.Qb(qb.a.qbe,2,h);this.ga.Qb(fb.a.pbe,2,r);this.ga.Qb(fb.a.rbe,2,B);if(b.text!=h.CommandValueId||b.matchCase!=r[qg.a.On]||b.matchWholeWord!=B[qg.a.On])WH(this.hb),this.ga.Qb(fb.a.findInDocument,2,{CommandValueId:b.text,MatchCase:b.matchCase,MatchWholeWord:b.matchWholeWord})}}else r=this.r0h,r.g0a(),h&&r.find(b)}selectNextPrevHighlight(b){const h=this.r0h;return 0<h.Sj.yka?(b?h.sli():h.xli(),h.Sj.nZe-1):-1}Vbf(b){let h=Ei.a.none;b.matchCase&&(h|=
Ei.a.matchCase);b.matchWholeWordOnly&&(h|=Ei.a.wholeWordOnly);return li.a.createQuery(b.query,h)}nHf(b){return b&&!!b.query&&0<b.query.length}Whe(){}oge(){}reset(){}nlf(){}z8b(){if(this.wv){var b=this.$Lh(this.lM);this.wv(b)}if(this.vve){b=new WG;const h=this.lM.count+this.Esc.count>this.Sjh;b.totalResultCount=this.lM.count+this.Esc.count;b.hasTooManyResults=h;h||(this.lM.aD(this.lM.count,this.Esc),b.results=this.$Lh(this.lM));this.vve(b);this.Esc.clear()}}$Lh(b){var h;const r=[];var B=Object.assign(new jE.a,
{rP:!1,Uca:!0,hpa:this.$cc(),sP:!0});B=this.gb.sFa(this.Cu.value,B);for(const ra of b){var P=ra.Ec;let Qa=ra.end;var ca=void 0;b=-1;let tb=null,Mb=0;if(32===ra.type){tb=$v.y9e;Mb=3;b=B.count+ra.IQa;const Zb=({Ec:P,end:Qa}=DL.a.gaj(this.Sba.J(ra.IQa).z9e,P,Qa)).returnValue;ca=this.Jdb.HJd(Zb,P,Qa,Nl.a(ra.type));this.Sba.J(ra.IQa).z9e=Zb;this.Sba.J(ra.IQa).ZEb.push(Object.assign(new LL,{Ec:P,end:Qa}))}else{if(2===ra.type||4===ra.type)Mb=2===ra.type?1:2,tb=$v.tzf;if(8===ra.type||16===ra.type)Mb=8===
ra.type?6:5,tb=$v.bUf;for(ca=0;ca<B.count;ca++)if(B.J(ca).id===ra.nodeId){b=ca;break}ca=this.Jdb.IJd(ra)}P=(null===(h=this.Sba)||void 0===h?0:h.nb(ra.IQa))?this.Sba.J(ra.IQa):null;if(0<=b||(null===P||void 0===P?0:P.authorName))b=Object.assign(new JL,{snippet:ca.qId,subdocumentId:tb,subdocumentType:Mb,startOffsetInSnippet:ca.Iee,endOffsetInSnippet:ca.Gee-1,paragraphIndex:b,startOffsetInParagraph:ra.Ec-ca.Iee,endOffsetInParagraph:ra.end-ca.Gee-1,authorName:P?P.authorName:"",authorEmail:P?P.authorEmail:
""}),r.push(b)}r.sort((ra,Qa)=>ra.paragraphIndex===Qa.paragraphIndex?ra.startOffsetInParagraph-Qa.startOffsetInParagraph:ra.paragraphIndex-Qa.paragraphIndex);return r}update(){}DPa(b,h){switch(b){case 0:h&&0<h.length&&!this.lM&&(t.ULS.sendTraceTag(570975814,313,15,"Results container list is null"),this.lM=new mb.a);for(const r of h)this.lM.add(r)}}cqb(){}dispose(){}}$v.y9e="Comment";$v.tzf="HeaderFooter";$v.bUf="Note";$v.Eqi="Image";Object(m.a)($v,"WordDocumentSearchProcessor",null,[300,9,301]);class ML extends SH{get mS(){return!this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.NoCommentFocusOnFindSelection",
!1)}$cc(){var b;return null===(b=v.AFrameworkApplication.K)||void 0===b?void 0:b.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableInDocNoteSearchOnWac",!1)}constructor(b,h,r,B,P,ca,ra,Qa,tb,Mb,Zb,jc,Gc,Uc){super();this.Ca=Mb;this.tNa=null;this.TY=(od,Od)=>{od=Od.node;Od=Od.property;this.fgg(od)&&Od===Pd.a.wo&&this.BHb(od,3)};this.dja=(od,Od)=>{od=Od.node;!Od.tEf&&this.fgg(od)&&this.BHb(od,1)};this.Onb=(od,Od)=>{od=Od.node;this.fgg(od)&&this.BHb(od,2)};this.Cu=b;this.gb=h;this.ld=
r;this.hb=B;this.NE=P;this.Bl=Qa;this.Vb=tb;this.R7=ca;this.yC=ra;this.Yh=Zb;this.r7j=jc;this.heh=V.a.create();this.mde(this.TY,this.dja,this.Onb);Uc&&Uc.execute(od=>this.ema=od);Gc.execute(od=>{this.zZa=od})}submitDocumentContentExtractionSignal(){this.zZa&&this.zZa.submitDocumentContentExtractionSignal()}generateDocumentSummary(){return this.zZa?this.zZa.generateDocumentSummary():Promise.resolve(null)}generateDocumentSummaryDetails(){return this.zZa?this.zZa.generateDocumentSummaryDetails():Promise.resolve(null)}getAllParagraphsInDocument(){const b=
this.AU(this.i9l());for(const r of this.Yh.bP()){var h=TH.a.LTd(r.text[0]).split("\n");h=1===h.length?h[0]:h.join(" ");b.add(h)}return b.toArray()}extractDocumentObjects(b){var h=Object.assign(new jE.a,{rP:!1,Uca:!1,sP:!0}),r=this.gb.sFa(this.Cu.value,h);h=[];const B=[];for(var P=0;P<r.count;++P){var ca=r.J(P);h.push(...this.U0l(ca,P));B.push(...this.R7.X_l(ca,P))}r=[];P=this.Yh.bP();for(ca=0;ca<P.length;ca++)r.push(this.pSl(P[ca]));P={};P.images=h;P.comments=r;P.highlights=B;b(P)}selectRange(b,h,
r,B,P){const ca=Date.now(),ra={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.wUa();if(0>b||0>h||0>r||0>B||b>r||b===r&&h>B)throw Error("Provided select range offsets incorrect");const Uc=Object.assign(new jE.a,{rP:!1,Uca:!0,hpa:this.$cc(),sP:!0}),od=this.gb.sFa(this.Cu.value,Uc);if(r>=od.count){const Od=Ma.a.instance.resolve("Common.Comments.ICommentModel").bP(),ze=r-od.count;if(ze<Od.length){P=-1;if(this.R7.Sba.nb(ze)){const ee=this.R7.Sba.J(ze).ZEb;
for(var Qa=0;Qa<ee.length;Qa++)if(ee[Qa].Ec===h){P=Qa;break}}this.tNa=-1!==P?Object.assign(new VH,{u9e:ze,vOc:P}):null;const de=Od[ze];v.AFrameworkApplication.va.processAction(qb.a.iU,2);v.AFrameworkApplication.va.Qb(qb.a.p4,2,null);v.AFrameworkApplication.va.Qb(qb.a.selectComment,2,Object.assign(new GL.a,{commentId:de.id,E$:2,mS:this.mS}))}}else{this.tNa=null;var tb=od.J(b),Mb=od.J(r);if(!this.C1d(tb,h)||!this.C1d(Mb,B))throw Error("Provided select range offsets incorrect");v.AFrameworkApplication.va.processAction(qb.a.iU,
2);this.FLo(tb);var Zb=this.NE.ne(tb,h);Qa=this.NE.Gy(Zb,Ue.a.Rc(Mb,B+1));if(P){const Od=Qa.toArray();h=[];for(const ze of Od)h.push(this.zTd(ze.node));h.join(" ").includes(P)||(ra.success=!1,ra.message="The text in clicked passage does not match the selected hit")}var jc=this.Bl.value.iu,Gc=this.hb.ib.lb;Gc&&Gc.equals(Qa)&&this.ld.oea(jc,null);this.ld.oea(jc,Qa);ra.duration=Date.now()-ca;this.logMessage(ra)}}catch(Uc){ra.success=!1,ra.message=Uc.stack,ra.duration=Date.now()-ca,this.logMessage(ra)}}search(b,
h){this.wUa();this.R7.search(Object.assign(new XG,{query:b}),h)}searchV2(b,h){this.wUa();this.R7.searchV2(Object.assign(new XG,{query:b}),h)}selectNextPrevHighlight(b){this.wUa();return this.R7.selectNextPrevHighlight(b)}searchWithParam(b,h){this.wUa();this.R7.search(b,h)}searchWithParamV2(b,h){this.wUa();this.R7.searchV2(b,h)}highlight(b){this.wUa();this.R7.highlight(Object.assign(new XG,{query:b}))}highlightWithParam(b){this.wUa();this.R7.highlight(b)}getRevision(){return this.heh.toString()}getSelectedText(){const b=
this.r7j.getSelectedText();return Object.assign(new Gx.a,{neighborhood:b.neighborhood,mentionStart:b.mentionStart,mentionLength:b.mentionLength})}getDocumentSelection(){var b=Object.assign(new jE.a,{rP:!1,Uca:!0,hpa:this.$cc(),sP:!0}),h=({ps:ca}=this.Rdm(b)).returnValue;if(h)return h;var r=this.hb.ib.lb;if(!r||!r.length)return null;h=r.Pa;r=r.Tc;let B=-1,P=-1;var ca=ca||this.gb.sFa(this.Cu.value,b);b=null;for(let ra=0;ra<ca.count;ra++){const Qa=ca.J(ra);-1===B&&h.node.id===Qa.id&&(B=ra,b=Qa);-1===
P&&r.node.id===Qa.id&&(P=ra)}ca=null;5===(null===b||void 0===b?void 0:b.$na)&&(ca=$v.tzf);if(1===(null===b||void 0===b?void 0:b.$na)||2===(null===b||void 0===b?void 0:b.$na))ca=$v.bUf;return Object.assign(new UH,{subdocumentId:ca,startParagraphIndex:B,startParagraphOffset:h.Wj,endParagraphIndex:P,endParagraphOffset:r.vp})}clearDocumentSelection(){WH(this.hb)}selectRangeV2(b,h,r,B,P,ca){const ra=Date.now(),Qa={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};
try{this.wUa();if(0>h||0>r||0>B||0>P||h>B||h===B&&r>P)throw Error("Provided select range offsets incorrect");var tb=Object.assign(new jE.a,{rP:!1,Uca:!0,hpa:this.$cc(),sP:!0});const Gc=this.gb.sFa(this.Cu.value,tb);if(b==$v.y9e)this.yij(r,B,Gc.count);else{tb=this.tNa=null;var Mb={};Mb.subdocumentId=b;Mb.startParagraphIndex=h;Mb.startParagraphOffset=r;Mb.endParagraphIndex=B;Mb.endParagraphOffset=P;tb=b==$v.Eqi?this.Fai(Gc.J(h),{isFloatingImage:!1,imageId:"",...Mb}):this.hji(Gc.J(h),Gc.J(B),{clickedPassage:ca,
...Mb},Qa);var Zb=this.Bl.value.iu,jc=this.hb.ib.lb;(null===jc||void 0===jc?0:jc.equals(tb))&&this.ld.oea(Zb,null);this.ld.oea(Zb,tb)}Qa.duration=Date.now()-ra;this.logMessage(Qa)}catch(Gc){Qa.success=!1,Qa.message=Gc.stack,Qa.duration=Date.now()-ra,this.logMessage(Qa)}}selectRangeV3(b){const h=Date.now(),r={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",duration:0};try{this.wUa();if(0>b.startParagraphIndex||0>b.startParagraphOffset||0>b.endParagraphIndex||0>b.endParagraphOffset||
b.startParagraphIndex>b.endParagraphIndex||b.startParagraphIndex===b.endParagraphIndex&&b.startParagraphOffset>b.endParagraphOffset)throw Error("Provided select range offsets incorrect");var B=Object.assign(new jE.a,{rP:!1,Uca:!0,hpa:this.$cc(),sP:!0});const ra=this.gb.sFa(this.Cu.value,B);if(b.subdocumentId==$v.y9e)this.yij(b.startParagraphOffset,b.endParagraphIndex,ra.count);else{B=this.tNa=null;B=b.subdocumentId==$v.Eqi?this.Fai(ra.J(b.startParagraphIndex),b):this.hji(ra.J(b.startParagraphIndex),
ra.J(b.endParagraphIndex),b,r);var P=this.Bl.value.iu,ca=this.hb.ib.lb;(null===ca||void 0===ca?0:ca.equals(B))&&this.ld.oea(P,null);this.ld.oea(P,B)}r.duration=Date.now()-h;this.logMessage(r)}catch(ra){r.success=!1,r.message=ra.stack,r.duration=Date.now()-h,this.logMessage(r)}}i9l(){const b=Date.now(),h={activityName:"GetParagraphNodes",success:!0,message:"",duration:0},r=Object.assign(new jE.a,{rP:!1,Uca:!1,sP:!0});h.duration=Date.now()-b;this.logMessage(h);return this.gb.sFa(this.Cu.value,r)}AU(b){const h=
Date.now(),r={activityName:"GetParagraphContent",success:!0,message:"",duration:0},B=new mb.a;for(const P of b)B.add(this.zTd(P));r.duration=Date.now()-h;this.logMessage(r);return B}Fai(b,h){if(h.isFloatingImage)return h=V.a.If(h.imageId),b=b.Mc.Eb(h),b=og.SelectionFactory.Eq(b);const r=this.NE.ne(b,h.startParagraphOffset);return b=this.NE.Gy(r,Ue.a.Rc(b,h.startParagraphOffset+1))}async getAuthorImageUrlFromClient(b,h){b=new of.a(b,"O365",h,b);if(!this.ema||!this.ema.getPersonaIconPropertiesArray)return null;
b=await this.ema.getPersonaIconPropertiesArray([b]);return 0<b.length&&b[0].authorImageURL?Object.assign(new HL,{authorImageURL:b[0].authorImageURL,authorColor:b[0].authorColor,authorID:b[0].authorID}):null}hji(b,h,r,B){if(!this.C1d(b,r.startParagraphOffset)||!this.C1d(h,r.endParagraphOffset))throw Error("Provided select range offsets incorrect");r.subdocumentId==$v.tzf?v.AFrameworkApplication.va.Qb(qb.a.kmb,2,new Hp.a(b)):v.AFrameworkApplication.va.processAction(qb.a.iU,2);r.subdocumentId==$v.bUf?
32===v.AFrameworkApplication.va.Qb(qb.a.m6a,2,new Hp.a(b))&&v.AFrameworkApplication.va.processAction(qb.a.uPd,2):v.AFrameworkApplication.va.Qb(qb.a.p4,2,null);b=this.NE.ne(b,r.startParagraphOffset);h=this.NE.Gy(b,Ue.a.Rc(h,r.endParagraphOffset+1));if(r.clickedPassage){b=h.toArray();const P=[];for(const ca of b)P.push(this.zTd(ca.node));P.join(" ").includes(r.clickedPassage)||(B.success=!1,B.message="The text in clicked passage does not match the selected hit")}return h}yij(b,h,r){const B=Ma.a.instance.resolve("Common.Comments.ICommentModel").bP();
h-=r;if(h<B.length){r=-1;if(this.R7.Sba.nb(h)){const P=this.R7.Sba.J(h).ZEb;for(let ca=0;ca<P.length;ca++)if(P[ca].Ec===b){r=ca;break}}this.tNa=-1!==r?Object.assign(new VH,{u9e:h,vOc:r}):null;b=B[h];v.AFrameworkApplication.va.processAction(qb.a.iU,2);v.AFrameworkApplication.va.Qb(qb.a.p4,2,null);v.AFrameworkApplication.va.Qb(qb.a.selectComment,2,Object.assign(new GL.a,{commentId:b.id,E$:2,mS:this.mS}))}}wUa(){this.Vb&&(this.Vb.currentScope&&this.Vb.currentScope.name===Oh.lC||this.Vb.mg(Oh.lC))}tZo(){this.heh=
V.a.create()}zTd(b){if(b.bJb)return"";b=this.gb.text(b);return oi.AParagraphNode.UP(b," ")}C1d(b,h){b=this.zTd(b);return h<b.length}BHb(b,h){switch(h){case 1:case 2:case 3:this.tZo()}}logMessage(b){const h=[Object.assign(new ha.a,{name:"Message",string:b.message})];Object(Ke.a)(b.activityName,b.success,b.duration,h)}fgg(b){return!b.bJb&&this.uXc(b)}uXc(b){const h=this.Cu.value;return!!h&&!!h.xd&&!!b.Mc&&b.Mc.id.equals(h.xd.id)}FLo(b){this.gb.Rcc(b)?32===v.AFrameworkApplication.va.Qb(qb.a.m6a,2,new Hp.a(b))&&
v.AFrameworkApplication.va.processAction(qb.a.uPd,2):v.AFrameworkApplication.va.Qb(qb.a.p4,2,null)}mde(b,h,r){this.yC&&(this.yC.Eo(b),this.yC.ju(h),this.yC.Vw(r))}Rdm(b){let h=null;var r=this.Vb?this.Vb.currentScope.name:"";if(!this.Yh.tt||r!==Dd.AFrame.Ur&&r!==Dd.AFrame.JM)return{returnValue:null,ps:h};r=Array.indexOf(this.Yh.bP(),this.Yh.tt);if(0>r)return{returnValue:null,ps:h};h=this.gb.sFa(this.Cu.value,b);var B=TH.a.LTd(this.Yh.tt.text[0]).split("\n");b=0;B=(1===B.length?B[0]:B.join(" ")).length-
1;this.tNa&&r===this.tNa.u9e&&this.R7.Sba.nb(r)&&this.R7.Sba.J(r).ZEb.length>this.tNa.vOc&&(b=this.R7.Sba.J(r).ZEb[this.tNa.vOc].Ec,B=this.R7.Sba.J(r).ZEb[this.tNa.vOc].end);return{returnValue:Object.assign(new UH,{startParagraphIndex:h.count+r,startParagraphOffset:b,endParagraphIndex:h.count+r,endParagraphOffset:B,subdocumentId:"Comment"}),ps:h}}U0l(b,h){const r=[];if(12!=b.type)return r;r.push(...this.t1l(b,h));r.push(...this.XYl(b,h));return r}XYl(b,h){const r=[],B=Ad.GraphIterator.eb(b);if(!B.Iz())return r;
let P=B.Rd();for(;P;){if(!this.lRa(P)){P=B.It();continue}const ca=P.properties;ca&&Id.ImageReader.TWc(ca)&&r.push(this.kBj(ca,h,0,b.Mc,!0,P.id.toString()));P=B.It()}return r}lRa(b){if(19!==b.type||5!==Id.ImageReader.ui(b))return!1;b=Ad.GraphIterator.eb(b);if(!b.Iz())return!0;let h=b.Rd();for(;h;){if(59===h.type)return!1;h=b.It()}return!0}t1l(b,h){const r=[],B=b.Mc;if(B){if(!b.hasProperty(Pd.a.Sn))return r;var P=b.ja(Pd.a.Sn,null);if(!P)return r;b=b.ja(Pd.a.Jm,null);for(let ra=0;ra<P.length;++ra){var ca=
P[ra];if(!ca)continue;ca=B.Eb(ca);if(!ca||!Id.ImageReader.TWc(ca)||5!==Id.ImageReader.ui(ca))continue;let Qa=0;0!=ra&&b&&ra-1<b.length&&(Qa=b[ra-1]);r.push(this.kBj(ca,h,Qa,B,!1,""))}return r}}kBj(b,h,r,B,P,ca){B=(new Sys.Net.WebRequest).getResolvedUrl()+Id.ImageReader.K7l(b,B);const ra=b.ja(Yc.a.ft,""),Qa={};Qa.base64Encoding=ra;Qa.url=B;Qa.width=Id.ImageReader.ZC(b);Qa.height=Id.ImageReader.WH(b);Qa.altText=Id.ImageReader.bY(b);Qa.description=Id.ImageReader.iQa(b);Qa.imageId=ca;Qa.isFloatingImage=
P;return{data:Qa,startParagraphIndex:h,endParagraphIndex:h,startOffsetInParagraph:r,endOffsetInParagraph:r+1}}pSl(b){return{data:{comment:IL(b),authorName:b.author,authorEmail:b.authorId,objectId:b.objectId,authorImageURL:""},startParagraphIndex:-1,endParagraphIndex:-1,startOffsetInParagraph:-1,endOffsetInParagraph:-1}}}Object(m.a)(ML,"WordDocumentContentExecutor",SH,[]);class YG{isEditingAllowed(){return!0}author(){return null}createdDate(){return null}}Object(m.a)(YG,"BaseDocumentHelper",null,[286]);
class NL extends YG{constructor(b){super();this.sKl=b}get j7b(){const b=this.sKl.instance;b&&b.loadDocumentProperty();return b}isEditingAllowed(){return Eb.App.za.jb.isEditingAllowed}author(){var b;return null===(b=this.j7b)||void 0===b?void 0:b.author}createdDate(){var b;return null===(b=this.j7b)||void 0===b?void 0:b.creationDate}}Object(m.a)(NL,"WordDocumentHelper",YG,[]);class OL{constructor(b){this.jMi=b}insertOnlinePicture(){}insertHtmlText(b){b&&this.iCf(b.htmlText)}getId(){return"InsertContentExecutor"}iCf(b){return this.executeCommand(Nb.a.Zma,
b)}executeCommand(b,h){const r=new fd.DictionaryPropertySet;r.setValue(Yc.a.NP,h);r.setValue(Yc.a.Wja,!1);h=this.jMi.processAction(b,1);32===h&&(h=this.jMi.Qb(b,2,r));return h}}Object(m.a)(OL,"WordInsertContentExecutor",null,[299,276]);var rN=c(1733),sN=c(1734);class PL{constructor(b,h,r,B,P){this.utc="undefined";this.zfg="Something went wrong with retrieving a summary. Please try again.";this.kHm=(ca,ra,Qa,tb,Mb)=>pv.wY(ca,ra,Qa,tb,this.vC,Mb);this.Tie=(ca,ra,Qa,tb,Mb)=>{if(1===Qa)return this.s8j?
32:8;ca=uG.getSelectedText();ca=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuDictionarySmartLookupWithQuery,uG.aUd(ca));Mb[pj.a.LabelText]=ca;return 32};this.Cnf=(ca,ra,Qa)=>{if(1===Qa)return 32;const tb={};this.zZa?this.zZa.generateDocumentSummary().then(Mb=>{Mb||(Mb=this.zfg,t.ULS.sendTraceTag(509723399,1303,15,"Share with summary: Generated document summary is empty."));tb.additionalData=this.Faf(Mb);this.ga.Qb(fb.a.V8,2,tb)}).catch(()=>{t.ULS.sendTraceTag(509723398,1303,15,"Share with summary: Error in generating document summary.");
tb.additionalData=this.Faf(this.zfg);this.ga.Qb(fb.a.V8,2,tb)}):(t.ULS.sendTraceTag(509723397,1303,15,"Share with summary: Search provider manager is unavailable."),tb.additionalData=this.Faf(this.zfg),this.ga.Qb(fb.a.V8,2,tb));return 32};this.wNo=(ca,ra,Qa)=>{if(!this.YMi)return t.ULS.sendTraceTag(508929473,1303,15,"Cannot get a token for Transform to Slides action."),8;if(1===Qa)return this.IWm()?32:2;if(2===Qa)this.YMi.$Ud(this.Ca.kb("SmartLookupShredderServiceEndpoint")).then(tb=>{tb={token:tb,
files:H.c(this.YXl()),type:"MultiFilesDeckGeneration"};tb=Object.assign(new rN.a,{selection:Object.assign(new Gx.a,{neighborhood:"",mentionStart:0,mentionLength:0}),launchData:Object.assign(new ju.a,{landingTab:"All",data:tb}),entryPoint:38});this.ga.Qb(fb.a.q9,2,tb);return 32}).catch(()=>{t.ULS.sendTraceTag(508929472,1303,15,"Error in getting a token for Transform to Slides action.");return 8});else return 32};this.vC=b;this.ga=h||v.AFrameworkApplication.va;this.Ca=r;this.b8j=(this.Pw=!!v.AFrameworkApplication.ua&&
v.AFrameworkApplication.ua.Kb.tL)&&!!this.Ca&&this.Ca.$("AutoOpenSearchPaneInDoublePortraitIsEnabled");this.s8j=!!this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefineFloatieEntrypointIsEnabled",!1);B&&B.execute(ca=>{this.zZa=ca});this.YMi=P}Tb(){this.ga.fb(qb.a.Vwh,yd.a.frame,this.kHm,1028);this.ga.fb(qb.a.Tie,yd.a.frame,this.Tie,1028);this.ga.fb(qb.a.$3h,yd.a.frame,this.Cnf,1028);this.ga.fb(qb.a.lBj,yd.a.frame,this.wNo,1028);this.b8j&&(this.utc=Eb.App.za.aJ.getWindowMode(),
this.rXh(this.utc),Eb.App.za.aJ.registerBoundingWindowRectsChanged("SearchPane",(b,h)=>{h!==this.utc&&(this.utc=h,this.rXh(this.utc))}))}IWm(){return v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableTransformToSlidesInRibbon",!1)&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableContentTransformInL2",!1)}rXh(b){"DP"===b&&al.UISurfaces.Nu().then(h=>{h.selectors.getTabbedTaskPaneCount()||this.ga.Qb(qb.a.Vwh,
2,{SourceControlId:"smartlookupAuto"});return null})}Faf(b){return{["documentSummary"]:b}}YXl(){const b=new sN.a("docx",v.AFrameworkApplication.K.kb("EditDocInClientUrl"),v.AFrameworkApplication.K.kb("BreadcrumbBrandUrl"),"",v.AFrameworkApplication.sessionStartInfoSettings.FileSizeBytes,(new Date).toLocaleString()),h=[];Array.add(h,b);return h}}Object(m.a)(PL,"WordInsightsActor",null,[]);class $E{constructor(){this.djd=this.wQ=null}I2a(){return this.nGb()}bbi(){return this.nGb()}$ai(){return null}oxo(b,
h,r){this.wQ||(this.wQ=this.qJd());this.wQ.WP(b,h,r)}pxo(b,h,r){this.wQ||(this.wQ=this.qJd());this.wQ.Dhg(b,h,r)}Ivo(b,h){this.djd||(this.djd=null);this.djd&&this.djd.Dhg(b,h)}$Pb(b,h){this.wQ||(this.wQ=this.qJd());this.wQ.$Pb(b,h)}p2d(b){this.wQ||(this.wQ=this.qJd());this.wQ.p2d(b)}ieo(){this.wQ&&this.wQ.Fkc()}Tio(){this.wQ&&this.wQ.Pge()}Vuo(){var b=v.AFrameworkApplication.K.mc("SmartLookupLaunchThrottleThresholdInMilliseconds",1500);b=window.performance.now()-$E.jGi<=b;b||($E.jGi=window.performance.now());
return b}dispose(){this.wQ&&(this.wQ.dispose(),this.wQ=null)}get FJb(){return this.wQ?this.wQ.isVisible:!1}}$E.jGi=0;Object(m.a)($E,"InsightsManager",null,[953,9]);class XF{constructor(b,h,r,B,P,ca=!0,ra=null,Qa=null){this.C6=this.ME=this.dMa=null;this.Sxc=!1;this.wfa=null;this.Vb=h;this.wYb=ca;this.cTg=Qa?Qa:new YG;this.Zu=ra;this.lp=b;this.wYb&&(Ma.a.instance.Oa("Common.App.SearchCommon.SearchHostRuntime")&&(this.wfa=Ma.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").urf()),this.Kdb=
Ma.a.instance.resolve("Common.App.SearchCommon.ISearchHelper"),this.nAb=this.Kdb.URc())}Jnb(b){if(this.wYb){b=b.rawEvent;try{var h=H.a(b.data)}catch(r){t.ULS.sendTraceTag(595161728,1303,15,this.rU("Message data from Serplet [{0}] failed to deserialize.",b.data));return}switch(h.actionType){case 101:b=0;this.ME&&(b=this.ME.entryPoint);this.Kdb.Juf(this.C6,this.cTg,this.fac(),b).then(r=>{h.data=r;this.Dob(h)});break;case 118:h.data=this.ME?this.ME:Object.assign(new Mt.a,{selection:Object.assign(new Gx.a,
{neighborhood:this.dMa.neighborhood,mentionStart:this.dMa.mentionStart,mentionLength:this.dMa.mentionLength})});this.Dob(h);break;case 103:b=H.a(Object(Ra.a)(String,h.data));Xl.sendTelemetryEvent(b);break;case 206:this.Kdb.$Ud(h.data).then(r=>{h.data=r;this.Dob(h)});break;case 112:h.data.shiftPressed?(Z.a.Cj&&document.activeElement.blur(),this.lp.QVd(0,null,2,null,null),t.ULS.sendTraceTag(592545156,1303,50,this.rU("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.lp.NSc(0,null,2,null,null),
t.ULS.sendTraceTag(592545155,1303,50,this.rU("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.$oa()}}}F8c(b){if(this.wfa){var h=0;this.ME&&(h=this.ME.entryPoint);this.Kdb.Juf(this.C6,this.cTg,this.fac(),h).then(r=>{Xl.zjj("SearchFromHost",this.C6);this.ME.launchData||(this.ME.launchData=new ju.a);const B=UG();try{this.wfa.search(this.ME,r,v.AFrameworkApplication.userSessionId,B,b),this.Kdb.zCn(P=>{Xl.zjj("SearchFromHostWithToken",this.C6);this.wfa.searchAuthenticatedProviders(this.ME,
r,v.AFrameworkApplication.userSessionId,B,null,P)})}catch(P){Xl.Uz("BaseSmartLookupPane - Fail to search from host. Error: "+P,10)}}).catch(r=>{Xl.Uz("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+r.toString(),10)})}}Gkc(b){if(this.wYb){var h=Xl,r=h.Gkc,B=this.C6;b=Math.round(window.performance.now()-b);var P=this.ME?XE[this.ME.entryPoint]:"",ca=this.Kdb.URc(),ra=this.Kdb.NXl(),Qa=this.ME?this.ME.entryPoint:0;r.call(h,B,b,P,ca,ra,v.AFrameworkApplication.z1e,this.Sxc,
18===Qa||19===Qa||15===Qa)}}}Object(m.a)(XF,"BaseSmartLookupPane",null,[281,9]);class YF{constructor(b){this.messageType=null;this.messageType=b}}Object(m.a)(YF,"InsightsMessage",null,[]);class ZF extends YF{constructor(b,h){super(b);this.messageContent=null;this.messageContent=h}}Object(m.a)(ZF,"InsightsMessageWithContent",YF,[]);class QL extends ZF{constructor(b){super(Oh.vdn,b)}}Object(m.a)(QL,"InsightsMessageAppProperties",ZF,[]);class RL extends ZF{constructor(b){super(Oh.Gdn,b)}}Object(m.a)(RL,
"InsightsMessageSelection",ZF,[]);class SL extends YF{constructor(){super(Oh.Idn)}}Object(m.a)(SL,"InsightsMessageTakeFocus",YF,[]);class $F extends XF{constructor(b,h,r,B,P=null,ca=null,ra=null,Qa=!0,tb=null,Mb=null){super(h,r,P,ca,ra,Qa,tb,Mb);this.Whd=this.gB=this.lj=null;this.ttd=!1;this.lod=b;this.Bwc=this.wYb?PH(this.nAb):v.AFrameworkApplication.rFm;this.Q_();this.g7f();this.Xo=B;this.RRg=0}get isVisible(){return!1}Q_(){this.lj=this.lod.UKc();v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb.Dlb&&
this.lj.iXn(b=>{b===this.lj&&(this.Pge(),this.Fkc())});this.KBf(this.lj.RUa.Cxh);this.lj.Hm()}KBf(b){b.style.overflow="hidden";const h=qf.a.createElement("iframe");Sys.UI.DomElement.addCssClass(h,"InsightsPaneIFrame");h.setAttribute("Unselectable","off");this.gB=h;b.appendChild(this.gB);this.gB.id=Oh.oAf}g7f(){He.a.addHandler(this.gB,"load",Object(z.a)(this,this.Inb,"onIFrameLoad"));He.a.addHandler(this.gB,"error",Object(z.a)(this,this.Hnb,"onIFrameError"));$addHandler(window,"message",Object(z.a)(this,
this.Jnb,"onIFrameMessage"))}Qog(){He.a.removeHandler(this.gB,"load",Object(z.a)(this,this.Inb,"onIFrameLoad"));He.a.removeHandler(this.gB,"error",Object(z.a)(this,this.Hnb,"onIFrameError"));$removeHandler(window,"message",Object(z.a)(this,this.Jnb,"onIFrameMessage"))}dispose(){this.gB&&(this.Qog(),this.gB.parentNode.removeChild(this.gB),this.gB=null);this.lj&&(this.lod.d7b(this.lj),this.lj=null)}WP(b,h,r){this.C6=h;this.Whd=null;this.RRg=r;this.Sxc=!b.mentionLength;this.ttd=!1;t.ULS.sendTraceTag(6295947,
1303,50,this.rU("Start to show Insights"));this.dMa=b;this.Bwc&&this.Bwc.length?this.gB.src=this.Bwc:(this.gB.src=$F.HSi,t.ULS.sendTraceTag(6295948,1303,15,this.rU("The Insights URL config setting is null or empty")));this.Xo.sendNotification(CommonUIStrings.l_InsightsPaneNotification,!0);this.lj.GY||this.lj.o7f(Object(z.a)(this,this.Ypn,"onInsightsTaskPaneHidden"));this.wYb&&this.F8c(!1);b=window.performance.now();this.lod.showTaskPane(this.lj);this.lj.Hm();this.Gkc(b)}Dhg(b,h,r){this.ME=b;this.WP(Object.assign(new UF.a,
{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,r)}$Pb(){}p2d(){}Fkc(){this.gB.src===this.Bwc&&this.ttd&&(this.Vb.mg(Oh.lC),this.Dob(new SL))}Pge(){this.gB&&pc.FocusManager.iK(this.gB.contentWindow)}Ndf(){this.gB.src=$F.HSi;this.lj.Im()}$oa(){this.lod.hideTaskPane(this.lj);this.Ndf()}Ypn(b){b===this.lj&&this.$oa()}Inb(){t.ULS.sendTraceTag(6295951,1303,50,this.rU("The iframe is successfully loaded in Insights task pane"))}Hnb(){t.ULS.sendTraceTag(6295952,
1303,15,this.rU("The iframe failed to load in Insights task pane"))}Jnb(b){const h=b.rawEvent;if(h.source===this.gB.contentWindow)if(this.wYb)super.Jnb(b);else{let r;try{r=H.a(h.data)}catch(B){t.ULS.sendTraceTag(6295953,1303,15,this.rU("Message data [{0}] failed to deserialize.",h.data));return}if(nf.c(r.messageType))t.ULS.sendTraceTag(6295954,1303,15,this.rU("Message data [{0}] is in wrong format.",h.data));else switch(r.messageType){case Oh.wdn:this.Dob(new QL(this.C1l()));break;case Oh.Hdn:this.Dob(new RL(this.dMa));
break;case Oh.Cdn:this.ttd=!0;this.Pge();this.Fkc();t.ULS.sendTraceTag(6295955,1303,50,this.rU("Insights pane rendering is completed"));break;case Oh.Jdn:b=r.messageContent;this.Whd=b.clientCorrelationId;this.C6!==b.appCorrelationId&&t.ULS.sendTraceTag(6403778,1303,15,this.rU("App correlation ID on client {0} does not match one on server {1}",this.C6,b.appCorrelationId));break;case Oh.Bdn:r.messageContent?(Z.a.Cj&&document.activeElement.blur(),this.lp.QVd(0,null,2,null,null),t.ULS.sendTraceTag(6604741,
1303,50,this.rU("Insights UX lost focus through Ctrl + Shift + F6"))):(this.lp.NSc(0,null,2,null,null),t.ULS.sendTraceTag(6604742,1303,50,this.rU("Insights UX lost focus through Ctrl + F6")));break;case Oh.ydn:r.messageContent.keyCode===se.a.YJa&&this.$oa();break;case Oh.zdn:try{this.ttd=!1,localStorage.setItem(Oh.cHi,"true")}catch(B){t.ULS.sendTraceTag(17961859,1303,10,this.rU("Failed to SetItem in LocalStorage for LegalAgreed"))}}}}C1l(){const b={anid:"00000000-0000-0000-0000-000000000000"};b.appCorrelationId=
this.C6;3===v.AFrameworkApplication.ua.Kb.yk?b.applicationName=Oh.j8o:4===v.AFrameworkApplication.ua.Kb.yk&&(b.applicationName=Oh.Cwn);b.applicationVersion=v.AFrameworkApplication.buildVersion;var h=lj.a.tg(v.AFrameworkApplication.lcid);h=h?h.name:null;b.market=OH(h);b.uiLanguage=h;b.sessionId=v.AFrameworkApplication.userSessionId;b.parentalControl=Oh.a0f;b.clientType="user";b.legalAgreed=this.M2l();b.defaultDefineTab=1===this.RRg?"true":null;return b}rU(b,...h){const r={};this.C6&&(r[Oh.Kyj]=this.C6);
this.Whd&&(r[Oh.RIo]=this.Whd);r[Oh.Lyj]=String.format.apply(null,[b].concat(h));return H.c(r)}fac(){return 5}M2l(){try{const b=localStorage.getItem(Oh.cHi);return!!b&&"true"===b}catch(b){return t.ULS.sendTraceTag(17961860,1303,10,this.rU("Failed to GetItem in LocalStorage for LegalAgreed")),!1}}Dob(b){b=H.c(b);this.gB.contentWindow.postMessage(b,ia.a.getOrigin(this.Bwc))}}$F.HSi="about:blank";Object(m.a)($F,"InsightsPane",XF,[]);class TL{constructor(){this.type="SmartLookupTaskPaneProps"}}Object(m.a)(TL,
"SmartLookupTaskPaneProps",null,[]);class UL{}Object(m.a)(UL,"ActionDescriptor",null,[]);class VL extends XF{constructor(b,h,r,B=null,P=null,ca=null,ra=!0,Qa=null,tb=null){super(h,r,B,P,ca,ra,Qa,tb);this.pVe=!!v.AFrameworkApplication.ua&&!!v.AFrameworkApplication.ua.Kb&&v.AFrameworkApplication.ua.Kb.BIf;this.Ws=this.eQe=!1;this.ebk=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxViewportWidthThreshold",1680);this.cbk=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxPaneWidth",
844);this.hbk=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumViewportWidthThreshold",1366);this.gbk=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumPaneWidth",700);ra||Xl.Uz("ReactSmartLookupPane - React SmartLookup pane constructed for legacy SmartLookup.",10);this.iCa=b;this.FZg=PH(this.nAb)}get isVisible(){return this.Ws}$Pb(b,h){this.ME=b;this.dMa=b=Object.assign(new UF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,
mentionLength:b.selection.mentionLength});this.Sxc=!b.mentionLength;this.C6=h;this.F8c(!1)}p2d(b){this.ME=b;this.bmc(Object.assign(new UF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),!1)}WP(b,h){this.C6=h;this.bmc(b,!0)}Dhg(b,h,r){this.ME=b;this.WP(Object.assign(new UF.a,{neighborhood:b.selection.neighborhood,mentionStart:b.selection.mentionStart,mentionLength:b.selection.mentionLength}),h,r)}$oa(){this.kea();this.iCa.hideTaskPane()}bmc(b,
h){kc.SessionStatusManager.instance.cD&&this.wfa?(this.dMa=b,this.Sxc=!b.mentionLength,b=window.performance.now(),this.initialize(),this.isVisible?v.AFrameworkApplication.K.$("SmartLookupDisableRefreshPaneIsEnabled")?(this.iCa.updateTaskPane(null),h&&this.Seo()):(h&&this.F8c(!1),this.eQe=!this.eQe,this.iCa.updateTaskPane(this.xA())):(h&&this.F8c(this.isVisible),this.iCa.showTaskPane(this.xA())),this.Gkc(b)):(this.iCa.showTaskPane(this.xA()),Xl.keo(kc.SessionStatusManager.instance.cD,!!this.wfa,this.ME?
XE[this.ME.entryPoint]:"",this.Kdb.URc(),v.AFrameworkApplication.z1e,this.Sxc))}Seo(){if(!this.ME){const b=Object.assign(new Gx.a,{neighborhood:this.dMa.neighborhood,mentionStart:this.dMa.mentionStart,mentionLength:this.dMa.mentionLength});this.ME=Object.assign(new Mt.a,{selection:b,userIntent:null,entryPoint:0,launchData:null})}this.F8c(this.isVisible)}ueo(){const b=new UL;b.transactionId=this.C6;b.actionType=15;b.channelId=Oh.channelId;this.Dob(b)}Jnb(b){const h=b.rawEvent;document.getElementById(Oh.lC)&&
h.source!==document.getElementById(Oh.lC).contentWindow||this.TPn(b)}TPn(b){const h=b.rawEvent;let r;try{r=H.b(h.data)}catch(B){t.ULS.sendTraceTag(545604257,1303,15,this.rU("Message data from Serplet [{0}] failed to deserialize.",h.data));return}switch(r.actionType){case 32:v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&(dc.a.qHb()>=this.ebk?this.iCa.updateTaskPane(this.ncf(this.cbk)):dc.a.qHb()>=this.hbk&&this.iCa.updateTaskPane(this.ncf(this.gbk)));
break;case 33:v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&this.iCa.updateTaskPane(this.ncf(r.data));break;case 42:this.iCa.updateTaskPane(this.vfl(r.data));break;case 43:this.iCa.updateTaskPane(this.xA());break;default:super.Jnb(b)}}dispose(){}initialize(){this.Q_();this.hka()}Q_(){this.iCa.UKc()}hka(){const b=this.Vb.fe(Oh.lC);b.parent=Dd.AFrame.Ap;b.eI=!0}$io(){this.Vb.mg(Oh.lC)}kea(){this.X4a()&&this.Vb.mg(this.Vb.gU)}g7f(){$addHandler(window,
"message",Object(z.a)(this,this.Jnb,"onIFrameMessage"))}Qog(){$removeHandler(window,"message",Object(z.a)(this,this.Jnb,"onIFrameMessage"))}X4a(){return!!this.Vb.currentScope&&this.Vb.currentScope.name===Oh.lC}Dob(b){b=H.c(b);document.getElementById(Oh.lC)&&document.getElementById(Oh.lC).contentWindow.postMessage(b,ia.a.getOrigin(this.FZg))}rU(b,...h){const r={};this.C6&&(r[Oh.Kyj]=this.C6);r[Oh.Lyj]=String.format.apply(null,[b].concat(h));return H.c(r)}fac(){return Hh.a("isSharedUXDarkModeOn")&&
appChrome.api.isSharedUXDarkModeOn()?3:0}gZi(){if(this.wfa)this.wfa.onPaneThemeChanged(this.fac());return Hh.a("getTheme")?appChrome.api.getTheme():null}Fkc(){}Pge(){document.getElementById(Oh.lC)&&pc.FocusManager.iK(document.getElementById(Oh.lC).contentWindow)}Hnb(){Xl.Uz("ReactSmartLookupPane - Iframe component failed to load.",10)}Inb(){v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableSerpletIFrameLoadHandler",!1)||window.navigator.onLine||Xl.Uz("ReactSmartLookupPane - Onload detected no network.",
50)}DWl(){return this.ME?10===this.ME.entryPoint?2===v.AFrameworkApplication.ua.Kb.yk?CommonUIStrings.l_ReuseSlidesPaneTitle:CommonUIStrings.l_ReuseFilesPaneTitle:18===this.ME.entryPoint?CommonUIStrings.l_FindInDocumentPaneTitle:37===this.ME.entryPoint?CommonUIStrings.l_SummarizePaneTitle:36===this.ME.entryPoint||38===this.ME.entryPoint?CommonUIStrings.l_ConvertToDeckPaneTitle:CommonUIStrings.L_SmartLookupPaneTitle:""}xA(){var b=CommonUIStrings.L_SmartLookupPaneTitle;v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletDynamicPaneTitle",
!1)&&(b=this.DWl());const h=new TL;h.src=this.FZg;h.id=Oh.lC;h.refreshPane=this.eQe;h.onError=Object(z.a)(this,this.Hnb,"onIFrameError");h.onLoad=Object(z.a)(this,this.Inb,"onIFrameLoad");h.title=b;kc.SessionStatusManager.instance.cD?this.wfa||(h.errorMessage=CommonUIStrings.l_SmartLookupPaneInitializationError,h.errorType=1):(h.errorMessage=CommonUIStrings.l_SmartLookupPaneNetworkDisconnected,h.errorType=0);b=Object.assign(new vm.a,{title:b,hideHeader:!1,width:Oh.width,location:Oh.Qzn,contentProps:h,
isModernPane:!0,onOpen:()=>{this.$io();this.Ws=!0;this.g7f();Hh.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(Object(z.a)(this,this.gZi,"onThemeIdChanged"));v.AFrameworkApplication.ua.updateCommandUI();if(this.wfa)this.wfa.onPaneStateChanged(!0)},onClose:()=>{this.ueo();this.kea();this.Ws=!1;this.Qog();Hh.a("removeOnThemeChangeCallback")&&appChrome.api.removeOnThemeChangeCallback(Object(z.a)(this,this.gZi,"onThemeIdChanged"));v.AFrameworkApplication.ua.updateCommandUI();
if(this.wfa)this.wfa.onPaneStateChanged(!1)}});this.pVe&&(b.enableResize=!0,b.minResizeWidth=320,b.maxResizeWidth=920);return b}vfl(b){const h=this.xA();h.title=b;h.contentProps.title=b;return h}ncf(b){const h=this.xA();h.resizeWidth=b;return h}}Object(m.a)(VL,"ReactSmartLookupPane",XF,[]);class XL{UKc(){const b=new vl.CuiHelper(Nd.a.V_a,WordEditorIntl.WordEditorStrings);return tn.a.instance.mOh(Oh.lC,Oh.Ghc,Oh.width,Oh.xlg,b)}showTaskPane(b){tn.a.instance.showTaskPane(b)}hideTaskPane(b){tn.a.instance.hideTaskPane(b)}d7b(b){tn.a.instance.d7b(Oh.lC,
b)}}Object(m.a)(XL,"WordInsightsPaneHandler",null,[274]);class YL{UKc(){tn.a.instance.UOa()}showTaskPane(b){al.UISurfaces.Nu().then(h=>{h.showTaskPane(Oh.lC,b);return null})}updateTaskPane(b=null){al.UISurfaces.Nu().then(h=>{h.setSelectedTaskPane(Oh.lC);b&&h.updateTaskPane(Oh.lC,b);return null})}hideTaskPane(){al.UISurfaces.Nu().then(b=>{b.hideTaskPane(Oh.lC,2);return null})}}Object(m.a)(YL,"WordReactSmartLookupPaneHandler",null,[273]);class ZL extends $E{constructor(b,h){super();this.Dx=b;this.hb=
h}qJd(){const b=!!v.AFrameworkApplication.ua&&!!v.AFrameworkApplication.ua.Kb&&v.AFrameworkApplication.K.$("SmartLookupEnableNativePane");return v.AFrameworkApplication.ua&&v.AFrameworkApplication.ua.Kb&&v.AFrameworkApplication.ua.Kb.tHf?new VL(new YL,Rp.a.instance,pc.FocusManager.instance(),Ma.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Ma.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),Ma.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),
b,Ma.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Ma.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper")):new $F(new XL,Rp.a.instance,pc.FocusManager.instance(),Ma.a.instance.resolve("Common.Utils.IAriaNotifier"),Ma.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),Ma.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),Ma.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),b,Ma.a.instance.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
Ma.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper"))}nGb(){return this.Dx.getSelectedText()}$ai(){if(!this.hb||!this.hb.ib||1>this.hb.ib.length)return null;var b=this.hb.ib.lb.Pa;b=null==b?null:pn.FormattingReader.Yr(b);return(b=null==b?null:lj.a.tg(pn.FormattingReader.language(b)))?b.name:""}I2a(){return this.Dx.wuf()}bbi(){return this.Dx.wuf()}rzi(){return this.Dx.JKm()}}Object(m.a)(ZL,"WordInsightsManager",$E,[]);var tN=c(215);class $L{}Object(m.a)($L,"CommandMetadataResponse",null,
[]);class kE{constructor(){this.qAf=this.getAllIcons()}executeCommand(){}executeCommandAsync(){return Promise.resolve(null)}openFeedbackPane(){}openSerpletTaskPane(){}sendAutoLaunchSearchRequest(){}openFindReplaceTaskPane(){}openFindReplaceTaskPaneV2(){}openFindTaskPane(){}openNavigationPane(){}closeNavigationPane(){}openPrivacySettings(){tN.PrivacyDialogManager.Qie()}browseFiles(){}getId(){return"SerpletExecutor"}getCommandMetadata(b){const h=new $L;b.iconNames&&(h.svgData=this.getCommandIconSvg(b.iconNames));
if(!b.commandId||""===b.commandId)return h.isVisible=!1,h;try{h.isVisible=Array.contains(appChrome.selectors.getVisibleControlIds(),b.commandId);h.isDisabled=appChrome.selectors.isControlDisabled(b.commandId);h.label=appChrome.selectors.getControlLabel(b.commandId);if(h.svgData&&""!==h.svgData)return h;const r=appChrome.selectors.getControlIconSet(b.commandId),B=Array(2);B[0]=r["default"];B[1]=r.icon32;h.svgData=this.getCommandIconSvg(B)}catch(r){return null}return h}getCommandIconSvg(b){if(!this.qAf)return"";
for(let h=0;h<b.length;h++){const r=b[h];if(r in this.qAf)return this.qAf[r]}return""}startSpeech(){return Promise.resolve(!1)}stopSpeech(){return Promise.resolve(!1)}getAllIcons(){return{}}createFeedbackPropertiesFromData(b){const h={SourceControlId:"GiveFeedback"};h.feedbackType="true"===b.IsPosFeedback?0:1;const r={};r.featureArea=kE.GBl;h.telemetryGroup=r;h.appData=b;return h}}kE.Eoi="FA000000012";kE.queryPrefix="AssetID=";kE.GBl="SearchPane";Object(m.a)(kE,"BaseSerpletExecutor",null,[275,276]);
class aM extends kE{constructor(b,h){super();this.ga=b;this.hb=h}executeCommand(b){if(!b)throw Error("Missing commandData argument");switch(b.CommandId){case 0:this.ga.Qb(Nb.a.HKb,2,null);break;case 1:this.ga.Qb(qb.a.kRb,2,null);break;case 2:this.ga.Qb(Nb.a.digitalPrintToSway,2,{SourceControlId:"Serplet"});break;default:throw Error(`Unknown commandId requested: ${b.CommandId}`);}}browseFiles(){this.ga.Qb(fb.a.MYd,2,null)}openHelpTaskPane(){}openFeedbackPane(b){this.ga.Qb(fb.a.SPb,2,this.createFeedbackPropertiesFromData(b))}openFindReplaceTaskPane(b){const h=
{};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Qb(fb.a.jlf,2,h)}openFindReplaceTaskPaneV2(b){b={CommandValueId:b.Query,MatchCase:b.MatchCase,MatchWholeWord:b.MatchWholeWordOnly};WH(this.hb);this.ga.Qb(fb.a.jlf,2,b)}openFindTaskPane(b){const h={};h.CommandValueId=b;h.SourceControlId="Insights";this.ga.Qb(fb.a.findInDocument,2,h)}openNavigationPane(){this.ga.Qb(qb.a.Ylc,2,null)}openSerpletTaskPane(){this.ga.Qb(fb.a.Yui,2,null)}sendAutoLaunchSearchRequest(){this.ga.Qb(fb.a.FYd,2,null)}getAllIcons(){const b=
{};for(const r of Object.keys(window))if(r.startsWith("word")){var h=window[r];h&&(h=h.icons,null!==h&&void 0!==h&&h.length&&h.forEach(B=>b[B.id]=JSON.stringify(B)))}return b}}Object(m.a)(aM,"WordSerpletExecutor",kE,[]);class bM extends RH{constructor(){super();this.zNe=null;this.Xx=()=>{v.AFrameworkApplication.E0&&(this.Vsl(),Jr.a.ml().then(()=>this.zNe.resolve("WordEditor.Insights.IAugloopSearchProviderManager")))}}get name(){return"WordEditor.Insights"}init(){v.AFrameworkApplication.E0&&(this.zNe.Oa("WordEditor.Insights.WordInsightsActor").Tb(),
v.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&v.AFrameworkApplication.K.$("DownloadSmartLookupRuntimeDuringPkgInitIsEnabled")?v.AFrameworkApplication.K.Nn(this.Xx):super.init())}wc(b){super.wc(b);this.zNe=b;b.ia("Box4.Insights.Box4InsightsSelection",()=>new Vq.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ha();b.ia("WordEditor.Insights.WordInsertContentExecutor",()=>new OL(v.AFrameworkApplication.va)).as("Common.App.SearchCommon.IInsertContentExecutor").ha();
b.ia("WordEditor.Insights.WordSerpletExecutor",()=>new aM(v.AFrameworkApplication.va,Bh.a.instance)).as("Common.App.SearchCommon.ISerpletExecutor").ha();b.ia("WordEditor.Insights.AugloopSearchProviderManager",()=>new WF(b.resolve("Common.App.Insights.IDocumentContentExtractionManager"))).as("WordEditor.Insights.IAugloopSearchProviderManager").ha();b.ia("WordEditor.Insights.WordDocumentContentExecutor",()=>{const h=new $v(new pf.a(()=>Eb.App.za?Eb.App.za.jb.Zc:null),b.resolve("Box4.IParagraphReader"),
DL.a.instance,v.AFrameworkApplication.K,Yf.a.instance,kN.a.instance,b.resolve("Box4.Search.IFindManagerHelper"),b.resolve("Common.Comments.ICommentModel"),v.AFrameworkApplication.va,Bh.a.instance,b.resolve("Box4.ISelectionFactory"));h.initialize();return new ML(new pf.a(()=>Eb.App.za?Eb.App.za.jb.Zc:null),b.resolve("Box4.IParagraphReader"),hb.InteractiveViewManager.instance,Bh.a.instance,b.resolve("Box4.ISelectionFactory"),h,Eb.App.si.Il.Ue(12),new pf.a(()=>Eb.App.za.jb),pc.FocusManager.instance(),
v.AFrameworkApplication.K,b.resolve("Common.Comments.ICommentModel"),b.resolve("Common.App.Insights.IInsightsSelection"),b.Ta("WordEditor.Insights.IAugloopSearchProviderManager"),b.Ta("Common.App.People.IExternalPeopleAPI"))}).as("Common.App.SearchCommon.IDocumentContentExecutor").ha();b.ia("WordEditor.Insights.WordInsightsManager",()=>new ZL(b.resolve("Common.App.Insights.IInsightsSelection"),b.resolve("Box4.ISelectionManager"))).as("Common.App.Insights.IInsightsManager").ha();b.ia("WordEditor.Insights.WordInsightsActor",
()=>new PL(b.Ve("Common.App.Insights.IInsightsManager"),v.AFrameworkApplication.va,v.AFrameworkApplication.K,b.Ta("WordEditor.Insights.IAugloopSearchProviderManager"),b.resolve("Common.App.SearchCommon.ISearchHelper"))).ha();b.ia("Common.App.SearchCommon.IDocumentHelper",()=>new NL(b.Ta("WordEditor.Extension.DocumentProperties"))).ha()}}Object(m.a)(bM,"WordInsightsPackage",RH,[]);class uN{}Object(m.a)(uN,"ScalingStep",null,[]);class cM{constructor(b,h,r){this.exc=!1;this.lQ=null;this.YDc=this.iYb=
!1;this.IZa=[];this.wee=B=>{this.yaa&&this.yaa!==B&&appChrome.api.dispatch(this.Ogi(!1))};h.execute(B=>{this.lQ=B});b.Ww(Object(z.a)(this,this.iun,"onProcessSetSelectionFinished"));this.rp=r}O$b(b,h,r){const B=[];for(const P of b)B.push(appChrome.actions.addScalingStepInTab("Home",{type:h,controlId:P},r));return B}jfi(b){const h=[];for(let r=0;4>r;r++)h.push(appChrome.actions.addScalingStepInTab("Home",{type:"DropPreviewItemFromGallery",controlId:b},2>r?0:void 0));h.push(appChrome.actions.addScalingStepInTab("Home",
{type:"GalleryToFlyout",controlId:b},void 0));return h}Ogi(b){const h=[];if(b)switch(this.yaa){case "Image":h.push(appChrome.actions.removeControlScalingStepsFromTab("TextAlignmentAnchor","Home"));h.push(...this.jfi("PictureStyles"));h.push(...this.O$b("RotatePictureMenu PictureBorders PictureStyles CropPictureMenu WrapTextMenu EditPictureAltText".split(" "),"DropLabel"));b=this.IZa.slice().reverse();b.push("TextAlignmentAnchor");h.push(...this.O$b(b,"MoveToOverflow"));break;case "Table":this.YDc||
h.push(...this.jfi("TableStyles"));h.push(...this.O$b(this.IZa,"DropLabel",this.YDc?0:void 0));b=this.IZa.slice().reverse();h.push(...this.O$b(b,"MoveToOverflow"));break;case "Hyperlink":h.push(...this.O$b(["EditHyperlink","RemoveHyperlink"],"DropLabel")),b=this.IZa.slice().reverse(),h.push(...this.O$b(b,"MoveToOverflow"))}else for(const r of this.IZa)h.push(appChrome.actions.removeControlScalingStepsFromTab(r,"Home"));return h}rdd(b){const h={};for(const r of b)try{h[r]=appChrome.selectors.getModelType(r)}catch(B){this.UG("Error",
"GetModelType failed for "+r)}Eb.App.za.HPd(h)}QTo(b){if(0!==b.length){var h=[],r={},B=!1;for(const P of b)try{if(appChrome.selectors.isControlDefined(P))r[P]=appChrome.selectors.getModelType(P);else{B=!0;break}}catch(ca){this.UG("Error","GetModelType failed for "+P);B=!0;break}if(B)this.yaa=void 0,this.boe(!1);else{if("Image"===this.yaa&&!this.iYb)h.push(appChrome.actions.updateGroupHiddenState("Font",!0)),this.iYb=!0;else if(this.iYb){h.push(appChrome.actions.updateGroupHiddenState("Font",!1));
B=appChrome.selectors.getVisibleControlsInGroup("Font");for(const P of B)r[P]=appChrome.selectors.getModelType(P);this.iYb=!1}Eb.App.za.HPd(r);this.IZa=b;r=[];for(const P of b)appChrome.selectors.isControlDisabled(P)&&r.push(P);0<r.length&&this.UG("Disabled",r.join(","));0<this.IZa.length&&(h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),h.push(appChrome.actions.updateControlsInGroup("Adaptive",this.IZa)),h.push(...this.Ogi(!0)),this.exc=!0);appChrome.api.dispatch(h)}}}boe(b){if(b||
this.exc){var h=[];h.push(appChrome.actions.updateGroupHiddenState("Adaptive",!b));this.exc=b;if("Image"===this.yaa||this.iYb){b=!b;h.push(appChrome.actions.updateGroupHiddenState("Font",!b));if(b){const r=appChrome.selectors.getVisibleControlsInGroup("Font");this.rdd(r)}this.iYb=!b}appChrome.api.dispatch(h)}}wVa(){this.exc&&this.rp&&this.rp.execute(b=>{b.logActivity("AdaptiveContextualGroupShown",null)})}iun(b,h){!v.AFrameworkApplication.ua.Kb.Klc&&"Home"===appChrome.selectors.getSelectedTabId()&&
this.lQ&&h.yl&&h.yl.lb&&0!==h.yl.length?(b=()=>{let r=[],B=!1;var P=this.lQ.contentType,ca=appChrome.selectors.getActiveContextualTabIds();P.includes("Image")?(this.wee("Image"),this.yaa&&"Image"===this.yaa?B=!0:(r="PictureStyles PictureBorders WrapTextMenu RotatePictureMenu CropPictureMenu PictureAbsoluteHeight PictureAbsoluteWidth LockAspectRatio EditPictureAltText FormatPictureOptions".split(" "),this.yaa="Image")):P.includes("Table")&&0<=ca.indexOf("Table")?(P=!(Gp.a.instance.lb.RGa||Gp.a.instance.lb.Pv||
Gp.a.instance.lb.Qlb),(ca="Table"===this.yaa&&P!==this.YDc)?this.wee("TableCellEdit"):this.wee("Table"),!this.yaa||"Table"!==this.yaa||ca?(P?(r=["SelectTableMenu","DeleteTableMenu","InsertTableMenu","AlignmentTableMenu"],this.YDc=!0):(r="SelectTableMenu DeleteTableMenu InsertTableMenu AlignmentTableMenu MergeCells SplitCells TableDistributeMenu TableStyles ChangeColorsTable StyleOptionsTableMenu CellShading EditTableAltText BorderGallery TableBorderColor".split(" "),this.YDc=!1),this.yaa="Table"):
B=!0):P.includes("Hyperlink")&&(this.wee("Hyperlink"),this.yaa&&"Hyperlink"===this.yaa?B=!0:(r=["EditHyperlink","RemoveHyperlink","CopyHyperlink","OpenHyperlink"],this.yaa="Hyperlink"));B?this.exc||(this.rdd(this.IZa),this.boe(!0),this.wVa()):0<r.length?(this.QTo(r),this.wVa()):this.boe(!1)},"requestIdleCallback"in window?window.requestIdleCallback(b):window.requestAnimationFrame(b)):this.boe(!1)}UG(b,h){b={Time:(new Date).getTime(),Event:b,Message:h,Scenario:"AdaptiveTabGroup"};h=new Uh.a;h.name=
"Events";h.dataFields=xj.a.oJ(b);h.durationMs=window.performance.now();ea.a.FIa(h,"TellMeWAC.")}}Object(m.a)(cM,"AdaptiveTabGroupUpdater",null,[]);class dM{constructor(){this.W=null;this.jln=()=>{v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableAdaptiveTabGroupUpdater",!1)&&(this.W.ia("WordEditor.UI.AdaptiveTabGroupUpdater",()=>new cM(this.W.resolve("Box4.ISelectionManager"),this.W.Ta("Common.IActionContextProvider"),this.W.Ta("Common.ISystemInitiatedFeedback"))).ha(),
this.W.resolve("WordEditor.UI.AdaptiveTabGroupUpdater"))}}get name(){return"WordEditor.RibbonIntelligence"}wc(b){this.W=b}init(){ED.a(1,this.jln)}dispose(){}}Object(m.a)(dM,"PackageManager",null,[1,2]);const vN=(b,h,r)=>1===r?32:2===r?(c.e(4).then(c.bind(null,2092)).then(B=>{B.createAndShowDevToolsMenu()}),32):2;class XH{constructor(){this.name="WordEditor.DevTools"}init(){if(window.g_wordDevToolsIsEnabled||v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DevToolsIsEnabled",
!1))v.AFrameworkApplication.va.ra(qb.a.dhg,yd.a.frame,vN),null!==sessionStorage.getItem("devToolsRefresh")&&c.e(4).then(c.bind(null,2092))}dispose(){}wc(){}static main(){L.a.instance.Gc(new XH)}}Object(m.a)(XH,"WordDevToolsPackage",null,[1,2]);c(585);class YH{constructor(){this.underline=this.strikethrough=this.italic=this.highlight=this.fontColor=this.bold=null}}Object(m.a)(YH,"FormattingData",null,[]);class eM extends YH{constructor(){super();this.hyperlinkData=null}}Object(m.a)(eM,"RichContentCommandData",
YH,[]);class Gi{constructor(){Gi.aj.add(qb.a.E8a);Gi.aj.add(qb.a.FRb);Gi.aj.add(qb.a.Smc);Gi.aj.add(qb.a.LV);Gi.aj.add(qb.a.ETf);Gi.aj.add(qb.a.C2f);Gi.aj.add(qb.a.deleteComment);Gi.aj.add(qb.a.ALc);Gi.aj.add(qb.a.qef);Gi.aj.add(qb.a.jje);Gi.aj.add(qb.a.R8a);Gi.aj.add(qb.a.dhg);Gi.aj.add(qb.a.kRb);Gi.aj.add(qb.a.khg);Gi.aj.add(qb.a.BMc);Gi.aj.add(qb.a.bMd);Gi.aj.add(Nb.a.digitalPrintToSway);Gi.aj.add(Nb.a.openInClient);Gi.aj.add(Nb.a.print);Gi.aj.add(Nb.a.ebe);Gi.aj.add(Nb.a.W4f);Gi.aj.add(Nb.a.readingMode);
Gi.aj.add(Nb.a.HKb);Gi.aj.add(fb.a.bAj);Gi.aj.add(fb.a.tellMe);Gi.aj.add(fb.a.Hbd);Gi.aj.add(fb.a.SPb);Gi.aj.add(fb.a.giveFeedback);Gi.aj.add(fb.a.R$c);Gi.aj.add(fb.a.Xgg);Gi.aj.add(fb.a.lsg);Gi.aj.add(fb.a.V8);Gi.aj.add(fb.a.qHa);Gi.aj.add(fb.a.Y8e);Gi.aj.add(fb.a.bSa);Gi.aj.add(fb.a.M9f);Gi.aj.add(fb.a.L9f);Gi.aj.add(fb.a.N9f);Gi.aj.add(fb.a.pLd);Gi.aj.add(fb.a.Rma);Gi.aj.add(fb.a.yje);Gi.aj.add(fb.a.jsj);Gi.aj.add(fb.a.close);Gi.aj.add(fb.a.Ybe);Gi.aj.add(fb.a.mbe);Gi.aj.add(fb.a.v9d);Gi.aj.add(fb.a.sje);
Gi.aj.add(fb.a.xje);Gi.aj.add(fb.a.WNb);Gi.aj.add(fb.a.renameFile);Gi.aj.add(fb.a.Fbc);Gi.aj.add(fb.a.Khg);Gi.aj.add(fb.a.emc);Gi.aj.add(fb.a.downloadACopy);Gi.aj.add(fb.a.pkc);Gi.aj.add(fb.a.jae);Gi.aj.add(fb.a.AOb);Gi.aj.add(fb.a.m6i);Gi.aj.add(fb.a.mGh);Gi.aj.add(fb.a.PGd);Gi.aj.add(fb.a.X8e);Gi.aj.add(fb.a.oGh);Gi.aj.add(fb.a.nGh);Gi.aj.add(fb.a.Y8e);Gi.aj.add(fb.a.QGd);Gi.aj.add(qb.a.sqe);Gi.aj.add(qb.a.ctg);Gi.aj.add(qb.a.zoomToPageWidth);Gi.aj.add(qb.a.Nbg);Gi.aj.add(qb.a.Nob);Gi.aj.add(qb.a.qce);
Gi.aj.add(qb.a.Jka);Gi.aj.add(fb.a.vkb);Gi.aj.add(fb.a.Wgb);Gi.aj.add(fb.a.hmc);Gi.aj.add(fb.a.tMj);Gi.aj.add(fb.a.t6i);Gi.aj.add(qb.a.E5c);Gi.aj.add(Nb.a.HNb);Gi.aj.add(Nb.a.gja)}}Gi.aj=new Set;Object(m.a)(Gi,"CommentRibbonCommands",null,[]);class fM{constructor(b,h,r,B,P){this.YRi=b;this.Ch=h;this.Go=r;this.pl=B;this.gKo=P;this.H_b=null;this.QAa=new Ng.a(0);this.itb=new Ng.a(0);this.Tue=new Ng.a(0);this.oXe=!1;this.wAm();this.UXn()}KJm(b){return this.H_b&&this.Go.Qx?!Gi.aj.has(b):!1}tac(b,h,r){if(b===
fb.a.Kg)return 32;if(!this.QAa.nb(b)&&!this.itb.nb(b)||!this.H_b)return 2;const B=this.itb.nb(b);var P=B?this.itb.J(b):this.QAa.J(b);const ca=B?2:this.Tue.J(r);B||1!==ca||(this.nNm(Eb.App.za.Hp.currentScope.name)||Eb.App.za.Hp.mg(this.Ch.Bm?Dd.AFrame.Ur:Dd.AFrame.JM),Eb.App.za.updateCommandUI(!0));r=new eM;switch(P){case 1:r.highlight={color:this.Mfi(h.Color)};break;case 6:r.fontColor={color:this.Mfi(h.Color)}}P=this.H_b.executeCommand(P,ca,r);2===P&&B&&(b===Nb.a.Gic?h[qg.a.On]=!!r.bold:b===Nb.a.Mic?
h[qg.a.On]=!!r.italic:b===Nb.a.Vic?h[qg.a.On]=!!r.underline:b===Nb.a.Pic?h[qg.a.On]=!!r.strikethrough:b===Nb.a.lZ?h[qg.a.On]=!!r.highlight:b===Nb.a.Yv&&(h[qg.a.On]=!!r.fontColor));return 2===P?32:1===P?2:8}ZUn(b){this.H_b=b;this.H_b.registerSelectionChangeHandler(()=>{this.oXe||(this.oXe=!0,Eb.App.za.updateCommandUI(!0),this.oXe=!1)});this.H_b.registerKeypressHandler(h=>{if(h.shortKey)switch(h.key){case se.a.cUb:case se.a.Fsb:case se.a.bse:case se.a.iWa:Eb.App.za.updateCommandUI(!0)}h.key!==se.a.qC&&
h.key!==se.a.k2||Eb.App.za.updateCommandUI(!0)})}UXn(){this.YRi.f$i(Dd.AFrame.Ur,this);this.YRi.f$i(Dd.AFrame.JM,this)}wAm(){this.QAa.Z(Nb.a.bold,0);this.QAa.Z(Nb.a.az,3);this.QAa.Z(Nb.a.strikethrough,4);this.QAa.Z(Nb.a.underline,5);this.QAa.Z(Nb.a.lZ,1);this.QAa.Z(Nb.a.fva,1);this.QAa.Z(Nb.a.Yv,6);this.QAa.Z(Nb.a.Jga,6);this.QAa.Z(Nb.a.sra,6);this.itb.Z(Nb.a.Gic,0);this.itb.Z(Nb.a.Mic,3);this.itb.Z(Nb.a.Pic,4);this.itb.Z(Nb.a.Vic,5);this.Tue.Z(1,0);this.Tue.Z(2,1)}nNm(b){return b===Dd.AFrame.Ur||
b===Dd.AFrame.JM}Mfi(b){return b?Wi.a.eF(this.gKo.nva(this.pl.ed,b)):""}}Object(m.a)(fM,"CommentRibbonCommandHandler",null,[339,340]);class ZH{constructor(){this.W=null}get name(){return"WordEditor.CommentsRibbonHandler"}init(){this.W.resolve("WordEditor.Comments.ICommentRibbonCommandHandler");this.W.resolve("WordEditor.Comments.CommentsState").E5f?this.W.resolve("WordEditor.Comments.CommentRibbonCommands"):this.W.resolve("WordEditor.Comments.WordCommentEventsActor").u$("OnCommentRenderedOnce",()=>
{this.W.resolve("WordEditor.Comments.CommentRibbonCommands")})}dispose(){}wc(b){this.W=b;this.W.ia("WordEditor.Comments.CommentRibbonCommandHandler",()=>new fM(this.W.Oa("Common.INonCanvasCuiUser"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("Common.Comments.ICommentModel"),ub.App.nn.jb.rc,qi.a.instance)).as("WordEditor.Comments.ICommentRibbonCommandHandler").ha();this.W.ia("WordEditor.Comments.CommentRibbonCommands",()=>new Gi).ha()}static main(){L.a.instance.Gc(new ZH)}}Object(m.a)(ZH,
"PackageManager",null,[1,2]);var wN=c(1983);class aG{constructor(b,h){this.bjl=2E3;this.wnh=null;this.O_f=b.K0i;this.maxLength=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MaxCanvasContextChars",this.bjl);h&&h.execute(r=>{this.wnh=r})}Qof(b){b=this.zQl(b,this.maxLength);return{semantic:da.ObjectSemantic.CanvasContext,type:da.ObjectSchemaType.WordCanvasContext,value:b}}zQl(b,h){try{return this.yQl(b,h)}catch(r){return t.ULS.sendTraceTag(522725067,1303,15,"Error processing selection for Canvas Context: {0}",
r),null}}Xdm(b,h){const r={F1a:[],rya:0,selection:{start:null,end:null},cursor:null,tiles:[]},B=b.length;for(let ca=0;ca<B;ca++){const ra=b.J(ca);var P=ra.node;if(!ke.ParagraphReader.Xb(P)||Array.contains(r.F1a,P.Vk))continue;r.F1a.push(P.Vk);const Qa=ke.ParagraphReader.textLength(P);if(r.rya+Qa>h)break;P=this.O_f.TCb(P);r.tiles.push(P);r.rya+=Qa;1!==B||r.cursor||(r.cursor=aG.NUl(ra,r.tiles.length-1));null===r.selection.start&&0===ca&&(r.selection.start=this.lji(ra,!0,r.tiles.length-1));null===r.selection.end&&
ca===B-1&&(r.selection.end=this.lji(ra,!1,r.tiles.length-1))}return r}P5l(b,h,r){const B={Wbd:[],Fzj:[],rya:0};var P=b.J(0).node;let ca=b.J(b.length-1).node;for(b=h;0<b&&(P||ca);){var ra=aG.Y4i(P,!0,b,r);if(P=ra.node)P=this.O_f.TCb(P),B.Wbd.push(P),b-=ra.rya,P=ra.node,r=ra.F1a;ra=aG.Y4i(ca,!1,b,r);if(ca=ra.node)r=this.O_f.TCb(ca),B.Fzj.push(r),b-=ra.rya,ca=ra.node,r=ra.F1a}B.rya=h-b;return B}AQl(b,h){let r=0;var B=this.Xdm(b,h);const P={tiles:B.tiles,selection:B.selection,cursor:B.cursor};r+=B.rya;
B=B.F1a;r<h&&(b=this.P5l(b,h-r,B),P.tiles.unshift.apply(P.tiles,b.Wbd),P.tiles.push.apply(P.tiles,b.Fzj),P.selection.start&&(P.selection.start.index+=b.Wbd.length),P.selection.end&&(P.selection.end.index+=b.Wbd.length),P.cursor&&(P.cursor.index+=b.Wbd.length));return P}yQl(b,h){var r;if(!b)return null;b=this.AQl(b,h);return{contentType:null===(r=this.wnh)||void 0===r?void 0:r.contentType,formattedContext:b.tiles,selection:b.selection,cursor:b.cursor}}lji(b,h,r){if(b.contextId===yc.a.Fd||b.contextId===
yc.a.paragraph||b.contextId===yc.a.Uc){if(h&&-1!==b.Wj)return{index:r,offset:b.Wj};if(!h&&-1!==b.vp)return{index:r,offset:b.vp}}return null}static NUl(b,h){return b.contextId===yc.a.Uc?{index:h,offset:b.Wj}:null}static Y4i(b,h,r,B){B={node:null,rya:0,F1a:B};if(!b||0>=r||!B.F1a)return B;do B.node=ke.ParagraphReader.Xf(b,h,!1,!1),B.rya=B.node?ke.ParagraphReader.textLength(B.node):0,b=B.node;while(B.node&&(Array.contains(B.F1a,B.node.Vk)||!ke.ParagraphReader.Xb(B.node)||!B.rya));B.node&&(B.rya>r?B.node=
null:B.F1a.push(B.node.Vk));return B}}Object(m.a)(aG,"Box4CanvasContextProvider",null,[234]);class $H{get name(){return"Box4.CanvasContext"}init(){}dispose(){}wc(b){b.ia("Box4.CanvasContext.Box4CanvasContextProvider",()=>new aG(b.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),b.Ta("Common.IActionContextProvider"))).as("Box4.CanvasContext.ICanvasContextProvider").ha()}static main(){L.a.instance.Gc(new $H)}}Object(m.a)($H,"Box4CanvasContextPackage",null,[1,2]);class gM{constructor(b,h,
r,B){this.FI={};this.U1b=this.qwd=0;this.AKd=3E4;this.start=()=>{0!=this.vAb.size&&0===this.U1b&&(this.U1b=window.setInterval(this.N$n,this.AKd),t.ULS.sendTraceTag(509215365,306,50,"Starting watchdog task"))};this.N$n=()=>{if(0!=this.vAb.size)if(this.rf.Jo)t.ULS.sendTraceTag(520974675,306,50,"Session has been kicked out"),this.stop();else{var P=50;this.FI.ScanTime=Date.now();this.FI.NumWatchDogs=this.vAb.size;this.FI.WatchDogManagerScanNumber=++this.qwd;this.vAb.forEach(async(ca,ra)=>{this.FI[ra]=
await ca.Ken();this.EPm&&"KickoutComponent"==this.FI[ra].ComponentStatus&&this.NJf(this.mXl(ra));ca.SXm()||(P=15)});t.ULS.sendTraceTag(520974674,306,P,JSON.stringify(this.FI))}};this.rf=b;this.M_b=r;this.e_=B;this.pYe=new Map;this.vAb=new Map;h.execute(P=>{this.am=P;this.am.B_a((ca,ra)=>{this.jY(ra)})})}jY(b){2!==b.oldState&&3!==b.oldState||1!==b.newState&&0!==b.newState?2!==b.newState&&3!==b.newState||0===this.U1b||(t.ULS.sendTraceTag(509215698,306,50,"WatchDogManager stopping for {0}",b.newState),
this.stop()):(this.stop(),this.start(),this.c7n(),t.ULS.sendTraceTag(509219479,306,50,"WatchDogManager returning from {0} to {1}",b.oldState,b.newState))}stop(){0!==this.U1b&&(window.clearInterval(this.U1b),this.U1b=0);t.ULS.sendTraceTag(509215696,306,50,"Stopping watchdog task")}yvk(b,h){this.pYe.set(b,h)}F7n(){this.lGn(this.pYe)}get RBk(){return this.pYe.size===this.vAb.size}lGn(b){b.forEach((h,r)=>{h.execute(B=>{B?(this.vAb.set(r,B),this.start()):t.ULS.sendTraceTag(512550848,306,10,"WatchDog {0} resolved to null",
r)})})}c7n(){this.vAb.forEach(b=>{b&&b.pza()});t.ULS.sendTraceTag(509138259,306,50,"WatchDogs reset")}NJf(b){0<this.M_b.zVa&&this.e_.Gec(b)}mXl(b){return"WordEditor.RunawayDataLossMonitorWatchDog"==b?hh.a.l8o:"WordEditor.LastSavedToHostDetailsManagerWatchDog"==b?hh.a.k8o:null}get EPm(){return null!=this.CDg?this.CDg:this.CDg=v.AFrameworkApplication.K&&v.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.KickoutEnabledFromWatchDogs",!1)}}Object(m.a)(gM,"WatchDogManager",null,
[235]);class aI{constructor(){this.W=this.uAb=null}get name(){return"Box4.WatchDogManager.WatchDogManager"}init(){this.uAb=this.W.resolve(this.name);this.wCm()}dispose(){this.uAb&&this.uAb.stop()}wc(b){this.W=b;b.ia(this.name,this.hgl.bind(this)).as("Box4.WatchDogManager.IWatchDogManager").ha()}static main(){L.a.instance.Gc(new aI)}Y2o(){if(!this.uAb.RBk){const b=[];let h=0;this.lwd.forEach((r,B)=>{r&&(this.W.Oa(B)||(b[h++]=B))});if(0<b.length){const r=!this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager").XU;
t.ULS.sendTraceTag(508965916,306,10,"{0} did not resolve. HasDataLoss: {1}",b,r)}}}hgl(){return new gM(this.W.resolve("Common.ISessionStatus")||kc.SessionStatusManager.instance,this.W.Ta("Common.App.VisibilityManagement.IVisibilityManager"),this.W.resolve("Box4.Revision.RevisionSequenceNumberManager"),this.W.resolve("Wonca.KickoutExecutor"))}rwk(){window.setTimeout(this.Y2o.bind(this),this.r4o)}ywk(){this.lwd=new Map;this.lwd.set("WordEditor.RunawayDataLossMonitorWatchDog",Eb.App.Dm||Eb.App.Fs);this.lwd.set("WordEditor.LastSavedToHostDetailsManagerWatchDog",
!0)}wCm(){this.ywk();this.xwk(this.lwd,this.uAb.yvk.bind(this.uAb));this.uAb.F7n();this.rwk()}xwk(b,h){b.forEach((r,B)=>{r&&h(B,this.W.Ta(B))})}get r4o(){return null!=this.GKg?this.GKg:this.GKg=v.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.WatchdogResolveIntervalMs",3E5)}}Object(m.a)(aI,"WatchDogManagerPackage",null,[1,2]);Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");Type.registerNamespace("CommandUI.Controls.SearchBoxComponents");Type.registerNamespace("CommandUI.React");
Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");Type.registerNamespace("B4AuC");Type.registerNamespace("B4CS");Type.registerNamespace("B4IE");Type.registerNamespace("B4Im");Type.registerNamespace("B4Intent");Type.registerNamespace("B4LE");Type.registerNamespace("B4NLE");Type.registerNamespace("B4OLE");Type.registerNamespace("B4S");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TaE");Type.registerNamespace("B4UI");Type.registerNamespace("B4Up");Type.registerNamespace("Box3");
Type.registerNamespace("Box4.AtMentions");Type.registerNamespace("Box4.AugmentationLoop");Type.registerNamespace("Box4.AugmentationLoop.TilingSchema");Type.registerNamespace("Box4.ClipArt");Type.registerNamespace("Box4.Clipboard");Type.registerNamespace("Box4.Insights");Type.registerNamespace("Box4.ListMarker");Type.registerNamespace("Box4.ListMarkerGallery");Type.registerNamespace("Box4.Media");Type.registerNamespace("Box4.Proofing");Type.registerNamespace("Box4.TaskPaneManager");Type.registerNamespace("Box4.WorkerShared");
Type.registerNamespace("Box4.Workers");Type.registerNamespace("CanvasAtMentions");Type.registerNamespace("Common.App.CatchUpActivity");Type.registerNamespace("GC2");Type.registerNamespace("PUTSOMETHINGHERE");Type.registerNamespace("WEAc");Type.registerNamespace("WEB");Type.registerNamespace("WECX");Type.registerNamespace("WEDCE");Type.registerNamespace("WEIE");Type.registerNamespace("WEIL");Type.registerNamespace("WELE");Type.registerNamespace("WENLE");Type.registerNamespace("WEOLE");Type.registerNamespace("WETaE");
Type.registerNamespace("WEUI");Type.registerNamespace("Wac.Common");Type.registerNamespace("Wac.Common.Actors");Type.registerNamespace("Wac.Common.SendUsYourFile");Type.registerNamespace("Wonca.UI");Type.registerNamespace("WordEditor.AtMentions");Type.registerNamespace("WordEditor.CanvasContextualProvider");Type.registerNamespace("WordEditor.CatchUpActivity");Type.registerNamespace("WordEditor.CatchUpActivity.NetworkShared");Type.registerNamespace("WordEditor.ContextualSearch");Type.registerNamespace("WordEditor.CritiqueCounts");
Type.registerNamespace("WordEditor.Designer.Common");Type.registerNamespace("WordEditor.Designer.Common.AL");Type.registerNamespace("WordEditor.Designer.Common.Conditions");Type.registerNamespace("WordEditor.Designer.Common.Review");Type.registerNamespace("WordEditor.DocumentUnderstanding.RLM");Type.registerNamespace("WordEditor.Embed");Type.registerNamespace("WordEditor.FindReplace");Type.registerNamespace("WordEditor.FootnoteEndnote");Type.registerNamespace("WordEditor.FootnoteEndnoteInteractive");
Type.registerNamespace("WordEditor.Goals");Type.registerNamespace("WordEditor.GraphicsEditor");Type.registerNamespace("WordEditor.HeaderFooter");Type.registerNamespace("WordEditor.Insights");Type.registerNamespace("WordEditor.IntelligentPlaceholder");Type.registerNamespace("WordEditor.RibbonIntelligence");Type.registerNamespace("WordEditor.Ruler");Type.registerNamespace("WordEditor.SendUsYourFile");Type.registerNamespace("WordEditor.SignalAggregator");Type.registerNamespace("WordEditor.TableStyle");
Type.registerNamespace("WordEditor.TaskPaneManager");Type.registerNamespace("WordEditor.Tasks");Type.registerNamespace("WordEditor.WordCount");Type.registerNamespace("WordEditor.WorkerShared");Type.registerNamespace("WordEditor.Workers");Type.registerNamespace("Common.App.AccountSwitching");R.main();Type.registerNamespace("Common.App.WopiIdentity");sa.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");Ub.main();Object(wN.a)(!1);bb.main();Va.main();
Qb.main();XH.main();Type.registerNamespace("Common.App.AccessibilityHelpDialog");Type.registerNamespace("Common.App.ActivityAggregator");bd.main();Type.registerNamespace("Common.App.AltTextDialog");Type.registerNamespace("Common.App.ChromeExtensionHelper");Type.registerNamespace("Common.App.CommandUIActors");Type.registerNamespace("Common");gf.main();Type.registerNamespace("Common.App.WildFire");fc.main();Type.registerNamespace("Common.App.BrowserInfoLogger");hd.main();Type.registerNamespace("Common.App.HostNotification");
Gb.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.FloatPane");Zh.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");Type.registerNamespace("Common.App.LivePersonaUtils");Cg.main();Type.registerNamespace("CNT");Hm.main();Type.registerNamespace("Common.App.NewAndOpen.Core");L.a.instance.Gc(new zk);Type.registerNamespace("Common.App.NewAndOpen.UX");L.a.instance.Gc(new rm);Type.registerNamespace("Common.App.OneDriveFilePickerApi");
rk.main();Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SafeLinks");Type.registerNamespace("Common.App.SafeLinks");ne.main();Type.registerNamespace("Common.Search");Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");ge.main();Type.registerNamespace("Common.App.TaskPaneManager");Type.registerNamespace("CAUI");Ca.main();Type.registerNamespace("CADWLTR");zb.main();Type.registerNamespace("Common.App.DirectPrint");
L.a.instance.Gc(new ak);Type.registerNamespace("Common.App.SearchOAuthManager");ti.main();Nk.main();bk.main();wn.main();Yo.main();hj.main();L.a.instance.Gc(new Yi);th.main();sb.main();Kh.main();L.a.instance.Gc(new kk);Type.registerNamespace("Common.App.SaveStatus");L.a.instance.Gc(new yl);Type.registerNamespace("Common.App.EventsCacheManager");Wn.main();Type.registerNamespace("CUIB");fn.main();Type.registerNamespace("CommandUI.TaskPane");try{L.a.instance.Gc(new Tw(Eb.App.za.jb))}catch(b){t.ULS.shipAssertTag(575930383,
3016,!1,b.message)}Qp.main();Type.registerNamespace("Common.App.Insights");Tl;L.a.instance.Gc(new mo);Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.AugmentationLoop");Type.registerNamespace("Common.App.CommentsSmartReply");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AugmentationLoop.SDX");bm("Begin");L.a.instance.Gc(new Ox);try{L.a.instance.Gc(new tt(ij.a.get_instance(),Eb.App.za.jb,Eb.App.za.Kb))}catch(b){t.ULS.shipAssertTag(575930384,
3016,!1,b.message)}Aa.main();L.a.instance.Gc(new pb);er.main();Ou.main();fr.main();Qu.main();Ds.main();Hy.main();yq.main();UB.main();L.a.instance.Gc(new $x);ay.main();Jl.main();Vz.main();Kv.main();$H.main();ZH.main();L.a.instance.Gc(new Rd);L.a.instance.Gc(new YB);Lr.main();Mv.main();Oq.main();L.a.instance.Gc(new fC);L.a.instance.Gc(new hC);iC;Hw.main();ux.main();Cq.main();Ge.main();Df;L.a.instance.Gc(new Ud);L.a.instance.Gc(new T);Rb.main();qB.main();rE.main();L.a.instance.Gc(new lv);L.a.instance.Gc(new mF);
Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=zz;Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");wB.main();KD.main();AE.main();iG;nH.main();EM;window.MSOJS=wD;JH.main();MH.main();L.a.instance.Gc(new bM);L.a.instance.Gc(new dM);(async()=>{v.AFrameworkApplication.K.$("WPMPackageIsEnabled")&&await c.e(28).then(c.bind(null,2103)).then(b=>{b.initializeOnDemandPackage()})})();
aI.main();Co.main()},2111:function(D,I,c){D=c(0);var l=c(7),e=c(1637);class a{static get xbn(){return 50}static LTd(x){if(""===x)return"";let y=0,m="";try{const t=e.a.aGb(x);for(const z of t.ops)if(a.PG(z))y||(m+=a.zYl(z.attributes.atmention.fullName)),y+=1;else{const v=z.insert?z.insert:"";" "!==v&&0<v.length&&(y=0,m+=v)}}catch(t){l.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return m}static ySl(x){x=a.LTd(x);return 0<
x.length&&x.split(" ").length<=a.xbn?x:null}static zYl(x){let y="";x&&(x=x.split(" "),0<x.length&&(y=x[0]));return y}static PG(x){return!!x.attributes&&!!x.attributes.atmention}}Object(D.a)(a,"BaseCommentSmartReplyHelpers",null,[]);c.d(I,"a",function(){return k});class k extends a{constructor(){super()}static RFb(x,y,m=!1){if(!x)return null;x=x.text&&0<x.text.length?x.text[0]:"";y=!y||!y.Df||""===y.Df;return 0<x.length&&y&&!m?a.ySl(x):null}}Object(D.a)(k,"CommentSmartReplyHelpers",a,[])},959:function(D,
I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.method=this.api=0}}Object(D.a)(l,"Message",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/20308609/wdjs/WordEditorDSVersionHistoryRemoved.box4.dll1.js.map