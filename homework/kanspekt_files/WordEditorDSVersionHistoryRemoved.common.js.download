/*
 Microsoft Corporation. All rights reserved.
*/
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1513:function(D,I,c){c.d(I,"a",function(){return m});D=c(0);var l=c(2),e=c(1996),a=c(57),k=c(7),x=c(1645),y=c(1604);class m{static bKa(t,z){t||(k.ULS.sendTraceTag(16795331,369,10,"The {0} root node should not be null.",z),m.Tf())}static ipc(t,z){t&&t.count||(k.ULS.sendTraceTag(16795332,369,10,"The list of {0} objects should not be null or empty.",z),m.Tf())}static o2(t,z){m.bKa(t,z);t.isConnected||(k.ULS.sendTraceTag(16795333,
369,15,"The accessed node is no longer connected to the graph in class: {0}.",z),m.Uk())}static fy(t,z){null===t&&(k.ULS.sendTraceTag(16847773,369,10,"The {0} value should not be null.",z),m.od())}static jpc(t,z){t&&""!==t||(k.ULS.sendTraceTag(17056035,369,10,"The {0} value should not be null or empty.",z),m.od())}static OVa(t,z){if(null===t||0>=t)k.ULS.sendTraceTag(17040545,369,10,"{0} is with not supported value: {1}.",z,t),m.od()}static NVa(t,z){if(null===t||0>t)k.ULS.sendTraceTag(20534342,369,
10,"Set {0} with not supported value: {1}.",z,t),m.od()}static hQ(t){if("number"===typeof t)return t;m.od();return 0}static $Ja(t,z,v){m.jpc(t,z);var H=e.a.yva(t);H=""!==H?H:t;"#"!==H.charAt(0)&&(H="#"+H);let F=!1;if(7>H.length)F=!0;else for(let G=1;7>G;G++){const M=H.charAt(G);if(!("0"<=M&&"9">=M||"A"<=M&&"F">=M||"a"<=M&&"f">=M)){F=!0;break}}if(F)throw k.ULS.sendTraceTag(19240924,369,15,"AppId:{0}, Set {1} with not supported argument: {2}.",v.appId,z,t),OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.invalidArgument,
WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_InvalidArgument);return m.VGn(H)}static VGn(t){return t.substring(5,7)+t.substring(3,5)+t.substring(1,3)}static ZM(t,z,v=0,H=!0){k.ULS.sendTraceTag(17576160,369,50,"{0}",{["MethodName"]:t,["BlobSize"]:v,["Latency"]:z,["ExecutionStatus"]:H})}static BN(t){return(new Date).getTime()-t}static Tf(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.generalException,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_GeneralException);}static od(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.invalidArgument,
WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_InvalidArgument);}static Ak(t=""){if("Getter"!==t)throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.notImplemented,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_NotImplemented);}static qrb(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.GAb,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_AccessDenied);}static Uk(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.uYm,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_ItemNotFound);
}static vmg(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.notSupported,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_NotSupported);}static Gnc(t,z,v="",H=""){t="AppId:"+t+",";t=(""!==v?t+("Property"+v):t+"Method")+(":"+z+", currently is not allowed on Word Wac");""!==H&&(t+=" for Parameter:"+H);k.ULS.sendTraceTag(19415938,369,15,t);"Getter"!==v&&m.qD()}static qD(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.notAllowed,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_NotAllowed);
}static nKo(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(y.a.Jxn,WordEditorIntl.WordEditorStrings.L_RichAPIErrorMsg_OperationCancelled);}static Ai(){return l.AFrameworkApplication.K.$("WordEditorExtensionRichApi_1_3_Enabled")}static Ped(){return l.AFrameworkApplication.K.$("WordEditorContentControlUserEditingIsEnabled")}static Upe(){return l.AFrameworkApplication.K.$("WordEditorContentControlInlineBlockConversionIsEnabled")}static get AAa(){return a.a.k1f}static aKc(t){t=(t||
"").replace(RegExp("\\r","g"),"\\r");t=t.replace(RegExp("\\n","g"),"\\n");return t=t.replace(RegExp("\\v","g"),"\\v")}static umc(t){return t.split(RegExp("\r\n|\r|\n"))}static a9i(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RefactorFontEnabled",!1)}static G6f(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RefactorHyperlinkEnabled",!1)}static UTn(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RefactorRangeTextEnabled",
!1)}static rva(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentEventAPIEnabled",!1)}static x5o(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CustomXmlPartApiIsEnabled",!1)}static hGl(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixGetHtmlStyleBug",!1)}static mJh(){var t;l.AFrameworkApplication.oe("46ab6280;fg4g7862");return null===(t=l.AFrameworkApplication.K)||void 0===t?
void 0:t.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContentControlEventApiEnabled",!1)}static Flf(){l.AFrameworkApplication.oe("241fi198;754i3702");return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FixFtnEtnClearFormat",!1)}static cPc(){l.AFrameworkApplication.oe("0cdc8638;0cdc8638");return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FtnEtnBodyEnabled",!1)}static DLj(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocumentInsertFileFromBase64ApiIsEnabled",
!1)}static B5o(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RecognizeCCWhenTrackchangesONOrOFF",!1)}static A5o(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InlineContentControlIsValidEnabled",!1)}static QOh(){var t;l.AFrameworkApplication.oe("aa6dc483;d84c1847");return null===(t=l.AFrameworkApplication.K)||void 0===t?void 0:t.getBooleanFeatureGate("Microsoft.Office.WordOnline.CrossFtnEtnNodeEnabled",!1)}static D5o(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RetrieveStylesApiIsEnabled",
!1)}static Nwj(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.StyleAPIEnabled",!1)}static rNc(t){null!==t&&void 0!==t&&t.length&&t.some(z=>-1===m.$bd(z))&&m.od()}static Rif(t,z){null!=t&&(t=m.$bd(t),k.ULS.sendTraceTag(509616404,369,50,`${z}.insertContentControl(${x.a[t]})`),-1===t&&m.od())}static $bd(t,z=-1){switch(t){case 96:return 1;case 31:return 0;default:return z}}}m.tmb="\r";m.qWh=new Map([[7,"\u0002"],[6,"\x0B"],[8,"\f"],[12,"\t"]]);m.Tia=9;Object(D.a)(m,
"Utility",null,[])},1523:function(D,I,c){c.d(I,"f",function(){return v});c.d(I,"e",function(){return H});c.d(I,"d",function(){return F});c.d(I,"g",function(){return G});c.d(I,"h",function(){return M});c.d(I,"a",function(){return K});c.d(I,"j",function(){return L});c.d(I,"i",function(){return R});c.d(I,"c",function(){return S});c.d(I,"b",function(){return N});var l=c(59),e=c(7),a=c(1531);c.n(a);D=[{role:2,roleType:a.RoleType.Title},{role:3,roleType:a.RoleType.Subtitle},{role:4,roleType:a.RoleType.Heading1},
{role:5,roleType:a.RoleType.Heading2},{role:6,roleType:a.RoleType.Heading3},{role:7,roleType:a.RoleType.Heading4},{role:8,roleType:a.RoleType.Heading5},{role:9,roleType:a.RoleType.Heading6},{role:10,roleType:a.RoleType.Heading7},{role:11,roleType:a.RoleType.Heading8},{role:12,roleType:a.RoleType.Heading9},{role:15,roleType:a.RoleType.ListItem},{role:13,roleType:a.RoleType.BodyText},{role:14,roleType:a.RoleType.Caption}];I=[{role:1,dH:{default:"Unknown",PJ:null}},{role:2,dH:{default:"Title",PJ:Box4Intl.Box4Strings.L_StyleWordTitle}},
{role:3,dH:{default:"Subtitle",PJ:Box4Intl.Box4Strings.L_StyleWordSubtitle}},{role:4,dH:{default:"Heading1",PJ:Box4Intl.Box4Strings.L_StyleWordHeading1}},{role:5,dH:{default:"Heading2",PJ:Box4Intl.Box4Strings.L_StyleWordHeading2}},{role:6,dH:{default:"Heading3",PJ:Box4Intl.Box4Strings.L_StyleWordHeading3}},{role:7,dH:{default:"Heading4",PJ:Box4Intl.Box4Strings.L_StyleWordHeading4}},{role:8,dH:{default:"Heading5",PJ:Box4Intl.Box4Strings.L_StyleWordHeading5}},{role:9,dH:{default:"Heading6",PJ:Box4Intl.Box4Strings.L_StyleWordHeading6}},
{role:10,dH:{default:"Heading7",PJ:Box4Intl.Box4Strings.L_StyleWordHeading17}},{role:11,dH:{default:"Heading8",PJ:Box4Intl.Box4Strings.L_StyleWordHeading8}},{role:12,dH:{default:"Heading9",PJ:Box4Intl.Box4Strings.L_StyleWordHeading9}},{role:13,dH:{default:"BodyText",PJ:Box4Intl.Box4Strings.L_StyleWordNormal}},{role:14,dH:{default:"Caption",PJ:Box4Intl.Box4Strings.L_StyleWordCaption}},{role:15,dH:{default:"ListItem",PJ:null}},{role:16,dH:{default:"SubtleEmphasis",PJ:Box4Intl.Box4Strings.L_StyleWordSubtleEmphasis}},
{role:17,dH:{default:"Emphasis",PJ:Box4Intl.Box4Strings.L_StyleWordEmphasis}},{role:18,dH:{default:"IntenseEmphasis",PJ:Box4Intl.Box4Strings.L_StyleWordIntenseEmphasis}},{role:19,dH:{default:"Strong",PJ:Box4Intl.Box4Strings.L_StyleWordStrong}},{role:20,dH:{default:"Quote",PJ:Box4Intl.Box4Strings.L_StyleWordQuote}},{role:21,dH:{default:"IntenseQuote",PJ:Box4Intl.Box4Strings.L_StyleWordIntenseQuote}},{role:22,dH:{default:"SubtleReference",PJ:Box4Intl.Box4Strings.L_StyleWordSubtleReference}},{role:23,
dH:{default:"IntenseReference",PJ:Box4Intl.Box4Strings.L_StyleWordIntenseReference}},{role:24,dH:{default:"BookTitle",PJ:Box4Intl.Box4Strings.L_StyleWordBookTitle}},{role:25,dH:{default:"NoSpacing",PJ:Box4Intl.Box4Strings.L_StyleWordNoSpacing}}];const k=new Map(I.map(O=>[O.dH.default,O.role])),x=new Map(I.map(O=>[O.role,O.dH.default])),y=new Map(I.map(O=>[O.role,O.dH.PJ])),m=new Map(D.map(O=>[O.roleType,O.role])),t=new Map(D.map(O=>[O.role,O.roleType])),z=(O,W,V)=>O.has(W)?O.get(W):V,v=O=>z(k,O,1),
H=O=>z(m,O,1),F=O=>z(t,O,a.RoleType.Unknown),G=O=>z(x,O,"Unknown"),M=O=>z(y,O,null),K=O=>{switch(O){case 4:return 0;case 5:return 1;case 6:return 2;case 7:return 3;case 8:return 4;case 9:return 5;case 10:return 6;case 11:return 7;case 12:return 8;default:return 9}},L=O=>{switch(O){case 13:return"Normal";case 1:return"Unknown";case 4:return"Heading 1";case 5:return"Heading 2";case 2:return"Title";case 15:return"List Paragraph";case 3:return"Subtitle";case 14:return"Caption";case 6:return"Heading 3";
case 7:return"Heading 4";case 8:return"Heading 5";case 9:return"Heading 6";case 10:return"Heading 7";case 11:return"Heading 8";case 12:return"Heading 9";case 16:return"Subtle Emphasis";case 17:return"Emphasis";case 18:return"Intense Emphasis";case 19:return"Strong";case 20:return"Quote";case 21:return"Intense Quote";case 22:return"Subtle Reference";case 23:return"Intense Reference";case 24:return"Book Title";case 25:return"No Spacing";default:return"Unknown"}},R=O=>{switch(O){case 13:return l.StyleReader.wordStyleIdNormal;
case 4:return l.StyleReader.wordStyleIdHeading1;case 5:return l.StyleReader.wordStyleIdHeading2;case 2:return l.StyleReader.osb;case 15:return l.StyleReader.wordStyleIdListParagraph;case 3:return l.StyleReader.Ted;case 6:return l.StyleReader.wordStyleIdHeading3;case 7:return l.StyleReader.HTb;case 8:return l.StyleReader.ITb;case 9:return l.StyleReader.JTb;case 10:return l.StyleReader.Apc;case 11:return l.StyleReader.Bpc;case 12:return l.StyleReader.KTb;case 16:return l.StyleReader.nsb;case 17:return l.StyleReader.M9a;
case 18:return l.StyleReader.lsb;case 19:return l.StyleReader.XLj;case 20:return l.StyleReader.Epc;case 21:return l.StyleReader.msb;case 22:return l.StyleReader.YLj;case 23:return l.StyleReader.WLj;case 24:return l.StyleReader.ULj;case 25:return l.StyleReader.Dpc;case 14:return l.StyleReader.VLj;default:return e.ULS.sendTraceTag(512274639,3016,50,"Style ID not supported for role "+G(O)),"Unknown"}},S=O=>{switch(O){case 18:case 21:case 23:return!0;default:return!1}},N=O=>4<=O&&12>=O},1525:function(D,
I,c){c.d(I,"c",function(){return G});c.d(I,"b",function(){return M});c.d(I,"t",function(){return L});c.d(I,"r",function(){return N});c.d(I,"q",function(){return O});c.d(I,"g",function(){return W});c.d(I,"d",function(){return V});c.d(I,"o",function(){return Q});c.d(I,"n",function(){return Y});c.d(I,"a",function(){return ba});c.d(I,"e",function(){return Z});c.d(I,"i",function(){return ea});c.d(I,"m",function(){return ha});c.d(I,"s",function(){return ka});c.d(I,"j",function(){return ua});c.d(I,"k",function(){return sa});
c.d(I,"h",function(){return Da});c.d(I,"v",function(){return Pa});c.d(I,"u",function(){return Ra});c.d(I,"p",function(){return ia});c.d(I,"f",function(){return pa});c.d(I,"l",function(){return Fa});D=c(22);var l=c(60),e=c(115),a=c(135);I=c(393);var k=c(37),x=c(8),y=c(57),m=c(420),t=c(6),z=c(7),v=c(1534),H=c(1635);const F=()=>document.getElementById(a.AppFrame.TVa),G=new I.a,M=`.ParaWrappingDiv .${k.a.eMd}`,K=D.a.instance.Ve("Box4.CommentParagraphMapping"),L=[Box4Intl.Box4Strings.l_HK_Bold,Box4Intl.Box4Strings.l_HK_Bold_Mac,
Box4Intl.Box4Strings.l_HK_Italic,Box4Intl.Box4Strings.l_HK_Italic_Mac,Box4Intl.Box4Strings.l_HK_Underline,Box4Intl.Box4Strings.l_HK_Underline_Mac];let R=void 0;const S=()=>{if(void 0===R){let za;try{za=CSS.supports("selector(:not(* *))")}catch(Oa){za=!1}za||z.ULS.sendTraceTag(526263553,324,15,"Cannot use complex CSS selector in CommentHelpers, falling back to less performant alternative");R=za}return R},N=za=>!!za&&!!za.Df,O=(za,Oa,xa,fa)=>{if(!za||!za.objectId)return!1;const Ka=xa.Eb(l.a.If(za.objectId)),
lb=v.a.W$b(Ka,!0),Xa=v.a.W$b(Ka,!1);if(!lb||!Xa||lb===Xa&&lb!==Oa||!x.ParagraphReader.BXc(Oa,lb,Xa))return!1;za=!0;var kb=!1;lb===Oa&&(kb=v.a.vca(Ka,xa,!0),za=za&&!!kb&&kb.Lb.cp<=fa,kb=!!kb&&kb.Lb.cp===fa);Oa===Xa&&(Oa=v.a.vca(Ka,xa,!1),za=za&&!!Oa&&Oa.Lb.cp>fa,kb=kb&&!!Oa&&Oa.Lb.cp===fa);return za||kb},W=za=>{if(!za)return null;za=e.a.Eb(za,k.a.sJc);return null!==za&&void 0!==za?za:[]},V=za=>za?e.a.Eb(za,k.a.lHd):null,Q=(za,Oa)=>{if(!za)return-1;for(let xa=0;xa<za.length;xa++)if(za[xa].Ohc.equals(Oa))return xa;
return-1},Y=(za,Oa)=>{if(!za)return-1;for(let xa=0;xa<za.length;xa++)if(za[xa].Zti.equals(Oa))return xa;return-1},ba=za=>`Comment Object Id: ${za.objectId}`,Z=(za=!1)=>pa(F(),za),ea=()=>y.a.Xj?Array.from(F().querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart,.ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart")):qa()?Array.from(F().querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart")):
[],ha=(za,Oa=!1)=>{if(za.gk){for(const xa of za.Xg.hj)if(Fa(xa,Oa))return!0;return!1}return Fa(za.htmlElement,Oa)},ka=za=>!!za&&!!za.ja(t.a.zM,null),ua=()=>{const za=new Set,Oa=ea();for(let xa=0;xa<Oa.length;xa++)W(Oa[xa]).forEach(fa=>{za.add(fa.toString())});return za},sa=(za,Oa)=>Oa?Ga(za,!0,Oa):ta(za,!0),Da=(za,Oa)=>Oa?Ga(za,!1,Oa):ta(za,!1),Pa=(za,Oa)=>{va(za,Oa,!0);m.a.isEnabled&&!za.$kb&&z.ULS.sendTraceTag(512372928,327,50,`Adding to CommentParagraphMapping CommentId: ${za.id} StartParaId: ${Oa}`)},
Ra=(za,Oa)=>{va(za,Oa,!1);m.a.isEnabled&&!za.$kb&&z.ULS.sendTraceTag(512372899,327,50,`Adding to CommentParagraphMapping CommentId: ${za.id} EndParaId: ${Oa}`)},Ga=(za,Oa,xa)=>{var fa,Ka;const lb=za.id.toString();return Oa?m.a.isEnabled?null!==(fa=K.value.y0a.get(lb))&&void 0!==fa?fa:xa:za.ja(t.a.OUa,xa):m.a.isEnabled?null!==(Ka=K.value.x0a.get(lb))&&void 0!==Ka?Ka:xa:za.ja(t.a.kwa,xa)},ta=(za,Oa)=>{const xa=za.id.toString();return Oa?m.a.isEnabled?K.value.y0a.get(xa):za.getValue(t.a.OUa):m.a.isEnabled?
K.value.x0a.get(xa):za.getValue(t.a.kwa)},va=(za,Oa,xa)=>{const fa=za.id.toString();m.a.isEnabled?za.$kb||(xa?K.value.y0a:K.value.x0a).set(fa,Oa):za.setValue(xa?t.a.OUa:t.a.kwa,Oa)},ia=za=>m.a.isEnabled?K.value.y0a.has(za.objectId)&&K.value.x0a.has(za.objectId):!0,qa=()=>0===H.a.Nj||2===H.a.Nj,pa=(za,Oa)=>{if(Oa&&(qa()||y.a.Xj)){if(S())return Array.from(za.querySelectorAll(y.a.Xj?".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart, .ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart)":
".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart)"));Oa=y.a.Xj?za.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart,.ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart"):za.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart");const xa=
Oa.length;if(0<xa){za=za.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart");const fa=[];let Ka=0;for(let lb=0,Xa=za.length;lb<Xa;lb++){const kb=za[lb];Ka<xa&&Oa[Ka]===kb?++Ka:fa.push(kb)}return fa}}return Array.from(za.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart"))},Fa=(za,Oa)=>{if(Oa&&(qa()||y.a.Xj)){if(S())return!!za.querySelector(y.a.Xj?".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart, .ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart)":
".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart:not(.ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart)");Oa=y.a.Xj?za.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart,.ParaWrappingDiv:not([style*='visibility: hidden;']) .Vanish .CommentStart").length:za.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .TextDeletionSimpleOrNoMarkup .CommentStart").length;
if(0<Oa)return Oa!==za.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart").length}return!!za.querySelector(".ParaWrappingDiv:not([style*='visibility: hidden;']) .CommentStart")}},1528:function(D,I,c){c.d(I,"a",function(){return k});D=c(0);var l=c(2),e=c(1835),a=c(19);class k{static n$h(){return k.Vzk+"_"+e.a.ITc+"_"+a.a.RQ(l.AFrameworkApplication.userName)+"_"}static M4h(x){return x+"_"+e.a.ITc+"_"+a.a.RQ(l.AFrameworkApplication.userName)+"_"}static yfi(){return k.fIn+
"_"+e.a.ITc+"_"+a.a.RQ(l.AFrameworkApplication.userName)+"_"}}k.YNa="ack0";k.ZNa="ack1";k.uCd="ack2";k.Vzk="ack3";k.Orh="ack4";k.Prh="ack7";k.rGi="ack8";k.Rrj="ack9";k.K3e="ack10";k.Svo="ack13";k.BGi="ack14";k.R2b="AddinDetailsRefreshed";k.Tzk="DdaMethod";k.Szk="ControlId";k.yCd="OsfcontrolId";k.N0e="SecurityOrigin";k.T2b="ak0";k.$zk="ak1";k.Srh="ak2";k.H0e="ak4";k.Nrh="Office.AutoShowTaskpaneWithDocument";k.Qrh="value";k.Zzk="errorCode";k.ztl="SourceControlId";k.xtl="OsfControl";k.ytl="RibbonUpdaterData";
k.dme="AddinShared";k.fIn="__OSF_PRIVATECATALOG_ADDINIDS";Object(D.a)(k,"AddinConstantsString",null,[])},1530:function(D,I,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var m=Object.getOwnPropertyDescriptor(k,x);if(!m||("get"in m?!k.hz:m.writable||m.configurable))m={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,m)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,
x)||l(k,a,x)};Object.defineProperty(I,"__esModule",{value:!0});e(c(1852),I);e(c(1853),I)},1531:function(D,I,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var m=Object.getOwnPropertyDescriptor(k,x);if(!m||("get"in m?!k.hz:m.writable||m.configurable))m={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,m)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,
x)||l(k,a,x)};Object.defineProperty(I,"__esModule",{value:!0});e(c(1837),I);e(c(1838),I)},1534:function(D,I,c){D=c(0);var l=c(22),e=c(81),a=c(60),k=c(2),x=c(736),y=c(139),m=c(243),t=c(611),z=c(10),v=c(5),H=c(256),F=c(8),G=c(420),M=c(327),K=c(1189),L=c(76),R=c(62),S=c(1798),N=c(1840),O=c(1841),W=c(16),V=c(6),Q=c(599),Y=c(7),ba=c(112),Z=c(250),ea=c(83),ha=c(1695);class ka extends Sys.EventArgs{constructor(va,ia){super();this.graphNode=va;this.F1k=ia}}Object(D.a)(ka,"OnCopyCommentEventArgs",Sys.EventArgs,
[]);class ua extends Sys.EventArgs{constructor(va,ia){super();this.graphNode=va;this.z_k=ia}}Object(D.a)(ua,"OnPasteCommentEventArgs",Sys.EventArgs,[]);var sa=c(1220),Da=c(1525),Pa=c(1597);class Ra extends Sys.EventArgs{constructor(va){super();this.commentNode=va}}Object(D.a)(Ra,"OnDeleteEventArgs",Sys.EventArgs,[]);class Ga extends Sys.EventArgs{constructor(va){super();this.commentNode=va}}Object(D.a)(Ga,"OnPasteEventArgs",Sys.EventArgs,[]);c.d(I,"a",function(){return ta});class ta{static get jg(){return null!=
ta.Xwg?ta.Xwg:ta.Xwg=l.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static get fd(){return null!=ta.Hyg?ta.Hyg:ta.Hyg=new e.a}static get TDa(){return Pa.a.instance}static get rj(){return z.App.za.jb.Zc.xd}static get Zb(){return null!=ta.Hzg?ta.Hzg:ta.Hzg=l.a.instance.Oa("Box4.IFeatureHelper")}static isComment(va){return 40===va.Xe}static tZd(va){return 40===va.type}static SDf(va){return!!va&&39===va.Xe}static dWf(va,ia){ia.property===W.a.gf&&(ta.aJb=!1)}static hWf(va,ia){ia&&!va.Oc&&ta.lRh(va)}static lRh(va){const ia=
va.Lb.paragraph.Mc;va=ia.Eb(va.Lj);ta.qNc();va&&va.anchor&&ta.deleteComment(va,ia)}static Abf(va){const ia=new v.GraphIterator;ia.set(va.Yi());ta.TDa.Q5a(ia);return ia}static deleteComment(va,ia){va?(ta.qNc(),ta.OKd(va,ia),va.anchor&&(ta.fd.raiseEvent(ta.c2c,new Ra(va)),ia=va.ja(V.a.hF,0),Y.ULS.sendTraceTag(592188697,327,15,`Comment deleted by canvas anchor removal. ${va.id}`),ta.QPg.add(ia.toString()),ia=new v.GraphIterator,ia.set(va),ia.zb(39),ia.zg())):Y.ULS.sendTraceTag(512275402,327,50,"Comment Node is Undefined")}static fLm(va){return ta.QPg.contains(va)}static OKd(va,
ia){ta.qNc();const qa=ta.vca(va,ia,!0);ia=ta.vca(va,ia,!1);ta.epb(qa);ta.epb(ia);qa&&ia&&qa.Lb===ia.Lb&&Y.ULS.sendTraceTag(50619292,327,10,`comment ${va.id} start and end range objects belonged to same chp`)}static epb(va){if(va&&va.Lb.Te){va.Lb.Te.remove(va);const ia=va.Lb.paragraph;0<=va.qe&&va.qe<ia.ye.length&&(va.Lb.cp||1!==ia.ye.length||(ia.ye.uY(0,4),ia.ye.vq.Z(1,H.CharacterPropertiesEditor.aN),ia.ye.nt.Z(1,H.CharacterPropertiesEditor.YR)),ia.ye.removeAt(va.qe,4));ia.Wl()}}static Lln(va,ia){if(ia){var qa=
ia.paragraph;va=ia.cpBegin;var pa=ia.cpEnd;if(qa&&F.ParagraphReader.Xb(qa)&&(qa=qa.qa)){ia.Ro[ta.xHd]||(ia.Ro[ta.xHd]=[]);ia=ia.Ro[ta.xHd];for(let za=0;za<qa.length;za++){const Oa=qa.J(za).Te;if(!Oa)continue;const xa=Oa.length;var Fa=qa.J(za).cp;if(Fa<va||Fa>pa)for(Fa=0;Fa<xa;Fa++)ia.push(Oa.J(Fa))}}}}static Ukn(va,ia){if(ia&&(va=ia.Ro[ta.xHd]))for(ia=0;ia<va.length;ia++)ta.lRh(va[ia])}static vca(va,ia,qa){if(!va)return null;const pa=qa?Da.k(va,a.a.nil):Da.h(va,a.a.nil);ia=ia.Eb(pa);return ia?ta.Ewa(ia,
va.id,qa):(qa||Y.ULS.sendTraceTag(4531344,327,15,`Comment anchor missing! Comment Id: ${va.id} Anchor Id: ${pa} ${ta.eLm(pa)}`),null)}static eLm(va){return G.a.isEnabled?`isDeletedParagraph: ${ta.ORh.has(va.toString())}`:""}static Ewa(va,ia,qa){for(let pa=0;pa<va.qa.length;pa++){const Fa=va.qa.J(pa);if(Fa.Te)for(let za=0;za<Fa.Te.length;za++)if(Fa.Te.J(za).Lj.equals(ia)&&qa===Fa.Te.J(za).Oc)return Fa.Te.J(za)}return null}static W$b(va,ia){if(!va)return null;ia=ia?Da.k(va,a.a.nil):Da.h(va,a.a.nil);
return va.Mc.Eb(ia)}static WPc(va,ia,qa,pa=null){const Fa=!pa;for(let za=0;za<va.qa.length;za++){const Oa=va.qa.J(za);if(Oa.cp>=ia&&Oa.Te)for(let xa=0;xa<Oa.Te.length;xa++){const fa=Oa.Te.J(xa).Lj.toString();if(Oa.Te.J(xa).Oc===qa&&(Fa||pa.contains(fa)))return Oa.Te.J(xa)}}return null}static x2l(va,ia,qa,pa){for(let Fa=0;Fa<va.qa.length;Fa++){const za=va.qa.J(Fa);if(za.cp>ia)break;if(za.cp===ia&&za.Te)for(let Oa=za.Te.length-1;0<=Oa;Oa--){const xa=za.Te.J(Oa).Lj.toString();if(za.Te.J(Oa).Oc===qa&&
pa.contains(xa))return za.Te.J(Oa)}}return null}static p2b(va,ia,qa,pa){let Fa=null;for(let za=0;za<va.qa.length;za++){let Oa=va.qa.J(za);if(Oa.cp>=qa){Oa.cp>qa||!Oa.formatting?(Fa=ta.jg.qZ(va,za,qa,Fa),Oa=va.qa.J(za)):Fa=Oa.formatting;Oa.Te||(Oa.Te=new M.a(Oa));ta.ABd(ia,Oa.Te,Fa.Yj,pa);break}Oa.formatting&&(Fa=Oa.formatting)}}static ABd(va,ia,qa,pa){qa=ia.Lb.paragraph;const Fa=new K.a(ia.Lb,null,va,pa);for(let za=0;za<ia.length;za++)if(ia.J(za).Lj===va&&ia.J(za).Oc===pa){Y.ULS.sendTraceTag(589616028,
327,10,"CommentRangeObject {0} already exists with isStart value {1} in commentRangeObjects",va,pa);break}ia.add(Fa);qa.Wl();Fa.qe?qa.ye.uY(Fa.qe-1,4):qa.ye.lpa(Fa.qe,4);qa.ye.vq.Z(Fa.qe,H.CharacterPropertiesEditor.aN);qa.ye.nt.Z(Fa.qe,H.CharacterPropertiesEditor.YR);return Fa}static qNc(){if(!ta.aJb){var va=new v.GraphIterator;va.set(z.App.za.jb.Zc);ta.TDa.Q5a(va);if(va.Ub(1))for(;va.Mf(1););ta.aJb=!0}}static gEl(va){const ia=new v.GraphIterator;ia.set(z.App.za.jb.Zc);ta.TDa.Q5a(ia);if(39!==ia.Xe)return!1;
let qa;if(qa=ia.Ub(1)){if(qa.id.equals(va))return!0;for(;qa=ia.Mf(1);)if(qa.id.equals(va))return!0}return!1}static NMb(va,ia){ta.E6c(ia)}static XQj(va,ia){G.a.isEnabled&&(va=ia.node)&&(ia=F.ParagraphReader.tR(va),ta.Ife(ia)&&ta.ORh.add(va.id.toString()))}static Ife(va){return 0<va?document.querySelector("div.PageContentContainer p[paraid='"+va+"']"):null}static E6c(va){ta.Q7f(F.ParagraphReader.QFb(va));let ia=null;var qa=new v.GraphIterator;qa.set(va);if(qa.Ip()&&(qa=L.a.Gs(qa,qa.origin),qa.moveNext()))for(;qa.moveNext();)if(F.ParagraphReader.oh(qa.iterator)){ia=
qa.iterator.currentNode;break}if(ia){va=F.ParagraphReader.QFb(va);for(const pa of va)pa.Oc&&(va=pa.Lb.paragraph.Mc.Eb(pa.Lj))&&(ta.epb(pa),ta.p2b(ia,va.id,0,!0),Da.v(va,ia.id))}}static Q7f(va){for(const ia of va)if(!ia.Oc){va=ia.Lb.paragraph.Mc;const qa=va.Eb(ia.Lj);ta.deleteComment(qa,va)}}static yTd(va,ia){const qa=[];if(!va)return Y.ULS.shipAssertTag(594908762,327,!1,"Trying to highlight null node."),qa;if(!va.isConnected)return Y.ULS.shipAssertTag(51467871,327,!1,"Trying to highlight disconnected node."),
qa;const pa=ta.vca(va,ta.rj,!0),Fa=ta.vca(va,ta.rj,!1);if(!pa||!Fa)return Y.ULS.shipAssertTag(51467872,327,!1,`Missing comment anchor ${va.id}`),qa;va=!1;let za=pa.Lb.paragraph;for(;za&&(!ia||!ia(za,za===pa.Lb.paragraph));){za===pa.Lb.paragraph&&(va=!0);va&&qa.push(za);if(za===Fa.Lb.paragraph)break;za=F.ParagraphReader.Xf(za,!1)}return qa}static eWf(va,ia){ia.Ro.Comments||(ia.Ro.Comments={});ta.Y6d(ia.operation,ia.g_i,ia.original,ia.clone,ia.Ro.Comments,!0)}static gWf(va,ia){ia.Ro.Comments||(ia.Ro.Comments=
{});ta.Y6d(ia.operation,ia.g_i,ia.original,ia.clone,ia.Ro.Comments,!1)}static Gmn(va,ia){ia.Ro.Comments||(ia.Ro.Comments={});va=ia.Ro.Comments;if((ia=Object.keys(va))&&0<ia.length)for(let qa=0;qa<ia.length;qa++){const pa=va[ia[qa].toString()];pa&&(pa.Lj=null,ta.epb(pa))}}static Y6d(va,ia,qa,pa,Fa,za){const Oa=qa.Mc;var xa=F.ParagraphReader.QFb(pa);xa.sort((Ja,Ma)=>Ja.Lb.cp<Ma.Lb.cp||Ja.Lb.cp===Ma.Lb.cp&&Ja.Oc?-1:Ja.Lb.cp===Ma.Lb.cp&&Ja.Oc===Ma.Oc?0:1);const fa=new ea.a,Ka=new Z.a,lb=ta.Zb.isFeatureEnabled(114);
for(const Ja of xa)if(Object(ba.a)(sa.MainView,R.InteractiveViewManager.instance.yd)){var Xa=Oa.Eb(Ja.Lj);if(Xa&&Xa.isConnected)if(Ja.Oc)Fa[Ja.Lj.toString()]=Ja;else{var kb=Xa.ja(V.a.hF,0);xa=za?ta.z4c(Xa,pa,va,ia):ta.E4c(Xa,pa,va,ia);if(za)lb&&(kb=v.GraphIterator.eb(pa),kb.zb(25)&&kb.jd(25)&&ha.a.fd.raiseEvent(ha.a.FUi,new ka(kb.currentNode,xa.getValue(V.a.hF))));else{if(lb){var Bb=xa.ja(V.a.hF,0);kb&&Bb&&(Ka.nb(kb)?Ka.J(kb)!==Bb&&Y.ULS.sendTraceTag(589616029,327,10,"Failed to add Key {0}, Value {1} to clonedDurableIdMapping, since Key {0}, Value {2} already exists. This could affect copy/paste of tasks.",
kb,Bb,Ka.J(kb)):Ka.add(kb,Bb))}xa.setValue(V.a.Ykb,!0);Xa.ja(V.a.w9e,null)||(kb=Xa.ja(V.a.IOa,null))&&xa.setValue(V.a.w9e,kb);xa.setValue(V.a.IOa,k.AFrameworkApplication.userSessionId)}kb=Ja.Lj.toString();Bb=Fa[kb];Ja.Lj=xa.id;if(!za){Ja.fv=null;Xa=Xa.getValue(V.a.LH);const Ma=xa.getValue(V.a.LH);Fa[Xa]=Ma;if(Xa=xa.ja(V.a.zM,null))fa.nb(Xa)||fa.add(Xa,[]),fa.J(Xa).push(xa)}Da.u(xa,pa.id);pa.id||Y.ULS.shipAssertTag(5564305,327,!1,"Comment node has no end anchor!");Bb?(Bb.Lj=xa.id,za||(Bb.fv=null),
Da.v(xa,Bb.Lb.paragraph.id),delete Fa[kb]):(ta.p2b(pa,xa.id,Ja.Lb.cp,!0),Da.v(xa,pa.id))}else Y.ULS.sendTraceTag(592188835,327,10,String.format("Node is null or not connected, IsNodeChildOfCommentContent:{0}, IsNull:{1}",ta.gEl(Ja.Lj),!Xa)),Ja.Lj=null,ta.epb(Ja)}else Ja.Lj=null,ta.epb(Ja);if(!za){for(const Ja of fa){va=Ja.key;ia=Ja.value;for(const Ma of ia)Ma.setValue(V.a.zM,Fa[va])}0<Ka.count&&lb&&(qa=v.GraphIterator.eb(qa),qa.zb(25)&&qa.jd(25)&&ha.a.fd.raiseEvent(ha.a.gXi,new ua(qa.currentNode,
Ka)))}pa.jk()}static Fif(va,ia){if(va.zb(25)&&va.jd(25)&&!va.Jt(16)){const qa=v.GraphIterator.eb(ia);qa.zb(39);qa.jd(39);ia=Q.b(qa.currentNode,ia.Yi().Mc,!0);va.Bf(ia,16)}}static vaf(va,ia){var qa=ia.Yi().xd;qa=Q.b(va,qa,!0);ia=v.GraphIterator.eb(ia);ta.Fif(ia,va);ia.Ub(16);ia.O3(qa,1,va.id);return qa}static z4c(va,ia,qa,pa){ta.qNc();ia=ta.vaf(va,ia);ia.$kb=!0;ta.$yl(va,ia,qa,pa);return ia}static $yl(va,ia,qa,pa){va=new S.a(v.GraphIterator.eb(va),v.GraphIterator.eb(ia),{});va.RQb=!0;qa=new x.a(qa,
pa,new N.a(va,null));qa.Qh=!0;qa.Rl("ExecuteInternalCommentCopy");qa.run()}static E4c(va,ia,qa,pa){ta.qNc();var Fa=ia.Yi().xd;ia=v.GraphIterator.eb(ia);ia.zb(7);ia.jd(7);ia.Ub(16);Fa=Q.b(va,Fa,!0);Fa.Hg(V.a.LH,y.a.create().toString());Fa.Hg(V.a.commentId,m.a.GF());let za=!1;ta.EEi(Fa.wf(V.a.hF))?za=!0:Fa.Hg(V.a.hF,ta.oqf());ia.Bf(Fa,1);ta.azl(va,Fa,qa,pa);ia.Aj(Fa);ia.EJ(1);ia.Rib(2);ia.Ub(2);Fa.setValue(V.a.LH,ia.currentNode.wf(V.a.Wc).toString());ta.fd.raiseEvent(ta.Xrn,new Ga(Fa));za&&this.HPh.add(Fa.id.toString());
return Fa}static azl(va,ia,qa,pa){va=new O.a(v.GraphIterator.eb(va),v.GraphIterator.eb(ia),null,null);qa=new x.a(qa,pa,va);qa.Qh=!0;qa.Rl("ExecuteInternalCommentPaste");qa.run()}static oqf(){const va=m.a.$ic(1,this.NNi);return ta.EEi(va)?va:ta.oqf()}static EEi(va){if(!va)return!1;if(z.App.za){const ia=new v.GraphIterator;ia.set(z.App.za.jb.Zc);ta.TDa.Q5a(ia);let qa=ia.Rd();for(;qa;){if(qa.wf(V.a.hF)===va)return!1;qa=ia.Oj()}}return!0}static k0e(va){ta.fd.addHandler(ta.c2c,va)}}ta.Xrn="OnPaste";ta.c2c=
"OnDelete";ta.xHd="CommentRangesToTrimOutsideSelection";ta.QPg=new t.a;ta.aJb=!1;ta.NNi=2147483646;ta.HPh=new Set;ta.ORh=new Set;Object(D.a)(ta,"CommentEditor",null,[])},1539:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l extends Sys.EventArgs{constructor(e){super();this.data=e}}Object(D.a)(l,"DesignerEventArgs",Sys.EventArgs,[])},1541:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.completion=new Promise((e,a)=>{this.resolve=e;this.reject=a})}}Object(D.a)(l,
"ControlledPromise",null,[])},1543:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}l.wq="SpellingErrorV2";l.Oig="SpellingErrorV2Themed";l.x6k="ContextualSpellingAndGrammarErrorV2";l.Y$e="ContextualSpellingAndGrammarErrorV2Themed";l.ECd="AdvancedProofingIssueV2Themed";l.L7i="AdvancedProofingIssueV2Themed";l.Ktj="SimilarityReviewed";l.Ltj="SimilarityReviewedThemed";l.Mtj="SimilarityUnreviewed";l.Ntj="SimilarityUnreviewedThemed";l.qKh="CopilotHighlightThemed";l.rmc="SpellingErrorHighlight";
l.qac="GrammarErrorHighlight";l.Yeb="CritiqueIndicatorHighlight";l.K7i="ReactiveRewriteIndicatorHighlight";l.izo="SimilarityHighlight";l.jzo="SimilarityReviewedHighlight";l.WDd="IdeasSuggestionConfirmation";Object(D.a)(l,"CanvasContextualCssClasses",null,[])},1545:function(D,I,c){c.d(I,"a",function(){return y});D=c(0);var l=c(6),e=c(290),a=c(1198),k=c(1105),x=c(7);class y{constructor(m,t,z,v){this.s0m=m;this.EFm=t;this.DFm=z;this.i2i=v}cic(m,t,z,v,H){m?(m=this.FKc(m,t,z),null!==m&&(v=this.Kaf(v,m,
H),this.DFm.setState(this.s0m.value,v))):x.ULS.shipAssertTag(543499408,3016,!1,"No ParagraphNode")}FKc(m,t,z){return 0>z?(x.ULS.sendTraceTag(539018900,389,10,"Attempted to create a ParagraphRange descriptor with negative length"),null):e.a.OKc(m.ja(l.a.Wc,-1),m.ja(l.a.tj,-1),t,z,t,z,m)}Kaf(m,t,z){return Object.assign(new k.a,{annotationType:m,contentDescriptor:t,state:z})}vDf(m,t,z,v,H){if(m){var F=m.ja(l.a.Wc,-1),G=m.ja(l.a.tj,-1);-1===F||-1===G?H(null):(m=this.FKc(m,t,z),null===m?H(0):this.EFm.w2c(m,
v,M=>{H(M)}))}else x.ULS.shipAssertTag(543499409,3016,!1,"No ParagraphNode")}UCn(m){if(m){var t=a.a.R$k(m);this.i2i.Bph({nqb:t,settingType:m})||x.ULS.shipAssertTag(521416710,3016,!1,"Persist Designer suppression setting failed")}}NUm(m){return new Promise(t=>{this.i2i.Nei(m,z=>{(null===z||void 0===z?0:z.nqb)?t(z.nqb):t(null)})})}}y.Y3f="WordDesignerPullQuotesAnnotation";y.iQh="WordDesignerDefaultAnnotation";y.ikg="WordDesignerSuggestedImageAnnotation";y.rzj="WordDesignerThemeImageAnnotation";y.Xjg=
"WordDesignerStylizedTitleAnnotation";y.h5b="WordDesignerComplexDecoratorAnnotationType";y.eSh="DesignerPaneSuppressionSetting";Object(D.a)(y,"PersistenceHelperImpl",null,[1072])},1546:function(D,I,c){function l(K){return 1===(null===K||void 0===K?void 0:K.Kq)||3===(null===K||void 0===K?void 0:K.Kq)}D=c(0);var e=c(39),a=c(42),k=c(31),x=c(7),y=c(1647),m;(function(K){K[K.initial=0]="initial";K[K.z3o=.1]="viewingOriginal";K[K.OGk=.5]="applying";K[K.applied=1]="applied";K[K.sep=2]="accepted";K[K.rejected=
3]="rejected";K[K.Oqp=4]="roleChanged";K[K.Jlp=5]="invalidated"})(m||(m={}));Object(D.b)("ReviewIntentState",m);const t=K=>{switch(K){case m.z3o:return m.rejected;case m.OGk:return m.applied;default:return K}};var z=c(138);c.d(I,"d",function(){return H});c.d(I,"e",function(){return l});c.d(I,"b",function(){return F});c.d(I,"c",function(){return G});c.d(I,"a",function(){return M});class v{constructor(K,L,R=null,S,N=!0){this.id=K;this.Kq=L;this.pE=R;this.Zd=S;this.rKm=N;this.Wyi=!1;this.VFi=e.a.$e()}Kni(){return!1}iSa(K){this.c5(m[t(K)]);
this.E3d(K)}E3d(K){1===K&&this.pE&&this.Zd&&(this.rKm?(this.Zd.THm()&&this.pE.execute(L=>{L.logActivity(z.a.CTj,null)}),2===this.Kq&&this.Zd.PVm()?this.pE.execute(L=>{L.logActivity(z.a.STj,null)}):1===this.Kq&&this.Zd.KRm()?this.pE.execute(L=>{L.logActivity(z.a.MTj,null)}):0===this.Kq&&this.Zd.CNm()&&this.pE.execute(L=>{L.logActivity(z.a.GTj,null)})):4===this.Kq&&this.Zd.nLm()&&this.pE.execute(L=>{L.logActivity(z.a.ETj,null)}))}H_c(){6E4>e.a.$e()-this.VFi?this.c5("removed"):x.ULS.sendTraceTag(539109067,
3016,50,"ID: {0}, Type: {1}, State: {2}",this.id,this.Kq,"removedButKept")}L5m(){this.Wyi||(this.c5("hovered"),this.Wyi=!0)}c5(K){this.VFi=e.a.$e();x.ULS.sendTraceTag(540357460,3016,50,"ID: {0}; Type: {1}, State: {2};",this.id,this.Kq,K);a.a(z.a.Eml,!0,void 0,[Object.assign(new k.a,{name:"suggestionType",int64:this.Kq}),Object.assign(new k.a,{name:"ID",string:this.id.toString()}),Object.assign(new k.a,{name:"State",string:K})])}}Object(D.a)(v,"DesignerSuggestion",null,[]);class H extends v{constructor(K,
L=1,R=null,S,N=!1,O=0,W=""){super(K,L,R,S,N);this.Q6a=O;this.T4c=W}}Object(D.a)(H,"PullQuoteSuggestion",v,[]);class F extends v{constructor(K,L,R,S=null,N,O){super(K,2,S,N);this.AR=L;this.baseUrl=R;this.o1d=O;this.selectedIndex=0;this.Kmc=z.a.iAm}zym(){x.ULS.shipAssertTag(527708514,3016,this.Kmc===z.a.wjn,`${this.Kmc}`);this.Kmc=Math.min(this.AR.length,z.a.y4d)}Kni(){return this.Kmc<Math.min(this.AR.length,z.a.y4d)}kGb(K){return K>=this.AR.length?(x.ULS.shipAssertTag(527708515,3016,!1),null):this.baseUrl+
this.AR[K].imageId}Kvf(K){return K>=this.AR.length?(x.ULS.shipAssertTag(527708544,3016,!1),null):this.baseUrl+this.AR[K].thumbnailId}bY(K){return K>=this.AR.length?(x.ULS.shipAssertTag(527708545,3016,!1),null):this.AR[K].altText?this.AR[K].altText:this.AR[K].category===y.SuggestionCategory.AbstractImage?WordEditorIntl.WordEditorStrings.L_DesignerImageSuggestionAbstractImageAltText:WordEditorIntl.WordEditorStrings.L_DesignerDecorativeImage}z0l(K){var L;return K>=this.AR.length?(x.ULS.shipAssertTag(527210446,
3016,!1),0):null!==(L=this.AR[K].score)&&void 0!==L?L:0}iSa(K){if(!this.o1d){const L=m[t(K)];x.ULS.sendTraceTag(509653453,3016,50,"ID: {0}; Type: ImageSuggestion for Heading , State: {1};",this.id,L);a.a(z.a.nml,!0,void 0,[Object.assign(new k.a,{name:"ID",string:this.id.toString()}),Object.assign(new k.a,{name:"State",string:L})])}super.iSa(K)}}Object(D.a)(F,"ImageSuggestion",v,[]);class G extends v{constructor(K,L=null,R,S,N=null){super(K,0,L,R,S);this.metadata=N;this.hPi=!1}iSa(K){this.hPi||(this.hPi=
!0,this.metadata&&a.a(z.a.Kal,!0,0,this.metadata.concat([Object.assign(new k.a,{name:"ID",string:this.id.toString()})])));super.iSa(K)}}Object(D.a)(G,"InconsistencySuggestion",v,[]);class M extends v{constructor(K,L=null,R,S=!1,N){super(K,4,L,R,S);this.HBn=N}iSa(K){this.AFo=K;super.iSa(K)}}Object(D.a)(M,"DesignerPasteSuggestion",v,[])},1548:function(D,I,c){c.d(I,"a",function(){return l});const l={YGh:"CommentDeepLinkNavigationFailed",jHd:"CommentDataLoss",a5b:"CommentExperienceDegraded",pkf:"CommentsFeatureUsage",
A9e:"CommentThreadInProgress",yHd:"CommentReplyInProgress",aHh:"CommentEditInProgress",kHd:"CommentDeepLink",WGh:"CommentCommit",b5b:"CommentLoad",pHh:"CommentInitialization"}},1549:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e,a,k,x=!1,y=!1,m=!1,t=!1,z=null){this.ul=e;this.source=a;this.WRa=k;this.uga=x;this.lmc=y;this.yjf=m;this.fPa=t;this.Qo=z}}Object(D.a)(l,"ContextualIntentInvocationParameters",null,[])},1550:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);
class l{constructor(e,a,k,x,y=null,m=null,t=null,z=0,v=0){this.l5=this.tnc=this.PHa=this.bS=null;this.QH=z;this.Pce=e;this.cTa=a;this.M8a=k;x&&(this.bS=x);null!=y&&(this.PHa=y);null!=m&&(this.tnc=m);t&&(this.l5=t);this.shapeId=v}}Object(D.a)(l,"AnchorData",null,[])},1554:function(D,I,c){c.d(I,"a",function(){return v});D=c(0);var l=c(19),e=c(192),a=c(10),k=c(537),x=c(43),y=c(17),m=c(23),t=c(237),z=c(8);class v{constructor(H,F,G,M,K){this.dIb=H;this.m3a=F;this.bxb=G;this.Tla=M;this.Md=K;this.u5g=0;
this.tbb=null;this.Jik=!1;this.c5g=!0;this.T_g=null;this.f1c=this.Iqd=!0;this.i1g=!1;this.AAc=H?H.innerText:z.ParagraphReader.text(F)}get bD(){throw Error.notImplemented("The inherit class should have the default value.");}set bD(H){}get PKb(){return this.u5g}Zoj(H){this.u5g=H}get lb(){return this.tbb}set lb(H){this.tbb=H}get VG(){return this.bxb}get d1(){return this.Tla}get oyi(){return this.i1g}get sEi(){return!1}get Jya(){return this.AAc}get $uo(){return!0}invoke(){this.i1g=!0;if(this.dIb&&this.dIb.parentNode&&
!this.bD){var H=this.dIb.innerText;if(this.f1c&&l.a.substring(this.AAc,this.bxb,this.Tla)!==l.a.substring(H,this.bxb,this.Tla))return 0;this.aEb(this.dIb);this.Zoj(this.dIb.innerText.length-H.length);return 1}this.Iqd||e.a.instance.Yb("MatchTextIsNotTheSame",{["Reason"]:"MatchTextIsNotTheSame"});if(!this.c5g)return e.a.instance.Yb("AbortedAction",{["Reason"]:this.T_g}),0;var F=z.ParagraphReader.text(this.m3a);H=F.length;var G=this.AAc.length,M=l.a.substring(this.AAc,this.bxb,this.Tla).trimEnd();F=
l.a.substring(F,this.bxb,this.Tla).trimEnd();this.$uo&&M===F&&this.Tla>G&&(this.Tla=G);if(this.f1c&&M!==F)if(G=M.replace(RegExp('"',"g"),""),G===l.a.substr(F,0,G.length))this.Tla-=2;else return 0;if(a.App.zd.Uo&&k.CoauthLockEditor.getInstance().g8a(v.Yf.y9b(this.m3a)))return 0;G=new x.GraphTransaction(15);G.Db(this.m3a);G.Uj=this.commandId;this.Xna(this.m3a);this.Zoj(z.ParagraphReader.textLength(this.m3a)-H);this.tbb&&!this.Jik&&y.SelectionEditor.Pl(this.tbb)&&(F=this.tbb.Pa,H=F.cpBegin,M=F.cpEnd,
F=F.node,F===this.m3a&&this.PKb&&(H>=this.Tla&&(H+=this.PKb),M>=this.Tla&&(M+=this.PKb),this.tbb=m.SelectionFactory.lJ(F,H,M)));G.dispose();return 2}DJj(){this.Iqd=this.XDh()}aEb(){}XDh(){var H=z.ParagraphReader.text(this.m3a);const F=l.a.substring(this.AAc,this.bxb,this.Tla).trimEnd();H=l.a.substring(H,this.bxb,this.Tla).trimEnd();return F===H}static get Yf(){return t.a.instance}}Object(D.a)(v,"AAutoCorrectAction",null,[561])},1555:function(D,I,c){c.d(I,"a",function(){return a});D=c(0);var l=c(26),
e=c(7);class a{constructor(k){this.ul=k}static create(k){if(!k)return e.ULS.shipAssertTag(575930373,3016,!1),null;k=l.a.create(k);return new a(k)}}Object(D.a)(a,"ShowReviewArgs",null,[])},1556:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.data=this.landingTab=null}}Object(D.a)(l,"LaunchData",null,[])},1560:function(D,I,c){c.d(I,"c",function(){return a});c.d(I,"a",function(){return k});c.d(I,"b",function(){return x});D=c(0);var l=c(1545);class e{constructor(y,m,
t){this.suggestion=y;this.Kq=m;this.paragraphNode=t}get role(){switch(this.Kq){case 1:case 3:return 27;case 2:return 28;default:return 1}}}Object(D.a)(e,"AddEnhancementActionData",null,[]);class a extends e{constructor(y,m,t,z,v,H=1){super(y,H,m);this.Q6a=t;this.T4c=z;this.callback=v}}Object(D.a)(a,"AddPullQuoteActionData",e,[]);class k extends e{constructor(y,m,t=0){super(y,2,m);this.epa=t}}Object(D.a)(k,"AddCoverPhotoActionData",e,[]);class x{constructor(y,m,t,z,v){this.suggestion=y;this.ps=m;this.Qbc=
t;this.xVc=z;this.ADd=v}get annotationType(){switch(this.suggestion.Kq){case 1:case 3:return l.a.Y3f;case 2:return l.a.ikg;default:return l.a.iQh}}get qSa(){return this.ps&&1<=this.ps.length?this.ps[0]:null}}Object(D.a)(x,"AddDesignerSuggestionActionData",null,[])},1564:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}Object(D.a)(l,"OAuthResult",null,[])},1565:function(D,I,c){c.r(I);c.d(I,"FindManagerHelper",function(){return y});D=c(0);var l=c(7),e=c(112),a=c(10),k=c(177),x=c(1067);
c=c(1849);class y extends c.a{constructor(){super()}get Zc(){return a.App.za.jb.Zc}get rj(){return a.App.za.jb.Zc.xd}get Fpa(){return a.App.za.jb.Fpa()}get aEf(){return a.App.za.jb.rc.Zi}x_e(m){a.App.si.Il.UNa(m)}w5d(m,t,z){return x.b(m,t,z)}hog(m,t,z){if(1===z){if(!y.hi.iog(m))return!1}else if(!(m.Xe===t||m.zb(t)&&m.jd(t)))return!1;return Object(e.a)(64,m.currentNode)||this.w5d(m,t,z)?!0:!1}tFa(m){return this.rj.Eb(m).tFa()}TBi(m,t,z,v){if(!m||m.matchCase!==z.matchCase||m.matchWholeWord!==z.matchWholeWord||
v.length!==t.length)return!0;for(m=0;m<v.length;m++){if(v[m]!==t[m])return!0;if(z.matchCase){if(v[m]!==t[m])return!0}else if(v[m].toLocaleLowerCase()!==t[m].toLocaleLowerCase())return!0}return!1}cCi(m,t,z,v){if(!m||m.matchWholeWord&&!z.matchWholeWord||m.matchCase&&!z.matchCase||v.length!==t.length)return!1;if(m.matchWholeWord)return m.matchCase?t[0]===v[0]:v[0].toLocaleLowerCase()===t[0].toLocaleLowerCase();for(let H=0;H<v.length;H++)if(m.matchCase){if(!v[H].startsWith(t[H]))return!1}else if(!v[H].toLocaleLowerCase().startsWith(t[H].toLocaleLowerCase()))return!1;
m.matchCase===z.matchCase&&m.matchWholeWord===z.matchWholeWord&&1===t.length&&l.ULS.sendTraceTag(4069025,313,50,"{0}",{["IncrementalSearchTriggeredQueryLength"]:z.text.length});return!0}mde(m,t,z){const v=a.App.si.Il.Ue(12);v.Eo(m);v.ju(t);v.Vw(z)}static get hi(){return k.PageNavigator.instance}static get instance(){y.Zub||(y.Zub=new y);return y.Zub}}y.Zub=null;Object(D.a)(y,"FindManagerHelper",c.a,[])},1566:function(D,I,c){c.d(I,"a",function(){return e});D=c(0);var l=c(2);class e{constructor(){this.currentDocumentPath=
l.AFrameworkApplication.K.kb("EditDocInClientUrl")}}Object(D.a)(e,"SmartLookupApplicationInterface",null,[])},1567:function(D,I,c){c.d(I,"a",function(){return R});D=c(0);var l=c(736),e=c(5),a=c(1798),k=c(1840),x=c(1841),y=c(199),m=c(8),t=c(43),z=c(141),v=c(177),H=c(549),F=c(6),G=c(599),M=c(78),K=c(163),L=c(536);class R{constructor(S,N,O,W,V){R.WZd=!1;this.GE=S;this.KNe=N;this.JNe=O;this.Yc=W;this.$3j=V}jjo(S,N){this.GE.xpa(S)&&S.properties.setValue(F.a.soa,N)}Y7b(){if(!R.WZd){var S=this.eei();for(var N=
S.Ub(7);N;N=S.Ti(7))for(N=S.Ub(8);N;N=S.Ti(8));R.WZd=!0}}eei(){const S=this.Yc.Ek();S.set(this.$3j());R.hi.IP(S);return S}Yu(){const S=this.eei();this.JNe.x5d(S);this.O3n(S.currentNode);R.WZd=!1}NIn(S){this.Y7b();if(S.isConnected){var N=this.G4(S);if(N=this.GE.BQc(S,N)){var O=this.Yc.Ek();O.set(N);O.zb(25);S.anchor&&(O.set(S),O.zb(37),O.zg())}}}Rwl(S,N){if(S.zb(25)&&S.jd(25)&&!S.Jt(7)){const O=e.GraphIterator.eb(N);O.zb(37);O.jd(37);N=G.b(O.currentNode,N.Yi().Mc,!0);S.Bf(N,7)}}ezl(S,N,O,W){S=new a.a(e.GraphIterator.eb(S),
e.GraphIterator.eb(N),{});S.RQb=!0;O=new l.a(O,W,new k.a(S,null));O.Qh=!0;O.Rl("ExecuteInternalFootnoteEndnoteCopy");O.run()}vaf(S,N){N=N.Lb.paragraph;var O=N.Yi().xd;O=G.b(S,O,!0);N=e.GraphIterator.eb(N);this.Rwl(N,S);N.Ub(7);N.Bf(O,8);return O}z4c(S,N,O,W){this.Y7b();const V=this.G4(S);if(!this.GE.BQc(this.GE.pei(S),V))return null;N=this.vaf(S,N);this.ezl(S,N,O,W);return N}E4c(S,N,O,W){this.Y7b();var V=N.Lb.paragraph;const Q=V.Yi().xd;V=e.GraphIterator.eb(V);V.zb(7);V.jd(7);this.u5d(V,N.G4());N=
G.b(S,Q,!0);V.Bf(N,8);this.fzl(S,N,O,W);return N}fzl(S,N,O,W){S=new x.a(e.GraphIterator.eb(S),e.GraphIterator.eb(N),null,null);O=new l.a(O,W,S);O.Qh=!0;O.Rl("ExecuteInternalFootnoteEndnotePaste");O.run()}u5d(S,N){S.Ub(7);this.GE.Byi(S,N)||S.Mf(7)}rbi(S,N){const O=this.Yc.Ek();O.set(N);O.zb(7);O.jd(7);this.u5d(O,S);return O}Xci(S,N,O){return this.fdi(S,N,O,!1)}Y$l(S,N,O){return this.fdi(S,N,O,!0)}fdi(S,N,O,W){var V=this.Yc.Ek();let Q=null,Y=!1;V.set(S);V.Ip();V.jd(8);V.Rd();for(V=y.a.Gs(V,V.$dd(8));V.moveNext();){if(m.ParagraphReader.Xb(V.currentNode)){const Z=
V.currentNode;var ba=M.i(Z,7);for(const ea of ba){if(Z===S){ba=ea.Lb.cp;if(W&&ba>=N)return Q;ba>=N&&-1!==N&&(Y=!0)}if(ea.G4()===O){if(!W&&Y)return ea;Q=ea}}Z===S&&(Y=!0)}if(W&&Y)return Q}return null}O3n(S){const N=new t.GraphTransaction(3);N.Db(S);S=y.a.gp(R.hi.su(S));let O=1,W=1;for(;S.moveNext();){var V=S.currentNode;if(V&&m.ParagraphReader.Xb(V)){V=M.i(V,7);for(const Q of V){V=Q.H4();const Y=Q.G4()?O++:W++;this.jjo(V,Y)}}}N.dispose()}G4(S){return this.GE.xpa(S)?S.properties.getValue(F.a.y4):0}static wZl(){return new R(L.a.instance,
z.PageReader.instance,v.PageNavigator.instance,new H.a,R.uMl)}static uMl(){return K.App.nn.jb.Zc}static get hi(){return v.PageNavigator.instance}static get instance(){return null!=R.hCg?R.hCg:R.hCg=R.wZl()}}R.WZd=!1;Object(D.a)(R,"FootnoteEndnoteEditorInteractive",null,[614])},1568:function(D,I,c){c.d(I,"a",function(){return S});D=c(0);var l=c(115),e=c(2),a=c(551),k=c(242),x=c(339),y=c(1543),m=c(784),t=c(305),z=c(507),v=c(640);c.n(v);var H=c(870);c.n(H);var F=c(612),G=c(1076),M=c(1679),K=c(105),L=
c(871),R;(function(N){N[N.Spelling=0]="Spelling";N[N.Grammar=1]="Grammar";N[N.Style=2]="Style";N[N.iqc=3]="Similarity";N[N.Ctg=4]="ContextIQ";N[N.$Mj=5]="AutoReplace";N[N.Ftg=6]="CopilotHighlight"})(R||(R={}));Object(D.b)("AnnotationRenderCategory",R);class S{static mUl(N){switch(S.cUd(N)){case R.Spelling:N=y.a.Oig;break;case R.Grammar:N=y.a.Y$e;break;case R.iqc:N=60!==N.M_.state&&70!==N.M_.state?y.a.Ntj:y.a.Ltj;break;case R.Ctg:if(M.a.dDi(N))return;N=y.a.ECd;break;case R.$Mj:N=y.a.WDd;break;case R.Ftg:N=
y.a.qKh;break;default:N=y.a.ECd}return N}static sjm(N){switch(S.cUd(N)){case R.Spelling:return t.f.SpellingSquiggle;case R.Grammar:return t.f.GrammarSquiggle;default:return t.f.CritiqueSquiggle}}static cUd(N){let O;if(S.uYc(N)){switch(N.priority){case 0:O=R.Spelling;break;case 1:O=R.Grammar;break;default:O=R.Style}Object(L.b)()&&this.UYd(N)&&(O=R.Ftg)}else S.Udc(N)?O=R.iqc:S.CWc(N)&&(O=R.Ctg);return O}static UYd(N){return k.a.getTypeNameFor(N)===v.AddInTextAnnotation.getTypeName()}static uYc(N){const O=
k.a.getTypeNameFor(N);return O===x.a.getTypeName()||O===m.a.getTypeName()||Object(L.b)()&&this.UYd(N)}static CWc(N){return k.a.getTypeNameFor(N)===H.FlagAnnotation.getTypeName()}static Udc(N){return k.a.getTypeNameFor(N)===a.a.getTypeName()}static Y0d(N){return S.uYc(N)?0===N.priority:!1}static n_d(N){return S.uYc(N)?1===N.priority:!1}static vHm(N){return k.a.getTypeNameFor(N)===m.a.getTypeName()}static ADf(N){return null!=N&&"Spelling"===N.categoryName&&1===N.suggestions.length&&4===(N.suggestions[0].suggestionActions&
4)}static fgm(N,O){const W=[t.b.IgnoreOnce];switch(N){case 0:W.push(t.b.IgnoreAll);O&&W.push(t.b.AddToDictionary);break;case 1:W.push(t.b.Options)}return W}static u6h(N){return S.uYc(N)?N.categoryName:S.Udc(N)?S.Jtj:S.CWc(N)?S.KGl:null}static Guf(N,O){let W=z.a.ylc;switch(N){case 0:W=O?z.a.die:z.a.Tpj;break;case 1:W=z.a.Spj}return W}static j9b(N,O=!1,W){W="IntentProvider_Suggestion_"+W;let V=l.a.Eb(N,W);O&&!V&&l.a.Sl(N,W,V=new F.a);return V}static myf(N,O,W,V,Q,Y,ba,Z,ea=!1,ha){V&&W&&(!(W=Y.F4h(W,
Q))||!G.a.qRa()&&e.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)&&this.cUd(W)==R.Style||(ba.XMd(N,O,Z),S.j9b(N,!0,ha).add(W.id),O=S.mUl(W),N.classList.add(O),S.cTb&&S.yZe(N,W),ea&&G.a.K_c()))}static get cTb(){return null!=S.sJg?S.sJg:S.sJg=e.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AriaInvalidForSpellingGrammar",!1)}static yZe(N,O){S.Y0d(O)?N.setAttribute("aria-invalid","spelling"):S.n_d(O)&&N.setAttribute("aria-invalid",
"grammar")}static oRa(N,O,W){N=(N=S.j9b(N,!1,W))?K.firstOrDefault(N):null;return{returnValue:!!N,type:N?W:null,data:N}}}S.Jtj="Similarity";S.KGl="FlagAnnotation";Object(D.a)(S,"AnnotationHelper",null,[])},1574:function(D,I,c){D=c(0);class l{static i6l(){return l._nextEventReceiverId++}}l._nextEventReceiverId=0;Object(D.a)(l,"EventReceiverIdCounter",null,[]);c.d(I,"a",function(){return e});class e{constructor(a,k){this.VWb=a;this._id=l.i6l();this.Ghk=k}get id(){return this._id}notify(a,k){this.Ghk(a,
k)}lP(a,k){return this.VWb.MLn(a,k?this:null)}}Object(D.a)(e,"EventReceiver",null,[315])},1578:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}l.open="open";l.refresh="refresh";l.Vag="saveAs";l.translate="translate";l.modeSwitch="modeSwitch";l.Lbf="createNew";Object(D.a)(l,"ReasonList",null,[])},1579:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{static Mcd(e){if(!e)return"{NULL}";const a=e.length;if(600>=a)return e;const k=a-195;return e.substring(0,400)+"[...]"+e.substring(k,
a)}}Object(D.a)(l,"LogUtils",null,[])},1580:function(D,I,c){c.d(I,"b",function(){return l});c.d(I,"a",function(){return e});c.d(I,"c",function(){return a});const l=(k,x,y,m,t,z,v,H)=>{var F=1;if(!k&&!x||!y||!m)return F;t&&z?(z=y+k,F=m+x,k=1/y,x=1/m,t=k>x?k:x,1>z?z=1:1920<z&&(z=1920),1>F?F=1:1280<F&&(F=1280),k=z-y,x=F-m,H?(y=z/y,m=F/m,F=Math.abs(y-v)<Math.abs(m-v)?y:m):F=Math.abs(k/y)>Math.abs(x/m)?z/y:F/m,F<t&&(F=t)):t?(v=y+k,1>v?v=1:1920<v&&(v=1920),F=v/y):z&&(v=m+x,1>v?v=1:1280<v&&(v=1280),F=v/
m);return F},e=(k,x)=>{k=Math.atan2(x.y-k.y,x.x-k.x);0>k&&(k+=2*Math.PI);return k},a=k=>{k%=360;0>k&&(k+=360);return k}},1581:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}Object(D.a)(l,"SmartLookupSelection",null,[])},1583:function(D,I,c){c.d(I,"a",function(){return L});D=c(0);var l=c(22),e=c(902),a=c(549),k=c(32),x=c(177),y=c(6),m=c(46),t=c(16),z=c(7),v=c(112),H=c(69),F=c(54),G=c(479),M=c(148),K=c(1068);class L{constructor(R,S,N,O,W,V){this.Xok=R;this.we=S;this.Swf=N;this.uZb=
O;this.Z4j=W;this.Y4j=V}get Mk(){return null!=this.RHg?this.RHg:this.RHg=l.a.instance.resolve("WordEditor.ITableEditor")}get Qd(){return null!=this.SIg?this.SIg:this.SIg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Ej(){return null!=this.zIg?this.zIg:this.zIg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get ATb(){return this.Xok.value}get Fed(){return this.we.value}vZk(R){const S=this.ATb.AUd(R,e.a.dMb);S&&(this.CQb(S,R),this.Kza(1696,
R))}CQb(R,S,N=!0){const O=this.ATb.WRc(S);if(O&&(R=this.Fed.Ag(R),O.oj(R))){const W=this.ATb.q0(S);let V="Unknown";this.ATb.QZa.value&&(V=this.ATb.QZa.value.nb(R)?R:"CustomStyle");z.ULS.sendTraceTag(0,311,50,"{0}",{["ApplyTableStyleId"]:V,["RowCount"]:this.Z4j(S),["ColumnCount"]:this.Y4j(S),["HR"]:!!(W&32),["FC"]:!!(W&128),["TR"]:!!(W&64),["LC"]:!!(W&256),["BR"]:!(W&512),["BC"]:!(W&1024),["TableId"]:S.id.toString()});N&&this.BUa(S);this.g_o(S,O);N=O.oj(R);S.properties.setValue(y.a.tableStyle,N.id);
this.tZk(S);S.Z_.kia(!0)}}Khe(R,S,N){if(R=this.ATb.AUd(N,R))this.Kza(S,N),this.CQb(R,N)}Kza(R,S,N=!0){N&&this.BUa(S);S.properties.setValue(y.a.tableLook,R);z.ULS.sendTraceTag(0,311,50,"{0}",{["HR"]:!!(R&32),["FC"]:!!(R&128),["TR"]:!!(R&64),["LC"]:!!(R&256),["BR"]:!(R&512),["BC"]:!(R&1024),["TableId"]:S.id.toString()});S.Z_.kia(!0)}g_o(R,S){(R=this.uZb(R))&&S.Lhe(R)}tZk(R){if(R.isConnected){R.hasProperty(m.a.ux)&&R.removeProperty(m.a.ux);this.U0n(R);this.kbj(R);R=this.Swf.Rf(R);for(var S=R.Ub(1);S;){for(S=
R.Ub(1);S;)S.hasProperty(t.a.UK)&&S.removeProperty(t.a.UK),S.hasProperty(y.a.nJa)&&S.removeProperty(y.a.nJa),this.dpb(S),this.kbj(S),S=R.Ti(1);S=R.Ti(1)}}}NUd(R){let S=R.ja(m.a.x6a,null);if(S)return S;if(R=this.Fed.Ag(R))if(S=({value:S}=this.ATb.QZa.value.Fc(R,S)).returnValue?S:null)return S;return R}Rgo(R,S,N,O,W){R.properties.setValue(S.style,N);R.properties.setValue(S.size,O*M.a.yHc);R.properties.setValue(S.color,W)}BUa(R){if(this.Qd.xg){var S;Object(v.a)(G.a,R)&&(S=Object(H.a)(G.a,R))&&(S=S.oV())&&
this.Ej.BUa(R,S)}}U0n(R){R.Cg(y.a.Xa,y.a.Ya,y.a.Wza,y.a.pb,y.a.qb,y.a.Uza,y.a.Va,y.a.Wa,y.a.Tza,y.a.rb,y.a.tb,y.a.Vza,y.a.ub,y.a.vb,y.a.kJa,y.a.Nb,y.a.Ob,y.a.lJa)}dpb(R){R.Cg.apply(R,this.Mk.LCh)}kbj(R){R.Cg(y.a.Fa,y.a.Aa,y.a.Ba,y.a.Da,y.a.oS,y.a.IV,y.a.eVa,y.a.dVa)}static dhm(){return new L(l.a.instance.Ve("WordEditor.IWACTableStyleReader"),l.a.instance.Ve("Box4.Styles.IWACStyleReader"),new a.a,Object(F.a)(L.hi,L.hi.su,"navigateToPageContentNode"),k.TableReader.gg,k.TableReader.hh,K.a.instance)}static get hi(){return x.PageNavigator.instance}static get instance(){return null!=
L.fDg?L.fDg:L.fDg=L.dhm()}}Object(D.a)(L,"WACTableStyleEditor",null,[500,501])},1590:function(D,I,c){I=c(1981);c=c(1982);c.Rup=I;c.Tup=c;D.exports=c},1597:function(D,I,c){c.d(I,"a",function(){return a});D=c(0);var l=c(177),e=c(249);class a{Q5a(k){a.hi.IP(k);return k.Ub(16)}static Xr(){return new e.a(()=>new a)}static get instance(){return a._instance.value}static get hi(){return l.PageNavigator.instance}}a._instance=a.Xr();Object(D.a)(a,"CommentNavigator",null,[365])},1598:function(D,I,c){c.d(I,"a",
function(){return l});D=c(0);class l extends Sys.EventArgs{constructor(){super();this.sVi=this.tHa=null}}Object(D.a)(l,"OnCommentInitArgs",Sys.EventArgs,[])},1599:function(D,I,c){c.d(I,"a",function(){return G});D=c(0);var l=c(7),e=c(10),a=c(537),k=c(36),x=c(60),y=c(2065),m=c(2),t=c(1534),z=c(1548),v=c(119),H=c(603),F=c(1525);class G{static P6m(){const M=document.getElementsByClassName(H.a.OZf);if(M&&M.length){var K=M[0].clientWidth;for(let L=1;L<M.length;L++){if(M[L].clientWidth!==K||L===M.length-
1){l.ULS.sendTraceTag(540160401,327,50,"{0}:NoOfContainers={1}",M[L].clientWidth-K,M.length);break}K=M[L].clientWidth}}}static yug(M,K,L){M&&(M=e.App.zd.fq.psf(M),a.CoauthLockEditor.getInstance().g8a(M)&&l.ULS.sendTraceTag(540160402,327,15,`Comment with ObjectId: ${K.objectId} added to a locked ${L?"start":"end"} paragraph. Lock Type ${M.Type.toString()}`))}static X2o(M,K,L){var R=K.Eb(x.a.If(M.objectId));if(R){var S=t.a.vca(R,K,!0);K=t.a.vca(R,K,!1);null!==S&&void 0!==S&&S.fv||(S=F.k(R),l.ULS.sendTraceTag(540160404,
327,15,`CommentRangeStart failed to save. startParaId: ${S}, CommentObjectId: ${M.objectId}`),G.vKi(L));null!==K&&void 0!==K&&K.fv||(R=F.h(R),l.ULS.sendTraceTag(540160405,327,15,`CommentRangeEnd failed to save. endParaId: ${R}, CommentObjectId: ${M.objectId}`),G.vKi(L))}else l.ULS.sendTraceTag(540160403,327,15,`Commited Comment missing CommentNode graph object ObjectId: ${M.objectId}`)}static vKi(M){M.logKpiFailure(z.a.WGh,"CommentReferenceFailedToSave",{isIntentional:!1,isInternal:!0},{name:z.a.jHd,
isIntentional:!1,isInternal:!0,isSessionEndingError:!1})}static E6m(M,K,L){0!==M.size&&M.forEach(R=>{K.has(R)||G.F6m(R,L)})}static F6m(M,K){K.Eb(x.a.If(M))&&l.ULS.sendTraceTag(539800642,327,15,`comment start missing for ${M}`)}static qWk(M){const K=new Set;M.forEach(L=>{L&&L.xj&&((L=G.a8l(L))?K.add(L):l.ULS.sendTraceTag(539554689,327,15,"Outline Node is undefined"))});K.forEach(L=>{const R=L.ja(v.a.E9e,[]);0===L.ja(v.a.C9e,[]).length&&0===R.length&&l.ULS.sendTraceTag(539800644,327,15,`Outline Element Node ${L.id.toString()} is missing comment info while paragraph has comments. This will cause some comments to fail to load.`)})}static vXm(M,
K,L,R){M=L.w7h(M);if(!M)return!1;L=F.k(M,x.a.nil);R=R.Eb(L);K.has(L.toString())&&l.ULS.sendTraceTag(539800643,327,15,`Para Node ${L} missing comment reference for comment ${M.id}`);return R&&R.xj?!0:(l.ULS.sendTraceTag(539567714,327,15,`Para Node ${L} with missing comment reference for comment ${M.id} is in a invalid state ${R?"paraNode containingGraph is null":"paraNode is null"}`),!1)}static a8l(M){let K;try{K=k.OutlineElementNavigator.El(M)}catch(L){l.ULS.sendTraceTag(539567715,327,10,`ParaNode ${M.id} OutlineNode failed to retrieve ${L}`)}return K}static xWl(M){var K;
switch(null===(K=M.Bz)||void 0===K?void 0:K.sessionType){case y.a.create:return z.a.A9e;case y.a.reply:return z.a.yHd;case y.a.edit:return z.a.aHh}}static ODh(M){if(m.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckForDuplicateReactionUsers",!0)&&(M=M[1])&&0!==M.length){var K=new Set;for(let L=0;L<M.length;L++)K.add(M[L].UserId);M.length>K.size&&l.ULS.sendTraceTag(521458447,327,15,`Reaction UserList has duplicates: ${M.length-K.size}`)}}}Object(D.a)(G,"CommentDiagnosticHelpers",
null,[])},1600:function(D,I,c){c.d(I,"a",function(){return e});D=c(0);var l=c(7);class e{constructor(a){this.wj=a}get Fk(){return this.wj&&this.wj.Zi?this.wj:null}gUa(a,k){return this.Fk?this.Fk.K6e(a,!0)?this.Fk.gUa(a,k,!0,!0,!1):(l.ULS.sendTraceTag(579396803,377,15,"ScrollToHighlightParagraph: unable to scroll to desired paragraph"),null):null}}Object(D.a)(e,"PageViewWrapper",null,[])},1601:function(D,I,c){c.d(I,"a",function(){return y});D=c(0);var l=c(56),e=c(174),a=c(7),k=c(82),x=c(61);class y{constructor(m,
t,z){a.ULS.shipAssertTag(6305502,307,!!m);this.properties=m;this.Ic=t;this.xT=z}Kei(){return this.properties.ja(e.a.NP,"")}D3i(){return!0}xCj(){let m=!1,t=null;const z=this.Kei();if(this.xT||""!==z)try{({Yva:t,returnValue:m}=this.voc(z))}catch(v){a.ULS.shipAssertTag(4203138,307,!1),this.Ic.Yb(k.a.moa,{["Reason"]:x.a.s5e}),l.a.U_(t)}else a.ULS.sendTraceTag(3994443,307,50,"PastedHTMLString empty"),this.Ic.Yb(k.a.f2,{["Reason"]:x.a.Sjf});return{returnValue:m,jId:t}}}Object(D.a)(y,"AStringInputImportStrategy",
null,[716])},1602:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.kaa=[]}f8h(){const e=new l;for(let a=0;a<this.kaa.length;a++)e.add(this.J(a));return e}get count(){return this.kaa.length}J(e){return this.kaa[e]}Z(e,a){return this.kaa[e]=a}add(e){this.kaa.push(e)}clear(){Array.clear(this.kaa)}contains(e){return Array.contains(this.kaa,e)}getRange(e,a){const k=new l;for(let x=0;x<a;x++)k.add(this.J(e+x));return k}indexOf(e){return Array.indexOf(this.kaa,e)}insert(e,
a){Array.insert(this.kaa,e,a)}remove(e){return Array.remove(this.kaa,e)}removeAt(e){Array.removeAt(this.kaa,e)}removeRange(e,a){for(let k=0;k<a;k++)Array.removeAt(this.kaa,e)}reverse(){this.kaa.reverse()}sort(){this.kaa.sort()}toArray(){return Array.clone(this.kaa)}}Object(D.a)(l,"List",null,[])},1604:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}l.generalException="GeneralException";l.invalidArgument="InvalidArgument";l.notImplemented="NotImplemented";l.GAb="AccessDenied";l.uYm=
"ItemNotFound";l.notSupported="NotSupported";l.apiNotAvailable="ApiNotAvailable";l.notAllowed="NotAllowed";l.Jxn="OperationCancelled";l.userNotSignedIn="UserNotSignedIn";l.userAborted="UserAborted";l.invalidResourceUrl="InvalidResourceUrl";l.invalidGrant="InvalidGrant";l.clientError="ClientError";l.serverError="ServerError";Object(D.a)(l,"ErrorCodes",null,[])},1605:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e){this.id=e}}Object(D.a)(l,"DesignerPaneToggleData",null,
[])},1607:function(D,I,c){c.d(I,"a",function(){return x});D=c(0);var l=c(1882),e=c(549),a=c(6),k=c(1067);class x{constructor(y){this.gYl=(m,t)=>{const z=this.Bgi(m),v=this.Yc.Rf(t);return v.zb(z)?(v.jd(z),new l.a(v.currentNode,t,m)):null};this.fYl=(m,t)=>{let z=null,v=null;const H=this.Bgi(m);t=this.Yc.Rf(t);({rootNode:z,oka:v}=this.eno(t,m,H,z,v));return z&&v?new l.a(z,v,m):null};this.kYl=m=>{m=this.Yc.Rf(m);return(this.F9(2)||this.F9(4))&&m.zb(36)?(m.jd(36),this.TEl(m.currentNode)):(this.F9(8)||
this.F9(16))&&m.zb(37)?(m.jd(37),this.A0h(m.currentNode)):this.F9(32)&&m.zb(40)?32:this.F9(1)&&m.zb(8)?1:0};this.Yc=y;this.UEl=this.kYl;this.FEl=this.gYl;this.EEl=this.fYl;this.kFl=31;this.okg=this.oYl()}W9h(y){const m=[],t=this.UEl(y);if(t){var z=this.FEl(t,y);z&&(m[m.length]=z)}for(const v of this.okg)v!==t&&v&&(z=this.EEl(v,y))&&(m[m.length]=z);return m}F9(y){return!!y&&!!(this.kFl&y)}eno(y,m,t,z,v){if(y.zb(7)){y.jd(7);if(8===t||37===t||39===t)for(var H=y.Rd();H;){if(H.type===t)if(37===t){if((8===
m||16===m)&&m===this.A0h(H)){z=y.currentNode;break}}else{z=y.currentNode;break}H=y.Oj()}z&&y.Iz()&&(H=this.Yc.Rf(z),k.b(H,t,m)&&(v=y.currentNode))}return{rootNode:z,oka:v}}oYl(){const y=[];this.F9(1)&&(y[y.length]=1);this.F9(2)&&(y[y.length]=2);this.F9(4)&&(y[y.length]=4);this.F9(8)&&(y[y.length]=8);this.F9(16)&&(y[y.length]=16);this.F9(32)&&(y[y.length]=32);return y}Bgi(y){let m=8;switch(y){case 1:case 2:case 4:m=8;break;case 8:case 16:m=37;break;case 32:m=39}return m}A0h(y){y=y.properties.getValue(a.a.y4);
return this.F9(8)&&1===y?8:this.F9(16)&&!y?16:0}TEl(y){y=y.getValue(a.a.Kac);return this.F9(2)&&x.$Nm(y)?2:this.F9(4)&&x.wNm(y)?4:0}static gF(){return new x(new e.a)}static get instance(){return null!=x.nCg?x.nCg:x.nCg=x.gF()}static $Nm(y){return y&&1!==y&&2!==y?!1:!0}static wNm(y){return 3===y||4===y||5===y?!0:!1}}Object(D.a)(x,"WordFindContextHelper",null,[310])},1615:function(D,I,c){c.d(I,"a",function(){return a});D=c(0);var l=c(93),e=c(1541);class a{constructor(k){this.taskManager=k}owa(k,x){const {priority:y=
2,delay:m=0}=null!==x&&void 0!==x?x:{},t=new e.a,z=async()=>await k();x=new l.a(y,1,m,()=>{z().then(t.resolve).catch(t.reject)});this.taskManager.Wb(x);return t.completion}}Object(D.a)(a,"TaskDispatcher",null,[])},1616:function(D,I,c){c.d(I,"a",function(){return k});D=c(0);var l=c(139),e=c(2),a=c(7);class k{constructor(x,y){this.TQ=x;this.tZ=y}dK(x,y,m){x={["appId"]:2155,["manifestType"]:"Fps",["submitTime"]:(new Date).toISOString(),["source"]:"Client",["type"]:"Survey",["clientFeedbackId"]:l.a.create().toString(),
["email"]:y,["application"]:{["appData"]:"{}",["extendedManifestData"]:JSON.stringify({["surveySpecificData"]:JSON.stringify(m)})},["survey"]:{["surveyId"]:x},["telemetry"]:this.Y_a(),["web"]:this.MBb()};this.Bja(JSON.stringify(x),{["Content-Type"]:"application/json"})}Y_a(){const x=e.AFrameworkApplication.sessionStartInfoSettings;return{["officeBuild"]:e.AFrameworkApplication.buildVersion,["featureArea"]:"EditorAi",["audienceGroup"]:x.AudienceGroup,["osBuild"]:x.OsVersion,["platform"]:x.Platform,
["processSessionId"]:x.WACSessionID,["flights"]:e.AFrameworkApplication.K.kb("FlightId"),["loggableUserId"]:e.AFrameworkApplication.K.kb("LoggableUserId"),["tenantId"]:e.AFrameworkApplication.K.kb("TenantId")}}Bja(x,y,m=0){3<m||this.tZ.owa(()=>{this.TQ.mj("https://petrol.office.microsoft.com/v1/feedback",2,x,y,!1,2,()=>{a.ULS.sendTraceTag(509207132,3041,50,"Success sending OCV feedback for EditorAi")},()=>{this.Bja(x,y,m+1);a.ULS.sendTraceTag(509207131,3041,50,"Failure sending OCV feedback for EditorAi, attempt {0}",
m)},null)},{delay:this.xVl(m)})}xVl(x=0){let y=0;1===x?y=200:1<x&&(y=200+500*(x-1));return y}MBb(){const x=e.AFrameworkApplication.sessionStartInfoSettings;return{["browser"]:x.Browser,["browserVersion"]:x.BrowserVersion,["dataCenter"]:x.WACDatacenter}}}Object(D.a)(k,"EditorAiSurveysApiClient",null,[])},1618:function(D,I,c){c.d(I,"a",function(){return e});D=c(0);class l{constructor(a){this.selectedRating=a}}Object(D.a)(l,"EditorAiRatingData",null,[]);class e{constructor(a,k,x){this.rating=[new l(a)];
this.comment=[k,...x]}}Object(D.a)(e,"EditorAiSurveyData",null,[])},1625:function(D,I,c){var l=c(1550);D=c(0);class e{}Object(D.a)(e,"SerializableAnchorDataV1",null,[]);class a{}Object(D.a)(a,"SerializableCpDataV1",null,[]);var k=c(1001);c.d(I,"a",function(){return x});c.d(I,"c",function(){return y});c.d(I,"b",function(){return m});c.d(I,"d",function(){return t});const x=z=>new l.a(z.RK,z.PS,z.TS,c(1654).versionedDeserialize(z.OS),z.PE,z.TE,c(1654).versionedDeserialize(z.OE),z.DK,z.SI),y=z=>{const v=
new e;v.RK=z.Pce;v.PS=z.cTa;v.TS=z.M8a;v.DK=z.QH;v.SI=z.shapeId;z.bS&&(v.OS=t(z.bS));z.PHa&&(v.PE=z.PHa);z.tnc&&(v.TE=z.tnc);z.l5&&(v.OE=t(z.l5));return v},m=z=>{if(!z)return null;const v=new k.a(z.CP);v.swa=null!=z.FB?z.FB:0;v.uha=null!=z.FE?z.FE:0;v.pva=null!=z.CB?z.CB:0;v.qva=null!=z.CE?z.CE:0;v.MQa=null!=z.HB?z.HB:0;v.eia=null!=z.HE?z.HE:0;v.vza=null!=z.R?z.R:0;v.nwa=null!=z.E?z.E:0;v.aAa=null!=z.TW?z.TW:0;v.Mya=null!=z.PB?z.PB:0;v.symbols=null!=z.SYM?z.SYM:0;v.uxa=null!=z.IE?z.IE:0;v.sya=null!=
z.OO?z.OO:0;v.Eua=null!=z.AX?z.AX:0;v.vva=null!=z.CCI?z.CCI:0;v.dryDeletion=null!=z.DD?z.DD:0;return v},t=z=>{if(!z)return null;const v=new a;v.CP=z.cp;v.VS=1;0<z.swa&&(v.FB=z.swa);0<z.uha&&(v.FE=z.uha);0<z.pva&&(v.CB=z.pva);0<z.qva&&(v.CE=z.qva);0<z.MQa&&(v.HB=z.MQa);0<z.eia&&(v.HE=z.eia);0<z.vza&&(v.R=z.vza);0<z.nwa&&(v.E=z.nwa);0<z.aAa&&(v.TW=z.aAa);0<z.Mya&&(v.PB=z.Mya);0<z.symbols&&(v.SYM=z.symbols);0<z.uxa&&(v.IE=z.uxa);0<z.sya&&(v.OO=z.sya);0<z.Eua&&(v.AX=z.Eua);0<z.vva&&(v.CCI=z.vva);0<z.dryDeletion&&
(v.DD=z.dryDeletion);return v}},1633:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e,a="",k="",x=""){this.IsCurrentUser=!1;this.UserId=e;this.Provider=a;this.DisplayName=k;this.Email=x}}Object(D.a)(l,"CommentTaskPerson",null,[920])},1634:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e,a,k,x,y=!1){this.priority=this.completion=-1;this.type=e;this.user=a;this.time=k;this.recordId=x;this.isLossy=y}}Object(D.a)(l,"HistoryRecord",null,[])},1635:function(D,
I,c){c.d(I,"a",function(){return k});D=c(0);var l=c(503),e=c(393),a=c(480);class k{constructor(){this.gLg=null;this.FY=!1;this.sMb=this.jgb=null;this.$x=new l.a(new e.a);this.gV=new l.a(new e.a);this.E5f=this.nIb=!1;this.VIa=!0}get Bm(){return a.a.Bm}set Bm(x){a.a.Bm=x}get Leb(){return this.gLg}set Leb(x){this.gLg=x}}k.Nj=1;Object(D.a)(k,"CommentsState",null,[])},1636:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}l.yellow="FFFF00";l.Z0m="00FF00";l.TGk="00FFFF";l.iKl="FF00FF";l.blue=
"0000FF";l.red="FF0000";l.wgn="000080";l.Dyj="008080";l.green="008000";l.purple="800080";l.Ean="800000";l.lkn="808000";l.gray="808080";l.cAo="C0C0C0";l.black="000000";Object(D.a)(l,"FontHighlightColorEnum",null,[])},1637:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.Aaa={};this.Aaa.ops=[]}Xca(e){const a=this.Aaa.ops;if(a.length){var k=a.length-1;const x=a[k];if(!x.attributes){x.insert+=e;a[k]=x;this.Aaa.ops=a;return}}k={};k.insert=e;Array.add(a,k)}zCf(e,a){const k=
{};this.snj(k,a);Array.add(this.Aaa.ops,this.W5b(e,k))}bCf(e,a,k,x=!1){var y={};y.fullName=a.fullName;y.email=a.email;y.resolveState=a.resolveState;a={};a.atmention=y;e=this.W5b(e,a);k&&(y={},y.contentId=k.contentId,a={},a.atmention=y,x&&(y.isCurrentUser=k.isCurrentUser),e.optional=a);Array.add(this.Aaa.ops,e)}insertImage(e,a){e=this.W5b(e,{});const k={};k.base64=a.base64;a={};a.image=k;e.optional=a;Array.add(this.Aaa.ops,e)}Ssi(e,a){const k={};k.link=a.link;this.snj(k,a);Array.add(this.Aaa.ops,this.W5b(e,
k))}I9b(){return Sys.Serialization.JavaScriptSerializer.serialize(this.Aaa)}W5b(e,a){const k={};k.insert=e;k.attributes=a;return k}snj(e,a){this.eQb(a.weight>=l.R4d,e,"weight",a.weight);this.eQb(a.italic,e,"italic",!0);this.eQb(a.underline,e,"underline",!0);this.eQb(a.strikethrough,e,"strikethrough",!0);this.eQb(!!a.highlight,e,"highlight",a.highlight);this.eQb(!!a.color,e,"color",a.color);this.eQb(!!a.paragraph,e,"paragraph",a.paragraph)}eQb(e,a,k,x){e&&(a[k]=x)}static aGb(e){return Sys.Serialization.JavaScriptSerializer.deserialize(e,
!0)}}l.R4d=700;Object(D.a)(l,"DeltaFormatCreator",null,[875])},1638:function(D,I,c){c.d(I,"a",function(){return a});D=c(0);var l=c(596),e=c(393);class a{constructor(k=!1){this.cN=null;this.t3a=!1;k&&(this.cN=new l.a(new e.a))}}Object(D.a)(a,"OpenCommentInfo",null,[])},1639:function(D,I,c){c.d(I,"b",function(){return t});c.d(I,"a",function(){return z});c.d(I,"c",function(){return v});c.d(I,"d",function(){return H});c.d(I,"e",function(){return F});var l=c(20),e=c(2),a=c(119),k=c(7),x=c(457),y=c(443),
m=c(262);const t=()=>l.a.Nt,z=()=>void 0!==window.self.FormData&&null!==window.self.FormData?!0:!1,v=G=>!!G&&G.isConnected,H=(G,M,K,L)=>{if(!M||!M.isConnected)return G.dispose(),!1;const R=M.Yi(),S=M.ja(a.a.QJ,m.a.Pt),N={};N[x.a.nodeId]=M.id.toString();N[x.a.cellId]=R.Gm.toString();N[x.a.fileId]=R.zr;N[x.a.Yua]=R.contentReplicator.Pu.toString();N[x.a.XM]=R.contentReplicator.XM;N[x.a.JX]=K.toString();N[x.a.lcid]=e.AFrameworkApplication.lcid.toString();N[x.a.accessToken]=e.AFrameworkApplication.accessToken;
N[x.a.classId]=M.Qc.toString();N[x.a.QJ]=S;L=L||{};for(const O of y.a(L))N[O]=L[O];for(const O of y.a(N))G.T5b(O,N[O]);return!0},F=(G,M,K)=>{const L={};L.IsResponseNull=!M;M&&(L.OperationResult=M.StatusCode,L.RevisionListLength=M.RevisionList?M.RevisionList.length.toString():"null");k.ULS.sendTraceTag(36783366,322,50,"UploadResponseReceived: {0}",L);K&&K.isConnected&&(M&&!M.StatusCode?(K.zJ().contentReplicator.kF(null,null,null),G.Dqg()):G.ZNb(null,M?M.StatusCode:14))}},1640:function(D,I,c){var l=
this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);Object.defineProperty(a,y,{enumerable:!0,get:function(){return k[x]}})}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(I,"__esModule",{value:!0});e(c(1854),I);e(c(1855),I)},1641:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.neighborhood=null;this.mentionLength=
this.mentionStart=0}}Object(D.a)(l,"InsightsParameters",null,[])},1645:function(D,I,c){c.d(I,"a",function(){return l});c.d(I,"b",function(){return e});D=c(0);var l;(function(a){a[a.Unknown=-1]="Unknown";a[a.ocp=0]="RichText";a[a.Pbp=1]="PlainText";a[a.Nbp=2]="Picture";a[a.$9o=3]="ComboBox";a[a.K$o=4]="DropDownList";a[a.S9o=5]="BuildingBlockGallery";a[a.Date=6]="Date";a[a.gcp=7]="RepeatSectionItem";a[a.Y9o=8]="CheckBox";a[a.fcp=9]="RepeatSection";a[a.eNj=10]="Bibliography";a[a.Pcp=11]="TableOfContents";
a[a.SQj=12]="NumberOfContentControlKinds"})(l||(l={}));Object(D.b)("ContentControlKind",l);const e=a=>{for(let k=0;k<l.SQj;++k)if(l[k]===a)return k;return l.Unknown}},1646:function(D,I,c){c.d(I,"c",function(){return y});c.d(I,"b",function(){return m});c.d(I,"a",function(){return t});var l=c(39),e=c(597),a=c(64),k=c(62),x=c(278);const y=(z,v,H)=>{var F=z.characterData.length;if(v>H||H>F)return null;a:{for(G of z.kH)if(F=G.nc,F.ue&&F===k.InteractiveViewManager.instance.yd){var G=F;break a}G=null}if(!G)return null;
G=z.zj(G.$b);if(!G)return null;F=[];z=z.qa;for(let K=z.zca(v);K<z.length;K++){var M=z.J(K);if(M.cp>H||M.cp===H&&v!==H)break;(M=x.a.Uwa(G,M.cp))&&0>Array.indexOf(F,M)&&F.push(M)}return F},m=z=>{let v=null;for(const F of z){var H=l.a.getElementBounds(F);v?(z=v,z.x>H.x&&(z.x=H.x),z.x+z.width<H.x+H.width&&(z.width=H.x+H.width-z.x),z.y>H.y&&(z.y=H.y),z.y+z.height<H.y+H.height&&(z.height=H.y+H.height-z.y)):v=H}v||(v=new Sys.UI.Bounds(0,0,0,0));return v},t=(z,v)=>{z=m(z);if(!z.width&&!z.height)return null;
const H=document.createElement("div");H.id=v;H.style.position="absolute";H.style.left=z.x+"px";H.style.top=z.y+"px";H.style.width=z.width+"px";H.style.height=z.height+"px";H.style.zIndex="-9999";a.d(H,e.a.lBb,"true");return H}},1647:function(D,I,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);Object.defineProperty(a,y,{enumerable:!0,get:function(){return k[x]}})}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===
x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(I,"__esModule",{value:!0});e(c(1876),I);e(c(1877),I);e(c(1878),I);e(c(1879),I);e(c(1880),I)},1648:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e){this.source=e}}Object(D.a)(l,"AcceptAllActionData",null,[])},1650:function(D,I,c){c.d(I,"a",function(){return N});D=c(0);var l=c(716),e=c(26),a=c(10),k=c(17),x=c(23),y=c(8),m=c(12),t=c(759),z=c(551),v=c(242),H=c(69),F=c(75),G=c(112),M=c(1220),K=c(1549),
L=c(870);c.n(L);var R=c(1568),S=c(871);class N{constructor(O,W,V,Q,Y,ba,Z){this.SMa=O;this.hb=W;this.Un=V;this.Cn=Q;this.Cab=Y;this.s5j=ba;this.AWb=Z}Boa(O){return(O=this.Cn.Boa(O))&&Object(H.a)(l.a,O.errorDetails)&&!O.errorDetails.z4a()?O:null}qFa(O){return this.Cab.qFa(O)}Knf(O){if(!O)return null;if(t.a(O.annotationType)){if((O=O.content)&&O.suggestions&&!N.a3b(O))return O}else if(O.annotationType===z.a.getTypeName()){if((O=O.content)&&O.suggestions)return O}else if(O.annotationType===L.FlagAnnotation.getTypeName()&&
(O=O.content)&&O.results)return O;return null}jOd(O,W,V){let Q=null,Y=null,ba=null;var Z=this.Un.ZQc(O,0);if(!Z||!Z.count)return{returnValue:!1,annotation:Q,n5i:Y,J1e:ba};for(const ea of Z){if(W&&(ea.Ec!==O.cpBegin||ea.end!==O.cpEnd))continue;Z=this.Knf(ea.intent);if(!Z||V&&!V(Z))continue;let ha;({stop:ha}=N.zrj(Y,Z)).returnValue&&(Q=ea.intent,Y=Z,ba=e.a.createTextRange(O.node,ea.Ec,ea.end));if(ha)break}return{returnValue:!!Y,annotation:Q,n5i:Y,J1e:ba}}F4h(O,W){let V=null;for(const Q of O){if(Q.type)continue;
O=this.Knf(Q.intent);if(!O||W&&!W(O))continue;let Y;({stop:Y}=N.zrj(V,O)).returnValue&&(V=O);if(Y)break}return V}jji(O,W,V,Q,Y){const ba=new F.a;if(Q.zXd){var Z=this.Un.kQa(O,0,ea=>{if(W>ea.Ec||ea.Ec>V)return!1;ea=this.Knf(ea.intent);return!ea||N.a3b(ea)||Q.T5c&&!Q.T5c(ea)?!1:!0});for(const ea of Z)ba.add(ea)}if(Q.yXd){Z=this.Cn.E4(O,ea=>{if(W>ea.Ec||ea.Ec>V)return!1;ea=ea.errorDetails;return ea.z4a()||Q.L4c&&!Q.L4c(ea)?!1:!0});for(const ea of Z)ba.add(ea)}if(Q.xXd){O=this.Cab.eqf(O,ea=>W>ea.Ec||
ea.Ec>V||Q.TLc&&!Q.TLc(ea.PD)?!1:!0);for(const ea of O)ba.add(ea)}ba.Sc(Y);return ba}hqf(O,W){return Math.min(Math.abs(W-O.Ec),Math.abs(W-O.end))}s6l(O,W,V,Q){let Y,ba=0;Q?(Q=0,Y=W-1):(Q=W+1,Y=O.characterData.length);V=this.jji(O,Q,Y,V,(Z,ea)=>this.hqf(Z,W)-this.hqf(ea,W));if(!V.count)return{returnValue:null,offset:ba};ba=W<V.J(0).Ec||W>V.J(0).end?this.hqf(V.J(0),W):0;return{returnValue:e.a.createTextRange(O,V.J(0).Ec,V.J(0).end),offset:ba}}Psf(O,W,V,Q){let Y=0;var ba=({offset:Y}=this.s6l(O,W,V,Q)).returnValue;
if(ba)return{returnValue:ba,offset:Y};ba=this.SMa.BOh(O,Q);if(!ba)return{returnValue:null,offset:Y};for(Y=Q?W:O.characterData.length-W;ba.h9();){O=ba.ex;W=this.jji(O,0,O.characterData.length,V,(Z,ea)=>Z.Ec===ea.Ec?Z.end-ea.end:Z.Ec-ea.Ec);if(W.count)return V=Q?W.J(W.count-1):W.J(0),Y+=Q?O.characterData.length-V.end:V.Ec,{returnValue:e.a.createTextRange(O,V.Ec,V.end),offset:Y};Y+=O.characterData.length}return{returnValue:null,offset:Y}}Osf(O,W,V,Q){return this.Psf(O,W,V,Q).returnValue}OLc(O,W,V){let Q=
0,Y=1;this.Osf(O,W,V,!1)&&Y++;this.Osf(O,W,V,!0)&&(Q++,Y++);return{index:Q,count:Y}}LRl(O,W,V){let Q;const Y=({offset:Q}=this.Psf(O,W<O.characterData.length?W+1:W,V,!0)).returnValue;if(Y&&!Q)return Y;W=({offset:O}=this.Psf(O,1<W?W-1:0,V,!1)).returnValue;return Y&&W?Q<O?Y:W:Y?Y:W}dij(O,W){let V=null;a.App.za&&Object(G.a)(M.MainView,a.App.za.jb.rc)&&(V=a.App.za.jb.rc);if(!V)return!1;this.hb.Ac(k.SelectionEditor.Jj(x.SelectionFactory.Zn(O),!0,!1));O=V.Es.edm();const Q=(O-250)/2;V.Es.E1(100<Q?100-100*
Q/O:-1,void 0,void 0,Y=>{window.setTimeout(()=>{W(Y)},0)});return!0}ULb(O,W,V=4,Q=!0){const Y=()=>{W.Wi.eE||W.EN(new K.a(O,V,!1,Q,void 0,!0))};W.Wi.dismiss();this.s5j.select(O.node,O.cpBegin,O.cpBegin);if(!this.AWb.OLd(O.node))return this.dij(O,()=>{Y()});Y();return!0}static a3b(O){if(!O)return!0;if(!O.M_||!O.M_.state)return!1;O=O.M_.state;return 60===O||70===O}static zrj(O,W){const V=Object(S.b)()&&R.a.UYd(W)||v.a.getTypeNameFor(W)===z.a.getTypeName();return{returnValue:!O||V||t.a(v.a.getTypeNameFor(W))&&
O.priority>W.priority,stop:V}}YSf(O,W,V,Q,Y=4,ba=!0){O=this.rTl(O);if(!O)return!1;W=this.rSh(O,W,V,Q);return this.ULb(O,W,Y,ba)}rTl(O){var W=this.hb.ib.lb;for(const V of W)if(y.ParagraphReader.Xb(V.node)&&(W=V.contextId,W===m.a.Uc||W===m.a.Fd||W===m.a.paragraph))return this.LRl(V.node,W!==m.a.paragraph?V.cpBegin:0,O);return null}rSh(O,W,V,Q){return this.tHm(O)?W:this.vLm(O)?Q:V}tHm(O){return this.jOd(O,!0,null).returnValue}vLm(O){return!!this.qFa(O)}}Object(D.a)(N,"SuggestionNavigator",null,[])},
1651:function(D,I,c){c.d(I,"c",function(){return e});c.d(I,"a",function(){return a});c.d(I,"b",function(){return k});var l=c(25);const e=(x,y,m)=>{if(!l.c(x)&&"#text"!==x.nodeName&&(y?x.setAttribute("unselectable","on"):x.setAttribute("unselectable","off"),m))for(x=x.firstChild;x;)e(x,y,!0),x=x.nextSibling},a=x=>{x=document.createElement(x);x.setAttribute("unselectable","on");return x},k=(x,y)=>{if(!l.c(x)){var m=x.className;if(l.c(m)||-1===m.indexOf(y))y=m.trim()+" "+y,y=y.trim(),x.className=y}}},
1652:function(D,I,c){c.d(I,"a",function(){return t});D=c(0);var l=c(7),e=c(54),a=c(2),k=c(190),x=c(22),y=c(292),m=c(31);class t{constructor(){this.Zfa=null}vne(){try{this.Zfa||(this.Zfa=x.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager"))}catch(z){l.ULS.sendTraceTag(51689674,1300,10,"Unable to resolve ISearchOAuthManager: "+z)}}Qvf(z,v){return this.Zfa?this.Zfa.getToken(z,v):new Promise(H=>{x.a.instance.Ta("Common.App.SearchCommon.ISearchOAuthManager").execute(F=>{F?(this.Zfa=F,this.Zfa.getToken(z,
v).then(G=>H(G))):H(null)})})}e4l(){this.vne();return this.Zfa?this.Zfa.getToken("Search",a.AFrameworkApplication.YNf):null}gii(){if("Dev Box"===a.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(z=>{window.setTimeout(()=>{z(window.TellMeSubstrateTokenOverride)},750)});this.vne();return this.Zfa?this.Zfa.getToken("Search",a.AFrameworkApplication.fkg):null}Dhm(){this.vne();return this.Zfa?
this.Zfa.getToken("Search",this.Ahm()):null}Ahm(){return a.AFrameworkApplication.K.kb("TellMeServiceAuthEndpointForSearch")}Aem(){if("Dev Box"===a.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse")&&void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(z=>{window.setTimeout(()=>{z(window.TellMeSubstrateTokenOverride)},750)});this.vne();return this.Zfa?this.Zfa.getToken("SmartLookup",this.xem()):null}xem(){return a.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint")}f4l(){return Object(e.a)(this,
this.e4l,"getLokiTokenPromise")}Vfm(){return Object(e.a)(this,this.gii,"getSubstrateTokenPromise")}VQb(){return!!a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.Kb.VQb}pim(){const z={};this.VQb()&&(z.Loki=this.f4l(),z.Substrate=this.Vfm());return z}I_c(z){k.a.FIa(Object.assign(new y.a,{name:"Events",dataFields:[Object.assign(new m.a,{name:"Event",string:"StringsLoaded"}),Object.assign(new m.a,{name:"Status",bool:z})],durationMs:Math.round(window.performance.now())}),"TellMeWAC.")}f3m(){return a.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk("tellme-strings").catch(()=>{this.I_c(!1);return!1}).then(()=>{this.I_c(!0);return!0}):new Promise((z,v)=>{const H=x.a.instance.resolve("Common.IDynamicScriptLoaderProvider").dA;H?H.loadScript("tellme-strings").then(()=>{this.I_c(!0);z(!0)}).catch(()=>{this.I_c(!1);v(!1)}):(this.I_c(!1),v(!1))})}static hUm(){return!!a.AFrameworkApplication.ua&&(a.AFrameworkApplication.ua.Kb.DYc||a.AFrameworkApplication.ua.Kb.Tdc)}static K0d(){return!!a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.Kb.Tdc}}
Object(D.a)(t,"ReactSharedHeaderSearchUtils",null,[])},1654:function(D,I,c){c.r(I);c.d(I,"validateCpDataV1",function(){return e});c.d(I,"isEqual",function(){return a});c.d(I,"isSupportedCpVersion",function(){return k});c.d(I,"validateVersionedCpData",function(){return y});c.d(I,"versionedDeserialize",function(){return m});var l=c(1625);const e=t=>"number"!==typeof t.CP||null!=t.FB&&"number"!==typeof t.FB||null!=t.FE&&"number"!==typeof t.FE||null!=t.HB&&"number"!==typeof t.HB||null!=t.HE&&"number"!==
typeof t.HE||null!=t.CB&&"number"!==typeof t.CB||null!=t.CE&&"number"!==typeof t.CE||null!=t.R&&"number"!==typeof t.R||null!=t.E&&"number"!==typeof t.E||null!=t.TW&&"number"!==typeof t.TW||null!=t.PB&&"number"!==typeof t.PB||null!=t.SYM&&"number"!==typeof t.SYM||null!=t.IE&&"number"!==typeof t.IE||null!=t.OO&&"number"!==typeof t.OO||null!=t.AX&&"number"!==typeof t.AX||null!=t.CCI&&"number"!==typeof t.CCI||null!=t.DD&&"number"!==typeof t.DD?!1:!0,a=(t,z)=>t||z?t&&z&&t.CP===z.CP&&t.FB===z.FB&&t.FE===
z.FE&&t.HB===z.HB&&t.HE===z.HE&&t.CB===z.CB&&t.CE===z.CE&&t.R===z.R&&t.E===z.E&&t.TW===z.TW&&t.PB===z.PB&&t.SYM===z.SYM&&t.IE===z.IE&&t.OO===z.OO&&t.AX===z.AX&&t.CCI===z.CCI&&t.DD===z.DD?!0:!1:!0,k=t=>1===t,x=t=>{let z=t,v=0;"number"===typeof z.VS&&(v=z.VS);if("number"===typeof z.VS||"number"===typeof z.CP)return{returnValue:z,Frg:v};z=null;for(let H=0;H<t.length;H++){const F=t[H];1===F.VS&&F.VS>v&&(v=F.VS,z=t[H])}return{returnValue:z,Frg:v}},y=t=>{const z=({Frg:t}=x(t)).returnValue;if(!z)return!1;
switch(t){case 0:case 1:return e(z);default:return!1}},m=t=>{if(!t)return null;const z=({Frg:t}=x(t)).returnValue;if(!z)return null;switch(t){case 0:case 1:return l.b(z);default:return null}}},1667:function(D,I,c){D=c(0);var l=c(758),e=c(19),a=c(173),k=c(79),x=c(2),y=c(22),m=c(7),t=c(1469),z=c(12),v=c(104),H=c(26),F=c(3),G=c(1077),M=c(134),K=c(17),L=c(23),R=c(101),S=c(8);class N{static get Qwh(){N.mrc||(N.mrc=[],N.Dfc(l.a.tg("ar-sa")),N.Dfc(l.a.tg("de-de")),N.Dfc(l.a.tg("es-es")),N.c1(l.a.tg("en-029"),
l.a.tg("en-us")),N.c1(l.a.tg("en-au"),l.a.tg("en-us")),N.c1(l.a.tg("en-bz"),l.a.tg("en-us")),N.c1(l.a.tg("en-ca"),l.a.tg("en-us")),N.c1(l.a.tg("en-gb"),l.a.tg("en-us")),N.c1(l.a.tg("en-id"),l.a.tg("en-us")),N.c1(l.a.tg("en-my"),l.a.tg("en-us")),N.c1(l.a.tg("en-ph"),l.a.tg("en-us")),N.c1(l.a.tg("zh-tw"),l.a.tg("en-us")),N.Dfc(l.a.tg("fr-fr")),N.c1(l.a.tg("hr-ba"),l.a.tg("hr-hr")),N.c1(l.a.tg("it-ch"),l.a.tg("it-it")),N.c1(l.a.tg("nb-no"),l.a.tg("nn-no")),N.Dfc(l.a.tg("nl-nl")),N.c1(l.a.tg("ro-md"),
l.a.tg("ro-ro")),N.c1(l.a.tg("ru-md"),l.a.tg("ru-ru")),N.c1(l.a.tg("sr-latn-ba"),l.a.tg("sr-latn-cs")),N.c1(l.a.tg("sr-latn-me"),l.a.tg("sr-latn-cs")),N.c1(l.a.tg("sr-latn-rs"),l.a.tg("sr-latn-cs")),N.Dfc(l.a.tg("sr-cyrl-cs")),N.c1(l.a.tg("sv-fi"),l.a.tg("sv-se")));return N.mrc}static Dfc(Wa){N.mrc[Wa.languageId]=Wa.LCID}static c1(Wa,yb){N.mrc[Wa.LCID]=yb.LCID}static N9h(Wa){var yb=l.a.tg(Wa);if(!yb)return 0;yb=N.Qwh[yb.LCID]||N.Qwh[yb.languageId]||0;return yb===Wa?0:yb}}N.mrc=null;Object(D.a)(N,
"AutoCorrectListFallback",null,[]);var O=c(358),W=c(86),V=c(174),Q=c(119),Y=c(6),ba=c(16),Z=c(5),ea=c(80),ha=c(377),ka=c(36),ua=c(58),sa=c(99),Da=c(43),Pa=c(1554);class Ra extends Pa.a{constructor(Wa,yb,Yb,qc,Hc,$b){super(Wa,yb,Yb,qc,$b);this.NY=Hc}get bD(){return!0}get commandId(){return F.a.SIk}set bD(Wa){super.bD=Wa}}Object(D.a)(Ra,"ARegexCorrectAction",Pa.a,[]);class Ga extends Ra{static get wmb(){if(null!=Ga.dEg)var Wa=Ga.dEg;else(Wa=y.a.instance.Oa("Box4.List.IListCommands"))||m.ULS.sendTraceTag(512357316,
393,50,"IListCommands was tried to be resolved before it was registered."),Wa=Ga.dEg=Wa;return Wa}static get Qn(){return null!=Ga.hEg?Ga.hEg:Ga.hEg=y.a.instance.resolve("Box4.List.IListEditor")}static get Jd(){return null!=Ga.yEg?Ga.yEg:Ga.yEg=y.a.instance.resolve("Box4.List.IListReader")}get levelText(){const [Wa,yb]=this.NY;return yb?Wa.replace(yb,"%1"):Wa}}Object(D.a)(Ga,"AListAutoCorrectAction",Ra,[]);var ta=c(136);class va extends Ga{get commandId(){return F.a.KIk}Xna(Wa){if(va.wmb){var yb=Z.GraphIterator.eb(Wa);
yb.qd();ka.OutlineElementNavigator.Yd(yb);if(va.Qn.iie(yb,this.NY[0])){var Yb=va.Jd.vw(yb),qc=this.NY[0],Hc=e.a.charAt(qc,0),$b=this.w4l(Hc),Ub=ha.a.c0(1,$b.listStyle);Yb&&Ub.$yf(Yb)||(Yb=new Da.GraphTransaction(15),Yb.St(yb),this.Md.Ge(H.a.createTextRange(Wa,this.VG,this.d1+1),"",!0,!1),va.Qn.Hko(Ub),Wa=new O.DictionaryPropertySet,Wa.setValue(V.a.ymf,!0),Hc&&(Ub.OQ=Hc,Wa.setValue(Q.a.OQ,Ub.OQ)),Wa.setValue(Y.a.pv,$b.levelText),Wa.setValue(ba.a.font,$b.fontName),"-"===Hc&&W.Health.instance.recordKpiUsage("DashBulletAutoCreate",
0,va.yB,null),ta.a.DY&&(Wa.setValue(Q.a.cqa,"autocorrect"),Wa.setValue(Q.a.Jia,qc)),va.wmb.LPk(Ub.listType,Ub.listStyle,Wa),Yb.dispose())}}}w4l(Wa){const yb={listStyle:0,levelText:ea.a.wKd,fontName:ea.a.tLc};switch(Wa){case "*":return{...yb,listStyle:1};case "-":return{...yb,levelText:"-",fontName:sa.a.OH};default:return yb}}static wG(Wa,yb,Yb,qc,Hc){return new va(null,Wa,yb,Yb,qc,Hc)}static eU(Wa,yb,Yb,qc,Hc){return new va(Wa,ua.a(Wa).Cb,yb,Yb,qc,Hc)}}va.yB="wwaengidc";va.N6f=["[\\*](?![\\*])","[\\-](?![\\-])"];
Object(D.a)(va,"BulletListAction",Ga,[]);var ia=c(83);class qa extends Ra{constructor(Wa,yb,Yb,qc,Hc,$b){super(Wa,yb,Yb,qc,Hc,$b);this.uxc=!1;this.bD=!Wa;qa.qp=new ia.a}get bD(){return this.uxc}set bD(Wa){this.uxc=Wa}aEb(Wa){this.Q7e(Wa.innerText,(yb,Yb,qc)=>{Wa.innerText=e.a.substring(Wa.innerText,0,yb)+qc+e.a.right(Wa.innerText,Yb)})}Xna(Wa){this.Q7e(S.ParagraphReader.text(Wa).substring(this.VG,this.d1),(yb,Yb,qc)=>{this.Md.Ge(H.a.createTextRange(Wa,this.VG+yb,this.VG+Yb),qc,!0,!1)})}Q7e(Wa,yb){if(!(2>
this.NY.length)&&this.NY[1]){var Yb=this.NY[1];qa.qp.count||this.V2i();qa.qp.nb(Yb)&&(Wa=Wa.lastIndexOf(Yb),-1!==Wa&&yb(Wa,Wa+Yb.length,qa.qp.J(Yb)))}}}Object(D.a)(qa,"ADictionarySequenceReplacerAction",Ra,[]);class pa extends qa{get commandId(){return F.a.F3e}V2i(){qa.qp.Z("--","\u2014");qa.qp.Z(" -- "," \u2013 ");qa.qp.Z(" - "," \u2013 ");qa.qp.Z("-- ","\u2014");qa.qp.Z(" --"," \u2013");qa.qp.Z(" -"," \u2013")}static wG(Wa,yb,Yb,qc,Hc){return new pa(null,Wa,yb,Yb,qc,Hc)}static eU(Wa,yb,Yb,qc,Hc){return new pa(Wa,
ua.a(Wa).Cb,yb,Yb,qc,Hc)}}Object(D.a)(pa,"DashAction",qa,[]);class Fa extends qa{constructor(Wa,yb,Yb,qc,Hc,$b,Ub){super(Wa,yb,Yb,qc,Hc,$b);this.ga=Ub}get commandId(){return F.a.LIk}V2i(){qa.qp.Z(":)","\ud83d\ude0a");qa.qp.Z(":-)","\ud83d\ude0a");qa.qp.Z(":|","\ud83d\ude10");qa.qp.Z(":-|","\ud83d\ude10");qa.qp.Z(":(","\ud83d\ude41");qa.qp.Z(":-(","\ud83d\ude41");qa.qp.Z(";)","\ud83d\ude09");qa.qp.Z(";-)","\ud83d\ude09");qa.qp.Z(":D","\ud83d\ude00");qa.qp.Z(":-D","\ud83d\ude00");qa.qp.Z(":')","\ud83d\ude02");
qa.qp.Z("=D","\ud83d\ude03");qa.qp.Z(":>","\ud83d\ude06");qa.qp.Z(":->","\ud83d\ude06");qa.qp.Z(":3","\ud83d\ude0a");qa.qp.Z(":-3","\ud83d\ude0a");qa.qp.Z("B-)","\ud83d\ude0e");qa.qp.Z("*-*","\ud83d\ude0d");qa.qp.Z(":*","\ud83d\ude19");qa.qp.Z(":-*","\ud83d\ude19");qa.qp.Z(":X","\ud83d\ude36");qa.qp.Z(":-X","\ud83d\ude36");qa.qp.Z(":O","\ud83d\ude2e");qa.qp.Z(":-O","\ud83d\ude2e");qa.qp.Z(":#","\ud83e\udd10");qa.qp.Z(":-#","\ud83e\udd10");qa.qp.Z(":P","\ud83d\ude1b");qa.qp.Z(":-P","\ud83d\ude1b");
qa.qp.Z(";P","\ud83d\ude1c");qa.qp.Z(";-P","\ud83d\ude1c");qa.qp.Z(":-/","\ud83d\ude15");qa.qp.Z("$-$","\ud83e\udd11");qa.qp.Z(":S","\ud83d\ude16");qa.qp.Z(":-S","\ud83d\ude16");qa.qp.Z(":[","\ud83d\ude1f");qa.qp.Z(":-[","\ud83d\ude1f");qa.qp.Z(":\u2019(","\ud83d\ude22");qa.qp.Z(":'(","\ud83d\ude22");qa.qp.Z("@-@","\ud83d\ude31")}Xna(Wa){this.Q7e(S.ParagraphReader.text(Wa).substring(this.VG,this.d1),(yb,Yb,qc)=>{yb=H.a.createTextRange(Wa,this.VG+yb,this.VG+Yb);Yb={};Yb.MenuItemId=qc;this.ga.Nf(yb,
F.a.Ekb,2,!1,null,Yb,null)})}static wG(Wa,yb,Yb,qc,Hc,$b){return new Fa(null,Wa,yb,Yb,qc,Hc,$b)}static eU(Wa,yb,Yb,qc,Hc,$b){return new Fa(Wa,ua.a(Wa).Cb,yb,Yb,qc,Hc,$b)}}Object(D.a)(Fa,"EmojiAction",qa,[]);class za{constructor(Wa,yb,Yb,qc){this.QS=Wa;this.Hzd=yb;this.byc=qc;this.cG=Yb}eBi(){if(!this.cG)return!1;this.QS=this.QS.trimStart();return this.QS===this.cG?!0:!1}dYm(){if(!this.QS)return!1;const Wa=this.QS.lastIndexOf(" ");return-1!==Wa&&"."===this.QS.charAt(Wa-1)&&"."===this.QS.charAt(Wa-
3)?!0:!1}cYm(){if(!this.QS)return!1;var Wa=this.QS.lastIndexOf(" ");return-1!==Wa&&(Wa=this.QS.substring(0,Wa-1).lastIndexOf(" "),"."===this.QS.charAt(Wa+2))?!0:!1}qRm(){return this.eBi()&&(1===this.cG.length&&"."===this.Hzd||"."===this.QS.charAt(1))?!0:!1}rRm(){return this.cG?0<="\\/".indexOf(this.Hzd)||3===this.cG.length&&0<="\\/".indexOf(this.cG.charAt(1))?!0:!1:!1}nQm(){return this.cG?0<=this.cG.indexOf("@")?!0:!1:!1}UB(){if(!this.cG)return!1;for(const Wa of za.Fwf())if(e.a.startsWith(this.cG+
this.Hzd,Wa))return!0;return!1}SPm(){return this.cG?"i"===this.cG&&0<=za.quotes.indexOf(this.Hzd)?!0:!1:!1}SJm(){if(!this.QS)return!1;const Wa=e.a.j5a(this.QS,this.QS.length-1);if(-1!==Wa&&this.QS.substring(Wa+1,this.QS.length)===this.cG){const yb=this.QS.charAt(Wa-1);if(0<=za.xcg.indexOf(yb)||0<=za.quotes.indexOf(yb)&&0<=za.xcg.indexOf(this.QS.charAt(Wa-2)))return!0}return!1}EVk(){return!this.QS||this.dYm()||this.qRm()||this.rRm()||this.cYm()||this.nQm()||this.UB()?!1:this.eBi()||this.SPm()||this.SJm()?
!0:!1}static Fwf(){return za.A5g||(za.A5g="http: https: ftp:// mailto: \\\\ www.".split(" "))}}za.xcg=".!?";za.quotes="'\"";za.A5g=null;Object(D.a)(za,"FirstLetterUpperCaseRules",null,[]);class Oa{constructor(Wa){this.cG=Wa}HJl(){if(!this.cG)return null;for(let Wa=0;Wa<Oa.Tki().length;Wa++)if(this.cG===Oa.Tki()[Wa])return Oa.Ulm()[Wa];return null}static Tki(){return Oa.JWg||(Oa.JWg=["1/2","1/4","3/4"])}static Ulm(){return Oa.IWg||(Oa.IWg=["\u00bd","\u00bc","\u00be"])}}Oa.JWg=null;Oa.IWg=null;Object(D.a)(Oa,
"FractionsCollection",null,[]);class xa extends Pa.a{constructor(Wa,yb,Yb,qc,Hc,$b){super(Wa,yb,Yb,qc,$b);this.OKh=Hc}get bD(){return!0}get commandId(){return F.a.MIk}aEb(Wa){Wa.innerText=e.a.substring(Wa.innerText,0,this.VG)+this.OKh+e.a.right(Wa.innerText,this.d1)}Xna(Wa){this.Md.Ge(H.a.createTextRange(Wa,this.VG,this.d1),this.OKh,!0,!1)}set bD(Wa){super.bD=Wa}static wG(Wa,yb,Yb,qc,Hc){return new xa(null,Wa,yb,Yb,qc,Hc)}}Object(D.a)(xa,"FractionsReplaceCorrectAction",Pa.a,[]);class fa extends Ga{get commandId(){return F.a.OIk}Xna(Wa){if(fa.wmb){var yb=
Z.GraphIterator.eb(Wa);yb.qd();ka.OutlineElementNavigator.Yd(yb);if(fa.Qn.iie(yb,this.NY[0])){var [Yb,qc]=this.NY,Hc=fa.rjn(qc),$b=e.a.iec(qc)?4:2,Ub=H.a.createTextRange(Wa,this.VG,this.d1+1);fa.Qn.D3b(Wa,yb,$b,Hc,Ub,Yb,this.levelText,fa.wmb)}}}static wG(Wa,yb,Yb,qc,Hc){return new fa(null,Wa,yb,Yb,qc,Hc)}static eU(Wa,yb,Yb,qc,Hc){return new fa(Wa,ua.a(Wa).Cb,yb,Yb,qc,Hc)}static rjn(Wa){if(!Wa)return 0;Wa=e.a.eh(Wa);if(!e.a.YYd(Wa.charAt(0)))return 0;const yb=Wa.charCodeAt(0)-97+1;let Yb;for(Yb=1;Yb<
Wa.length&&Wa.charAt(Yb)===Wa.charAt(0);Yb++);return 26*(Yb-1)+yb}}Object(D.a)(fa,"LetterListAction",Ga,[]);var Ka=c(123);class lb extends Ga{get commandId(){return F.a.D3b}Xna(Wa){if(lb.wmb){var yb=Z.GraphIterator.eb(Wa);yb.qd();ka.OutlineElementNavigator.Yd(yb);if(lb.Qn.iie(yb,this.NY[0])){var [Yb,qc]=this.NY,Hc=parseInt(qc);if(!(99999999<=Hc)){var $b=H.a.createTextRange(Wa,this.VG,this.d1+1);Ka.a.O1d()&&Ka.a.Qnm();lb.Qn.D3b(Wa,yb,1,Hc,$b,Yb,this.levelText,lb.wmb)}}}}static wG(Wa,yb,Yb,qc,Hc){return new lb(null,
Wa,yb,Yb,qc,Hc)}static eU(Wa,yb,Yb,qc,Hc){return new lb(Wa,ua.a(Wa).Cb,yb,Yb,qc,Hc)}}Object(D.a)(lb,"NumberListAction",Ga,[]);class Xa extends Pa.a{get bD(){return!0}get commandId(){return F.a.QIk}aEb(){}Xna(Wa){const yb=H.a.createTextRange(Wa,this.d1-2,this.d1),Yb=new Da.GraphTransaction(15);Yb.Db(Wa);let qc=!1,Hc=null,$b=0;for(;$b<Wa.qa.length;){var Ub=Wa.qa.J($b),mc=Ub.E9;const ic=Ub.RU;if(Ub.cp>=yb.cpBegin){Ub.cp>yb.cpBegin||!Ub.formatting?Hc=qc?Ub.formatting:this.Md.qZ(Wa,$b,yb.cpBegin,Hc):(Hc=
Ub.formatting,ic&&(qc=!1),mc&&(qc=!0));$b++;break}Ub.formatting&&(Hc=Ub.formatting);ic&&(qc=!1);mc&&(qc=!0);$b++}for(;$b<Wa.qa.length;){mc=Wa.qa.J($b);if(mc.cp>=yb.cpEnd){if(mc.cp>yb.cpEnd||!mc.formatting&&!mc.Ph)qc||this.Md.qZ(Wa,$b,yb.cpEnd,Hc);qc||Xa.qn.vra(Hc,!0);break}mc.formatting&&(qc||Xa.qn.vra(Hc,!0),Hc=mc.formatting);Ub=mc.E9;mc=mc.RU;Ub&&(qc=!0);!Ub&&mc&&(qc=!1);$b++}Yb.dispose()}set bD(Wa){super.bD=Wa}static get qn(){return null!=Xa.vAg?Xa.vAg:Xa.vAg=y.a.instance.resolve("Box4.IFormattingEditor")}static wG(Wa,
yb,Yb,qc){return new Xa(null,Wa,yb,Yb,qc)}}Object(D.a)(Xa,"OrdinalsReplaceCorrectAction",Pa.a,[]);var kb=c(90),Bb=c(217),Ja;(function(Wa){Wa[Wa.r7i=0]="rand";Wa[Wa.s7i=1]="randOld";Wa[Wa.VLi=2]="lorem"})(Ja||(Ja={}));Object(D.b)("RandTextType",Ja);class Ma extends Ra{constructor(Wa,yb,Yb,qc,Hc,$b){super(Wa,yb,Yb,qc,Hc,$b);Ma.JPe||Ma.EDo()}static bRm(){var Wa;return null===(Wa=x.AFrameworkApplication.K)||void 0===Wa?void 0:Wa.getBooleanFeatureGate("Microsoft.Office.WordOnline.isNoRandDoubleSpaceEnabled",
!0)}get commandId(){return F.a.RIk}Xna(Wa){if(!(Wa.Ms||ta.a.getInstance().Ov&&(ta.a.getInstance().vHf?kb.ListItemReader.isListItem(Wa):Bb.a.Bpa(Wa)))){var yb=this.tbb.Pa.node===Wa,Yb=5,qc=3;if(this.NY[0].startsWith("=rand.old")){var Hc=Ja.s7i;Yb=3}else if(this.NY[0].startsWith("=rand"))Hc=Ja.r7i;else if(this.NY[0].startsWith("=lorem"))Hc=Ja.VLi;else return;this.NY[1]&&(Yb=parseInt(this.NY[1]));this.NY[2]&&(qc=parseInt(this.NY[2]));if(!(20<qc||100<Yb)){Wa.zJ().sF.g8(7);var $b=Z.GraphIterator.eb(Wa);
$b.qd();ka.OutlineElementNavigator.Yd($b);Ma.Pf.My($b,!1,!1);Ma.Pf.NH($b);var Ub=!1;switch(Hc){case Ja.r7i:Hc=Ma.JPe;break;case Ja.s7i:Hc=Ma.wch;break;case Ja.VLi:Hc=Ma.v6g;Ub=!0;break;default:return}var mc=0;for(let ab=0;ab<Yb;++ab){const bb=[];for(var ic=0;ic<qc;ic++)bb.push(Hc[mc++%Hc.length]);ic=H.a.Rc($b.currentNode,0);if(Ub){const Jb=v.FormattingReader.Yr(ic);Ma.qn.hm(Jb,Y.a.noProof,!0)}this.Md.Ge(ic,bb.join(Ma.bRm()?"":" "),!0,!1);ab<Yb-1&&(ka.OutlineElementNavigator.Yd($b),Ma.Pf.My($b,!1,
!1),Ma.Pf.NH($b))}Yb=$b.currentNode;$b=Z.GraphIterator.eb(Wa);$b.qd();ka.OutlineElementNavigator.Yd($b);$b.zg();yb&&(this.tbb=L.SelectionFactory.ne(Yb,S.ParagraphReader.textLength(Yb)))}}}static get Pf(){return null!=Ma.dFg?Ma.dFg:Ma.dFg=y.a.instance.resolve("Box4.IOutlineElementEditor")}static get qn(){return null!=Ma.zAg?Ma.zAg:Ma.zAg=y.a.instance.resolve("Box4.IFormattingEditor")}static EDo(){Ma.JPe="Video provides a powerful way to help you prove your point. ;When you click Online Video, you can paste in the embed code for the video you want to add. ;You can also type a keyword to search online for the video that best fits your document. ;To make your document look professionally produced, Word provides header, footer, cover page, and text box designs that complement each other. ;For example, you can add a matching cover page, header, and sidebar. ;Click Insert and then choose the elements you want from the different galleries. ;Themes and styles also help keep your document coordinated. ;When you click Design and choose a new Theme, the pictures, charts, and SmartArt graphics change to match your new theme. ;When you apply styles, your headings change to match the new theme. ;Save time in Word with new buttons that show up where you need them. ;To change the way a picture fits in your document, click it and a button for layout options appears next to it. ;When you work on a table, click where you want to add a row or a column, and then click the plus sign. ;Reading is easier, too, in the new Reading view. ;You can collapse parts of the document and focus on the text you want. ;If you need to stop reading before you reach the end, Word remembers where you left off - even on another device. ".split(";");
Ma.wch=["The quick brown fox jumps over the lazy dog. "];Ma.v6g="Lorem ipsum dolor sit amet, consectetuer adipiscing elit. ;Maecenas porttitor congue massa. ;Fusce posuere, magna sed pulvinar ultricies, purus lectus malesuada libero, sit amet commodo magna eros quis urna. ;Nunc viverra imperdiet enim. ;Fusce est. ;Vivamus a tellus. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Proin pharetra nonummy pede. ;Mauris et orci. ;Aenean nec lorem. ;In porttitor. ;Donec laoreet nonummy augue. ;Suspendisse dui purus, scelerisque at, vulputate vitae, pretium mattis, nunc. ;Mauris eget neque at sem venenatis eleifend. ;Ut nonummy. ;Fusce aliquet pede non pede. ;Suspendisse dapibus lorem pellentesque magna. ;Integer nulla. ;Donec blandit feugiat ligula. ;Donec hendrerit, felis et imperdiet euismod, purus ipsum pretium metus, in lacinia nulla nisl eget sapien. ;Donec ut est in lectus consequat consequat. ;Etiam eget dui. ;Aliquam erat volutpat. ;Sed at lorem in nunc porta tristique. ;Proin nec augue. ;Quisque aliquam tempor magna. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Nunc ac magna. ;Maecenas odio dolor, vulputate vel, auctor ac, accumsan id, felis. ;Pellentesque cursus sagittis felis. ;Pellentesque porttitor, velit lacinia egestas auctor, diam eros tempus arcu, nec vulputate augue magna vel risus. ;Cras non magna vel ante adipiscing rhoncus. ;Vivamus a mi. ;Morbi neque. ;Aliquam erat volutpat. ;Integer ultrices lobortis eros. ;Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. ;Proin semper, ante vitae sollicitudin posuere, metus quam iaculis nibh, vitae scelerisque nunc massa eget pede. ;Sed velit urna, interdum vel, ultricies vel, faucibus at, quam. ;Donec elit est, consectetuer eget, consequat quis, tempus quis, wisi. ;In in nunc. ;Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos hymenaeos. ;Donec ullamcorper fringilla eros. ;Fusce in sapien eu purus dapibus commodo. ;Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. ;Cras faucibus condimentum odio. ;Sed ac ligula. ;Aliquam at eros. ;Etiam at ligula et tellus ullamcorper ultrices. ;In fermentum, lorem non cursus porttitor, diam urna accumsan lacus, sed interdum wisi nibh nec nisl. ;Ut tincidunt volutpat urna. ;Mauris eleifend nulla eget mauris. ;Sed cursus quam id felis. ;Curabitur posuere quam vel nibh. ;Cras dapibus dapibus nisl. ;Vestibulum quis dolor a felis congue vehicula. ;Maecenas pede purus, tristique ac, tempus eget, egestas quis, mauris. ;Curabitur non eros. ;Nullam hendrerit bibendum justo. ;Fusce iaculis, est quis lacinia pretium, pede metus molestie lacus, at gravida wisi ante at libero. ;Quisque ornare placerat risus. ;Ut molestie magna at mi. ;Integer aliquet mauris et nibh. ;Ut mattis ligula posuere velit. ;Nunc sagittis. ;Curabitur varius fringilla nisl. ;Duis pretium mi euismod erat. ;Maecenas id augue. ;Nam vulputate. ;Duis a quam non neque lobortis malesuada. ;Praesent euismod. ;Donec nulla augue, venenatis scelerisque, dapibus a, consequat at, leo. ;Pellentesque libero lectus, tristique ac, consectetuer sit amet, imperdiet ut, justo. ;Sed aliquam odio vitae tortor. ;Proin hendrerit tempus arcu. ;In hac habitasse platea dictumst. ;Suspendisse potenti. ;Vivamus vitae massa adipiscing est lacinia sodales. ;Donec metus massa, mollis vel, tempus placerat, vestibulum condimentum, ligula. ;Nunc lacus metus, posuere eget, lacinia eu, varius quis, libero. ;Aliquam nonummy adipiscing augue. ".split(";")}static wG(Wa,
yb,Yb,qc,Hc){return new Ma(null,Wa,yb,Yb,qc,Hc)}static eU(Wa,yb,Yb,qc,Hc){return new Ma(Wa,ua.a(Wa).Cb,yb,Yb,qc,Hc)}}Ma.JPe=null;Ma.wch=null;Ma.v6g=null;Object(D.a)(Ma,"RandAction",Ra,[]);class fb{constructor(Wa,yb,Yb,qc){this.pattern=qc&8?new RegExp(Wa,"i"):new RegExp(Wa);this.gwm=yb;this.Hmm=Yb;this.flags=qc}}Object(D.a)(fb,"RegexAutoCorrectEntry",null,[]);class hc extends Ga{get commandId(){return F.a.TIk}Xna(Wa){if(hc.wmb){var yb=Z.GraphIterator.eb(Wa);yb.qd();ka.OutlineElementNavigator.Yd(yb);
if(hc.Qn.iie(yb,this.NY[0])){var [Yb,qc]=this.NY,Hc=hc.sjn(qc);if(!(0>=Hc)){var $b=e.a.iec(qc.charAt(0))?5:3,Ub=H.a.createTextRange(Wa,this.VG,this.d1+1);hc.Qn.D3b(Wa,yb,$b,Hc,Ub,Yb,this.levelText,hc.wmb)}}}}static wG(Wa,yb,Yb,qc,Hc){return new hc(null,Wa,yb,Yb,qc,Hc)}static eU(Wa,yb,Yb,qc,Hc){return new hc(Wa,ua.a(Wa).Cb,yb,Yb,qc,Hc)}static zxl(){hc.mNa||(hc.mNa={},hc.mNa.M=1E3,hc.mNa.D=500,hc.mNa.C=100,hc.mNa.L=50,hc.mNa.X=10,hc.mNa.V=5,hc.mNa.I=1)}static sjn(Wa){if(!Wa)return 0;hc.zxl();Wa=e.a.ZA(Wa);
let yb=0,Yb=0;for(let qc=Wa.length-1;0<=qc;qc--){const Hc=hc.mNa[e.a.charAt(Wa,qc).toString()];Yb=Hc<yb?Yb-Hc:Yb+Hc;yb=Hc}return Yb}}hc.mNa=null;hc.N6f=["M{1,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})","(CM|CD|DC{0,3}|C{1,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})","(XC|XL|LX{0,3}|X{1,3})(IX|IV|V?I{0,3})","(IX|IV|VI{0,3}|I{1,3})"].map(Wa=>`\\(?(${Wa})[\\.\\)\\-]`);Object(D.a)(hc,"RomanListAction",Ga,[]);var cc=c(40);class mb extends Pa.a{constructor(Wa,yb,Yb,qc,Hc,$b){super(Wa,yb,Yb,Yb+1,$b);this.xnk=
qc;this.GQg=Hc;this.f1c=!1}get bD(){return!1}get commandId(){return F.a.UIk}aEb(Wa){Wa.innerText=e.a.substring(Wa.innerText,0,this.VG)+this.GQg+e.a.right(Wa.innerText,this.d1)}Xna(Wa){this.Md.Ge(H.a.createTextRange(Wa,this.VG,this.d1),this.xnk,!0,!1);this.Md.Ge(H.a.createTextRange(Wa,this.VG,this.VG+1),this.GQg,!0,!1)}set bD(Wa){super.bD=Wa}static wG(Wa,yb,Yb,qc,Hc,$b){if("'"!==Yb&&'"'!==Yb)return null;var Ub=Z.GraphIterator.eb(Wa);Ub.qd();ka.OutlineElementNavigator.Yd(Ub);if(cc.OutlineElementReader.Pn(Ub.currentNode))return null;
qc=!yb||e.a.pda(qc)||-1!==Array.indexOf(mb.Lwn,qc);Ub="'"===Yb;return new mb($b,Wa,yb,Yb+"",qc?Ub?"\u2018":"\u201c":Ub?"\u2019":"\u201d",Hc)}}mb.Lwn=["[","{","("];Object(D.a)(mb,"SmartQuoteCorrectAction",Pa.a,[]);class Hb extends Pa.a{constructor(Wa,yb,Yb,qc,Hc,$b){super(Wa,yb,Yb,qc,$b);this.FQg=Hc}get bD(){return Hb.uxc}set bD(Wa){Hb.uxc=Wa}get commandId(){return F.a.VIk}DJj(){this.Iqd=this.XDh();this.Iqd||(this.c5g=!1,this.T_g="MatchTextIsNotTheSame")}aEb(Wa){Wa.innerText=e.a.substring(Wa.innerText,
0,this.VG)+this.FQg+e.a.right(Wa.innerText,this.d1)}Xna(Wa){this.Md.Ge(H.a.createTextRange(Wa,this.VG,this.d1),this.FQg,!0,!1)}static eU(Wa,yb,Yb,qc,Hc){const $b=ua.a(Wa);return new Hb(Wa,$b?$b.Cb:null,yb,Yb,qc,Hc)}static wG(Wa,yb,Yb,qc,Hc){return new Hb(null,Wa,yb,Yb,qc,Hc)}}Hb.uxc=!1;Object(D.a)(Hb,"StringReplaceCorrectAction",Pa.a,[]);class Ua extends Pa.a{constructor(Wa,yb,Yb,qc,Hc,$b,Ub,mc){super(Wa,yb,Yb,qc,Hc);this.Ok=$b;this.U8j=Ub;this.HD=mc}get bD(){return!0}get commandId(){return F.a.WIk}aEb(Wa){let yb=
e.a.substring(Wa.innerText,this.VG,this.d1);yb.charAt(0)!==yb.charAt(0).toUpperCase()&&(yb=yb.charAt(0).toUpperCase()+yb.substring(1,yb.length));Wa.innerText=e.a.substring(Wa.innerText,0,this.VG)+yb+e.a.right(Wa.innerText,this.d1)}Xna(Wa){const yb=this.VG,Yb=this.VG+1,qc=Wa.characterData.substring(yb,Yb).charAt(0);if(!e.a.iec(qc)){const Hc=H.a.createTextRange(Wa,yb,Yb);this.nKm(Hc)||this.HD&&this.HD.GYc(Wa,yb,Yb)||this.Md.Ge(Hc,qc.toUpperCase().toString(),!0,!1)}}nKm(Wa){return this.U8j?!!this.Ok&&
this.Ok.x9(Wa):!1}set bD(Wa){super.bD=Wa}static eU(Wa,yb,Yb,qc){const Hc=ua.a(Wa);return new Ua(Wa,Hc?Hc.Cb:null,yb,Yb,qc,null,!1,null)}static wG(Wa,yb,Yb,qc,Hc,$b){return new Ua(null,Wa,yb,Yb,qc,Hc,!0,$b)}}Object(D.a)(Ua,"UpperFirstLetterAutoCorrectAction",Pa.a,[]);class Ya{constructor(Wa,yb){this.byc=yb;this.cG=Wa}j2o(){const Wa=Number.parseInvariant(this.cG.substring(0,this.cG.length-2));switch(Number.parseInvariant(this.cG.charAt(this.cG.length-3).toString())){case 1:return 11===Wa?"th":"st";
case 2:return 12===Wa?"th":"nd";case 3:return 13===Wa?"th":"rd";case 4:case 5:case 6:case 7:case 8:case 9:case 0:return"th";default:return""}}DRm(){var Wa=l.a.tg(this.byc);if(!Wa||!Wa.name.toLowerCase().startsWith("en")||!this.cG||2>=this.cG.length)return!1;for(Wa=0;Wa<Ya.sVd().length;Wa++)if(this.cG.toLowerCase().endsWith(Ya.sVd()[Wa])){if(RegExp("^\\d+$").test(this.cG.substr(0,this.cG.length-2))){const yb=this.j2o();if(this.cG.toLowerCase().endsWith(Ya.sVd()[Wa])&&yb===Ya.sVd()[Wa])return!0}break}return!1}static sVd(){return Ya.H$g||
(Ya.H$g=["st","nd","rd","th"])}}Ya.H$g=null;Object(D.a)(Ya,"ValidateOrdinalsRule",null,[]);c.d(I,"a",function(){return Fb});class Fb{constructor(Wa,yb,Yb,qc,Hc,$b,Ub){this.QBc=[];this.RUb=[];this.lrc=[];this.nue=new Set;this.Obb=-1;this.EZg=this.Ufa=!1;this.o6j=Wa;this.Md=yb;this.Ok=Yb;this.ga=qc;this.aW=$b;this.HD=Ub;Hc?(this.Ufa=Hc.$("ReplaceQuoteWithSmartQuoteIsEnabled"),this.EZg=Hc.$("HyperlinkUrlValidationIsEnabled"),m.ULS.sendTraceTag(23418953,324,50,"{0}",{["ReplaceQuoteWithSmartQuoteIsEnabled"]:this.Ufa})):
(m.ULS.sendTraceTag(23418954,324,50,"appSettingsManager is null.  Auto correct is disabled for: emoticons and smart quotes."),this.Ufa=!1)}alb(Wa){return 0<=Fb.G3e.indexOf(Wa)}IIf(Wa){return 0<=Fb.H3e.indexOf(Wa)}oGf(Wa){return Wa.toLowerCase()===Wa}iec(Wa){return Wa.toUpperCase()===Wa}YYd(Wa){return Wa.toLowerCase()!==Wa.toUpperCase()}TMm(Wa,yb,Yb,qc){return(new za(Wa,yb,Yb,qc)).EVk()}sUl(Wa){do{if(Wa.getAttribute("xml:lang"))return l.a.tg(Wa.getAttribute("xml:lang"))||l.a.GVc;if(Wa.getAttribute("lang"))return l.a.tg(Wa.getAttribute("lang"))||
l.a.GVc;Wa=Wa.parentNode}while(Wa&&1===Wa.nodeType);return l.a.GVc}Qpf(Wa){return l.a.tg(v.FormattingReader.language(v.FormattingReader.Yr(Wa)))||l.a.GVc}EOd(Wa,yb){0>yb&&(yb=0);let Yb=-1;const qc=Fb.G3e.length;for(let Hc=0;Hc<qc;++Hc){const $b=Wa.lastIndexOf(e.a.charAt(Fb.G3e,Hc),yb);$b>Yb&&(Yb=$b)}Wa=e.a.j5a(Wa,yb);Wa>Yb&&(Yb=Wa);return Yb}RDl(Wa){for(let yb=0;yb<Wa.length;++yb)if(this.YYd(e.a.charAt(Wa,yb)))return yb;return-1}qlf(Wa,yb){if(!Wa||0>yb)return-1;let Yb=yb;Yb=Yb?this.EOd(Wa,Yb-1):-1;
Yb=Yb>e.a.j5a(Wa,yb-1)?Yb:e.a.j5a(Wa,yb-1);Yb++;return Yb}H0h(Wa,yb,Yb){this.pNc(yb);if(!this.RUb[yb]){yb=N.N9h(yb);if(0>=yb)return null;this.pNc(yb);if(!this.RUb[yb])return null}if(Yb&&this.lrc[yb]&&Array.contains(this.lrc[yb],Wa+Yb))return null;Yb=this.RUb[yb][e.a.eh(Wa)];if("string"!==typeof Yb||Yb===Wa||!Yb)return null;var qc=this.RDl(Wa);if(0>qc||this.oGf(e.a.charAt(Wa,qc)))return Yb;yb=!0;for(qc+=1;qc<Wa.length;++qc){const Hc=e.a.charAt(Wa,qc);yb&&!this.iec(Hc)&&(yb=!1)}return yb?null:e.a.ZA(e.a.substring(Yb,
0,1))+e.a.right(Yb,1)}eEl(Wa,yb,Yb,qc){a.a.mark(4666);const Hc=this.sUl(yb).LCID;let $b=0,Ub=Wa;const mc=yb.innerText;var ic=mc.lastIndexOf(" ",Wa);if(this.VEf(mc.substring(ic+1,Wa)))return a.a.mark(4667),null;ic=null;var ab=!1;do{Ub=Ub?this.EOd(mc,Ub-1):-1;if(-1===Ub&&!Yb){ab=yb;var bb=null;if(!this.alb(mc.charAt(0))){do{for(;ab&&!ab.previousSibling;)ab=ab.parentNode;ab&&(ab=ab.previousSibling,bb=ab.innerText)}while(ab&&!bb);if(ab&&bb&&!this.alb(e.a.charAt(bb,bb.length-1)))return a.a.mark(4667),
null}ab=!0}bb=e.a.substring(mc,Ub+1,Wa);++$b;var Jb=this.H0h(bb,Hc,qc.toString());if(Jb)ic=Hb.eU(yb,Ub+1,Wa,Jb,this.Md),Fb.XMf();else for(const Eb of this.QBc)if(!(Eb.flags&1&&!(Yb&&1>Ub)||Eb.flags&4||Eb.flags&2&&" "!==qc)&&(Jb=Eb.pattern.exec(bb))){ic=Eb.gwm(yb,Ub+1,Wa,Jb,this.Md,this.ga);break}}while(!ab&&!ic&&$b<Fb.RNi&&0<=Ub);a.a.mark(4667);return ic}cEl(Wa,yb,Yb){const qc=Wa.node;let Hc=S.ParagraphReader.text(qc);0>yb&&(yb=Wa.cpBegin);Wa=this.Qpf(Wa).LCID;if(this.VEf(Hc.substring(e.a.j5a(Hc,
yb)+1,yb)))return null;var $b=-1,Ub=R.a.Z9b(qc);for(var mc=0;mc<Ub.length;mc++)if(yb>Ub[mc].cpEnd)$b=Ub[mc].cpEnd;else{if(yb>Ub[mc].cpBegin)return null;break}Ub=null;mc=(mc=yb)?this.EOd(Hc,mc-1):-1;mc<$b&&(mc=$b-1);$b=e.a.substring(Hc,mc+1,yb);$b=$b.trimStart();if(1>mc)for(const ic of this.QBc){let ab=Hc;" "!==Yb&&(ab=Hc+Yb);if(ic.pattern.exec(ab))return null}Hc=Hc.substring(0,yb);if(!this.TMm(Hc,Yb.toString(),$b,Wa))return null;$b.charAt(0).toUpperCase()!==$b.charAt(0)&&(Ub=Ua.wG(qc,mc+1,yb,this.Md,
this.Ok,this.HD));return Ub}i0h(Wa,yb,Yb){Wa=L.SelectionFactory.ro(Wa,!1);if(!Wa)return null;Wa=Wa.Tc;return K.SelectionEditor.Ze(Wa)?this.cEl(Wa,yb,Yb):null}VEf(Wa){return e.a.xP(Wa)}Ukf(Wa,yb,Yb,qc){a.a.mark(4666);const Hc=Wa.node,$b=this.Qpf(Wa).LCID,Ub=S.ParagraphReader.text(Hc);0>yb&&(yb=Wa.cpBegin);if(Yb&&!this.alb(e.a.charAt(Ub,yb))||this.VEf(Ub.substring(e.a.j5a(Ub,yb)+1,yb)))return a.a.mark(4667),null;Wa=-1;Yb=R.a.Z9b(Hc);for(var mc=0;mc<Yb.length;mc++)if(yb>Yb[mc].cpEnd)Wa=Yb[mc].cpEnd;
else{if(yb>Yb[mc].cpBegin)return null;break}Yb=0;mc=yb;let ic=null;do{mc=mc?this.EOd(Ub,mc-1):-1;mc<Wa&&(mc=Wa-1);const bb=e.a.substring(Ub,mc+1,yb);++Yb;var ab=null;let Jb=!1;if(G.a.aVh){const Eb=Ub+String.fromCharCode(qc);Jb=this.QBc.some(hb=>hb.pattern.exec(Eb))}Jb||(ab=this.H0h(bb,$b,null));if(ab)this.aW.QTa&&(ic=Hb.wG(Hc,mc+1,yb,ab,this.Md),Fb.XMf());else for(const Eb of this.QBc)if(!(Eb.flags&1&&-1!==mc||Eb.flags&4&&qc!==k.a.Ss||Eb.flags&2&&qc!==k.a.ZJa)&&(ab=Eb.pattern.exec(bb))){ic=Eb.Hmm(Hc,
mc+1,yb,ab,this.Md,this.ga);if(ic.commandId!==F.a.F3e&&!this.aW.QTa||ic.commandId===F.a.F3e&&!this.aW.i7c)ic=null;break}}while(0<=mc&&mc>=Wa&&!ic&&Yb<Fb.RNi);a.a.mark(4667);return ic}h0h(Wa,yb,Yb){Wa=L.SelectionFactory.ro(Wa,!1);if(!Wa)return null;Wa=Wa.Tc;return K.SelectionEditor.Ze(Wa)?this.Ukf(Wa,yb,!1,Yb):null}p0h(Wa,yb){var Yb=L.SelectionFactory.ro(Wa,!1);if(!Yb)return null;let qc=Yb.Tc;Yb.Yw&&Yb.Tc.contextId!==z.a.Vc&&0<=yb&&(qc=H.a.Rc(Wa,yb));if(!K.SelectionEditor.Ze(qc)||R.a.Ixa(qc,!1))return null;
Yb=S.ParagraphReader.text(qc.node);Wa=0<yb?e.a.j5a(Yb,yb-1)+1:e.a.j5a(Yb,Yb.length-1)+1;yb=0<yb?yb:Yb.length;Yb=e.a.substring(Yb,Wa,yb);return!Yb||this.EZg&&!R.a.RRa(Yb)||!e.a.xP(Yb)&&!e.a.vWc(Yb)||!Fb.hp.k0n(qc,Wa,yb)?null:this.o6j.jbl(qc.node,Wa,yb)}t0h(Wa,yb){var Yb=L.SelectionFactory.ro(Wa,!1);if(!Yb)return null;var qc=Yb.Tc;if(!K.SelectionEditor.Ze(qc))return null;0>yb&&(yb=qc.cpBegin);var Hc=S.ParagraphReader.text(qc.node);Yb=this.qlf(Hc,yb);const $b=Fb.H3e.length;for(let Ub=0;Ub<$b;++Ub){const mc=
Hc.lastIndexOf(e.a.charAt(Fb.H3e,Ub),yb-1);mc>Yb&&(Yb=mc+1)}Hc=e.a.substring(Hc,Yb,yb);if(!Hc)return null;qc=this.Qpf(qc).LCID;return(new Ya(Hc,qc)).DRm()?Xa.wG(Wa,Yb,yb,this.Md):null}e0h(Wa,yb){var Yb=L.SelectionFactory.ro(Wa,!1);if(!Yb)return null;Yb=Yb.Tc;if(!K.SelectionEditor.Ze(Yb))return null;0>yb&&(yb=Yb.cpBegin);var qc=S.ParagraphReader.text(Yb.node);Yb=this.qlf(qc,yb);qc=e.a.substring(qc,Yb,yb);return qc?(qc=(new Oa(qc)).HJl())?xa.wG(Wa,Yb,yb,qc,this.Md):null:null}bFl(Wa,yb,Yb,qc,Hc){var $b=
L.SelectionFactory.ro(Wa,!1);if(!$b)return null;$b=$b.Tc;if(Yb>yb||!K.SelectionEditor.Ze($b))return null;0>yb&&(yb=$b.cpBegin);if(0>yb)return null;$b=S.ParagraphReader.text($b.node);return mb.wG(Wa,Yb,Hc,yb?$b.charAt(yb-1):"\x00",this.Md,qc)}OAb(Wa,yb,Yb,qc){this.QBc.push(new fb(`^${Wa}$`,yb,Yb,qc))}CPf(Wa){if(this.RUb[this.Obb]){const yb=this.RUb[this.Obb];for(const Yb in Wa)yb[Yb]=Wa[Yb]}else this.RUb[this.Obb]=Wa}GPf(Wa){this.lrc[this.Obb]?this.lrc[this.Obb].push(...(Wa||[])):this.lrc[this.Obb]=
Wa}g2m(Wa,yb){var Yb;this.nue.has(yb)||(this.nue.add(yb),null===(Yb=x.AFrameworkApplication.He)||void 0===Yb?void 0:Yb.mj(Wa,1,null,null,!1,3,qc=>{this.Obb=yb;try{Object(t.a)(qc.data.se)}catch(Hc){m.ULS.sendTraceTag(5898336,324,50,"Failed to parse autocorrect: {0}",{["ResponseData"]:qc.data?qc.data.se:""})}this.Obb=-1},()=>{this.Kwl(yb)},null,void 0,void 0,void 0,void 0,"27"))}Kwl(Wa){Wa=N.N9h(Wa);0<Wa&&this.pNc(Wa)}static get pJk(){return null!=Fb.Bwg?Fb.Bwg:Fb.Bwg=(()=>Fb.Wwh.map(([Wa,...yb])=>
(new fb(`^${Wa}`,...yb)).pattern))()}static get Wwh(){return null!=Fb.Cwg?Fb.Cwg:Fb.Cwg=(()=>[...va.N6f.map(Wa=>[Wa,va.eU,va.wG,3]),["\\(?(\\d+)[\\.\\)\\-]",lb.eU,lb.wG,3],["\\(?(L|l|C|c|D|d|M|m){1}[\\.\\)\\-]",fa.eU,fa.wG,3],...hc.N6f.map(Wa=>[Wa,hc.eU,hc.wG,11]),["\\(?([A-Za-z]){1}[\\.\\)\\-]",fa.eU,fa.wG,3]])()}p2m(){this.pNc(1033);this.OAb("=rand\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",Ma.eU,Ma.wG,5);this.OAb("=rand\\.old\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",Ma.eU,Ma.wG,5);this.OAb("=lorem\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",
Ma.eU,Ma.wG,5);Fb.Wwh.forEach(Wa=>this.OAb(...Wa));this.OAb("[\\w\\d]+( ?\\-{1,2} ?)[\\w\\d]+",pa.eU,pa.wG,0);this.OAb("(?:.*)([\\:\\;\\=][\\'\\-]??[DOPSX3>\\(\\)\\*#\\|\\[\\/])",Fa.eU,Fa.wG,0);this.OAb("(?:.*)([\\@\\*\\$][\\-][\\@\\*\\$])",Fa.eU,Fa.wG,0)}pNc(Wa){this.nue.has(Wa)||this.g2m(M.a.rMk(String.format("Acl/Acl{0}.js",Wa)),Wa)}static XMf(){y.a.instance.Ta("Common.ISystemInitiatedFeedback").execute(Wa=>{Wa.logActivity("AutocorrectStringMatch",null)})}static get hp(){return null!=Fb.jBg?Fb.jBg:
Fb.jBg=y.a.instance.resolve("Box4.IHyperlinkEditor")}}Fb.G3e=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014";Fb.H3e=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014/\\.!?\"'";Fb.xcg=".!?";Fb.RNi=5;Object(D.a)(Fb,"AutoCorrectRules",null,[488])},1672:function(D,I,c){D=c(0);var l=c(75),e=c(54),a=c(324),k=c(341);class x{constructor(G,M,K,L=0,R=0,S=null,N=null){this.commandId=G;this.controlId=M;this.timeStamp=K;this.commandSurface=a.a[L];this.Rx=k.a[R];
this.contentType=S;this.Ple=N}}Object(D.a)(x,"CommandActionInfo",null,[]);class y{constructor(){this.QUj=RegExp("(Close|TabSwitch|((Populate|Query|Report|Show|BrowserFocus).+)|(.+(Rendered|Seen|Scroll)))");this.H_j=RegExp("(CoauthorsRendered|DoNothing|MenuClose|MenuOpen|ZeroTermContextMenuClose|SmartLookupContextMenu|TabSwitch|((TellMe).+))")}isNullOrUndefined(G){return null===G||"undefined"===typeof G}GXm(G){return!this.QUj.exec(G)}HXm(G){return this.isNullOrUndefined(G)||!G.trim().length?!1:!this.H_j.exec(G)}}
Object(D.a)(y,"EventsCacheLoggingUtils",null,[]);class m{constructor(G,M,K,L){this.CmdId=this.ParentTcid=this.Tcid=null;this.Time=0;this.Tcid=G;this.ParentTcid=M;this.CmdId=K;this.Time=L}}Object(D.a)(m,"MRUControl",null,[]);var t=c(2),z=c(1851),v=c(658),H=c(157);c.d(I,"a",function(){return F});class F{constructor(){this.Xyc=null;this.T6g=this.xKe=20;this.Srd=this.Ata=this.pvc=this.kid=this.Tid=null;this.Fgh=this.HGe=!1}init(){this.Xyc=new y;this.Tid=new l.a;this.kid=new l.a;this.pvc=new l.a;this.xKe=
t.AFrameworkApplication.K.mc("MaxCommandClickedEventQueueSize",20);z.a.Mxk(Object(e.a)(this,this.r1k,"commandClickEventRaised"));v.a.instance.Mqh(Object(e.a)(this,this.OQn,"recordActionEvent"));this.HGe=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UserMRUActionsCookieEnabled",!1);this.Fgh=t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPreferParentControls",!0);this.HGe&&(this.Ata=new l.a,this.Srd="UserRecentActions_"+this.qQd(),
this.P2m())}qQd(){switch(t.AFrameworkApplication.ua.Kb.yk){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}P2m(){var G=H.a.get(this.Srd);if(!this.Xyc.isNullOrUndefined(G)&&0<G.length){let M=null;try{M=JSON.parse(decodeURIComponent(G))}catch(K){H.a.remove(this.Srd);return}G=0;for(const K of M)this.Ata.insert(G++,K)}}esk(G){const M=this.Fgh&&!this.Xyc.isNullOrUndefined(G.Uhc)&&0<G.Uhc.length;if(0<this.Ata.count){for(var K=
0;K<this.Ata.count&&3>K;K++){var L=this.Ata.J(K);if(M&&L.ParentTcid===G.Uhc||L.Tcid===G.controlId)return}for(K=3;K<this.Ata.count;K++)if(L=this.Ata.J(K),M&&L.ParentTcid===G.Uhc||L.Tcid===G.controlId){this.Ata.remove(L);break}}this.Ata.insert(0,new m(G.controlId,G.Uhc,G.commandId,G.time));this.Ata.count>this.T6g&&this.Ata.removeAt(this.T6g);G=JSON.stringify(this.Ata.toArray());H.a.PIa(this.Srd,G,H.a.hHa)}Png(G){G.count>this.xKe&&G.removeAt(this.xKe)}r1k(G,M){this.Tid.insert(0,new x(M.commandId,M.controlId,
M.time,M.commandSurface,M.Rx,M.contentType,M.Uhc));this.Png(this.Tid);this.HGe&&this.Xyc.HXm(M.controlId)&&this.esk(M)}OQn(G,M){this.kid.insert(0,new x(M.actionName,M.controlId,M.timeStamp,M.commandSurface,M.Rx,M.contentType,M.Ple));this.Png(this.kid);this.Xyc.GXm(M.actionName)&&(this.pvc.insert(0,new x(M.actionName,M.controlId,M.timeStamp,M.commandSurface,M.Rx,M.contentType,M.Ple)),this.Png(this.pvc))}VPc(){return this.Tid}Dib(){return this.kid}static get instance(){return F._instance||(F._instance=
new F)}}F._instance=null;Object(D.a)(F,"CommandClickEventsCache",null,[])},1674:function(D,I,c){D=c(0);var l=c(139),e=c(60),a=c(358),k=c(55),x=c(3),y=c(735),m=c(18),t=c(5),z=c(301),v=c(43),H=c(1343),F=c(832),G=c(119),M=c(46),K=c(16),L=c(6),R=c(174),S=c(41),N=c(7),O=c(1891),W=c(689),V=c(1731),Q=c(126),Y=c(1580);class ba{constructor(sa,Da,Pa,Ra,Ga,ta){this.B7b=this.RH=null;this.knf=Da;if(sa[W.a.ESc])this.nP=sa[W.a.ESc],this.rGc=sa[W.a.rGc],this.B7b=Array(4),this.B7b[0]=sa[W.a.vhb],this.B7b[1]=sa[W.a.whb],
this.B7b[2]=sa[W.a.xhb],this.B7b[3]=sa[W.a.uhb],this.I4o=sa[W.a.width],this.jum=sa[W.a.height],this.Xxa=void 0!==sa[W.a.Xxa]?"true"===sa[W.a.Xxa].toLowerCase():void 0,this.Qs=Pa,this.q7b=Ra;else{Da=sa[W.a.vhb];const va=sa[W.a.whb],ia=sa[W.a.xhb],qa=sa[W.a.uhb];ta&&ta.$("EffectExtentPointsForGraphicsEditorIsEnabled")&&void 0!==Da&&void 0!==va&&void 0!==ia&&void 0!==qa?(this.vhb=Da,this.whb=va,this.xhb=ia,this.uhb=qa):(this.vhb=sa[W.a.left],this.whb=sa[W.a.right],this.xhb=sa[W.a.top],this.uhb=sa[W.a.bottom]);
this.width=sa[W.a.width];this.height=sa[W.a.height];this.rotationAngle=sa[W.a.angle];this.ODn=sa[W.a.NDn];this.Qs=Pa;this.q7b=Ra;this.agb=Ga;this.$Fa=2;this.flipH=this.$X(sa,W.a.flipH);this.flipV=this.$X(sa,W.a.flipV);this.Xhn();this.eWo()}}eWo(){this.RH||(this.RH=Array(4),this.RH[0]=Q.a.DG(this.vhb),this.RH[1]=Q.a.DG(this.whb),this.RH[2]=Q.a.DG(this.xhb),this.RH[3]=Q.a.DG(this.uhb))}Xhn(){var sa=Y.c(this.rotationAngle);if(45<=sa&&135>=sa||225<=sa&&315>=sa){sa=this.width/2;const Da=this.height/2;
this.vhb-=sa-Da;this.whb+=sa-Da;this.xhb-=Da-sa;this.uhb+=Da-sa}}$X(sa,Da){if(sa.hasOwnProperty(Da))return sa[Da]}}Object(D.a)(ba,"JsonToDocumentXmlResponseCommonParams",null,[]);class Z extends ba{constructor(sa,Da,Pa,Ra,Ga,ta){super(sa,Da,Pa,Ra,Ga,ta);this.pCk="string"===typeof sa[W.a.UCd]?sa[W.a.UCd]:null;this.m8b="string"===typeof sa[W.a.m8b]?sa[W.a.m8b]:null}}Object(D.a)(Z,"JsonToDocumentXmlResponseDrawingParams",ba,[]);var ea=c(521),ha=c(505);class ka extends ba{constructor(sa,Da,Pa,Ra,Ga,ta){var va,
ia,qa,pa,Fa;super(sa,Da,Pa,Ra,Ga,ta);this.f0o=sa[W.a.wDn];this.n5k=sa[W.a.oDn];this.$Fa=ha.a.rendered;this.n5k||(this.$Fa=ha.a.notRendered,this.RH=ea.a.instance.zoa(Q.a.DG(this.width),Q.a.DG(this.height),this.rotationAngle));this.JZf=this.$X(sa,W.a.vhc);this.C9d=this.$X(sa,W.a.C9d);this.KZf=this.$X(sa,W.a.KZf);this.QKj=this.$X(sa,W.a.PKj);this.Kpe=this.$X(sa,W.a.Kpe);this.jsg=this.$X(sa,W.a.jsg);this.y6c=null!==(va=this.$X(sa,W.a.y6c))&&void 0!==va?va:"";this.extension=sa[W.a.extension];this.Iva=
null!==(ia=this.$X(sa,W.a.left))&&void 0!==ia?ia:0;this.Kva=null!==(qa=this.$X(sa,W.a.top))&&void 0!==qa?qa:0;this.Jva=null!==(pa=this.$X(sa,W.a.right))&&void 0!==pa?pa:0;this.Hva=null!==(Fa=this.$X(sa,W.a.bottom))&&void 0!==Fa?Fa:0;this.lockAspectRatio=this.$X(sa,W.a.lockAspectRatio);this.ryh=this.$X(sa,W.a.sja);this.borderStyle=this.$X(sa,W.a.Mqa);this.borderColor=this.$X(sa,W.a.UHa);this.PLk=void 0!==this.ryh||void 0!==this.borderStyle||void 0!==this.borderColor;this.altTextDescription=this.$X(sa,
W.a.altTextDescription);this.alphaModFix=this.$X(sa,W.a.alphaModFix)}}Object(D.a)(ka,"JsonToDocumentXmlResponsePictureParams",ba,[]);c.d(I,"a",function(){return ua});class ua{constructor(sa,Da,Pa,Ra,Ga,ta,va,ia,qa,pa,Fa,za,Oa,xa,fa,Ka,lb){this.bbb=this.Bzb=null;this.Lmd=sa;this.qCe=Da;this.oK=Pa;this.Qm=Ra;this.Yl=Ga;this.Lc=ta;this.v2j=ia;this.MTg=va;this.Vj=qa;this.ap=pa;this.sfk=Fa;this.rfk=za;this.Ca=Oa;this.bW=xa;this.rd=fa;this.M8j=Ka;this.P6j=lb}yqa(sa,Da,Pa,Ra,Ga,ta,va){ta.stop();va?N.ULS.sendTraceTag(575522565,
3001,10,sa):N.ULS.sendTraceTag(575522566,3001,10,sa);this.MTg?(Ra=this.Lc.Pc(7,x.a.FSc),Ra.Db(Pa),this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",!1)&&Da.Gb.setValue(G.a.IPa,!1),Da.Gb.setValue(M.a.B0,0),Da.Gb.setValue(K.a.Hia,Da.FQk),Da.Gb.setValue(K.a.Gia,Da.DQk),Ra.dispose()):Ra();this.bbb&&this.bbb(sa);Ga()}ehc(sa,Da,Pa,Ra,Ga,ta,va){N.ULS.sendTraceTag(575522567,3001,50,"GraphicsEditorJsonToDocumentXmlRequestHelper: {0}",{["Method"]:"OnRequestSuccess",
["DurationInMilliseconds"]:va.oi});var ia=sa.data.se,qa=null;try{qa=JSON.parse(ia)}catch(Fa){this.yqa("Failed to parse incoming JSON blob.",Da,Ga,Ra,Pa,va,!1);return}if(O.a.error in qa)this.yqa("Error code returned from WordGraphicsEditorHandler endpoint: "+qa[O.a.error],Da,Ga,Ra,Pa,va,!1);else{ia=10;var pa=1;try{ia=parseInt(qa[W.a.Qs]),pa=parseInt(qa[W.a.q7b])}catch(Fa){this.yqa("Invalid data found in the JSON blob. (i.e. placeholderkind/drawingid)",Da,Ga,Ra,Pa,va,!1);return}Pa=sa.data.request?y.a.VNc(sa.data.request.get_body()):
null;sa=null;sa=Da.Gb;Ra=Da.getId();Da=sa.getValue(L.a.Qs);Da=Da!==ia&&(5===Da||5===ia||this.Xrm(sa,qa));5===ia?(qa=new ka(qa,this.qCe,ia,pa,Pa,this.Ca),sa=this.DSl(Ga,ta,qa,Da,sa,Ra)):(qa=new Z(qa,this.qCe,ia,pa,Pa,this.Ca),sa=this.CSl(Ga,ta,qa,Da,sa,Ra));qa=this.Lc.Pc(7,x.a.FSc);ia=Ga;m.ImageReader.r9(Ga)&&Da&&(ia=t.GraphIterator.eb(Ga),ia.zb(12),ia=ia.parentNode);qa.Db(ia);sa();this.oK.IIa(ta);qa.dispose();if(this.Yl&&this.Yl!==l.a.nil){const Fa=ia.Yi();null===Fa||void 0===Fa?void 0:Fa.contentReplicator.forceOutbound(()=>
{N.ULS.sendTraceTag(574358089,3001,50,"Graphical Content Properties Persisted to Box4: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:va.oi});va.stop();const za=new e.a(this.Yl,1);this.Qm.g5b(Fa,za);const Oa=this.Lmd.properties;null!=Oa&&Object(z.a)(()=>{const xa=new v.GraphTransaction(3,x.a.m9);xa.Db(Ga);Oa.setValue(G.a.G5,1);xa.dispose()})},null,null)}this.Bzb&&this.Bzb(Ga)}}Lth(sa,Da){sa.Be(O.a.l1f,"false");sa.Be(O.a.knf,this.qCe);sa.Be(O.a.daf,"0");sa.bJ(W.a.agb,window.self.devicePixelRatio.toString());
void 0!==Da&&null!==Da&&(Da=this.ap.rn(Da.ik),Da=this.ap.ui(Da),sa.Be(W.a.Qs,H.a[Da]));this.M8j&&(sa.Be(W.a.qXd,"true"),sa.Be(W.a.Yxm,this.P6j.toString()))}tnh(sa){if(this.MTg){sa=sa.ik;var Da=this.ap.rn(sa);if(!Da)return null;const Pa=new V.a(this.v2j,Da),Ra=this.Lc.Pc(15,x.a.FSc);Ra.Db(sa.node);this.e2i(Da,!1);Da.setValue(L.a.Qs,Da.ja(L.a.Qs,10));Ra.Uj=x.a.FSc;Ra.eHa(this.Yl,1);Ra.dispose();return Pa}Da=new a.DictionaryPropertySet;this.e2i(Da,!0);return(sa=this.Vj.dUh(sa,Da,this.Yl))&&sa.blob?new V.a(sa.blob.id,
sa.blob.properties):null}fUd(){return Box4Intl.Box4Strings.l_GraphicsEditorError}e2i(sa,Da){sa.setValue(K.a.Hia,k.a.Ql(this.sfk,0));sa.setValue(K.a.Gia,k.a.Ql(this.rfk,1));this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",!1)&&!Da?sa.setValue(G.a.IPa,!0):sa.setValue(M.a.B0,1);sa.setValue(R.a.P4,!0)}CSl(sa,Da,Pa,Ra,Ga,ta){const va=ia=>{this.Lmd.IWo(Pa,ia,sa)};return this.$Qi(Ra,Ga,sa)?this.z7h(Da,Ga,ta,va):()=>{va(Ga)}}DSl(sa,Da,Pa,Ra,Ga,ta){const va=
ia=>{this.Lmd.JWo(Pa,ia,sa)};return this.$Qi(Ra,Ga,sa,Pa)?this.z7h(Da,Ga,ta,va):()=>va(Ga)}$Qi(sa,Da,Pa,Ra){return sa?!0:Ra?m.ImageReader.kTd(Da,Pa.Mc,!1)!==Ra.JZf:!1}z7h(sa,Da,Pa,Ra){const Ga=F.a.instance.Gfd;Ga.ax(Da);Ga.id=Pa;return()=>{this.Lmd.p4n(sa,Pa,Ga,this.bW,Ra)}}loo(sa){this.Bzb=sa}Dio(sa){this.bbb=sa}Xrm(sa,Da){return this.rd.isFeatureEnabled(47)&&(sa.hasProperty(S.a.nP)&&!Da[W.a.ESc]||!sa.hasProperty(S.a.nP)&&Da[W.a.ESc])?!0:!1}}Object(D.a)(ua,"GraphicsEditorJsonToDocumentXmlRequestHelper",
null,[345])},1675:function(D,I,c){D=c(0);var l=c(34),e=c(7),a=c(457),k=c(578),x=c(2E3),y=c(2),m=c(19),t=c(257),z=c(10),v=c(1799);class H extends x.a{constructor(G,M,K,L,R,S,N=null,O=!1){super(G,M,K,L,R,"WACUploadFrame",y.AFrameworkApplication.userSessionId,S,!1,N,O)}IB(G){return z.App.za.qj(G)}wkj(G){t.a.instance.TAb(G)}DKc(){y.AFrameworkApplication.canary&&this.T5b(a.a.canary,y.AFrameworkApplication.canary);z.App.za.jb.activeSection.TH&&this.T5b(a.a.TH,z.App.za.jb.activeSection.TH)}sUd(G){let M=
null,K;({group:K}=k.a.d2(G)).returnValue?M=K.Responses[0]:e.ULS.sendTraceTag(41697634,322,10,"Box4UploadFrame.GetServerResponse: unable to deserialize the response");return M}uac(){e.ULS.sendTraceTag(41697635,322,15,"Box4ImageUploadFrame.HandleUploadError: The response is invalid, falling back on a default unspecified failure response");const G=new v.a;G.StatusCode=14;this.Tej(G);this.IBd()}WMb(G){G?(G=m.a.Lwj(G),G=G.replace(RegExp("&amp;","g"),"&"),(G=this.sUd(G))?(this.Tej(G),this.IBd()):this.uac()):
this.uac()}}Object(D.a)(H,"Box4UploadFrame",x.a,[]);c.d(I,"a",function(){return F});class F extends H{constructor(G,M,K,L,R,S=null,N=!1){super(G,M,K,L,R,F.bMl(),S,N);this.QBf()}static bMl(){return F.Dlh.join(",")+","+F.MXe.join(",")}DKc(){super.DKc();this.T5b(a.a.jsb,"1");this.T5b(a.a.oTb,"1")}uac(){super.uac();e.ULS.sendTraceTag(41697632,322,15,"Box4ImageUploadFrame.HandleUploadError: Falling back on a default Unspecified Failure response")}sUd(G){const M=super.sUd(G);if(!M)try{const K=l.a(G);k.a.$mf(K)}catch(K){e.ULS.sendTraceTag(41697633,
322,10,"Box4ImageUploadFrame.GetServerResponse: {0}",K.toString())}return M}}F.Dlh=".jpg .jpeg .png .gif .bmp .tif .tiff .jfif".split(" ");F.MXe=[".webp"];Object(D.a)(F,"Box4ImageUploadFrame",H,[])},1677:function(D,I,c){D=c(0);class l{}Object(D.a)(l,"AuthContext",null,[]);var e=c(2),a=c(466);c.d(I,"a",function(){return k});class k{static getAuthContext(){const x=e.AFrameworkApplication.K.kb("UserPrincipalName")||"";let y=x;e.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginHintEnabled",
!1)&&(y=a.OAuthManagerSettings.Ljn||x);return Object.assign(new l,{upn:x,loginHint:y,authority:a.OAuthManagerSettings.authority,authorityType:k.vQd(),tenantId:e.AFrameworkApplication.K.kb("TenantId")||""})}static vQd(){let x=0;const y=k.E5h();"aad"===y.toLowerCase()?x=2:"msa"===y.toLowerCase()&&(x=1);return x}static E5h(){return e.AFrameworkApplication.K.kb("HostAuthType")||""}}Object(D.a)(k,"OAuthIdentity",null,[])},1678:function(D,I,c){c.r(I);D=c(0);var l=c(1843),e=c(54),a=c(1845),k=c(449),x=c(1846),
y=c(176),m=c(2),t=c(96),z=c(91),v=c(535),H=c(232),F=c(11),G=c(67),M=c(79),K=c(102),L=c(93),R=c(28),S=c(56),N=c(39),O=c(20),W=c(13);class V{constructor(ba){this.X4d=4;this.ach=0;this.fSg=this.eOg=this.ydh=this.mTg=this.Reh=this.GCa=this.$0b=this.Sw=this.Rhh=this.sWg=this.tWg=this.xCa=this.jZa=this.Nze=this.iXa=this.aXa=this.W=this.O6=this.VAa=null;O.a.Gxa&&(this.X4d=6);this.yv=ba;this.YZ=K.KeyInputManager.ic(M.a.l2,0);this.render()}get containerElement(){return this.W}dispose(){var ba=m.AFrameworkApplication.ua.oD;
const Z=m.AFrameworkApplication.ua.pD;ba.sc(F.a.click,this.W,Object(e.a)(this,this.BUi,"onContainerClick"));ba.sc(F.a.vB,this.W,Object(e.a)(this,this.CUi,"onContainerDoubleClick"));Z.sc(F.a.yh,this.W,Object(e.a)(this,this.DUi,"onContainerKeyPress"));this.aXa&&(ba.sc(F.a.click,this.aXa,Object(e.a)(this,this.oWf,"onDeleteButtonClick")),Z.Mrb(this.aXa,this.fSg));this.iXa&&(ba.sc(F.a.click,this.iXa,Object(e.a)(this,this.wWf,"onDoneButtonClick")),Z.Mrb(this.iXa,this.mTg));this.xCa&&(ba.sc(F.a.click,this.xCa,
Object(e.a)(this,this.y8d,"onSaveButtonClick")),Z.Mrb(this.xCa,this.Reh));this.VAa&&(ba.sc(F.a.click,this.VAa,Object(e.a)(this,this.MVf,"onCancelButtonClick")),Z.Mrb(this.VAa,this.eOg));this.jZa&&(ba.sc(F.a.click,this.jZa,Object(e.a)(this,this.tYf,"onReplyButtonClick")),Z.Mrb(this.jZa,this.ydh));this.Sw&&(Z.sc(F.a.ru,this.Sw,Object(e.a)(this,this.EHa,"onKeyEvent")),Z.sc(F.a.yh,this.Sw,Object(e.a)(this,this.EHa,"onKeyEvent")),O.a.vi&&(ba=m.AFrameworkApplication.ua.Anc,ba.sc(F.a.yJc,this.Sw,Object(e.a)(this,
this.zHa,"onCompositionEvent")),ba.sc(F.a.k5b,this.Sw,Object(e.a)(this,this.zHa,"onCompositionEvent")),ba.sc(F.a.l5b,this.Sw,Object(e.a)(this,this.zHa,"onCompositionEvent"))),v.a.instance.sc(F.a.paste,this.Sw,Object(e.a)(this,this.u2c,"onPaste")));this.GCa=this.$0b=this.Sw=this.VAa=this.xCa=this.Nze=this.iXa=this.jZa=this.aXa=this.W=null}focus(){G.FocusManager.instance().kD(y.AFrame.Ur);this.W.focus();this.yv.Zq.hpf().hk.gz(this.W)}V1h(){G.FocusManager.instance().kD(a.a.qJc);this.Sw.focus();this.yv.Zq.hpf().hk.gz(this.Sw);
2===this.yv.$q&&this.Sw.value&&0<this.Sw.value.length&&N.a.K8c(this.Sw);const ba=this.yv.Zq.Mda.q3c,Z=N.a.Y2a(ba,this.W);Z.y+this.W.clientHeight>ba.scrollTop+ba.clientHeight&&(ba.scrollTop=Z.y+this.W.clientHeight-ba.clientHeight)}xFl(){Sys.UI.DomElement.removeCssClass(this.W,"NewOrEditComment");this.VAa.style.display="none";this.Sw.style.display="none";G.FocusManager.Ung(this.Sw);G.FocusManager.Ung(this.xCa);G.FocusManager.instance().fe(a.a.qJc).nr(this.YZ);G.FocusManager.instance().i7a(a.a.qJc);
K.KeyInputManager.instance.sc(F.a.ru,this.Sw,Object(e.a)(this,this.EHa,"onKeyEvent"));K.KeyInputManager.instance.sc(F.a.yh,this.Sw,Object(e.a)(this,this.EHa,"onKeyEvent"));if(O.a.vi){const ba=m.AFrameworkApplication.ua.Anc;ba.sc(F.a.yJc,this.Sw,Object(e.a)(this,this.zHa,"onCompositionEvent"));ba.sc(F.a.k5b,this.Sw,Object(e.a)(this,this.zHa,"onCompositionEvent"));ba.sc(F.a.l5b,this.Sw,Object(e.a)(this,this.zHa,"onCompositionEvent"))}v.a.instance.sc(F.a.paste,this.Sw,Object(e.a)(this,this.u2c,"onPaste"));
this.O6.removeChild(this.Sw);this.O6.removeChild(this.$0b);this.GCa=this.$0b=this.Sw=null;this.fqg();this.Idd();this.focus()}Idd(){this.Mcj(this.Rhh,this.tWg,this.sWg,this.Nze,this.W)}render(){var ba=k.a("a",this.Sia("cc"),"CommentContainer");R.a.lr(ba,R.a.wga,a.a.J2k);ba.tabIndex=0;this.yv.Df&&(ba.className+=" Reply1");var Z=k.a("div",this.Sia("ch"),"CommentHeaderRow");const ea=k.a("span",this.Sia("ca"),"CommentAuthor UIFontBold");ea.innerText=this.yv.author;Z.appendChild(ea);const ha=k.a("span",
this.Sia("ct"),"CommentDate");ha.innerText=V.fil(this.yv.date,this.yv.Zq.eil,this.yv.Zq.wKo);Sys.UI.DomElement.addCssClass(ha,m.AFrameworkApplication.isRtl?"FloatLeft":"FloatRight");Z.appendChild(ha);const ka=k.a("span",this.Sia("ci"),"CommentStatusIcon");Z.appendChild(ka);let ua=null;this.yv.$Ib&&(ua=x.a.M0a(this.Sia("cl"),a.a.L1k,CommonUIStrings.l_CommentCancelButton,"ClosePaneGlyph_16x16x32",!1),Sys.UI.DomElement.addCssClass(ua,m.AFrameworkApplication.isRtl?"FloatLeft":"FloatRight"),ua.tabIndex=
0,Z.appendChild(ua));this.O6=k.a("div",this.Sia("cn"),"CommentContent");let sa=null,Da=null,Pa=null;this.yv.$Ib?(sa=k.a("textarea",this.Sia("ce"),a.a.xHh+" UIFont"),sa.rows=this.X4d,sa.cols=50,sa.tabIndex=0,R.a.lr(sa,"title",CommonUIStrings.l_CommentContent),this.O6.appendChild(sa),Da=k.a("div","","CommentTextMeasurementContainer"),Pa=k.a("textarea","",a.a.xHh+" UIFont"),Pa.rows=1,Pa.cols=50,Pa.style.visibility="hidden",Pa.spellcheck=!1,Da.appendChild(Pa),this.O6.appendChild(Da),2===this.yv.$q&&(sa.value=
this.yv.text.join("\n")+"\n")):this.fqg();const Ra=k.a("div","","CommentFooterRow"),Ga=k.a("span",this.Sia("cf"),""),ta=x.a.M0a(this.Sia("cr"),a.a.D2k+" CommentFooterButton",CommonUIStrings.l_CommentReplyButton,"CommentReply_16x16x32",!1);ta.tabIndex=0;ta.setAttribute(R.a.uh,R.a.X3);Ga.appendChild(ta);const va=x.a.M0a(this.Sia("cd"),"CommentDoneButton CommentFooterButton",CommonUIStrings.l_CommentDoneButton,"CheckboxUnchecked_16x16x32",!1);va.tabIndex=0;const ia=va.childNodes[0].childNodes[0];Ga.appendChild(va);
const qa=x.a.M0a(this.Sia("cx"),a.a.N1k+" CommentFooterButton",CommonUIStrings.l_CommentDeleteButton,"Delete_16x16x32",!1);va.tabIndex=0;Ga.appendChild(qa);Ra.appendChild(Ga);const pa=k.a("span",this.Sia("cfa"),""),Fa=x.a.M0a(this.Sia("cs"),a.a.E2k,CommonUIStrings.l_CommentSaveCommentButton,null);x.a.fQb(Fa,!1);Fa.tabIndex=0;pa.appendChild(Fa);Ra.appendChild(pa);this.Mcj(ka,Ga,pa,ia,ba);this.yv.Zq.IKh||(ea.setAttribute("Unselectable","on"),ha.setAttribute("Unselectable","on"));ba.appendChild(Z);ba.appendChild(this.O6);
ba.appendChild(Ra);this.W=ba;this.iXa=va;this.Nze=ia;this.aXa=qa;this.jZa=ta;this.xCa=Fa;this.Sw=sa;this.$0b=Da;this.GCa=Pa;this.VAa=ua;this.tWg=Ga;this.sWg=pa;this.Rhh=ka;ba=m.AFrameworkApplication.ua.oD;Z=m.AFrameworkApplication.ua.pD;ba.ob(F.a.click,this.W,Object(e.a)(this,this.BUi,"onContainerClick"));ba.ob(F.a.vB,this.W,Object(e.a)(this,this.CUi,"onContainerDoubleClick"));Z.ob(F.a.yh,this.W,Object(e.a)(this,this.DUi,"onContainerKeyPress"));this.iXa&&(ba.ob(F.a.click,this.iXa,Object(e.a)(this,
this.wWf,"onDoneButtonClick")),this.mTg=Z.Wob(this.iXa,Object(e.a)(this,this.wWf,"onDoneButtonClick"),M.a.Ss));this.jZa&&(ba.ob(F.a.click,this.jZa,Object(e.a)(this,this.tYf,"onReplyButtonClick")),this.ydh=Z.Wob(this.jZa,Object(e.a)(this,this.tYf,"onReplyButtonClick"),M.a.Ss));this.xCa&&(ba.ob(F.a.click,this.xCa,Object(e.a)(this,this.y8d,"onSaveButtonClick")),this.Reh=Z.Wob(this.xCa,Object(e.a)(this,this.y8d,"onSaveButtonClick"),M.a.Ss));this.aXa&&(ba.ob(F.a.click,this.aXa,Object(e.a)(this,this.oWf,
"onDeleteButtonClick")),this.fSg=Z.Wob(this.aXa,Object(e.a)(this,this.oWf,"onDeleteButtonClick"),M.a.Ss));this.VAa&&(ba.ob(F.a.click,this.VAa,Object(e.a)(this,this.MVf,"onCancelButtonClick")),this.eOg=Z.Wob(this.VAa,Object(e.a)(this,this.MVf,"onCancelButtonClick"),M.a.Ss));sa&&(Z.ob(F.a.ru,sa,Object(e.a)(this,this.EHa,"onKeyEvent")),Z.ob(F.a.yh,sa,Object(e.a)(this,this.EHa,"onKeyEvent")),O.a.vi&&(ba=m.AFrameworkApplication.ua.Anc,ba.ob(F.a.yJc,sa,Object(e.a)(this,this.zHa,"onCompositionEvent"),null),
ba.ob(F.a.k5b,sa,Object(e.a)(this,this.zHa,"onCompositionEvent"),null),ba.ob(F.a.l5b,sa,Object(e.a)(this,this.zHa,"onCompositionEvent"),null)),v.a.instance.ob(F.a.paste,sa,Object(e.a)(this,this.u2c,"onPaste")),this.Dqo())}wnj(ba){x.a.fQb(this.xCa,ba)}Sia(ba){return ba+"_"+this.yv.id}Mcj(ba,Z,ea,ha,ka){switch(this.yv.eUa){case 0:case 1:this.jtj(ba,0);break;case 2:case 4:ba.style.display="none";break;case 3:Sys.UI.DomElement.addCssClass(ka,"SaveFailure"),Sys.UI.DomElement.addCssClass(ka,"NoReply"),
this.jtj(ba,1)}this.yv.done?(Sys.UI.DomElement.addCssClass(ka,"CommentIsDone"),ha.className=z.getImageClass("CheckboxChecked_16x16x32")):(Sys.UI.DomElement.removeCssClass(ka,"CommentIsDone"),ha.className=z.getImageClass("CheckboxUnchecked_16x16x32"));this.yv.$Ib?(Sys.UI.DomElement.addCssClass(ka,"NewOrEditComment"),Sys.UI.DomElement.addCssClass(ka,"SelectedComment"),ba.style.display="none",Z.style.display="none",ea.style.display="inline",0===this.yv.Zq.mode&&(this.wnj(!1),x.a.fQb(this.VAa,!1))):(1===
this.yv.Yja?(Sys.UI.DomElement.addCssClass(ka,"SelectedComment"),Sys.UI.DomElement.removeCssClass(ka,"SelectedParentComment"),Z.style.display=1!==this.yv.Zq.mode||3===this.yv.eUa||this.yv.wRa?"none":"inline"):(2===this.yv.Yja?(Sys.UI.DomElement.removeCssClass(ka,"SelectedComment"),Sys.UI.DomElement.addCssClass(ka,"SelectedParentComment")):(Sys.UI.DomElement.removeCssClass(ka,"SelectedComment"),Sys.UI.DomElement.removeCssClass(ka,"SelectedParentComment")),Z.style.display="inline"),ea.style.display=
"none")}jtj(ba,Z){S.a.KC(ba);switch(Z){case 0:Z=document.createElement("img");Z.alt=CommonUIStrings.l_CommentProgressTooltip;Z.src=t.a.Tba("progress16.gif");ba.appendChild(Z);break;case 1:Z=z.createClusteredImage(16,16,"Risks_16x16x32","",!0,CommonUIStrings.l_CommentFailTooltip),ba.appendChild(Z)}ba.style.display="inline-block"}fqg(){S.a.U_(this.O6);var ba=this.yv.text;1===ba.length&&ba[0]&&(ba=ba[0].split("\n"));for(const Z of ba)ba=k.a("p","","CommentContentPara"),ba.innerText=Z||"\u00a0",this.yv.Zq.IKh||
ba.setAttribute("Unselectable","on"),this.O6.appendChild(ba)}Dqo(){const ba=G.FocusManager.instance().fe(a.a.qJc);ba.parent=y.AFrame.Ur;H.a.instance.r2b(a.a.qJc,this.Sw);ba.bindAction(K.KeyInputManager.ic(M.a.$re,2),W.a.Kg);ba.bindAction(this.YZ,W.a.r9e);ba.bindAction(K.KeyInputManager.ic(M.a.v6,0),W.a.t1a);ba.bindAction(K.KeyInputManager.ic(M.a.Lea,0),W.a.t1a);ba.nr(G.FocusManager.instance().WW);ba.nr(G.FocusManager.instance().XW)}BUi(ba){if(this.yv.$Ib&&ba.Hb.target===this.Sw)return!0;this.yv.HYf();
return!0}CUi(){this.yv.fVi();return!0}DUi(ba){let Z=!1;ba.Hb.keyCode===M.a.Ss&&(0===this.yv.Yja?this.yv.HYf():this.yv.fVi(),Z=!0);return Z}oWf(){if(this.aXa.disabled)return!0;this.yv.bja();return!0}wWf(){if(this.iXa.disabled)return!0;this.yv.Avn();return!0}tYf(){if(this.jZa.disabled)return!0;this.yv.ntn();return!0}y8d(){if(this.xCa.disabled)return!0;this.yv.SMb(this.Sw.value);return!0}MVf(){if(this.VAa.disabled)return!0;this.yv.rMb();return!0}EHa(ba){if(ba.Hb.ctrlKey&&ba.Hb.keyCode===M.a.Ss)return 0<
this.Sw.value.length&&this.y8d(null),!0;if(ba.Hb.keyCode===M.a.l2)return!0;this.onTextEntered(ba.eventName===F.a.ru&&ba.Hb.charCode===M.a.Ss);return!1}zHa(){this.onTextEntered(!1);return!1}u2c(){const ba=new L.a(0,1,0,()=>{this.onTextEntered(!1)},1);m.AFrameworkApplication.lc.Wb(ba);return!1}onTextEntered(ba){if(0!==this.yv.Zq.mode&&(this.wnj(0<this.Sw.value.length),!O.a.Gxa)){this.$0b.clientWidth!==this.Sw.clientWidth&&(this.$0b.style.width=this.Sw.clientWidth+"px");this.GCa.value=this.Sw.value+
"___";this.ach>this.Sw.value.length&&(this.GCa.rows=1);for(var Z=0,ea=Number.MAX_VALUE;1<=(Z=this.GCa.scrollHeight-this.GCa.clientHeight)&&Z<ea;)ea=Z,this.GCa.rows++;this.GCa.rows<this.X4d?this.Sw.rows=this.X4d:(ba&&this.GCa.rows++,this.Sw.rows=this.GCa.rows);this.ach=this.Sw.value.length}}static fil(ba,Z,ea){if(!ba||isNaN(ba.getDate()))return"";let ha=ea;const ka=new Date;if(ka.getFullYear()!==ba.getFullYear()||ka.getMonth()!==ba.getMonth()||ka.getDate()!==ba.getDate())ha=String.format(CommonUIStrings.l_CommentLongDateFormat,
Z,ea);return ba.localeFormat(ha)}}Object(D.a)(V,"CommentViewObject",null,[9,1090]);var Q=c(139);c.d(I,"Comment",function(){return Y});class Y{constructor(ba,Z,ea,ha,ka,ua,sa,Da,Pa=!1,Ra=null,Ga=null,ta=null){this.FLg=this.GLg=this.ITg=null;this.Fwd=0;this.Edb=2;this.aBa=0;this.Vze=this.oO=null;this.zGf=!1;this.objectId=null;this.wRa=!1;this._id=ba;this.UXg=Z;this.sMg=ea;this.Ojd=ha;this.wvd=ka;this.jLa=ua;this.eO=sa;this.SXg=Da;this.jJh=Pa;this.dXj=Ra;this.eXj=Ga;this.usersByReactionType=ta;this.fj=
l.a.instance}get id(){return this._id}set id(ba){this._id=ba}get author(){return this.J0d?CommonUIStrings.l_RemovedAuthorName:this.sMg}get authorId(){return this.dXj}get C3b(){return this.eXj}get date(){return this.J0d?null:this.Ojd}set date(ba){this.Ojd=ba}get done(){return this.jLa}set done(ba){this.jLa!==ba&&(this.jLa=ba,this.oO&&this.oO.Idd())}get Uli(){return this.SXg}set Uli(ba){this.SXg=ba}get Df(){return this.wvd}set Df(ba){this.wvd=ba}get text(){return this.eO}set text(ba){this.eO=ba;this.oO&&
this.oO.fqg()}get cxa(){return this.UXg}set cxa(ba){this.UXg=ba}get y1a(){return this.ITg}set y1a(ba){this.ITg=ba}get vGc(){return this.GLg}set vGc(ba){this.GLg=ba}get uGc(){return this.FLg}set uGc(ba){this.FLg=ba}get Yja(){return this.Fwd}set Yja(ba){this.Fwd!==ba&&(this.Fwd=ba,this.oO&&this.oO.Idd())}get eUa(){return this.Edb}set eUa(ba){this.Edb===ba||0===this.Edb&&2===ba||3===this.Edb||(this.Edb=ba,this.oO&&this.oO.Idd())}get $q(){return this.aBa}set $q(ba){if(this.aBa!==ba){const Z=this.$Ib&&
0===ba;this.aBa=ba;Z&&this.oO&&this.oO.xFl()}}get $Ib(){return 1===this.aBa||2===this.aBa}get J0d(){return!!this.fj&&this.fj.Zda}get containerElement(){return this.oO?this.oO.containerElement:null}get Zq(){return this.fj}get Bz(){return this.Vze}set Bz(ba){this.Vze=ba}dispose(){this.oO&&(this.oO.dispose(),this.oO=null)}render(){this.oO=new V(this);return this.oO.containerElement}O5a(){this.oO&&this.oO.Idd()}focus(){this.HYf();this.oO.focus();this.$Ib&&this.oO.V1h()}toString(){let ba="[null]";this.eO&&
0<this.eO.length&&(ba=30<this.eO[0].length?this.eO[0].substr(0,30)+"...":this.eO[0]);return String.format('I:{0} A:{1} T:{2} R:{3} D:{4} "{5}"',this._id||"[null]",this.sMg||"[null]",this.Ojd?this.Ojd.toString():"[null]",this.wvd||"[null]",this.jLa,ba)}HYf(){2===this.Zq.mode||3===this.Zq.mode?this.$Ib&&this.oO.V1h():(G.FocusManager.instance().kD(y.AFrame.Ur),1!==this.Fwd&&this.Zq.selectComment(this._id))}fVi(){this.Zq.HFo&&0===this.aBa&&(G.FocusManager.instance().kD(y.AFrame.Ur),this.aBa=2,this.Edb=
0,this.Zq.editComment(this,null))}aon(){3===this.Zq.mode&&(G.FocusManager.instance().kD(y.AFrame.Ur),this.aBa=0,this.Edb=2,this.Zq.S6e())}bja(){G.FocusManager.instance().kD(y.AFrame.Ur);this.Zq.deleteComment(this)}Avn(){this.Zq.iCb(this,!this.jLa)}ntn(){2!==this.Zq.mode&&(G.FocusManager.instance().kD(y.AFrame.Ur),this.Zq.addReply(this.wvd||this._id,null))}SMb(ba){G.FocusManager.instance().kD(y.AFrame.Ur);this.eO=Array(1);this.eO[0]=ba;1===this.aBa?this.Zq.sva(this):this.Zq.lgb(this)}rMb(){G.FocusManager.instance().kD(y.AFrame.Ur);
this.Zq.Mda.q3c&&this.Zq.Mda.q3c.focus();1===this.aBa?(this.Zq.deleteComment(this),this.Zq.Mfe(this.Df)):this.aon()}static JLh(ba,Z,ea,ha){const ka=Q.a.create().toString();ba=new Y(ka,Y.ynm,ba,new Date,Z,!1,[],ea,!1,m.AFrameworkApplication.K.kb("PresenceUserId"),m.AFrameworkApplication.K.kb("PresenceProvider"));ba.aBa=1;ba.Edb=0;ba.Vze=ha;return ba}}Y.ynm=null;Y.c0i=-1;Object(D.a)(Y,"Comment",null,[9,400])},1679:function(D,I,c){D=c(0);var l=c(1229),e=c(2067),a=c(1105),k=c(8),x=c(104),y=c(43),m=c(26),
t=c(23),z=c(305),v=c(772),H=c(948),F=c(60),G=c(2),M=c(780),K=c(20),L=c(79),R=c(399),S=c(758),N=c(19),O=c(15),W=c(7),V=c(371),Q=c(869),Y=c(370),ba=c(870),Z=c(507),ea=c(1057),ha=c(31);class ka{constructor(){this.WMe=void 0}onKeyPressed(va){return this.WMe?this.WMe(va):!1}setKeyPressHandler(va){this.WMe=va}}var ua=c(1467),sa=c(1650),Da=c(1568),Pa=c(1543);c.d(I,"a",function(){return ta});var Ra;(function(va){va[va.WMj=0]="ArrowDown";va[va.XMj=1]="ArrowUp";va[va.F9o=2]="ArrowLeft";va[va.G9o=3]="ArrowRight";
va[va.End=4]="End";va[va.SOj=5]="Enter";va[va.S$o=6]="Escape";va[va.pPj=7]="Home";va[va.Jcp=8]="Space";va[va.Tab=9]="Tab"})(Ra||(Ra={}));Object(D.b)("KeyIdentifier",Ra);var Ga;(function(va){va.Seen="Seen";va.Tried="Tried";va.Kept="Kept";va.Rejected="Rejected"})(Ga||(Ga={}));Object(D.b)("EngagementType",Ga);class ta extends H.a{constructor(va,ia,qa,pa,Fa,za,Oa,xa,fa,Ka,lb,Xa,kb,Bb,Ja,Ma,fb,hc,cc){super();this.ga=va;this.Je=ia;this.Md=qa;this.AD=pa;this.hb=Fa;this.LI=za;this.mB=Oa;this.YV=xa;this.TBa=
fa;this.YI=lb;this.MK=Xa;this.jCa=kb;this.JVj=Bb;this.Un=Ja;this.ld=Ma;this.rC=fb;this.$F=hc;this.Lc=cc;this.lkk=0;this.RSe=!1;this.KKe=1E3;this.okk=3500;this.xxd="ContextIQSignalId";this.sTe=0;this.k1g=!0;this.Una=()=>{this.TBa.reset();this.m4m()};this.h2c=(mb,Hb)=>{for(const Ua of Hb.Qj)mb=Ua.intent,8===mb.type&&(0<=Ua.PKb?(mb=mb.Lb.paragraph,Hb=this.Un.tSd(mb,8,Ua.cpBegin,Ua.cpEnd),1<=Hb.count&&Hb.J(0)&&(Hb=mb.characterData.indexOf("@",Hb.J(0).Ec),this.Un.Kog(mb,Ua.cpBegin,Ua.cpEnd),Hb=new l.a(8,
Hb,Hb+1,F.a.create()),this.Un.fHa(mb,Hb))):this.RBa.Tv(O.a.W$e,!0,void 0,void 0,void 0,void 0))};Ka&&Ka.execute(mb=>this.ema=mb);this.RBa=new ea.a;this.O3g=new ka;this.getPersonImageUrl=this.getPersonImageUrl.bind(this);this.s4h(!0);this.V3h();this.Md.m0e(this.h2c);this.JVj.Xob(this);this.tfa=[new e.a(Pa.a.Yeb,Pa.a.Yeb)]}onSessionClose(){}onSessionConnect(){this.s4h(!1);this.V3h()}onSessionDisconnect(){}get ZHb(){return this.tfa}static PCk(va){return va.results&&0!==va.results.length?va.results[0].entityType===
ba.EntityType.Topic:!1}static dDi(va){return ta.UNj()&&Da.a.CWc(va)&&this.PCk(va)?!0:ta.TNj()?va.isStealth:!1}static VRd(va){var ia,qa;if(0!==(null===(ia=null===va||void 0===va?void 0:va.results)||void 0===ia?void 0:ia.length))return null===(qa=null===va||void 0===va?void 0:va.results[0])||void 0===qa?void 0:qa.entityType}oRa(va,ia){return Da.a.oRa(va,ia,Z.a.Yfb)}U0a(va,ia){va=Da.a.j9b(va,!1,Z.a.Yfb);if(!va||!va.contains(ia))return null;ia=this.Je.Eha(ia);return ta.dDi(null===ia||void 0===ia?void 0:
ia.content)?Pa.a.ECd:Pa.a.Yeb}$ob(va){ta.ufd()&&!this.Dv&&(this.Dv=va,this.jCa.hDa((ia,qa)=>{ia=qa.paragraphNode;const pa=qa.Fja;for(const Fa of qa.contents)1!=Fa.CG&&0!=Fa.CG||Da.a.myf(Fa.element,ia,Fa.intents,this.yGc,this.RIa,this.MK,this.Dv,pa,!1,Z.a.Yfb)}))}V3h(){const va=G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1),ia=G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQSatoriFlags",!1),qa=G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQAddressFlags",
!1),pa=G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQTopicFlags",!1),Fa=G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQLoopFlags",!1),za=ta.vfd()&&ta.WDf?void 0:[Object.assign(new ba.CustomProp,{name:"Filter",value:'{"And":[{"Term":{"PeopleType":"Person"}},{"Term":{"PeopleSubtype":"OrganizationUser"}}]}'})],Oa=Object.assign(new Q.a,{parentPath:["Signal",ba.ClientConfigSignal.getTypeName()],items:[Object.assign(new V.a,
{id:"ClientConfigSignal",body:Object.assign(new ba.ClientConfigSignal,{timestamp:Date.now(),sessionConfig:Object.assign(new ba.SessionConfig,{clientConfig:Object.assign(new ba.ClientConfig,{ecc:Object.assign(new ba.EccConfig,{enabled:ta.wfd()||ta.vfd(),entities:[Object.assign(new ba.EccEntityConfig,{entityType:ba.EntityType.People,enabled:!0,queryPrefix:["@"],customProps:za}),Object.assign(new ba.EccEntityConfig,{entityType:ba.EntityType.File,enabled:!0,queryPrefix:["@"]}),Object.assign(new ba.EccEntityConfig,
{entityType:ba.EntityType.Loop,enabled:va,queryPrefix:["@"]})],bestMatch:Object.assign(new ba.BestMatchConfig,{enabled:ta.Dtg()}),scopes:Object.assign(new ba.ScopeConfig,{enabled:!1})}),flag:Object.assign(new ba.FlagConfig,{enabled:ta.ufd(),entities:[Object.assign(new ba.EntityConfig,{entityType:ba.EntityType.Loop,enabled:va&&Fa}),Object.assign(new ba.EntityConfig,{entityType:ba.EntityType.Topic,enabled:pa}),Object.assign(new ba.EntityConfig,{entityType:ba.EntityType.Address,enabled:qa}),Object.assign(new ba.EntityConfig,
{entityType:ba.EntityType.Satori,enabled:ia})]}),nudge:Object.assign(new ba.NudgeConfig,{enabled:!1}),prediction:Object.assign(new ba.PredictionConfig,{enabled:!1})})})})})]});this.mB.ml().then(()=>{this.YV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Y.a,{operation:Oa}));W.ULS.sendTraceTag(520104021,3034,50,"Submitted ClientConfigSignal Operation.")})}s4h(va){const ia=Object.assign(new Q.a,{parentPath:["Signal",ba.StartupSignal.getTypeName()],items:[Object.assign(new V.a,{id:"SessionStartupSignal",
body:Object.assign(new ba.StartupSignal,{timestamp:Date.now()})})]});this.mB.ml().then(()=>{va&&this.fC();this.YV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Y.a,{operation:ia}));W.ULS.sendTraceTag(521412674,3034,50,"Submitted StartupSignal Operation.")})}fC(){ta.wfd()&&(G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQUseEccResultAnnotation",!1)?(this.Je.ob(this,ba.EccResultAnnotation.getTypeName()),W.ULS.sendTraceTag(521412673,3034,50,"Registered for EccResultAnnotations.")):
(this.Je.ob(this,ba.UserInitiatedResultAnnotation.getTypeName()),W.ULS.sendTraceTag(521412672,3034,50,"Registered for UserInitiatedResultAnnotations.")));ta.ufd()&&(this.Je.ob(this,ba.FlagResultAnnotation.getTypeName()),W.ULS.sendTraceTag(512361884,3034,50,"Registered for FlagResultAnnotations."))}AUo(va,ia,qa,pa,Fa){const za=void 0===ia?!1:this.sTe>ia;this.Wi.eE&&!za&&(va=this.Z3h(va),pa&&va.suggestionGroups&&0<va.suggestionGroups.length&&(va.suggestionGroups[0].previewData=pa.substring(Fa+1,pa.length)),
this.Wi.definition=va,ia&&(this.sTe=ia));ia?(pa=Date.now(),qa=[Object.assign(new ha.a,{name:this.xxd,string:qa}),Object.assign(new ha.a,{name:"ContextIQMenuOpen",bool:this.Wi.eE}),Object.assign(new ha.a,{name:"ContextIQStaleAnnotation",bool:za})],this.RBa.z_c("ContextIQUserInitUserPerceivedLatency",pa-ia,1,!0,void 0,qa)):W.ULS.sendTraceTag(537966025,3034,15,"SignalGenerationTime is undefined, can not determine if this annotation is stale or generate User Perceived Latency telemetry.")}Z3h(va){if(va){var ia=
[],qa=[];switch(va.annotationType){case ba.UserInitiatedResultAnnotation.getTypeName():var pa=va.content;if(!pa)return;for(var Fa of pa.results)ia=ia.concat(Fa.results);pa=Z.a.p0a;break;case ba.EccResultAnnotation.getTypeName():Fa=va.content;if(!Fa)return;for(const za of Fa.entityResults)ia=ia.concat(za.entities);ta.Dtg()&&(qa=null===(pa=Fa.treatments)||void 0===pa?void 0:pa.bestMatchEntries);pa=Z.a.p0a;break;case ba.FlagAnnotation.getTypeName():ia=ia.concat(va.content.results);pa=Z.a.Yfb;break;default:return}va=
{annotationId:va.id,results:ia,bestMatchResults:qa};if(ia=this.k1g)this.k1g=!1;return{...z.g,id:pa,suggestionGroups:[{type:pa,isContentPending:!1,contentData:va,isFirstInvoke:ia}]}}}async getPersonImageUrl(va,ia){va=new M.a(va,"O365",ia,va);if(this.ema&&this.ema.getPersonaIconPropertiesArray&&(va=await this.ema.getPersonaIconPropertiesArray([va]),0<va.length&&va[0].authorImageURL))return va[0].authorImageURL}static Jqe(){return ta.wfd()||ta.ufd()}static wfd(){return ta.Cqe&&G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQAtMentionEntryPointIsEnabled",
!1)}static vfd(){return ta.Cqe&&G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQConsumerAtMentionEntryPointIsEnabled",!1)}static ufd(){return ta.Cqe&&G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQFlagsAreEnabled",!1)}static TNj(){return G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQStealthFlagsAreEnabled",!1)}static SNj(){return G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CIQFlagsIgnoreOnce",
!1)}static Dtg(){return G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQBestMatchIsEnabled",!1)}static UNj(){return G.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContextIQTopicFlagsLimitIsEnabled",!1)}static Cqe(){return!K.a.kda&&!K.a.O4}static get q8a(){return ta.nkk}Pyo(va){if(this.ema){var ia={...z.g,id:Z.a.p0a,suggestionGroups:[{type:Z.a.p0a,isContentPending:!0,contentData:{annotationId:"",results:[]}}]},qa=!1;this.ga.l0(O.a.HUa)&&
(qa=!0);this.Wi.kka(va,ia,this,!0,!1,null,this.Una,null,!1,pa=>{pa.shouldIgnoreFocusEvent=Fa=>{var za;return this.RSe?!0:Fa===(null===(za=this.ld.xe)||void 0===za?void 0:za.editingElement)};pa.getPersonImageUrl=this.getPersonImageUrl},qa,!1,this.O3g)}else W.ULS.sendTraceTag(539068165,3034,15,"PeopleAPI was not ready in time for showing a User Init Context IQ Card")}WFh(){this.Wi.dismiss()}onKeyDown(va){if(va&&va.Hb){switch(va.Hb.keyCode){case L.a.Lea:var ia=Ra.WMj;break;case L.a.QL:ia=Ra.End;break;
case L.a.Ss:ia=Ra.SOj;break;case L.a.u6:ia=Ra.pPj;break;case L.a.Iw:ia=Ra.Tab;break;case L.a.v6:ia=Ra.XMj}void 0!==ia&&(va.Hb.stopPropagation(),va.Hb.preventDefault(),this.O3g.onKeyPressed(ia))}}KB(va,ia){if(va&&va.content&&ia===v.a.getTypeName()&&(va.annotationType===ba.UserInitiatedResultAnnotation.getTypeName()||va.annotationType===ba.EccResultAnnotation.getTypeName())){var qa=ia=void 0,pa=void 0,Fa=0,za=va.parentPath.split("\\");if(za&&6===za.length)if(qa=za[5],za=Date.now(),qa in ta.q8a){clearTimeout(ta.q8a[qa].NKo);
ia=ta.q8a[qa].startTime;pa=ta.q8a[qa].fzo;Fa=ta.q8a[qa].QDd;delete ta.q8a[qa];const Oa=[Object.assign(new ha.a,{name:this.xxd,string:qa})];this.RBa.z_c("ContextIQUserInitALLatency",za-ia,1,!0,void 0,Oa)}else W.ULS.sendTraceTag(537962376,3034,15,"SignalId is not in the dictionary, can not generate AL Latency telemetry.");else W.ULS.sendTraceTag(537966026,3034,15,"Annotation's parent path is not the expected length of 6. Can not generate AL Latency telemetry.");this.AUo(va,ia,qa,pa,Fa)}}get types(){return[Z.a.p0a,
Z.a.Yfb]}npg(va,ia){this.Wi.eE&&this.Wi.npg(va,ia)}get yGc(){return!R.SessionStatusManager.instance.Zj&&1!=G.AFrameworkApplication.ua.mode}RIa(va){return va&&Da.a.CWc(va)?!sa.a.a3b(va):!1}EN(va){if(ta.Jqe()){var ia,qa;if(R.SessionStatusManager.instance.Zj||!this.yGc||!({annotation:ia,J1e:qa}=this.MK.jOd(va.ul,va.yjf,this.RIa)).returnValue)return!1;if(ia.annotationType===ba.FlagAnnotation.getTypeName()){let pa=!1;this.ga.l0(O.a.HUa)&&(pa=!0);const Fa=this.Z3h(ia);va=this.Wi.kka(qa,Fa,this,va.WRa,va.fPa,
null,za=>{(null===za||void 0===za?void 0:za.cardType)===Z.a.Yfb&&(null===za||void 0===za?0:za.ONf)&&this.RBa.Tv(O.a.nId,!0,void 0,void 0,void 0,void 0,{uif:Ga.Tried,entityType:ta.VRd(ia.content)})},null,!1,null,pa);this.Wi.iQb({ONf:!0,cardType:Z.a.Yfb});va&&this.RBa.Tv(O.a.nId,!0,void 0,void 0,void 0,void 0,{uif:Ga.Seen,entityType:ta.VRd(ia.content)});return va}return!1}}nQo(va,ia){this.Je.mAa(va,70);const qa=this.rC.X7h(va,0);if(qa){const pa=new a.a;pa.contentDescriptor=qa;pa.annotationType=va.annotationType;
pa.state=70;this.$F.setState(ia,pa)}}executeAction(va,ia,qa,pa){var Fa,za,Oa,xa=Date.now();if(!ia)return!1;var fa=null===(Fa=this.Wi.definition)||void 0===Fa?void 0:Fa.id;switch(va.actionType){case z.b.Apply:this.Wi.iQb({cardType:fa,ONf:!1});this.LVd(va.descriptorData,ia,qa,pa);fa===Z.a.Yfb&&(ia={uif:Ga.Kept,entityType:ta.VRd(null===(za=this.Je.Eha(va.descriptorData.annotationId))||void 0===za?void 0:za.content)},this.RBa.Tv(O.a.nId,!0,void 0,void 0,void 0,void 0,ia));this.WFh();break;case z.b.ClearSearch:this.RSe=
!0;this.clearSearch(ia,qa,pa,!1);this.Wi.eE&&(this.Msj(),fa=k.ParagraphReader.text(ia).substring(0,qa+1),this.Bnf(ia,fa,qa,xa));this.RSe=!1;break;case z.b.Retry:this.Wi.eE&&(this.Msj(),fa=k.ParagraphReader.text(ia).substring(0,pa),this.Bnf(ia,fa,qa,xa));break;case z.b.OpenEditorPane:if(32!==this.ga.processAction(O.a.HUa,2))return W.ULS.sendTraceTag(520898381,3034,15,"Failed to launch the editor pane from contextual card.",va.actionType),!1;break;case z.b.IgnoreOnce:if(!ta.SNj)return!1;qa=this.Je.Eha(null===
(Oa=va.descriptorData)||void 0===Oa?void 0:Oa.annotationId);this.nQo(qa,ia.Mc);xa=this.Lc.Pc(3);try{xa.Db(ia),ia.ol(16,!0)}finally{xa&&xa.dispose()}this.RBa.Tv(O.a.nId,!0,void 0,void 0,void 0,void 0,{uif:Ga.Rejected,entityType:ta.VRd(qa.content)});this.Wi.iQb({ONf:!1,cardType:fa});this.Wi.dismiss();break;default:return W.ULS.sendTraceTag(539849408,3034,15,"Failed to process action of type {0} since it is not known to us.",va.actionType),!1}return!0}Bnf(va,ia,qa,pa){var Fa,za;const Oa=qa.toString(),
xa=va.id.toString(),fa=xa+"-"+Oa;var Ka=++this.lkk;const lb=fa+"-"+Ka;Ka=(Ka=x.FormattingReader.SRd(va,qa,k.ParagraphReader.textLength(va)))?x.FormattingReader.language(Ka):G.AFrameworkApplication.lcid;Ka=null!==(za=null===(Fa=S.a.tg(Ka))||void 0===Fa?void 0:Fa.NPd)&&void 0!==za?za:"";ia.length>this.KKe&&(qa-=ia.length-this.KKe,ia=ia.slice(-this.KKe));const Xa=Object.assign(new Q.a,{parentPath:["Signal",ua.a.getTypeName(),xa,Oa,fa],items:[Object.assign(new V.a,{id:lb,body:Object.assign(new ua.a,{languageId:Ka,
startOfSentence:!0,text:ia,timestamp:Date.now(),userInitQuery:!0})})]});this.mB.ml().then(()=>{this.YV.getAugLoopRuntimeManager().submitOperation(Object.assign(new Y.a,{operation:Xa}));W.ULS.sendTraceTag(521412643,3034,50,"Submitted Text Predictor Signal.");const kb=[Object.assign(new ha.a,{name:this.xxd,string:lb})];this.RBa.z_c("ContextIQUserInitSignalGenerationLatency",Date.now()-pa,1,!0,void 0,kb)});"@"===ia.slice(-1)&&qa===ia.length-1&&(Fa=this.Un.tSd(va,8,qa,qa))&&0===Fa.count&&(Fa=new l.a(8,
qa,qa+1,F.a.create()),this.Un.fHa(va,Fa));va=setTimeout(()=>{this.Cwo(lb)},this.okk);ta.q8a[lb]={startTime:pa,fzo:ia,QDd:qa,NKo:va}}rXo(){if(this.Wi.eE&&this.Wi.definition&&this.Wi.definition.suggestionGroups&&this.Wi.definition.suggestionGroups[0]){const va=this.Wi.definition;va.suggestionGroups[0].isContentPending=!0;this.Wi.definition=va}}Msj(){this.Wi.definition={...z.g,id:Z.a.p0a,suggestionGroups:[{type:Z.a.p0a,isContentPending:!0,contentData:{annotationId:"",results:[]}}]}}Cwo(va){if(va in ta.q8a){var ia=
ta.q8a[va].startTime;ia=void 0===ia?!1:this.sTe>ia;!ia&&this.Wi.eE&&(this.Wi.definition={...z.g,id:Z.a.p0a,suggestionGroups:[{type:Z.a.p0a,isContentPending:!1,errorMessage:"No results received from AugLoop",contentData:{annotationId:"",results:[]}}]});va=[Object.assign(new ha.a,{name:this.xxd,string:va}),Object.assign(new ha.a,{name:"ContextIQMenuOpen",bool:this.Wi.eE}),Object.assign(new ha.a,{name:"ContextIQStaleSignal",bool:ia})];this.RBa.z_c("ContextIQUserInitALTimeout",1,0,!0,void 0,va)}}LVd(va,
ia,qa,pa){var Fa=va.type;switch(Fa){case ba.EntityType.File:this.insertHyperlink(ia,qa,pa,va.fileName,va.url+"?web=1");break;case ba.EntityType.People:ta.WDf?this.insertHyperlink(ia,qa,pa,va.displayName,"mailto:"+va.primaryEmailAddress):this.TPo(va,ia,qa,pa);break;case ba.EntityType.Loop:this.aEm(va,ia,qa,pa);break;case ba.EntityType.Address:this.aDm(va,ia,qa,pa);break;case ba.EntityType.Satori:Fa="https://www.bing.com/search?q="+va.title.replace(" ","+");this.insertHyperlink(ia,qa,pa,va.title,Fa);
break;case ba.EntityType.Topic:this.insertHyperlink(ia,qa,pa,va.title,va.url);break;default:W.ULS.sendTraceTag(539849409,3034,15,"Failed to process entity of type {0} since it is not known to us.",Fa)}}TPo(va,ia,qa,pa){const Fa=va.primaryEmailAddress,za=new M.a(Fa,"O365",va.displayName,Fa);this.ema.checkUserAccess(za).then(Oa=>{Oa.UserCanWrite?(W.ULS.sendTraceTag(539100301,3034,50,"User has the correct permissions to be AtMentioned"),this.hVc(ia,qa,pa,za)):this.QCj(za,ia,qa,pa)},()=>{W.ULS.sendTraceTag(539100302,
3034,15,"Got back failed response from checking user access for AtMentioned User");this.QCj(za,ia,qa,pa)})}QCj(va,ia,qa,pa){this.ema.grantUsersAccess([va]).then(Fa=>{let za=!1;Fa.Details&&(za=Fa.Details.Result[0].UserCanWrite);za?(W.ULS.sendTraceTag(539100303,3034,50,"AtMentioned User has been granted access"),this.hVc(ia,qa,pa,va)):(W.ULS.sendTraceTag(539100304,3034,50,"AtMentioned user has been denied access"),this.clearSearch(ia,qa,pa,!0))},()=>{W.ULS.sendTraceTag(539100305,3034,15,"Failed Response from Attempt to grant access to AtMentioned user")})}hVc(va,
ia,qa,pa){this.Un.Kog(va,ia,qa);this.RBa.Tv(O.a.W$e,!0,void 0,void 0,void 0,void 0);this.LI.hVc(va,ia,qa,pa.DisplayName,pa.Email)}insertHyperlink(va,ia,qa,pa,Fa){if(va){var za=new y.GraphTransaction(15),Oa=pa+" ";try{za.Db(va);this.Un.Kog(va,ia,qa);this.RBa.Tv(O.a.W$e,!0,void 0,void 0,void 0,void 0);this.Md.Ge(m.a.createTextRange(va,ia,qa),Oa);const xa=N.a.cbc(Fa);this.AD.fF(m.a.createTextRange(va,ia,ia+pa.length),xa,!1,!1,!1);this.hb.Ac(t.SelectionFactory.ne(va,ia+Oa.length))}finally{za&&za.dispose()}}else W.ULS.sendTraceTag(509612897,
3034,15,"Paragraph node is undefined/null.")}aEm(va,ia,qa,pa){if(ia){var Fa=new y.GraphTransaction(15);try{Fa.Db(ia);this.Md.Ge(m.a.createTextRange(ia,qa,pa),"");this.hb.Ac(t.SelectionFactory.ne(ia,qa));const za=va.id;za===Z.a.a9m?this.ga.processAction(O.a.oVc,2):za===Z.a.Y8m?this.ga.processAction(O.a.aVc,2):za===Z.a.$8m?this.ga.processAction(O.a.hYd,2):W.ULS.sendTraceTag(537458136,3034,15,"Trying to insert unsupported loop type.")}finally{Fa&&Fa.dispose()}}else W.ULS.sendTraceTag(537458135,3034,
15,"Paragraph node is undefined/null.")}aDm(va,ia,qa,pa){if(ia){var Fa=new y.GraphTransaction(15);try{Fa.Db(ia);const za=N.a.cbc(va.url);this.AD.fF(m.a.createTextRange(ia,qa,pa),za,!1,!1,!1);this.hb.Ac(t.SelectionFactory.ne(ia,pa));const Oa=this.Je.Eha(va.annotationId);this.Je.mAa(Oa,60)}finally{Fa&&Fa.dispose()}}else W.ULS.sendTraceTag(509434014,3034,15,"Paragraph node is undefined/null.")}clearSearch(va,ia,qa,pa){if(va){var Fa=new y.GraphTransaction(15);pa||(ia+=1);try{Fa.Db(va),this.Md.Ge(m.a.createTextRange(va,
ia,qa),""),this.hb.Ac(t.SelectionFactory.ne(va,ia))}finally{Fa&&Fa.dispose()}}else W.ULS.sendTraceTag(529413333,3034,15,"Paragraph node is undefined/null.")}m4m(){this.YI.execute(va=>{va.logActivity("CIQ_AtInvoke",null)})}}ta.WDf=!1;ta.nkk={};Object(D.a)(ta,"ContextIQIntentProvider",H.a,[265,405])},1681:function(D,I,c){D=c(0);var l=c(336),e=c(251);class a{constructor(x,y,m,t,z,v,H){this.ej=x;this.focusManager=y;this.jF=m;this.clickInputManager=t;this.skc=z;this.T0i=v;this.NQh=H;this.lR=this.bDb();
this.jF.V7(this.lR.name);this.clickInputManager.r2b(this.lR.name,this.ej,this.lR.KVa);x=this.ebf();this.focusManager.Gfb(this.ej,this.lR,x)}focus(){this.isFocused||this.focusManager.mg(this.lR.name)}get isFocused(){return this.focusManager.currentScope===this.lR}addIsFocusChangedHandler(x){this.lR.Q3(()=>x(!0));this.lR.SNa(()=>x(!1))}qph(x){this.lR.u_a(x)}dispose(){var x;this.focusManager.i7a(this.lR.name);this.focusManager.currentScope||this.focusManager.mg(null!==(x=this.NQh)&&void 0!==x?x:e.a.In)}bDb(){var x;
const y=this.focusManager.fe(this.skc);y.parent=null!==(x=this.T0i)&&void 0!==x?x:e.a.Ap;y.KVa=!0;y.Q7c=!0;y.eI=!0;return y}ebf(){const x=new l.DOMFocusListing(()=>this.ej);x.Rm(8);return x}}Object(D.a)(a,"EditorAiFocusScopeImpl",null,[]);c.d(I,"a",function(){return k});class k{constructor(x,y,m,t){this.options=x;this.focusManager=y;this.jF=m;this.clickInputManager=t}registerScope(x){return new a(x,this.focusManager,this.jF,this.clickInputManager,this.options.skc,this.options.T0i,this.options.NQh)}}
Object(D.a)(k,"EditorAiFocusManagerImpl",null,[])},1691:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.handler=null}}Object(D.a)(l,"SetAnnotationResultCallbackParameters",null,[])},1693:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{static get Hhc(){return CommonUIStrings.l_ModernFontPicker_FontInfoPaneTitle}}l.oFb="fontInfoTaskPane";l.experienceId="modernfontpicker";Object(D.a)(l,"FontInfoPaneConstants",null,[])},1694:function(D,I,c){c.d(I,"a",function(){return l});
D=c(0);class l{constructor(){this.endDate=this.startDate=null}}Object(D.a)(l,"CommentTaskSchedule",null,[])},1695:function(D,I,c){c.d(I,"a",function(){return e});D=c(0);var l=c(81);class e{static get fd(){return null!=e.Fyg?e.Fyg:e.Fyg=new l.a}static Nxk(a){e.fd.addHandler(e.FUi,a)}static tyk(a){e.fd.addHandler(e.gXi,a)}}e.FUi="OnCopyComment";e.gXi="OnPasteComment";Object(D.a)(e,"CommentEventsManager",null,[])},1696:function(D,I,c){c.d(I,"a",function(){return l});const l={pkf:"TasksFeatureUsage",
oIo:"TaskExperienceDegraded",Ele:"TaskCreate",Fle:"TaskEngagement"}},1699:function(D,I,c){c.d(I,"c",function(){return x});c.d(I,"b",function(){return y});c.d(I,"a",function(){return m});var l=c(75),e=c(7),a=c(2),k=c(34);const x=t=>{if(!t)return null;let z;try{z=k.b(t)}catch(v){z=null,e.ULS.sendTraceTag(578352835,202,15,"MruActor.TryDeserializeMruV2Response: SecureDeserialize Exception: {0}",v)}return z},y=(t,z)=>{let v=[];if(t.breadcrumbs&&0<t.breadcrumbs.length)v=t.breadcrumbs;else{const H=t.service_info;
H&&H.friendly_service_name&&Array.add(v,H.friendly_service_name);t.display_path&&Array.addRange(v,t.display_path)}return v.join(z?" \u00ab ":" \u200f\u00bb ")},m=(t,z=!1)=>{if(!t)return[];if(!t.documents)return e.ULS.sendTraceTag(578352838,202,15,"missing documents object"),[];if(!t.documents.items)return e.ULS.sendTraceTag(578352839,202,15,"missing items object"),[];t=t.documents.items;const v=new l.a;for(let F=0;F<t.length;F++){const G=t[F];var H=G.web_url;if(!H){e.ULS.sendTraceTag(578320064,202,
15,"Empty web_url");if(!G.url){e.ULS.sendTraceTag(578140248,202,15,"Empty url");continue}H=String.format("{0}?web=1",G.url)}const M={};M.DocumentUrl=H;M.MruId=G.mru_id;{H=G;let K=H.title;K?(H.extension&&(K=String.format("{0}.{1}",K,H.extension)),H=K):(e.ULS.sendTraceTag(578352837,202,15,"empty file title"),H="")}M.FileName=H;M.IsPinned=G.is_pinned;M.Path=y(G,a.AFrameworkApplication.isRtl);z&&(M.App=G.app,M.TimeStamp=G.time_stamp);v.add(M)}return v.toArray()}},1700:function(D,I,c){c.d(I,"a",function(){return k});
D=c(0);var l=c(54),e=c(93),a=c(20);class k{constructor(x,y,m){this.gq=this.kZf=null;this.Zdh=this.xdb=this.Ydh=this.rCa=0;this.Dld=null;this._context=x;this.Ib=y;this.Ca=m;this.m1a=!1;this.Zdd=!0;this.M6n();this.anb=this.K.$("NativeFileOpenDialogIsEnabled")}get context(){return this._context}get K(){return this.Ca}get retryCount(){return this.rCa}get A8n(){return this.Ydh}get t7a(){return this.xdb}get B8n(){return this.Zdh}l6a(x){this.gq=x;if(!this.m1a){if(this.Zdd){if(this.anb&&a.a.TG){this.Dld=
x.nMc(Object(l.a)(this,this.AWf,"onFileChosen"));return}this.Dld=x.nMc(null);if(!this.Lka(this.Dld,x))return}this.uwa(x,null)}}AWf(x){if(this.Lka(x,this.gq)){if(a.a.TG||a.a.Cj)this.Dld=x;this.uwa(this.gq,null)}}ohc(){this.kZf&&this.kZf()}H8n(x){if(!x||this.retryCount>=this.A8n)return!1;this.rCa=this.retryCount+1;const y=new e.a(2,1,this.t7a,()=>{this.l7c(x)},110);this.Ib.Wb(y);this.t7a<this.B8n&&(this.xdb=2*this.t7a);return!0}M6n(){this.rCa=0;this.Ydh=this.K.mc("Box4UploadRetryCount",20);this.xdb=
this.K.mc("Box4UploadRetryDelayStart",200);this.Zdh=this.K.mc("Box4UploadRetryDelayMax",3200);this.gq&&(this.gq.dispose(),this.gq=null)}}Object(D.a)(k,"FileUploader",null,[])},1701:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}l.Callback="action";Object(D.a)(l,"MenuLauncherAsyncTriggerCommandProperties",null,[])},1702:function(D,I,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);Object.defineProperty(a,y,{enumerable:!0,get:function(){return k[x]}})}:function(a,
k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(I,"__esModule",{value:!0});e(c(1856),I);e(c(1857),I);e(c(1858),I);e(c(1859),I);e(c(1860),I);e(c(1861),I)},1703:function(D,I,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var m=Object.getOwnPropertyDescriptor(k,x);if(!m||("get"in m?!k.hz:m.writable||m.configurable))m={enumerable:!0,get:function(){return k[x]}};
Object.defineProperty(a,y,m)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(I,"__esModule",{value:!0});e(c(1862),I);e(c(1863),I)},1704:function(D,I,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var m=Object.getOwnPropertyDescriptor(k,x);if(!m||("get"in m?!k.hz:m.writable||m.configurable))m={enumerable:!0,get:function(){return k[x]}};
Object.defineProperty(a,y,m)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(I,"__esModule",{value:!0});e(c(1864),I);e(c(1865),I)},1706:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.ariaDescription=this.onExecute=this.label=null}}Object(D.a)(l,"CalloutButtonProps",null,[])},1707:function(D,I,c){function l(){a||(e.Health.instance.addQosPillar("AsyncCollab"),
a=!0)}c.d(I,"a",function(){return l});var e=c(86);let a=!1},1708:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e,a=0,k=!1){this.nJj=!1;this.paragraphNode=e;this.ATf=a;this.nJj=k}}Object(D.a)(l,"ReviewActionArgs",null,[])},1712:function(D,I,c){c.d(I,"a",function(){return l});c.d(I,"b",function(){return e});D=c(0);class l{constructor(k,x,y,m,t,z,v){this.ccpId=k;this.pKey=x;this.type=y;this.count=m;this.dc=t;this.client=z;this.version=v}}Object(D.a)(l,"ClipServiceArgs",null,
[]);var e;(e||(e={})).Chart="chart";Object(D.b)("ClipServiceDataType",e);var a;(a||(a={})).ExcelOnline="XLO";Object(D.b)("ClipServiceClientApp",a)},1713:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e=0,a=0,k=0,x=0,y="",m="",t="",z="",v="0pt",H="0pt",F="0pt",G="0pt"){this.borderTopStyle=e;this.borderRightStyle=a;this.borderBottomStyle=k;this.borderLeftStyle=x;this.borderTopColor=y;this.borderRightColor=m;this.borderBottomColor=t;this.borderLeftColor=z;this.borderTopWidth=
v;this.borderRightWidth=H;this.borderBottomWidth=F;this.borderLeftWidth=G}}Object(D.a)(l,"TableCellBorderProperties",null,[])},1714:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e="",a="",k="",x=""){this.DUk=e;this.CUk=a;this.AUk=k;this.BUk=x}}Object(D.a)(l,"TableCellMarginProperties",null,[])},1718:function(D,I,c){c.d(I,"a",function(){return k});D=c(0);var l=c(43);c(6);var e=c(7),a=c(1481);class k{constructor(x,y){this.Q7m=()=>{e.ULS.sendTraceTag(39358976,324,50,"ForceSave request was successful in AutoSaveParamsUpdateService.")};
this.eya=(m,t)=>{e.ULS.sendTraceTag(39358977,324,10,"ForceSave request failed in AutoSaveParamsUpdateService with status code {0}.",t)};this.gvb=y}Njj(x,y,m,t=null,z=null,v=null){if(x){var H=new l.GraphTransaction(0);H.Db(x);x.setValue(y,m);H.dispose();try{this.gvb(a.a.autoSaveParams,!1,t||this.Q7m,z||this.eya,v,null,null)}catch(F){e.ULS.sendTraceTag(39358947,324,10,"Error calling ForceSave in TableOfContentsActor.SendSaveRequest. Message: {0}",F.message)}}else e.ULS.sendTraceTag(39358946,324,10,
"AutoSaveParametersNode is null in AutoSaveParamsUpdateService.")}}Object(D.a)(k,"AutoSaveParamsUpdateService",null,[641])},1719:function(D,I,c){c.d(I,"a",function(){return e});D=c(0);var l=c(7);class e{constructor(a){this.Ezj=a}ie(a,k){if(a){var x=this.Ezj();a();a=this.Ezj();l.ULS.sendTraceTag(555307094,345,50,`${k}-${a-x}`)}else l.ULS.shipAssertTag(520127454,345,!1)}}Object(D.a)(e,"PerfLogger",null,[435])},1720:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e,a){this.paragraphNode=
e;this.state=a}}Object(D.a)(l,"ReviewCompletedArgs",null,[])},1721:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e,a){this.index=e;this.count=a}}Object(D.a)(l,"DesignerReviewPosition",null,[])},1722:function(D,I,c){c.d(I,"a",function(){return e});D=c(0);var l;(function(a){a[a.empty=0]="empty";a[a.filled=1]="filled"})(l||(l={}));Object(D.b)("BlueDotHighlightContextType",l);class e{constructor(a,k,x=WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionTooltipClick,y=l.empty){this.ps=
a;this.sHc=k;this.XLo=x;this.kLk=y}}Object(D.a)(e,"BlueDotHighlightContext",null,[])},1723:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.tv=this.Ko=this.marginRight=this.marginLeft=this.marginBottom=this.marginTop=0;this.Jxa=!1;this.gNb=this.xLb=5;this.una=this.aF=this.jJc=0;this.a1k=!1}}Object(D.a)(l,"SectionPropertiesData",null,[])},1724:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(195);class l extends c.a{constructor(){super();this.OnRetryCommandId=
this.RetryButtonTitle=this.AriaDescription=this.IconName=this.Label=null}get ControlType(){return 12}}Object(D.a)(l,"ErrorViewProps",c.a,[])},1725:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(195);class l extends c.a{constructor(){super();this.CommandValueId=this.ActionCommandValueId=this.ActionText=this.ActionIdMapped=this.ActionId=this.Details=this.Links=this.Description=this.SecondaryLabel=this.Label=this.iconSet=this.ActionCommandId=this.CommandIdMapped=this.CommandId=null}get ControlType(){return 13}}
Object(D.a)(l,"MultiActionButtonProps",c.a,[])},1726:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}Object(D.a)(l,"PersonaInfo",null,[])},1727:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}Object(D.a)(l,"PersonaIdentifiers",null,[])},1728:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);I=c(1155);c=c(1088);class l{}l.u1=[new I.a(1440,1440,1440,1440),new I.a(720,720,720,720),new I.a(1440,1440,1080,1080),new I.a(1440,1440,2880,2880),new I.a(1440,1440,1800,1800)];
l.Qqa=[new c.a(12240,15840),new c.a(12240,20160),new c.a(10440,15120),new c.a(11907,16839),new c.a(8391,11907)];Object(D.a)(l,"PredefinedPageProperties",null,[])},1730:function(D,I,c){c.d(I,"a",function(){return F});D=c(0);var l=c(205),e=c(2),a=c(22),k=c(20),x=c(18),y=c(1343),m=c(257),t=c(441),z=c(7),v=c(457),H=c(689);class F{constructor(G,M,K,L,R,S,N,O,W,V,Q,Y,ba,Z){this.rr=G;this.Pvb=M;this.Ca=K;this.Op=L;this.Qr=R;this.vE=S;this.pba=N;this.nab=O;this.jab=W;this.lab=V;this.mab=Q;this.kbb=Y;this.lbb=
ba;this.Qpd=Z}build(G,M,K,L){const R=new l.QueryStringBuilder("WordOart.ashx");e.AFrameworkApplication.nga(R);R.Be(v.a.nodeId,M.id.toString());M=x.ImageReader.m$l(M,G.Mc);R.Be(H.a.pKd,M?M.ja(t.a.JUf,""):"");R.Be(H.a.width,this.Op.toString());R.Be(H.a.height,this.Qr.toString());R.Be(H.a.U3c,this.pba.toString());R.Be(H.a.J3n,y.a[this.Pvb]);M=this.Ca.$("WordEditorImageCropIsEnabled");R.Be(H.a.OOh,M.toString());M&&(R.Be(H.a.top,this.nab.toString()),R.Be(H.a.bottom,this.jab.toString()),R.Be(H.a.left,this.lab.toString()),
R.Be(H.a.right,this.mab.toString()));M=this.Ca.$("WordEditorImageRotateIsEnabled");R.Be(H.a.ogj,M.toString());M&&(R.Be(H.a.angle,this.vE.toString()),R.Be(H.a.flipH,this.kbb?"true":"false"),R.Be(H.a.flipV,this.lbb?"true":"false"));R.Be(H.a.l1f,K?"true":"false");R.Be(H.a.strict,this.Qpd?"true":"false");this.Ca.$("WacWordEditorRenderHighContrastGraphicsIsEnabled")&&this.rr&&this.rr.Lzf&&R.Be(H.a.x3a,this.rr.Lzf);(G=G.Yi())?(R.Be(v.a.fileId,G.zr),R.Be(v.a.cellId,G.Gm.toString())):z.ULS.sendTraceTag(575522528,
322,10,"parentGraphSpace is null. Cannot set FileId and CellId. url: {0}",R.toString());G=a.a.instance.Oa("Box4.IFeatureHelper");G=!!G&&G.isFeatureEnabled(50);R.Be(H.a.etl,"true");R.Be(H.a.ICm,G.toString());R.Be(H.a.rWh,"true");G&&R.Be(H.a.u2i,G.toString());R.Be(H.a.LCm,"true");m.a.instance.TAb(R);K&&L&&!k.a.gt&&R.bJ(H.a.agb,window.self.devicePixelRatio.toString());R.Be(H.a.axh,"true");return R.toString()}}Object(D.a)(F,"WordOartEndpointUrlBuilder",null,[])},1731:function(D,I,c){c.d(I,"a",function(){return e});
D=c(0);var l=c(16);class e{constructor(a,k){this._id=a;this.Gb=k;this.FQk=k.ja(l.a.Hia,0);this.DQk=k.ja(l.a.Gia,0)}getId(){return this._id}}Object(D.a)(e,"GraphicsEditorImageContainer",null,[362])},1732:function(D,I,c){c.d(I,"a",function(){return N});D=c(0);var l=c(60),e=c(2),a=c(126),k=c(205),x=c(18),y=c(521),m=c(735),t=c(6),z=c(174),v=c(46),H=c(16),F=c(41),G=c(441),M=c(119),K=c(1009),L=c(7),R=c(689),S=c(1730);class N{constructor(O,W,V,Q,Y,ba){this.properties=null;this.rr=W;this.Vj=Q;this.Ca=Y;this.lA=
ba}IWo(O,W,V){O.nP||(W.setValue(t.a.sGc,O.pCk),W.setValue(t.a.QNd,O.m8b));this.jMj(O,W,V)}JWo(O,W,V){W.setValue(t.a.yNb,O.f0o);x.ImageReader.kTd(W,V.Mc,!1)!==O.JZf&&W.Cg(t.a.P$d,z.a.ft,z.a.Cqa,v.a.K9a);if(O.C9d)W.setValue(H.a.Sda,l.a.If(O.C9d));else{var Q=this.jMh(O.JZf,O.KZf,O.extension);V.Mc.Uu(Q);W.setValue(H.a.Sda,Q.id)}O.Kpe?W.setValue(v.a.K9a,l.a.If(O.Kpe)):O.QKj&&(Q=this.jMh(O.QKj,O.jsg,O.extension),V.Mc.Uu(Q),W.setValue(v.a.K9a,Q.id));W.ja(t.a.Q$d,"")!==O.y6c&&(""!==O.y6c?W.setValue(t.a.Q$d,
O.y6c):W.removeProperty(t.a.Q$d));0===O.Iva&&0===O.Kva&&0===O.Jva&&0===O.Hva||this.Vj.Kdg(W,O.Kva,O.Hva,O.Iva,O.Jva);void 0!==O.lockAspectRatio?W.setValue(t.a.tY,O.lockAspectRatio):W.setValue(t.a.tY,!1);O.PLk&&(this.tQb(W,t.a.sja,O.ryh),this.tQb(W,t.a.Mqa,O.borderStyle),this.tQb(W,t.a.UHa,O.borderColor));void 0!==O.altTextDescription&&W.setValue(t.a.sY,O.altTextDescription);this.tQb(W,F.a.alphaModFix,O.alphaModFix);this.jMj(O,W,V);O=y.a.instance.qjf(W);W.setValue(t.a.Tda,O)}jMh(O,W,V){const Q=new K.a(524345);
Q.setValue(G.a.JUf,O);Q.setValue(G.a.vhc,O);Q.setValue(v.a.sCl,l.a.If(O).guid);Q.setValue(t.a.rqi,W);Q.setValue(G.a.Dkf,e.AFrameworkApplication.rootQuerySignature);Q.setValue(v.a.y_h,V);return Q}jMj(O,W,V){O.nP?(this.properties=W,W.setValue(F.a.nP,O.nP),O.rGc&&W.setValue(F.a.TCd,O.rGc),W.setValue(F.a.Zwa,O.I4o),W.setValue(F.a.$wa,O.jum),W.setValue(F.a.xQa,O.B7b),W.setValue(t.a.Qs,O.Qs),W.setValue(t.a.qhb,O.q7b),W.setValue(v.a.B0,0),this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",
!1)&&W.setValue(M.a.IPa,!1),W.setValue(M.a.G5,0),this.tQb(W,F.a.k4a,O.Xxa),this.Eoh(W,V,!1,!0),this.MXk(W)):(W.setValue(t.a.$Fa,O.$Fa),W.setValue(z.a.ft,O.$Fa?O.ODn:""),O.agb&&W.setValue(z.a.kIb,O.agb),W.setValue(t.a.Qs,O.Qs),W.setValue(t.a.qhb,O.q7b),W.setValue(t.a.Tda,O.RH),W.setValue(H.a.Hia,a.a.DG(O.width)),W.setValue(H.a.Gia,a.a.DG(O.height)),W.setValue(v.a.X0f,a.a.DG(O.width)),W.setValue(v.a.V0f,a.a.DG(O.height)),W.setValue(z.a.YFa,-1),W.setValue(z.a.XFa,-1),W.setValue(H.a.Lxa,!0),W.setValue(t.a.JU,
O.rotationAngle),this.Ca&&this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.DontUseUploadStateWithDrawingCanvas",!1)&&W.setValue(M.a.IPa,!1),W.setValue(v.a.B0,0),O.$Fa&&this.Eoh(W,V,!0,!1),this.NXk(W));5!=x.ImageReader.ui(W)?this.PXk(W):this.LXk(W);this.tQb(W,t.a.Uyf,O.flipH);this.tQb(W,t.a.qzf,O.flipV)}p4n(O,W,V,Q,Y=null){O=this.Vj.k4n(O.ik,W,V,Q);null==O?L.ULS.sendTraceTag(561538391,3001,10,"Failed to replace picture properties"):Y&&Y(O)}Eoh(O,W,V,Q){let Y=!1;var ba=this.lA.su(W);ba&&ba.wf(t.a.iIf)&&
(Y=!0);ba=x.ImageReader.yca(O);const Z=x.ImageReader.Goa(O);W=(new S.a(this.rr,x.ImageReader.ui(O),this.Ca,x.ImageReader.oF(O),x.ImageReader.JG(O),x.ImageReader.o0(O),x.ImageReader.vjb(O),Math.max(ba.top,0),Math.max(ba.bottom,0),Math.max(ba.left,0),Math.max(ba.right,0),Z.nib,Z.bFa,Y)).build(W,O,!0,!1);Q&&(Q=new k.QueryStringBuilder(W),Q.Be(R.a.qXd,"true"),W=Q.toString());O.setValue(t.a.shb,W);V&&m.a.uQb(O,1,e.AFrameworkApplication.K,this.rr)}tQb(O,W,V){void 0===V||null===V?O.removeProperty(W):O.setValue(W,
V)}NXk(O){O.removeProperty(F.a.nP);O.removeProperty(F.a.TCd);O.removeProperty(F.a.Zwa);O.removeProperty(F.a.$wa);O.removeProperty(F.a.xQa);O.removeProperty(F.a.w6d);O.removeProperty(F.a.Grl);O.removeProperty(F.a.k4a)}PXk(O){O.removeProperty(t.a.P$d);O.removeProperty(t.a.yNb);O.removeProperty(H.a.Sda);O.removeProperty(t.a.Q$d)}LXk(O){O.removeProperty(t.a.QNd);O.removeProperty(t.a.sGc);O.removeProperty(F.a.nP);O.removeProperty(F.a.TCd)}MXk(O){O.removeProperty(t.a.sGc);O.removeProperty(z.a.ft);O.removeProperty(H.a.Hia);
O.removeProperty(H.a.Gia);O.removeProperty(t.a.Tda);O.removeProperty(z.a.Cqa);O.removeProperty(t.a.QNd);O.removeProperty(t.a.JU)}}Object(D.a)(N,"GraphicsEditorImageEditor",null,[346])},1733:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}Object(D.a)(l,"SmartLookupApplicationInterface",null,[])},1734:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e,a,k,x,y,m){this.lastModified=this.size=this.uniqueId=this.spWebUrl=this.url=this.fileType=null;this.fileType=
e;this.url=a;this.spWebUrl=k;this.uniqueId=x;this.size=y;this.lastModified=m}}Object(D.a)(l,"FileInfo",null,[])},1761:function(D,I,c){c.d(I,"a",function(){return e});D=c(0);var l=c(7);c=c(259);class e extends c.a{constructor(a,k,x,y){super(e.r4e);this.Jl=a;this.ij=k;this.view=x;this.options=y}initialize(){super.initialize();const a=this.options.MPb==this.ij.Eba(this.view.ed,{sP:this.options.sP,Uca:this.options.wbc,hpa:this.options.vbc,rP:this.options.rP});a&&!this.Bia&&l.ULS.sendTraceTag(557114691,
3028,50,this.GO(this.Jl,!0,`satisfiedIfBlank=${this.options.MPb}`));this.pg(a)}Od(){super.Od()}}e.r4e="BlankDocumentConditionId";Object(D.a)(e,"BlankDocumentCondition",c.a,[])},1765:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e){this.alt=this.ariaLabel=this.src=null;this.src=e}}Object(D.a)(l,"ImageProps",null,[])},1767:function(D,I,c){c.d(I,"a",function(){return v});D=c(0);var l=c(60),e=c(8),a=c(12),k=c(7),x=c(15),y=c(1560),m=c(1546),t=c(1555),z=c(1549);class v{constructor(H,
F,G,M,K,L,R){this.RUi=(S,N)=>{N&&N.data&&N.data.ul&&(S=new z.a(N.data.ul,1,!0),this.Kye.EN(S))};this.XXi=(S,N)=>{N&&N.data&&N.data.ul&&N.data.ul.node&&this.N0j.SQi(this.Kye,N.data.ul.node)};this.Wjc=(S,N,O)=>{S=N.view.ue?N.view:null;if(!S||!S.mb)return 8;S=S.mb.ib.J(0).Pa;return e.ParagraphReader.Xb(S.node)?1===O?32:2===O?(O=new z.a(S,2,!1),this.Kye.EN(O),32):2:2};this.a6b=(S,N,O)=>{var W,V;S=N.view.ue?N.view:null;if(!S||!S.mb)return 8;S=null===(W=S.mb.ib.J(0))||void 0===W?void 0:W.Pa;return S&&S.node?
e.ParagraphReader.Xb(S.node)?1===O?32:2===O?(O=S.node,W=e.ParagraphReader.text(S.node),N=S.cpBegin,S=S.cpEnd-N,0<S&&(W=W.substr(N,S)),S=Math.floor(Math.random()*v.Zgj),N=l.a.create(),k.ULS.sendTraceTag(541446531,3016,50,"Create Pull Quote invoked from context menu. PullQuote info: {0}; Document info: {1}",{["suggestionId"]:N,["textLength"]:W.length,["paragraphLength"]:e.ParagraphReader.textLength(O),["paragraphRole"]:null===(V=this.I7.GA(O))||void 0===V?void 0:V.role,["styleId"]:S},this.Fak.oSd()),
V=[new y.c(new m.d(N,3,null,null,!1,S,W),O,S,W,Q=>{this.kWb.Q5c(t.a.create(Q));this.kWb.Yic({role:27,paragraphNode:Q,placeholder:!1})},3)],this.pgk.vDd(V),32):2:2:8};this.ga=H;this.Kye=F;this.N0j=G;this.kWb=M;this.pgk=K;this.I7=L;this.Fak=R}initialize(){this.ga.fb(x.a.Wjc,a.a.view,this.Wjc,1028);this.kWb.Oyk(this.XXi);this.kWb.Jxk(this.RUi);this.ga.fb(x.a.a6b,a.a.view,this.a6b,4)}dispose(){this.ga.Wv(x.a.a6b,a.a.view,this.a6b);this.kWb.G1n(this.RUi);this.kWb.c2n(this.XXi);this.ga.Wv(x.a.Wjc,a.a.view,
this.Wjc)}}v.Zgj=5;Object(D.a)(v,"DesignerActionListener",null,[1035,9])},1769:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}l.seen="Seen";l.kept="Kept";l.rejected="Rejected";Object(D.a)(l,"CritiqueAction",null,[])},1778:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.aRj="PageContentOrigin";this.NOj=500;this.$vg=["resize"];this.lKo=e=>()=>{!this.Nmd&&e&&(this.Nmd=setTimeout(()=>this.ZEh(),this.NOj),e())}}addHandler(e){this.XOb();this.PLa=this.lKo(e);
this.twn(this.PLa);this.$vg.forEach(a=>{window.addEventListener(a,this.PLa)})}XOb(){var e;this.ZEh();null===(e=this.Rmh)||void 0===e?void 0:e.disconnect();this.$vg.forEach(a=>{window.removeEventListener(a,this.PLa)});this.PLa=void 0}ZEh(){this.Nmd&&(clearTimeout(this.Nmd),this.Nmd=void 0)}twn(e){this.Rmh=new MutationObserver(e);(e=document.getElementsByClassName(this.aRj)[0])&&this.Rmh.observe(e,{attributes:!0,attributeFilter:["style"]})}}Object(D.a)(l,"EditorAiWindowEventManager",null,[])},1779:function(D,
I,c){c.d(I,"a",function(){return a});D=c(0);var l=c(38),e=c(11);class a{constructor(k){var x,y;this.Nl=k;this.kS=null;this.kS=null===(y=null===(x=this.Nl)||void 0===x?void 0:x.yd)||void 0===y?void 0:y.container}addHandler(k){this.kS&&(this.XOb(),this.PLa=k,l.a.addHandler(this.kS,e.a.scroll,this.PLa),l.a.addHandler(this.kS,e.a.resize,this.PLa))}XOb(){this.kS&&this.PLa&&(l.a.removeHandler(this.kS,e.a.scroll,this.PLa),l.a.removeHandler(this.kS,e.a.resize,this.PLa))}}Object(D.a)(a,"EditorAiPositionManager",
null,[])},1780:function(D,I,c){var l=this&&this.aB||(Object.create?function(a,k,x,y){void 0===y&&(y=x);var m=Object.getOwnPropertyDescriptor(k,x);if(!m||("get"in m?!k.hz:m.writable||m.configurable))m={enumerable:!0,get:function(){return k[x]}};Object.defineProperty(a,y,m)}:function(a,k,x,y){void 0===y&&(y=x);a[y]=k[x]}),e=this&&this.__exportStar||function(a,k){for(var x in a)"default"===x||Object.prototype.hasOwnProperty.call(k,x)||l(k,a,x)};Object.defineProperty(I,"__esModule",{value:!0});e(c(1971),
I);e(c(1972),I);e(c(1973),I);e(c(1974),I);e(c(1975),I);e(c(1976),I)},1782:function(D){var I="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(I){var c=new Uint8Array(16);D.exports=function(){I(c);return c}}else{var l=Array(16);D.exports=function(){for(var e=0,a;16>e;e++)0===(e&3)&&(a=4294967296*Math.random()),l[e]=a>>>((e&3)<<3)&255;return l}}},
1783:function(D){for(var I=[],c=0;256>c;++c)I[c]=(c+256).toString(16).substr(1);D.exports=function(l,e){e=e||0;return[I[l[e++]],I[l[e++]],I[l[e++]],I[l[e++]],"-",I[l[e++]],I[l[e++]],"-",I[l[e++]],I[l[e++]],"-",I[l[e++]],I[l[e++]],"-",I[l[e++]],I[l[e++]],I[l[e++]],I[l[e++]],I[l[e++]],I[l[e++]]].join("")}},1784:function(D,I,c){c.d(I,"a",function(){return l});const l={Uzj(e){return"function"===typeof e?{execute:e}:e}}},1786:function(D,I,c){var l=c(0),e=c(1844),a=c(367),k=c(611),x=c(60),y=c(22),m=c(2062),
t=c(2),z=c(109),v=c(93),H=c(1637),F=c(188);class G{constructor(fc,Fc){this.CommentId=fc;this.ResolveState=Fc}}Object(l.a)(G,"CommentProperties",null,[]);var M=c(585),K=c(2065),L=c(2066),R=c(1678),S=c(2064),N=c(194),O=c(1842);class W extends O.a{constructor(fc,Fc="",id="",ld="",hd=!1){super(fc,Fc,id,ld,hd);this.DateUtc=null}}Object(l.a)(W,"CommentReactionUser",O.a,[]);var V;(function(fc){fc[fc.like=1]="like"})(V||(V={}));Object(l.b)("ReactionType",V);var Q;(function(fc){fc[fc.first=0]="first";fc[fc.done=
0]="done";fc[fc.undone=1]="undone";fc[fc.addComment=2]="addComment";fc[fc.deleteComment=3]="deleteComment";fc[fc.editComment=4]="editComment";fc[fc.addReaction=5]="addReaction";fc[fc.removeReaction=6]="removeReaction";fc[fc.last=7]="last"})(Q||(Q={}));Object(l.b)("CommentChangeType",Q);var Y=c(243),ba=c(1470),Z=c(249);class ea{constructor(){this.$fh=this.pih=!1;this.mnk=[]}get eoc(){return this.mnk}get BRb(){return this.pih}set BRb(fc){this.pih=fc;for(const Fc of this.eoc)Fc.BRb=fc}get pQb(){return this.$fh}set pQb(fc){this.$fh=
fc;for(const Fc of this.eoc)Fc.pQb=fc}a9a(fc){for(const Fc of this.eoc)fc=Fc.a9a(fc);return fc}}Object(l.a)(ea,"AggregateCommentTaskPersonTransformer",null,[928]);var ha=c(7),ka=c(139),ua=c(1634);class sa{constructor(fc,Fc){this.B$j=new Z.a(()=>Fc.a9a(fc.value))}fVl(){return new Date}L0a(fc,Fc,id){if(0===fc)throw ha.ULS.sendTraceTag(594650201,327,10,"CreateBlankHistoryRecord: we do not expect user to be able to create a record of type Unknown in the browser."),Error.argument("recordType");const ld=
ka.a.create().toString();id=new ua.a(fc,this.B$j.value,id,ld,!1);id.commentId=Fc;ha.ULS.sendTraceTag(42796192,327,50,"History Record Generated. [RecordType: {0}]",fc);return id}}Object(l.a)(sa,"HistoryRecordFactory",null,[929]);var Da=c(1694);class Pa{constructor(fc,Fc,id,ld,hd,Be){this.isLossy=fc;this.title=Fc;this.assignees=id;this.schedule=ld;this.completion=hd;this.priority=Be}}Object(l.a)(Pa,"CommentTaskState",null,[]);class Ra{constructor(){this.commentId=null}}Object(l.a)(Ra,"HistoryItem",
null,[]);class Ga{constructor(fc,Fc,id,ld,hd,Be,Ke){this.PFe=!1;if(1!==Fc.type)throw Error.argument("createRecord");this.Mtc=id;this.Itc=ld;this.Jtc=hd;this.v8g=1;this.Dnd=fc;this.Dbk=Be;this._state=new Pa(!1,this.Mtc,Ke,new Da.a,this.Jtc,this.Itc);this._history=[];this.dNh(Fc)}d6b(fc,Fc){if(1!==fc.type)throw Error.argument("createRecordTemplate");const id=Ga.ogm(fc,this.v8g);this.v8g++;return Object.assign(new ua.a(Fc,fc.user,fc.time,id),{commentId:fc.commentId})}get RFi(){return this.history[this.history.length-
1]}get sni(){return this.state.completion===this.Jtc}get rni(){return this.state.priority===this.Itc}get tni(){return(void 0===this.state.schedule.startDate||null===this.state.schedule.startDate)&&(void 0===this.state.schedule.endDate||null===this.state.schedule.endDate)}get uni(){return this.state.title===this.Mtc}dNh(fc){fc=Object.assign(new Ra,{commentId:fc.commentId,records:[fc]});this.history.push(fc)}z5h(fc){let Fc=-1;for(let id=0;id<this.state.assignees.length;id++)if(this.Dnd.equals(this.state.assignees[id],
fc)){Fc=id;break}return Fc}rro(fc){const Fc=this.RFi,id=Fc.records[Fc.records.length-1];return this.Dnd.equals(id.user,fc.user)&&Fc.commentId===fc.commentId&&id.time.getTime()===fc.time.getTime()?!0:!1}Y_o(fc){switch(fc.type){case 2:-1===this.z5h(fc.assignee)&&this.state.assignees.push(fc.assignee);break;case 3:const Fc=this.z5h(fc.assignee);0<=Fc&&this.state.assignees.splice(Fc,1);break;case 4:Array.clear(this.state.assignees);break;case 5:this.state.schedule=fc.schedule;break;case 6:this.state.completion=
fc.completion;break;case 9:this.state.title=fc.title;break;case 10:this.state.priority=fc.priority;break;case 0:this.state.isLossy=!0;break;case 1:ha.ULS.sendTraceTag(595198540,327,10,"Create record passed for state evaluation");break;case 7:this.PFe=!0;break;case 8:this.PFe=!1;break;case -1:ha.ULS.sendTraceTag(51139905,327,10,"Undo record passed for state evaluation");break;default:this.state.isLossy=!0}fc.isLossy&&(this.state.isLossy=!0);this.rro(fc)?this.RFi.records.push(fc):this.dNh(fc)}get isDeleted(){return this.PFe}get state(){return this._state}get history(){return this._history}Z_l(fc){if(!fc)return this.history;
const Fc=Array.clone(this.history),id=Fc[0],ld=id.records.shift();if(!this.Dbk){var hd=this.d6b(ld,4);id.records.unshift(hd)}!fc.sni&&this.sni&&(hd=this.d6b(ld,6),hd.completion=this.Jtc,id.records.unshift(hd));!fc.rni&&this.rni&&(hd=this.d6b(ld,10),hd.priority=this.Itc,id.records.unshift(hd));!fc.tni&&this.tni&&(hd=this.d6b(ld,5),hd.schedule=new Da.a,id.records.unshift(hd));!fc.uni&&this.uni&&(hd=this.d6b(ld,9),hd.title=this.Mtc,id.records.unshift(hd));fc.isDeleted&&(fc=this.d6b(ld,8),id.records.unshift(fc));
return Fc}static ogm(fc,Fc){return"Synthesized-"+fc.recordId+"-"+Fc}}Object(l.a)(Ga,"CommentTaskStateBuilder",null,[]);class ta{constructor(fc,Fc,id,ld){this.id=fc;this.commentId=Fc;this.currentState=id;this.history=ld}}Object(l.a)(ta,"CommentTaskItem",null,[]);var va=c(1633);const ia=fc=>{const Fc=new va.a(fc.UserId,fc.Provider,fc.DisplayName,fc.Email);Fc.IsCurrentUser=fc.IsCurrentUser;return Fc};var qa=c(1839);class pa{static clone(fc){fc=pa.x_k(fc.extensions);return new qa.a(fc)}static PFh(fc){return fc?
pa.clone(fc):null}static isEmpty(fc){return!fc.extensions||!fc.extensions.count}static af(fc){return!fc||pa.isEmpty(fc)}static x_k(fc){if(!fc)return null;const Fc=new a.a;fc.forEach((id,ld)=>{Fc.add(id,ld);return!0});return Fc}}Object(l.a)(pa,"ExtensionListExtensions",null,[]);class Fa{static clone(fc){var Fc=ia(fc.user);Fc=new ua.a(fc.type,Fc,fc.time,fc.recordId,fc.isLossy);Fc.commentId=fc.commentId;Fc.anchorExtensionList=pa.PFh(fc.anchorExtensionList);Fc.recordExtensionList=pa.PFh(fc.recordExtensionList);
fc.assignee&&(Fc.assignee=ia(fc.assignee));if(fc.schedule){var id=fc.schedule;const ld=new Da.a;ld.startDate=id.startDate;ld.endDate=id.endDate;Fc.schedule=ld}Fc.completion=fc.completion;Fc.title=fc.title;Fc.priority=fc.priority;Fc.undoId=fc.undoId;return Fc}}Object(l.a)(Fa,"HistoryRecordExtensions",null,[]);class za{constructor(fc,Fc,id,ld,hd,Be,Ke,Me=!1){this.Dnd=fc;this.$td=Fc;this.fNa=id;this.t_j=ld;this.Mtc=hd;this.Itc=Be;this.Jtc=Ke;this.qpd=Me}tfl(fc,Fc,id,ld=null){if(!fc)throw ha.ULS.sendTraceTag(42796181,
327,10,"taskId cannot be null."),Error.argumentNull("taskId");if(!Fc)throw ha.ULS.sendTraceTag(42796182,327,10,"parentCommentId cannot be null."),Error.argumentNull("parentCommentId");if(!id||!id.length)throw ha.ULS.sendTraceTag(42796183,327,10,"records cannot be null or empty."),Error.argumentNull("records");if(1!==id[0].type)throw ha.ULS.sendTraceTag(42796184,327,10,"First record must be a Create record."),Error.argument("First record must be a Create record.");var hd=[],Be=null,Ke=this.dKn(id);
for(var Me of id)if(!Ke.contains(Me.recordId))if(id=this.Rji(Me.commentId,ld),id=this.JLl(Me,id),1===id.type){let kg=[];this.qpd&&Be&&Be.state&&(kg=Be.state.assignees);Be=new Ga(this.Dnd,id,this.Mtc,this.Itc,this.Jtc,this.qpd,kg);hd.push(Be)}else if(Be)Be.Y_o(id);else throw ha.ULS.sendTraceTag(595198539,327,10,"Undo resulted in ignoring of Task creation without also ignoring records after the create record."),Error.argument("Undo resulted in ignoring of Task creation without also ignoring records after the create record.");
Ke=null;Me=[];if(Be){Be.isDeleted||(Ke=Be.state);Be=null;for(var jf of hd)hd=jf.Z_l(Be),Array.addRange(Me,hd),Be=jf}jf=this.Rji(Fc,ld);Ke&&(Ke.completion=this.L3k(Fc,ld,Ke.completion));return new ta(fc,jf,Ke,Me)}e4h(fc,Fc,id,ld=null){if(!Fc)throw ha.ULS.sendTraceTag(42796185,327,10,"update cannot be null."),Error.argumentNull("update");if(id&&!fc)throw ha.ULS.sendTraceTag(42796187,327,10,"CommentId must be specified for task creation."),Error.argument("commentId");const hd=[],Be=this.fNa.fVl();if(id){var Ke=
this.fNa.L0a(1,fc,Be);hd.push(Ke)}Ke=null;if(Fc.assigneeUpdate){if(!Fc.assigneeUpdate.assigneesToAdd||!Fc.assigneeUpdate.assigneesToRemove)throw ha.ULS.sendTraceTag(536999254,327,15,"Invalid AssigneeUpdate."),Error.argument("Schedule","Invalid AssigneeUpdate.");for(var Me=0;Me<Fc.assigneeUpdate.assigneesToAdd.length;Me++){var jf=this.eNh(2,Fc.assigneeUpdate.assigneesToAdd[Me],fc,Be);jf&&hd.push(jf)}for(Me=0;Me<Fc.assigneeUpdate.assigneesToRemove.length;Me++)(jf=this.eNh(3,Fc.assigneeUpdate.assigneesToRemove[Me],
fc,Be))&&hd.push(jf)}else Fc.assignee&&(id||(Ke=this.fNa.L0a(4,fc,Be),hd.push(Ke)),Me=this.fNa.L0a(2,fc,Be),Ke=this.$td.a9a(Fc.assignee),Me.assignee=Ke,hd.push(Me));Fc.title?(ld=this.fNa.L0a(9,fc,Be),ld.title=Fc.title,hd.push(ld)):id&&ld&&(Me=this.fNa.L0a(9,fc,Be),Me.title=this.t_j.ejm(ld,Ke),hd.push(Me));if(Fc.schedule){if(Fc.schedule.startDate>Fc.schedule.endDate)throw ha.ULS.sendTraceTag(42796188,327,10,"Invalid schedule."),Error.argument("Schedule","Invalid schedule.");ld=this.fNa.L0a(5,fc,Be);
ld.schedule=Fc.schedule;hd.push(ld)}if(void 0!==Fc.completion&&null!==Fc.completion){ld=Fc.completion;if(0>ld||100<ld)throw ha.ULS.sendTraceTag(42796189,327,10,"Invalid completion state."),Error.argumentOutOfRange("completion");id||ha.ULS.sendTraceTag(595198538,327,50,"Task progress change. [Progress: {0}]",ld);id=this.fNa.L0a(6,fc,Be);id.completion=ld;hd.push(id)}if(void 0!==Fc.priority&&null!==Fc.priority){Fc=Fc.priority;if(0>Fc||10<Fc)throw ha.ULS.sendTraceTag(42796190,327,10,"Invalid priority state."),
Error.argumentOutOfRange("priority");fc=this.fNa.L0a(10,fc,Be);fc.priority=Fc;hd.push(fc)}return hd}eNh(fc,Fc,id,ld){if(2!==fc&&3!==fc)return ha.ULS.sendTraceTag(0,327,10,"Assignee field should only be used for an Assign or Unassign HistoryRecord."),null;fc=this.fNa.L0a(fc,id,ld);fc.assignee=this.$td.a9a(Fc);return fc}dKn(fc){const Fc=new k.a,id=new k.a;for(let ld=fc.length-1;0<=ld;ld--){const hd=fc[ld],Be=id.contains(hd.recordId);Be||-1!==hd.type||(id.contains(hd.undoId)?ha.ULS.sendTraceTag(578670598,
327,50,"Multiple Undo records attempting to undo the same record."):id.add(hd.undoId));if(Be||-1===hd.type)Fc.contains(hd.recordId)?ha.ULS.sendTraceTag(578670599,327,50,"Record was already added to records to ignore. There must be multiple records with same ID."):Fc.add(hd.recordId)}return Fc}JLl(fc,Fc){const id=Fa.clone(fc);id.commentId=Fc;id.user=this.$td.a9a(fc.user);id.assignee=this.$td.a9a(fc.assignee);return id}L3k(fc,Fc,id){let ld=id;fc&&Fc&&(({value:Fc}=Fc.Fc(fc)).returnValue?(ld=Fc.ResolveState?
100:100===id?0:id,ld!==id&&ha.ULS.sendTraceTag(592719873,327,50,"Task completion state has been changed to match comment resolution state for comment {0}",fc)):ha.ULS.sendTraceTag(592719874,327,50,"Comment {0} not found in translation map. Completion unchanged",fc));return ld}Rji(fc,Fc){let id=fc;fc&&Fc&&(({value:Fc}=Fc.Fc(fc)).returnValue?id=Fc.CommentId:(ha.ULS.sendTraceTag(42796191,327,50,"Id not found in translation map. Possible Orphan task candidate [CommentId: {0}]",fc),id=fc));return id}}
Object(l.a)(za,"CommentTaskTranslatorImpl",null,[930]);var Oa=c(1059),xa=c(1234);class fa{constructor(){this.yhb=CommonUIStrings.l_Ellipsis}ejm(fc,Fc){if(!fc)throw ha.ULS.sendTraceTag(592998807,327,10,"Missing commentRichText"),Error.argumentNull("commentRichText");try{var id=H.a.aGb(fc)}catch(jf){throw ha.ULS.sendTraceTag(592998806,327,10,"commentRichText not in Delta Format"),Error.format("Improperly formatted Delta text in commentRichText");}var ld=fc=0,hd=0;const Be=RegExp("\\s+","g"),Ke=new Sys.StringBuilder;
for(var Me of id.ops)Me.attributes&&Me.attributes.atmention&&Me.attributes.atmention.email&&Fc&&(id=Me.attributes.atmention.email,0<id.length&&(id===Fc.UserId||id===Fc.Email||id===Oa.a.$hb(Fc.UserId))&&(ld=fc,hd=ld+Me.insert.length)),id=Me.insert.replace(Be," "),fc+=id.length,Ke.append(id);!hd&&Fc&&ha.ULS.sendTraceTag(592998805,327,10,"Assignee was not found in comment text",Fc.Provider);Fc=Ke.toString().trimEnd();fc=Fc.length;255<fc?(Me=(255-(hd-ld))/2,0>ld-Me?(fc=xa.a.instance.j2a(Fc,255-this.yhb.length),
hd=Fc.substring(0,fc)+this.yhb,fc="Trimmed End"):hd+Me>fc?(ld=xa.a.instance.C2a(Fc,fc-255+this.yhb.length),hd=this.yhb+Fc.substring(ld,fc),fc="Trimmed Start"):(ld=xa.a.instance.C2a(Fc,ld-Me+this.yhb.length),fc=xa.a.instance.j2a(Fc,hd+Me-this.yhb.length),hd=this.yhb+Fc.substring(ld,fc)+this.yhb,fc="Trimmed Both")):(fc="No Trim",hd=Fc);ha.ULS.sendTraceTag(592998804,327,50,fc);return hd}}Object(l.a)(fa,"ContentExtractor",null,[]);class Ka{constructor(fc,Fc){this.v6j=fc;this.C$j=Fc;this.pQb=this.BRb=
!1}a9a(fc){if(!fc)return null;if(void 0===fc.UserId||null===fc.UserId)throw ha.ULS.sendTraceTag(593368219,327,10,"Unexpected user missing UserId field"),Error.argumentType();if(fc.IsCurrentUser||!this.v6j.equals(this.C$j.value,fc))return fc;fc=ia(fc);fc.IsCurrentUser=!0;return fc}}Object(l.a)(Ka,"EnsureIsCurrentUserSetTransformer",null,[928]);class lb{constructor(){this.pQb=this.BRb=!1}a9a(fc){if(!fc)return null;if(void 0===fc.UserId||null===fc.UserId)return fc;if(!fc.Email||""===fc.Email){let Fc;
if(Fc=Oa.a.$hb(fc.UserId))return fc=ia(fc),fc.Email=Fc,fc}return fc}}Object(l.a)(lb,"RestoreEmailTransformer",null,[928]);class Xa{constructor(){this.pQb=this.BRb=!1}a9a(fc){if(!fc)return null;if(void 0!==fc.UserId&&null!==fc.UserId)return fc;switch(this.BRb?this.pQb?2:1:0){case 0:if(void 0===fc.UserId||null===fc.UserId)throw ha.ULS.sendTraceTag(593368215,327,10,"assignee missing UserId"),Error.argument("assignee.UserId");fc=ia(fc);break;case 1:if(void 0===fc.Id||null===fc.Id)throw ha.ULS.sendTraceTag(593368214,
327,10,"assignee missing Id"),Error.argument("assignee.Id");if(void 0===fc.Email||null===fc.Email)throw ha.ULS.sendTraceTag(593368213,327,10,"assignee missing Email"),Error.argument("assignee.Email");var Fc=Xa.d1i(fc.Id,fc.Email,null);if(!Fc||""===Fc)throw ha.ULS.sendTraceTag(593368212,327,10,"Failed to generate UserId"),Error.argument("UserId");var id=t.AFrameworkApplication.K.kb("HostAuthType")||"";if("aad"!==id.toLowerCase()||Fc.startsWith("S::")){if("msa"===id.toLowerCase())throw ha.ULS.sendTraceTag(593368210,
327,10,"Unexpected IPersonObject in MSA Environment"),Error.argument("CommentTaskUserType");ha.ULS.sendTraceTag(593368209,327,50,"Receiving IPersonObject with AuthType {0}",id)}else throw ha.ULS.sendTraceTag(593368211,327,10,"Unexpected UserID format"),Error.argument("userId");fc=new va.a(Fc,"AD",fc.DisplayName,fc.Email);break;case 2:if(void 0===fc.UserPrincipalName||null===fc.UserPrincipalName)throw ha.ULS.sendTraceTag(593368208,327,10,"assignee missing UserPrincipalName"),Error.argument("assignee.UserPrincipalName");
if(void 0!==fc.SuggestionSubtype&&null!==fc.SuggestionSubtype)if("OrganizationUser"===fc.SuggestionSubtype)Fc="AD";else throw ha.ULS.sendTraceTag(593368207,327,10,"Unexpected LPP SuggestionSubtype : {0}",fc.SuggestionSubtype),Error.argument("assignee.SuggestionSubtype");else throw ha.ULS.sendTraceTag(593368206,327,10,"Missing SuggestionSubtype"),Error.argument("assignee.SuggestionSubtype");id=Xa.d1i(fc.Id,fc.UserPrincipalName,fc.AadObjectId);if(!id||""===id)throw ha.ULS.sendTraceTag(593368205,327,
10,"Failed to generate UserId"),Error.argument("UserId");if("AD"===Fc&&!id.startsWith("S::"))throw ha.ULS.sendTraceTag(593368204,327,10,"Unexpected UserID and Provider combination"),Error.argument("userId");fc=new va.a(id,Fc,fc.Name,fc.UserPrincipalName);break;default:throw ha.ULS.sendTraceTag(593368203,327,10,"Unexpected UserType"),Error.argument("assignee.UserType");}return fc}static d1i(fc,Fc,id){if(!Fc||""===Fc)return ha.ULS.sendTraceTag(593368218,327,50,"Missing UPN"),fc;if(id&&""!==id)return"S::"+
Fc+"::"+id;if(!fc||""===fc)return ha.ULS.sendTraceTag(593368217,327,50,"Missing ID"),fc;if(fc.startsWith("S::"))return fc;if(-1!==fc.indexOf("@")){id=fc.split("@");if(ka.a.isValid(id[0]))return"S::"+Fc+"::"+id[0];ha.ULS.sendTraceTag(593368216,327,50,"ID is not in AadObjectId@TenantId format")}return fc}}Object(l.a)(Xa,"UserIdCanonicalizationTransformer",null,[928]);class kb{constructor(fc,Fc,id=!1,ld=!1){this.f2j=fc;this.gOg=Fc;this.oak=id;this.qpd=ld}j$k(){const fc=new Oa.a;var Fc=new Z.a(kb.JUl);
const id=new ea;this.gOg&&(id.eoc.push(new Xa),id.eoc.push(new lb));this.f2j&&id.eoc.push(new Ka(fc,Fc));id.BRb=this.gOg;id.pQb=this.oak;Fc=new sa(Fc,id);const ld=new fa;return new za(fc,id,Fc,ld,kb.yjl,kb.pjl,kb.qjl,this.qpd)}static JUl(){const fc=new va.a(t.AFrameworkApplication.K.kb("PresenceUserId")||"",t.AFrameworkApplication.K.kb("PresenceProvider")||"",t.AFrameworkApplication.userName||"");fc.IsCurrentUser=!0;return fc}}kb.yjl="";kb.pjl=5;kb.qjl=0;Object(l.a)(kb,"CommentTaskTranslatorFactory",
null,[919]);var Bb=c(42),Ja=c(166),Ma=c(13),fb=c(5),hc=c(51),cc=c(10),mb=c(177),Hb=c(48),Ua=c(23),Ya=c(741),Fb=c(37),Wa=c(8),yb=c(1229),Yb=c(17),qc=c(26),Hc=c(76),$b=c(289),Ub=c(130),mc=c(531),ic=c(206),ab=c(393),bb=c(720),Jb=c(372),Eb=c(62),hb=c(237),ob=c(12),Va=c(253),Qb=c(6),Vb=c(708),Sb=c(596),nb=c(359),ac=c(54),zc=c(612),Ib=c(112),ya=c(83),ib=c(224),wb=c(1494),bc=c(34),lc=c(1061);class Kb{create(){return new lc.a}}Object(l.a)(Kb,"CommentNodeFactory",null,[404]);var Bc=c(1220),Xc=c(1081),vd=c(1534),
vc=c(1597);class bd{constructor(){this.gNc=this.Rad=null;this.KMd=this.lke=!1;this.HOa=this.QDa=null}}Object(l.a)(bd,"CommentAnchorParaNodesStatus",null,[]);var Sd=c(1424),pd=c(16);class Tc extends Sd.a{constructor(fc){super();this.Ogk=fc}get index(){return 2}run(){this.Ogk()}XGh(fc,Fc){Fc.property===pd.a.gf&&this.QY()}}Object(l.a)(Tc,"CommentContentPropertyTracker",Sd.a,[]);var Wc=c(1525);class Pc{constructor(fc,Fc){this.Ohc=fc;this.Zti=Fc}}Object(l.a)(Pc,"CommentIntentIdentifier",null,[]);var Xd=
c(1050),Dd=c(1235),$e=c(197),se=c(163);class wc extends Sd.a{constructor(fc,Fc){super();this.O$a=new Sb.a(new Xd.a);this.y1b=new Dd.a(Wc.c);this.z1b=new $e.ScriptSharpLegacyMap;this.Lck=fc;this.Odk=Fc;this.z1b.add(Qb.a.Rba,1);this.z1b.add(Qb.a.LH,0);this.z1b.add(pd.a.gf,0);this.z1b.add(Qb.a.WQ,2)}get index(){return 4}run(){let fc="";for(const Fc of this.O$a)if(this.Lck(Fc),this.y1b.nb(Fc.id))for(const id of this.y1b.J(Fc.id))fc+="_"+id;this.Odk(fc);this.O$a.clear();this.y1b=new Dd.a(Wc.c)}y2k(fc,
Fc){fc=Fc.property;if(fc===Qb.a.Rba||fc===Qb.a.LH||fc===pd.a.gf||se.App.cqe&&fc===Qb.a.Z4b||fc===Qb.a.WQ)this.O$a.add(Fc.node),this.z1b.nb(fc)&&(this.y1b.nb(Fc.node.id)||this.y1b.add(Fc.node.id,new zc.a),this.y1b.J(Fc.node.id).add(this.z1b.J(fc))),this.QY();vd.a.HPh.has(Fc.node.id.toString())&&fc===Qb.a.hF&&ha.ULS.sendTraceTag(521484097,327,15,"Durable ID changed of a Cut Pasted Comment")}K2k(fc,Fc){Fc.property===pd.a.wo&&(fc=Fc.node,fc.bJb&&(this.O$a.add(fc),this.QY()))}vIo(fc,Fc){this.O$a.add(Fc.node);
this.QY()}}Object(l.a)(wc,"CommentNodeTransactionCompletedProcessor",Sd.a,[]);var cd=c(1598),Jd=c(1638);class Qd{constructor(){this.Zze=new Map;this.cDe=new Map}Rrk(fc,Fc){if(this.Zze.has(fc))throw Error("DuplicateDurableId");if(this.cDe.has(Fc))throw Error("DuplicateGuardId");this.Zze.set(fc,Fc);this.cDe.set(Fc,fc)}i_l(fc){return this.Zze.get(fc)}k9h(fc){return this.cDe.get(fc)}}Object(l.a)(Qd,"CommentIdMapper",null,[]);var yd=c(15),Le=c(1548),gf=c(1696),xh=c(1599),Qg=c(117),Ng=c(116),zg=c(994);
c.d(I,"a",function(){return Jf});class Jf extends e.a{constructor(fc,Fc,id,ld,hd,Be,Ke,Me,jf,kg,sf,Wg,Db,Gb,$c,Bd,we,He,Se,jg,Hi,ii,Zh,vg,vf,Lf=null,Cg){super();this.Cx=fc;this.BJe=Fc;this.wJe=id;this.Lc=ld;this.DZj=hd;this.Lwb=Be;this.yYe=Ke;this.Fsc=Me;this.Ca=jf;this.rd=kg;this.Un=sf;this.hZb=Wg;this.e_=Db;this.XYb=Gb;this.n5g=$c;this.Sg=Bd;this.Qm=we;this.jWa=He;this.gj=Se;this.G2=jg;this.pK=Hi;this.SZa=ii;this.oCc=Zh;this.Jsc=[];this.DWa=[];this.NVe=new a.a(0);this.Fvd=new a.a;this.Myd=new Sb.a(nb.a.ih());
this.lVe=new Sb.a(nb.a.ih());this.zkd=null;this.yub=new a.a;this.Dye=!1;this.Bid=new k.a;this.O_g=!1;this.Owe=new Set;this.lwe=0;this.UZ=[];this.EWb=2;this.ICa=new a.a(!1);this.Ozc=new k.a;this.Buc=new Map;this.wid=new Qd;this.xid=0;this.CZj=5;this.nMb=(bg,eg)=>{bg=eg.paragraphNode;for(const sh of eg.contents)this.bia(sh.element,bg,sh.intents,sh.CG)};this.T1c=(bg,eg)=>{if(bg.Mc.id.equals(this.xd.id)){this.jWa.kIa(7);var sh=bg.getValue(Qb.a.LH),nh=bg.getValue(Qb.a.hF).toString();sh=this.Sg.Hhb?this.Buc.has(nh)?
this.Buc.get(nh):nh:sh;sh=this.ZD(sh);if(eg){if(sh){this.Qx&&this.Qx.Df===sh.id&&(ha.ULS.sendTraceTag(592188698,327,50,"Draft lost by parent deletion"),this.pK.logKpiFailure(Le.a.yHd,"DraftCommentLostOnParentDelete",{isIntentional:!1,isInternal:!0},{name:Le.a.jHd,isIntentional:!1,isInternal:!0,isSessionEndingError:!1}));eg=sh.Df?"The comment is a reply":"";nh=Wc.k(bg,x.a.nil).toString();const Sh=Wc.h(bg,x.a.nil).toString();if(this.Bid.contains(sh.id)&&!vd.a.fLm(sh.y1a)){this.Bid.remove(sh.id);const Xk=
+new Date-+sh.date;ha.ULS.sendTraceTag(577307335,327,15,"New session comment deleted by inbound change: {0}. duration: {1}. startParaId: {2}. endParaId: {3}. {4}.",Wc.a(sh),Xk,nh,Sh,eg)}else ha.ULS.sendTraceTag(50426379,327,50,"{0} deleted by inbound changes. startParaId: {1}. endParaId: {2}. {3}.",Wc.a(sh),nh,Sh,eg);this.fj.BLc(sh);this.ARh(bg.id)}}else if(!sh){this.pK.ensureFeatureDenominatorLoggedAndVetoPillarRegistered();y.a.instance.Oa("WordEditor.Comments.EditorCommentManager")||ha.ULS.sendTraceTag(525379405,
327,10,"comment Manager resolve failed");if(this.Sg.SDb&&!this.gj.FY){this.G2.s$("OnCommentInit",Object.assign(new cd.a,{sVi:()=>{this.fWf(bg);this.POb()}}));return}this.Sg.ar||this.gj.FY||this.G2.s$("OnCommentInit");this.oNn(bg)||this.fWf(bg)}this.Dye=!0}};this.POb=(bg=null)=>{this.Sg.$Rb&&this.$ri();this.Sg.$Rb&&this.swl();this.rJ.ROb(void 0,bg);this.jWa.kIa(8)};this.dZi=(bg,eg,sh)=>{if(bg.Mc.id.equals(this.xd.id)){var nh=bg.ja(Qb.a.taskId,"");if(""===nh)ha.ULS.sendTraceTag(42856717,3003,10,"Newly added or deleted task node does not have a task id.");
else{if(eg)if(this.lVe.add(nh),nh=this.XYb.value.Qii(bg),void 0!==nh&&null!==nh)this.yub.remove(nh);else{ha.ULS.sendTraceTag(591971722,3003,10,"A task without comment id was deleted even though that shouldn't be possible.");return}else if(this.Myd.add(nh),eg=this.XYb.value,bg=eg.Qii(bg),void 0!==bg&&null!==bg)for(this.yub.J(bg)?this.yub.Z(bg,nh):this.yub.add(bg,nh),bg=eg.Sii(nh),eg=0;eg<bg.length;eg++){var Sh=bg[eg].commentId;Sh&&(Sh=Number.parseInvariant(Sh),this.yub.J(Sh)||this.yub.add(Sh,nh))}else{ha.ULS.sendTraceTag(591971723,
3003,10,"A task without comment id was added or modified even though that shouldn't be possible.");return}sh&&this.POb()}}};this.YUo=bg=>{if(vd.a.tZd(bg)){const sh=this.m0(bg.id.toString());if(sh){const nh={text:sh.text,done:sh.done};var eg=fb.GraphIterator.eb(bg);sh.text=this.RFb(eg);this.CKi(sh.text);sh.done=bg.ja(Qb.a.Rba,!1);bg.hasProperty(Qb.a.WQ)&&(eg=(eg=bg.getValue(Qb.a.WQ))?bc.b(eg||""):null,sh.usersByReactionType=eg,xh.a.ODh(sh.usersByReactionType),this.AWk(sh));this.aVo(bg,sh);sh.Df||this.fVo(bg,
sh);!this.Sg.rva||!this.LE||this.Qx&&this.Qx.id===sh.id||this.LE.fireEvent(10,{comment:sh,pTi:nh})}}else this.rd.isFeatureEnabled(114)&&72===bg.type?this.dZi(bg,!1,!1):this.$Uo(bg)};this.twl=()=>{const bg=this.TQd();for(this.Jsc.sort((eg,sh)=>{const nh=eg.ja(Qb.a.zM,null),Sh=sh.ja(Qb.a.zM,null);if(!nh&&Sh)return-1;if(!Sh&&nh)return 1;eg.hasProperty(Qb.a.RDa)&&sh.hasProperty(Qb.a.RDa)?(eg=eg.getValue(Qb.a.RDa),sh=sh.getValue(Qb.a.RDa),sh=eg<sh):(eg=new Date(eg.getValue(Qb.a.pJc)),sh=new Date(sh.getValue(Qb.a.pJc)),
sh=eg<sh);return sh?-1:1});this.Jsc.length;){const eg=this.Jsc[0];bg.Tjb(eg)&&(bg.Aj(eg),this.fj.addComment(this.hJd(bg),null),this.fj.mode=1);Array.removeAt(this.Jsc,0)}if(bg.Ub(1))for(;bg.Mf(1););this.rd.isFeatureEnabled(114)&&this.XYb.value.Uii();this.Dye&&(this.POb(),this.Dye=!1)};this.Nnl=bg=>{1===bg&&(ib.WoncaApp.Wle.sLh(),this.hZb.value.N7a(!0,"CommentInboundFailed"));this.e_.fI(hc.a.Daf,this.BFi)};this.lia=bg=>{if(!this.Sg.ar||bg.done)return!1;if(bg.$q===m.a.beingCreated)return!0;if(bg.objectId){if(this.NJm(bg))return!1;
if(!this.kQm(bg.objectId)||bg.Df)return!0;for(const eg of this.bP())if(eg.Df===bg.id)return!0}return!1};Jf.oK=Lf;this.asd=new Sb.a(nb.a.ih());!this.Sg.SDb&&this.Sg.ar||lc.a.FTa(this.T1c);vf.hDa(this.nMb);vg&&(vg.Vw((bg,eg)=>{bg=Wc.o(this.UZ,eg.node.id);0<this.UZ.length&&(!bg||bg===this.UZ.length-1)&&(this.EWb=1,this.UZ=[])}),Cg.execute(bg=>{this.LE=bg}),t.AFrameworkApplication.cI&&(t.AFrameworkApplication.oe("AutoPopulateShareTUIComment;AutoPopulateShareTUICommentCf"),this.Sg.eJk&&Object(zg.a)().then(bg=>
{bg||this.brk()})))}brk(){z.a.instance.Wb(new v.a(5,1,0,()=>{const fc=this.Lc.Pc(7);fc.Db(this.hKa);var Fc=cc.App.za.jb.Zc;Fc&&(Fc=mb.PageNavigator.instance.jP(Fc),Fc=fb.GraphIterator.eb(Fc),Fc.Rd(),Fc.Rd(),Fc.Rd(),Fc.Rd(),Hb.a.instance.Ac(Ua.SelectionFactory.lJ(Fc.currentNode,0,0)),Fc=new H.a,Fc.Xca("Get the conversation going by adding comments and using Share (above) to send a link to this doc. It\u2019s free! No subscription or sign-in necessary. \n"),this.lDb(Hb.a.instance.ib.lb,"Microsoft Word",
Fc),fc.dispose(),Bb.a("ShareTUICommentCreated"),ha.ULS.sendTraceTag(520728590,327,50,"ShareTUICommentCreated"))}))}get rJ(){return this.fj}get u1e(){return this.fh}get BFi(){return null!=this.TDg?this.TDg:this.TDg=Object.assign(new Ya.a,{i8:WoncaIntl.WoncaStrings.l_InboundingCommentFailed,jna:1})}get Zr(){return this.Lc}get ox(){return this.Cx.value}get xd(){return this.ox.xd}get hKa(){return this.BJe.value}get TDa(){return this.wJe.value}get mb(){return this.Lwb.value}get bZ(){return this.Ca.kb("PresenceUserId")}get H6a(){return this.Ca.kb("PresenceProvider")}bia(fc,
Fc,id,ld){if(id&&this.Qx&&(!this.Qx||!this.Qx.Df)){var hd=!1;for(const Be of id)if(3===Be.type)switch(hd=!0,id=Wc.n(this.UZ,Be.id),-1<id&&(this.UZ[id].Ohc=Fc.id),fc.classList.add(Fb.a.eMd),ld){case 1:fc.classList.add(Fb.a.Xgf);break;case 0:fc.classList.add(Fb.a.Ygf)}hd||fc.classList.remove(Fb.a.eMd,Fb.a.Ygf,Fb.a.Xgf);this.jWa.kIa(3)}}ipf(fc=!1){return this.yYe.cKl(this.fh,t.AFrameworkApplication.va.mode,Fc=>!this.Sg.pRb||!fc||this.lia(Fc))}Mof(fc){return this.yYe.tQl(this.fj.model.bP(),t.AFrameworkApplication.va.mode,
fc)}xtf(fc){if(!fc||!fc.Df)return fc;fc=fc.Df;for(let Fc=0;Fc<this.fh.length;Fc++)if(this.fh[Fc].id===fc)return this.fh[Fc];return null}i$k(){const fc=[];if(this.rd.isFeatureEnabled(114)){var Fc=this.XYb.value;for(const id of Fc.Uii())(Fc=this.u4h(id))&&fc.push(Fc)}return fc}Nym(fc){if(!this.DWa)throw F.a.invalidOperation("UpdateContent must have been called before this.");for(let Fc=0;Fc<this.DWa.length;Fc++)if(this.DWa[Fc].id===fc)return Fc;return-1}$ri(){const fc=new ya.a;for(const id of this.fh)if(id.objectId&&
id.cxa){var Fc=x.a.If(id.objectId);if((Fc=this.xd.Eb(Fc))&&Fc.hasProperty(Qb.a.hF))if(Fc=Fc.getValue(Qb.a.hF).toString(),fc.nb(Fc)){const ld=fc.J(Fc).CommentId;this.iQj(ld,id,Fc)}else fc.add(Fc,new G(id.id,id.done))}this.zkd=fc}iQj(fc,Fc,id){fc!==Fc.cxa?(ha.ULS.sendTraceTag(42866777,327,10,"Multiple comments contains the same DurableId [{0}]; ObjectId [{1}], GuardId [{2}], GuardId of existing entry: {3}",id,Fc.objectId,Fc.cxa,fc),this.pK.logKpiFailure(Le.a.b5b,"MultipleCommentsWithSameDurableId",
{isInternal:!0},{name:Le.a.a5b,isInternal:!0})):ha.ULS.sendTraceTag(554297428,327,15,"Duplicate entry of same comment with DurableId [{0}], GuardId [{1}], ObjectId [{2}]",id,Fc.cxa,Fc.objectId)}u4h(fc){const Fc=this.n5g.value;var id=this.XYb.value;const ld=id.aac(fc);if(void 0===ld||null===ld)return ha.ULS.sendTraceTag(592234717,3003,50,"GenerateTaskItemForTaskId was called with a taskId [{0}] that has no comment anchor id.",fc),null;id=id.Sii(fc);try{return Fc.tfl(fc,ld.toString(),id,this.zkd)}catch(hd){return ha.ULS.sendTraceTag(42856716,
3003,10,"CreateTaskItemFromHistoryRecords Failed due to [{0}]",hd.message),null}}x7h(fc=!1,Fc=!1){const id=new k.a,ld=Fc?Wc.j():new Set;this.ICa.keys.forEach(hd=>{ld.has(hd)||fc&&this.ICa.J(hd)||id.add(hd);return!0});return id}jTd(){if(!this.fh)return 0;let fc=0;for(const Fc of this.fh)Fc.Df||fc++;return fc}uWc(fc){var Fc,id;return(null===(id=null===(Fc=this.Qx)||void 0===Fc?void 0:Fc.Bz)||void 0===id?void 0:id.draftId)===fc}Urk(fc){var Fc;if(fc.$q===m.a.beingCreated){if(this.fj.mode=2,this.Nbb=fc,
this.mb.ib){var id=this.mb.ib.lb;if(id&&id.Pa){id=this.IZo(id);for(var ld=0;ld<id.length;ld++){var hd=id.J(ld).node;if(!Wa.ParagraphReader.Xb(hd)||!(-1!==id.J(ld).cpBegin&&-1!==id.J(ld).cpEnd||-1!==id.J(ld).Wj&&-1!==id.J(ld).vp))continue;var Be=-1===id.J(ld).cpBegin?id.J(ld).Wj:id.J(ld).cpBegin;const Ke=-1===id.J(ld).cpEnd?id.J(ld).vp:id.J(ld).cpEnd,Me=x.a.create();this.Un.fHa(hd,new yb.a(3,Be,Ke,Me));this.UZ.push(new Pc(hd.id,Me));this.Ask(null===(Fc=fc.Bz)||void 0===Fc?void 0:Fc.draftId,hd,Be,id)}}}}else this.x6f(fc);
id=({index:Fc}=this.nne(fc)).returnValue;ld=null;if(!fc.Df){hd=this.x7h();fc.$q!==m.a.beingCreated&&(ld=this.Odm(fc),hd.remove(fc.objectId));hd=({index:Be}=this.K5l(ld,hd)).returnValue;Fc=-1<Be?Be:Fc;Be=0;if(hd)for(;Fc<this.fh.length&&this.fh[Fc].Df;)Fc++;if(!hd&&this.Sg.ar&&fc.$q===m.a.beingCreated)for(hd=0;hd<Fc;hd++)this.fh[hd].Df||this.fh[hd].done||Be++;this.zEo(fc,Be)}id&&(Array.insert(this.fh,Fc,fc),this.Sg.rva&&this.LE&&fc.$q!==m.a.beingCreated&&(fc.Df?this.LE.fireEvent(10,{comment:fc,changeType:"replyAdded"}):
this.LE.fireEvent(11,{comment:fc})),this.Xrk(fc,ld))}IZo(fc){if(this.Sg.Fzl){var Fc=Yb.SelectionEditor.Nzl(fc);Fc&&(this.mb.Ac(Fc),fc=Fc)}else Yb.SelectionEditor.Pl(fc)&&(Fc=Yb.SelectionEditor.j0(fc.Pa,!1))&&(this.mb.Ac(Fc),fc=Fc);return fc}Ask(fc,Fc,id,ld){this.Sg.contentNavigationApiEnabled&&fc&&Fc&&ld&&this.oCc.M_e({contentId:fc,containerContentType:0,n$:{Bd:id,bN:Fc.Vk}},{selection:ld})}Xrk(fc,Fc){if(this.Sg.contentNavigationApiEnabled&&fc&&!fc.Df&&fc.$q!==m.a.beingCreated){var id=this.xd.Eb(fc.objectId);
if(id){var ld=Wc.k(id,x.a.nil);ld=this.xd.Eb(ld);ld=vd.a.Ewa(ld,id.id,!1);(null===ld||void 0===ld?0:ld.Lb)&&(null===ld||void 0===ld?0:ld.paragraph)?this.oCc.M_e({contentId:fc.id,containerContentType:0,n$:{Bd:ld.Lb.cp,bN:ld.paragraph.Vk}},{selection:Fc}):ha.ULS.sendTraceTag(520717896,327,10,`comment object id: ${id.id},
        commentStartRangeObject Valid: ${!!ld},
        containingProperties Valid: ${!(null===ld||void 0===ld||!ld.Lb)},
        paragraph valid: ${!(null===ld||void 0===ld||!ld.paragraph)};
        Failed to add to ReviewSuggestionModel`)}}}sva(fc){super.sva(fc);this.Bid.add(fc.id)}b4n(fc,Fc){this.Sg.contentNavigationApiEnabled&&this.oCc.a4n(fc,Fc)}zEo(fc,Fc){this.Sg.ar&&fc.$q===m.a.beingCreated&&fc.Bz&&this.NVe.Z(fc.Bz.draftId,Fc)}Zhm(fc){return this.NVe.J(fc)}caj(fc){this.NVe.remove(fc)}c1l(fc){let Fc=0,id=0;for(let ld=0;ld<this.fh.length;ld++){if(this.fh[ld].id===fc.id){id=ld;break}this.fh[ld].Df||this.fh[ld].done||Fc++}return{returnValue:id,iKo:Fc}}zuf(fc){var Fc=null,id=this.xd.Eb(fc);
fc=vd.a.vca(id,this.xd,!0);id=vd.a.vca(id,this.xd,!1);fc&&id&&(Fc=Ua.SelectionFactory.ne(fc.Lb.paragraph,fc.Lb.cp),Fc=Ua.SelectionFactory.Gy(Fc,qc.a.Rc(id.Lb.paragraph,id.Lb.cp)));fc&&id||this.pK.logKpiFailure(Le.a.b5b,"ParaNodeNotConnected",{isIntentional:!1,isInternal:!0});return Fc}Odm(fc){fc=x.a.If(fc.objectId);return this.zuf(fc)}m8f(fc,Fc){var id=this.xd.Eb(fc);if(id){var ld=this.xd.Eb(Wc.k(id));id=this.xd.Eb(Wc.h(id));if(ld===id)for(id=0;id<ld.qa.length&&!ld.qa.J(id).xQo(fc,Fc);id++);}}K5l(fc,
Fc){let id=-1;var ld=null;fc||(fc=this.mb.ib?this.mb.ib.lb:null);if(!fc||!fc.Pa)return{returnValue:null,index:id};const hd=this.gfi(fc.Pa);if(!hd)return{returnValue:null,index:id};var Be=vd.a.x2l(hd.iterator.currentNode,fc.Pa.cpBegin,this.Sg.ar,Fc);Be&&(ld=this.m0(Be.Lj.toString()),Be=Array.indexOf(this.fh,ld),ld=0<=Be?ld:null,id=0<=Be?Be+1:id);ld||(fc=this.v7h(hd,fc.Pa,this.Sg.ar,Fc),ld=0<=fc?this.fh[fc]:null,id=0<=fc?fc:id);return{returnValue:ld,index:id}}qSl(fc=null){var Fc=null;Fc=this.mb.ib.lb;
return Fc&&Fc.Pa?this.vYl(Fc.Pa,this.Sg.ar,fc):null}gfi(fc){const Fc=new fb.GraphIterator;Fc.set(fc.node);return Fc.Ip()?Hc.a.Gs(Fc,Fc.origin):null}vYl(fc,Fc,id=null){const ld=this.gfi(fc);fc=this.v7h(ld,fc,Fc,id);return-1<fc?this.fh[fc]:null}v7h(fc,Fc,id,ld=null){let hd=-1;if(fc)for(Fc=Fc.cpBegin;-1===hd&&fc.moveNext();)Wa.ParagraphReader.oh(fc.iterator)&&((Fc=vd.a.WPc(fc.iterator.currentNode,Fc,id,ld))&&(hd=Array.indexOf(this.fh,this.m0(Fc.Lj.toString()))),Fc=0);return hd}mwi(fc){const Fc=fc.toString();
return this.ICa.nb(Fc)&&this.ICa.J(Fc)||this.Ozc.contains(fc)&&this.xd.gxa(fc)&&this.xd.Eb(fc).ja(Qb.a.Rba,!1)}Ykj(fc,Fc=!1){if(fc=this.XPc(fc))fc.zGf=!Fc}XGf(fc){return this.ICa.nb(fc.toString())||this.Ozc.contains(fc)&&this.xd.gxa(fc)&&!this.xd.Eb(fc).ja(Qb.a.zM,null)}x6f(fc){!fc.objectId||fc.Df||this.ICa.nb(fc.objectId)||this.ICa.add(fc.objectId,fc.done)}deleteComment(fc){fc&&!fc.Df&&(this.Sg.ar&&fc.$q!==m.a.beingCreated?this.ICa.remove(fc.objectId):fc.$q===m.a.beingCreated&&this.fEj());this.Bid.remove(fc.id);
return super.deleteComment(fc)}pqf(fc){return fc&&fc.hasProperty(Qb.a.hF)?fc.wf(Qb.a.hF).toString():""}XPc(fc){if(!fc)return null;if(this.Sg.Hhb)return this.ZD(fc);for(const Fc of this.fh){const id=this.xd.Eb(x.a.If(Fc.objectId));if(this.pqf(id)===fc.toString())return fc=id.wf(Qb.a.LH),this.ZD(fc)}return null}n5f(fc,Fc=!1){if(fc&&vd.a.tZd(fc)&&this.rd.isFeatureEnabled(114)){const id=this.pqf(fc);if(""!==id){if(Fc){let ld;if(this.zkd&&({value:ld}=this.zkd.Fc(id,ld)).returnValue&&ld.ResolveState===
fc.ja(Qb.a.Rba,!1))return}(fc=this.yub.J(Number.parseInvariant(id)))&&this.Myd.add(fc)}}}oNn(fc){const Fc=this.gpf(fc);let id=!1;Fc.lke&&Fc.KMd||(this.Ozc.add(fc.id),id=!0,this.zUi(fc));return id}zUi(fc){M.a.R3(t.AFrameworkApplication.lc,()=>{this.fWf(fc);this.Ozc.remove(fc.id);this.Ozc.count||(this.POb(),this.rJ.iWo())},"DelayLoadCommentNodeIntoModel")}fWf(fc){if(!this.fj&&(ha.ULS.sendTraceTag(525379406,327,10,"Comment Manager Not initialized"),this.xid<this.CZj)){this.xid+=1;this.zUi(fc);ha.ULS.sendTraceTag(525378784,
327,50,`Comment Node add Retry attempt ${this.xid}`);return}const Fc=this.TQd();Fc.Aj(fc);if(Fc.Iz()){let id;try{id=this.hJd(Fc)}catch(ld){ha.ULS.Vz(512553930,327,10,ld,"create comment from comment node failed")}if(!id){ha.ULS.sendTraceTag(512553929,327,15,`CommentNode Failed to add: ${null===fc||void 0===fc?void 0:fc.id}`);this.pK.logKpiFailure(Le.a.b5b,"CommentCreationFailed",{isInternal:!0},{name:Le.a.a5b,isInternal:!0});return}this.fj.addComment(id,null);2!==this.fj.mode&&3!==this.fj.mode&&(this.fj.mode=
1);this.n5f(fc);this.Fin(id);this.eKj(id)}else this.Jsc.push(fc);this.G2.s$("OnCommentNodeAdded",{commentNode:fc})}Fin(fc){this.Sg.ar&&!this.gj.Bm&&this.rJ.Tz&&fc.Df&&this.rJ.Tz.id===fc.Df&&this.rJ.notify(String.format(Box4Intl.Box4Strings.L_CommentReplyAdded,fc.author),!1)}gpf(fc){const Fc=new bd;Fc.Rad=Wc.k(fc,x.a.nil);Fc.gNc=Wc.h(fc,x.a.nil);fc=Fc.Rad.equals(x.a.nil);const id=Fc.gNc.equals(x.a.nil);fc||(Fc.QDa=this.xd.Eb(Fc.Rad),Fc.lke=!!Fc.QDa&&Fc.QDa.isConnected);id||(Fc.HOa=this.xd.Eb(Fc.gNc),
Fc.KMd=!!Fc.HOa&&Fc.HOa.isConnected);return Fc}AXh(fc,Fc){const id=this.Nym(fc);-1!==id&&Array.removeAt(this.DWa,id);Fc||((fc=this.u4h(fc))?this.DWa.push(fc):ha.ULS.sendTraceTag(42870813,3003,10,"GenerateTaskItemForTaskId returned null"))}swl(){for(const fc of this.Myd)this.AXh(fc,!1);this.Myd.clear();for(const fc of this.lVe)this.AXh(fc,!0);this.lVe.clear()}nne(fc){var Fc=this.fh.length,id=!1;if(fc.Df){var ld=(id=this.ZD(fc.Df))&&id.objectId?this.xd.Eb(x.a.If(id.objectId)):null;ld=!!ld&&ld.hasProperty(Qb.a.RDa);
Fc=Array.indexOf(this.fh,id);id=0>Fc;for(Fc+=1;Fc<this.fh.length&&this.fh[Fc].Df===fc.Df&&this.fh[Fc]!==this.Qx&&!(ld&&fc.date<this.fh[Fc].date);)Fc++}return{returnValue:!id,index:Fc}}svm(){const fc=new wc(this.YUo,this.POb),Fc=cc.App.si.Il;Fc.Ue(40).Eo(Object(ac.a)(fc,fc.y2k,"commentPropertyChanged"));Fc.Ue(12).Eo(Object(ac.a)(fc,fc.K2k,"commentTextChanged"));this.rd.isFeatureEnabled(114)&&Fc.Ue(72).Eo(Object(ac.a)(fc,fc.vIo,"taskPropertyChanged"));$b.GraphTransactionManager.instance.nra(fc,3)}CKi(fc){this.Ca.getBooleanFeatureGate("Microsoft.Office.WordOnline.EmptyCommentLogging",
!1)&&fc&&0!==fc.length&&(fc=H.a.aGb(fc[0]),1<fc.ops.length||0===fc.ops.length||("\n"===fc.ops[0].insert&&(this.lwe+=1),3<this.lwe&&ha.ULS.sendTraceTag(509437908,327,15,"comments content cleared. Potentially resulting in data loss")))}AWk(fc){if(fc&&this.Owe.has(fc.id)){var Fc=fc.usersByReactionType[1];for(let id=0;Fc&&id<Fc.length;id++)if(Fc[id].UserId===this.bZ)return;ha.ULS.sendTraceTag(542765345,327,15,`Like by current user on Comment ${fc.objectId} removed by inbound changes`)}}fVo(fc,Fc){this.J_k(Fc);
const id=this.Sg.ar;id&&this.Srm(Fc)?(this.Tjl(Fc),this.n5f(fc),this.pZo(Fc)):id||this.n5f(fc,!0)}$Uo(fc){const Fc=new fb.GraphIterator;Fc.set(fc);Fc.zb(40);Fc.jd(40);if(Fc.currentNode){if(fc=this.m0(Fc.currentNode.id.toString())){const id={done:fc.done,text:fc.text};fc.text=this.RFb(Fc);this.CKi(fc.text);!this.Sg.rva||!this.LE||this.Qx&&this.Qx.id===fc.id||this.LE.fireEvent(10,{comment:fc,pTi:id})}}else ha.ULS.sendTraceTag(592738053,327,15,"UpdateComment Unexpected Node Type: "+Ub.a[fc.type])}pZo(fc){if(!this.gj.Bm){var Fc=
new zc.a;this.zoe(fc,Fc);0<Fc.count&&Vb.b(Fc)}}Tjl(fc){const Fc=new v.a(0,1,0,()=>{this.ZUo(fc)},137,void 0,!0);t.AFrameworkApplication.lc.Wb(Fc)}J_k(fc){var Fc;null!==(Fc=this.Qx)&&void 0!==Fc&&Fc.Bz&&this.Qx.Bz.sessionType!==K.a.metadata&&(Fc=this.Qx,fc.Df||!fc.done||Fc.Df!==fc.id&&Fc.id!==fc.id||(ha.ULS.sendTraceTag(592188699,327,15,"Draft comment lost on parent resolve, DraftType: {0}",Fc.$q),this.pK.logKpiFailure(Le.a.yHd,"DraftCommentLostOnParentResolve",{isIntentional:!1,isInternal:!0},{name:Le.a.jHd,
isIntentional:!1,isInternal:!0,isSessionEndingError:!1}),Fc.$q===m.a.beingCreated?(this.fj.clearSelection(),this.deleteComment(Fc),this.selectComment(fc)):Fc.$q===m.a.beingEdited&&(Fc.$q=m.a.normal,Fc.eUa=L.a.succeeded,this.fj.S6e())))}aVo(fc,Fc){var id;const ld=null===(id=Fc.Bz)||void 0===id?void 0:id.draftId;if(this.Sg.Hhb){if(fc=fc.getValue(Qb.a.hF).toString(),Fc.id!==fc){if(!Fc.Df)for(id=Array.indexOf(this.fh,Fc)+1;id<this.fh.length&&this.fh[id].Df===Fc.id;id++)this.fh[id].Df=fc;ha.ULS.sendTraceTag(555044877,
327,50,"durable Id updated.");Fc.id=fc;this.Buc.has(fc)&&this.Buc.delete(fc)}}else if(fc=fc.getValue(Qb.a.LH),Fc.id!==fc){if(!Fc.Df)for(id=Array.indexOf(this.fh,Fc)+1;id<this.fh.length&&this.fh[id].Df===Fc.id;id++)this.fh[id].Df=fc;Fc.id=fc}ld&&this.b4n(ld,Fc.id)}Srm(fc){return this.ICa.nb(fc.objectId)&&this.ICa.J(fc.objectId)!==fc.done}ZUo(fc){this.ICa.Z(fc.objectId,fc.done);if(fc.done)if(this.rJ.Koc(fc),this.gj.Bm)this.rJ.l2c(fc,!0);else{var Fc=new v.a(0,1,0,()=>{this.rJ.l2c(fc,!0,!1);this.Fvd.remove(fc.id)},
139);this.Fvd.add(fc.id,Fc);t.AFrameworkApplication.lc.Wb(Fc);this.oz&&fc.id===(void 0===this.oz.Df||null===this.oz.Df?this.oz.id:this.oz.Df)&&this.rJ.clearSelection()}else this.rJ.Koc(fc),Fc=null,({value:Fc}=this.Fvd.Fc(fc.id)).returnValue?(t.AFrameworkApplication.lc.ff(Fc),this.Fvd.remove(fc.id)):this.rJ.l2c(fc,!1)}BWi(){this.KAm();this.IAm();t.AFrameworkApplication.K.$("IsDocumentOwner")||y.a.instance.Ta("Common.ISystemInitiatedFeedback").execute(fc=>{fc.logActivity("ShowTUIForCommentAwareness",
null)})}IAm(){this.Sg.$Rb&&this.$ri();this.Sg.$Rb&&(this.DWa=this.i$k(),Xc.a.FTa(this.dZi))}KAm(){!this.Sg.SDb&&this.Sg.ar&&lc.a.FTa(this.T1c);this.svm();this.rvm()}rvm(){const fc=new Tc(this.twl),Fc=cc.App.si.Il;Fc.Ue(39).Eo(Object(ac.a)(fc,fc.XGh,"commentContainerPropertyChanged"));this.rd.isFeatureEnabled(114)&&Fc.Ue(71).Eo(Object(ac.a)(fc,fc.XGh,"commentContainerPropertyChanged"));$b.GraphTransactionManager.instance.nra(fc,3)}m0(fc){for(let Fc=0;Fc<this.fh.length;Fc++){const id=this.fh[Fc];if(id.objectId===
fc)return id}return null}Zvk(fc){if(fc)for(const Fc of fc)Fc&&this.asd.add(Fc)}TYk(){this.asd.clear()}FZe(fc,Fc){Array.insert(this.fh,Fc,fc);this.x6f(fc);this.z4m(fc);Fc=this.vRd(fc);this.asd.contains(Fc)&&(fc.zGf=!0,this.asd.remove(Fc))}eKj(fc){Wc.p(fc)||ha.ULS.sendTraceTag(512278912,327,15,`Missing Start or End mapping info for Comment ${fc.objectId}`)}z4m(fc){ha.ULS.sendTraceTag(539800645,327,50,`Comment added to Model. ${Wc.a(fc)} `)}hJd(fc){40!==fc.Xe&&ha.ULS.sendTraceTag(594363294,327,15,"[CreateCommentForNode] Iterator is not at commentNode");
const Fc=fc.currentNode;var id=Fc.getValue(Qb.a.Z4b),ld=Fc.getValue(Qb.a.LH);const hd=Fc.getValue(Qb.a.hF).toString(),Be=Fc.getValue(Qb.a.pJc);let Ke=null,Me=null;if(Fc.hasProperty(Qb.a.WQ)){var jf=Fc.getValue(Qb.a.WQ);Ke=jf?bc.b(jf||""):null;xh.a.ODh(Ke)}Fc.hasProperty(Qb.a.RDa)&&(Me=Fc.getValue(Qb.a.RDa));let kg=null,sf=null;Fc.hasProperty(Qb.a.gHd)&&Fc.hasProperty(Qb.a.oJc)&&(kg=Fc.getValue(Qb.a.gHd),sf=Fc.getValue(Qb.a.oJc));jf=Wc.k(Fc,x.a.nil).toString();const Wg=Wc.h(Fc,x.a.nil).toString(),
Db=Fc.ja(Qb.a.Rba,!1),Gb=Fc.ja(Qb.a.zM,null),$c=Fc.ja(Qb.a.Zjb,!1);let Bd;Fc.attrString?(ld=this.N$k(Fc.attrString),Bd=ld.paragraphs,ld=ld.cxa.toString()):Bd=this.RFb(fc);id=new R.Comment(this.Sg.Hhb?hd:ld,ld,id,Me||new Date(Be),this.Sg.Hhb?this.wid.k9h(Gb):Gb,Db,Bd,R.Comment.c0i,$c,sf,kg,Ke);id.vGc=jf;id.uGc=Wg;id.objectId=Fc.id.toString();id.y1a=hd;this.uoh(hd,ld);fc.jd(39);return id}N$k(fc){let Fc=fc.WEl(new mc.a(0));const id=new H.a;let ld=0;for(;Fc&&!Fc.are();){let hd=void 0;Fc.kAi||(hd=fc.IB(Fc));
const Be=fc.Wha(Fc.cbe),Ke=Be&&Be.properties.get("2");Be&&Be.properties.forEach(()=>{});const Me=new S.a;"para"==Ke?ld=null===Be||void 0===Be?void 0:Be.properties.get("5417"):Ke||(Me.weight=(null===Be||void 0===Be?0:Be.properties.get("1436"))?H.a.R4d:0,id.zCf(hd,Me),id.Xca("\n"));Fc=fc.B6l(Fc)}return{cxa:ld,paragraphs:[id.I9b()]}}uoh(fc,Fc){(!fc||Number.parseInvariant(fc)>=vd.a.NNi)&&ha.ULS.sendTraceTag(544022547,327,10,`Durable Id is invalid ${fc}`);Fc||ha.ULS.sendTraceTag(544022548,327,10,`Guard Id is invalid ${Fc}`);
try{this.wid.Rrk(fc,Fc)}catch(id){"DuplicateDurableId"===id.message?ha.ULS.sendTraceTag(544511521,327,10,`Duplicate Durable Id: ${fc} with Guard Id: ${Fc}`):"DuplicateGuardId"===id.message?ha.ULS.sendTraceTag(544511522,327,10,`Duplicate GuardId: ${Fc} with Durable Id: ${fc}`):ha.ULS.sendTraceTag(544022549,327,10,`Unkown Error when adding to CommentIds map: ${id}`)}}RFb(fc){var Fc;if(40!==fc.Xe)return ha.ULS.sendTraceTag(594379426,327,15,"Trying to get text from node of type: {0}",fc.Xe),this.Fsc.Lmg([]);
let id=fc.Xe+":";const ld=fc.Wp();0<ld?(fc.Rd(),id+=fc.Xe+":"):(ha.ULS.sendTraceTag(509642946,327,15,`Comment has no paragraphs. ${null===(Fc=fc.currentNode)||void 0===Fc?void 0:Fc.id}`),Fc=new Qg.a,Fc.inStaging=!0,this.pK.logKpiFailure(Le.a.b5b,"CommentContentNotFound",{isIntentional:!1,isInternal:!0},{name:Le.a.jHd,isIntentional:!1,isInternal:!0,isSessionEndingError:!1,additionalValues:Fc},Ng.a));Fc=Array(ld);for(let hd=0;hd<ld;hd++){fc.Rd();id+=fc.Xe+":";const Be=fc.currentNode;Be.bJb=!0;Fc[hd]=
Be;Be.qa||ha.ULS.sendTraceTag(594363293,327,15,"[GetCommentText_Crash] "+id);!Be.qa&&this.Sg.Udo&&(t.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordSendErrorReportOnCommentInboundCrashSettings"),this.Ep());fc.uc();fc.Oj();id+=hd<ld-1?":"+fc.Xe+":":":"}return this.Fsc.Lmg(Fc)}Ep(){if(ib.WoncaApp.Wle){var fc=new wb.a(!0,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportTitle,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportDescription,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportPrivacyStatement);
fc.Cd=1;fc.ze(1,WoncaIntl.WoncaStrings.l_SendErrorReport);fc.ze(0,WoncaIntl.WoncaStrings.l_NoThanks);fc.BV(1);fc.vx(hc.a.Daf,CommonUIStrings.l_DefaultDialogTitle,WoncaIntl.WoncaStrings.l_InboundingCommentFailed,this.Nnl,!1)}else this.e_.fI(hc.a.Daf,this.BFi)}vRd(fc){if(!fc||!fc.objectId)return"";fc=x.a.If(fc.objectId);fc=this.xd.Eb(fc);return this.pqf(fc)}F9l(fc){return this.vRd(fc.Df?this.ZD(fc.Df):fc)}CTn(fc,Fc){if(this.rd.isFeatureEnabled(114))if(this.Sg.Zda)ha.ULS.sendTraceTag(595128897,3003,
50,"RecordTaskChanges no ops because filter PII flag on"),this.POb();else{this.SZa.Tv(Ma.a.Cfg);var id=null===Fc||void 0===Fc?void 0:Fc.taskId,ld=!id;ld?this.SZa.logKpiUsage(gf.a.Ele,0):this.SZa.logKpiUsage(gf.a.Fle,0);try{const jf=this.XYb.value,kg=this.vRd(fc);if(""===kg)this.F3d(ld,"FailedDurableIdForComment");else{var hd=this.F9l(fc);if(""===hd)this.F3d(ld,"FailedDurableIdForParentComment");else if(ld&&fc.Bz.sessionType!==K.a.create&&fc.Bz.sessionType!==K.a.reply)ha.ULS.sendTraceTag(42856725,
3003,10,"Unexpected create task for drafting session type [{0}]",fc.Bz.sessionType),this.SZa.logKpiFailure(gf.a.Ele,"FailedTaskCreateInvalidSessionType");else{var Be=null;fc.Bz.sessionType!==K.a.metadata&&(Be=kg);var Ke=this.n5g.value;var Me=N.a.af(fc.text)?Ke.e4h(Be,Fc,ld):Ke.e4h(Be,Fc,ld,fc.text[0]);0<Me.length?ld?(jf.Kgb(Number.parseInvariant(hd),Me)||this.SZa.logKpiFailure(gf.a.Ele,"TaskCreateFailed"),this.POb()):(this.SZa.logKpiUsage(gf.a.Fle,0),jf.kEk(id,Me)||this.SZa.logKpiFailure(gf.a.Fle,
"TaskEngagementFailed")):this.F3d(ld,"HistoryRecordsLengthZero")}}}catch(jf){this.F3d(ld,"RecordTaskChangesFailed")}}}F3d(fc,Fc){const id={name:gf.a.oIo,isInternal:!0};fc?this.SZa.logKpiFailure(gf.a.Ele,Fc,id):this.SZa.logKpiFailure(gf.a.Fle,Fc,id)}BBd(fc,Fc){if(fc){var id=t.AFrameworkApplication.userName,ld=Fc.toString();fc.usersByReactionType||(fc.usersByReactionType={});var hd=fc.usersByReactionType[ld];id=new W(this.bZ,this.H6a,id);id.DateUtc=new Date;hd?hd.push(id):fc.usersByReactionType[ld]=
[id];ha.ULS.sendTraceTag(572014993,327,50,"Reaction type {0} added to {1} with Object Id: {2} ",Fc,fc.Df?"reply":"parent",fc.objectId);ld=[fc];this.pK.Tv(yd.a.z2k,{succeeded:!0,customData:{reactionType:V[Fc]}});this.b6c(ld,Q.addReaction);this.Owe.add(fc.id)}}Ade(fc,Fc){if(fc&&fc.usersByReactionType){var id=fc.usersByReactionType[Fc.toString()];if(id&&id.length){for(let ld=0;ld<id.length;ld++)if(id[ld].UserId===this.bZ){Array.removeAt(id,ld);break}ha.ULS.sendTraceTag(572014994,327,50,"Reaction type {0} removed from {1} with Object Id: {2} ",
Fc,fc.Df?"reply":"parent",fc.objectId);id=[fc];this.pK.Tv(yd.a.B2k,{succeeded:!0,customData:{reactionType:V[Fc]}});this.Owe.delete(fc.id);this.b6c(id,Q.removeReaction)}}}b6c(fc,Fc){const id=this.Lc.Pc(15);id.Db(this.hKa);this.ox.sF.g8(3);switch(Fc){case Q.deleteComment:for(Fc=0;Fc<fc.length;Fc++){var ld=fc[Fc];if(ld.$q===m.a.beingCreated)this.Sg.contentNavigationApiEnabled&&this.oCc.remove(ld.Bz.draftId),this.rJ.Apg();else{var hd=x.a.If(ld.objectId);(hd=this.xd.Eb(hd))&&vd.a.OKd(hd,this.xd);ha.ULS.sendTraceTag(39364559,
327,50,`Deleting Comment: [CommentObjectId:${ld.objectId}]`);this.Sg.rva&&this.LE&&(ld.Df?this.LE.fireEvent(10,{comment:ld,changeType:"replyDeleted"}):this.LE.fireEvent(7,{comment:ld}));this.Sg.contentNavigationApiEnabled&&this.oCc.remove(ld.id)}}break;case Q.addComment:this.fj.mode=1;fc=fc[0];fc.date=new Date;Fc=this.Ncl(fc);ld=Fc.getValue(Qb.a.hF).toString();fc.y1a=ld;this.Sg.Hhb&&this.Buc.set(ld,fc.id);ld=fc.text;hd=this.TQd();if(fc.Df){var Be=this.ZD(fc.Df),Ke=this.xd.Eb(x.a.If(Be.objectId));
Fc.setValue(Qb.a.zM,Ke.getValue(Qb.a.LH));this.addReply(Fc,ld,this.xd,hd,Ke);ha.ULS.sendTraceTag(39364560,327,50,`Adding Reply: [ObjectId:${fc.objectId}][ParentObjectId:${Be.objectId}]`)}else(Be=this.mb.ib.lb)&&Be.Pa&&(Yb.SelectionEditor.Pl(Be)&&(Ke=Yb.SelectionEditor.j0(Be.Pa,!1))&&(this.mb.Ac(Ke),Be=Ke,ha.ULS.sendTraceTag(592569872,327,50,"[RecordChanges] Selection extended")),Wa.ParagraphReader.Xb(Be.Pa.node)&&Wa.ParagraphReader.Xb(Be.Tc.node)&&(this.MAb(Fc,ld,hd,Be),ha.ULS.sendTraceTag(39364561,
327,50,`Adding Comment: [ObjectId:${fc.objectId}]`)));ld=Fc.ja(Qb.a.LH,null);fc.cxa=ld;fc.eUa=L.a.sentToServer;fc.eUa=L.a.succeeded;fc.objectId=Fc.id.toString();this.x6f(fc);this.eKj(fc);this.uoh(fc.y1a,fc.cxa);this.Sg.rva&&this.LE&&(fc.Df?this.LE.fireEvent(10,{comment:fc,changeType:"replyAdded"}):this.LE.fireEvent(11,{comment:fc}));break;case Q.editComment:this.fj.mode=1;fc=fc[0];Fc=x.a.If(fc.objectId);Fc=this.xd.Eb(Fc);ld=fc.cxa;fc.cxa||(ld=Fc.getValue(Qb.a.LH),ha.ULS.sendTraceTag(554446870,327,
15,`Missing GuardID for Comment with objectId ${fc.objectId} while editing`),ld=this.Sg.Hhb?ld:fc.id);this.qFj(Fc,fc.text,ld);ha.ULS.sendTraceTag(39364562,327,50,`Editing Comment: [CommentObjectId:${fc.objectId}]`);fc.eUa=L.a.sentToServer;fc.eUa=L.a.succeeded;this.Sg.rva&&this.LE&&this.LE.fireEvent(10,{comment:fc,changeType:fc.Df?"replyEdited":"edited"});break;case Q.addReaction:case Q.removeReaction:Fc=fc[0];fc=x.a.If(Fc.objectId);fc=this.xd.Eb(fc);(Fc=(Fc=Fc.usersByReactionType)?bc.c(Fc):"")&&fc.setValue(Qb.a.WQ,
Fc);break;case Q.done:case Q.undone:for(Fc=0;Fc<fc.length;Fc++)ld=fc[Fc],hd=x.a.If(ld.objectId),this.xd.Eb(hd).setValue(Qb.a.Rba,ld.done),ha.ULS.sendTraceTag(594124932,327,50,`${ld.done?"Resolved":"Re-opened"} Comment: [CommentObjectId:${ld.objectId}]`),this.Sg.rva&&this.LE&&this.LE.fireEvent(10,{comment:ld,changeType:ld.done?"resolved":"reopened"})}this.Qm.tF();ha.ULS.sendTraceTag(572281361,327,50,"Disposing transaction, should raise context reload event");id.dispose()}TQd(){const fc=new fb.GraphIterator;
fc.set(this.ox);this.TDa.Q5a(fc);return fc}P8c(){return this.Iij(!0)}Q8c(){return this.Iij(!1)}Iij(fc){if(!this.fh.length)return null;let Fc=this.oz;do{if(Fc){const id=this.Sg.ar&&!this.gj.Bm;Fc=fc?this.tYl(Fc,id):this.uYl(Fc,id)}else Fc=fc?this.fh[0]:this.fh[this.fh.length-1];if(!Fc)return null}while(Fc.Df&&""!==Fc.Df);this.selectComment(Fc);return Fc}KLh(fc,Fc,id,ld,hd){const Be=this.DZj.create(1074135127);this.Sg.Zda&&(Fc=CommonUIStrings.l_RemovedAuthorName,id=null);Be.setValue(Qb.a.commentId,
Y.a.GF());Be.setValue(Qb.a.hF,vd.a.oqf());Be.setValue(Qb.a.IOa,t.AFrameworkApplication.userSessionId);Be.setValue(Qb.a.LH,fc);Be.setValue(Qb.a.Z4b,Fc);Be.setValue(Qb.a.qHh,Fc);Be.setValue(Qb.a.pJc,id?ba.a.IPd(id,"MM/dd/yyyy HH:mm:ss",ba.a.dataCulture):"");Be.setValue(Qb.a.RDa,id);Be.setValue(Qb.a.Rba,ld);hd&&(fc=hd?bc.c(hd):"",Be.setValue(Qb.a.WQ,fc));Be.setValue(Qb.a.oJc,this.bZ);Be.setValue(Qb.a.gHd,this.H6a);return Be}Ncl(fc){var Fc;const id=this.KLh(fc.id,fc.author,fc.date,fc.done,null!==(Fc=
fc.usersByReactionType)&&void 0!==Fc?Fc:{});fc.Df&&(this.Sg.Hhb?((Fc=this.wid.i_l(fc.Df))||ha.ULS.sendTraceTag(555008772,327,10,`Missing guardId for Comment With Durable Id ${fc.Df}`),fc=Fc):fc=fc.Df,id.setValue(Qb.a.zM,fc));return id}addReply(fc,Fc,id,ld,hd){this.addComment(fc,Fc,ld);Fc=Jf.Jph(fc,id,hd,!0);id=Jf.Jph(fc,id,hd,!1);Fc&&Wc.v(fc,Fc.Lb.paragraph.id);id&&(Wc.u(fc,id.Lb.paragraph.id),id.Lb.paragraph.id||ha.ULS.shipAssertTag(5564303,327,!1,"Comment node has no end anchor!"))}MAb(fc,Fc,id,
ld){this.addComment(fc,Fc,id);let hd,Be;({start:Fc,end:hd,startCp:id,endCp:Be,Cvh:Ke}=this.KQk());Ke&&(ld.Pa.node===Fc&&(id=ic.a.Wib(ld,!0)),ld.Tc.node===hd&&(Be=ic.a.Wib(ld,!1)));if(-1===id||-1===Be){this.O_g||0!==this.EWb||(this.pK.logKpiFailure(Le.a.A9e,"DraftSelectionLost",{isInternal:!0},{name:Le.a.a5b,isInternal:!0}),this.O_g=!0);Fc=ld.Pa.node;id=ic.a.Wib(ld,!0);hd=ld.Tc.node;Be=ic.a.Wib(ld,!1);if(2<ld.length){var Ke=[];for(let Me=0;Me<ld.length;Me++)Ke.push(ld.J(Me).node.id);this.nph(fc,Ke)}ha.ULS.sendTraceTag(51233603,
327,50,"Intents invalid reason {0}",this.EWb)}else if(2<this.UZ.length){Ke=[];for(ld=0;ld<this.UZ.length;ld++)Ke.push(this.UZ[ld].Ohc);this.nph(fc,Ke)}vd.a.p2b(Fc,fc.id,id,!0);vd.a.p2b(hd,fc.id,Be,!1);Wc.v(fc,Fc.id);Wc.u(fc,hd.id);this.fEj();hd.id||ha.ULS.shipAssertTag(5564304,327,!1,"Comment node has no end anchor!")}nph(fc,Fc){if(!(2>=Fc.length||!fc||Wc.s(fc))){this.gj.gV.add(fc.id,new Sb.a(new ab.a));for(var id=x.a.Dq(Fc[0],Fc[1])?2:1,ld=Fc.length-2;id<=ld;id++){const hd=Fc[id];this.gj.$x.nb(hd)?
this.gj.$x.J(hd).cN||(this.gj.$x.J(hd).cN=new Sb.a(new ab.a)):this.gj.$x.add(hd,new Jd.a(!0));this.gj.$x.J(hd).t3a=!0;this.gj.$x.J(hd).cN.add(fc.id);this.gj.gV.J(fc.id).add(hd)}}}KQk(){let fc=null,Fc=-1,id=null;var ld=-1;let hd=!1;if(!this.UZ.length||2!==this.EWb)return{start:fc,end:id,startCp:Fc,endCp:ld,Cvh:hd};fc=this.xd.Eb(this.UZ[0].Ohc);id=1===this.UZ.length?fc:this.xd.Eb(this.UZ[this.UZ.length-1].Ohc);if(Wa.ParagraphReader.Xb(fc)&&Wa.ParagraphReader.Xb(id)){ld=Ke=>3===Ke.type;let Be=this.Un.kQa(fc,
3,ld);Fc=0<Be.count?Be.J(0).Ec:-1;fc!==id&&(Be=this.Un.kQa(id,3,ld));ld=0<Be.count?Be.J(0).end:-1;-1===Fc&&null!=fc&&(Fc=fc.qa.first.cp,hd=!0,ha.ULS.sendTraceTag(524862562,327,50,"Draft Anchor startCp was adjusted"));-1===ld&&null!=id&&(ld=id.qa.last.cp,hd=!0,ha.ULS.sendTraceTag(524862563,327,50,"Draft Anchor endCp was adjusted"))}this.EWb=-1===Fc||-1===ld?0:2;return{start:fc,end:id,startCp:Fc,endCp:ld,Cvh:hd}}fEj(){for(const fc of this.UZ){const Fc=this.xd.Eb(fc.Ohc);Wa.ParagraphReader.Xb(Fc)&&this.Un.AVa(Fc,
3)}this.UZ=[];this.EWb=2}addComment(fc,Fc,id){fc.anchor||(id.Bf(fc,1),id.Aj(fc),this.Zkj(fc,Fc,id))}Zkj(fc,Fc,id){let ld=0;var hd=null;Fc=this.Fsc.gLo(Fc,Be=>{const Ke=new bb.a;id.Bf(Ke,1);id.Aj(Ke);id.Bf(Be,2);id.Aj(Be);id.uc();id.uc()});for(let Be=0;Be<Fc.length;Be++)hd=Fc[Be],ld=hd.getValue(Qb.a.Wc),Jf.Tk.IVa(hd),Jf.oK&&Jf.oK.rOa&&Jf.oK.IIa(qc.a.create(hd));fc.setValue(Qb.a.LH,ld.toString());return hd}Xkb(fc,Fc){return this.bIm(fc,Fc)}asm(){return 0<this.UZ.length}lDb(fc,Fc,id){return fc.Pa&&Wa.ParagraphReader.Xb(fc.Pa.node)&&
Wa.ParagraphReader.Xb(fc.Tc.node)?(Fc=this.KLh(Wa.ParagraphReader.tR(fc.Tc.node).toString(),Fc?Fc:t.AFrameworkApplication.userName,new Date,!1,{}),id||(id=new H.a,id.Xca("\n")),this.MAb(Fc,[id.I9b()],this.TQd(),fc),Fc):null}Fs(fc){return!this.yYe.xgg(this.XPc(fc.getValue(Qb.a.hF)))}qFj(fc,Fc,id){const ld=new fb.GraphIterator;for(ld.set(fc);ld.Rd();)ld.zg();this.Zkj(fc,Fc,ld).Hg(Qb.a.Wc,Number.parseInvariant(id));fc.setValue(Qb.a.LH,id);if(Fc=this.m0(fc.id.toString()))Fc.jJh=!1;fc.setValue(Qb.a.Zjb,
!1)}pFj(fc,Fc){this.qFj(fc,[Sys.Serialization.JavaScriptSerializer.serialize(Fc)],fc.getValue(Qb.a.LH))}SG(fc){fc=this.xd.Eb(x.a.If(fc));return!!fc&&fc.ja(Qb.a.SG,!1)}v2i(fc){fc=this.xd.Eb(x.a.If(fc));return!!fc&&fc.ja(Qb.a.SIh,!1)}NJm(fc){const Fc=Wc.j();return fc&&Fc.has(fc.objectId)}kQm(fc){const Fc=this.xd.Eb(x.a.If(fc));return Fc?this.mdc(Fc):(ha.ULS.sendTraceTag(562562755,341,15,"CommentNode is null, commentObjectId: "+fc),!1)}mdc(fc){var Fc=fc.id,id=Wc.k(fc),ld=Wc.h(fc);if(!x.a.Dq(id,ld))return!1;
id=fc.Mc.Eb(id);if(!id)return!1;ld=({FIc:fc}=this.oKc(id,Fc,!0)).returnValue;var hd=({FIc:Fc}=this.oKc(id,Fc,!1)).returnValue;if(-1===ld||-1===hd)return!1;id=id.qa;ld=id.J(fc);hd=id.J(Fc);if(!ld.hyperlink||!ld.hyperlink.PG||!hd.Cm)return!1;for(fc+=1;fc<Fc;fc++)if(ld=id.J(fc),ld.hyperlink||ld.Cm)return!1;return!0}bTc(){return Jf.ksm(this.fh,fc=>this.SG(fc),fc=>this.v2i(fc))}oKc(fc,Fc,id){let ld;for(ld=0;ld<fc.qa.length;ld++){const hd=fc.qa.J(ld);if(hd.Te)for(let Be=0;Be<hd.Te.length;Be++){const Ke=
hd.Te.J(Be);if(Ke.Lj.equals(Fc)&&Ke.Oc===id)return{returnValue:hd.cp,FIc:ld}}}return{returnValue:-1,FIc:ld}}ARh(fc){if(this.gj.gV.nb(fc)){const Fc=new zc.a;for(const id of this.gj.gV.J(fc))this.QZn(id,fc,Fc);this.gj.gV.remove(fc);Vb.b(Fc)}}zoe(fc,Fc){if(fc.objectId){fc=x.a.If(fc.objectId);var id=this.xd.Eb(fc);if(id){var ld=Wc.k(id,x.a.nil);id=Wc.h(id,x.a.nil);ld.equals(x.a.nil)||Fc.add(this.xd.Eb(ld));id.equals(x.a.nil)||Fc.add(this.xd.Eb(id));if(this.gj.gV.nb(fc))for(const hd of this.gj.gV.J(fc))Fc.add(this.xd.Eb(hd))}}}QZn(fc,
Fc,id){let ld;({value:ld}=this.gj.$x.Fc(fc,ld));ld&&(ld.cN.remove(Fc),ld.cN.count||(ld.t3a=!1,id.add(this.xd.Eb(fc))))}static get Tk(){return null!=Jf.PFg?Jf.PFg:Jf.PFg=y.a.instance.resolve("Box4.IParagraphEditor")}static getInstance(){return Jf.fm()}static fm(){if(Jf._instance)return Jf._instance;const fc=new Z.a(()=>(new kb(!0,!0,!0)).j$k()),Fc=y.a.instance;Jf._instance=new Jf(new Z.a(()=>cc.App.za.jb.Zc),new Z.a(()=>cc.App.za.jb.rc.ed),new Z.a(()=>vc.a.instance),new Jb.a,new Kb,new Z.a(()=>Hb.a.instance),
Fc.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),Fc.resolve("WordEditor.Comments.ICommentFormatTranslator"),Fc.resolve("Common.IAppSettingsManager"),Fc.resolve("Box4.IFeatureHelper"),Fc.resolve("Box4.Intent.IIntentRangeEditor"),new Z.a(()=>cc.App.sS),Fc.resolve("Box4.IKickoutExecutor"),Fc.Ve("WordEditor.Tasks.ITaskActor"),fc,Fc.resolve("WordEditor.Comments.CommentsSettings"),Fc.resolve("Box4.IUndoManager"),Fc.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),Fc.resolve("WordEditor.Comments.CommentsState"),
Fc.resolve("WordEditor.Comments.WordCommentEventsActor"),Fc.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),Fc.resolve("WordEditor.Comments.ITasksUsageAndHealthLogger"),Fc.resolve("WordEditor.ReviewSuggestionContent.IReviewSuggestionContentModel"),cc.App.si.Il.Ue(12),Fc.resolve("Box4.ParagraphRenderEvents"),Fc.resolve("Box4.CatchUpActivity.IChangeIdEditor"),Fc.Ta("WordEditor.Extension.RichApiEventManager"));return Jf._instance}static Jph(fc,Fc,id,ld){Fc=vd.a.vca(id,Fc,ld);if(!Fc)return null;
Fc=Fc.Lb.Te;return vd.a.ABd(fc.id,Fc,Fc.J(0).fv,ld)}bIm(fc,Fc){if(cc.App.lostSession||(Fc?!cc.App.Fs:!cc.App.Fs&&!cc.App.Dm)||1===fc.mode||!Object(Ib.a)(Bc.MainView,Eb.InteractiveViewManager.instance.yd))return!1;fc=this.UNl();return!fc||hb.a.instance.$_(fc)||hb.a.instance.via(fc)||fc.contextId===ob.a.X7||Va.a.hFf(fc)&&Va.a.Mcc()?!1:!0}UNl(){const fc=Eb.InteractiveViewManager.instance.yd;var Fc=fc.mb.qg;this.Qx&&Ja.n(Fc.node)&&(Fc=fb.GraphIterator.eb(Fc.node),Fc.zb(12),Fc=Fc.ko(12),Fc=Ua.SelectionFactory.Ena(Fc),
fc.mb.Ac(Fc),Fc=fc.mb.qg);return Fc}static ksm(fc,Fc,id){const ld=new zc.a,hd=new zc.a,Be=new ya.a,Ke=new ya.a;for(const kg of fc){var Me=kg.id,jf=kg.objectId;fc=kg.done;const sf=!!jf&&Fc(jf);Me&&(fc&&ld.add(Me),sf&&hd.add(Me),jf&&Be.Z(Me,jf));if(Me=kg.Df)({value:jf}=Ke.Fc(Me,0)).returnValue||(jf=0),Ke.Z(Me,jf+1);if(!Me&&!fc&&!sf)return!0}for(const kg of hd){if(ld.contains(kg))continue;let sf;if(({value:sf}=Be.Fc(kg,sf)).returnValue&&id(sf))return!0;let Wg;if(({value:Wg}=Ke.Fc(kg,0)).returnValue&&
0<Wg)return!0}return!1}kSl(fc){const Fc=[];let id=this.fh.findIndex(ld=>ld.id===fc);if(-1<id)for(Fc.push(this.fh[id]);++id<this.fh.length&&this.fh[id].Df===fc;)Fc.push(this.fh[id]);return Fc}BWl(fc){return this.wid.k9h(fc)}}Jf._instance=null;Jf.oK=null;Object(l.a)(Jf,"EditorCommentModel",e.a,[391,392,393])},1790:function(D,I,c){D=c(0);var l=c(399),e=c(139),a=c(42),k=c(305),x=c(3),y=c(7),m=c(15),t=c(1648),z=c(1605);class v{constructor(Z,ea,ha=!1){this.paragraphNode=Z;this.role=ea;this.juj=ha}}Object(D.a)(v,
"DesignerReviewActionData",null,[]);class H{constructor(Z,ea,ha){this.paragraphNode=Z;this.Kq=ea;this.role=ha}}Object(D.a)(H,"TriageActionData",null,[]);class F extends H{constructor(Z,ea){super(Z,0,ea)}}Object(D.a)(F,"RoleTriageActionData",H,[]);class G extends H{constructor(Z,ea,ha){super(Z,1,27);this.styleId=ea;this.JX=ha}}Object(D.a)(G,"PullQuoteTriageActionData",H,[]);class M extends H{constructor(Z,ea){super(Z,2,28);this.epa=ea}}Object(D.a)(M,"ImageTriageActionData",H,[]);class K{constructor(Z,
ea){this.paragraphNode=Z;this.kKb=ea}}Object(D.a)(K,"ViewOriginalActionData",null,[]);var L=c(138),R=c(1546),S=c(1720);class N{constructor(Z,ea){this.currentNode=Z;this.nextNode=ea}}Object(D.a)(N,"ReviewNavigationArgs",null,[]);class O{constructor(Z,ea){this.paragraphNode=Z;this.isVisible=ea}}Object(D.a)(O,"ReviewVisibilityArgs",null,[]);class W{constructor(Z){this.Cik=Z}getSelectedOption(){return this.Cik}getSeparatorIndexes(){return[1]}}Object(D.a)(W,"DesignerPreviewData",null,[]);var V=c(507),
Q=c(948),Y=c(1721);c.d(I,"a",function(){return ba});class ba extends Q.a{constructor(Z,ea,ha,ka,ua,sa,Da,Pa,Ra,Ga,ta,va){super();this.oc=Z;this.Zd=ea;this.fLd=ha;this.Zca=ka;this.ij=ua;this.hC=sa;this.tBj=Da;this.gm=Pa;this.Lv=Ra;this.gLd=Ga;this.Is=ta;this.hnf=va;this.meb=null;this.ahd=void 0;this.nxe=0;this.EH=[V.a.YRh]}get types(){return this.EH}get Zij(){return Box4Intl.Box4Strings.l_ShowDesignerReviewTooltipSelectOrPress}get uae(){return 0}yuo(Z){return 3!==Z.suggestion.Kq&&!this.Lv.isVisible&&
(!this.nxe||!Z.gBb&&1===this.nxe)}EN(Z){var ea;if(!Z.source||l.SessionStatusManager.instance.Zj)return!1;const ha=Z.ul;var ka=this.Zca.ZQc(ha,1);if(!ka||!ka.count)return!1;const ua=ka.J(0).intent;if(Z.lmc)return.5!=(null===ua||void 0===ua?void 0:ua.state)&&4!=(null===ua||void 0===ua?void 0:ua.state);const sa=ha.node;if(0==(null===ua||void 0===ua?void 0:ua.state)&&(2==(null===ua||void 0===ua?void 0:ua.suggestion.Kq)||1==(null===ua||void 0===ua?void 0:ua.suggestion.Kq)))return ua.gBb(),this.Zca.AVa(sa,
1),this.hC.Q6i(new S.a(sa,1)),!0;if(1==Z.source&&27==(null===ua||void 0===ua?void 0:ua.Bkb)&&(.5==(null===ua||void 0===ua?void 0:ua.state)||4==(null===ua||void 0===ua?void 0:ua.state)))return!1;ka=this.Lv.isVisible?this.fLd.hnl(sa):new Y.a(0,1);let Da;const Pa=this.J1l(null===(ea=null===ua||void 0===ua?void 0:ua.suggestion)||void 0===ea?void 0:ea.Kq);ea=this.Wi.kka(ha,{id:"Intent-"+V.a.YRh,suggestionGroups:[{type:Pa,id:Pa,title:ua.description,snippet:this.RGn(this.ij.Uda(ha.node)),snippetFormatting:[],
supportedActions:this.Rof(null===ua||void 0===ua?void 0:ua.suggestion,!0),suggestions:({gdo:Da}=this.xOh(sa)).returnValue,previewData:Da?new W(Da):null,isContentPending:!1}],setSize:ka.count,positionInSet:ka.index},this,Z.WRa,!1,()=>{var Ra;this.hC.R6i(new O(sa,!0));this.Lv.isVisible||3===(null===(Ra=null===ua||void 0===ua?void 0:ua.suggestion)||void 0===Ra?void 0:Ra.Kq)||this.nxe++},()=>{this.hC.R6i(new O(sa,!1))},null,!1,Ra=>{Ra.showDesignerButton=!this.Lv.isVisible;Ra.shouldSkipTwoStepReview=!0;
Ra.isFormattingSuggestion=0==ua.suggestion.Kq;Ra.isMultiParagraphSuggestion=1<ua.sO.length;Ra.proactivePromptHintType=this.yuo(ua)?k.e.HideFromReviewCardAndRibbon:k.e.None});a.c(m.a.Rwn,ea,void 0,void 0,30);return ea}executeAction(Z,ea){var ha,ka,ua,sa,Da;if(!Z||!ea)return!1;const Pa=this.gm.GA(ea);y.ULS.sendTraceTag(541446529,3016,50,"Action: {0}; Role: {1}; Pane: {2};",Z.actionType,null===Pa||void 0===Pa?void 0:Pa.role,this.Lv.isVisible);const Ra=this.gLd.CU(ea);try{switch(Z.actionType){case k.b.Accepted:const Ga=
this.oc.Qb(m.a.XAd,2,new v(ea,null===Pa||void 0===Pa?void 0:Pa.role,!0));this.Opg(Oa=>{Oa.supportedActions=this.Rof(null===Ra||void 0===Ra?void 0:Ra.suggestion,!1)});return this.Lv.isVisible&&32===Ga?this.XSf(ea):32===Ga;case k.b.Rejected:const ta=this.oc.Qb(m.a.pde,2,new v(ea,null===Pa||void 0===Pa?void 0:Pa.role,!0));2===(null===Ra||void 0===Ra?void 0:Ra.suggestion.Kq)||Object(R.e)(null===Ra||void 0===Ra?void 0:Ra.suggestion)||this.Bdd(ea,!1);2===(null===Ra||void 0===Ra?void 0:Ra.suggestion.Kq)&&
this.Wi.dismiss();return this.Lv.isVisible&&32===ta?this.XSf(ea):32===ta;case k.b.Next:case k.b.Previous:return!this.Lv.isVisible||this.XSf(ea,Z.actionType===k.b.Previous);case k.b.Apply:const va=null===(ha=Z.suggestion)||void 0===ha?void 0:ha.contentData;let ia;switch(null===va||void 0===va?void 0:va.Kq){case 0:ia=new F(ea,va.role);break;case 1:case 3:const Oa=va.Q6a;y.ULS.sendTraceTag(541446530,3016,50,"Changing PullQuote style: {0}",{["suggestionId"]:null===(ka=null===Ra||void 0===Ra?void 0:Ra.suggestion)||
void 0===ka?void 0:ka.id,["newStyleId"]:Oa});Ra.suggestion.Q6a=Oa;ia=new G(ea,Oa,e.a.create());break;case 2:ia=new M(ea,va.epa);break;default:return y.ULS.shipAssertTag(527459665,3016,!1,String.format("DesignerSuggestionType: {0}",va.Kq)),!1}this.Wi.focus();const qa=this.oc.Qb(m.a.changeDesignerRole,2,ia);this.Bdd(ea,!1);return 32===qa;case k.b.AcceptAll:return 32===this.oc.Qb(x.a.Ieb,2,new t.a(2));case k.b.RejectAll:return 32===this.oc.processAction(m.a.x6c,2);case k.b.SnoozeAll:return 32===this.oc.processAction(m.a.designerSnoozeContextualSuggestions,
2);case k.b.Undo:const pa=this.oc.Qb(m.a.OJa,2,new v(ea,null===Pa||void 0===Pa?void 0:Pa.role));this.Bdd(ea,!0);return 32===pa;case k.b.OpenDesignerPane:return 32===this.oc.Qb(m.a.wJa,2,new z.a(6));case k.b.ViewOriginal:const Fa={kKb:Z.descriptorData.isViewingOriginal,Qdg:Z.descriptorData.setIsViewingOriginal};if(void 0==(null===Fa||void 0===Fa?void 0:Fa.kKb)||void 0==(null===Fa||void 0===Fa?void 0:Fa.Qdg))return y.ULS.shipAssertTag(538789889,3016,!1,String.format("isViewingOriginal: {0}; setIsViewingOriginal: {1}",
null===Fa||void 0===Fa?void 0:Fa.kKb,null===Fa||void 0===Fa?void 0:Fa.Qdg)),!1;this.Wi.focus();const za=this.oc.Qb(m.a.$ef,2,new K(ea,Fa.kKb));Fa.Qdg(!Fa.kKb);this.Bdd(ea,!0);return 32===za;case k.b.GiveFeedback:switch(null===(ua=null===Ra||void 0===Ra?void 0:Ra.suggestion)||void 0===ua?void 0:ua.Kq){case 0:return this.Is.invokeUserFeedback(L.a.ITj),!0;case 1:case 3:return this.Is.invokeUserFeedback(L.a.OTj),!0;case 2:return this.Is.invokeUserFeedback(L.a.KTj),!0;default:return y.ULS.shipAssertTag(537658138,
3016,!1,String.format("DesignerSuggestionType: {0}",null===(sa=null===Ra||void 0===Ra?void 0:Ra.suggestion)||void 0===sa?void 0:sa.Kq)),!1}case k.b.ShowMore:switch(null===(Da=null===Ra||void 0===Ra?void 0:Ra.suggestion)||void 0===Da?void 0:Da.Kq){case 2:y.ULS.sendTraceTag(527210449,3016,50,"User clicked show more images"),Ra.suggestion.zym(),this.Bdd(ea,!0,!0)}return!0;default:return!1}}catch(Ga){return y.ULS.shipAssertTag(572027277,3016,!1,String.format("{0} {1}",Ga.message,Ga.stack)),!1}}XSf(Z,
ea=!1){const ha=this.fLd.m$b(Z,ea)||this.fLd.m$b(Z,!ea);this.hC.yOn(new N(Z,ha,!ea));return!ha||this.fLd.SQi(this,ha)}EZl(Z){switch(Z.Kq){case 0:case 1:case 3:return{...k.h,font:Z.font,cssColor:Z.color,fontSize:Z.fontSize,fontWeight:Z.bold?k.d.Bold:k.d.Normal,italic:Z.italic,underlineType:Z.underline?k.f.Single:k.f.None,backgroundImg:Z.backgroundImg};case 2:break;default:y.ULS.shipAssertTag(527569927,3016,!1,`${Z.Kq}`)}}G0l(Z){if(2===Z.Kq)return{src:Z.imageUrl,width:0,height:0,imageAltText:Z.altText}}xOh(Z){var ea=
null;let ha=null;if(this.meb=this.tBj.F7l(Z)){ha=Array(this.meb.options.length);for(Z=0;Z<this.meb.options.length;Z++)ea=this.meb.options[Z],ha[Z]={type:"DesignerTriageItem",id:String.format("DesignerTriageItem {0}",Z),title:ea.title,supportedActions:[k.b.Apply],contentData:ea,image:this.G0l(ea),titleFormatting:[this.EZl(ea)]};ea=(null===ha||void 0===ha?0:ha.length)?ha[this.meb.selectedIndex]:void 0}return{returnValue:ha,gdo:ea}}Opg(Z){this.Wi.definition?this.Wi.definition.suggestionGroups?1===this.Wi.definition.suggestionGroups.length&&
(Z(this.Wi.definition.suggestionGroups[0]),this.Wi.definition=this.Wi.definition):y.ULS.sendTraceTag(512274571,3016,50,"UXManger.definition.suggestionGroups is null"):y.ULS.sendTraceTag(512274572,3016,50,"UXManger.definition is null")}Bdd(Z,ea,ha=!1){const ka=this.gLd.CU(Z);this.Opg(ua=>{ua.supportedActions=this.Rof(null===ka||void 0===ka?void 0:ka.suggestion,ea);if(this.meb){if(ha){var sa=this.xOh(Z).returnValue;ua.suggestions=sa}sa=this.tBj.sdm(this.meb.options,Z);ua.previewData=new W(ua.suggestions[sa])}})}Rof(Z,
ea){const ha=[];ea?(ha.push(k.b.Accepted),ha.push(k.b.Rejected),0==(null===Z||void 0===Z?void 0:Z.Kq)&&ha.push(k.b.ViewOriginal)):(ha.push(k.b.Next),ha.push(k.b.Undo));this.Lv.isVisible||(this.Zd.sKm()&&this.dHk(ka=>{ka&&this.Opg(ua=>ua.supportedActions.push(k.b.GiveFeedback))})&&ha.push(k.b.GiveFeedback),this.Zd.gLm()&&ha.push(k.b.OpenDesignerPane),ha.push(k.b.SnoozeAll));0===(null===Z||void 0===Z?void 0:Z.Kq)&&ha.push(k.b.AcceptAll);ha.push(k.b.RejectAll);(null===Z||void 0===Z?0:Z.Kni())&&ha.push(k.b.ShowMore);
return ha}RGn(Z){const ea=Z.split(" ",10);return 10>ea.length?Z:ea.join(" ")+"\u2026"}static mLm(Z){return Z===V.a.ZRh||Z===V.a.$Rh||Z===V.a.dSh}J1l(Z){return 2===Z?V.a.$Rh:1===Z||3===Z?V.a.dSh:V.a.ZRh}dHk(Z){void 0===this.ahd&&this.hnf.execute(async ea=>{this.ahd=await ea.isFeatureEnabled(L.a.HQi,!1);Z(this.ahd)});return!!this.ahd}}Object(D.a)(ba,"DesignerIntentProvider",Q.a,[])},1797:function(D,I,c){D=c(0);var l=c(504),e=c(463),a=c(11),k=c(1498),x=c(2068),y=c(354),m=c(7),t=c(112),z=c(1555);class v{constructor(K,
L,R){this.isVisible=K;this.elements=L;this.content=R}}Object(D.a)(v,"TooltipVisibilityArgs",null,[]);var H;(function(K){K[K.consistency=0]="consistency";K[K.Qpp=1]="pullQuote";K[K.ptp=2]="suggestedImage";K[K.Rpp=3]="pullQuoteMenu";K[K.shp=4]="designerPaste"})(H||(H={}));Object(D.b)("DesignerSuggestionType",H);var F=c(138),G=c(1722);c.d(I,"a",function(){return M});class M extends k.a{constructor(K,L,R,S,N,O,W,V){super();this.um=K;this.Dr=L;this.KZk=R;this.PPi=S;this.ij=N;this.hC=O;this.kI=W;this.rc=
V;this.hva=this.UFa=null;this.onMouseEnter=Q=>{Q=Q.Vo;this.hC.k7i(new v(!0,[Q.sHc],Q.XLo));if(Q.ps&&0<Q.ps.length){const Y=this.kI.CU(Q.ps[0]);Y&&Y.suggestion.L5m()}return this.cmj(Q)};this.wqa=Q=>{this.hC.k7i(new v(!1));return this.aFh(Q.Vo)};this.yHa=Q=>{if(M.R4a(Q.Vo,this.hva))return!0;this.hC.zOn(z.a.create(Q.Vo.ps[0]));return!0};this.vYf=(Q,Y)=>{Y.data?Y.data.isVisible?this.kho(Y.data.paragraphNode):this.qYk():m.ULS.shipAssertTag(573850384,3016,!1)};this.hC.u0e(this.vYf)}Ejo(K){K?(K=this.qrf(K))&&
this.cmj(K):m.ULS.shipAssertTag(589693324,3016,!1)}HYk(){this.aFh(this.UFa)}e8a(K){K=this.ij.al(K.Cb);return!!K&&this.kI.bYc(K)}R0a(K){const L=K.d0a(0,F.a.jLk,this.zoom),R=[];R.push(this.Gna(K.w5,L,K.qpc[0].y-K.L4[0].y));return R}Gna(K,L,R){var S,N=K.Fg.ownerDocument;const O=l.a.createElement(N,e.a.div);O.className=F.a.eLk;O.style.left=L+"px";O.style.top=R+"px";L=l.a.createElement(N,e.a.div);L.className=F.a.hLk;N=l.a.createElement(N,e.a.div);N.className=F.a.fLk;K=this.ij.al(K.Cb);R=this.kI.CU(K);
if(null===(S=null===R||void 0===R?void 0:R.suggestion)||void 0===S?0:S.Kq)N.className+=String.format(" {0}",H[R.suggestion.Kq]);L.appendChild(N);O.appendChild(L);O.id=M.T5h(K);S=this.qrf(K,O);1==S.kLk&&(N.className+=String.format(" {0}",F.a.gLk));this.hva&&this.hva.ps.includes(K)?(O.className+=String.format(" {0}",F.a.z4e),this.hva=S):this.UFa&&this.UFa.ps.includes(K)&&(O.className+=String.format(" {0}",F.a.y4e),this.UFa=S);this.PPi(a.a.WR,O,this.onMouseEnter,S);this.PPi(a.a.xL,O,this.wqa,S);this.KZk(a.a.click,
O,this.yHa,S);return O}kho(K){if(K){var L=this.qrf(K);L?(this.kI.CU(K)&&(K=Object.assign(new x.a,{action:0,type:3,HA:L,VJ:this.hva}),this.Dr.LF(K)),this.hva=L,M.R4a(this.UFa,this.hva)&&(this.UFa=null)):m.ULS.shipAssertTag(590112344,3016,!1)}else m.ULS.shipAssertTag(590112343,3016,!1)}qYk(){if(this.hva){var K=Object.assign(new x.a,{action:1,type:3,HA:null,VJ:this.hva});this.hva=null;this.Dr.LF(K)}}cmj(K){if(M.R4a(K,this.hva)||M.R4a(K,this.UFa))return!0;const L=Object.assign(new x.a,{action:2,type:3,
HA:K,VJ:this.UFa});this.UFa=K;this.Dr.LF(L);return!0}aFh(K){if(M.R4a(K,this.hva))return!0;K=Object.assign(new x.a,{action:3,type:3,HA:null,VJ:this.UFa});this.UFa=null;this.Dr.LF(K);return!0}qrf(K,L){L=L?L:this.pPl(K);if(!L)return null;const R=this.kI.CU(K);return new G.a(0<(null===R||void 0===R?void 0:R.sO.length)?null===R||void 0===R?void 0:R.sO:[K],L,M.Cji(R),M.qPl(R))}static Cji(K){if(!K)return WordEditorIntl.WordEditorStrings.L_ReviewDesignerSuggestion;switch(K.suggestion.Kq){case 0:return M.gZd(K.state)?
WordEditorIntl.WordEditorStrings.L_ReviewUpdatedDesignerFormattingSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerFormattingSuggestion;case 1:case 3:return M.gZd(K.state)?WordEditorIntl.WordEditorStrings.L_ReviewAddedDesignerPullQuoteSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerPullQuoteSuggestion;case 2:return M.gZd(K.state)?WordEditorIntl.WordEditorStrings.L_ReviewAddedDesignerText2ImageSuggestion:WordEditorIntl.WordEditorStrings.L_ReviewDesignerText2ImageSuggestion;default:return WordEditorIntl.WordEditorStrings.L_ReviewDesignerSuggestion}}static qPl(K){return K?
M.gZd(K.state)?1:0:0}static gZd(K){return 0!==K&&.1!==K}pPl(K){var L=null,R=this.um.Rf(K);R.zb(11)&&(R.uc(),R=R.currentNode.zj(this.rc.$b))&&(K=String.format("#{0}",M.T5h(K)),L=R.htmlElement.querySelector(K),!L&&Object(t.a)(y.a,R)&&(L=(L=R.FOd())?L.querySelector(K):null));return L}static T5h(K){return String.format("p{0}{1}",K.id.guid,K.id.n)}static R4a(K,L){return!!L&&!!K&&K.sHc===L.sHc}}Object(D.a)(M,"BlueDotActor",k.a,[343,330])},1798:function(D,I,c){D=c(0);var l=c(639);class e{constructor(k){this.oGa=
k.M1l();this.xHb=k.irf("intCopy");this.n$d=k.wei("intCopy");this.oCb=k.Wof("intCopy");this.tfb=k.wof("intCopy")}static mF(){return e.Xr()}static Xr(){return new e(l.a.instance)}}Object(D.a)(e,"InternalCopyUsageHelper",null,[]);c.d(I,"a",function(){return a});class a{constructor(k,x,y){this.fX=e.mF();this.cGd=null;this.RQb=this.Uoe=!1;this.hVg=null;this.source=k;this.target=x;this.N_f=y}get Kka(){return this.fX}get Ro(){return this.hVg}set Ro(k){this.hVg=k}}Object(D.a)(a,"InternalCopyArguments",null,
[])},1799:function(D,I,c){D=c(0);var l=c(1464);class e extends l.a{constructor(){super();this.LastAutoSaveErrorReported=0;this.LastAutoSaveCorrelation=null;this.MeritsErrorReport=!1;this.LocalCobaltMachineId=this.LocalCobaltSessionId=null;this.WaciiEnabledRequests=0;this.ShowMergePrompt=!1;this.PartMergeInfo=0}}Object(D.a)(e,"ALocalCobaltServerResponse",l.a,[]);c.d(I,"a",function(){return a});class a extends e{constructor(){super();this.RootCellId=null;this.AvailableFileAccess=0;this.PageHtml=this.ClientKnowledge=
this.LatestRevisionId=this.RevisionList=null;this.PinRevisionForAugLoopResponse=this.ContentBytes=0;this.RevisionIdPinnedForAugLoop=null;this.ScheduledShutdownTime=0;this.LastSavedToHostRevisionSequenceNumber=-1}}Object(D.a)(a,"GetChangesResponse",e,[])},1800:function(D,I,c){D=c(0);var l=c(81);class e extends Sys.EventArgs{constructor(){super()}}Object(D.a)(e,"UploadEventArgs",Sys.EventArgs,[]);c.d(I,"a",function(){return a});class a{constructor(){this.sa=new l.a}Hqg(k){this.sa.raiseEvent("UploadStarted",
new e(k,-1))}Voc(k,x){this.sa.raiseEvent("UploadComplete",new e(k,x))}static get instance(){return null!=a.WCg?a.WCg:a.WCg=new a}}Object(D.a)(a,"Box4UploadNotifier",null,[584])},1803:function(D,I,c){D=c(0);var l=c(31),e=c(1062);class a extends e.a{isUserPromptField(G){return new k(G)}annotationStatusField(G){return new x(G)}annotationCharCountField(G){return new y(G)}userPromptCharCountField(G){return new m(G)}precedingTextsCharCountField(G){return new t(G)}followingTextsCharCountField(G){return new z(G)}promptTriggerSourceField(G){return new v(G)}promptIdField(G){return new H(G)}}
Object(D.a)(a,"AiInserterDataFieldsFactoryImpl",e.a,[]);class k extends l.a{constructor(G){super();this.name="isUserPrompt";this.bool=G}}Object(D.a)(k,"IsUserPromptDataField",l.a,[]);class x extends l.a{constructor(G){super();this.name="annotationStatus";this.int64=G}}Object(D.a)(x,"AnnotationStatusDataField",l.a,[]);class y extends l.a{constructor(G){super();this.name="annotationCharCount";this.int64=G}}Object(D.a)(y,"AnnotationCharCountField",l.a,[]);class m extends l.a{constructor(G){super();this.name=
"userPromptCharCount";this.int64=G}}Object(D.a)(m,"UserPromptCharCountField",l.a,[]);class t extends l.a{constructor(G){super();this.name="precedingTextsCharCount";this.int64=G}}Object(D.a)(t,"PrecedingTextsCharCountField",l.a,[]);class z extends l.a{constructor(G){super();this.name="followingTextsCharCount";this.int64=G}}Object(D.a)(z,"FollowingTextsCharCountField",l.a,[]);class v extends l.a{constructor(G){super();this.name="promptTriggerSource";this.string=G}}Object(D.a)(v,"PromptTriggerSourceField",
l.a,[]);class H extends l.a{constructor(G){super();this.name="promptId";this.string=G}}Object(D.a)(H,"PromptIdField",l.a,[]);l=c(949);c.d(I,"a",function(){return F});class F extends l.a{constructor(G){super(G,"AiInsert");this.fieldsFactory=new a}}Object(D.a)(F,"AiInserterTelemetryLoggerImpl",l.a,[])},1833:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=
!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static D5h(e){switch(e){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(D.a)(l,"WopiAuthContext",null,[756])},1834:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}l.Awn="OneDriveWOPI";Object(D.a)(l,"HostApplicationType",null,[])},1835:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}l.eMj="WAC_Word";
l.ITc=null;Object(D.a)(l,"AddinHostApp",null,[])},1837:function(D,I){Object.defineProperty(I,"__esModule",{value:!0});I.RoleType=I.ErrorCode=void 0;(function(c){c[c.Success=0]="Success";c[c.DocumentTooLarge=1]="DocumentTooLarge"})(I.ErrorCode||(I.ErrorCode={}));(function(c){c[c.Unknown=0]="Unknown";c[c.Title=1]="Title";c[c.Subtitle=2]="Subtitle";c[c.Heading1=3]="Heading1";c[c.Heading2=4]="Heading2";c[c.Heading3=5]="Heading3";c[c.Heading4=6]="Heading4";c[c.Heading5=7]="Heading5";c[c.Heading6=8]="Heading6";
c[c.Heading7=9]="Heading7";c[c.Heading8=10]="Heading8";c[c.Heading9=11]="Heading9";c[c.ListItem=12]="ListItem";c[c.BodyText=13]="BodyText";c[c.ListHeader=14]="ListHeader";c[c.Caption=15]="Caption";c[c.CoverPageElement=16]="CoverPageElement"})(I.RoleType||(I.RoleType={}))},1838:function(D,I,c){Object.defineProperty(I,"__esModule",{value:!0});I.NavigationPaneInputClassifierSignal=I.DesignerInputClassifierSignal=I.DocumentRoleDetectionAnnotation=I.RoleDetectionAnnotation=I.RoleDetectionSettings=I.RoleDetectionCustomMetadata=
I.BasePartialDocumentLevelAnnotation=I.WordNavPaneInputTargetDocumentClassificationAnnotation=I.WordDesignerInputTargetDocumentClassificationAnnotation=I.BaseInputTargetDocumentClassificationAnnotation=void 0;const l=c(196);class e{constructor(F){l.SchemaObject.assign(e,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,
[e.getTypeName()])}}I.BaseInputTargetDocumentClassificationAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(F){l.SchemaObject.assign(a,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_WordDesignerInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation","AugLoop_Core_Annotation"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,
[a.getTypeName()])}}I.WordDesignerInputTargetDocumentClassificationAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class k{constructor(F){l.SchemaObject.assign(k,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_WordNavPaneInputTargetDocumentClassificationAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BaseInputTargetDocumentClassificationAnnotation","AugLoop_Core_Annotation"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,
[k.getTypeName()])}}I.WordNavPaneInputTargetDocumentClassificationAnnotation=k;k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class x{constructor(F){l.SchemaObject.assign(x,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_BasePartialDocumentLevelAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,[x.getTypeName()])}}I.BasePartialDocumentLevelAnnotation=x;x.H_=
{T_:x.getTypeName(),B_:x.getBaseTypes()};class y{constructor(F){l.SchemaObject.assign(y,this,F)}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionCustomMetadata"}static getBaseTypes(){return[]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,[y.getTypeName()])}}I.RoleDetectionCustomMetadata=y;y.H_={T_:y.getTypeName(),B_:y.getBaseTypes()};class m{constructor(F){l.SchemaObject.assign(m,this,F)}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionSettings"}static getBaseTypes(){return[]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,
[m.getTypeName()])}}I.RoleDetectionSettings=m;m.H_={T_:m.getTypeName(),B_:m.getBaseTypes()};class t{constructor(F){l.SchemaObject.assign(t,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_RoleDetectionAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,[t.getTypeName()])}}I.RoleDetectionAnnotation=t;t.H_={T_:t.getTypeName(),B_:t.getBaseTypes()};
class z{constructor(F){l.SchemaObject.assign(z,this,F)}get metadata(){return this.M_}set metadata(F){this.M_=F}static getTypeName(){return"AugLoop_RoleDetection_DocumentRoleDetectionAnnotation"}static getBaseTypes(){return["AugLoop_RoleDetection_BasePartialDocumentLevelAnnotation","AugLoop_Core_Annotation"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,[z.getTypeName()])}}I.DocumentRoleDetectionAnnotation=z;z.H_={T_:z.getTypeName(),B_:z.getBaseTypes()};class v{constructor(F){l.SchemaObject.assign(v,
this,F)}static getTypeName(){return"AugLoop_RoleDetection_DesignerInputClassifierSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,[v.getTypeName()])}}I.DesignerInputClassifierSignal=v;v.H_={T_:v.getTypeName(),B_:v.getBaseTypes()};class H{constructor(F){l.SchemaObject.assign(H,this,F)}static getTypeName(){return"AugLoop_RoleDetection_NavigationPaneInputClassifierSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(F){return l.SchemaObject.matchesTypesFor(F,
[H.getTypeName()])}}I.NavigationPaneInputClassifierSignal=H;H.H_={T_:H.getTypeName(),B_:H.getBaseTypes()}},1839:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e){this.extensions=e}}Object(D.a)(l,"ExtensionList",null,[])},1840:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(1798);class l extends c.a{constructor(e,a){super(e.source,e.target,e.N_f);this.yi=e;this.insertAfter=a}get Kka(){return this.yi.Kka}get Ro(){return this.yi.Ro}set Ro(e){this.yi.Ro=e}}Object(D.a)(l,
"CoreInternalCopyArguments",c.a,[])},1841:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e,a,k,x,y=null){this.source=e;this.target=a;this.insertAfter=k;this.UZf=x;this.Ro=y||{}}}Object(D.a)(l,"CoreInternalPasteArguments",null,[])},1842:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e,a="",k="",x="",y=!1){this.Email=this.DisplayName=this.Provider=this.UserId=null;this.IsCurrentUser=!1;this.UserId=e;this.Provider=a;this.DisplayName=k;this.Email=
x;this.IsCurrentUser=y}}Object(D.a)(l,"OfficeSharedCommentUser",null,[])},1843:function(D,I,c){c.d(I,"a",function(){return K});D=c(0);var l=c(54),e=c(1844),a=c(176),k=c(2),x=c(129),y=c(336),m=c(1398),t=c(775),z=c(539),v=c(1399),H=c(182),F=c(181),G=c(70),M=c(13);class K{constructor(L){this.Haa=this.Yh=this.I2=null;this.vD=0;this.AVb=this.Ala=this.Vb=null;this.kgh=!1;this.Kwe=null;this.IKh=!0;this.ga=L;this.Tb()}get Mda(){return this.I2}get model(){return this.Yh}get Vac(){return this.Haa}get eil(){return k.AFrameworkApplication.lro}get wKo(){return k.AFrameworkApplication.Zpj}get zkl(){return CommonUIStrings.l_DeleteCommentConfirm}get HFo(){return!1}get BA(){return!1}get sRi(){return!1}get pjj(){return!1}get zYh(){return this.Ala}set zYh(L){this.Ala=
L}get mode(){return this.vD}set mode(L){L!==this.vD&&(this.vD=L,-1!==this.vD&&(this.I2.O5a(),this.Yh.O5a(),0===this.vD&&this.iif()))}get MQb(){return this.kgh}set MQb(L){this.kgh=L}get Zda(){return!1}get Xrj(){return!0}dispose(){this.I2&&(this.I2.dispose(),this.I2=null);this.Yh&&(this.Yh.dispose(),this.Yh=null);this.Haa&&(this.Haa.dispose(),this.Haa=null);this.iif()}selectComment(L,R=1){const S=this.Yh.ZD(L);!S||2===this.mode&&1!==S.$q||(this.Yh.selectComment(S),this.Haa.highlightComment(S,!0),this.I2.selectComment(S,
R),1===R&&this.MQb&&this.Ala.selectComment(L))}P8c(){const L=this.Yh.P8c();L&&(this.Haa.highlightComment(L,!0),this.I2.selectComment(L),this.MQb&&this.Ala.selectComment(L.id))}Q8c(){const L=this.Yh.Q8c();L&&(this.Haa.highlightComment(L,!0),this.I2.selectComment(L),this.MQb&&this.Ala.selectComment(L.id))}Mfe(L){L?this.selectComment(L,0):this.I2.hRi&&this.hpf().hk.gz(this.I2.hRi)}clearSelection(){this.Yh.clearSelection();this.MQb&&this.Ala.selectComment(null);this.Haa.FYk()}paneClosing(){this.BA||(2===
this.vD?(this.clearSelection(),this.deleteComment(this.Yh.Qx)):this.clearSelection())}MAb(L){if(1===this.mode){L=e.a.lDb(L);var R=({anchor:S}=this.Haa.i9k()).returnValue;if(S&&0===R)this.addComment(L,S);else{switch(R){case 1:L=CommonUIStrings.l_NewCommentError;break;case 2:L=CommonUIStrings.l_NewCommentInvalidContent;break;default:L=CommonUIStrings.l_NewCommentError}var S=new F.StandardDialog;S.Cd=0;S.jka(CommonUIStrings.l_DefaultDialogTitle,L,null)}}}addComment(L){0!==this.mode&&(this.Yh.Urk(L),
0===L.$q||this.sRi||this.selectComment(L.id),this.ga.processAction(M.a.sHh,2))}editComment(L,R){1===this.mode&&L&&(this.Yh.LMc(L,R),this.selectComment(L.id))}S6e(){this.Yh.ITk()}addReply(L,R){1===this.mode&&(L=this.Yh.nLh(L,R),this.selectComment(L.id,0),this.ga.processAction(M.a.wHh,2))}deleteComment(L){if(1!==this.mode)if(2===this.mode){if(1!==L.$q)return;this.mode=1}else return;this.Xrj&&1!==L.$q?(this.AVb=L,L=new F.StandardDialog,L.Cd=4,L.BV(2),L.Hhg(CommonUIStrings.l_DefaultDialogTitle,this.zkl,
Object(l.a)(this,this.Hkl,"deleteDialogHandler"))):this.BLc(L)}Tb(){this.ga.fb(M.a.H1k,G.a.frame,x.ActionManager.Of,64);this.ga.fb(M.a.I1k,G.a.frame,x.ActionManager.Of,64);this.ga.fb(M.a.SGh,G.a.frame,x.ActionManager.Of,64);this.ga.ra(M.a.r9e,G.a.frame,x.ActionManager.Of);this.ga.ra(M.a.ZGh,G.a.frame,x.ActionManager.Of);this.ga.ra(M.a.$Gh,G.a.frame,x.ActionManager.Of);this.ga.fb(M.a.O1k,G.a.frame,x.ActionManager.Of,64);this.ga.fb(M.a.P1k,G.a.frame,x.ActionManager.Of,64);this.ga.ra(M.a.sHh,G.a.frame,
x.ActionManager.Of);this.ga.ra(M.a.tHh,G.a.frame,x.ActionManager.Of);this.ga.ra(M.a.wHh,G.a.frame,x.ActionManager.Of);this.ga.fb(M.a.F2k,G.a.frame,x.ActionManager.Of,64);this.ga.fb(M.a.H2k,G.a.frame,x.ActionManager.Of,64);this.ga.fb(M.a.G2k,G.a.frame,x.ActionManager.Of,64);this.ga.ra(M.a.yHh,G.a.frame,x.ActionManager.Of);this.ga.ra(M.a.Y5a,G.a.frame,()=>{this.Y5a();return 32})}Hkl(L){1===L?this.BLc(this.AVb):(this.AVb&&this.selectComment(this.AVb.id),this.AVb=null)}BLc(L){const R=L.Df;1===L.$q?this.ga.processAction(M.a.r9e,
2):this.ga.processAction(M.a.ZGh,2);this.AVb=null;this.MQb||this.clearSelection();L=this.Yh.deleteComment(L);for(let S=0;S<L.length;S++)L[S].dispose();this.Mfe(R)}iCb(L,R){0!==this.mode&&(this.ga.processAction(R?M.a.$Gh:M.a.yHh,2),this.Yh.iCb(L,R))}sva(L){this.Yh.sva(L);this.mode=1;this.ga.processAction(M.a.tHh,2)}lgb(L){this.Yh.lgb(L);this.mode=1}V2k(L,R){this.Yh.CTn(L,R)}VUc(){}iif(){}gRb(L,R,S,N,O){return this.I2.gRb(L,R,S,N,O)}LV(L,R,S,N,O){return this.I2.LV(L,R,S,N,O)}hpf(){var L=this.Vb.getRegion(a.AFrame.Ur);
if(!L){const R=this.Vb.fe(a.AFrame.Ur);L=new y.DOMFocusListing(()=>this.Mda.q3c);L.Ija=!0;L.Rm(3);L.Rm(2);L.Rm(4);L.Rm(1);L.Rm(6);L.Rm(5);this.Vb.ina(()=>this.Mda.q3c,R,L);L=this.Vb.getRegion(a.AFrame.Ur);L.ITa();L.BP=!0;L.A0a=!0;R.nr(this.Vb.WW);R.nr(this.Vb.XW)}return L}BBd(L,R){0!==this.mode&&this.Yh.BBd(L,R)}Ade(L,R){0!==this.mode&&this.Yh.Ade(L,R)}Y5a(){H.UISurfaces.LM().then(L=>{var R=Object.assign(new m.a,{target:this.pjj?'[data-unique-id*="ShowCommentsTopBar"]':'[data-unique-id~="ShowCommentsTopBar"]',
showCloseIcon:!0,content:CommonUIStrings.l_DeepLinkedCommentDoesNotExistNotification,calloutProps:Object.assign(new v.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});R=L.callout(R);const S=Object.assign(new z.a,{expirationOptions:Object.assign(new t.a,{displayTimeoutSeconds:10,onExpire:Object(l.a)(this,this.dismiss,"dismiss")})});this.Kwe=L.addNotification(R,S)})}dismiss(){H.UISurfaces.LM().then(L=>{L.removeNotification(this.Kwe);return this.Kwe=null})}static get instance(){return K._instance||
(K.factory?K._instance=K.factory():null)}static set instance(L){K._instance=L}}K._instance=null;K.factory=null;Object(D.a)(K,"CommentManager",null,[387,388,9])},1844:function(D,I,c){c.d(I,"a",function(){return a});D=c(0);var l=c(2),e=c(950);class a{constructor(){this.fj=null;this.fh=[];this._changes=[];this.Nbb=this.$_b=this.oz=null}get tt(){return this.oz}get Qx(){return this.Nbb}initialize(k){this.fj=k}dispose(){const k=this.fh.length;for(let x=0;x<k;x++)this.fh[x].dispose();this.fh=[]}O5a(){this.oz&&
this.oz.O5a();this.$_b&&this.$_b.O5a()}selectComment(k){this.clearSelection();k.Yja=1;this.oz=k;if(k.Df){var x=Array.indexOf(this.fh,k);for(--x;0<=x;x--){const y=this.fh[x];if(y.id===k.Df){y.Yja=2;this.$_b=y;break}}}l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Kb.Npa&&e.ShyRibbon.Tfb(1,0)}P8c(){if(!this.fh.length)return null;let k;k=this.oz?this.s7h(this.oz,!0):this.fh[0];this.selectComment(k);return k}Q8c(){if(!this.fh.length)return null;let k;k=this.oz?this.lSl(this.oz):this.fh[this.fh.length-
1];this.selectComment(k);return k}clearSelection(){this.oz&&(this.oz.Yja=0,this.oz=null);this.$_b&&(this.$_b.Yja=0,this.$_b=null)}LMc(k,x){this.fj.mode=3;k.$q=2;k.eUa=0;k.Bz=x;this.Nbb=k}ITk(){this.Nbb=null;this.fj.mode=1}nLh(k,x){var y=this.ZD(k);this.fj.mode=2;this.Nbb=k=c(1678).Comment.JLh(l.AFrameworkApplication.userName,k,y.Uli,x);for(x=this.fh.length-1;0<=x;x--)if(y=this.fh[x],y.Df===k.Df||y.id===k.Df){Array.insert(this.fh,x+1,k);break}return k}sva(k){this.zHh(k,2)}lgb(k){this.zHh(k,4)}deleteComment(k){const x=
[],y=Array.indexOf(this.fh,k);for(;y<this.fh.length;){const m=this.fh[y];if(m.id===k.id||m.Df===k.id)Array.removeAt(this.fh,y),Array.add(x,m);else break}this.b6c(x,3);-1<Array.indexOf(x,this.Nbb)&&(this.Nbb=null,this.fj.mode=1);return x}iCb(k,x){const y=[];let m=Array.indexOf(this.fh,k);for(;m<this.fh.length;){const t=this.fh[m];if(t.id===k.id||t.Df===k.id)t.done=x,Array.add(y,t),m++;else break}this.b6c(y,x?0:1)}bP(){return Array.clone(this.fh)}yac(){return!!this.fh&&!!this.fh.length}ZD(k){for(let x=
0;x<this.fh.length;x++){const y=this.fh[x];if(y.id===k)return y}return null}s7h(k,x){k=Array.indexOf(this.fh,k);return k===this.fh.length-1?x?this.fh[0]:null:this.fh[k+1]}tYl(k,x=!1){let y=k=Array.indexOf(this.fh,k);do if(y=y===this.fh.length-1?0:y+1,!x||!this.fh[y].done)return this.fh[y];while(y!==k);return this.fh[k]}lSl(k){return(k=Array.indexOf(this.fh,k))?this.fh[k-1]:this.fh[this.fh.length-1]}uYl(k,x=!1){let y=k=Array.indexOf(this.fh,k);do if(y=y?y-1:this.fh.length-1,!x||!this.fh[y].done)return this.fh[y];
while(y!==k);return this.fh[k]}BBd(){}Ade(){}zHh(k,x){const y=[];k.$q=0;Array.add(y,k);this.b6c(y,x);this.Nbb=null}static lDb(k){return c(1678).Comment.JLh(l.AFrameworkApplication.userName,null,c(1678).Comment.c0i,k)}}Object(D.a)(a,"CommentModel",null,[9,392])},1845:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}l.qJc="CommentPaneTextbox";l.wHd="CommentPane";l.N1k="CommentDeleteButton";l.E2k="CommentSaveButton";l.D2k="CommentReplyButton";l.L1k="CommentCancelButton";l.xHh="CommentTextEntry";
l.J2k="CommentTabHelp";Object(D.a)(l,"CommentManagerConstants",null,[])},1846:function(D,I,c){c.d(I,"a",function(){return k});D=c(0);var l=c(449),e=c(91),a=c(28);class k{dispose(){}static M0a(x,y,m,t=null,z=!0){var v=z?"":m;x=l.a("a",x,"StandardButton "+y);x.title=v;x.tabIndex=0;v=null;t?(v=e.createClusteredImage(16,16,t,"StandardButtonImage",!0,null),v.setAttribute(a.a.uh,a.a.wz),x.appendChild(v)):Sys.UI.DomElement.addCssClass(x,"StandardButtonNoImage");z?(t=l.a("span",null,"StandardButtonLabel"),
t.innerText=m,x.appendChild(t)):Sys.UI.DomElement.addCssClass(v,"StandardButtonImageNoText");x.setAttribute(a.a.uh,a.a.X3);return x}static fQb(x,y){void 0!==x&&null!==x&&(x.disabled=!y,y?(y=a.a.xM,Sys.UI.DomElement.removeCssClass(x,"DisabledButton"),Sys.UI.DomElement.removeCssClass(x,"cui-disabled")):(y=a.a.xp,Sys.UI.DomElement.containsCssClass(x,"DisabledButton")||Sys.UI.DomElement.addCssClass(x,"DisabledButton"),Sys.UI.DomElement.containsCssClass(x,"cui-disabled")||Sys.UI.DomElement.addCssClass(x,
"cui-disabled")),a.a.lr(x,a.a.c3e,y))}}Object(D.a)(k,"SimpleButtonFactory",null,[9])},1848:function(D,I,c){c.d(I,"a",function(){return v});D=c(0);var l=c(79),e=c(11),a=c(2),k=c(20),x=c(19),y=c(42),m=c(7),t=c(3),z=c(10);class v{constructor(H,F,G,M,K="@"){this.JQe=this.bqd=this.fFe=this.ge=null;this.L3g=this.$vb=this.Ola=this.qta=this.OMg=!1;this.Efa=0;this.Lgg=!1;this.XMb=()=>{this.reset()};this.jOa=L=>{this.Efa=L.Hb.keyCode;var R=L.Hb.rawEvent.key;R&&R!==this.Sna||(this.Lgg=!0);return this.Ola&&this.bqd?
L.Hb.keyCode===l.a.l2||L.Hb.keyCode===l.a.Ss||L.Hb.keyCode===l.a.Iw?(R=!1,L.Hb.keyCode===l.a.l2?(m.ULS.sendTraceTag(41178049,324,50,"@ mention People Picker dismissed via escape"),R=!0):L.Hb.keyCode===l.a.Ss?m.ULS.sendTraceTag(41178050,324,50,"@ mention People Picker enter pressed while picker is up"):L.Hb.keyCode===l.a.Iw&&m.ULS.sendTraceTag(51451662,324,50,"@ mention People Picker tab pressed while picker is up"),this.bqd(L),R&&this.reset(),!0):L.Hb.keyCode===l.a.Lea||L.Hb.keyCode===l.a.v6||L.Hb.keyCode===
l.a.m2||L.Hb.keyCode===l.a.n2||L.Hb.keyCode===l.a.u6||L.Hb.keyCode===l.a.QL?(this.bqd(L),!0):!1:!1};this.Ora=L=>{if(this.Lgg||this.Ola){this.Lgg=!1;var R=this.BRc(),S=this.kQc(L.Hb.target),N=L.Hb.rawEvent.inputType;return(void 0!==N&&null!==N||this.Efa!==l.a.qC&&this.Efa!==l.a.k2)&&"deleteContentBackward"!==N&&"deleteContentForward"!==N?this.Ymi(R,S,L.Hb.target):!1}};this.bKk=L=>{if(1!==L.Hb.rawEvent.key.length)return!1;const R=this.BRc(),S=this.kQc(L.Hb.target);return this.Ymi(R,S,L.Hb.target)};
this.XRa=L=>{if(!this.Ola)return!1;const R=this.BRc(),S=this.kQc(L.Hb.target);(L.Hb.keyCode===l.a.qC||L.Hb.keyCode===l.a.k2||(L.Hb.keyCode===l.a.iWa||L.Hb.keyCode===l.a.rqc)&&L.Hb.ctrlKey)&&this.pyf(R,S,L.Hb.target);return!1};this.T3e=(L,R)=>{this.Efa=R.BDf?l.a.qC:R.isDelete?l.a.k2:this.Efa;this.Ola&&(R.BDf?this.Snm(R.wFi):R.isDelete&&this.zom(R.wFi))};this.Ce=H;this.rk=F;this.orc=G;this.ld=M;this.Sna=K;this.reset()}qfb(H,F){this.qta||(this.qta=!0,H.zxa?this.rfb(F):H.sga(()=>{this.qta||this.rfb(F)}))}dispose(){this.$vb&&
(z.App.za.Dnc.sc(e.a.input,this.ld.xe.editingElement,this.Ora),this.$vb=!1);this.OMg&&(this.ge.sc(e.a.eEd,this.ld.xe.editingElement,this.bKk),this.OMg=!1);this.L3g&&(this.ge.sc(e.a.lG,this.ld.xe.editingElement,this.jOa),this.ge.sc(e.a.yh,this.ld.xe.editingElement,this.XRa));z.App.za.$da(this.XMb);this.gwj()}i7f(H){this.fFe=H}r7f(H){this.JQe=H}j7f(H){this.bqd=H}hKk(){this.Ola=!0;a.AFrameworkApplication.oe("ContextIQAtMentionEntryPoint-Treatment;ContextIQAtMentionEntryPoint-Control")}gwj(){this.Ola=
!1}eE(){return this.Ola}rfb(H){this.ge=H;if(!this.ld.yd)m.ULS.sendTraceTag(593376530,324,10,"SelectionView is null. AtMentions will not work in this session");else if(this.ld.yd.Zi){if(z.App.BHc&&k.a.Uke||k.a.Nt)z.App.za.Dnc.ob(e.a.input,this.ld.xe.editingElement,this.Ora,null),this.$vb=!0;this.ge&&(this.ge.ob(e.a.lG,this.ld.xe.editingElement,this.jOa),this.ge.ob(e.a.yh,this.ld.xe.editingElement,this.XRa),this.L3g=!0);this.orc.Uqh(this.T3e);z.App.za.E_(this.XMb)}}Ymi(H,F,G){if(1>F)return!1;H=H.replace(new RegExp(v.newLine,
"g"),"");const M=H.charAt(F-1);this.Ola&&M!==this.Sna?this.pyf(H,F,G):this.Ola||M!==this.Sna?this.Ola&&M===this.Sna&&m.ULS.sendTraceTag(41178052,324,50,"Tried to type @ while already in at mention mode"):this.fFe&&(this.reset(),this.HHn(F,H)&&(this.hKk(),this.pyf(H,F,G),m.ULS.sendTraceTag(41178051,324,50,"@ typed.  Beginning of paragraph?: {0}",1===F?"true":"false")));return this.Ola}reset(){this.qta=!1;this.gwj();this.JQe&&this.JQe()}kQc(H){return this.rk.r9b(2,H)}BRc(){return this.Ce.uw().innerText}HHn(H,
F){return 0>H-2||this.hVk(F.charAt(H-2))?!0:!1}hVk(H){return x.a.pda(H)||"("===H}pyf(H,F,G){if(!H||""===H||0>F)this.reset();else{const {mij:M,QDd:K}=this.yZm(H,F);this.fFe(M,G,K)}}yZm(H,F){const G=this.DOl(H,F);if(0<=G&&F<=H.length)return{mij:H.substring(G,F),QDd:G};this.reset();return{mij:"",QDd:G}}DOl(H,F){let G=-1,M=F;for(M;0<=M&&63>=F-M;M--)if(H.charAt(M)===this.Sna){G=M;break}63<F-M&&-1==G&&y.c(t.a.ZQo,!0,void 0,void 0,void 0,void 0);return G}Snm(H){H=this.kQc(H.Hb.target);H=this.BRc().charAt(H-
1);this.Ola&&H===this.Sna&&this.reset()}zom(H){H=this.kQc(H.Hb.target);H=this.BRc().charAt(H);this.Ola&&H===this.Sna&&this.reset()}}v.newLine="\n";Object(D.a)(v,"AtMentionsListener",null,[12])},1849:function(D,I,c){c.d(I,"a",function(){return z});D=c(0);var l=c(7),e=c(78),a=c(771),k=c(124),x=c(8),y=c(351),m=c(1850);class t{constructor(v,H){this.ETc=v;this.WVc=H}m9h(){return this.WVc?this.ETc.Ec:this.ETc.end}jio(v){this.WVc?this.ETc.Ec=v:this.ETc.end=v}czi(v,H){const F=this.m9h()+(this.WVc?0:-1);return F>=
v&&F<H}}Object(D.a)(t,"HitRangeEdge",null,[]);class z{get Zc(){return null}get rj(){return null}get Fpa(){return!1}get aEf(){return!1}x_e(){}w5d(){return!1}hog(){return!1}Y9h(v){return e.f(v,()=>!1)}tFa(){return null}O4d(v,H,F,G,M){H=H||[];F=F||[];const K=[];let L=0,R=0,S=0;for(;L<H.length||R<F.length;){const N=L<H.length&&R<F.length?H[L].Ec<F[R].Ec?H[L++]:F[R++]:L<H.length?H[L++]:F[R++];K[S]=m.a.createInstance(N.Ec,N.end,v,S,G,M);++S}return K}$_l(v,H){if(!H)return null;if(!x.ParagraphReader.WIh(v))return this.Njb(v.characterData,
H);const F=this.Nkm(v,k.AParagraphNode.yOc);v=this.Rkm(v,F);H=this.Njb(v,H);if(!H)return H;H=this.GEn(H);this.gZn(H,F);return H=this.gDl(H,F)}Nkm(v,H){H=Object(y.c)(H);const F=Object(y.a)(H);return[...x.ParagraphReader.MRc(v)].map(G=>{G.isVisible=F(G);return G})}Rkm(v,H){H=H.filter(F=>F.isVisible);return x.ParagraphReader.TUd(v,H)}GEn(v){const H=[];for(const F of v)H.push(new t(F,!0)),H.push(new t(F,!1));return H}gZn(v,H){if(0!==v.length){var F=0,G=0;for(const M of H){if(F>=v.length)break;if(M.isVisible)for(;F<
v.length;){H=v[F];if(!H.czi(M.d4.cp-G,M.cpEnd-G))break;H.jio(H.m9h()+G);F++}else G+=M.cpEnd-M.d4.cp}}}gDl(v,H){if(0===v.length)return[];const F=[];let G=0,M=!1;for(const K of H){if(G>=v.length)break;if(K.isVisible)for(;G<v.length;){H=v[G];if(!H.czi(K.d4.cp,K.cpEnd))break;H.WVc?M=!0:!H.WVc&&M&&(F.push(H.ETc),M=!1);G++}else M=!1}return F}TBi(){return!1}cCi(){return!1}Njb(v,H){if(H&&v){let F;const G=[];try{for(;F=H.exec(v);){const M=new a.a(F.index,H.lastIndex);G.push(M)}return G}catch(M){l.ULS.sendTraceTag(522846819,
313,15,M instanceof SyntaxError?"Invalid regular expression":`errorName: ${M.name}`)}}return null}mde(){}}Object(D.a)(z,"BaseFindManagerHelper",null,[549])},1850:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e,a,k,x,y,m,t){this.id=++l.Ihk;this.PMg=e;this.Wab=a;this.C8g=k;this.$Yg=x;this.fk=y;this.c0g=m;this.np=t;this.next=this.previous=null}get Ec(){return this.PMg}get end(){return this.Wab}get type(){return this.fk}Pdi(){return this.np.tFa(this.nodeId)}get nodeId(){return this.C8g}get IQa(){return this.$Yg}get WYd(){return this.c0g}d8k(e){this.PMg=
e.Ec;this.Wab=e.end;this.C8g=e.nodeId;this.$Yg=e.IQa;this.fk=e.type;this.c0g=e.WYd}static createInstance(e,a,k,x,y,m){const {FindManagerHelper:t}=c(1565);return new l(e,a,k,x,y,m,t.instance)}}l.Ihk=0;Object(D.a)(l,"FindResult",null,[571])},1851:function(D,I,c){c.d(I,"a",function(){return e});D=c(0);var l=c(2);c=c(81);class e{static Mxk(a){e.fwg.addHandler(e.EGh,a)}static TNn(a){l.AFrameworkApplication.K.$("SqmCommandEventSourceEnabled")&&e.fwg.raiseEvent(e.EGh,a)}}e.EGh="CommandClickEvent";e.fwg=
new c.a;Object(D.a)(e,"CommandClickEvents",null,[])},1852:function(D,I){Object.defineProperty(I,"__esModule",{value:!0});I.ErrorCode=I.FormattingSuggestionsRange=I.FormattingSuggestionType=void 0;(function(c){c[c.FontSize=0]="FontSize";c[c.FontFamily=1]="FontFamily";c[c.FontColor=2]="FontColor";c[c.Alignment=3]="Alignment";c[c.Indentation=4]="Indentation";c[c.Bold=5]="Bold";c[c.RightIndentation=6]="RightIndentation";c[c.Italic=7]="Italic";c[c.Underline=8]="Underline";c[c.AllCaps=9]="AllCaps";c[c.LineSpacing=
10]="LineSpacing";c[c.BeforeSpacing=11]="BeforeSpacing";c[c.AfterSpacing=12]="AfterSpacing";c[c.SpecialIndentType=13]="SpecialIndentType";c[c.SpecialIndentBy=14]="SpecialIndentBy";c[c.FontKerning=15]="FontKerning"})(I.FormattingSuggestionType||(I.FormattingSuggestionType={}));(function(c){c[c.Paragraph=0]="Paragraph";c[c.List=1]="List"})(I.FormattingSuggestionsRange||(I.FormattingSuggestionsRange={}));(function(c){c[c.Success=0]="Success";c[c.DocumentTooLarge=1]="DocumentTooLarge"})(I.ErrorCode||
(I.ErrorCode={}))},1853:function(D,I,c){Object.defineProperty(I,"__esModule",{value:!0});I.FormattingSuggestionsSummaryAnnotation=I.FormattingSuggestionsAnnotation=void 0;const l=c(196);class e{constructor(k){l.SchemaObject.assign(e,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_ConsistencyChecker_FormattingSuggestionsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,
[e.getTypeName()])}}I.FormattingSuggestionsAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_ConsistencyChecker_FormattingSuggestionsSummaryAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}I.FormattingSuggestionsSummaryAnnotation=a;a.H_={T_:a.getTypeName(),
B_:a.getBaseTypes()}},1854:function(D,I){Object.defineProperty(I,"__esModule",{value:!0})},1855:function(D,I,c){Object.defineProperty(I,"__esModule",{value:!0});I.PullQuotesSignal=I.DocumentPullQuoteAnnotation=I.PullQuoteAnnotation=void 0;const l=c(196);class e{constructor(x){l.SchemaObject.assign(e,this,x)}get metadata(){return this.M_}set metadata(x){this.M_=x}static getTypeName(){return"AugLoop_PullQuotes_PullQuoteAnnotation"}static getBaseTypes(){return["AugLoop_Text_RangeAnnotation","AugLoop_Core_Annotation"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,
[e.getTypeName()])}}I.PullQuoteAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(x){l.SchemaObject.assign(a,this,x)}get metadata(){return this.M_}set metadata(x){this.M_=x}static getTypeName(){return"AugLoop_PullQuotes_DocumentPullQuoteAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,[a.getTypeName()])}}I.DocumentPullQuoteAnnotation=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class k{constructor(x){l.SchemaObject.assign(k,
this,x)}static getTypeName(){return"AugLoop_PullQuotes_PullQuotesSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,[k.getTypeName()])}}I.PullQuotesSignal=k;k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()}},1856:function(D,I){Object.defineProperty(I,"__esModule",{value:!0})},1857:function(D,I){Object.defineProperty(I,"__esModule",{value:!0})},1858:function(D,I){Object.defineProperty(I,"__esModule",{value:!0})},1859:function(D,I,
c){Object.defineProperty(I,"__esModule",{value:!0});I.TextToImageAnnotation=void 0;var l=c(196);D=function(){function e(a){l.SchemaObject.assign(e,this,a)}Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(a){this.M_=a},enumerable:!1,configurable:!0});e.getTypeName=function(){return"AugLoop_TextToImage_TextToImageAnnotation"};e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]};e.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])};
e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};return e}();I.TextToImageAnnotation=D},1860:function(D,I,c){Object.defineProperty(I,"__esModule",{value:!0});I.TextToImageSignal=void 0;var l=c(196);D=function(){function e(a){l.SchemaObject.assign(e,this,a)}e.getTypeName=function(){return"AugLoop_TextToImage_TextToImageSignal"};e.getBaseTypes=function(){return["AugLoop_TextToSuggestions_TextToSuggestionSignal","AugLoop_Signals_Signal"]};e.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,
[e.getTypeName()])};e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};return e}();I.TextToImageSignal=D},1861:function(D,I,c){Object.defineProperty(I,"__esModule",{value:!0});I.TextToImageTraceSignal=void 0;var l=c(196);D=function(){function e(a){l.SchemaObject.assign(e,this,a)}e.getTypeName=function(){return"AugLoop_TextToImage_TextToImageTraceSignal"};e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]};e.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])};e.H_=
{T_:e.getTypeName(),B_:e.getBaseTypes()};return e}();I.TextToImageTraceSignal=D},1862:function(D,I){Object.defineProperty(I,"__esModule",{value:!0})},1863:function(D,I,c){Object.defineProperty(I,"__esModule",{value:!0});I.ThemeExtractorSignal=I.ThemeExtractorAnnotation=void 0;const l=c(196);class e{constructor(k){l.SchemaObject.assign(e,this,k)}get metadata(){return this.M_}set metadata(k){this.M_=k}static getTypeName(){return"AugLoop_ThemeExtractor_ThemeExtractorAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,
[e.getTypeName()])}}I.ThemeExtractorAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(k){l.SchemaObject.assign(a,this,k)}static getTypeName(){return"AugLoop_ThemeExtractor_ThemeExtractorSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(k){return l.SchemaObject.matchesTypesFor(k,[a.getTypeName()])}}I.ThemeExtractorSignal=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()}},1864:function(D,I){Object.defineProperty(I,"__esModule",{value:!0});I.TableType=
void 0;D=I.TableType||(I.TableType={});D[D.Other=0]="Other";D[D.SimpleHeaded=1]="SimpleHeaded"},1865:function(D,I,c){Object.defineProperty(I,"__esModule",{value:!0});I.TableTypeAnnotation=void 0;const l=c(196);class e{constructor(a){l.SchemaObject.assign(e,this,a)}get metadata(){return this.M_}set metadata(a){this.M_=a}static getTypeName(){return"AugLoop_TableAnalysis_TableTypeAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,
[e.getTypeName()])}}I.TableTypeAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1866:function(D,I,c){c.d(I,"a",function(){return v});D=c(0);c(1581);var l=c(1641),e=c(2),a=c(19);c(1566);c(34);var k=c(7),x=c(1427),y=c(10),m=c(17),t=c(124),z=c(8);class v{constructor(H=2E3){this.gok=/(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)?/g;this.ycb=H}JKm(){v.tU();return!0}nXm(){return!0}getSelectedText(){const H=v.tU();return this.qUd(H)}wuf(){const H=
v.tU();return this.Fdm(H)}qUd(H){return this.ahi(H,!0)}Fdm(H){return this.ahi(H,!1)}ahi(H,F){try{return this.Edm(H,F)}catch(G){k.ULS.sendTraceTag(545869845,1303,15,"Error accessing selection: {0}",G)}return Object.assign(new l.a,{neighborhood:"",mentionStart:0,mentionLength:0})}Edm(H,F){var G=null;let M=!1;F&&H&&H.Yw&&m.SelectionEditor.Ze(H.Pa)&&m.SelectionEditor.Llb(H.Pa)&&(k.ULS.sendTraceTag(17944729,1303,50,"Selection was an insertion point, expanding to word"),M=m.SelectionEditor.Ze(H.Pa),(G=
m.SelectionEditor.j0(H.Pa,!1))&&G.Yw&&0<=G.Pa.cpBegin&&0<=G.Pa.cpEnd&&1>=G.Pa.cpEnd-G.Pa.cpBegin&&(G=null));G&&(H=G);if(!H)return Object.assign(new l.a,{neighborhood:"",mentionStart:0,mentionLength:0});const K=new Sys.StringBuilder;G=F=0;const L=[],R=H.length;let S=null;for(let V=0;V<R;V++){var N=H.J(V);if(!z.ParagraphReader.Xb(N.node)||Array.contains(L,N.node.Vk))continue;L.push(N.node.Vk);const Q=x.a.create(N.cpBegin,N.cpEnd),Y=z.ParagraphReader.fib(N.node,t.AParagraphNode.yOc,null,Q);e.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartLookupUrlExtIsEnabled",
!1)&&M&&(S=this.UAl(Y,Q.Bd));let ba=Y,Z=0;var O=z.ParagraphReader.Xf(N.node,!0,!0,!0);N=z.ParagraphReader.Xf(N.node,!1,!0,!0);let ea=0;for(;ba.length<this.ycb&&(O||N);){if(!(ea%2)&&O){var W=z.ParagraphReader.text(O,t.AParagraphNode.yOc);W&&(ba=W+" "+ba,Z+=W.length+1);O=z.ParagraphReader.Xf(O,!0,!0,!0)}1===ea%2&&N&&(ba=(W=z.ParagraphReader.text(N,t.AParagraphNode.yOc))?ba+" "+W:ba,N=z.ParagraphReader.Xf(N,!1,!0,!0));ea++}O=V===R-1;V||-1===Q.Bd||(F=Q.Bd);G+=O&&-1!==Q.endCp?Q.endCp:Y.length;K.append(ba);
e.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartLookupUrlExtIsEnabled",!1)&&M&&S&&(F=S.start,G=S.start+S.length);F+=Z;G+=Z;O||(K.append(" "),G++)}for(H=t.AParagraphNode.UP(K.toString()," ");F<G&&a.a.Qv(H.charCodeAt(F));)F++;for(;G>F&&a.a.Qv(H.charCodeAt(G-1));)G--;return this.OAk(H,F,G)}UAl(H,F){for(var G;null!==(G=this.gok.exec(H));){const M=G.index;G=G[0].length;if(F>=M&&F<=M+G)return{start:M,length:G}}return null}OAk(H,F,G){if(H.length>this.ycb){var M=G-F;if(M>
this.ycb)H=H.substr(F,this.ycb),G=this.ycb,F=0;else{M=Math.max(F-Math.floor((this.ycb-M)/2),0);let K;K=Math.min(M+this.ycb,H.length);M=Math.max(K-this.ycb,0);F-=M;G-=M;H=H.substring(M,K)}}return Object.assign(new l.a,{neighborhood:H,mentionStart:F,mentionLength:G-F})}static tU(){var H=y.App.za.jb.rc;if(!H)return k.ULS.sendTraceTag(38548897,1303,50,"ContentView is null"),null;H=H.mb;return H&&H.ib&&H.ib.length?H.ib.lb:(k.ULS.sendTraceTag(38548898,1303,50,"SelectionManager or selectionCollection is null"),
null)}}Object(D.a)(v,"Box4InsightsSelection",null,[518,519])},1867:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(404);class l extends c.a{constructor(){super();this.LargePreviewIconStyle=this.PreviewIconStyle=this.FullIconStyle=this.Icon=null}get Type(){return 4}}Object(D.a)(l,"IconGalleryButtonProps",c.a,[])},1868:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.y=this.x=0}}Object(D.a)(l,"IPoint",null,[])},1869:function(D,I,c){c.d(I,"a",function(){return a});
D=c(0);var l=c(19),e=c(7);c=c(1601);class a extends c.a{constructor(k,x,y,m,t){super(k,x,t);this.lk=y;this.Rgh=t}voc(k){let x;if(this.xT&&!k)return e.ULS.sendTraceTag(594408835,307,10,"No htmlDomContent"),{returnValue:!1,Yva:null};if(this.Rgh){if(this.lk)return x=this.lk.e0f(k,!1),{returnValue:!0,Yva:x};e.ULS.sendTraceTag(592269661,307,10,"_clipboardDataHelper should not be null")}x=document.createElement("div");k=k.split(RegExp("\r\n|\r|\n"));for(var y=0;y<k.length-1;y++){const m=document.createElement("p");
m.innerText=this.$Zc(k[y]);x.appendChild(m)}y=document.createElement("span");y.innerText=l.a.eNc(k[k.length-1]);x.appendChild(y);return{returnValue:!0,Yva:x}}$Zc(k){return l.a.eNc(k.length?k:" ")}}Object(D.a)(a,"MultiLineTextImportStrategy",c.a,[])},1870:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(868);class l extends c.a{constructor(e,a,k,x,y=null,m=0,t=0,z=null,v=null,H=null,F=null){super(y?y.f$:null,y?y.LB:null,y?y.Kya:null,y?y.cultureName:null,y?y.YCa:null);this.src=e;this.alt=
a;this.width=k;this.height=x;this.maxWidth=m;this.maxHeight=t;this.href=z;this.Pll=v;this.ckf=H;this.EGd=F}}Object(D.a)(l,"ImageSemanticArgs",c.a,[])},1871:function(D,I,c){c.d(I,"a",function(){return e});D=c(0);var l=c(113);class e{constructor(){this.Desc=this.Alt=this.Src=this.ImageId=null;this.ImageAnchorId=this.LockId=this.Height=this.Width=0;this.IsImageFromPaste=!1;this.EditContainerWidth=0;this.LocalizedPicture=null;this.IsLayoutSizeSetByUser=!1;this.ClipServiceArgs=this.WordId=this.RunId=this.ContentNodes=
null}static construct(a,k,x,y,m,t,z,v,H,F,G,M,K,L,R,S=null){const N=new e;N.ImageId=a;N.Src=k;N.Alt=x;N.Width=y;N.Height=m;N.Desc=t;N.LockId=z;N.ImageAnchorId=v;N.IsImageFromPaste=H;N.EditContainerWidth=F;N.LocalizedPicture=G;N.IsLayoutSizeSetByUser=M;if(K&&0<K.length){N.ContentNodes=Array(K.length);a=0;for(const O of K)N.ContentNodes[a]=l.a(O),a++}N.RunId=L;N.WordId=R;N.ClipServiceArgs=S;return N}}Object(D.a)(e,"PastedPicture",null,[])},1872:function(D,I,c){c.d(I,"a",function(){return a});D=c(0);
var l=c(22);I=c(592);var e=c(530);class a extends I.a{constructor(){super();this.DataUriPictures=!1;this.FileId=this.PastedPictures=null;this.InkExternalPartFileFormatFixIsEnabled=this.PictureEditingInIllustrationCanvasIsEnabled=this.InkEditingInCanvasSupportedIsEnabled=this.ChartsPasteFromXLOIsEnabled=this.ClipServicePictures=!1}nl(){return e.a.picturePaste}static construct(k,x,y=null,m=!1){const t=new a;t.DataUriPictures=x;t.PastedPictures=k;(k=l.a.instance.Oa("Box4.IFeatureHelper"))&&k.isFeatureEnabled(10)&&
k.isFeatureEnabled(50)&&(t.ClipServicePictures=m,t.ChartsPasteFromXLOIsEnabled=!0,t.InkEditingInCanvasSupportedIsEnabled=!0,t.PictureEditingInIllustrationCanvasIsEnabled=!0,t.InkExternalPartFileFormatFixIsEnabled=!0);y&&y.length&&(t.FileId=y);return t}}Object(D.a)(a,"PicturePasteRequest",I.a,[])},1873:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e,a,k,x=!1){this.vFb=e;this.vFi=a;this.CSk=k;this.dZm=x}}Object(D.a)(l,"ClearSpecificFormattingProperties",null,[])},1876:function(D,
I){Object.defineProperty(I,"__esModule",{value:!0})},1877:function(D,I){Object.defineProperty(I,"__esModule",{value:!0});I.SuggestionCategory=void 0;D=I.SuggestionCategory||(I.SuggestionCategory={});D[D.TextRelatedImage=0]="TextRelatedImage";D[D.AbstractImage=1]="AbstractImage";D[D.Icon=2]="Icon"},1878:function(D,I){Object.defineProperty(I,"__esModule",{value:!0})},1879:function(D,I){Object.defineProperty(I,"__esModule",{value:!0})},1880:function(D,I,c){Object.defineProperty(I,"__esModule",{value:!0});
I.TextToSuggestionSignal=void 0;var l=c(196);D=function(){function e(a){l.SchemaObject.assign(e,this,a)}e.getTypeName=function(){return"AugLoop_TextToSuggestions_TextToSuggestionSignal"};e.getBaseTypes=function(){return["AugLoop_Signals_Signal"]};e.typeGuard=function(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])};e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};return e}();I.TextToSuggestionSignal=D},1881:function(D,I,c){c.d(I,"a",function(){return y});D=c(0);var l=c(93),e=c(194),a=c(7),
k=c(112),x=c(57);class y{constructor(m,t,z,v,H,F,G,M,K){this.GAd=0;this.JW=null;this.Aeb="";this.ZXb=this.xBe=!1;this.xLa=this.S7=null;this.x9f=!1;this.fXb=null;this.KCo=L=>{this.xLa===L&&(this.xLa=null,this.S7?this.Aeb=this.Tfa.p4c(this.JW.text):(this.AVf(),this.findInternal(null)),this.pvj())};this.findInternal=()=>{this.S7=null;if(!this.U6e())if(!this.Tfa.sNb(this.Aeb).length)this.Lfb(),this.lqb(!0);else if(!this.B$f())switch(this._state){case 0:this.k4o();break;case 1:this.$7i()}};this.hbb=m;
this.Tfa=t;this.a3j=z;this.np=v;this.zJe=H;this.Myb=F;this.i3j=G;this.gXb=M;this.Sj=K;this._state=2;this.aM=0}get Zrg(){return this.GAd}set Zrg(m){this.GAd=m}get wpc(){return this.GAd}set wpc(m){this.GAd=m}get taskManager(){return this.zJe.value}get fPb(){return this.Myb.value}get R7c(){return this.i3j.value}get CDl(){return this.xBe}lqb(m){(this.xBe=m)&&this.hbb&&this.hbb.z8b()}get ilf(){return null}get uOc(){return this.fXb}find(m){this.JW=m;this.dZk();this.xLa=new l.a(2,1,this.Zrg,this.KCo,51);
this.taskManager.Wb(this.xLa)}g0a(){}A$f(){}sli(){}xli(){}boi(){return!1}dZk(){this.S7&&(this.taskManager.ff(this.S7),this.S7=null);this.xLa&&(this.taskManager.ff(this.xLa),this.xLa=null)}k4o(){var m=(new Date).getTime();this.bUi();const t=this.l4o(m);this._state||(this.S7=new l.a(2,1,this.wpc,this.findInternal,52),this.taskManager.Wb(this.S7));m=(new Date).getTime()-m;a.ULS.sendTraceTag(17306246,313,50,"{0}",{["Extension Walk Time"]:m,["Count"]:t})}axf(m,t,z=!0){this.FDh(m);if(Object(k.a)(64,m))if(12===
m.type)this.enm(m,t,this.ZXb,z);else{const v=this.np.Njb(m.tFa(),this.uOc);z&&(v&&0<v.length?this.qUa(m,v):m.pna());z=this.np.O4d(m.id,v,null,t,this.ZXb);this.ZBd(m.id,z,m,t);this.$Of(m)}}enm(m,t,z,v=!0){const H=[];var F=this.np.Y9h(m);if(!e.a.af(F)&&(this.$Of(m),v))for(var G of F)F=this.np.Njb(G.tFa(),this.uOc),e.a.af(F)?this.pna(G):(this.qUa(G,F),H.push(F));G=x.a.Xj?this.np.$_l(m,this.uOc):this.np.Njb(m.tFa(),this.uOc);this.pna(m);!e.a.af(G)&&v&&this.qUa(m,G);z=this.np.O4d(m.id,G,H,t,z);this.ZBd(m.id,
z,m,t)}l4o(m){let t=this._state=0;const z=this.Qhi();this.I3i();const v=this.ooj();do this.rZf(),t++;while(this.X9e(z)&&(new Date).getTime()-m<y.jOi);v&&v.dispose();this.kVf();return t}AVf(){}pvj(){}U6e(){return!1}Lfb(){}B$f(){return!1}$7i(){}bUi(){}FDh(){}qUa(){}pna(){}$Of(){}ZBd(){}kVf(){}Qhi(){return null}I3i(){}ooj(){return null}rZf(){}X9e(){return!1}}y.jOi=200;Object(D.a)(y,"BaseFindManager",null,[1342])},1882:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e,a,k){this.rootNode=
e;this.oka=a;this.F8b=k}}Object(D.a)(l,"FindNodeContext",null,[])},1888:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e,a=null,k=null,x=null){this.iconSet={};this.iconSet["default"]=e;this.iconSet.icon16=a;this.iconSet.icon24=k;this.iconSet.icon32=x}}Object(D.a)(l,"IconSetContainer",null,[])},1891:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(457);class l extends c.a{constructor(){super()}}l.daf="conversionRequestType";l.l1f="png";l.knf="gc2json";l.strict=
"strict";l.yzl="existingcontent";l.error="error";Object(D.a)(l,"GraphicsEditorParameters",c.a,[])},1904:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e){this.qtb=0;this.Ird=isFinite(e)?Math.max(e,8):8;this.pp=Array(this.Ird);this.ak=this.Eeb=this.cZa=0;this.LQg=this.k8h(this.Ird)}get count(){return this.ak}get isEmpty(){return!this.count}enqueue(e){this.count===this.qtb&&this.tym();this.pp[this.Eeb]=e;this.Eeb++;this.Eeb===this.qtb&&(this.Eeb=0);this.ak=this.count+1}dequeue(){if(!this.count)throw Error.create("Empty Queue");
const e=this.pp[this.cZa];this.cZa++;this.cZa===this.qtb&&(this.cZa=0);this.ak=this.count-1;this.count<=this.LQg&&this.ril();return e}$Y(){if(!this.count)throw Error.create("Empty Queue");return this.pp[this.cZa]}tym(){this.Pmj(2*this.qtb)}ril(){const e=Math.max(this.qtb/2,this.Ird);this.count>e||this.Pmj(e)}Pmj(e){const a=Array(e);let k=0;if(this.cZa<this.Eeb||!this.count)for(var x=this.cZa;x<this.Eeb;x++)a[k]=this.pp[x],k++;else{for(x=this.cZa;x<this.qtb;x++)a[k]=this.pp[x],k++;for(x=0;x<this.Eeb;x++)a[k]=
this.pp[x],k++}this.pp=a;this.qtb=e;this.cZa=0;this.Eeb=k;this.LQg=this.k8h(e)}k8h(e){return e<=this.Ird?-1:Math.floor(.25*e)}}Object(D.a)(l,"Queue",null,[])},1971:function(D,I){Object.defineProperty(I,"__esModule",{value:!0})},1972:function(D,I,c){Object.defineProperty(I,"__esModule",{value:!0});I.AiInsertStreamCompletedAnnotation=I.AiInsertStreamChunkAnnotation=I.AiInsertAnnotationV2=I.AiInsertAnnotation=void 0;const l=c(196);class e{constructor(y){l.SchemaObject.assign(e,this,y)}get metadata(){return this.M_}set metadata(y){this.M_=
y}static getTypeName(){return"AugLoop_AiInsert_AiInsertAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(y){return l.SchemaObject.matchesTypesFor(y,[e.getTypeName()])}}I.AiInsertAnnotation=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(y){l.SchemaObject.assign(a,this,y)}get metadata(){return this.M_}set metadata(y){this.M_=y}static getTypeName(){return"AugLoop_AiInsert_AiInsertAnnotationV2"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(y){return l.SchemaObject.matchesTypesFor(y,
[a.getTypeName()])}}I.AiInsertAnnotationV2=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class k{constructor(y){l.SchemaObject.assign(k,this,y)}get metadata(){return this.M_}set metadata(y){this.M_=y}static getTypeName(){return"AugLoop_AiInsert_AiInsertStreamChunkAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(y){return l.SchemaObject.matchesTypesFor(y,[k.getTypeName()])}}I.AiInsertStreamChunkAnnotation=k;k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()};class x{constructor(y){l.SchemaObject.assign(x,
this,y)}get metadata(){return this.M_}set metadata(y){this.M_=y}static getTypeName(){return"AugLoop_AiInsert_AiInsertStreamCompletedAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(y){return l.SchemaObject.matchesTypesFor(y,[x.getTypeName()])}}I.AiInsertStreamCompletedAnnotation=x;x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()}},1973:function(D,I){Object.defineProperty(I,"__esModule",{value:!0});I.CountLimitType=void 0;D=I.CountLimitType||(I.CountLimitType={});D[D.character=
0]="character";D[D.word=1]="word";D[D.sentence=2]="sentence";D[D.paragraphs=3]="paragraphs"},1974:function(D,I,c){Object.defineProperty(I,"__esModule",{value:!0});I.LimitCount=I.AiInsertSignalV2=I.AiInsertSignal=void 0;const l=c(196);class e{constructor(x){l.SchemaObject.assign(e,this,x)}static getTypeName(){return"AugLoop_AiInsert_AiInsertSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,[e.getTypeName()])}}I.AiInsertSignal=
e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()};class a{constructor(x){l.SchemaObject.assign(a,this,x)}static getTypeName(){return"AugLoop_AiInsert_AiInsertSignalV2"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,[a.getTypeName()])}}I.AiInsertSignalV2=a;a.H_={T_:a.getTypeName(),B_:a.getBaseTypes()};class k{constructor(x){l.SchemaObject.assign(k,this,x)}static getTypeName(){return"AugLoop_AiInsert_LimitCount"}static getBaseTypes(){return[]}static typeGuard(x){return l.SchemaObject.matchesTypesFor(x,
[k.getTypeName()])}}I.LimitCount=k;k.H_={T_:k.getTypeName(),B_:k.getBaseTypes()}},1975:function(D,I){Object.defineProperty(I,"__esModule",{value:!0});I.Status=void 0;D=I.Status||(I.Status={});D[D.Success=0]="Success";D[D.BlockedByShortInputFilter=1]="BlockedByShortInputFilter";D[D.BlockedByLanguageDetector=2]="BlockedByLanguageDetector";D[D.BlockedByPrefilter=3]="BlockedByPrefilter";D[D.BlockedByContentModerator=4]="BlockedByContentModerator";D[D.BlockedByPostfilter=5]="BlockedByPostfilter";D[D.FailedToGenerateContent=
6]="FailedToGenerateContent";D[D.UnexpectedError=7]="UnexpectedError";D[D.InvalidInputError=8]="InvalidInputError";D[D.MissingTemplateError=9]="MissingTemplateError"},1976:function(D,I,c){Object.defineProperty(I,"__esModule",{value:!0});I.QualityStatus=void 0;const l=c(196);class e{constructor(a){l.SchemaObject.assign(e,this,a)}static getTypeName(){return"AugLoop_AiInsert_QualityStatus"}static getBaseTypes(){return[]}static typeGuard(a){return l.SchemaObject.matchesTypesFor(a,[e.getTypeName()])}}
I.QualityStatus=e;e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()}},1981:function(D,I,c){var l=c(1782),e=c(1783),a,k,x=0,y=0;D.exports=function(m,t,z){z=t&&z||0;var v=t||[];m=m||{};var H=m.node||a,F=void 0!==m.FFh?m.FFh:k;if(null==H||null==F){var G=l();null==H&&(H=a=[G[0]|1,G[1],G[2],G[3],G[4],G[5]]);null==F&&(F=k=(G[6]<<8|G[7])&16383)}G=void 0!==m.Vfn?m.Vfn:(new Date).getTime();var M=void 0!==m.FSi?m.FSi:y+1,K=G-x+(M-y)/1E4;0>K&&void 0===m.FFh&&(F=F+1&16383);(0>K||G>x)&&void 0===m.FSi&&(M=0);if(1E4<=
M)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");x=G;y=M;k=F;G+=122192928E5;m=(1E4*(G&268435455)+M)%4294967296;v[z++]=m>>>24&255;v[z++]=m>>>16&255;v[z++]=m>>>8&255;v[z++]=m&255;m=G/4294967296*1E4&268435455;v[z++]=m>>>8&255;v[z++]=m&255;v[z++]=m>>>24&15|16;v[z++]=m>>>16&255;v[z++]=F>>>8|128;v[z++]=F&255;for(F=0;6>F;++F)v[z+F]=H[F];return t?t:e(v)}},1982:function(D,I,c){var l=c(1782),e=c(1783);D.exports=function(a,k,x){x=k&&x||0;"string"==typeof a&&(k="binary"===a?Array(16):null,a=null);
a=a||{};a=a.random||(a.D9n||l)();a[6]=a[6]&15|64;a[8]=a[8]&63|128;if(k)for(var y=0;16>y;++y)k[x+y]=a[y];return k||e(a)}},1987:function(D,I,c){c.r(I);D=c(0);var l=c(2),e=c(93),a=c(2071),k=c(7),x=c(69),y=c(54),m=c(112),t=c(249),z=c(549),v=c(372),H=c(76),F=c(3),G=c(10),M=c(63),K=c(43),L=c(1067),R=c(5),S=c(95);class N extends M.a{constructor(){super(new S.a(33));this.klf=this.Aag=0}HXd(){return 0}wHa(){const Xa=new K.GraphTransaction(3);Xa.Db(this);const kb=new R.GraphIterator;kb.set(this);if(kb.Iz()){const Bb=
kb.Rd();kb.set(Bb);const Ja=L.b(kb,this.Aag,this.klf),Ma=new R.GraphIterator;Ma.set(this);Ma.Rd();Ma.zg();Ja&&kb.currentNode!==Bb&&Ma.Bf(kb.currentNode,-2)}Xa.dispose()}}Object(D.a)(N,"FindTrackingNode",M.a,[]);var O=c(17),W=c(48),V=c(8),Q=c(1881),Y=c(1882);class ba{constructor(Xa){this.Yc=Xa;Xa=[];Xa.push(1);this.okg=Xa}W9h(Xa){const kb=this.Yc.Ek();kb.set(Xa);const Bb=[];kb.zb(8)&&(kb.jd(8),Bb.push(new Y.a(kb.currentNode,Xa,1)));return Bb}static gF(){return new ba(new z.a)}static get instance(){return null!=
ba.$Bg?ba.$Bg:ba.$Bg=ba.gF()}}Object(D.a)(ba,"FindContextHelper",null,[310]);var Z=c(1565),ea=c(367),ha=c(109),ka=c(16);class ua{constructor(Xa,kb,Bb,Ja,Ma,fb,hc,cc,mb){this.Do=null;this.EXb=this.fDe=!1;this.Aab=this.lLg=this.O$a=null;this.Sdh=!1;this.TY=(Hb,Ua)=>{Hb=Ua.node;Ua.property===ka.a.wo&&this.uXc(Hb)&&this.BHb(Hb,3)};this.Onb=(Hb,Ua)=>{Hb=Ua.node;this.uXc(Hb)&&this.BHb(Hb,2)};this.dja=(Hb,Ua)=>{Hb=Ua.node;Ua=Ua.tEf;!this.eB.CDl&&Ua||!this.uXc(Hb)||this.BHb(Hb,1)};this.processDirtyNodes=
()=>{const Hb=this.je.Zf("UserAction","ProcessDirtyNodesInFindResultsTime");this.Do=null;const Ua=this.Lc.Pc(3);Ua.Db(this.np.Zc);0<this.addedNodes.count&&(this.EXb=!0,this.WOg(this.addedNodes,this.eB.Sj));0<this.GLc.count&&this.WOg(this.GLc,this.eB.Sj);if(0<this.Ufb.count){const Ya=!this.Tgk(this.Ufb,this.eB,this.np,this.Sgk);this.EXb=this.EXb||Ya}Ua.dispose();this.eB.Sj.Nrb();this.cqb(this.EXb);this.Phj();Hb.stop()};this.obo=()=>{this.xGd();if(0<this.Ufb.count||0<this.addedNodes.count||0<this.GLc.count)this.Do=
new e.a(2,1,500,this.processDirtyNodes,53),this.Ib.Wb(this.Do)};this.eB=Xa;this.rW=kb;this.np=Bb;this.Ib=Ja;this.Lc=Ma;this.WOg=fb;this.Tgk=hc;this.Sgk=cc;this.je=mb;this.reset();this.Phj=this.obo;this.np.mde(this.TY,this.dja,this.Onb)}get Ufb(){return this.O$a}get addedNodes(){return this.lLg}get GLc(){return this.Aab}get efj(){return this.Sdh}get Rrm(){return 0<this.Ufb.count||0<this.GLc.count}start(){this.fDe=!0;this.cqb(!1)}stop(){this.reset()}reset(){this.fDe=!1;this.cqb(!1);this.O$a=new ea.a;
this.lLg=new ea.a;this.Aab=new ea.a;this.xGd()}uXc(Xa){return!!Xa.Mc&&!!this.np.rj&&Xa.Mc.id.equals(this.np.rj.id)}BHb(Xa,kb){if(this.fDe&&Object(m.a)(64,Xa)&&!this.eB.fPb.j7c)if(this.eB.Sj.V8a||this.eB.Sj.hmb.length){switch(kb){case 1:this.Ufb.nb(Xa.id)||this.addedNodes.Z(Xa.id,Xa);break;case 2:this.Ufb.nb(Xa.id)&&this.Ufb.remove(Xa.id);this.addedNodes.nb(Xa.id)?this.addedNodes.remove(Xa.id):this.GLc.Z(Xa.id,Xa);break;case 3:this.Ufb.Z(Xa.id,Xa)}this.Phj()}else 2!==kb&&this.cqb(this.EXb=!0)}xGd(){this.Do&&
(this.Ib.ff(this.Do),this.Do=null)}cqb(Xa){this.efj!==Xa&&(this.Sdh=Xa,this.rW.cqb(Xa));Xa||(this.EXb=!1)}static gF(Xa,kb){return new ua(Xa,kb,Z.FindManagerHelper.instance,ha.a.instance,new v.a,ua.wYk,ua.KYn,ua.JYn,G.App.za.Lq)}static createInstance(Xa,kb){return ua._instance||(ua._instance=ua.gF(Xa,kb))}static KYn(Xa,kb,Bb,Ja){let Ma=!1;const fb=ua.bki(Xa,ua.ubn);for(let hc=0;hc<fb.length;++hc){const cc=!Ja(fb[hc],kb,Bb);Ma=Ma||cc;Xa.remove(fb[hc].id)}return!Ma}static JYn(Xa,kb,Bb){const Ja=kb.Sj;
Xa.pna();const Ma=Xa.id,fb=Ja.M$b(Ma);if(fb)kb=Bb.Njb(Xa.tFa(),kb.uOc),Bb=Bb.O4d(Ma,kb,null,fb.type,fb.WYd),Xa.qUa(kb),Ja.gee(Ma,Bb);else return!1;return!0}static wYk(Xa,kb){const Bb=ua.bki(Xa,ua.tbn);for(let Ja=0;Ja<Bb.length;++Ja){const Ma=Bb[Ja],fb=Ma.id;Ma.pna();kb.O6c(fb);Xa.remove(fb)}}static bki(Xa,kb){const Bb=[];let Ja=kb;Xa.forEach((Ma,fb)=>{Bb.push(fb);--Ja;return Ja?!0:!1});return Bb}}ua.ubn=5;ua.tbn=15;ua._instance=null;Object(D.a)(ua,"FindResultAppEventCoordinator",null,[1370]);class sa{constructor(Xa,
kb){this.Xzb=this.sUb=0;this.ptc=this.IDc=this.Uka=null;this.o1b=0;this.zwb=null;this.rW=Xa;this.Dla=kb;this.oZa=new ea.a;this.Qyb=new ea.a;this.Icb=new ea.a;this.Iab=new ea.a;this.nZa=new ea.a(0);this.lCc=new ea.a;for(Xa=0;Xa<kb.length;++Xa)this.nZa.Z(kb[Xa],0);this.hmb=[]}get UE(){return this.Uka}set UE(Xa){this.Uka=Xa;Xa=Array(1);Xa[0]=this.Uka;this.rW.DPa(3,Xa)}get U$(){return this.IDc}set U$(Xa){this.IDc=Xa}get n4(){return this.ptc}set n4(Xa){this.ptc=Xa}get aFa(){let Xa=null;for(const kb of this.Dla)if(Xa=
this.oZa.J(kb))break;return Xa}get nZe(){return this.sUb}aie(Xa){Xa!==this.sUb&&(this.sUb=Xa)}get yka(){return this.Xzb}wlc(Xa){Xa!==this.Xzb&&(this.Xzb=Xa,this.rW&&!this.Xzb&&(this.rW.oge(0),this.rW.Whe(0)))}get V8a(){return this.o1b}get Lec(){return this.zwb}vZe(Xa,kb){if(Xa&&!(0>=Xa.length)){var Bb=Xa[0].type,Ja=kb,Ma=Ja?Ja.next:this.oZa.J(Bb);Ja||this.oZa.Z(Bb,Xa[0]);for(const fb of Xa){const hc=fb;this.lCc.Z(hc.id,hc);Ja&&(Ja.next=hc);hc.previous=Ja;Ja=hc}Ja&&(Ja.next=Ma);Ma&&(Ma.previous=Ja);
kb&&Xa[0].nodeId.equals(kb.nodeId)||this.Icb.Z(Xa[0].nodeId,Xa[0]);!Ma&&Ja&&this.Qyb.Z(Ja.type,Ja);this.Lec===kb&&(this.zwb=Ja);this.nZa.Z(Bb,this.nZa.J(Bb)+Xa.length);this.wlc(this.yka+Xa.length);this.o1b=this.V8a+Xa.length;this.rW&&this.rW.DPa(0,Xa)}}cCd(Xa){!Xa||0>=Xa.length||this.vZe(Xa,this.Qyb.J(Xa[0].type))}aoh(Xa){!Xa||0>=Xa.length||(this.Lec&&this.Lec.type!==Xa[0].type&&(this.zwb=null),this.vZe(Xa,this.Lec))}O6c(Xa){const kb=this.M$b(Xa);if(kb){Xa=kb;for(var Bb=0;Xa;){++Bb;if(!Xa.next||!Xa.nodeId.equals(Xa.next.nodeId))break;
Xa=Xa.next}this.Zaj(kb,Xa)}else k.ULS.sendTraceTag(4069027,313,15,"RemoveResultsForNode called for node not in cache: {0}",Xa.toString())}Zaj(Xa,kb){let Bb=0,Ja=0;const Ma=[];let fb=Xa;for(;fb!==kb.next;){const hc=this.oCi(fb);this.Icb.J(fb.nodeId).id===fb.id&&(fb.next&&fb.next.nodeId.equals(fb.nodeId)?(this.Icb.Z(fb.nodeId,fb.next),hc&&this.Iab.Z(fb.nodeId,fb.next)):(this.Icb.remove(fb.nodeId),hc&&this.Iab.remove(fb.nodeId)));this.Lec&&this.Lec.id===fb.id&&(this.zwb=Xa.previous);this.U$&&this.U$.id===
fb.id&&(this.U$=this.Qsf(fb,Xa));this.n4&&this.n4.id===fb.id&&(this.n4=this.Qsf(fb,Xa));this.UE&&this.UE.id===fb.id&&(this.UE=this.Qsf(fb,Xa));this.lCc.remove(fb.id);Ma.push(fb);fb=fb.next;hc?++Ja:++Bb}Xa.previous?Xa.previous.next=kb.next:kb.next?this.oZa.Z(kb.type,kb.next):this.oZa.remove(kb.type);kb.next?kb.next.previous=Xa.previous:Xa.previous?this.Qyb.Z(Xa.type,Xa.previous):this.Qyb.remove(Xa.type);kb.next=null;Xa.previous=null;this.nZa.Z(Xa.type,this.nZa.J(Xa.type)-Bb);this.wlc(this.yka-Bb);
this.o1b=this.V8a-(Bb+Ja);this.rW&&this.rW.DPa(1,Ma)}gee(Xa,kb){const Bb=this.M$b(Xa);if(Bb){const Ja=[],Ma=[],fb=[];let hc=Bb,cc,mb=0;do mb<kb.length?(hc.d8k(kb[mb]),Ja.push(hc)):(Ma.push(hc),this.U$&&this.U$.id===hc.id&&0<Ja.length&&(this.U$=Ja[Ja.length-1])),++mb,cc=hc,hc=hc.next;while(hc&&cc.nodeId.equals(hc.nodeId));for(;mb<kb.length;++mb)fb.push(kb[mb]);0<Ma.length&&this.Zaj(Ma[0],Ma[Ma.length-1]);0<fb.length&&this.vZe(fb,0<Ja.length?Ja[Ja.length-1]:Bb);kb=Ja.length;if(0<kb){if(this.Iab.nb(Xa)){this.Iab.remove(Xa);
this.wlc(this.yka+kb);let Hb,Ua;(Hb=this.nZa).Z(Ua=Ja[0].type,Hb.J(Ua)+kb)}this.rW&&this.rW.DPa(4,Ja)}}else k.ULS.sendTraceTag(4069056,313,15,"ReplaceResultsForNode: NodeId not found in cache nodeId={0}",Xa.toString())}mFh(){this.Icb=new ea.a;this.Iab=new ea.a;this.oZa=new ea.a;this.Qyb=new ea.a;this.lCc=new ea.a;for(let Xa=0;Xa<this.Dla.length;++Xa)this.nZa.Z(this.Dla[Xa],0);this.UE=null;this.aie(0);this.n4=this.U$=this.zwb=null;this.wlc(0);this.o1b=0;this.rW&&this.rW.DPa(2,null)}tNi(){this.Iab=
new ea.a;this.Icb.forEach((Xa,kb)=>{this.Iab.Z(Xa,kb);return!0});for(let Xa=0;Xa<this.Dla.length;++Xa)this.nZa.Z(this.Dla[Xa],0);this.UE=null;this.aie(0);this.zwb=null;this.wlc(0);this.rW&&this.rW.DPa(2,null)}M$b(Xa){return this.Icb.nb(Xa)?this.Icb.J(Xa):null}lP(Xa){let kb=null;this.lCc.nb(Xa)&&(kb=this.lCc.J(Xa));return kb}i$h(Xa){return this.oZa.nb(Xa)?this.oZa.J(Xa):null}z2l(Xa){return this.Qyb.nb(Xa)?this.Qyb.J(Xa):null}Nrb(){var Xa=0;if(this.UE){Xa=0;const Ja=this.UE.type;var kb=this.oZa.J(Ja);
if(kb){for(var Bb=1;kb&&this.UE.id!==kb.id;)this.oCi(kb)||++Bb,kb=kb.next;kb&&(Xa=Bb)}if(kb){kb=0;for(Bb=0;Bb<this.Dla.length&&this.Dla[Bb]!==Ja;++Bb)kb+=this.nZa.J(this.Dla[Bb]);Xa=kb+Xa}else k.ULS.sendTraceTag(4069057,313,10,"UpdateActiveIndexFromActiveResult, active result not found in cache, setting it to null"),this.UE=null,Xa=0}this.aie(Xa);this.rW&&(this.rW.oge(this.nZe),this.rW.Whe(this.yka))}R2a(Xa){return this.fTd(Xa,!1)}VTd(Xa){return this.fTd(Xa,!0)}fTd(Xa,kb){let Bb=kb?Xa.previous:Xa.next,
Ja=Xa.type;for(;!Bb&&(Ja=this.r6l(Ja,kb),Bb=kb?this.z2l(Ja):this.i$h(Ja),Ja!==Xa.type););return Bb||Xa}Q9b(Xa){return this.f7h(Xa,!1)}Fbi(Xa){return this.f7h(Xa,!0)}f7h(Xa,kb){let Bb=this.fTd(Xa,kb);for(;Bb.nodeId.equals(Xa.nodeId)&&Bb.id!==Xa.id;)Bb=this.fTd(Bb,kb);return Bb}r6l(Xa,kb){let Bb=0;for(let Ja=0;Ja<this.Dla.length;++Ja)if(Xa===this.Dla[Ja]){Bb=Ja;break}kb?(--Bb,0>Bb&&(Bb=this.Dla.length-1)):(++Bb,Bb===this.Dla.length&&(Bb=0));return this.Dla[Bb]}tej(){this.zwb=null}Qsf(Xa,kb){Xa=this.R2a(Xa);
Xa.id===kb.id&&(Xa=null);return Xa}oCi(Xa){return this.Iab.nb(Xa.nodeId)}static createInstance(Xa,kb,Bb=!1){return Bb?new sa(Xa,kb):sa._instance||(sa._instance=new sa(Xa,kb))}}sa._instance=null;Object(D.a)(sa,"FindResultManager",null,[1340]);class Da{constructor(Xa,kb){this.ymm=Bb=>{const Ja=this.np.rj.Eb(Bb.nodeId);if(Ja){if(this.zC.UE){var Ma=this.np.rj.Eb(this.zC.UE.nodeId);(Ma=Object(x.a)(64,Ma))?Ma.NEh():k.ULS.sendTraceTag(4069060,313,15,"{0}",{["GoToResultInternal"]:"ActiveHitNodeNotFound",
["NodeId"]:this.zC.UE.nodeId})}Ja.NOf(Bb.IQa,Bb.type)?(this.zC.UE=Bb,k.ULS.sendTraceTag(4065305,313,50,"{0}",{["GoToResultInternal"]:"Success",["ResultId"]:Bb.id})):c(1987).FindManager.instance.boi()?k.ULS.sendTraceTag(4575581,313,15,"{0}",{["GoToResultInternal"]:"Failure",["NodeId"]:Ja.id,["HitIndexInNode"]:Bb.IQa,["ResultId"]:Bb.id}):k.ULS.sendTraceTag(4069061,313,10,"{0}",{["GoToResultInternal"]:"Failure",["NodeId"]:Ja.id,["HitIndexInNode"]:Bb.IQa,["ResultId"]:Bb.id});this.zC.Nrb()}else k.ULS.sendTraceTag(4069059,
313,10,"{0}",{["GoToResultInternal"]:"Invalid findResult.NodeId",["NodeId"]:Bb.nodeId})};this.zC=Xa;this.np=kb;this.Iwf=this.ymm}vli(){const Xa=this.zC.UE?this.zC.R2a(this.zC.UE):this.zC.aFa;this.Iwf(Xa)}xmm(){const Xa=this.zC.UE?this.zC.VTd(this.zC.UE):this.zC.aFa;this.Iwf(Xa)}zli(Xa){const kb=this.zC.lP(Xa);kb?this.Iwf(kb):k.ULS.sendTraceTag(4069058,313,10,"{0}",{["GoToResult"]:"Invalid FindResult",["ResultId"]:Xa})}static gF(Xa){return new Da(Xa,Z.FindManagerHelper.instance)}static createInstance(Xa){return Da._instance||
(Da._instance=Da.gF(Xa))}}Da._instance=null;Object(D.a)(Da,"FindResultNavigator",null,[1339]);var Pa=c(19),Ra=c(1234);M=c(149);class Ga{static sNb(Xa){const kb=[];var Bb=RegExp('"[^"\\r\\n]*"',"ig"),Ja=Xa.match(Bb);let Ma;if(Ja&&0<Ja.length)for(Ma=0;Ma<Ja.length;Ma++){var fb=Ja[Ma].split('"').join("");fb=fb.trim();fb=fb.split(Ga.Cad).join(" ");if(""!==fb){kb.push(fb);var hc=fb.split(Ga.punctuation).join(" ");hc=hc.trim();hc=hc.split(Ga.Cad).join(" ");""!==hc&&hc!==fb&&kb.push(hc)}}Xa=Xa.split(Bb).join(" ");
Bb=Ra.a.instance.WPl(Xa);if(!Bb.length)return kb.sort(Ga.Duj),kb;Ja=Bb[0];for(Ma=1;Ma<Bb.length;Ma++)if(hc=Bb[Ma],2!==Ja.UL||2!==hc.UL)fb=Xa.substring(Ja.cp,hc.cp),fb=fb.trim(),Ga.$Ei(fb,Ja)&&kb.push(fb),Ja=hc;fb=Xa.substring(Ja.cp,Xa.length);fb=fb.trim();Ga.$Ei(fb,Ja)&&kb.push(fb);kb.sort(Ga.Duj);return kb}static $Ei(Xa,kb){return""!==Xa&&'"'!==Xa&&1!==kb.UL}static r4n(Xa){for(let kb=0;kb<Xa.length;kb++)Xa[kb]=Xa[kb].split(Ga.Cad).join("\\s+");return Xa}static Duj(Xa,kb){return Xa.length>kb.length?
-1:Xa.length===kb.length?0:1}}Ga.punctuation=RegExp("[\\[\\]\\\\\\^\\$\\.\\|\\+\\(\\)\\?\\*\\-_=,;:%!'<>/@#&{}]");Ga.Cad=RegExp("\\s+");Ga.wUn=[new M.a(RegExp("\\[","g"),"\\["),new M.a(RegExp("\\]","g"),"\\]"),new M.a(RegExp("\\\\","g"),"\\\\"),new M.a(RegExp("\\^","g"),"\\^"),new M.a(RegExp("\\$","g"),"\\$"),new M.a(RegExp("\\.","g"),"\\."),new M.a(RegExp("\\|","g"),"\\|"),new M.a(RegExp("\\+","g"),"\\+"),new M.a(RegExp("\\(","g"),"\\("),new M.a(RegExp("\\)","g"),"\\)"),new M.a(RegExp("\\?","g"),
"\\?"),new M.a(RegExp("\\*","g"),"\\*")];Object(D.a)(Ga,"SearchAndFindUtils",null,[]);class ta{p4c(Xa){return Pa.a.mha(Xa,Ga.wUn)}sNb(Xa){Xa=Ga.sNb(Xa);return Xa=Ga.r4n(Xa)}M3i(){return null}D1d(){return!1}static get instance(){return null!=ta.BCg?ta.BCg:ta.BCg=new ta}}Object(D.a)(ta,"QueryProcessor",null,[938]);var va=c(736),ia=c(22),qa=c(12),pa=c(26),Fa=c(650),za=c(771),Oa=c(206),xa=c(237);class fa{constructor(){this.k7c=this.transaction=null;this.xrb=this.z9f=0;this.w9f=this.Rgb=null}}Object(D.a)(fa,
"ReplaceAllContext",null,[]);class Ka{constructor(Xa,kb,Bb,Ja,Ma,fb,hc,cc,mb,Hb,Ua){this.Yon=(Ya,Fb,Wa,yb,Yb)=>{let qc=null;if(Ya>Fb)for(qc=Wa;0<Fb&&qc.nodeId.equals(Yb.id);)qc=this.zC.R2a(qc),--Fb;else 0<Ya?qc=this.zC.Q9b(Wa):yb.nodeId!==Yb.id&&(qc=yb);return qc};this.dFh=()=>{const Ya=this.zC.hmb;if(Ya&&0<Ya.length){const Fb=this.Lc.Pc(3);Fb.Db(this.np.rj.Eb(Ya[0]));for(let Wa=0;Wa<Ya.length;++Wa){const yb=this.np.rj.Eb(Ya[Wa]);yb?yb.pna(!1,!0):k.ULS.sendTraceTag(4069064,313,10,"Last replaced node not found in object Space, NodeId: {0}",
Ya[Wa])}Fb.dispose();Array.clear(this.zC.hmb)}};this.Pun=(Ya,Fb)=>{this.cCc=!0;this.Baj();const Wa=new fa;Wa.k7c=Ya?Ya:"";Wa.w9f=Fb;Wa.xrb=this.zC.yka;Ya=this.Lc.Pc(15);Ya.Db(this.np.Zc);Wa.transaction=Ya;this.nzl(Wa,Ya)};this.pon=(Ya,Fb)=>{Ya=new va.a(null,this.DJn,Ya);const Wa=this.np.Zc;Wa&&Wa.zJ().sF.g8(9);Ya.Rl("ReplaceAll");Fb.HIa(Ya);Ya.run()};this.Asn=(Ya,Fb)=>{Ya=this.je.Zf("UserAction","OnProcessReplaceAll");if(this.xTm(Fb))return this.y3k(Fb),!1;let Wa=Fb.Rgb;Wa||(Wa=this.zC.aFa);Fb.Rgb=
this.zC.Q9b(Wa);const yb=this.np.rj.Eb(Wa.nodeId);if(!yb)return k.ULS.sendTraceTag(4065307,313,10,"ReplaceAll: Node for result with id: {0} and nodeId: {1}, Not Found!",Wa.id,Wa.nodeId),!0;const Yb=yb.fQa();if(Yb&&Yb.length)if(this.qVk(yb,Yb[0].Ec,Yb[0].end))k.ULS.sendTraceTag(5007254,313,50,"ReplaceAll: Skipping node: {0} as Paragraph is locked",yb.id);else{let qc=0;for(let Hc=0;Hc<Yb.length;++Hc){Fb.z9f+=1;const $b=this.replaceText(this.eB.ilf,yb,Fb.k7c,pa.a.createTextRange(yb,Yb[Hc].Ec+qc,Yb[Hc].end+
qc));qc+=Fb.k7c.length-(Yb[Hc].end-Yb[Hc].Ec)+$b;yb.xeg(0,Fb.k7c.length)}0<Fb.k7c.length&&this.zC.hmb.push(Wa.nodeId)}else k.ULS.sendTraceTag(4065308,313,15,"ReplaceAll: No hits found for result with id: {0} and nodeId: {1}!",Wa.id,Wa.nodeId);Ya.stop();return!0};this.Rmn=Ya=>{Ya.transaction.dispose();this.cCc=!1;this.eB.g0a(!1);Ya.w9f&&Ya.w9f(Ya.z9f,Ya.xrb)};this.ltn=(Ya,Fb,Wa,yb)=>{!Ya.matchCase&&0<Wa.length&&(Ya=Fb.tFa().substr(yb.cpBegin,yb.cpEnd-yb.cpBegin),Wa=this.$Tk(Wa,Ya));return this.dCc(yb,
Wa,!0,!1)};this.eB=Xa;this.zC=kb;this.np=Bb;this.Lc=Ja;this.yJe=Ma;this.o8j=hc;this.UKg=cc;this.dCc=mb;this.A$j=Hb;this.je=Ua;this.cCc=!1;this.gDo=this.Pun;this.DJn=this.Asn;this.y3k=this.Rmn;this.nzl=this.pon;this.Baj=this.dFh;this.replaceText=this.ltn;this.$Tk=Ka.amn;this.y6l=this.Yon}get mI(){return this.yJe.value}get j7c(){return this.cCc}replace(Xa){var kb=!1;if(this.j7c)return k.ULS.sendTraceTag(4069062,313,15,"Replace: Cancelled as replace is already in progress"),kb;if(this.mI.mhl){var Bb=
this.mI.w4;const fb=Bb.node;Bb.contextId===qa.a.paragraph&&(Bb=pa.a.createTextRange(fb,0,V.ParagraphReader.textLength(fb)));var Ja=Object(x.a)(64,fb);if(Ja){var Ma=new za.a(Bb.cpBegin,Bb.cpEnd);Ma=Ja.Nai(Ma);if(Ma!==Fa.a.invalid&&0<=Ma){if(this.oDh(Bb))return k.ULS.sendTraceTag(5007250,313,50,"Replace: Cancelled as Paragraph is locked"),kb;this.cCc=!0;kb=this.Lc.Pc(15);kb.Db(fb);this.replaceText(this.eB.ilf,Ja,Xa,Bb);kb.dispose();this.Baj();Ja.xeg(Ma,Xa.length);0<Xa.length&&this.zC.hmb.push(fb.id);
Xa=this.zC.M$b(fb.id);Bb=this.zC.R2a(Xa);Ja=Ja.fQa();Ja=this.np.O4d(fb.id,Ja,null,Xa.type,Xa.WYd);this.zC.gee(fb.id,Ja);(Bb=this.y6l(Ja.length,Ma,Xa,Bb,fb))?this.eB.R7c.zli(Bb.id):this.zC.Nrb();kb=!0;this.cCc=!1}else k.ULS.sendTraceTag(5007251,313,50,"Replace: Cancelled as current selection not on a find hit.")}else k.ULS.sendTraceTag(4069063,313,15,"Replace: Failed as No node found corresponding to current selection")}else k.ULS.sendTraceTag(5007252,313,50,"Replace: Cancelled as current selection does not contain single context");
kb?(k.ULS.sendTraceTag(4065306,313,50,"ReplaceManager Replace Success"),this.eB.x9f=!0):(k.ULS.sendTraceTag(5007253,313,50,"ReplaceManager Replace Not Successful"),this.eB.R7c.vli());return kb}replaceAll(Xa,kb){this.j7c?k.ULS.sendTraceTag(4069065,313,15,"ReplaceAll: Called when Replace is already in Progress"):this.zC.yka?this.gDo(Xa,kb):k.ULS.sendTraceTag(4069066,313,15,"ReplaceAll: Called when total results is 0")}oDh(Xa){const kb=this.o8j(Xa);!kb&&this.UKg.value&&this.A$j.value&&this.UKg.value(Xa.node);
return kb}qVk(Xa,kb,Bb){return this.oDh(pa.a.createTextRange(Xa,kb,Bb))}xTm(Xa){return Xa.Rgb===this.zC.aFa}static get jg(){return null!=Ka.Wwg?Ka.Wwg:Ka.Wwg=ia.a.instance.resolve("Box4.ICharacterPropertiesEditor")}static gF(Xa,kb){const Bb=new t.a(()=>G.App.zd&&G.App.zd.fq?Object(y.a)(G.App.zd.fq,G.App.zd.fq.gG,"acquireAndApplyLock"):null);return new Ka(Xa,kb,Z.FindManagerHelper.instance,new v.a,new t.a(()=>Oa.a.instance),new t.a(()=>W.a.instance),Object(y.a)(xa.a.instance,xa.a.instance.qKm,"isContextSetInLockedRange"),
Bb,Object(y.a)(Ka.jg,Ka.jg.Ge,"replaceTextRange"),new t.a(()=>G.App.zd.Uo),G.App.za.Lq)}static createInstance(Xa,kb){return Ka._instance||(Ka._instance=Ka.gF(Xa,kb))}static amn(Xa,kb){const Bb=Pa.a.eh(kb);!Pa.a.localeCompare(Pa.a.ZA(kb),kb)&&Pa.a.localeCompare(Bb,kb)?Xa=Pa.a.ZA(Xa):Pa.a.iec(kb.charAt(0))&&!Pa.a.oGf(kb.charAt(0))&&(kb=Pa.a.ZA(Xa.substr(0,1)),Xa=1===Xa.length?kb:kb+Xa.substr(1,Xa.length-1));return Xa}}Ka._instance=null;Object(D.a)(Ka,"ReplaceManager",null,[1280]);c.d(I,"FindManager",
function(){return lb});class lb extends Q.a{constructor(Xa,kb,Bb,Ja,Ma,fb,hc,cc,mb,Hb,Ua,Ya,Fb,Wa,yb,Yb=!1){super(Xa,kb,Bb,Ma,fb,Fb,Wa,Ua,Ya);this.Cla=this.JCc=null;this.IAd=!1;this.TCa=this.wab=this.lcb=null;this.Wuc=0;this.lyd=Ja;this.Lwb=hc;this.Yc=cc;this.Lc=mb;this.OOe=Hb;this.h3j=yb;this.yyc=[];this._state=2;this.nzb=!Yb;this.Utb=new N;this.np.x_e(this.Utb);this.F0b=new N;this.np.x_e(this.F0b);this.np.Zc&&(this.lcb=this.np.rj);this.Zrg=400;this.wpc=100}get mb(){return this.Lwb.value}get ilf(){return this.JCc}get KOd(){return this.h3j.value}g0a(Xa=
!0){this.fPb&&this.fPb.j7c||(this.Lfb(Xa),this.hbb.reset(),this.Aeb="",this.lyd&&this.KOd.stop(),this.eZk(),this.Mnj(null))}eZk(){this.S7&&(this.taskManager.ff(this.S7),this.S7=null);this.xLa&&(this.taskManager.ff(this.xLa),this.xLa=null)}Lfb(Xa=!0){!this.lcb&&0<this.Sj.V8a&&k.ULS.sendTraceTag(4235910,313,10,"{0}",{["CancelFind"]:"LastKnowSpaceNull"});if(0<this.Sj.V8a&&this.lcb){let Bb=this.Sj.aFa;const Ja=Bb.nodeId;if(this.lcb.Eb(Ja)){const Ma=this.Lc.Pc(3);for(Ma.Db(this.lcb.Eb(Ja));Bb;){const fb=
this.lcb.Eb(Bb.nodeId);var kb=Object(x.a)(64,fb);if(kb){if(this.nzb&&(kb.pna(void 0,Xa),V.ParagraphReader.Xb(fb)&&(kb=this.np.Y9h(fb))))for(const hc of kb)hc.pna(void 0,Xa);fb.ol(16,!0)}Bb=this.Sj.Q9b(Bb);if(!Bb||Bb.nodeId.equals(Ja))break}Ma.dispose()}else k.ULS.sendTraceTag(4235911,313,10,"ClearFindHits: Error - node not in last known space");this.Sj.mFh()}Xa&&this.fPb&&this.fPb.dFh();this.zej();this.yyc=[];this.fXb=this.JCc=null;this.aM=0;this.x9f=this.IAd=!1}A$f(){const Xa=this.JW;this.Lfb();
Xa&&""!==Xa.text&&this.find(Xa)}boi(){return this.lyd&&this.KOd.Rrm}Wej(){10>this.Wuc?(this.Wuc++,k.ULS.sendTraceTag(4069014,313,15,"{0}",{["ErrorRestartCount"]:this.Wuc}),this.find(this.JW)):(k.ULS.sendTraceTag(4235912,313,10,"RestartFindAfterErrorCondition: max retries reached"),l.AFrameworkApplication.va.processAction(F.a.s4b,2),this.Wuc=0)}$7i(){var Xa=(new Date).getTime();let kb=!1;this.Sj.V8a||(kb=!0);let Bb=0;if(!kb){this.Sj.U$||(this.Sj.U$=this.Sj.aFa);this.Sj.n4||(this.Sj.n4=this.Sj.U$,this.Sj.UE=
null);let Ja=null,Ma=!0;for(;!kb&&this.Sj.n4&&(new Date).getTime()-Xa<Q.a.jOi;){const fb=this.Sj.n4,hc=this.np.rj.Eb(fb.nodeId);hc?(Ma&&(Ja=this.Lc.Pc(3),Ja.Db(hc),Ma=!1),fb.WYd&&!this.wab&&(this.wab=hc),this.Sj.n4=this.Sj.Q9b(this.Sj.n4),kb=!this.Sj.n4||this.Sj.n4.nodeId.equals(this.Sj.U$.nodeId),this.axf(hc,fb.type,this.nzb),++Bb):this.Sj.O6c(fb.nodeId)}Ja&&Ja.dispose()}this.Sj.Nrb();kb&&(this.Sj.n4=null,this.IAd?this._state=0:(this._state=2,this.lqb(!0)));this.S7=new e.a(2,1,this.wpc,Object(y.a)(this,
this.findInternal,"findInternal"),52);this.taskManager.Wb(this.S7);Xa=(new Date).getTime()-Xa;k.ULS.sendTraceTag(4065247,313,50,"{0}",{["RecheckTime"]:Xa,["Count"]:Bb,["Total"]:this.Sj.yka,["TotalWithDirty"]:this.Sj.V8a})}zGn(){this.Lfb();this.aM=0;if(this.np.aEf&&this.nzb){var Xa=this.mb;if(Xa){var kb=Xa.ib.lb;if(kb){var Bb=G.App.za.jb.rc;(Bb=Bb?Bb.Es:null)&&Bb.ZUa();kb=O.SelectionEditor.Jj(kb,!1,!1);Xa.Ac(kb);Bb&&Bb.$Na()}}}Xa=this.tnl();this.Cla=this.a3j.W9h(Xa)}Nnj(){this.Mnj(this.Cla[this.aM].oka)}Mnj(Xa){this.boo(Xa);
this.ilj(Xa)}zej(){this.wab=null;this.ZXb=!1}Nsf(Xa){const kb=this.Yc.Ek();kb.set(Xa);if(!kb.zb(7))return kb.reset(),null;if(this.np.w5d(kb,7,0))return Xa=kb.currentNode,kb.reset(),Xa;k.ULS.sendTraceTag(4235914,313,10,"GetNextFindableNode: No findable nodes");kb.reset();return null}tnl(){if(this.np.aEf){var Xa=this.mb;if((Xa=Xa?Xa.ib.lb:null)&&this.nzb)return Xa.Tc.el?(Xa=Xa.Tc,O.SelectionEditor.nv(Xa)?(Xa=Xa.node,Object(m.a)(64,Xa)?Xa:this.Nsf(Xa)):Object(m.a)(64,Xa.node)?Xa.node:this.Nsf(Xa.node)):
this.Nsf(this.np.Zc);Xa=this.Yc.Ek();Xa.set(this.np.Zc);if(this.np.hog(Xa,8,1)){k.ULS.sendTraceTag(4069018,313,50,"No Selection: No selection, choosing title or first findable");const kb=Xa.currentNode;Xa.reset();return kb}k.ULS.sendTraceTag(4235915,313,10,"TryMoveToPageLeadingContent failed")}k.ULS.sendTraceTag(4235916,313,10,"Error: ContentView isn't PageView");return null}Suf(){const Xa=this.Yc.Ek();Xa.set(this.F0b);if(1===Xa.Wp())return Xa.Rd(),Xa.currentNode;k.ULS.sendTraceTag(4069019,313,15,
"Something went wrong in GetStartingNode...");return null}boo(Xa){const kb=this.Lc.Pc(3);kb.Db(this.F0b);const Bb=this.Yc.Ek();Bb.set(this.F0b);Bb.Iz()&&(Bb.Rd(),Bb.zg());Xa&&(Bb.Bf(Xa,81),Xa=this.Cla[this.aM],this.F0b.Aag=Xa.rootNode.type,this.F0b.klf=Xa.F8b);kb.dispose()}EUl(){if(this.Utb){var Xa=this.Yc.Ek();Xa.set(this.Utb);if(Xa.Wp())return Xa.Rd(),Xa.currentNode;Xa=this.OOe(this.np.Zc);Xa.moveNext();if(Xa.currentNode)return Xa.currentNode}k.ULS.sendTraceTag(4069020,313,15,"Something went wrong in GetCurrentNode...");
return null}ilj(Xa){const kb=this.Lc.Pc(3);kb.Db(this.Utb);const Bb=this.Yc.Ek();Bb.set(this.Utb);Bb.Iz()&&(Bb.Rd(),Bb.zg());Xa&&(Bb.Bf(Xa,81),Xa=this.Cla[this.aM],this.Utb.Aag=Xa.rootNode.type,this.Utb.klf=Xa.F8b);kb.dispose()}sli(){let Xa=this.Sj.UE||this.Sj.aFa;if(Xa){for(var kb=!1,Bb=!0;Xa;){var Ja=this.np.rj.Eb(Xa.nodeId);if(Ja=Object(x.a)(64,Ja))if(kb=Ja.OOf(Xa.type)){Bb&&(Xa=this.Sj.R2a(Xa));break}else Xa=this.Sj.R2a(Xa);else if(Bb=Xa,Xa=this.Sj.Q9b(Xa),this.Sj.O6c(Bb.nodeId),!Xa||Bb.nodeId.equals(Xa.nodeId))break;
Bb=!1}kb?(this.Sj.UE=Xa,this.Sj.Nrb(),k.ULS.sendTraceTag(4065248,313,50,"FindManager GoToNextHit Success")):k.ULS.sendTraceTag(4069022,313,15,"Failed to go to Next Hit")}}xli(){let Xa=this.Sj.UE||this.Sj.aFa;if(Xa){for(var kb=!1,Bb=!0;Xa;){var Ja=this.np.rj.Eb(Xa.nodeId);if(Ja=Object(x.a)(64,Ja))if(kb=Ja.lNi(Xa.type)){Bb&&(Xa=this.Sj.VTd(Xa));break}else Xa=this.Sj.VTd(Xa);else if(Bb=Xa,Xa=this.Sj.Fbi(Xa),this.Sj.O6c(Bb.nodeId),!Xa||Bb.nodeId.equals(Xa.nodeId))break;Bb=!1}kb?(this.Sj.UE=Xa,k.ULS.sendTraceTag(4065249,
313,50,"FindManager GoToPreviousHit Success")):k.ULS.sendTraceTag(4069024,313,15,"Failed to go to Previous Hit");this.Sj.Nrb()}}wTk(){return 2===this._state&&(this.x9f||this.lyd&&this.KOd.efj)}AVf(){this.np.Fpa?(this.Aeb=this.Tfa.p4c(this.JW.text),this.lcb=this.np.rj,this.zej()):this.Wej()}pvj(){this.lyd&&this.KOd.start()}U6e(){if(!this.np.Fpa||this.lcb!==this.np.rj)return this.Lfb(),this.Wej(),!0;this.Wuc=0;return!1}B$f(){const Xa=this.Tfa.sNb(this.Aeb),kb=this.wTk();let Bb=!1;if(kb||this.np.TBi(this.JCc,
this.yyc,this.JW,Xa)){Bb=!0;this.lqb(!1);this.hbb.update();this.hbb.nlf();!kb&&this.np.cCi(this.JCc,this.yyc,this.JW,Xa)?(this.Sj.tNi(),this.Sj.n4=null,this._state=1):(this.zGn(),this.Nnj(),this._state=0,this.IAd=!0);this.JCc=this.JW;this.yyc=Xa;try{this.fXb=this.gXb.J$b(this.yyc.join("|"),this.JW)}catch(Ja){return k.ULS.sendTraceTag(0,313,10,"FindManager Find being completed because of invalid search with case filter {0} and whole word {1} .",this.JW.matchCase,this.JW.matchWholeWord),this.fXb=null,
this._state=2,this.lqb(!0),!0}this.S7=new e.a(2,1,this.wpc,Object(y.a)(this,this.findInternal,"findInternal"),52);this.taskManager.Wb(this.S7)}return Bb}bUi(){if(!this.wab){const Xa=this.Yc.Ek();Xa.set(1===this.Cla[this.aM].F8b?this.np.Zc:this.Cla[this.aM].rootNode);this.np.hog(Xa,this.Cla[this.aM].rootNode.type,this.Cla[this.aM].F8b)?(this.wab=Xa.currentNode,Xa.reset()):(k.ULS.sendTraceTag(17306254,313,10,"TryToMoveToPageLeadingParagraph failed."),Xa.reset(),this.S7=new e.a(2,1,this.wpc,Object(y.a)(this,
this.findInternal,"findInternal"),52),this.taskManager.Wb(this.S7))}}kVf(){this.Sj.Nrb();this.ilj(this.TCa.currentNode);this.TCa.currentNode===this.Suf()&&(this.aM++,this.aM===this.Cla.length?(this.aM=0,this._state=2,this.IAd=!1,this.lqb(!0)):this.Nnj());this.TCa=null}Qhi(){return this.Suf()}I3i(){const Xa=this.EUl();this.TCa=this.Yc.Ek();this.TCa.set(Xa);this.TCa.e2(this.Cla[this.aM].rootNode)}ooj(){const Xa=this.Lc.Pc(3);Xa.Db(this.TCa.currentNode);return Xa}rZf(){this.axf(this.TCa.currentNode,
this.Cla[this.aM].F8b,this.nzb);this.np.w5d(this.TCa,this.Cla[this.aM].rootNode.type,this.Cla[this.aM].F8b)}X9e(Xa){return!!this.TCa.currentNode&&!this.TCa.currentNode.id.equals(Xa.id)}FDh(Xa){!this.ZXb&&this.wab&&Xa.id===this.wab.id&&this.Suf().id!==this.wab.id&&0<this.Sj.V8a&&(this.ZXb=!0,this.Sj.tej())}ZBd(Xa,kb,Bb,Ja){const Ma=this.Sj.M$b(Xa);Ma?this.Sj.gee(Xa,kb):this.ZXb?this.Sj.aoh(kb):this.Sj.cCd(kb);this.nzb&&!this.Sj.UE&&0<kb.length&&Bb.OOf(Ja)&&(this.Sj.UE=Ma?Ma:kb[0],this.Sj.U$||(this.Sj.U$=
this.Sj.UE))}qUa(Xa,kb){Xa.qUa(kb)}pna(Xa){this.nzb&&Xa.pna()}$Of(Xa){Xa.ol(16,!0)}static gF(Xa,kb,Bb,Ja,Ma=!1){kb||(kb=ta.instance);Bb||(Bb=ba.instance);const fb=sa.createInstance(Xa,Bb.okg,Ma),hc=new t.a(()=>Ka.createInstance(lb.instance,lb.instance.Sj)),cc=new t.a(()=>Da.createInstance(lb.instance.Sj)),mb=new t.a(()=>ua.createInstance(lb.instance,Xa));return new lb(Xa,kb,Bb,Ja,Z.FindManagerHelper.instance,new t.a(()=>l.AFrameworkApplication.lc),new t.a(()=>W.a.instance),new z.a,new v.a,H.a.createInstance,
a.a.instance,fb,hc,cc,mb,Ma)}static get instance(){return lb._instance}static createInstance(Xa,kb=null,Bb=null,Ja=!1,Ma=!1){return Ma?lb.gF(Xa,kb,Bb,Ja,!0):lb.instance||(lb._instance=lb.gF(Xa,kb,Bb,Ja))}}lb._instance=null;Object(D.a)(lb,"FindManager",Q.a,[])},1989:function(D,I,c){D=c(0);var l=c(22),e=c(2),a=c(243),k=c(42),x=c(6),y=c(16),m=c(46),t=c(7),z=c(69),v=c(112),H=c(75),F=c(88),G=c(209),M=c(12),K=c(5),L=c(599),R=c(104),S=c(832),N=c(1054),O=c(36),W=c(221),V=c(207),Q=c(84);class Y{constructor(mb){this.rqa=
mb}}Object(D.a)(Y,"ValidParentData",null,[]);var ba=c(40),Z=c(338),ea=c(666),ha=c(364),ka=c(665),ua=c(515);class sa{constructor(){this.O6b=0}}Object(D.a)(sa,"BelowOutlineElementData",null,[]);var Da=c(637),Pa=c(876),Ra=c(541);class Ga extends Da.a{constructor(mb,Hb,Ua,Ya){super(4,Ya);this.M6b=mb;this.FAb=Hb;this.mHc=Ua}iac(){var mb=this.M6b;if(!mb)return t.ULS.shipAssertTag(16819992,300,!1,"IParagraphStateWithChps not provided for DeletePara GetUpdateHintsForOperation"),null;const Hb=[],Ua=new Pa.a(this.M6b.id,
this.M6b.Wc,this.FAb?this.FAb.id:null);""!==mb.characterData&&mb.characterData&&(mb=new Ra.DeleteTextUpdateHint(this.M6b.id,0,mb.characterData),Hb.push(mb));Hb.push(Ua);return Hb}}Object(D.a)(Ga,"DeleteParagraphOperation",Da.a,[]);var ta=c(953),va=c(468);class ia extends Da.a{constructor(mb,Hb,Ua,Ya,Fb){super(3,Fb);this.sqa=mb;this.JSa=Hb;this.Ign=Ua;this.nya=Ya}iac(){const mb=[];var Hb=new ta.AddParagraphUpdateHint(this.nya.id,this.nya.Wc,this.sqa?this.sqa.id:null);mb.push(Hb);""!==this.nya.characterData&&
this.nya.characterData&&(Hb=new va.a(this.nya.id,0,this.nya.characterData),mb.push(Hb));return mb}}Object(D.a)(ia,"InsertNewParagraphOperation",Da.a,[]);var qa=c(952);class pa extends Da.a{constructor(mb,Hb,Ua,Ya){super(2,Ya);this.sqa=mb;this.JSa=Hb;this.M4d=Ua}iac(){const mb=[],Hb=new qa.MergeParagraphUpdateHint(this.sqa.id,this.sqa.Wc,this.sqa.characterData.length,this.JSa.id,this.JSa.Wc,this.M4d.id,this.M4d.Wc);mb.push(Hb);return mb}}Object(D.a)(pa,"MergeParagraphOperation",Da.a,[]);var Fa=c(875);
class za extends Da.a{constructor(mb,Hb,Ua,Ya,Fb){super(1,Fb);this.m5=mb;this.Vuj=Hb;this.FAb=Ua;this.mHc=Ya}iac(){const mb=[],Hb=new Fa.a(this.m5.id,this.m5.Wc,this.Vuj,this.FAb.id,this.FAb.Wc,this.mHc.id,this.mHc.Wc);mb.push(Hb);return mb}}Object(D.a)(za,"SplitParagraphOperation",Da.a,[]);var Oa=c(376),xa=c(10),fa=c(537),Ka=c(43),lb=c(1114),Xa=c(32),kb=c(124),Bb=c(237),Ja=c(8),Ma=c(184),fb=c(13),hc=c(90);c.d(I,"a",function(){return cc});class cc{constructor(mb,Hb,Ua,Ya,Fb,Wa,yb=null,Yb=null,qc=
null,Hc=null,$b=null){this.lV=$b;this.FK=mb;this.CK=Hb;this.Hf=Ua;this.h7=yb;this.$u=Yb;this.qz=qc;this.rp=Hc}kqk(mb){var Hb;(null===(Hb=xa.App.zd)||void 0===Hb?0:Hb.Uo)&&xa.App.zd.fq.gG(mb)}Iza(mb,Hb,Ua,Ya=!1){O.OutlineElementNavigator.Ee(mb);Ja.ParagraphReader.oh(mb)?cc.Tk.qq.Iza(mb,Hb,Ua):Xa.TableReader.isTable(mb)&&14===mb.Xe&&(Hb=(new ha.a(1,Ua)).Wt,Ua=Object(z.a)(Z.TableNode,mb.currentNode),this.Xnj(Ua,Hb,Ya));O.OutlineElementNavigator.Yd(mb)}Xnj(mb,Hb,Ua=!1){mb&&Object(v.a)(Z.TableNode,mb)&&
(Ua?Hb?(mb.setValue(x.a.ee,Hb),Hb=Xa.TableReader.hh(mb),cc.Mk.feg(mb,Hb)):mb.removeProperty(x.a.ee):mb.ee=Hb)}get qq(){return N.a.MGb}get uE(){return this.$u||(this.$u=l.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}get qc(){return this.qz||(this.qz=l.a.instance.resolve("Box4.Styles.IWACStyleReader"))}get Qd(){return null!=this.KIg?this.KIg:this.KIg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance}get Ej(){return null!=this.wIg?this.wIg:this.wIg=l.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance}get Qn(){return this.CK.value}get Jd(){return this.Hf.value}get BL(){return this.FK.value}get Yf(){return Bb.a.instance}get OD(){return null!=
this.zxg?this.zxg:this.zxg=l.a.instance.Oa("Box4.IContentControlConverter")}Jgb(){const mb=S.a.instance.createInstance(393229);mb.setValue(y.a.CL,W.a.first);mb.setValue(y.a.sgl,new Date);mb.Moc();return mb}jdl(){const mb=new lb.a;mb.setValue(y.a.CL,W.a.first);return mb}jhf(mb,Hb,Ua=!1){ba.OutlineElementReader.HHf(mb)?(mb=ba.OutlineElementReader.isRtl(mb),Ua?this.xQb(Hb,mb):this.wQb(Hb,mb)):this.G0n(Hb)}tlc(mb,Hb){const Ua=O.OutlineElementNavigator.El(mb);ba.OutlineElementReader.Pn(Ua)!==Hb&&(this.wQb(Ua,
Hb),mb.anchor.vY(4))}wQb(mb,Hb){const Ua=new Ka.GraphTransaction(7);Ua.Db(mb);this.xQb(mb,Hb);const Ya=new K.GraphIterator;Ya.set(mb);Oa.a.instance.mGm(Ya);if(Ya.zb(10)){const Fb=Ya.jd(10);Ya.Ub(1)===mb&&this.BL.wQb(Fb,Hb)}Ua.dispose()}xQb(mb,Hb){let Ua=null,Ya=null;if(F.a.instance.J(1)&&mb.isConnected){Ua=Ja.ParagraphReader.xw(mb,!0,!0);Ya=new H.a;for(let Fb=0;Fb<Ua.count;Fb++)12===Ua.J(Fb).type&&Ya.add(Ua.J(Fb).$D())}mb.properties.setValue(y.a.n1,Hb);if(F.a.instance.J(1)&&Ua&&Ya)if(Ua.count!==Ya.count)t.ULS.shipAssertTag(35973010,
376,!1,"Paragraph count [{0}] doesn't match PreviousFormatProp count [{1}]",Ua.count,Ya.count);else for(mb=0;mb<Ua.count;mb++)this.Ej.DV(Ua.J(mb),Ya.J(mb),this.Qd.xg)}G0n(mb){mb.properties.removeProperty(y.a.n1)}NH(mb,Hb=null,Ua=!1){var Ya,Fb=null;let Wa=null;if(!ba.OutlineElementReader.Eh(mb))return t.ULS.sendTraceTag(40502923,307,15,"GraphIterator does not point to an outline element."),null;let yb=null,Yb=null,qc=0;Hb&&(yb=Hb.formatting,Yb=Hb.Pka,qc=Hb.languageId);Ua||({sqa:Fb,JSa:Wa}=this.G4h(mb,
Fb,Wa));Hb=G.a.instance.createInstance(393230);Hb.setValue(y.a.wo,"");mb.Bf(Hb,2);mb.Aj(Hb);cc.Tk.ZOb(Hb);cc.Tk.W9m(Hb);cc.Tk.IVa(Hb);this.kqk(Hb);e.AFrameworkApplication.cI&&!e.AFrameworkApplication.lcj&&(e.AFrameworkApplication.oe("AutoRenameNewDocument-tf;AutoRenameNewDocument-cf"),(null===(Ya=e.AFrameworkApplication.K)||void 0===Ya?0:Ya.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoRenameNewDocument",!1))&&this.hJk());yb&&(Hb.qa.first.formatting.Yj=yb);qc||(qc=e.AFrameworkApplication.lcid);
mb.currentNode.Hg(y.a.c8c,mb.currentNode.ja(y.a.c8c,qc));mb.currentNode.setValue(x.a.dTa,0);Yb&&this.uE.aK(Yb,Hb,!0);!Ua&&Fb&&(Ua=new ua.a(Hb),Fb=new ia(Fb,Wa,Fb,Ua,Hb.$na),mb.currentNode.zJ().sF.IH(Fb));return Hb}hJk(){if(this.lV){for(var mb,Hb=this.lV.ylf();Hb;){const Ua=Hb.node;if(0<Ja.ParagraphReader.textLength(Ua,9)&&(mb=kb.AParagraphNode.$Xl(Ua.characterData.trim()),0<mb.length))break;Hb=Hb.next}mb&&32===e.AFrameworkApplication.va.Qb(fb.a.renameFile,2,mb)&&this.rp&&(this.rp.execute(Ua=>{Ua.logActivity("AutoRenameDocumentCallout",
null)}),k.a("AutoRenameDocumentSuccess"))}}G4h(mb,Hb,Ua){Ua=new K.GraphIterator;Ua.kd(mb);Hb=null;Ua.bFf?Ua.currentNode.zJ().sF.g8(6):(O.OutlineElementNavigator.h1(Ua,!0,!1),Hb=this.cSd(Ua));Ua.kd(mb);Ua=this.M5h(Ua);return{sqa:Hb,JSa:Ua}}M5h(mb){const Hb=new K.GraphIterator;Hb.kd(mb);mb=null;Hb.KGa||(O.OutlineElementNavigator.ns(Hb,!0,!1),mb=this.cSd(Hb));return mb}cSd(mb,Hb=!1){mb=O.OutlineElementNavigator.Ee(mb,!0);return mb?this.S$h(mb,Hb):(t.ULS.sendTraceTag(8451733,355,15,"No paragraph node below OutlineElement"),
null)}S$h(mb,Hb=!1){if(12===mb.type)return Hb?new ua.a(mb):new ka.a(mb);mb.zJ().sF.g8(5);return new ea.a(mb)}f_k(mb,Hb){var Ua=Hb.currentNode.clone();mb.ZH(Ua,null,1);mb.Aj(Ua);Ua.Pba=Hb.currentNode;O.OutlineElementNavigator.Ee(Hb);Hb.o9&1&&Hb.currentNode.uTb(null);Ua=Hb.currentNode.clone();Ua.hJa=Hb.currentNode.hJa;Ua.RL=Hb.currentNode.RL;mb.ZH(Ua,null,2);mb.Aj(Ua);mb.G0(1);Ua.Pba=Hb.currentNode;Ua.setValue(x.a.Wc,a.a.GF());Hb.rt(11)}ZOb(mb){mb.Ub(2)&&mb.zg()}c4n(mb,Hb){const Ua=mb.currentNode;O.OutlineElementNavigator.Ee(mb);
const Ya=mb.currentNode;O.OutlineElementNavigator.Yd(mb);Hb.EJ(1);O.OutlineElementNavigator.Ee(Hb);mb.Bf(Hb.currentNode,2);Hb.zg();var Fb=new K.GraphIterator;Fb.kd(Hb);if(Fb.Ub(1)){const Wa=new K.GraphIterator;Wa.kd(mb);const yb=new Y(null);if(!this.okm(Wa,Fb.currentNode,yb))return;L.g(Wa,null,1,1,Fb,-1)}Hb.zg();Fb=null;mb.QM(1)&&(Fb=mb.currentNode);for(mb.uc();V.OutlineNavigator.S9(Hb);)mb.ZH(Hb.currentNode,Fb,1),Fb=Hb.currentNode,Hb.zg();mb.Aj(Ua);mb.Aj(Ya);mb.zg()}S$(mb,Hb,Ua,Ya,Fb,Wa,yb=!1,Yb=
!1){var qc=ba.OutlineElementReader.Eh(mb),Hc=ba.OutlineElementReader.Eh(Hb),$b=Ua.isValid&&Ua.contextId===M.a.Uc;qc&&Hc&&$b||t.ULS.sendTraceTag(594642515,307,15,"sourceOutlineElementIsValid:{0}; destinationOutlineElementIsValid:{1}; ipContextIsValid:{2}",qc,Hc,$b);var Ub=mb.currentNode;this.ZOb(Hb);Hc=Hb.Xe;let mc,ic=null;qc=$b=null;let ab=!1;O.OutlineElementNavigator.Ee(mb);const bb=mb.Xe;if(Ja.ParagraphReader.oh(mb)){mc=mb.currentNode;($b=Object(z.a)(kb.AParagraphNode,mc))?$b.qa&&$b.qa.length||
t.ULS.sendTraceTag(38925760,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",$b):t.ULS.sendTraceTag(38925731,307,15,"srcParaNode is null");$b=new ua.a($b);(ab=Ua.cpBegin===Ja.ParagraphReader.textLength(mc))&&(qc=this.M5h(Hb));const Jb=Hb.currentNode;ic=this.NH(Hb,void 0,!0);cc.Tk.NUa(mb,Hb,Ua,Fb,Wa,yb,Yb);Ya?(Fb=this.qc.So(mc))&&this.uE.aK(Fb,ic,!0):ab&&(Fb=this.qc.So(mc))&&((Yb=Fb.ja(m.a.ae,null))?(Fb=this.qc.JB(ic).oj(Yb),this.uE.aK(Fb,ic,!1)):this.uE.aK(Fb,ic,!0));this.jhf(Ub,
Jb)}O.OutlineElementNavigator.Yd(mb);O.OutlineElementNavigator.Yd(Hb);O.OutlineElementNavigator.Ee(mb);(Ub=Object(z.a)(kb.AParagraphNode,mb.currentNode))?Ub.qa&&Ub.qa.length||t.ULS.sendTraceTag(38925762,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",Ub):t.ULS.sendTraceTag(38925761,307,15,"srcPara is null");Ub=new ua.a(Ub);O.OutlineElementNavigator.Yd(mb);(mb=ic)?mb.qa&&mb.qa.length||t.ULS.sendTraceTag(38925764,307,15,"paragraphNode: {0}. paragraphNode has no characterProperties.",
mb):(t.ULS.sendTraceTag(38925763,307,15,"paragraphNode is null"),t.ULS.sendTraceTag(40425482,307,50,"SplitAtIp state. {0}",{["splittingAtEnd"]:ab,["moveText"]:Wa,["overrideParagraphStyle"]:Ya,["sourceOutlineElementContentNodeType"]:bb,["destinationOutlineElementNodeType"]:Hc,["alwaysMoveEopToDestinationPara"]:yb}));ab?(Ua=new ua.a(mb),Ua=new ia($b,qc,Ub,Ua,mb.$na),Hb.currentNode.zJ().sF.IH(Ua)):(Ua=Wa?new za($b,Ua.cpBegin,Ub,new ua.a(mb),mb.$na):new za($b,Ua.cpBegin,new ua.a(mb),Ub,mb.$na),Hb.currentNode.zJ().sF.IH(Ua));
return mb}yBh(mb,Hb){O.OutlineElementNavigator.Ee(mb);let Ua=Ja.ParagraphReader.Bt(mb.currentNode)&&this.bTk(mb);const Ya=mb.currentNode;Ua=Hb?Ua&&!this.Yf.uAn(Ya):Ua&&!this.Yf.kAn(Ya);O.OutlineElementNavigator.Yd(mb);return Ua}bTk(mb){return Ja.ParagraphReader.oh(mb)&&!Ja.ParagraphReader.qgb(mb.currentNode)}merge(mb,Hb,Ua,Ya,Fb=null,Wa=!1,yb,Yb=!1,qc=!1,Hc=!1){var $b;if(mb.currentNode.id===Hb.currentNode.id)return!1;let Ub;const mc=new K.GraphIterator;mc.kd(Hb);yb=this.cSd(mc);mc.kd(mb);Ub=this.cSd(mc,
!0);if(!this.yBh(Hb,!0)||!this.yBh(mb,!1))return!1;if(this.Yf.jh){O.OutlineElementNavigator.Ee(mb);O.OutlineElementNavigator.Ee(Hb);var ic=Ja.ParagraphReader.oh(mb)?mb.currentNode:null,ab=Ja.ParagraphReader.oh(Hb)?Hb.currentNode:null;O.OutlineElementNavigator.Yd(mb);O.OutlineElementNavigator.Yd(Hb);if(ic&&ab&&!this.Yf.zBh(ic,ab,!1)){if(!this.OD||!this.Yf.zBh(ic,ab,!0))return!1;this.OD&&(this.OD.vDj(ic,!1),this.OD.vDj(ab,!0))}}ic=Object(z.a)(kb.AParagraphNode,mb.currentNode);ic=(Ua||!ic||!ic.characterData.length)&&
!hc.ListItemReader.lg(mb);Yb||this.Qn.merge(mb,Hb,ic,Fb);O.OutlineElementNavigator.Ee(mb);Fb=mb.currentNode.$na;O.OutlineElementNavigator.Ee(Hb);if(Ja.ParagraphReader.oh(Hb)){Yb=Hb.currentNode;if(null===($b=xa.App.zd)||void 0===$b?0:$b.Uo)if($b=mb.currentNode,ic=fa.CoauthLockEditor.getInstance(),ic.g8a(this.Yf.y9b(Yb))||ic.g8a(this.Yf.y9b($b)))return Hb.uc(),mb.uc(),!1;$b=!1;(Yb=mb.parentNode)&&ba.OutlineElementReader.Epa(Yb)&&($b=hc.ListItemReader.lg(Yb));(Yb=this.wro(Ja.ParagraphReader.isEmpty(mb),
$b,Ua,Ya,qc))&&(ic=this.qc.Xuf(Hb))&&this.uE.aK(ic,mb.currentNode,!0);Ua&&(ic=Hb.currentNode,ab=mb.currentNode,(Yb||$b)&&Ma.b(ic,ab),qc&&Ya||this.h7.XOi(ic,ab,$b),e.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordPreserveEopFormattingPasteSettings"),Hc&&(qc=this.b8k(ab,ic),t.ULS.sendTraceTag(588288132,307,50,"wasCopied: {0}",qc)));Ua=cc.Tk.merge(mb,Hb,Ua,Ya,Wa);Wa=mc.currentNode;Ya=mb.currentNode;mb.uc();Ua&&ba.OutlineElementReader.isEmpty(Hb,!0)&&this.r1a(Hb);mb=new pa(Ub,
yb,new ka.a(Wa),Fb);Ya.zJ().sF.IH(mb);return!0}Hb.uc();mb.uc();return!1}b8k(mb,Hb){let Ua=null;Hb&&Hb.qa&&0<Hb.qa.length&&Hb.qa.first.Ph&&(Ua=Hb.qa.first.formatting);return Ua&&mb&&mb.qa&&0<mb.qa.length&&R.FormattingReader.v5k(mb.qa)?(mb.qa.last.formatting=Ua.vf(mb.qa.last),!0):!1}wro(mb,Hb,Ua,Ya,Fb){return Hb?!1:Ua?!(Ya&&Fb):mb}tEm(mb){const Hb=new K.GraphIterator;Hb.set(mb.node);Hb.qd();O.OutlineElementNavigator.Yd(Hb);const Ua=this.npa(Hb),Ya=this.npa(Hb);this.S$(Hb,Ua,mb,!1,!0,!0);ba.OutlineElementReader.isEmpty(Hb,
!1)&&(this.Qn.Yda(Hb),Hb.zg());ba.OutlineElementReader.isEmpty(Ua,!1)&&!ba.OutlineElementReader.plb(Ua)&&(this.Qn.Yda(Ua),Ua.zg());return Ya}My(mb,Hb,Ua,Ya=null,Fb=!1,Wa=!0){if(!this.YSk(mb))return null;const yb=mb.currentNode;var Yb=!1;Wa&&(Yb=hc.ListItemReader.lg(mb),Fb=Hb||Fb||!ba.OutlineElementReader.isEmpty(mb,!1),Yb=this.Qn.Xuo(Yb,Fb));Fb=Hb?mb.QM(1):mb.currentNode;mb.uc();Ua=this.BL.Fkb(mb,Fb,Ua,Ya);if(!Ua)return null;this.jhf(yb,Ua);Wa&&Yb&&this.Qn.rNo(mb,Hb,yb,Ua);return Ua}YSk(mb){return ba.OutlineElementReader.Eh(mb)&&
(mb=mb.parentNode,Q.OutlineReader.i0d(mb)||ba.OutlineElementReader.Epa(mb)||ba.OutlineElementReader.BRa(mb))?!0:!1}kza(mb){const Hb=new K.GraphIterator;Hb.set(mb);Hb.qd();Hb.rt(11);let Ua=null,Ya=null;({sqa:Ua,JSa:Ya}=this.G4h(Hb,Ua,Ya));let Fb=-1;12===mb.type&&(Fb=mb.$na);Hb.currentNode?(Hb.currentNode.zJ().sF.IH(new Ga(this.S$h(mb,!0),Ua,Ya,Fb)),this.r1a(Hb)):t.ULS.sendTraceTag(574650269,324,15,"The content to be deleted does not have a containing OE")}r1a(mb){if(mb.Jt(1)){const Hb=new sa,Ua=new K.GraphIterator;
Ua.kd(mb);this.ZOl(Ua,Hb)&&this.qq.ILc(mb,-Hb.O6b)}mb.zg();Xa.TableReader.lx(mb)&&this.qFn(mb)}vCf(mb,Hb,Ua){if(!Q.OutlineReader.mx(mb)&&!ba.OutlineElementReader.Eh(mb))return null;const Ya=this.jdl();0<Ua&&Ua<W.a.last&&Ya.setValue(y.a.CL,Math.min(W.a.nil,Ua));mb.ZH(Ya,Hb,1);return Ya}vEm(mb,Hb){if(!ba.OutlineElementReader.Eh(mb)&&!ba.OutlineElementReader.sL(mb)||!Q.OutlineReader.Nxa(mb.parentNode)&&!ba.OutlineElementReader.Epa(mb.parentNode))return null;const Ua=mb.currentNode;let Ya;Ya=mb.currentNode;
mb.uc();Hb=this.vCf(mb,Ya,Hb);mb.Aj(Ua);return Hb}qFn(mb){ba.OutlineElementReader.sL(mb)&&(mb.Jt(1)||mb.zg());this.q1h(mb,!1);this.qsh(mb)}q1h(mb,Hb){var Ua,Ya=null;for(Ua=mb.Ub(1);Ua;){var Fb=!1;ba.OutlineElementReader.BRa(Ua)&&!mb.Jt(1)&&(Fb=!0);var Wa=Ua;Ua=mb.Ti(1);if(Fb)Fb=new K.GraphIterator,Fb.set(Wa),Fb.qd(),Fb.zg();else if(ba.OutlineElementReader.BRa(Wa)){if(Ya){Fb=new K.GraphIterator;Fb.set(Ya);var yb=new K.GraphIterator;yb.set(Wa);yb.qd();Fb.Bf(yb.currentNode,1);yb.zg();yb=ba.OutlineElementReader.Gha(Wa);
yb===W.a.nil&&(yb=1);const Yb=ba.OutlineElementReader.Gha(Wa);(yb=Math.max(0,Yb-yb))?Wa.setValue(y.a.CL,Math.min(W.a.nil,yb)):(Fb.Aj(Wa),mb.Ub(1),L.e(Fb),Fb.uc());Hb&&this.q1h(Fb,!0)}}else Ya=Wa}Hb=null;Ya=W.a.last+1;for(Ua=mb.Ub(1);Ua;Ua=mb.Ti(1))if(ba.OutlineElementReader.sL(mb))Wa=ba.OutlineElementReader.Gha(Ua),Ya>Wa&&(Ya=Wa,Hb=Ua);else{mb.uc();return}if(Hb){for(Ua=mb.Ub(1);Ua;Ua=mb.Ti(1))Ua!==Hb&&(Ua=ba.OutlineElementReader.Gha(Ua),mb.currentNode.setValue(y.a.CL,Math.min(W.a.nil,Ua-Ya)));Ya+=
ba.OutlineElementReader.Gha(mb.currentNode);mb.currentNode.setValue(y.a.CL,Math.min(W.a.nil,Ya));Ua=new K.GraphIterator;Ua.kd(mb);Ua.Aj(Hb);Ua.Ub(1);L.e(Ua)}}okm(mb,Hb,Ua){var Ya=ba.OutlineElementReader.Gha(mb.currentNode);if(1===Ya)return!0;if(ba.OutlineElementReader.sL(mb))return!1;if(!mb.Rib(1)||this.vRm(mb,Hb))return mb.currentNode.setValue(y.a.CL,Math.min(W.a.nil,1)),!0;if(Ua.rqa&&mb.Aj(Ua.rqa)){if(ba.OutlineElementReader.sL(mb)&&1===Ya+ba.OutlineElementReader.Gha(mb.currentNode))return Ua.rqa=
mb.EJ(1),mb.uc(),!0;mb.uc()}if(Ua.rqa&&mb.Aj(Ua.rqa)||!Ua.rqa&&mb.Ub(1)){if(mb.currentNode!==Hb&&mb.Mf(1)&&ba.OutlineElementReader.sL(mb)&&1===Ya+ba.OutlineElementReader.Gha(mb.currentNode))return Ua.rqa=null,!0;mb.uc()}if(mb.Tjb(Hb)&&this.uRm(mb,Hb)){for(Ua=mb.Ub(1);Ua;Ua=mb.Ti(1))if(Ua!==Hb){var Fb=ba.OutlineElementReader.Gha(Ua);Ua.setValue(y.a.CL,Math.min(W.a.nil,Fb+(Ya-1)))}mb.currentNode.setValue(y.a.CL,Math.min(W.a.nil,1));return!0}if(1>Ya)return Ya=this.vCf(mb,Ua.rqa,1-Ya),mb.Aj(Ya),Ua.rqa=
null,!0;if(1<Ya){mb.currentNode.setValue(y.a.CL,Math.min(W.a.nil,1));Hb=null;for(Fb=mb.Ub(1);Fb;){if(ba.OutlineElementReader.sL(mb)){Fb.setValue(y.a.CL,Math.min(W.a.nil,Ya-1+ba.OutlineElementReader.Gha(Fb)));Fb=mb.Ti(1);continue}Hb||(Hb=this.vEm(mb,Ya-1));const Wa=Fb;Fb=L.i(mb,Hb,1);Fb===Hb&&(Fb=mb.Ti(1));Ua.rqa===Wa&&(Ua.rqa=Hb,Hb=null)}return!0}return!1}vRm(mb,Hb){return K.GraphIterator.lca(()=>{if(1===mb.Rib(1)){const Ua=mb.Ub(1);mb.uc();if(Ua===Hb)return!0}return!1})}uRm(mb,Hb){return K.GraphIterator.lca(()=>
{let Ua;for(Ua=mb.Ub(1);Ua;Ua=mb.Ti(1))if(Ua!==Hb&&!ba.OutlineElementReader.sL(mb))return mb.uc(),!1;return!0})}ZOl(mb,Hb){Hb.O6b=0;do{const Ua=mb.currentNode;if(mb.Ub(1))Hb.O6b-=ba.OutlineElementReader.Gha(Ua);else{if(Q.OutlineReader.mx(mb)||null===mb.currentNode)return!1;if(3!==mb.role||!mb.aia(1))for(;!mb.Ti(1);)if(Hb.O6b+=ba.OutlineElementReader.Gha(mb.currentNode),Q.OutlineReader.mx(mb)||null===mb.currentNode)return!1}}while(ba.OutlineElementReader.sL(mb));return!0}npa(mb,Hb=!1){return this.cYd(mb,
!1,Hb)}sEm(mb){return this.cYd(mb,!0,!1)}cYd(mb,Hb,Ua=!1){const Ya=new K.GraphIterator;Ya.kd(mb);mb=new K.GraphIterator;mb.kd(Ya);this.My(mb,Hb,!1,null,Ua);mb.currentNode.setValue(y.a.CL,Math.min(W.a.nil,ba.OutlineElementReader.Gha(Ya.currentNode)));Ya.Ub(1)&&L.g(mb,null,1,1,Ya,-1);return mb}qsh(mb){if(ba.OutlineElementReader.O5n(mb)){1!==ba.OutlineElementReader.Gha(mb.currentNode)&&mb.currentNode.setValue(y.a.CL,W.a.first);for(var Hb=mb.Ub(1);Hb;)if(ba.OutlineElementReader.sL(mb)){Hb=new K.GraphIterator;
Hb.kd(mb);Hb.uc();const Ua=new K.GraphIterator;Ua.kd(mb);Ua.Ub(1);L.g(Hb,mb.currentNode,1,1,Ua,-1);Hb=mb.hhb(1)}else this.qsh(mb),Hb=mb.Ti(1)}}static get Mk(){return null!=cc.WHg?cc.WHg:cc.WHg=l.a.instance.resolve("Box4.ITableEditor")}static get Tk(){return cc.Ys||(cc.Ys=l.a.instance.resolve("Box4.IParagraphEditor"))}static set Tk(mb){cc.Ys=mb}}cc.Ys=null;Object(D.a)(cc,"OutlineElementEditor",null,[517])},1990:function(D,I,c){D=c(0);var l=c(139),e=c(45),a=c(22),k=c(2),x=c(60),y=c(646),m=c(93),t=c(86),
z=c(399),v=c(357),H=c(19),F=c(358),G=c(55),M=c(181),K=c(42),L=c(34),R=c(13),S=c(1602),N=c(1712),O=c(119),W=c(6),V=c(16),Q=c(174),Y=c(7),ba=c(457),Z=c(689),ea=c(578),ha=c(1035),ka=c(117),ua=c(18),sa=c(252),Da=c(254),Pa=c(26),Ra=c(35);class Ga{constructor(Ma){this.iz=null;this.X6g=!1;this.As=null;this.lM=new S.a;this.GEe=new S.a;this.zc=Ma}get qnb(){Ra.a(4281429,307,this.lM.count===this.GEe.count);return this.lM.count}get A4d(){return this.X6g}set A4d(Ma){this.X6g=Ma}H3b(Ma){this.iz=Ma}get JX(){return null}ysh(Ma,
fb){this.lM.add(Ma);this.GEe.add(fb)}}Ga.Mmb=2712;Object(D.a)(Ga,"APicturePasteHandler",null,[719]);var ta=c(257),va=c(3),ia=c(10),qa=c(1167),pa;(function(Ma){Ma[Ma.unknown=0]="unknown";Ma[Ma.other=1]="other";Ma[Ma.file=2]="file";Ma[Ma.blob=3]="blob";Ma[Ma.Zfp=4]="chromeExtension";Ma[Ma.cid=5]="cid"})(pa||(pa={}));Object(D.b)("UnsupportedUrlScheme",pa);var Fa=c(262),za=c(43),Oa=c(8),xa=c(1871),fa=c(1872),Ka=c(1800);class lb{constructor(){this.delay=this.retry=0}}Object(D.a)(lb,"ForceInboundData",
null,[]);class Xa{constructor(Ma,fb,hc,cc){this.fWd=!1;this.request=Ma;this.F5n=fb;this.url=cc;this.HEm=hc}}Object(D.a)(Xa,"PicturePasteRequestInfo",null,[]);var kb=c(396);c.d(I,"a",function(){return Ja});const Bb=["ImageInsertFailed"];class Ja extends Ga{constructor(Ma,fb,hc,cc,mb,Hb=null,Ua=null,Ya=!1,Fb=null,Wa=null){super(Ma);this.Yl=l.a.nil;this.lB=new S.a;this.GMa=0;this.lyc=this.feh=null;this.pch=!1;this.lBc=null;this.fmd=new S.a;this.Xo=null;this.MGn=()=>{var yb=this.UOl(),Yb=131073;this.T9j&&
(Yb=1073872970);yb=e.a.No(yb,ba.a.cellId,this.As.Gm.toString());yb=e.a.No(yb,ba.a.JX,this.Yl.toString());yb=e.a.No(yb,ba.a.classId,Yb.toString());this.As.TH&&(yb=e.a.No(yb,ba.a.TH,this.As.TH));yb=e.a.No(yb,ba.a.jsb,"1");yb=e.a.No(yb,Z.a.imageType,"1");yb=ta.a.instance.O_e(yb);let qc=0;Yb=yb;var Hc=new S.a;const $b=new S.a,Ub=new S.a,mc=new S.a,ic=new S.a,ab=new S.a;var bb="",Jb=a.a.instance.Oa("Box4.IFeatureHelper");Jb=!!Jb&&Jb.isFeatureEnabled(10)&&Jb.isFeatureEnabled(50);for(let Qb=0;Qb<this.qnb;Qb++){var Eb=
this.GEe.J(Qb);Y.ULS.shipAssertTag(7869452,307,!!Eb.src);Y.ULS.shipAssertTag(7869453,307,""!==Eb.src);Y.ULS.shipAssertTag(7869454,307,19922944>Eb.src.length);const Vb=this.lM.J(Qb);var hb=Vb.node.ja(O.a.QJ,Fa.a.Pt);this.iXo(Vb.blob,Eb);var ob=Eb.alt;var Va=Eb.Pll;Va||(Va=ob,ob="");const Sb=Vb.blob;hb=xa.a.construct(Sb?Sb.id.toString():Vb.node.id.toString(),Eb.src,ob,Eb.width,Eb.height,Va,hb,Vb.IU,!!Sb&&Sb.properties.ja(W.a.tia,!1),Sb?Sb.properties.ja(O.a.iha,-1):-1,Sb?Sb.properties.ja(W.a.Dmb,Box4Intl.Box4Strings.l_Picture):
"",Vb.node.properties.ja(V.a.Lxa,!1),null,null,null,Eb.EGd);Eb.src.startsWith("data:")?(Va=!1,Jb&&Eb.EGd?(Va=!0,Eb=ic,ob=ab):(Eb=Ub,ob=mc),Eb.add(hb),ob.add(Vb),Va=fa.a.construct(Eb.toArray(),!Va,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.As.zr:null,Va),Va=L.c(Va),Va.length>Ja.Pbn?(Y.ULS.shipAssertTag(7869456,307,1<Eb.count),Eb.remove(hb),ob.remove(Vb),Va=this.lB.count?(new x.a(this.Yl,qc)).toString():this.As.contentReplicator.Pu.toString(),Yb=e.a.No(Yb,ba.a.Yua,
Va),Yb=e.a.No(Yb,ba.a.Xhc,qc.toString()),ua.ImageReader.eBf&&(Yb=e.a.No(Yb,ba.a.oTb,"1")),this.lB.add(new Xa(fa.a.construct(Eb.toArray(),!0,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.As.zr:null),bb,ob,Yb)),qc+=Ub.count,Eb=new S.a,Eb.add(hb),ob=new S.a,ob.add(Vb)):bb=Va):(Hc.add(hb),$b.add(Vb))}Ub.count&&(Yb=yb,Va=this.lB.count?(new x.a(this.Yl,qc)).toString():this.As.contentReplicator.Pu.toString(),Yb=e.a.No(Yb,ba.a.Yua,Va),Yb=e.a.No(Yb,ba.a.Xhc,qc.toString()),
ua.ImageReader.eBf&&(Yb=e.a.No(Yb,ba.a.oTb,"1")),bb=fa.a.construct(Ub.toArray(),!0,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.As.zr:null),this.lB.add(new Xa(bb,L.c(bb),mc,Yb)),qc+=Ub.count,this.fmd.add(Ja.vmf));Hc.count&&(Yb=yb,Va=this.lB.count?(new x.a(this.Yl,qc)).toString():this.As.contentReplicator.Pu.toString(),Yb=e.a.No(Yb,ba.a.Yua,Va),Yb=e.a.No(Yb,ba.a.Xhc,qc.toString()),Yb=e.a.No(Yb,ba.a.oTb,"1"),Hc=fa.a.construct(Hc.toArray(),!1,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?
this.As.zr:null),this.lB.add(new Xa(Hc,L.c(Hc),$b,Yb)),k.AFrameworkApplication.Oia("WoInc325;WoInc325cf"),this.fmd.add(this.wWg));ic.count&&(Yb=yb,Va=this.lB.count?(new x.a(this.Yl,qc)).toString():this.As.contentReplicator.Pu.toString(),Yb=e.a.No(Yb,ba.a.Yua,Va),Yb=e.a.No(Yb,ba.a.Xhc,qc.toString()),Yb=e.a.No(Yb,ba.a.oTb,"1"),yb=fa.a.construct(ic.toArray(),!1,k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.As.zr:null,!0),this.lB.add(new Xa(yb,L.c(yb),ab,Yb)),this.fmd.add(this.wWg));
Y.ULS.sendTraceTag(595068930,307,50,"Prepared "+(this.lB?this.lB.count:-1)+" picture paste requests to send");this.Jpb()};this.picturePasteRequestSucceeded=yb=>{var Yb;Y.ULS.sendTraceTag(572528019,307,50,"PicturePasteRequestSucceeded received response with Http status: {0}",this.m0l(yb));if(({group:qc}=ea.a.d2(yb.data.se)).returnValue){var qc=qc.Responses[0];if(qc.StatusCode)if(46!==qc.StatusCode||this.lB.J(this.GMa).fWd){Y.ULS.sendTraceTag(51212675,322,15,"Picture paste request failed with reason "+
qc.StatusCode);yb=Object.assign(new ka.a,{extendedProperties:new Map});yb.extendedProperties.set("statuscode",qc.StatusCode.toString());if(null===(Yb=k.AFrameworkApplication.K)||void 0===Yb?0:Yb.$("ShouldLogPicturesExtendedHealthKpis")){var Hc={name:kb.c.mbc,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:yb};yb.extendedProperties.set("ErrorLevel","warning");this.rg.logKpiFailure({kpiName:kb.c.ZFa,errorName:"PictureRemotePasteFailed",
optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:yb},optionalVeto:Hc})}else t.Health.instance.recordQosError("PictureRemotePasteFailed",Bb,!1,!0,!1,!1,yb);this.Xom()}else this.lB.J(this.GMa).fWd=!0,this.Jpb();else{qc=Yb="";yb&&yb.data&&yb.data.Dj&&(Z.a.gI in yb.data.Dj&&yb.data.Dj[Z.a.gI]&&(qc=yb.data.Dj[Z.a.gI]),"X-CorrelationId"in yb.data.Dj&&yb.data.Dj["X-CorrelationId"]&&(Yb=yb.data.Dj["X-CorrelationId"]));Y.ULS.sendTraceTag(595068929,307,50,"PicturePasteRequestSucceeded called.[Status code: {0}][X-CorrelationID: {1}]",
qc,Yb);(null===(Hc=k.AFrameworkApplication.K)||void 0===Hc?0:Hc.$("ShouldLogPicturesExtendedHealthKpis"))&&this.rg.logKpiSuccess({kpiName:kb.c.ZFa});this.lBc&&(this.lBc.stop(),this.lBc=null);this.GMa++;this.tEj&&this.Jpb();this.feh=this.As.contentReplicator.Pu;let $b=null;$b=Object.assign(new lb,{retry:0,delay:this.fmd.J(this.GMa-1)});yb=new m.a(2,1,Ja.vmf,()=>{this.As.contentReplicator.X1f(this.G2h,$b)},124);this.Ib.Wb(yb)}}else Y.ULS.sendTraceTag(7869457,307,10,"PicturePasteRequestSucceeded received null or empty server response group"),
yb=new y.a(yb.data),this.eic(yb)};this.G2h=yb=>{const Yb=!x.a.Dq(this.feh,this.As.contentReplicator.Pu);Y.ULS.sendTraceTag(8246492,307,50,"Revision changed after ForceInbound: {0}",Yb);if(Yb)this.qBh();else{const qc=yb?yb:null;if(yb&&qc&&qc.retry<Ja.LIl){qc.retry+=1;yb=new m.a(2,1,qc.delay,()=>{this.As.contentReplicator.X1f(this.G2h,qc)},125);this.Ib.Wb(yb);return}yb=Ja.vmf;null!=qc&&(yb=qc.delay);yb=new m.a(2,1,yb,()=>{this.As.contentReplicator.X1f(null,null)},125);this.Ib.Wb(yb);this.rBh()}Ja.BUf--;
k.AFrameworkApplication.va.processAction(R.a.t9a,2);Ka.a.instance.Voc(this.As,0);this.Ivg();this.Gv.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)};this.eic=yb=>{var Yb,qc="",Hc="";yb&&yb.data&&yb.data.Dj&&("X-CorrelationId"in yb.data.Dj&&yb.data.Dj["X-CorrelationId"]&&(qc=yb.data.Dj["X-CorrelationId"]),Z.a.gI in yb.data.Dj&&yb.data.Dj[Z.a.gI]&&(Hc=yb.data.Dj[Z.a.gI]));Hc=""===Hc?"":String.format("[Operation Result: {0}]",Hc);qc=""===qc?"":String.format("[X-CorrelationID: {0}]",qc);Y.ULS.sendTraceTag(51212676,
322,15,"Picture paste request failed.[HttpStatus: {2}] [Connection state: {3}]{0}{1}",Hc,qc,yb.data.Se,z.SessionStatusManager.instance.cD);9===yb.data.status||this.lB.J(this.GMa).fWd?(Ka.a.instance.Voc(this.As,127),this.YCh(),this.lBc=null,(null===(Yb=k.AFrameworkApplication.K)||void 0===Yb?0:Yb.$("ShouldLogPicturesExtendedHealthKpis"))?(yb=Object.assign(new ka.a,{extendedProperties:new Map([["HttpStatus",String(yb.data.Se)],["ConnectionState",String(z.SessionStatusManager.instance.cD)],["OperationResult",
Hc],["CorrelationId",qc],["ErrorLevel","warning"]])}),this.rg.logKpiFailure({kpiName:kb.c.ZFa,errorName:"PictureRemotePasteFailed",optionalProperties:{isIntentional:!1,isInternal:!0,additionalValues:yb},optionalVeto:{name:kb.c.mbc,errorNameOverride:null,isIntentional:!1,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:null}})):t.Health.instance.recordQosError("PictureRemotePasteFailed",Bb,!1,!0,!1,!1,null)):(this.lB.J(this.GMa).fWd=!0,this.Jpb())};this.rg=v.a.getInstance(kb.a);
this.Vj=fb;this.Ib=hc;this.Qm=cc;this.je=ia.App.za.Lq;this.HEe=Hb;this.A7=Ua;this.vak=Ya;this._operationId=Fb;this.lik=Wa;this.wWg=k.AFrameworkApplication.K.mc("PicturePasteHttpForceInboundDelay",3E3);this.pch=this.K?this.K.$("ProvideUnsupportedUrlSchemeIsEnabled"):!1;ia.App.Bnc.addHandler(this);this.T9j=!!mb&&mb.isFeatureEnabled(121)}get Gv(){return this.Xo||(this.Xo=a.a.instance.resolve("Common.Utils.IAriaNotifier"))}get K(){return k.AFrameworkApplication.K}get dic(){return ia.App.dic}get eOi(){return this.qnb===
ia.App.iPf}get tEj(){return this.GMa!==this.lB.count}Ivg(){k.AFrameworkApplication.K&&k.AFrameworkApplication.K.$("WordEditorInsertImagesFloodgateIsEnabled")&&window.setTimeout(()=>{const Ma=a.a.instance.Ta("Common.ISystemInitiatedFeedback");Ma&&Ma.execute(fb=>{fb.logActivity("WordInsertImageApplied","WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}get JX(){return this.Yl}xya(Ma){var fb;Ma.alt.length>Ga.Mmb&&(Ma.alt=Ma.alt.substring(0,H.a.Kz(Ma.alt,Ga.Mmb)?Ga.Mmb-1:Ga.Mmb));this.rg.logKpiUsage({kpiName:kb.c.ZFa,
kpiType:0});if(this.A7&&Ja.BOm(Ma)){this.vak&&K.c(va.a.eBl);var hc="unknown";this.pch&&(Ma=new URL(Ma.src),hc=pa[qa.a.DTo(Ma.protocol)]);Y.ULS.sendTraceTag(41969745,322,15,"Unable to paste image with local URL. OperationId: {0}, URL scheme: {1}, rtfDataStatus: {2}",this._operationId,hc,this.lik);Ma=Object.assign(new ka.a,{extendedProperties:new Map});Ma.extendedProperties.set("protocol",hc);(null===(fb=k.AFrameworkApplication.K)||void 0===fb?0:fb.$("ShouldLogPicturesExtendedHealthKpis"))?(fb={name:kb.c.mbc,
errorNameOverride:null,isIntentional:!0,isInternal:!0,alertOnPillar:!1,isSessionEndingError:!1,additionalValues:Ma},Ma.extendedProperties.set("ErrorLevel","warning"),this.rg.logKpiFailure({kpiName:kb.c.ZFa,errorName:"PictureRemoteWithLocalPath",optionalProperties:{isIntentional:!0,isInternal:!0,additionalValues:Ma},optionalVeto:fb})):t.Health.instance.recordQosError("PictureRemoteWithLocalPath",Bb,!0,!0,!1,!1,Ma);this.myo()}else fb=new F.DictionaryPropertySet,Ma=this.Ghj(Ma),null!==Ma.EGd&&Ma.EGd.type===
N.b.Chart&&fb.setValue(W.a.Qs,7),this.Vj.xae(fb,Ma.width,Ma.height,!0),Y.ULS.shipAssertTag(7869444,307,Oa.ParagraphReader.Xb(this.zc.currentNode)),this.lBc=this.je.Zf("WebServiceCall",Ja.qDn),Y.ULS.sendTraceTag(20505094,322,50,String.format("ImagePasteRequest img width: {0}, height {1}",Ma.width,Ma.height)),hc=Pa.a.tw(this.zc.currentNode),fb=this.Vj.fYd(hc,fb),this.ysh(fb,Ma)}$Xf(){0<this.qnb&&(this.Yl=l.a.create(),this.As=this.lM.J(0).node.Yi(),Y.ULS.sendTraceTag(38122840,307,50,"Pasted pictures: {0}",
this.qnb),this.A4d&&(Y.ULS.sendTraceTag(38122841,307,15,"MaxPicturesExceeded in paste."),this.sxo()),Ka.a.instance.Hqg(this.As),this.Ivg(),this.As.contentReplicator.forceOutbound(this.MGn,null,null))}$ge(Ma){if(0<this.qnb){const hc=Ma.ja(W.a.tia,!1),cc=Ma.ja(Q.a.RYc,!1),mb=Ma.ja(Q.a.P4,!1);Ma=Ma.ja(O.a.iha,-1);for(let Hb=0;Hb<this.lM.count;Hb++){var fb=this.lM.J(Hb).blob;fb&&(fb=fb.properties,fb.setValue(W.a.tia,hc),fb.setValue(Q.a.RYc,cc),fb.setValue(Q.a.P4,mb),fb.setValue(O.a.iha,Ma),this.Vj.jbg(fb,
Ma))}}}k6a(){}Ghj(Ma){var fb=sa.WordSectionNavigator.instance.yL(this.zc.Gn);if(!fb)return Ma;var hc=G.a.Qi(Ja.Uf.GB(fb)-Ja.Uf.Nwa(fb)-Ja.Uf.Ioa(fb),1);fb=G.a.Qi(Ja.Uf.qu(fb)-Ja.Uf.CJ(fb)-Ja.Uf.mL(fb),0);Y.ULS.shipAssertTag(7869449,307,0<=hc);Y.ULS.shipAssertTag(7869450,307,0<=fb);if(Ma.height>hc){const cc=hc/Ma.height;Ma.height=hc;Ma.width=Math.floor(Ma.width*cc)}Ma.width>fb&&(hc=fb/Ma.width,Ma.width=fb,Ma.height=Math.floor(Ma.height*hc));return Ma}myo(){const Ma=Box4Intl.Box4Strings.l_PastedImageFailedWithInvalidUrl;
if(!this.lyc||this.lyc.message!==Ma&&!this.lyc.Mpa)this.lyc=this.A7.Cva(Ma,!1),this.A7.sA(this.lyc)}UOl(){if(this.HEe&&this.HEe.Nlp())return this.HEe.Xjp();var Ma=new Sys.Net.WebRequest;Ma.set_url("PicturePaste.ashx");Ma=Ma.getResolvedUrl();k.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")||(Ma=e.a.No(Ma,ba.a.fileId,this.As.zr));return Ma}iXo(Ma,fb){if(Ma&&fb){const hc=G.a.nf(ua.ImageReader.ZC(Ma.properties),0);Ma=G.a.nf(ua.ImageReader.WH(Ma.properties),1);0<hc&&hc<fb.width&&
(fb.width=hc,fb.height=Ma)}}Jpb(){const Ma={},fb=l.a.create().toString();Ma[Ja.correlationID]=fb;k.AFrameworkApplication.He.mj(this.lB.J(this.GMa).url,2,this.lB.J(this.GMa).F5n,Ma,!1,2,this.picturePasteRequestSucceeded,this.eic,null,void 0,void 0,void 0,void 0,"26");Ja.BUf++;Y.ULS.sendTraceTag(572528018,307,50,"SendPicturePasteRequest PicturePaste request added to the queue with correlation id : {0}",fb)}m0l(Ma){return Ma&&Ma.data?Ma.data.Se:-1}Xom(){Ka.a.instance.Voc(this.As,127);this.YCh()}YCh(){Y.ULS.shipAssertTag(7869458,
307,this.tEj);const Ma=new za.GraphTransaction(15);Ma.Db(this.lM.J(0).node);for(let fb=this.GMa;fb<this.lB.count;fb++){const hc=this.lB.J(fb).HEm;for(let cc=0;cc<hc.count;cc++){const mb=hc.J(cc).blob.properties;this.Vj.rUa(mb,Box4Intl.Box4Strings.l_PastedImageFailed);ua.ImageReader.hmj(mb,ha.a.failed)}}Ma.dispose();this.Qm.Q4b(this.As,!1);this.pBh()}sxo(){const Ma=new M.StandardDialog;Ma.Cd=0;Ma.vx(0,Box4Intl.Box4Strings.l_MaxPicturesExceededTitle,String.format(Box4Intl.Box4Strings.l_MaxPicturesExceededMessage,
ia.App.iPf),null,!0);k.AFrameworkApplication.va.processAction(va.a.D1i,2)}Wpn(Ma,fb){Ma.alt.length>Ga.Mmb&&(Ma.alt=Ma.alt.substring(0,H.a.Kz(Ma.alt,Ga.Mmb)?Ga.Mmb-1:Ga.Mmb));const hc=new F.DictionaryPropertySet;this.Vj.xae(hc,Ma.width,Ma.height);fb=this.Vj.fYd(fb,hc);Ma=this.Ghj(Ma);this.ysh(fb,Ma)}pBh(){}qBh(){}rBh(){}xWd(){return!!Ja.BUf}static get Uf(){return Da.a.instance}static BOm(Ma){return!!Ma&&!!Ma.src&&!qa.a.oDi(Ma.src)}}Ja.vmf=1E3;Ja.LIl=4;Ja.qDn="PicturePasteRequestTime";Ja.correlationID=
"X-CorrelationId";Ja.BUf=0;Ja.Pbn=20971520;Object(D.a)(Ja,"Box4ImageSteward",Ga,[570])},1992:function(D,I,c){D=c(0);var l=c(54),e=c(91),a=c(11),k=c(28);class x extends Sys.UI.Control{constructor(G,M,K,L){super(document.createElement("div"));this.LZ=this.dla=this.ZL=this.ew=this.d3=this.z$a=this.Rcb=null;this.dwc=this.wbb=!1;this.content=this._title=null;this.Rka=0;this.fxh=null;this.Bga=0;this.BYi=null;this.Tih=G;this.XZb=M;this.tk=K;this.RFh=L;this.jj=M.ownerDocument;this.wWd=this.Kt=this.hT=!1}get d$(){this.Rcb||
(this.Rcb=this.jj.createElement("div"),this.Rcb.id=this.qj("WACCalloutOuter"),this.Rcb.className="WACCalloutOuter",this.Rcb.setAttribute(k.a.uh,k.a.Lvh),this.Rcb.style.width=this.Rka+"px");return this.Rcb}get kHc(){if(!this.z$a){this.z$a=this.jj.createElement("div");this.z$a.id=this.qj("WACCalloutBeakContainer");this.z$a.className="WACCalloutBeakContainer";var G="CalloutBeakTopFilled_32x16x32";if(5===this.Bga||6===this.Bga||4===this.Bga)G="CalloutBeakBottomFilled_32x16x32";G=e.createClusteredImage(32,
16,G,"WACCalloutBeak",!0,"");this.z$a.appendChild(G)}return this.z$a}set kHc(G){this.z$a=G}get aI(){return this.hT}get title(){return this._title}set title(G){this._title!==G&&(this._title=G,this.dla&&(this.dla.innerText=this._title))}get Kt(){return this.wbb}set Kt(G){this.wbb!==G&&(this.wbb=G,this.d3&&(this.d3.contains(this.ZL)&&!this.wbb?this.d3.removeChild(this.ZL):!this.d3.contains(this.ZL)&&this.wbb&&this.toh()))}get wWd(){return this.dwc}set wWd(G){this.dwc!==G&&(this.dwc=G,this.d3&&(this.d3.contains(this.dla)&&
!this.dwc?this.d3.removeChild(this.dla):!this.d3.contains(this.dla)&&this.dwc&&this.eqh()))}show(){this.hT||(this.cal(),this.dJ(),this.XZb.appendChild(this.d$),this.d$.style.display="Block",this.Sno(),this.hT=!0,this.BYi&&this.BYi())}dismiss(){this.hT&&(this.Nml(),this.XZb.removeChild(this.d$),this.hT=!1,this.RFh&&this.RFh())}dispose(){this.dismiss();this.dla=this.ZL=this.ew=this.z$a=this.d3=this.Rcb=null;Sys.Component.prototype.dispose.call(this)}qj(G){return this.get_element().id+G}cal(){this.d3=
this.jj.createElement("div");this.d3.id=this.qj("WACCalloutHeader");this.d3.className="WACCalloutHeader";this.Kt&&this.toh();this.wWd&&this.eqh();this.ew=this.jj.createElement("div");this.ew.id=this.qj("WACCalloutContent");this.ew.className="WACCalloutContent";this.ew.style.width=190<this.Rka?this.Rka-26+"px":"164px";this.ew.appendChild(this.content);this.d$.appendChild(this.kHc);this.d$.appendChild(this.d3);this.d$.appendChild(this.ew)}toh(){this.ZL=this.jj.createElement("a");this.ZL.className="WACCalloutCloseAnchor";
this.ZL.id=this.qj("WACCalloutCloseAnchor");this.ZL.href="#";this.d3.appendChild(this.ZL);const G=e.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.ZL.appendChild(G)}eqh(){this.dla=this.jj.createElement("div");this.dla.className="WACCalloutTitle UIFontBold";this.dla.style.width=190<this.Rka?this.Rka-30+"px":"160px";this.dla.id=this.qj("WACCalloutTitle");this.dla.innerText=this.title;this.d3.contains(this.ZL)?this.d3.insertBefore(this.dla,
this.ZL):this.d3.appendChild(this.dla)}Sno(){var G=this.Tih;let M;if(1===this.Bga){var K=this.fxh.y+16;M=-16}else 2===this.Bga||3===this.Bga||0===this.Bga?(K=G.y+G.height+15,M=-15):(K=G.y-this.d$.clientHeight-15-2,M=this.d$.clientHeight-1);this.d$.style.top=K+"px";this.kHc.style.top=M+"px";1===this.Bga?(G=this.fxh.x-16,this.d$.style.left="50%",this.d$.style.marginLeft=-this.Rka/2+"px",K=Sys.UI.DomElement.getBounds(this.d$),this.kHc.style.left=G-K.x+"px"):(K=G.x+this.Tih.width/2,2===this.Bga||5===
this.Bga?(G=20,K-=36):0===this.Bga||4===this.Bga?(G=this.Rka/2-16,K-=this.Rka/2):(G=this.Rka-20-32,K=K-this.Rka+36),this.d$.style.left=K+"px",this.kHc.style.left=G+"px")}dJ(){this.Kt&&!this.LZ&&(this.LZ=Object(l.a)(this,this.Kga,"closeHandler"),this.tk.ob(a.a.click,this.ZL,this.LZ,null))}Nml(){this.Kt&&this.LZ&&(this.tk.sc(a.a.click,this.ZL,this.LZ),this.LZ=null)}Kga(){this.dismiss();return!0}}Object(D.a)(x,"Callout",Sys.UI.Control,[1020]);class y extends x{constructor(G,M,K,L,R,S=null){super(G,K,
R.X1,S);this.G7g=0;this.Rka=this.$4l(L);this.n1b=M;this.Xi=R;this.MKo=7;this.Tq=this.n1b.ownerDocument.createElement("div");this.Tq.className="ModalCalloutControlOverlay";this.Tq.tabIndex=0;this.n1b.insertBefore(this.Tq,this.n1b.firstChild)}show(){this.aI||(this.Xi.wae(),this.Xi.Cga(!1),this.Tq.style.zIndex=String(this.Xi.$Ca),super.show(),this.Qz(),this.G7g=window.setTimeout(Object(l.a)(this,this.dismiss,"dismiss"),1E3*this.MKo))}dismiss(){this.aI&&(this.Xi.jca(!1),this.daa(),this.n1b&&this.n1b.contains(this.Tq)&&
this.n1b.removeChild(this.Tq),super.dismiss(),window.clearTimeout(this.G7g))}Qz(){this.Xi.E_(Object(l.a)(this,this.dismiss,"dismiss"));this.Xi.oD.ob(a.a.click,this.Tq,Object(l.a)(this,this.onClick,"onClick"))}daa(){this.Xi.$da(Object(l.a)(this,this.dismiss,"dismiss"));this.Xi.oD.sc(a.a.click,this.Tq,Object(l.a)(this,this.onClick,"onClick"))}onClick(){this.dismiss();return!0}$4l(G){let M=0;switch(G){case 0:M=190;break;case 1:M=250;break;case 2:M=300;break;case 3:M=360}return M}}Object(D.a)(y,"ModalCallout",
x,[]);var m=c(7),t=c(539),z=c(182);class v extends y{constructor(G,M,K,L,R,S=null){super(G,M,K,L,R,S);this.pT=null}show(){if(!this.aI){const G=Object.assign(new t.a,{onShow:()=>{y.prototype.show.call(this)}});z.UISurfaces.LM().then(M=>{const K=M.externalNotification();this.pT=M.addNotification(K,G);return null},M=>{m.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",M);return null})}}dismiss(){this.aI&&this.pT&&(z.UISurfaces.LM().then(G=>{G.removeNotification(this.pT);return this.pT=
null},G=>{m.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",G);return null}),super.dismiss())}}Object(D.a)(v,"ReactManagedModalCallout",y,[]);var H=c(2);c.d(I,"a",function(){return F});class F{static WMh(G,M,K,L){return H.AFrameworkApplication.ua.Kb.HRa?new v(G,M,K,L,H.AFrameworkApplication.ua,null):new y(G,M,K,L,H.AFrameworkApplication.ua,null)}}Object(D.a)(F,"ModalCalloutControlFactory",null,[])},1996:function(D,I,c){D=c(0);var l=c(55),e=c(126),a=c(19),k=c(2),x=c(85);
class y{constructor(F,G){this.value=F;this.aKl=G}get j_d(){return this.aKl}}Object(D.a)(y,"ElementValueWrapper",null,[]);class m extends y{constructor(F,G,M){super(F,G);this.fCi=M}}Object(D.a)(m,"DimensionWrapper",y,[]);var t=c(1713),z=c(1714),v=c(7);c.d(I,"a",function(){return H});class H{static get Gpi(){return H.j6j}static get nle(){return H.Klk}static get lle(){return H.Jlk}static qwf(F,G,...M){G=H.kki(G);let K=!1;G||(G=H.ukm(F,...M),K=!!G);return new y(G,K)}static kki(F){for(const G of F)if(void 0!==
G&&null!==G&&""!==G)return G.trim();return null}static ukm(F,...G){for(const M of G)if(G=F.getAttribute(M),void 0!==G&&null!==G&&(G+="",void 0!==G&&null!==G&&""!==G))return G.trim();return null}static o$l(F,G){G=parseFloat(G);if(isNaN(G))return 0;switch(F){case "px":return Math.round(G);case "pt":return Math.round(l.a.aZ(G,0,!1));case "in":return Math.round(l.a.Tca(G,0,!1));case "cm":return Math.round(l.a.Tca(e.a.SCh(G),0,!1));case "mm":return Math.round(l.a.Tca(e.a.SCh(.1*G),0,!1));default:return G}}static Mee(F,
G,...M){F=H.qwf(F,G,...M);M=0;G=!1;if(F.value){G=F.value.endsWith("%");let K;G?(M="%",K=a.a.substring(F.value,0,F.value.length-1)):F.j_d?(M="px",K=F.value):(M=F.value.substr(F.value.length-2),isNaN(parseFloat(M))?K=a.a.substring(F.value,0,F.value.length-2):(M="px",K=F.value));M=H.o$l(M,K)}return new m(M,F.j_d,G)}static xki(F){return H.Mee(F,[F.style.width],"width","WIDTH","Width")}static gai(F){return H.Mee(F,[F.style.height],"height","HEIGHT","Height")}static CJ(F){return H.Mee(F,[F.style.marginLeft],
"leftmargin","LEFTMARGIN","LeftMargin")}static mL(F){return H.Mee(F,[F.style.marginRight],"rightmargin","RIGHTMARGIN","RightMargin")}static Akm(F){F=H.qwf(F,[F.style.verticalAlign],"vAlign","valign","VALIGN","VAlign");return F.value&&F.value in H.nle&&void 0!==H.nle[F.value]&&null!==H.nle[F.value]?H.nle[F.value]:0}static SVm(F){F=H.kki([F.style.borderCollapse]);return!!F&&!(void 0===F||null===F)&&("collapse"===F||"COLLAPSE"===F||"Collapse"===F)}static OOl(F){return H.qwf(F,[F.style.backgroundColor,
F.style.background],"bgcolor","BGCOLOR","BgColor","BGColor").value}static z7k(F){const G=a.a.substring(F,0,1),M=a.a.substring(F,1,2);F=a.a.substring(F,2,3);return G+G+M+M+F+F}static yva(F){let G="";if(!F||""===F)return G;G=F.trim();if(G.startsWith("rgb")){G=a.a.substring(G,G.indexOf("(")+1,G.length-1);F=G.split(",");if(3!==F.length)return"";G="";for(let K=0;K<F.length;K++){var M=parseInt(F[K]);if(isNaN(M)||0>M||255<M)return"";M=M.toString(16);1===M.length&&(M="0"+M);G+=M}return a.a.ZA(G)}if(H.Gpi[a.a.eh(G)])return H.Gpi[a.a.eh(G)];
G.startsWith("#")&&(G=a.a.substring(G,1,G.length));if(isNaN(parseInt(G,16)))return"";3===G.length&&(G=H.z7k(G));return 6!==G.length?"":G}static jBn(F){var G=F.indexOf("mso-tab-count");if(-1===G)return 0;const M=RegExp("([\\d])");let K="";for(G=G+13+1;G<F.length;G++){const L=F.charAt(G).toString();if(M.test(L))K+=L;else break}F=0;""!==K&&(F=parseInt(K));return F}static OVd(F,G){const M=H.OOl(F);M&&""!==M&&G.kv(K=>K.F$(H.yva(M)))}static v6h(F){var G,M=F.style;if(!M)return null;let K=H.lle[M.borderTopStyle];
const L=H.yva(M.borderTopColor);let R=M.borderTopWidth,S=H.lle[M.borderRightStyle];const N=H.yva(M.borderRightColor);let O=M.borderRightWidth,W=H.lle[M.borderBottomStyle];const V=H.yva(M.borderBottomColor);let Q=M.borderBottomWidth,Y=H.lle[M.borderLeftStyle];const ba=H.yva(M.borderLeftColor);M=M.borderLeftWidth;k.AFrameworkApplication.oe("gdea6103;0df65435");if(null===(G=k.AFrameworkApplication.K)||void 0===G?0:G.getBooleanFeatureGate("Microsoft.Office.WordOnline.PasteTableBorderFixEnabled",!1))F=
F.getAttribute("border"),null!==F&&(K=this.Ukc(F,K),W=this.Ukc(F,W),Y=this.Ukc(F,Y),S=this.Ukc(F,S),R=this.Vkc(F,R),O=this.Vkc(F,O),Q=this.Vkc(F,Q),M=this.Vkc(F,M),v.ULS.sendTraceTag(509125330,3022,50,"getCellBorders: Table Border Attribute found and fixed"));return new t.a(K,S,W,Y,L,N,V,ba,R,O,Q,M)}static Vkc(F,G){return""===G?F+"px":G}static Ukc(F,G){return 0===G?"0"===F?1:11:G}static MQl(F){var G=F.querySelectorAll("[class^=TableCellContent]");G=1===G.length?G[0]:void 0;return(F=(null===G||void 0===
G?0:G.style)?G.style:F.style)?new z.a(F.paddingTop,F.paddingRight,F.paddingBottom,F.paddingLeft):null}}H.j6j=x.a.h6("aliceblue","F0F8FF","antiquewhite","FAEBD7","aqua","00FFFF","aquamarine","7FFFD4","azure","F0FFFF","beige","F5F5DC","bisque","FFE4C4","black","000000","blanchedalmond","FFEBCD","blue","0000FF","blueviolet","8A2BE2","brown","A52A2A","burlywood","DEB887","cadetblue","5F9EA0","chartreuse","7FFF00","chocolate","D2691E","coral","FF7F50","cornflowerblue","6495ED","cornsilk","FFF8DC","crimson",
"DC143C","cyan","00FFFF","darkblue","00008B","darkcyan","008B8B","darkgoldenrod","B8860B","darkgray","A9A9A9","darkgrey","A9A9A9","darkgreen","006400","darkkhaki","BDB76B","darkmagenta","8B008B","darkolivegreen","556B2F","darkorange","FF8C00","darkorchid","9932CC","darkred","8B0000","darksalmon","E9967A","darkseagreen","8FBC8F","darkslateblue","483D8B","darkslategray","2F4F4F","darkslategrey","2F4F4F","darkturquoise","00CED1","darkviolet","9400D3","deeppink","FF1493","deepskyblue","00BFFF","dimgray",
"696969","dimgrey","696969","dodgerblue","1E90FF","firebrick","B22222","floralwhite","FFFAF0","forestgreen","228B22","fuchsia","FF00FF","gainsboro","DCDCDC","ghostwhite","F8F8FF","gold","FFD700","goldenrod","DAA520","gray","808080","grey","808080","green","008000","greenyellow","ADFF2F","honeydew","F0FFF0","hotpink","FF69B4","indianred","CD5C5C","indigo","4B0082","ivory","FFFFF0","khaki","F0E68C","lavender","E6E6FA","lavenderblush","FFF0F5","lawngreen","7CFC00","lemonchiffon","FFFACD","lightblue",
"ADD8E6","lightcoral","F08080","lightcyan","E0FFFF","lightgoldenrodyellow","FAFAD2","lightgray","D3D3D3","lightgrey","D3D3D3","lightgreen","90EE90","lightpink","FFB6C1","lightsalmon","FFA07A","lightseagreen","20B2AA","lightskyblue","87CEFA","lightslategray","778899","lightslategrey","778899","lightsteelblue","B0C4DE","lightyellow","FFFFE0","lime","00FF00","limegreen","32CD32","linen","FAF0E6","magenta","FF00FF","maroon","800000","mediumaquamarine","66CDAA","mediumblue","0000CD","mediumorchid","BA55D3",
"mediumpurple","9370D8","mediumseagreen","3CB371","mediumslateblue","7B68EE","mediumspringgreen","00FA9A","mediumturquoise","48D1CC","mediumvioletred","C71585","midnightblue","191970","mintcream","F5FFFA","mistyrose","FFE4E1","moccasin","FFE4B5","navajowhite","FFDEAD","navy","000080","oldlace","FDF5E6","olive","808000","olivedrab","6B8E23","orange","FFA500","orangered","FF4500","orchid","DA70D6","palegoldenrod","EEE8AA","palegreen","98FB98","paleturquoise","AFEEEE","palevioletred","D87093","papayawhip",
"FFEFD5","peachpuff","FFDAB9","peru","CD853F","pink","FFC0CB","plum","DDA0DD","powderblue","B0E0E6","purple","800080","red","FF0000","rosybrown","BC8F8F","royalblue","4169E1","saddlebrown","8B4513","salmon","FA8072","sandybrown","F4A460","seagreen","2E8B57","seashell","FFF5EE","sienna","A0522D","silver","C0C0C0","skyblue","87CEEB","slateblue","6A5ACD","slategray","708090","slategrey","708090","snow","FFFAFA","springgreen","00FF7F","steelblue","4682B4","tan","D2B48C","teal","008080","thistle","D8BFD8",
"tomato","FF6347","turquoise","40E0D0","violet","EE82EE","wheat","F5DEB3","white","FFFFFF","whitesmoke","F5F5F5","yellow","FFFF00","yellowgreen","9ACD32");H.Klk=x.a.h6("",0,"unset",1,"top",1,"middle",2,"bottom",3,"start",2,"baseline",1,"sub",3,"super",1,"initial",1,"inherit",2,"text-top",1,"text-bottom",3);H.Jlk=x.a.h6("",0,"initial",3,"inherit",11,"nil",1,"dotted",5,"dashed",4,"solid",11,"double",6,"groove",7,"ridge",10,"inset",8,"outset",9,"none",1,"hidden",2);Object(D.a)(H,"DefaultHtmlTranslatorHelper",
null,[])},1999:function(D,I,c){D=c(0);var l=c(7),e=c(54),a=c(2),k=c(216),x=c(212),y=c(93);class m{constructor(){this.B4d=22;this.U$f=1E3;this.D8n=2E4;this.J8n=18E4}}Object(D.a)(m,"Config",null,[]);c.d(I,"a",function(){return t});class t{constructor(z){this._url=this.wv=null;this.qZa=this.pZa=0;this.xeb=!1;this.l3c="";this.Ndh=this._body=this._headers=null;this.A7=z}send(z,v,H,F,G,M){this._url=z;this.wv=G;this.xeb=M;this._body=v;this._headers=H;this.Ndh=F;this.makeRequest(null)}makeRequest(){a.AFrameworkApplication.He.mj(this._url,
1,this._body,this._headers,!0,2,Object(e.a)(this,this.QMb,"onRequestSucceeded"),Object(e.a)(this,this.yqa,"onRequestFailed"),null,void 0,void 0,void 0,void 0,"16",void 0,void 0,void 0,this.Ndh)}QMb(z){var v=t.uT;this.C7c();var H=z.data.Oja;let F=null;if(H){t.zXm(H)||(H=Sys.Net.XMLDOM(z.data.se,!0));if("undefined"===typeof H.selectSingleNode){v=z.data.se||"[null]";800<v.length&&(v=v.substring(0,400)+"[...]"+v.substring(v.length-400,v.length));l.ULS.sendTraceTag(39387396,301,10,'Invalid docdata.xml retrieved.  Contents: "{0}"',
v);this.k3a(z.data);return}F=H.selectSingleNode("/docdata/status")}a.AFrameworkApplication.mva&&z.data.Dj[k.PageStats.hNb]&&(this.l3c+=z.data.Dj[k.PageStats.hNb].toString());F&&("InProgress"===F.text&&this.pZa++<t.$t.B4d||"ServiceBusy"===F.text&&3>this.qZa++)?(l.ULS.sendTraceTag(39387397,301,50,"Re-requesting; Status: {0}; Retry Count: {1}; Url: {2}",F.text,this.pZa+this.qZa,this._url),this.vIa(t.$t.U$f*(this.pZa+this.qZa))):(H=F?F.text:null,l.ULS.sendTraceTag(39387398,301,50,"Request Complete. Result: {0}; Url: {1}",
H,this._url),4<v&&l.ULS.sendTraceTag(524104657,301,15,"Request Complete. Result: {0}; Url: {1}; Retry: {2}",H,this._url,v),a.AFrameworkApplication.mva&&""!==this.l3c&&(z.data.Dj[k.PageStats.hNb]=this.l3c,this.l3c=""),this.wv(!0,H,z.data))}yqa(z){this.xeb?(t.sCa||(t.kcb=new Date,t.sCa=!0,t.uT=1),(new Date).getTime()-t.kcb.getTime()<t.$t.J8n?(this.retryOnFailure(4<=t.uT?t.$t.D8n:t.$t.U$f),4===t.uT&&(t.Tzc=this.A7.Cva(CommonUIStrings.l_NetworkProblemToast,!0),this.A7.sA(t.Tzc))):this.k3a(z.data)):4>
t.uT?this.retryOnFailure(2*t.$t.U$f):this.k3a(z.data)}vIa(z){z=new y.a(2,1,z,Object(e.a)(this,this.makeRequest,"makeRequest"),94);a.AFrameworkApplication.lc.Wb(z)}retryOnFailure(z){this.vIa(z);t.uT++}k3a(z){l.ULS.sendTraceTag(524104658,301,15,"Request failed - giving up (failures "+t.uT+"): "+this._url);this.wv(!1,null,z)}C7c(){t.sCa=!1;t.uT=0;if(t.Tzc){this.A7.removeEntry(t.Tzc);t.Tzc=null;const z=this.A7.Cva(CommonUIStrings.l_NetworkRestoredToast,!1);z.image=3;this.A7.sA(z)}}static J8(z,v,H){return t.qrl(z,
v,H)}static qrl(z,v,H){if(x.a.instance.eva()&&a.AFrameworkApplication.ua&&a.AFrameworkApplication.ua.Pzf)return!1;(new t(H)).send(z,null,null,null,v,!1);return!0}static zXm(z){return!!z&&"undefined"!==typeof z.selectSingleNode}}t.kcb=null;t.sCa=!1;t.uT=0;t.Tzc=null;t.$t=new m;Object(D.a)(t,"ClientRequestWithRetry",null,[])},2E3:function(D,I,c){D=c(0);var l=c(7),e=c(54),a=c(2),k=c(38);const x=(L,R,S)=>{if(L){var N=0;do{try{L();break}catch(O){if(l.ULS.sendTraceTag(50946190,306,10,"RetryOnException: [Retries: {0}] [Caller: {1}] [Exception: {2}] [Callstack: {3}].",
N,S,O.message,O.stack),N>=R)break}N++}while(1)}};var y=c(93),m=c(28),t=c(34),z=c(205),v=c(170),H=c(45),F=c(314),G=c(20),M=c(139);c.d(I,"a",function(){return K});class K{constructor(L,R,S,N,O,W,V,Q,Y=!0,ba=null,Z=!1){this.H_h="FileUpload.ashx";this._iframe=null;this._initialized=!1;this.Kl=this.lvc=this.rBe=this.f_a=this.Ald=this.EE=this._form=null;this.Oh=!1;this.kz=this.Bld=this.teb=null;this._parent=L;this.i7j=R;this.Ehk=S;this.MWg=O;this.zCa=V;this.PKg=Q;this.nOg=ba;this.CXe=!1;this.h8j=N.$("CanaryRenewalForFileUploadIsEnabled");
this.S0o=!1;(this.Pcb=Z)||this.n9k(W);Y&&this.QBf()}get Tej(){return this.Ehk}get sessionId(){return this.zCa}get iFrame(){return this._iframe}get YO(){return this.EE}get anb(){return a.AFrameworkApplication.K?a.AFrameworkApplication.K.$("NativeFileOpenDialogIsEnabled"):!1}get B_h(){return a.AFrameworkApplication.K?a.AFrameworkApplication.K.$("FileInputDescriptionAccessibilityIsEnabled"):!1}get hQm(){return this.Pcb?!1:v.b(this._iframe.contentWindow.location.pathname,this.H_h,0)}get aCk(){return!G.a.zpa&&
a.AFrameworkApplication.K.$("AllowMultipleImageInsertFromLocalDevice")}QBf(){this.kz=M.a.create().toString();this.Pcb?this.Lif():this.WDk()}n9k(L){this._iframe=document.createElement("iframe");this._iframe.className=L;this._iframe.id=L;this.MWg&&(this._iframe.style.visibility="visible",this._iframe.style.height="30px",this._iframe.setAttribute("frameborder","0"));this.f_a=Object(e.a)(this,this.lZf,"onUploadFrameLoad");k.a.addHandler(this._iframe,"load",this.f_a)}nMc(L=null){a.AFrameworkApplication.ua.wae();
if(!this.EE)return l.ULS.sendTraceTag(25798093,322,50,"_fileInput is null"),"";k.a.addHandler(this.EE,"change",()=>{this.vCl(L)});x(Object(e.a)(this,this.A_h,"fileInputClick"),1,"DoFileOpenDialog");return this.EE.value}vCl(L){L&&L(this.EE.value)}wCl(){this.Ald&&(this.Ald.innerText=this.Xai())}cXn(L){k.a.addHandler(this.EE,"change",()=>{L(this.Xai())})}Xai(){let L=null;if(this.EE.value){const R=this.EE.value,S=R.lastIndexOf("\\");0<S&&(L=R.substring(S+1,R.length))}return L?L:""}A_h(){try{l.ULS.sendTraceTag(35939520,
322,50,"UploadFrame.FileInputClick - Clicking on File input element."),this.EE.click()}catch(L){throw l.ULS.sendTraceTag(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",L.message),L;}}fbd(){this.GUm()?this.$wj():(this.xqg(),this._form.submit())}GUm(){return(this.h8j||this.Pcb)&&!(void 0===window.self.FormData||null===window.self.FormData)}Ijj(L){if(L){const R=this.iLh();this.Kl=new XMLHttpRequest;this.Kl.open("POST",R);this.Kl.setRequestHeader("X-CorrelationId",this.kz);this.p5m(L);this.Kl.onreadystatechange=
Object(e.a)(this,this.Kea,"uploadResponseReceived");this.Kl.send(L)}}p5m(L){if(!G.a.zpa&&L.get){var R=L.get("ImageId");L=window.self.navigator;R={["CorrelationId"]:this.kz,["Canary"]:a.AFrameworkApplication.canary,["ImageNodeId"]:R};L&&(L=L.connection?L.connection:L.mozConnection?L.mozConnection:L.webkitConnection?L.webkitConnection:null)&&(R.effectiveType=L.effectiveType,R.downlink=L.downlink,R.type=L.type,R.rtt=L.rtt);l.ULS.sendTraceTag(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",
R)}}$wj(){try{this.xqg();l.ULS.sendTraceTag(594888409,322,50,"SubmitFormWithRequest is preparing to send an upload request");const L=new (Type.parse("FormData"))(this._form);this.Ijj(L)}catch(L){l.ULS.sendTraceTag(594888407,322,10,"SubmitFormWithRequest failed to send the request with exception "+L.message),this.WMb(null)}}Zwj(L){try{if(this.xqg(),l.ULS.sendTraceTag(594888406,322,50,"SubmitFormWithBlob is preparing to send an upload request"),this.u2o(L)){this.Bld=L;this._form.contains(this.EE)&&
this._form.removeChild(this.EE);var R=new (Type.parse("FormData"))(this._form);R.append("applicationfileInput",L.blob,L.filename);this.Ijj(R)}else this.WMb(null)}catch(S){l.ULS.sendTraceTag(591267743,322,10,"SubmitFormWithBlob failed to send the request with exception "+S.message),this.WMb(null)}}u2o(L){return L&&void 0!==L.blob&&null!==L.blob&&void 0!==L.filename&&null!==L.filename&&""!==L.filename?void 0===window.self.FormData||null===window.self.FormData?(l.ULS.sendTraceTag(578380442,322,10,"FormData isn't supported"),
!1):!0:(L=L?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",void 0===L.blob||null===L.blob,void 0===L.filename||null===L.filename||""===L.filename):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]",l.ULS.sendTraceTag(578380441,322,10,String.format("Content of the blob is empty {0}",L)),!1)}Kea(){if(4===this.Kl.readyState)if(200===this.Kl.status){l.ULS.sendTraceTag(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",
this.kz);const L=this.Kl.getResponseHeader("X-NewKey"),R=this.gJm(this.Kl);let S=!1;if(void 0!==L&&null!==L&&R&&(S=this.e2o(L),!this.CXe&&S)){l.ULS.sendTraceTag(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",this.kz);this.CXe=!0;this.DKc();void 0!==this.Bld&&null!==this.Bld?this.Zwj(this.Bld):this.$wj();return}l.ULS.sendTraceTag(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",
this.CXe,R,!(void 0===L||null===L),S,this.kz);this.WMb(this.Kl.responseText)}else l.ULS.sendTraceTag(42874946,322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",this.Kl.status,this.Kl.responseText?!1:!0,this.kz),this.WMb(null)}gJm(L){try{const R=t.a(L.responseText).Responses;if(void 0!==R&&null!==R&&1===R.length){const S=R[0];if(void 0!==S&&null!==S&&2===S.length&&28===S[1].StatusCode)return!0}}catch(R){}return!1}e2o(L){F.a.ipg(L);return a.AFrameworkApplication.canary!==
L?!1:!0}xqg(){this.teb||(this.teb=new Date)}dispose(){this.Oh||(this.Pcb?this._parent.removeChild(this._form):(this._parent.removeChild(this._iframe),k.a.removeHandler(this._iframe,"load",this.f_a),this.f_a=null),this.rBe&&(k.a.removeHandler(this.EE,"change",this.rBe),this.rBe=null),this.B_h&&(this.lvc&&(k.a.removeHandler(this.EE,"change",this.lvc),this.lvc=null),this.Ald=null),this.EE=this._form=this._parent=this._iframe=null,this.Oh=!0,this.teb=null,l.ULS.sendTraceTag(25798094,322,50,"UploadFrame disposed"))}delayedDispose(){this.dispose()}T5b(L,
R){if(this._form){var S;(S=this._form.querySelector("input[name="+L+"]"))?S.value=R:(S=this.zbf(),S.type="hidden",S.id=L,S.name=L,S.value=R,this._form.appendChild(S))}}zbf(){return this.Pcb?document.createElement("input"):this._iframe.contentWindow.document.createElement("input")}lZf(){try{if(!this._iframe.contentWindow.document.body)return}catch(R){this.uac();return}if(!(this._initialized||this.anb&&G.a.TG))this.Lif();else if(!this.anb||!G.a.TG||this.hQm){let R;R=G.a.gt?this._iframe.contentWindow.document.body.innerText:
this.S0o?this._iframe.contentWindow.document.body.firstChild.innerText:this._iframe.contentWindow.document.body.firstChild.innerHTML;var L=this._iframe.contentWindow.document.body.innerText.toLowerCase();const S=0<=L.indexOf("responses")||0<=L.indexOf("wopisrc");L=0<=L.indexOf("http error");!S&&L&&l.ULS.sendTraceTag(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+this._iframe.contentWindow.document.body.innerText);this.WMb(R)}}Lif(){if(!this._initialized){var L=this.IB("uploadForm");
const R=this.IB("fileInput"),S=this.iLh();this.Ial();this._form.id=L;this._form.method="post";this._form.encoding="multipart/form-data";this._form.action=S;this.EE.type="file";this.PKg&&(this.EE.accept=this.PKg,this.nOg&&(this.EE.capture=this.nOg));this.EE.id=R;this.EE.name=R;this.aCk&&(this.EE.multiple=!0);!this.B_h||G.a.gt||G.a.Nt||(this.lvc=Object(e.a)(this,this.wCl,"fileInputChangedHandleAccessibility"),k.a.addHandler(this.EE,"change",this.lvc),this.Ald=m.a.Ith(this._form,this.EE,"InputFileDescription"));
this.MWg&&(this.Pcb||(L=this._iframe.contentWindow.document.body,L.style.margin="0",L.style.overflow="hidden"),L=a.AFrameworkApplication.ua,this.EE.style.fontFamily=L.jAa,this.EE.style.fontSize=L.Bog,this.EE.style.margin="0");(L=document.getElementById("__REQUESTDIGEST"))&&this.T5b("__REQUESTDIGEST",L.value);this.DKc();this._form.appendChild(this.EE);this._initialized=!0;this.i7j(this)}}Ial(){if(this.Pcb)this._form=document.createElement("form"),this._parent.appendChild(this._form),this.EE=document.createElement("input");
else{this._form=this._iframe.contentWindow.document.createElement("form");const L=this._iframe.contentWindow.document;L.body.appendChild(this._form);this.EE=L.createElement("input")}}WDk(){this._parent.appendChild(this._iframe);this.anb&&G.a.TG&&this.Lif()}iLh(){var L=new z.QueryStringBuilder(this.H_h);a.AFrameworkApplication.nga(L);this.wkj(L);L=L.toString();if(G.a.Cj||G.a.TG||G.a.Nt)L=H.a.f9b(L);return L}IBd(){const L=new y.a(2,1,0,Object(e.a)(this,this.delayedDispose,"delayedDispose"),4);a.AFrameworkApplication.lc.Wb(L)}}
Object(D.a)(K,"UploadFrame",null,[9])},2001:function(D,I,c){D=c(0);class l{constructor(a){this.next=null;this.data=a}}Object(D.a)(l,"QueueNode",null,[]);c.d(I,"a",function(){return e});class e{constructor(){this.jvb=this.ftb=null;this.ak=0}get count(){return this.ak}get isEmpty(){return!this.count||!this.ftb||!this.jvb}enqueue(a){a=new l(a);this.isEmpty?this.jvb=this.ftb=a:this.ftb=this.ftb.next=a;this.ak=this.count+1}back(){return this.isEmpty?null:this.ftb.data}dequeue(){if(this.isEmpty)return null;
const a=this.jvb;this.jvb=a.next;this.ak=this.count-1;this.jvb||(this.ftb=null);return a.data}clear(){this.jvb=this.ftb=null;this.ak=0}toArray(){const a=Array(this.count);let k=this.jvb;for(let x=0;x<this.count&&k;x++)a[x]=k.data,k=k.next;return a}}Object(D.a)(e,"Queue",null,[])},2059:function(D,I,c){c.d(I,"b",function(){return l});c.d(I,"e",function(){return e});c.d(I,"d",function(){return a});c.d(I,"c",function(){return k});c.d(I,"h",function(){return x});c.d(I,"a",function(){return y});c.d(I,"f",
function(){return m});c.d(I,"g",function(){return t});var l;(function(z){z[z.Unspecified=0]="Unspecified";z[z.Inline=1]="Inline";z[z.Floating=2]="Floating"})(l||(l={}));var e;(function(z){z[z.Undefined=0]="Undefined";z[z.Bullet=1]="Bullet";z[z.Numbered=2]="Numbered";z[z.Lim=3]="Lim";z[z.Nil=4]="Nil";z[z.Any=5]="Any";z[z.NoList=6]="NoList";z[z.Invalid=7]="Invalid"})(e||(e={}));var a;(function(z){z[z.DontCare=1]="DontCare";z[z.Thin=2]="Thin";z[z.ExtraLight=3]="ExtraLight";z[z.Light=4]="Light";z[z.Normal=
5]="Normal";z[z.Medium=6]="Medium";z[z.SemiBold=7]="SemiBold";z[z.Bold=8]="Bold";z[z.ExtraBold=9]="ExtraBold";z[z.Heavy=10]="Heavy"})(a||(a={}));var k;(function(z){z[z.NoCaps=0]="NoCaps";z[z.SmallCaps=1]="SmallCaps";z[z.AllCaps=2]="AllCaps";z[z.AllPetiteCaps=3]="AllPetiteCaps";z[z.PetiteCaps=4]="PetiteCaps";z[z.Unicase=5]="Unicase";z[z.Titling=6]="Titling";z[z.Other=7]="Other"})(k||(k={}));var x;(function(z){z[z.None=0]="None";z[z.Words=1]="Words";z[z.SingleLine=2]="SingleLine";z[z.DoubleLine=3]=
"DoubleLine";z[z.HeavyLine=4]="HeavyLine";z[z.DottedLine=5]="DottedLine";z[z.DottedHeavyLine=6]="DottedHeavyLine";z[z.DashLine=7]="DashLine";z[z.DashHeavyLine=8]="DashHeavyLine";z[z.DashLongLine=9]="DashLongLine";z[z.DashLongHeavyLine=10]="DashLongHeavyLine";z[z.DotDashLine=11]="DotDashLine";z[z.DotDashHeavyLine=12]="DotDashHeavyLine";z[z.DotDotDashLine=13]="DotDotDashLine";z[z.DotDotDashHeavyLine=14]="DotDotDashHeavyLine";z[z.WavyLine=15]="WavyLine";z[z.WavyHeavyLine=16]="WavyHeavyLine";z[z.WavyDoubleLine=
17]="WavyDoubleLine"})(x||(x={}));var y;(function(z){z[z.Left=0]="Left";z[z.Right=1]="Right";z[z.Center=2]="Center";z[z.Justified=3]="Justified";z[z.Other=4]="Other";z[z.None=5]="None";z[z.JustifyLow=6]="JustifyLow";z[z.Distributed=7]="Distributed";z[z.ThaiDistributed=8]="ThaiDistributed"})(y||(y={}));var m;(function(z){z[z.Image=0]="Image";z[z.TextBox=1]="TextBox";z[z.Chart=2]="Chart";z[z.SmartArt=3]="SmartArt";z[z.Drawing=4]="Drawing";z[z.EquationObject=5]="EquationObject";z[z.Ink=6]="Ink";z[z.InkSpace=
7]="InkSpace";z[z.InkEndOfLine=8]="InkEndOfLine";z[z.LineBreak=9]="LineBreak";z[z.PageBreak=10]="PageBreak";z[z.PageNumbers=11]="PageNumbers";z[z.FootnoteEndnote=12]="FootnoteEndnote";z[z.FootnoteEndnoteReferenceMark=13]="FootnoteEndnoteReferenceMark";z[z.Tab=14]="Tab";z[z.UnsupportedObject=15]="UnsupportedObject";z[z.Other=16]="Other"})(m||(m={}));var t;(function(z){z[z.Initial=0]="Initial";z[z.FirstLine=1]="FirstLine";z[z.Hanging=2]="Hanging"})(t||(t={}))},2062:function(D,I,c){c.d(I,"a",function(){return l});
D=c(0);var l;(function(e){e[e.normal=0]="normal";e[e.beingCreated=1]="beingCreated";e[e.beingEdited=2]="beingEdited"})(l||(l={}));Object(D.b)("CommentType",l)},2064:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.atmention=this.altText=this.lang=null;this.italic=!1;this.link=null;this.underline=this.strikethrough=!1;this.weight=0;this.paragraph=this.color=this.highlight=null}}Object(D.a)(l,"DeltaAttributes",null,[])},2065:function(D,I,c){c.d(I,"a",function(){return l});
D=c(0);class l{static Irf(e){return e===l.create?0:e===l.reply?1:e===l.edit?2:e===l.metadata?3:null}}l.create="CREATE";l.reply="REPLY";l.edit="EDIT";l.metadata="METADATA";Object(D.a)(l,"CommentSessionType",null,[])},2066:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);var l;(function(e){e[e.unsaved=0]="unsaved";e[e.sentToServer=1]="sentToServer";e[e.succeeded=2]="succeeded";e[e.failed=3]="failed";e[e.saveNotNeeded=4]="saveNotNeeded"})(l||(l={}));Object(D.b)("CommentSaveStatus",l)},2067:function(D,
I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e,a){this.className=e;this.GSc=a}}Object(D.a)(l,"HighlightCssClassPair",null,[])},2068:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.type=this.action=0;this.VJ=this.HA=null}}Object(D.a)(l,"HighlightOperation",null,[])},2069:function(D,I,c){c.d(I,"a",function(){return a});D=c(0);var l=c(530);I=c(233);var e=c(113);class a extends I.a{constructor(){super();this.LastKnownPaginationRevision=this.FileId=
null}nl(){return l.a.pagination}static Vba(k,x){const y=new a;y.FileId=k;y.LastKnownPaginationRevision=e.a(x);return y}}Object(D.a)(a,"PaginationRequest",I.a,[])},2071:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{J$b(e,a){let k="g";a.matchCase||a.r4d||(k+="i");if(a.matchPrefix||a.matchWholeWord)e="\\b"+e;if(a.matchSuffix||a.matchWholeWord)e+="\\b";return new RegExp(e,k)}static get instance(){return l._instance||(l._instance=new l)}}l._instance=null;Object(D.a)(l,"FindUtils",null,
[1098])},2073:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e,a){this._text=e;this.qvc=a}get text(){return this._text}get matchCase(){return this.NJb(1)}get matchWholeWord(){return this.NJb(2)}get r4d(){return this.NJb(4)}get matchPrefix(){return this.NJb(8)}get matchSuffix(){return this.NJb(16)}get ignorePunct(){return this.NJb(32)}get ignoreSpace(){return this.NJb(64)}NJb(e){return(this.qvc&e)===e}static createQuery(e,a){return new l(e,a)}}Object(D.a)(l,"Query",null,
[1095])},2074:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);var l;(function(e){e[e.none=0]="none";e[e.matchCase=1]="matchCase";e[e.wholeWordOnly=2]="wholeWordOnly";e[e.wildCards=4]="wildCards";e[e.prefix=8]="prefix";e[e.suffix=16]="suffix";e[e.ignorePunct=32]="ignorePunct";e[e.ignoreSpace=64]="ignoreSpace"})(l||(l={}));Object(D.b)("QueryFilters",l)},2075:function(D,I,c){c.d(I,"a",function(){return y});D=c(0);var l=c(155),e=c(176),a=c(2),k=c(67),x=c(203);class y extends l.a{constructor(m,
t=!1){super(m,!1,t)}get pXc(){return!1}get gL(){return x.a.SLc+"/modeless"}get jmb(){return null}set jmb(m){}get emb(){return null}set emb(m){}Uh(m,t=null,z=null){this.DT&&(z.isModal=!1);super.Uh(m,t,z)}hide(){if(a.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.HideReactModelessDialogEnabled")||this.Kc)this.HGj(),a.AFrameworkApplication.ua.wx.fx(e.AFrame.hQf),super.hide()}Jsk(){const m=a.AFrameworkApplication.ua.wx,t=a.AFrameworkApplication.ua.Hp;m.V7(this.gL);
m.JT(this.gL);t.fe(this.gL).parent=e.AFrame.Ap}dDa(){k.FocusManager.lK()&&(super.dDa(),this.Jsk(),a.AFrameworkApplication.ua.wx.$I(e.AFrame.hQf))}Z7f(){if(k.FocusManager.lK()&&!a.AFrameworkApplication.Rk){const m=k.FocusManager.instance();m.gS(this.gL);const t=m.getRegion(this.gL);t&&t.hk.gz(null);m.i7a(this.gL)}}Wda(){"DL"===this.VCa||"DP"===this.VCa?super.Wda():a.AFrameworkApplication.K&&a.AFrameworkApplication.K.$("WacAutoFitNonModalDialogIsEnabled")?(this.HGj(),this.Twh()&&this.Ytj(this.Kc.clientHeight,
this.Kc.clientWidth)):this.KL()}KL(){this.Ytj(l.a.QRg,l.a.XRg)}Ytj(m,t){if(this.emb&&this.jmb){let z,v;z=x.a.pae+this.jmb;v=x.a.oae+this.emb;z+m>this.GB()&&(z=this.GB()-m);v+t>this.qu()&&(v=this.qu()-t);this.Ztj(z,v)}else super.KL()}Vsf(m){if(!m)return null;m.endsWith("px")&&(m=m.substring(0,m.length-2));return x.a.sdc(m)?((m=parseInt(m))||(m=1),m):null}HGj(){if(this.Kc&&this.Kc.style){var m=this.Vsf(this.Kc.style.top);m&&(this.jmb=m-x.a.pae);if(m=a.AFrameworkApplication.isRtl?this.Vsf(this.Kc.style.right):
this.Vsf(this.Kc.style.left))this.emb=m-x.a.oae}}}Object(D.a)(y,"ModelessCustomDialog",l.a,[])},2076:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);var l;(function(e){e[e.connected=0]="connected";e[e.disconnected=1]="disconnected";e[e.connecting=2]="connecting";e[e.timeout=3]="timeout"})(l||(l={}));Object(D.b)("AppNetworkConnectivityState",l)},2077:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{DPa(){}z8b(){}Whe(){}oge(){}reset(){}nlf(){}update(){}cqb(){}dispose(){}}Object(D.a)(l,
"FindStatusManagerStub",null,[300,9])},2085:function(D,I,c){c.d(I,"b",function(){return l});c.d(I,"a",function(){return e});var l;(function(a){a[a.None=0]="None";a[a.BetweenLeftAndRightMargin=1]="BetweenLeftAndRightMargin";a[a.BetweenLeftAndRightEdge=2]="BetweenLeftAndRightEdge";a[a.FitToBox=3]="FitToBox"})(l||(l={}));var e;(function(a){a.left="left";a.center="center";a.right="right";a.both="both"})(e||(e={}))},2086:function(D,I,c){c.d(I,"a",function(){return e});D=c(0);var l=c(773);class e{static for(a){return[l.b.getTypeName(),
a.getTypeName()]}}Object(D.a)(e,"RequestSignalParentPath",null,[])},2087:function(D,I,c){c.d(I,"a",function(){return a});D=c(0);var l=c(772),e=c(1784);class a{constructor(k){this.Ved=!1;this.operation=k}static rFb(k){return new a(k)}AUc(){this.Ved=!0;return this}Ope(k){this.FHd=this.G5e(k);return this}build(){let k;this.FHd&&(k={AUc:this.Ved,FHd:this.FHd});return{operation:this.operation,K$f:k}}G5e(k){const {annotation:x,ALb:y,mt:m="add"}=k,t=e.a.Uzj(y);return(z,v)=>z.annotationType!==x.getTypeName()||
v!==this.Aam(m)?!1:t.execute(z)}Aam(k){switch(k){case "add":return l.a.getTypeName();case "update":return l.n.getTypeName();case "delete":return l.b.getTypeName();default:throw Error(`Unknown operation type: "${k}"`);}}}Object(D.a)(a,"AugloopRequestBuilder",null,[1889,1890,1891])},2088:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e){this.parentId=e;this.execute=a=>a.parentPath.endsWith(this.parentId)}}Object(D.a)(l,"ParentIdAnnotationMatcher",null,[1886])},2109:function(D,
I,c){D=c(0);var l=c(1633),e=c(1634),a=c(1694),k=c(225),x=c(34);class y{}y.eventType="Type";y.Qhb="Time";y.eventId="Id";y.Awh="AttributionId";y.Bwh="AttributionProvider";y.zwh="AttributionName";y.jwh="AssigneeId";y.kwh="AssigneeProvider";y.iwh="AssigneeName";y.startDate="Start";y.endDate="End";y.title="Title";y.RGh="Anchor";y.anchorExtensionList="AnchorExtensionList";y.L1i="Percent";y.priority="Priority";y.undoId="UndoId";y.isLossy="IsLossy";y.recordExtensionList="RecordExtensionList";Object(D.a)(y,
"Key",null,[]);var m=c(367),t=c(1839);const z=H=>{if(!H)return null;let F=null;H=m.a.eDb(H,G=>G.toString(),G=>G.toString());0<H.count&&(F=new t.a(H));return F};c.d(I,"a",function(){return v});class v{ycg(H){if(!H)return"[]";H=v.o7k(H);return x.c(H)}Q6b(H){H=x.b(H||"[]");return v.Y6k(H)}static Hea(H,F){throw Error.argument(H,F);}static s$b(H,F){F=F.toString();return F in H?H[F].toString():null}static dHb(H,F){F=F.toString();F in H||v.Hea("dictionary",String.format("Serialized task history dictionary is missing key '{0}'",
F));return H[F].toString()}static Lrf(H,F){F=F.toString();F in H||v.Hea("dictionary",String.format("Serialized task history dictionary is missing key '{0}'",F));return Number.parseInvariant(H[F].toString())}static D7l(H,F,G){F=F.toString();return F in H?Boolean.parse(H[F].toString()):G}static E7l(H,F){F=F.toString();return F in H?H[F]:null}static Ljg(H){H=new Date(H);isNaN(H.getUTCMilliseconds())&&v.Hea("dateTime","Date and time is in invalid format");return H}static Ldf(H){return H.toISOString()}static hMh(H,
F){return z(v.E7l(H,F))}static p7k(H){const F={};F[y.eventType]=H.type;F[y.Qhb]=v.Ldf(H.time);F[y.eventId]=H.recordId;H.isLossy!==v.eAi&&(F[y.isLossy]=H.isLossy);H.user&&(H.user.UserId&&H.user.Provider&&H.user.DisplayName||v.Hea("record","HistoryRecord has invalid attribution"),F[y.Awh]=H.user.UserId,F[y.Bwh]=H.user.Provider,F[y.zwh]=H.user.DisplayName);H.commentId&&(F[y.RGh]=H.commentId);if(H.anchorExtensionList&&H.anchorExtensionList.extensions){var G=H.anchorExtensionList.extensions.Onc();F[y.anchorExtensionList]=
G}H.recordExtensionList&&H.recordExtensionList.extensions&&(G=H.recordExtensionList.extensions.Onc(),F[y.recordExtensionList]=G);switch(H.type){case 1:case 4:case 7:case 8:case 0:break;case 2:case 3:H.assignee&&H.assignee.UserId&&H.assignee.Provider&&H.assignee.DisplayName||v.Hea("record","HistoryRecord has invalid assignee");F[y.jwh]=H.assignee.UserId;F[y.kwh]=H.assignee.Provider;F[y.iwh]=H.assignee.DisplayName;break;case 5:H.schedule||v.Hea("record","Schedule history record must have a schedule object");
H.schedule.startDate&&(F[y.startDate]=v.Ldf(H.schedule.startDate));H.schedule.endDate&&(F[y.endDate]=v.Ldf(H.schedule.endDate));break;case 6:(0>H.completion||100<H.completion)&&v.Hea("record","Progress history record must have a completion >= 0 and <= 100");F[y.L1i]=H.completion;break;case 10:(0>H.priority||10<H.priority)&&v.Hea("record","Priority history record must have a completion >= 0 and <= 10");F[y.priority]=H.priority;break;case 9:H.title||v.Hea("record","SetTitle history record must have a title");
F[y.title]=H.title;break;case -1:H.undoId||v.Hea("record","Undo history record must have an id to undo");F[y.undoId]=H.undoId;break;default:v.Hea("record","Unsupported history record type")}return F}static y7k(H){var F=null,G=v.s$b(H,y.Awh);const M=v.s$b(H,y.Bwh),K=v.s$b(H,y.zwh);if(G||M||K)G&&M&&K||v.Hea("dictionary","Record has invalid attribution user"),F=new l.a(G,M,K);F=new e.a(v.Lrf(H,y.eventType),F,v.Ljg(v.dHb(H,y.Qhb)),v.dHb(H,y.eventId));F.commentId=v.s$b(H,y.RGh);F.anchorExtensionList=v.hMh(H,
y.anchorExtensionList);F.recordExtensionList=v.hMh(H,y.recordExtensionList);F.isLossy=v.D7l(H,y.isLossy,v.eAi);switch(F.type){case 1:case 4:case 7:case 8:case 0:break;case 2:case 3:F.assignee=new l.a(v.dHb(H,y.jwh),v.dHb(H,y.kwh),v.dHb(H,y.iwh));break;case 5:F.schedule=new a.a;if(G=v.s$b(H,y.startDate))F.schedule.startDate=v.Ljg(G);if(H=v.s$b(H,y.endDate))F.schedule.endDate=v.Ljg(H);break;case 10:F.priority=v.Lrf(H,y.priority);(0>F.priority||10<F.priority)&&v.Hea("dictionary","Priority record must have history >= 0 and <= 10");
break;case 6:F.completion=v.Lrf(H,y.L1i);(0>F.completion||100<F.completion)&&v.Hea("dictionary","Progress record must have history >= 0 and <= 100");break;case 9:F.title=v.dHb(H,y.title);break;case -1:F.undoId=v.dHb(H,y.undoId);break;default:v.Hea("dictionary","Unsupported history record type")}return F}static o7k(H){const F=Array(H.length);for(let G=0;G<H.length;++G)F[G]=v.p7k(H.J(G));return F}static Y6k(H){const F=new k.a;for(const G of H)H=v.y7k(G),F.add(H);return F}}v.eAi=!1;Object(D.a)(v,"JsonTaskHistorySerialization",
null,[454])},2110:function(D,I,c){D=c(0);class l{constructor(){this.dkg=new Set}subscribe(z){this.dkg.add(z)}unsubscribe(z){this.dkg.delete(z)}KB(z,v){for(const H of this.dkg)try{H.filter(z,v)&&H.action(z,v)}catch{}}}Object(D.a)(l,"DelegatingAnnotationEventHandlerImpl",null,[]);var e=c(400),a=c(370),k=c(249),x=c(1541);class y{constructor(){this.J_=[]}enqueue(z){var v;this.J_.push(z);null===(v=this.promise)||void 0===v?void 0:v.resolve()}async dequeue(){0===this.J_.length&&(this.promise=new x.a,await this.promise.completion);
return this.J_.shift()}}Object(D.a)(y,"BlockingQueue",null,[]);class m{constructor(z,v,H,F){this.tA=z;this.$2b=v;this.V3=H;this.Hqn=async()=>{await e.a.ml();return this.V3.getAugLoopRuntimeManager()};this.Xgj=new k.a(this.Hqn);this.Fqk=this.vqk(F.map(G=>G.getTypeName()))}async executeRequest(z){const v=z.operation;if(z=z.K$f)return z=this.uqo(z),await this.submitOperation(v),z;await this.submitOperation(v)}async eZh(z){const v=z.operation;z=z.K$f;if(!z)throw Error("Streaming request must have result handling");
z=this.zqo(z);await this.submitOperation(v);return z}async dispose(){await this.Xgj.value;for(const z of this.Fqk)this.tA.sc(this.$2b,z)}uqo(z){const v=z.AUc,H=z.FHd;let F;return(new Promise(G=>{F={filter:H,action:M=>{v?G(M):G(M.content)}};this.$2b.subscribe(F)})).finally(()=>{this.$2b.unsubscribe(F)})}zqo(z){const v=z.AUc,H=z.VDf;z=z.JHd;const F=new x.a,G=new y,M={filter:z,action:K=>{G.enqueue(v?K:K.content)}};this.$2b.subscribe(M);return{chunks:this.yql({[Symbol.asyncIterator](){return{async next(){const K=
await G.dequeue();return H(K)?(F.resolve(K),{value:void 0,done:!0}):{value:K,done:!1}}}}},()=>{this.$2b.unsubscribe(M)}),completion:F.completion}}async *yql(z,v){try{for await(const H of z)yield H}finally{v()}}async submitOperation(z){(await this.Xgj.value).submitOperation(Object.assign(new a.a,{operation:z}))}vqk(z){const v=new Set;for(const H of z)v.add(H)&&this.tA.ob(this.$2b,H);return v}}Object(D.a)(m,"AugloopAsyncClientImpl",null,[1906]);c.d(I,"a",function(){return t});class t{constructor(z,
v){this.tA=z;this.V3=v}L5b(z){return new m(this.tA,new l,this.V3,z.YCd)}}Object(D.a)(t,"AugloopAsyncClientFactory",null,[])},2112:function(D,I,c){D=c(0);class l{constructor(k){this.result=null;this.o9i=k}exec(k){return(this.result=this.o9i.exec(k))?!0:!1}AJ(){return this.result.index}GSd(){return this.o9i.lastIndex}}Object(D.a)(l,"RegularExpressionWrapper",null,[]);var e=c(19);c.d(I,"a",function(){return a});class a{p4c(k){return this.jvj(k).join("").replace(RegExp("(\\\\.\\\\.\\\\.)","g"),"(\\.\\.\\.|\u2026)")}M3i(k){var x=
k.text;x=k.r4d?this.WBo(x):this.jvj(x);if(k.ignorePunct||k.ignoreSpace){let y="";k.ignoreSpace&&(y+="\\s");k.ignorePunct&&(y+=a.mLn);y="["+y+"]*";for(let m=1;m<x.length;m++)if(!k.r4d||"{"!==x[m].charAt(0)&&"@"!==x[m].charAt(0))x[m]=y+x[m]}return x.join("")}sNb(k){return[k]}D1d(k){for(let x=0;x<k.length;++x){const y=k.charAt(x);let m=0;if("["===y){if(!({XD:m}=this.qVm(k.substr(x))).returnValue)return!1;x=m+x-1}else if("<"===y){if(!this.nVm(k.substr(x)))return!1}else if(">"===y){if(!x)return!1}else if("{"===
y){if(!x||!({XD:m}=this.pVm(k.substr(x))).returnValue)return!1;x=m+x-1}else if("@"===y){if(!x||!this.oVm(k.substr(x)))return!1}else if("("===y){if(!({XD:m}=this.mVm(k.substr(x))).returnValue)return!1;x=m+x-1}else if("}"===y||"]"===y||")"===y)return!1}return!0}P0h(k,x){let y,m;m=y=0;if(k.length<=x)return{returnValue:!1,XD:y,Jed:m};const t=k.length;var z=k.charAt(x);if("["===z)for(z=x+1;z<t;z++){if("]"===k.charAt(z)&&1!==z-x)return y=z,m=5,{returnValue:!0,XD:y,Jed:m}}else if("{"===z)for(z=-1,x+=1;x<
t;x++){let v=k.charAt(x);if(","===v)z=x;else if("}"===v)return m=-1===z?6:1!==x-z?7:8,y=x,{returnValue:!0,XD:y,Jed:m}}return{returnValue:!1,XD:y,Jed:m}}XQo(k,x,y){let m;if((m=x)||1!==k.length)switch(k.charAt(x+1)){case "{":let t,z;if(!({XD:t,Jed:z}=this.P0h(k,x+1)).returnValue)return{returnValue:this.LJa("*",y,!1),XD:m};k=this.LJa("*",y,!0)+this.LJa(k.substring(x+1,t+1),z);m=t;if(7===z||8===z)k+="?";return{returnValue:k,XD:m};case "@":return m=x+1,{returnValue:this.LJa("*",y,!0),XD:m};case "*":if(!x){for(m++;"*"===
k.charAt(m);)m++;if(m===k.length)return{returnValue:this.LJa("*",y,!0),XD:m}}return{returnValue:this.LJa("*",y,!1),XD:m};default:return{returnValue:this.LJa("*",y,!1),XD:m}}else return{returnValue:this.LJa(k,y,!0),XD:m}}LJa(k,x,y=!1){const m=k.length;switch(x){case 5:return"!"===k.charAt(1)&&2<m?"([^"+this.O3i(k.substr(2,m-3))+"]\u0640*)":"(["+this.O3i(k.substr(1,m-2))+"]\u0640*)";case 6:return k;case 7:return k;case 9:return"+?";case 8:return k;case 3:return"\\b";case 4:return"\\b";case 1:return".";
case 2:return y?"(.+?)":"(.*?)";case 10:return k}return null}zki(k){switch(k){case "?":return 1;case "*":return 2;case "<":return 3;case ">":return 4;case "@":return 9}return 0}RFn(k){return"["===k||"]"===k||"\\"===k||"("===k||")"===k?String.format("\\{0}",k):"'"===k||"\u2018"===k||"\u2019"===k||'"'===k||"\u201c"===k||"\u201d"===k||e.a.pda(k)?this.b3f(k):k}O3i(k){const x=[];for(let y=0;y<k.length;++y)x[y]=this.RFn(k.charAt(y));return x.join("")}qVm(k){let x;var y;x=-1;var m=new l(RegExp("\\[.+?\\]",
"g"));if(m.exec(k)){if(y=m.AJ())return{returnValue:!1,XD:x};x=m.GSd()}else return{returnValue:!1,XD:x};if((new l(RegExp("(\\(\\))|(.+?!)","g"))).exec(k.substring(1,x-1)))return{returnValue:!1,XD:x};y=new l(RegExp("[^!\\[]-[^\\]]","g"));for(k.substring(0,x);y.exec(k.substring(0,x));){m=y.AJ();const t=RegExp("[-]","g");m=k.substring(m,y.GSd()).split(t);if(m[0].charAt(0)>m[1].charAt(0))return{returnValue:!1,XD:x}}return{returnValue:!0,XD:x}}nVm(k){return(new l(RegExp("\\<(\\{|\\@|\\>|\\<|\\}|\\))","g"))).exec(k)?
!1:!0}pVm(k){let x;x=-1;var y;if((new l(RegExp("(\\}\\{)|(\\}\\@)","g"))).exec(k))return{returnValue:!1,XD:x};const m=new l(RegExp("\\{\\d+(,|(,\\d+))?\\}","g"));if(m.exec(k)){if(y=m.AJ())return{returnValue:!1,XD:x};x=m.GSd();y=RegExp("[{,}]","g");y=k.substring(0,x).split(y);if(4===y.length&&(k=Number.parseInvariant(y[1]),y=Number.parseInvariant(y[2]),k>=y))return{returnValue:!1,XD:x}}else return{returnValue:!1,XD:x};return{returnValue:!0,XD:x}}oVm(k){return(new l(RegExp("\\@\\{","g"))).exec(k)?!1:
!0}mVm(k){let x;x=-1;let y;const m=new l(RegExp("\\(([^\\[\\]]*?(\\[.+?\\])?)+?\\)","g"));if(m.exec(k)){y=m.AJ();x=m.GSd();if(y)return{returnValue:!1,XD:x};if(this.D1d(k.substring(1,x-1)))return{returnValue:!0,XD:x}}return{returnValue:!1,XD:x}}WBo(k){const x=[],y=k.length;let m=0;for(let t=0;t<y;++t){const z=m,v=k.charAt(t);let H=0,F=0;"["===v||"\\"===v||"^"===v||"$"===v||"."===v||"|"===v||"+"===v||"("===v||")"===v||"?"===v||"*"===v||"<"===v||">"===v||"@"===v||"?"===v||"{"===v?"["!==v&&"{"!==v||!({XD:H,
Jed:F}=this.P0h(k,t)).returnValue?"?"===v||"<"===v||">"===v||"@"===v?(F=this.zki(v),x[z]=this.LJa(v,F)):"*"===v?(F=this.zki(v),x[z]=({XD:H}=this.XQo(k,t,F)).returnValue,t=H):"("===v||")"===v?(F=10,x[z]=this.LJa(v,F)):x[z]=String.format("\\{0}",v):(x[z]=this.LJa(k.substr(t,H+1-t),F),t=H):x[z]="'"===v||"\u2018"===v||"\u2019"===v||'"'===v||"\u201c"===v||"\u201d"===v||"-"===v||"\u2013"===v||"\u2014"===v||e.a.pda(v)?"["+this.b3f(v)+"]":"\u2026"===v?"\\.\\.\\.":v;""!==x[z]&&0===F&&(x[z]=t<k.length-1&&("@"===
k.charAt(t+1)||"{"===k.charAt(t+1))?"("+x[z]+"\u0640*)":x[z]+"\u0640*");m++}return x}jvj(k){const x=[];for(let y=0;y<k.length;++y){const m=k.charAt(y);x[y]="["===m||"\\"===m||"^"===m||"$"===m||"."===m||"|"===m||"+"===m||"("===m||")"===m||"?"===m||"*"===m?String.format("\\{0}",m):"'"===m||"\u2018"===m||"\u2019"===m||'"'===m||"\u201c"===m||"\u201d"===m||"-"===m||"\u2013"===m||"\u2014"===m||e.a.pda(m)?"["+this.b3f(m)+"]":"\u2026"===m?"\\.\\.\\.":m;""!==x[y]&&(x[y]+="\u0640*")}return x}b3f(k){return"'"===
k||"\u2018"===k||"\u2019"===k?"'\u2018\u2019":'"'===k||"\u201c"===k||"\u201d"===k?'"\u201c\u201d':"-"===k||"\u2013"===k||"\u2014"===k?"-\u2013\u2014":e.a.pda(k)?a.$Ro:k}static get instance(){return a._instance||(a._instance=new a)}}a._instance=null;a.$Ro=" \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000";a.mLn='-\u2013.,:;/?!"\u3002\uff0c\uff1a\uff1b\u3001\uff1f\uff01\u201d\u201c';Object(D.a)(a,"WordQueryProcessor",null,[938])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/20308609/wdjs/WordEditorDSVersionHistoryRemoved.common.js.map