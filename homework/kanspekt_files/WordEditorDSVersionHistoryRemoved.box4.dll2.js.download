'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1514:function(D,I,c){D=c(0);var l=c(16),e=c(46),a=c(6),k=c(119),x=c(183),y=c(816),m=c(225),t=c(611),z=c(2),v=c(367),H=c(22),F=c(54),G=c(249),M=c(1),K=c(1584);class L{constructor(W,V){this.n2j=W;this.yA=V}J(W){return this.n2j.Fz(W,this.yA)}}Object(D.a)(L,"PropertyMergeStrategies",null,[]);var R=c(1658),S=c(1610);class N extends S.a{constructor(){super();this.t1c=this.L4d=this.Yn=null;this.$ae=0}get tha(){return"Property"}eGb(){this.detail.Z("Type",
this.tha);this.detail.Z("ComplexMerger",null!=this.Yn?this.Yn:-1);this.detail.Z("Strategy",null!=this.L4d?this.L4d:-1);this.detail.Z("ClassId",null!=this.t1c?this.t1c:-1);this.detail.Z("PropId",this.$ae);return this.detail}}Object(D.a)(N,"PropertyMergeFailureDetail",S.a,[]);c.d(I,"a",function(){return O});class O{constructor(W=null){this.mch=this.Zb=null;this.pZb=W||this.gRc()}get Yn(){return 1}get Qmb(){return this.pZb}gRc(){return[Object(F.a)(this,this.oQo,"tryPreProcessFavoredRevision"),Object(F.a)(this,
this.l_k,"cloneObjectAndRemoveNeededProperties"),Object(F.a)(this,this.eQo,"tryMergeNodeInternal")]}get yA(){return 5}get bbe(){return this.mch||(this.mch=new L(this.xk(),this.yA))}oC(W,V){const Q=W.Ng.value.xf;x.a.instance.Ua(4016352,1,4,"GenericNodeComplexMerge: Failing to merge object with [Id: {0}] [ClassId: {1}] because not all of its properties changes were ignorable.",Q.id,Q.Qc);W.uq.logger.Rg(Object.assign(new N,{Yn:this.Yn,t1c:Q.Qc,$ae:V}));return!1}gog(W){const V=W.Ng.value;x.a.instance.Ua(4016353,
1,5,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",V.xf.id,V.xf.Qc);for(let Q=0;Q<this.Qmb.length;Q++)if(!(0,this.Qmb[Q])(W))return x.a.instance.Ua(4016354,1,4,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",V.xf.id,V.xf.Qc,Q),W.uq.logger.u3d("GraphNodeComplexMerge.GetMergeFunctions()",Q),this.g5m(W),W.gl=null,!1;x.a.instance.Ua(4016355,1,5,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",V.xf.id,V.xf.Qc);
return!0}g5m(W){W.csg||(W.csg=!0,R.a(W.Ng.value.tu,"Base",1),R.a(W.Ng.value.xf,"Favored",1),R.a(W.En.value.xf,"Conflict",1))}oQo(W){const V=W.Ng.value,Q=this.bbe;if(!V.AY)return!0;let Y=!0;V.Tqa.forEach((ba,Z)=>{if(!Z.AY||W.og.contains(ba))return!0;Z=Q.J(ba);if(5===Z){const ea=V.tu.Qc;x.a.instance.Ua(4018176,1,2,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",ea,ba,Z);W.uq.logger.Rg(Object.assign(new N,
{Yn:this.Yn,t1c:ea,$ae:ba,L4d:Z}));return Y=!1}6===Z&&W.S3f.add(ba);return!0});return Y}l_k(W){W.gl=W.Ng.value.xf.XK();const V=W.S3f,Q=W.gl;V&&V.forEach(Y=>{Q.removeProperty(y.a.XX(Y));return!0});return!0}eQo(W){const V=W.En.value,Q=V.tu.Qc,Y=this.bbe;let ba=!0;V.Tqa.forEach((Z,ea)=>{const ha=Y.J(Z);ba=this.fQo(W,ea,Z,ha);ba||(W.gl=null,x.a.instance.Ua(4018177,1,4,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",Q,Z,ha),W.uq.logger.Rg(Object.assign(new N,{Yn:this.Yn,
t1c:Q,$ae:Z,L4d:ha})));return ba});return ba}fQo(W,V,Q,Y){const ba=W.gl;if(!V.AY&&8!==Y||2===Y||7===Y||W.og.contains(Q))return!0;if(5===Y)return!1;if(4===Y||3===Y){let Z;if(({value:Z}=W.Ng.value.Tqa.Fc(Q)).returnValue&&Z.AY)return 4!==Y;Y=0}8===Y&&(Y=0);if(0===Y){if(!V.isDeleted)return W=y.a.XX(Q),(O.I2o(V,Q,W)||O.Qto())&&ba.sUa(W,V.newValue),!0;Y=6}return 6===Y?(ba.removeProperty(y.a.XX(Q)),!0):1===Y?this.oC(W,Q):!1}Vcn(W,V,Q,Y,ba,Z){W=W||new m.a;V=V||new m.a;Q=Q||new m.a;var ea=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseList.Length: {0}] to not exceed [favoredList.Length: {1}] or [conflictList.Length: {2}]",
W.length,V.length,Q.length),ha=W.length<=V.length&&W.length<=Q.length;this.Zzi()&&ha&&x.a.instance.Ua(541181455,1,1,ea);if(!ha&&this.gyi(Z.runtime.Zb))return null;if(this.Zzi())for(ea=0;ea<W.length;ea++){ha=W.eg(ea);var ka=V.eg(ea);let ua=Q.eg(ea);ha=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseVal: {0}] [favoredVal: {1}] and [conflictVal: {2}] [index: {3}] [baseList.Count {4}] to all be the same.",ha,ka,ua,ea,W.length);x.a.instance.Ua(541181457,1,1,ha)}if(this.gyi(Z.runtime.Zb))for(Z=
0;Z<W.length;Z++)if(ea=W.eg(Z),ha=V.eg(Z),ka=Q.eg(Z),!Y(ea,ha)||!Y(ea,ka))return null;W=W.R5();Y=new t.a;Z=W.length;for(ea=Z;ea<V.length;ea++)ha=V.eg(ea),W.add(ha),Y.add(ha);for(;Z<Q.length;Z++)V=Q.eg(Z),Y.contains(V)?x.a.instance.Ua(4018180,1,5,"MergePurelyAdditiveLists: Both favored and conflict lists contained a reference to {0}. Only adding one copy of it.",V):(W.add(V),ba(V));return W}Zzi(){return!!z.AFrameworkApplication.K&&z.AFrameworkApplication.K.$("LogMPALErrors")}gyi(W){if(!W)return!1;
W.HVd(1000008);return W.Jjb(1000008)}aVm(W){if(!W)return!1;W.HVd(1000009);return W.Jjb(1000009)}WOi(W,V,Q,Y){return K.a(W,V,Q,Y)}kHa(W,V,Q){W=W||new m.a;V=V||new m.a;Q=Q||new m.a;const Y=W.fH(),ba=V.fH(),Z=Q.fH();W=O.filter(W,ea=>ba.contains(ea)&&Z.contains(ea));W.fH();W.aD(W.length,O.filter(V,ea=>!Y.contains(ea)));W.aD(W.length,O.filter(Q,ea=>!Y.contains(ea)&&!ba.contains(ea)));return W}Ocn(W,V){const Q=y.a.XX(V),Y=W.Xd;var ba=Y.getPropertyObjectIds(W.Ng.value.tu,Q),Z=Y.getPropertyObjectIds(W.Ng.value.xf,
Q);const ea=Y.getPropertyObjectIds(W.En.value.xf,Q);ba=this.kHa(ba,Z,ea);Z=W.gl;0<ba.length?Y.setPropertyObjectIds(Z,Q,ba):Z.removeProperty(Q);W.og.add(V)}Cgb(W,V,Q){W.hasProperty(Q)?V.sUa(Q,W.yU(Q)):V.removeProperty(Q)}X3n(W,V){var Q=V.xl();for(const Y of Q)V.removeProperty(Y);Q=W.xl();for(const Y of Q)V.sUa(Y,W.yU(Y))}CJf(W,V,Q,Y,ba){V=W.getPropertyInt32(V,ba);Q=W.getPropertyInt32(Q,ba);Q=null!=V&&null!=Q?Math.max(V,Q):null!=Q?Q:null!=V?V:null;null!=Q?W.setPropertyInt32(Y,ba,Q):Y.removeProperty(ba)}N7e(W,
V,Q,Y,ba,Z){V=W(V,ba);Q=W(Q,ba);W=W(Y,ba);Y=V.fH();let ea=!1;Z&&(ea=Z(V,Q,W));ea?(Z=!0,Y=!1):(Z=Y.RIh(Q),Y=Y.RIh(W));x.a.instance.Ua(588011013,1,4,"CheckForMaterialDifferences: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",y.a.Ab(ba),V.ir(),Q.ir(),W.ir(),Z,Y);return{DJc:W,p4a:Z,f4a:Y}}XVk(W,V,Q,Y,ba){let Z;V=W(V,ba);Q=W(Q,ba);W=W(Y,ba);Y=this.jDi(V,Q);Z=this.jDi(V,W);x.a.instance.Ua(588011014,1,4,"CheckForMaterialDifferencesInDictionaryProperty: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",
y.a.Ab(ba),V.ir(),Q.ir(),W.ir(),Y,Z);return{DJc:W,p4a:Y,f4a:Z}}jDi(W,V){if(!W&&!V)return!0;if(!W||!V)return!1;if(!W.count&&!V.count)return!0;let Q=!1;V.forEach((Y,ba)=>Q=W.nb(Y)&&ba==W.J(Y));return Q}xk(){let W;W=this.aVm(this.Zb)?O.J$j.value:O.I$j.value;const V=new v.a(0);for(let Q=0;Q<W.length;Q++)V.Z(W[Q],7);return V}static x8(){return new O}static get instance(){return O._instance.value}static Qto(){return H.a.instance.Oa("Box4.IFeatureHelper").isFeatureEnabled(78)}static I2o(W,V,Q){if(void 0!==
W.newValue&&null!==W.newValue||M.a.JAi(Q.type))return!0;O.f6m(W,V,Q);return!1}static f6m(W,V,Q){Q=Q.type===M.a.string;V=String.format("TryMergeProperty: Failed to Merge Property [ID: {0}]",V);Q||(V+=String.format(" [NewValue: {0}] [OldValue: {1}]",W.newValue,W.oldValue));x.a.instance.Ua(19145822,1,2,V)}static FPf(W,V,Q){const Y=y.a.Ab(Q),ba=W.Xd;var Z=ba.getPropertyObjectIds(W.Ng.value.tu,Q);const ea=ba.getPropertyObjectIds(W.Ng.value.xf,Q);var ha=ba.getPropertyObjectIds(W.En.value.xf,Q);ha=O.nkm(ha,
W.uq.runtime.mmc);V=V.kHa(Z,ea,ha);Z=W.gl;0<V.length?ba.setPropertyObjectIds(Z,Q,V):Z.removeProperty(Q);W.og.add(Y);return!0}static nkm(W,V){const Q=new m.a;W.forEach(Y=>{V.contains(Y,(ba,Z)=>ba.equals(Z))||Q.add(Y);return!0});return Q}static filter(W,V){const Q=new m.a;W.forEach(Y=>{V(Y)&&Q.add(Y);return!0});return Q}static u0l(){return[y.a.Ab(l.a.tif),y.a.Ab(l.a.lastModifiedTime),y.a.Ab(l.a.CL),y.a.Ab(l.a.c8c),y.a.Ab(l.a.lag),y.a.Ab(e.a.r1c),y.a.Ab(a.a.NHd),y.a.Ab(a.a.shb),y.a.Ab(k.a.Wgj)]}static v0l(){return[y.a.Ab(l.a.tif),
y.a.Ab(l.a.lastModifiedTime),y.a.Ab(l.a.CL),y.a.Ab(l.a.c8c),y.a.Ab(l.a.lag),y.a.Ab(e.a.r1c),y.a.Ab(a.a.NHd),y.a.Ab(k.a.Wgj)]}}O._instance=new G.a(O.x8);O.I$j=new G.a(O.u0l);O.J$j=new G.a(O.v0l);Object(D.a)(O,"GraphNodeComplexMerge",null,[1986])},1515:function(D,I,c){c.r(I);D=c(0);var l=c(112),e=c(1535),a=c(1521),k=c(1661),x=c(1662);class y{constructor(t,z){this.bcb=!1;this.Qia=null;if(!t)throw Error.argumentNull("annotations");if(!t.mec(z))throw Error.argument("structTypeID","Invalid struct type ID");
this.zw=t;this.Afc=this.zw.tdi(z);this.nlk=z}get d3b(){return this.zw}get isReadOnly(){return this.bcb}get SUa(){return this.nlk}ajb(t){if(0>t||t>=this.Afc)throw Error.argument("iField","Invalid field index");return this.Qia&&null!=this.Qia[t]?this.Qia[t]:this.zw.Whi(this.SUa,t)}udg(t,z){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>t||t>=this.Afc)throw Error.argument("iField","Invalid field index");if(!this.zw.jdc(this.zw.eHb(this.SUa,
t),z))throw Error.argument("value","Value is not of the correct type for the specified field");(this.Qia||(this.Qia=Array(this.Afc)))[t]=z}Mea(){const {Annotations:t}=c(1515);let z="[";if(this.Qia){let v=!0;for(let H=0;H<this.Afc;++H){if(null==this.Qia[H])continue;const F=this.zw.eHb(this.SUa,H);if(t.fsb(F,this.Qia[H],this.zw.Whi(this.SUa,H)))continue;v?v=!1:z+=", ";z+=this.zw.Xhi(this.SUa,H);z+="=";const G=this.zw.Mea(F,this.Qia[H]);F===t.caa?(z+='"',z+=e.a.pjf(G),z+='"'):z+=G}}return z+"]"}isEqual(t){const {Annotations:z}=
c(1515);if(this===t)return!0;if(!t||this.zw!==t.d3b||this.SUa!==t.SUa)return!1;for(let v=0;v<this.Afc;++v)if(!z.fsb(this.zw.eHb(this.SUa,v),this.ajb(v),t.ajb(v)))return!1;return!0}clone(){const t=new y(this.zw,this.SUa);this.Qia&&(t.Qia=Array.clone(this.Qia));return t}YT(){return this.isReadOnly?this.clone():this}RMf(){const {Annotations:t}=c(1515);if(!this.isReadOnly&&(this.bcb=!0,this.Qia))for(let z=0;z<this.Afc;++z){const v=this.Qia[z];null!=v&&t.fLb(v)}}toString(){return this.Mea()}}Object(D.a)(y,
"StructValue",null,[1241,1239]);c.d(I,"Annotations",function(){return m});class m{constructor(t,z){if(!t)throw Error.argumentNull("initData");if(!z)throw Error.argumentNull("objectFetcher");this.o9m=z.Msl;let v=0;var H=z.Nib(t.J(v));++v;this.DOf=new k.a(new x.a(H));this.j2j=t.J(v);++v;this.tMi=Array(this.iNd);this.R_c=Array(this.iNd);this.Hmb=Array(this.iNd);for(H=0;H<this.iNd;++H){this.tMi[H]=z.IB(t.J(v));++v;this.R_c[H]=t.J(v);++v;var F=t.J(v);++v;this.Hmb[H]=Array(F);for(var G=0;G<F;++G)this.Hmb[H][G]=
z.IB(t.J(v)),++v}this.mlk=t.J(v);++v;this.aNi=Array(this.Yad);this.$3d=Array(this.Yad);this.a4d=Array(this.Yad);this.Z3d=Array(this.Yad);for(H=0;H<this.Yad;++H)for(this.aNi[H]=z.IB(t.J(v)),++v,F=t.J(v),++v,this.$3d[H]=Array(F),this.a4d[H]=Array(F),this.Z3d[H]=Array(F),G=0;G<F;++G)this.$3d[H][G]=z.IB(t.J(v)),++v,this.a4d[H][G]=t.J(v),++v,this.Z3d[H][G]=({fia:v}=this.cPa(this.a4d[H][G],t,v,null,null,null)).returnValue,m.fLb(this.Z3d[H][G]);this.KWj=t.J(v);++v;this.hOf=Array(this.A3b);this.iOf=Array(this.A3b);
this.gOf=Array(this.A3b);for(H=0;H<this.A3b;++H)this.hOf[H]=z.IB(t.J(v)),++v,this.iOf[H]=t.J(v),++v,this.gOf[H]=({fia:v}=this.cPa(this.iOf[H],t,v,null,null,null)).returnValue,m.fLb(this.gOf[H])}BPc(t){for(let z=0;z<this.A3b;++z)if(this.hOf[z]===t)return z;return-1}A5h(t){if(!this.kec(t))throw Error.argument("attrID","Invalid attribute ID");return this.hOf[t]}getAttributeType(t){if(!this.kec(t))throw Error.argument("attrID","Invalid attribute ID");return this.iOf[t]}eHb(t,z){if(!this.mec(t))throw Error.argument("structTypeID",
"Invalid struct type ID");t=this.a4d[m.Zad(t)];if(0>z||z>=t.length)throw Error.argument("iField","Invalid field index");return t[z]}Mea(t,z){if(!this.$If(t))throw Error.argument("typeID","Invalid type ID");if(!this.jdc(t,z))throw Error.argument("value","Value is not of the correct type");switch(t){case m.caa:return z;case m.iAa:return z?"True":"False";case m.NJa:case m.Tra:return z.toString();case m.PV:return z.Mea();default:if(!m.tI(t)&&m.gdd(t)){t=m.fjf(t);const F=this.Hmb[t].length;switch(this.R_c[t]){case 0:return this.Hmb[t][z];
case 1:if(z){var v="";for(var H=1;H<F;++H)z&1<<H-1&&(0<v.length&&(v+=" & "),v+=this.Hmb[t][H]);return v}return this.Hmb[t][0];case 2:v="";for(H=0;H<F;++H)z&1<<H&&(0<v.length&&(v+=" & "),v+=this.Hmb[t][H]);return v;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.R_c[t]);}}else return z.Mea()}}$If(t){switch(t){case m.caa:case m.iAa:case m.NJa:case m.Tra:case m.PV:return!0;default:return m.tI(t)?this.$If(m.N2a(t)):m.gdd(t)?this.kXm(t):this.mec(t)}}kXm(t){t=m.fjf(t);return 0<=
t&&t<this.tMi.length}mec(t){t=m.Zad(t);return 0<=t&&t<this.aNi.length}kec(t){return 0<=t&&t<this.A3b}jdc(t,z){if(null==z)return!1;switch(t){case m.caa:return"string"===typeof z;case m.iAa:return"boolean"===typeof z;case m.NJa:return"number"===typeof z;case m.Tra:return"number"===typeof z;case m.PV:return Object(l.a)(1238,z);default:if(m.tI(t))return Object(l.a)(1240,z)&&z.g5===m.N2a(t);if(m.gdd(t)){if("number"!==typeof z)return!1;t=m.fjf(t);const v=this.Hmb[t].length;switch(this.R_c[t]){case 0:return 0<=
z&&z<v;case 1:return!(z&-1<<v-1);case 2:return!!z&&!(z&-1<<v);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.R_c[t]);}}else return Object(l.a)(1241,z)&&z.SUa===t}}get A3b(){return this.KWj}get iNd(){return this.j2j}get Yad(){return this.mlk}EOl(t){if(!this.kec(t))throw Error.argument("attrID","Invalid attribute ID");return this.gOf[t]}tdi(t){if(!this.mec(t))throw Error.argument("structTypeID","Invalid struct type ID");return this.$3d[m.Zad(t)].length}Xhi(t,z){if(!this.mec(t))throw Error.argument("structTypeID",
"Invalid struct type ID");return this.$3d[m.Zad(t)][z]}Whi(t,z){if(!this.mec(t))throw Error.argument("structTypeID","Invalid struct type ID");t=this.Z3d[m.Zad(t)];if(0>z||z>=t.length)throw Error.argument("iField","Invalid field index");return t[z]}cPa(t,z,v,H,F,G){if(!z)throw Error.argumentNull("initData");if(m.tI(t)){var M=z.J(v);++v;t=m.N2a(t);var K=new a.a(this,t);for(var L=0;L<M;++L)Array.add(K.items,({fia:v}=this.cPa(t,z,v,H,F,G)).returnValue);return{returnValue:K,fia:v}}switch(t){case m.caa:return{returnValue:(H||
this.DOf).IB(z.J(v++)),fia:v};case m.iAa:return{returnValue:1===z.J(v++),fia:v};case m.NJa:return{returnValue:z.J(v++),fia:v};case m.Tra:return{returnValue:(F||this.o9m)[z.J(v++)],fia:v};case m.PV:t=z.J(v++);M=new e.a(this);for(K=0;K<t;++K)L=z.J(v),++v,G&&(L=G[L]),M.$y(L,({fia:v}=this.cPa(this.getAttributeType(L),z,v,H,F,G)).returnValue);return{returnValue:M,fia:v};default:if(m.gdd(t))return{returnValue:z.J(v++),fia:v};if(m.GDj(t)){M=z.J(v++);K=new y(this,t);for(L=0;L<M;++L){const R=z.J(v);++v;K.udg(R,
({fia:v}=this.cPa(this.eHb(t,R),z,v,H,F,G)).returnValue)}return{returnValue:K,fia:v}}throw Error.argument("typeID","Invalid type ID");}}static gdd(t){return 16<=(t&16383)&&16384!==(t&16384)&&32768!==(t&32768)}static GDj(t){return 16<=(t&16383)&&16384===(t&16384)&&32768!==(t&32768)}static tI(t){return 32768===(t&32768)}static R3l(t){if(m.tI(t))throw Error.argument("nonListTypeID","Non-list type ID required");return t|32768}static N2a(t){if(!m.tI(t))throw Error.argument("listTypeID","List type ID required");
return t&-32769}static fsb(t,z,v){switch(t){case m.caa:case m.iAa:case m.NJa:case m.Tra:return z===v;case m.PV:return z.isEqual(v);default:return m.tI(t)?z.isEqual(v):m.gdd(t)?z===v:z.isEqual(v)}}static fLb(t){Object(l.a)(1239,t)&&t.RMf()}static YT(t){return Object(l.a)(1239,t)?t.YT():t}static fjf(t){return t-16}static Zad(t){return(t&-16385)-16}}m.caa=1;m.iAa=2;m.NJa=3;m.Tra=5;m.PV=9;Object(D.a)(m,"Annotations",null,[1242])},1519:function(D,I,c){D=c(0);var l=c(348);class e{constructor(){this.userId=
this.email=this.displayName=null}}Object(D.a)(e,"InsertMentionParameters",null,[]);class a{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(D.a)(a,"InsightsParameters",null,[]);var k=c(1752),x=c(1753),y=c(1754),m=c(1755),t=c(2),z=c(1566),v=c(1581),H=c(34),F=c(20),G=c(19),M=c(25);c.d(I,"a",function(){return K});class K{static get ICf(){return"Insights_16x16x32"}static get iEl(){return"Find_16x16x32"}static get O0i(){return"-Parameterized"}static get fig(){return"Parameterized"}static get une(){return"bTryQuery"}static get oog(){return"TellMeSuggestion_"}static get gDj(){return"bTryQueryAlternate"}static get Jlg(){return"MenuTellMe"}static get rCn(){const L=
{},R=[];Array.add(R,{Term:{PeopleType:"Person"}});L.And=R;return L}static wcf(L){return L+K.O0i}static getParameter(L){let R="",S="";if(L)for(let N=0;N<L.t_h;++N)"Type"===L.Hqf(N)?R=L.getValue(N):"Value"===L.Hqf(N)&&(S=L.getValue(N));return new l.a(R,S)}static sDb(L){L=Object.assign(new a,{neighborhood:L,mentionStart:0,mentionLength:L.length});return H.c(L)}static XNh(L,R,S){L=Object.assign(new e,{displayName:L,email:R,userId:S});return H.c(L)}static VOa(L,R,S=null){return H.c(K.Chi(L,R,S,null))}static Chi(L,
R,S=null,N=null){L=Object.assign(new v.a,{neighborhood:L,mentionStart:0,mentionLength:L?L.length:0});return Object.assign(new z.a,{selection:L,userIntent:N,entryPoint:R,launchData:S})}static j8n(L,R){return K.VOa(L,K.dfj(R))}static dfj(L){switch(L){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;case "GenerateDeckFromFile":return 38;default:return 0}}static ONm(){return!!t.AFrameworkApplication.K&&t.AFrameworkApplication.K.$("IsGoLocalEnvironment")}static Ydc(){const L=
t.AFrameworkApplication.K?t.AFrameworkApplication.K.kb("SovereignEnvironmentName"):null;return!!L&&0<L.length}static isEnterpriseUser(){const L=t.AFrameworkApplication.K?t.AFrameworkApplication.K.kb("HostAuthType"):null;return!!L&&"aad"===L.toLowerCase()||"external"===L&&K.xEf()}static $fg(L){return L.YIo&&!K.Ydc()}static kUm(){const L=t.AFrameworkApplication.K?t.AFrameworkApplication.K.kb("UiHostIntegrationType"):"";return!!t.AFrameworkApplication.K&&"UnifiedUiHostTeams"===L&&t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",
!1)}static Zfg(L){return L.iVa&&L.lCl&&(L.Ibd||L.Gbd||L.Rlb)&&!K.kUm()&&K.isEnterpriseUser()&&!K.Ydc()}static Lpa(){return t.AFrameworkApplication.K?t.AFrameworkApplication.r8a||t.AFrameworkApplication.K.$("SmartLookupEnableNativePane"):t.AFrameworkApplication.r8a}static FR(L){return!L||K.eDi(L.Gg)}static eDi(L){return!L||!L.trim().length}static ene(L){if(!L)return 0;const R=Math.pow(10,5);return Math.round(L*R)/R}static kLo(){var L=new Date;return L?new Date(L.getUTCFullYear(),L.getUTCMonth(),L.getUTCDate(),
L.getUTCHours(),L.getUTCMinutes(),L.getUTCSeconds(),L.getUTCMilliseconds()):null}static Nvf(L){L=new Date(L);return(K.kLo().getTime()-L.getTime())/1E3}static NDi(L){const {InsightsMenuItemFactory:R}=c(1751);switch(L){case k.a.xzf:case x.a.g1h:case R.Cti:case y.a.PRi:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "ActionAIFromTellMe":case "LaunchAddinDialogFromTellMe":case "GenerateSlidesFromTellMe":case "QuickActionOnFile":case "SummarizeDeckFromTellMe":case "SummarizeSlidesFromTellMe":return!0}return L.startsWith(K.une)||
L.startsWith(K.oog)||L.startsWith(K.gDj)||L.startsWith("PeopleSuggestion")||L.startsWith("FileSuggestion")||L.startsWith("FindInDocumentSuggestion")||L.startsWith("NotesSuggestion")||L.startsWith("OnenoteNotesSuggestion")||L.startsWith("SmartLookupFromTellMe")||L.startsWith("GetHelpFromTellMe")||L.startsWith("GetHelpWithDescriptionFromTellMe")||L.startsWith("AddinSuggestion")||L.startsWith("OfficeScripts")?!0:!1}static arf(L,R){const S=[];Array.add(S,new m.a(400,L));Array.add(S,new m.a(200,R));L=
{};L.parts=S;return JSON.stringify(L)}static Kib(L){const R=L.indexOf("<b0>"),S=L.lastIndexOf("</b0>"),N=[];Array.add(N,new m.a(400,L.substring(0,R)));Array.add(N,new m.a(600,L.substring(R+4,S)));Array.add(N,new m.a(400,L.substring(S+5,L.length)));L={};L.parts=N;return JSON.stringify(L)}static uji(L){const R=K.Nvf(L);return 60>R?CommonUIStrings.l_TimeSince_SecsAgo:3600>R?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(R/60).toString()):86400>R?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(R/3600).toString()):172800>R?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(L)).localeFormat("MMMM dd, yyyy"))}static eSl(L){const R=Array(L.length);for(let S=0;S<L.length;S++)R[S]=L[S].commandId;return R}static xEf(){if("Dev Box"===t.AFrameworkApplication.K.kb("StatusBarEnvironmentNameToUse"))return!0;let L=t.AFrameworkApplication.K.kb("UserPrincipalName");L=M.c(L)?"":G.a.eh(L);const R=t.AFrameworkApplication.K.rw("TellMeIntEnabledForFeatureCrew")?
t.AFrameworkApplication.K.DB("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(R,L)&&"inner"===t.AFrameworkApplication.K.kb("Microsoft365Ring")}static q0l(L){switch(K.NRd(L)){case "PowerPoint":return"SaveAsPowerPointPptx_20";case "Word":return"SaveAsWordDocx_20";case "Excel":return"SaveAsExcelXlsx_20";case "Pdf":return"PdfFile_20";case "OneNote":return"OneNote_20";case "Visio":return"visio_20"}return""}static Nem(L){L=K.NRd(L);switch(L){case "PowerPoint":return"pptx";case "Word":return"docx";
case "Excel":return"xlsx";default:return L}}static NRd(L){switch(L.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"PowerPoint";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"Word";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"Excel";case "pdf":return"Pdf";case "one":case "onepkg":return"OneNote";
case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio"}return"Unknown"}static zpa(){return F.a.S4&&!F.a.Fr}}K.T8a=9E5;Object(D.a)(K,"TellMeUtils",null,[])},1520:function(D,I,c){c.r(I);D=c(0);var l=c(503),e=c(359),a=c(54),k=c(112),x=c(69),y=c(1672),m=c(219);class t{constructor(Va,Qb,Vb,Sb,nb,ac){this.groupType=Va;this.resultType=Qb;this.Zjg=Vb;this.i9=Sb;this.fgf=nb;this.resultIndex=
ac}}Object(D.a)(t,"ClickLoggingInfo",null,[]);const z=Va=>{const Qb=[];for(;Va;)Array.add(Qb,"{ContextId:"+Va.contextId+", IsGraphNodeContext:"+Va.el+"}"),Va=Va.ik;Qb.reverse();return"{"+Qb.join(", ")+"}"};class v{constructor(){this.rpa=this.sessionId=null}}Object(D.a)(v,"CorrelationRecord",null,[1118]);var H=c(1540);class F{constructor(Va,Qb){this.provider=Va;this.g9a=Qb}}Object(D.a)(F,"ExternalResultProvider",null,[]);class G{constructor(Va,Qb){this.Id=null;this.TimeStamp=0;this.Id=Va;this.TimeStamp=
Qb}}Object(D.a)(G,"MRUControl",null,[]);var M=c(1663),K=c(1519),L=c(2),R=c(1395);class S{constructor(Va,Qb){this.$ak=10;this.z7=[];this.XBa=[];this.d2g=this.c2g=!1;this.Fzc=this.Ezc="";this.nZb=Qb;this.fc=Va}dQc(){!this.c2g&&this.fc&&(this.Ezc="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.fc.application,this.z7=this.q6h(),this.c2g=!0);return this.z7}Ram(){!this.d2g&&this.fc&&(this.Fzc="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.fc.application,this.XBa=this.q6h(!0),this.d2g=!0);return this.XBa}kWm(Va){return Va.startsWith("TellMeUpsell")||
"OpenInClientUpsell"===Va||"TryOfficeUpsell"===Va}cEf(Va){return this.hIm(Va)||this.kWm(Va)||K.a.NDi(Va)?!1:!0}t_a(Va){Va=Va.ControlId;this.cEf(Va)&&(Va=this.C8f(Va),this.g0n(Va),this.i$m(),Array.insert(this.z7,0,new G(Va,Date.now())),this.Ezc.length&&(Va=JSON.stringify(this.z7),R.a.instance.setItem(this.Ezc,Va)))}WE(Va){this.h$m();Array.insert(this.XBa,0,new G(M.a[Va],Date.now()));this.Fzc.length&&(Va=JSON.stringify(this.XBa),R.a.instance.setItem(this.Fzc,Va))}q6h(Va=!1){if(!this.z7.length){var Qb=
Va?R.a.instance.getItem(this.Fzc):R.a.instance.getItem(this.Ezc);if(!Qb||""===Qb)return Va?this.XBa:this.z7;let Vb=null;try{Vb=JSON.parse(Qb)}catch(Sb){this.mYk(Va),Vb=null}if(!Vb||!Vb.length||10<Vb.length)return Va?this.XBa:this.z7;Qb=0;for(const Sb of Vb)if(Va||this.fc.B1d(Sb.Id)&&this.cEf(Sb.Id))if(Va?Array.insert(this.XBa,Qb++,Sb):Array.insert(this.z7,Qb++,Sb),Qb===this.nZb)break}return Va?this.XBa:this.z7}q$e(Va){Va=this.C8f(Va);for(const Qb of this.z7)if(Qb.Id===Va)return!0;return!1}mYk(Va=
!1){R.a.instance.setItem(Va?this.Fzc:this.Ezc,"")}vKm(Va){Va=this.C8f(Va.ControlId);return this.cEf(Va)?this.q$e(Va):!1}g0n(Va){if(0<this.z7.length){let Qb=0;for(const Vb of this.z7){if(Vb.Id===Va){Array.removeAt(this.z7,Qb);break}Qb++}}}C8f(Va){return"Excel"===this.fc.application&&Va.startsWith("m_excelWebRenderer_ewaCtl_")?Va.substr(26,Va.length):Va}i$m(){this.z7.length===this.nZb&&Array.removeAt(this.z7,this.z7.length-1)}h$m(){this.XBa.length===this.$ak&&Array.removeAt(this.XBa,this.XBa.length-
1)}hIm(Va){Va=Va.split("|");let Qb="";if(6<=Va.length)Qb=Va[0];else if(3<=Va.length){if("3"===Va[0])return!0;Qb=Va[1]}return Qb.startsWith("WA")}static createInstance(Va){let Qb=3;L.AFrameworkApplication.K&&(Qb=L.AFrameworkApplication.K.mc("TellMeMaxRecommendedResultsToReturn",3));return new S(Va,Qb)}}Object(D.a)(S,"MruControlsManager",null,[1117]);class N{constructor(Va){this.$xb=Va}Zga(Va,Qb){let Vb;return Va.hD&&(Vb=this.$xb[Va.value])?Vb.Zga(Va,Qb):(Vb=this.p7h(Va.value))?Vb.Zga(Vb.Pen,Qb):null}y9l(Va,
Qb){if(Va=this.$xb[Va])for(const Vb of Qb)if(Qb=K.a.getParameter(Vb),Qb.key===Va.W_f)return Qb.value;return null}Hin(Va){(Va=this.p7h(Va))&&Va.Ein()}p7h(Va){const Qb=Va.indexOf(K.a.O0i);return 0<Qb?this.$xb[Va.substring(0,Qb)]:null}}Object(D.a)(N,"ParameterizedCommandManager",null,[1115]);var O=c(1551);class W{constructor(Va,Qb){this.Gg=Va;this.Oob=Qb}}Object(D.a)(W,"TellMeQuery",null,[]);var V=c(1660);class Q{constructor(Va,Qb){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=Va;this.TimeElapsedSinceClick=
Qb}}Object(D.a)(Q,"CommandClickedEvent",null,[]);var Y=c(25);class ba{constructor(Va,Qb){this.qdk=Va;this.Tta=Qb}resultsUpdated(Va){this.qdk(Y.c(Va.query)?"":Va.query.Gg,Va.vo,Va.attributes,this.Tta,Va.Ddc)}}Object(D.a)(ba,"ResultsUpdatedCallback",null,[1114]);class Z{constructor(Va,Qb,Vb,Sb,nb){this.CommandId=this.ControlId=null;this.TimeElapsedSinceClick=0;this.TerminalParentControlId=this.CommandSurface=null;this.ControlId=Va;this.TimeElapsedSinceClick=Vb;this.CommandSurface=Sb;this.CommandId=
Qb;this.TerminalParentControlId=nb}}Object(D.a)(Z,"UserActionEvent",null,[]);var ea=c(75);class ha{constructor(Va,Qb){this.menuModel=Va;this.bfj=Qb}}Object(D.a)(ha,"GeneratedMenuModel",null,[]);class ka{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(D.a)(ka,"MenuModel",null,[]);class ua{constructor(Va,Qb,Vb){this.fc=Va;this.$xb=Qb;this.iga=Vb}BLl(Va,Qb,Vb){const {TellMeActor:Sb}=c(1520);let nb=0;const ac=new ka,zc=[];let Ib=
"";ac.sections=[];let ya=new ea.a;const ib=!!this.fc&&this.fc.Y4a;var wb=!!this.fc&&this.fc.rqb||L.AFrameworkApplication.ua.Kb.rqb;for(const lc of Va){Va=0;ib||(ya=new ea.a);const Kb=new ea.a;let Bc=lc.displayName;for(const Xc of lc.results){if(0<=Xc.value.indexOf(K.a.fig)){if(Xc.hD){var bc=this.$xb[Xc.value];if(bc&&Xc.value.endsWith(K.a.fig)){if("FindParameterized"!==Xc.value&&!wb){const vd=[];vd.push(appChrome.actions.setControlLabel(Xc.value,bc.DSd(Xc)));vd.push(appChrome.actions.setButtonCommandValueId(Xc.value,
bc.fpf(Xc)));appChrome.api.dispatch(vd)}bc=Xc.value.replace(K.a.fig,"");ya.remove(bc)?Va--:Kb.add(bc);ya.add(Xc.value);Va++}}}else switch(Xc.type){case 5:Kb.contains(Xc.value)||(ya.add(Xc.value),Va++);break;case 7:ya.add(Xc.hD);Va++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 25:case 26:case 6:case 19:case 20:case 21:case 27:case 29:case 28:case 30:case 31:ya.add(Xc.value),Va++}13===lc.groupType&&(Bc=K.a.Lpa()?0<Qb.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,
Qb):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,Qb));21===lc.groupType&&(Bc=CommonUIStrings.l_LearningUILiveText)}nb+=Va;""!==Bc&&0<Va&&(Ib+=" , "+Va.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+Bc+" , ");0<ya.count&&!ib&&(Va=appChrome.api.menuSection(ya.toArray(),lc.displayName,null,O.a[lc.groupType]),zc.push(Va))}wb=null;0<nb&&(wb=0<Qb.length?1!==nb?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,
nb,Qb):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,Qb):1!==nb?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,nb):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,ib?(Qb=appChrome.api.menuSection(ya.toArray(),"",null,null),zc.push(Qb)):wb+=Ib);Vb&&(this.fc.bxa?Sb.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(wb)):appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(wb)));ac.sections=
zc;return new ha(ac,nb,[])}static get $hf(){return ua.dUg||(ua.dUg=new ha(Object.assign(new ka,{sections:[]}),0,[]))}}ua.dUg=null;Object(D.a)(ua,"TellMeMenuDefintionGenerator",null,[]);var sa;(function(Va){Va[Va.TellMeControlActivated=0]="TellMeControlActivated";Va[Va.TellMeQueryExecuted=1]="TellMeQueryExecuted";Va[Va.TellMeResultsRendered=2]="TellMeResultsRendered";Va[Va.TellMeControlDeactivated=3]="TellMeControlDeactivated"})(sa||(sa={}));Object(D.b)("PerformanceMarker",sa);var Da;(function(Va){Va[Va.TellMeTimeToRender=
0]="TellMeTimeToRender";Va[Va.TellMeSessionLength=1]="TellMeSessionLength";Va[Va.TellMeResultTriageTime=2]="TellMeResultTriageTime"})(Da||(Da={}));Object(D.b)("PerformanceMeasure",Da);class Pa{mark(Va){window.performance.mark(sa[Va])}measure(Va,Qb,Vb){const {TellMeActor:Sb}=c(1520);try{window.performance.measure(Da[Va],sa[Qb],sa[Vb])}catch(nb){Sb.instance.Oe.onError("TellMePerformance:Measure","error measuring "+Da[Va])}}rNf(Va,Qb,Vb){const {TellMeActor:Sb}=c(1520);Sb.instance.Oe.ANf(Qb,Vb,Va,this.B4l(Va))}QYk(){var Va=
[0,1,2,3];for(const Qb of Va)window.performance.clearMarks(sa[Qb])}clearMeasures(Va){for(const Qb of Va)window.performance.clearMeasures(Da[Qb])}B4l(Va){let Qb=0;(Va=this.oNl(Va))&&0<Va.length&&(Qb=Va[Va.length-1].duration);return Qb}oNl(Va){return window.performance.getEntriesByName(Da[Va],"measure")}}Object(D.a)(Pa,"TellMePerformance",null,[]);var Ra=c(1587),Ga=c(1586),ta=c(34);class va{constructor(Va){this.omk=Va}VMb(Va,Qb,Vb){const {TellMeActor:Sb}=c(1520);Sb.instance.Oe.W9(Qb,Ga.a.Kic,Va.data.Se.toString(),
Math.round(window.performance.now()-Vb),Ga.a.Kic,!0,Ra.a.LQa);Va=ta.b(Va.data.se);Qb=-1;Va.Index&&(Qb=Va.Index);Sb.instance.Oe.l7m(Qb,this.omk)}DMb(Va,Qb,Vb){const {TellMeActor:Sb}=c(1520);Sb.instance.Oe.W9(Qb,Ga.a.Kic,Va.data.Se.toString(),Math.round(window.performance.now()-Vb),Ga.a.Kic,!1,Ra.a.LQa)}Xam(Va){if(Va&&""!==Va.trim()){const Vb=window.performance.now(),Sb=L.AFrameworkApplication.Oyj;var Qb={};Qb.Text=Va;Qb.IsFileHash="false";Qb=ta.c(Qb);L.AFrameworkApplication.He.mj(Sb,2,Qb,{"Content-Type":"application/json",
Accept:"application/json"},!1,0,nb=>{this.VMb(nb,Va.length,Vb)},nb=>{this.DMb(nb,Va.length,Vb)},null,null,!1,4E3,6E3)}}}Object(D.a)(va,"TellMeQueryIndexCallback",null,[]);var ia=c(1522);class qa{constructor(Va,Qb,Vb){this.xml=Va;this.bfj=Qb;this.jql=Vb}}Object(D.a)(qa,"GeneratedMenuXml",null,[]);var pa=c(1752),Fa=c(19);class za{constructor(Va,Qb){this.Yid=Va||{};this.JYa=Qb}get tPb(){return 5}Zga(Va,Qb=null){return this.JYa.Zga(Va,Qb)||this.oNk(Va.value)}oNk(Va){return za.F5e(Va,this.Yid[Va]||null)}static F5e(Va,
Qb=null){Va=String.format('<ClonedControl Id="{0}" ',Va);for(let nb in Qb){var Vb=nb,Sb=Qb[nb];Sb=Sb?Fa.a.zf(Sb.toString()):"";Va+=String.format('{0}="{1}" ',Vb,Sb)}return Va+"/>"}}Object(D.a)(za,"CommandMenuItemFactory",null,[1111]);var Oa=c(164);class xa{constructor(){this.c3j=CommonUIStrings.l_FindInDocumentText}get tPb(){return 8}Zga(Va){var Qb=Va.hD;Va=Fa.a.zf(Va.value);const Vb=Fa.a.zf(Qb);Qb=Fa.a.zf(String.format(this.c3j,Qb));return this.PKl(Va,Vb,Qb)}PKl(Va,Qb,Vb){return Oa.a(Va,"1540292897",
Vb,K.a.iEl,null,Qb,Vb,null,null)}}Object(D.a)(xa,"FindInDocumentMenuItemFactory",null,[1111]);var fa=c(1753),Ka=c(1751),lb=c(1754);class Xa{get tPb(){return 7}Zga(Va){const Qb=Object(x.a)(V.a,Va);return this.KLl(Fa.a.zf(Va.value),Qb.id)}KLl(Va,Qb){return Oa.a(Qb,"1404166600",Va,null,null,Va,Va,null,null)}}Object(D.a)(Xa,"TryQueryMenuItemFactory",null,[1111]);class kb{constructor(Va){this.a7=[];this.fc=Va}GXl(Va){for(const Qb of this.a7)if(Qb.tPb===Va)return Qb;return null}ia(Va){this.a7.push(Va)}kVn(Va){this.ia(new za(this.fc.J6k,
Va));this.ia(new lb.a(this.fc.thn));this.ia(new pa.a(this.fc.aco,this.fc.$bo,this.fc.gJo,this.fc.mum,this.fc.Uso));this.ia(new Ka.InsightsMenuItemFactory);this.ia(new xa);this.ia(new fa.a);this.ia(new Xa)}}Object(D.a)(kb,"MenuItemFactoryRegistry",null,[]);var Bb=c(1524);class Ja{constructor(Va,Qb){this.fc=Va;this.h7g=new kb(this.fc);this.h7g.kVn(Qb)}CLl(Va,Qb){let Vb=0;const Sb=[],nb=[];for(const zc of Va){Va=K.a.Jlg;var ac=[];for(const Ib of zc.results){const ya=this.h7g.GXl(Ib.type).Zga(Ib,Qb);
Va=K.a.Jlg;ac.push(ya);if(13===Ib.type||14===Ib.type)Va="Menu32";17===Ib.type&&(Va="MenuTellMeExtended");Ib.groupType=zc.groupType;nb.push(Object(x.a)(Bb.a,Ib))}Vb=Vb?Vb:ac.length;ac=Oa.d("TellMeDropdownControls",ac);Va=Oa.g("TellMeDropdownMenuSection",ac,Va,zc.displayName);Sb.push(Va)}Qb=Oa.h(Sb,"LookupDropdownMenu");return new qa(Qb,Vb,nb)}static get CMd(){return Ja.eUg||(Ja.eUg=new qa(Oa.h([],"LookupDropdownMenu"),0,[]))}}Ja.eUg=null;Object(D.a)(Ja,"TellMeXmlGenerator",null,[]);class Ma{}Ma.Kfn=
"MRU";Ma.test="Test";Object(D.a)(Ma,"ActionType",null,[]);var fb=c(1570),hc;(function(Va){Va[Va.Service=0]="Service";Va[Va.Local=1]="Local";Va[Va.MRU=2]="MRU";Va[Va.TestResult=3]="TestResult";Va[Va.Unknown=4]="Unknown"})(hc||(hc={}));Object(D.b)("SubResultType",hc);var cc=c(85);class mb{constructor(Va,Qb,Vb,Sb,nb=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=this.SubResultType=this.ResultType=null;this.CommandId=Va;this.IsEnabled=Qb;this.ResultType=M.a[Vb];this.SubResultType=hc[Sb];
this.OptionalData=nb?cc.a.toJSON(nb):null}}Object(D.a)(mb,"ResultInfo",null,[]);var Hb=c(114),Ua=c(190),Ya=c(292);class Fb{constructor(Va,Qb=null){this.uod="TellMeWAC.";this.Vek=Va;this.rnk=Qb}GIa(Va,Qb,Vb){Qb=Hb.a.oJ(Qb);Va=Hb.a.rcf(Va,this.Vek,this.rnk,Vb,Qb);Ua.a.GIa(Va,this.uod)}FIa(Va,Qb,Vb=0){Qb=Hb.a.oJ(Qb);Ua.a.FIa(Object.assign(new Ya.a,{name:Va,dataFields:Qb,durationMs:Vb}),this.uod)}}Object(D.a)(Fb,"TellMeOtelLogger",null,[1141]);var Wa=c(139);class yb{constructor(Va,Qb,Vb,Sb,nb,ac,zc){this.B7=
this.lba=this.FPg=null;this.Vea=Va;this.oab=Qb;this.eNa=Vb;this.acb=Sb;this.VXa=nb;this.L9j=ac;this.B7=zc?zc:new Fb(this.acb?m.CuiHelper.eig:m.CuiHelper.Lle)}get Ir(){return this.acb}get Xqa(){return this.eNa}Che(Va){this.FPg=Va;switch(Va){case ia.a.contextMenu:this.lba=ia.a.contextMenu;break;default:this.lba=ia.a.tellMe}}kKk(Va,Qb){this.eNa.rpa||(this.eNa.rpa=Wa.a.create().toString(),this.oKi(Va,!0,Qb))}XWh(Va,Qb=!0){this.eNa.rpa&&this.W4m(Va,Qb);this.acb&&appChrome.api.updateTellMeCorrelationId("");
this.eNa.rpa=null}oKi(Va,Qb,Vb){const {TellMeActor:Sb}=c(1520),nb=this.A8(H.a.Z3a);nb[fb.a.culture]=this.oab;nb[fb.a.appName]=this.Vea;nb[fb.a.context]=Va;nb[fb.a.K0d]=this.VXa;nb[fb.a.iWm]=this.L9j;nb[fb.a.UUm]=Vb;nb[fb.a.$Om]=Qb;nb[fb.a.contentType]=Sb.instance.eKd;this.B7.GIa(H.a.Z3a,nb,this.FPg);this.acb&&appChrome.api.updateTellMeCorrelationId(this.eNa.rpa)}W4m(Va,Qb){const Vb=this.A8(H.a.OIb);Vb[fb.a.wtl]=Va;Vb[fb.a.ZOm]=Qb;this.B7.FIa(H.a.OIb,Vb)}k7m(Va,Qb,Vb){let Sb=0;!Vb&&0<Va.length&&(Sb=
Va.trim().split(" ").length);const nb=this.A8(H.a.query);nb[fb.a.query]="!";nb[fb.a.oOb]=Qb;nb[fb.a.f6i]=Va.length;nb[fb.a.cFi]=Vb;nb[fb.a.m8o]=Sb;this.B7.GIa(H.a.query,nb,this.lba)}l6m(Va,Qb,Vb,Sb,nb,ac,zc,Ib=null){const ya=this.A8(H.a.latency);ya[fb.a.culture]=this.oab;ya[fb.a.f6i]=Va;ya[fb.a.LDj]=Qb;ya[fb.a.statusCode]=Vb;ya[fb.a.service]=nb;ya[fb.a.isSuccess]=ac;ya[fb.a.r_m]=zc;Ib&&(ya[fb.a.NLo]=Ib);this.B7.FIa(H.a.latency,ya,Sb)}ANf(Va,Qb,Vb,Sb){const nb=this.A8(H.a.performance);nb[fb.a.culture]=
this.oab;nb[fb.a.oKk]=sa[Va];nb[fb.a.Tvl]=sa[Qb];nb[fb.a.ICn]=Da[Vb];this.B7.FIa(H.a.performance,nb,Sb)}s7m(Va,Qb){var {TellMeActor:Vb}=c(1520);const {CommandResultsUtility:Sb}=c(1559);if(Va.results.length){var nb=this.A8(H.a.Rcj);nb[fb.a.i9]=Qb.toString();nb[fb.a.groupType]=O.a[Va.groupType];16===Va.groupType&&(nb[fb.a.sUm]=Vb.instance.ged);Qb=[];Vb=[];var ac=[];for(const zc of Va.results)nb[fb.a.resultType]||(nb[fb.a.resultType]=M.a[zc.type]),Va={},27===zc.type&&(Va.AssetId=zc.cJ),Vb.push(Sb.fWc(zc.value)),
Qb.push(zc.value),ac.push(new mb(zc.value,Sb.fWc(zc.value),zc.type,zc.Wwj,Va));0<Qb.length&&(nb[fb.a.l8n]="{"+Qb.join(", ")+"}",nb[fb.a.svl]="{"+Vb.join(", ")+"}",nb[fb.a.h8n]=ta.c(ac));this.B7.GIa(H.a.Rcj,nb,this.lba)}}qMl(Va,Qb){if(4===Va)return Ma.Kfn;switch(Qb){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return M.a[Qb]}y4m(Va,Qb,Vb,Sb,nb){const ac=this.A8(H.a.click);ac[fb.a.LDj]=Va;ac[fb.a.GAn]=Qb;ac[fb.a.commandId]=
Vb;ac[fb.a.e4]=Sb;ac[fb.a.actionType]=this.qMl(nb.groupType,nb.resultType);ac[fb.a.resultType]=M.a[nb.resultType];ac[fb.a.Zjg]=hc[nb.Zjg];ac[fb.a.groupType]=O.a[nb.groupType];ac[fb.a.i9]=nb.i9.toString();ac[fb.a.fgf]=nb.fgf.toString();ac[fb.a.resultIndex]=nb.resultIndex.toString();this.B7.GIa(H.a.click,ac,this.lba)}E4m(Va,Qb){this.eNa.rpa||(this.eNa.rpa=Wa.a.create().toString(),this.oKi("",!1,Qb));Qb=this.A8(H.a.HJh);Qb[fb.a.oOb]=Va;this.B7.FIa(H.a.HJh,Qb)}EKi(Va,Qb,Vb){if(Va){if(Vb)for(let Sb in Vb)Va[Sb]=
Vb[Sb];this.B7.FIa(H.a.events,Va,Qb)}}UG(Va,Qb,Vb=null){const Sb=this.A8(H.a.events);Sb[fb.a.event]=Va;this.EKi(Sb,Math.round(Qb),Vb)}eqa(Va,Qb,Vb=null){const Sb=this.A8(H.a.events);Sb[fb.a.event]=H.a.error;Sb[fb.a.module]=Va;Sb[fb.a.errorMessage]=Qb;Sb[fb.a.message]=Qb;this.EKi(Sb,Math.round(window.performance.now()),Vb)}w4m(Va){const Qb=this.A8(H.a.FGh);Qb[fb.a.value]=Va;Qb[fb.a.Rce]=this.acb;this.B7.GIa(H.a.FGh,Qb,this.lba)}Q3m(Va){const Qb=this.A8(H.a.xnh);Qb[fb.a.value]=Va;Qb[fb.a.Rce]=this.acb;
this.B7.GIa(H.a.xnh,Qb,this.lba)}q5m(Va){const Qb=this.A8(H.a.R_h);Qb[fb.a.value]=Va;Qb[fb.a.Rce]=this.acb;this.B7.GIa(H.a.R_h,Qb,this.lba)}i7m(Va){const Qb=this.A8(H.a.y5i);Qb[fb.a.value]=Va;Qb[fb.a.Rce]=this.acb;this.B7.GIa(H.a.y5i,Qb,this.lba)}d4m(Va){const Qb=this.A8(H.a.fkj);Qb[fb.a.value]=Va;this.B7.GIa(H.a.fkj,Qb,this.lba)}m7m(Va,Qb){const Vb=this.A8(H.a.a6i);Vb[fb.a.Kic]=Va;Qb&&(Vb[fb.a.rpa]=Qb);this.B7.FIa(H.a.a6i,Vb)}A8(Va){return{["SessionID"]:this.eNa.sessionId,["CorrelationID"]:this.eNa.rpa,
["Time"]:(new Date).getTime(),["Event"]:Va,["Scenario"]:this.lba}}}Object(D.a)(yb,"UsageLogger",null,[1113]);var Yb=c(67),qc=c(1701),Hc=c(1225),$b=c(1556),Ub=c(93),mc=c(28),ic=c(1224),ab=c(633),bb=c(20),Jb=c(758),Eb=c(70),hb=c(13);c.d(I,"TellMeActor",function(){return ob});class ob{constructor(){this.JYa=this.q3=this.Vb=this.Ca=this.lQ=this.Zu=this.Ib=this.ga=this.Oe=this.JK=this.OKe=this.Mmh=this.pma=this.fc=null;this.GYb=!1;this.Dwe=[];this.BPg=[];this.slh=[];this.W7g=[];this.X7g=[];this.R2g=!1;
this.zVb=this.iga=null;this.Dxc=this.VXa=!1;this.Nrd=!0;this.u_=this.Dwc=this.TXg=this.dLe=this.I7g=null;this.AZ=[];this.qab=this.bWb=this.gBa=this.Mud=this.Zgh=null;this.WXb=!1;this.XKe=0;this.ZUb=null;this.Tta=-1;this.j7g=0;this.Lxc=!1;this.Vab=null;this.nlh=!1;this.aVb=this.rp=null}get eKd(){return this.lQ?this.lQ.contentType:ob.unknown}get actions(){return this.AZ}set actions(Va){this.AZ=Va}SUd(){return this.Oe?this.Oe.Xqa.rpa:null}cP(){return this.fc}get uen(){return this.Nrd}get c4o(){return this.I7g}performance(){return this.JK}get Vhg(){return this.Zgh}set Vhg(Va){this.Zgh=
Va}get ged(){return this.nlh}set ged(Va){this.nlh=Va}jH(Va){const Qb=window.performance.now();this.iga&&!Y.c(Va)&&(this.iga(Va),this.Oe.QA(H.a.jH,window.performance.now()-Qb))}initialize(Va,Qb=null,Vb=null,Sb=null,nb=null,ac=null,zc=null,Ib=null,ya=null,ib=null,wb=null){const {InteractionLogger:bc}=c(1995),{GroupsPlacementInfo:lc}=c(1991),{AggregatorResultsProvider:Kb}=c(1785);this.fc=Va;this.VXa=!!L.AFrameworkApplication.ua&&L.AFrameworkApplication.ua.Kb.Tdc;this.Oe=Sb;if(!Sb){Sb=new v;Sb.sessionId=
L.AFrameworkApplication.userSessionId;const Bc=Jb.a.tg(L.AFrameworkApplication.lcid)||Jb.a.GVc;this.Oe=new bc(new yb(this.fc.application,Bc.name,Sb,this.fc.Ir,this.VXa,Va.iVa,null),this.fc.Q6k,this.fc)}this.JYa=new N(this.fc.parameterData);this.Mmh=Vb||new Ja(this.fc,this.JYa);this.iga=zc;this.OKe=this.OKe||new ua(this.fc,this.fc.parameterData,zc);this.Vb=Yb.FocusManager.instance();this.q3=S.createInstance(this.fc);this.TXg=new lc(Va);this.ga=nb||L.AFrameworkApplication.va;this.Ib=ac||L.AFrameworkApplication.lc;
this.Zu=ya;this.pma=Qb;this.rp=wb;this.JK=new Pa;this.aVb=new l.a(e.a.ih());this.Mud=[];ya?ya.execute(Bc=>{Bc.isFeatureEnabled(ob.XIo,!0).then(Xc=>{const {AggregatorResultsProvider:vd}=c(1785);this.Lxc=Xc;this.pma=this.pma||vd.createInstance(this.q3,this.fc,this.JYa,this.Lxc);for(const vc of this.Mud)this.pma.WE(vc.provider,vc.g9a);this.Mud=[];return null})}):(this.Lxc=!0,this.pma=this.pma||Kb.createInstance(this.q3,this.fc,this.JYa,this.Lxc));this.Ca=Ib;this.gBa=Ja.CMd;this.I7g=new Promise(Bc=>{this.dLe=
Bc});ib&&ib.execute(Bc=>{this.lQ=Bc})}Tb(){this.Lvk()}EWn(Va){this.Dwc=Va}Lvk(){this.ga.fb(hb.a.tellMe,Eb.a.frame,Object(a.a)(this,this.tellMe,"tellMe"),96);this.ga.fb(hb.a.Ilg,Eb.a.frame,Object(a.a)(this,this.iAh,"cacheAsyncMenuRefreshFunction"),96);this.ga.fb(hb.a.Nlg,Eb.a.frame,Object(a.a)(this,this.VKi,"logItemExecuted"),96);this.ga.fb(hb.a.Qlg,Eb.a.frame,Object(a.a)(this,this.xKi,"logControlDeactivation"),96);this.ga.fb(hb.a.Plg,Eb.a.frame,Object(a.a)(this,this.RKi,"logInputFocus"),96);this.ga.fb(hb.a.Llg,
Eb.a.frame,Object(a.a)(this,this.Z3a,"interactionBegin"),96);this.ga.fb(hb.a.Slg,Eb.a.frame,Object(a.a)(this,this.Z3a,"interactionBegin"),96);this.ga.fb(hb.a.Olg,Eb.a.frame,Object(a.a)(this,this.QKi,"logInputBlur"),96);this.ga.fb(hb.a.Rlg,Eb.a.frame,Object(a.a)(this,this.wKi,"logControlActivated"),96);this.ga.fb(hb.a.Hbd,Eb.a.frame,Object(a.a)(this,this.X1h,"focusSearchBox"),96);this.ga.fb(hb.a.Hlg,Eb.a.frame,Object(a.a)(this,this.CIh,"constructLiveNotificationForMenu"),96);this.ga.fb(hb.a.Tlg,Eb.a.frame,
Object(a.a)(this,this.FCf,"insertTryQuery"),96);this.ga.fb(hb.a.VKf,Eb.a.frame,Object(a.a)(this,this.FCf,"insertTryQuery"),96);this.ga.fb(hb.a.Fkf,Eb.a.frame,Object(a.a)(this,this.XSa,"openOrInsertUrl"),96);this.ga.fb(hb.a.Gkf,Eb.a.frame,Object(a.a)(this,this.XSa,"openOrInsertUrl"),96);this.ga.fb(hb.a.Hkf,Eb.a.frame,Object(a.a)(this,this.XSa,"openOrInsertUrl"),96);this.ga.fb(hb.a.Ikf,Eb.a.frame,Object(a.a)(this,this.XSa,"openOrInsertUrl"),96);this.ga.fb(hb.a.Jkf,Eb.a.frame,Object(a.a)(this,this.XSa,
"openOrInsertUrl"),96);this.ga.fb(hb.a.uZf,Eb.a.frame,Object(a.a)(this,this.XSa,"openOrInsertUrl"),96);this.ga.fb(hb.a.vZf,Eb.a.frame,Object(a.a)(this,this.XSa,"openOrInsertUrl"),96);this.ga.fb(hb.a.wZf,Eb.a.frame,Object(a.a)(this,this.XSa,"openOrInsertUrl"),96);this.ga.fb(hb.a.B0f,Eb.a.frame,Object(a.a)(this,this.U3a,"insertMention"),96);this.ga.fb(hb.a.C0f,Eb.a.frame,Object(a.a)(this,this.U3a,"insertMention"),96);this.ga.fb(hb.a.D0f,Eb.a.frame,Object(a.a)(this,this.U3a,"insertMention"),96);this.ga.fb(hb.a.Klg,
Eb.a.frame,Object(a.a)(this,this.QZi,"openFeedback"),96);this.ga.fb(hb.a.Ulg,Eb.a.frame,Object(a.a)(this,this.XSa,"openOrInsertUrl"),96);this.ga.fb(hb.a.P0e,Eb.a.frame,Object(a.a)(this,this.m2d,"launchAddin"),96);this.ga.fb(hb.a.Q0e,Eb.a.frame,Object(a.a)(this,this.m2d,"launchAddin"),96);this.ga.fb(hb.a.R0e,Eb.a.frame,Object(a.a)(this,this.m2d,"launchAddin"),96);this.ga.fb(hb.a.mRb,Eb.a.frame,Object(a.a)(this,this.mRb,"showTellMeCoachmark"),96);this.ga.fb(hb.a.pKf,Eb.a.frame,Object(a.a)(this,this.tGi,
"launchAddinStore"),96);this.ga.fb(hb.a.o5f,Eb.a.frame,Object(a.a)(this,this.A6i,"quickActionOnFileHandler"),96);this.ga.fb(hb.a.znf,Eb.a.frame,Object(a.a)(this,this.r4h,"generateSlidesFromFiles"),96)}CUn(Va){this.Nrd=!1;const Qb=window.performance.now();Va.s5a.isCompleted?(this.Nrd=!0,this.dLe(!0)):Va.D_(()=>{this.Nrd=!0;this.dLe(!0);this.Oe.QA(H.a.Kll,window.performance.now()-Qb)});this.oVn(Va)}oVn(Va){ab.a.gde(Object(a.a)(this,this.ALd,"dispatcher"));ab.a.nNc([new ic.a(hb.a.tellMe,Eb.a.frame,96),
new ic.a(hb.a.Ilg,Eb.a.frame,96),new ic.a(hb.a.Nlg,Eb.a.frame,96),new ic.a(hb.a.Qlg,Eb.a.frame,96),new ic.a(hb.a.Plg,Eb.a.frame,96),new ic.a(hb.a.Llg,Eb.a.frame,96),new ic.a(hb.a.Slg,Eb.a.frame,96),new ic.a(hb.a.Olg,Eb.a.frame,96),new ic.a(hb.a.Rlg,Eb.a.frame,96),new ic.a(hb.a.Hbd,Eb.a.frame,96),new ic.a(hb.a.Hlg,Eb.a.frame,96),new ic.a(hb.a.Tlg,Eb.a.frame,96),new ic.a(hb.a.VKf,Eb.a.frame,96),new ic.a(hb.a.Fkf,Eb.a.frame,96),new ic.a(hb.a.Gkf,Eb.a.frame,96),new ic.a(hb.a.Hkf,Eb.a.frame,96),new ic.a(hb.a.Ikf,
Eb.a.frame,96),new ic.a(hb.a.Jkf,Eb.a.frame,96),new ic.a(hb.a.uZf,Eb.a.frame,96),new ic.a(hb.a.vZf,Eb.a.frame,96),new ic.a(hb.a.wZf,Eb.a.frame,96),new ic.a(hb.a.B0f,Eb.a.frame,96),new ic.a(hb.a.C0f,Eb.a.frame,96),new ic.a(hb.a.D0f,Eb.a.frame,96),new ic.a(hb.a.Klg,Eb.a.frame,96),new ic.a(hb.a.Ulg,Eb.a.frame,96),new ic.a(hb.a.P0e,Eb.a.frame,96),new ic.a(hb.a.Q0e,Eb.a.frame,96),new ic.a(hb.a.R0e,Eb.a.frame,96),new ic.a(hb.a.mRb,Eb.a.frame,96),new ic.a(hb.a.pKf,Eb.a.frame,96),new ic.a(hb.a.o5f,Eb.a.frame,
96),new ic.a(hb.a.znf,Eb.a.frame,96)],Va)}ALd(Va,Qb,Vb,Sb,nb){if(Qb.contextId===Eb.a.frame)switch(Va){case hb.a.tellMe:return this.tellMe(Va,Qb,Vb,Sb,nb);case hb.a.Ilg:return this.iAh(Va,Qb,Vb,Sb,nb);case hb.a.Nlg:return this.VKi(Va,Qb,Vb,Sb,nb);case hb.a.Qlg:return this.xKi(Va,Qb,Vb,Sb,nb);case hb.a.Plg:return this.RKi(Va,Qb,Vb,Sb,nb);case hb.a.Llg:return this.Z3a(Va,Qb,Vb,Sb,nb);case hb.a.Slg:return this.U7n(Vb);case hb.a.Olg:return this.QKi(Va,Qb,Vb,Sb,nb);case hb.a.Rlg:return this.wKi(Va,Qb,Vb,
Sb,nb);case hb.a.Hbd:return this.X1h(Va,Qb,Vb,Sb,nb);case hb.a.Hlg:return this.CIh(Va,Qb,Vb,Sb,nb);case hb.a.Tlg:case hb.a.VKf:return this.FCf(Va,Qb,Vb,Sb,nb);case hb.a.Fkf:case hb.a.Gkf:case hb.a.Hkf:case hb.a.Ikf:case hb.a.Jkf:case hb.a.uZf:case hb.a.vZf:case hb.a.wZf:case hb.a.Ulg:return this.XSa(Va,Qb,Vb,Sb,nb);case hb.a.B0f:case hb.a.C0f:case hb.a.D0f:return this.U3a(Va,Qb,Vb,Sb,nb);case hb.a.Klg:return this.QZi(Va,Qb,Vb,Sb,nb);case hb.a.P0e:case hb.a.Q0e:case hb.a.R0e:return this.m2d(Va,Qb,
Vb,Sb,nb);case hb.a.mRb:return this.mRb(Va,Qb,Vb,Sb,nb);case hb.a.pKf:return this.tGi(Va,Qb,Vb,Sb,nb);case hb.a.o5f:return this.A6i(Va,Qb,Vb,Sb,nb);case hb.a.znf:return this.r4h(Va,Qb,Vb,Sb,nb)}return 2}X1h(Va,Qb,Vb){if(1===Vb)return 32;this.Rnj();Va=!1;(this.fc.iVa||this.VXa)&&(Qb=document.getElementById("SearchButton"))&&Qb.click();if(!this.fc.iVa&&this.VXa)for(Qb=document.getElementsByClassName("ms-suiteux-search-box"),Vb=0;Vb<Qb.length;Vb++){const Sb=Qb[Vb].querySelector("input[type=search]");
Sb&&(Va=Yb.FocusManager.iK(Sb))}else Va=Yb.FocusManager.iK($get(this.fc.Ir?m.CuiHelper.eig:m.CuiHelper.Lle));this.Dxc=!0;return Va?32:8}FCf(Va,Qb,Vb,Sb,nb){if(1===Vb)return 32;if(Y.c(nb))return this.Oe.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.Rnj();Va=nb.CommandValueId;Qb=this.fc.Ir?m.CuiHelper.eig:m.CuiHelper.Lle;this.fc.Ir&&!Y.c(nb[Hc.a.DUa])&&(nb[Hc.a.DUa]=!1);if(Va){if(this.fc.Ir)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(Va)),this.Vab=
[19],32;if(nb=$get(Qb))nb.value=Va}return Yb.FocusManager.iK($get(Qb))?32:8}Rnj(){this.Vb.EL(this.fc.iVa||this.VXa?this.fc.QHb:this.fc.x7a,!1)}hMl(Va,Qb){switch(Va){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,Qb);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,Qb);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,Qb);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,
Qb)}return Qb}CIh(Va,Qb,Vb,Sb,nb){if(1===Vb)return 32;if(Y.c(nb))return this.Oe.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;Va=this.gBa?this.gBa.bfj:0;nb.Value=1!==Va?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,Va):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.gBa)for(const ac of this.gBa.jql)nb=Object(k.a)(V.a,ac)?ac.id:Fa.a.replaceAll(ac.value,'"',""),(nb=$get(nb+"-"+K.a.Jlg))&&mc.a.lr(nb,mc.a.xga,Fa.a.zf(this.hMl(ac.groupType,
nb.innerText)));return 32}iAh(Va,Qb,Vb,Sb,nb){if(1===Vb)return 32;if(Y.c(nb))return this.Oe.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.ZUb=new Ub.a(2,1,0,()=>{nb[qc.a.Callback]()},97);this.gBa&&this.Ib.Wb(this.ZUb);return 32}VKi(Va,Qb,Vb,Sb,nb){if(1===Vb)return 32;if(Y.c(nb))return this.Oe.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;nb.CloseAllMenus&&(Va=void 0===nb.ParentControlId||null===nb.ParentControlId?"<NA>":nb.ParentControlId,
Qb=this.zVb?this.zVb[nb.ControlId]:null,!Qb&&this.zVb&&"<NA>"!==Va&&(Qb=this.zVb[Va]),Qb||(Qb=this.GYb&&this.q3.vKm(nb),Qb=this.fnl(Qb,nb.ControlId),Qb=new t(Qb,32,4,-1,-1,-1),this.Oe.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+nb.ControlId+" determined group:"+O.a[Qb.groupType])),this.Oe.Bmn(nb.ControlId,Va,nb.CommandId,nb.CloseAllMenus,Qb),this.JYa.Hin(nb.ControlId),nb.Location!==ia.a.contextMenu&&(this.q3.t_a(nb),this.q3.WE(Qb.resultType),this.fc.Die&&this.pma.Atk(nb.CommandId)));
return 32}xKi(Va,Qb,Vb,Sb,nb){if(1===Vb)return 32;(new va(this.SUd())).Xam(this.bWb);Va=this.bWb;Qb=this.Tta;Vb=this.Oe.xjd;if(Y.c(nb))return this.Oe.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;nb=nb.UILocation;Va&&0<Va.length&&this.Lxc&&K.a.$fg(this.fc)&&this.fc.i1d&&19!==nb&&Qb>Vb&&!this.fc.XP&&(this.Oe.CNf(Va),this.Oe.kdg(Qb));this.Oe.G6n();this.fc.Zoe&&19!==nb&&(this.JK.mark(3),this.JK.measure(1,0,3),this.JK.measure(2,2,3),this.JK.rNf(0,1,2),this.JK.rNf(2,2,3),this.JK.rNf(1,
0,3),this.JK.QYk(),this.JK.clearMeasures([0,2,1]));this.Oe.hnn(window.performance.now()-this.XKe);this.fc.Ir&&(this.qab=null,this.Oe.yya());this.Dxc=this.WXb=!1;this.bWb="";return 32}RKi(Va,Qb,Vb){if(1===Vb)return 32;this.Oe.Knb(z(Qb),this.Dxc);return 32}QKi(Va,Qb,Vb){if(1===Vb)return 32;this.Oe.yya();this.WXb=!1;return 32}wKi(Va,Qb,Vb,Sb,nb){if(1===Vb)return 32;this.u_=null;nb&&(this.u_=nb);this.fc.Zoe&&(Y.c(this.u_)||this.u_.Location!==ia.a.contextMenu)&&this.JK.mark(0);this.Oe.Che(Y.c(this.u_)||
Y.c(this.u_.Location)?ia.a.unknown:this.u_.Location);this.Oe.gnn(this.j7g,this.Dxc);this.WXb||this.h6a();return 32}gMh(Va,Qb){const Vb=[],Sb=Date.now();for(let nb of Va)Va=(Sb-nb.timeStamp)/1E3,Va=K.a.ene(Va),Array.add(Vb,new Q(Qb?nb.commandId:nb.controlId,Va));return Vb}qgl(Va){const Qb=[],Vb=Date.now();for(let Sb of Va)if(Sb.controlId||"keyboardShortcut"===Sb.commandSurface)Va=(Vb-Sb.timeStamp)/1E3,Va=K.a.ene(Va),Array.add(Qb,new Z(Sb.controlId,Sb.commandId,Va,Sb.commandSurface,Sb.Ple));return Qb}SMh(Va=
!1){var Qb=Va?this.q3.Ram():this.q3.dQc();Va=[];const Vb=Date.now();for(const Sb of Qb)Qb=(Vb-Sb.TimeStamp)/1E3,Qb=K.a.ene(Qb),Array.add(Va,new Q(Sb.Id,Qb));return Va}h6a(){if(!this.WXb){this.GYb=this.WXb=!0;""!==this.fc.Bbg&&L.AFrameworkApplication.ho(this.fc.Bbg);if(!this.R2g){this.R2g=!0;const Va={};Va.IsMLREnabled=this.fc.EQm;Va.IsReactRibbonEnabled=this.fc.Ir;Va.IsSharedHeaderEnabled=!!L.AFrameworkApplication.ua&&L.AFrameworkApplication.ua.Kb.MJ;Va.IsSearchUxEnabled=this.VXa;Va.IsTellMeInHeaderEnabled=
this.fc.iVa;Va.IsGoLocalEnv=K.a.ONm();Va.IsSovereignEnvironment=K.a.Ydc();Va.IsTellMeServiceResultsEnabled=K.a.$fg(this.fc);Va.IsSubstrateProviderEnabled=K.a.Zfg(this.fc);Va.ShouldFetchTokens=!!L.AFrameworkApplication.ua&&L.AFrameworkApplication.ua.Kb.VQb;Va.IsSerpletEnabled=K.a.Lpa();Va.FirstOnClickTimeInMS=Math.round(window.performance.now());Va.IsHeaderHidden=L.AFrameworkApplication.hideHeader||L.AFrameworkApplication.nY;Va.IsSearchInHeaderHidden=L.AFrameworkApplication.ATc;void 0!==window.performance.timing&&
null!==window.performance.timing&&(Va.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));Va.IsFindWithMatchesEnabled=this.fc.BOd;Va.HelpShowsTopSearchResult=this.fc.A$c;Va.HelpShowsNumberOfMatches=this.fc.z$c;L.AFrameworkApplication.K&&(Va.UiHost=L.AFrameworkApplication.K.kb("UiHostIntegrationType"));this.Oe.E7m(JSON.stringify(Va))}this.Dwe=this.gMh(y.a.instance.VPc(),!1);this.BPg=this.gMh(y.a.instance.Dib(),!0);this.slh=this.qgl(y.a.instance.Dib());this.W7g=this.SMh();
this.X7g=this.SMh(!0);this.Oe.h6a()}}Z3a(Va,Qb,Vb,Sb,nb){if(1===Vb)return 32;if(Y.c(nb))return this.Oe.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(bb.a.$Wc)return 32;this.XKe=window.performance.now();this.h6a();Va=new ba(Object(a.a)(this,this.Eya,"onRequestCompleted"),0);this.Tta++;this.Oe.beginQuery("",this.Tta,this.GYb);this.zpg(!0,null);this.gBa=Ja.CMd;this.qab=ua.$hf;if(this.pma)ob.instance.actions=[],this.pma.dI(new W("",this.Tta),Va,this.fc.Ir);else this.Oe.onError("TellMeActor:ExecuteTellMeQuery",
"Aggregator provider not resolved yet");this.ZUb&&this.Ib.Wb(this.ZUb);return 32}U7n(Va){if(1===Va)return 32;this.Vb.gS(this.fc.iVa||this.VXa?this.fc.QHb:this.fc.x7a,!1);return 32}tellMe(Va,Qb,Vb,Sb,nb){if(1===Vb)return 32;if(Y.c(nb))return this.Oe.onError("TellMeActor:TellMe","actiondata comes null"),16;this.u_=nb;this.Oe.Che(Y.c(this.u_.Location)?ia.a.unknown:this.u_.Location);Va=this.u_.Value;this.fc.Ir||Va&&""!==Va.trim()?(!this.qab&&this.fc.Ir&&(this.Oe.Knb(z(Qb),this.Dxc),this.h6a()),this.uzl(Va,
this.u_.Location),this.u_.PopulationXML=this.gBa.xml):this.GYb?this.u_.PopulationXML=this.gBa.xml:(this.u_.PopulationXML=Ja.CMd.xml,this.qab=ua.$hf,this.bWb="");return 32}uzl(Va,Qb){this.XKe=window.performance.now();this.fc.Zoe&&Qb!==ia.a.contextMenu&&this.JK.mark(1);this.fc.Ir&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(Va));Va&&0<Va.trim().length&&(this.GYb=!1);this.fc.Txl();Qb=Y.c(Qb)?ia.a.tellMe:Qb;if(Va!==this.bWb||this.fc.Ir){this.Tta++;this.Oe.beginQuery(Va,this.Tta,this.GYb);
this.zpg(!0,null);const Vb=new W(Va,this.Tta),Sb=new ba(Object(a.a)(this,this.Eya,"onRequestCompleted"),this.Tta);this.gBa=Ja.CMd;this.qab=ua.$hf;if(this.pma)ob.instance.actions=[],this.pma.dI(Vb,Sb,this.fc.Ir,Qb,this.Vab),this.Vab=null;else this.Oe.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.j7g=this.Tta;this.bWb=Va}}uXo(Va){if(this.fc.Ir){var Qb=appChrome.selectors.getActiveControlStates();if(Qb=Object(x.a)(Object,Qb[Va.value])){Va.label=Qb.label;let Vb=
null;"description"in Qb&&(Vb=Qb.description);Vb&&Object.getType(Vb)===String?Va.description=Vb:"secondaryText"in Qb?Va.description=Qb.secondaryText:"fullDescriptionLabel"in Qb&&(Va.description=Qb.fullDescriptionLabel)}}}sEn(Va){this.zVb={};let Qb=0,Vb=0;for(const Sb of Va){Va=0;for(const nb of Sb.results)this.zVb[nb.value]=new t(nb.groupType,nb.type,nb.Wwj,Qb,Va,Vb),Va++,Vb++,nb.label||5!==nb.type||this.uXo(nb);0<Va&&Qb++}}rhc(Va,Qb,Vb,Sb,nb){if(1===Vb)return 32;if(Y.c(nb))return this.Oe.onError("TellMeActor:OpenUrlInNewTab",
"actiondata comes null"),16;(Va=nb.CommandValueId)&&window.open(Va,"_blank");return 32}HGi(Va){const Qb={};Qb.token=this.Vhg;Qb.files=ta.c(Va);Qb.type="MultiFilesDeckGeneration";if(L.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFastCards",!1))return this.ga.Qb(hb.a.L_m,2,Qb),!0;Va=K.a.Chi("",K.a.dfj("GenerateDeckFromFile"),Object.assign(new $b.a,{landingTab:"All",data:Qb}));Va=this.ga.Qb(hb.a.q9,2,Va);return 32!==Va?(this.Oe.onError("LaunchSmartLookupWithFilesData",
"CommonCommands.InvokeSerplet failed. Response: "+Va+"."),!1):!0}A6i(Va,Qb,Vb,Sb,nb){if(1===Vb)return 32;if(Y.c(nb))return this.Oe.onError("TellMeActor:QuickActionOnFileHandler","actiondata comes null"),16;this.Vb.$lf();if(Va=nb.TerminalParentControlId){Va=this.aVb.J(Va);if(!Va)return 16;Qb=[];Array.add(Qb,Va);if(!this.HGi(Qb))return 8}return 32}r4h(){if(!this.aVb.count)return 16;const Va=[];for(let Qb of this.aVb.values)Array.add(Va,Qb);return this.HGi(Va)?32:8}U3a(Va,Qb,Vb,Sb,nb){if(1===Vb)return 32;
if(Y.c(nb))return this.Oe.onError("TellMeActor:InsertMention","actiondata comes null"),16;Va=nb.UILocation;let ac;nb=nb.CommandValueId;try{ac=ta.a(nb)}catch(zc){return this.Oe.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),16}return Y.c(ac)?(this.Oe.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):Y.c(this.Dwc)?(this.Oe.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==Va?(this.Oe.onError("TellMeActor:InsertMention",
"location "+Va+" is unexpected"),16):this.Dwc.U3a(ac.displayName,ac.email,ac.userId)?32:(this.Oe.onError("TellMeActor:InsertMention","mention is not inserted"),16)}XSa(Va,Qb,Vb,Sb,nb){return 1===Vb?32:Y.c(nb)?(this.Oe.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===nb.UILocation?this.lFm(Vb,nb):this.rhc(Va,Qb,Vb,Sb,nb)}QZi(Va,Qb,Vb,Sb,nb){if(1===Vb)return 32;if(Y.c(nb))return this.Oe.onError("TellMeActor:OpenFeedback","actiondata comes null"),16;this.rp&&window.setTimeout(()=>
{this.rp.execute(ac=>{ac.$Ia("TellMeSurvey",null)})},ob.EBl);return 32}lFm(Va,Qb){if(1===Va)return 32;if(Y.c(Qb))return this.Oe.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(Y.c(this.Dwc))return this.Oe.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),16;Va=Qb.CommandValueId;return Y.c(Va)?(this.Oe.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.Dwc.insertHtmlText(Va)?32:(this.Oe.onError("TellMeActor:InsertUrl","url is not inserted"),16)}Eya(Va,
Qb,Vb,Sb,nb){Vb=window.performance.now();this.sEn(Qb);this.Oe.uko(Qb);this.fc.Ir?(this.qab=this.OKe.BLl(Qb,Va,nb),this.fc.bxa?(this.AZ.push(appChrome.actions.updateTellMeSearchResults(this.qab.menuModel,Va,nb)),appChrome.api.dispatch(this.AZ)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.qab.menuModel,Va,nb)),this.fc.Zoe&&this.WXb&&(Y.c(this.u_)||this.u_.Location!==ia.a.contextMenu)&&(this.JK.mark(2),this.JK.measure(0,1,2))):this.gBa=this.Mmh.CLl(Qb,this.Oe.Xqa);this.ZUb&&
this.Ib.Wb(this.ZUb);nb={};nb.GroupsCount=Qb.length;nb.QueryID=Sb;nb.QueryLength=Va.length;this.Oe.QA(H.a.gel,window.performance.now()-Vb,nb)}fnl(Va,Qb){return Qb.startsWith(this.fc.Ir?K.a.oog:K.a.une)?5:Va?4:"bSearchHelp"===Qb||Qb.startsWith("GetHelpFromTellMe")?8:"bInsights"===Qb||Qb.startsWith("SmartLookupFromTellMe")?13:"ActionAIFromTellMe"===Qb?24:Qb===this.fc.Wkf?2:0}WE(Va,Qb){this.pma?this.pma.WE(Va,Qb):Array.add(this.Mud,new F(Va,Qb))}tGi(Va,Qb,Vb,Sb,nb){if(1===Vb)return 32;if(Y.c(nb))return this.Oe.onError("TellMeActor:LaunchAddinStore",
"actiondata comes null"),16;if(this.Ca.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",!1)){Va={};Va.SourceControlId=nb.SourceControlId;Va.Query=nb.CommandValueId;nb=this.ga.Qb(hb.a.BZc,2,Va);if(32!==nb)this.Oe.onError("TellMeActor:LaunchAddinStore","CommonCommands.LaunchAppforOfficeDialog failed. Response: "+nb+".");return nb}return this.ga.Qb(hb.a.BZc,2,nb)}m2d(Va,Qb,Vb,Sb,nb){({AddinResultsProvider:Va}=c(1673));if(1===Vb)return 32;if(Y.c(nb))return this.Oe.onError("TellMeActor:LaunchAddin",
"actiondata comes null"),16;Vb=nb.CommandValueId;if(Y.b(Vb))return this.Oe.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!Va.bBb[Vb])return this.Oe.onError("TellMeActor:LaunchAddin","Add-in with assetId "+Vb+" doesn't not exist in entitlements"),16;nb=c(1673).AddinResultsProvider.bBb[Vb];Va={};Va.solutionId=nb.id;Va.version=nb.appVersion;Va.storeType=nb.storeType;Va.storeId=nb.storeId;Va.assetId=nb.assetId;Va.assetStoreId=nb.assetStoreId;Va.displayName=nb.displayName;Va.targetType=
nb.targetType;Va.height=nb.height;Va.width=nb.width;nb=this.ga.Qb(hb.a.rCf,2,Va);if(32!==nb)this.Oe.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+nb+". AssetId: "+Vb);return nb}mRb(){if(!Y.c(this.rp))for(let Va of y.a.instance.Dib()){if("ShowContextMenuWithFloatie"===Va.commandId)return this.rp.execute(Qb=>{Qb.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if(Va.commandId&&-1===Va.commandId.indexOf("Tab"))break}return 8}zpg(Va,Qb="",Vb=null){Va?
this.aVb=new l.a(e.a.ih()):Qb&&Vb&&this.aVb.add(Qb,Vb)}static get instance(){return ob._instance||(ob._instance=new ob)}}ob._instance=null;ob.XIo="mso_tellMeService";ob.unknown="Unknown";ob.EBl=500;Object(D.a)(ob,"TellMeActor",null,[])},1521:function(D,I,c){c.d(I,"a",function(){return e});D=c(0);var l=c(1535);class e{constructor(a,k){this.bcb=!1;const {Annotations:x}=c(1515);if(!a)throw Error.argumentNull("annotations");if(!a.$If(k))throw Error.argument("memberTypeID","Invalid type ID");if(x.tI(k))throw Error.argument("memberTypeID",
"Lists of lists are not permitted");this.zw=a;this.ibk=k;this.pp=[]}get d3b(){return this.zw}get isReadOnly(){return this.bcb}get g5(){return this.ibk}get items(){return this.pp}Mea(){const {Annotations:a}=c(1515);let k="[";for(let x=0,y=this.items.length;x<y;++x){0<x&&(k+=", ");const m=this.zw.Mea(this.g5,this.items[x]);this.g5===a.caa?(k+='"',k+=l.a.pjf(m),k+='"'):k+=m}return k+"]"}isEqual(a){const {Annotations:k}=c(1515);if(this===a)return!0;if(!a||a.d3b!==this.zw||a.g5!==this.g5||a.items.length!==
this.items.length)return!1;for(let x=0;x<this.items.length;++x)if(!k.fsb(this.g5,this.items[x],a.items[x]))return!1;return!0}clone(){const a=new e(this.zw,this.g5);Array.addRange(a.items,this.items);return a}YT(){return this.isReadOnly?this.clone():this}RMf(){const {Annotations:a}=c(1515);if(!this.isReadOnly){this.bcb=!0;for(const k of this.items)a.fLb(k)}}toString(){return this.Mea()}}Object(D.a)(e,"ListValue",null,[1240,1239])},1522:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}
l.tellMe="TellMe";l.contextMenu="ContextMenu";l.unknown="Unknown";Object(D.a)(l,"TellMeScenario",null,[])},1524:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e,a,k=null,x=null,y=4,m=-99999,t=0){this.cJ="";this.JCd=-1;this.value=e;this.type=a;this.Wwj=y;this.label=this.hD=k;this.groupType=30;this.description=x;this.score=m;this.count=t}}Object(D.a)(l,"ResultBinding",null,[])},1526:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e){this.attributes=
null;this.query=e;this.vo=[]}dv(e){this.vo.push(e)}Yaj(e){const a=[];for(const k of this.vo)k.groupType!==e&&a.push(k);this.vo.length!==a.length&&(this.vo=a)}get Ddc(){return!1}}Object(D.a)(l,"SimpleResultsUpdatedEventArgs",null,[1082])},1527:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e=30,a=""){this.lM=[];this.groupType=e;this.displayName=a}get results(){return this.lM}Uw(e){e.groupType=this.groupType;Array.add(this.results,e)}r8f(e=1){if(this.results.length>=e)for(let a=
0;a<e;a++)Array.removeAt(this.results,this.results.length-1)}}Object(D.a)(l,"SimpleResultGroup",null,[1083])},1535:function(D,I,c){D=c(0);class l{constructor(a,k){this.lfb=a;this.value=k}}Object(D.a)(l,"AttrValuePair",null,[]);c.d(I,"a",function(){return e});class e{constructor(a){this.bcb=!1;if(!a)throw Error.argumentNull("annotations");this.zw=a;this.MY=[]}get d3b(){return this.zw}get isReadOnly(){return this.bcb}get Gyf(){return 0<this.MY.length}Mq(a){if(!this.zw.kec(a))throw Error.argument("attributeID",
"Invalid attribute ID");for(const k of this.MY)if(a===k.lfb)return a=k.value,{returnValue:!0,value:a};return{returnValue:!1,value:null}}$y(a,k){var {Annotations:x}=c(1515);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.zw.kec(a))throw Error.argument("attributeID","Invalid attribute ID");if(!this.zw.jdc(this.zw.getAttributeType(a),k))throw Error.argument("value","Value is not of the correct type for the specified attribute");x.fLb(k);
for(x=0;x<this.MY.length;++x){const y=this.MY[x];if(a===y.lfb){y.value=k;return}}Array.add(this.MY,new l(a,k))}KTa(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.zw.kec(a))throw Error.argument("attributeID","Invalid attribute ID");for(let k=0;k<this.MY.length;++k)if(a===this.MY[k].lfb){Array.removeAt(this.MY,k);break}}wPd(a){if(!a)throw Error.argumentNull("action");for(const k of this.MY)a(k.lfb,k.value)}clone(){const a=new e(this.zw);
a.J0a(this);return a}J0a(a){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!a)throw Error.argumentNull("other");if(a.d3b!==this.zw)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.MY);a.wPd((k,x)=>{this.$y(k,x)})}Mea(){const {Annotations:a}=c(1515);let k="[",x=!0;for(const y of this.MY){x?x=!1:k+=", ";k+=this.zw.A5h(y.lfb);k+="=";const m=this.zw.getAttributeType(y.lfb),t=this.zw.Mea(m,y.value);m===a.caa?(k+=
'"',k+=e.pjf(t),k+='"'):k+=t}return k+"]"}isEqual(a){const {Annotations:k}=c(1515);if(!a)throw Error.argumentNull("other");if(this===a)return!0;if(!a||this.zw!==a.d3b||this.Gyf!==a.Gyf)return!1;let x=0,y=null,m=!1;a.wPd((t,z)=>{++x;if(!m){var v=-1;for(let H=0,F=this.MY.length;H<F;++H)if(this.MY[H].lfb===t){v=H;break}0>v?m=!0:(y||(y=Array(this.MY.length)),y[v]=z)}});if(this.MY.length!==x||m)return!1;for(let t=0,z=this.MY.length;t<z;++t)if(!k.fsb(this.zw.getAttributeType(this.MY[t].lfb),this.MY[t].value,
y[t]))return!1;return!0}YT(){return this.isReadOnly?this.clone():this}RMf(){const {Annotations:a}=c(1515);if(!this.isReadOnly){this.bcb=!0;for(const k of this.MY)a.fLb(k.value)}}toString(){return this.Mea()}static pjf(a){return a.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(D.a)(e,"FeatureBundle",null,[1238,1239])},1540:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}l.click="Click";l.Z3a="InteractionBegin";l.OIb="InteractionEnd";l.HJh="ControlActivated";
l.query="Query";l.a6i="QueryIndexRecorded";l.FGh="Clicks";l.xnh="ActionEvents";l.R_h="FilteredActionEvents";l.fkj="SessionContext";l.latency="Latency";l.performance="Performance";l.Rcj="RenderedResults";l.events="Events";l.gel="CreateResultsMenu";l.jH="UpdateRibbonControls";l.k8n="ResultsAggregation";l.dI="IssueQuery";l.w1k="CommandSuggestions";l.error="Error";l.BMf="LoadModelData";l.Kll="DepsResolveTime";l.ven="ModelDataWaitTime";l.timedOut="TimedOut";l.bAk="AddinQueryCommandReady";l.LMl="GetAddinEntitlements";
l.y5i="ProviderMRUEvents";l.ivl="EnableAddinSearchCommands";Object(D.a)(l,"EventNames",null,[])},1544:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.AOf=null;this.xda=this.COf=0}Wmf(e,a,k){if(!e)throw Error.argumentNull("referenceList");if(0>a||a>e.length)throw Error.argumentOutOfRange("startIndex");if(0>k||k>e.length)throw Error.argumentOutOfRange("length");if(a+k>e.length)throw Error.argument("Invalid start-length range");this.AOf=e;this.COf=a;this.xda=k}yib(e,
a,k){this.Wmf(e.AOf,e.COf+a,k)}J(e){if(0>e||e>=this.xda)throw Error.argumentOutOfRange("index");return this.AOf[this.COf+e]}get count(){return this.xda}static Wbf(e){const a=new l;a.Wmf(e,0,e.length);return a}}Object(D.a)(l,"ReadOnlyList",null,[1259])},1551:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);var l;(function(e){e[e.Classifier=0]="Classifier";e[e.AppsForOffice=1]="AppsForOffice";e[e.FindInDocument=2]="FindInDocument";e[e.FindInDocumentScopedSearch=3]="FindInDocumentScopedSearch";
e[e.RecentlyUsed=4]="RecentlyUsed";e[e.TryQuery=5]="TryQuery";e[e.Empty=6]="Empty";e[e.TryCommand=7]="TryCommand";e[e.Assistance=8]="Assistance";e[e.Answer=9]="Answer";e[e.Definition=10]="Definition";e[e.Entity=11]="Entity";e[e.WolframAnswer=12]="WolframAnswer";e[e.Insights=13]="Insights";e[e.People=14]="People";e[e.Document=15]="Document";e[e.Recommended=16]="Recommended";e[e.ServiceClassifier=17]="ServiceClassifier";e[e.ServiceRecommended=18]="ServiceRecommended";e[e.Image=19]="Image";e[e.Notes=
20]="Notes";e[e.Learning=21]="Learning";e[e.Feedback=22]="Feedback";e[e.Template=23]="Template";e[e.ActionAI=24]="ActionAI";e[e.ActionAICommand=25]="ActionAICommand";e[e.SummarizeDeck=26]="SummarizeDeck";e[e.Addin=27]="Addin";e[e.OfficeScript=28]="OfficeScript";e[e.AddinStoreEntry=29]="AddinStoreEntry";e[e.None=30]="None";e[e.MergedActions=31]="MergedActions";e[e.MergedScopedSearches=32]="MergedScopedSearches";e[e.MergedSuggestedSearches=33]="MergedSuggestedSearches"})(l||(l={}));Object(D.b)("ResultGroupType",
l)},1557:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(1610);class l extends c.a{constructor(){super();this.info=this.yj=this.eventId=null}get tha(){return"Misc"}eGb(){this.detail.Z("Type",this.tha);this.detail.Z("EventId",this.eventId);this.detail.Z("Func",this.yj);this.detail.Z("Info",this.info);return this.detail}}Object(D.a)(l,"BasicMergeFailureDetail",c.a,[])},1558:function(D,I,c){c.d(I,"a",function(){return k});D=c(0);var l=c(611),e=c(816),a=c(1575);class k{constructor(x,y=!0){this.Fm=
y&&x?x.XK():x;this.p1b=new l.a}DC(x){this.p1b.add(e.a.Ab(x))}Roo(x){this.p1b=x}$Oi(x){this.Fm&&(new a.a(this.Fm,x)).Tqa.forEach((y,m)=>{m.AY&&!this.p1b.contains(y)&&(this.p1b.add(y),m.isDeleted?(m=this.Fm,m.hasProperty(e.a.XX(y))&&m.removeProperty(e.a.XX(y))):this.Fm.sUa(e.a.XX(y),m.newValue));return!0})}}Object(D.a)(k,"PartialMergeResult",null,[])},1559:function(D,I,c){c.r(I);c.d(I,"CommandResultsUtility",function(){return z});D=c(0);var l=c(1570),e=c(1540),a=c(1571),k=c(1524),x=c(1527),y=c(1520),
m=c(1519),t=c(2);class z{static rdd(v,H){if(H&&H.Ir){const F={};for(const G of v)H.B1d(G)&&(F[G]=appChrome.selectors.getModelType(G));y.TellMeActor.instance.jH(F)}}static hJo(v){return v.startsWith("btnTellMeOfficeAddIn")}static fWc(v){const H=y.TellMeActor.instance.cP();return!!H&&H.Ir&&!appChrome.selectors.isControlDisabled(v)}static h3d(v,H,F,G){if(y.TellMeActor.instance.Oe&&v){const M=[];for(const K of v)M.push(String.format('{{"Id":"{0}","Score":{1}}}',K.commandId,K.score));v={};v[l.a.suggestions]=
"[{"+M.join(",")+"}]";v[l.a.cFi]=H;v[l.a.groupType]=F;v[l.a.provider]=G;y.TellMeActor.instance.Oe.QA(e.a.w1k,window.performance.now(),v)}}static PTl(v,H){const F=[],G=[];for(const M of H){H=M.commandId;let K=M;M.commandId in v&&(H=v[M.commandId],K=new a.a(H,M.score));Array.contains(G,H)||(F.push(K),G.push(H))}return F}static PRc(v,H,F,G,M,K,L,R){F.Epf&&(H=z.PTl(F.Epf,H));var S=m.a.eSl(H);z.rdd(S,F);var N=[],O=[];S=[];const W=new x.a(L);L=16===L||18===L||7===L||4===L?t.AFrameworkApplication.K?t.AFrameworkApplication.K.mc("TellMeMaxRecommendedResultsToReturn",
3):3:0===L||17===L||25===L?5:0;for(const V of H)if(!z.tKm(V.commandId)){H=z.hJo(V.commandId);if(F.B1d(V.commandId)&&!H){if(m.a.NDi(V.commandId))continue;H=null;M&&K&&(H=M.y9l(V.commandId,K));z.fWc(V.commandId)?Array.add(N,new k.a(V.commandId,5,H,null,R,V.score)):Array.add(O,new k.a(V.commandId,5,H,null,R,V.score))}else F.jBb&&H&&G&&Array.add(S,V.commandId.substr(21));if(N.length+S.length>=L)break}F=0;for(M=0;M<N.length&&F<L;M++,F++)W.Uw(N[M]);for(N=0;N<O.length&&F<L;N++,F++)W.Uw(O[N]);for(O=0;O<S.length&&
F<L;O++,F++)G.Iup(v,S[O],W);return W}static tKm(v){z.wxh||(t.AFrameworkApplication.K&&t.AFrameworkApplication.K.rw("TellMeControlPredictionBlockList")&&t.AFrameworkApplication.K.DB("TellMeControlPredictionBlockList").forEach(H=>{Array.add(z.vxh,H.toLowerCase())}),z.wxh=!0);return Array.contains(z.vxh,v.toLowerCase())}static RDf(v){return 2<v.length&&";"===v.charAt(0)&&";"===v.charAt(v.length-1)&&!!t.AFrameworkApplication.K&&(t.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled")||t.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",
!1))}static r7h(v){const H=new x.a(0);var F=v.split(";");v=y.TellMeActor.instance.cP();for(const G of F)if(0<G.length){F=G.split(":");const M=2===F.length?F[0]:G;if(!v.B1d(M))break;if(1===F.length)F=new k.a(M,5,null,null,1),H.Uw(F);else if(2===F.length)F=new k.a(M,5,F[1],null,1),H.Uw(F);else break}return H}static ctk(v,H,F){if(!(H&&H.results&&v&&v.results&&v.results.length))return{returnValue:!1,SZe:v,J_e:H};const G=[];for(var M of H.results)Array.add(G,M.value);M=0;const K=0<H.results.length?H.results[0].score:
0;for(const L of v.results)if(L.score>F&&!Array.contains(G,L.value)&&z.fWc(L.value)&&(0<K&&(L.score=K),Array.insert(H.results,M,L),M++),2===M)break;return 0<M?(F=H.results.length-5,0<F&&H.r8f(F),{returnValue:!0,SZe:v,J_e:H}):{returnValue:!1,SZe:v,J_e:H}}}z.wxh=!1;z.vxh=[];Object(D.a)(z,"CommandResultsUtility",null,[])},1569:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{static $Ko(e){return e.toString().charCodeAt(0)}static JVm(e){return 55296<=e&&57343>=e}static charAt(e,a){return e.charAt(a)}static Avh(e,
a){if(e===a)return!0;"\u00a0"===e&&(e=" ");"\u00a0"===a&&(a=" ");return e===a}static zvh(e,a){if(e===a)return!0;if(!e||!a||e.length!==a.length)return!1;e=l.adj(e);a=l.adj(a);return e===a}static adj(e){return e.replace(l.i0c," ")}static Rqb(e,a,k){return e.substring(a,a+k)}}l.i0c=RegExp("\u00a0","g");Object(D.a)(l,"CharUtils",null,[])},1570:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}l.appName="AppName";l.e4="CloseAllMenus";l.commandId="CommandId";l.context="Context";l.culture=
"Culture";l.message="Message";l.errorMessage="ErrorMessage";l.event="Event";l.rpa="CorrelationID";l.GAn="ParentUiElement";l.query="Input";l.oOb="QueryID";l.f6i="QueryLength";l.Kic="QueryIndex";l.l8n="ResultsList";l.suggestions="Suggestions";l.scenario="Scenario";l.sessionId="SessionID";l.source="Source";l.timeStamp="Time";l.LDj="UiElement";l.Rce="ReactUx";l.value="Val";l.statusCode="StatusCode";l.service="Service";l.isSuccess="IsSuccess";l.NLo="TokenAcquired";l.r_m="LatencyType";l.groupName="GroupName";
l.i9="GroupIndex";l.groupType="GroupType";l.h8n="ResultInfoList";l.resultType="ResultType";l.Zjg="SubResultType";l.ZOm="IsInputBlur";l.$Om="IsInputFocus";l.UUm="IsShortCutUsed";l.actionType="ActionType";l.count="Count";l.wtl="DwellTime";l.cFi="IsZeroTerm";l.m8o="WordsCount";l.K0d="IsSearchUxEnabled";l.iWm="IsTellMeInHeaderEnabled";l.module="Module";l.resultIndex="ResultIndex";l.fgf="DisplayIndex";l.svl="EnableList";l.provider="Provider";l.contentType="ContentType";l.sUm="IsSelectionBased";l.oKk="BeginPerformanceMarker";
l.Tvl="EndPerformanceMarker";l.ICn="PerformanceMeasure";Object(D.a)(l,"Columns",null,[])},1571:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e,a){this.commandId=e;this.score=a}}Object(D.a)(l,"CommandSuggestion",null,[])},1575:function(D,I,c){D=c(0);var l=c(367),e=c(816),a=c(249),k=c(54);class x{constructor(m,t,z){this.hgk=m;this.Bck=t;this.Ubk=z;this.SFe=new a.a(Object(k.a)(this,this.kWk,"checkIfDifferent"))}get Lob(){return this.hgk}get oldValue(){return this.Bck}get newValue(){return this.Ubk}get Skb(){return!(void 0===
this.newValue||null===this.newValue)&&(void 0===this.oldValue||null===this.oldValue)}get isDeleted(){return(void 0===this.newValue||null===this.newValue)&&!(void 0===this.oldValue||null===this.oldValue)}get AY(){return this.Skb||this.isDeleted||this.SFe.value}kWk(){return this.Skb||this.isDeleted?!0:!e.a.Gvh(this.Lob,this.oldValue,this.newValue)}}Object(D.a)(x,"PropertyDiff",null,[]);c.d(I,"a",function(){return y});class y{constructor(m,t){this.yck=m;this.Rbk=t;this.SFe=new a.a(()=>this.qWc());this.jgk=
new a.a(Object(k.a)(this,this.Eyl,"evaluatePropertyDiffs"))}get tu(){return this.yck}get xf(){return this.Rbk}get Skb(){return!!this.xf&&!this.tu}get isDeleted(){return!this.xf&&!!this.tu}get AY(){return this.Skb||this.isDeleted||this.SFe.value}get Tqa(){return this.jgk.value}qWc(m=null){let t=!1;this.Tqa.forEach((z,v)=>{t=v.AY&&(!m||7!==m.J(z));return!t});return t}Eyl(){const m=new l.a;var t=this.xf,z=this.tu;if(this.Skb){z=t.xl();for(var v=0;v<z.length;v++){var H=z[v];m.Z(e.a.Ab(H),new x(H,null,
t.yU(H)))}}else if(this.isDeleted)for(t=z.xl(),v=0;v<t.length;v++)H=t[v],m.Z(e.a.Ab(H),new x(H,z.yU(H),null));else{v=z.xl();for(H=0;H<v.length;H++){var F=v[H],G=e.a.Ab(F),M=z.yU(F);const K=t.hasProperty(F)?t.yU(F):null;m.Z(G,new x(F,M,K))}v=t.xl();for(H=0;H<v.length;H++)F=v[H],z.hasProperty(F)||(G=e.a.Ab(F),M=t.yU(F),m.Z(G,new x(F,null,M)))}return m}}Object(D.a)(y,"MergeableObjectDiff",null,[])},1584:function(D,I,c){c.d(I,"b",function(){return x});c.d(I,"a",function(){return m});var l=c(225),e=c(367),
a=c(611),k=c(1742);const x=(z,v,H)=>{const F=y(z,v,H);let G=0,M=0,K=0,L=new k.a;const R=new l.a;for(let S=0;S<F.length;S++){const N=F.eg(S+1);L.eDd(z.eg(G));L.gDd(v.eg(M));L.kDd(H.eg(K));G++;M++;for(K++;G<z.length&&(!N||!N.equals(z.eg(G)));)L.eDd(z.eg(G)),G++;for(;M<v.length&&(!N||!N.equals(v.eg(M)));)L.gDd(v.eg(M)),M++;for(;K<H.length&&(!N||!N.equals(H.eg(K)));)L.kDd(H.eg(K)),K++;R.add(L);L=new k.a}for(;G<z.length;)L.eDd(z.eg(G)),G++;for(;M<v.length;)L.gDd(v.eg(M)),M++;for(;K<H.length;)L.kDd(H.eg(K)),
K++;L.isEmpty||R.add(L);return R},y=(z,v,H)=>{const F=new l.a,G=v.fH(),M=H.fH();z.forEach(K=>{G.contains(K)&&M.contains(K)&&F.add(K);return!0});return F},m=(z,v,H)=>{z=z||new l.a;v=v||new l.a;H=H||new l.a;const F=new l.a,G=new e.a(0),M=new a.a;for(var K=0;K<z.length;K++){var L=z.eg(K);G.Z(L,K)}for(z=K=0;K<v.length&&z<H.length;){L=v.eg(K);let R=H.eg(z),S=G.Fz(L,-1),N=G.Fz(R,-1);-1===S?(t(M,F,L),K++):-1===N?(t(M,F,R),z++):S===N?(t(M,F,L),K++,z++):S<N?K++:z++}for(;K<v.length;K++)L=v.eg(K),-1===G.Fz(L,
-1)&&t(M,F,L);for(;z<H.length;z++)v=H.eg(z),-1===G.Fz(v,-1)&&t(M,F,v);return F},t=(z,v,H)=>{z.contains(H)||(v.add(H),z.add(H))}},1585:function(D,I,c){c.d(I,"a",function(){return e});D=c(0);var l=c(60);class e{constructor(){this.cp=0;this.id=l.a.create()}}Object(D.a)(e,"LcsUpdateHint",null,[1313,75])},1586:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}l.tellMe="TellMe";l.loki="Loki";l.substrate="Substrate";l.Kic="QueryIndex";l.Pyj="TellMeRanker";l.Qyj="TellMeRankerLogging";Object(D.a)(l,
"Services",null,[])},1587:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{}l.LQa="HttpRequest";l.provider="Provider";Object(D.a)(l,"LatencyTypes",null,[])},1591:function(D,I,c){D=c(0);var l=c(16),e=c(6),a=c(225),k=c(183),x=c(243),y=c(60),m=c(611),t=c(54),z=c(238),v=c(1610);class H extends v.a{constructor(){super();this.cUa=null}get tha(){return"CreateMergeBlock"}eGb(){this.detail.Z("Type",this.tha);this.detail.Z("Revision",this.cUa);return this.detail}}Object(D.a)(H,"CreateMergeBlockFailureDetail",
v.a,[]);var F=c(1656),G=c(1658),M=c(1741),K=c(1611),L=c(1558),R=c(1804);c.d(I,"a",function(){return S});class S{static vJd(N,O,W,V,Q,Y,ba){let Z;Z="";const ea=new a.a;for(let ka=0;ka<W.length;ka++){var ha=void 0;let ua;ha=F.a.gUl(O,W.J(ka),V,Q,Y,ba,N);if(!ha)return{returnValue:null,K5a:Z};({EPf:ua,K5a:ha}=ha.Dci());if(!ua)return{returnValue:null,K5a:Z};Z+=ha;ea.aD(ea.length,ua)}return{returnValue:ea,K5a:Z}}static VMh(N,O,W,V,Q,Y,ba,Z){let ea,ha,ka,ua,sa,Da;Da=sa=ua=ka=ha=ea=null;({K5a:ua,returnValue:ea}=
S.vJd(O,Pa=>N.runtime.vk.J(Pa),W,1,Y,ba,Z));if(!ea)return k.a.instance.Ua(17044299,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for base revision"),N.logger.Rg(Object.assign(new H,{cUa:"Base"})),{returnValue:!1,QK:ea,ZNc:ha,jdd:ka,bEd:ua,eOd:sa,Qne:Da};({K5a:sa,returnValue:ha}=S.vJd(O,Pa=>N.runtime.Lu.J(Pa)||N.runtime.vk.J(Pa),V,2,Y,ba,Z));if(!ha)return k.a.instance.Ua(17044300,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for favoured revision"),
N.logger.Rg(Object.assign(new H,{cUa:"Favored"})),{returnValue:!1,QK:ea,ZNc:ha,jdd:ka,bEd:ua,eOd:sa,Qne:Da};({K5a:Da,returnValue:ka}=S.vJd(O,Pa=>N.runtime.Nq.J(Pa)||N.runtime.vk.J(Pa),Q,4,Y,ba,Z));return ka?{returnValue:!0,QK:ea,ZNc:ha,jdd:ka,bEd:ua,eOd:sa,Qne:Da}:(k.a.instance.Ua(17044301,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for unfavoured revision"),N.logger.Rg(Object.assign(new H,{cUa:"Unfavored"})),{returnValue:!1,
QK:ea,ZNc:ha,jdd:ka,bEd:ua,eOd:sa,Qne:Da})}static DGh(N,O=!1){const W=new a.a;let V=0;for(;V<N.length;){var Q=N.J(V);if(1===Q.type||4===Q.type||2===Q.type)W.add(Q),V++;else if(3===Q.type){let ba="";ba+=Q.character;V++;let Z=Q.DRa,ea=!1;for(;V<N.length;V++){var Y=N.J(V);3===Y.type?Q.runId===Y.runId&&Q.wJ.equals(Y.wJ)&&(Q.Kca===Y.Kca||Q.NFa===Y.NFa)&&Q.KF.JA(Y.KF)&&(!O||Q.mu&&Q.mu.equals(Y.mu))?(ba+=Y.character,Y.DRa&&(Z=!0)):ea=!0:ea=!0;if(ea){Q=new R.a(null,Q.source,Q.Pj,Q.Bg,Q.runId,Q.wJ,ba,Q.inb,
!0,Z,Q.Kca,Q.NFa,Q.qTa,Q.KF,Q.mu);W.add(Q);break}}}}k.a.instance.Ua(17044302,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",W.ir());return W}static m1k(N,O=!1){const W=new a.a;let V=0;for(;V<N.length;){var Q=N.J(V);if(1===Q.type||4===Q.type||2===Q.type)W.add(Q),V++;else if(3===Q.type){let ba=Q.character.toString();V++;let Z=Q.DRa;for(;V<N.length;V++){var Y=N.J(V);if(3===Y.type&&S.Zso(Q,Y,O))ba+=Y.character,Y.DRa&&(Z=!0);else break}Q=new R.a(null,Q.source,Q.Pj,
Q.Bg,Q.runId,Q.wJ,ba,Q.inb,!0,Z,Q.Kca,Q.NFa,Q.qTa,Q.KF,Q.mu);W.add(Q)}}k.a.instance.Ua(50931345,1,4,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",W.ir());return W}static Zso(N,O,W){return N.runId===O.runId&&N.wJ.equals(O.wJ)&&(N.Kca===O.Kca||N.NFa===O.NFa)&&N.KF.JA(O.KF)&&(!W||!!N.mu&&N.mu.equals(O.mu))}static Bmo(N,O,W,V,Q,Y,ba,Z,ea,ha,ka,ua,sa,Da,Pa,Ra){N.setPropertyString(W.Fm,l.a.wo,Q);N.setPropertyUint32(W.Fm,e.a.Wc,V);N.setPropertyUint32s(W.Fm,e.a.vq,Y);N.setPropertyUint32s(W.Fm,
e.a.nt,ba);N.setPropertyObjectIds(W.Fm,l.a.Sn,ea);N.hasProperty(W.Fm,e.a.tj)&&N.setPropertyUint32(W.Fm,e.a.tj,S.fLl());O&&O(9)&&N.setPropertyObjectIds(W.Fm,e.a.Iv,Ra);V=!1;for(Q=0;Q<ha.length;Q++)if(ha.J(Q)){V=!0;break}V&&N.setPropertyBools(W.Fm,e.a.DTf,ha);S.LQk(O,N,W,ka,ua,sa,Da);S.MQk(N,W,Pa);W.DC(l.a.wo);W.DC(e.a.Wc);W.DC(e.a.vq);W.DC(e.a.nt);W.DC(l.a.Sn);W.DC(e.a.DTf);W.DC(l.a.Jm);W.DC(l.a.Iqb);W.DC(e.a.tQa);W.DC(e.a.aIa);W.DC(l.a.pya);W.DC(e.a.Iv);N.hasProperty(W.Fm,e.a.tj)&&W.DC(e.a.tj);0<
Z.length?N.setPropertyUint32s(W.Fm,l.a.Jm,Z):W.Fm.removeProperty(l.a.Jm)}static LQk(N,O,W,V,Q,Y,ba){if(N(100)){N=V.contains(!0,(Z,ea)=>ea);S.veg(O,W,l.a.pya,N?V:null);S.veg(O,W,l.a.Iqb,S.Bej(V,Q));S.veg(O,W,e.a.tQa,S.Bej(V,Y));V=!1;for(Q=0;Q<ba.length;Q++)0!==ba.J(Q)&&(V=!0);V?O.setPropertyUint32s(W.Fm,e.a.aIa,ba):W.Fm.removeProperty(e.a.aIa)}}static MQk(N,O,W){const V=ba=>ba;var Q=Object(t.a)(N,N.setPropertyBools,"setPropertyBools");S.oOa(O,W.Kkb,V,Q,e.a.kGa);S.oOa(O,W.$gb,V,Q,e.a.eha);S.oOa(O,W.J6a,
V,Q,e.a.$Ha);Q=ba=>0<ba.length;var Y=Object(t.a)(N,N.setPropertyStrings,"setPropertyStrings");S.oOa(O,W.Jkb,Q,Y,e.a.lGa);S.oOa(O,W.Zgb,Q,Y,e.a.AEa);S.oOa(O,W.Gob,Q,Y,e.a.DJa);Q=ba=>!!ba;Y=Object(t.a)(N,N.setPropertyListOfMilliseconds,"setPropertyListOfMilliseconds");S.oOa(O,W.Lkb,Q,Y,e.a.mGa);S.oOa(O,W.i1a,Q,Y,e.a.BEa);S.oOa(O,W.Iob,Q,Y,e.a.EJa);W.J6a.any(V)?S.oOa(O,W.Hob,()=>!0,Object(t.a)(N,N.setPropertyObjectIds,"setPropertyObjectIds"),e.a.hAa):O.Fm.removeProperty(e.a.hAa)}static Bej(N,O){const W=
new a.a;let V=!1;for(let Q=0;Q<N.length;Q++){const Y=O.J(Q)&&!N.J(Q);W.add(Y);V=Y||V}return V?W:null}static veg(N,O,W,V){V?N.setPropertyBools(O.Fm,W,V):O.Fm.removeProperty(W)}static fLl(){return x.a.GF()}static zdi(N,O){return N.runtime.Lu.Fz(O,N.runtime.vk.J(O)||N.runtime.Nq.get(O))}static hRc(N,O,W,V,Q){let Y;Y=new a.a;const ba=!!W&&W(9);if(N.runtime.Zb.isFeatureEnabled(77)){var Z=S.m1k(V,ba);var ea=S.DGh(V,ba);Z.length!==ea.length&&N.runtime.Zb.Ux(77)}else Z=S.DGh(V,ba);ea=0;let ha="",ka=new a.a,
ua=new a.a,sa=new a.a,Da=new a.a,Pa=new a.a,Ra=new a.a,Ga=new a.a,ta=new a.a,va=new a.a;const ia=new M.a;let qa=new a.a;var pa=Z.J(Z.length-1);if(2!==pa.type&&4!==pa.type)return k.a.instance.Ua(17044304,1,2,"GetMergeableObjectsFromMergeBlocks: Last merge block not an EOP or table but is [Type: {0}] instead",pa.type),N.logger.Rg(Object.assign(new K.a,{yj:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnq",info:String.format("Last merge block is not EOP or table but {0}",pa.type)})),{returnValue:!1,
y$d:Y};var Fa=0;for(pa=0;pa<Z.length;pa++){var za=Z.J(pa),Oa=null;if(1===za.type||3===za.type)Oa=za,ha+=Oa.text;else if(4===za.type){za=S.zdi(N,za.Pj);za=new L.a(za);Y.add(za);continue}Oa?(ka.add(Oa.runId),ua.add(Oa.Bg),Fa+=Oa.text.length,sa.add(Fa),Da.add(Oa.wJ),Pa.add(Oa.inb),Ra.add(Oa.DRa),Ga.add(Oa.Kca),ta.add(Oa.NFa),va.add(Oa.qTa),ia.Kkb.add(Oa.KF.usm),ia.$gb.add(Oa.KF.Yrm),ia.J6a.add(Oa.KF.Ysm),ia.Jkb.add(Oa.KF.insertion.author),ia.Zgb.add(Oa.KF.deletion.author),ia.Gob.add(Oa.KF.ZHa.author),
ia.Lkb.add(Oa.KF.insertion.L0c),ia.i1a.add(Oa.KF.deletion.L0c),ia.Iob.add(Oa.KF.ZHa.L0c),ia.Hob.add(Oa.KF.ZHa.E2f),ba&&qa.add(Oa.mu)):ka.length||(ka.add(0),ua.add(0),sa.add(0),Da.add(y.a.nil),Pa.add(!1),Ra.add(!1),Ga.add(!1),ta.add(!1),va.add(0),ia.Kkb.add(!1),ia.$gb.add(!1),ia.J6a.add(!1),ia.Jkb.add(""),ia.Zgb.add(""),ia.Gob.add(""),ia.Lkb.add(0),ia.i1a.add(0),ia.Iob.add(0),ia.Hob.add(y.a.nil));if(2===za.type){Fa=za;za=Fa.Wc;sa.zG(sa.length-1);Oa=Q.J(ea);if(!Oa)return k.a.instance.Ua(17044307,1,
2,"GetMergeableObjectsFromMergeBlocks: Failed to get a paragraphId. [ParagraphIdx: {0}] [ParagraphIds.Count: {1}] [MergeBlocks.Length: {2}] [CombinedMergeBlockIdx: {3}] [CombinedMergeBlocks.Length: {4}]",ea,Q.length,V.length,pa,Z.length),N.logger.Rg(Object.assign(new K.a,{yj:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnt",info:"Failed to get ParaId"})),k.a.instance.Aka(17044308,1,4,"GetMergeableObjectsFromMergeBlocks Paragraphs",Q.ir()),k.a.instance.Aka(17044309,1,4,"GetMergeableObjectsFromMergeBlocks MergeBlocks",
V.ir()),k.a.instance.Aka(17044310,1,4,"GetMergeableObjectsFromMergeBlocks CombinedMergeBlocks",Z.ir()),{returnValue:!1,y$d:Y};if(Oa=S.zdi(N,Oa))Oa=new L.a(Oa.XK()),S.Bmo(O,W,Oa,Fa.Wc,ha,ka,ua,sa,Da,Pa,Ra,Ga,ta,va,ia,qa),Y.add(Oa);k.a.instance.Ua(17044312,1,4,"Merge result for: [GraphNode: {0}] [WordId: {1}] [RunIds: {2}] [ParaIds: {3}] [RunIndices: {4}] [ProofingRequired: {5}] [HasSpellingError: {6}] [HasGrammarError: {7}] [FormattingIds: {8}] {9} [ProofingErrorHint: {10}]",Fa.Pj,za,ka.ir(),ua.ir(),
sa.ir(),Ra.ir(),Ga.ir(),ta.ir(),Da.ir(),"",va.ir());ea++;ha="";ka=new a.a;ua=new a.a;sa=new a.a;Da=new a.a;Pa=new a.a;Ra=new a.a;Ga=new a.a;ta=new a.a;va=new a.a;ia.reset();Fa=0;qa=new a.a}}return{returnValue:!0,y$d:Y}}static $6n(N,O){const W=N.runtime.un.J(z.a.OL),V=O.getPropertyObjectIds(W.Fm,e.a.h2);for(let Q=0;Q<V.length;Q++)N.runtime.un.remove(V.J(Q));O.setPropertyObjectIds(W.Fm,e.a.h2,new a.a);O.setPropertyString(W.Fm,e.a.CVa,y.a.nil.toString());W.DC(e.a.h2);W.DC(e.a.CVa)}static tCm(N,O){if(N.runtime.un.nb(z.a.OL))return null;
const W=new L.a(N.runtime.vk.J(z.a.OL).XK());O.setPropertyString(W.Fm,e.a.CVa,N.output.$M.last().id.toString());O.setPropertyObjectIds(W.Fm,e.a.h2,new a.a);W.DC(e.a.h2);W.DC(e.a.CVa);N.runtime.un.Z(z.a.OL,W);return W}static ysf(N){const O=new a.a;N.forEach(W=>{O.add(W.id);return!0});return O}static rfc(N,O,W,V){let Q=0;W.forEach(Y=>{G.a(Y,O+Q++,1);393230===Y.Qc&&N.getPropertyObjectIds(Y,l.a.Sn).forEach(ba=>{V.add(ba);return!0});return!0})}static f5m(N,O){const W=new m.a;let V=0;O.forEach(Q=>{if(W.contains(Q))return!0;
W.add(Q);if(({index:V}=S.lNf("BaseFormatting_",V,Q,Y=>N.runtime.vk.J(Y))).returnValue||({index:V}=S.lNf("FavoredFormatting_",V,Q,Y=>N.runtime.Lu.J(Y))).returnValue||({index:V}=S.lNf("ConflictingFormatting_",V,Q,Y=>N.runtime.Nq.J(Y))).returnValue)return!0;V++;return!0})}static lNf(N,O,W,V){if(W=V(W))if(G.a(W,N+O,1),1179649===W.Qc)return O++,{returnValue:!0,index:O};return{returnValue:!1,index:O}}static Mgf(N){return!!N.runtime.vk.J(z.a.OL)}static oOa(N,O,W,V,Q){O.any(W)?(V(N.Fm,Q,O),N.DC(Q)):N.Fm.removeProperty(Q)}static vnj(N,
O){const W=new a.a;W.add(0);const V=N?N.length:0;for(let Q=0;Q<V;Q++)W.insert(Q+1,N.eg(Q));W.insert(W.length,O);return W}}Object(D.a)(S,"ParagraphMergeUtils",null,[])},1608:function(D,I,c){c.d(I,"a",function(){return e});D=c(0);var l=c(225);class e{constructor(a,k,x){this.Lm=null;this.fk=a;this.source=k;this.Pj=x}get type(){return this.fk}get D8a(){return!1}get ENm(){return 1===(this.source&1)}get FNm(){return 2===(this.source&2)}get GNm(){return 4===(this.source&4)}b5(){return!1}toString(){return String.format("[Source: {0}] [Type: {1}]",
this.oPl(),this.p9b())}oPl(){let a="";this.ENm&&(a+="Base");this.FNm&&(a+="FavoredUpdate");this.GNm&&(a+="UnfavoredUpdate");return a}p9b(){return""}JA(a){return this.type===a.type}Iad(){const a=new l.a;a.add(this);return a}get length(){return 0}}Object(D.a)(e,"AMergeBlock",null,[71,72])},1609:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(1608);class l extends c.a{constructor(e,a,k){super(2,e,a);this.Wc=k}toString(){return String.format("{0} [WordId: {1}] [GraphNodeId: {2}]",super.toString(),
this.Wc,this.Pj)}p9b(){return"Eop"}clone(){return new l(this.source,this.Pj,this.Wc)}JA(e,a,k,x=!1,y=!0){return super.JA(e,a,k,x)?y?e.Wc===this.Wc:e.Pj===this.Pj&&e.Wc===this.Wc:!1}get length(){return 1}}Object(D.a)(l,"EopMergeBlock",c.a,[])},1610:function(D,I,c){c.d(I,"a",function(){return e});D=c(0);var l=c(367);class e{constructor(){this.detail=new l.a}}Object(D.a)(e,"AMergeFailureDetail",null,[1999])},1611:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(1557);class l extends c.a{constructor(){super()}get tha(){return"ParagraphMerge"}}
Object(D.a)(l,"ParagraphMergeFailureDetail",c.a,[])},1612:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(1557);class l extends c.a{constructor(){super()}get tha(){return"RdOpLcs"}}Object(D.a)(l,"ReducedOpsLcsFailureDetail",c.a,[])},1613:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(1557);class l extends c.a{constructor(){super()}get tha(){return"TableMerge"}}Object(D.a)(l,"TableMergeFailureDetail",c.a,[])},1621:function(D,I,c){D=c(0);class l{constructor(){this.icd=this.$Uc=
null;this.oPf=this.score=this.k0c=0}b0f(F,G,M){this.score=F.J(G);++G;this.$Uc=F.J(G)?M.Doa(F.J(G)):null;++G;this.icd=F.J(G)?M.Doa(F.J(G)):null;++G;this.k0c=F.J(G);++G;this.oPf=F.J(G);++G;return G}}Object(D.a)(l,"TokenStringGeneratorInit",null,[]);class e{constructor(F,G,M,K,L){this.mib=F;this.count=G;this.TOd=M;this.TO=K;this.depth=L}}Object(D.a)(e,"ErrorTolerantTrieMatch",null,[]);var a=c(1671),k=c(1760);class x{constructor(F=null,G=0,M=0,K=0){this.qnk=F||new k.a;this.xwa=G;this.TO=M;this.depth=
K}get l6(){return this.qnk}getKey(){return this.l6.Px.toString()+":"+this.xwa.toString()}}Object(D.a)(x,"TrieBookmark",null,[]);class y{constructor(F,G){this.nSa=F;this.uOf=G}T8m(F){if(null==F)throw Error.argumentNull("prefix");let G={};var M=G[""]=new x;this.XWd(M,G);for(M=0;M<F.length;++M){const K=F.charCodeAt(M),L={};for(let R in G)this.YAk(K,G[R],L);G=L}return this.LNo(G)}XWd(F,G){if(!(F.TO>=this.uOf)&&(F=new x(a.a.I8e(F.l6),F.xwa,F.TO+1,F.depth),F.l6.VF&a.a.Y9a&&(F.xwa+=1),this.nSa.wSb(F.l6))){F.depth+=
1;let M=!0;for(;M;)y.xoe(F,G),this.XWd(F,G),F.xwa+=this.nSa.D9b(F.l6,!0)+(F.l6.VF&a.a.Y9a?1:0),M=this.nSa.Hcd(F.l6)}}YAk(F,G,M){G.TO+1<=this.uOf&&(G.TO+=1,y.xoe(G,M),--G.TO);G.l6.VF&a.a.Y9a&&(G.xwa+=1);if(this.nSa.wSb(G.l6)){G.depth+=1;let K=!0;for(;K;)G.l6.ETb===F?(y.xoe(G,M),this.XWd(G,M)):G.TO+1<=this.uOf&&(G.TO+=1,y.xoe(G,M),this.XWd(G,M),--G.TO),G.xwa+=this.nSa.D9b(G.l6,!0)+(G.l6.VF&a.a.Y9a?1:0),K=this.nSa.Hcd(G.l6)}}LNo(F){const G=[];for(var M in F){const K=F[M];if(!K.l6.Px)continue;const L=
!!(K.l6.VF&a.a.Y9a),R=this.nSa.D9b(K.l6,!1)+(L?1:0);Array.add(G,new e(K.xwa,R,L,K.TO,K.depth))}G.sort((K,L)=>{let R=K.mib-L.mib;return R||(R=-(K.count-L.count))?R:R=K.depth-L.depth});if(2>G.length)return G;F=[];for(M=0;M<G.length;)M+=y.rBj(M,G,F);return F}static xoe(F,G){const M=F.getKey();M in G?(G=G[M],G.TO=Math.min(G.TO,F.TO)):G[M]=new x(a.a.I8e(F.l6),F.xwa,F.TO,F.depth)}static rBj(F,G,M){const K=G[F];let L=K.mib;const R=L+K.count;let S=1,N=K.TOd;for(;F+S<G.length&&G[F+S].mib<R;){const O=G[F+S];
O.mib>L&&(Array.add(M,new e(L,O.mib-L,N,K.TO,K.depth)),N=!1);S+=y.rBj(F+S,G,M);L=O.mib+O.count}L<R&&Array.add(M,new e(L,R-L,N,K.TO,K.depth));return S}}Object(D.a)(y,"ErrorTolerantTrieLookupEngine",null,[1306]);class m extends l{constructor(F,G,M){super();this.Yqi=this.IZi=!1;this.sYh=null;if(F){var K=0;try{K=this.b0f(F,K,G);this.IZi=1===F.J(K);++K;this.Yqi=1===F.J(K);++K;const L=F.J(K);this.sYh=this.$An(M,L)}catch(L){throw Error.argument("initData");}}}$An(F,G){return new y(F,G)}}Object(D.a)(m,"FuzzyMatchTokenStringGeneratorInit",
l,[]);class t extends l{constructor(F,G){super();this.query=this.name=null;if(F){this.annotations=G.annotations;var M=0;try{M=this.b0f(F,M,G),this.name=G.IB(F.J(M)),++M,this.query=G.hL(F.J(M))}catch(K){throw Error.argument("initData");}}}}Object(D.a)(t,"QueryTokenStringGeneratorInit",l,[]);class z extends l{constructor(F,G){super();if(F)try{this.b0f(F,0,G)}catch(M){throw Error.argument("initData");}}}Object(D.a)(z,"SurfaceStringTokenStringGeneratorInit",l,[]);var v=c(1544);c.d(I,"a",function(){return H});
class H{constructor(F){this.kOf=F}get $Uc(){return this.kOf.$Uc}get icd(){return this.kOf.icd}get k0c(){return this.kOf.k0c}static create(F,G,M){const {SurfaceStringTokenStringGenerator:K}=c(1901),{QueryTokenStringGenerator:L}=c(1902),{FuzzyMatchTokenStringGenerator:R}=c(1903);let S=0;try{if(F.J(S)!==H.QBb)throw Error.argument("initData","Input does not represent a token string generator");++S;const N=F.J(S);++S;const O=new v.a;O.yib(F,S,F.count-S);switch(N){case K.QHc:return new K(new z(O,G));case L.QHc:return new L(new t(O,
G));case R.QHc:return new R(new m(O,G,M));default:throw Error.argument("initData");}}catch(N){throw Error.argument("initData");}}static nqh(F,G,M,K,L,R){F=F.SLo.getId(G,null);if(0>F)return++R,R;H.oqh(F,M,K,L);return R}static oqh(F,G,M,K){Array.add(K.Kjg,F);Array.add(K.Kwj,G);++K.Rnc[M]}}H.QBb=1099767983;Object(D.a)(H,"TokenStringGenerator",null,[1286])},1655:function(D,I,c){c.d(I,"a",function(){return a});D=c(0);var l=c(225);I=c(1608);var e=c(1569);class a extends I.a{constructor(k,x,y){super(k,x,
y)}xBo(k){let x;x=null;if(!this.text||!this.D8a||0>=k||k>=this.length)return{returnValue:!1,hvj:x};x=new l.a;const y=this.clone();y.k$c(e.a.Rqb(this.text,0,k));const m=this.clone();m.k$c(e.a.Rqb(this.text,k,this.length-k));x.add(y);x.add(m);return{returnValue:!0,hvj:x}}b5(){return!0}get length(){return this.text.length}}Object(D.a)(a,"ATextMergeBlock",I.a,[])},1656:function(D,I,c){c.d(I,"a",function(){return e});D=c(0);var l=c(183);class e{$1e(a,k){return a+("[Block: "+k+"] ")}static gUl(a,k,x,y,
m,t,z){const {ParagraphMergeBlockCreator:v}=c(1997),{TableMergeBlockCreator:H}=c(2002);if(393230===k.Qc)return new v(a,k,x,m,t,y(9),z);if(393250===k.Qc)return new H(k,x);l.a.instance.Ua(4051652,1,1,"Trying to Run GetMergeBlockList on unknown Runtime Class ID {0}.",k.Qc);return null}}Object(D.a)(e,"MergeBlockCreator",null,[])},1657:function(D,I,c){c.d(I,"a",function(){return k});D=c(0);var l=c(6),e=c(60);I=c(1655);var a=c(1575);class k extends I.a{constructor(x,y,m,t,z,v,H,F,G,M,K,L,R,S){super(y,m,
t);this.Bg=z;this.runId=v;this.inb=F;this.P3j=H;this.ute=x;this.DRa=G;this.Kca=M;this.NFa=K;this.qTa=L;this.KF=R;this.mu=S}get oGc(){return this.ute}get wJ(){return this.P3j}get tFb(){return this.oGc(this.wJ)}toString(){return String.format("{0} [ParaId: {1}] [RunId: {2}] [NewlyTypedRun: {3}] [GraphNodeId: {4}] [FormatId: {5}] [ChangeId: {6}]",super.toString(),this.Bg,this.runId,this.inb,this.Pj,this.wJ.toString(),this.mu?this.mu.toString():"NULL")}JA(x,y,m,t=!1){if(!super.JA(x,y,m,t))return!1;if(t)return!0;
if(!this.KF.JA(x.KF)||this.mu&&!this.mu.equals(x.mu))return!1;if(this.wJ.equals(x.wJ)||this.wJ.equals(e.a.nil)||x.wJ.equals(e.a.nil))return!0;x=new a.a(this.tFb,x.tFb);y=y.uMh(this.tFb,m);return x.qWc(y.bbe)?!1:!0}get rIm(){return this.b5()&&"\ufffc"===this.text&&this.tFb?this.tFb.hasProperty(l.a.Qs)||1179725!==this.tFb.Qc?!0:!1:!1}}Object(D.a)(k,"AUserRunMergeBlock",I.a,[])},1658:function(D,I,c){c.d(I,"a",function(){return e});var l=c(183);const e=(a,k,x=4)=>{a?l.a.instance.Aka(4273285,x,4,k,a.acd()):
l.a.instance.Ua(4293845,x,1,k,"{0}: Node was null.",k)}},1659:function(D,I,c){c.d(I,"e",function(){return y});c.d(I,"a",function(){return m});c.d(I,"d",function(){return t});c.d(I,"b",function(){return z});c.d(I,"c",function(){return v});var l=c(6),e=c(16),a=c(60),k=c(1060),x=c(1584);const y=(G,M,K)=>{const L=new k.a;let R=a.a.nil;M=L.getPropertyObjectId(M,l.a.$qb);M.equals(a.a.nil)||(G=G.runtime.vk.J(M),K&&(G=K.Fz(M,G)),G&&(R=L.getPropertyObjectId(G,l.a.$qb)));return R},m=(G,M,K,L,R)=>{const S=new k.a;
let N=null;var O=S.getPropertyObjectId(K,l.a.$qb);O!==a.a.nil&&(N=G.runtime.vk.J(O),M&&(N=M.Fz(O,N)));if(N){O=S.getPropertyObjectIds(N,e.a.gf);for(R=0;R<O.length&&!O.J(R).equals(K.id);R++);R===O.length&&(R=-1)}K=y(G,K,M);if(!K.equals(a.a.nil)&&(G=G.runtime.vk.J(K),M&&(G=M.Fz(K,G)),G)){M=S.getPropertyObjectIds(G,e.a.gf);for(L=0;L<M.length&&!M.J(L).equals(N.id);L++);L===M.length&&(L=-1)}return{rowIndex:L,W4b:R}},t=(G,M,K,L,R)=>{var S=new k.a;let N=null;var O=G.runtime.vk.J(K);M&&(O=M.Fz(K,O));if(!O)return null;
O=S.getPropertyObjectIds(O,e.a.gf);K=null;L<O.length&&(L=O.J(L),K=G.runtime.vk.J(L),M&&(K=M.Fz(L,K)));K&&(S=S.getPropertyObjectIds(K,e.a.gf),R<S.length&&(R=S.J(R),N=G.runtime.vk.J(R),M&&(N=M.Fz(R,N))));return N},z=(G,M,K)=>{let L,R;R=L=-1;const S=(new k.a).getPropertyObjectId(K,l.a.$qb);var N=y(G,K,M);if(N.equals(a.a.nil)||S.equals(a.a.nil))return{rowIndex:L,W4b:R};M=G.runtime.$kg;var O=M.J(N);if(!O){O=H(G,N);if(!O)return{rowIndex:L,W4b:R};M.Z(N,O)}for(N=0;N<O.length;N++)if(O.J(N).equals(S)){L=N;
break}O=M.J(S);if(!O){O=F(G,S);if(!O)return{rowIndex:L,W4b:R};M.Z(S,O)}for(G=0;G<O.length;G++)if(O.J(G).equals(K.id)){R=G;break}return{rowIndex:L,W4b:R}},v=(G,M,K,L)=>{if(0>K||0>L)return a.a.nil;new k.a;const R=G.runtime.$kg;let S=R.J(M);if(!S){S=H(G,M);if(!S)return a.a.nil;R.Z(M,S)}if(K<S.length)M=S.J(K);else return a.a.nil;K=R.J(M);if(!K){K=F(G,M);if(!K)return a.a.nil;R.Z(M,K)}if(L<K.length)G=K.J(L);else return a.a.nil;return G},H=(G,M)=>{var K=new k.a;const L=G.runtime.vk.J(M);if(L){var R=G.runtime.Lu.Fz(M,
L);G=G.runtime.Nq.Fz(M,L);M=K.getPropertyObjectIds(L,e.a.gf);R=K.getPropertyObjectIds(R,e.a.gf);K=K.getPropertyObjectIds(G,e.a.gf);return M.Dq(R,(S,N)=>S.equals(N))?K:M.Dq(K,(S,N)=>S.equals(N))?R:x.a(M,R,K,(S,N)=>S.equals(N))}return(R=G.runtime.Lu.J(M))?K.getPropertyObjectIds(R,e.a.gf):(R=G.runtime.Nq.J(M))?K.getPropertyObjectIds(R,e.a.gf):null},F=(G,M)=>{var K=new k.a;const L=G.runtime.vk.J(M);if(L){var R=G.runtime.Lu.Fz(M,L);G=G.runtime.Nq.Fz(M,L);M=K.getPropertyObjectIds(L,e.a.gf);R=K.getPropertyObjectIds(R,
e.a.gf);K=K.getPropertyObjectIds(G,e.a.gf);return M.Dq(R,(S,N)=>S.equals(N))?K:M.Dq(K,(S,N)=>S.equals(N))?R:null}return(R=G.runtime.Lu.J(M))?K.getPropertyObjectIds(R,e.a.gf):(R=G.runtime.Nq.J(M))?K.getPropertyObjectIds(R,e.a.gf):null}},1660:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(1524);class l extends c.a{constructor(e,a,k,x,y=null){super(e,a,y,null,k);this.id=x}}Object(D.a)(l,"TryQueryResultBinding",c.a,[])},1661:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e){this.Bb=
e}get Z5a(){return this.Bb.Z5a}get TFo(){return 4!==this.Bb.style}get VFo(){return!0}get trie(){return this.Bb.trie}getId(e,a){if(!this.TFo)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Bb.style){case 0:return this.s0l(e,a);default:throw Error.notImplemented();}}IB(e){if(!this.VFo)throw Error.invalidOperation("String lookup not supported on this string table");if(0>e||e>=this.Z5a)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Bb.style){case 0:return this.xfm(e);
case 4:return this.wfm(e);default:throw Error.notImplemented();}}s0l(e,a){e=this.Bb.trie.SLi(e,0,e.length,a);if(!e.succeeded)return-1;if(0>e.goc||e.goc>=this.Bb.Z5a)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Bb.Icd?this.Bb.V5c.Yy(this.Bb.Icd+4*e.goc,4):e.goc}xfm(e){if(this.Bb.Icd){let a=0;for(;a<this.Bb.Z5a&&this.Bb.V5c.Yy(this.Bb.Icd+4*a,4)!==e;++a);if(a>=this.Bb.Z5a)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Bb.trie.Vhi(a)}return this.Bb.trie.Vhi(e)}wfm(e){const a=
this.Bb.V5c.Yy(this.Bb.Hwj+4*e,4);e=this.Bb.V5c.Yy(this.Bb.Iwj+4*e,4);if(0>e||0>a)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const k=Array(a);for(let x=0;x<a;++x)k[x]=({Bwm:e}=this.fQn(e)).returnValue;return String.fromCharCode.apply(null,k)}fQn(e){let a=0;for(let k=0;3>k;++k){const x=this.Bb.V5c.J(this.Bb.eDh+e)^182;++e;a|=(x&127)<<7*k;if(!(x&128))break}return{returnValue:a,Bwm:e}}}Object(D.a)(l,"StringTable",null,[1261])},1662:function(D,I,c){c.d(I,"a",function(){return e});
D=c(0);var l=c(1671);class e{constructor(a){this.trie=null;this.eDh=this.Hwj=this.Iwj=this.Icd=0;if(a){this.V5c=a;var k=0;if(a.Yy(k,4)!==e.QBb)throw Error.argument("bytes","Input does not represent a string table");k+=4;this.Z5a=a.Yy(k,4);k+=4;this.style=a.Yy(k,4);k+=4;switch(this.style){case 0:const x=1===a.Yy(k,4);k+=4;x||(this.Icd=k,k+=4*this.Z5a);a.Yy(k,4);this.trie=this.zBn(a,k+4);break;case 4:this.Iwj=k;this.Hwj=k+=4*this.Z5a;k+=4*this.Z5a;a.Yy(k,4);this.eDh=k+4;break;default:throw Error.argument("bytes");
}}}zBn(a,k){return new l.a(a,k)}}e.QBb=1025118440;Object(D.a)(e,"StringTableInit",null,[])},1663:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);var l;(function(e){e[e.Answer=0]="Answer";e[e.Definition=1]="Definition";e[e.Entity=2]="Entity";e[e.WolframAnswer=3]="WolframAnswer";e[e.Assistance=4]="Assistance";e[e.Command=5]="Command";e[e.Document=6]="Document";e[e.TryQuery=7]="TryQuery";e[e.FindInDocument=8]="FindInDocument";e[e.HelpAction=9]="HelpAction";e[e.Insights=10]="Insights";e[e.People=
11]="People";e[e.Image=12]="Image";e[e.FirstRunResult=13]="FirstRunResult";e[e.NoCommandsFoundResult=14]="NoCommandsFoundResult";e[e.TestResult=15]="TestResult";e[e.AppsForOffice_Installed=16]="AppsForOffice_Installed";e[e.AppsForOffice_Recommandation=17]="AppsForOffice_Recommandation";e[e.AppsForOffice_Query=18]="AppsForOffice_Query";e[e.Notes_Onenote=19]="Notes_Onenote";e[e.Notes_Samsung=20]="Notes_Samsung";e[e.Notes_Sticky=21]="Notes_Sticky";e[e.Learning=22]="Learning";e[e.Feedback=23]="Feedback";
e[e.Template=24]="Template";e[e.ActionAI=25]="ActionAI";e[e.ActionAICommand=26]="ActionAICommand";e[e.Addin=27]="Addin";e[e.OfficeScript=28]="OfficeScript";e[e.AddinStoreEntry=29]="AddinStoreEntry";e[e.GenerateSlides=30]="GenerateSlides";e[e.SummarizeDeck=31]="SummarizeDeck";e[e.Unknown=32]="Unknown"})(l||(l={}));Object(D.b)("ResultType",l)},1668:function(D,I,c){D=c(0);var l=c(6),e=c(611),a=c(183),k=c(225),x=c(60),y=c(367),m=c(69),t;(function(Ua){Ua[Ua.none=0]="none";Ua[Ua.mergeConflict=1]="mergeConflict";
Ua[Ua.containerBaseIdValidationFailure=2]="containerBaseIdValidationFailure";Ua[Ua.failedToApplyHints=3]="failedToApplyHints";Ua[Ua.validateUpdateHintsAreComplete=4]="validateUpdateHintsAreComplete";Ua[Ua.other=5]="other"})(t||(t={}));Object(D.b)("ParagraphMergeUsingHintsFailureReason",t);var z=c(1060),v=c(238),H=c(909);const F=Ua=>{const Ya=new k.a;Ua.forEach(Fb=>{Ya.add(Fb);return!0});return Ya};var G=c(1609),M=c(1584),K=c(1612);const L=(Ua,Ya)=>{if(Ua.length!==Ya.length)return!1;for(let Fb=0;Fb<
Ua.length;Fb++)Ua.J(Fb).Lm=Ya.J(Fb),Ya.J(Fb).Lm=Ua.J(Fb);return!0},R=(Ua,Ya,Fb)=>{let Wa,yb,Yb;Wa=0;yb=!1;Yb=0;var qc;if(!({idx:qc}=V(Ua,Ya)).returnValue)return a.a.instance.Ua(18969440,1,5,"TryFindMergeBlockToSplit: Unable to find MergeBlock for [GraphNodeId: {0}] [MergeBlocks: {1}]",Ya,Ua.ir()),{returnValue:!1,ASc:Wa,enb:yb,h1c:Yb};if(!Fb&&2===Ua.J(qc).type)return{returnValue:!0,ASc:qc,enb:yb,h1c:Yb};if(!Ua.J(qc).b5())return a.a.instance.Ua(17044256,1,2,"TryFindMergeBlockToSplit: MergeBlock that at [Index: {0}] [Cp: {1}] is of Unexpected type [MergeBlocks: {2}]",
qc,Fb,Ua.ir()),{returnValue:!1,ASc:Wa,enb:yb,h1c:Yb};let Hc=!1,$b=0;for(;qc<Ua.length&&Ua.J(qc).Pj.equals(Ya);qc++){if(Fb===$b){Hc=!0;break}if(Fb>$b&&Fb<$b+Ua.J(qc).length){yb=Hc=!0;Yb=Fb-$b;break}$b+=Ua.J(qc).length}Hc||Fb!==$b||(Hc=!0);Hc&&(Wa=qc);return{returnValue:Hc,ASc:Wa,enb:yb,h1c:Yb}},S=(Ua,Ya,Fb)=>{let Wa,yb,Yb;Yb=yb=0;Wa=!1;let qc=0,Hc=!1;for(;yb<Ua.length;yb++){if(Ya===qc){Hc=!0;break}if(Ya>qc&&Ya<qc+Ua.J(yb).length){Wa=Hc=!0;Yb=Ya-qc;break}qc+=Ua.J(yb).length}Hc||Ya!==qc||(Hc=!0);Hc||
(Ua=String.format("Unable to find block idx to split at cp [Blocks: {0}][Length: {1}][CP: {2}]",Ua.length,qc,Ya),a.a.instance.Ua(573178201,1,2,Ua),Fb.Rg(Object.assign(new K.a,{eventId:"8k6fz",info:Ua})));return{returnValue:Hc,enb:Wa,uxh:yb,txh:Yb}},N=(Ua,Ya,Fb)=>{let Wa;if(Ua.J(Ya).b5()&&({hvj:Wa}=Ua.J(Ya).xBo(Fb)).returnValue)return Ua.aD(Ya+1,Wa),Ua.zG(Ya),!0;a.a.instance.Ua(18969441,1,5,"TrySplitMergeBlockInListAtIndexAndCp: Unable to split at [Index: {0}] [Cp: {1}] [MergeBlocks: {2}]",Ya,Fb,Ua.ir());
return!1},O=(Ua,Ya,Fb)=>{let Wa,yb;if(!({ASc:Fb,enb:yb,h1c:Wa}=R(Ua,Ya,Fb)).returnValue)return{returnValue:!1,index:0};if(!yb)return{returnValue:!0,index:Fb};if(N(Ua,Fb,Wa))return{returnValue:!0,index:Fb+1};a.a.instance.Ua(18969442,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [GraphNodeId: {0}] [Cp: {1}] [MergeBlocks: {2}]",Ya,Wa,Ua.ir());return{returnValue:!1,index:0}},W=(Ua,Ya,Fb)=>{let Wa;if(!({enb:Wa,uxh:Ya,txh:Fb}=S(Ua,Ya,Fb)).returnValue)return{returnValue:!1,index:0};if(!Wa)return{returnValue:!0,
index:Ya};if(N(Ua,Ya,Fb))return{returnValue:!0,index:Ya+1};a.a.instance.Ua(574433311,1,5,"TrySplitMergeBlockListAtCp: Unable to split at [Cp: {1}] [MergeBlocks: {2}]",Fb,Ua.ir());return{returnValue:!1,index:0}},V=(Ua,Ya)=>{let Fb;Fb=0;for(let Wa=0;Wa<Ua.length;Wa++)if(Ua.J(Wa).Pj.equals(Ya))return Fb=Wa,{returnValue:!0,idx:Fb};a.a.instance.Ua(18969443,1,5,"TryGetFirstIdxForGraphNodeId: Unable to find first idx [GraphNodeId: {0}] [MergeBlocks: {1}]",Ya,Ua.ir());return{returnValue:!1,idx:Fb}},Q=(Ua,
Ya)=>{let Fb;Fb=-1;for(let Wa=Ya;Wa<Ua.length;Wa++)if(2===Ua.J(Wa).type)return Fb=Wa,{returnValue:!0,qha:Fb};a.a.instance.Ua(18969472,1,5,"TryGetIdxNextEop: Unable to find first idx [Index: {0}] [MergeBlocks: {1}]",Ya,Ua.ir());return{returnValue:!1,qha:Fb}},Y=(Ua,Ya,Fb)=>{let Wa;Wa=-1;for(let yb=Fb;yb<Ua.length;yb++)if(2===Ua.J(yb).type&&Ua.J(yb).Pj.equals(Ya))return Wa=yb,{returnValue:!0,qha:Wa};a.a.instance.Ua(18969473,1,5,"TryGetIdxNextEopForGraphNodeId: Unable to find EOP [GraphNodeId: {0}] [Index: {1}] [MergeBlocks: {2}]",
Ya,Fb,Ua.ir());return{returnValue:!1,qha:Wa}},ba=(Ua,Ya)=>{let Fb;Fb=0;var Wa;if(!({idx:Wa}=V(Ua,Ya)).returnValue)return a.a.instance.Ua(17342616,1,2,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",Ya,Ua),{returnValue:!1,length:Fb};for(;Wa<Ua.length;Wa++)if(6!==Ua.J(Wa).type){if(2===Ua.J(Wa).type)return{returnValue:!0,length:Fb};a.a.instance.shipAssertTag(17342617,1,Ua.J(Wa).b5(),"We found something other than text with type "+Ua.J(Wa).type);a.a.instance.shipAssertTag(17877021,1,Ua.J(Wa).Pj.equals(Ya),
"Unexpected GraphNodeId {0} for ParaId {1}",Ua.J(Wa).Pj,Ya);Fb+=Ua.J(Wa).length}a.a.instance.Ua(18969474,1,5,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",Ya,Ua);return{returnValue:!1,length:Fb}},Z=Ua=>{const Ya=new k.a;for(let Fb=0;Fb<Ua.length;Fb++)Ya.add(Ua.J(Fb).clone());return Ya};var ea=c(1611),ha=c(1569);class ka{constructor(Ua,Ya,Fb=null,Wa=null){this.Pj=Ua;this.type=Ya;this.text=Fb;this.Wc=Wa}isEqual(Ua){return Ua.Pj.equals(this.Pj)&&this.type===Ua.type&&this.Wc===Ua.Wc&&ha.a.zvh(this.text,
Ua.text)}toString(){let Ua=String.format("[GraphNodeId: {0}] [WordId: {1}] [MergeBlockType: {2}]",this.Pj,this.Wc,this.type);this.text&&(Ua+=String.format(" [TextLength: {0}]",this.text.length));return Ua}}Object(D.a)(ka,"MergeBlockValidationState",null,[]);var ua=c(112),sa=c(953),Da=c(876),Pa=c(541),Ra=c(468),Ga=c(952),ta=c(875),va=c(1557),ia=c(1750),qa;(function(Ua){Ua[Ua.base=1]="base";Ua[Ua.favoredUpdate=2]="favoredUpdate";Ua[Ua.unfavoredUpdate=4]="unfavoredUpdate";Ua[Ua.min=1]="min";Ua[Ua.max=
7]="max"})(qa||(qa={}));Object(D.b)("MergeBlockSource",qa);class pa{constructor(Ua,Ya,Fb,Wa){this.Bg=Ua;this.cp=Ya;this.aEd=Fb;this.Sdd=Wa}}Object(D.a)(pa,"MergedListBlocksWithUpdatedFormattingIds",null,[]);var Fa=c(1608);class za extends Fa.a{constructor(Ua,Ya){super(6,Ua,Ya);this.Wc=0}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.Pj)}p9b(){return"Selection"}clone(){return new za(this.source,this.Pj)}JA(){return!1}get length(){return 0}}Object(D.a)(za,"SelectionMergeBlock",
Fa.a,[]);var Oa;(function(Ua){Ua[Ua.success=0]="success";Ua[Ua.selfSplit=1]="selfSplit";Ua[Ua.noSecondaryBlockToSplit=2]="noSecondaryBlockToSplit";Ua[Ua.unexpected=3]="unexpected"})(Oa||(Oa={}));Object(D.b)("SplitTwinListResult",Oa);var xa=c(1655);class fa extends xa.a{constructor(Ua,Ya,Fb,Wa){super(5,Ua,Ya);this._text=null;this.k$c(Fb);this.Wnk=Wa}get text(){return this._text}k$c(Ua){this._text=Ua}get zdd(){return this.Wnk}clone(){return new fa(this.source,this.Pj,this.text,this.zdd)}get D8a(){return this.text&&
this.text.length?!0:!1}toString(){return String.format("{0}",super.toString())}}Object(D.a)(fa,"UpdateHintTextMergeBlock",xa.a,[]);class Ka{constructor(Ua,Ya,Fb,Wa){this.p3=!1;this.sdb=new y.a;this.$d=Ua;this.Pkh=Wa;this.fOg=Fb;this._base=Ya;this.Hye=Z(Ya);if(!L(this.base,this.Pe))throw a.a.instance.Ua(574133957,1,2,"LcsTwinList ConnectList: Length not equal"),Ua.logger.Rg(Object.assign(new va.a,{info:"TwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get base(){return this._base}get Pe(){return this.Hye}get mergeConflict(){return this.p3}N2e(Ua,
Ya){switch(Ua.type){case 1:return this.dFk(Ua,Ya);case 2:return this.m2e(Ua,Ya);case 3:return this.bGk(Ua,Ya);case 4:return this.wFk(Ua);case 5:return this.uEk(Ua,Ya);case 6:return this.k2e(Ua);default:return!1}}M2e(Ua,Ya){switch(Ua.type){case 1:return this.q2e(Ua,Ya);case 2:return this.l2e(Ua,Ya);case 3:return this.aGk(Ua,Ya);case 4:return this.vFk(Ua);case 5:return this.tEk(Ua,Ya);case 6:return this.j2e(Ua);default:return{returnValue:!1,Au:null}}}dFk(Ua,Ya){let Fb;const Wa=({gia:Fb}=this.fJa(Ua.Bg,
Ya,!1,Ua.cp,!1,"ApplyInsertTextHintToDerived")).returnValue;if(0!==Wa&&1!==Wa)return 3!==Wa&&(a.a.instance.Ua(590202197,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToDerived for mergeBlockSource {0}: {1}",qa[Ya],Oa[Wa]),this.$d.logger.Rg(Object.assign(new ia.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vv"}))),!1;this.p3=!1;Ya=new fa(Ya,Ua.Bg,Ua.text,Ua.id);this.cCf(Ua,Fb,Ya);return!0}m2e(Ua,Ya){let Fb,Wa=({gia:Fb}=this.fJa(Ua.Bg,Ya,!1,Ua.cp,!1,"ApplyDeleteTextHintToDerived Start")).returnValue;
if(0!==Wa&&1!==Wa)return 3!==Wa&&(a.a.instance.Ua(590202198,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (start) for mergeBlockSource {0}: {1}",qa[Ya],Oa[Wa]),this.$d.logger.Rg(Object.assign(new ia.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vw"}))),!1;let yb;({gia:yb,returnValue:Wa}=this.fJa(Ua.Bg,Ya,!1,Ua.cp+Ua.text.length,!1,"ApplyDeleteTextHintToDerived End"));if(0!==Wa&&1!==Wa)return 3!==Wa&&(a.a.instance.Ua(590202199,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (end) for mergeBlockSource {0}: {1}",
qa[Ya],Oa[Wa]),this.$d.logger.Rg(Object.assign(new ia.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vx"}))),!1;this.p3=!1;this.sef(Ua,Fb,yb);return!0}bGk(Ua,Ya){let Fb;const Wa=({tAf:Fb}=this.Qai(Ua,Ya,!1)).returnValue;if(0!==Wa&&1!==Wa)return 3!==Wa&&(a.a.instance.Ua(590202200,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToDerived for mergeBlockSource {0}: {1}",qa[Ya],Oa[Wa]),this.$d.logger.Rg(Object.assign(new ia.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vy"}))),
!1;this.p3=!1;Ya=new G.a(Ya,Ua.hu,Ua.Aua);this.cCf(Ua,Fb,Ya);return!0}wFk(Ua){let Ya;if(!({cXd:Ya}=this.Rai(Ua,this.Pe,"Derived")).returnValue)return!1;this.sef(Ua,Ya,Ya+1);return!0}uEk(Ua,Ya){let Fb;if(!({DPf:Ya,sAf:Fb}=this.Cci(Ua,!1,Ya)).returnValue)return!1;this.cCf(Ua,Fb,Ya);return!0}k2e(Ua){let Ya;if(!({bXd:Ya}=this.Iai(Ua,this.Pe,"Derived")).returnValue)return!1;this.sef(Ua,Ya,Ya+1);return!0}Luh(Ua,Ya,Fb){const Wa=({gia:Ya}=this.fJa(Ua,Fb,!1,Ya,!0,"ApplyInsertCpPlaceHolderHintToDerived")).returnValue;
if(0!==Wa&&1!==Wa)return 3!==Wa&&(a.a.instance.Ua(590202201,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToDerived for mergeBlockSource {0}: {1}",qa[Fb],Oa[Wa]),this.$d.logger.Rg(Object.assign(new ia.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vz"}))),!1;this.p3=!1;Ua=new za(Fb,Ua);this.Pe.insert(Ya,Ua);return!0}q2e(Ua,Ya){var Fb=null;if(Ka.Rxi(Ua.text.length))return{returnValue:!1,Au:Fb};let Wa,yb,Yb;var qc=({gia:Wa,pxa:yb,Wga:Yb}=this.fJa(Ua.Bg,Ya,!0,Ua.cp,
!1,"ApplyInsertTextHintToBaseAndDerived")).returnValue;if(0!==qc&&2!==qc)return 3!==qc&&(a.a.instance.Ua(590202202,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToBaseAndDerived for mergeBlockSource {0}: {1}",qa[Ya],Oa[qc]),this.$d.logger.Rg(Object.assign(new ia.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v0"}))),{returnValue:!1,Au:Fb};this.p3=!1;({qha:qc}=Q(this.Pe,yb));qc=this.Pe.J(qc).Pj;Fb=new fa(Ya,Ua.Bg,Ua.text,Ua.id);Ya=new fa(Ya,qc,Ua.text,Ua.id);Fb.Lm=Ya;Ya.Lm=
Fb;this.base.insert(Wa,Fb);this.Pe.insert(yb,Ya);Fb=new k.a;Fb.add(new Ra.a(qc,Yb,Ua.text,Ua.id,Ua.Ou));return{returnValue:!0,Au:Fb}}l2e(Ua,Ya){let Fb;Fb=null;if(Ka.Rxi(Ua.text.length))return{returnValue:!1,Au:Fb};let Wa;var yb,Yb=({gia:Wa,pxa:qc,Wga:yb}=this.fJa(Ua.Bg,Ya,!0,Ua.cp,!1,"ApplyDeleteTextHintToBaseAndDerived Start")).returnValue;if(0!==Yb){if(2!==Yb)return 3!==Yb&&(a.a.instance.Ua(590202203,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (start) for mergeBlockSource {0}: {1}",
qa[Ya],Oa[Yb]),this.$d.logger.Rg(Object.assign(new ia.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v1"}))),{returnValue:!1,Au:Fb};var qc=0;for({idx:yb}=V(this.base,Ua.Bg);yb<this.base.length&&qc<Ua.cp;yb++)qc+=this.base.J(yb).length;qc-=this.base.J(yb-1).length;({pxa:qc,Wga:yb,returnValue:Yb}=this.fJa(Ua.Bg,Ya,!0,qc,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==Yb)return 3!==Yb&&(a.a.instance.Ua(590202204,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback start) for mergeBlockSource {0}: {1}",
qa[Ya],Oa[Yb]),this.$d.logger.Rg(Object.assign(new ia.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v2"}))),{returnValue:!1,Au:Fb};this.p3=!1}var Hc,$b;({gia:Hc,pxa:$b,Wga:Ub,returnValue:Yb}=this.fJa(Ua.Bg,Ya,!0,Ua.cp+Ua.text.length,!1,"ApplyDeleteTextHintToBaseAndDerived End"));if(0!==Yb){if(2!==Yb)return 3!==Yb&&(a.a.instance.Ua(590202205,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (end) for mergeBlockSource {0}: {1}",qa[Ya],Oa[Yb]),this.$d.logger.Rg(Object.assign(new ia.a,
{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v3"}))),{returnValue:!1,Au:Fb};var Ub=0;for({idx:$b}=V(this.base,Ua.Bg);$b<this.base.length&&Ub<Ua.cp+Ua.text.length;$b++)Ub+=this.base.J($b).length;({pxa:$b,Wga:Ub,returnValue:Yb}=this.fJa(Ua.Bg,Ya,!0,Ub,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==Yb)return 3!==Yb&&(a.a.instance.Ua(590202206,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback end) for mergeBlockSource {0}: {1}",qa[Ya],Oa[Yb]),
this.$d.logger.Rg(Object.assign(new ia.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v4"}))),{returnValue:!1,Au:Fb};this.p3=!1}Ya="";Fb=new k.a;for(--$b;$b>=qc;$b--)if(6!==this.Pe.J($b).type)if(this.Pe.J($b).Lm)Ya=this.Pe.J($b).text+Ya,this.Pe.zG($b);else{if(5===this.Pe.J($b).type)Yb=Ub-Ya.length;else if(2===this.Pe.J($b).type){if(Yb=0,!({length:Ub}=ba(this.Pe,this.Pe.J($b).Pj)).returnValue)return a.a.instance.Ua(589603462,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetTextLengthForParaId failed"),
this.$d.logger.Rg(Object.assign(new ia.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkg"})),{returnValue:!1,Au:Fb}}else return a.a.instance.Ua(589898051,1,2,"ApplyDeleteTextHintToBaseAndDerived: Unexpected block type missing twin"),this.$d.logger.Rg(Object.assign(new ia.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9ksfd"})),{returnValue:!1,Au:Fb};if(!({qha:mc}=Q(this.Pe,$b+1)).returnValue)return a.a.instance.Ua(589603463,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),
this.$d.logger.Rg(Object.assign(new ia.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkh"})),{returnValue:!1,Au:Fb};var mc=this.Pe.J(mc).Pj;Fb.add(new Pa.DeleteTextUpdateHint(mc,Yb,Ya));Ya=""}for(--Hc;Hc>=Wa;Hc--)this.base.zG(Hc);if(!({qha:mc}=Q(this.Pe,qc)).returnValue)return a.a.instance.Ua(589603464,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.$d.logger.Rg(Object.assign(new ia.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9jkki"})),{returnValue:!1,Au:Fb};mc=
this.Pe.J(mc).Pj;Ya&&Ya.length&&Fb.add(new Pa.DeleteTextUpdateHint(mc,yb,Ya,Ua.id,Ua.Ou));return{returnValue:!0,Au:Fb}}aGk(Ua,Ya){var Fb=null;let Wa,yb,Yb;var qc=({tAf:Wa,cqi:yb,Wga:Yb}=this.Qai(Ua,Ya,!0)).returnValue;if(0!==qc)return 3!==qc&&(a.a.instance.Ua(590202207,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToBaseAndDerived for mergeBlockSource {0}: {1}",qa[Ya],Oa[qc]),this.$d.logger.Rg(Object.assign(new ia.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v5"}))),
{returnValue:!1,Au:Fb};var Hc;if(!({qha:Hc}=Q(this.Pe,yb)).returnValue)return a.a.instance.Ua(17342618,1,2,"ApplySplitParaHintToBaseAndDerived: Could not find corrsponding block in derived list."),{returnValue:!1,Au:Fb};qc=this.Pe.J(Hc).Pj;const $b=this.Pe.J(Hc).Wc;let Ub,mc,ic;({hu:Hc,f8:Ub,Aua:mc,Hba:ic}=this.a6l(Ua,Hc));this.$Ch(this.Pe,Hc,Ub,ic,yb);Fb=new G.a(Ya,Ua.hu,Ua.Aua);Ya=new G.a(Ya,Hc,mc);Fb.Lm=Ya;Ya.Lm=Fb;this.base.insert(Wa,Fb);this.Pe.insert(yb,Ya);Fb=new k.a;Fb.add(new ta.a(qc,$b,
Yb,Hc,mc,Ub,ic,Ua.id,Ua.Ou));return{returnValue:!0,Au:Fb}}vFk(Ua){let Ya;Ya=null;let Fb,Wa;var yb;if(!({cXd:Fb}=this.Rai(Ua,this.base,"Base")).returnValue)return{returnValue:!1,Au:Ya};if(!this.base.J(Fb).Lm||!({qha:Wa}=Y(this.Pe,this.base.J(Fb).Lm.Pj,0)).returnValue)return a.a.instance.Ua(17342619,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.$d.logger.Rg(Object.assign(new ia.a,{yj:"ParagraphMergeUsingHintsTwinList",
eventId:"bckc1"})),this.p3=!0,{returnValue:!1,Au:Ya};if(!({qha:yb}=Q(this.Pe,Wa+1)).returnValue)return a.a.instance.Ua(17342620,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation as the below para on derived after merge is null"),this.$d.logger.Rg(Object.assign(new ia.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc2"})),this.p3=!0,{returnValue:!1,Au:Ya};let Yb,qc,Hc,$b,Ub,mc;({L5a:yb,M5a:Hc,vTf:Yb,$gn:$b,Jgn:qc,Kgn:Ub}=this.DUl(Ua,Wa,yb));if(!({length:mc}=ba(this.Pe,yb)).returnValue)return{returnValue:!1,
Au:Ya};this.ZCh(this.Pe,yb,Hc,Wa);this.Pe.zG(Wa);this.base.zG(Fb);Ya=new k.a;Ya.add(new Ga.MergeParagraphUpdateHint(Yb,$b,mc,qc,Ub,yb,Hc,Ua.id,Ua.Ou));return{returnValue:!0,Au:Ya}}tEk(Ua,Ya){var Fb=null;let Wa,yb,Yb;if(!({DPf:Yb,sAf:Wa}=this.Cci(Ua,!0,Ya)).returnValue)return{returnValue:!1,Au:Fb};if(!({lkb:yb}=this.WQc(this.base,this.Pe,Wa,!0)).returnValue)return a.a.instance.Ua(17146332,1,2,"ApplyAddParaHintToBaseAndDerived: We could not find the corresponding index in the Derived list."),{returnValue:!1,
Au:Fb};if(0<yb&&2!==this.Pe.J(yb-1).type)return a.a.instance.Ua(17342621,1,2,"ApplyAddParaHintToBaseAndDerived: We cannot insert a new para in a middle of an existing para"),this.$d.logger.Rg(Object.assign(new ia.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"bckc3"})),this.p3=!0,{returnValue:!1,Au:Fb};let qc;if(!({hu:qc}=this.H4h(yb)).returnValue)return{returnValue:!1,Au:Fb};Ya=new G.a(Ya,Ua.Bg,Ua.Wc);Fb=Yb;Fb.Lm=Ya;Ya.Lm=Fb;this.base.insert(Wa,Yb);this.Pe.insert(yb,Ya);Fb=new k.a;Fb.add(new sa.AddParagraphUpdateHint(Ua.Bg,
Ua.Wc,qc,Ua.id,Ua.Ou));return{returnValue:!0,Au:Fb}}j2e(Ua){let Ya;Ya=null;let Fb;var Wa;if(!({bXd:Wa}=this.Iai(Ua,this.base,"Base")).returnValue)return{returnValue:!1,Au:Ya};if(!this.base.J(Wa).Lm||!this.base.J(Wa).Lm.Pj.equals(Ua.Bg))return a.a.instance.Ua(17135243,1,2,"ApplyDeleteParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.$d.logger.Rg(Object.assign(new ia.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0l"})),this.p3=
!0,{returnValue:!1,Au:Ya};if(!({lkb:Fb}=this.WQc(this.base,this.Pe,Wa,!0)).returnValue)return a.a.instance.Ua(17135244,1,2,"ApplyDeleteParaHintToBaseAndDerived: Possibly bad merge hints provided"),{returnValue:!1,Au:Ya};if(0<Fb&&2!==this.Pe.J(Fb).type)return a.a.instance.Ua(17135245,1,2,"ApplyDeleteParaHintToBaseAndDerived: Detected new or leftover content in the list"),this.$d.logger.Rg(Object.assign(new ia.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0n"})),this.p3=!0,{returnValue:!1,Au:Ya};
const yb=this.Pe.J(Fb).Pj,Yb=this.Pe.J(Fb).Wc;this.Pe.zG(Fb);this.base.zG(Wa);({hu:Wa}=this.H4h(Fb));0<Fb&&6===this.Pe.J(Fb-1).type&&this.kFn(Fb-1,Wa);Ya=new k.a;Ya.add(new Da.a(yb,Yb,Wa,Ua.id,Ua.Ou));return{returnValue:!0,Au:Ya}}Kuh(Ua,Ya,Fb){let Wa;var yb=({gia:Ya,pxa:Wa}=this.fJa(Ua,Fb,!0,Ya,!0,"ApplyInsertCpPlaceHolderHintToBaseAndDerived")).returnValue;if(0!==yb)return 3!==yb&&(a.a.instance.Ua(590202208,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToBaseAndDerived for mergeBlockSource {0}: {1}",
qa[Fb],Oa[yb]),this.$d.logger.Rg(Object.assign(new ia.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v6"}))),!1;({qha:yb}=Q(this.Pe,Wa));yb=this.Pe.J(yb).Pj;Ua=new za(Fb,Ua);Fb=new za(Fb,yb);Ua.Lm=Fb;Fb.Lm=Ua;this.base.insert(Ya,Ua);this.Pe.insert(Wa,Fb);return!0}DUl(Ua,Ya,Fb){let Wa,yb,Yb;Wa=Ua.L5a.equals(Ua.Bg)?this.Pe.J(Ya).Pj:this.Pe.J(Fb).Pj;Ua=Ua.M5a===Ua.Wc?this.Pe.J(Ya).Wc:this.Pe.J(Fb).Wc;yb=this.Pe.J(Ya).Pj;Ya=this.Pe.J(Ya).Wc;Yb=this.Pe.J(Fb).Pj;Fb=this.Pe.J(Fb).Wc;return{L5a:Wa,
M5a:Ua,vTf:yb,$gn:Ya,Jgn:Yb,Kgn:Fb}}a6l(Ua,Ya){let Fb;var Wa=Ua.Bg.equals(Ua.hu)?Ua.f8:Ua.hu;const yb=Ua.Wc===Ua.Aua?Ua.Hba:Ua.Aua;Ua.Bg.equals(Ua.hu)?Fb=this.Pe.J(Ya).Pj:(Fb=Wa,Wa=this.Pe.J(Ya).Pj);Ua.Wc===Ua.Aua?(Ua=this.Pe.J(Ya).Wc,Ya=yb):(Ua=yb,Ya=this.Pe.J(Ya).Wc);return{hu:Fb,f8:Wa,Aua:Ua,Hba:Ya}}aDh(Ua,Ya,Fb,Wa){for(;Wa<Ua.length;Wa++){if(!Ua.J(Wa).b5()&&6!==Ua.J(Wa).type&&2!==Ua.J(Wa).type){a.a.instance.shipAssertTag(17311188,1,!1,"Found merge block of type "+Ua.J(Wa).type);break}Ua.J(Wa).Pj=
Ya;if(2===Ua.J(Wa).type){Ua.J(Wa).Wc=Fb;break}}}$Ch(Ua,Ya,Fb,Wa,yb){this.aDh(Ua,Fb,Wa,yb);Ka.bDh(Ua,Ya,yb)}ZCh(Ua,Ya,Fb,Wa){this.aDh(Ua,Ya,Fb,Wa+1);Ka.bDh(Ua,Ya,Wa)}Rai(Ua,Ya,Fb){let Wa,yb=-1;if(!({qha:Wa}=Y(Ya,Ua.Bg,0)).returnValue)return a.a.instance.Ua(17342622,1,2,"GetIndicesForMergePara: Failed to find index of EOP in "+Fb+"for GraphNodeId "+Ua.Bg),{returnValue:!1,cXd:Wa};if(!({qha:yb}=Q(Ya,Wa+1)).returnValue||!Ya.J(yb).Pj.equals(Ua.f8))return a.a.instance.Ua(17342623,1,2,"GetIndicesForMergePara: Failed to find index "+
Wa+1+" in "+Fb+" of length "+Ya.length),{returnValue:!1,cXd:Wa};this.ZCh(Ya,Ua.L5a,Ua.M5a,Wa);return{returnValue:!0,cXd:Wa}}Qai(Ua,Ya,Fb){let Wa;const yb=Fb?this.base:this.Pe,Yb=Fb?"Base":"Derived",qc=({gia:Ya,pxa:Fb,Wga:Wa}=this.fJa(Ua.Bg,Ya,Fb,Ua.cp,!1,"GetIndicesAndCpForSplitPara")).returnValue;if(3===qc||2===qc)return a.a.instance.Ua(17311189,1,2,"GetIndicesAndCpForSplitPara: Failed to find indices and Cp for "+Yb),{returnValue:qc,tAf:Ya,cqi:Fb,Wga:Wa};this.$Ch(yb,Ua.hu,Ua.f8,Ua.Hba,Ya);return{returnValue:qc,
tAf:Ya,cqi:Fb,Wga:Wa}}Iai(Ua,Ya,Fb){return({idx:Ua}=V(Ya,Ua.Bg)).returnValue?2!==Ya.J(Ua).type?(a.a.instance.Ua(17156034,1,2,"GetIndexForDeletePara: Found merge block that is not a zero length merge block "+Fb),{returnValue:!1,bXd:-1}):{returnValue:!0,bXd:Ua}:(a.a.instance.Ua(17156033,1,2,"GetIndexForDeletePara: Failed to find the para in "+Fb),{returnValue:!1,bXd:-1})}kFn(Ua,Ya){var Fb=this.Pe.J(Ua);if(Ya){let Wa;({qha:Wa}=Y(this.Pe,Ya,0));Fb=Fb.clone();Fb.Pj=Ya;this.Pe.zG(Ua);this.Pe.insert(Wa,
Fb)}else this.Pe.length>Ua&&(this.Pe.J(Ua+1).b5()||2===this.Pe.J(Ua+1).type)&&(Fb.Pj=this.Pe.J(Ua+1).Pj)}Cci(Ua,Ya,Fb){var Wa=Ya?this.base:this.Pe;Ya=Ya?"Base":"Derived";Fb=new G.a(Fb,Ua.Bg,Ua.Wc);if(Ua.hu){if(!({qha:Wa}=Y(Wa,Ua.hu,0)).returnValue)return a.a.instance.Ua(17146333,1,2,"GetMergeBlockAndIndexToInsertForAddPara: We could not find [AboveParaId: {0}] in {1}",Ua.hu,Ya),{returnValue:!1,DPf:Fb,sAf:Wa};Wa+=1}else Wa=0;return{returnValue:!0,DPf:Fb,sAf:Wa}}H4h(Ua){let Ya;Ya=null;let Fb=Ua-1;if(-1===
Fb)return{returnValue:!0,hu:Ya};6===this.Pe.J(Fb).type&&Fb--;if(2===this.Pe.J(Fb).type||4===this.Pe.J(Fb).type)return Ya=this.Pe.J(Fb).Pj,{returnValue:!0,hu:Ya};a.a.instance.Ua(17342934,1,2,"GetAboveParaIdFromDerived: We found an unexpected block [Type: {0}] above",this.Pe.J(Ua-1).type);return{returnValue:!1,hu:Ya}}WQc(Ua,Ya,Fb,Wa){let yb,Yb=!0;yb=-1;if(Fb>Ua.length)return a.a.instance.Ua(17146334,1,2,"GetIndexInSecondary: Index supplied for the primary is out of bounds"),{returnValue:!1,lkb:yb};
if(Fb<Ua.length){if(-1<Fb&&Fb<Ua.length&&!Ua.J(Fb).Lm){Yb=!1;for(var qc=Fb+1;qc<Ua.length;qc++)if(Ua.J(qc).Lm){Fb=qc;Yb=!0;break}}if(!Yb)return{returnValue:!1,lkb:yb};Yb=!1;for(qc=0;Ua.J(Fb)&&qc<Ya.length;qc++)if(Ya.J(qc).Lm===Ua.J(Fb)){yb=qc;Yb=!0;break}if(!Yb)return{returnValue:!1,lkb:yb}}else yb=Ya.length;if(0<yb&&Wa&&!Ya.J(yb-1).Lm){for(Ua=yb-1;0<=Ua&&!Ya.J(Ua).Lm;Ua--);yb=Ua+1;6===Ya.J(yb).type&&5!==this.$d.input.source&&yb++}return{returnValue:!0,lkb:yb}}fJa(Ua,Ya,Fb,Wa,yb,Yb){let qc;var Hc;
let $b;var Ub=this.base;let mc=this.Pe,ic=!1;Fb||(Ub=this.Pe,mc=this.base);$b=Hc=qc=0;let ab,bb,Jb=0;if(!({ASc:Wa,enb:ab,h1c:bb}=R(Ub,Ua,Wa)).returnValue)return a.a.instance.Ua(17044295,1,2,"SplitTwinListAtCpForHint: Unable to find the merge block to split at given Cp. It most likely means that our update hints are not complete"),{returnValue:3,gia:qc,pxa:Hc,Wga:$b};0<=Wa&&Wa<Ub.length&&!Ub.J(Wa).Lm&&ab&&!yb&&(a.a.instance.Ua(17044296,1,4,"SplitTwinListAtCpForHint: We are trying to split a merge block that is deleted in the other revision. Failing merge. Called from {0}",
Yb),this.p3=!0,Jb=Ya===Ub.J(Wa).source?1:2,ic=!0);yb&&!Ub.J(Wa)&&Wa--;yb&&ab&&!Ub.J(Wa).Lm&&(ab=!1,bb=0);if(!Fb&&!({idx:Ua}=V(mc,Ua)).returnValue&&!ab)return{returnValue:0,gia:Wa,pxa:Hc,Wga:$b};if(!({lkb:Ua}=this.WQc(Ub,mc,Wa,Fb&&!ab)).returnValue&&!ic&&(Ya=!1,1===this.Pkh&&0<Wa&&!bb&&(Wa--,{lkb:Ua,returnValue:Ya}=this.WQc(Ub,mc,Wa,Fb&&!ab),Ya&&(Wa++,Ua<mc.length-1?Ua++:Ya=!1)),!Ya))return a.a.instance.Ua(17156037,1,2,"SplitTwinListAtCpForHint: We are trying to find index in derived when the para most likley doesn't exist."),
this.$d.logger.Rg(Object.assign(new ia.a,{yj:"ParagraphMergeUsingHintsTwinList",eventId:"bb25f"})),this.p3=!0,{returnValue:3,gia:qc,pxa:Hc,Wga:$b};if(ab&&(!N(Ub,Wa,bb)||!ic&&!N(mc,Ua,bb)))return a.a.instance.shipAssertTag(17044297,1,!1,"SplitTwinListAtCpForHint: Unable find the twin in secondary or unable to split the lists when a split was needed"),{returnValue:3,gia:qc,pxa:Hc,Wga:$b};qc=Wa;Hc=Ua;ab&&(qc=Wa+1,ic||(Hc=Ub.J(Wa),Fb=mc.J(Ua),Hc.Lm=Fb,Fb.Lm=Hc,Ub=Ub.J(Wa+1),Hc=mc.J(Ua+1),Ub.Lm=Hc,Hc.Lm=
Ub,Hc=Ua+1));if(Hc>=mc.length)return a.a.instance.shipAssertTag(17311190,1,!1,"SplitTwinListAtCpForHint: We are in bad state. indexInSecondary was "+Hc+" secondaryList length was "+mc.length),{returnValue:3,gia:qc,pxa:Hc,Wga:$b};for(Ub=0;Ub<Hc;Ub++)mc.J(Ub).Pj.equals(mc.J(Hc).Pj)&&($b+=mc.J(Ub).length);return{returnValue:Jb,gia:qc,pxa:Hc,Wga:$b}}sef(Ua,Ya,Fb){this.fOg.contains(Ua.id)&&this.sdb.Z(Ua.id,new k.a);for(--Fb;Fb>=Ya;Fb--)this.fOg.contains(Ua.id)?this.sdb.J(Ua.id).insert(this.sdb.J(Ua.id).length,
this.Pe.J(Fb)):this.Pe.J(Fb).Lm&&(this.Pe.J(Fb).Lm.Lm=null),this.Pe.zG(Fb)}cCf(Ua,Ya,Fb){if(this.sdb.nb(Ua.Ou)){const Wa=this.sdb.J(Ua.Ou);for(let yb=0;yb<Wa.length;yb++)Wa.J(yb).Pj=Fb.Pj,Object(ua.a)(G.a,Fb)&&Object(ua.a)(G.a,Wa.J(yb))&&(Wa.J(yb).Wc=Fb.Wc);this.Pe.aD(Ya,this.sdb.J(Ua.Ou));this.sdb.remove(Ua.Ou)}else this.Pe.insert(Ya,Fb)}kjm(Ua){let Ya,Fb;Fb=Ya=-1;if(!Ua.Lm)return{returnValue:!1,P6b:Ya,Nef:Fb};var Wa;let yb=0,Yb=!1;if(!({idx:Wa}=V(this.Pe,Ua.Lm.Pj)).returnValue)return{returnValue:!1,
P6b:Ya,Nef:Fb};for(;Wa<this.Pe.length;Wa++){if(Ua.Lm===this.Pe.J(Wa)){Ya=Wa;Fb=yb;Yb=!0;break}yb+=this.Pe.J(Wa).length}return{returnValue:Yb,P6b:Ya,Nef:Fb}}Zkf(Ua){let Ya;Ya=new k.a;let Fb=0,Wa=0;for(;Fb<Ua.length;){if(Wa>=this.base.length)return a.a.instance.shipAssertTag(17335388,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),{returnValue:!1,Boc:Ya};if(Ua.J(Fb).length>this.base.J(Wa).length){if(!N(Ua,Fb,this.base.J(Wa).length))return a.a.instance.Ua(17335389,1,
2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision MergeBlock [Idx: {0}] at [Cp: {1}]",Fb,this.base.J(Wa).length),{returnValue:!1,Boc:Ya}}else if(Ua.J(Fb).length<this.base.J(Wa).length){var yb=!!this.base.J(Wa).Lm,Yb=0;if(yb&&!({lkb:Yb}=this.WQc(this.base,this.Pe,Wa,!1)).returnValue)return a.a.instance.shipAssertTag(17335390,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Base Merge Block at [Idx: {0}] has a Twin, but we are unable to find it",Wa),
{returnValue:!1,Boc:Ya};if(!N(this.base,Wa,Ua.J(Fb).length)||yb&&!N(this.Pe,Yb,Ua.J(Fb).length))return a.a.instance.Ua(17335391,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split Base and/or Derived Merge blocks"),{returnValue:!1,Boc:Ya};if(yb){yb=this.base.J(Wa);var qc=this.Pe.J(Yb);yb.Lm=qc;qc.Lm=yb;yb=this.base.J(Wa+1);Yb=this.Pe.J(Yb+1);yb.Lm=Yb;Yb.Lm=yb}}if(this.base.J(Wa).Lm&&5!==this.base.J(Wa).type&&this.base.J(Wa).b5()&&(Yb=this.base.J(Wa),yb=Ua.J(Fb),!Yb.wJ.equals(yb.wJ)||
!Yb.KF.JA(yb.KF))){let Hc;if(!({P6b:qc,Nef:Hc}=this.kjm(this.base.J(Wa))).returnValue)return{returnValue:!1,Boc:Ya};Ya.add(new pa(this.Pe.J(qc).Pj,Hc,Yb,yb))}Fb++;Wa++}return{returnValue:!0,Boc:Ya}}static bDh(Ua,Ya,Fb){for(--Fb;0<=Fb;Fb--){if(!Ua.J(Fb).b5()&&6!==Ua.J(Fb).type){a.a.instance.shipAssertTag(17311187,1,2===Ua.J(Fb).type||4===Ua.J(Fb).type,"Found merge block of type "+Ua.J(Fb).type);break}Ua.J(Fb).Pj=Ya}}static Rxi(Ua){return Ua?!1:(a.a.instance.Ua(17156036,1,2,"IsEmptyRunUpdateHint: We are trying to insert an empty run. It is likely we have bad merge hints."),
!0)}}Object(D.a)(Ka,"ParagraphMergeUsingHintsTwinList",null,[2015]);var lb=c(1748),Xa=c(1749),kb=c(1745),Bb=c(1747),Ja=c(1746);class Ma{constructor(Ua,Ya,Fb,Wa){this.cp=Ua;this.length=Ya;this.aEd=Fb;this.Sdd=Wa}}Object(D.a)(Ma,"UpdateFormattingIdsPosInfo",null,[]);class fb{constructor(Ua,Ya,Fb){this.p3=!1;this.sdb=new y.a;this.o7g=!1;this.$d=Ua;this.Pkh=Fb;this._base=Ya;this.Hye=Z(Ya);if(!L(this.base,this.Pe))throw a.a.instance.Ua(574133956,1,2,"LcsTwinList ConnectList: Length not equal"),Ua.logger.Rg(Object.assign(new K.a,
{info:"LcsTwinList ConnectList: Length not equal"})),Error.create("ConnectList");this.$d.runtime.Zb.Jjb(1000010)&&(this.o7g=!0)}get base(){return this._base}get Pe(){return this.Hye}get mergeConflict(){return this.p3}N2e(Ua,Ya){switch(Ua.type){case 11:return this.bFk(Ua,Ya);case 8:return this.m2e(Ua,Ya);case 10:return this.k2e(Ua);default:return!1}}M2e(Ua,Ya){switch(Ua.type){case 11:return this.aFk(Ua,Ya);case 8:return this.l2e(Ua,Ya);case 10:return this.j2e(Ua);default:return{returnValue:!1,Au:null}}}Luh(){a.a.instance.Ua(574433295,
1,2,"ApplyInsertCpPlaceHolderHintToDerived not implemented");this.$d.logger.Rg(Object.assign(new K.a,{yj:"ApplyInsertCpPlaceHolderHintToDerived",eventId:"8ps6p"}));return!1}Kuh(){a.a.instance.Ua(574433296,1,2,"ApplyInsertCpPlaceHolderHintToBaseAndDerived not implemented");this.$d.logger.Rg(Object.assign(new K.a,{yj:"ApplyInsertCpPlaceHolderHintToBaseAndDerived",eventId:"8ps6q"}));return!1}Zkf(Ua){let Ya;Ya=new k.a;let Fb=0,Wa=0,yb=0;for(;Fb<Ua.length;){if(Wa>=this.base.length)return a.a.instance.shipAssertTag(574433297,
1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),this.$d.logger.Rg(Object.assign(new K.a,{yj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6r"})),{returnValue:!1,Rdd:Ya};if(Ua.J(Fb).length>this.base.J(Wa).length){if(!N(Ua,Fb,this.base.J(Wa).length))return a.a.instance.Ua(574433298,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision"),this.$d.logger.Rg(Object.assign(new K.a,{yj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",
eventId:"8ps6s"})),{returnValue:!1,Rdd:Ya}}else if(Ua.J(Fb).length<this.base.J(Wa).length&&!this.v8a(yb+Ua.J(Fb).length,!0).returnValue)return a.a.instance.Ua(574433299,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split"),this.$d.logger.Rg(Object.assign(new K.a,{yj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6t"})),{returnValue:!1,Rdd:Ya};if(this.base.J(Wa).Lm&&5!==this.base.J(Wa).type&&this.base.J(Wa).b5()){const Yb=this.base.J(Wa),qc=Ua.J(Fb);if(!Yb.wJ.equals(qc.wJ)||
!Yb.KF.JA(qc.KF)){let Hc,$b;if(({P6b:Hc,TRh:$b}=this.ljm(this.base.J(Wa))).returnValue)Ya.add(new Ma($b,this.Pe.J(Hc).length,Yb,qc));else return a.a.instance.Ua(571757956,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Enable to find unfavored formatting"),this.$d.logger.Rg(Object.assign(new K.a,{yj:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ffwe"})),{returnValue:!1,Rdd:Ya}}}yb+=this.base.J(Wa).length;Fb++;Wa++}return{returnValue:!0,Rdd:Ya}}bFk(Ua,Ya){let Fb;if(!({CEa:Fb}=
this.v8a(Ua.cp,!0)).returnValue)return a.a.instance.Ua(574433300,1,2,"ApplyInsertTextHintToDerived"),this.$d.logger.Rg(Object.assign(new K.a,{yj:"ApplyInsertTextHintToDerived",eventId:"8ps6u"})),!1;for(let yb=0;yb<Ua.y0.length;yb++)switch(Ua.y0.J(yb).type){case 7:var Wa=Ua.y0.J(yb);this.Pe.insert(Fb,new fa(Ya,null,Wa.text,Wa.id));break;case 9:Wa=Ua.y0.J(yb);this.Pe.insert(Fb,new G.a(Ya,Wa.Bg,Wa.Wc));break;default:return a.a.instance.Ua(574433301,1,2,"ApplyInsertHintToDerived invalid hint"),this.$d.logger.Rg(Object.assign(new K.a,
{yj:"ApplyInsertHintToDerived",eventId:"8ps6v"})),!1}return!0}m2e(Ua,Ya){let Fb,Wa;if(!({CEa:Fb}=this.v8a(Ua.cp,!0)).returnValue||!({CEa:Wa}=this.v8a(Ua.cp+Ua.text.length,!1)).returnValue)return a.a.instance.Ua(575706433,1,2,"ApplyDeleteTextHintToDerived"),this.$d.logger.Rg(Object.assign(new K.a,{yj:"ApplyDeleteTextHintToDerived",eventId:"8ujvb"})),!1;for(Ua=Wa;Ua>=Fb;Ua--)this.Pe.J(Ua).source!==Ya&&this.MKd(this.Pe,Ua);return!0}k2e(Ua){let Ya;if(!({CEa:Ya}=this.v8a(Ua.cp,!0)).returnValue)return a.a.instance.Ua(574433302,
1,2,"ApplyDeleteParaHintToDerived"),this.$d.logger.Rg(Object.assign(new K.a,{yj:"ApplyDeleteParaHintToDerived",eventId:"8ps6w"})),!1;this.vef(this.Pe,Ua,Ya);return!0}aFk(Ua,Ya){let Fb;Fb=null;let Wa,yb;if(!({tBb:Wa,CEa:yb}=this.v8a(Ua.cp,!0)).returnValue)return a.a.instance.Ua(574433303,1,2,"ApplyInsertTextHintToBaseAndDerived unable to split"),this.$d.logger.Rg(Object.assign(new K.a,{yj:"ApplyInsertTextHintToBaseAndDerived",eventId:"8ps6x"})),{returnValue:!1,Au:Fb};var Yb=this.Gpf(this.Pe,yb-1);
Yb=new Ja.a(Yb);for(let qc=0;qc<Ua.y0.length;qc++)switch(Ua.y0.J(qc).type){case 7:Yb.y0.add(this.q2e(Ua.y0.J(qc),Ya,Wa,yb));break;case 9:Yb.y0.add(this.cFk(Ua.y0.J(qc),Ya,Wa,yb));break;default:return a.a.instance.Ua(574433304,1,2,"ApplyInsertHintToDerived invalid hint"),this.$d.logger.Rg(Object.assign(new K.a,{yj:"ApplyInsertHintToDerived",eventId:"8ps6y"})),{returnValue:!1,Au:Fb}}Fb=new k.a;Fb.add(Yb);return{returnValue:!0,Au:Fb}}q2e(Ua,Ya,Fb,Wa){const yb=new fa(Ya,Ua.Bg,Ua.text,Ua.id);Ya=new fa(Ya,
Ua.Bg,Ua.text,Ua.id);yb.Lm=Ya;Ya.Lm=yb;this.base.insert(Fb,yb);this.Pe.insert(Wa,Ya);Fb=new Bb.a(Ua.Bg,Ua.text);Fb.id=Ua.id;return Fb}cFk(Ua,Ya,Fb,Wa){const yb=new G.a(Ya,Ua.Bg,Ua.Wc);Ya=new G.a(Ya,Ua.Bg,Ua.Wc);yb.Lm=Ya;Ya.Lm=yb;this.base.insert(Fb,yb);this.Pe.insert(Wa,Ya);return new kb.a(Ua.Bg,Ua.Wc)}l2e(Ua){let Ya;Ya=new k.a;let Fb;var Wa;let yb;if(!({tBb:Fb,CEa:Wa}=this.v8a(Ua.cp,!0)).returnValue||!({tBb:yb,CEa:Yb}=this.v8a(Ua.cp+Ua.text.length,!1)).returnValue)return a.a.instance.Ua(588001990,
1,2,"ApplyDeleteTextHintToBaseAndDerived"),this.$d.logger.Rg(Object.assign(new K.a,{yj:"ApplyDeleteTextHintToBaseAndDerived",eventId:"9ddlg"})),{returnValue:!1,Au:Ya};this.$d.runtime.Zb.HVd(1000010);for(Ua=Yb;Ua>=Wa;Ua--)if(this.Pe.J(Ua).Lm){var Yb=Ua;const qc=({qTf:Ua}=this.MDl(Ua,Wa)).returnValue;qc&&(Ya.add(qc),this.MKd(this.Pe,Ua,Yb))}for(Wa=yb;Wa>=Fb;Wa--)this.MKd(this.base,Wa);return{returnValue:!0,Au:Ya}}j2e(Ua){let Ya;Ya=null;let Fb,Wa;if(!({tBb:Fb,CEa:Wa}=this.v8a(Ua.cp,!0)).returnValue)return a.a.instance.Ua(574433305,
1,2,"ApplyDeleteParaHintToBaseAndDerived"),this.$d.logger.Rg(Object.assign(new K.a,{yj:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps6z"})),{returnValue:!1,Au:Ya};if(!this.vef(this.base,Ua,Fb))return a.a.instance.Ua(574433306,1,2,"ApplyDeleteParaHintToBaseAndDerived EOP mismatch"),this.$d.logger.Rg(Object.assign(new K.a,{yj:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps60"})),{returnValue:!1,Au:Ya};this.vef(this.Pe,Ua,Wa)&&(Ya=new k.a,Ya.add(new lb.a(this.Gpf(this.Pe,Wa-1),Ua.Bg,Ua.Wc)));
return{returnValue:!0,Au:Ya}}v8a(Ua,Ya){var Fb;var Wa=Fb=-1;let yb,Yb;if(!({enb:Yb,uxh:Ua,txh:yb}=S(this.base,Ua,this.$d.logger)).returnValue)return{returnValue:!1,tBb:Fb,CEa:Wa};const qc=Ua>=this.base.length;qc&&Ua--;if(this.base.J(Ua).Lm){const Hc=this.jFl(this.Pe,this.base.J(Ua));if(Yb){if(0>Hc||!N(this.base,Ua,yb)||!N(this.Pe,Hc,yb))return a.a.instance.Ua(575706444,1,2,"SplitTwinListAndFindIdx"),this.$d.logger.Rg(Object.assign(new K.a,{yj:"SplitTwinListAndFindIdx",eventId:"8ujvm"})),{returnValue:!1,
tBb:Fb,CEa:Wa};Fb=this.base.J(Ua);Wa=this.Pe.J(Hc);Fb.Lm=Wa;Wa.Lm=Fb;Fb=this.base.J(Ua+1);Wa=this.Pe.J(Hc+1);Fb.Lm=Wa;Wa.Lm=Fb;Fb=Ya?Ua+1:Ua;Wa=Ya?Hc+1:Hc}else Ya?(Fb=qc?Ua+1:Ua,Wa=qc?Hc+1:Hc):(Fb=qc?Ua:Ua-1,Wa=qc?Hc:Hc-1)}else if(Yb){if(N(this.base,Ua,yb))Fb=Ya?Ua+1:Ua;else return a.a.instance.Ua(575706445,1,2,"SplitTwinListAndFindIdx"),this.$d.logger.Rg(Object.assign(new K.a,{yj:"SplitTwinListAndFindIdx",eventId:"8ujvn"})),{returnValue:!1,tBb:Fb,CEa:Wa};Ya?(Wa=({hIb:Wa}=this.A8b(this.base,this.Pe,
Ua,!1)).returnValue?Wa+1:0,Wa=Wa>=this.Pe.length?this.Pe.length-1:Wa):(Wa=({hIb:Wa}=this.A8b(this.base,this.Pe,Ua,!0)).returnValue?Wa-1:this.Pe.length-1,Wa=0>Wa?0:Wa)}else Ya?(({hIb:Wa}=this.A8b(this.base,this.Pe,Ua,!0)).returnValue||(({hIb:Wa}=this.A8b(this.base,this.Pe,Ua,!1)).returnValue?Wa+=1:(Wa=qc?this.Pe.length-1:0,Wa=0>Wa?0:Wa)),Fb=qc?Ua+1:Ua):(({hIb:Wa}=this.A8b(this.base,this.Pe,Ua,!1)).returnValue||(({hIb:Wa}=this.A8b(this.base,this.Pe,Ua,!0)).returnValue?--Wa:(Wa=Ua?this.Pe.length-1:0,
Wa=0>Wa?0:Wa)),Fb=qc?Ua:Ua-1);return{returnValue:!0,tBb:Fb,CEa:Wa}}A8b(Ua,Ya,Fb,Wa){let yb=null;if(Wa)for(;Fb<Ua.length;Fb++){if(Ua.J(Fb).Lm){yb=Ua.J(Fb).Lm;break}}else for(;0<=Fb;Fb--)if(Ua.J(Fb).Lm){yb=Ua.J(Fb).Lm;break}if(yb)for(Ua=0;Ua<Ya.length;Ua++)if(Ya.J(Ua)===yb)return Ya=Ua,{returnValue:!0,hIb:Ya};return{returnValue:!1,hIb:-1}}jFl(Ua,Ya){for(let Fb=0;Fb<Ua.length;Fb++)if(Ua.J(Fb).Lm===Ya)return Fb;return-1}MKd(Ua,Ya,Fb=-1){for(Fb=0>Fb?Ya:Fb;Fb>=Ya;Fb--)Ua.J(Fb).Lm&&(Ua.J(Fb).Lm.Lm=null),
Ua.zG(Fb)}Gpf(Ua,Ya){let Fb=0;for(;0<=Ya;Ya--)Fb+=Ua.J(Ya).length;return Fb}Ghm(Ua){Ua=Object(m.a)(xa.a,Ua);Ua||(a.a.instance.Ua(575706448,1,2,"GetTextBlock"),this.$d.logger.Rg(Object.assign(new K.a,{yj:"GetTextBlock",eventId:"8ujvq"})));return Ua}MDl(Ua,Ya){let Fb="",Wa=Ua;for(;Wa>=Ya&&this.Pe.J(Wa).Lm&&2!==this.Pe.J(Wa).type;)Fb=this.Ghm(this.Pe.J(Wa)).text+Fb,Wa--;Ya=0>Wa?0:this.Gpf(this.Pe,Wa);return!this.o7g||Wa<Ua?(Ua=Wa+1,{returnValue:new Xa.a(Ya,Fb),qTf:Ua}):{returnValue:null,qTf:Wa}}ljm(Ua){let Ya,
Fb,Wa=!1;Fb=Ya=0;if(!Ua.Lm)return{returnValue:!1,P6b:Ya,TRh:Fb};for(Ya=0;Ya<this.Pe.length;Ya++){if(this.Pe.J(Ya).Lm===Ua){Wa=!0;break}Fb+=this.Pe.J(Ya).length}return{returnValue:Wa,P6b:Ya,TRh:Fb}}vef(Ua,Ya,Fb){Fb=Fb===Ua.length?--Fb:Fb;Fb>Ua.length-1&&(a.a.instance.Ua(571757957,1,2,"DeleteEopInList: Idx out of range"),this.$d.logger.Rg(Object.assign(new K.a,{yj:"DeleteEopInList",eventId:"8ffwf"})));if(2===Ua.J(Fb).type){const Wa=Ua.J(Fb);if(Wa.Pj!==Ya.Bg||Wa.Wc!==Ya.Wc)return!1;this.MKd(Ua,Fb);return!0}return!1}}
Object(D.a)(fb,"ParagraphMergeUsingHintsTwinListLcs",null,[2015]);var hc=c(1591),cc=c(1558),mb=c(1744);c.d(I,"a",function(){return Hb});class Hb{constructor(Ua,Ya,Fb,Wa,yb,Yb,qc=null,Hc=null,$b=null){this.AQ=this.tua=this.vLa=this.vsa=null;this._initialized=!1;this.$d=Ua;this.WF=Ya;this.OCa=Wa;this.vBa=Fb;this.Xsa=yb;this.Due=new e.a;for(Ua=0;Ua<this.WF.length;Ua++)this.Due.add(this.WF.J(Ua).id);this.fVg=new e.a;for(Ua=0;Ua<this.vBa.length;Ua++)this.fVg.add(this.vBa.J(Ua).id);this.Ckh=new e.a;for(Ua=
0;Ua<this.OCa.length;Ua++)this.Ckh.add(this.OCa.J(Ua).id);this.Qg=Yb;this.tXe=qc||H.a.instance;this.HI=Hc;this.dX=$b;this.swb=1===(this.HI&&this.dX&&1===this.HI.UJa&&1===this.dX.UJa?1:0);this.Wsa=0}get V$f(){return 1!==this.Wsa}sCm(){var Ua=!0;if(this.HI&&this.dX)return Ua;if(this.HI||this.dX)return a.a.instance.Ua(593826832,1,2,"ParagraphMergeUsingHints.InitializeUpdateHints : Unexpected input to constructor: need to supply both or neither of favored and unfavored update hints, just supplying one is unsupported"),
!1;this.$d.runtime.Lu.nb(v.a.OL)&&(Ua=this.$d.runtime.Lu.J(v.a.OL),Ua=this.xrg(Ua,this.$d.runtime.UDa.id,"favored")&&({updateHints:this.HI}=this.ksi(Ua,this.Due,this.fVg,this.$d.runtime.Lu,"favored")).returnValue);Ua&&this.$d.runtime.Nq.nb(v.a.OL)&&(Ua=this.$d.runtime.Nq.J(v.a.OL),Ua=this.xrg(Ua,this.$d.runtime.UDa.id,"unfavored")&&({updateHints:this.dX}=this.ksi(Ua,this.Due,this.Ckh,this.$d.runtime.Nq,"unfavored")).returnValue);this.HI=this.HI?this.HI:new mb.a(new k.a,0);this.dX=this.dX?this.dX:
new mb.a(new k.a,0);Ua&&this.$d.input.jIb&&(Ua=this.$d.input.baa.last().O2a(v.a.OL),Ua=this.xrg(Ua,this.$d.input.baa.last().tX.id,"alreadyMerged"));return Ua}AAm(){const Ua=new e.a;if(this.swb)return Ua;const Ya=this.HI?this.HI.updateHints.R5():new k.a;let Fb=0;for(;Fb<Ya.length-1;){const Wa=Ya.J(Fb);let yb,Yb=!1;for(yb=Fb+1;yb<Ya.length;yb++){const qc=Ya.J(yb);if(Wa.wzi(qc)){Ua.add(Wa.id);Ya.zG(yb);Ya.zG(Fb);Yb=!0;break}}Yb||Fb++}return Ua}xrg(Ua,Ya,Fb){Ua=this.Qg.getPropertyString(Ua,l.a.CVa);Ua=
x.a.If(Ua);return Ya.equals(Ua)?!0:(this.I9c(2),a.a.instance.Ua(17162307,1,2,"ParagraphMergeUsingHints: ValidateUpdateHintsContainerBaseId returned failure [MergeBaseId: {0}] [UpdateHintsContainerBaseId: {1}] [RevisionType: {2}]",this.$d.runtime.UDa.id,Ua,Fb),!1)}ksi(Ua,Ya,Fb,Wa,yb){let Yb;Yb=new mb.a(new k.a,0);Ua=this.Qg.getPropertyObjectIds(Ua,l.a.h2).R5();for(let Hc=0;Hc<Ua.length;Hc++){if(!Wa.nb(Ua.J(Hc)))return a.a.instance.Ua(17044257,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to find [UpdateHintObject: {0}] in [RevisionType: {1}]",
Ua.J(Hc),yb),{returnValue:!1,updateHints:Yb};const $b=Wa.J(Ua.J(Hc));var qc=x.a.If(this.Qg.getPropertyString($b,l.a.Hka));if(Ya.contains(qc)||Fb.contains(qc)){qc=this.tXe.jSc($b);if(!qc)return a.a.instance.Ua(17044258,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to create a updateHint for [UpdateHintObject: {0}]  in [RevisionType: {1}]",$b.id,yb),{returnValue:!1,updateHints:Yb};Yb.updateHints.add(qc)}}0<Ua.length&&a.a.instance.Ua(17162308,1,5,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs for [RevisionType: {0}] [UpdateHintIds: {1}] [UpdateHints: {2}]",
yb,Ua.ir(),Yb.updateHints.ir());return{returnValue:!0,updateHints:Yb}}DBm(){return({QK:this.vsa,ZNc:this.vLa,jdd:this.tua}=hc.a.VMh(this.$d,this.Qg,this.WF,this.vBa,this.OCa,this.Xsa,!0,!0)).returnValue?!0:!1}qCm(Ua){const Ya=hc.a.vJd(this.Qg,Fb=>this.$d.runtime.vk.J(Fb),this.WF,1,this.Xsa,!0,!0).returnValue;if(!Ya)return a.a.instance.Ua(17044259,1,2,"InitializeTwinTextMergeBlocks:Unable to create merge blocks for the base or derived"),!1;this.AQ=this.swb?new fb(this.$d,Ya,1):new Ka(this.$d,Ya,Ua,
this.HI?this.HI.UJa:0);return!0}initialize(){if(this._initialized)return!1;this._initialized=!0;if(!this.sCm()||!this.DBm())return!1;const Ua=this.AAm();return this.qCm(Ua)?!0:!1}Eci(Ua){const Ya=new k.a;let Fb="";for(let Wa=0;Wa<Ua.length;Wa++){const yb=Ua.J(Wa);yb.b5()?Fb+=Ua.J(Wa).text:2===yb.type?(Ya.add(new ka(yb.Pj,yb.type,Fb,yb.Wc)),Fb=""):4===yb.type&&(Ya.add(new ka(yb.Pj,yb.type)),Fb="")}return Ya}validateUpdateHintsAreComplete(Ua,Ya,Fb){Ya=this.Eci(Ya);Ua=this.Eci(Ua);let Wa=Ya.length===
Ua.length;if(Wa)for(let yb=0;yb<Ya.length;yb++)if(!Ya.J(yb).isEqual(Ua.J(yb))){Wa=!1;break}Wa||(this.I9c(4),a.a.instance.Ua(17044288,1,2,"ValidateUpdateHintsAreComplete: Validation of update hints from [Revision: {0}] was unsuccessful [MergeValidationState: {1}] [RevisionValidationState: {2}]",Fb,Ua.ir(),Ya.ir()));return Wa}pvh(Ua,Ya,Fb){(Ya=({q9a:Ua}=this.KGk(Ua,Ya,Fb)).returnValue)||this.I9c(this.AQ.mergeConflict?1:3);return{returnValue:Ya,q9a:Ua}}KGk(Ua,Ya,Fb){let Wa;Wa=new k.a;let yb=!0;var Yb=
0;let qc=null,Hc=this.HI?this.HI.updateHints.length:0;for(var $b=0;$b<Hc&&yb;$b++)qc=this.HI.updateHints.J($b),Yb<this.dX.updateHints.length&&qc.id.equals(this.dX.updateHints.J(Yb).id)&&5!==this.$d.input.source?({returnValue:yb}=this.AQ.M2e(qc,2),Yb++):yb=this.AQ.N2e(qc,2);if(!yb)return a.a.instance.Ua(17044289,1,2,"ApplyUpdateHints: Failed to apply favored [UpdateHint: {0}]",qc.toString()),{returnValue:!1,q9a:Wa};if(!this.validateUpdateHintsAreComplete(this.AQ.Pe,this.vLa,"Favored"))return{returnValue:!1,
q9a:Wa};if(Ua&&1===this.$d.input.Uia&&!this.AQ.Luh(Ya,Fb,2))return a.a.instance.Ua(17409920,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",Ya,Fb),{returnValue:!1,q9a:Wa};yb=!0;$b=new k.a;for(Hc=this.dX?this.dX.updateHints.length:0;Yb<Hc&&yb;Yb++){qc=this.dX.updateHints.J(Yb);let Ub;({Au:Ub,returnValue:yb}=this.AQ.M2e(qc,4));yb&&Ub&&$b.aD($b.length,Ub)}return yb?this.validateUpdateHintsAreComplete(this.AQ.base,this.tua,"Unfavored")?Ua&&2===this.$d.input.Uia&&!this.AQ.Kuh(Ya,
Fb,4)?(a.a.instance.Ua(17409921,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",Ya,Fb),{returnValue:!1,q9a:Wa}):{returnValue:!0,q9a:$b}:{returnValue:!1,q9a:Wa}:(a.a.instance.Ua(17044291,1,2,"ApplyUpdateHints: Failed to apply unfavored [UpdateHint: {0}] [Type: {1}]",qc.id,qc.type),{returnValue:!1,q9a:Wa})}F4l(){let Ua,Ya=0;let Fb=0,Wa=x.a.nil;for(Ua=new y.a;Fb<this.AQ.base.length;){const qc=this.AQ.base.J(Fb);Wa.equals(qc.Pj)||(Ya=0,Wa=qc.Pj);if(5===qc.type){var yb=
Ya+qc.length;var Yb=void 0;let Hc;const $b=Z(this.tua);if(!({index:Yb}=O($b,qc.Pj,Ya)).returnValue||!({index:Hc}=O($b,qc.Pj,yb)).returnValue)return a.a.instance.Ua(17335384,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks from unfavored to insert in favored for [UpdateHintId: {0}]",qc.zdd),{returnValue:!1,OOi:Ua};for(yb=new k.a;Yb<Hc;Yb++)yb.add($b.J(Yb));Ua.Z(qc.zdd,yb)}Ya+=qc.length;Fb++}return{returnValue:!0,OOi:Ua}}G4l(){let Ua;Ua=new y.a;let Ya=0;for(let Wa=
0;Wa<this.AQ.base.length;Wa++){const yb=this.AQ.base.J(Wa);if(5===yb.type){var Fb=void 0;let Yb;const qc=Z(this.tua);if(!({index:Fb}=W(qc,Ya,this.$d.logger)).returnValue||!({index:Yb}=W(qc,Ya+yb.length,this.$d.logger)).returnValue)return a.a.instance.Ua(574433309,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks"),{returnValue:!1,POi:Ua};const Hc=new k.a;for(;Fb<Yb;Fb++)Hc.add(qc.J(Fb));Ua.Z(yb.zdd,Hc)}Ya+=yb.length}return{returnValue:!0,POi:Ua}}xFk(Ua){let Ya;Ya=
new k.a;let Fb;if(this.swb){if(!({POi:Fb}=this.G4l()).returnValue)return{returnValue:!1,I0c:Ya}}else if(!({OOi:Fb}=this.F4l()).returnValue)return{returnValue:!1,I0c:Ya};let Wa;Wa=this.swb?new fb(this.$d,Z(this.vLa),1):new Ka(this.$d,Z(this.vLa),new e.a,this.HI?this.HI.UJa:0);for(var yb=0;yb<Ua.length;yb++)if(!Wa.N2e(Ua.J(yb),4))return{returnValue:!1,I0c:Ya};for(Ua=Wa.Pe.length-1;0<=Ua;Ua--)5===Wa.Pe.J(Ua).type&&(yb=Wa.Pe.J(Ua).zdd,Wa.Pe.zG(Ua),Wa.Pe.aD(Ua,Fb.J(yb)));this.swb&&(this.aQh(Wa.Pe),this.aQh(this.AQ.Pe));
if(!this.validateUpdateHintsAreComplete(this.AQ.Pe,Wa.Pe,"Merged"))return{returnValue:!1,I0c:Ya};Ya=Wa.Pe;return{returnValue:!0,I0c:Ya}}aQh(Ua){const Ya=new y.a;for(let Fb=Ua.length-1;0<=Fb;Fb--){const Wa=Object(m.a)(G.a,Ua.J(Fb));Wa&&(Ya.nb(Wa.Wc)?Ya.J(Wa.Wc).source!==Wa.source&&Ua.zG(Fb):Ya.add(Wa.Wc,Wa))}}JGk(Ua){let Ya;if(!({Rdd:Ya}=this.AQ.Zkf(Z(this.tua))).returnValue)return!1;for(let Wa=0;Wa<Ya.length;Wa++){const yb=Ya.J(Wa);let Yb,qc;if(!({index:Yb}=W(Ua,yb.cp,this.$d.logger)).returnValue||
!({index:qc}=W(Ua,yb.cp+yb.length,this.$d.logger)).returnValue)return a.a.instance.Ua(572379488,1,2,"ApplyUnfavoredFormattingChangesLcs: Unable to split"),this.$d.logger.Rg(Object.assign(new K.a,{yj:"ApplyUnfavoredFormattingChangesLcs",eventId:"8h3f6"})),!1;var Fb=!1;for(let Hc=Yb;Hc<qc&&!Fb;Hc++)Fb=!yb.aEd.wJ.equals(Ua.J(Hc).wJ);if(!Fb){for(Fb=Yb;Fb<qc;Fb++)Ua.zG(Yb);Ua.insert(Yb,yb.Sdd)}}return!0}IGk(Ua){let Ya;if(!({Boc:Ya}=this.AQ.Zkf(Z(this.tua))).returnValue)return!1;for(let yb=0;yb<Ya.length;yb++){var Fb=
Ya.J(yb);let Yb,qc;if(({index:Yb}=O(Ua,Fb.Bg,Fb.cp)).returnValue&&({index:qc}=O(Ua,Fb.Bg,Fb.cp+Fb.Sdd.length)).returnValue){var Wa=!1;for(let Hc=Yb;Hc<qc&&!Wa;Hc++)Wa=!Fb.aEd.wJ.equals(Ua.J(Hc).wJ)||!Fb.aEd.KF.JA(Ua.J(Hc).KF);if(Wa){if(this.HI&&1===this.HI.UJa||this.dX&&1===this.dX.UJa)return!1}else{for(Wa=Yb;Wa<qc;Wa++)Ua.zG(Yb);Ua.insert(Yb,Fb.Sdd)}}else if(Fb=Fb.Sdd.rIm,a.a.instance.Ua(51500353,1,2,"ApplyUnfavoredFormattingChanges: Unable to find corresponding merge blocks with update formatting in merged list. IsEmbeddedObject {0}",
Fb),Fb||this.HI&&1===this.HI.UJa||this.dX&&1===this.dX.UJa)return!1}return!0}M9l(Ua){let Ya,Fb;Fb=new k.a;Ya=this.$d.runtime.un.J(v.a.OL);let Wa;({LPf:Wa}=Hb.f5h(this.$d,this.Qg));const yb=new k.a;for(let qc=0;qc<Ua.length;qc++){if(Wa.contains(Ua.J(qc).id,($b,Ub)=>$b.equals(Ub)))continue;if(this.$d.runtime.un.nb(Ua.J(qc).id))return a.a.instance.shipAssertTag(17044293,1,!1,"[UpdateHint: {0}] is already in the merged object. Failing merge.",Ua.J(qc).id),{returnValue:!1,A$d:Ya,z$d:Fb};yb.add(Ua.J(qc).id);
var Yb=Ua.J(qc).T2a();const Hc=new cc.a(Yb);Yb=Yb.xl();for(const $b of Yb)Hc.DC($b);Fb.add(Hc)}Ua=this.Qg.getPropertyObjectIds(Ya.Fm,l.a.h2);Ua.aD(Ua.length,yb);this.Qg.setPropertyObjectIds(Ya.Fm,l.a.h2,Ua);return{returnValue:!0,A$d:Ya,z$d:Fb}}GRd(Ua){return String.format("Name: {0}, Message: {1}, Stack: {2}",Ua.name,Ua.message,Ua.stack)}I9c(Ua){0===this.Wsa&&(this.Wsa=Ua)}noc(){let Ua;Ua=null;let Ya,Fb;var Wa;try{if({un:Ua,A$d:Ya,z$d:Fb,returnValue:Wa}=this.cPo(),Wa){if(Ya&&Fb){this.$d.runtime.un.Z(Ya.Fm.id,
Ya);for(Wa=0;Wa<Fb.length;Wa++){const Hc=Fb.J(Wa);this.$d.runtime.un.Z(Hc.Fm.id,Hc)}const yb=Ya.Fm,Yb=this.Qg.getPropertyObjectIds(yb,l.a.h2),qc=this.Qg.getPropertyString(yb,l.a.CVa);a.a.instance.Ua(17162312,1,5,"ParagraphMergeUsingHints returned success [UpdateHintsContainerNodeIds: {0}] [UpdateHintsContainerBaseId: {1}]",Yb.ir(),qc)}else a.a.instance.Ua(593826831,1,5,"ParagraphMergeUsingHints returned success and did not update UpdateHint objects");return{returnValue:!0,un:Ua}}}catch(yb){a.a.instance.Ua(17162313,
1,2,"ParagraphMergeUsingHints Crashed! Retrying ParagraphMerge [{0}]",this.GRd(yb))}this.I9c(5);a.a.instance.Ua(17409922,1,2,"TryDoMerge: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",this.Wsa,this.V$f);this.w5a();this.HI&&1===this.HI.UJa&&this.$d.logger.Rg(Object.assign(new ea.a,{eventId:"bc04c",yj:"ParagraphMergeUsingHints.TryDoMerge",info:t[this.Wsa]+"/LCS"}));return{returnValue:!1,un:Ua}}cPo(){let Ua,Ya,Fb;Fb=Ya=Ua=null;let Wa;Wa=this.initialize();
this.$d.logger.$U("PMUH Initialize");let yb=null;Wa=Wa&&({q9a:yb}=this.pvh(!1,x.a.nil,0)).returnValue;this.$d.logger.$U("PMUH ApplyUpdateHints");let Yb=new k.a;Wa=Wa&&({I0c:Yb}=this.xFk(yb)).returnValue;this.$d.logger.$U("PMUH ApplyMergedUnfavoredHintsToFavoredToMergeFavoredFormattingChanges");Wa=this.swb?Wa&&this.JGk(Yb):Wa&&this.IGk(Yb);this.$d.logger.$U("PMUH ApplyUnfavoredFormattingChanges");this.swb&&!this.S8n(Yb)&&(a.a.instance.shipAssertTag(571552961,1,!1,"ReuseParaIdsIfPossible"),this.$d.logger.Rg(Object.assign(new K.a,
{yj:"ReuseParaIdsIfPossible",eventId:"8ettb"})),Wa=!1);const qc=this.uTd(Yb);Wa=Wa&&({y$d:Ua}=hc.a.hRc(this.$d,this.Qg,this.Xsa,Yb,qc)).returnValue;this.$d.logger.$U("PMUH GetMergeableObjectsFromMergeBlocks");this.HI&&1===this.HI.UJa&&this.dX&&1===this.dX.UJa||(Wa=Wa&&({A$d:Ya,z$d:Fb}=this.M9l(F(yb))).returnValue,this.$d.logger.$U("PMUH GetPartialMergeResultForUpdateHintNodes"));return{returnValue:Wa,mergeConflict:!!this.AQ&&this.AQ.mergeConflict,un:Ua,A$d:Ya,z$d:Fb}}uTd(Ua){const Ya=new k.a;for(let Fb=
0;Fb<Ua.length;Fb++)2===Ua.J(Fb).type&&Ya.add(Ua.J(Fb).Pj);return Ya}zqf(Ua){const Ya=new k.a;for(let Fb=0;Fb<Ua.length;Fb++)2===Ua.J(Fb).type&&Ya.add(Ua.J(Fb));return Ya}S8n(Ua){var Ya=this.zqf(this.vsa),Fb=this.zqf(this.vLa),Wa=this.zqf(this.tua),yb=this.uTd(Ya),Yb=this.uTd(Fb),qc=this.uTd(Wa);Yb=M.b(yb,Yb,qc);yb=new k.a;for(qc=0;qc<Yb.length;qc++)yb.aD(yb.length,Yb.J(qc).lFl());Yb=this.qFl(Ua);Ya=this.mFl(Yb,yb,Ya,Fb,Wa);Fb=0;Wa=new e.a;for(yb=0;yb<Ua.length;yb++)if(Yb=Ua.J(yb),2===Yb.type)if(Wa.contains(Yb.Pj))if(Fb<
Ya.length)Ua.zG(yb),Ua.insert(yb,Ya.J(Fb)),Fb++;else return!1;else Wa.add(Yb.Pj);0<Ua.length&&2!==Ua.J(Ua.length-1).type&&Fb<Ya.length&&Ua.insert(Ua.length,Ya.J(Fb));return!0}qFl(Ua){const Ya=new e.a;for(let Fb=0;Fb<Ua.length;Fb++)2===Ua.J(Fb).type&&Ya.add(Ua.J(Fb).Pj);return Ya}mFl(Ua,Ya,Fb,Wa,yb){const Yb=new k.a;for(let qc=0;qc<Ya.length;qc++){const Hc=Ya.J(qc);if(!Ua.contains(Hc)){let $b;(({block:$b}=this.Rkf(Wa,Hc)).returnValue||({block:$b}=this.Rkf(yb,Hc)).returnValue||({block:$b}=this.Rkf(Fb,
Hc)).returnValue)&&$b&&Yb.add($b)}}return Yb}Rkf(Ua,Ya){for(let Fb=0;Fb<Ua.length;Fb++)if(2===Ua.J(Fb).type&&Ua.J(Fb).Pj===Ya)return Ua=Ua.J(Fb),{returnValue:!0,block:Ua};return{returnValue:!1,block:null}}w5a(){const Ua=new k.a;hc.a.rfc(this.Qg,"BaseObjects_",this.WF,Ua);hc.a.rfc(this.Qg,"FavoredObjects_",this.vBa,Ua);hc.a.rfc(this.Qg,"ConflictObjects_",this.OCa,Ua)}MRk(){let Ua,Ya;Ua=x.a.nil;Ya=-1;let Fb=0;for(let Wa=0;Wa<this.AQ.Pe.length;Wa++){const yb=this.AQ.Pe.J(Wa);if(yb.b5())Fb+=yb.length;
else if(6!==yb.type)Fb=0;else return Ua=yb.Pj,Ya=Fb,{returnValue:!0,objectId:Ua,cp:Ya}}a.a.instance.Ua(17409923,1,2,"CalculatePositionOfPlaceHolderCp: Unable to find placeholder Cp");return{returnValue:!1,objectId:Ua,cp:Ya}}vdd(Ua,Ya){let Fb,Wa;Wa=Ya;Fb=Ua;try{let yb=this.initialize();if(yb=(yb=yb&&this.pvh(!0,Ua,Ya).returnValue)&&({objectId:Fb,cp:Wa}=this.MRk()).returnValue)return a.a.instance.Ua(17409924,1,5,"UpdateCpAccordingToIncomingChange returned success [ResultObjectId: {0}] [ResultCp: {1}]",
Fb,Wa),{returnValue:!0,s7a:Fb,dra:Wa}}catch(yb){a.a.instance.Ua(17409925,1,2,"UpdateCpAccordingToIncomingChange Crashed! Retrying using the old method [{0}]",this.GRd(yb))}this.I9c(5);a.a.instance.Ua(17409926,1,2,"UpdateCpAccordingToIncomingChange: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",this.Wsa,this.V$f);this.w5a();return{returnValue:!1,s7a:Fb,dra:Wa}}static f5h(Ua,Ya){let Fb;Fb=new k.a;if(!Ua.input.jIb)return{returnValue:!0,LPf:Fb};Ua=Ua.input.baa.last().O2a(v.a.OL);
Fb=Ya.getPropertyObjectIds(Ua,l.a.h2);return{returnValue:!0,LPf:Fb}}static TFn(Ua){if(!hc.a.Mgf(Ua))return!0;const Ya=new z.a;Ua.runtime.un.Z(v.a.OL,hc.a.tCm(Ua,Ya));return!0}static yFn(Ua){if(!Ua.runtime.un.nb(v.a.OL)||!Ua.runtime.Nq.nb(v.a.OL))return!0;const Ya=new z.a,Fb=Ua.runtime.un.J(v.a.OL);var Wa=Ya.getPropertyString(Fb.Fm,l.a.CVa);if(x.a.If(Wa).equals(x.a.nil))return!0;Wa=Ya.getPropertyObjectIds(Fb.Fm,l.a.h2);const yb=Ya.getPropertyObjectIds(Ua.runtime.Nq.J(v.a.OL),l.a.h2);let Yb;({LPf:Yb}=
Hb.f5h(Ua,Ya));for(let qc=0;qc<yb.length;qc++)Wa.contains(yb.J(qc),(Hc,$b)=>Hc.equals($b))||Yb.contains(yb.J(qc),(Hc,$b)=>Hc.equals($b))||(Wa.add(yb.J(qc)),Ua.runtime.un.Z(yb.J(qc),new cc.a(Ua.runtime.Nq.J(yb.J(qc)).XK())));Ya.setPropertyObjectIds(Fb.Fm,l.a.h2,Wa);return!0}}Object(D.a)(Hb,"ParagraphMergeUsingHints",null,[1989])},1671:function(D,I,c){D=c(0);class l{constructor(m){this.ARi=m;this.succeeded=!1;this.goc=m?m.goc:0;this.dWm=!1;this.length=this.eIo=0}}Object(D.a)(l,"TrieResult",null,[]);
class e{constructor(m,t,z){this.Jmb=new l(null);this.w9m=m;this.T_c=t;this.sMi=t+z-1}get result(){return this.Jmb}Wci(){let m;return this.T_c<=this.sMi?(m=this.w9m.charAt(this.T_c),++this.T_c,{returnValue:!0,ch:m}):{returnValue:!1,ch:"\x00"}}u7f(m,t,z){m&&(this.Jmb.dWm=!0,this.Jmb.eIo=t);this.Jmb.length=this.T_c;this.Jmb.succeeded=!0;this.Jmb.goc=z;this.T_c!==this.sMi+1&&(this.Jmb=new l(this.Jmb))}}Object(D.a)(e,"LookUpStringVisitor",null,[1284]);var a=c(1760);class k{constructor(){this.FCh=this.dAh=
this.fAh=this.cAh=this.eAh=this.$5e=this.Y5e=this.b6e=this.X5e=0}}Object(D.a)(k,"TRIESTATS",null,[]);class x{constructor(){this.F8a=this.D1c=0}}Object(D.a)(x,"TrieSymbol",null,[]);c.d(I,"a",function(){return y});class y{constructor(m,t){this.d5=null;this.U3d=this.HMi=this.FMi=this.JMi=this.BMi=this.IMi=this.GMi=this.KMi=this.CMi=0;this.RJ=m;if(m.Yy(t,4)!==y.QBb)throw Error.argument("Input does not represent a trie");t+=4;this.uMi=1===m.Yy(t,4);t+=4;this.t9m=1===m.Yy(t,4);t+=4;this.p9m=m.Yy(t,4);t+=
4;if(m.Yy(t,4)){m=t+4;this.d5=this.oQn(m);this.CMi=t=m+y.hQk;this.KMi=t+=y.PEd*(this.d5.X5e+(this.d5.X5e%2?1:0));this.GMi=t+=y.PEd*(this.d5.b6e+(this.d5.b6e%2?1:0));this.IMi=t+=y.PEd*(this.d5.Y5e+(this.d5.Y5e%2?1:0));this.BMi=t+=y.PEd*(this.d5.$5e+(this.d5.$5e%2?1:0));this.JMi=t+=y.d6e*this.d5.cAh;this.FMi=t+=y.e6e*this.d5.fAh;this.HMi=t+=y.e6e*this.d5.dAh;t+=y.e6e*this.d5.eAh;if(t!==m+this.d5.FCh)throw Error.argument("Corrupted trie binary");this.U3d=t}else this.d5=null}SLi(m,t,z,v){m=new e(m,t,
z);this.vKj(m,v);return m.result}Vhi(m){if(this.uMi)if(m)--m;else return"";if(!this.d5)throw Error.argument("Invalid trieID");const t=new a.a;t.VF=0;this.wSb(t);const z=[];for(;;){if(t.VF&y.Y9a)if(m)--m;else return Array.add(z,t.ETb),String.fromCharCode.apply(null,z);const v=!!(t.VF&y.Kre),H=this.D9b(t,!0);if(v||m<H){if(Array.add(z,t.ETb),!this.wSb(t))throw Error.argument("Invalid trieID");}else if(m-=H,!this.Hcd(t))throw Error.argument("Invalid trieID");}}vKj(m,t){let z=0;this.uMi&&(m.u7f(this.t9m,
this.p9m,0),++z);if(this.d5){var v=new a.a;v.VF=0;if(this.wSb(v))for(;;){var H=void 0;if(!({ch:H}=m.Wci()).returnValue)break;t&&(H=t(H));H=H.toString().charCodeAt(0);let F=!1;for(;!F;){const G=!!(v.VF&y.Y9a);if(v.ETb===H){if(F=!0,G&&m.u7f(!!(v.VF&y.Bvg),v.yle,z),!this.wSb(v))return}else if(z+=this.D9b(v,!0),!this.Hcd(v))return;G&&++z}}}}wSb(m){if(!m.VF)return this.Jng(m),!0;if(!(m.VF&y.Jre))return!1;m.OQa=0;m.Px=m.kkb;this.Jng(m);return!0}Hcd(m){if(m.VF&y.Kre)return!1;this.Jng(m);return!0}D9b(m,t){return m.VF&
y.zvg?m.OEd:m.VF&y.Jre?!t&&m.VF&y.Kre?this.TTl(m):1:0}TTl(m){m=y.I8e(m);if(!this.wSb(m))return 0;let t=0;do m.VF&y.Y9a&&++t,t+=this.D9b(m,!1);while(this.Hcd(m));return t}Jng(m){m.VF||(m.OQa=0,m.Px=this.U3d);var t=this.uKd(this.CMi,m.Px),z=t.F8a;m.Px+=t.D1c;t=this.RJ.Yy(this.BMi+y.d6e*z,y.d6e);m.ETb=t&65535;m.VF=t>>16;m.VF&y.zvg&&(m.OEd=this.kil(m));m.VF&y.Bvg&&(t=this.uKd(this.KMi,m.Px),z=t.F8a,m.Px+=t.D1c,m.yle=this.RJ.Yy(this.JMi+4*z,4));m.VF&y.vSj?(m.kkb=this.U3d+((this.RJ.J(m.Px)<<8|this.RJ.J(m.Px+
1))<<8|this.RJ.J(m.Px+2)),m.Px+=3):m.VF&y.wSj?(m.kkb=m.Px,m.OQa=m.kkb):m.VF&y.xSj?(t=this.uKd(this.GMi,m.Px),z=t.F8a,m.Px+=t.D1c,m.kkb=this.U3d+this.RJ.Yy(this.FMi+4*z,4)):m.VF&y.Jre&&(t=this.uKd(this.IMi,m.Px),z=t.F8a,m.Px+=t.D1c,m.OQa||(m.OQa=m.Px),m.OQa+=this.RJ.Yy(this.HMi+4*z,4),m.kkb=m.OQa)}uKd(m,t){const z=new x;let v=0;for(;;){v+=this.RJ.J(t);++t;++z.D1c;const H=this.RJ.Yy(m,2);if(v<H)break;z.F8a+=H;v-=H;m+=2;v<<=8}z.F8a+=v;return z}kil(m){let t=this.RJ.J(m.Px);192<=t?(t=(t&63)<<15|(this.RJ.J(m.Px+
1)&127)<<8,t|=this.RJ.J(m.Px+2),m.Px+=3):128<=t?(t=(t&127)<<8|this.RJ.J(m.Px+1),m.Px+=2):m.Px+=1;return t}oQn(m){const t=new k;t.X5e=this.RJ.Yy(m+12,2);t.b6e=this.RJ.Yy(m+14,2);t.Y5e=this.RJ.Yy(m+16,2);t.$5e=this.RJ.Yy(m+18,2);t.eAh=this.RJ.Yy(m+24,4);t.cAh=this.RJ.Yy(m+28,4);t.fAh=this.RJ.Yy(m+32,4);t.dAh=this.RJ.Yy(m+36,4);t.FCh=this.RJ.Yy(m+40,4);return t}static I8e(m){const t=new a.a;t.ETb=m.ETb;t.VF=m.VF;t.OEd=m.OEd;t.Px=m.Px;t.kkb=m.kkb;t.OQa=m.OQa;t.yle=m.yle;return t}}y.QBb=1654263084;y.hQk=
48;y.PEd=2;y.e6e=4;y.d6e=4;y.Y9a=1;y.Kre=2;y.zvg=4;y.Bvg=8;y.Jre=16;y.wSj=64;y.xSj=128;y.vSj=256;Object(D.a)(y,"Trie",null,[1279])},1673:function(D,I,c){c.r(I);D=c(0);c(1522);var l=c(1540);class e{}e.marketPlace=0;e.catalog=1;e.privateCatalog=10;Object(D.a)(e,"AppsForOfficeStoreType",null,[]);var a=c(1520),k=c(2),x=c(93),y=c(13);class m{constructor(){this.eUe=0}s4f(K,L){this.eUe=window.performance.now();this.UVa(()=>{const R=window.performance.now(),S={},N=k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",
!0);L.cAk&&(S.callback=O=>{K(O,e.marketPlace,R)},N&&(S.storeType=e.marketPlace),k.AFrameworkApplication.va.Qb(y.a.mOb,2,S));L.dAk&&(S.callback=O=>{K(O,e.privateCatalog,R)},N?S.storeType=e.privateCatalog:k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?S.storeType=10:S.storeType=e.privateCatalog,k.AFrameworkApplication.va.Qb(y.a.mOb,2,S))},0,()=>{if(a.TellMeActor.instance.Oe)a.TellMeActor.instance.Oe.onError("AddinEntitlementsQuery:QueryEntitlementAsync",
"Query entitlements timeout after "+(window.performance.now()-this.eUe)+" ms")})}UVa(K,L=0,R=null){2!==k.AFrameworkApplication.va.processAction(y.a.mOb,1)?(a.TellMeActor.instance.Oe&&a.TellMeActor.instance.Oe.QA(l.a.bAk,window.performance.now()-this.eUe),K()):L<m.Kbn?k.AFrameworkApplication.lc.Wb(new x.a(2,1,m.g4o,()=>{this.UVa(K,L+1,R)})):R&&R()}static get instance(){m._instance||(m._instance=new m);return m._instance}}m._instance=null;m.Kbn=20;m.g4o=500;Object(D.a)(m,"AddinEntitlementsQuery",null,
[]);class t{constructor(){this.description=this.id=this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.KJf=this.storeType=this.storeId=this.providerName=this.iconUrl=null}}Object(D.a)(t,"AddinInfo",null,[]);var z=c(1524),v=c(1527),H=c(1526),F=c(1519),G=c(127);c.d(I,"AddinResultsProvider",function(){return M});class M{constructor(K){this.iQe=[];this.fc=K;this.Xon=(L,R,S)=>{if(L){const N=L.errorCode;if(a.TellMeActor.instance.Oe){const O=
{};O.StoreType=R;O.ErrorCode=N;O.AddinCount=L.value?L.value.length:0;a.TellMeActor.instance.Oe.QA(l.a.LMl,window.performance.now()-S,O)}if(0===N&&L.value){M.bBb=M.bBb||{};L=L.value;for(const O of L)L=new t,L.displayName=O[0],L.id=O[1],L.description=O[2],L.targetType=O[3],L.appVersion=4<O.length?O[4]:"",L.assetId=5<O.length?O[5]:"",L.assetStoreId=6<O.length?O[6]:"",L.width=7<O.length?O[7]:0,L.height=8<O.length?O[8]:0,L.iconUrl=9<O.length?O[9]:"",L.providerName=10<O.length?O[10]:"",L.storeId=11<O.length?
O[11]:"",L.storeType=12<O.length?O[12]:"",L.KJf=this.e2l(L),M.bBb[L.id]=L,0<L.iconUrl.length&&(R="AddinIcon_"+L.id,k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)?this.S9i(R,L.iconUrl):appChrome.addInApi.registerAddinIcon(R,L.iconUrl))}}};m.instance.s4f(this.Xon,this.fc)}oL(){return"Add-ins"}BU(){return 0===this.fc.hv?0:1===this.fc.hv?1:2}dI(K,L,R,S,N=null){R=new H.a(K);N&&!Array.contains(N,27)||F.a.FR(K)||(N=new v.a(27),N.displayName=
CommonUIStrings.l_TellMeAddinProviderTitle,this.E1l(K.Gg,N),R.dv(N));L.resultsUpdated(R)}E1l(K,L){if((K=this.Ybo(K))&&0<K.length){let R=0;K.forEach(S=>{if(!(3<++R)){var N="AddinSuggestion"+R,O={};if(k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)){var W="AddinIcon_"+S.id;0>Array.indexOf(this.iQe,W)&&0<S.iconUrl.length&&this.S9i(W,S.iconUrl);O["default"]=0<=Array.indexOf(this.iQe,W)?W:"AppForOfficeLogo_20"}else O["default"]=0<S.iconUrl.length?
"AddinIcon_"+S.id:"AppForOfficeLogo_20";W=[];W.push(appChrome.actions.setControlLabel(N,S.displayName));W.push(appChrome.actions.setControlIconSet(N,O));W.push(appChrome.actions.setCompoundButtonCommandValueId(N,S.id));W.push(appChrome.actions.updateCompoundButtonDescription(N,S.description));k.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",!0)&&(O=window.performance.now(),W.push(appChrome.actions.updateControlEnabledDisabledState(N,!1)),
a.TellMeActor.instance.Oe&&a.TellMeActor.instance.Oe.QA(l.a.ivl,window.performance.now()-O));appChrome.api.dispatch(W);N=new z.a(N,27,void 0,void 0,1);N.cJ=Telemetry.PrivacyRules.GetPrivacyCompliantId(S.id,S.storeType,S.assetId,null,null,S.storeId);L.Uw(N)}})}}S9i(K,L){G.c()&&appChrome.addInApi.registerAddinIcon&&(appChrome.addInApi.registerAddinIcon(K,L),Array.add(this.iQe,K))}Ybo(K){if(!M.bBb)return null;const L=[],R=M.bBb;for(let N in R){var S=R[N];S&&M.Ian(K,S)&&Array.add(L,S)}return L}e2l(K){return M.ZBo(K.displayName)}static Ian(K,
L){if(!L.KJf)return!1;for(const R of K.split(" ")){K=!1;for(const S of L.KJf)if(S.toLowerCase().startsWith(R.toLowerCase())){K=!0;break}if(!K)return!1}return!0}static ZBo(K){const L=[];for(const R of K.split(" ")){K=0;for(let S=0;S<R.length;S++){const N=R.charAt(S);N.toString().toUpperCase()===N.toString()&&S>K&&(Array.add(L,R.substring(K,S)),K=S)}Array.add(L,R.substring(K,R.length));K&&Array.add(L,R.substring(0,R.length))}return L}}M.bBb=null;Object(D.a)(M,"AddinResultsProvider",null,[1112])},1741:function(D,
I,c){c.d(I,"a",function(){return e});D=c(0);var l=c(225);class e{constructor(){this.Hob=this.Iob=this.i1a=this.Lkb=this.Gob=this.Zgb=this.Jkb=this.J6a=this.$gb=this.Kkb=null;this.reset()}reset(){this.Kkb=new l.a;this.$gb=new l.a;this.J6a=new l.a;this.Jkb=new l.a;this.Zgb=new l.a;this.Gob=new l.a;this.Lkb=new l.a;this.i1a=new l.a;this.i1a=new l.a;this.Iob=new l.a;this.Hob=new l.a}J2o(a){return this.BQa(this.Kkb,a)&&this.BQa(this.$gb,a)&&this.BQa(this.J6a,a)&&this.BQa(this.Jkb,a)&&this.BQa(this.Zgb,
a)&&this.BQa(this.Gob,a)&&this.BQa(this.Lkb,a)&&this.BQa(this.i1a,a)&&this.BQa(this.Iob,a)&&this.BQa(this.Hob,a)}BQa(a,k){return!a||!a.length||a.length===k}}Object(D.a)(e,"MergeableTrackedChangesProperties",null,[])},1742:function(D,I,c){c.d(I,"a",function(){return a});D=c(0);var l=c(225),e=c(611);class a{constructor(){this.uKa=new l.a;this.uLa=new l.a;this.KNa=new l.a}get rBb(){return this.uKa}get okf(){return this.uLa}get Lrb(){return this.KNa}get isEmpty(){return!this.uKa.length&&!this.uLa.length&&
!this.KNa.length}get Nmb(){return Math.max(Math.max(this.uKa.length,this.uLa.length),this.KNa.length)}get fen(){return Math.min(Math.min(this.uKa.length,this.uLa.length),this.KNa.length)}eDd(k){this.uKa.add(k)}gDd(k){this.uLa.add(k)}kDd(k){this.KNa.add(k)}lFl(){const k=new e.a,x=new l.a;let y=0;for(;y<this.uKa.length||y<this.uLa.length||y<this.KNa.length;)y<this.uKa.length&&!k.contains(this.uKa.J(y))&&(x.add(this.uKa.J(y)),k.add(this.uKa.J(y))),y<this.uLa.length&&!k.contains(this.uLa.J(y))&&(x.add(this.uLa.J(y)),
k.add(this.uLa.J(y))),y<this.KNa.length&&!k.contains(this.KNa.J(y))&&(x.add(this.KNa.J(y)),k.add(this.KNa.J(y))),y++;return x}}Object(D.a)(a,"ObjectCollection",null,[])},1743:function(D,I,c){c.d(I,"a",function(){return G});D=c(0);var l=c(1033),e=c(16),a=c(367),k=c(225);c(60);c(816);var x=c(611),y=c(183),m=c(188),t=c(1060),z=c(1418),v=c(1794),H=c(1584),F=c(1789);class G{constructor(M){this.iB=new t.a;this.DW=new a.a;this.Gjh=new a.a(0);this.Fgd=new k.a;this.ZYg=new k.a;this.d8g=new k.a;this.q5g=new k.a;
this.n7g="";this.tXa=null;this.ys=this.UIe=0;this.Atd=new a.a(0);this.kBe=this.Bah=this.uqd=0;const {MarkerValidation:K}=c(1899);this._state=M;this.Nak=new K}get h0c(){return this.Nak}get D5i(){return this.tXa}aoo(M){this.UIe=M}u3d(M,K){this.n7g=String.format("{0}-{1}",M,K)}qhe(M){this.zYk();this.kBe=M}ceg(){this.kBe=0}zYk(){this.tXa&&this.Fgd.add(this.tXa);this.tXa=null}Rg(M){this.tXa||(this.tXa=M);switch(this.kBe){case 1:this.ZYg.add(M);break;case 2:this.d8g.add(M);break;case 3:this.q5g.add(M);
break;default:this.tXa&&this.Fgd.add(M)}}mKi(M){this.Fgd.add(M)}w6m(){this.ys=this.pFa();this.Pia("MergeEnd")}Pia(M){const K=this.pFa();this.Gjh.Z(M,K-this.UIe);this.UIe=K}Zlo(){this.uqd=this.pFa();this.Bah++}$U(M){const K=this.pFa();let L;({value:L}=this.Atd.Fc(M)).returnValue?(L+=K-this.uqd,this.Atd.Z(M,L)):this.Atd.Z(M,K-this.uqd);this.uqd=K}K4l(){this.DW.Z("Id",this._state.input.HLb.toString());this.DW.Z("Source",z.a[this._state.input.source]);this.DW.Z("RevSummary",G.YVa(this.gcm()));this.DW.Z("NodesRolledBackIfFailed",
G.YVa(this.O6l()));if(!this._state.output.succeeded){let M,K,L,R,S;({TJk:M,vBl:K,URo:L,YJk:R,WRo:S}=this.tDl(this._state.runtime));this.DW.Z("CharactersLost",this.iRl(M,K,L));this.DW.Z("CharactersLostInComments",this.mSl());this.DW.Z("CharactersLostInTables",this.GNl(S,R))}this.DW.Z("FuncStep",this.n7g);this.DW.Z("FailureDetail",G.YVa(this.eGb()));this.DW.Z("FailDetailHints",this.IRd(this.ZYg));this.DW.Z("FailDetailNaiveMerge",this.IRd(this.d8g));this.DW.Z("FailDetailLcs",this.IRd(this.q5g));this.DW.Z("ExtraDetails",
this.IRd(this.Fgd));this.DW.Z("Timeline",G.YVa(this.Gjh));this.DW.Z("ParagraphMergesCount",this.Bah);this.DW.Z("ParagraphMergeDurations",G.YVa(this.Atd));this.DW.Z("MarkerInfo",G.YVa(this.h0c.V8h()));this.DW.Z("Result",G.YVa(this.M4l()));return JSON.stringify(G.YVa(this.DW))}pFa(){return(new Date).getTime()}gcm(){const M=new a.a;let K,L,R;({rmg:K,btg:L,UDa:R}=this.Xrf(this._state,this._state.input.baa,this._state.input.$Va,this._state.input.jIb));M.Z("hasBase",R?"true":"false");if(R){let S=0,N=0;
for(;K&&!K.id.equals(R.id);)S++,K=K.tX;for(;L&&!L.id.equals(R.id);)N++,L=L.tX;M.Z("lenToBaseTheirs",K?S:-1);M.Z("lenToBaseYours",L?N:-1)}return M}Xrf(M,K,L,R){M=K.eg(K.length-1-(R?1:0));K=(L=L.eg(L.length-1))&&M?M.o2a(L):null;return{rmg:M,btg:L,UDa:K}}O6l(){if(!this._state.runtime.msi)return null;const M=this._state.runtime.Nq,K=new a.a(0);M.forEach((L,R)=>{({value:L}=K.Fc(R.Qc.toString()));K.Z(R.Qc.toString(),L+1);return!0});return K}iRl(M,K,L){let R=null,S=null,N=null;const O=this._state.runtime.Nq;
let W=0;try{N=new F.a(this.iB,this._state);R=H.b(M,K,L);S=new x.a;for(M=0;M<R.length;M++)if(!R.J(M).rBb.Dq(R.J(M).Lrb,(V,Q)=>V.equals(Q))){const V=this.YSh(R.J(M),N);W+=V;S.add(R.J(M))}R&&O.forEach((V,Q)=>{if(393230===Q.Qc){Q=null;for(let Y=0;Y<R.length;Y++)if(!S.contains(R.J(Y))&&R.J(Y).Lrb.contains(V,(ba,Z)=>ba===Z)){Q=R.J(Y);break}Q&&(V=this.YSh(Q,N),S.add(Q),W+=V)}return!0});return W}catch(V){return y.a.instance.Ua(579190992,1,2,"Exception in GetCharactersLost: "+V.toString()),-1}}tDl(M){let K,
L,R,S,N;M.eH=W=>{if(750<this.pFa()-this._state.input.PUa)throw y.a.instance.Ua(579190991,1,2,"Timed out while calculating characters lost: {0}",W),m.a.invalidOperation(W);};K=new k.a;L=new k.a;R=new k.a;S=new k.a;const O=new k.a;N=new k.a;try{if(M.vk){const W=M.vk.J(v.ChildNodeListMerge.Q9d);let V,Q;V=M.Lu.J(v.ChildNodeListMerge.Q9d)||W;Q=M.Nq.J(v.ChildNodeListMerge.Q9d)||W;this.Pkf(W,Y=>M.vk.J(Y),K,S);this.Pkf(V,Y=>M.Lu.J(Y)||M.vk.J(Y),L,O);this.Pkf(Q,Y=>M.Nq.J(Y)||M.vk.J(Y),R,N)}}catch(W){y.a.instance.Ua(573089732,
1,2,"Exception in FindAllParagraphAndTableIds: "+W.toString())}return{TJk:K,vBl:L,URo:R,YJk:S,WRo:N}}GNl(M,K){try{let R=0;const S=this._state.runtime;var L=W=>S.Nq.J(W)||S.vk.J(W);const N=new x.a,O=this.fFl(M,S,L,N);for(M=0;M<O.count;M++){let W=O.keys.J(M);const V=O.J(W);if(!N.contains(W)){let Q=this.tii(S,L,N,W,V);if(-1!==Q)R+=Q;else return y.a.instance.Ua(573089733,1,2,"Error calculating characters lost between base and unfavored tables"),-1}}for(L=0;L<K.length;L++){let W=K.J(0);if(!N.contains(W)){let V=
this.VUd(S.vk.J(W));if(-1===V)return y.a.instance.Ua(573089734,1,2,"Error calculating characters lost in table deleted from base"),-1;R+=V}}return R}catch(R){return y.a.instance.Ua(573089735,1,2,"Exception in GetAllTablesCharactersLost: "+R.toString()),-1}}tii(M,K,L,R,S){M.eH("GetTableCharactersLost");let N=0;S=this.iB.getPropertyObjectIds(S,e.a.gf);for(let Y=0;Y<S.length;Y++){var O=K(S.J(Y));O=this.iB.getPropertyObjectIds(O,e.a.gf);for(let ba=0;ba<O.length;ba++){var W=K(O.J(ba));if(M.vk.J(S.J(Y))&&
M.vk.J(O.J(ba))){var V=M.vk.J(O.J(ba));if(!V)return y.a.instance.Ua(573089737,1,2,"Base cell unexpectedly null"),-1;W=this.iB.getPropertyObjectIds(V,e.a.gf);var Q=M.Lu.J(O.J(ba))||M.vk.J(O.J(ba));Q=this.iB.getPropertyObjectIds(Q,e.a.gf);V=this.iB.getPropertyObjectIds(V,e.a.gf);W=H.b(W,Q,V);for(V=0;V<W.length;V++){Q=W.J(V);const Z=this.Wgm(M,K,L,Q);if(-1===Z)return y.a.instance.Ua(573089738,1,2,"Error getting characters lost for parition {0}",Q.toString()),-1;N+=Z}}else{V=this.Khm(K,W,L);if(-1===V)return y.a.instance.Ua(573089736,
1,2,"Error getting text length of cell {0}",W.id.toString()),-1;N+=V}}}L.add(R);return N}Wgm(M,K,L,R){let S=0;var N=new k.a,O=new k.a;const W=new a.a;new a.a;for(var V=0;V<R.rBb.length;V++){var Q=M.vk.J(R.rBb.J(V));Q=this.iB.getPropertyObjectIds(Q,e.a.$K);if(1!==Q.length)return y.a.instance.Ua(573089739,1,2,"Unexpected number of ContentNodes: {0}",Q.length),-1;var Y=M.vk.J(Q.J(0));393230===Y.Qc?N.add(Y):393250===Y.Qc&&W.add(Q.J(0),Y)}for(V=0;V<R.Lrb.length;V++){Q=K(R.Lrb.J(V));Q=this.iB.getPropertyObjectIds(Q,
e.a.$K);if(1!==Q.length)return y.a.instance.Ua(573089740,1,2,"Unexpected number of ContentNodes: {0}",Q.length),-1;Y=K(Q.J(0));if(393230===Y.Qc)O.add(Y);else if(393250===Y.Qc){Y=this.tii(M,K,L,Q.J(0),Y);if(-1===Y)return y.a.instance.Ua(573089741,1,2,"Error diffing table {0}",Q.J(0).toString()),-1;S+=Y}}V=new F.a(this.iB,this._state);if(0<N.length&&0<O.length){N=V.b0h(N,ba=>M.vk.J(ba),O,ba=>K(ba));if(-1===N)return y.a.instance.Ua(573089742,1,2,"Problem diffing parition {0} with LCS",R.toString()),
-1;S+=N}else if(0<N.length)for(R=0;R<N.length;R++)S+=this.iB.getPropertyString(N.J(R),e.a.wo).length+1;else if(0<O.length)for(R=0;R<O.length;R++)S+=this.iB.getPropertyString(O.J(R),e.a.wo).length+1;for(R=0;R<W.count;R++)if(N=W.keys.J(R),!L.contains(N)){O=this.VUd(W.J(N));if(-1===O)return y.a.instance.Ua(573089743,1,2,"Error getting length of table {0}",N.toString()),-1;S+=O}return S}Khm(M,K,L){let R=0;K=this.iB.getPropertyObjectIds(K,e.a.gf);for(let O=0;O<K.length;O++){var S=M(K.J(O));S=this.iB.getPropertyObjectIds(S,
e.a.$K);if(1!==S.length)return y.a.instance.Ua(573089744,1,2,"Unexpected number of ContentNodes: {0}",S.length),-1;var N=M(S.J(0));if(393230===N.Qc)R+=this.iB.getPropertyString(N,e.a.wo).length+1;else if(393250===N.Qc){N=this.VUd(N);if(-1===N)return y.a.instance.Ua(573089745,1,2,"Problem finding text length of table {0}",S.J(0).toString()),-1;R+=N;L.add(S.J(0))}}return R}VUd(M){this._state.runtime.eH("GetTextLengthOfTable");let K=0;const L=W=>this._state.runtime.Nq.J(W)||this._state.runtime.vk.J(W);
M=this.iB.getPropertyObjectIds(M,e.a.gf);for(let W=0;W<M.length;W++){var R=L(M.J(W));R=this.iB.getPropertyObjectIds(R,e.a.gf);for(let V=0;V<R.length;V++){var S=L(R.J(V));S=this.iB.getPropertyObjectIds(S,e.a.gf);for(let Q=0;Q<S.length;Q++){var N=L(S.J(Q));N=this.iB.getPropertyObjectIds(N,e.a.$K);if(1!==N.length)return y.a.instance.Ua(573089746,1,2,"Unexpected number of ContentNodes: {0}",N.length),-1;var O=L(N.J(0));if(393230===O.Qc)K+=this.iB.getPropertyString(O,e.a.wo).length+1;else if(393250===
O.Qc){O=this.VUd(O);if(-1===O)return y.a.instance.Ua(573089747,1,2,"Error finding the text length of table {0}",N.J(0)),-1;K+=O}}}}return K}fFl(M,K,L,R){const S=new a.a;for(let N=0;N<M.length;N++){let O=!1;K.Nq.J(M.J(N))&&(O=!0);const W=L(M.J(N)),V=this.iB.getPropertyObjectIds(W,e.a.gf);if(!O)for(let Q=0;Q<V.length;Q++)if(K.Nq.J(V.J(Q))){O=!0;break}O?S.add(M.J(N),W):R.add(M.J(N))}return S}YSh(M,K){return this.XSh(M.rBb,M.Lrb,K)}XSh(M,K,L){const R=new k.a;for(var S=0;S<M.length;S++)R.add(this._state.runtime.vk.J(M.J(S)));
M=new k.a;for(S=0;S<K.length;S++)M.add(this._state.runtime.Nq.J(K.J(S))||this._state.runtime.vk.J(K.J(S)));return L.b0h(R,N=>this._state.runtime.vk.J(N),M,N=>this._state.runtime.Nq.J(N)||this._state.runtime.vk.J(N))}Pkf(M,K,L,R){if(393227===M.Qc){M=this.iB.getPropertyObjectIds(M,e.a.gf);for(let S=0;S<M.length;S++){const N=this.iB.getPropertyObjectIds(K(M.J(S)),e.a.gf);for(let O=0;O<N.length;O++){const W=this.iB.getPropertyObjectIds(K(N.J(O)),e.a.gf);for(let V=0;V<W.length;V++){const Q=this.iB.getPropertyObjectIds(K(W.J(V)),
e.a.$K);if(1!==Q.length)return;const Y=K(Q.J(0));393230===Y.Qc?L.add(Q.J(0)):393250===Y.Qc?R.add(Q.J(0)):y.a.instance.Ua(573089748,1,2,"Unsupported class id in GetCharactersLost: "+l.a[Y.Qc])}}}}}Qkf(M,K){M=this.iB.getPropertyObjectIds(M,e.a.gf);const L=new k.a;for(let R=0;R<M.length;R++){const S=this.iB.getPropertyObjectIds(K(M.J(R)),e.a.$K);if(1!==S.length)return null;L.add(S.J(0))}return L}mSl(){let M=0;const K=this._state.runtime,L=K.Nq,R=N=>K.Nq.J(N)||K.vk.J(N);let S=null;K.eH=N=>{if(750<this.pFa()-
this._state.input.PUa)throw y.a.instance.Ua(573089749,1,2,"Timed out while calculating comment characters lost: {0}",N),m.a.invalidOperation(N);};try{L.forEach((N,O)=>{if(1074135127===O.Qc){N=this.Qkf(O,R);var W=K.vk.J(O.id);if(W)W=this.Qkf(W,Q=>K.vk.J(Q)),S||(S=new F.a(this.iB,this._state)),M+=this.XSh(W,N,S);else for(W=0;W<N.length;W++)M+=this.iB.getPropertyString(K.Nq.J(N.J(W)),e.a.wo).length+1}if(1074135126===O.Qc&&(N=this.iB.getPropertyObjectIds(O,e.a.gf).fH(),O=K.vk.J(O.id)))for(O=this.iB.getPropertyObjectIds(O,
e.a.gf),W=0;W<O.length;W++)if(!N.contains(O.J(W))){var V=K.vk.J(O.J(W));V=this.Qkf(V,Q=>K.vk.J(Q));for(let Q=0;Q<V.length;Q++)M+=this.iB.getPropertyString(K.vk.J(V.J(Q)),e.a.wo).length+1}return!0})}catch(N){return y.a.instance.Ua(573089750,1,2,"Exception in GetCommentCharactersLost: "+N.toString()),-1}return M}eGb(){return this.tXa?this.tXa.eGb():null}IRd(M){const K=new k.a;M.forEach(L=>{K.add(G.YVa(L.eGb()));return!0});return K.toArray()}M4l(){const M=new a.a;M.Z("Succeeded",this._state.output.succeeded);
M.Z("Timeout",this._state.output.timeout);M.Z("Crash",this._state.output.crash);M.Z("MergedRevisions",this._state.output.$M?this._state.output.$M.length:-1);M.Z("Duration",this.ys-this._state.input.PUa);return M}static YVa(M){if(!M)return null;const K={};M.forEach((L,R)=>{K[L.toString()]=R;return!0});return K}}Object(D.a)(G,"MergeLogger",null,[])},1744:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e,a){this.UJa=a;this.updateHints=e}}Object(D.a)(l,"UpdateHintCollection",
null,[])},1745:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(1585);class l extends c.a{constructor(e,a){super();this.Bg=e;this.Wc=a}get type(){return 9}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",this.cp,this.type,this.Bg,this.Wc)}}Object(D.a)(l,"LcsInsertParaUpdateHint",c.a,[])},1746:function(D,I,c){c.d(I,"a",function(){return e});D=c(0);var l=c(225);c=c(1585);class e extends c.a{constructor(a){super();this.y0=new l.a;this.cp=a}get type(){return 11}toString(){let a=
"";for(let k=0;k<this.y0.length;k++)a+=String.format("({0}), ",this.y0.J(k).toString());return String.format("[Cp:{0}] {1}",this.cp,a)}}Object(D.a)(e,"LcsInsertUpdateHint",c.a,[])},1747:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(1585);class l extends c.a{constructor(e,a){super();this.text=a;this.Bg=e}get type(){return 7}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [Text:{3}]",this.cp,this.type,this.Bg,this.text)}}Object(D.a)(l,"LcsInsertTextUpdateHint",c.a,[])},
1748:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(1585);class l extends c.a{constructor(e,a,k){super();this.cp=e;this.Bg=a;this.Wc=k}get type(){return 10}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",this.cp,this.type,this.Bg,this.Wc)}}Object(D.a)(l,"LcsDeleteParaUpdateHint",c.a,[])},1749:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(1585);class l extends c.a{constructor(e,a){super();this.cp=e;this.text=a}get type(){return 8}toString(){return String.format("[Cp:{0}] [Type:{1}] [Text:{2}]",
this.cp,this.type,this.text)}}Object(D.a)(l,"LcsDeleteTextUpdateHint",c.a,[])},1750:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);c=c(1557);class l extends c.a{constructor(){super()}get tha(){return"Conflict"}}Object(D.a)(l,"ConflictMergeFailureDetail",c.a,[])},1751:function(D,I,c){c.r(I);c.d(I,"InsightsMenuItemFactory",function(){return k});D=c(0);var l=c(1519),e=c(164),a=c(19);class k{constructor(x=null){this.p7j=x||CommonUIStrings.l_InsightsButtonText}get tPb(){return 10}Zga(x){var y=
x.hD;x=l.a.Lpa()?l.a.VOa(y,1):l.a.sDb(y);y=String.format(this.p7j,y);return this.YKl(x,y)}YKl(x,y){return e.a(k.Cti,l.a.Lpa()?"1914896509":"3317204163",a.a.zf(y),l.a.ICf,null,a.a.zf(x),a.a.zf(y),null,null)}}k.Cti="bInsights";Object(D.a)(k,"InsightsMenuItemFactory",null,[1111])},1752:function(D,I,c){c.d(I,"a",function(){return a});D=c(0);var l=c(164),e=c(19);class a{constructor(k,x,y,m,t){this.VRe=k;this.URe=x;this.smk=y;this.Q5j=m;this.KZg=t}get tPb(){return 4}Zga(k,x=null){x=x.sessionId+"|"+x.rpa+
"|"+k.hD;if(this.KZg||this.Q5j){let y=this.KZg||e.a.ZA(CommonUIStrings.l_HelpTooltip)===e.a.ZA(k.hD.trim());if(this.smk&&2<k.hD.length){const m=k.hD;";"===m.charAt(0)&&";"===m.charAt(m.length-1)&&m.substring(1,m.length-1)===a.xzf&&(y=!0)}k=y?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,k.hD);return this.q4h(x,e.a.zf(k),y)}return this.q4h(x,e.a.zf(String.format(CommonUIStrings.l_TextWithQuotation,k.hD)),!1)}q4h(k,x,y){return l.a(a.xzf,y?this.URe:this.VRe,
x,"OfficeAssistant_16x16x32","A0",e.a.zf(k),x,null,null)}}a.xzf="bSearchHelp";Object(D.a)(a,"AssistanceMenuItemFactory",null,[1111])},1753:function(D,I,c){c.d(I,"a",function(){return x});D=c(0);var l=c(2),e=c(164),a=c(91),k=c(19);class x{get tPb(){return 13}Zga(){return x.INk()}static INk(){return e.b(x.g1h,"798637440",k.a.zf(CommonUIStrings.l_LookupFirstRunExperienceTitle),l.AFrameworkApplication.Ns,a.getImageClass("Info_32x32x32"),null,null,k.a.zf(CommonUIStrings.l_LookupFirstRunExperienceTitle),
"Menu32",null,null,k.a.zf(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}x.g1h="bTellMeFirstRun";Object(D.a)(x,"FirstRunMenuItemFactory",null,[1111])},1754:function(D,I,c){c.d(I,"a",function(){return k});D=c(0);var l=c(2),e=c(164),a=c(19);class k{constructor(x=null,y=null){this.A8g=x;this.cck=y||CommonUIStrings.l_LookupNoResultsDescription}get tPb(){return 14}Zga(x){x=String.format(this.cck,x.hD);return this.wOk(x)}wOk(x){return e.b(k.PRi,"798637440",a.a.zf(CommonUIStrings.l_LookupNoResultsTitle),
this.A8g?l.AFrameworkApplication.Ns:null,this.A8g,null,null,a.a.zf(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,a.a.zf(x),null,null)}}k.PRi="lookupNoResults";Object(D.a)(k,"NoCommandsFoundMenuItemFactory",null,[1111])},1755:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(e,a){this.FontWeight=0;this.Text=null;this.FontWeight=e;this.Text=a}}Object(D.a)(l,"LabelFormatted",null,[])},1756:function(D,I,c){c.d(I,"a",function(){return y});D=c(0);c(1522);var l=c(1524),
e=c(1527),a=c(1526),k=c(1519),x=c(19);class y{constructor(m){this.fc=m}oL(){return"Assistance"}BU(){return 0===this.fc.hv?0:1===this.fc.hv?1:this.fc.M2c?3:2}dI(m,t,z=!1,v,H=null){v=new a.a(m);if((!H||Array.contains(H,8))&&!k.a.FR(m)){H=new e.a(8);if(z){z=x.a.ZA(CommonUIStrings.l_HelpTooltip)===x.a.ZA(m.Gg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,m.Gg);const F=[];this.fc.Y4a&&(this.fc.Lie||F.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",
{"default":"search_20"})),z=this.mdi(m.Gg));const G="||"+m.Gg;F.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",z));F.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",G));appChrome.api.dispatch(F);m=new l.a("GetHelpFromTellMe",4,m.Gg,null,1)}else m=new l.a("bSearchHelp",4,m.Gg,null,1);H.Uw(m);H.displayName=CommonUIStrings.l_HelpButtonTitle;v.dv(H)}t.resultsUpdated(v)}Rjb(m,t=null){const z=new e.a(8),v=x.a.ZA(CommonUIStrings.l_HelpTooltip)===x.a.ZA(m.Gg.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:
String.format(CommonUIStrings.l_TextWithQuotation,m.Gg);for(let F=0;F<t.length&&2>F;F++){var H=void 0;H=[];let G="GetHelpWithDescriptionFromTellMe"+(F+1).toString(),M=4;if(this.fc.z$c)H.push(appChrome.actions.setControlLabel(G,v)),H.push(appChrome.actions.setCompoundButtonCommandValueId(G,m.Gg)),H.push(appChrome.actions.updateCompoundButtonDescription(G,this.Uvf(t.length)));else if(this.fc.A$c){let K=this.Eji(t[F]);G="GetHelpFromTellMe"+(F+1).toString();this.fc.Y4a&&(K=this.mdi(K));M=9;H.push(appChrome.actions.setControlLabel(G,
K));H.push(appChrome.actions.setButtonCommandValueId(G,this.Bim(t[F])))}appChrome.api.dispatch(H);H=new l.a(G,M,null,null,0);H.label=this.Eji(t[F]);H.description=this.Aim(t[F]);z.Uw(H);if(this.fc.A$c)break}z.displayName=CommonUIStrings.l_HelpButtonTitle;return z}Uvf(m){return 1===m?String.format(CommonUIStrings.l_SearchResultText,m):String.format(CommonUIStrings.l_SearchResultsText,m)}mdi(m){return this.fc.jIf?k.a.arf(m,CommonUIStrings.l_HelpScopedButtonText):m+CommonUIStrings.l_HelpScopedButtonText}Eji(m){return m.name?
m.name:""}Aim(m){return m.description?m.description:""}Bim(m){return m.id?"AssetID="+m.id:""}}Object(D.a)(y,"AssistanceResultsProvider",null,[1112])},1757:function(D,I,c){c.d(I,"a",function(){return m});D=c(0);c(1522);var l=c(1524),e=c(1527),a=c(1526),k=c(1520),x=c(1519),y=c(1556);class m{constructor(t){this.fc=t}oL(){return"Image"}BU(){return 0===this.fc.hv?0:1===this.fc.hv?1:3===this.fc.hv?3:2}dI(t,z,v,H,F=null){v=new a.a(t);(!F||Array.contains(F,19))&&x.a.FR(t)&&this.fc.XP&&this.Rjb(t,v,1);z.resultsUpdated(v)}Rjb(t,
z,v,H=null){var F=[];let G;k.TellMeActor.instance.cP()&&k.TellMeActor.instance.cP().Y4a?(G=this.fc.jIf?x.a.arf(t.Gg,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):t.Gg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.fc.Lie||F.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):G=this.fc.XP?x.a.FR(t)?this.fc.hfb?x.a.Kib(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:
this.fc.hfb?x.a.Kib(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,t.Gg)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,t.Gg):this.fc.Hlc?CommonUIStrings.l_TellMeImageSuggestionButtonText:t.Gg+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.fc.bxa?(k.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",G)),F=x.a.VOa(t.Gg,9,Object.assign(new y.a,{landingTab:"Image"})),k.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",
F))):(F.push(appChrome.actions.setControlLabel("ImageForSearch",G)),t=x.a.VOa(t.Gg,9,Object.assign(new y.a,{landingTab:"Image"})),F.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",t)),appChrome.api.dispatch(F));v=new l.a("ImageForSearch",12,null,null,v);H&&(v.score=H.ConfidenceScore);H=new e.a(19,this.fc.Hlc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);H.Uw(v);z.dv(H)}}Object(D.a)(m,"ImageResultsProvider",null,[1112])},1758:function(D,I,c){c.d(I,"a",function(){return y});
D=c(0);c(1522);var l=c(1524),e=c(1527),a=c(1526),k=c(1519),x=c(2);class y{constructor(m){this.fc=m}oL(){return"Template"}BU(){return 0===this.fc.hv?0:1===this.fc.hv?1:3}dI(m,t){m=new a.a(m);t.resultsUpdated(m)}Rjb(m,t,z){var v=[];let H;H=this.fc.XP?this.fc.hfb?k.a.Kib(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,m.Gg)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,m.Gg):String.format(CommonUIStrings.l_TellMeTemplateButtonText,m.Gg);v.push(appChrome.actions.setControlLabel("TemplateForSearch",
H));v.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",String.format(x.AFrameworkApplication.K.kb("TellMeTemplateProviderURL"),x.AFrameworkApplication.uiCulture,m.Gg)));appChrome.api.dispatch(v);m=new e.a(23);m.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;v=new l.a("TemplateForSearch",24,null,null,0);v.label=z[0].Title?z[0].Title:"";v.description=z[0].Description?z[0].Description:"";m.Uw(v);t.dv(m)}}Object(D.a)(y,"TemplateResultsProvider",null,[1112])},1759:function(D,
I,c){c.d(I,"a",function(){return z});D=c(0);c(1522);var l=c(1559),e=c(1524),a=c(1527),k=c(1526),x=c(1660),y=c(1520),m=c(1519),t=c(19);class z{constructor(v,H,F,G){this.q3=v;this.oeb=H;this.mkh=G;this.m3j=F;this.fc=y.TellMeActor.instance.cP()}oL(){return"EmptyQuery"}BU(){return 1===this.fc.hv?1:0}dI(v,H,F=!1,G,M=null){G=new k.a(v);if((!M||Array.contains(M,5)||Array.contains(M,6)||Array.contains(M,4))&&m.a.FR(v)){this.q3.dQc().length||!this.m3j||this.mkh||(v=new a.a(6),M=new e.a(null,13,void 0,void 0,
1),v.Uw(M),G.dv(v));v=new a.a(4);if(0<this.q3.dQc().length){v.displayName=CommonUIStrings.l_TellMeRecentlyUsedTitle;M=this.q3.dQc();var K=[];for(var L of M)K.push(L.Id);l.CommandResultsUtility.rdd(K,this.fc);for(var R of M)l.CommandResultsUtility.fWc(R.Id)&&v.Uw(new e.a(R.Id,5,null,null,2));G.dv(v)}if(this.mkh&&0<this.oeb.length&&this.q3.dQc().length<z.maxResults){L=new a.a(5);L.displayName=CommonUIStrings.l_TellMeTryQueryTitle;R=z.maxResults-v.results.length;v=[];for(M=0;M<this.oeb.length&&M<R;++M){if(F){K=
m.a.oog+(M+1);const S=this.oeb[M].key,N=t.a.replaceAll(S,'"',"");v.push(appChrome.actions.setControlLabel(K,S));v.push(appChrome.actions.setButtonCommandValueId(K,N));K=new x.a(S,7,0,N,K)}else K=new x.a(this.oeb[M].key,7,0,this.oeb[M].value);L.Uw(K)}0<v.length&&appChrome.api.dispatch(v);G.dv(L)}}H.resultsUpdated(G)}}z.maxResults=5;Object(D.a)(z,"EmptyQueryResultsProvider",null,[1112])},1760:function(D,I,c){c.d(I,"a",function(){return l});D=c(0);class l{constructor(){this.yle=this.OQa=this.kkb=this.Px=
this.OEd=this.VF=this.ETb=0}}Object(D.a)(l,"TRIESCAN",null,[])},1762:function(D,I,c){c.d(I,"a",function(){return F});D=c(0);var l=c(2),e=c(405),a=c(712),k=c(400),x=c(734);c.n(x);var y=c(752);c.n(y);var m=c(52),t=c(772),z=c(371),v=c(370),H=c(7);c=c(259);class F extends c.a{constructor(G,M){super("SummaryGenerationCondition");this.akg=-1;this.Qjj=()=>{if(!F.lkg&&this.Rpe.Ey>F.ien){const K=a.a.getAugLoopRuntimeManager(),L=this.ZPd();this.akg=Date.now();K.submitOperation(Object.assign(new v.a,{operation:L}))}};
this.Rjj=()=>{this.Qjj();this.Rpe.Sde(this.Rjj)};this.Wnb=K=>{K=K.items[0];x.TextSummaryAnnotation.typeGuard(K.body)||x.GptSummaryAnnotation.typeGuard(K.body)||y.TextAbstractiveSummaryAnnotation.typeGuard(K.body)?(F.lkg=K.body,"Success"!==F.lkg.status?this.pg(!1):(this.pg(!0),this.m6m())):(H.ULS.sendTraceTag(508944770,3047,10,`unexpected annotation: ${m.a.getTypeNameFor(K.body)}`),this.pg(!1))};this.Rpe=M.getInstance(0);this.Jl=G.Jl}static get summary(){return F.lkg}initialize(){super.initialize();
k.a.ml().then(()=>{const G=a.a.getAugLoopRuntimeManager();let M;M=this.Gzi()?x.GptSummaryAnnotation.getTypeName():this.UVc()?y.TextAbstractiveSummaryAnnotation.getTypeName():x.TextSummaryAnnotation.getTypeName();G.activateAnnotation(Object.assign(new e.a,{annotationType:M,handler:this.Wnb}))});-1===this.Rpe.Ey?this.Rpe.ZAb(this.Rjj):this.Qjj()}Od(){super.Od()}UVc(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AzureTextSummarizationIsEnabled",!1)}Gzi(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.KeypointsSummaryEnabled",
!1)}ZPd(){return this.Gzi()?Object.assign(new t.l,{parentPath:["Signal",x.GptSummarySignal.getTypeName()],items:[Object.assign(new z.a,{body:new x.GptSummarySignal})]}):this.UVc()?Object.assign(new t.l,{parentPath:["Signal",y.GenerateTextAbstractiveSummarySignal.getTypeName()],items:[Object.assign(new z.a,{body:new y.GenerateTextAbstractiveSummarySignal({clientApplication:"Editor"})})]}):Object.assign(new t.l,{parentPath:["Signal",x.GenerateTextSummarySignal.getTypeName()],items:[Object.assign(new z.a,
{body:new x.GenerateTextSummarySignal})]})}pg(G){super.pg(G);H.ULS.sendTraceTag(508944769,3028,50,this.GO(this.Jl,G))}m6m(){if(-1!==this.akg){var G=Date.now()-this.akg;H.ULS.sendTraceTag(508925082,3047,50,"[Copilot Chat][Summarization] Latency for summary generation response (ms): {0}",G)}}}F.ien=300;Object(D.a)(F,"SummaryGenerationCondition",c.a,[])},1785:function(D,I,c){c.r(I);var l=c(0),e=c(1522),a=c(1570),k=c(1540),x=c(1524),y=c(1527),m=c(1526),t=c(1520),z=c(1519),v=c(1556);class H{constructor(db){this.fc=
db}oL(){return"ActionAI"}BU(){return 0===this.fc.hv?0:1===this.fc.hv?1:2}dI(db,Lb,kc=!1,Kc,Qc=null){Kc=new m.a(db);if(!Qc||Array.contains(Qc,24))if(this.fuo()||!z.a.FR(db)){Qc=new y.a(24);var md=z.a.FR(db);kc&&(kc=null,z.a.Lpa()&&(kc=z.a.VOa(md?"":db.Gg,1,Object.assign(new v.a,{landingTab:"ActionAI"}))),this.fc.bxa?kc&&t.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",kc)):(db=[],kc&&db.push(appChrome.actions.setButtonCommandValueId("ActionAIFromTellMe",
kc)),appChrome.api.dispatch(db)));Qc.Uw(new x.a("ActionAIFromTellMe",25,null,null,1));Kc.dv(Qc)}Lb.resultsUpdated(Kc)}fuo(){return z.a.Lpa()&&this.fc.pDf}}Object(l.a)(H,"ActionAIResultsProvider",null,[1112]);var F=c(1673);class G{constructor(db,Lb){this.HAa=db;this.Xk=Lb}resultsUpdated(db){this.HAa.Xmo(this.Xk,db)}}Object(l.a)(G,"AggregatorResultsProviderCallback",null,[1114]);class M{constructor(db){this.qsa=null;this.fc=db;this.fc.jBb&&(this.qsa=null)}oL(){return"AppsForOffice"}BU(){return 0===
this.fc.hv?0:1===this.fc.hv?1:2}dI(db,Lb,kc,Kc,Qc=null){kc=new m.a(db);if(!Qc||Array.contains(Qc,1))Qc=new y.a(1),this.qsa.Fep(Qc,db.Gg),kc.dv(Qc);Lb.resultsUpdated(kc)}}Object(l.a)(M,"AppsForOfficeRecommendationResultsProvider",null,[1112]);var K=c(1756),L=c(1515),R=c(1535),S=c(112);class N{constructor(db,Lb){this.Bb=db;this.s9m=Lb}isMatch(db,Lb){if(!Object(S.a)(1238,db))throw Error.argument("objToTest","Expected feature bundle");let kc;return({value:kc}=db.Mq(this.Bb.Vua)).returnValue?this.Bb.zrg.isMatch(kc,
Lb):this.s9m}}Object(l.a)(N,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[1262]);class O{constructor(db,Lb){this.Bb=db;this.qOf=Lb}isMatch(db){if(!Object(S.a)(1238,db))throw Error.argument("objToTest","Expected feature bundle");return!!(this.qOf^db.Mq(this.Bb.Vua).returnValue)}}Object(l.a)(O,"AnnotatedWithAnnotationFilter",null,[1262]);class W{constructor(db){this.Bb=db}isMatch(db,Lb){if(!Object(S.a)(1241,db))throw Error.argument("objToTest","Expected struct value");return this.Bb.zrg.isMatch(db.ajb(this.Bb.CPa),
Lb)}}Object(l.a)(W,"FieldValueMatchesStructFilter",null,[1262]);class V{constructor(db,Lb){db&&(this.CPa=db.J(0),this.zrg=Lb.Doa(db.J(1)))}}Object(l.a)(V,"FieldValueMatchesStructFilterInit",null,[]);class Q{constructor(db){this.qOf=db}isMatch(db){if(!Object(S.a)(1238,db))throw Error.argument("objToTest","Expected feature bundle");return!!(this.qOf^db.Gyf)}}Object(l.a)(Q,"HasAnnotationsAnnotationFilter",null,[1262]);class Y{constructor(db,Lb){this.Bb=db;this.Q9=Lb}isMatch(db,Lb){if(!Object(S.a)(1240,
db))throw Error.argument("objToTest","Expected list value");switch(this.Q9){case 0:for(const kc of db.items)if(this.Bb.filter.isMatch(kc,Lb))return!0;return!1;case 1:for(const kc of db.items)if(!this.Bb.filter.isMatch(kc,Lb))return!1;return!0;default:throw Error.notImplemented();}}}Object(l.a)(Y,"ItemTestListFilter",null,[1262]);class ba{constructor(db){this.Bb=db}isMatch(db,Lb){if(!Object(S.a)(1240,db))throw Error.argument("objToTest","Expected list value");return this.Bb.filter.isMatch(db.items.length,
Lb)}}Object(l.a)(ba,"LengthMatchesListFilter",null,[1262]);class Z{constructor(db,Lb){this.Bb=db;this.Q9=Lb}isMatch(db,Lb,kc=null){let Kc=0===this.Q9;for(const Qc of this.Bb.mEh)if((Kc=Qc.isMatch(db,Lb,kc))?1===this.Q9:0===this.Q9)return Kc;2===this.Q9&&(Kc=!Kc);return Kc}}Object(l.a)(Z,"NonterminalFilter",null,[1262]);class ea{constructor(db,Lb){if(db){var kc=db.J(0);this.mEh=Array(kc);for(let Kc=0;Kc<kc;++Kc)this.mEh[Kc]=Lb.Doa(db.J(1+Kc))}}}Object(l.a)(ea,"NonterminalFilterInit",null,[]);class ha{constructor(db,
Lb){this.Bb=db;this.Q9=Lb}isMatch(db,Lb){if("number"!==typeof db)throw Error.argument("objToTest","Expected number value");let kc=this.Bb.number;if(this.Bb.query){Lb=this.Bb.query.Ot(null,Lb);if("number"!==typeof Lb)throw Error.invalidOperation("Query did not return number");kc+=Lb}switch(this.Q9){case 0:return db===kc;case 1:return db<kc;case 2:return db<=kc;case 3:return db>kc;case 4:return db>=kc;default:throw Error.notImplemented();}}}Object(l.a)(ha,"NumberFilter",null,[1262]);class ka{constructor(db,
Lb){db&&(this.number=db.J(0),this.query=db.J(1)?Lb.hL(db.J(1)):null)}}Object(l.a)(ka,"NumberFilterInit",null,[]);class ua{constructor(db,Lb,kc){this.JRd=this.MXl;this.y9m=db;this.yMi=Lb;this.xMi=kc}s7e(db){this.yMi=db}MXl(db){if(!db)throw Error.argument("name","Invalid named feature bundle reference");const Lb=db.substr(1);return 1===db.charCodeAt(0)&&Lb===this.y9m?this.yMi:this.xMi?this.xMi.JRd(db):null}}Object(l.a)(ua,"SimpleNamedFeatureBundleResolver",null,[1282]);class sa{constructor(db){this.Bb=
db}isMatch(db,Lb){if(!Object(S.a)(1238,db))throw Error.argument("objToTest","Expected feature bundle");db=this.Bb.query.Ot(null,new ua(this.Bb.npe,db,Lb));if("boolean"!==typeof db)throw Error.invalidOperation("Query did not return bool");return db}}Object(l.a)(sa,"PredicateAnnotationFilter",null,[1262]);class Da{constructor(db,Lb){db&&(this.npe=Lb.IB(db.J(0)),this.query=Lb.hL(db.J(1)))}}Object(l.a)(Da,"PredicateAnnotationFilterInit",null,[]);class Pa{constructor(db){this.Bb=db}isMatch(db,Lb){if("boolean"!==
typeof db)throw Error.argument("objToTest","Expected bool value");Lb=this.Bb.query.Ot(null,Lb);if("boolean"!==typeof Lb)throw Error.invalidOperation("Query did not return bool");return db===Lb}}Object(l.a)(Pa,"QueryBooleanFilter",null,[1262]);class Ra{constructor(db,Lb){this.Bb=db;this.Q9=Lb}isMatch(db,Lb){if("number"!==typeof db)throw Error.argument("objToTest","Expected integer");Lb=this.Bb.query.Ot(null,Lb);if("number"!==typeof Lb)throw Error.invalidOperation("Query did not return an enum value");
switch(this.Q9){case 0:return db===Lb;case 1:return 0!==(db&Lb);case 2:return db===(db&Lb);case 3:return Lb===(db&Lb);default:throw Error.notImplemented();}}}Object(l.a)(Ra,"QueryEnumFilter",null,[1262]);class Ga{constructor(db,Lb){db&&(this.Z_d=1===db.J(0),this.query=Lb.hL(db.J(1)))}}Object(l.a)(Ga,"QueryEnumFilterInit",null,[]);class ta{constructor(db,Lb){this.Bb=db;this.Q9=Lb}isMatch(db,Lb){if(!Object(S.a)(1240,db))throw Error.argument("objToTest","Expected list value");Lb=this.Bb.query.Ot(null,
Lb);if(!Object(S.a)(1240,Lb))throw Error.invalidOperation("Query did not return list value");if(db.g5!==Lb.g5)return!1;switch(this.Q9){case 0:return L.Annotations.fsb(L.Annotations.R3l(db.g5),db,Lb);case 1:for(const kc of db.items)for(const Kc of Lb.items)if(L.Annotations.fsb(db.g5,kc,Kc))return!0;return!1;case 2:for(const kc of db.items)for(const Kc of Lb.items)if(!L.Annotations.fsb(db.g5,kc,Kc))return!1;return!0;case 3:for(const kc of Lb.items)for(const Kc of db.items)if(!L.Annotations.fsb(db.g5,
kc,Kc))return!1;return!0;default:throw Error.notImplemented();}}}Object(l.a)(ta,"QueryListFilter",null,[1262]);class va{constructor(db,Lb){this.Bb=db;this.Q9=Lb}isMatch(db,Lb){if("string"!==typeof db)throw Error.argument("objToTest","Expected string");Lb=this.Bb.query.Ot(null,Lb);if("string"!==typeof Lb)throw Error.invalidOperation("Query did not return string");this.Bb.IDf&&(db=db.toUpperCase(),Lb=Lb.toUpperCase());switch(this.Q9){case 0:return db===Lb;case 1:return 0<=db.indexOf(Lb);case 2:return db.startsWith(Lb);
case 3:return db.endsWith(Lb);case 4:return 0<=Lb.indexOf(db);case 5:return Lb.startsWith(db);case 6:return Lb.endsWith(db);default:throw Error.notImplemented();}}}Object(l.a)(va,"QueryStringFilter",null,[1262]);class ia{constructor(db,Lb){db&&(this.query=Lb.hL(db.J(0)),this.IDf=1===db.J(1))}}Object(l.a)(ia,"QueryStringFilterInit",null,[]);class qa{constructor(db){this.Bb=db}isMatch(db,Lb){if(!Object(S.a)(1241,db))throw Error.argument("objToTest","Expected struct value");Lb=this.Bb.query.Ot(null,
Lb);if(!Object(S.a)(1241,Lb))throw Error.invalidOperation("Query did not return struct value");return db.isEqual(db)}}Object(l.a)(qa,"QueryStructFilter",null,[1262]);class pa{constructor(db){this.Bb=db}isMatch(db,Lb){db=this.Bb.query.Ot(null,Lb);if("boolean"!==typeof db)throw Error.invalidOperation("Query did not return bool");return db}}Object(l.a)(pa,"QueryWhereConstraintFilter",null,[1262]);class Fa{constructor(db){this.Bb=db}isMatch(db){if("string"!==typeof db)throw Error.argument("objToTest",
"Expected string");return this.Bb.M6f.test(db)}}Object(l.a)(Fa,"RegexStringFilter",null,[1262]);class za{constructor(db,Lb){db&&(this.M6f=Lb.J$b(db.J(0)))}}Object(l.a)(za,"RegexStringFilterInit",null,[]);class Oa{constructor(db,Lb){db&&(this.filter=Lb.Doa(db.J(0)))}}Object(l.a)(Oa,"SingleFilterFilterInit",null,[]);class xa{constructor(db,Lb){db&&(this.query=Lb.hL(db.J(0)))}}Object(l.a)(xa,"SingleQueryFilterInit",null,[]);class fa{constructor(db){this.Bb=db}isMatch(db){if("boolean"!==typeof db)throw Error.argument("objToTest",
"Expected bool value");return db===this.Bb.value}}Object(l.a)(fa,"StoredValueBooleanFilter",null,[1262]);class Ka{constructor(db){db&&(this.value=1===db.J(0))}}Object(l.a)(Ka,"StoredValueBooleanFilterInit",null,[]);class lb{constructor(db,Lb){this.Bb=db;this.Q9=Lb}isMatch(db){if("number"!==typeof db)throw Error.argument("objToTest","Expected integer");switch(this.Q9){case 0:return this.Bb.Z_d?this.Bb.value?!!(db&this.Bb.value):!db:db===this.Bb.value;case 1:return this.Bb.Z_d?(db&this.Bb.value)===
this.Bb.value:32>db&&(1<<db&this.Bb.value)===this.Bb.value;case 2:return this.Bb.Z_d?!!(db&this.Bb.value):32>db&&!!(1<<db&this.Bb.value);default:throw Error.notImplemented();}}}Object(l.a)(lb,"StoredValueEnumFilter",null,[1262]);class Xa{constructor(db){db&&(this.Z_d=1===db.J(0),this.value=db.J(1))}}Object(l.a)(Xa,"StoredValueEnumFilterInit",null,[]);class kb{constructor(){this.FAn=null;this.c6e=this.gIb=0}}Object(l.a)(kb,"WHEREConstraintData",null,[]);class Bb{constructor(db){this.Bb=db}isMatch(db,
Lb){if(!Object(S.a)(kb,db))throw Error.argument("objToTest","Expected WHERE constraint data");let kc=-1,Kc=-1;const Qc=db.FAn;switch(this.Bb.b7e){case 4:kc=Qc.DOc;Kc=Qc.vig;break;case 5:kc=db.gIb;Kc=Qc.DOc-db.gIb;break;case 6:kc=Qc.DOc+Qc.vig;Kc=db.gIb+db.c6e-kc;break;case 1:case 2:case 3:let md=!1;for(let Hd=Qc.Nfp;Hd;Hd=Hd.next)if(this.Bb.p1o===Hd.name){md=!0;1===this.Bb.b7e?(kc=Hd.DOc,Kc=Hd.vig):2===this.Bb.b7e?(kc=db.gIb,Kc=Hd.DOc-db.gIb):(kc=Hd.DOc+Hd.vig,Kc=db.gIb+db.c6e-kc);break}if(!md)return!1;
break;case 7:kc=db.gIb;Kc=db.c6e;break;default:throw Error.notImplemented();}return null!==this.Bb.aCo.dkp(Qc.ftp,kc,Kc,kc,!0,2,Lb)}}Object(l.a)(Bb,"SubSreWhereConstraintFilter",null,[1262]);class Ja{constructor(db,Lb){if(db){var kc=Lb.IB(db.J(0));this.b7e=kc.charCodeAt(0);this.p1o=kc.substr(1);this.aCo=Lb.Ucm(db.J(1))}}}Object(l.a)(Ja,"SubSreWhereConstraintFilterInit",null,[]);class Ma{constructor(db){this.Bb=db}isMatch(db,Lb,kc=null){if(!Object(S.a)(1238,db))throw Error.argument("objToTest","Expected feature bundle");
if(null==kc)throw Error.argumentNull("parentTextForSpan");if(this.Bb.bth&&!this.Bb.bth.isMatch(db,Lb))return!1;if(this.Bb.bmg){let Kc;if(({value:Kc}=db.Mq(this.Bb.TAo)).returnValue){if(!this.Bb.bmg.isMatch(Kc,Lb))return!1}else{let Qc,md;if(!({value:Qc}=db.Mq(this.Bb.Juj)).returnValue||!({value:md}=db.Mq(this.Bb.Iuj)).returnValue||0>Qc||0>md||Qc+md>kc.length||!this.Bb.bmg.isMatch(kc.substr(Qc,md),Lb))return!1}}if(this.Bb.yvj){let Kc;if(!({value:Kc}=db.Mq(this.Bb.Juj)).returnValue||!this.Bb.yvj.isMatch(Kc,
Lb))return!1}if(this.Bb.dHi){let Kc;if(!({value:Kc}=db.Mq(this.Bb.Iuj)).returnValue||!this.Bb.dHi.isMatch(Kc,Lb))return!1}return!0}}Object(l.a)(Ma,"TextSpanFilter",null,[1262]);class fb{constructor(db,Lb){db&&(this.annotations=Lb.annotations,this.Juj=db.J(0),this.Iuj=db.J(1),this.TAo=db.J(2),this.bmg=db.J(3)?Lb.Doa(db.J(3)):null,this.bth=db.J(4)?Lb.Doa(db.J(4)):null,this.yvj=db.J(5)?Lb.Doa(db.J(5)):null,this.dHi=db.J(6)?Lb.Doa(db.J(6)):null)}}Object(l.a)(fb,"TextSpanFilterInit",null,[]);class hc{constructor(db,
Lb){db&&(this.annotations=Lb.annotations,this.Vua=db.J(0),this.zrg=db.J(1)?Lb.Doa(db.J(1)):null)}}Object(l.a)(hc,"ValueFilterAnnotationFilterInit",null,[]);var cc=c(1544);class mb{Doa(db,Lb){const kc=db.J(0),Kc=new cc.a;Kc.yib(db,1,db.count-1);switch(kc){case 1:return new Z(new ea(Kc,Lb),0);case 2:return new Z(new ea(Kc,Lb),1);case 3:return new Z(new ea(Kc,Lb),2);case 101:return new Fa(new za(Kc,Lb));case 103:return new va(new ia(Kc,Lb),0);case 104:return new va(new ia(Kc,Lb),1);case 105:return new va(new ia(Kc,
Lb),2);case 106:return new va(new ia(Kc,Lb),3);case 107:return new va(new ia(Kc,Lb),4);case 108:return new va(new ia(Kc,Lb),5);case 109:return new va(new ia(Kc,Lb),6);case 201:return new fa(new Ka(Kc));case 202:return new Pa(new xa(Kc,Lb));case 301:return new ha(new ka(Kc,Lb),0);case 302:return new ha(new ka(Kc,Lb),1);case 303:return new ha(new ka(Kc,Lb),2);case 304:return new ha(new ka(Kc,Lb),3);case 305:return new ha(new ka(Kc,Lb),4);case 401:return new lb(new Xa(Kc),0);case 402:return new lb(new Xa(Kc),
1);case 403:return new lb(new Xa(Kc),2);case 404:return new Ra(new Ga(Kc,Lb),0);case 405:return new Ra(new Ga(Kc,Lb),1);case 406:return new Ra(new Ga(Kc,Lb),2);case 407:return new Ra(new Ga(Kc,Lb),3);case 501:return new W(new V(Kc,Lb));case 502:return new qa(new xa(Kc,Lb));case 601:return new Y(new Oa(Kc,Lb),0);case 602:return new Y(new Oa(Kc,Lb),1);case 603:return new ba(new Oa(Kc,Lb));case 604:return new ta(new xa(Kc,Lb),0);case 605:return new ta(new xa(Kc,Lb),1);case 606:return new ta(new xa(Kc,
Lb),2);case 607:return new ta(new xa(Kc,Lb),3);case 701:return new Q(!1);case 702:return new Q(!0);case 703:return new O(new hc(Kc,Lb),!1);case 704:return new O(new hc(Kc,Lb),!0);case 705:return new N(new hc(Kc,Lb),!1);case 706:return new N(new hc(Kc,Lb),!0);case 707:return new sa(new Da(Kc,Lb));case 901:return new Ma(new fb(Kc,Lb));case 1002:return new pa(new xa(Kc,Lb));case 1001:return new Bb(new Ja(Kc,Lb));default:throw Error.argument("initData");}}}Object(l.a)(mb,"FilterFactory",null,[1237]);
var Hb=c(1521);class Ua{constructor(db){this.Bb=db}get dE(){return this.Bb.dE}get H5(){return this.Bb.H5}get Wke(){return this.Bb.Wke}get DZd(){return this.Bb.DZd}load(db,Lb){return this.Ot(db,db?new ua("root",db,Lb):Lb)}store(db,Lb,kc){this.Dmc(db,Lb,db?new ua("root",db,kc):kc,null)}Ot(db,Lb){if(!this.DZd&&!this.Bb.annotations.jdc(this.dE,db))throw Error.argument("input","Input value not of expected type");let kc=this.Bb.m1h;for(;kc;)db=kc.load(db,Lb),kc=kc.next;return db}Dmc(db,Lb,kc,Kc){if(!this.Wke)throw Error.invalidOperation("Attempt to store into query that supports only loading");
if(!this.DZd&&!this.Bb.annotations.jdc(this.dE,db))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Bb.annotations.jdc(this.H5,Lb))throw Error.argument("rvalue","Rvalue not of expected type");return this.Bb.m1h.store(db,Lb,kc,Kc)}static qGh(db,Lb,kc,Kc){if(kc===Kc)return Lb;if(L.Annotations.tI(kc)&&L.Annotations.tI(Kc)){kc=L.Annotations.N2a(kc);Kc=L.Annotations.N2a(Kc);const Qc=new Hb.a(db,Kc);for(const md of Lb.items)Array.add(Qc.items,Ua.qGh(db,md,kc,Kc));return Qc}if(kc===
L.Annotations.NJa){if(Kc===L.Annotations.Tra)return Lb;if(Kc===L.Annotations.caa)return Lb.toString()}else if(kc===L.Annotations.Tra){if(Kc===L.Annotations.NJa)return Math.floor(Lb);if(Kc===L.Annotations.caa)return Lb.toString()}else if(kc===L.Annotations.caa){if(Kc===L.Annotations.NJa)return parseInt(Lb);if(Kc===L.Annotations.Tra)return parseFloat(Lb)}throw Error.invalidOperation("Type conversion failure in query step");}}Object(l.a)(Ua,"AnnotationQuery",null,[1267]);class Ya{constructor(){this.H5=
this.dE=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}S2a(db){if(this.next)return{returnValue:this.next,gJa:db};if(db){const Lb=db.FJh;db=db.d4i;return{returnValue:Lb,gJa:db}}return{returnValue:null,gJa:db}}}Object(l.a)(Ya,"AnnotationQueryStep",null,[1291]);class Fb extends Ya{constructor(db){super();this.Bb=db}load(db,Lb){Lb=this.Bb.query.Ot(db,Lb);if(L.Annotations.tI(this.dE)){var kc=L.Annotations.N2a(this.dE);let Qc=new Hb.a(this.Bb.annotations,kc);if(L.Annotations.tI(this.Bb.query.H5)){if(db.items.length!==
Lb.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let md=0,Hd=db.items.length;md<Hd;++md)Array.add(Qc.items,this.WEd(db.items[md],Lb.items[md],kc===L.Annotations.Tra))}else for(var Kc of db.items)Array.add(Qc.items,this.WEd(Kc,Lb,kc===L.Annotations.Tra));return Qc}if(L.Annotations.tI(this.Bb.query.H5)){Kc=new Hb.a(this.Bb.annotations,this.dE);for(kc of Lb.items)Array.add(Kc.items,this.WEd(db,kc,this.dE===L.Annotations.Tra));return Kc}return this.WEd(db,
Lb,this.dE===L.Annotations.Tra)}WEd(db,Lb,kc){db=this.l4b(db,Lb);return kc?db:Math.floor(db)}}Object(l.a)(Fb,"NumericAnnotationQueryStep",Ya,[]);class Wa extends Fb{constructor(db){super(db)}l4b(db,Lb){return db+Lb}}Object(l.a)(Wa,"AddAnnotationQueryStep",Fb,[]);class yb extends Ya{constructor(db){super();this.Bb=db}load(db,Lb){if(this.dE===L.Annotations.iAa&&this.Bb.query.H5===L.Annotations.iAa){let Qc;if(({result:Qc}=this.PBh(db)).returnValue)return Qc}if(L.Annotations.tI(this.dE)){var kc=new Hb.a(this.Bb.annotations,
L.Annotations.iAa);Lb=this.Bb.query.Ot(db,Lb);if(L.Annotations.tI(this.Bb.query.H5)){if(db.items.length!==Lb.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let Qc=0,md=db.items.length;Qc<md;++Qc)Array.add(kc.items,this.AJc(Lb.items[Qc],db.items[Qc]))}else for(var Kc of db.items)Array.add(kc.items,this.AJc(Lb,Kc));return kc}Kc=this.Bb.query.Ot(db,Lb);if(L.Annotations.tI(this.Bb.query.H5)){Lb=new Hb.a(this.Bb.annotations,L.Annotations.iAa);for(kc of Kc.items)Array.add(Lb.items,
this.AJc(kc,db));return Lb}return this.AJc(Kc,db)}}Object(l.a)(yb,"BinaryBooleanAnnotationQueryStep",Ya,[]);class Yb extends yb{constructor(db){super(db)}PBh(db){return{returnValue:!db,result:!1}}AJc(db,Lb){return db&&Lb}}Object(l.a)(Yb,"AndAnnotationQueryStep",yb,[]);class qc{constructor(db){db&&(this.annotations=db)}}Object(l.a)(qc,"AnnotationsOnlyQueryStepInit",null,[]);class Hc extends Ya{constructor(db){super();this.Bb=db}load(db,Lb){Lb=this.Bb.query.Ot(db,Lb);db=db.clone();L.Annotations.tI(this.Bb.query.H5)?
Array.addRange(db.items,Lb.items):Array.add(db.items,Lb);return db}}Object(l.a)(Hc,"AppendAnnotationQueryStep",Ya,[]);class $b extends Ya{constructor(db){super();this.Bb=db}load(db,Lb){if(this.dE===L.Annotations.PV)return this.MNc(db,Lb);const kc=new Hb.a(this.Bb.annotations,L.Annotations.PV);for(const Kc of db.items)Array.add(kc.items,this.MNc(Kc,Lb));return kc}MNc(db,Lb){const kc=new R.a(this.Bb.annotations);kc.J0a(db);db=new R.a(this.Bb.annotations);this.Bb.script.tPa(null,new ua("Input",kc,new ua("Output",
db,Lb)));return db}}Object(l.a)($b,"ApplyAnnotationQueryStep",Ya,[]);class Ub extends Ya{constructor(db){super();this.Bb=db}load(db,Lb){if(this.dE===L.Annotations.PV)return Lb=this.MNc(db,Lb),Lb.Mq(this.Bb.$sh).returnValue||new Hb.a(this.Bb.annotations,L.Annotations.PV),Lb;const kc=new Hb.a(this.Bb.annotations,L.Annotations.PV);for(const Kc of db.items)if(db=this.MNc(Kc,Lb),({value:db}=db.Mq(this.Bb.$sh)).returnValue)for(const Qc of db.items)Array.add(kc.items,Qc);return kc}MNc(db,Lb){const kc=new R.a(this.Bb.annotations);
kc.J0a(db);db=new R.a(this.Bb.annotations);this.Bb.script.tPa(null,new ua("Input",kc,new ua("Output",db,Lb)));return db}}Object(l.a)(Ub,"ApplyExpandAnnotationQueryStep",Ya,[]);class mc{constructor(db,Lb){db&&(this.annotations=Lb.annotations,this.script=Lb.EFb(db.J(0)),this.$sh=db.J(1))}}Object(l.a)(mc,"ApplyExpandQueryStepInit",null,[]);class ic{constructor(db,Lb){db&&(this.annotations=Lb.annotations,this.script=Lb.EFb(db.J(0)))}}Object(l.a)(ic,"ApplyQueryStepInit",null,[]);class ab extends Ya{constructor(db){super();
this.Bb=db}load(db){if(this.dE===L.Annotations.PV)return this.U2d(db);const Lb=new Hb.a(this.Bb.annotations,this.Bb.annotations.getAttributeType(this.Bb.Vua));for(const kc of db.items)Array.add(Lb.items,this.U2d(kc));return Lb}store(db,Lb,kc,Kc){if(this.dE===L.Annotations.PV){var Qc=Lb,md=({gJa:Kc}=this.S2a(Kc)).returnValue;md&&(Qc=md.store(L.Annotations.YT(this.U2d(db)),Lb,kc,Kc));db.$y(this.Bb.Vua,Qc)}else{var Hd=Lb;if(Qc=({gJa:Kc}=this.S2a(Kc)).returnValue){Hd=new Hb.a(this.Bb.annotations,this.Bb.annotations.getAttributeType(this.Bb.Vua));
for(md of db.items)Array.add(Hd.items,this.U2d(md));Hd=Qc.store(Hd,Lb,kc,Kc)}Lb=Hd;if(Lb.items.length!==db.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let Ne=0,Cc=db.items.length;Ne<Cc;++Ne)kc=db.items[Ne],kc.isReadOnly&&(kc=kc.clone(),db.items[Ne]=kc),kc.$y(this.Bb.Vua,Lb.items[Ne])}return db}U2d(db){({value:db}=db.Mq(this.Bb.Vua)).returnValue||(db=this.Bb.annotations.EOl(this.Bb.Vua));return db}}Object(l.a)(ab,"AttrAnnotationQueryStep",Ya,
[]);class bb{constructor(db,Lb){db&&(this.annotations=Lb,this.Vua=db.J(0))}}Object(l.a)(bb,"AttrQueryStepInit",null,[]);class Jb extends Ya{constructor(db){super();this.Bb=db}load(db){const Lb=new R.a(this.Bb.annotations);Lb.J0a(db);return this.Bb.module.execute(Lb)}}Object(l.a)(Jb,"CallModuleAnnotationQueryStep",Ya,[]);class Eb{constructor(db,Lb){db&&(this.annotations=Lb.annotations,this.module=Lb.Dsf(db.J(0)))}}Object(l.a)(Eb,"CallModuleQueryStepInit",null,[]);class hb extends Ya{constructor(db){super();
this.Bb=db}load(db,Lb){if(L.Annotations.tI(this.dE)){var kc=this.Bb.query.Ot(db,Lb);Lb=new Hb.a(this.Bb.annotations,L.Annotations.caa);let md="string"===typeof kc;for(var Kc of db.items)if(md)Array.add(Lb.items,Kc+kc);else for(var Qc of kc.items)Array.add(Lb.items,Kc+Qc);return Lb}Kc=this.Bb.query.Ot(db,Lb);if("string"===typeof Kc)return db+Kc;Qc=new Hb.a(this.Bb.annotations,L.Annotations.caa);for(kc of Kc.items)Array.add(Qc.items,db+kc);return Qc}}Object(l.a)(hb,"ConcatAnnotationQueryStep",Ya,[]);
class ob extends Ya{constructor(db){super();this.Bb=db}load(db){return Ua.qGh(this.Bb.annotations,db,this.dE,this.H5)}}Object(l.a)(ob,"ConvertAnnotationQueryStep",Ya,[]);class Va extends Ya{constructor(){super()}load(db){return db.items.length}}Object(l.a)(Va,"CountAnnotationQueryStep",Ya,[]);class Qb extends Fb{constructor(db){super(db)}l4b(db,Lb){return db/Lb}}Object(l.a)(Qb,"DivideAnnotationQueryStep",Fb,[]);class Vb extends Ya{constructor(db){super();this.Bb=db}load(db,Lb){Lb=new ua(this.Bb.npe,
null,Lb);for(const kc of db.items)if(Lb.s7e(kc),this.Bb.query.Ot(kc,Lb))return!0;return!1}}Object(l.a)(Vb,"ExistsAnnotationQueryStep",Ya,[]);class Sb extends Fb{constructor(db){super(db)}l4b(db,Lb){return Math.pow(db,Lb)}}Object(l.a)(Sb,"ExpAnnotationQueryStep",Fb,[]);class nb{constructor(db,Lb){db&&(this.BPa=Lb.IB(db.J(0)))}}Object(l.a)(nb,"FeatureBundleNameQueryStepInit",null,[]);class ac extends Ya{constructor(db){super();this.Bb=db}load(db){if(L.Annotations.tI(this.dE)){const Lb=new Hb.a(this.Bb.annotations,
this.Bb.annotations.eHb(L.Annotations.N2a(this.dE),this.Bb.CPa));for(const kc of db.items)Array.add(Lb.items,kc.ajb(this.Bb.CPa));return Lb}return db.ajb(this.Bb.CPa)}store(db,Lb,kc,Kc){if(L.Annotations.tI(this.dE)){var Qc=Lb,md=({gJa:Kc}=this.S2a(Kc)).returnValue;if(md){Qc=new Hb.a(this.Bb.annotations,this.Bb.annotations.eHb(L.Annotations.N2a(this.dE),this.Bb.CPa));for(var Hd of db.items)Array.add(Qc.items,Hd.ajb(this.Bb.CPa));Qc=md.store(Qc,Lb,kc,Kc)}Lb=Qc;if(Lb.items.length!==db.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");
for(let Ne=0,Cc=db.items.length;Ne<Cc;++Ne)kc=db.items[Ne],kc.isReadOnly&&(kc=kc.clone(),db.items[Ne]=kc),kc.udg(this.Bb.CPa,Lb.items[Ne])}else md=Lb,(Hd=({gJa:Kc}=this.S2a(Kc)).returnValue)&&(md=Hd.store(L.Annotations.YT(db.ajb(this.Bb.CPa)),Lb,kc,Kc)),db.udg(this.Bb.CPa,md);return db}}Object(l.a)(ac,"FieldAnnotationQueryStep",Ya,[]);class zc{constructor(db,Lb){db&&(this.annotations=Lb,this.CPa=db.J(0))}}Object(l.a)(zc,"FieldQueryStepInit",null,[]);class Ib extends Ya{constructor(db){super();this.Bb=
db}load(db,Lb){for(const kc of db.items)if(this.Bb.filter.isMatch(kc,Lb))return kc;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(db,Lb,kc,Kc){let Qc=Lb,md=-1;for(let Ne=0,Cc=db.items.length;Ne<Cc;Ne++)if(this.Bb.filter.isMatch(db.items[Ne],kc)){md=Ne;break}if(0>md)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const Hd=({gJa:Kc}=this.S2a(Kc)).returnValue;Hd&&(Qc=Hd.store(L.Annotations.YT(db.items[md]),Lb,kc,Kc));
db.items[md]=Qc;return db}}Object(l.a)(Ib,"FirstItemMatchingAnnotationQueryStep",Ya,[]);class ya extends Ya{constructor(db){super();this.Bb=db}load(db,Lb){Lb=new ua(this.Bb.npe,null,Lb);for(const kc of db.items)if(Lb.s7e(kc),!this.Bb.query.Ot(kc,Lb))return!1;return!0}}Object(l.a)(ya,"ForAllAnnotationQueryStep",Ya,[]);class ib extends Ya{constructor(db){super();this.Bb=db}load(db,Lb){db=Lb?Lb.JRd(this.Bb.BPa):null;if(!db)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Bb.BPa+
'"');return db}store(db,Lb,kc,Kc){db=kc?kc.JRd(this.Bb.BPa):null;if(!db)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Bb.BPa+'"');let Qc=Lb;const md=({gJa:Kc}=this.S2a(Kc)).returnValue;md&&(Qc=md.store(db,Lb,kc,Kc));db!==Qc&&db.J0a(Qc);return db}}Object(l.a)(ib,"GetAnnotationQueryStep",Ya,[]);class wb{constructor(db,Lb){this.F_j=db;this.Ofk=Lb}get FJh(){return this.F_j}get d4i(){return this.Ofk}}Object(l.a)(wb,"AnnotationQueryStoreContinuation",null,[1293]);class bc extends Ya{constructor(db){super();
this.Bb=db}load(db,Lb){return this.Bb.Rle.Ot(db,Lb)?this.Bb.fCj.Ot(db,Lb):this.Bb.aOd?this.Bb.aOd.Ot(db,Lb):db}store(db,Lb,kc,Kc){var Qc=this.Bb.Rle.Ot(db,kc);this.next&&(Kc=new wb(this.next,Kc));if(Qc)return this.Bb.fCj.Dmc(db,Lb,kc,Kc);if(this.Bb.aOd)return this.Bb.aOd.Dmc(db,Lb,kc,Kc);Qc=Lb;let md=null;Kc&&(md=Kc.FJh,Kc=Kc.d4i);md&&(Qc=md.store(L.Annotations.YT(db),Lb,kc,Kc));return Qc}}Object(l.a)(bc,"IfAnnotationQueryStep",Ya,[]);class lc{constructor(db,Lb){db&&(this.Rle=Lb.hL(db.J(0)),this.fCj=
Lb.hL(db.J(1)),this.aOd=db.J(2)?Lb.hL(db.J(2)):null)}}Object(l.a)(lc,"IfQueryStepInit",null,[]);class Kb{constructor(db,Lb){db&&(this.Sym=Lb.hL(db.J(0)),this.fFi=Lb.hL(db.J(1)))}}Object(l.a)(Kb,"IndexAndItemQueryStepInit",null,[]);class Bc extends Ya{constructor(db){super();this.Bb=db}load(db,Lb){const kc=this.Bb.Sym.Ot(db,Lb);Lb=this.Bb.fFi.Ot(db,Lb);db=db.clone();if(0>kc||kc>db.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(L.Annotations.tI(this.Bb.fFi.H5))for(let Kc=
0;Kc<Lb.items.length;++Kc)Array.insert(db.items,kc+Kc,Lb.items[Kc]);else Array.insert(db.items,kc,Lb);return db}}Object(l.a)(Bc,"InsertAtAnnotationQueryStep",Ya,[]);class Xc extends Ya{constructor(db){super();this.Bb=db}load(db,Lb){return!(!Lb||!Lb.JRd(this.Bb.BPa))}}Object(l.a)(Xc,"IsDefinedAnnotationQueryStep",Ya,[]);class vd extends Ya{constructor(db){super();this.Bb=db}load(db,Lb){Lb=this.AJ(db,Lb);return db.items[Lb]}store(db,Lb,kc,Kc){const Qc=this.AJ(db,kc);let md=Lb;const Hd=({gJa:Kc}=this.S2a(Kc)).returnValue;
Hd&&(md=Hd.store(L.Annotations.YT(db.items[Qc]),Lb,kc,Kc));db.items[Qc]=md;return db}AJ(db,Lb){Lb=this.Bb.query.Ot(db,Lb);if(0>Lb||Lb>=db.items.length)throw Error.invalidOperation("Index out of range in Item store step");return Lb}}Object(l.a)(vd,"ItemAnnotationQueryStep",Ya,[]);class vc extends Ya{constructor(db){super();this.Bb=db}load(db,Lb){const kc=new Hb.a(this.Bb.annotations,L.Annotations.N2a(this.dE));for(const Kc of db.items)this.Bb.filter.isMatch(Kc,Lb)&&Array.add(kc.items,Kc);return kc}}
Object(l.a)(vc,"ItemsMatchingAnnotationQueryStep",Ya,[]);class bd extends Ya{constructor(db){super();this.Bb=db}load(db,Lb){Lb=this.AJ(db,Lb);return db.items[db.items.length-Lb-1]}store(db,Lb,kc,Kc){const Qc=this.AJ(db,kc);let md=Lb;const Hd=({gJa:Kc}=this.S2a(Kc)).returnValue;Hd&&(md=Hd.store(L.Annotations.YT(db.items[db.items.length-Qc-1]),Lb,kc,Kc));db.items[db.items.length-Qc-1]=md;return db}AJ(db,Lb){Lb=this.Bb.query?this.Bb.query.Ot(db,Lb):0;if(0>Lb||Lb>=db.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");
return Lb}}Object(l.a)(bd,"LastItemAnnotationQueryStep",Ya,[]);class Sd extends Ya{constructor(db){super();this.Bb=db}load(db){if(L.Annotations.tI(this.dE)){const Lb=new Hb.a(this.Bb.annotations,L.Annotations.NJa);for(const kc of db.items)Array.add(Lb.items,kc.length);return Lb}return db.length}}Object(l.a)(Sd,"LengthAnnotationQueryStep",Ya,[]);class pd extends Ya{constructor(db){super();this.Bb=db}load(db,Lb){if(L.Annotations.tI(this.dE)){const kc=new Hb.a(this.Bb.annotations,L.Annotations.iAa);
for(const Kc of db.items)Array.add(kc.items,this.Bb.filter.isMatch(Kc,Lb));return kc}return this.Bb.filter.isMatch(db,Lb)}}Object(l.a)(pd,"MatchesAnnotationQueryStep",Ya,[]);class Tc extends Ya{constructor(db){super();this.Bb=db}load(db,Lb){return this.Bb.filter.isMatch(db,Lb)}}Object(l.a)(Tc,"MatchesAsListAnnotationQueryStep",Ya,[]);class Wc extends Fb{constructor(db){super(db)}l4b(db,Lb){return db%Lb}}Object(l.a)(Wc,"ModuloAnnotationQueryStep",Fb,[]);class Pc extends Fb{constructor(db){super(db)}l4b(db,
Lb){return db*Lb}}Object(l.a)(Pc,"MultiplyAnnotationQueryStep",Fb,[]);class Xd extends Ya{constructor(db){super();this.Bb=db}load(db){if(L.Annotations.tI(this.dE)){const Lb=new Hb.a(this.Bb.annotations,L.Annotations.iAa);for(const kc of db.items)Array.add(Lb.items,!kc);return Lb}return!db}}Object(l.a)(Xd,"NotAnnotationQueryStep",Ya,[]);class Dd extends yb{constructor(db){super(db)}PBh(db){return{returnValue:db,result:!0}}AJc(db,Lb){return db||Lb}}Object(l.a)(Dd,"OrAnnotationQueryStep",yb,[]);class $e extends Ya{constructor(db){super();
this.Bb=db}load(db,Lb){const kc=this.Bb.qjg.Ot(db,Lb);db=this.Bb.mKc.Ot(db,Lb);Lb=new Hb.a(this.Bb.annotations,L.Annotations.NJa);for(let Kc=0;Kc<db;++Kc)Array.add(Lb.items,kc+Kc);return Lb}}Object(l.a)($e,"RangeAnnotationQueryStep",Ya,[]);class se{constructor(db,Lb){db&&(this.annotations=Lb.annotations,this.filter=Lb.Doa(db.J(0)))}}Object(l.a)(se,"SingleFilterQueryStepInit",null,[]);class wc{constructor(db,Lb){db&&(this.annotations=Lb.annotations,this.query=db.J(0)?Lb.hL(db.J(0)):null)}}Object(l.a)(wc,
"SingleOptionalQueryQueryStepInit",null,[]);class cd{constructor(db,Lb){db&&(this.annotations=Lb.annotations,this.query=Lb.hL(db.J(0)))}}Object(l.a)(cd,"SingleQueryQueryStepInit",null,[]);class Jd{constructor(db,Lb){db&&(this.annotations=Lb.annotations,this.qjg=Lb.hL(db.J(0)),this.mKc=db.J(1)?Lb.hL(db.J(1)):null)}}Object(l.a)(Jd,"StartAndCountOrLengthQueryStepInit",null,[]);class Qd extends Ya{constructor(db){super();this.Bb=db}load(db,Lb){let kc;({startIndex:Lb,length:kc}=this.wUd(db,Lb));const Kc=
new Hb.a(this.Bb.annotations,db.g5);for(let Qc=0;Qc<kc;++Qc)Array.add(Kc.items,db.items[Lb+Qc]);return Kc}store(db,Lb,kc,Kc){let Qc,md;({startIndex:Qc,length:md}=this.wUd(db,kc));var Hd=Lb;const Ne=({gJa:Kc}=this.S2a(Kc)).returnValue;if(Ne){Hd=new Hb.a(this.Bb.annotations,db.g5);for(let Cc=0;Cc<md;++Cc)Array.add(Hd.items,db.items[Qc+Cc]);Hd=Ne.store(Hd,Lb,kc,Kc)}Lb=Hd;for(kc=0;kc<md;++kc)Array.removeAt(db.items,Qc);for(let Cc=0,oe=Lb.items.length;Cc<oe;++Cc)Array.insert(db.items,Qc+Cc,Lb.items[Cc]);
return db}wUd(db,Lb){let kc;kc=this.Bb.qjg.Ot(db,Lb);if(0>kc)throw Error.invalidOperation("Invalid start index in Sublist() query step");Lb=this.Bb.mKc?this.Bb.mKc.Ot(db,Lb):db.items.length-kc;if(0>Lb||kc+Lb>db.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{startIndex:kc,length:Lb}}}Object(l.a)(Qd,"SublistAnnotationQueryStep",Ya,[]);class yd extends Ya{constructor(db){super();this.Bb=db}load(db,Lb){if(L.Annotations.tI(this.dE)){const kc=
new Hb.a(this.Bb.annotations,L.Annotations.caa);for(let Kc=0,Qc=db.items.length;Kc<Qc;++Kc)Array.add(kc.items,this.iii(db.items[Kc],Lb));return kc}return this.iii(db,Lb)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}iii(db,Lb){let kc;({startIndex:Lb,length:kc}=this.wUd(db,Lb));return db.substr(Lb,kc)}wUd(db,Lb){let kc;kc=this.Bb.qjg.Ot(db,Lb);if(0>kc)throw Error.invalidOperation("Invalid start index in Substring() query step");Lb=this.Bb.mKc?this.Bb.mKc.Ot(db,
Lb):db.length-kc;if(0>Lb||kc+Lb>db.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{startIndex:kc,length:Lb}}}Object(l.a)(yd,"SubstringAnnotationQueryStep",Ya,[]);class Le extends Fb{constructor(db){super(db)}l4b(db,Lb){return db-Lb}}Object(l.a)(Le,"SubtractAnnotationQueryStep",Fb,[]);class gf extends Ya{constructor(db){super();this.Bb=db}load(db){const Lb=new Hb.a(this.Bb.annotations,L.Annotations.caa);for(let kc=0;kc<db.length;++kc)Array.add(Lb.items,
db.charAt(kc).toString());return Lb}}Object(l.a)(gf,"ToCharListAnnotationQueryStep",Ya,[]);class xh extends Ya{constructor(db){super();this.Bb=db}load(db){const Lb=new Hb.a(this.Bb.annotations,this.dE);Array.add(Lb.items,db);return Lb}}Object(l.a)(xh,"ToListAnnotationQueryStep",Ya,[]);class Qg extends Ya{constructor(db){super();this.Bb=db}load(){return this.Bb.value}}Object(l.a)(Qg,"ValueAnnotationQueryStep",Ya,[]);class Ng{constructor(db,Lb){if(db){var kc=db.J(0),Kc=1;this.value=({fia:Kc}=Lb.cPa(kc,
db,Kc,null,null,null)).returnValue;L.Annotations.fLb(this.value)}}}Object(l.a)(Ng,"ValueQueryStepInit",null,[]);class zg{constructor(db,Lb){db&&(this.npe=Lb.IB(db.J(0)),this.query=Lb.hL(db.J(1)))}}Object(l.a)(zg,"VarNameAndQueryQueryStepInit",null,[]);class Jf{constructor(db,Lb){this.YVg=null;if(db){this.annotations=Lb.annotations;var kc=0;this.dE=db.J(kc);++kc;this.H5=db.J(kc);++kc;this.Wke=1===db.J(kc);++kc;this.DZd=1===db.J(kc);++kc;var Kc=db.J(kc);++kc;if(Kc){var Qc=kc,md=kc+Kc,Hd=kc+2*Kc;kc+=
3*Kc;var Ne=db.count-kc,Cc=null;for(let gc=0;gc<Kc;++gc){var oe=kc+db.J(Hd+gc);const eh=(gc===Kc-1?Ne:db.J(Hd+gc+1))-db.J(Hd+gc),nj=new cc.a;nj.yib(db,oe,eh);oe=Jf.c6l(db.J(md+gc),nj,Lb);oe.dE=db.J(Qc+gc);oe.H5=gc===Kc-1?this.H5:db.J(Qc+gc+1);Cc?Cc.next=oe:this.YVg=oe;Cc=oe}}}}get m1h(){return this.YVg}static c6l(db,Lb,kc){switch(db){case 1:return new ib(new nb(Lb,kc));case 2:return new Xc(new nb(Lb,kc));case 3:return new ab(new bb(Lb,kc.annotations));case 4:return new ac(new zc(Lb,kc.annotations));
case 5:return new bc(new lc(Lb,kc));case 6:return new pd(new se(Lb,kc));case 43:return new Tc(new se(Lb,kc));case 45:return new $b(new ic(Lb,kc));case 49:return new Ub(new mc(Lb,kc));case 46:return new Qg(new Ng(Lb,kc.annotations));case 51:return new Jb(new Eb(Lb,kc));case 52:return new $e(new Jd(Lb,kc));case 53:return new ob(new qc(kc.annotations));case 13:return new vd(new cd(Lb,kc));case 14:return new bd(new wc(Lb,kc));case 15:return new Va;case 18:return new Ib(new se(Lb,kc));case 16:return new ya(new zg(Lb,
kc));case 17:return new Vb(new zg(Lb,kc));case 22:return new Bc(new Kb(Lb,kc));case 24:return new Hc(new cd(Lb,kc));case 26:return new Qd(new Jd(Lb,kc));case 27:return new vc(new se(Lb,kc));case 30:return new xh(new qc(kc.annotations));case 31:return new yd(new Jd(Lb,kc));case 32:return new hb(new cd(Lb,kc));case 47:return new Sd(new qc(kc.annotations));case 48:return new gf(new qc(kc.annotations));case 34:return new Wa(new cd(Lb,kc));case 35:return new Le(new cd(Lb,kc));case 36:return new Pc(new cd(Lb,
kc));case 37:return new Qb(new cd(Lb,kc));case 38:return new Wc(new cd(Lb,kc));case 39:return new Sb(new cd(Lb,kc));case 40:return new Yb(new cd(Lb,kc));case 41:return new Dd(new cd(Lb,kc));case 42:return new Xd(new qc(kc.annotations));default:throw Error.argument("currStepInitData");}}}Object(l.a)(Jf,"AnnotationQueryInit",null,[]);class fc{constructor(db){this.Bb=db}execute(db,Lb){this.tPa(db,db?new ua("root",db,Lb):Lb)}tPa(db,Lb){for(const kc of this.Bb.commands)Lb=kc.execute(db,Lb)}}Object(l.a)(fc,
"AnnotationScript",null,[1266]);class Fc{constructor(db){this.Bb=db}execute(db,Lb){const kc=this.Bb.XCm.Ot(db,Lb),Kc=this.Bb.zyn.Ot(db,Lb);this.Bb.script.tPa(db,new ua("Input",kc,new ua("Output",Kc,Lb)));return Lb}}Object(l.a)(Fc,"ApplyAnnotationScriptCommand",null,[1287]);class id{constructor(db,Lb){db&&(this.XCm=Lb.hL(db.J(0)),this.zyn=Lb.hL(db.J(1)),this.script=Lb.EFb(db.J(2)))}}Object(l.a)(id,"ApplyScriptCommandInit",null,[]);class ld{constructor(db){this.Bb=db}execute(db,Lb){const kc=this.Bb.Oag.Ot(db,
Lb);this.Bb.L3d.Dmc(db,kc,Lb,null);return Lb}}Object(l.a)(ld,"AssignAnnotationScriptCommand",null,[1287]);class hd{constructor(db){this.Bb=db}execute(db,Lb){const kc=this.Bb.L3d.Ot(db,Lb);db=this.Bb.Oag.Ot(db,Lb);kc!==db&&kc.J0a(db);return Lb}}Object(l.a)(hd,"CopyAnnotationScriptCommand",null,[1287]);class Be{constructor(db){this.Bb=db}execute(db,Lb){let kc=this.Bb.wLf.Ot(db,Lb);if(this.Bb.wLf.Wke){kc=L.Annotations.YT(kc);var Kc=new ua(this.Bb.BPa,null,Lb);for(let md=0,Hd=kc.items.length;md<Hd;++md){var Qc=
this.PYh(db,kc.items[md],Kc);if(0>this.Bb.Fee)kc.items[md]=Qc;else if(({value:Qc}=Qc.Mq(this.Bb.Fee)).returnValue)kc.items[md]=Qc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}this.Bb.wLf.Dmc(db,kc,Lb,null)}else{Kc=new ua(this.Bb.BPa,null,Lb);for(let md=0,Hd=kc.items.length;md<Hd;++md)this.PYh(db,kc.items[md],Kc)}return Lb}PYh(db,Lb,kc){let Kc;0>this.Bb.Fee?Kc=L.Annotations.YT(Lb):(Kc=new R.a(this.Bb.annotations),Kc.$y(this.Bb.Fee,Lb));kc.s7e(Kc);
this.Bb.oLk.tPa(db,kc);return Kc}}Object(l.a)(Be,"EnumerateAnnotationScriptCommand",null,[1287]);class Ke{constructor(db,Lb){db&&(this.annotations=Lb.annotations,this.BPa=Lb.IB(db.J(0)),this.wLf=Lb.hL(db.J(1)),this.oLk=Lb.EFb(db.J(2)),this.Fee=db.J(3))}}Object(l.a)(Ke,"EnumerateScriptCommandInit",null,[]);class Me{constructor(db){this.Bb=db}execute(db,Lb){this.Bb.Rle.Ot(db,Lb)?this.Bb.IOo.tPa(db,Lb):this.Bb.UZh&&this.Bb.UZh.tPa(db,Lb);return Lb}}Object(l.a)(Me,"IfAnnotationScriptCommand",null,[1287]);
class jf{constructor(db,Lb){db&&(this.Rle=Lb.hL(db.J(0)),this.IOo=Lb.EFb(db.J(1)),this.UZh=db.J(2)?Lb.EFb(db.J(2)):null)}}Object(l.a)(jf,"IfScriptCommandInit",null,[]);class kg{constructor(db,Lb){db&&(this.annotations=Lb.annotations,this.L3d=Lb.hL(db.J(0)),this.Oag=Lb.hL(db.J(1)))}}Object(l.a)(kg,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class sf{constructor(db){this.Bb=db}execute(db,Lb){const kc=this.Bb.Oag.Ot(this.Bb.L3d.Ot(db,Lb),Lb);this.Bb.L3d.Dmc(db,kc,Lb,null);return Lb}}Object(l.a)(sf,
"ModifyAnnotationScriptCommand",null,[1287]);class Wg{constructor(db){this.Bb=db}execute(db,Lb){const kc=new R.a(this.Bb.annotations);this.Bb.query&&kc.J0a(this.Bb.query.Ot(db,Lb));return Lb=new ua(this.Bb.BPa,kc,Lb)}}Object(l.a)(Wg,"NewAnnotationScriptCommand",null,[1287]);class Db{constructor(db,Lb){db&&(this.annotations=Lb.annotations,this.BPa=Lb.IB(db.J(0)),this.query=db.J(1)?Lb.hL(db.J(1)):null)}}Object(l.a)(Db,"NewScriptCommandInit",null,[]);class Gb{constructor(db){this.Bb=db}execute(db,Lb){db=
this.Bb.query.Ot(db,Lb);if(this.Bb.query.H5===L.Annotations.PV)db.KTa(this.Bb.Vua);else for(const kc of db.items)kc.KTa(this.Bb.Vua);return Lb}}Object(l.a)(Gb,"RemoveAnnotationScriptCommand",null,[1287]);class $c{constructor(db,Lb){db&&(this.annotations=Lb.annotations,this.query=Lb.hL(db.J(0)),this.Vua=db.J(1))}}Object(l.a)($c,"RemoveScriptCommandInit",null,[]);class Bd{constructor(db,Lb){if(db){var kc=0,Kc=db.J(kc);++kc;if(Kc){var Qc=kc,md=kc+Kc;kc+=2*Kc;var Hd=db.count-kc;this.commands=Array(Kc);
for(let Ne=0;Ne<Kc;++Ne){const Cc=kc+db.J(md+Ne),oe=(Ne===Kc-1?Hd:db.J(md+Ne+1))-db.J(md+Ne),gc=new cc.a;gc.yib(db,Cc,oe);this.commands[Ne]=Bd.T5l(db.J(Qc+Ne),gc,Lb)}}}}static T5l(db,Lb,kc){switch(db){case 1:return new ld(new kg(Lb,kc));case 2:return new sf(new kg(Lb,kc));case 3:return new Gb(new $c(Lb,kc));case 6:return new Wg(new Db(Lb,kc));case 7:return new Be(new Ke(Lb,kc));case 8:return new Me(new jf(Lb,kc));case 9:return new hd(new kg(Lb,kc));case 10:return new Fc(new id(Lb,kc));default:throw Error.argument("initData");
}}}Object(l.a)(Bd,"AnnotationScriptInit",null,[]);var we=c(1671);class He{constructor(db){this.v2=db;this.my=0}t$(){const db=this.v2.Yy(this.my,4);this.my+=4;return db}get J_(){return this.v2}get offset(){return this.my}set offset(db){this.my=db}}Object(l.a)(He,"ByteArrayReader",null,[]);class Se{constructor(){this.RJ=null;this.DMi=this.xda=0}J(db){if(0>db||db>=this.xda)throw Error.argumentOutOfRange("index");return this.RJ.Yy(this.DMi+4*db,4)}get count(){return this.xda}static Mal(db,Lb,kc){const Kc=
new Se;Kc.RJ=db;Kc.DMi=Lb;Kc.xda=kc;return Kc}}Object(l.a)(Se,"ReadOnlyListOverByteArray",null,[1259]);class jg{constructor(db,Lb){this.wMi=this.vMi=!1;this.zw=this.nSa=this.fOf=this.zMi=null;try{this.zw=Lb.annotations;const kc=Lb.Nib(db.J(0)),Kc=new He(kc);if(-914743053!==Kc.t$())throw Error.argument("Input does not represent a flat lexicon");this.vMi=1===Kc.t$();this.wMi=1===Kc.t$();const Qc=Kc.t$();Kc.offset+=Qc;const md=Kc.t$();this.fOf=jg.KAn(Kc,md,this.zw);const Hd=Kc.t$();this.zMi=jg.aBn(Kc,
Hd);const Ne=Kc.t$();this.nSa=new we.a(Kc.J_,Kc.offset);Kc.offset+=Ne}catch(kc){throw Error.argument("initData");}}get trie(){return this.nSa}DQl(db){return"i"===db&&this.wMi?"\u0130":db.toUpperCase()}IDf(){return this.vMi}PNl(db){let Lb;Lb=new Hb.a(this.zw,L.Annotations.PV);if(1!==db)if(0===db)db=new R.a(this.zw),Array.add(Lb.items,db);else if(db&1073741824){db=this.zMi[db&-1073741825];for(let Kc=0;Kc<db.length;++Kc){var kc=db[Kc];kc=0===kc?new R.a(this.zw):this.fOf[kc-2];Array.add(Lb.items,kc)}}else Array.add(Lb.items,
this.fOf[db-2]);return{returnValue:!0,W0m:Lb}}static KAn(db,Lb,kc){if(Lb%4)throw Error.argument("reader");const Kc=Se.Mal(db.J_,db.offset,Lb/4);db.offset+=Lb;db=[];for(Lb=0;Lb<Kc.count;){const Qc=({fia:Lb}=kc.cPa(L.Annotations.PV,Kc,Lb,null,null,null)).returnValue;Array.add(db,Qc)}return db}static aBn(db,Lb){Lb=db.offset+Lb;const kc=[];for(;db.offset<Lb;){const Kc=db.t$(),Qc=Array(Kc);for(let md=0;md<Kc;++md){const Hd=db.t$();Qc[md]=Hd}Array.add(kc,Qc)}return kc}}Object(l.a)(jg,"RawFlatLexicon",null,
[1265]);var Hi=c(1661),ii=c(1662);class Zh{constructor(db){if(null==db)throw Error.argumentNull("base64String");const Lb=db.length;if(Lb%4)throw Error.argument("base64String's length must be a multiple of 4");this.xda=.75*Lb;this.rLb=Array(Math.ceil(this.xda/4));db.endsWith("==")?this.xda-=2:db.endsWith("=")&&--this.xda;let kc=0;for(let Kc=0;Kc<Lb;Kc+=4){const Qc=Zh.tfe[db.charCodeAt(Kc)-43]<<18|Zh.tfe[db.charCodeAt(Kc+1)-43]<<12|Zh.tfe[db.charCodeAt(Kc+2)-43]<<6|Zh.tfe[db.charCodeAt(Kc+3)-43];let md=
Qc>>16&255;this.rLb[Math.floor(kc/4)]|=md<<kc%4*8;++kc;md=Qc>>8&255;this.rLb[Math.floor(kc/4)]|=md<<kc%4*8;++kc;md=Qc&255;this.rLb[Math.floor(kc/4)]|=md<<kc%4*8;++kc}}get length(){return this.xda}J(db){if(0>db||db>=this.xda)throw Error.argumentOutOfRange("i");return this.k6h(db)}Yy(db,Lb){if(0>db||0>Lb||db+Lb>this.xda)throw Error.argument("Bad range");let kc=0;for(let Kc=0;Kc<Lb;++Kc)kc|=this.k6h(db+Kc)<<8*Kc;return kc}rQn(db,Lb){let kc=0,Kc=0,Qc=Math.floor(db/8);for(db%=8;Kc<Lb;){const md=8-db>Lb-
Kc?Lb-Kc:8-db,Hd=this.J(Qc);kc|=(Hd>>db&~(255<<md))<<Kc;Kc+=md;++Qc;db=0}return kc}k6h(db){return this.rLb[Math.floor(db/4)]>>db%4*8&255}}Zh.tfe=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(l.a)(Zh,"ByteArray",null,[]);class vg{constructor(db,Lb,kc){this.hE=db;this.u9m=Lb;this.x9m=kc;this.LMi=Array(db.b?db.b.length:0);this.DOf=
new Hi.a(new ii.a(this.Nib(this.hE.s)));this.O9=Array(db.t.length);this.uD=new L.Annotations(this.Jib(0),this)}get annotations(){return this.uD}get Msl(){return this.hE.d}m5l(){if(!(""in this.hE.m))throw Error.argument("name","Unrecognized module");return this.Dsf(this.hE.m[""])}Nib(db){if(0>db||!this.hE.b||db>=this.hE.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.LMi[db]||(this.LMi[db]=new Zh(this.hE.b[db]))}IB(db){if(1>db||db>=this.hE.t.length)throw Error.argumentOutOfRange("blobID");
if(1!==this.hE.t[db])throw Error.argument("blobID","Requested blob is not a string");if(null==this.O9[db]){const Lb=this.Jib(db).J(0);this.O9[db]=this.DOf.IB(Lb)}return this.O9[db]}J$b(db){if(1>db||db>=this.hE.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.hE.t[db])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.O9[db]){var Lb=this.Jib(db);const kc=this.IB(Lb.J(0));Lb=1===Lb.J(1);this.O9[db]=new RegExp(kc,Lb?"i":"")}return this.O9[db]}Ucm(db){if(1>db||db>=this.hE.t.length)throw Error.argumentOutOfRange("blobID");
if(3!==this.hE.t[db])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}Dsf(db){if(1>db||db>=this.hE.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.hE.t[db])throw Error.argument("blobID","Requested blob is not an NL module");return this.O9[db]||(this.O9[db]=this.x9m.H5l(this.Jib(db),this))}hL(db){if(1>db||db>=this.hE.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.hE.t[db])throw Error.argument("blobID","Requested blob is not an annotation query");
return this.O9[db]||(this.O9[db]=new Ua(new Jf(this.Jib(db),this)))}EFb(db){if(1>db||db>=this.hE.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.hE.t[db])throw Error.argument("blobID","Requested blob is not an annotation script");return this.O9[db]||(this.O9[db]=new fc(new Bd(this.Jib(db),this)))}Doa(db){if(1>db||db>=this.hE.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.hE.t[db])throw Error.argument("blobID","Requested blob is not a filter");return this.O9[db]||(this.O9[db]=
this.u9m.Doa(this.Jib(db),this))}cbm(db){if(1>db||db>=this.hE.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.hE.t[db])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.O9[db]||(this.O9[db]=new jg(this.Jib(db),this))}Jib(db){const Lb=this.hE.n[db];db=(db<this.hE.t.length-1?this.hE.n[db+1]:this.hE.n.length)-Lb;if(0>Lb||0>db||Lb+db>this.hE.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+Lb+","+db+")");const kc=new cc.a;
kc.Wmf(this.hE.n,Lb,db);return kc}}Object(l.a)(vg,"ObjectFetcher",null,[1236]);class vf{constructor(db,Lb,kc){if(!db)throw Error.argumentNull("prediction");if(!Lb)throw Error.argumentNull("fieldNames");if(!kc)throw Error.argumentNull("values");if(Lb.length!==kc.length)throw Error.argument("values","fieldNames and values do not have same length");this.Dfk=db;this.sLb=Lb;this.X_c=kc}get prediction(){return this.Dfk}get t_h(){return this.sLb.length}Hqf(db){return 0<=db&&db<this.sLb.length?this.sLb[db]:
null}getValue(db){return 0<=db&&db<this.X_c.length?this.X_c[db]:null}}Object(l.a)(vf,"PredictionData",null,[]);class Lf{constructor(db,Lb){if(!db)throw Error.argumentNull("predictions");if(!Lb)throw Error.argumentNull("tokenAttributes");this.A9m=db;this.E9m=Lb}Htf(){return this.A9m}d5h(){return this.E9m}}Object(l.a)(Lf,"PredictionDataWithTokenAttributes",null,[]);class Cg{constructor(db,Lb){this.prediction=null;this.score=0;this.prediction=db;this.score=Lb}}Object(l.a)(Cg,"PredictionWithScore",null,
[]);class bg{constructor(db,Lb){if(!db)throw Error.argumentNull("predictions");if(!Lb)throw Error.argumentNull("attributes");this.Efk=db;this.MWj=Lb}Htf(){return this.Efk}d5h(){return this.MWj}}Object(l.a)(bg,"PredictionsWithTokenAttributes",null,[]);class eg{constructor(db,Lb,kc){if(!db)throw Error.argumentNull("attributeName");if(!Lb)throw Error.argumentNull("fieldNames");if(!kc)throw Error.argumentNull("values");if(Lb.length!==kc.length)throw Error.argument("values","fieldNames and values do not have same length");
this.LWj=db;this.sLb=Lb;this.X_c=kc}get attributeName(){return this.LWj}get t_h(){return this.sLb.length}Hqf(db){return 0<=db&&db<this.sLb.length?this.sLb[db]:null}getValue(db){return 0<=db&&db<this.X_c.length?this.X_c[db]:null}}Object(l.a)(eg,"TokenAttributes",null,[]);var sh=c(54),nh=c(132);class Sh{constructor(db,Lb,kc,Kc,Qc){this.ffd=0;this.ftg=null;this.gfd=this.Lpc=0;this.tqe=this.MTb=this.isa=this.Mpc=null;this.gtg=0;this.HLe=this.sC=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=
this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.zS=db;this.wMj=this.AMj=Lb;this.vMj=this.yMj=kc;this.dfd=this.xMj=Kc;this.efd=this.zMj=Qc}BMj(){this.gfd=0;return this.dtg}dtg(){if(!(this.gfd<this.dfd))return this.etg;this.Mpc=this.wMj.items[this.gfd+this.vMj];this.isa=new R.a(this.zS.Bb.annotations);1!==this.dfd&&this.zS.Bb.bWc||this.isa.J0a(this.Mpc);if(0<=this.zS.Bb.B5d){({value:this.MTb}=this.isa.Mq(this.zS.Bb.B5d)).returnValue?this.MTb=this.MTb.YT():this.MTb=new Hb.a(this.zS.Bb.annotations,
L.Annotations.PV);this.tqe=this.efd.items;this.gtg=this.tqe.length;for(this.ffd=0;this.ffd<this.gtg;++this.ffd)this.ftg=this.tqe[this.ffd],Array.add(this.MTb.items,this.ftg);this.isa.$y(this.zS.Bb.B5d,this.MTb)}else 0<=this.zS.Bb.gig?this.isa.$y(this.zS.Bb.gig,this.efd.items[0]):0<=this.zS.Bb.L4e?this.isa.$y(this.zS.Bb.L4e,!0):this.zS.Bb.YAi?this.efd.items[0].wPd((db,Lb)=>this.isa.$y(db,Lb)):(this.isa.J0a(this.efd.items[0]),1!==this.dfd&&this.zS.Bb.bWc||(({value:this.Lpc}=this.Mpc.Mq(this.zS.Bb.Z3)).returnValue&&
this.isa.$y(this.zS.Bb.Z3,this.Lpc),({value:this.Lpc}=this.Mpc.Mq(this.zS.Bb.d8)).returnValue&&this.isa.$y(this.zS.Bb.d8,this.Lpc),this.Mpc.Mq(this.zS.Bb.mfb).returnValue&&this.isa.$y(this.zS.Bb.mfb,this.Lpc)));this.sC=this.isa;this._state=2;return this.DMj}etg(){this._state=3}CMj(){this.gfd++;return this.dtg}DMj(){return 1<this.dfd&&this.zS.Bb.bWc?this.etg:this.CMj}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new Sh(this.zS,this.AMj,this.yMj,this.xMj,this.zMj)).getEnumerator()}[Symbol.iterator](){return Object(nh.a)(this.getEnumerator())}moveNext(){if(3===
this._state)return!1;this._state?this._state=1:(this._state=1,this.HLe=this.BMj());for(;1===this._state;)this.HLe=this.HLe();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.sC}}Object(l.a)(Sh,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",null,[9,77,87]);class Xk{constructor(db,Lb,kc){this.U_c=this.EMi=0;this.Bfc=null;this.EOf=this.lOf=this.zfc=this.S3d=this.oOf=
0;this.T3d=!1;this.yOf=db;this.GOf=Lb;this.z9m=kc}Wci(){null===this.Bfc&&({fzj:this.Bfc,Vpi:this.oOf,length:this.S3d,XAl:db}=this.yOf.Bji(this.GOf.items[this.U_c],this.z9m),this.T3d=db||this.T3d);if(this.zfc<this.S3d){var db=this.Bfc.charAt(this.oOf+this.zfc);++this.zfc;return{returnValue:!0,ch:db}}if(this.U_c===this.GOf.items.length-1)return{returnValue:!1,ch:"\x00"};++this.U_c;this.zfc=0;this.Bfc=null;return{returnValue:!0,ch:" "}}u7f(db,Lb){this.zfc===this.S3d&&this.Bfc&&(this.EOf=Lb,this.lOf=
this.U_c-this.EMi+1)}U6n(db){if(0>db||db>=this.GOf.items.length)throw Error.argumentOutOfRange("iToken");this.U_c=this.EMi=db;this.Bfc=null;this.lOf=this.zfc=this.S3d=this.oOf=0;this.EOf=-1;this.T3d=!1}i4l(){return{fQk:this.lOf,oZm:this.EOf,WAl:this.T3d}}}Object(l.a)(Xk,"TriePrefixVisitor",null,[1284]);class rl{constructor(db){this.Bb=db}execute(db){if(!({value:kc}=db.Mq(this.Bb.fOa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Lb;({value:Lb}=db.Mq(this.Bb.O_a)).returnValue||
(Lb=null);var kc=this.UMl(kc,Lb);db=L.Annotations.YT(db);db.$y(this.Bb.fOa,kc);return db}UMl(db,Lb){let kc=null;const Kc=this.Bb.flatLexicon.trie,Qc=new Xk(this,db,Lb);let md=null;this.Bb.flatLexicon.IDf()&&(md=Object(sh.a)(this.Bb.flatLexicon,this.Bb.flatLexicon.DQl,"getCaseInsensitiveForm"));let Hd=0,Ne;var Cc;let oe;for(;Hd<db.items.length;){const gc=db.items[Hd];Qc.U6n(Hd);Kc.vKj(Qc,md);({fQk:Ne,oZm:Cc,WAl:oe}=Qc.i4l());if(0<Ne){({W0m:Cc}=this.Bb.flatLexicon.PNl(Cc));for(let eh of this.Lcl(db,
Hd,Ne,Cc)){1<Ne&&this.Bb.bWc&&this.Edl(db,Lb,Hd,gc,Ne,oe,eh);if(!kc)for(kc=new Hb.a(this.Bb.annotations,L.Annotations.PV),Cc=0;Cc<Hd;++Cc)Array.add(kc.items,db.items[Cc]);Array.add(kc.items,eh)}Hd+=Ne}else kc&&Array.add(kc.items,gc),++Hd}return kc||db}Edl(db,Lb,kc,Kc,Qc,md,Hd){if(md)md=!0;else if(this.Bb.HAi){md=!1;var Ne=-1;for(var Cc=0;Cc<Qc;Cc++){var oe=db.items[kc+Cc];let vi;var gc=void 0;if(!({value:vi}=oe.Mq(this.Bb.Z3)).returnValue||!({value:gc}=oe.Mq(this.Bb.d8)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");
if(0<Cc){if(vi>Ne+1){md=!0;break}if(0>Ne||null===Lb||Ne>=Lb.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");if(" "!==Lb.charAt(Ne)){md=!0;break}}Ne=vi+gc}}else md=!1;if(md){gc=new Sys.StringBuilder;for(md=0;md<Qc;++md)({fzj:Ne,Vpi:Cc,length:oe}=this.Bji(db.items[kc+md],Lb)),0<md&&gc.append(" "),gc.append(Ne.substr(Cc,oe));Hd.$y(this.Bb.mfb,gc.toString())}db=db.items[kc+Qc-1];let eh,nj;({value:Kc}=Kc.Mq(this.Bb.Z3)).returnValue&&
({value:eh}=db.Mq(this.Bb.Z3)).returnValue&&({value:nj}=db.Mq(this.Bb.d8)).returnValue?(Hd.$y(this.Bb.Z3,Kc),Hd.$y(this.Bb.d8,eh+nj-Kc)):(Hd.KTa(this.Bb.Z3),Hd.KTa(this.Bb.d8))}Lcl(db,Lb,kc,Kc){return new Sh(this,db,Lb,kc,Kc)}Bji(db,Lb){let kc,Kc;if(({value:kc}=db.Mq(this.Bb.mfb)).returnValue)Kc=!0,Lb=0,db=kc.length;else{Kc=!1;if(null===Lb)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");kc=Lb;if(!({value:Lb}=db.Mq(this.Bb.Z3)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!({value:db}=db.Mq(this.Bb.d8)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>Lb||0>db||Lb+db>kc.length)throw Error.argument("Token start/length values out of range","token");}return{fzj:kc,Vpi:Lb,length:db,XAl:Kc}}}Object(l.a)(rl,"FlatLexiconNLModule",null,[1260]);class sl{constructor(db,Lb){this.L4e=this.B5d=this.gig=this.mfb=this.d8=this.Z3=this.O_a=this.fOa=0;this.YAi=this.HAi=this.bWc=!1;this.flatLexicon=null;this.annotations=Lb.annotations;
let kc=0;try{this.fOa=db.J(kc),++kc,this.O_a=db.J(kc),++kc,this.Z3=db.J(kc),++kc,this.d8=db.J(kc),++kc,this.mfb=db.J(kc),++kc,this.gig=db.J(kc),++kc,this.B5d=db.J(kc),++kc,this.L4e=db.J(kc),++kc,this.bWc=1===db.J(kc),++kc,this.HAi=1===db.J(kc),++kc,this.YAi=1===db.J(kc),++kc,this.flatLexicon=Lb.cbm(db.J(kc))}catch(Kc){throw Error.argument("initData");}}}Object(l.a)(sl,"FlatLexiconNLModuleInit",null,[]);class Xf{constructor(){this.XTc=0;this.Nkf=null;this.D8c=0}}Object(l.a)(Xf,"FeatureGenStackRec",
null,[]);class Dl{constructor(db){this.cng=Array(db);this.Rnc=Array(db);this.Kjg=[];this.Kwj=[]}}Object(l.a)(Dl,"TokenStringLattice",null,[]);const rg=(db,Lb,kc)=>{for(let Kc=0;Kc<db.length;Kc++)kc=Lb(kc,db[Kc]);return kc},Hm=(db,Lb)=>{const kc=Array(db.length);for(let Kc=0;Kc<db.length;Kc++)kc[Kc]=Lb(db[Kc]);return kc},pf=(db,Lb)=>{Lb=Array(Math.min(Lb,db.length));for(let kc=0;kc<Lb.length;kc++)Lb[kc]=db[kc];return Lb},vh=(db,Lb)=>{const kc=[];for(const Kc of db)Lb(Kc)&&Array.add(kc,Kc);return kc};
class ri{constructor(db,Lb){this.key=db;this.value=Lb}}Object(l.a)(ri,"KeyValuePair",null,[]);const tl=(db,Lb)=>({returnValue:Lb in db,value:db[Lb]}),ci=db=>{const Lb=[];for(let kc in db){const Kc=new ri(kc,db[kc]);Array.add(Lb,Kc)}return Lb};class Li{constructor(db){this.Aji=this.qim;this.Bb=db;this.W3d=this.vOf=this.wOf=0;for(const Lb of this.Bb.hOd)this.wOf=Math.max(this.wOf,Lb.a2f),this.vOf=Math.max(this.vOf,Lb.U1f),this.W3d=Math.max(this.W3d,Lb.Eqb.length)}get kDl(){return this.Bb.Gme.trie}execute(db){if(!db)throw Error.argumentNull("input");
let Lb,kc;({tokens:Lb,t_m:kc}=this.rim(db));let Kc=null,Qc=null,md={};if(this.Bb.IWc){Lb=L.Annotations.YT(Lb);for(var Hd=0;Hd<Lb.items.length;++Hd)Lb.items[Hd]=L.Annotations.YT(Lb.items[Hd])}else({b_h:Qc,returnValue:Kc}=this.Odi(db,md));Hd=Array(this.W3d);const Ne=Array(this.W3d);for(var Cc=0;Cc<Ne.length;++Cc)Ne[Cc]=new Xf;for(Cc=-this.wOf;Cc<Lb.items.length+this.vOf;++Cc){let oe=null;this.Bb.IWc&&(oe=Lb.items[Cc],md={},{b_h:Qc,returnValue:Kc}=this.Odi(oe,md));for(const gc of this.Bb.hOd){if(0>Cc&&
-Cc>gc.a2f||Cc>=Lb.items.length&&Cc-Lb.items.length+1>gc.U1f)continue;let eh=!0;for(let nj=0;nj<gc.Eqb.length;++nj){const vi=Cc+gc.Eqb[nj];Hd[nj]=vi;if(0>vi?0>this.Bb.b2f:vi>=Lb.items.length?0>this.Bb.V1f:!kc.Rnc[vi]){eh=!1;break}}eh&&({Zgl:Kc,$gl:Qc}=this.yFm(gc,kc,Kc,Qc,md,Ne,Hd))}this.Bb.IWc&&(oe.$y(this.Bb.v4a?this.Bb.z3b:this.Bb.x3b,Kc),this.Bb.v4a&&oe.$y(this.Bb.y3b,Qc))}db=L.Annotations.YT(db);this.Bb.IWc?db.$y(this.Bb.fOa,Lb):(db.$y(this.Bb.v4a?this.Bb.z3b:this.Bb.x3b,Kc),this.Bb.v4a&&db.$y(this.Bb.y3b,
Qc));return db}rim(db){let Lb,kc;if(!db||!({value:Lb}=db.Mq(this.Bb.fOa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Kc;({value:Kc}=db.Mq(this.Bb.O_a)).returnValue||(Kc="");kc=new Dl(Lb.items.length);const Qc=vh(this.Bb.fng,md=>!md.$Uc||md.$Uc.isMatch(db,null));for(let md=0;md<Lb.items.length;++md){const Hd=Lb.items[md];let Ne=null;kc.cng[md]=kc.Kjg.length;let Cc=kc.Rnc[md]=0;for(const oe of Qc)0<oe.k0c&&kc.Rnc[md]+Cc>=oe.k0c||oe.icd&&!oe.icd.isMatch(Hd,
null)||({kcd:Ne,PHc:Cc}=oe.apply(this,Hd,md,kc,Kc,Ne,Cc))}return{tokens:Lb,t_m:kc}}yFm(db,Lb,kc,Kc,Qc,md,Hd){let Ne=0;md[0].XTc=-1;for(md[0].Nkf=db.hgj;;){var Cc=Hd[Ne],oe=0>Cc||Cc>=Lb.Rnc.length?1:Lb.Rnc[Cc];let nj=!1;for(;md[Ne].XTc<oe-1;){++md[Ne].XTc;var gc=void 0,eh=void 0;0>Cc?(gc=this.Bb.b2f,eh=1):Cc>=Lb.cng.length?(gc=this.Bb.V1f,eh=1):(eh=Lb.cng[Cc]+md[Ne].XTc,gc=Lb.Kjg[eh],eh=Lb.Kwj[eh]);md[Ne].D8c=eh*(Ne?md[Ne-1].D8c:db.score);if(({value:gc}=tl(md[Ne].Nkf,gc.toString())).returnValue){Ne===
db.Eqb.length-1?(Cc=gc,md[Ne].D8c&&(({value:oe}=tl(Qc,Cc.toString())).returnValue||(oe=-1),0>oe&&(kc=L.Annotations.YT(kc),Array.add(kc.items,Cc)),this.Bb.v4a&&(Kc=L.Annotations.YT(Kc),0>oe?Array.add(Kc.items,md[Ne].D8c):Kc.items[oe]+=md[Ne].D8c),0>oe&&(this.Bb.uEi||this.Bb.v4a)&&(Qc[Cc.toString()]=kc.items.length-1))):(++Ne,md[Ne].XTc=-1,md[Ne].Nkf=gc);nj=!0;break}}if(!nj&&(--Ne,0>Ne))break}return{Zgl:kc,$gl:Kc}}Odi(db,Lb){let kc;if(({value:kc}=db.Mq(this.Bb.v4a?this.Bb.z3b:this.Bb.x3b)).returnValue)for(let Kc=
0;Kc<kc.items.length;++Kc)Lb[kc.items[Kc].toString()]=Kc;else kc=new Hb.a(this.Bb.annotations,L.Annotations.NJa);if(this.Bb.v4a){if(({value:Lb}=db.Mq(this.Bb.y3b)).returnValue||(Lb=new Hb.a(this.Bb.annotations,L.Annotations.Tra)),Lb.items.length!==kc.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Bb.annotations.Mea(L.Annotations.PV,db));}else Lb=null;return{returnValue:kc,b_h:Lb}}get SLo(){return this.Bb.Gme}qim(db,
Lb){var kc;if(({value:kc}=Lb.Mq(this.Bb.mfb)).returnValue)db=kc;else{if(!({value:kc}=Lb.Mq(this.Bb.Z3)).returnValue)throw Error.argument("Token is missing Span.StartIndex");if(!({value:Lb}=Lb.Mq(this.Bb.d8)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>kc||0>Lb||kc+Lb>db.length)throw Error.argument("Token indices are out of range");db=db.substr(kc,Lb)}return db}}Object(l.a)(Li,"NGramNLModule",null,[1260,1268]);class kj{constructor(db){this.Eqb=null;this.score=this.U1f=this.a2f=
0;this.hgj=null;if(db){var Lb=0;try{if(db.J(Lb)!==kj.QBb)throw Error.argument("initData","Input does not represent a feature template");++Lb;const kc=db.J(Lb);++Lb;this.Eqb=Array(kc);for(let Kc=0;Kc<kc;++Kc)this.Eqb[Kc]=db.J(Lb),++Lb;this.a2f=db.J(Lb);++Lb;this.U1f=db.J(Lb);++Lb;this.score=db.J(Lb);++Lb;this.hgj=({Ppi:Lb}=kj.Q7i(db,Lb)).returnValue}catch(kc){throw Error.argument("initData");}}}static Q7i(db,Lb){const kc=db.J(Lb);++Lb;const Kc={};for(let Qc=0;Qc<kc;++Qc){const md=db.J(Lb);++Lb;db.J(Lb)?
Kc[md.toString()]=({Ppi:Lb}=kj.Q7i(db,Lb)).returnValue:(++Lb,Kc[md.toString()]=db.J(Lb),++Lb)}return{returnValue:Kc,Ppi:Lb}}}kj.QBb=240803228;Object(l.a)(kj,"FeatureTemplate",null,[1285]);var El=c(1621);class Ph{constructor(db,Lb){this.v4a=this.uEi=this.IWc=!1;this.mfb=this.d8=this.Z3=this.fOa=this.O_a=this.y3b=this.z3b=this.x3b=0;this.Gme=null;this.V1f=this.b2f=0;this.hOd=this.fng=null;if(db){this.annotations=Lb.annotations;var kc=0;try{this.IWc=1===db.J(kc);++kc;this.uEi=1===db.J(kc);++kc;this.v4a=
1===db.J(kc);++kc;this.x3b=db.J(kc);++kc;this.z3b=db.J(kc);++kc;this.y3b=db.J(kc);++kc;this.O_a=db.J(kc);++kc;this.fOa=db.J(kc);++kc;this.Z3=db.J(kc);++kc;this.d8=db.J(kc);++kc;this.mfb=db.J(kc);++kc;this.Gme=this.vBn(Lb.Nib(db.J(kc)));++kc;this.b2f=db.J(kc);++kc;this.V1f=db.J(kc);++kc;const Kc=db.J(kc);++kc;this.fng=Array(Kc);for(let md=0;md<Kc;++md){const Hd=db.J(kc);++kc;const Ne=this.Gme.trie,Cc=new cc.a;Cc.yib(db,kc,Hd);this.fng[md]=this.yBn(Cc,Lb,Ne);kc+=Hd}const Qc=db.J(kc);++kc;this.hOd=Array(Qc);
for(Lb=0;Lb<Qc;++Lb){const md=db.J(kc);++kc;const Hd=new cc.a;Hd.yib(db,kc,md);this.hOd[Lb]=this.bBn(Hd);kc+=md}}catch(Kc){throw Error.argument("initData");}}}vBn(db){return new Hi.a(new ii.a(db))}yBn(db,Lb,kc){return El.a.create(db,Lb,kc)}bBn(db){return new kj(db)}}Object(l.a)(Ph,"NGramNLModuleInit",null,[]);class ji{constructor(db){this.Bb=db}execute(db){if(!db)throw Error.argumentNull("input");db=db.clone();this.Bb.script.execute(db,null);return db}}Object(l.a)(ji,"ScriptNLModule",null,[1260]);
class ej{constructor(db,Lb){db&&(this.script=Lb.EFb(db.J(0)))}}Object(l.a)(ej,"ScriptNLModuleInit",null,[]);const Hk=db=>{db=Hm(db,Lb=>Lb*Lb);return Math.sqrt(rg(db,(Lb,kc)=>Lb+kc,0))},Yk=db=>rg(db,(Lb,kc)=>Lb>kc?Lb:kc,db[0]);class nn{constructor(db){this.Bb=db}execute(db){if(!db)throw Error.argumentNull("input");var Lb=[],kc=[];this.I0k(db,Lb,kc);this.rAk(Lb,kc);const Kc={};for(let md=0;md<Lb.length;++md){var Qc=Lb[md];const Hd=this.Bb.eui.J(Qc);Qc=this.Bb.fui.J(Qc);for(let Ne=0;Ne<Qc;++Ne){const Cc=
this.Bb.q8.J(this.Bb.vEh.J(Hd+Ne)),oe=this.Bb.wEh.J(Hd+Ne);let gc;({value:gc}=tl(Kc,Cc)).returnValue||(gc=0);Kc[Cc]=gc+kc[md]*oe}}kc=ci(Kc);kc.sort((md,Hd)=>{var Ne=md.value,Cc=Hd.value;(Ne=-(Ne>Cc?1:Ne<Cc?-1:0))||(Ne=md.key.localeCompare(Hd.key));return Ne});Lb=new Hb.a(this.Bb.annotations,L.Annotations.PV);for(const md of pf(kc,this.Bb.Yan))kc=new R.a(this.Bb.annotations),kc.$y(this.Bb.tIk,md.key),kc.$y(this.Bb.vIk,md.value),Array.add(Lb.items,kc);db.$y(this.Bb.uIk,Lb);return db}I0k(db,Lb,kc){if(({value:db}=
db.Mq(this.Bb.sIk)).returnValue){let Kc;if(({value:Kc}=db.Mq(this.Bb.z3b)).returnValue){let Qc;if(!({value:Qc}=db.Mq(this.Bb.y3b)).returnValue||Kc.items.length!==Qc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.ZGd(Kc,Qc,Lb,kc)}if(({value:Kc}=db.Mq(this.Bb.xIk)).returnValue){let Qc;if(!({value:Qc}=db.Mq(this.Bb.yIk)).returnValue||Kc.items.length!==Qc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");
this.ZGd(Kc,Qc,Lb,kc)}({value:Kc}=db.Mq(this.Bb.x3b)).returnValue&&this.ZGd(Kc,null,Lb,kc);({value:Kc}=db.Mq(this.Bb.wIk)).returnValue&&this.ZGd(Kc,null,Lb,kc)}}ZGd(db,Lb,kc,Kc){for(let md=0;md<db.items.length;++md){var Qc=void 0;db.g5===L.Annotations.caa?({value:Qc}=tl(this.Bb.GVh,db.items[md])).returnValue||(Qc=-1):(Qc=db.items[md],Qc=Qc>=this.Bb.$Pf&&Qc<=this.Bb.Ebn?this.Bb.VTf?this.Bb.VTf.J(Qc-this.Bb.$Pf)-1:Qc-this.Bb.$Pf:-1);if(0<=Qc){let Hd;Hd=Lb?Lb.items[md]:1;0<Hd&&(Array.add(kc,Qc),Array.add(Kc,
Hd))}}}rAk(db,Lb){if(db.length){switch(this.Bb.GLn){case 0:break;case 1:for(var kc=0;kc<Lb.length;++kc)Lb[kc]=1+Math.log(Lb[kc]);break;case 2:kc=Yk(Lb);for(let Kc=0;Kc<Lb.length;++Kc)Lb[Kc]=.5+Lb[Kc]/kc*.5;break;case 3:for(kc=0;kc<Lb.length;++kc)Lb[kc]=1;break;default:throw Error.notImplemented();}if(this.Bb.xYd)for(kc=0;kc<Lb.length;++kc)Lb[kc]*=this.Bb.xYd.J(db[kc]);db=Hk(Lb);for(kc=0;kc<Lb.length;++kc)Lb[kc]/=db}}}Object(l.a)(nn,"TfIdfRankerNLModule",null,[1260]);class Yl{constructor(db,Lb=0){if(!db)throw Error.argumentNull("byteArray");
this.X3d=Lb;if(604662927!==db.Yy(this.X3d+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.ak=db.Yy(this.X3d+4,4);this.nMi=db.Yy(this.X3d+8,4);this.n9m=db}J(db){if(0>db||db>=this.count)throw Error.argumentOutOfRange("index");return this.n9m.rQn(8*this.X3d+96+db*this.nMi,this.nMi)}get count(){return this.ak}}Object(l.a)(Yl,"CompactIntArray",null,[1259]);const Hh=(db,Lb)=>{Lb=Array(Lb);for(let md=0;md<Lb.length;md++){var kc=md,Kc=db.t$(),Qc=1===(Kc>>31&1)?-1:
1;const Hd=Kc&8388607;Kc=Kc>>23&255;256===Kc+1?Qc=Hd?Number.NaN:1===Qc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:Kc?(Kc-=127,Qc=Qc*bn(Hd,1)*Math.pow(2,Kc)):Qc=Qc*bn(Hd,0)*Math.pow(2,-126);Lb[kc]=Qc}return Lb},bn=(db,Lb)=>{let kc=0;for(let Kc=0;23>Kc;Kc++)kc+=(db>>22-Kc&1)/Math.pow(2,Kc+1);return Lb+kc};class lj{constructor(db,Lb){this.VTf=null;this.LSi=0;this.fui=this.eui=this.xYd=null;this.KSi=0;this.wEh=this.vEh=null;this.annotations=Lb.annotations;let kc=0;this.wIk=db.J(kc);++kc;this.x3b=
db.J(kc);++kc;this.xIk=db.J(kc);++kc;this.yIk=db.J(kc);++kc;this.z3b=db.J(kc);++kc;this.y3b=db.J(kc);++kc;this.sIk=db.J(kc);++kc;this.uIk=db.J(kc);++kc;this.tIk=db.J(kc);++kc;this.vIk=db.J(kc);++kc;var Kc=db.J(kc);++kc;var Qc=Array(Kc);for(var md=0;md<Kc;++md)Qc[md]=Lb.IB(db.J(kc)),++kc;this.q8=cc.a.Wbf(Qc);this.Yan=db.J(kc);++kc;this.GLn=db.J(kc);++kc;Kc=db.J(kc);++kc;this.GVh={};for(Qc=0;Qc<Kc;++Qc){md=Lb.IB(db.J(kc));++kc;const Hd=db.J(kc);++kc;this.GVh[md]=Hd}this.$Pf=db.J(kc);++kc;this.Ebn=db.J(kc);
++kc;Kc=db.J(kc);++kc;0<Kc&&(Kc=Lb.Nib(db.J(kc)),++kc,this.VTf=this.q$d(new He(Kc)));++kc;db=Lb.Nib(db.J(kc));this.iBn(db)}q$d(db){return new Yl(db.J_,db.offset)}iBn(db){try{const Lb=new He(db);this.LSi=Lb.t$();1===Lb.t$()?this.xYd=cc.a.Wbf(Hh(Lb,this.LSi)):this.xYd=null;const kc=Lb.t$();this.eui=this.q$d(Lb);Lb.offset+=kc;const Kc=Lb.t$();this.fui=this.q$d(Lb);Lb.offset+=Kc;this.KSi=Lb.t$();const Qc=Lb.t$();this.vEh=this.q$d(Lb);Lb.offset+=Qc;this.wEh=cc.a.Wbf(Hh(Lb,this.KSi))}catch(Lb){throw Error.argument("byteReader");
}}}Object(l.a)(lj,"TfIdfRankerNLModuleInit",null,[]);class il{constructor(db,Lb,kc,Kc){this.$_f=db;this.Y0h=kc;this.tokens=Kc;this.Lna=Lb;this.Nkc=-1;this.gge=0}}Object(l.a)(il,"TokenizerData",null,[]);class zk{constructor(db){this.Bb=db}execute(db){if(!db)throw Error.argumentNull("input");if(!({value:Kc}=db.Mq(this.Bb.O_a)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Lb;({value:Lb}=db.Mq(this.Bb.Z3)).returnValue||(Lb=0);let kc;({value:kc}=
db.Mq(this.Bb.d8)).returnValue||(kc=Kc.length-Lb);if(0>Lb||Lb>Kc.length)throw Error.argument("input","Start index out of range");if(0>kc||kc>Kc.length)throw Error.argument("input","Length out of range");if(Lb+kc>Kc.length)throw Error.argument("input","Bad start-length range");var Kc=new il(Kc,Lb,Lb+kc,new Hb.a(this.Bb.annotations,L.Annotations.PV));this.TLo(Kc);db=db.isReadOnly?db.clone():db;db.$y(this.Bb.fOa,Kc.tokens);return db}TLo(db){for(;db.Lna<db.Y0h;){if(this.Bb.$wf){var Lb=this.Bb.$wf.SLi(db.$_f,
db.Lna,db.Y0h-db.Lna,null);!Lb.succeeded&&Lb.ARi&&(Lb=Lb.ARi);if(Lb.succeeded){this.IWi(db,Lb.length,this.Bb.Oli);db.Lna+=Lb.length;continue}}Lb=db.$_f.substr(db.Lna);let kc=-1,Kc=-1,Qc=-1;for(let md=0;md<this.Bb.ife.length;++md){const Hd=this.Bb.ife[md].exec(Lb);Hd&&0<Hd[1].length&&(0>kc||Hd[0].length>Kc)&&(kc=md,Kc=Hd[0].length,Qc=Hd[1].length)}0<=kc?(this.IWi(db,Qc,this.Bb.Kag[kc]),db.Lna+=Qc):db.Lna+=1}}IWi(db,Lb,kc){if(this.Bb.LCi)kc!==zk.oQk&&(0>db.Nkc&&(db.Nkc=db.Lna),db.gge=db.Lna+Lb-db.Nkc,
kc===zk.nQk&&(0<=db.Nkc&&0<db.gge&&(Lb=new R.a(this.Bb.annotations),Lb.$y(this.Bb.Z3,db.Nkc),Lb.$y(this.Bb.d8,db.gge),Lb.$y(this.Bb.A3e,zk.pQk),Lb.$y(this.Bb.O_a,db.$_f),Array.add(db.tokens.items,Lb)),db.Nkc=-1,db.gge=0));else{let Kc=new R.a(this.Bb.annotations);Kc.$y(this.Bb.Z3,db.Lna);Kc.$y(this.Bb.d8,Lb);Kc.$y(this.Bb.A3e,kc);Array.add(db.tokens.items,Kc)}}}zk.oQk="GAP";zk.nQk="EOS_CHUNK";zk.pQk="SENTENCE";Object(l.a)(zk,"TokenizerNLModule",null,[1260]);class Im{constructor(db,Lb){this.d8=this.Z3=
this.A3e=this.fOa=this.O_a=0;this.LCi=!1;this.Kag=this.ife=this.Oli=this.$wf=null;if(db){this.annotations=Lb.annotations;var kc=0;try{this.O_a=db.J(kc);++kc;this.fOa=db.J(kc);++kc;this.A3e=db.J(kc);++kc;this.Z3=db.J(kc);++kc;this.d8=db.J(kc);++kc;this.LCi=1===db.J(kc);++kc;var Kc=db.J(kc);++kc;0<Kc&&(this.$wf=Lb.Dsf(Kc).kDl);this.Oli=db.J(kc)?Lb.IB(db.J(kc)):"";++kc;const Qc=db.J(kc);++kc;this.ife=Array(Qc);this.Kag=Array(Qc);for(Kc=0;Kc<Qc;++Kc)this.ife[Kc]=new RegExp(Lb.IB(db.J(kc))),++kc,this.Kag[Kc]=
Lb.IB(db.J(kc)),++kc}catch(Qc){throw Error.argument("initData");}}}}Object(l.a)(Im,"TokenizerNLModuleInit",null,[]);class zd{constructor(db){this.Bb=db}execute(db){if(!db)throw Error.argumentNull("input");let Lb;if(!({value:Lb}=db.Mq(this.Bb.xwh)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const kc of this.Bb.$ig)Lb=kc.apply(Lb);db=L.Annotations.YT(db);db.$y(this.Bb.ywh,Lb);return db}static L2e(db,Lb){const kc=new Sys.StringBuilder;for(let Kc=
0;Kc<db.length;++Kc)kc.append(Lb(db.substr(Kc,1)));return kc.toString()}}Object(l.a)(zd,"TransliteratorNLModule",null,[1260]);class hf{constructor(db){db&&(this.style=db.J(0))}apply(db){return zd.L2e(db,Lb=>hf.MUk(Lb,this.style))}static MUk(db,Lb){switch(Lb){case 0:return db.toLowerCase();case 1:return"I"===db?"\u0131":db.toLowerCase();case 2:return db.toUpperCase();case 3:return"i"===db?"\u0130":db.toUpperCase();default:throw Error.invalidOperation();}}}hf.RBb=0;Object(l.a)(hf,"ChangeCaseTransliterationStage",
null,[1276]);class Mi{apply(db){return zd.L2e(db,Mi.uNo)}static uNo(db){const Lb=db.charCodeAt(0);return 65281<=Lb&&65374>=Lb?String.fromCharCode(Lb-65248):db}}Mi.RBb=4;Object(l.a)(Mi,"LatinFullWidthToHalfWidthTransliterationStage",null,[1276]);class Rl{constructor(db,Lb){db&&(this.M6f=Lb.J$b(db.J(0)),this.A4n=Lb.IB(db.J(1)))}apply(db){return db.replace(this.M6f,this.A4n)}}Rl.RBb=1;Object(l.a)(Rl,"RegexReplaceTransliterationStage",null,[1276]);class me{constructor(db,Lb){if(db){var kc=db.J(0),Kc=
Lb.IB(db.J(1)),Qc=new Yl(Lb.Nib(db.J(2)));db=0>db.J(3)?null:new Yl(Lb.Nib(db.J(3)));this.ekg={};for(Lb=0;Lb<kc;++Lb)this.ekg[Kc.charAt(Lb).toString()]=Kc.substr(Qc.J(Lb),db?db.J(Lb):1)}}apply(db){return zd.L2e(db,Lb=>Lb in this.ekg?this.ekg[Lb]:Lb)}}me.RBb=2;Object(l.a)(me,"SingleCharSubstitutionsTransliterationStage",null,[1276]);class qd{constructor(db,Lb){this.ywh=this.xwh=0;this.$ig=null;if(db){this.annotations=Lb.annotations;var kc=0;try{this.xwh=db.J(kc);++kc;this.ywh=db.J(kc);++kc;const Kc=
db.J(kc);++kc;this.$ig=Array(Kc);for(let Qc=0;Qc<Kc;++Qc){const md=db.J(kc);++kc;const Hd=db.J(kc);++kc;const Ne=new cc.a;Ne.yib(db,kc,Hd);kc+=Hd;this.$ig[Qc]=this.uBn(md,Ne,Lb)}}catch(Kc){throw Error.argument("initData");}}}uBn(db,Lb,kc){switch(db){case hf.RBb:return new hf(Lb);case Rl.RBb:return new Rl(Lb,kc);case me.RBb:return new me(Lb,kc);case Mi.RBb:return new Mi;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(l.a)(qd,"TransliteratorNLModuleInit",
null,[]);class Yj{H5l(db,Lb){const kc=db.J(0),Kc=new cc.a;Kc.yib(db,1,db.count-1);switch(kc){case 0:return new ji(new ej(Kc,Lb));case 2:return new zk(new Im(Kc,Lb));case 3:return new Li(new Ph(Kc,Lb));case 5:return new rl(new sl(Kc,Lb));case 9:return new zd(new qd(Kc,Lb));case 10:return new nn(new lj(Kc,Lb));default:throw Error.notImplemented();}}}Object(l.a)(Yj,"NLModuleFactory",null,[1234]);class af{constructor(db){this.lQk=";";if(!db)throw Error.argumentNull("resource");this.Ria=new vg(db,new mb,
new Yj);this.yOf=this.Ria.m5l();this.mMi=this.Ria.annotations.BPc("Text.Text");this.kMi=this.Ria.annotations.BPc("Classification.Predictions");this.jOf=this.Ria.annotations.BPc("Classification.PredictionString");this.lMi=this.Ria.annotations.BPc("Classification.Probability");this.m9m=this.Ria.annotations.BPc("NLMod.Tokens");if(0>this.mMi||0>this.kMi||0>this.jOf||0>this.lMi)throw Error.argument("resourceObj","Resource does not represent a ranker");}$Ol(){const db=[];this.Bjf(void 0,this.N5h(db),null);
return db}bPl(db,Lb){const kc=[],Kc=[];this.Bjf(db,this.N5h(kc),(Qc,md)=>{const Hd=this.Ria.annotations.A5h(Qc),Ne=[],Cc=[];Lb&&Lb.length&&-1===Array.indexOf(Lb,Hd)||(Qc=this.Ria.annotations.getAttributeType(Qc),this.Y2i(Qc,md,Ne,Cc),md=new eg(Hd,Ne,Cc),Array.add(Kc,md))});return new bg(kc,Kc)}aPl(db){const Lb=[];this.Bjf(db,kc=>{let Kc;if(({value:Kc}=kc.Mq(this.jOf)).returnValue){let Qc;({value:Qc}=kc.Mq(this.lMi)).returnValue&&Array.add(Lb,new Cg(Kc,Qc))}},null);return Lb}Bjf(db,Lb,kc){var Kc=new R.a(this.Ria.annotations);
Kc.$y(this.mMi,db);db=this.yOf.execute(Kc);if(({value:Kc}=db.Mq(this.kMi)).returnValue)for(const Qc of Kc.items)Lb(Qc);if(kc&&({value:Lb}=db.Mq(this.m9m)).returnValue)for(const Qc of Lb.items)Qc.wPd(kc)}Y2i(db,Lb,kc,Kc){if(L.Annotations.tI(db))for(var Qc of Lb.items)this.Y2i(Lb.g5,Qc,kc,Kc);else if(L.Annotations.GDj(db)){Qc=this.Ria.annotations.tdi(db);for(let md=0;md<Qc;md++)Array.add(kc,this.Ria.annotations.Xhi(db,md)),Array.add(Kc,this.Ria.annotations.Mea(this.Ria.annotations.eHb(db,md),Lb.ajb(md)))}else Array.add(kc,
"VALUE"),Array.add(Kc,this.Ria.annotations.Mea(db,Lb))}N5h(db){return Lb=>{let kc;({value:kc}=Lb.Mq(this.jOf)).returnValue&&Array.add(db,this.D$l(kc))}}D$l(db){const Lb=db.indexOf(this.lQk);return 0>Lb?db:db.substring(0,Lb)}}Object(l.a)(af,"Ranker",null,[]);var Xe=c(1559),ho=c(1571),ki=c(2);class qm{constructor(db,Lb){this.E4g="";this.KPe=null;this.LPe=!1;this.qsa=null;this.OWj=["TellMe.TellMeParamCollection"];this.fc=db;this.JYa=Lb;this.fc.jBb&&(this.qsa=null)}get Sbe(){if(!this.KPe&&!this.LPe){let db=
null;try{db=window.TellMeModel}catch(Lb){if(t.TellMeActor.instance.Oe)t.TellMeActor.instance.Oe.onError("QueryRanker","TellMeModel not found. Exception: "+Lb)}if(db){try{this.KPe=new af(db)}catch(Lb){if(t.TellMeActor.instance.Oe)t.TellMeActor.instance.Oe.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+Lb)}this.LPe=!0}else if(t.TellMeActor.instance.Oe)t.TellMeActor.instance.Oe.onError("QueryRanker","Classifier model not found")}return this.KPe}oL(){return"Command"}BU(){return 0===
this.fc.hv?0:1===this.fc.hv?1:2}dI(db,Lb,kc=!1,Kc=e.a.tellMe,Qc=null){const md=new m.a(db);if((!Qc||Array.contains(Qc,0))&&!z.a.FR(db)){if(!this.Sbe&&this.LPe){if(t.TellMeActor.instance.Oe)t.TellMeActor.instance.Oe.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.fc.jBb&&this.qsa&&this.qsa.initialize();if(Xe.CommandResultsUtility.RDf(db.Gg)&&(Qc=Xe.CommandResultsUtility.r7h(db.Gg),0<Qc.results.length)){Qc.displayName=
"Classifier Debug";md.dv(Qc);Lb.resultsUpdated(md);return}Qc=db?this.E4g=db.Gg:this.E4g;if(ki.AFrameworkApplication.K.$("TellMeParameterizedQueriesEnabled")){Qc=this.F$l(Qc);var Hd=this.RQd(Qc.Htf());Qc=Qc.d5h()}else Qc=this.E$l(Qc),Hd=this.hSl(Qc),Qc=[];Xe.CommandResultsUtility.h3d(Hd,!1,"Classifier","TFIDF");Hd=Xe.CommandResultsUtility.PRc(db,Hd,this.fc,this.qsa,this.JYa,Qc,0,1);0<Hd.results.length&&Kc!==e.a.contextMenu&&(Hd.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);kc||Hd.results.length||
this.fc.E0||this.fc.r8a||(db=new x.a("lookupNoResults",14,db.Gg,null,1),Hd.Uw(db));0<Hd.results.length&&md.dv(Hd);md.attributes=Qc}Lb.resultsUpdated(md)}Htf(){let db=[];try{db=this.Sbe.$Ol()}catch(Lb){if(t.TellMeActor.instance.Oe)t.TellMeActor.instance.Oe.onError("GetPredictions","Exception: "+Lb)}return db}E$l(db){let Lb=[];try{Lb=this.Sbe.aPl(db)}catch(kc){if(t.TellMeActor.instance.Oe)t.TellMeActor.instance.Oe.onError("GetPredictionsWithScore","Exception: "+kc)}return Lb}F$l(db){try{return this.Sbe.bPl(db,
this.OWj)}catch(Lb){if(t.TellMeActor.instance.Oe)t.TellMeActor.instance.Oe.onError("GetPredictionsWithTokenAttributes","Exception: "+Lb)}return new bg([],[])}RQd(db){const Lb=[];if(db)for(const kc of db)Lb.push(new ho.a(kc,-99999));return Lb}hSl(db){const Lb=[];if(db)for(const kc of db)Lb.push(new ho.a(kc.prediction,kc.score));return Lb}}Object(l.a)(qm,"CommandResultsProvider",null,[1112]);var Fj=c(1759);class rm{constructor(db){this.fc=db}oL(){return"Feedback"}BU(){return 0===this.fc.hv?0:1===this.fc.hv?
1:2}dI(db,Lb,kc,Kc,Qc=null){db=new m.a(db);if(!Qc||Array.contains(Qc,21))Qc=[],Qc.push(appChrome.actions.setControlLabel("TellMeFeedback",CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(Qc),Qc=new y.a(22),Qc.displayName="",Qc.Uw(new x.a("TellMeFeedback",23,null,null,1)),db.dv(Qc);Lb.resultsUpdated(db)}}Object(l.a)(rm,"FeedbackResultsProvider",null,[1112]);class Tf{constructor(db,Lb,kc,Kc){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=db;this.CommandId=
Lb;this.CommandValueId=kc;this.InputText=Kc}}Object(l.a)(Tf,"FindInDocumentProp",null,[]);var Fl=c(19);class Hf{constructor(db){this.AKe=2;this.kxb=[];this.Fcb=[];this.fc=db;Hf.YEa=db.Wkf;Hf.q0h="FindInDocumentSuggestion";Hf.j2i="FindInDocumentSuggestion3";this.tJe=Object.assign(new v.a,{landingTab:"Indoc",data:null});this.kjk=this.fc.rqb||!!ki.AFrameworkApplication.ua&&ki.AFrameworkApplication.ua.Kb.rqb}oL(){return"FindInDocument"}BU(){return 0===this.fc.hv?0:1===this.fc.hv?1:3===this.fc.hv?this.fc.euj?
2:3:2}dI(db,Lb,kc=!1,Kc,Qc=null){const md=new m.a(db);if(Qc&&!Array.contains(Qc,2))Lb.resultsUpdated(md);else if(Array.clear(this.kxb),z.a.FR(db)){if(kc&&this.orj()){kc=new y.a(2);kc.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Qc=1;Kc="";if(0<this.Fcb.length&&!this.fc.Hlc)for(var Hd of this.Fcb)if(""!==Hd.Label.toLowerCase()){if(Qc>=this.AKe)break;this.EHj(kc,Hd.Label,Hd.CommandValueId,Hf.q0h+Qc,Hd.InputText);Qc++}Hd="";this.fc.XP?(md.dv(kc),kc=new y.a(3),Hd=this.fc.hfb?z.a.Kib(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):
CommonUIStrings.l_TellMeOpenFindPaneTextV2):Hd=CommonUIStrings.l_TellMeOpenFindPaneText;Kc=this.q7h("");this.EHj(kc,Hd,Kc,Hf.j2i,"");md.dv(kc)}Lb.resultsUpdated(md)}else Hd="",kc&&(kc=this.q7h(db.Gg),Kc=[],this.fc.Y4a?(this.fc.Lie&&Kc.push(appChrome.actions.setControlIconSet(Hf.YEa,{"default":"FindInDocument_20"})),Hd=this.fc.jIf?z.a.arf(db.Gg,CommonUIStrings.l_FindInDocumentScopedButtonText):db.Gg+CommonUIStrings.l_FindInDocumentScopedButtonText):this.fc.XP?(Hd=this.fc.hfb?z.a.Kib(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,
db.Gg)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,db.Gg),Kc.push(appChrome.actions.setControlIconSet(Hf.YEa,{"default":"FindInDocument_20"}))):Hd=this.fc.Hlc?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,db.Gg),this.fc.bxa?(t.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Hf.YEa,Hd)),t.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Hf.YEa,kc))):(Kc.push(appChrome.actions.setControlLabel(Hf.YEa,
Hd)),Kc.push(appChrome.actions.setButtonCommandValueId(Hf.YEa,kc)),appChrome.api.dispatch(Kc)),this.Mmj(Hd,Hf.YEa,kc,db.Gg)),this.fc.euj?(Hd=new x.a(Hf.YEa,8,db.Gg),kc=new y.a(2),kc.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,kc.Uw(Hd),md.dv(kc),Lb.resultsUpdated(md)):this.fc.ORd(db.Gg).then(Ne=>{const Cc=new x.a(Hf.YEa,8,db.Gg,null,1);Cc.count=Ne;Ne=new y.a(2);Ne.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Ne.Uw(Cc);md.dv(Ne);Lb.resultsUpdated(md)},Ne=>{t.TellMeActor.instance.Oe.onError("FindInDocumentResultsProvider:issueQuery",
"Find manager promise rejected: "+Ne);Ne=new x.a(Hf.YEa,8,db.Gg,null,1);const Cc=new y.a(2);Cc.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Cc.Uw(Ne);md.dv(Cc);Lb.resultsUpdated(md)})}orj(){return!!this.fc&&this.fc.Die}EHj(db,Lb,kc,Kc,Qc=null){const md=[];Lb&&md.push(appChrome.actions.setControlLabel(Kc,Lb));this.fc.XP&&md.push(appChrome.actions.setControlIconSet(Kc,{"default":"FindInDocument_20"}));md.push(appChrome.actions.setButtonCommandValueId(Kc,kc));appChrome.api.dispatch(md);
this.Mmj(Lb,Kc,kc,"");db.Uw(new x.a(Kc,8,Qc,null,1,-99999))}q7h(db){return this.kjk?z.a.VOa(db,15,this.tJe):Fl.a.zf(db)}Mmj(db,Lb,kc,Kc){this.orj()&&this.kxb.length<this.AKe&&(db=new Tf(db,Lb,kc,Kc),Array.add(this.kxb,db))}clo(db){for(let Lb=0;Lb<this.kxb.length;Lb++)if(this.kxb[Lb].CommandId===db){const kc=this.kxb[Lb].Label;let Kc=!1;if(0<this.Fcb.length){let Qc=0;for(const md of this.Fcb){if(md.Label===kc){Array.removeAt(this.Fcb,Qc);Kc=!0;break}Qc++}}!Kc&&this.Fcb.length>=this.AKe-1&&Array.removeAt(this.Fcb,
1);Array.insert(this.Fcb,0,this.kxb[Lb])}}}Hf.YEa=null;Hf.q0h=null;Hf.j2i=null;Object(l.a)(Hf,"FindInDocumentResultsProvider",null,[1112]);var Ed=c(1757);class Zl{constructor(db){this.fc=db}oL(){return"Insights"}BU(){return 0===this.fc.hv?0:1===this.fc.hv?1:2}dI(db,Lb,kc=!1,Kc,Qc=null){Kc=new m.a(db);if(!Qc||Array.contains(Qc,13))if(this.uuo()||!z.a.FR(db)){Qc=new y.a(13);var md=""===db.Gg.trim(),Hd=md?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",Ne=new x.a(Hd,10,db.Gg,null,1);kc&&(kc=
null,z.a.Lpa()?md?md=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:(md=this.fc.Hlc?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,db.Gg),kc=z.a.VOa(db.Gg,1)):(md=String.format(CommonUIStrings.l_InsightsButtonText,db.Gg),kc=z.a.sDb(db.Gg)),this.fc.bxa?(t.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Hd,md)),kc&&t.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",
kc))):(db=[],db.push(appChrome.actions.setControlLabel(Hd,md)),kc&&db.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",kc)),appChrome.api.dispatch(db)),Ne.label=md);Qc.Uw(Ne);Kc.dv(Qc)}Lb.resultsUpdated(Kc)}uuo(){return z.a.Lpa()&&this.fc.WIo&&!this.fc.kha}}Object(l.a)(Zl,"InsightsResultsProvider",null,[1112]);var ed=c(1755);class Bf{constructor(db){this.fc=db}oL(){return"Learning"}BU(){return 0===this.fc.hv?0:1===this.fc.hv?1:2}dI(db,Lb,kc,Kc,Qc=null){kc=new m.a(db);Qc&&!Array.contains(Qc,
21)||!z.a.FR(db)||(Qc=[],Kc=this.fc.E0m,Qc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",Kc)),Kc=Bf.DZl(Kc),Qc.push(appChrome.actions.setControlLabel("LearningForSearch",Kc)),appChrome.api.dispatch(Qc),db=new x.a("LearningForSearch",22,db.Gg,null,1),Qc=new y.a(21),Qc.Uw(db),kc.dv(Qc));Lb.resultsUpdated(kc)}static DZl(db){const Lb=[];Array.add(Lb,new ed.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Lb,new ed.a(400,CommonUIStrings.l_TellMeLearningButtonText));
Array.add(Lb,new ed.a(600,db));Array.add(Lb,new ed.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));db={};db.parts=Lb;return JSON.stringify(db)}}Object(l.a)(Bf,"LearningProvider",null,[1112]);var Og=c(612);class Rm{constructor(db,Lb){this.JYb=this.B1b=this.edb=this.Mrd=null;this.Ax=!1;this.rZb=db;this.g0j=Lb;db&&this.DZh(db)}qne(){this.rZb.qne()&&this.DZh(this.rZb)}getSuggestions(db){let Lb=[];var kc=[];db=Rm.Yhn(db);var Kc="";Array.clear(kc);for(let Qc=0;Qc<db.length;Qc++){const md=db.charAt(Qc);
-1!==" ".indexOf(md)?(Kc.length&&Array.add(kc,Kc),Kc=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(md)?(Kc.length&&Array.add(kc,Kc),Kc=md,Array.add(kc,Kc),Kc=""):Kc+=md}Kc.length&&Array.add(kc,Kc);for(db=0;db<kc.length;db++)Kc=this.gSl(kc[db]),Kc=this.B7k(Kc),Lb=Rm.Bcn(Lb,Kc);return Lb=this.yuk(Lb)}tGf(){this.Ax||this.qne();return this.Ax}tKd(db){return this.Mrd[db.toString()]}yuk(db){for(let Lb=0;Lb<db.length;Lb++){const kc=this.edb[Lb];if(db[Lb].commandId!==this.tKd(kc[0]))throw Error.create("Incorrect Tcid orders with Priors data");
let Kc;(Kc=db[Lb]).score=Kc.score+kc[1]}return db}B7k(db){const Lb=[];for(var kc=0;kc<this.edb.length;kc++)Lb.push(new ho.a(this.tKd(this.edb[kc][0]),-5));kc=new Og.a;for(var Kc=0;Kc<db.length;Kc++)kc.add(this.tKd(db[Kc][0]));for(Kc=0;Kc<Lb.length;Kc++){const md=Lb[Kc];for(let Hd=0;Hd<db.length;Hd++){var Qc=db[Hd];const Ne=this.tKd(Qc[0]);Qc=Qc[1];if(Ne===md.commandId){md.score=Qc;kc.remove(Ne);break}}if(!kc.count)break}return Lb}gSl(db){const Lb=1>db.length;for(let Hd=0;2>=Hd;Hd++){const Ne=this.JYb;
for(let Cc in Ne){var kc=Ne[Cc],Kc=db,Qc=Cc;const oe=Qc.length+1,gc=Array((Kc.length+1)*oe);for(var md=0;md<=Kc.length;md++)gc[md*oe]=md;for(md=0;md<=Qc.length;md++)gc[md]=md;for(md=0;md<Qc.length;md++)for(let eh=0;eh<Kc.length;eh++)gc[(eh+1)*oe+(md+1)]=Kc.charAt(eh)===Qc.charAt(md)?gc[eh*oe+md]:Math.min(Math.min(gc[eh*oe+(md+1)]+1,gc[(eh+1)*oe+md]+1),gc[eh*oe+md]+1);Kc=gc[Kc.length*oe+Qc.length];if((!Kc||!Lb)&&Kc<=Hd)return kc}}return this.B1b}DZh(db){this.Mrd=db.Csf();this.edb=db.nam();this.B1b=
db.wjm();this.JYb=db.g2l();if(this.Ax=!!this.Mrd&&!!this.edb&&!!this.JYb&&!!this.B1b)this.Ax=0<this.edb.length&&Rm.wDf(this.edb);this.Ax&&(this.Ax=0<this.B1b.length&&Rm.wDf(this.B1b));this.Ax&&(this.JYb=Rm.mkm(this.JYb));this.Ax||(this.JYb=this.B1b=this.edb=this.Mrd=null)}Cim(db){db=this.getSuggestions(db);return this.XCl(db,this.g0j)}XCl(db,Lb){let kc=[];for(let Kc=0;Kc<db.length;Kc++)db[Kc].score>=Lb&&kc.push(db[Kc]);kc.sort((Kc,Qc)=>Kc.score<Qc.score?1:Kc.score>Qc.score?-1:0);0<kc.length-10&&(kc=
kc.slice(0,10));return kc}static Bcn(db,Lb){if(!db.length)return Lb;if(db.length!==Lb.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let kc=0;kc<db.length;kc++){if(db[kc].commandId!==Lb[kc].commandId)throw Error.create("Incorrect CommandId");let Kc;(Kc=db[kc]).score=Kc.score+Lb[kc].score}return db}static Yhn(db){return Fl.a.eh(db)}static wDf(db){for(let Lb=0;Lb<db.length;Lb++)if(2!==db[Lb].length)return!1;return!0}static mkm(db){const Lb=
{};for(let Qc in db){var kc=Qc,Kc=db[Qc];const md=Kc;md.length&&Rm.wDf(md)&&(Lb[kc]=Kc)}return Lb}}Object(l.a)(Rm,"NaiveBayesClassifierModel",null,[]);class Xh{constructor(db,Lb){this.qsa=null;this.fc=db;this.zzc=new Rm(Lb,db.I5l);this.fc.jBb&&(this.qsa=null)}oL(){return"NBCommand"}BU(){return 0===this.fc.hv?0:1===this.fc.hv?1:2}dI(db,Lb,kc=!1,Kc=e.a.tellMe,Qc=null){const md=new m.a(db);if((!Qc||Array.contains(Qc,0))&&!z.a.FR(db)){if(Xe.CommandResultsUtility.RDf(db.Gg)&&(Qc=Xe.CommandResultsUtility.r7h(db.Gg),
0<Qc.results.length)){Qc.displayName="Classifier Debug";md.dv(Qc);Lb.resultsUpdated(md);return}if(!this.zzc.tGf()){if(t.TellMeActor.instance.Oe)t.TellMeActor.instance.Oe.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.fc.jBb&&this.qsa&&this.qsa.initialize();Qc=this.zzc.Cim(db.Gg);Xe.CommandResultsUtility.h3d(Qc,!1,"Classifier","NaiveBayesian");Qc=Xe.CommandResultsUtility.PRc(db,Qc,this.fc,this.qsa,
null,null,0,1);0<Qc.results.length&&Kc!==e.a.contextMenu&&(Qc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);kc||Qc.results.length||this.fc.E0||this.fc.r8a||(db=new x.a("lookupNoResults",14,db.Gg,null,1),Qc.Uw(db));0<Qc.results.length&&md.dv(Qc)}Lb.resultsUpdated(md)}}Object(l.a)(Xh,"NaiveBayesCommandProvider",null,[1112]);class rf{constructor(){this.hxb=null;this.Ax=!1;this.qne()}qne(){this.Ax||(this.hxb=window.NBCRM)&&4===this.hxb.length&&(this.Ax=!0);return this.Ax}nam(){return this.Ax?
this.hxb[1]:null}wjm(){return this.Ax?this.hxb[2]:null}g2l(){return this.Ax?this.hxb[3][0]:null}Csf(){return this.Ax?this.hxb[0][0]:null}}Object(l.a)(rf,"NaiveBayesModelAdapter",null,[1139]);var Ak=c(170);class ye{constructor(db){this.fc=db}oL(){return"OfficeScript"}BU(){return 0===this.fc.hv?0:1===this.fc.hv?1:2}dI(db,Lb){const kc=new m.a(db);if(!z.a.FR(db)){db=Ak.d(db.Gg);var Kc=new y.a(28);Kc.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;Kc=this.Oph(db,ye.YRo,"OfficeScriptsUnhideAllRowsCols",
"samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,Kc);Kc=this.Oph(db,ye.$Jl,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,Kc);kc.dv(Kc)}Lb.resultsUpdated(kc)}Oph(db,Lb,kc,Kc,Qc,md){const Hd=[];for(const Ne of Lb)if(Ak.a(db,Ne)){this.fc.bxa?(t.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(kc,Qc)),t.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(kc,Kc))):(Hd.push(appChrome.actions.setControlLabel(kc,
Qc)),Hd.push(appChrome.actions.setButtonCommandValueId(kc,Kc)),appChrome.api.dispatch(Hd));md.Uw(new x.a(kc,28,null,null,1));break}return md}}ye.YRo="unhide row rows col cols column columns".split(" ");ye.$Jl=["freeze","selection","pane","panes"];Object(l.a)(ye,"OfficeScriptsSamplesProvider",null,[1112]);var rk=c(75),Hn=c(348),fj=c(1587),Qh=c(1551),gh=c(1586),sk=c(34),Xi=c(139),Zk=c(25);class ne{constructor(db){this.BQ=null;this.M2=-1;this.pPf=14;this.rPf=12;this.attributes=this.fXe=this.query=null;
this.Ddc=!1;this.B_b=[];this.$f=ki.AFrameworkApplication.He;ki.AFrameworkApplication.K&&(this.pPf=ki.AFrameworkApplication.K.mc("TellMeMaxTermedResults",this.pPf),this.rPf=ki.AFrameworkApplication.K.mc("TellMeMaxZeroTermResults",this.rPf));this.UR=db}get vo(){return this.B_b}get Une(){return this.fXe}dv(db){let Lb=!1;for(let kc=0;kc<this.vo.length;kc++)if(30!==this.vo[kc].groupType&&this.vo[kc].groupType===db.groupType){this.v_e(this.vo[kc],db);Lb=!0;break}Lb||this.vo.push(db)}v_e(db,Lb){for(let kc=
0;kc<Lb.results.length;kc++)db.Uw(Lb.results[kc])}Yaj(db){const Lb=[];for(const kc of this.vo)kc.groupType!==db&&Lb.push(kc);this.vo.length!==Lb.length&&(this.B_b=Lb)}V_n(db){let Lb=null,kc=null,Kc=null;for(let Qc=0;Qc<db.length;Qc++){const md=db[Qc];if(md&&md.vo&&md.vo.length)for(const Hd of md.vo)if(17===Hd.groupType||18===Hd.groupType)Lb=Hd;else if(0===Hd.groupType||16===Hd.groupType)kc=Hd,Kc=md}Lb&&kc&&0<kc.results.length&&(17===Lb.groupType&&({SZe:kc,J_e:Lb}=Xe.CommandResultsUtility.ctk(kc,Lb,
this.UR.cP()?this.UR.cP().BRl:-.6)),Kc.Yaj(kc.groupType))}wAo(){this.UR&&(new rk.a,this.Aad(this.UR.TMi))}sYc(db,Lb){return this.query.Gg.length>this.UR.cP().Yam&&this.ISm(db,Lb)||this.query.Gg.length>this.UR.cP().Zam&&this.wVm(db,Lb)?!0:!1}wVm(db,Lb){return db&&db.length&&Lb&&Lb.length?-1===Lb.toLowerCase().indexOf(db.toLowerCase())?!1:!0:!1}ISm(db,Lb){return db&&db.length&&Lb&&Lb.length?Lb.toLowerCase().startsWith(db.toLowerCase()):!1}iDl(db){const Lb=[];for(const kc of this.UR.cP().XP?this.Une:
this.vo)db.contains(kc.groupType)||Lb.push(kc);this.UR.cP().XP?this.fXe=Lb:this.B_b=Lb}qZo(db,Lb){const kc=[];for(const Kc of this.vo){const Qc=Kc;if(13!==Qc.groupType||24!==Qc.groupType){const md=db[Qh.a[Qc.groupType].toLowerCase()];let Hd="False";md<Lb&&(Hd="True");Qc.displayName=Qc.displayName+" ("+Hd+": "+md+")"}kc.push(Qc)}this.B_b=kc}Aad(db,Lb=!1,kc=null){if(this.UR.cP().XP){if(!Lb)for(this.fXe=Array(this.vo.length),Lb=0;Lb<this.vo.length;Lb++)this.Une[Lb]=this.vo[Lb];this.UR.ZMi.Aad(this.vo,
this.Une,this.query,db,kc)}else{for(kc=new rk.a;this.vo.length;){Lb=this.vo.pop();const Kc=Qh.a[Lb.groupType].toLowerCase(),Qc=db[Kc];if(Zk.c(Qc))throw Error.create("GroupId "+Kc+" missed from group SortingOrder");kc.add(new Hn.a(Qc,Lb))}kc.Sc((Kc,Qc)=>Kc.key<Qc.key?-1:1);for(db=0;db<kc.count;db++)Lb=kc.J(db).value,this.vo.push(Lb)}}xAo(){var db=!1;let Lb=!1,kc=!1;for(let Qc=0;Qc<this.vo.length;Qc++){var Kc=this.vo[Qc];const md=Kc.groupType;if(8===md||15===md||14===md){Kc=Kc.results;for(let Hd=0;Hd<
Kc.length;Hd++){if(8===md&&this.sYc(this.query.Gg,Kc[Hd].label)){db=!0;break}if(15===md&&this.sYc(this.query.Gg,Kc[Hd].label)){Lb=!0;break}if(14===md){if(this.sYc(this.query.Gg,Kc[Hd].label)||this.sYc(this.query.Gg,Kc[Hd].description)){kc=!0;break}const Ne=Kc[Hd].label.split(" ");for(const Cc of Ne)if(this.sYc(this.query.Gg,Cc)){kc=!0;break}}}}}db=this.UR.Pcm(db,Lb,kc);this.Aad(db)}UMb(db,Lb,kc,Kc,Qc,md){if(Qc===this.BQ){var Hd=db.data.se;Qc=null;try{Qc=sk.b(Hd)}catch(wg){t.TellMeActor.instance.Oe.onError("OnSuccessCallBack",
"Exception occured while deserializing ranker inference response:"+wg);return}if("RankerResults"in Qc&&Qc.RankerResults){this.MDa();var Ne=Qc.RankerResults,Cc=new rk.a,oe=new rk.a;Hd=0;for(var gc of Ne){Ne=gc.ProviderId;var eh=gc.Score;Hd+=eh;Cc.add(new Hn.a(Ne,eh))}Cc.Sc(($f,di)=>$f.value>di.value?-1:1);eh=md?md.lhi:1E-6;gc={};Ne={};let wg=0;for(var nj=0;nj<Cc.count;nj++){let $f=parseInt(Cc.J(nj).key),di=Cc.J(nj).value/Hd;1===$f&&(Ne.answer=wg++,Ne.entity=wg++,Ne.definition=wg++,Ne.wolframanswer=
wg++,di<eh&&(oe.add(9),oe.add(11),oe.add(10),oe.add(12)),gc.answer=di,gc.entity=di,gc.definition=di,gc.wolframanswer=di);2===$f&&(Ne.assistance=wg++,di<eh&&oe.add(8),gc.assistance=di);3===$f&&(Ne.classifier=wg++,Ne.serviceclassifier=wg++,di<eh&&(oe.add(0),oe.add(17)),gc.classifier=di,gc.serviceclassifier=di);4===$f&&(Ne.people=wg++,di<eh&&oe.add(14),gc.people=di);5===$f&&(Ne.document=wg++,di<eh&&oe.add(15),gc.document=di);6===$f&&(Ne.findindocument=wg++,di<eh&&oe.add(2),gc.findindocument=di);7===
$f&&(Ne.notes=wg++,di<eh&&oe.add(20),gc.notes=di);8===$f&&(Ne.image=wg++,di<eh&&oe.add(19),gc.image=di)}Cc=new rk.a;Cc.add("classifier");Cc.add("serviceclassifier");Cc.add("appsforoffice");Cc.add("addin");Cc.add("findindocument");Cc.add("assistance");Cc.add("document");Cc.add("people");Cc.add("answer");Cc.add("wolframanswer");Cc.add("definition");Cc.add("entity");Cc.add("image");Cc.add("template");Cc.add("officescript");for(nj=0;nj<Cc.count;nj++)Cc.J(nj)in Ne||(Ne[Cc.J(nj)]=wg++);Ne.learning=wg++;
Ne.insights=wg++;Ne.actionai=wg++;Ne.actionaicommand=wg++;Ne.feedback=wg++;md&&md.pAi&&this.qZo(gc,eh);md&&md.qAi&&this.iDl(oe);oe={};for(var vi in gc)oe[vi]=gc[vi]*Hd;this.Aad(Ne,!0,oe)}if(md.R0d&&"Intents"in Qc&&Qc.Intents){vi=Qc.Intents;for(var ge of vi)if(this.VIf(ge)&&"Serplet"===ge.GroupType&&ge.ConfidenceScore>ge.ConfidenceThreshold){vi=!1;Qc=0;if(md.S0d){Hd=new x.a("",32);for(oe=0;oe<this.vo.length;oe++)if((Cc=this.vo[oe].results)&&0<Cc.length){Qc=oe;Hd=Cc[0];break}2===Hd.groupType&&(vi=!0)}Hd=
new y.a(13);vi&&md.S0d&&(Hd=new y.a(13,CommonUIStrings.l_TellMeWebTitle));oe=new x.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Gg,null,0);Cc=[];gc=null;gc=z.a.Lpa()?z.a.VOa(this.query.Gg,1):z.a.sDb(this.query.Gg);Cc.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",gc));gc=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,this.query.Gg);Cc.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",gc));appChrome.api.dispatch(Cc);
Hd.Uw(oe);oe=[];if(vi&&md.S0d)for(oe.push(this.vo[Qc]),oe.push(Hd),vi=Qc+1;vi<this.vo.length;vi++)(Qc=this.vo[vi].results)&&0<Qc.length&&oe.push(this.vo[vi]);else for(oe.push(Hd),vi=0;vi<this.vo.length;vi++)(Qc=this.vo[vi].results)&&0<Qc.length&&oe.push(this.vo[vi]);this.B_b=oe}}if(md.EYc&&!md.XP){ge=vi=-1;for(Qc=0;Qc<this.vo.length;Qc++)switch(this.vo[Qc].groupType){case 23:vi=Qc;break;case 0:case 17:case 2:-1===ge&&(ge=Qc)}if(-1!==vi){ge=-1===ge?0:vi>ge?ge+1:ge;vi=this.vo[vi];Qc=Array(this.vo.length);
Hd=0;for(oe=0;oe<Qc.length;oe++)oe===ge?Qc[oe]=vi:(23===this.vo[Hd].groupType&&Hd++,Qc[oe]=this.vo[Hd],Hd++);this.B_b=Qc}}Kc.resultsUpdated(this);Kc=t.TellMeActor.instance.Oe;Kc.W9(Lb.length,"RankerInference",db.data.Se.toString(),Math.round(window.performance.now()-kc),gh.a.Pyj,!0,fj.a.LQa);this.Ddc&&Kc&&(db=this.query.Oob,Lb=Kc.xjd,md.i1d&&db>Lb&&!md.XP&&(Kc.CNf(this.query.Gg),Kc.kdg(db)))}}VIf(db){if("GroupType"in db&&db.GroupType&&"ConfidenceScore"in db&&"ConfidenceThreshold"in db)return!0;t.TellMeActor.instance.Oe.onError("IsValidIntentGroup",
"Invalid intents found");return!1}CMb(db,Lb,kc,Kc,Qc){Kc===this.BQ&&(this.MDa(),t.TellMeActor.instance.Oe.W9(Lb.length,"RankerInference",db.data.Se.toString(),Math.round(window.performance.now()-kc),gh.a.Pyj,!1,fj.a.LQa));Qc.resultsUpdated(this)}MDa(){-1!==this.M2&&(window.clearTimeout(this.M2),this.M2=-1)}yAo(db){let Lb;Lb=this.UR.cP().XP?t.TellMeActor.instance.Oe.evf(this.Une,this.query.Gg):t.TellMeActor.instance.Oe.evf(this.vo,this.query.Gg);var kc=this.UR.cP().khi;""!==kc&&(kc="_"+kc);let Kc=
"";this.UR.cP().W_d&&(Kc="RankerInference"+kc+",");this.UR.cP().R0d&&(Kc+="SerpletClassifier");","===Kc.charAt(Kc.length-1)&&(Kc=Kc.substring(0,Kc.length-1));kc=t.TellMeActor.instance.Oe.Yii(Kc);const Qc=this.BQ=Xi.a.create().toString();kc["Client-Request-Id"]=Qc;const md=window.performance.now(),Hd=this.UR.cP()?this.UR.cP().mhi:600;this.MDa();this.M2=window.setTimeout(()=>{if(Qc===this.BQ){this.BQ="";this.M2=-1;db.resultsUpdated(this);const Ne={};Ne[a.a.provider]="Ranker";Ne[a.a.oOb]=this.query.Oob;
t.TellMeActor.instance.Oe.QA(k.a.timedOut,Hd,Ne)}},Hd);this.$f.mj(t.TellMeActor.instance.Oe.Zii(),2,Lb,kc,!1,0,Ne=>{this.UMb(Ne,this.query.Gg,md,db,Qc,this.UR.cP())},Ne=>{this.CMb(Ne,this.query.Gg,md,Qc,db)},null,null,!1,4E3,6E3)}wOo(){var db=0,Lb=new rk.a,kc=this.UR.QMi,Kc=this.UR.RMi;for(var Qc=0;Qc<this.vo.length;Qc++){var md=this.vo[Qc],Hd=Qh.a[md.groupType].toLowerCase(),Ne=kc[Hd];db+=md.results.length;md.results.length>Ne&&(Hd=Kc[Hd],Zk.c(Hd)||Lb.add(new Hn.a(Hd,md)))}Kc=!this.query||""===this.query.Gg.trim();
Qc=db-(Kc?this.rPf:this.pPf);if(!(0>=Qc)){Kc=window.performance.now();db=db.toString()+" total,"+Qc.toString()+" to remove.";if(0<Lb.count)for(Lb.Sc((Cc,oe)=>Cc.key>oe.key?-1:1),md=0;md<Lb.count&&0<Qc;md++){Hd=Lb.J(md).value;Ne=Qh.a[Hd.groupType].toLowerCase();let Cc=Hd.results.length-kc[Ne];Cc>Qc&&(Cc=Qc);0<Cc&&(Hd.r8f(Cc),db+=Ne+": "+Cc.toString()+" results removed.",Qc-=Cc)}if(0<Qc){db+=Qc.toString()+" results left after trimming.";Lb=new rk.a;kc=this.UR.WMi;for(md=0;md<this.vo.length;md++)Hd=
this.vo[md],Ne=kc[Qh.a[Hd.groupType].toLowerCase()],Zk.c(Ne)||Lb.add(new Hn.a(Ne,Hd));Lb.Sc((Cc,oe)=>Cc.key<oe.key?-1:1);for(kc=0;0<Qc;)md=Lb.J(kc++).value,Qc>=md.results.length?(Array.remove(this.vo,md),db+=Qh.a[md.groupType]+": "+md.results.length.toString()+" results force removed.",Qc-=md.results.length):(md.r8f(Qc),db+=Qh.a[md.groupType]+": "+Qc.toString()+" results force removed.",Qc=0)}t.TellMeActor.instance.Oe&&(Lb={},Lb[a.a.message]=db,t.TellMeActor.instance.Oe.QA("ShowOptimal",window.performance.now()-
Kc,Lb))}}}Object(l.a)(ne,"CombineResultsUpdatedEventArgs",null,[1082]);class $k{constructor(db,Lb,kc,Kc=!1,Qc=""){this.kOe=this.QQe=!1;this.wv=db;this.Ryb=[];this.qch=Lb.length;this.fc=t.TellMeActor.instance.cP();this.Spd=Kc;this.hga=Qc;this.S0b={};for(db=0;db<Lb.length;++db)this.S0b[db.toString()]=kc?0:Lb[db].BU()}Xmo(db,Lb){Lb&&Lb.query&&Lb.query.Oob<t.TellMeActor.instance.Tta||(this.Ryb[db]=Lb,this.kOe?this.QQe=!0:(!this.fc||3!==this.fc.hv||3!==this.S0b[db.toString()]||this.VSh())&&this.GYd())}eCn(){this.kOe=
!0}pSo(){this.kOe=!1;this.QQe&&(this.QQe=!1,this.GYd())}VSh(){if(this.Ryb.length<this.qch)return!1;for(let db=0;db<this.qch;++db)if(!this.Ryb[db])return!1;return!0}GYd(){var db=this.VSh();const Lb=window.performance.now(),kc=new ne(t.TellMeActor.instance.TXg);kc.V_n(this.Ryb);for(var Kc=0;Kc<this.Ryb.length;++Kc){var Qc=this.Ryb[Kc];if(Qc&&Qc.vo&&Qc.vo.length&&(kc.query=Qc.query,Qc.attributes&&0<Qc.attributes.length&&(kc.attributes=Qc.attributes),Qc&&Qc.vo&&(db||this.eXk(Kc,this.Ryb))))for(const md of Qc.vo)kc.dv(md)}kc.vo&&
kc.vo.length&&(kc.Ddc=db,this.fc&&this.fc.ane&&kc.wOo(),this.fc&&this.fc.WTm&&kc.query.Gg&&0<kc.query.Gg.length?kc.xAo():kc.wAo(),this.fc&&(this.fc.W_d||this.fc.R0d)&&this.Spd&&kc.query.Gg&&0<kc.query.Gg.length&&kc.Ddc&&this.hga!==e.a.contextMenu?(3===this.fc.hv&&db||this.wv.resultsUpdated(kc),kc.yAo(this.wv)):this.wv.resultsUpdated(kc),db=t.TellMeActor.instance.Oe,kc.Ddc&&db&&(Kc=kc.query.Oob,Qc=db.xjd,kc.query.Gg&&0<kc.query.Gg.length&&this.Spd&&this.fc.i1d&&this.hga!==e.a.contextMenu&&Kc>Qc&&!this.fc.W_d&&
!this.fc.XP&&(db.CNf(kc.query.Gg),db.kdg(Kc)),db.QA(k.a.k8n,window.performance.now()-Lb)))}eXk(db,Lb){if(!(this.S0b&&db.toString()in this.S0b)||Lb.length<=db||!Lb[db])return!1;if(!Lb[db].vo.length)return!0;const kc=this.S0b[db.toString()];if(0===kc)return!0;const Kc=this.S0b;for(let md in Kc){var Qc=Kc[md];const Hd=Number.parseInvariant(md);if(Hd!==db&&Qc===kc&&!(Lb.length>Hd&&Lb[Hd]))return!1}return!0}}Object(l.a)($k,"ResultsAggregator",null,[]);var wf=c(1795);class wj{constructor(){this.Inc=this.Jnc=
this.Hnc=this.logCount=this.logRank=this.invertedRank=0}Lsk(db,Lb){switch(db){case 1:this.invertedRank=Lb;break;case 3:this.logRank=Lb;break;case 2:this.logCount=Lb;break;case 5:this.Hnc=Lb;break;case 4:this.Jnc=Lb;break;case 6:this.Inc=Lb}}}Object(l.a)(wj,"CommandFeatures",null,[]);class Pe{constructor(db){this.kVg=0;this.VBa=db;this.tZj={}}get modelId(){return this.VBa}get featureIntercept(){return this.kVg}get cJc(){return this.tZj}Irk(db,Lb,kc){0===Lb?this.kVg=kc:(this.cJc[db]||(this.cJc[db]=
new wj),this.cJc[db].Lsk(Lb,kc))}}Object(l.a)(Pe,"CoefficientsModel",null,[]);const Kg=(db,Lb)=>Math.pow(10,-Lb/(60*Math.LN10/Math.LN2*db));class em{constructor(db,Lb){this.ak=1;this.uld=new wj;this.features.logCount=1+Math.log(this.count)/Math.LN2;this.features.invertedRank=db?1/db:0;this.features.logRank=2/Math.pow(2,db);this.features.Hnc=Kg(10,Lb);this.features.Jnc=Kg(2,Lb);this.features.Inc=Kg(1,Lb)}get count(){return this.ak}get features(){return this.uld}bri(){this.ak=this.count+1;this.features.logCount=
1+Math.log(this.count)/Math.LN2}eZo(db){const Lb=2/Math.pow(2,db);this.features.invertedRank=Math.max(this.features.invertedRank,db?1/db:0);this.features.logRank=Math.max(this.features.logRank,Lb)}D_o(db){const Lb=Kg(10,db),kc=Kg(2,db);db=Kg(1,db);this.features.Hnc=Math.max(this.features.Hnc,Lb);this.features.Jnc=Math.max(this.features.Jnc,kc);this.features.Inc=Math.max(this.features.Inc,db)}}Object(l.a)(em,"CommandModel",null,[]);class jl{constructor(db){this.usc=null;if(!db&&t.TellMeActor.instance.Oe)t.TellMeActor.instance.Oe.onError("PredictionEngine",
"IModelAdapter can't be null");this.rZb=db;this.Lrd=this.BMf()}BMf(){const db=this.rZb.d5l(),Lb=this.rZb.Csf();if(void 0===db||null===db||void 0===Lb||null===Lb)return!1;try{window.performance.now();this.usc={};for(let kc=0;kc<db.length;kc++){const Kc=db[kc],Qc=Lb[Kc[0].toString()].trim(),md=Kc[1],Hd=0!==md?Lb[Kc[2].toString()].trim():"",Ne=Kc[3];Qc in this.usc||(this.usc[Qc]=new Pe(Qc));this.usc[Qc].Irk(Hd,md,Ne)}}catch(kc){if(t.TellMeActor.instance.Oe)t.TellMeActor.instance.Oe.onError("LoadModelData",
"Error Loading Suggestions Model: "+kc);return!1}return!0}XKl(){const db=this.rZb.w1l(),Lb={};if(!db)return Lb;let kc=1;for(let Kc=0;Kc<db.length;Kc++){const Qc=db[Kc];Qc.Id in Lb?(Lb[Qc.Id].bri(),Lb[Qc.Id].eZo(kc),Lb[Qc.Id].D_o(Qc.TimeElapsedSinceClick)):Lb[Qc.Id]=new em(kc,Qc.TimeElapsedSinceClick);kc++}return Lb}tGf(){this.Lrd||(this.Lrd=this.BMf());return this.Lrd}C$l(){let db=[];if(!this.Lrd){if(t.TellMeActor.instance.Oe)t.TellMeActor.instance.Oe.onError("GetPredictedCommands","IModelAdapter returned no data");
return db}const Lb=this.XKl(),kc=this.usc;for(let Qc in kc){const md=kc[Qc],Hd=md.modelId;let Ne=0;for(let Cc in Lb){var Kc=Cc;const oe=Lb[Cc].features;(Kc=Kc in md.cJc?md.cJc[Kc]:null)&&(Ne+=oe.invertedRank*Kc.invertedRank+oe.logRank*Kc.logRank+oe.logCount*Kc.logCount+oe.Hnc*Kc.Hnc+oe.Jnc*Kc.Jnc+oe.Inc*Kc.Inc)}Ne+=md.featureIntercept;db.push(new ho.a(Hd,Ne))}db.sort((Qc,md)=>Qc.score<md.score?1:Qc.score>md.score?-1:0);0<db.length-10&&(db=db.slice(0,10));return db}}Object(l.a)(jl,"PredictionEngine",
null,[]);class io{constructor(){this.ufh={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),
"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),
"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),
"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}RQd(db,
Lb){return Lb&&"word"===Lb.application.toLowerCase()&&db in this.ufh?this.ufh[db]:[]}}Object(l.a)(io,"SuggestionResultsUtility",null,[]);class Mf{constructor(db,Lb,kc){this.fc=Lb;this.zzc=new jl(db);this.q3=kc;this.kih=new io}oL(){return"Suggestion"}BU(){return 0===this.fc.hv?0:1===this.fc.hv?1:2}dI(db,Lb,kc,Kc=e.a.tellMe,Qc=null){kc=new m.a(db);t.TellMeActor.instance.ged=!1;if((!Qc||Array.contains(Qc,16))&&z.a.FR(db)){if(!this.zzc.tGf()){if(t.TellMeActor.instance.Oe)t.TellMeActor.instance.Oe.onError("CRASH",
"SuggestionResultsProvider: Found invalid Model data");throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}Date.now();if(this.L0d()&&0<this.kih.RQd(t.TellMeActor.instance.eKd,this.fc).length){const Hd=this.kih.RQd(t.TellMeActor.instance.eKd,this.fc);Qc=[];for(var md of Hd)this.fc.Die&&"Find"===md||Qc.push(new ho.a(md,0));t.TellMeActor.instance.ged=!0}else Qc=this.zzc.C$l();Xe.CommandResultsUtility.h3d(Qc,!0,"Recommended","LRE");md=[];for(const Hd of Qc)this.q3&&this.q3.q$e(Hd.commandId)||
md.push(Hd);db=Xe.CommandResultsUtility.PRc(db,md,this.fc,null,null,null,16,1);0<db.results.length&&Kc!==e.a.contextMenu&&(db.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<db.results.length&&kc.dv(db)}Lb.resultsUpdated(kc)}L0d(){return!!this.fc&&(this.fc.L0d||this.fc.mYm)}}Object(l.a)(Mf,"SuggestionResultsProvider",null,[1112]);class nk{w1l(){return t.TellMeActor.instance.Dwe}d5l(){return window.TellMeSuggestionModel}Csf(){return window.CoefficientModelIdMap}}Object(l.a)(nk,"SuggestionsModelAdapter",
null,[1138]);var mj=c(1806),Rf=c(1758);c.d(I,"AggregatorResultsProvider",function(){return sg});class sg{constructor(db=!1){this.q_b={};this.q_b[e.a.tellMe]=[];this.q_b[e.a.contextMenu]=[];this.Spd=db}eFi(db,Lb,kc,Kc,Qc=null){let md;var Hd=!1;switch(Kc){case e.a.contextMenu:md=this.q_b[e.a.contextMenu];Hd=!0;break;default:md=this.q_b[e.a.tellMe]}Lb=new $k(Lb,md,Hd,this.Spd,Kc);Lb.eCn();for(let Ne=0;Ne<md.length;++Ne){const Cc=window.performance.now(),oe=new G(Lb,Ne);(Hd=t.TellMeActor.instance.cP())&&
Hd.vMk?window.setTimeout(()=>{md[Ne].dI(db,oe,kc,Kc,Qc);if(t.TellMeActor.instance.Oe){const gc={};gc[a.a.provider]=md[Ne].oL();gc[a.a.oOb]=db.Oob;t.TellMeActor.instance.Oe.QA(k.a.dI,window.performance.now()-Cc,gc)}},0):(md[Ne].dI(db,oe,kc,Kc,Qc),t.TellMeActor.instance.Oe&&(Hd={},Hd[a.a.provider]=md[Ne].oL(),Hd[a.a.oOb]=db.Oob,t.TellMeActor.instance.Oe.QA(k.a.dI,window.performance.now()-Cc,Hd)))}Lb.pSo()}oL(){return"Aggregator"}BU(){return 0}dI(db,Lb,kc=!1,Kc=e.a.tellMe,Qc=null){if(t.TellMeActor.instance.uen)this.eFi(db,
Lb,kc,Kc,Qc);else{const md=window.performance.now();t.TellMeActor.instance.c4o.then(()=>{t.TellMeActor.instance.Oe&&t.TellMeActor.instance.Oe.QA(k.a.ven,window.performance.now()-md);this.eFi(db,Lb,kc,Kc,Qc);return!0})}}WE(db,Lb){this.q_b[Lb].push(db)}Atk(db){switch(db){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Lb=this.q_b[e.a.tellMe];for(const kc of Lb)if("FindInDocument"===kc.oL()){kc.clo(db);break}}}static createInstance(db,Lb,kc,Kc){const Qc=
Lb.kha;var md=Kc&&z.a.$fg(Lb),Hd=md&&Lb.xZf&&!Qc;const Ne=Lb.DIf&&!z.a.Ydc()&&!Qc,Cc=Lb.HGf&&!Qc,oe=new sg(md);if(Lb.vuo&&!Qc){var gc=new Bf(Lb);oe.WE(gc,e.a.tellMe)}gc=Lb.Ir?ki.AFrameworkApplication.K.$("TellMeIsSuggestionsForSimplifiedUxEnabled"):ki.AFrameworkApplication.K.$("TellMeSuggestionsIsEnabled");const eh=!gc&&ki.AFrameworkApplication.K.$("TellMeFirstRunExperienceIsEnabled");oe.WE(new Fj.a(db,Lb.sQo,eh,!1),e.a.tellMe);gc&&!Qc&&oe.WE(new Mf(new nk,Lb,db),e.a.tellMe);db=ki.AFrameworkApplication.ua.Kb.ODi?
new Xh(Lb,new rf):new qm(Lb,kc);oe.WE(db,e.a.contextMenu);(md&&Lb.yZf||Hd)&&oe.WE(mj.a.oOh(Lb,!0),e.a.tellMe);oe.WE(db,e.a.tellMe);!Lb.m0h||Qc||"Word"===Lb.application&&Lb.BOd||oe.WE(new Hf(Lb),e.a.tellMe);Lb.jBb&&!Qc&&(Hd=new M(Lb),oe.WE(Hd,e.a.tellMe),oe.WE(Hd,e.a.contextMenu));!Lb.oBb||Lb.A$c||Lb.z$c||Qc||oe.WE(new K.a(Lb),e.a.tellMe);Kc&&(Lb.E0||z.a.Lpa())&&(Hd=new Zl(Lb),oe.WE(Hd,e.a.tellMe),oe.WE(Hd,e.a.contextMenu));md&&oe.WE(mj.a.oOh(Lb,!1),e.a.tellMe);Kc&&!Lb.gkg&&z.a.Zfg(Lb)&&!Qc&&(oe.WE(new wf.a(Lb),
e.a.tellMe),Lb.dxj&&oe.WE(new wf.a(Lb),e.a.contextMenu));Ne&&oe.WE(new rm(Lb),e.a.tellMe);!Lb.Mlc&&!Lb.XP||Qc||oe.WE(new Ed.a(Lb),e.a.tellMe);Lb.EYc&&!Qc&&oe.WE(new Rf.a(Lb),e.a.tellMe);Lb.pDf&&(md=new H(Lb),oe.WE(md,e.a.tellMe),oe.WE(md,e.a.contextMenu));Kc&&Lb.VYd&&!Qc&&oe.WE(new F.AddinResultsProvider(Lb),e.a.tellMe);Cc&&"Excel"===Lb.application&&!Qc&&oe.WE(new ye(Lb),e.a.tellMe);return oe}}Object(l.a)(sg,"AggregatorResultsProvider",null,[1112])},1789:function(D,I,c){D=c(0);var l=c(16),e=c(6),
a=c(183),k=c(225),x=c(367);c(60);var y=c(69);c(953);c(876);var m=c(541);c(468);var t=c(1748),z=c(1749),v=c(1745),H=c(1747),F=c(1746);c(952);c(875);class G{constructor(Z,ea,ha){this.qKl=Z;this.PJk=ea;this.dVk=ha}}Object(D.a)(G,"BacktraceAndMakeUpdateHintsInput",null,[]);var M=c(1569),K;(function(Z){Z[Z.EOP=0]="EOP";Z[Z.character=1]="character";Z[Z.embeddedMarker=2]="embeddedMarker"})(K||(K={}));Object(D.b)("LCSBlockType",K);class L{toString(){return String.format("[Type: {0}]",K[this.type])}}Object(D.a)(L,
"ALCSBlock",null,[]);class R extends L{constructor(Z,ea){super();this.Nve=ea;this.VNe=Z}get type(){return 1}get character(){return this.Nve}get fTa(){return this.VNe}JA(Z){return 1===Z.type&&M.a.Avh(Z.character,this.character)}toString(){return String.format("{0} [Char: {1}]",super.toString(),this.character)}}Object(D.a)(R,"CharacterLCSBlock",L,[]);class S extends L{constructor(Z,ea,ha){super();this.VNe=Z;this.zYe=ea;this.Cyc=ha}get type(){return 0}get Wc(){return this.zYe}get length(){return this.Cyc}get fTa(){return this.VNe}JA(Z){return 0!==
Z.type?!1:Z.fTa===this.fTa&&Z.Wc===this.Wc}toString(){return String.format("{0} [ParaId: {1}] [WordId: {2}] [Length: {3}]",super.toString(),this.fTa.toString(),this.Wc,this.length)}}Object(D.a)(S,"EOPLCSBlock",L,[]);class N extends R{constructor(Z,ea,ha){super(Z,"\ufffc");this.Mak=ea;this.lmd=ha}get type(){return 2}get uf(){return this.Mak}get Yj(){return this.lmd}JA(Z){return 2!==Z.type?!1:Z.uf===this.uf&&this.Yj.equals(Z.Yj)}toString(){return String.format("{0} [Marker: {1}] [FId: {2}]",super.toString(),
this.uf,this.Yj)}}Object(D.a)(N,"EmbeddedMarkerLCSBlock",R,[]);class O{constructor(Z,ea){this.x=Z;this.y=ea}equals(Z){return Z.x===this.x&&Z.y===this.y}toString(){return"("+this.x+", "+this.y+")"}}Object(D.a)(O,"IntPair",null,[900]);var W=c(1611),V=c(1591),Q=c(1612),Y=c(1744);c.d(I,"a",function(){return ba});class ba{constructor(Z,ea){this.Qg=Z;this.$d=ea}zOh(Z,ea,ha,ka,ua,sa,Da){return this.Qfl(Z,ea,ha,ka,ua,sa,Da)}Qfl(Z,ea,ha,ka,ua,sa,Da){let Pa;Pa=null;({returnValue:Z}=this.CSd(Z,ea));if(!Z)return a.a.instance.Ua(575706449,
1,2,"Failed to get LCS blocks from objects for base"),this.$d.logger.$U("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:Pa};({returnValue:ha}=this.CSd(ha,ka));if(!ha)return a.a.instance.Ua(575706450,1,2,"Failed to get LCS blocks from objects for changed"),this.$d.logger.$U("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:Pa};this.$d.logger.$U("GetLCSBlocksFromObject");Pa=this.Pfl(Z,ha,ua,sa,Da);return Pa?{returnValue:!0,updateHints:Pa}:(a.a.instance.Ua(575706451,1,2,"Failed to Create UpdateHints"),
{returnValue:!1,updateHints:Pa})}b0h(Z,ea,ha,ka){({returnValue:Z}=this.CSd(Z,ea));if(!Z)return-1;({returnValue:ha}=this.CSd(ha,ka));if(!ha)return-1;({zdf:ha}=this.f0h(Z,ha));return ha}CSd(Z,ea){let ha;const ka=new k.a;ha=new k.a;if(!Z.length)return a.a.instance.Ua(594124833,1,2,"Abandoning LCS due to empty list of paragraphs"),this.$d.logger.Rg(Object.assign(new W.a,{yj:"GetLCSBlocksFromObject",eventId:"900a7"})),{returnValue:null,hjf:ha};for(let Da=0;Da<Z.length;Da++)if(this.$d.runtime.eH("GetLCSBlocksFromObject: paraObjs#"+
Da),393230===Z.J(Da).Qc){const Pa=this.Qg.getPropertyString(Z.J(Da),l.a.wo),Ra=this.Qg.getPropertyUint32(Z.J(Da),e.a.Wc);if(null==Ra)return a.a.instance.Ua(594124835,1,2,"Abandoning LCS due to missing WordId"),this.$d.logger.Rg(Object.assign(new W.a,{yj:"GetLCSBlocksFromObject",eventId:"900a9"})),{returnValue:null,hjf:ha};let Ga=this.Qg.getPropertyUint32s(Z.J(Da),l.a.Jm);Ga=V.a.vnj(Ga,Pa.length);const ta=this.Qg.getPropertyObjectIds(Z.J(Da),l.a.Sn);let va;for(va=0;va<Ga.length-1;va++){var ua=ea(ta.eg(va)),
sa=void 0;sa=ua?(sa=this.Qg.getPropertyBool(ua,l.a.Z$))?sa:!1:!1;if(sa)ka.add(this.hal(Z.J(Da).id,ua));else for(ua=Ga.eg(va);ua<Ga.eg(va+1);ua++)ka.add(new R(Z.J(Da).id,M.a.charAt(Pa,ua)))}ka.add(new S(Z.J(Da).id,Ra,Ga.J(va)));ha.add(ka.length-1)}else return a.a.instance.Ua(594124864,1,2,"Abandoning LCS due to presence of non-paragraph object of type {0}",Z.J(Da).Qc),this.$d.logger.Rg(Object.assign(new W.a,{yj:"GetLCSBlocksFromObject",eventId:"900ba"})),{returnValue:null,hjf:ha};this.$d.runtime.eH("LCS: GetLCSBlocks for base");
return{returnValue:ka,hjf:ha}}hal(Z,ea){const ha=null==this.Qg.getPropertyInt32(ea,e.a.Qs)?0:this.Qg.getPropertyInt32(ea,e.a.Qs);return new N(Z,ha,ea.id)}Pfl(Z,ea,ha,ka,ua){ka=({zdf:ha}=this.f0h(Z,ea,ha,ka,ua)).returnValue;this.$d.logger.$U("FindFurthestPaths");Z=new G(ka,Z,ea);Z=new Y.a(this.EJk(Z,ha),1);this.$d.logger.$U("BacktraceAndMakeUpdateHints");return Z}f0h(Z,ea,ha=-1,ka=-1,ua=-1){let sa;if(-1===ha||-1===ka||-1===ua)ua=ka=ha=-1;sa=-1;const Da=new x.a;Da.Z(new O(-1,1),new O(0,-1));if(-1!==
ha){Da.Z(new O(0,0),new O(ha,ha));var Pa=1}else Pa=0,ka=Z.length,ua=ea.length;for(ha=0;Pa<=Z.length+ea.length;Pa++){let Ra=!1;for(let Ga=-Pa;Ga<=Pa;Ga+=2){let ta,va;Ga===-Pa?(ta=Da.J(new O(Pa-1,Ga+1)).x,va=Da.J(new O(Pa-1,Ga+1)).y+1):Ga===Pa?(ta=Da.J(new O(Pa-1,Ga-1)).x+1,va=Da.J(new O(Pa-1,Ga-1)).y):Da.J(new O(Pa-1,Ga-1)).x>=Da.J(new O(Pa-1,Ga+1)).x?(ta=Da.J(new O(Pa-1,Ga-1)).x+1,va=Da.J(new O(Pa-1,Ga-1)).y):(ta=Da.J(new O(Pa-1,Ga+1)).x,va=Da.J(new O(Pa-1,Ga+1)).y+1);for(;ta<ka&&va<ua&&Z.J(ta).JA(ea.J(va));)ta++,
va++;Da.Z(new O(Pa,Ga),new O(ta,va));if(ta===ka&&va===ua){Ra=!0;sa=Pa;ha=Ga;break}}if(Ra)break;this.$d.runtime.eH("LCS FindFurthestPaths")}if(ha!==ka-ua)return{returnValue:null,zdf:sa};Da.Z(new O(sa,ha),new O(ka+1,ua+1));a.a.instance.Ua(593826837,1,4,"FindFurthestPaths finished. Length of base: {0} Length of changed: {1} Size of diff: {2}",Z.length,ea.length,sa);return{returnValue:Da,zdf:sa}}EJk(Z,ea){const ha=Z.qKl,ka=Z.PJk;Z=Z.dVk;const ua=new k.a;let sa=ka.length,Da=Z.length;for(;0<sa||0<Da;){var Pa=
sa-1,Ra=Da-1;if(this.dCn(ha,ea,sa,Da)){Pa=Z.J(Ra);if(1===Pa.type||2===Pa.type)this.gFm(ua,sa,Pa);else if(0===Pa.type)this.EEm(ua,sa,Pa);else return a.a.instance.Ua(575706452,1,2,"Abandoning LCS due to unexpected block of type {0}",Pa.type),this.$d.logger.Rg(Object.assign(new Q.a,{yj:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;Da--;ea--}else if(this.cCn(ha,ea,sa,Da)){Ra=ka.J(Pa);if(1===Ra.type||2===Ra.type)this.zll(ua,Pa,Ra);else if(0===Ra.type)this.ell(ua,Pa,Ra);else return a.a.instance.Ua(575706453,
1,2,"Abandoning LCS due to unexpected block of type {0}",Ra.type),this.$d.logger.Rg(Object.assign(new Q.a,{yj:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;sa--;ea--}else if(sa&&Da&&ka.J(Pa).JA(Z.J(Ra)))sa--,Da--;else return a.a.instance.Ua(575706454,1,2,"Abandoning LCS due to being unable to find a path"),this.$d.logger.Rg(Object.assign(new Q.a,{yj:"BacktraceAndMakeUpdateHints",eventId:"0"})),null}this.$d.runtime.eH("LCS: CreateUpdateHintsFromLCSBlocks");return ua}cCn(Z,ea,ha,ka){ea=
new O(ea-1,ha-ka-1);return Z.nb(ea)&&Z.J(ea).x===ha-1&&Z.J(ea).y===ka}dCn(Z,ea,ha,ka){ea=new O(ea-1,ha-ka+1);return Z.nb(ea)&&Z.J(ea).x===ha&&Z.J(ea).y===ka-1}EEm(Z,ea,ha){ha=new v.a(ha.fTa,ha.Wc);let ka=!1;if(0<Z.length&&11===Z.eg(Z.length-1).type){const ua=Z.eg(Z.length-1);ua.cp===ea&&(ka=!0,ua.y0.add(ha))}ka||(ea=new F.a(ea),ea.y0.add(ha),Z.add(ea))}gFm(Z,ea,ha){var ka=!1;if(0<Z.length&&11===Z.eg(Z.length-1).type){const ua=Z.eg(Z.length-1);ua.cp===ea&&((ka=Object(y.a)(H.a,ua.y0.J(ua.y0.length-
1)))?ka.text=ha.character.toString()+ka.text:ua.y0.add(new H.a(ha.fTa,ha.character.toString())),ka=!0)}ka||(ea=new F.a(ea),ea.y0.add(new H.a(ha.fTa,ha.character.toString())),Z.add(ea))}ell(Z,ea,ha){ea=new t.a(ea,ha.fTa,ha.Wc);Z.add(ea)}ELc(Z,ea){let ha=!1;if(0<Z.updateHints.length&&2===Z.updateHints.eg(Z.updateHints.length-1).type){const ka=Z.updateHints.eg(Z.updateHints.length-1);ka.Bg.equals(ea.fTa)&&ka.cp===ea.d$d&&(ka.cp=ea.d$d-1,ka.text=(void 0).character.toString()+ka.text,ha=!0)}ha||Z.updateHints.add(new m.DeleteTextUpdateHint(ea.fTa,
ea.d$d-1,(void 0).character.toString()));--ea.d$d}zll(Z,ea,ha){let ka=!1;if(0<Z.length&&8===Z.eg(Z.length-1).type){const ua=Z.eg(Z.length-1);ua.cp===ea+1&&(ua.text=ha.character.toString()+ua.text,--ua.cp,ka=!0)}ka||Z.add(new z.a(ea,ha.character.toString()))}}Object(D.a)(ba,"LCSUpdateHintGenerator",null,[])},1794:function(D,I,c){c.r(I);D=c(0);var l=c(16),e=c(6),a=c(183),k=c(367),x=c(611),y=c(225),m=c(60),t=c(54),z=c(1557);class v extends z.a{constructor(){super()}get tha(){return"ChildNodeListMerge"}}
Object(D.a)(v,"ChildNodeListMergeFailureDetail",z.a,[]);class H{Irb(ba,Z,ea){return Z.Fz(ba,ea.J(ba))}DCj(ba,Z,ea,ha){let ka;return({value:ka}=Z.Fc(ba)).returnValue||({value:ka}=ea.Fc(ba)).returnValue?ka:ha.J(ba)}}Object(D.a)(H,"ChildNodeListMergeUtils",null,[1994]);var F=c(1584),G=c(1805),M=c(1658);class K{constructor(ba,Z){this.classId=ba;this.UQo=Z}}Object(D.a)(K,"NodeChildrenTransformation",null,[]);var L=c(816),R=c(1575);class S{constructor(ba,Z,ea){this.ZE=ba;this.Wra=ea;this.Q8=Z}abe(ba){let Z,
ea;return({t5i:Z}=this.ICj(this.Wra,ba)).returnValue&&Z.AY||({t5i:ea}=this.ICj(this.Q8,ba)).returnValue&&ea.AY}ICj(ba,Z){let ea;return{returnValue:({value:ea}=(new R.a(this.ZE,ba)).Tqa.Fc(L.a.Ab(Z))).returnValue,t5i:ea}}}Object(D.a)(S,"NodeTriplet",null,[]);var N=c(1742);class O{constructor(ba,Z,ea){this.$d=ba;this.Qg=Z;this.O7=ea;this.fih=!0}get uq(){return this.$d}get Xd(){return this.Qg}get uAa(){return this.O7}get success(){return this.fih}L9l(){a.a.instance.Ua(4220310,1,5,"Evaluating ParentObjects");
const ba=new k.a;this.M5e(ba,Z=>this.uq.runtime.vk.J(Z));this.M5e(ba,Z=>this.uAa.Irb(Z,this.uq.runtime.Lu,this.uq.runtime.vk));this.M5e(ba,Z=>this.uAa.Irb(Z,this.uq.runtime.Nq,this.uq.runtime.vk));return ba}M5e(ba,Z){const ea=Z(c(1794).ChildNodeListMerge.Q9d);this.Xd.getPropertyObjectIds(ea,l.a.gf).forEach(ha=>{this.Xd.getPropertyObjectIds(Z(ha),l.a.gf).forEach(ka=>{ba.nb(ka)&&!ha.equals(ba.J(ka))&&(this.fih=!1,a.a.instance.Ua(4220311,1,1,"OutlineGroup {0} should have parent {1} but instead has a different parent {2}.",
ka,ha,ba.J(ka)));ba.Z(ka,ha);return!0});return!0})}}Object(D.a)(O,"OutlineGroupParentFinder",null,[]);var W=c(1558),V=c(1613),Q=c(1659);c.d(I,"ChildNodeListMerge",function(){return Y});class Y{constructor(ba,Z=null,ea=null,ha=null,ka=null){this.Qg=ba;this.rAn=Z||G.a.cDj;this.$5d=ea||this.I6l();this.uAa=ha||new H;this.SOi=ka||this.H4l()}get Xd(){return this.Qg}I6l(){return[new K(393227,Object(t.a)(this,this.azn,"pageContentNodeThreewayChildMerge")),new K(1073872968,Object(t.a)(this,this.a8o,"wordSectionNodeThreewayChildMerge")),
new K(393241,Object(t.a)(this,this.G9d,"outlineElementContainerThreewayChildMerge")),new K(393252,Object(t.a)(this,this.hHo,"tableCellThreewayChildMergev2")),new K(1074135125,Object(t.a)(this,this.G9d,"outlineElementContainerThreewayChildMerge")),new K(1074135123,Object(t.a)(this,this.G9d,"outlineElementContainerThreewayChildMerge")),new K(1074135127,Object(t.a)(this,this.G9d,"outlineElementContainerThreewayChildMerge"))]}H4l(){return[Object(t.a)(this,this.GGn,"prepareObjectGroupings"),Object(t.a)(this,
this.spm,"handleInterOutlineGroupMerge"),Object(t.a)(this,this.HCn,"performThreewayChildMerge")]}Acn(ba){let Z=0;for(;Z<this.SOi.length;Z++)if(!(0,this.SOi[Z])(ba))return a.a.instance.Ua(4273296,1,4,"MergeChildNodeLists: Merged failed. [Function: {0}]",Z),ba.logger.u3d("ChildNodeListMerge.GetMergeChildNodeListsFunctions()",Z),!1;return!0}GGn(ba){const Z=new k.a,ea=new k.a,ha=new x.a;ba.runtime.Lu.forEach((ka,ua)=>Y.h1i(ua,Z));ba.runtime.Nq.forEach((ka,ua)=>Y.h1i(ua,ea));for(let ka=0;ka<this.$5d.length;ka++){const ua=
this.$5d[ka].classId;ba.runtime.knb.Z(ua,new k.a);Z.nb(ua)&&Z.J(ua).forEach(sa=>{var Da=ba.runtime.vk.J(sa.id);Da&&(Da=new S(Da,sa,ba.runtime.Nq.Fz(sa.id,Da)),ba.runtime.knb.J(ua).add(sa.id,Da),ha.add(sa.id));return!0});ea.nb(ua)&&ea.J(ua).forEach(sa=>{if(ha.contains(sa.id))return!0;const Da=ba.runtime.vk.J(sa.id);Da&&ba.runtime.knb.J(ua).add(sa.id,new S(Da,Da,sa));return!0})}ba.runtime.eH("PrepareObjectGroupings");ba.logger.Pia("PrepareObjectGroupings");return!0}HCn(ba){let Z=!0;for(let ea=0;Z&&
ea<this.$5d.length;ea++){const ha=this.$5d[ea];ba.runtime.eH("Before function#"+ea);const ka=ha.classId;ba.runtime.knb.J(ka).forEach((ua,sa)=>{ba.runtime.wOa.contains(sa.ZE.id)||(Z=ha.UQo(ba,sa)&&Z);Z||(a.a.instance.Ua(4273297,1,4,"PerformThreewayChildMerge: Failed. [ClassId: {0}] [BaseObject.Id: {1}]",ka,sa.ZE.id),ba.logger.Rg(Object.assign(new v,{yj:"PerformThreewayChildMerge",eventId:"aqtsr"})));return Z});ba.runtime.eH("PerformThreewayChildMerge"+ea)}ba.logger.Pia("PerformThreewayChildMerge");
return Z}azn(ba,Z){if(Z.abe(l.a.gf)){var ea=this.Xd.getPropertyObjectIds(Z.ZE,l.a.gf);const ha=this.Xd.getPropertyObjectIds(Z.Q8,l.a.gf);Z=this.Xd.getPropertyObjectIds(Z.Wra,l.a.gf);ea=String.format("Child node count: Base={0}, Favored={1}, Unfavored={2}, GraphMergeSource={3}",ea.length,ha.length,Z.length,ba.input.source);a.a.instance.Ua(4030551,1,4,"Punting attempted merge as there appears to be an added or removed WordSection. {0}",ea);ba.logger.Rg(Object.assign(new v,{yj:"PageContentNodeThreewayChildMerge",
eventId:"apybx",info:ea}));return!1}return!0}a8o(ba,Z){if(Z.abe(l.a.gf)){const Pa=new x.a,Ra=new x.a,Ga=new x.a,ta=new x.a;var ea=this.Xd.getPropertyObjectIds(Z.ZE,l.a.gf),ha=ea.fH(),ka,ua=({XKh:ka}=this.fKj(Z.Q8,ha,Pa,"Favored")).returnValue,sa=({XKh:Da}=this.fKj(Z.Wra,ha,Ra,"Unfavored")).returnValue;if(!ua||!sa)return ea=String.format("Unexpected OG node added. Base OG count: {0}. Favored OG count: {1}. Unfavored OG count: {2}. Favored OGs not found in base: {3}. Unfavored OGs not found in base: {4}.",
ha.count,Pa.count,Ra.count,ka,Da),ba.logger.Rg(Object.assign(new v,{yj:"WordSectionNodeThreewayChildMerge",info:ea})),!1;ea.forEach(va=>{Pa.contains(va)||Ga.add(va);Ra.contains(va)||ta.add(va);return!0});Z=Z.ZE.XK();ha=new y.a;for(ka=0;ka<ea.length;ka++){var Da=ea.eg(ka);if(Ga.contains(Da)||ta.contains(Da)){if(ba.runtime.wOa.add(Da),ha.length&&(ua=ha.eg(ha.length-1),ua=ba.runtime.knb.J(393241).J(ua),sa=ba.runtime.knb.J(393241).J(Da),ua&&sa))Ga.contains(Da)?ta.contains(Da)||(ua.ZE=ua.ZE.XK(),ua.Wra=
ua.Wra.XK(),this.fDd(ua.ZE,sa.ZE),this.fDd(ua.Wra,sa.Wra)):(ua.ZE=ua.ZE.XK(),ua.Q8=ua.Q8.XK(),this.fDd(ua.ZE,sa.ZE),this.fDd(ua.Q8,sa.Q8))}else ha.add(Da)}this.Xd.setPropertyObjectIds(Z,l.a.gf,ha);ea=new W.a(Z);ea.DC(l.a.gf);ba.runtime.un.Z(Z.id,ea)}return!0}fDd(ba,Z){const ea=this.Xd.getPropertyObjectIds(ba,l.a.gf);Z=this.Xd.getPropertyObjectIds(Z,l.a.gf);const ha=ea.R5();Z.forEach(ka=>{ha.add(ka);return!0});this.Xd.setPropertyObjectIds(ba,l.a.gf,ha)}fKj(ba,Z,ea,ha){let ka=0,ua=!0;this.Xd.getPropertyObjectIds(ba,
l.a.gf).forEach(sa=>{Z.contains(sa)?ea.add(sa):(ua=!1,a.a.instance.Ua(573912977,1,4,"VerifyWordSectionChildren {0}: Failed to find {1} in baseObjects.",ha,sa),ka++);return!0});return{returnValue:ua,XKh:ka}}spm(ba){let Z=!0;ba.runtime.knb.J(393241).forEach((ea,ha)=>{if(this.kPm(ha)){a.a.instance.Ua(4220302,1,4,"OutlineGroup {0} requires inter-OG merge.",ha.ZE.id);let ka;const ua=new O(ba,this.Xd,this.uAa);if(({B_i:ea,TLj:ka}=this.nPo(ba,ua.L9l(),ha)).returnValue)return a.a.instance.Ua(4220303,1,4,
"Merging WordSection {0} as a unit.",ka),Z=ua.success&&this.qdn(ba,ka,ea)&&Z,Z||(a.a.instance.Ua(4273299,1,2,"Inter-OG merge failed. [ObjectId: {0}] [OutlineGroupParentFinder.Success: {1}].",ha.ZE.id,ua.success),ba.logger.Rg(Object.assign(new v,{yj:"HandleInterOutlineGroupMerge",eventId:"aqtst",info:String.format("Inter-OG Failure [OutlineGroupParentFinder.Success: {0}]",ua.success)}))),Z}return!0});return Z}kPm(ba){if(!ba.abe(l.a.gf))return!1;const Z=this.Xd.getPropertyObjectIds(ba.ZE,l.a.gf).J(0),
ea=this.Xd.getPropertyObjectIds(ba.Q8,l.a.gf);ba=this.Xd.getPropertyObjectIds(ba.Wra,l.a.gf);return!ea.contains(Z,(ha,ka)=>ha.equals(ka))||!ba.contains(Z,(ha,ka)=>ha.equals(ka))}nPo(ba,Z,ea){Z=Z.J(ea.ZE.id);a.a.instance.Ua(4220304,1,4,"While inspecting OG {0}, it appears an inter-OG merge is taking place. All children of WordSection {1} will be merged as a unit.",ea.ZE.id,Z);if(ba.runtime.wOa.contains(Z))return a.a.instance.Ua(4220305,1,5,"Trying to merge WordSection {0} for an inter-OG merge, but an another OG caused us to do that already. Skipping the attempt.",
Z),{returnValue:!1,B_i:null,TLj:Z};const ha=new N.a;ea=ba.runtime.vk.J(Z);this.Xd.getPropertyObjectIds(ea,l.a.gf).forEach(ka=>{ha.eDd(ka);return!0});ea=this.uAa.Irb(Z,ba.runtime.Lu,ba.runtime.vk);this.Xd.getPropertyObjectIds(ea,l.a.gf).forEach(ka=>{ha.gDd(ka);return!0});ba=this.uAa.Irb(Z,ba.runtime.Nq,ba.runtime.vk);this.Xd.getPropertyObjectIds(ba,l.a.gf).forEach(ka=>{ha.kDd(ka);return!0});return{returnValue:!0,B_i:ha,TLj:Z}}r2f(ba,Z,ea,ha,ka){let ua=!0;ba.forEach(sa=>{const Da=Z(sa);this.Xd.getPropertyObjectIds(Da,
l.a.gf).forEach(Pa=>{ea.add(Pa);if(ha.nb(Pa))return(ua=ha.J(Pa).equals(sa)&&ua)||a.a.instance.Ua(4273300,1,2,"PreprocessRevisionOutlineGroups {0}: Failed. [OutlineElementId: {1}] [OutlineGroupId: {2}] [OutputMapping: {3}]",ka,Pa,sa,ha.J(Pa)),ua;ha.Z(Pa,sa);return!0});return!0});return ua}Z7l(ba,Z){let ea,ha,ka,ua;ea=new y.a;ha=new y.a;ka=new y.a;ua=new k.a;const sa=ba.runtime.vk;return this.r2f(Z.rBb,Da=>sa.J(Da),ea,ua,"Base")&&this.r2f(Z.okf,Da=>this.uAa.Irb(Da,ba.runtime.Lu,sa),ha,ua,"Favored")&&
this.r2f(Z.Lrb,Da=>this.uAa.Irb(Da,ba.runtime.Nq,sa),ka,ua,"Unfavored")?{returnValue:!0,bxh:ea,WZh:ha,aEj:ka,ZSi:ua}:{returnValue:!1,bxh:ea,WZh:ha,aEj:ka,ZSi:ua}}vFl(ba,Z,ea,ha){let ka=!0;const ua=ba.runtime.vk,sa=ba.runtime.Lu,Da=ba.runtime.Nq,Pa=ba.runtime.un,Ra=new y.a,Ga=new k.a;ea.forEach(ta=>{const va=ha.J(ta);if(!va)return a.a.instance.Ua(4220306,1,1,"OutlineElementId {0} does not have an OutlineGroup parent in oeToOgMapping.",ta),ba.logger.Rg(Object.assign(new v,{yj:"FinishInterOutlineGroupMerge",
eventId:"aqgws"})),ka=!1;va.equals(Ra.last())||(Ra.add(va),Ga.add(va,new y.a));Ga.J(va).add(ta);ba.runtime.wOa.add(ta);return!0});if(!ka)return!1;Ga.forEach((ta,va)=>{const ia=this.uAa.DCj(ta,sa,Da,ua).XK();this.Xd.setPropertyObjectIds(ia,l.a.gf,va);Pa.Z(ta,new W.a(ia));Pa.J(ta).DC(l.a.gf);ba.runtime.wOa.add(ta);return ka});ea=this.uAa.DCj(Z,sa,Da,ua).XK();this.Xd.setPropertyObjectIds(ea,l.a.gf,Ra);Pa.Z(Z,new W.a(ea));Pa.J(Z).DC(l.a.gf);ba.runtime.wOa.add(Z);return ka}qdn(ba,Z,ea){let ha,ka;if(!({bxh:ua,
WZh:ha,aEj:ka,ZSi:ea}=this.Z7l(ba,ea)).returnValue)return!1;var ua=F.b(ua,ha,ka);ua=this.QZf(ba,ua);return!!ua&&this.vFl(ba,Z,ua,ea)}G9d(ba,Z){return this.x_i(ba,Z)}x_i(ba,Z){if(Z.abe(l.a.gf)){var ea=this.V7l(Z);ea=this.QZf(ba,ea);if(!ea)return a.a.instance.Ua(4220308,1,1,"OutlineElementContainerThreewayChildMerge: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",Z.ZE.id),ba.logger.Rg(Object.assign(new v,{yj:"OutlineElementContainerThreewayChildMerge",
eventId:"aqgwu"})),M.a(Z.ZE,"OutlineElementContainerThreewayChildMerge_Base",1),M.a(Z.Q8,"OutlineElementContainerThreewayChildMerge_Favored",1),M.a(Z.Wra,"OutlineElementContainerThreewayChildMerge_Unfavored",1),!1;var ha=this.Xd.getPropertyObjectIds(Z.ZE,l.a.gf);const ka=ea.fH();ha.forEach(ua=>{ka.contains(ua)||(ua=this.Xd.getPropertyObjectIds(Z.ZE,l.a.$K),0<ua.length&&ba.runtime.E_f.add(ua.J(0)));return!0});ha=Z.Q8.XK();this.Xd.setPropertyObjectIds(ha,l.a.gf,ea);ba.runtime.un.Z(ha.id,new W.a(ha));
ba.runtime.un.J(ha.id).DC(l.a.gf)}return!0}dKb(ba){if(!ba)return a.a.instance.Ua(573957964,1,2,"Feature helper is null"),!1;ba.Ux(106);return ba.isFeatureEnabled(106)}hHo(ba,Z){if(!this.dKb(ba.runtime.Zb))return this.Xkg(ba,Z);var ea=Z.ZE.id,ha=Q.e(ba,Z.ZE,null);if(ha.equals(m.a.nil))return a.a.instance.Ua(573957965,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",ea),ba.logger.Rg(Object.assign(new V.a,{info:"Table node ID could not be found for table cell"})),!1;var ka=ba.runtime.FCb.J(ha);
if(ka&&(ka=ka.J(ea)))if(ka.hg)Z=Z.Q8.XK(),Z.removeProperty(l.a.gf),this.Xd.setPropertyBool(Z,e.a.ghostCell,!0),null!=ka.colSpan?this.Xd.setPropertyUint32(Z,e.a.colSpan,ka.colSpan):Z.removeProperty(e.a.colSpan),ba.runtime.un.Z(Z.id,new W.a(Z)),ba.runtime.un.J(Z.id).DC(l.a.gf),ba.runtime.un.J(Z.id).DC(e.a.ghostCell),ba.runtime.un.J(Z.id).DC(e.a.colSpan);else{let ua,sa;({ZDd:ha,cOd:ua,One:sa}=this.F3l(ba,Z,ka,ha));if(!ua.length&&!sa.length)return a.a.instance.Ua(573957966,1,2,"A non-ghost cell does not have OE nodes on either side. Table cell ID: {0}",
ea),ba.logger.Rg(Object.assign(new V.a,{info:"A non-ghost cell does not have OE nodes on either side"})),!1;ua.length?sa.length?(ea=F.b(ha,ua,sa),ea=this.QZf(ba,ea)):ea=ua:ea=sa;if(!ea)return a.a.instance.Ua(573957920,1,1,"TableCellThreewayChildMergev2: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",Z.ZE.id),ba.logger.Rg(Object.assign(new v,{yj:"TableCellThreewayChildMergev2",eventId:"8n426"})),M.a(Z.ZE,"TableCellThreewayChildMergev2_Base",
1),M.a(Z.Q8,"TableCellThreewayChildMergev2_Favored",1),M.a(Z.Wra,"TableCellThreewayChildMergev2_Unfavored",1),!1;Z=Z.Q8.XK();this.Xd.setPropertyObjectIds(Z,l.a.gf,ea);Z.removeProperty(e.a.ghostCell);ea=ka.rowSpan;ka=ka.colSpan;null!=ea&&null!=ka&&(1<ea||1<ka)?(this.Xd.setPropertyUint32(Z,e.a.rowSpan,ea),this.Xd.setPropertyUint32(Z,e.a.colSpan,ka)):(Z.removeProperty(e.a.rowSpan),Z.removeProperty(e.a.colSpan));ba.runtime.un.Z(Z.id,new W.a(Z));ba.runtime.un.J(Z.id).DC(l.a.gf);ba.runtime.un.J(Z.id).DC(e.a.ghostCell);
ba.runtime.un.J(Z.id).DC(e.a.rowSpan);ba.runtime.un.J(Z.id).DC(e.a.colSpan)}else return this.Xkg(ba,Z);ba.logger.Pia("TableCellThreewayChildMergev2");return!0}F3l(ba,Z,ea,ha){let ka,ua;({ZDd:Z,cOd:ka,One:ua}=this.q9h(Z));Z||(Z=new y.a);ka||(ka=new y.a);ua||(ua=new y.a);var sa=Z.fH(),Da=ka.fH(),Pa=ua.fH(),Ra=ea.A6d;if(Ra)for(var Ga=0;Ga<Ra.length;Ga++){var ta=Ra.J(Ga),va=ba.runtime.vk.J(ta);!sa.contains(ta)&&va&&(sa.add(ta),Z.add(ta));!Da.contains(ta)&&ba.runtime.Lu.Fz(ta,va)&&(Da.add(ta),ka.add(ta));
!Pa.contains(ta)&&ba.runtime.Nq.Fz(ta,va)&&(Pa.add(ta),ua.add(ta))}ba.logger.Pia("OENodesAddedToChildrenList");if(Ra=ea.Hwf)for(Ga=0;Ga<Ra.length;Ga++)if(ta=Ra.J(Ga),va=ba.runtime.vk.J(ta)){var ia=this.Xd.getPropertyObjectIds(va,l.a.gf);if(ia)for(var qa=0;qa<ia.length;qa++){var pa=ia.J(qa);sa.contains(pa)||(sa.add(pa),Z.add(pa))}ia=ba.runtime.Lu.Fz(ta,va);if(ia=this.Xd.getPropertyObjectIds(ia,l.a.gf))for(qa=0;qa<ia.length;qa++)pa=ia.J(qa),Da.contains(pa)||(Da.add(pa),ka.add(pa));ta=ba.runtime.Nq.Fz(ta,
va);if(ta=this.Xd.getPropertyObjectIds(ta,l.a.gf))for(va=0;va<ta.length;va++)ia=ta.J(va),Pa.contains(ia)||(Pa.add(ia),ua.add(ia))}ba.logger.Pia("GhostCellOENodesAddedToChildrenList");if(ea=ea.XTf)for(sa=0;sa<ea.length;sa++)if(Da=ea.J(sa),Da=ba.runtime.FCb.J(ha).J(Da))if(Da=Da.A6d){Da=Da.fH();Pa=new y.a;for(Ra=0;Ra<Z.length;Ra++)Da.contains(Z.J(Ra))||Pa.add(Z.J(Ra));Z=Pa;Pa=new y.a;for(Ra=0;Ra<ka.length;Ra++)Da.contains(ka.J(Ra))||Pa.add(ka.J(Ra));ka=Pa;Pa=new y.a;for(Ra=0;Ra<ua.length;Ra++)Da.contains(ua.J(Ra))||
Pa.add(ua.J(Ra));ua=Pa}ba.logger.Pia("NonGhostCellsOENodesRemovedFromChildrenList");return{ZDd:Z,cOd:ka,One:ua}}Xkg(ba,Z){let ea=Z.Q8.hasProperty(l.a.gf),ha=Z.Wra.hasProperty(l.a.gf);ea&&(ea=!!this.Xd.getPropertyObjectIds(Z.Q8,l.a.gf).length);ha&&(ha=!!this.Xd.getPropertyObjectIds(Z.Wra,l.a.gf).length);if(ea!==ha)if(this.TVm(ba.runtime.Zb))ba.logger.mKi(Object.assign(new V.a,{info:"TableCell OE missing children, ghost cell likely touched"}));else return ba.logger.Rg(Object.assign(new V.a,{info:"TableCell OE missing children, ghost cell likely touched"})),
!1;return this.x_i(ba,Z)}V7l(ba){let Z,ea;({ZDd:ba,cOd:Z,One:ea}=this.q9h(ba));return F.b(ba,Z,ea)}QZf(ba,Z){a.a.instance.Ua(4220309,1,5,"Considering {0} OutlineElement collections for merge.",Z.length);const ea=new y.a;let ha=!0;Z.forEach(ka=>{if(!ka)return a.a.instance.shipAssertTag(4740611,1,!1,"Mapping is null."),ba.logger.Rg(Object.assign(new v,{yj:"OutlineElementCollectionsThreewayChildMerge",eventId:"asfyd"})),ha=!1;if(1===ka.fen&&1===ka.Nmb){const ia=ka.rBb.J(0),qa=ka.okf.J(0),pa=ka.Lrb.J(0);
if(ia&&ia.equals(qa)&&ia.equals(pa))return ea.add(ia),!0;if(1!==Z.length)return a.a.instance.shipAssertTag(4030554,1,!1,"OutlineElementCollectionsThreewayChildMerge: A 1-1-1 mapping found which somehow contains differing objects. [Base: {0}] [Favored: {1}] [Unfavored: {2}] [Total Collections: {3}].",ia,qa,pa,Z.length),ba.logger.Rg(Object.assign(new v,{yj:"OutlineElementCollectionsThreewayChildMerge",eventId:"apyb0"})),ha=!1}const ua=new k.a,sa=new y.a,Da=new y.a,Pa=new y.a,Ra=new y.a,Ga=new y.a,ta=
new y.a,va=ba.runtime.vk;ka.rBb.forEach(ia=>ha=this.o3f(ba,ia,qa=>va.J(qa),sa,Ra,ua,"Base"));if(!ha)return a.a.instance.Ua(4285026,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process base outlines."),ba.logger.Rg(Object.assign(new v,{yj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj8"})),!1;ka.okf.forEach(ia=>ha=this.o3f(ba,ia,qa=>this.uAa.Irb(qa,ba.runtime.Lu,va),Da,Ga,ua,"Favored"));if(!ha)return a.a.instance.Ua(4285027,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process favored outlines."),
ba.logger.Rg(Object.assign(new v,{yj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj9"})),!1;ka.Lrb.forEach(ia=>ha=this.o3f(ba,ia,qa=>this.uAa.Irb(qa,ba.runtime.Nq,va),Pa,ta,ua,"Unfavored"));if(!ha)return a.a.instance.Ua(4285056,1,4,"OutlineElementCollectionsThreewayChildMerge: Failed to process unfavored outlines."),ba.logger.Rg(Object.assign(new v,{yj:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwka"})),!1;ba.runtime.Zb&&ba.runtime.Zb.Jjb(1000005)&&(Ga.length&&this.sBl(Ga,
ba.runtime.Lu)?(this.mqh(Ga,ba,ea,ua),this.eCd(ba,ua,ta)):this.mqh(ta,ba,ea,ua));if(sa.length){ka=null;if(!({un:ka}=this.rAn(ba,sa,Da,Pa,ka)).returnValue||!ka)return ha=!1;ka.forEach(ia=>{0<ia.p1b.count&&ba.runtime.un.Z(ia.Fm.id,ia);ea.add(ua.J(ia.Fm.id));return!0})}return!0});return ha?ea:null}sBl(ba,Z){for(let ea=0;ea<ba.length;ea++)if(Z.get(ba.eg(ea).id))return!0;return!1}eCd(ba,Z,ea){ea.length&&(ea.forEach(ha=>{ba.runtime.mmc.add(ha.id);ba.runtime.mmc.add(Z.J(ha.id));return!0}),G.a.eCd(ba,this.Xd,
ea.J(0)))}mqh(ba,Z,ea,ha){ba.forEach(ka=>{const ua=new W.a(ka.XK());Z.runtime.un.Z(ka.id,ua);ea.add(ha.J(ka.id));return!0})}o3f(ba,Z,ea,ha,ka,ua,sa){var Da=ea(Z);if(!Da)return a.a.instance.Ua(4285057,1,1,"ProcessOutlineElement {0}: Failed to find OutlineElement with [Id: {1}]",sa,Z),ba.logger.Rg(Object.assign(new v,{yj:"ProcessOutlineElement",eventId:"aqwkb",info:String.format("[Revision: {0}] Failed to find OutlineElement",sa)})),!1;const Pa=this.Xd.getPropertyObjectIds(Da,l.a.$K);if(!Pa||!Pa.length)return a.a.instance.Ua(4285058,
1,1,"ProcessOutlineElement {0}: OutlineElement [Id: {1}] has no children.",sa,Z),ba.logger.Rg(Object.assign(new v,{yj:"ProcessOutlineElement",eventId:"aqwkc",info:String.format("[Revision: {0}] OutlineElement has no children",sa)})),M.a(Da,"ProcessOutlineElement_"+sa,1),!1;Da=Pa.eg(0);ea=ea(Da);if(!ea)return a.a.instance.Ua(4285059,1,1,"ProcessOutlineElement {0}: Failed to find ParagraphNode with [Id: {1}] as a child of OutlineElement with [Id: {2}]",sa,Da,Z),ba.logger.Rg(Object.assign(new v,{yj:"ProcessOutlineElement",
eventId:"aqwkd",info:String.format("[Revision: {0}] Failed to find correct ParagraphNode in OutlineElement",sa)})),!1;if((sa=this.Xd.getPropertyString(ea,e.a.DN))&&""!==sa&&ba.runtime.Zb&&(ba.runtime.Zb.HVd(1000005),ba.runtime.Zb.Jjb(1000005)))return ka.add(ea),ua.add(Da,Z),ba.runtime.wOa.add(Da),!0;ha.add(ea);ua.add(Da,Z);ba.runtime.wOa.add(Da);return!0}q9h(ba){let Z,ea;Z=this.Xd.getPropertyObjectIds(ba.ZE,l.a.gf);ea=this.Xd.getPropertyObjectIds(ba.Q8,l.a.gf);ba=this.Xd.getPropertyObjectIds(ba.Wra,
l.a.gf);return{ZDd:Z,cOd:ea,One:ba}}TVm(ba){if(!ba)return a.a.instance.Ua(51422868,1,2,"Feature Helper is null"),!1;ba.Ux(105);return ba.isFeatureEnabled(105)}static h1i(ba,Z){Z.nb(ba.Qc)||Z.Z(ba.Qc,new y.a);Z.J(ba.Qc).add(ba);return!0}}Y.Q9d=m.a.If("{4215CA2B-DF37-4aaa-89ED-F1646178CD20}{1}");Object(D.a)(Y,"ChildNodeListMerge",null,[1933])},1795:function(D,I,c){D=c(0);var l=c(1522),e=c(1652),a=c(1570),k=c(1540),x=c(1734),y=c(1587);class m{constructor(Z,ea){this.DimensionValue=this.DimensionName=
null;this.DimensionName=Z;this.DimensionValue=ea}}Object(D.a)(m,"Dimension",null,[]);class t{constructor(Z,ea,ha,ka,ua){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=Z;this.Query=ea;this.From=ha;this.Size=ka;ua&&(this.Filter=ua)}}Object(D.a)(t,"EntityRequest",null,[]);class z{constructor(Z){this.QueryString=null;this.QueryString=Z}}Object(D.a)(z,"Query",null,[]);var v=c(1524);class H{constructor(Z,ea){this.Dimensions=this.Name=null;this.Name=Z;this.Dimensions=
ea}}Object(D.a)(H,"Scenario",null,[]);var F=c(1527),G=c(1526);class M{constructor(Z,ea,ha,ka){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=Z;this.TimeZone=ea;this.Cvid=ha;this.Scenario=ka}}Object(D.a)(M,"SubstrateBody",null,[]);var K=c(1586),L=c(1520),R=c(1519),S=c(2),N=c(1727),O=c(1726),W=c(1556),V=c(34),Q=c(19),Y=c(139);c.d(I,"a",function(){return ba});class ba{constructor(Z){this.vAc=this.Ddb=this.ksd=this.ovc=this.hBc=0;this.G8g=this.hbh=this.BQ=null;this.jJe=
0;this.M2=-1;this.SDc="";this.uCe=!1;this.$f=S.AFrameworkApplication.He;this.fc=Z;this.hyd=this.fvf();this.Zyb=new e.a;this.W6g=this.fc.ane?3:2;this.wVe=this.fc.ane&&this.fc.Qsj?5:3;this.OYe=this.fc.Die?2:3;this.Nmh=1;this.ord=this.fc.wdi;this.nhh=this.fc.dVm;this.gCc=Z.Ahi;S.AFrameworkApplication.K&&(this.hbh=S.AFrameworkApplication.K.kb("AppCatalogUrl")+S.AFrameworkApplication.K.kb("SearchPersonaPhotoBaseUrl"),this.uCe=this.fc.J7b||this.fc.kha||this.fc.FMd);this.fc.kha&&(this.OYe=this.wVe=5)}oL(){return"Substrate"}BU(){return 0===
this.fc.hv?0:1===this.fc.hv?1:3}dI(Z,ea,ha,ka=l.a.tellMe,ua=null){const sa=new G.a(Z);if(!ua||Array.contains(ua,14)||Array.contains(ua,15)||Array.contains(ua,20))if(!this.jJe||window.performance.now()-this.jJe>=R.a.T8a)if(ha=this.Zyb.gii())this.jJe=window.performance.now(),ha.then(Da=>{Da&&""!==Da?(this.SDc=Da,""!==this.BQ&&this.fii(Z,ka,this.SDc,ea,ua)):(L.TellMeActor.instance.Oe.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),ea.resultsUpdated(sa))},Da=>{L.TellMeActor.instance.Oe.onError("SubstrateResultsProvider:IssueQuery",
"SubstrateTokenPromise rejected "+Da);ea.resultsUpdated(sa)});else{if(L.TellMeActor.instance.Oe)L.TellMeActor.instance.Oe.onError("SubstrateResultsProvider:IssueQuery","undefined token promise");ea.resultsUpdated(sa)}else this.SDc&&""!==this.SDc?this.fii(Z,ka,this.SDc,ea,ua):(ea.resultsUpdated(sa),L.TellMeActor.instance.Oe.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else ea.resultsUpdated(sa)}pza(){this.Ddb=this.vAc=this.ksd=this.ovc=this.hBc=0}fii(Z,ea,ha,ka,ua){this.pza();
const sa=new G.a(Z),Da=this.BQ=Y.a.create().toString();this.MDa();this.M2=window.setTimeout(()=>{if(Da===this.BQ){this.BQ="";this.M2=-1;ka.resultsUpdated(sa);const Ga={};Ga[a.a.provider]=this.oL();Ga[a.a.oOb]=Z.Oob;L.TellMeActor.instance.Oe.QA(k.a.timedOut,this.gCc,Ga)}},this.gCc);const Pa={"Content-Type":"application/json",Accept:"application/json"};Pa.Authorization="Bearer "+ha;Pa["X-Office-Version"]=S.AFrameworkApplication.buildVersion;Pa["X-Office-Application"]=S.AFrameworkApplication.K.kb("Application");
Pa["X-Office-Platform"]="WAC";Pa["X-TellMe-SessionId"]=L.TellMeActor.instance.SUd();Pa["X-TellMe-Culture"]=S.AFrameworkApplication.uiCulture;Pa["X-TellMe-ProcessSessionId"]=S.AFrameworkApplication.userSessionId;Pa["Client-Request-Id"]=Da;const Ra=window.performance.now();this.$f.mj(this.Tfm(),2,this.Ufm(Z.Gg,this.fc.application,L.TellMeActor.instance.SUd(),R.a.FR(Z)),Pa,!1,0,Ga=>{this.UMb(Ga,Z,ka,Da,Ra,ea,ua)},Ga=>{this.CMb(Ga,Z,ka,Da,Ra)},null,null,!1,4E3,6E3)}MDa(){-1!==this.M2&&(window.clearTimeout(this.M2),
this.M2=-1)}UMb(Z,ea,ha,ka,ua,sa,Da){L.TellMeActor.instance.Oe.W9(ea.Gg.length,this.hyd.join(","),Z.data.Se.toString(),Math.round(window.performance.now()-ua),K.a.substrate,!0,y.a.LQa);const Pa=R.a.FR(ea),Ra=new G.a(ea);if(ka===this.BQ){this.MDa();Z=V.b(Z.data.se);if(Z.Groups){Z=Z.Groups;for(const Ga of Z)"People"===Ga.Type&&this.fc.Ibd&&(Da?Array.contains(Da,14):1)?(Z=this.Lei(Ga.Suggestions,Pa,sa),0<Z.results.length&&Ra.dv(Z)):"File"===Ga.Type&&this.fc.Gbd&&(Da?Array.contains(Da,15):1)?(Z=this.Lqf(Ga.Suggestions,
Pa,sa),0<Z.results.length&&(this.m_d()&&(ka=new v.a("GenerateSlidesFromTellMe",30,"",null,1),Z.Uw(ka)),Ra.dv(Z))):"Notes"===Ga.Type&&this.fc.Rlb&&sa!==l.a.contextMenu&&(Da?Array.contains(Da,20):1)&&(Z=this.sdi(Ga.Suggestions,Pa,ea),0<Z.results.length&&Ra.dv(Z))}ha.resultsUpdated(Ra);L.TellMeActor.instance.Oe.W9(ea.Gg.length,this.hyd.join(","),"",Math.round(window.performance.now()-ua),"",!0,y.a.provider)}else ha.resultsUpdated(Ra)}sdi(Z,ea,ha){const ka=new F.a(20);ka.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;
for(const ua of Z)this.wXm(ua)&&(Z=ua.NotesType,Z=Q.a.eh(Z),Z=this.Z6l(Z,ua.LastModifiedTime,ua.BodyPreview,ua.Subject,ea,ha,ua))&&(Z.groupType=20,ka.Uw(Z));return ka}Lei(Z,ea,ha){const ka=new F.a(14);ka.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const sa of Z)if(this.xXm(sa)){var ua=sa.Id.split("@")[0];Z=sa.EmailAddresses[0];let Da=sa.Type;if(void 0===Da||null===Da)Da="User";if(ua=this.Z9l(Da,sa.DisplayName,sa.JobTitle,Z,ua,ha,ea))ua.description=Z,Z=sa.JobTitle,"Department"in sa&&
"CompanyName"in sa&&(Z+="@"+sa.Department+"@"+sa.CompanyName),ua.cJ=Z,ka.Uw(ua)}return ka}Lqf(Z,ea,ha){const ka=new F.a(15);ka.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const Ga of Z)if(this.mXm(Ga)){var ua=Ga.FileName;Z=Ga.FileExtension;var sa=ua;ua.length>Z.length&&sa.endsWith(Z)&&(sa=ua.substr(0,ua.length-Z.length-1));var Da=void 0,Pa=0;"DateCreated"in Ga&&Ga.DateCreated?(Pa=R.a.Nvf(Ga.DateCreated),Da=R.a.uji(Ga.DateCreated),Da=String.format(CommonUIStrings.l_CreatedTimeFormatString,
Ga.Author,Da)):Da=Ga.Author;var Ra=Ga.AccessUrl+"?web=1";const ta=Q.a.cbc(Ra);ua=String.format('<a href="{0}">{1}</a>',ta,Q.a.rY(ua));if(ha!==l.a.contextMenu||Q.a.xP(Ra))if(sa=this.aYl(sa,ha===l.a.contextMenu?ua:Ra,Da,Ga.FileExtension,Ga.Text,ea))sa.description=Ga.Author,sa.JCd=Pa,ka.Uw(sa),this.uCe&&(Pa=Ga.AccessUrl,ua=R.a.NRd(Z),Da=Ga.DateModified?Ga.DateModified:Ga.DateCreated,Ra=Ga.Size?Ga.Size:Ga.FileSize,this.qto()&&(Pa=Pa.replace(RegExp("%20","g")," "),ua=R.a.Nem(Z)),Z=new x.a(ua,Pa,Ga.SPWebUrl,
Ga.Id,Ra,Da),L.TellMeActor.instance.zpg(!1,sa.value,Z))}return ka}CMb(Z,ea,ha,ka,ua){ka===this.BQ&&(this.MDa(),L.TellMeActor.instance.Oe.W9(ea.Gg.length,this.hyd.join(","),Z.data.Se.toString(),Math.round(window.performance.now()-ua),K.a.substrate,!1,y.a.LQa));Z=new G.a(ea);ha.resultsUpdated(Z)}Z9l(Z,ea,ha,ka,ua,sa,Da){Da=Da?this.Nmh:this.W6g;if(!window.LPC&&!R.a.xEf()||this.hBc===Da)return null;this.hBc+=1;Da="PeopleSuggestion"+this.hBc.toString();var Pa=this.hbh+"?size=1&accountName="+ka;Z=Object.assign(new N.a,
{PersonaType:Z,Smtp:ka,ProfilePictureUrl:Pa,AadObjectId:ua});const Ra=Object.assign(new O.a,{identifiers:Z,displayName:ea});Z=sa===l.a.contextMenu;this.fc.bxa?(L.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(Da,Ra,ea,ha)),sa===l.a.contextMenu&&(ha=R.a.XNh(ea,ka,ua),L.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Da,ha))),L.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Da,Z))):(Pa=[],Pa.push(appChrome.actions.setPersonaButtonCoauthor(Da,
Ra,ea,ha)),sa===l.a.contextMenu&&(ha=R.a.XNh(ea,ka,ua),Pa.push(appChrome.actions.setButtonCommandValueId(Da,ha))),Pa.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Da,Z)),appChrome.api.dispatch(Pa));return new v.a(Da,11,ea,ka,0)}Z6l(Z,ea,ha,ka,ua,sa,Da){if(ua&&!this.fc.SDi||this.ksd===this.ord||this.vAc===this.ord||this.Ddb===this.ord)return null;var Pa=null;this.ksd+=1;ua="";const Ra=[],Ga={};Da.type="Notes";this.G8g=Object.assign(new W.a,{landingTab:"Notes",data:Da});sa=R.a.VOa(sa.Gg,
33,this.G8g);if("onenotepagepreviews"===Z){if(!("ClickthroughUrl"in Da&&Da.ClickthroughUrl)||""===Da.ClickthroughUrl)return null;this.vAc+=1;ua="OnenoteNotesSuggestion"+this.vAc.toString();Ga["default"]="SaveAsonetoc2_20";Pa=Da.ClickthroughUrl;Ra.push(appChrome.actions.setControlIconSet(ua,Ga));Ra.push(appChrome.actions.setCompoundButtonCommandValueId(ua,Pa));Pa=new v.a(ua,19,null,null,0)}else if("stickynote"===Z){if(!this.nhh)return null;this.Ddb+=1;ua="NotesSuggestion"+this.Ddb.toString();Ga["default"]=
"ShowAllNotes_20";Ra.push(appChrome.actions.setControlIconSet(ua,Ga));Ra.push(appChrome.actions.setCompoundButtonCommandValueId(ua,sa));Pa=new v.a(ua,21,null,null,0)}else if("samsung"===Z){if(!this.nhh)return null;this.Ddb+=1;ua="NotesSuggestion"+this.Ddb.toString();Ga["default"]="CategoryCollapsed_20";Ra.push(appChrome.actions.setControlIconSet(ua,Ga));Ra.push(appChrome.actions.setCompoundButtonCommandValueId(ua,sa));Pa=new v.a(ua,20,null,null,0)}""!==ua&&(Z=R.a.uji(ea),Z=String.format(CommonUIStrings.l_LastModifiedString,
Z),Pa.label=ka,Pa.JCd=R.a.Nvf(ea),Ra.push(appChrome.actions.setControlLabel(ua,ka)),Ra.push(appChrome.actions.updateCompoundButtonDescription(ua,Z)),Ra.push(appChrome.actions.setControlCustomTooltip(ua,ha)),appChrome.api.dispatch(Ra));return Pa}aYl(Z,ea,ha,ka,ua,sa){if(this.ovc===(sa?this.OYe:this.wVe)||this.uCe&&"Word"!==R.a.NRd(ka))return null;this.ovc+=1;sa="FileSuggestion"+this.ovc.toString();const Da=[],Pa={};Pa["default"]=R.a.q0l(ka);this.fc.bxa?(L.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(sa,
Z)),L.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(sa,Pa)),L.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(sa,ha)),L.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(sa,ea)),L.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(sa,ua)),this.fc.J7b&&L.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonSecondaryButtonId(sa,"QuickActionOnFile"))):(Da.push(appChrome.actions.setControlLabel(sa,
Z)),Da.push(appChrome.actions.setControlIconSet(sa,Pa)),Da.push(appChrome.actions.updateCompoundButtonDescription(sa,ha)),Da.push(appChrome.actions.setCompoundButtonCommandValueId(sa,ea)),Da.push(appChrome.actions.setControlCustomTooltip(sa,ua)),this.fc.J7b&&Da.push(appChrome.actions.setCompoundButtonSecondaryButtonId(sa,"QuickActionOnFile")),appChrome.api.dispatch(Da));return new v.a(sa,6,Z,ha,0)}fvf(){const Z=[];this.fc.Ibd&&Array.add(Z,"People");this.fc.Gbd&&Array.add(Z,"File");this.fc.Rlb&&Array.add(Z,
"Notes");return Z}Ufm(Z,ea,ha,ka){var ua=new z(Z);Z=new t("File",ua,0,ka?this.OYe:this.wVe,null);ka=new t("People",ua,0,ka?this.Nmh:this.W6g,R.a.rCn);ua=new t("Notes",ua,0,this.ord,null);(this.fc.J7b||this.fc.FMd)&&"powerpoint"===ea.toLowerCase()&&(ea="word");ea=new m("app",ea.toLowerCase());var sa=[];Array.add(sa,ea);ea=new H("tellmesearch",sa);sa=[];this.fc.Gbd&&Array.add(sa,Z);this.fc.Ibd&&Array.add(sa,ka);this.fc.Rlb&&Array.add(sa,ua);ha=new M(sa,"UTC",ha,ea);return V.c(ha)}Tfm(){let Z=this.fc.sFo;
this.fc.Rlb&&(Z+="?&setflight=NotesFrom3S");""!==this.fc.hii&&(Z=Z+"&"+this.fc.hii);return Z}xXm(Z){return"DisplayName"in Z&&"Id"in Z&&"EmailAddresses"in Z&&!!Z.Id&&!!Z.EmailAddresses}mXm(Z){return"FileExtension"in Z&&!!Z.FileExtension&&"FileName"in Z&&!!Z.FileName&&""!==Z.FileName&&"AccessUrl"in Z&&!!Z.AccessUrl&&""!==Z.AccessUrl}wXm(Z){return"Id"in Z&&!!Z.Id&&"NotesType"in Z&&!!Z.NotesType&&"Subject"in Z&&!!Z.Subject&&""!==Z.Subject}m_d(){return!!S.AFrameworkApplication.K&&S.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",
!1)}qto(){return!!S.AFrameworkApplication.K&&S.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShouldPerformFileInfoFixes",!0)}}Object(D.a)(ba,"SubstrateResultsProvider",null,[1112])},1796:function(D,I,c){D=c(0);var l=c(41),e=c(6),a=c(16),k=c(183),x=c(86),y=c(188),m=c(225),t=c(611),z=c(60),v=c(367),H=c(2),F=c(1471),G=c(970);class M{constructor(sa,Da=0){this.mbf=null;this.i0f=0;this.$M=sa;this.Xcn=Da}}Object(D.a)(M,"GraphMergerResponse",null,[]);var K=c(54),L=c(1),R=c(117),
S=c(885),N=c(1557),O=c(1610);class W extends O.a{constructor(){super();this.nvj=null;this.bLj=!1}get tha(){return"Crash"}eGb(){this.detail.Z("Type",this.tha);this.detail.Z("Trace",this.JOo(this.nvj));this.detail.Z("Continue",this.bLj);return this.detail}JOo(sa){sa=sa.split("\n");const Da=4<sa.length?4:sa.length,Pa=new Sys.StringBuilder;for(let Ra=0;Ra<Da;Ra++)Ra===Da-1?Pa.append(String.format("{0}...",sa[Ra])):Pa.append(String.format("{0}\n",sa[Ra]));return Pa.toString()}}Object(D.a)(W,"CrashMergeFailureDetail",
O.a,[]);var V=c(1993),Q=c(1575),Y=c(1668),ba=c(1558);class Z{constructor(){this.BLk=new v.a;this.w2k=new v.a;this.N5k=new v.a}}Object(D.a)(Z,"RangeMarkers",null,[]);class ea{constructor(){this.colSpan=this.rowSpan=null;this.hg=!1;this.QCe=new m.a;this.NLe=new m.a;this.gMe=new m.a}get Hwf(){return this.QCe.R5()}set Hwf(sa){sa||(this.QCe=new m.a);this.QCe=sa.R5()}get XTf(){return this.NLe.R5()}set XTf(sa){sa||(this.NLe=new m.a);this.NLe=sa.R5()}get A6d(){return this.gMe.R5()}set A6d(sa){sa||(this.gMe=
new m.a);this.gMe=sa.R5()}}Object(D.a)(ea,"TableCellStructureInfo",null,[]);var ha=c(1613),ka=c(1659);c.d(I,"a",function(){return ua});class ua{constructor(){this.GVd=0;this.LXg=this.rbb=this.pZb=this.Qg=this.geh=this.D_b=null;this.U6g=0;this.C3g=50;this.jVg=this.POg=null}get Ree(){return this.D_b}get c9n(){return this.geh}get Xd(){return this.Qg}get Qmb(){return this.pZb}get Ili(){return this.rbb}get Pmm(){return this.LXg}get Mfc(){return this.U6g}get nEh(){return this.POg}get $Nc(){return this.jVg}Tfc(sa,
Da,Pa,Ra,Ga,ta,va){Pa=this.rcl(sa,Da,Ra,Ga,ta,va,this.$Nc);Ra=0;const ia=Pa.runtime.Iie;let qa=null;try{this.C6m(ia,Pa,va,sa,Da,Ga,ta);for(sa=1;Ra<this.Qmb.length;Ra++)if(!(0,this.Qmb[Ra])(Pa)){sa=2;Pa.logger.u3d("GraphMerger.GetMergeFunctions()",Ra);break}return qa=new M(Pa.output.$M,sa)}catch(pa){const Fa=!Pa.output.timeout;Pa.output.crash=Fa;const za=this.GRd(pa),Oa=String.format("Merge {0}! [MergeId: {1}] Failing the merge. [Will continue: {2}] [{3}]",Fa?"Crashed":"Timed Out",Pa.input.HLb,!!Pa.output.$M,
za);Fa?(k.a.instance.Ua(4051608,1,1,"MergeChanges Crash. [Error: {0}]",Oa),Pa.logger.Rg(Object.assign(new W,{nvj:za,bLj:!!Pa.output.$M}))):k.a.instance.Ua(4993346,1,2,"MergeChanges Timeout. [Error: {0}]",Oa);if(Pa.output.$M)return qa=new M(Pa.output.$M,2);throw pa;}finally{Pa.output.succeeded?this.z6m(ia,Pa,Ra):Pa.output.timeout?this.B6m(Pa,Ra):Pa.output.crash?Pa.output.$M?this.A6m(Pa,Ra):this.y6m(Pa,Ra):this.x6m(Pa,Ra);Pa.logger.w6m();k.a.instance.Aka(42350232,1,Pa.output.succeeded?4:2,"MergeLogger",
Pa.logger.K4l());Pa.logger.h0c.Eni()&&k.a.instance.Aka(559015903,1,2,"MarkerInfo",Pa.logger.h0c.toString());if(Pa.runtime.Zb&&Pa.runtime.Zb.isFeatureEnabled(74))try{this.U3m(Pa)}catch(pa){k.a.instance.Ua(571619421,1,4,"Error logging references: {0}",pa.toString())}this.j7m(Pa);qa.i0f|=(Pa.output.succeeded?2:1)<<2*(va-1);if(qa)try{qa.mbf=this.mGn(Pa)}catch(pa){k.a.instance.shipAssertTag(51663492,1,!1,"Failed to create merge report {0}",pa)}}}j7m(sa){if(!sa.output.succeeded){sa=sa.output.timeout?"Timeout":
sa.logger.D5i?sa.logger.D5i.tha:"Unknown";const Da=new R.a;x.Health.instance.recordQosError(sa,["MergeFailure"],!0,!0,!1,!1,Da)}}U3m(sa){const Da=Ga=>{const ta=this.pFa()-sa.input.PUa>this.Mfc;if(0<this.Mfc&&ta)throw k.a.instance.Ua(571619422,1,2,"Timed out while calculating added and deleted nodes: {0}",Ga),y.a.invalidOperation(Ga);};let Pa=sa.runtime.Lu.keys,Ra=Ga=>sa.runtime.Lu.J(Ga);this.WMf(sa,Da,Pa,Ra,"Favored");Pa=sa.runtime.Nq.keys;Ra=Ga=>sa.runtime.Nq.J(Ga);this.WMf(sa,Da,Pa,Ra,"Unfavored");
Pa=sa.runtime.un.keys;Ra=Ga=>{const ta=sa.runtime.un.J(Ga);return ta?ta.Fm:sa.runtime.Lu.J(Ga)};this.WMf(sa,Da,Pa,Ra,"Merged")}WMf(sa,Da,Pa,Ra,Ga){var ta=new m.a;const va=new m.a;for(let ia=0;ia<Pa.length;ia++){Da("LogAddedAndDeletedNodes");const qa=Ra(Pa.J(ia));if(4325465===qa.Qc)continue;const pa=sa.runtime.vk.J(qa.id);pa&&this.V3m(ta,va,qa,pa)}this.bLi(va,ia=>sa.runtime.vk.J(ia),Da);this.bLi(ta,Ra,Da);Da=new Sys.StringBuilder;for(Pa=0;Pa<ta.length;Pa++)Da.append(ta.J(Pa).toString()+",");ta=new Sys.StringBuilder;
for(Pa=0;Pa<va.length;Pa++)ta.append(va.J(Pa).toString()+",");k.a.instance.Aka(571619423,1,4,Ga+" revision: Added references",Da.toString());k.a.instance.Aka(571619424,1,4,Ga+" revision: Deleted references",ta.toString())}V3m(sa,Da,Pa,Ra){const Ga=Pa.xl();for(let va=0;va<Ga.length;va++){const ia=Ga[va];if(this.uvi(ia)){var ta=this.Xd.getPropertyObjectIds(Pa,ia);this.G5m(sa,Da,Ra,ia,ta)}else this.NAi(ia)&&(ta=this.Xd.getPropertyObjectId(Pa,ia),this.F5m(sa,Da,Ra,ia,ta))}}bLi(sa,Da,Pa){Pa("LogNestedReferences");
Pa=new m.a;const Ra=new t.a;for(let Ga=0;Ga<sa.length;Ga++){const ta=sa.J(Ga);this.zNf(ta,Pa,Ra,Da)}for(Da=0;Da<Pa.length;Da++)sa.add(Pa.J(Da))}zNf(sa,Da,Pa,Ra){const Ga=Ra(sa);if(Ga){const va=Ga.xl();for(let ia=0;ia<va.length;ia++){var ta=va[ia];if(this.uvi(ta)){ta=this.Xd.getPropertyObjectIds(Ga,ta);for(let qa=0;qa<ta.length;qa++)Pa.contains(ta.J(qa))||(Da.add(ta.J(qa)),Pa.add(ta.J(qa)),this.zNf(ta.J(qa),Da,Pa,Ra))}else this.NAi(ta)&&(ta=this.Xd.getPropertyObjectId(Ga,ta),Pa.contains(ta)||(Da.add(ta),
Pa.add(ta),this.zNf(sa,Da,Pa,Ra)))}}}G5m(sa,Da,Pa,Ra,Ga){if(this.Xd.hasProperty(Pa,Ra)){Pa=this.Xd.getPropertyObjectIds(Pa,Ra);const ta=Pa.fH();Ra=Ga.fH();for(let va=0;va<Ga.length;va++)ta.contains(Ga.J(va))||sa.add(Ga.J(va));for(sa=0;sa<Pa.length;sa++)Ra.contains(Pa.J(sa))||Da.add(Pa.J(sa))}else for(Da=0;Da<Ga.length;Da++)sa.add(Ga.J(Da))}F5m(sa,Da,Pa,Ra,Ga){Ga&&(this.Xd.hasProperty(Pa,Ra)?(Pa=this.Xd.getPropertyObjectId(Pa,Ra),Ga.equals(Pa)||(sa.add(Ga),Da.add(Pa))):sa.add(Ga))}v6m(sa){k.a.instance.Ua(4535064,
1,4,"Sending merge backup. [MergeId: {0}] [Crash: {1}] [Timeout: {2}]",sa.input.HLb,sa.output.crash,sa.output.timeout)}C6m(sa,Da,Pa,Ra,Ga,ta,va){if(sa){sa=Ra.length?Ra.eg(Ra.length-1):null;var ia=Ga.length?Ga.eg(Ga.length-1):null;Pa=String.format("MergeChanges: Begin. [MergeId: {0}] [TheirChanges - Length:{1} Last:{2} Base:{3}] [YourChanges - Length:{4} Last:{5} Base:{6}] [MergeHint: {7}] [IgnoreConflictsInLastServerRevision: {8}] [MaxMergeTimeInMs: {9}] [Source: {10}]",Da.input.HLb,Ra.length,sa?
sa.id:z.a.nil,sa?sa.tX?sa.tX.id:z.a.nil:z.a.nil,Ga.length,ia?ia.id:z.a.nil,ia?ia.tX?ia.tX.id:z.a.nil:z.a.nil,ta,va,this.Mfc,Pa);switch(Da.input.source){case 5:k.a.instance.Ua(51663493,1,4,Pa);break;default:k.a.instance.Ua(4051606,1,4,Pa)}}}z6m(sa,Da,Pa){if(sa)switch(sa=this.qQc(Da,Pa,"Succeeded"),Da.input.source){case 5:k.a.instance.Ua(51663494,1,4,sa);break;default:k.a.instance.Ua(4059162,1,4,sa)}}B6m(sa,Da){Da=this.qQc(sa,Da,"Timeout");switch(sa.input.source){case 5:k.a.instance.Ua(51663495,1,4,
Da);break;default:k.a.instance.Ua(4059163,1,2,Da)}}x6m(sa,Da){Da=this.qQc(sa,Da,"Rejection");switch(sa.input.source){case 5:k.a.instance.Ua(51663496,1,4,Da);break;default:k.a.instance.Ua(4059164,1,2,Da)}}A6m(sa,Da){Da=this.qQc(sa,Da,"Crash - Rejection");switch(sa.input.source){case 5:k.a.instance.Ua(51663497,1,4,Da);break;default:k.a.instance.Ua(4059165,1,2,Da)}}y6m(sa,Da){Da=this.qQc(sa,Da,"Crash - Failed");switch(sa.input.source){case 5:k.a.instance.Ua(51663498,1,4,Da);break;default:k.a.instance.Ua(4059166,
1,2,Da)}}qQc(sa,Da,Pa){const Ra=sa.output.$M,Ga=Ra&&Ra.length?Ra.eg(Ra.length-1):null;return String.format("MergeChanges: End for [MergeId: {0}] with result {1}. [ElapsedTime: {2}ms] [Function: {3}] [MergedRevisions - Length:{4} Last:{5} Base:{6}] [Source: {7}]",sa.input.HLb,Pa,this.pFa()-sa.input.PUa,Da,Ra?Ra.length:0,Ga?Ga.id:z.a.nil,Ga?Ga.tX?Ga.tX.id:z.a.nil:z.a.nil,sa.input.source)}rcl(sa,Da,Pa,Ra,Ga,ta,va){const ia=new V.a,qa=ia.input;qa.baa=sa;qa.$Va=Da;qa.Gm=Pa;qa.Uia=Ra;qa.jIb=Ga;qa.source=
ta;qa.$Nc=va;qa.PUa=this.pFa();ia.logger.aoo(qa.PUa);sa=ia.runtime;sa.K$c=k.a.instance.R$(1,5);sa.Iie=k.a.instance.R$(1,4);let pa="";sa.eH=Fa=>{if(this.Mfc){var za=this.pFa()-qa.PUa,Oa=za>this.Mfc;pa+=String.format(" ({0}: {1})",Fa,za);Oa&&(ia.output.timeout=!0,Fa=String.format("[MergeId: {0}] Exceeded [MaxMergeTimeInMs: {1}] when we reached [Details: {2}] [Elapsed Time: {3}] [Timeline: {4}]",qa.HLb,this.Mfc,Fa,za,pa),k.a.instance.Ua(528061012,1,2,Fa),this.mKo(Fa))}};return ia}gRc(){return[Object(K.a)(this,
this.Wxn,"otherAuthorsHaveChangesToMerge"),Object(K.a)(this,this.aPm,"isInputValid"),Object(K.a)(this,this.JBm,"initializeOutputMergeState"),Object(K.a)(this,this.PXd,"initializeRuntimeMergeState"),Y.a.TFn,Object(K.a)(this,this.SFn,"preProcessTableStructure"),Object(K.a)(this.nEh,this.nEh.Acn,"mergeChildNodeLists"),Object(K.a)(this,this.jQo,"tryObjectMerge"),Y.a.yFn,Object(K.a)(this,this.oDl,"finalizeObjectMerge"),Object(K.a)(this,this.y2o,"validateMarkers"),Object(K.a)(this,this.Dtk,"addMergeResultsToOutput")]}Wxn(sa){const Da=
sa.input.baa;sa=sa.output;return Da?Da.length?!0:(k.a.instance.Ua(4051610,1,5,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),sa.$M=Da,sa.succeeded=!0,!1):(k.a.instance.Ua(4051609,1,5,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),sa.$M=Da,sa.succeeded=!0,!1)}aPm(sa){var Da=sa.input;const Pa=Da.baa,Ra=Da.$Va,Ga=Da.Gm,ta=Da.Uia;Da=Da.jIb;sa=sa.output;if(!Ra||!Ra.length)return k.a.instance.Ua(42350233,1,5,"IsInputValid: No local changes to merge."),
sa.$M=Pa,sa.succeeded=!0,!1;let va=!0;if(2!==ta&&1!==ta)return sa.$M=Pa,!1;Ga&&Ga!==z.a.nil||(va=!1);Pa.length<(Da?2:1)&&(k.a.instance.Ua(4051614,1,5,"IsInputValid: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",Da),va=!1);va||(sa.$M=2===ta?Pa:Ra);return va}PXd(sa){var Da=sa.input,Pa=Da.baa,Ra=Da.$Va,Ga=Da.Uia,ta;let va;({rmg:ta,btg:va,UDa:Da}=this.Xrf(sa,Pa,Ra,Da.jIb));if(!Da)return k.a.instance.Ua(4273301,
1,2,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",ta.id,va.id),sa.logger.Rg(Object.assign(new N.a,{yj:"InitializeRuntimeMergeState",eventId:"aqtsv",info:"Couldn't find a common base change"})),this.tLi(ta,Pa.length,"TheirChanges"),this.tLi(va,Ra.length,"YourChanges"),sa.output.$M=2===Ga?Pa:Ra,!1;sa.runtime.UDa=Da;({SRo:Pa,tBl:Ra}=this.wnl(Ga,ta,va));({TRo:Da,uBl:Ga,SJk:ta}=this.h5l(sa,Pa,Ra,Da));sa.runtime.vk=ta;sa.runtime.Nq=Da;sa.runtime.Lu=
Ga;sa.runtime.un=new v.a;sa.runtime.dOd=Ra.id;sa.runtime.Pne=Pa.id;sa.runtime.knb=new v.a;sa.runtime.wOa=new t.a;sa.runtime.lef=new v.a;sa.runtime.FCb=new v.a;sa.runtime.$kg=new v.a;sa.runtime.Qce=new Z;sa.runtime.N4d=new m.a;sa.runtime.E_f=new t.a;sa.runtime.mmc=new m.a;sa.runtime.Zb=sa.input.$Nc(sa);sa.runtime.Zb.XFc(1000001,"Microsoft.Office.WordOnline.WordTestCrossCompiledFeature","WoWor220;WoWor220cf",l.a.iJo);sa.runtime.Zb.XFc(1000005,"Microsoft.Office.WordOnline.TOCMerge","Word-TOCMerge;Word-TOCMergecf",
l.a.oLo);sa.runtime.Zb.XFc(1000008,"Microsoft.Office.WordOnline.FailOnMPALAsserts","69bca399;0362i899",l.a.cBl);sa.runtime.Zb.XFc(1000009,"Microsoft.Office.WordOnline.RemoveEditedImageUrlFromIgnoredProperties","mergeeditedimageurl;mergeeditedimageurlcf",l.a.j_n);sa.runtime.Zb.XFc(1000010,"Microsoft.Office.WordOnline.MergeLcsInfLoopFix","79ee6190;i588c310",l.a.Ncn);sa.runtime.msi=!0;H.AFrameworkApplication.K&&(this.C3g=H.AFrameworkApplication.K.mc("WordEditorGraphMergeMaxIterationsPerCycle",50));return!0}tLi(sa,
Da,Pa){const Ra=new m.a;for(;sa;)Ra.add(sa),sa=sa.tX;const Ga=new Sys.StringBuilder;Ga.append(String.format("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",Pa,Da,Ra.length));let ta=Ra.length,va=0;Ra.forEach(ia=>({Upi:ta,OLi:va}=this.qvk(Ga,ia,Ra,ta,va)).returnValue);k.a.instance.Ua(4273302,1,4,Ga.toString())}qvk(sa,Da,Pa,Ra,Ga){sa.append(String.format(" [{0} {1} {2}]",Ra,Da.Cia?"S":"B",Da.id));Ra--;Ga++;return 50<Ga&&Pa.length!==Ga?(sa.append(" ...Truncated."),{returnValue:!1,Upi:Ra,OLi:Ga}):
{returnValue:!0,Upi:Ra,OLi:Ga}}Xrf(sa,Da,Pa,Ra){Da=Da.eg(Da.length-1-(Ra?1:0));Pa=Pa.eg(Pa.length-1);Ra=Da.o2a(Pa);sa.runtime.eH("GetCommonBase");sa.logger.Pia("GetCommonBase");return{rmg:Da,btg:Pa,UDa:Ra}}h5l(sa,Da,Pa,Ra){let Ga,ta;({result:Ga}=Da.Ufc(Ra));sa.runtime.eH("GetUnfavoredChanges");sa.logger.Pia("GetUnfavoredChanges");({result:ta}=Pa.Ufc(Ra));5===sa.input.source&&(sa.runtime.xBl=S.a.fgi(Pa),sa.runtime.VRo=S.a.fgi(Da));sa.runtime.eH("GetFavoredChanges");sa.logger.Pia("GetFavoredChanges");
Da=new F.a(Object(K.a)(Ra,Ra.O2a,"getMergeableObject"));sa.runtime.eH("GetModifiedObjects");sa.logger.Pia("GetModifiedObjects");return{TRo:Ga,uBl:ta,SJk:Da}}wnl(sa,Da,Pa){2===sa?(sa=Da,Da=Pa):sa=Pa;return{SRo:Da,tBl:sa}}JBm(sa){const Da=sa.input,Pa=Da.baa,Ra=Da.$Va;sa.output.$M=(2===Da.Uia?Pa:Ra).R5();sa.runtime.eH("InitializeOutputMergeState");sa.logger.Pia("InitializeOutputMergeState");return!0}Dtk(sa){var Da=sa.input.Gm;const Pa=sa.runtime.un,Ra=sa.output.$M;Da=this.scl(sa,Ra.eg(Ra.length-1),Da,
z.a.create());this.NCl(sa,Da,Pa);Ra.add(Da);return sa.output.succeeded=!0}scl(sa,Da,Pa,Ra){sa.runtime.Iie&&k.a.instance.Ua(4051616,1,4,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",Pa,Ra);sa=this.c9n(Ra);sa.qKk(Da,Pa);return sa}NCl(sa,Da,Pa){sa.runtime.Iie&&k.a.instance.Ua(4059167,1,4,"FillRevision: Adding {0} objects to merged revision.",Pa.count);Pa.forEach((Ra,Ga)=>{Da.Uuk(Ga.Fm);return!0})}dKb(sa){if(!sa)return k.a.instance.Ua(573957952,1,2,"Feature helper is null"),
!1;sa.Ux(106);return sa.isFeatureEnabled(106)}SFn(sa){if(!this.dKb(sa.runtime.Zb))return!0;const Da=sa.runtime.Lu,Pa=sa.runtime.Nq,Ra=sa.runtime.vk;let Ga=!0;Da.forEach((ta,va)=>{393252===va.Qc&&(Ga=this.t3i(sa,ta,va,Ra,Da));return Ga});if(!Ga)return!1;Pa.forEach((ta,va)=>{393252===va.Qc&&(Ga=this.t3i(sa,ta,va,Ra,Pa));return Ga});sa.logger.Pia("PreProcessTableStructure");return Ga}t3i(sa,Da,Pa,Ra,Ga){const ta=null==this.Xd.getPropertyBool(Pa,e.a.ghostCell)?!1:this.Xd.getPropertyBool(Pa,e.a.ghostCell),
va=null==this.Xd.getPropertyUint32(Pa,e.a.rowSpan)?1:this.Xd.getPropertyUint32(Pa,e.a.rowSpan),ia=null==this.Xd.getPropertyUint32(Pa,e.a.colSpan)?1:this.Xd.getPropertyUint32(Pa,e.a.colSpan);if(ta)return!0;var qa=Ra.J(Da);if(qa){Ra=null==this.Xd.getPropertyBool(qa,e.a.ghostCell)?!1:this.Xd.getPropertyBool(qa,e.a.ghostCell);var pa=null==this.Xd.getPropertyUint32(qa,e.a.rowSpan)?1:this.Xd.getPropertyUint32(qa,e.a.rowSpan);var Fa=null==this.Xd.getPropertyUint32(qa,e.a.colSpan)?1:this.Xd.getPropertyUint32(qa,
e.a.colSpan);Ra=Ra!==ta;pa=pa!==va;Fa=Fa!==ia}else Fa=pa=Ra=!0;const za=ka.e(sa,Pa,Ga);if(za.equals(z.a.nil))return k.a.instance.Ua(573957953,1,2,"Table cell's containing table node id could not be found. Table Cell ID: {0}",Da),sa.logger.Rg(Object.assign(new ha.a,{info:"Table Cell's containing table node ID could not be found"})),!1;let Oa=sa.runtime.FCb.J(za);Oa||(sa.runtime.FCb.Z(za,new v.a),Oa=sa.runtime.FCb.J(za));let xa=Oa.J(Da),fa=new m.a;const Ka=new m.a,lb=new m.a;Ra&&(xa||(fa=this.Xd.getPropertyObjectIds(Pa,
a.a.gf)));if(pa||Fa)if(xa){if(xa.hg)return k.a.instance.Ua(573957961,1,4,"Table cell has conflicting ghostcell properties we are not handling"),sa.logger.Rg(Object.assign(new ha.a,{info:"A table cell is ghost in one revision while non-ghost in another."})),!1;if(null!=xa.rowSpan&&va!==xa.rowSpan||null!=xa.colSpan&&ia!==xa.colSpan)return k.a.instance.Ua(573957962,1,4,"Same table cell has different rowSpan/colSpan in conflicting revisions"),sa.logger.Rg(Object.assign(new ha.a,{info:"A table cell has different rowSpan/colSpan in the conflicting revisions"})),
!1}else{var Xa;({rowIndex:Pa,W4b:Xa}=ka.b(sa,Ga,Pa));if(-1===Pa||-1===Xa)return k.a.instance.Ua(573957954,1,2,"Table cell location could not be found. Table Cell ID: {0}",Da),sa.logger.Rg(Object.assign(new ha.a,{info:"Table cell location could not be found"})),!1;for(var kb=Pa;kb<Pa+va;kb++)for(var Bb=Xa;Bb<Xa+ia;Bb++){var Ja=ka.c(sa,za,kb,Bb);if(Ja.equals(z.a.nil))return k.a.instance.Ua(573957955,1,4,"Other revision deleted the table cells this revision is trying to merge"),sa.logger.Rg(Object.assign(new ha.a,
{info:"Ghost cell not found in the table bounds"})),!1;var Ma=Ga.Fz(Ja,sa.runtime.vk.J(Ja));if(!Ma)return k.a.instance.Ua(573957956,1,4,"Other revision has inserted cells in between the cells this revision is trying to merge"),sa.logger.Rg(Object.assign(new ha.a,{info:"Newly inserted cell in another revision cannot be merged with the cell in current revision"})),!1;if(!Ja.equals(Da)){if(null==this.Xd.getPropertyBool(Ma,e.a.ghostCell)||!this.Xd.getPropertyBool(Ma,e.a.ghostCell))return k.a.instance.Ua(573957957,
1,4,"Other revision deleted some of the cells this revision is trying to merge"),sa.logger.Rg(Object.assign(new ha.a,{info:"Cannot merge a non-ghost cell with the controlling cell"})),!1;var fb=Oa.J(Ja);if(fb)return k.a.instance.Ua(573957958,1,4,"The ghost cell is already merged with some other cells in the other revision"),sa.logger.Rg(Object.assign(new ha.a,{info:"Ghost cell is already merged with some other cell"})),!1;Ka.add(Ja);fb=new ea;fb.hg=!0;Ma=this.Xd.getPropertyUint32(Ma,e.a.colSpan);
null!=Ma&&(fb.colSpan=Ma);Oa.Z(Ja,fb)}}if(qa&&(null==this.Xd.getPropertyBool(qa,e.a.ghostCell)||!this.Xd.getPropertyBool(qa,e.a.ghostCell))&&(Ga=null==this.Xd.getPropertyUint32(qa,e.a.rowSpan)?1:this.Xd.getPropertyUint32(qa,e.a.rowSpan),Pa=null==this.Xd.getPropertyUint32(qa,e.a.colSpan)?1:this.Xd.getPropertyUint32(qa,e.a.colSpan),Ga>va||Pa>ia)){kb=Xa=-1;({rowIndex:Xa,W4b:kb}=ka.a(sa,null,qa,Xa,kb));if(-1===Xa||-1===kb)return k.a.instance.Ua(573957959,1,2,"Table cell location could not be found in base revision. Table Cell ID: {0}",
Da),sa.logger.Rg(Object.assign(new ha.a,{info:"Table cell location could not be found in base revision, although the object is present itself"})),!1;qa=Ka.fH();for(Bb=Xa;Bb<Xa+Ga;Bb++)for(Ja=kb;Ja<kb+Pa;Ja++){fb=ka.d(sa,null,za,Bb,Ja);if(!fb)return k.a.instance.Ua(573957960,1,2,"Table cell could not be found within table bounds"),sa.logger.Rg(Object.assign(new ha.a,{info:"Ghost cell not found in the table bounds"})),!1;fb.id.equals(Da)||qa.contains(fb.id)||lb.add(fb.id)}}}!xa&&(Ra||pa||Fa)&&(k.a.instance.Ua(573957963,
1,4,"Adding cell info structure to the ComplexTableStructure Dictionary for table cell id: {0}",Da),xa=new ea,xa.rowSpan=va,xa.colSpan=ia,xa.hg=ta,xa.A6d=fa,xa.Hwf=Ka,xa.XTf=lb,Oa.add(Da,xa));return!0}jQo(sa){return this.ZCj(sa,!1)}oDl(sa){return this.ZCj(sa,!0)}ZCj(sa,Da){const Pa=sa.runtime,Ra=Pa.vk,Ga=Pa.Lu,ta=Da?Pa.lef:Pa.Nq,va=Pa.un;let ia=!0;const qa=sa.runtime.K$c;let pa=0,Fa=0,za=0;ta.forEach((Oa,xa)=>{qa&&k.a.instance.Ua(4051617,1,5,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]",
Oa,xa.Qc,Da);Fa++;this.C3g===Fa&&(pa++,sa.runtime.eH(String.format("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}] [Finalize: {2}]",pa,za,Da)),Fa=0);if(sa.runtime.Zb&&sa.runtime.Zb.Jjb(1000005)&&sa.runtime.mmc.contains(xa.id,(lb,Xa)=>lb.equals(Xa))||this.Hzo(xa.Qc))return!0;if(!Da&&this.Wjl(xa.Qc,sa.runtime.Zb))return Pa.lef.Z(Oa,xa),!0;var fa=Ga.get(Oa);if(!fa)return va.nb(Oa)?va.J(Oa).$Oi(xa):va.Z(Oa,new ba.a(xa,!1)),!0;if(!Ra.J(Oa)&&!this.pdn(fa.Qc)){var Ka=!!sa.input.baa&&!!sa.input.baa.last()&&
sa.input.baa.last().W4(Oa);const lb=!!sa.input.$Va&&!!sa.input.$Va.last()&&sa.input.$Va.last().W4(Oa),Xa=new Q.a(fa,xa);if(!Xa.AY)return va.Z(Oa,new ba.a(fa,!1)),!0;k.a.instance.Ua(4051618,1,2,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]. Object wasn't in base revision, but was in conflict and favored. [ReferencedInFavored: {3}] [ReferencedInUnfavored: {4}] [Identical: {5}] [Source: {6}].",Oa,xa.Qc,Da,Ka,lb,!Xa.AY,sa.input.source);sa.logger.Rg(Object.assign(new N.a,{yj:"GraphMerger.TryObjectMerge",
eventId:"ap3k8"}));return ia=!1}Ka=va.Fz(Oa,new ba.a(Ra.J(Oa)));({gl:fa,returnValue:ia}=this.Pmm.merge(sa,this.Ili,this.Xd,Ka,fa,xa));za++;ia&&(sa.runtime.eH(String.format("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}] [Finalize: {4}]",Oa,xa.Qc,za,pa,Da)),fa&&(va.nb(fa.Fm.id)?va.J(fa.Fm.id).$Oi(fa.Fm):va.Z(fa.Fm.id,fa)));return ia});sa.logger.Pia("ObjectMerge");qa&&k.a.instance.Ua(4059168,1,5,"TryObjectMerge: Merged {0} objects. {1} were complex merges, finalize: {2}.",ta.count,
za,Da);return ia}y2o(sa){try{for(let Da=0;Da<sa.runtime.N4d.length;Da++){const Pa=sa.runtime.N4d.J(Da);if(sa.runtime.un.J(Pa)){if(!this.pQm(sa,Pa))return!1}else k.a.instance.Ua(527034192,1,2,"ValidateMerge: Couldn't find merged node to verify");sa.runtime.eH("Validate markers taking too long")}}catch(Da){k.a.instance.Ua(559535579,1,2,"ValidateMerge threw an exception: {0}",Da)}return sa.logger.h0c.Eni()?!1:!0}Juo(sa){return 38===sa||39===sa||40===sa||41===sa||44===sa||45===sa||33===sa||34===sa?!1:
!0}u4l(sa){switch(sa){case 38:case 39:case 40:case 41:return e.a.me;case 44:case 45:return e.a.pEd;case 33:case 34:return e.a.Lj}return G.CommonProperties.nil}x2o(sa,Da){const Pa=this.Xd.getPropertyUint32(sa,e.a.Qs);if(!Pa||this.Juo(Pa))return!0;sa=this.Xd.getPropertyObjectId(sa,this.u4l(Pa));return ua.T9b(Da,sa)?!0:(Da.logger.h0c.zYd=Pa,!1)}pQm(sa,Da){if(sa.runtime.E_f.contains(Da))return!1;if(Da=ua.T9b(sa,Da)){Da=this.Xd.getPropertyObjectIds(Da,a.a.Sn);for(let Pa=0;Pa<Da.length;Pa++){const Ra=ua.T9b(sa,
Da.eg(Pa));if(Ra&&!this.x2o(Ra,sa))return!1}}return!0}Hzo(sa){switch(sa){case 1074135137:case 1074135138:case 1074135139:case 1074135140:case 131162:case 4325465:return!0}return!1}Wjl(sa,Da){let Pa=!1;if(1074135145===sa)return!0;Da&&Da.Ux(123);Da&&Da.isFeatureEnabled(123)&&1074135153===sa&&(Pa=!0);return Pa}pdn(sa){switch(sa){case 1074135162:return!0}return!1}Hel(sa,Da){const Pa=new m.a,Ra=new m.a,Ga=new m.a;var ta=sa.runtime.UDa;const va=ta?ta.id:z.a.nil;this.xLf(ta).forEach(ia=>{Pa.add(Da(ia));
return!0});ta=sa.input.baa.eg(sa.input.baa.length-1);this.xLf(ta,va).forEach(ia=>{Ra.add(Da(ia));return!0});sa=sa.input.$Va.eg(sa.input.$Va.length-1);this.xLf(sa,va).forEach(ia=>{Ga.add(Da(ia));return!0});return{RJk:Pa,PJo:Ra,Q8o:Ga}}xLf(sa,Da=null){const Pa=new m.a;Da||(Da=z.a.nil);for(;sa&&!Da.equals(sa.id);)Pa.add(sa),sa=sa.tX;Pa.reverse();return Pa}UFo(sa){const Da=3===this.GVd;let Pa=!1;!sa.output.succeeded&&(2===this.GVd||sa.output.crash&&1===this.GVd)&&(Pa=!0);let Ra=!1;sa.input.baa&&0<sa.input.baa.length&&
(Da||Pa)&&sa.runtime.Lu&&sa.runtime.vk&&sa.runtime.Zb&&(Ra=sa.runtime.Zb.isFeatureEnabled(52));return Ra}uvi(sa){return 9===L.a.Bjb(L.a.Zmf(sa))}NAi(sa){return 8===L.a.Bjb(L.a.Zmf(sa))}static WZl(sa){return sa.output.crash?2:sa.output.succeeded?3:1}static T9b(sa,Da){if(!Da||Da===z.a.nil)return null;const Pa=sa.runtime.un.J(Da);return Pa?Pa.Fm:sa.runtime.vk.J(Da)}}ua.EVd=z.a.If("{0B310978-27EA-4A49-A620-7E588CFE64C6}{1}");Object(D.a)(ua,"GraphMergerBase",null,[1378])},1804:function(D,I,c){D=c(0);var l=
c(225),e=c(1657),a=c(188),k=c(1569);class x extends e.a{constructor(m,t,z,v,H,F,G,M,K,L,R,S,N,O){super(m,3,t,z,v,H,F,M,K,L,R,S,N,O);this.Nve=G}get character(){return this.Nve}get text(){return this.character.toString()}k$c(){throw a.a.notImplemented();}toString(){return String.format("{0}",super.toString())}p9b(){return"CharRun"}clone(){return new x(this.oGc,this.source,this.Pj,this.Bg,this.runId,this.wJ,this.character,this.inb,this.DRa,this.Kca,this.NFa,this.qTa,this.KF,this.mu)}JA(m,t,z,v=!1){return super.JA(m,
t,z,v)?m.character===this.character?!0:k.a.Avh(m.character,this.character):!1}}Object(D.a)(x,"CharRunMergeBlock",e.a,[]);c.d(I,"a",function(){return y});class y extends e.a{constructor(m,t,z,v,H,F,G,M,K,L,R,S,N,O,W){super(m,1,t,z,v,H,F,M,L,R,S,N,O,W);this._text=G;this.NUe=K}get text(){return this._text}k$c(m){this._text=m}get D8a(){return this.NUe&&this._text&&this._text.length?!0:!1}toString(){return String.format("{0} [SupportsSplit: {1}]",super.toString(),this.NUe)}p9b(){return"TextRun"}clone(){return new y(this.oGc,
this.source,this.Pj,this.Bg,this.runId,this.wJ,this._text,this.inb,this.NUe,this.DRa,this.Kca,this.NFa,this.qTa,this.KF,this.mu)}JA(m,t,z,v=!1){return super.JA(m,t,z,v)?k.a.zvh(this._text,m._text):!1}Iad(){const m=new l.a;for(let z=0;z<this.text.length;z++){var t=k.a.charAt(this._text,z);if(k.a.JVm(k.a.$Ko(t))){let v="";v+=t;t=k.a.charAt(this._text,++z);v+=t;t=new y(this.oGc,this.source,this.Pj,this.Bg,this.runId,this.wJ,v,this.inb,!1,this.DRa,this.Kca,this.NFa,this.qTa,this.KF,this.mu);m.add(t)}else t=
new x(this.oGc,this.source,this.Pj,this.Bg,this.runId,this.wJ,t,this.inb,this.DRa,this.Kca,this.NFa,this.qTa,this.KF,this.mu),m.add(t)}return m}}Object(D.a)(y,"TextRunMergeBlock",e.a,[])},1805:function(D,I,c){D=c(0);var l=c(249),e=c(16),a=c(6),k=c(119),x=c(816),y=c(183),m=c(225),t=c(367),z=c(1514);class v{constructor(G,M,K){this.position=G;this.leader=M;this.val=K}equals(G){return this.position===G.position&&this.leader===G.leader&&this.val===G.val}toString(){return this.position.toString()}}Object(D.a)(v,
"TabStop",null,[]);var H=c(1900);c.d(I,"a",function(){return F});class F extends z.a{constructor(){super()}get Yn(){return 20}get yA(){return 0}xk(){const G=super.xk();G.Z(x.a.Ab(e.a.wo),1);G.Z(x.a.Ab(e.a.Sn),1);G.Z(x.a.Ab(e.a.Jm),1);G.Z(x.a.Ab(a.a.nt),1);G.Z(x.a.Ab(a.a.vq),1);G.Z(x.a.Ab(a.a.Wc),1);G.Z(x.a.Ab(e.a.Iqb),1);G.Z(x.a.Ab(a.a.tQa),1);G.Z(x.a.Ab(a.a.aIa),1);G.Z(x.a.Ab(e.a.pya),1);G.Z(x.a.Ab(a.a.kGa),1);G.Z(x.a.Ab(a.a.eha),1);G.Z(x.a.Ab(a.a.lGa),1);G.Z(x.a.Ab(a.a.AEa),1);G.Z(x.a.Ab(a.a.mGa),
1);G.Z(x.a.Ab(a.a.BEa),1);G.Z(x.a.Ab(a.a.$Ha),1);G.Z(x.a.Ab(a.a.DJa),1);G.Z(x.a.Ab(a.a.EJa),1);G.Z(x.a.Ab(a.a.hAa),1);G.Z(x.a.Ab(a.a.Iv),1);G.Z(x.a.Ab(a.a.Oz),1);G.Z(x.a.Ab(a.a.Pz),1);G.Z(x.a.Ab(a.a.Bw),1);G.Z(x.a.Ab(k.a.QJ),6);G.Z(x.a.Ab(k.a.VVa),6);G.Z(x.a.Ab(a.a.rCb),7);G.Z(x.a.Ab(k.a.QJ),6);G.Z(x.a.Ab(a.a.kuj),2);G.Z(x.a.Ab(k.a.q5k),2);G.Z(x.a.Ab(k.a.bAn),2);G.Z(x.a.Ab(a.a.coc),2);G.Z(x.a.Ab(a.a.Bcd),2);G.Z(x.a.Ab(a.a.vSb),2);G.Z(x.a.Ab(a.a.Y8a),2);G.Z(x.a.Ab(a.a.Ccd),2);G.Z(x.a.Ab(a.a.Dcd),2);
G.Z(x.a.Ab(a.a.SMf),2);G.Z(x.a.Ab(a.a.listID),3);G.Z(x.a.Ab(a.a.listLevel),3);return G}oC(G,M){if(M===x.a.Ab(e.a.wo)||M===x.a.Ab(e.a.Sn)||M===x.a.Ab(e.a.Jm)||M===x.a.Ab(a.a.nt)||M===x.a.Ab(a.a.vq)||M===x.a.Ab(a.a.Wc)||M===x.a.Ab(e.a.Iqb)||M===x.a.Ab(a.a.tQa)||M===x.a.Ab(a.a.aIa)||M===x.a.Ab(e.a.pya)||M===x.a.Ab(a.a.kGa)||M===x.a.Ab(a.a.eha)||M===x.a.Ab(a.a.lGa)||M===x.a.Ab(a.a.AEa)||M===x.a.Ab(a.a.mGa)||M===x.a.Ab(a.a.BEa)||M===x.a.Ab(a.a.$Ha)||M===x.a.Ab(a.a.DJa)||M===x.a.Ab(a.a.EJa)||M===x.a.Ab(a.a.hAa)||
M===x.a.Ab(a.a.Iv)||M===x.a.Ab(a.a.DN)){var K=G.En.value.tu,L=G.En.value.xf;M=G.Ng.value.xf;if(G.uq.runtime.wOa.contains(K.id))return y.a.instance.Ua(18989579,1,4,"ParagraphNodeComplexMerge: Skipping merge for [Paragraph: {0}] as it was already merged during ChildNodeListMerge.",K.id),!0;if(G.uq.runtime.Zb.Jjb(1000005)&&this.Pzo(G,M,L))return G.gl=M.XK(),F.gph(G),F.eCd(G.uq,G.Xd,L),!0;const R=new m.a;R.add(K);K=new m.a;K.add(L);L=new m.a;L.add(M);if(!({un:M}=F.cDj(G.uq,R,L,K)).returnValue)return G.csg=
!0,G.gl=null,!1;F.gph(G);G.gl=M.eg(0).Fm;return!0}return M===x.a.Ab(a.a.Oz)||M===x.a.Ab(a.a.Pz)||M===x.a.Ab(a.a.Bw)?(this.YOo(G),G.og.add(x.a.Ab(a.a.Oz)),G.og.add(x.a.Ab(a.a.Pz)),G.og.add(x.a.Ab(a.a.Bw)),!0):!1}Pzo(G,M,K){M=G.Xd.getPropertyString(M,a.a.DN);G=G.Xd.getPropertyString(K,a.a.DN);return M||G?!0:!1}YOo(G){const M=G.Xd,K=G.gl;var L=G.En.value.xf,R=G.Ng.value.xf;G=this.Vpf(G.En.value.tu,M);R=this.Vpf(R,M);L=this.Vpf(L,M);({sdn:L,tdn:G,udn:R}=this.O4l(G,R,L));L.length?(M.setPropertyUint32s(K,
a.a.Bw,L),M.setPropertyUint32s(K,a.a.Oz,G),M.setPropertyUint32s(K,a.a.Pz,R)):this.WZn(K)}Vpf(G,M){const K=M.getPropertyUint32s(G,a.a.Bw),L=M.getPropertyUint32s(G,a.a.Oz);G=M.getPropertyUint32s(G,a.a.Pz);M=new m.a;if(!K)return M;for(let R=0;R<K.length;++R)M.add(new v(K.J(R),L.J(R),G.J(R)));return M}O4l(G,M,K){({r_i:M,s_i:N,t_i:S}=this.E8h(G,M));let L,R;({r_i:K,s_i:L,t_i:R}=this.E8h(G,K));G=this.uom(G,N,S,L,R);var S=this.tom(G,M,K);G=new m.a;M=new m.a;var N=new m.a;for(K=0;K<S.length;++K)G.add(S.J(K).position),
M.add(S.J(K).leader),N.add(S.J(K).val);return{sdn:G,tdn:M,udn:N}}E8h(G,M){let K,L,R;K=new m.a;L=new t.a;R=new t.a;let S,N;for(S=N=0;S<G.length&&N<M.length;)G.J(S).position===M.J(N).position?(G.J(S).equals(M.J(N))||R.Z(G.J(S).position,M.J(N)),++S,++N):G.J(S).position<M.J(N).position?(L.Z(G.J(S).position,G.J(S)),++S):(K.add(M.J(N)),++N);for(;S<G.length;)L.Z(G.J(S).position,G.J(S)),++S;for(;N<M.length;)K.add(M.J(N)),++N;return{r_i:K,s_i:L,t_i:R}}uom(G,M,K,L,R){const S=new m.a;for(let N=0;N<G.length;++N){const O=
G.J(N).position;M.nb(O)||(K.nb(O)?S.add(K.J(O)):L.nb(O)||(R.nb(O)?S.add(R.J(O)):S.add(G.J(N))))}return S}tom(G,M,K){M=this.YOi(M,K);return this.YOi(G,M)}YOi(G,M){const K=new m.a;let L,R;for(L=R=0;L<G.length&&R<M.length;)G.J(L).position<=M.J(R).position?(K.add(G.J(L)),G.J(L).position===M.J(R).position&&++R,++L):K.add(M.J(R++));for(;L<G.length;)K.add(G.J(L++));for(;R<M.length;)K.add(M.J(R++));return K}WZn(G){G.removeProperty(a.a.Bw);G.removeProperty(a.a.Oz);G.removeProperty(a.a.Pz)}static mh(){return new F}static get instance(){return F.Pg.value}static gph(G){G.og.add(x.a.Ab(e.a.wo));
G.og.add(x.a.Ab(e.a.Sn));G.og.add(x.a.Ab(e.a.Jm));G.og.add(x.a.Ab(a.a.nt));G.og.add(x.a.Ab(a.a.vq));G.og.add(x.a.Ab(a.a.Wc));G.og.add(x.a.Ab(e.a.Iqb));G.og.add(x.a.Ab(a.a.tQa));G.og.add(x.a.Ab(a.a.aIa));G.og.add(x.a.Ab(e.a.pya));G.og.add(x.a.Ab(a.a.kGa));G.og.add(x.a.Ab(a.a.eha));G.og.add(x.a.Ab(a.a.lGa));G.og.add(x.a.Ab(a.a.AEa));G.og.add(x.a.Ab(a.a.mGa));G.og.add(x.a.Ab(a.a.BEa));G.og.add(x.a.Ab(a.a.$Ha));G.og.add(x.a.Ab(a.a.DJa));G.og.add(x.a.Ab(a.a.EJa));G.og.add(x.a.Ab(a.a.hAa));G.og.add(x.a.Ab(a.a.Iv));
G.og.add(x.a.Ab(a.a.DN))}static cDj(G,M,K,L){return(new H.a(G,M,K,L)).noc()}static eCd(G,M,K){K=M.getPropertyObjectIds(K,e.a.Sn);for(let R=0;R<K.length;R++){var L=G.runtime.Nq.J(K.eg(R));if(L&&(L=M.getPropertyObjectId(L,a.a.me))){G.runtime.mmc.add(L);break}}}}F.Pg=new l.a(F.mh);Object(D.a)(F,"ParagraphNodeComplexMerge",z.a,[])},1806:function(D,I,c){D=c(0);var l=c(75),e=c(1522),a=c(1652),k=c(1570),x=c(1540),y=c(1587),m=c(1524),t=c(1527),z=c(1526),v=c(1520),H=c(1519);class F{constructor(Y){this.fc=
Y;this.hyd=this.fvf()}oL(){return"Add-ins"}BU(){return 0===this.fc.hv?0:1===this.fc.hv?1:3}dI(Y,ba){Y=new z.a(Y);ba.resultsUpdated(Y)}Rjb(Y,ba,Z){let ea;ea=this.fc.XP?new t.a(29):new t.a(27);ea.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;Z&&this.qyo(Y.Gg,ba,ea)}qyo(Y,ba,Z){const ea=[];let ha;ha=this.fc.MHm?this.fc.XP&&this.fc.hfb?H.a.Kib(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,Y)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,Y):
this.fc.NHm?this.fc.XP&&this.fc.hfb?H.a.Kib(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,Y)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,Y):this.fc.XP&&this.fc.hfb?H.a.Kib(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,Y)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,Y);this.fc.bxa?(v.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",ha)),v.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",
Y))):(ea.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",ha)),ea.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",Y)),appChrome.api.dispatch(ea));Z.Uw(new m.a("LaunchAddinDialogFromTellMe",29));ba.dv(Z)}fvf(){const Y=[];this.fc.VYd&&Array.add(Y,"Addin");return Y}}Object(D.a)(F,"AddinStoreResultsProvider",null,[1112]);var G=c(1756),M=c(1559),K=c(1571),L=c(1757),R=c(1795),S=c(1758),N=c(1586),O=c(2),W=c(34),V=c(139);c.d(I,"a",function(){return Q});class Q{constructor(Y,
ba,Z){this.Tdb=this.mDc=this.nDc=this.oxd=!1;this.BQ=null;this.M2=-1;this.JZa=this.fEc=this.hga=this.Azb=null;this.Q4g=this.Z4g=0;this.fc=Y;const ea=H.a.Lpa();this.Vab=ba||[];this.$f=O.AFrameworkApplication.He;this.Lgh=Y.yZf;this.oDc=Y.xZf;this.mxd=ea&&this.ZQb();this.nxd=ea&&this.$Qb();this.Ngh=ea&&this.aRb();this.qxd=this.cRb();this.bTe=this.Mlc();if((ba=Y.gkg&&H.a.Zfg(Y))||Y.kha)this.Azb=new R.a(Y),this.oxd=Y.Gbd;ba&&(this.nDc=Y.Ibd,this.mDc=Y.Rlb,this.Tdb=this.oxd&&this.nx("File")||this.nDc&&
this.nx("People")||this.mDc&&this.nx("Notes"));this.lxd=this.huo();this.qDc=Y.M2c;this.pxd=this.Buo();this.aTe=this.guo();this.q0b=this.Cie();this.naa=this.Chm();this.jMg=new G.a(Y);this.J6j=new L.a(Y);this.qmk=new S.a(Y);this.sVj=new F(Y);this.gCc=Z;this.Zyb=new a.a;this.qDc&&(this.jMg=new G.a(Y));Y.kha&&(this.aTe=this.pxd=this.qDc=this.Tdb=this.mDc=this.nDc=this.bTe=this.qxd=this.Ngh=this.nxd=this.mxd=this.oDc=!1,O.AFrameworkApplication.K&&this.nx("File")&&this.Erj()||this.q0b)&&(Y=this.Zyb.Qvf("Search",
O.AFrameworkApplication.K.kb("TellMeServiceAuthEndpointForSearch")),this.bOc(Y,"TellMeService",!0),Y=this.Zyb.Qvf("SmartLookup",O.AFrameworkApplication.K.kb("SmartLookupShredderServiceEndpoint")),this.bOc(Y,"Shredder",!1));O.AFrameworkApplication.K&&this.Tdb&&this.nx("File")&&this.Erj()&&(Y=this.Zyb.Qvf("Search",O.AFrameworkApplication.K.kb("TellMeServiceAuthEndpointForSearch")),this.bOc(Y,"TellMeService",!0))}nx(Y){return Array.contains(this.Vab,Y)?!0:!1}oL(){return"TellMeService"}BU(){return 0===
this.fc.hv?0:1===this.fc.hv?1:this.nx("Command")||this.nx("Recommended")?2:3}zhm(Y){let ba="";if(!Y&&this.nx("Command")&&this.fc.vGf){ba+="CommandSearch_DLIS,";var Z=this.fc.Tyj;0<Z.length&&(ba+=Z+",")}Y&&this.nx("Recommended")&&this.oDc&&(Z=this.Glm(),0<Z.length&&(ba+=Z+","));!Y&&this.nx("Help")&&(Y=this.fc.Syj,0<Y.length&&(ba+=Y+","));this.fc.kha&&this.JZa&&0<this.JZa.length&&(ba+="IsRecallEnabled_true,");(this.fc.J7b||this.fc.FMd||this.fc.kha)&&this.Tdb&&(ba+="IsGenerateSlidesEnabled_true,");0<
ba.length&&(ba=ba.substr(0,ba.length-1));return ba}bOc(Y,ba,Z){const ea=Z?this.Z4g:this.Q4g;if(!ea||window.performance.now()-ea>=H.a.T8a)if(Y)Z?this.Z4g=window.performance.now():this.Q4g=window.performance.now(),Y.then(ha=>{Z?this.fEc=ha:(this.JZa=ha,v.TellMeActor.instance.Vhg=ha)},ha=>{v.TellMeActor.instance.Oe.onError("TellMeServiceProvider:FetchTokenForService_"+ba,"tellMeServiceToken promise rejected: "+ha)});else if(v.TellMeActor.instance.Oe)v.TellMeActor.instance.Oe.onError("TellMeServiceProvider:FetchTokenForService_"+
ba,"undefined token promise")}dI(Y,ba,Z,ea=e.a.tellMe,ha=null){const ka=new z.a(Y);Z=H.a.FR(Y);this.nx("File")&&(this.Tdb||this.fc.kha)&&this.bOc(this.Zyb.Dhm(),"TellMeService",!0);(this.nx("File")&&this.fc.kha||this.nx("ActionAI")&&this.q0b)&&this.bOc(this.Zyb.Aem(),"Shredder",!1);var ua=this.Tdb&&!!this.fEc;const sa=this.fc.kha&&!!this.JZa;var Da=ua||sa||Z&&this.nx("Recommended")&&this.oDc;ua=ua||sa||!Z&&(this.Lgh&&this.nx("Command")||this.mxd&&this.nx("Answer")||this.nxd&&this.nx("Definition")||
this.bTe&&this.nx("Image")||this.qDc&&this.nx("Help")||this.qxd&&this.nx("WolframAnswer")||this.pxd&&this.nx("Template")||this.aTe&&this.nx("Addin"));if(Da||ua)if(this.hga=ea,ea={"Content-Type":"application/json",Accept:"application/json"},ea["X-Office-Version"]=O.AFrameworkApplication.buildVersion,ea["X-Office-Application"]=O.AFrameworkApplication.K.kb("Application"),ea["X-Office-Platform"]="WAC",ea["X-TellMe-SqmUserId"]=O.AFrameworkApplication.K.kb("LoggableUserId")||"",ea["X-TellMe-SessionId"]=
v.TellMeActor.instance.SUd(),this.fEc&&(ea.Authorization="Bearer "+this.fEc),this.JZa&&0<this.JZa.length&&(ea["X-TellMe-ShredderToken"]="Bearer "+this.JZa),Da=this.zhm(Z),0<Da.length&&(ea["X-TellMe-Flights"]=Da),Da=[],!Z&&this.nx("Answer")&&this.mxd&&(ha?Array.contains(ha,9):1)&&Array.add(Da,"Answer"),!Z&&this.nx("Command")&&this.Lgh&&!M.CommandResultsUtility.RDf(Y.Gg)&&(ha?Array.contains(ha,17):1)&&Array.add(Da,"Command"),!Z&&this.nx("Definition")&&this.nxd&&(ha?Array.contains(ha,10):1)&&Array.add(Da,
"Definition"),!Z&&this.nx("Help")&&this.qDc&&(ha?Array.contains(ha,8):1)&&Array.add(Da,"Help"),!Z&&this.nx("WolframAnswer")&&this.qxd&&(ha?Array.contains(ha,12):1)&&Array.add(Da,"WolframAnswer"),Z&&this.nx("Recommended")&&this.oDc&&!v.TellMeActor.instance.ged&&(ha?Array.contains(ha,18):1)&&Array.add(Da,"Recommended"),!Z&&this.nx("Image")&&this.bTe&&(ha?Array.contains(ha,19):1)&&Array.add(Da,"Image"),this.fEc&&this.Tdb&&(ha?Array.contains(ha,14)||Array.contains(ha,15)||Array.contains(ha,20):1)&&(this.Azb.pza(),
this.oxd&&this.nx("File")&&Array.add(Da,"File"),this.nDc&&this.nx("People")&&Array.add(Da,"People"),this.mDc&&this.nx("Notes")&&Array.add(Da,"Notes")),this.JZa&&0<this.JZa.length&&this.fc.kha&&(ha?Array.contains(ha,15):1)&&(this.Azb.pza(),this.nx("File")&&Array.add(Da,"File")),!Z&&this.nx("Template")&&this.pxd&&(ha?Array.contains(ha,23):1)&&Array.add(Da,"Template"),!Z&&this.nx("Addin")&&this.aTe&&(ha?Array.contains(ha,27):1)&&Array.add(Da,"Addin"),!Z&&this.nx("ActionAI")&&this.q0b&&(ha?Array.contains(ha,
25):1)&&Array.add(Da,"ActionAI"),Da.length){ea["X-TellMe-SuggestionTypes"]=Da.join(",");ea["X-TellMe-Culture"]=O.AFrameworkApplication.uiCulture;ea["X-TellMe-ProcessSessionId"]=O.AFrameworkApplication.userSessionId;var Pa=this.BQ=V.a.create().toString();ea["Client-Request-Id"]=Pa;var Ra=window.performance.now();this.MDa();this.M2=window.setTimeout(()=>{if(Pa===this.BQ){this.BQ="";this.M2=-1;ba.resultsUpdated(ka);const Ga={};Ga[k.a.provider]=this.oL();Ga[k.a.oOb]=Y.Oob;v.TellMeActor.instance.Oe.QA(x.a.timedOut,
this.gCc,Ga)}},this.gCc);this.$f.mj(this.naa,2,this.Bhm(Y.Gg),ea,!1,0,Ga=>{this.UMb(Ga,Y,ba,Pa,Ra,ha)},Ga=>{this.CMb(Ga,Y,ba,Pa,Ra)},null,null,!1,4E3,this.q0b?3E4:6E3)}else v.TellMeActor.instance.Oe.onError("IssueQuery","Empty Online Provider List: No online calls by provider"),ba.resultsUpdated(ka);else ba.resultsUpdated(ka)}MDa(){-1!==this.M2&&(window.clearTimeout(this.M2),this.M2=-1)}UMb(Y,ba,Z,ea,ha,ka){const ua=new z.a(ba);if(ea===this.BQ){this.MDa();v.TellMeActor.instance.Oe.W9(ba.Gg.length,
this.Vab.join(","),Y.data.Se.toString(),Math.round(window.performance.now()-ha),N.a.tellMe,!0,y.a.LQa);ea=Y.data.se;Y=null;try{Y=W.b(ea)}catch(ta){v.TellMeActor.instance.Oe.onError("OnSuccessCallBack","Exception occured while deserializing response:"+ta);return}ea=H.a.FR(ba);if("Groups"in Y&&Y.Groups){var sa=Y.Groups;for(var Da of sa)if("GroupType"in Da&&"Suggestions"in Da&&Da.Suggestions)if("Commands"===Da.GroupType&&(ka?Array.contains(ka,17):1)||"Recommended"===Da.GroupType&&(ka?Array.contains(ka,
18):1)){var Pa=(sa="Recommended"===Da.GroupType)?"DLIS":"NaiveBayes";"Source"in Da&&Da.Source&&(Pa=Da.Source);var Ra=Da.Suggestions;new l.a;var Ga=[];for(const ta of Ra)this.fXm(ta)&&(Ra=ta.Type,("Command"===Ra||sa&&"Recommended"===Ra)&&Ga.push(new K.a(ta.CommandId,ta.Score)));M.CommandResultsUtility.h3d(Ga,!ba.Gg.trim().length,Da.GroupType,Pa);Pa=v.TellMeActor.instance.q3;Ra=[];for(const ta of Ga)sa&&Pa&&Pa.q$e(ta.commandId)||Ra.push(ta);Ga=M.CommandResultsUtility.PRc(ba,Ra,this.fc,null,null,null,
sa?18:17,0);0<Ga.results.length&&(this.hga!==e.a.contextMenu&&(Ga.displayName=sa?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),ua.dv(Ga))}else if("Answer"===Da.GroupType){Ra=Da.Suggestions;sa=null;Ga=2147483647;Pa="";for(const ta of Ra)if(this.eXm(ta))if(Pa=ta.Type,Ra=this.YTd(Pa),"Answer"===Pa&&this.mxd){sa=this.MNh(Pa,ta,ba.Gg);break}else Ra&&Ra<Ga&&(Ga=Ra,sa=this.MNh(Pa,ta,ba.Gg));Ga=H.a.j8n(ba.Gg,Pa);sa&&(ka?Array.contains(ka,sa.type):1)&&(Pa=[],this.lxd?
this.fc.bxa?(v.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(sa.value,sa.hD)),v.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(sa.value,sa.description)),v.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(sa.value,Ga))):(Pa.push(appChrome.actions.setControlLabel(sa.value,sa.hD)),Pa.push(appChrome.actions.updateCompoundButtonDescription(sa.value,sa.description)),Pa.push(appChrome.actions.setCompoundButtonCommandValueId(sa.value,
Ga)),appChrome.api.dispatch(Pa)):this.fc.bxa?(v.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(sa.value,sa.hD+" - "+sa.description)),v.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(sa.value,Ga))):(Pa.push(appChrome.actions.setControlLabel(sa.value,sa.hD+" - "+sa.description)),Pa.push(appChrome.actions.setButtonCommandValueId(sa.value,Ga)),appChrome.api.dispatch(Pa)),Ga=this.Oel(sa.type),Ga.Uw(sa),ua.dv(Ga))}else"Help"===Da.GroupType&&Da.Suggestions.length&&
(ka?Array.contains(ka,8):1)?this.qDc&&(sa=this.jMg.Rjb(ba,Da.Suggestions))&&0<sa.results.length&&ua.dv(sa):"Template"===Da.GroupType&&(ka?Array.contains(ka,23):1)?(sa=Da.Suggestions)&&0<sa.length&&this.qmk.Rjb(ba,ua,sa):"Addin"===Da.GroupType&&(ka?Array.contains(ka,27):1)?(sa=Da.Suggestions)&&0<sa.length&&this.sVj.Rjb(ba,ua,sa):"ActionAI"===Da.GroupType&&(ka?Array.contains(ka,25):1)?(Ga=Da.Suggestions,sa=[],new t.a(25),Ga&&1===Ga.length&&(Pa=Ga[0])&&Pa.CommandId&&(Ga=Pa.CommandId,sa.push(new K.a(Ga,
"Score"in Pa?Pa.Score:0)),sa=M.CommandResultsUtility.PRc(ba,sa,this.fc,null,null,null,25,0),sa.displayName=CommonUIStrings.l_TellMeActionAIProviderTitle,ua.dv(sa))):"Substrate"===Da.GroupType&&this.Tdb&&"Type"in Da?"File"===Da.Type&&this.oxd&&(ka?Array.contains(ka,15):1)?(sa=this.Azb.Lqf(Da.Suggestions,ea,this.hga))&&0<sa.results.length&&(this.m_d()&&(Ga=new m.a("GenerateSlidesFromTellMe",30,"",null,1),sa.Uw(Ga)),ua.dv(sa)):"People"===Da.Type&&this.nDc&&(ka?Array.contains(ka,14):1)?(sa=this.Azb.Lei(Da.Suggestions,
ea,this.hga))&&0<sa.results.length&&ua.dv(sa):"Notes"===Da.Type&&this.mDc&&(ka?Array.contains(ka,14):1)&&(sa=this.Azb.sdi(Da.Suggestions,ea,ba))&&0<sa.results.length&&ua.dv(sa):"Recall"===Da.GroupType&&this.fc.kha&&"Type"in Da&&"IntentService"===Da.Type&&(ka?Array.contains(ka,15):1)&&(sa=this.Azb.Lqf(Da.Suggestions,ea,this.hga))&&0<sa.results.length&&(this.m_d()&&(Ga=new m.a("GenerateSlidesFromTellMe",30,"",null,1),sa.Uw(Ga)),ua.dv(sa));else v.TellMeActor.instance.Oe.onError("OnSuccessCallBack","GroupType"in
Da?"Invalid group suggestions found for "+Da.GroupType:"Invalid group found")}if(Y.Intents){Da=Y.Intents;for(const ta of Da)this.VIf(ta)&&("Image"===ta.GroupType&&ta.ConfidenceScore>ta.ConfidenceThreshold&&(ka?Array.contains(ka,19):1)?this.J6j.Rjb(ba,ua,0,ta):"Commands"===ta.GroupType&&ta.ConfidenceScore<ta.ConfidenceThreshold&&(ka?Array.contains(ka,17):1)&&(Da=new t.a(17),ua.dv(Da)))}Z.resultsUpdated(ua);v.TellMeActor.instance.Oe.W9(ba.Gg.length,this.Vab.join(","),"",Math.round(window.performance.now()-
ha),"",!0,y.a.provider)}}CMb(Y,ba,Z,ea,ha){const ka=new z.a(ba);ea===this.BQ&&(this.MDa(),v.TellMeActor.instance.Oe.W9(ba.Gg.length,this.Vab.join(","),Y.data.Se.toString(),Math.round(window.performance.now()-ha),N.a.tellMe,!1,y.a.LQa));Z.resultsUpdated(ka)}YTd(Y){switch(Y){case "Entity":return this.Ngh?3:0;case "Definition":return this.nxd?5:0;case "WolframAnswer":return this.qxd?2:0;default:return 0}}MNh(Y,ba,Z){switch(Y){case "Answer":return new m.a(this.lxd?"AnswerForSearch":"AnswerForSearchSingleLine",
0,""===ba.Title?Z:ba.Title,ba.Description,0);case "Entity":return new m.a(this.lxd?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===ba.Title?Z:ba.Title,ba.Description,0);case "Definition":return new m.a(this.lxd?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===ba.Title?Z:ba.Title,ba.Description,0);case "WolframAnswer":return new m.a("WolframForSearch",3,""===ba.Title?Z:ba.Title,ba.Description,0);default:return null}}Oel(Y){switch(Y){case 0:return new t.a(9,CommonUIStrings.l_TellMeAnswersTitle);
case 2:return new t.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new t.a(10,CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new t.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new t.a(19,this.fc.Hlc?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);default:return null}}eXm(Y){return"Type"in Y&&!!Y.Type&&""!==Y.Type&&"Description"in Y&&!!Y.Description&&""!==Y.Description}fXm(Y){return"Type"in Y&&!!Y.Type&&""!==Y.Type&&"CommandId"in Y&&!!Y.CommandId&&
""!==Y.CommandId&&"Score"in Y&&!!Y.Score}VIf(Y){if("GroupType"in Y&&Y.GroupType&&"ConfidenceScore"in Y&&"ConfidenceThreshold"in Y)return!0;v.TellMeActor.instance.Oe.onError("IsValidIntentGroup","Invalid intents found");return!1}Bhm(Y){const ba=H.a.eDi(Y),Z={};Z.Query=Y;ba&&this.oDc&&(this.VQm()?Z.UserActionEvents=v.TellMeActor.instance.slh:(Z.CommandClickedEvents=v.TellMeActor.instance.Dwe,Z.CommandActionEvents=v.TellMeActor.instance.BPg),Z.TellMeCommandClickMruEvents=v.TellMeActor.instance.W7g,Z.ContentType=
v.TellMeActor.instance.eKd);this.pxd&&(Y={},Y.Application=this.fc.application,Z.TemplateInfo=Y);return W.c(Z)}ZQb(){return!!this.fc&&this.fc.ZQb||!!O.AFrameworkApplication.ua&&O.AFrameworkApplication.ua.Kb.ZQb}$Qb(){return!!this.fc&&this.fc.$Qb||!!O.AFrameworkApplication.ua&&O.AFrameworkApplication.ua.Kb.$Qb}aRb(){return!!this.fc&&this.fc.aRb||!!O.AFrameworkApplication.ua&&O.AFrameworkApplication.ua.Kb.aRb}cRb(){return!!this.fc&&this.fc.cRb||!!O.AFrameworkApplication.ua&&O.AFrameworkApplication.ua.Kb.cRb}Mlc(){return!!this.fc&&
(this.fc.Mlc||this.fc.XP)}huo(){return!!this.fc&&!this.fc.Y4a}Buo(){return!!this.fc&&this.fc.EYc}guo(){return!!this.fc&&this.fc.OHm&&this.fc.LHm}Cie(){return!!this.fc&&this.fc.Cie}PDi(){return!!O.AFrameworkApplication.K&&O.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",!1)}QDi(){return!!O.AFrameworkApplication.K&&O.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}VQm(){return!!O.AFrameworkApplication.K&&
O.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewZeroSearchTermModel",!1)}m_d(){return!!O.AFrameworkApplication.K&&O.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesOnMultipleFiles",!1)}Erj(){return!!O.AFrameworkApplication.K&&O.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FetchTellMeTokensAtBoot",!1)}Glm(){return O.AFrameworkApplication.K?O.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.TellMeZeroTermModelName",
""):""}Chm(){if(!O.AFrameworkApplication.K)return"";if(this.QDi())return O.AFrameworkApplication.K.kb("TellMeServiceProdEndpointForSearch");if(this.PDi())return O.AFrameworkApplication.K.kb("TellMeServiceEdogEndpointForSearch");if(H.a.xEf())return O.AFrameworkApplication.K.kb("TellMeServiceIntEndpointForSearch");let Y=O.AFrameworkApplication.K.kb("TellMeServiceSearchEndpoint");Y&&""!==Y||(Y=O.AFrameworkApplication.Ryj);return Y}static oOh(Y,ba){if(ba)return new Q(Y,["Command","Recommended"],Y.JXl);
ba=H.a.Lpa()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin ActionAI".split(" "):"Help WolframAnswer File People Notes Template Addin ActionAI".split(" ");return new Q(Y,ba,Y.Ahi)}}Object(D.a)(Q,"TellMeServiceProvider",null,[1112])},1899:function(D,I,c){c.r(I);c.d(I,"MarkerValidation",function(){return a});D=c(0);var l=c(367),e=c(1743);class a{constructor(){this.zYd=this.sui=this.rui=this.qui=0}V8h(){const k=new l.a(0);k.Z("InvalidBookmarks",this.qui);k.Z("InvalidComments",
this.rui);k.Z("InvalidContentControls",this.sui);0!==this.zYd&&k.Z("InvalidMarkerType",this.zYd);return k}Eni(){return 0<this.qui||0<this.rui||0<this.sui||0!==this.zYd?!0:!1}toString(){return JSON.stringify(e.a.YVa(this.V8h()))}}Object(D.a)(a,"MarkerValidation",null,[])},1900:function(D,I,c){c.d(I,"a",function(){return y});D=c(0);var l=c(183),e=c(1060),a=c(238),k=c(1668),x=c(1591);class y{constructor(m,t,z,v,H=null,F=null,G=null,M=null){this.$d=m;this.WF=t;this.vBa=z;this.OCa=v;this.mbk=H;this.L2j=
F;this.Knk=G;this.Xsa=M||this.Yaf()}Yaf(){return m=>!!this.$d.runtime.Zb&&this.$d.runtime.Zb.isFeatureEnabled(m)}wal(){return()=>this.$d.runtime.Zb}Mgf(){return!!this.$d.runtime.vk.J(a.a.OL)}Euj(){let m;if(1===this.$d.input.source||2===this.$d.input.source)m=81;else if(4===this.$d.input.source||3===this.$d.input.source)m=40;else if(5===this.$d.input.source)m=118;else return!1;return this.Mgf()&&this.Xsa(m)}Gwj(m,...t){return String.format.apply(null,[m].concat(t))}xTd(m){const {ParagraphMerge:t}=
c(1994);let z=this.$d,v=this.vBa,H=this.OCa;m||(z=this.mbk||this.$d,v=this.L2j||v,H=this.Knk||H);var F=x.a.ysf(this.WF);const G=x.a.ysf(v),M=x.a.ysf(H);F=this.Gwj("[MergeSource: {0}] [BaseRevisionId: {1}] [FavoredRevisionId: {2}] [UnfavoredRevisionId: {3}] [BaseObjects: {4}] [FavoredObjects: {5}] [UnfavoredObjects: {6}]",z.input.source,z.runtime.UDa.id,z.runtime.dOd,z.runtime.Pne,F.ir(),G.ir(),M.ir());return m?{returnValue:new k.a(z,this.WF,v,H,this.Yaf(),new e.a),ir:F}:{returnValue:new t(z,this.WF,
v,H,this.Yaf(),this.wal(),new e.a),ir:F}}noc(){this.$d.logger.Zlo();var m=this.Euj();var t=({ir:v}=this.xTd(m)).returnValue;l.a.instance.Ua(18994389,1,4,"ParagraphMergeSelector TryDoMerge: [UseHints: {0}] {1}",m,v);this.$d.logger.$U("ParagraphMergeSelector initialization");m?this.$d.logger.qhe(1):this.$d.logger.qhe(2);let z=({un:t}=t.noc()).returnValue;this.$d.logger.ceg();var v=!z;m=!!this.$d.runtime.vk.J(a.a.OL)&&(m&&!z||!m);v&&({ir:v,returnValue:t}=this.xTd(!1),{un:t,returnValue:z}=t.noc(),l.a.instance.Ua(18994390,
1,z?4:2,"ParagraphMergeSelector TryDoMerge Fallback: [Success: {0}] {1}",z,v));m&&(v=new e.a,x.a.$6n(this.$d,v));this.$d.logger.$U("ParagraphMergeSelector finalization");return{returnValue:z,un:t}}vdd(m,t){let z,v,H;const F=this.Euj()&&this.Xsa(119);let G=({ir:H}=this.xTd(F)).returnValue,M=({s7a:z,dra:v}=G.vdd(m,t)).returnValue;l.a.instance.Ua(18994391,1,4,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange: [UseHints: {0}] {1}",F,H);F&&!M&&G.V$f&&({ir:H,returnValue:G}=this.xTd(!1),{s7a:z,dra:v,
returnValue:M}=G.vdd(m,t),l.a.instance.Ua(18994392,1,M?4:2,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange Fallback: [Success: {0}] {1}",M,H));return{returnValue:M,s7a:z,dra:v}}}Object(D.a)(y,"ParagraphMergeSelector",null,[1989])},1901:function(D,I,c){c.r(I);c.d(I,"SurfaceStringTokenStringGenerator",function(){return e});D=c(0);var l=c(1621);class e extends l.a{constructor(a){super(a);this.Bb=a}apply(a,k,x,y,m,t,z){null==t&&(t=a.Aji(m,k));z=l.a.nqh(a,t,this.Bb.score,x,y,z);return{kcd:t,
PHc:z}}}e.QHc=0;Object(D.a)(e,"SurfaceStringTokenStringGenerator",l.a,[])},1902:function(D,I,c){c.r(I);c.d(I,"QueryTokenStringGenerator",function(){return a});D=c(0);var l=c(1621),e=c(1515);class a extends l.a{constructor(k){super(k);this.Bb=k}apply(k,x,y,m,t,z,v){x=this.Bb.query.load(x,null);t=0;let H=null;this.Bb.query.H5===e.Annotations.iAa?x&&(H=this.Bb.name):((H=this.Bb.name)&&(H+="_"),H+=this.Bb.annotations.Mea(this.Bb.query.H5,x));null!=H&&(t=l.a.nqh(k,H,this.Bb.score,y,m,t));return{kcd:z,
PHc:v+t}}}a.QHc=1;Object(D.a)(a,"QueryTokenStringGenerator",l.a,[])},1903:function(D,I,c){c.r(I);c.d(I,"FuzzyMatchTokenStringGenerator",function(){return e});D=c(0);var l=c(1621);class e extends l.a{constructor(a){super(a);this.Bb=a}apply(a,k,x,y,m,t,z){null==t&&(t=a.Aji(m,k));a=this.Bb.sYh.T8m(t);if(this.Bb.IZi)for(var v of a)if(!v.TO&&v.TOd)return{kcd:t,PHc:z};v=0;for(const H of a)if(H.TO&&!({a6e:v}=this.rvh(H,!0,x,y,v)).returnValue)return{kcd:t,PHc:z};if(this.Bb.Yqi)for(const H of a)if(!({a6e:v}=
this.rvh(H,!1,x,y,v)).returnValue)break;return{kcd:t,PHc:z}}rvh(a,k,x,y,m){let t;k?(k=0,t=a.TOd?1:0):(k=a.TOd?1:0,t=a.count-k);for(let z=0;z<t;++z)if(l.a.oqh(a.mib+k+z,this.Bb.score,x,y),++m,0<this.Bb.oPf&&m>=this.Bb.oPf)return{returnValue:!1,a6e:m};return{returnValue:!0,a6e:m}}}e.QHc=2;Object(D.a)(e,"FuzzyMatchTokenStringGenerator",l.a,[])},1984:function(D,I,c){D=c(0);var l=c(6),e=c(46),a=c(249),k=c(1514);class x extends k.a{constructor(){super()}get Yn(){return 2}get yA(){return 7}static mh(){return new x}static get instance(){return x.Pg.value}}
x.Pg=new a.a(x.mh);Object(D.a)(x,"AppBindingNodeComplexMerge",k.a,[]);var y=c(16),m=c(816),t=c(183),z=c(1558);class v extends k.a{constructor(){super()}get Yn(){return 3}get yA(){return 7}xk(){const nb=super.xk();nb.Z(m.a.Ab(y.a.NR),1);return nb}oC(nb,ac){if(ac===m.a.Ab(y.a.NR)){const Ib=nb.gl;var zc=nb.Xd;t.a.instance.Ua(6633221,1,4,"AppNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Ib.id,Ib.Qc,ac);ac=zc.getPropertyMilliseconds(nb.Ng.value.xf,y.a.NR);
zc=zc.getPropertyMilliseconds(nb.En.value.xf,y.a.NR);ac<zc&&this.NSl(nb);nb.og.add(m.a.Ab(y.a.NR));return!0}t.a.instance.Ua(6633222,1,1,"AppNodeComplexMerge: Failed to merge AppNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",nb.Ng.value.xf.id,ac);return!1}NSl(nb){this.X3n(nb.En.value.xf,nb.gl);this.npf(nb,l.a.U1e);this.npf(nb,l.a.uth);this.npf(nb,l.a.hth)}npf(nb,ac){var zc=nb.Xd,Ib=nb.gl;if(zc.hasProperty(Ib,ac)&&(ac=zc.getPropertyObjectIds(Ib,ac))&&ac.length)for(zc=nb.uq.runtime.Nq,
nb=nb.uq.runtime.un,Ib=0;Ib<ac.length;Ib++){const ya=ac.J(Ib);if(!zc.nb(ya))continue;const ib=zc.J(ya).XK();nb.add(ya,new z.a(ib,!1))}}static mh(){return new v}static get instance(){return v.Pg.value}}v.Pg=new a.a(v.mh);Object(D.a)(v,"AppNodeComplexMerge",k.a,[]);class H extends k.a{constructor(){super()}get Yn(){return 4}get yA(){return 7}static mh(){return new H}static get instance(){return H.Pg.value}}H.Pg=new a.a(H.mh);Object(D.a)(H,"AppPropNodeComplexMerge",k.a,[]);class F extends k.a{constructor(){super()}get Yn(){return 5}get yA(){return 7}static mh(){return new F}static get instance(){return F.Pg.value}}
F.Pg=new a.a(F.mh);Object(D.a)(F,"AppRefNodeComplexMerge",k.a,[]);var G=c(367),M=c(611),K=c(225),L=c(19);class R{constructor(nb,ac){this.id=nb;this.pCo=ac}}Object(D.a)(R,"IdAndTime",null,[]);class S extends k.a{constructor(){super()}get Yn(){return 6}xk(){const nb=super.xk();nb.Z(m.a.Ab(l.a.I_a),1);return nb}oC(nb,ac){if(ac===m.a.Ab(l.a.I_a)){const zc=nb.gl,Ib=nb.Xd;t.a.instance.Ua(6633224,1,4,"AppsNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",zc.id,
zc.Qc,ac);ac=Ib.getPropertyObjectIds(nb.Ng.value.tu,l.a.I_a);const ya=Ib.getPropertyObjectIds(nb.Ng.value.xf,l.a.I_a),ib=Ib.getPropertyObjectIds(nb.En.value.xf,l.a.I_a);ac=this.qcn(nb,ac,ya,ib);0<ac.length?Ib.setPropertyObjectIds(zc,l.a.I_a,ac):zc.removeProperty(l.a.I_a);nb.og.add(m.a.Ab(l.a.I_a));return!0}t.a.instance.Ua(6633225,1,1,"AppsNodeComplexMerge: Failed to merge AppsNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",nb.Ng.value.xf.id,ac);return!1}qcn(nb,ac,zc,Ib){const ya=
this.kHa(ac,zc,Ib),ib=ac.fH(),wb=zc.fH(),bc=Ib.fH();ac=k.a.filter(ya,Bc=>!ib.contains(Bc)&&wb.contains(Bc));zc=k.a.filter(ya,Bc=>!ib.contains(Bc)&&bc.contains(Bc));if(!ac.length||!zc.length)return ya;const lc=new G.a;ac.forEach(Bc=>{const Xc=new R(Bc,this.x5h(nb,Bc,!1));this.t5h(nb,Bc,!1).forEach(vd=>{lc.add(vd,Xc);return!0});return!0});const Kb=new M.a;zc.forEach(Bc=>{const Xc=this.x5h(nb,Bc,!0);this.t5h(nb,Bc,!0).forEach(vd=>lc.nb(vd)?(Kb.add(lc.J(vd).pCo>=Xc?Bc:lc.J(vd).id),!1):!0);return!0});
return k.a.filter(ya,Bc=>!Kb.contains(Bc))}x5h(nb,ac,zc){return(ac=this.Wha(nb,ac,zc))?nb.Xd.getPropertyMilliseconds(ac,y.a.NR):0}Wha(nb,ac,zc){nb=zc?nb.uq.runtime.Nq:nb.uq.runtime.Lu;return nb.nb(ac)?nb.J(ac):null}t5h(nb,ac,zc){const Ib=new K.a,ya=new M.a,ib=nb.Xd;ac=this.Wha(nb,ac,zc);var wb=this.Xfi(ib,ac);if(wb)for(Ib.add(wb),ya.add(wb),ac=ib.getPropertyObjectIds(ac,l.a.U1e),wb=0;ac&&wb<ac.length;wb++){const bc=this.Xfi(ib,this.Wha(nb,ac.J(wb),zc));if(!bc)break;ya.contains(bc)||(Ib.add(bc),ya.add(bc))}return Ib}Xfi(nb,
ac){if(!nb.hasProperty(ac,l.a.bfb)||!nb.hasProperty(ac,l.a.g3b)||!nb.hasProperty(ac,l.a.h3b))return null;const zc=nb.getPropertyString(ac,l.a.bfb),Ib=nb.getPropertyString(ac,l.a.g3b);nb=nb.getPropertyString(ac,l.a.h3b);return L.a.ZA(zc+";"+Ib+";"+nb)}static mh(){return new S}static get instance(){return S.Pg.value}}S.Pg=new a.a(S.mh);Object(D.a)(S,"AppsNodeComplexMerge",k.a,[]);class N extends k.a{constructor(){super()}get Yn(){return 36}xk(){const nb=super.xk();nb.Z(m.a.Ab(l.a.ypg),1);nb.Z(m.a.Ab(l.a.qeg),
1);return nb}oC(nb,ac){t.a.instance.Ua(51430790,1,4,"AutoSaveParametersNode PropertyId {0}: Using CustomMerge Strategy",ac);if(ac===m.a.Ab(l.a.ypg)||ac===m.a.Ab(l.a.qeg)){const ib=m.a.XX(ac);var zc=nb.Ng.value.xf,Ib=nb.En.value.xf;const wb=nb.gl;var ya=nb.Xd.getPropertyStrings(nb.Ng.value.tu,ib);zc=nb.Xd.getPropertyStrings(zc,ib);Ib=nb.Xd.getPropertyStrings(Ib,ib);ya=this.kHa(ya,zc,Ib);nb.Xd.setPropertyStrings(wb,ib,ya);nb.og.add(ac);return!0}return!1}static mh(){return new N}static get instance(){return N.Pg.value}}
N.Pg=new a.a(N.mh);Object(D.a)(N,"AutoSaveParametersNodeComplexMerge",k.a,[]);class O extends k.a{constructor(){super()}get Yn(){return 44}xk(){const nb=super.xk();nb.Z(m.a.Ab(y.a.gf),1);return nb}oC(nb,ac){const zc=nb.uq.runtime.Zb;if(ac===m.a.Ab(y.a.gf))return t.a.instance.Ua(589608865,1,4,"BookmarkContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",nb.gl.id,nb.gl.Qc,ac),zc.Ux(123),zc.isFeatureEnabled(123)?this.tcn(nb,ac):this.Ocn(nb,ac),!0;t.a.instance.Ua(589608912,
1,1,"BookmarkContainerNodeComplexMerge: Failed to merge BookmarkContainer [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",nb.Ng.value.xf.id,ac);return!1}tcn(nb,ac){const zc=m.a.XX(ac),Ib=nb.Xd;var ya=Ib.getPropertyObjectIds(nb.Ng.value.tu,zc),ib=Ib.getPropertyObjectIds(nb.Ng.value.xf,zc),wb=Ib.getPropertyObjectIds(nb.En.value.xf,zc);wb=O.ujm(nb,ib,wb);ya=this.kHa(ya,ib,wb);ib=nb.gl;0<ya.length?Ib.setPropertyObjectIds(ib,zc,ya):ib.removeProperty(zc);nb.og.add(ac)}static mh(){return new O}static get instance(){return O.Pg.value}static ujm(nb,
ac,zc){const Ib=new K.a,ya=new G.a;ac.forEach(ib=>{const wb=nb.uq.runtime.Lu.J(ib);wb&&ya.add(wb.yU(l.a.At).toString(),ib);return!0});zc.forEach(ib=>{var wb=nb.uq.runtime.Nq.J(ib);wb?(wb=wb.yU(l.a.At).toString(),ya.nb(wb)&&ya.get(wb)!==ib?t.a.instance.Ua(557061773,1,4,"BookmarkContainerNodeComplexMerge: Similar name bookmark found during merge, skipping conflict revision bookmark"):Ib.add(ib)):Ib.add(ib);return!0});return Ib}}O.Pg=new a.a(O.mh);Object(D.a)(O,"BookmarkContainerNodeComplexMerge",k.a,
[]);class W extends k.a{constructor(){super()}get Yn(){return 41}xk(){const nb=super.xk();nb.Z(m.a.Ab(l.a.DBb),1);nb.Z(m.a.Ab(l.a.At),1);return nb}oC(nb,ac){return ac===m.a.Ab(l.a.DBb)?(nb.og.add(m.a.Ab(l.a.DBb)),!0):ac===m.a.Ab(l.a.At)?(nb.og.add(m.a.Ab(l.a.At)),!0):!1}af(nb){return nb&&nb.length?!1:!0}static mh(){return new W}static get instance(){return W.Pg.value}}W.Pg=new a.a(W.mh);Object(D.a)(W,"BookmarkNodeComplexMerge",k.a,[]);class V extends k.a{constructor(){super();this.sZd=!1}get Yn(){return 7}xk(){const nb=
super.xk();nb.Z(m.a.Ab(y.a.gf),1);return nb}oC(nb,ac){if(ac===m.a.Ab(y.a.gf)){const ya=nb.gl,ib=nb.Xd;var zc=nb.uq.runtime.Zb;zc&&(this.sZd=zc.isFeatureEnabled(75));t.a.instance.Ua(4511579,1,4,"CommentContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",ya.id,ya.Qc,ac);ac=ib.getPropertyObjectIds(nb.Ng.value.tu,y.a.gf);zc=ib.getPropertyObjectIds(nb.Ng.value.xf,y.a.gf);var Ib=ib.getPropertyObjectIds(nb.En.value.xf,y.a.gf);ac=this.Ccn(ac,zc,Ib);if(this.sZd&&
0<ac.length){zc=new Sys.StringBuilder;for(Ib=0;Ib<ac.length;Ib++)zc.append(ac.J(Ib).toString()+",");t.a.instance.Ua(559710276,1,4,"Merge result for CommentContentNode {0}: {1}",ya.id,zc.toString())}0<ac.length?ib.setPropertyObjectIds(ya,y.a.gf,ac):ya.removeProperty(y.a.gf);nb.og.add(m.a.Ab(y.a.gf));return!0}t.a.instance.Ua(4511580,1,1,"CommentContentNodeComplexMerge: Failed to merge CommentContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",nb.Ng.value.xf.id,ac);return!1}Ccn(nb,
ac,zc){const Ib=new K.a,ya=new G.a(0);this.LCl(nb,zc,Ib,ya);return this.lnl(ac,ya,Ib)}LCl(nb,ac,zc,Ib){nb=nb||new K.a;ac=ac||new K.a;nb.forEach(ya=>{Ib.Z(ya,1);return!0});ac.forEach(ya=>{Ib.Fc(ya).returnValue?Ib.Z(ya,2):(Ib.Z(ya,0),zc.add(ya));return!0})}lnl(nb,ac,zc){nb=nb||new K.a;const Ib=new K.a,ya=new K.a,ib=new K.a;nb.forEach(wb=>{let bc=!0,lc;({value:lc}=ac.Fc(wb)).returnValue&&(0===lc?ac.Z(wb,2):1===lc&&(bc=!1));bc?Ib.add(wb):this.sZd&&ya.add(wb);return!0});zc.forEach(wb=>{let bc=!1,lc;({value:lc}=
ac.Fc(wb)).returnValue?0===lc&&(bc=!0,ac.Z(wb,2)):t.a.instance.Ua(4511585,1,4,"DetermineMergedListOfCommentNodes: Expected to find Conflicting Comment with [ObjectID: {0}] in conflictChangesMap, but it was not there.",wb);bc?Ib.add(wb):this.sZd&&ib.add(wb);return!0});this.pLi(ya,"Favored");this.pLi(ib,"Unfavored");return Ib}pLi(nb,ac){if(nb.length){var zc=new Sys.StringBuilder;for(let Ib=0;Ib<nb.length;Ib++)zc.append(nb.J(Ib).toString()+",");t.a.instance.Ua(561637572,1,4,"DetermineMergedListOfCommentNodes: Removed {0} ObjectIds: {1}",
ac,zc.toString())}}static mh(){return new V}static get instance(){return V.Pg.value}}V.Pg=new a.a(V.mh);Object(D.a)(V,"CommentContentNodeComplexMerge",k.a,[]);var Q=c(69),Y=c(34);class ba extends k.a{constructor(){super();this.rih=[1];this.RPe=new G.a}get Yn(){return 8}xk(){const nb=super.xk();nb.Z(m.a.Ab(l.a.Rba),3);nb.Z(m.a.Ab(l.a.hF),3);nb.Z(m.a.Ab(l.a.pJc),2);nb.Z(m.a.Ab(l.a.commentId),2);nb.Z(m.a.Ab(l.a.qHh),2);nb.Z(m.a.Ab(l.a.RDa),2);nb.Z(m.a.Ab(l.a.IOa),1);nb.Z(m.a.Ab(l.a.Zjb),1);nb.Z(m.a.Ab(l.a.Ykb),
1);nb.Z(m.a.Ab(l.a.WQ),1);nb.Z(m.a.Ab(l.a.SG),1);nb.Z(m.a.Ab(l.a.oJc),2);nb.Z(m.a.Ab(l.a.gHd),2);nb.Z(m.a.Ab(l.a.Z4b),2);nb.Z(m.a.Ab(l.a.w9e),2);nb.Z(m.a.Ab(l.a.zM),1);nb.Z(m.a.Ab(y.a.gf),0);nb.Z(m.a.Ab(l.a.LH),0);return nb}oC(nb,ac){if(ac===m.a.Ab(l.a.zM)){var zc=nb.Xd.getPropertyString(nb.En.value.xf,l.a.zM);this.af(zc)?nb.gl.removeProperty(l.a.zM):nb.gl.sUa(l.a.zM,zc);return!0}if(ac!==m.a.Ab(l.a.IOa)&&ac!==m.a.Ab(l.a.Zjb)&&ac!==m.a.Ab(l.a.Ykb)&&ac!==m.a.Ab(l.a.SG)&&ac!==m.a.Ab(l.a.WQ))return!1;
var Ib=nb.Ng.value.tu;const ya=nb.Ng.value.xf;var ib=nb.En.value.xf;zc=nb.gl;if(ac===m.a.Ab(l.a.IOa)){Ib=nb.Xd.getPropertyString(ya,l.a.IOa);ib=nb.Xd.getPropertyString(ib,l.a.IOa);ib=this.af(Ib)?ib:this.af(ib)?Ib:null;if(this.af(ib))return!0;nb.Xd.setPropertyString(zc,l.a.IOa,ib);nb.og.add(m.a.Ab(l.a.IOa));return!0}if(ac===m.a.Ab(l.a.Ykb))return Ib=nb.Xd.getPropertyBool(ya,l.a.Ykb),ib=nb.Xd.getPropertyBool(ib,l.a.Ykb),Ib=null!=Ib?Ib:!1,Ib=(null!=ib?ib:!1)||Ib,nb.Xd.setPropertyBool(zc,l.a.Ykb,Ib),
nb.og.add(m.a.Ab(l.a.Ykb)),!0;if(ac===m.a.Ab(l.a.Zjb)){Ib=nb.Xd.getPropertyBool(ya,l.a.Zjb);ib=nb.Xd.getPropertyBool(ib,l.a.Zjb);if(Ib===ib)return!0;Ib=null!=Ib?Ib:!1;Ib=(null!=ib?ib:!1)||Ib;nb.Xd.setPropertyBool(zc,l.a.Zjb,Ib);return!0}if(ac===m.a.Ab(l.a.SG)){Ib=nb.Xd.getPropertyBool(ya,l.a.SG);ib=nb.Xd.getPropertyBool(ib,l.a.SG);if(Ib===ib)return!0;Ib=null!=Ib?Ib:!1;Ib=(null!=ib?ib:!1)||Ib;nb.Xd.setPropertyBool(zc,l.a.SG,Ib);nb.og.add(m.a.Ab(l.a.SG));return!0}if(ac===m.a.Ab(l.a.WQ)){ac=nb.uq.runtime.Zb;
ac.Ux(13);if(ac.isFeatureEnabled(13))return this.A2k(nb,Ib,ya,ib,zc);Ib=nb.Xd.getPropertyString(ya,l.a.WQ);ib=nb.Xd.getPropertyString(ib,l.a.WQ);if(Ib===ib)return!0;nb.Xd.setPropertyString(zc,l.a.WQ,ib||Ib);nb.og.add(m.a.Ab(l.a.WQ));return!0}return!1}A2k(nb,ac,zc,Ib,ya){zc=nb.Xd.getPropertyString(zc,l.a.WQ);Ib=nb.Xd.getPropertyString(Ib,l.a.WQ);if(zc===Ib)return!0;ac=nb.Xd.getPropertyString(ac,l.a.WQ);const ib={};for(let bc=0;bc<this.rih.length;bc++){const lc=this.rih[bc];var wb=this.Stf(ac,lc,0);
const Kb=this.Stf(zc,lc,1),Bc=this.Stf(Ib,lc,2);wb=this.Wcn(wb,Kb,Bc);ib[lc.toString()]=wb.toArray()}nb.Xd.setPropertyString(ya,l.a.WQ,this.Kfo(ib));nb.og.add(m.a.Ab(l.a.WQ));return!0}Wcn(nb,ac,zc){const Ib=new G.a,ya=new G.a(0);for(var ib=0;ib<ac.length;ib++){const bc=ac[ib].UserId;Ib.add(bc,ac[ib]);ya.add(bc,0)}for(ac=0;ac<zc.length;ac++)ib=zc[ac].UserId,ya.nb(ib)?ya.Z(ib,2):(Ib.add(ib,zc[ac]),ya.add(ib,0));for(zc=0;zc<nb.length;zc++)ac=nb[zc].UserId,ya.nb(ac)&&2!==ya.J(ac)&&ya.Z(ac,1);const wb=
new K.a;ya.forEach((bc,lc)=>{if(1===lc)return!0;wb.add(Ib.J(bc));return!0});return wb}Stf(nb,ac,zc){nb=Object(Q.a)(Object,this.ibm(nb,zc));return ac.toString()in nb?Array.isArray(nb[ac.toString()])?nb[ac.toString()]:null:[]}ibm(nb,ac){if(this.RPe.nb(ac))return Object(Q.a)(Object,this.RPe.J(ac));nb=Object(Q.a)(Object,this.Xll(nb));this.RPe.add(ac,nb);return nb}Xll(nb){return Object(Q.a)(Object,Y.b(nb))}Kfo(nb){return Y.c(nb)}af(nb){return nb&&nb.length?!1:!0}static mh(){return new ba}static get instance(){return ba.Pg.value}}
ba.Pg=new a.a(ba.mh);Object(D.a)(ba,"CommentNodeComplexMerge",k.a,[]);class Z extends k.a{constructor(){super()}get Yn(){return 46}xk(){const nb=super.xk();nb.Z(m.a.Ab(l.a.contentControlNode),1);nb.Z(m.a.Ab(y.a.lastModifiedTime),0);nb.Z(m.a.Ab(l.a.OJc),2);return nb}oC(nb,ac){if(ac===m.a.Ab(l.a.contentControlNode))return t.a.instance.Ua(556865370,1,4,"ContentControlContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",nb.gl.id,nb.gl.Qc,ac),k.a.FPf(nb,
this,l.a.contentControlNode);t.a.instance.Ua(556865371,1,1,"ContentControlContainerNodeComplexMerge: Failed to merge ContentControlContainerNode [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",nb.Ng.value.xf.id,ac);return!1}static mh(){return new Z}static get instance(){return Z.Pg.value}}Z.Pg=new a.a(Z.mh);Object(D.a)(Z,"ContentControlContainerNodeComplexMerge",k.a,[]);var ea=c(60),ha=c(1796);class ka extends k.a{constructor(){super()}get Yn(){return 37}xk(){const nb=super.xk();nb.Z(m.a.Ab(l.a.u8),
1);nb.Z(m.a.Ab(l.a.wrb),1);nb.Z(m.a.Ab(l.a.fId),2);nb.Z(m.a.Ab(l.a.MCb),2);nb.Z(m.a.Ab(l.a.contentControlNode),1);nb.Z(m.a.Ab(l.a.u9),1);nb.Z(m.a.Ab(l.a.Rga),1);nb.Z(m.a.Ab(l.a.y5b),1);nb.Z(m.a.Ab(l.a.wgb),1);nb.Z(m.a.Ab(l.a.ugb),1);nb.Z(m.a.Ab(l.a.tgb),1);nb.Z(m.a.Ab(l.a.POa),2);nb.Z(m.a.Ab(l.a.PCb),1);nb.Z(m.a.Ab(l.a.gId),1);nb.Z(m.a.Ab(l.a.t8),1);this.Zb.isFeatureEnabled(29)&&(nb.Z(m.a.Ab(l.a.QU),2),nb.Z(m.a.Ab(l.a.Sva),2),nb.Z(m.a.Ab(l.a.Rna),2),nb.Z(m.a.Ab(l.a.R4),1),nb.Z(m.a.Ab(l.a.ppa),1),
nb.Z(m.a.Ab(l.a.qpa),1));return nb}oC(nb,ac){var zc=nb.Ng.value.xf,Ib=nb.En.value.xf;const ya=nb.gl;if(ac===m.a.Ab(l.a.contentControlNode))return k.a.FPf(nb,this,l.a.contentControlNode);if(ac===m.a.Ab(l.a.u9)){ac=nb.Xd.getPropertyBool(zc,l.a.u9);Ib=nb.Xd.getPropertyBool(Ib,l.a.u9);if(null!=ac&&ac||null!=Ib&&Ib)nb.Xd.setPropertyBool(ya,l.a.u9,!0),nb.og.add(m.a.Ab(l.a.u9));return!0}if(ac===m.a.Ab(l.a.Rga))return ac=nb.Xd.getPropertyBool(zc,l.a.Rga),Ib=nb.Xd.getPropertyBool(Ib,l.a.Rga),nb.Xd.setPropertyBool(ya,
l.a.Rga,null!=ac&&!!ac&&null!=Ib&&!!Ib),nb.og.add(m.a.Ab(l.a.Rga)),!0;if(ac===m.a.Ab(l.a.y5b))return ac=nb.Xd.getPropertyUint32(Ib,l.a.y5b),null!=ac&&(nb.Xd.setPropertyUint32(ya,l.a.y5b,ac),nb.og.add(m.a.Ab(l.a.y5b))),!0;if(ac===m.a.Ab(l.a.wgb)||ac===m.a.Ab(l.a.ugb)||ac===m.a.Ab(l.a.tgb))return(Ib=nb.Xd.getPropertyString(Ib,m.a.XX(ac)))&&0<Ib.length&&(nb.Xd.setPropertyString(ya,m.a.XX(ac),Ib),nb.og.add(ac)),!0;if(ac===m.a.Ab(l.a.PCb)||ac===m.a.Ab(l.a.gId)){zc=nb.Xd.getPropertyObjectId(zc,m.a.XX(ac));
if(ha.a.T9b(nb.uq,zc))return!0;if((Ib=nb.Xd.getPropertyObjectId(Ib,m.a.XX(ac)))&&Ib!==ea.a.nil)return nb.Xd.setPropertyObjectId(ya,m.a.XX(ac),Ib),nb.og.add(ac),!0;ya.removeProperty(m.a.XX(ac));nb.og.add(ac);return!0}if(ac===m.a.Ab(l.a.t8)){zc=nb.Xd.getPropertyObjectId(zc,l.a.t8);if((zc=ha.a.T9b(nb.uq,zc))&&nb.Xd.getPropertyObjectIds(zc,l.a.contentControlNode).fH().contains(nb.gl.id))return!0;Ib=nb.Xd.getPropertyObjectId(Ib,l.a.t8);return(zc=ha.a.T9b(nb.uq,Ib))&&nb.Xd.getPropertyObjectIds(zc,l.a.contentControlNode).fH().contains(nb.gl.id)?
(nb.Xd.setPropertyObjectId(ya,l.a.t8,Ib),nb.og.add(ac),!0):!1}if(ac===m.a.Ab(l.a.u8))return ac=nb.Xd.getPropertyBool(Ib,l.a.u8),null==ac||ac||(nb.Xd.setPropertyBool(ya,l.a.u8,!1),nb.og.add(m.a.Ab(l.a.u8))),!0;if(ac===m.a.Ab(l.a.wrb)){ac=nb.Xd.getPropertyObjectId(zc,l.a.wrb);Ib=nb.Xd.getPropertyObjectId(Ib,l.a.wrb);if(ac&&!ac.equals(Ib))return!1;if(ac=ac||Ib)nb.Xd.setPropertyObjectId(ya,l.a.wrb,ac),nb.og.add(m.a.Ab(l.a.wrb));return!0}!this.Zb.isFeatureEnabled(29)||ac!==m.a.Ab(l.a.R4)&&ac!==m.a.Ab(l.a.ppa)&&
ac!==m.a.Ab(l.a.qpa)||t.a.instance.Ua(512274638,1,1,"ContentControlNodeComplexMerge: Unexpected merge conflict for inserted tracked change property [PropertyId: {1}]",ac);return!1}static mh(){return new ka}static get instance(){return ka.Pg.value}}ka.Pg=new a.a(ka.mh);Object(D.a)(ka,"ContentControlNodeComplexMerge",k.a,[]);class ua extends k.a{constructor(){super()}get Yn(){return 10}xk(){const nb=super.xk();nb.Z(m.a.Ab(l.a.customXmlPartNode),1);return nb}oC(nb,ac){if(ac===m.a.Ab(l.a.customXmlPartNode)){ac=
nb.gl;const Ib=nb.Xd;var zc=Ib.getPropertyObjectIds(nb.Ng.value.tu,l.a.customXmlPartNode);const ya=Ib.getPropertyObjectIds(nb.Ng.value.xf,l.a.customXmlPartNode),ib=Ib.getPropertyObjectIds(nb.En.value.xf,l.a.customXmlPartNode);zc=this.Gcn(zc,ya,ib);0<zc.length?Ib.setPropertyObjectIds(ac,l.a.customXmlPartNode,zc):ac.removeProperty(l.a.customXmlPartNode);nb.og.add(m.a.Ab(l.a.customXmlPartNode));return!0}return!1}Gcn(nb,ac,zc){return this.kHa(nb,ac,zc)}static mh(){return new ua}static get instance(){return ua.Pg.value}}
ua.Pg=new a.a(ua.mh);Object(D.a)(ua,"CustomXmlPartContainerNodeComplexMerge",k.a,[]);class sa extends k.a{constructor(){super()}get Yn(){return 9}get yA(){return 0}static mh(){return new sa}static get instance(){return sa.Pg.value}}sa.Pg=new a.a(sa.mh);Object(D.a)(sa,"CustomXmlPartNodeComplexMerge",k.a,[]);class Da extends k.a{constructor(){super()}get Yn(){return 29}get yA(){return 3}xk(){const nb=super.xk();nb.Z(m.a.Ab(l.a.embeddedFontNode),1);return nb}oC(nb,ac){if(ac===m.a.Ab(l.a.embeddedFontNode)){ac=
nb.Xd;var zc=ac.getPropertyObjectIds(nb.Ng.value.tu,l.a.embeddedFontNode),Ib=ac.getPropertyObjectIds(nb.Ng.value.xf,l.a.embeddedFontNode);const ya=ac.getPropertyObjectIds(nb.En.value.xf,l.a.embeddedFontNode);zc=this.kHa(zc,Ib,ya);Ib=nb.gl;0<zc.length?ac.setPropertyObjectIds(Ib,l.a.embeddedFontNode,zc):Ib.removeProperty(l.a.embeddedFontNode);nb.og.add(m.a.Ab(l.a.embeddedFontNode));return!0}return!1}static mh(){return new Da}static get instance(){return Da.Pg.value}}Da.Pg=new a.a(Da.mh);Object(D.a)(Da,
"EmbeddedFontContainerNodeComplexMerge",k.a,[]);class Pa extends k.a{constructor(){super()}get Yn(){return 30}get yA(){return 3}static mh(){return new Pa}static get instance(){return Pa.Pg.value}}Pa.Pg=new a.a(Pa.mh);Object(D.a)(Pa,"EmbeddedFontNodeComplexMerge",k.a,[]);class Ra extends k.a{constructor(){super()}get Yn(){return 11}xk(){const nb=super.xk();nb.Z(m.a.Ab(l.a.y4),4);nb.Z(m.a.Ab(l.a.a2a),1);return nb}oC(nb,ac){if(ac===m.a.Ab(l.a.a2a)){const zc=nb.gl,Ib=nb.Xd;t.a.instance.Ua(4063307,1,4,
"FootnoteEndnoteContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",zc.id,zc.Qc,ac);ac=Ib.getPropertyObjectIds(nb.Ng.value.tu,l.a.a2a);const ya=Ib.getPropertyObjectIds(nb.Ng.value.xf,l.a.a2a),ib=Ib.getPropertyObjectIds(nb.En.value.xf,l.a.a2a);ac=this.WOi(ac,ya,ib,(wb,bc)=>wb.equals(bc));0<ac.length?Ib.setPropertyObjectIds(zc,l.a.a2a,ac):zc.removeProperty(l.a.a2a);nb.og.add(m.a.Ab(l.a.a2a));return!0}t.a.instance.Ua(4063308,1,1,"FootnoteEndnoteContainerNodeComplexMerge: Failed to merge FootnoteEndnoteContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
nb.Ng.value.xf.id,ac);return!1}static mh(){return new Ra}static get instance(){return Ra.Pg.value}}Ra.Pg=new a.a(Ra.mh);Object(D.a)(Ra,"FootnoteEndnoteContainerNodeComplexMerge",k.a,[]);class Ga extends k.a{constructor(){super()}get Yn(){return 12}get yA(){return 3}xk(){const nb=super.xk();nb.Z(m.a.Ab(l.a.soa),1);return nb}oC(nb,ac){const zc=nb.gl,Ib=nb.Xd;if(ac===m.a.Ab(l.a.soa)){let ya=-1;t.a.instance.Ua(5002527,1,4,"FootnoteEndnoteNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
zc.id,zc.Qc,ac);const ib=Ib.getPropertyInt32(nb.Ng.value.xf,l.a.soa),wb=Ib.getPropertyInt32(nb.En.value.xf,l.a.soa);null!=ib&&-1!==ib?ya=ib:null!=wb&&(ya=wb);Ib.setPropertyInt32(zc,l.a.soa,ya);nb.og.add(ac);return!0}t.a.instance.Ua(5002528,1,4,"FootnoteEndnoteNodeComplexMerge: Failed to merge FootnoteEndnoteNodeComplexMerge [Id: {0}] due to a conflicting change on [PropertyId: {1}]",nb.Ng.value.tu.id,ac);return!1}static mh(){return new Ga}static get instance(){t.a.instance.Ua(5002526,1,4,"FootnoteEndnoteNodeComplexMerge: Got Instance");
return Ga.Pg.value}}Ga.Pg=new a.a(Ga.mh);Object(D.a)(Ga,"FootnoteEndnoteNodeComplexMerge",k.a,[]);class ta extends k.a{constructor(){super()}get Yn(){return 47}xk(){const nb=super.xk();nb.Z(m.a.Ab(l.a.glossaryPageContentNode),1);return nb}oC(nb,ac){return ac===m.a.Ab(l.a.glossaryPageContentNode)?(t.a.instance.Ua(525099865,1,4,"GlossaryPageManifestNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",nb.gl.id,nb.gl.Qc,ac),k.a.FPf(nb,this,l.a.glossaryPageContentNode)):
!1}static mh(){return new ta}static get instance(){return ta.Pg.value}}ta.Pg=new a.a(ta.mh);Object(D.a)(ta,"GlossaryPageManifestNodeComplexMerge",k.a,[]);class va extends k.a{constructor(){super()}get Yn(){return 13}get yA(){return 3}xk(){const nb=super.xk();nb.Z(m.a.Ab(l.a.Vja),4);return nb}static mh(){return new va}static get instance(){return va.Pg.value}}va.Pg=new a.a(va.mh);Object(D.a)(va,"HeaderFooterContainerNodeComplexMerge",k.a,[]);class ia extends k.a{constructor(){super()}get Yn(){return 14}get yA(){return 3}xk(){const nb=
super.xk();nb.Z(m.a.Ab(l.a.runId),3);nb.Z(m.a.Ab(l.a.Wc),3);nb.Z(m.a.Ab(l.a.jvi),3);nb.Z(m.a.Ab(l.a.IU),1);nb.Z(m.a.Ab(e.a.B0),1);nb.Z(m.a.Ab(y.a.imageAltText),1);nb.Z(m.a.Ab(l.a.sY),1);nb.Z(m.a.Ab(y.a.Sda),1);nb.Z(m.a.Ab(e.a.K9a),1);nb.Z(m.a.Ab(l.a.F_a),1);return nb}oC(nb,ac){if(ac===m.a.Ab(y.a.imageAltText)||ac===m.a.Ab(l.a.sY)||ac===m.a.Ab(l.a.IU)||ac===m.a.Ab(l.a.tY)||ac===m.a.Ab(y.a.jkb)||ac===m.a.Ab(y.a.Sda)||ac===m.a.Ab(e.a.B0)||ac===m.a.Ab(e.a.K9a)||ac===m.a.Ab(l.a.F_a)){const Ib=nb.gl;var zc=
nb.Xd;t.a.instance.Ua(4018185,1,4,"ImageNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Ib.id,Ib.Qc,ac);const ya=zc.getPropertyInt32(nb.Ng.value.xf,e.a.B0);zc=zc.getPropertyInt32(nb.En.value.xf,e.a.B0);if(null!=ya&&(0===ya||2===ya))return!0;if(null!=zc&&(0===zc||2===zc))return ac=nb.En.value.xf,this.Cgb(ac,Ib,y.a.imageAltText),this.Cgb(ac,Ib,l.a.sY),this.Cgb(ac,Ib,l.a.tY),ac.hasProperty(l.a.IU)&&this.Cgb(ac,Ib,l.a.IU),this.Cgb(ac,Ib,y.a.jkb),this.Cgb(ac,
Ib,y.a.Sda),this.Cgb(ac,Ib,e.a.B0),this.Cgb(ac,Ib,e.a.K9a),nb.og.add(m.a.Ab(y.a.imageAltText)),nb.og.add(m.a.Ab(l.a.sY)),nb.og.add(m.a.Ab(l.a.tY)),nb.og.add(m.a.Ab(l.a.IU)),nb.og.add(m.a.Ab(y.a.jkb)),nb.og.add(m.a.Ab(y.a.Sda)),nb.og.add(m.a.Ab(e.a.B0)),nb.og.add(m.a.Ab(e.a.K9a)),nb.og.add(m.a.Ab(l.a.F_a)),!0}t.a.instance.Ua(4018186,1,4,"ImageNodeComplexMerge: Failed to merge ImageNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",nb.Ng.value.tu.id,ac);return!1}static mh(){return new ia}static get instance(){return ia.Pg.value}}
ia.Pg=new a.a(ia.mh);Object(D.a)(ia,"ImageNodeComplexMerge",k.a,[]);class qa extends k.a{constructor(){super()}get Yn(){return 40}get yA(){return 0}static mh(){return new qa}static get instance(){return qa.Pg.value}}qa.Pg=new a.a(qa.mh);Object(D.a)(qa,"IntelligenceAnnotationNodeComplexMerge",k.a,[]);class pa extends k.a{constructor(){super()}get Yn(){return 32}get yA(){return 0}static mh(){return new pa}static get instance(){return pa.Pg.value}}pa.Pg=new a.a(pa.mh);Object(D.a)(pa,"IntelligenceContentLocatorNodeComplexMerge",
k.a,[]);class Fa extends k.a{constructor(){super()}get Yn(){return 34}get yA(){return 0}xk(){const nb=super.xk();nb.Z(m.a.Ab(l.a.Nkb),1);return nb}oC(nb,ac){const zc=nb.gl,Ib=nb.Xd;if(ac===m.a.Ab(l.a.Nkb)){ac=Ib.getPropertyObjectIds(nb.Ng.value.tu,l.a.Nkb);const ya=Ib.getPropertyObjectIds(nb.Ng.value.xf,l.a.Nkb),ib=Ib.getPropertyObjectIds(nb.En.value.xf,l.a.Nkb);ac=this.kHa(ac,ya,ib);Ib.setPropertyObjectIds(zc,l.a.Nkb,ac);nb.og.add(m.a.Ab(l.a.Nkb));return!0}return!1}static mh(){return new Fa}static get instance(){return Fa.Pg.value}}
Fa.Pg=new a.a(Fa.mh);Object(D.a)(Fa,"IntelligenceRegionNodeComplexMerge",k.a,[]);class za extends k.a{constructor(){super()}get Yn(){return 35}get yA(){return 0}static mh(){return new za}static get instance(){return za.Pg.value}}za.Pg=new a.a(za.mh);Object(D.a)(za,"IntelligenceRejectionNodeComplexMerge",k.a,[]);class Oa extends k.a{constructor(){super()}get Yn(){return 39}get yA(){return 0}static mh(){return new Oa}static get instance(){return Oa.Pg.value}}Oa.Pg=new a.a(Oa.mh);Object(D.a)(Oa,"IntelligenceReviewedNodeComplexMerge",
k.a,[]);class xa extends k.a{constructor(){super()}get Yn(){return 33}get yA(){return 0}xk(){const nb=super.xk();nb.Z(m.a.Ab(l.a.wVc),1);nb.Z(m.a.Ab(l.a.pYd),1);nb.Z(m.a.Ab(l.a.LCf),1);nb.Z(m.a.Ab(l.a.NCf),1);return nb}oC(nb,ac){const zc=nb.gl,Ib=nb.Xd;if(ac===m.a.Ab(l.a.wVc)||ac===m.a.Ab(l.a.pYd)||ac===m.a.Ab(l.a.LCf)||ac===m.a.Ab(l.a.NCf)){ac=ac===m.a.Ab(l.a.wVc)?l.a.wVc:l.a.pYd;var ya=Ib.getPropertyObjectIds(nb.Ng.value.tu,ac);const ib=Ib.getPropertyObjectIds(nb.Ng.value.xf,ac),wb=Ib.getPropertyObjectIds(nb.En.value.xf,
ac);ya=this.kHa(ya,ib,wb);Ib.setPropertyObjectIds(zc,ac,ya);nb.og.add(m.a.Ab(ac));return!0}return!1}static mh(){return new xa}static get instance(){return xa.Pg.value}}xa.Pg=new a.a(xa.mh);Object(D.a)(xa,"IntelligenceRootNodeComplexMerge",k.a,[]);class fa extends k.a{constructor(){super()}get Yn(){return 42}get yA(){return 0}static mh(){return new fa}static get instance(){return fa.Pg.value}}fa.Pg=new a.a(fa.mh);Object(D.a)(fa,"IntelligenceSettingNodeComplexMerge",k.a,[]);class Ka extends k.a{constructor(){super()}get Yn(){return 45}get yA(){return 0}static mh(){return new Ka}static get instance(){return Ka.Pg.value}}
Ka.Pg=new a.a(Ka.mh);Object(D.a)(Ka,"IntelligenceWorkflowNodeComplexMerge",k.a,[]);class lb extends k.a{constructor(){super()}get Yn(){return 15}get yA(){return 3}static mh(){return new lb}static get instance(){return lb.Pg.value}}lb.Pg=new a.a(lb.mh);Object(D.a)(lb,"NumberListNodeComplexMerge",k.a,[]);var Xa=c(119);class kb extends k.a{constructor(){super()}get Yn(){return 16}get yA(){return 0}xk(){const nb=super.xk();nb.Z(m.a.Ab(l.a.iBb),1);nb.Z(m.a.Ab(Xa.a.E9e),7);nb.Z(m.a.Ab(Xa.a.C9e),7);return nb}oC(nb,
ac){const zc=nb.gl,Ib=nb.Xd;if(ac===m.a.Ab(l.a.iBb))return this.CJf(Ib,nb.Ng.value.xf,nb.En.value.xf,zc,l.a.iBb),nb.og.add(ac),!0;t.a.instance.Ua(4207940,1,4,"OutlineElementNodeComplexMerge: Failed to merge OutlineElementNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",nb.Ng.value.tu.id,ac);return!1}static mh(){return new kb}static get instance(){return kb.Pg.value}}kb.Pg=new a.a(kb.mh);Object(D.a)(kb,"OutlineElementNodeComplexMerge",k.a,[]);class Bb extends k.a{constructor(){super()}get Yn(){return 17}xk(){const nb=
super.xk();nb.Z(m.a.Ab(l.a.iBb),1);nb.Z(m.a.Ab(l.a.Zna),1);nb.Z(m.a.Ab(Xa.a.vJ),1);nb.Z(m.a.Ab(Xa.a.Oec),1);nb.Z(m.a.Ab(Xa.a.ija),8);return nb}oC(nb,ac){const zc=nb.gl,Ib=nb.Xd;if(ac===m.a.Ab(l.a.iBb))return this.CJf(Ib,nb.Ng.value.xf,nb.En.value.xf,zc,l.a.iBb),nb.og.add(ac),!0;if(ac===m.a.Ab(l.a.Zna)){var ya=Ib.getPropertyBool(nb.Ng.value.xf,l.a.Zna),ib=Ib.getPropertyBool(nb.En.value.xf,l.a.Zna);Ib.setPropertyBool(zc,l.a.Zna,null==ya?!1:ya&&null==ib?!1:ib);nb.og.add(ac);return!0}if(ac===m.a.Ab(Xa.a.Oec))return this.CJf(Ib,
nb.Ng.value.xf,nb.En.value.xf,zc,Xa.a.Oec),nb.og.add(ac),!0;if(ac===m.a.Ab(Xa.a.vJ))return ya=Ib.getPropertyBool(nb.Ng.value.xf,Xa.a.vJ),ib=Ib.getPropertyBool(nb.En.value.xf,Xa.a.vJ),Ib.setPropertyBool(zc,Xa.a.vJ,null==ya?!0:ya||null==ib?!0:ib),nb.og.add(ac),!0;t.a.instance.Ua(4057305,1,4,"OutlineGroupNodeComplexMerge: Failed to merge OutlineGroupNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",nb.Ng.value.tu.id,ac);return!1}static mh(){return new Bb}static get instance(){return Bb.Pg.value}}
Bb.Pg=new a.a(Bb.mh);Object(D.a)(Bb,"OutlineGroupNodeComplexMerge",k.a,[]);var Ja=c(41),Ma=c(54);class fb extends k.a{constructor(){super()}get Yn(){return 18}get yA(){return 2}xk(){const nb=super.xk();nb.Z(m.a.Ab(l.a.jWd),3);nb.Z(m.a.Ab(y.a.jV),this.yA);nb.Z(m.a.Ab(l.a.jt),1);nb.Z(m.a.Ab(l.a.e$),1);nb.Z(m.a.Ab(l.a.sq),1);nb.Z(m.a.Ab(Ja.a.xF),1);nb.Z(m.a.Ab(Ja.a.GSa),1);return nb}oC(nb,ac){const zc=nb.Xd;if(nb.uq.runtime.Zb.isFeatureEnabled(72)){if(ac===m.a.Ab(l.a.jt)||ac===m.a.Ab(l.a.e$)||ac===m.a.Ab(Ja.a.GSa)||
ac===m.a.Ab(l.a.sq)||ac===m.a.Ab(Ja.a.xF))return this.NQo(zc,nb)}else if(ac===m.a.Ab(l.a.jt)||ac===m.a.Ab(l.a.sq)){let Ib,ya;({DJc:ac,p4a:Ib,f4a:ya}=this.N7e(Object(Ma.a)(zc,zc.getPropertyUint32s,"getPropertyUint32s"),nb.Ng.value.tu,nb.Ng.value.xf,nb.En.value.xf,l.a.jt,null));if(!ya&&!Ib)return t.a.instance.Ua(4318873,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",nb.Ng.value.xf.id,m.a.Ab(l.a.jt)),!0;let ib,wb,bc;({DJc:ib,
p4a:wb,f4a:bc}=this.N7e(Object(Ma.a)(zc,zc.getPropertyObjectIds,"getPropertyObjectIds"),nb.Ng.value.tu,nb.Ng.value.xf,nb.En.value.xf,l.a.sq,null));if(!wb&&!bc)return t.a.instance.Ua(4318874,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",nb.Ng.value.xf.id,m.a.Ab(l.a.sq)),!0;const lc=wb&&!bc;if((Ib&&!ya)!==lc)return t.a.instance.Ua(4318875,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
nb.Ng.value.xf.id,m.a.Ab(l.a.jt),m.a.Ab(l.a.sq)),!1;lc&&(zc.setPropertyObjectIds(nb.gl,l.a.sq,ib),zc.setPropertyUint32s(nb.gl,l.a.jt,ac));t.a.instance.Ua(4318877,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [PropertyId: {1}] [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}]. [PropertyId: {3}] [favoredEquivalentToBase: {4}] [conflictEquivalentToBase: {5}]",nb.Ng.value.xf.id,m.a.Ab(l.a.jt),Ib,ya,m.a.Ab(l.a.sq),wb,bc);nb.og.add(m.a.Ab(l.a.sq));nb.og.add(m.a.Ab(l.a.jt));
return!0}t.a.instance.Ua(4318878,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",nb.Ng.value.xf.id,ac);return!1}joi(nb,ac,zc,Ib){let ya;({DJc:ac,p4a:Ib,f4a:ya}=this.N7e(ac,zc.Ng.value.tu,zc.Ng.value.xf,zc.En.value.xf,nb,Ib));return ya||Ib?{returnValue:!0,a$e:ac,p4a:Ib,f4a:ya}:(t.a.instance.Ua(592545113,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
zc.Ng.value.xf.id.toString(),m.a.Ab(nb)),{returnValue:!1,a$e:ac,p4a:Ib,f4a:ya})}ini(nb,ac,zc,Ib,ya){let ib;let wb,bc,lc,Kb;({a$e:ib,p4a:Bc,f4a:wb,returnValue:lc}=this.joi(nb,Object(Ma.a)(zc,zc.getPropertyUint32s,"getPropertyUint32s"),Ib,null));({a$e:zc,p4a:ya,f4a:bc,returnValue:Kb}=this.joi(ac,Object(Ma.a)(zc,zc.getPropertyObjectIds,"getPropertyObjectIds"),Ib,ya));var Bc=Bc&&!wb;return lc&&Kb?Bc!==(ya&&!bc)?(t.a.instance.Ua(592545114,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
Ib.Ng.value.xf.id.toString(),m.a.Ab(nb),m.a.Ab(ac)),{returnValue:2,PHd:ib,OHd:zc,zle:Bc}):{returnValue:0,PHd:ib,OHd:zc,zle:Bc}:{returnValue:1,PHd:ib,OHd:zc,zle:Bc}}PEf(nb){let ac=!0;nb.forEach(zc=>zc!==ea.a.nil?ac=!1:!0);return ac}AXl(nb,ac,zc){return this.PEf(nb)&&this.PEf(ac)&&this.PEf(zc)?!0:!1}NQo(nb,ac){let zc,Ib,ya,ib,wb,bc;var lc=({PHd:ib,OHd:wb,zle:Ib}=this.ini(Ja.a.GSa,l.a.sq,nb,ac,null)).returnValue;if(2===lc||1===lc)return!0;({PHd:ya,OHd:bc,zle:zc,returnValue:lc}=this.ini(l.a.jt,l.a.e$,
nb,ac,Object(Ma.a)(this,this.AXl,"getExtendedGuidEquivalence")));if(2===lc||1===lc)return!0;let Kb;({DJc:lc,p4a:Bc,f4a:Kb}=this.XVk(Object(Ma.a)(nb,nb.getPropertyDictionary,"getPropertyDictionary"),ac.Ng.value.tu,ac.Ng.value.xf,ac.En.value.xf,Ja.a.xF));if(!Kb&&!Bc)return t.a.instance.Ua(592545115,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",ac.Ng.value.xf.id.toString(),m.a.Ab(Ja.a.xF)),!0;var Bc=Bc&&!Kb;if(zc!==Ib||zc!==
Bc)return t.a.instance.Ua(592545116,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}], [PropertyId: {2}] and [PropertyId: {3}] differently. [takeConflictingAbsListId: {4}] [takeConflictingListId: {5}] [takeConflictingMap: {6}]",ac.Ng.value.xf.id.toString(),m.a.Ab(l.a.jt),m.a.Ab(Ja.a.GSa),m.a.Ab(Ja.a.xF),Ib,zc,Bc),!0;zc&&(nb.setPropertyObjectIds(ac.gl,l.a.sq,wb),nb.setPropertyUint32s(ac.gl,Ja.a.GSa,ib),nb.setPropertyObjectIds(ac.gl,
l.a.e$,bc),nb.setPropertyUint32s(ac.gl,l.a.jt,ya),nb.setPropertyDictionary(ac.gl,Ja.a.xF,lc));t.a.instance.Ua(592545118,1,4,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [takeConflictingNSID: {1}] [takeConflictingListId: {2}] [takeConflictingMap: {3}]",ac.Ng.value.xf.id.toString(),Ib,zc,Bc);ac.og.add(m.a.Ab(Ja.a.GSa));ac.og.add(m.a.Ab(l.a.sq));ac.og.add(m.a.Ab(l.a.jt));ac.og.add(m.a.Ab(l.a.e$));ac.og.add(m.a.Ab(Ja.a.xF));return!0}static mh(){return new fb}static get instance(){return fb.Pg.value}}
fb.Pg=new a.a(fb.mh);Object(D.a)(fb,"PageContentNodeComplexMerge",k.a,[]);class hc extends k.a{constructor(){super()}get Yn(){return 19}xk(){const nb=super.xk();nb.Z(m.a.Ab(l.a.QIa),1);nb.Z(m.a.Ab(l.a.appsNode),2);nb.Z(m.a.Ab(l.a.customXmlPartContainerNode),2);nb.Z(m.a.Ab(l.a.intelligenceRootNode),1);return nb}oC(nb,ac){const zc=nb.Xd;if(ac===m.a.Ab(l.a.QIa)){var Ib=zc.getPropertyObjectIds(nb.Ng.value.tu,l.a.QIa),ya=zc.getPropertyObjectIds(nb.Ng.value.xf,l.a.QIa),ib=zc.getPropertyObjectIds(nb.En.value.xf,
l.a.QIa);if((Ib=this.Vcn(Ib,ya,ib,(wb,bc)=>wb.equals(bc),wb=>{let bc;({value:bc}=nb.uq.runtime.Nq.Fc(wb)).returnValue?nb.uq.runtime.un.Z(wb,new z.a(bc,!1)):t.a.instance.shipAssertTag(4034653,1,!1,"PageManifestNodeComplexMerge failed to shared formatting object with [id: {0}] in conflicting revision.")},nb.uq))&&0<Ib.length)return zc.setPropertyObjectIds(nb.gl,l.a.QIa,Ib),nb.og.add(m.a.Ab(l.a.QIa)),!0}if(ac===m.a.Ab(l.a.intelligenceRootNode))return Ib=zc.getPropertyObjectIds(nb.Ng.value.tu,l.a.intelligenceRootNode),
ya=zc.getPropertyObjectIds(nb.Ng.value.xf,l.a.intelligenceRootNode),ib=zc.getPropertyObjectIds(nb.En.value.xf,l.a.intelligenceRootNode),Ib=this.kHa(Ib,ya,ib),zc.setPropertyObjectIds(nb.gl,l.a.intelligenceRootNode,Ib),nb.og.add(ac),!0;t.a.instance.Ua(4018187,1,4,"PageManifestNodeComplexMerge: Failed to merge PageManifestNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",nb.Ng.value.xf.id,ac);return!1}static mh(){return new hc}static get instance(){return hc.Pg.value}}hc.Pg=new a.a(hc.mh);
Object(D.a)(hc,"PageManifestNodeComplexMerge",k.a,[]);class cc extends k.a{constructor(){super()}get Yn(){return 43}xk(){const nb=super.xk();nb.Z(m.a.Ab(l.a.Tma),0);nb.Z(m.a.Ab(l.a.DNb),0);nb.Z(m.a.Ab(l.a.WJb),0);nb.Z(m.a.Ab(l.a.Woa),1);nb.Z(m.a.Ab(l.a.sessionId),3);nb.Z(m.a.Ab(l.a.buildVersion),3);nb.Z(m.a.Ab(l.a.LR),1);nb.Z(m.a.Ab(l.a.Fyi),1);nb.Z(m.a.Ab(l.a.ov),1);return nb}oC(nb,ac){if(ac===m.a.Ab(l.a.LR)||ac===m.a.Ab(l.a.Fyi)||ac===m.a.Ab(l.a.ov)){var zc=nb.En.value.xf,Ib=nb.Ng.value.xf,ya=m.a.XX(ac);
Ib=nb.Xd.getPropertyBool(Ib,ya);zc=nb.Xd.getPropertyBool(zc,ya);nb.Xd.setPropertyBool(nb.gl,ya,null==Ib?!1:Ib&&null==zc?!1:zc);nb.og.add(ac);return!0}if(ac===m.a.Ab(l.a.Woa)){ac=nb.Xd;zc=nb.Ng.value.tu;Ib=nb.En.value.xf;ya=nb.Ng.value.xf;zc=zc?ac.getPropertyObjectId(zc,l.a.Woa):null;Ib=Ib?ac.getPropertyObjectId(Ib,l.a.Woa):null;ya=ya?ac.getPropertyObjectId(ya,l.a.Woa):null;t.a.instance.Ua(589657691,1,4,"GraphFeatureChild Merge Attempt: [Base: {0}] [Conflict: {1}] [Favored: {2}]",zc?zc.toString():
"NULL",Ib?Ib.toString():"NULL",ya?ya.toString():"NULL");if(Ib){if(ya&&Ib.equals(ya))return nb.og.add(m.a.Ab(l.a.Woa)),ac.setPropertyObjectId(nb.gl,l.a.Woa,Ib),!0;if(ha.a.EVd.equals(Ib))return nb.og.add(m.a.Ab(l.a.Woa)),ac.setPropertyObjectId(nb.gl,l.a.Woa,ha.a.EVd),!0}if(ya&&ha.a.EVd.equals(ya))return nb.og.add(m.a.Ab(l.a.Woa)),ac.setPropertyObjectId(nb.gl,l.a.Woa,ha.a.EVd),!0;t.a.instance.Ua(589657692,1,2,"GraphFeatureChild Merge Failure: [Base: {0}] [Conflict: {1}] [Favored: {2}]",zc?zc.toString():
"NULL",Ib?Ib.toString():"NULL",ya?ya.toString():"NULL")}return!1}static mh(){return new cc}static get instance(){return cc.Pg.value}}cc.Pg=new a.a(cc.mh);Object(D.a)(cc,"PageMetadataNodeComplexMerge",k.a,[]);var mb=c(1805),Hb=c(174);class Ua extends k.a{constructor(){super()}get Yn(){return 31}xk(){const nb=super.xk();nb.Z(m.a.Ab(Hb.a.MA),1);nb.Z(m.a.Ab(l.a.listID),3);nb.Z(m.a.Ab(l.a.listLevel),1);nb.Z(m.a.Ab(l.a.Ie),3);nb.Z(m.a.Ab(l.a.J3b),3);nb.Z(m.a.Ab(l.a.runId),3);nb.Z(m.a.Ab(l.a.lNd),3);nb.Z(m.a.Ab(y.a.fontColor),
3);nb.Z(m.a.Ab(l.a.pIh),3);nb.Z(m.a.Ab(l.a.Wc),1);nb.Z(m.a.Ab(Hb.a.nZd),3);nb.Z(m.a.Ab(Hb.a.qJf),3);nb.Z(m.a.Ab(Hb.a.dXc),3);nb.Z(m.a.Ab(l.a.lIl),3);nb.Z(m.a.Ab(Xa.a.DEj),3);for(let ac=0;ac<Ua.p5a.length;ac++)nb.Z(Ua.p5a[ac],1);return nb}oC(nb,ac){var zc=nb.Xd;const Ib=nb.gl;m.a.XX(ac);if(ac===m.a.Ab(l.a.Wc)){zc=nb.Xd.getPropertyInt32(nb.En.value.xf,l.a.Wc);if(null==zc||!zc)return!0;nb.Xd.setPropertyInt32(Ib,l.a.Wc,zc);nb.og.add(ac);return!0}if(ac===m.a.Ab(Hb.a.MA)){const ya=zc.getPropertyUint32(nb.Ng.value.xf,
Hb.a.MA),ib=zc.getPropertyUint32(nb.En.value.xf,Hb.a.MA);if(null!=ya&&null!=ib&&ya===ib)return zc.setPropertyUint32(Ib,Hb.a.MA,ya),nb.og.add(ac),!0;if(null==ya&&null==ib)return Ib.removeProperty(Hb.a.MA),nb.og.add(m.a.Ab(Hb.a.MA)),!0;if(null!=ya&&null==ib)return zc.setPropertyUint32(Ib,Hb.a.MA,ya),nb.og.add(ac),!0;if(null==ya&&null!=ib)return zc.setPropertyUint32(Ib,Hb.a.MA,ib),nb.og.add(ac),!0}else{if(ac===m.a.Ab(l.a.listLevel))return this.dQo(zc,nb);if(Array.contains(Ua.p5a,ac))return this.cQo(nb)}return!1}cQo(nb){let ac=
!0,zc=!0,Ib,ya;({EMm:ac,UJm:zc,wBl:Ib,q4k:ya}=this.YVk(nb));t.a.instance.Ua(578932993,1,4,"PersistablePropertySetComplexMerge: Merging ListDef properties [Id: {0}]. [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}].",nb.Ng.value.xf.id.toString(),ac,zc);return ac&&!zc?(this.LPi(ya,nb),!0):ac?!1:(this.LPi(Ib,nb),!0)}YVk(nb){let ac,zc,Ib,ya;const ib=nb.En.value;let wb;const bc=nb.Ng.value;let lc;zc=ac=!0;Ib=new G.a;ya=new G.a;for(let Kb=0;Kb<Ua.p5a.length;Kb++){const Bc=Ua.p5a[Kb],Xc=({value:wb}=
ib.Tqa.Fc(Bc)).returnValue;({value:lc}=bc.Tqa.Fc(Bc)).returnValue&&(ac=this.HCj(nb.Ng,Ib,lc,Bc)&&ac);Xc&&(zc=this.HCj(nb.En,ya,wb,Bc)&&zc)}return{EMm:ac,UJm:zc,wBl:Ib,q4k:ya}}HCj(nb,ac,zc,Ib){const ya=m.a.XX(Ib);nb=nb.value.xf;ac.Z(Ib,nb.hasProperty(ya)?nb.yU(ya):null);return!zc.AY}LPi(nb,ac){const zc=ac.gl;for(let ya=0;ya<Ua.p5a.length;ya++){var Ib=Ua.p5a[ya];const ib=m.a.XX(Ib);(Ib=nb.J(Ib))?zc.sUa(ib,Ib):zc.removeProperty(ib)}for(nb=0;nb<Ua.p5a.length;nb++)ac.og.add(Ua.p5a[nb]);t.a.instance.Ua(578932994,
1,4,"PersistablePropertySetComplexMerge: Completed Merging ListDef properties [Id: {0}].",ac.Ng.value.xf.id.toString())}dQo(nb,ac){const zc=ac.gl,Ib=nb.getPropertyInt32(ac.Ng.value.xf,l.a.listLevel),ya=nb.getPropertyInt32(ac.En.value.xf,l.a.listLevel);return null!=Ib&&null!=ya&&Ib===ya?(nb.setPropertyInt32(zc,l.a.listLevel,Ib),ac.og.add(m.a.Ab(l.a.listLevel)),!0):null==Ib&&null==ya?(zc.removeProperty(l.a.listLevel),ac.og.add(m.a.Ab(l.a.listLevel)),!0):null!=Ib&&null==ya?(nb.setPropertyInt32(zc,l.a.listLevel,
Ib),ac.og.add(m.a.Ab(l.a.listLevel)),!0):null==Ib&&null!=ya?(nb.setPropertyInt32(zc,l.a.listLevel,ya),ac.og.add(m.a.Ab(l.a.listLevel)),!0):!1}static mh(){return new Ua}static get instance(){return Ua.Pg.value}}Ua.Pg=new a.a(Ua.mh);Ua.p5a=[m.a.Ab(l.a.ee),m.a.Ab(l.a.ot),m.a.Ab(y.a.k5),m.a.Ab(l.a.vda),m.a.Ab(l.a.pv),m.a.Ab(l.a.ks),m.a.Ab(y.a.Z0),m.a.Ab(l.a.Z3e),m.a.Ab(y.a.font),m.a.Ab(Xa.a.Amb),m.a.Ab(e.a.Vv)];Object(D.a)(Ua,"PersistablePropertySetComplexMerge",k.a,[]);class Ya extends k.a{constructor(){super()}get Yn(){return 21}get yA(){return 0}static mh(){return new Ya}static get instance(){return Ya.Pg.value}}
Ya.Pg=new a.a(Ya.mh);Object(D.a)(Ya,"RevisionMetadataNodeComplexMerge",k.a,[]);class Fb extends k.a{constructor(){super()}get Yn(){return 48}xk(){const nb=super.xk();nb.Z(m.a.Ab(l.a.j4i),3);return nb}static mh(){return new Fb}static get instance(){return Fb.Pg.value}}Fb.Pg=new a.a(Fb.mh);Object(D.a)(Fb,"ShadowNumberListNodeComplexMerge",k.a,[]);class Wa extends k.a{constructor(){super()}get Yn(){return 22}xk(){const nb=super.xk();nb.Z(m.a.Ab(l.a.g5a),7);nb.Z(m.a.Ab(l.a.LXc),2);return nb}static mh(){return new Wa}static get instance(){return Wa.Pg.value}}
Wa.Pg=new a.a(Wa.mh);Object(D.a)(Wa,"SharedPersistablePropertySetComplexMerge",k.a,[]);class yb extends k.a{constructor(){super()}get Yn(){return 38}get yA(){return 3}static mh(){return new yb}static get instance(){return yb.Pg.value}}yb.Pg=new a.a(yb.mh);Object(D.a)(yb,"StylePropertySetComplexMerge",k.a,[]);var Yb=c(1613),qc=c(1659);class Hc extends k.a{constructor(){super()}get Yn(){return 23}get yA(){return 0}xk(){const nb=super.xk();nb.Z(m.a.Ab(y.a.gf),4);nb.Z(m.a.Ab(l.a.rowSpan),1);nb.Z(m.a.Ab(l.a.colSpan),
1);nb.Z(m.a.Ab(l.a.ghostCell),1);nb.Z(m.a.Ab(Ja.a.vMerge),1);nb.Z(m.a.Ab(Ja.a.gridSpan),1);nb.Z(m.a.Ab(l.a.Z8a),2);nb.Z(m.a.Ab(l.a.Drb),2);nb.Z(m.a.Ab(l.a.oJa),2);nb.Z(m.a.Ab(l.a.$qb),5);return nb}dKb(nb){if(!nb)return t.a.instance.Ua(573957923,1,2,"Feature helper is null"),!1;nb.Ux(106);return nb.isFeatureEnabled(106)}Wxa(nb){if(!nb)return t.a.instance.Ua(540120285,1,2,"Feature helper is null"),!1;nb.Ux(107);return nb.isFeatureEnabled(107)}oC(nb,ac){nb.uq.runtime.eH("TableCellNodeComplexMerge.TryMergeCustomProperty, propertyId:"+
ac);var zc=ac===m.a.Ab(l.a.rowSpan)||ac===m.a.Ab(l.a.colSpan)||ac===m.a.Ab(l.a.ghostCell);this.Wxa(nb.uq.runtime.Zb)&&(zc=zc||ac===m.a.Ab(Ja.a.vMerge)||ac===m.a.Ab(Ja.a.gridSpan));if(!this.dKb(nb.uq.runtime.Zb))return!zc;var Ib=nb.En.value.tu,ya=qc.e(nb.uq,Ib,null);if(ya.equals(ea.a.nil))return t.a.instance.Ua(573845783,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",Ib.id),nb.uq.logger.Rg(Object.assign(new Yb.a,{info:"Table node ID could not be found for table cell"})),
!1;var ib=nb.uq.runtime.FCb.J(ya).J(Ib.id);if(!ib)return!zc;Ib=nb.gl;ya=nb.Xd;if(ac===m.a.Ab(l.a.ghostCell))return ya.setPropertyBool(Ib,l.a.ghostCell,ib.hg),nb.og.add(m.a.Ab(l.a.ghostCell)),!0;if(ac===m.a.Ab(l.a.rowSpan))return ac=ib.rowSpan,ib=ib.colSpan,null!=ac&&null!=ib&&(1<ac||1<ib)?ya.setPropertyUint32(Ib,l.a.rowSpan,ac):Ib.removeProperty(l.a.rowSpan),nb.og.add(m.a.Ab(l.a.rowSpan)),!0;if(ac===m.a.Ab(l.a.colSpan))return ac=ib.rowSpan,zc=ib.colSpan,ib=ib.hg,null!=ac&&null!=zc&&(1<ac||1<zc)?ya.setPropertyUint32(Ib,
l.a.colSpan,zc):ib&&null!=zc?ya.setPropertyUint32(Ib,l.a.colSpan,zc):Ib.removeProperty(l.a.colSpan),nb.og.add(m.a.Ab(l.a.colSpan)),!0;t.a.instance.Ua(573690910,1,2,"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property whose merge strategy is not custom merge. PropertyID:{0}",ac);nb.uq.logger.Rg(Object.assign(new Yb.a,{info:"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property which should not be custom merged"}));return!zc}static mh(){return new Hc}static get instance(){return Hc.Pg.value}}
Hc.Pg=new a.a(Hc.mh);Object(D.a)(Hc,"TableCellNodeComplexMerge",k.a,[]);class $b extends k.a{constructor(){super()}get Yn(){return 24}dKb(nb){if(!nb)return t.a.instance.Ua(573845782,1,2,"Feature helper is null"),!1;nb.Ux(106);return nb.isFeatureEnabled(106)}get yA(){return 0}xk(){const nb=super.xk();nb.Z(m.a.Ab(y.a.gf),1);nb.Z(m.a.Ab(y.a.R1),1);nb.Z(m.a.Ab(y.a.Yza),1);nb.Z(m.a.Ab(l.a.Vmc),1);nb.Z(m.a.Ab(l.a.Y$),1);nb.Z(m.a.Ab(l.a.Z8a),2);nb.Z(m.a.Ab(l.a.Drb),2);nb.Z(m.a.Ab(l.a.oJa),2);return nb}oC(nb,
ac){nb.uq.runtime.eH("TableNodeComplexMerge.TryMergeCustomProperty, PropertyId:"+ac);if(ac===m.a.Ab(y.a.gf)||ac===m.a.Ab(y.a.R1)||ac===m.a.Ab(l.a.Vmc)||ac===m.a.Ab(l.a.Y$)||ac===m.a.Ab(y.a.Yza)){const ya=nb.gl;var zc=nb.Xd;t.a.instance.Ua(4273303,1,4,"TableNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",ya.id,ya.Qc,ac);if(this.Kql(nb))return!1;var Ib=zc.getPropertyObjectIds(nb.Ng.value.tu,y.a.gf);const ib=zc.getPropertyObjectIds(nb.Ng.value.xf,y.a.gf),
wb=zc.getPropertyObjectIds(nb.En.value.xf,y.a.gf);Ib=this.WOi(Ib,ib,wb,(bc,lc)=>bc.equals(lc));if(0<Ib.length)return zc.setPropertyObjectIds(ya,y.a.gf,Ib),zc.setPropertyInt32(ya,y.a.Yza,Ib.length),this.dKb(nb.uq.runtime.Zb)&&({value:ac}=nb.En.value.Tqa.Fc(m.a.Ab(y.a.R1)),{value:zc}=nb.Ng.value.Tqa.Fc(m.a.Ab(y.a.R1)),ac.AY?ya.sUa(y.a.R1,ac.newValue):ya.sUa(y.a.R1,zc.newValue)),nb.og.add(m.a.Ab(y.a.gf)),nb.og.add(m.a.Ab(y.a.R1)),nb.og.add(m.a.Ab(y.a.Yza)),nb.og.add(m.a.Ab(l.a.Vmc)),nb.og.add(m.a.Ab(l.a.Y$)),
!0}t.a.instance.Ua(4018189,1,4,"TableNodeComplexMerge: Failed to merge TableNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",nb.Ng.value.xf.id,ac);return!1}Kql(nb){const ac=nb.En.value,zc=nb.Ng.value;let Ib,ya;({value:Ib}=ac.Tqa.Fc(m.a.Ab(y.a.R1)));({value:ya}=zc.Tqa.Fc(m.a.Ab(y.a.R1)));return Ib.AY||ya.AY?Ib.AY&&ya.AY?(t.a.instance.Ua(4273304,1,4,"TableNodeComplexMerge: Failed to merge TableNode due to columns being changed in both. [Base: {0}] [Favored: {1}] [Conflicting: {2}]",
Ib.oldValue,ya.newValue,Ib.newValue),nb.uq.logger.Rg(Object.assign(new Yb.a,{yj:"DoColumnsConflict",eventId:"aqtsy",info:"Columns changed"})),!0):$b.XTh(nb.uq,Ib,zc,"BaseConflict")||$b.XTh(nb.uq,ya,ac,"BaseFavored")?!0:!1:!1}static mh(){return new $b}static get instance(){return $b.Pg.value}static XTh(nb,ac,zc,Ib){return ac.AY&&({value:ac}=zc.Tqa.Fc(m.a.Ab(y.a.gf)),ac.AY)?(t.a.instance.Ua(4273305,1,4,"TableNodeComplexMerge {0}: Failed to merge TableNode due to columns and rows being changed on different sides of the conflict.",
Ib),nb.logger.Rg(Object.assign(new Yb.a,{yj:"DoColumnsConflictWithRows",eventId:"aqtsz"})),!0):!1}}$b.Pg=new a.a($b.mh);Object(D.a)($b,"TableNodeComplexMerge",k.a,[]);class Ub extends k.a{constructor(){super()}get Yn(){return 25}get yA(){return 0}xk(){const nb=super.xk();nb.Z(m.a.Ab(l.a.Wc),3);nb.Z(m.a.Ab(y.a.gf),4);nb.Z(m.a.Ab(l.a.Z8a),2);nb.Z(m.a.Ab(l.a.Drb),2);nb.Z(m.a.Ab(l.a.oJa),2);nb.Z(m.a.Ab(Ja.a.hlg),2);nb.Z(m.a.Ab(Ja.a.glg),2);nb.Z(m.a.Ab(l.a.$qb),5);return nb}static mh(){return new Ub}static get instance(){return Ub.Pg.value}}
Ub.Pg=new a.a(Ub.mh);Object(D.a)(Ub,"TableRowNodeComplexMerge",k.a,[]);class mc extends k.a{constructor(){super()}xk(){const nb=super.xk();nb.Z(m.a.Ab(l.a.yIo),2);nb.Z(m.a.Ab(y.a.gf),1);return nb}oC(nb,ac){if(ac===m.a.Ab(y.a.gf)){const Ib=nb.gl,ya=nb.Xd;t.a.instance.Ua(42754251,1,4,"TaskContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Ib.id,Ib.Qc,ac);var zc=ya.getPropertyObjectIds(nb.Ng.value.tu,y.a.gf);const ib=ya.getPropertyObjectIds(nb.Ng.value.xf,
y.a.gf),wb=ya.getPropertyObjectIds(nb.En.value.xf,y.a.gf);if(zc=this.gdn(zc,ib,wb))return 0<zc.length?ya.setPropertyObjectIds(Ib,y.a.gf,zc):Ib.removeProperty(y.a.gf),nb.og.add(m.a.Ab(y.a.gf)),!0}t.a.instance.Ua(42754252,1,1,"TaskContentNodeComplexMerge: Failed to merge TaskContent [Id: {0}] due to a conflicting change on [PropertyId: {1}]",nb.Ng.value.xf.id,ac);return!1}gdn(nb,ac,zc){const Ib=new G.a(0);nb.forEach(ib=>{Ib.Z(ib,0);return!0});ac.forEach(ib=>{Ib.nb(ib)?Ib.Z(ib,1):Ib.Z(ib,3);return!0});
zc.forEach(ib=>{let wb;({value:wb}=Ib.Fc(ib)).returnValue?1===wb?Ib.Z(ib,5):3===wb?(t.a.instance.Ua(42754253,1,2,"TaskNode was found added by both sides of merge"),Ib.Z(ib,3)):Ib.Z(ib,2):Ib.Z(ib,4);return!0});const ya=new K.a;Ib.forEach((ib,wb)=>{0!==wb&&2!==wb&&1!==wb&&ya.add(ib);return!0});return ya}static mh(){return new mc}static get instance(){return mc.Pg.value}}mc.Pg=new a.a(mc.mh);Object(D.a)(mc,"TaskContentNodeComplexMerge",k.a,[]);class ic{equals(nb,ac){return nb&&ac?nb.UserId===ac.UserId&&
nb.Provider===ac.Provider&&nb.DisplayName===ac.DisplayName&&nb.Email===ac.Email:!nb&&!ac}KM(){return 0}}Object(D.a)(ic,"CommentTaskPersonComparer",null,[218]);class ab{equals(nb,ac){return nb&&ac?nb.startDate?nb.endDate?nb.startDate.getTime()===ac.startDate.getTime()&&nb.endDate.getTime()===ac.endDate.getTime():!ac.endDate:!ac.startDate:!nb&&!ac}KM(){return 0}}Object(D.a)(ab,"CommentTaskScheduleEqualityComparer",null,[218]);class bb{equals(nb,ac){if(!nb||!ac)return!nb&&!ac;if(!nb.extensions&&!ac.extensions)return!0;
if(!nb.extensions||!ac.extensions||nb.extensions.count!==ac.extensions.count)return!1;let zc=!0;nb.extensions.forEach((Ib,ya)=>{let ib;return({value:ib}=ac.extensions.Fc(Ib)).returnValue&&ya===ib?!0:zc=!1});return zc}KM(){return 0}}Object(D.a)(bb,"ExtensionListEqualityComparer",null,[218]);class Jb{jyl(nb,ac){return nb&&ac?nb.recordId===ac.recordId&&Jb.OPg.equals(nb.user,ac.user)&&Jb.OPg.equals(nb.assignee,ac.assignee)&&nb.type===ac.type&&nb.title===ac.title&&nb.priority===ac.priority&&nb.isLossy===
ac.isLossy&&nb.completion===ac.completion&&nb.commentId===ac.commentId&&nb.time===ac.time&&Jb.GZj.equals(nb.schedule,ac.schedule):!nb&&!ac}equals(nb,ac){return this.jyl(nb,ac)}KM(){return 0}}Jb.OPg=new ic;Jb.GZj=new ab;new bb;Object(D.a)(Jb,"HistoryRecordEqualityComparer",null,[218]);var Eb=c(2109),hb=c(1575);class ob extends k.a{constructor(nb){super();this.CNa=nb}xk(){const nb=super.xk();nb.Z(m.a.Ab(l.a.XRb),5);nb.Z(m.a.Ab(l.a.taskId),2);nb.Z(m.a.Ab(l.a.kIo),2);nb.Z(m.a.Ab(l.a.pIo),2);nb.Z(m.a.Ab(l.a.$za),
1);return nb}gog(nb){if(!nb.En.value.tu&&!nb.Ng.value.tu){const ac=nb.Ng.value.xf.XK();ac.removeProperty(l.a.$za);const zc=nb.Ng.value.xf,Ib=nb.En.value.xf;nb.Ng=new a.a(()=>new hb.a(ac,zc));nb.En=new a.a(()=>new hb.a(ac,Ib))}return super.gog(nb)}oC(nb,ac){if(ac!==m.a.Ab(l.a.$za))return t.a.instance.Ua(42754254,1,1,"TaskSingleNodeComplexMerge: Failed to merge TaskSingle [Id: {0}] due to a conflicting change on [PropertyId: {1}]",nb.Ng.value.xf.id,ac),!1;const zc=nb.gl,Ib=nb.Xd;t.a.instance.Ua(42754255,
1,4,"TaskSingleNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",zc.id,zc.Qc,ac);ac=Ib.getPropertyString(nb.Ng.value.tu,l.a.$za);const ya=Ib.getPropertyString(nb.Ng.value.xf,l.a.$za),ib=Ib.getPropertyString(nb.En.value.xf,l.a.$za);ac=this.fdn(ac,ya,ib);if(!ac)return!1;0<ac.length?Ib.setPropertyString(zc,l.a.$za,ac):zc.removeProperty(l.a.$za);nb.og.add(m.a.Ab(l.a.$za));return!0}fdn(nb,ac,zc){nb=this.CNa.Q6b(nb);ac=this.CNa.Q6b(ac);zc=this.CNa.Q6b(zc);if(!ob.BBi(nb,
ac))return t.a.instance.Ua(42754256,1,1,"MergeTaskHistory: base must be a prefix of the favored entries"),null;if(!ob.BBi(nb,zc))return t.a.instance.Ua(42754257,1,1,"MergeTaskHistory: base must be a prefix of the conflict entries"),null;zc=ob.o1k(nb.length,ac,zc);return this.CNa.ycg(zc)}static mh(){const nb=new Eb.a;return new ob(nb)}static get instance(){return ob.Pg.value}static o1k(nb,ac,zc){const Ib=new K.a;for(let ya=0;ya<ac.length;ya++)Ib.add(ac.J(ya));for(;nb<zc.length;nb++)Ib.add(zc.J(nb));
return Ib}static BBi(nb,ac){const zc=nb.length;if(zc>ac.length)return!1;for(let Ib=0;Ib<zc;Ib++)if(!ob.W5j.equals(ac.J(Ib),nb.J(Ib)))return ac.J(Ib).recordId===nb.J(Ib).recordId&&t.a.instance.Ua(50357519,1,1,"MergeTaskHistory: History records with same RecordId must have all other fields equal"),!1;return!0}}ob.Pg=new a.a(ob.mh);ob.W5j=new Jb;Object(D.a)(ob,"TaskSingleNodeComplexMerge",k.a,[]);class Va extends k.a{constructor(){super()}get Yn(){return 26}xk(){const nb=super.xk();nb.Z(m.a.Ab(y.a.gf),
1);return nb}oC(nb,ac){const zc=y.a.gf;if(ac===m.a.Ab(zc)){ac=nb.gl;const ya=nb.Xd;var Ib=ya.getPropertyObjectIds(nb.Ng.value.tu,zc);const ib=ya.getPropertyObjectIds(nb.Ng.value.xf,zc),wb=ya.getPropertyObjectIds(nb.En.value.xf,zc);Ib=this.mdn(Ib,ib,wb);ya.setPropertyObjectIds(ac,zc,Ib);nb.og.add(m.a.Ab(zc));return!0}return!1}mdn(nb,ac,zc){return this.kHa(nb,ac,zc)}static mh(){return new Va}static get instance(){return Va.Pg.value}}Va.Pg=new a.a(Va.mh);Object(D.a)(Va,"VectorClockContainerNodeComplexMerge",
k.a,[]);class Qb extends k.a{constructor(){super()}get Yn(){return 27}xk(){const nb=super.xk();nb.Z(m.a.Ab(l.a.iQ),1);return nb}oC(nb,ac){const zc=l.a.iQ;if(ac===m.a.Ab(zc)){ac=nb.gl;const Ib=nb.Xd,ya=Ib.getPropertyUint32(nb.Ng.value.xf,zc)||0,ib=Ib.getPropertyUint32(nb.En.value.xf,zc)||0;Ib.setPropertyUint32(ac,zc,this.A4l(ya,ib));nb.og.add(m.a.Ab(zc));return!0}return!1}A4l(nb,ac){return nb>ac?nb:ac}static mh(){return new Qb}static get instance(){return Qb.Pg.value}}Qb.Pg=new a.a(Qb.mh);Object(D.a)(Qb,
"VectorClockNodeComplexMerge",k.a,[]);class Vb extends k.a{constructor(){super()}get Yn(){return 28}get yA(){return 0}xk(){const nb=super.xk();nb.Z(m.a.Ab(l.a.rUh),3);nb.Z(m.a.Ab(l.a.Wc),3);nb.Z(m.a.Ab(l.a.tUh),5);nb.Z(m.a.Ab(l.a.fPi),5);nb.Z(m.a.Ab(l.a.Vja),5);return nb}static mh(){return new Vb}static get instance(){return Vb.Pg.value}}Vb.Pg=new a.a(Vb.mh);Object(D.a)(Vb,"WordSectionNodeComplexMerge",k.a,[]);c.d(I,"a",function(){return Sb});class Sb{uMh(nb,ac){switch(nb.Qc){case 131073:return nb.hasProperty(l.a.imageType)||
nb.hasProperty(e.a.B0)?this.jp(ia.instance,ac):this.jp(Ua.instance,ac);case 1074135140:return this.jp(x.instance,ac);case 1074135137:return this.jp(v.instance,ac);case 1074135139:return this.jp(H.instance,ac);case 1074135138:return this.jp(F.instance,ac);case 1074135136:return this.jp(S.instance,ac);case 1074135157:return this.jp(N.instance,ac);case 1074135152:return this.jp(O.instance,ac);case 1074135153:return this.jp(W.instance,ac);case 1074135126:return this.jp(V.instance,ac);case 1074135127:return this.jp(ba.instance,
ac);case 1074135145:return this.jp(ka.instance,ac);case 1074135144:return this.jp(Z.instance,ac);case 1074135142:return this.jp(ua.instance,ac);case 1074135143:return this.jp(sa.instance,ac);case 1074135163:return this.jp(Da.instance,ac);case 1074135164:return this.jp(Pa.instance,ac);case 1074135124:return this.jp(Ra.instance,ac);case 1074135125:return this.jp(Ga.instance,ac);case 1074135122:return this.jp(va.instance,ac);case 393233:return this.jp(ia.instance,ac);case 1073872970:return this.jp(ia.instance,
ac);case 1074135170:return this.jp(qa.instance,ac);case 1074135168:return this.jp(pa.instance,ac);case 1074135166:return this.jp(Fa.instance,ac);case 1074135167:return this.jp(za.instance,ac);case 1074135169:return this.jp(Oa.instance,ac);case 1074135165:return this.jp(xa.instance,ac);case 393234:return this.jp(lb.instance,ac);case 393229:return this.jp(kb.instance,ac);case 393241:return this.jp(Bb.instance,ac);case 393227:return this.jp(fb.instance,ac);case 131120:return this.jp(cc.instance,ac);
case 393271:return this.jp(hc.instance,ac);case 393230:return this.jp(mb.a.instance,ac);case 131140:return this.jp(Ya.instance,ac);case 1179649:return this.jp(Wa.instance,ac);case 1073872969:return this.jp(yb.instance,ac);case 393252:return this.jp(Hc.instance,ac);case 393250:return this.jp($b.instance,ac);case 393251:return this.jp(Ub.instance,ac);case 1074135154:return this.jp(Va.instance,ac);case 1074135161:return this.jp(mc.instance,ac);case 1074135162:return this.jp(ob.instance,ac);case 1074135155:return this.jp(Qb.instance,
ac);case 1073872968:return this.jp(Vb.instance,ac);case 1074135172:return this.jp(Ka.instance,ac);case 1074135171:return this.jp(fa.instance,ac);case 1074135149:return this.jp(ta.instance,ac);case 1074135151:return this.jp(Fb.instance,ac)}return this.jp(k.a.instance,ac)}jp(nb,ac){nb.Zb=ac?ac():null;return nb}}Object(D.a)(Sb,"GraphNodeComplexMergeFactory",null,[1934])},1991:function(D,I,c){c.r(I);D=c(0);var l=c(1551),e=c(75),a=c(348),k=c(69),x=c(1527);class y{constructor(K,L,R,S=0){this.Wli=K;this.groupType=
L;this.$xf=S;this.S7c=R}}Object(D.a)(y,"SortingGroup",null,[]);class m{constructor(K,L,R,S){this.order=K;this.i9=L;this.lnm=R;this.groupType=S}}Object(D.a)(m,"SortingProp",null,[]);var t=c(1520),z=c(1522),v=c(1519),H=c(25);class F{constructor(K,L){this.VMi={};this.UMi={};this.PMi=this.bNi=1;this.Azh(K,L)}zAo(K,L,R){var S=v.a.FR(R)?this.VMi:this.UMi;R=new e.a;for(var N of L)L=Object(k.a)(m,S[l.a[N.groupType].toLowerCase()]),H.c(L)||R.add(new a.a(L,N));R.Sc((W,V)=>W.key.order<V.key.order?-1:1);Array.clear(K);
N=t.TellMeActor.instance.u_;for(L=0;L<R.count;){S=R.J(L).key.i9;var O=R.J(L).value;const W=new x.a(R.J(L).key.groupType);H.c(N)||N.Location===z.a.contextMenu||(W.displayName=R.J(L).key.lnm);for(const V of O.results)W.Uw(V);for(O=++L;O<R.count&&R.J(O).key.i9===S;)this.v_e(W,R.J(O).value),O=++L;K.push(W)}}RZo(K,L){this.PMi=this.bNi=1;this.Azh(K,L)}Azh(K,L){this.Auj(K);for(var R=0;R<K.length;R++){let S=K[R];for(const N of S.S7c)this.atk(N,R,S.Wli,S.groupType)}this.Auj(L);for(K=0;K<L.length;K++){R=L[K];
for(const S of R.S7c)this.$sk(S,K,R.Wli,R.groupType)}}Auj(K){K.sort((L,R)=>Object(k.a)(y,L).$xf>Object(k.a)(y,R).$xf?-1:1)}atk(K,L,R,S){this.VMi[l.a[K].toLowerCase()]=new m(this.bNi++,L,R,S)}$sk(K,L,R,S){this.UMi[l.a[K].toLowerCase()]=new m(this.PMi++,L,R,S)}v_e(K,L){for(let R=0;R<L.results.length;R++)K.Uw(L.results[R])}}Object(D.a)(F,"BaseGroupingSorter",null,[]);class G{constructor(){this.c4d=[new y("",26,[26]),new y("",24,[24]),new y(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,4,[4,2]),new y(CommonUIStrings.l_TellMeCommandProviderTitle,
7,[18,16,7]),new y(CommonUIStrings.l_TellMeSuggestionsProviderTitle,33,[15,14,19,3]),new y("",13,[13]),new y("",22,[22])];this.Y3d=[new y("",25,[25]),new y(CommonUIStrings.l_TellMeCommandProviderTitle,31,[17,0,1,8,28]),new y(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,32,[2,19,23,29]),new y(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,33,[15,14,20,9,12,10,11,27]),new y("",13,[13]),new y("",22,[22])];this.AMi=new F(this.c4d,this.Y3d)}Aad(K,L,R,S=null,N=null){let O=!1;if(S){for(const W of v.a.FR(R)?
this.c4d:this.Y3d)this.tPn(W,S);O=!0}if(N){for(const W of v.a.FR(R)?this.c4d:this.Y3d)this.SZo(L,W,N);O=!0}O&&this.AMi.RZo(this.c4d,this.Y3d);this.AMi.zAo(K,L,R)}tPn(K,L){const R=new e.a;for(var S of K.S7c){const N=L[l.a[S].toLowerCase()];R.add(new a.a(H.c(N)?Number.MAX_VALUE:N,S))}if(R.count){R.Sc((N,O)=>N.key<O.key?-1:1);L=Array(R.count);for(S=0;S<R.count;S++)L[S]=R.J(S).value;K.S7c=L}}SZo(K,L,R){let S=0;for(const N of L.S7c)if(l.a[N].toLowerCase()in R&&R[l.a[N].toLowerCase()])for(const O of K)if(O.groupType===
N){S+=R[l.a[N].toLowerCase()];break}L.$xf=S}}Object(D.a)(G,"SimplifiedGroupingSorter",null,[]);c.d(I,"GroupsPlacementInfo",function(){return M});class M{constructor(K){this.TMi={};this.QMi={};this.RMi={};this.WMi={};this.BOf={};this.XMi=this.G9m=this.B9m=this.D9m=1;this.ZMi=null;this.Aw=K;this.fPk();this.REn();this.UOk();this.XNk();K.XP&&(this.ZMi=new G)}VE(K){this.TMi[l.a[K].toLowerCase()]=this.D9m++}GH(K,L){this.QMi[l.a[K].toLowerCase()]=L}QNa(K){this.RMi[l.a[K].toLowerCase()]=this.B9m++}P3(K){this.WMi[l.a[K].toLowerCase()]=
this.G9m++}LD(K){this.BOf[l.a[K].toLowerCase()]=this.XMi++}fPk(){const K=!!this.Aw&&this.Aw.Y4a,L=!!this.Aw&&this.Aw.M2c,R=!!this.Aw&&this.Aw.Rlb,S=!!this.Aw&&this.Aw.DIf&&!v.a.Ydc(),N=!!this.Aw&&this.Aw.EYc,O=!!this.Aw&&this.Aw.VYd,W=!!this.Aw&&this.Aw.HGf,V=!!this.Aw&&this.Aw.pDf;this.Aw&&(this.Aw.J7b||this.Aw.kha||this.Aw.FMd)&&this.VE(26);V&&this.VE(24);this.VE(4);this.VE(18);this.VE(16);this.VE(7);this.VE(17);this.VE(0);this.VE(1);W&&this.VE(28);N&&this.VE(23);K||this.VE(2);K&&!L||this.VE(8);
this.VE(15);R&&this.VE(20);this.VE(14);this.VE(9);this.VE(12);this.VE(10);this.VE(11);K&&this.VE(2);K&&!L&&this.VE(8);this.VE(19);O&&this.VE(27);this.VE(21);this.VE(13);S&&this.VE(22);this.VE(30)}REn(){this.GH(21,1);this.GH(4,3);this.GH(18,3);this.GH(16,3);this.GH(7,3);this.GH(17,5);this.GH(0,5);this.GH(1,1);this.GH(28,2);this.GH(2,1);this.GH(8,2);this.GH(15,3);this.GH(14,2);this.GH(27,3);this.GH(9,1);this.GH(12,1);this.GH(10,1);this.GH(11,1);this.GH(19,1);this.GH(23,1);this.GH(13,1);this.GH(24,1);
this.GH(25,1);this.GH(20,2);this.GH(22,1);this.GH(26,1)}UOk(){this.QNa(4);this.QNa(0);this.QNa(17);this.QNa(7);this.QNa(16);this.QNa(18);this.QNa(15);this.QNa(20);this.QNa(8);this.QNa(14)}XNk(){this.P3(14);this.P3(10);this.P3(12);this.P3(9);this.P3(11);this.P3(20);this.P3(15);this.P3(8);this.P3(2);this.P3(1);this.P3(27);this.P3(7);this.P3(18);this.P3(16);this.P3(17);this.P3(0);this.P3(4)}R6n(){this.BOf={};this.XMi=1}Pcm(K,L,R){this.R6n();const S=!!this.Aw&&this.Aw.Y4a,N=!!this.Aw&&this.Aw.M2c,O=!!this.Aw&&
this.Aw.Rlb,W=!!this.Aw&&this.Aw.DIf&&!v.a.Ydc(),V=!!this.Aw&&this.Aw.EYc,Q=!!this.Aw&&this.Aw.VYd,Y=!!this.Aw&&this.Aw.HGf,ba=!!this.Aw&&this.Aw.Cie;K=K&&N;ba&&this.LD(25);this.LD(4);this.LD(18);this.LD(16);this.LD(7);this.LD(17);this.LD(0);this.LD(1);Y&&this.LD(28);V&&this.LD(23);S&&!N||!K||this.LD(8);L&&this.LD(15);S||this.LD(2);Q&&this.LD(27);R&&this.LD(14);S&&!N||K||this.LD(8);L||this.LD(15);O&&this.LD(20);R||this.LD(14);this.LD(9);this.LD(12);this.LD(10);this.LD(11);S&&this.LD(2);S&&!N&&this.LD(8);
this.LD(19);this.LD(21);this.LD(13);W&&this.LD(22);return this.BOf}cP(){return this.Aw}}Object(D.a)(M,"GroupsPlacementInfo",null,[])},1993:function(D,I,c){D=c(0);var l=c(1743),e=c(60);class a{constructor(){this.source=0;this.Gm=this.$Va=this.baa=null;this.Uia=0;this.jIb=!1;this.mode=this.PUa=0;this.$Nc=null;this.HLb=e.a.create()}}Object(D.a)(a,"InputState",null,[]);class k{constructor(){this.timeout=this.succeeded=this.crash=!1;this.$M=null}}Object(D.a)(k,"OutputState",null,[]);class x{constructor(){this.msi=
this.Iie=this.K$c=!1;this.Zb=this.N4d=this.E_f=this.Qce=this.$kg=this.FCb=this.wOa=this.eH=this.knb=this.mmc=this.VRo=this.xBl=this.un=this.lef=this.Nq=this.Lu=this.vk=this.Pne=this.dOd=this.UDa=null}}Object(D.a)(x,"RuntimeState",null,[]);c.d(I,"a",function(){return y});class y{constructor(){this.input=new a;this.runtime=new x;this.output=new k;this.logger=new l.a(this)}}Object(D.a)(y,"MergeState",null,[])},1994:function(D,I,c){c.r(I);D=c(0);var l=c(611),e=c(225),a=c(183),k=c(112),x=c(1657),y=c(1750),
m=c(1789),t=c(6),z=c(1984);class v{constructor(R,S){this.start=R;this.end=S}}Object(D.a)(v,"MergeDiffIdx",null,[]);class H{constructor(R,S,N,O=!1,W=null,V=null,Q=!0){this.gkd=this.fkd=this.MSg=this.uzc=0;this.D1b=this.Cue=null;this.rbb=W||new z.a;this.Qg=N;this.vsa=R.R5();this.cok=S.R5();this.nQ=new v(0,0);this.BT=new v(0,0);this.tEe=O;this.Iwc=Q;this.Ysa=V;this.bRk();this.jlo()}get QK(){return this.vsa}get kK(){return this.cok}get Nz(){return this.uzc}get zA(){return this.MSg}get Vva(){return this.fkd}get Tna(){return this.gkd}get mol(){const R=
new e.a;for(let S=this.Cue.start;S<this.Cue.end;S++)R.add(this.QK.eg(S));return R}get Aff(){const R=new e.a;for(let S=this.D1b.start;S<this.D1b.end;S++)R.add(this.kK.eg(S));return R}Lgf(R){if(this.zA<R.zA){if(this.zA+this.Vva>R.zA)return!0}else if(this.zA>R.zA){if(R.zA+R.Vva>this.zA)return!0}else if(2===this.Nz&&3===R.Nz||3===this.Nz&&2===R.Nz||2===this.Nz&&2===R.Nz||3===this.Nz&&3===R.Nz)return!0;return!1}Zcj(R,S,N,O){R.zG(S);R.aD(S,N);return O+=N.length-1}Wuj(R,S,N,O,W){let V=this.QK.eg(R),Q=this.kK.eg(S);
if(!V||!Q||!V.D8a&&!Q.D8a)return{returnValue:!1,sDa:O,TJa:W};let Y=new e.a,ba=new e.a;V.D8a&&(Y=V.Iad(),V=Y.eg(N?0:Y.length-1));Q.D8a&&(ba=Q.Iad(),Q=ba.eg(N?0:ba.length-1));if(!V.JA(Q,this.rbb,this.Ysa,this.tEe,this.Iwc))return{returnValue:!1,sDa:O,TJa:W};Y.length&&(O=this.Zcj(this.QK,R,Y,O));ba.length&&(W=this.Zcj(this.kK,S,ba,W));return{returnValue:!0,sDa:O,TJa:W}}aEl(R,S,N,O,W,V){for(;W<=N&&V<=O;){const Q=R.eg(W),Y=S.eg(V);if(!Q.JA(Y,this.rbb,this.Ysa,this.tEe,this.Iwc))break;this.nQ.start+=Q.length;
this.BT.start+=Y.length;W++;V++}return{Y3e:W,qpg:V}}ZDl(R,S,N,O,W,V){for(;W>=N&&V>=O;){const Q=R.eg(W),Y=S.eg(V);if(!Q.JA(Y,this.rbb,this.Ysa,this.tEe,this.Iwc))return{returnValue:!0,sDa:W,TJa:V};W--;V--}return{returnValue:!1,sDa:W,TJa:V}}$Dl(R,S,N,O){let W=!1;do({Y3e:R,qpg:S}=this.aEl(this.QK,this.kK,N,O,R,S)),{sDa:N,TJa:O,returnValue:W}=this.Wuj(R,S,!0,N,O);while(W);return{Y3e:R,qpg:S,sDa:N,TJa:O}}YDl(R,S,N,O){let W=!1;do{if(!({sDa:N,TJa:O}=this.ZDl(this.QK,this.kK,R,S,N,O)).returnValue)break;({sDa:N,
TJa:O,returnValue:W}=this.Wuj(N,O,!1,N,O))}while(W);return{sDa:N,TJa:O}}bRk(){var R=0,S=0,N=this.QK.length-1,O=this.kK.length-1;0<=N&&this.QK.eg(N);0<=O&&this.kK.eg(O);({Y3e:R,qpg:S,sDa:N,TJa:O}=this.$Dl(R,S,N,O));if(R<N||S<O)({sDa:N,TJa:O}=this.YDl(R,S,N,O));N++;O++;this.Cue=new v(R,N);this.D1b=new v(S,O);this.nQ.end=this.nQ.start;this.BT.end=this.BT.start;for(var W=R;W<N;W++){var V=this.QK.eg(W);this.nQ.end+=V.length}for(W=S;W<O;W++)V=this.kK.eg(W),this.BT.end+=V.length;a.a.instance.Ua(3993809,
1,4,"CalculateDiffIndexes: NonGranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",R,N,S,O);a.a.instance.Ua(3993810,1,4,"CalculateDiffIndexes: GranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",this.nQ.start,this.nQ.end,this.BT.start,this.BT.end);this.nQ.start<=this.nQ.end&&this.BT.start<=this.BT.end&&(R=this.QK.eg(R),S=this.kK.eg(S),W=this.QK.eg(N),V=this.kK.eg(O),N=this.QK.eg(N-1),O=this.kK.eg(O-1),a.a.instance.Ua(3993811,
1,4,"CalculateDiffIndexes: Merge Blocks [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}] [Base.UnequalEnd: {4}] [Update.UnequalEnd: {5}]",R,W,S,V,N,O))}jlo(){this.MSg=this.nQ.start;this.fkd=this.gkd=0;this.nQ.start===this.nQ.end&&this.BT.start===this.BT.end?this.uzc=0:this.nQ.start===this.nQ.end&&this.BT.start<this.BT.end?(this.uzc=1,this.gkd=this.BT.end-this.BT.start):this.BT.start===this.BT.end&&this.nQ.start<this.nQ.end?(this.uzc=2,this.fkd=this.nQ.end-this.nQ.start):(this.uzc=
3,this.fkd=this.nQ.end-this.nQ.start,this.gkd=this.BT.end-this.BT.start);a.a.instance.Ua(3993814,1,4,"SetMergeDiffType: [MergeDiffType: {0}] [DiffIndex: {1}] [DiffLengthBase: {2}] [DiffLengthUpdate: {3}]",this.Nz,this.zA,this.Vva,this.Tna)}tQm(R,S){return R.b5()&&S.b5()?R.runId===S.runId&&R.Bg===S.Bg:!1}CVm(R){if(!R.b5()||"\ufffc"!==R.text)return!1;R=R.tFb;return R?R.hasProperty(t.a.Lj)||R.hasProperty(t.a.pEd)||R.hasProperty(t.a.mhf)||R.hasProperty(t.a.y4)||R.hasProperty(t.a.imageType)||R.hasProperty(t.a.MRa)||
R.hasProperty(t.a.$Jb)||R.hasProperty(t.a.Qs)&&(R=this.Qg.getPropertyInt32(R,t.a.Qs))&&(36===R||35===R||24===R||23===R||33===R||34===R||44===R||45===R||42===R||43===R)?!0:!1:!1}mXc(R){return R.b5()&&!this.CVm(R)}GSk(){if(2===this.Nz)return!1;var R=this.D1b.start;if(!R)return!1;let S=null;for(var N=this.D1b.start;N<this.D1b.end;N++){const O=this.kK.eg(N);if(this.mXc(O)){S=O;break}}if(!S)return!1;--R;for(N=this.kK.eg(R);N&&!this.mXc(N);)R--,N=this.kK.eg(R);return N&&this.tQm(N,S)?!0:!1}L$h(R){const S=
new e.a;for(let N=0;N<R.length;N++)R.J(N).D8a?S.aD(S.length,R.J(N).Iad()):S.insert(S.length,R.J(N));return S}vQm(){if(3!==this.Nz||this.Vva!==this.Tna)return!1;const R=this.L$h(this.mol),S=this.L$h(this.Aff);if(R.length!==S.length)return!1;for(let N=0;N<R.length;N++)if(!R.J(N).JA(S.J(N),this.rbb,this.Ysa,!0,this.Iwc))return!1;return!0}uQm(){if(0!==this.Nz&&3!==this.Nz||this.QK.length!==this.kK.length)return!1;let R=!1;for(let S=0;S<this.QK.length;S++){if(!this.QK.J(S).JA(this.kK.J(S),this.rbb,this.Ysa,
!0,this.Iwc))return!1;if(3===this.QK.J(S).type||1===this.QK.J(S).type){const N=this.QK.J(S),O=this.kK.J(S);R=N.runId!==O.runId||N.Bg!==O.Bg||R}}return R}}Object(D.a)(H,"MergeBlockDiff",null,[]);var F=c(1611);class G{constructor(R,S){this.id=R;this.index=S}}Object(D.a)(G,"ParagraphStartIndex",null,[]);var M=c(1668),K=c(1591);c.d(I,"ParagraphMerge",function(){return L});class L{constructor(R,S,N,O,W,V,Q){this.C_b=this.Wxb=this.Yo=this.xx=null;this.Zh=!1;this.Dkh=this.gVg=this.LMg=this.tua=this.vLa=
this.vsa=null;this.$d=R;this.WF=S;this.OCa=O;this.vBa=N;this.Xsa=W;this.Ysa=V;this.Qg=Q}egi(R){const S=new l.a;R.QK.forEach(N=>{2===N.type&&S.add(N.Pj);return!0});R.kK.forEach(N=>{2===N.type&&S.remove(N.Pj);return!0});return S}Fci(R){const S=new e.a;R.kK.forEach(N=>{2===N.type&&S.add(N.Pj);return!0});return S}bIh(R){const S=new e.a;let N=0,O=0;R.kK.forEach(W=>{2===W.type&&(S.add(new G(W.Pj,N<R.zA?N:N<R.zA+R.Tna?R.zA:N-R.Tna+R.Vva)),N=O);O+=W.length;return!0});return S}R3k(R,S){var N=this.bIh(R);const O=
this.bIh(S);R=this.egi(R);const W=this.egi(S);S=new e.a;const V=new l.a;let Q=0;for(let Y=0;Y<N.length;Y++){const ba=N.J(Y);if(Q<O.length){let Z=O.J(Q);for(;Q<O.length&&Z.index<=ba.index;){if(Z.id.equals(ba.id)){Q++;break}R.contains(Z.id)||V.contains(Z.id)||(S.add(Z.id),V.add(Z.id));Q++;Z=O.J(Q)}}W.contains(ba.id)||(S.add(ba.id),V.add(ba.id))}for(;Q<O.length;)N=O.J(Q),R.contains(N.id)||V.contains(N.id)||(S.add(N.id),V.add(N.id)),Q++;return S}initialize(){if(this.Zh){const R=!!this.xx&&!!this.Yo;this.$d.logger.Rg(Object.assign(new F.a,
{yj:"ParagraphMerge.Initialize",info:"MergeDiff objects not initialized"}));return R}this.Zh=!0;if(!({QK:this.vsa,ZNc:this.vLa,jdd:this.tua,bEd:this.LMg,eOd:this.gVg,Qne:this.Dkh}=K.a.VMh(this.$d,this.Qg,this.WF,this.vBa,this.OCa,this.Xsa,!1,!1)).returnValue)return!1;this.xx=new H(this.vsa,this.vLa,this.Qg,void 0,void 0,this.Ysa);this.Yo=new H(this.vsa,this.tua,this.Qg,void 0,void 0,this.Ysa);a.a.instance.Ua(593272919,1,4,String.format("FavoredBaseDiffLen: {0} FavoredUpdateDiffLen: {1} UnfavoredBaseDiffLen: {2} UnfavoredUpdateDiffLen {3}",
this.xx.Vva,this.xx.Tna,this.Yo.Vva,this.Yo.Tna));return!0}HJa(){a.a.instance.Ua(593826836,1,4,"Attempting to merge with LCS");let R=!1;const S=new m.a(this.Qg,this.$d);let N=null,O=null;var W=null;const V=Y=>this.$d.runtime.vk.J(Y),Q=Y=>this.$d.runtime.Nq.J(Y)||this.$d.runtime.vk.J(Y);this.xx=new H(this.vsa,this.vLa,this.Qg,void 0,void 0,this.Ysa,!1);this.Yo=new H(this.vsa,this.tua,this.Qg,void 0,void 0,this.Ysa,!1);({updateHints:N}=S.zOh(this.WF,V,this.vBa,Y=>this.$d.runtime.Lu.J(Y)||this.$d.runtime.vk.J(Y),
this.xx.zA,this.xx.zA+this.xx.Vva,this.xx.zA+this.xx.Tna)).returnValue&&({updateHints:O}=S.zOh(this.WF,V,this.OCa,Q,this.Yo.zA,this.Yo.zA+this.Yo.Vva,this.Yo.zA+this.Yo.Tna)).returnValue&&(R=!0);R||(a.a.instance.Ua(593826835,1,2,"Failed to create update hints with LCS"),R=!1);R&&(W=new M.a(this.$d,this.WF,this.vBa,this.OCa,Y=>this.$d.runtime.Zb?this.$d.runtime.Zb.isFeatureEnabled(Y):!1,this.Qg,null,N,O),({un:W}=W.noc()).returnValue||(a.a.instance.Ua(593826834,1,2,"Failed to merge using LCS generated UpdateHints"),
this.$d.logger.Rg(Object.assign(new F.a,{yj:"TryLCSMerge",eventId:"9zrqs"})),R=!1));a.a.instance.Ua(593826833,1,R?4:2,"TryLCSMerge: [Success: {0}]",R);return{returnValue:R,un:W}}noc(){let R;R=null;if(!this.initialize())return this.$d.logger.$U("ParagraphMerge Initialize"),this.w5a(),{returnValue:!1,un:R};this.$d.logger.$U("ParagraphMerge Initialize");let S;this.$d.logger.qhe(2);let N=({HJa:S}=this.drl()).returnValue;N=N&&({un:R,HJa:S}=this.hRc(this.$d,this.Qg,this.Xsa,this.C_b,this.Wxb)).returnValue;
this.$d.logger.ceg();if(!N){this.$d.logger.$U("ParagraphMerge DoMergeInteral");if(S){this.$d.logger.qhe(3);({un:R,returnValue:N}=this.HJa());this.$d.logger.ceg();if(N)return{returnValue:!0,un:R};this.w5a();return{returnValue:!1,un:R}}this.w5a();return{returnValue:!1,un:R}}if(!({un:R,HJa:S}=this.hRc(this.$d,this.Qg,this.Xsa,this.C_b,this.Wxb)).returnValue)return this.$d.logger.$U("ParagraphMerge DoMergeInteral"),this.w5a(),{returnValue:!1,un:R};this.$d.logger.$U("ParagraphMerge DoMergeInteral");return{returnValue:!0,
un:R}}hRc(){let R;if(!({y$d:R}=K.a.hRc(this.$d,this.Qg,this.Xsa,this.C_b,this.Wxb)).returnValue)return this.$d.logger.$U("ParagraphMerge GetMergeableObjectsFromMergeBlocks"),this.w5a(),{returnValue:!1,un:R,HJa:!0};this.$d.logger.$U("ParagraphMerge GetMergeableObjectsFromMergeBlocks");return{returnValue:!0,un:R,HJa:!1}}w5a(R=!1){a.a.instance.Aka(4478665,1,1,"ParagraphMergeFailed: [IsCpMerge: "+R+"] BaseRevisionMergeBlocksList: {0}",this.LMg);a.a.instance.Aka(4478666,1,1,"FavoredRevisionMergeBlocksList: {0}",
this.gVg);a.a.instance.Aka(4478667,1,1,"UnfavoredRevisionMergeBlocksList: {0}",this.Dkh);R=new e.a;K.a.rfc(this.Qg,"BaseObjects_",this.WF,R);K.a.rfc(this.Qg,"FavoredObjects_",this.vBa,R);K.a.rfc(this.Qg,"ConflictObjects_",this.OCa,R);K.a.f5m(this.$d,R)}$Ah(R){let S,N;N=S=0;if(0===this.xx.Nz)S=this.Yo.zA;else if(1===this.xx.Nz)S=this.Yo.zA<this.xx.zA?this.Yo.zA:this.Yo.zA===this.xx.zA?R||1!==this.Yo.Nz?this.Yo.zA+this.xx.Tna:this.Yo.zA:this.Yo.zA+this.xx.Tna;else if(2===this.xx.Nz||3===this.xx.Nz)S=
this.Yo.zA<=this.xx.zA?this.Yo.zA:this.Yo.zA+(this.xx.Tna-this.xx.Vva);if(2===this.Yo.Nz||3===this.Yo.Nz)N=S+this.Yo.Vva;return{Gli:S,Emm:N}}s0h(R,S){let N;N=0;if(!S)return{returnValue:!0,x1c:N};let O=0,W=0;for(;O<R.length;){let V;for(let Q=O;Q<R.length;Q++){O=Q;V=R.J(Q);const Y=V.length;W+=Y;if(!(W<S)){if(W>S)if(V.D8a)R.zG(O),R.aD(O,V.Iad()),W-=Y;else return a.a.instance.Ua(3993819,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}] as the block could not be split",
S),this.$d.logger.Rg(Object.assign(new F.a,{yj:"FindNonGranularListIndex",eventId:"appd1"})),{returnValue:!1,x1c:N};break}}if(W===S)return O++,N=O,{returnValue:!0,x1c:N}}a.a.instance.Ua(3993820,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}]",S);this.$d.logger.Rg(Object.assign(new F.a,{yj:"FindNonGranularListIndex",eventId:"appd2"}));return{returnValue:!1,x1c:N}}jGk(R,S,N){let O=0;var W=0,V=!1;const Q=this.Yo.Aff.R5();
if(this.Yo.GSk())for(--S;0<=S;S--){let Y=R.J(S);if(this.Yo.mXc(Y)){W=R.J(S);O=W.runId;W=W.Bg;V=!0;break}}V||((W=R.J(N))&&this.Yo.mXc(W)?(O=W.runId,W=W.Bg):W=O=0);for(R=0;R<Q.length;R++)N=Q.J(R),N.b5()&&(V=N,this.Yo.mXc(N)?(V.runId=O,V.Bg=W):(V.runId=0,V.Bg=0));return Q}QAi(R){if(2===R.length){const S=1===R.J(0).type?R.J(0):null;R=2===R.J(1).type;if(S&&R&&""===S.text)return!0}return!1}drl(){const R=this.xx.uQm();if(!R&&0===this.xx.Nz)return this.C_b=this.Yo.kK.R5(),this.Wxb=this.Fci(this.Yo),{returnValue:!0,
HJa:!1};if(0===this.Yo.Nz)return this.C_b=this.xx.kK.R5(),this.Wxb=this.Fci(this.xx),{returnValue:!0,HJa:!1};(this.QAi(this.xx.kK)||this.QAi(this.Yo.kK))&&this.$d.logger.mKi(Object.assign(new F.a,{info:"DoMergeInternal - OneParaEmpty"}));if(!R){var S=this.xx.Lgf(this.Yo);S&&this.Xsa(56)&&(a.a.instance.Ua(17326359,1,2,"DoMergeInternal: Diff overlaps when we take formatting ids into account. Running another diff without formatting ids"),this.xx=new H(this.vsa,this.vLa,this.Qg,!0,void 0,this.Ysa),this.Yo=
new H(this.vsa,this.tua,this.Qg,!0,void 0,this.Ysa),S=this.xx.Lgf(this.Yo));if(S)return a.a.instance.Ua(3993821,1,2,"DoMergeInternal: We were unable to merge as there was an overlap in the changes in the 2 revisions"),this.$d.logger.Rg(Object.assign(new y.a,{yj:"ParagraphMerge",eventId:"appd3"})),{returnValue:!1,HJa:!0}}var N;S=0;this.Wxb=this.R3k(this.xx,this.Yo);({Gli:N,Emm:W}=this.$Ah(!1));const O=this.xx.kK.R5();if(!({x1c:N}=this.s0h(O,N)).returnValue||(2===this.Yo.Nz||3===this.Yo.Nz)&&!({x1c:S}=
this.s0h(O,W)).returnValue)return{returnValue:!1,HJa:!1};if(2===this.Yo.Nz||3===this.Yo.Nz){this.Skc(O,S);this.Skc(O,N-1);var W=null;for(var V=S-1;V>=N;V--)2===O.J(V).type&&(W=O.J(V)),O.zG(V);0<O.length&&(V=O.J(O.length-1),2!==V.type&&4!==V.type&&W&&(this.$d.runtime.Zb.Ux(77),this.$d.runtime.Zb.isFeatureEnabled(77)&&(O.add(W),this.Wxb.add(W.Pj))));a.a.instance.Ua(4019726,1,4,"DoMergeInternal deleted [Length: {0}] merge blocks at [Index: {1}]",S-N-1,N)}if(1===this.Yo.Nz||3===this.Yo.Nz)W=this.Yo.Aff,
R&&(W=this.jGk(O,N,S)),this.Skc(O,N-1),this.Skc(O,N),this.Skc(W,0),this.Skc(W,W.length-1),O.aD(N,W),a.a.instance.Ua(4019727,1,4,"DoMergeInternal: Inserted merge blocks at [Index: {0}] [Syncdiff merge: {1}] [Merge Blocks: {2}]",N,R,W.ir());this.C_b=O;return{returnValue:!0,HJa:!1}}Skc(R,S){0>S||S>=R.length||(R=R.J(S),Object(k.a)(x.a,R)&&(R.DRa=!0))}vdd(R,S){let N;N=S;if(!this.initialize())return{returnValue:!1,s7a:R,dra:N};if(this.Yo.Lgf(this.xx))return this.w5a(!0),this.$d.logger.Rg(Object.assign(new y.a,
{yj:"ParagraphMerge",info:"Is a CpMerge"})),{returnValue:!1,s7a:R,dra:N};if(0===this.Yo.Nz||3===this.Yo.Nz&&this.Yo.vQm())return{returnValue:!0,s7a:R,dra:S};let O;({Gli:O}=this.$Ah(!0));S<O||S===O&&(1!==this.Yo.Nz||1===this.Yo.Nz&&1===this.xx.Nz&&S===this.xx.zA+this.xx.Tna)?N=S:(N=S+this.Yo.Tna-this.Yo.Vva,N<O&&(N=O));return{returnValue:!0,s7a:R,dra:N}}}Object(D.a)(L,"ParagraphMerge",null,[1989])},1995:function(D,I,c){c.r(I);D=c(0);var l=c(1672),e=c(1587),a=c(1551),k=c(1806),x=c(1586);class y{constructor(M=
"",K="",L="",R=-99999,S=-1,N=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=M?M:"";this.Description=K?K:"";this.Type=L?L:"";this.Score=R;this.Age=S;this.Count=N}}Object(D.a)(y,"Suggestion",null,[]);class m{constructor(M,K){this.GroupType=this.Suggestions=null;this.Suggestions=M;this.GroupType=K}}Object(D.a)(m,"SuggestionGroup",null,[]);class t{}t.help="help";t.answer="answer";t.commands="commands";t.Pfo="servicecommands";t.template="template";Object(D.a)(t,
"SuggestionGroupType",null,[]);var z=c(1520),v=c(1519),H=c(2),F=c(34);c.d(I,"InteractionLogger",function(){return G});class G{constructor(M,K,L){this.aAe=0;this.tVe=this.xyc=null;this.ve=M;this.xTe=this.pxe=this.SEe=!1;this.K_j=K;this.$f=H.AFrameworkApplication.He;this.fc=L;this.xjd=this.aOe=0}get Xqa(){return this.ve.Xqa}Che(M){this.ve.Che(M)}qLi(){if(this.xyc){var M=0;for(const K of this.xyc)this.ve.s7m(K,M++);this.xyc=null}}beginQuery(M,K,L){this.ve.k7m(M,K,L)}Knb(M,K){this.ve.kKk(M,K);this.SEe=
!0;this.xTe=!1}yya(){this.SEe=!1;this.pxe||(this.qLi(),this.ve.XWh(this.aAe))}l7m(M,K){this.ve.m7m(M,K)}Bmn(M,K,L,R,S){for(const N of this.K_j)if(M.startsWith(N)){this.xTe=!0;break}this.ve.y4m(M,K,L,R,S)}hnn(M){this.pxe=!1;this.aAe=M;this.SEe||this.xTe||(this.qLi(),this.ve.XWh(this.aAe,!1))}gnn(M,K){this.ve.E4m(M,K);this.pxe=!0}qnf(M,K){if(!M.count)return"";let L="";const R=Date.now();for(let S of M)M=(R-S.timeStamp)/1E3,M=v.a.ene(M),0<L.length&&(L+=";"),L+=K?S.commandId:S.controlId,L+=":",L+=M.toString();
return L}h6a(){var M=this.qnf(l.a.instance.VPc(),!1);0<M.length&&this.ve.w4m(M);M=this.qnf(l.a.instance.Dib(),!0);0<M.length&&this.ve.Q3m(M);M=this.qnf(l.a.instance.pvc,!0);0<M.length&&this.ve.q5m(M);M=z.TellMeActor.instance.X7g;0<M.length&&this.ve.i7m(F.c(M))}E7m(M){this.ve.d4m(M)}W9(M,K,L,R,S,N,O,W=null){this.ve.l6m(M,K,L,R,S,N,O,W)}ANf(M,K,L,R){this.ve.ANf(M,K,L,R)}QA(M,K,L=null){this.ve.UG(M,K,L)}onError(M,K,L=null){this.ve.eqa(M,K,L)}uko(M){this.xyc=M}Yfm(M){const K=[];if(!M)return K;for(let L=
0;L<M.length;L++){const R=a.a[M[L].groupType].toLowerCase(),S=[],N=M[L].results;if(N){for(let O=0;O<N.length;O++)"findindocument"===R?Array.add(S,new y("","",R,N[O].score,N[O].JCd,N[O].count)):Array.add(S,new y(N[O].label,N[O].description,R,N[O].score,N[O].JCd,N[O].count));"answer"===R||"definition"===R||"wolframanswer"===R||"entity"===R?Array.add(K,new m(S,t.answer)):"classifier"===R||"appsforoffice"===R?Array.add(K,new m(S,t.commands)):"serviceclassifier"===R?Array.add(K,new m(S,t.Pfo)):"assistance"===
R?Array.add(K,new m(S,t.help)):("document"===R||"people"===R||"findindocument"===R||"notes"===R||"image"===R||"template"===R)&&Array.add(K,new m(S,R))}}return K}evf(M,K){const L={};L.Query=K;L.SuggestionGroups=F.c(this.Yfm(M));return F.c(L)}Yii(M){const K={"Content-Type":"application/json",Accept:"application/json"};K["X-Office-Version"]=H.AFrameworkApplication.buildVersion;K["X-Office-Application"]=H.AFrameworkApplication.K.kb("Application");K["X-Office-Platform"]="WAC";K["X-TellMe-SqmUserId"]=H.AFrameworkApplication.K.kb("LoggableUserId")||
"";K["X-TellMe-SessionId"]=this.ve.Xqa.rpa;K["X-TellMe-SuggestionTypes"]="Ranker";K["X-TellMe-Culture"]=H.AFrameworkApplication.uiCulture;K["X-TellMe-ProcessSessionId"]=H.AFrameworkApplication.userSessionId;K["X-TellMe-Flights"]=M;K["X-TellMe-PartialQueryIndex"]=this.aOe;return K}UMb(M,K,L){this.W9(K.length,"RankerLogging",M.data.Se.toString(),Math.round(window.performance.now()-L),x.a.Qyj,!0,e.a.LQa)}CMb(M,K,L){this.W9(K.length,"RankerLogging",M.data.Se.toString(),Math.round(window.performance.now()-
L),x.a.Qyj,!1,e.a.LQa)}Zii(){this.tVe||(this.tVe=new k.a(this.fc,null,6E3));return this.tVe.naa}CNf(M){const K=this.evf(this.xyc,M),L=this.Yii("RankerLogging"),R=window.performance.now();this.$f.mj(this.Zii(),2,K,L,!1,0,S=>{this.UMb(S,M,R)},S=>{this.CMb(S,M,R)},null,null,!1,4E3,6E3);this.aOe++}G6n(){this.aOe=0}kdg(M){this.xjd=M}}Object(D.a)(G,"InteractionLogger",null,[])},1997:function(D,I,c){c.r(I);D=c(0);var l=c(16),e=c(6),a=c(183),k=c(225),x=c(60),y=c(1741),m=c(1656),t=c(1609),z=c(1591);class v{constructor(M,
K,L=null){this.author=M;this.L0c=K;this.E2f=L||x.a.nil}JA(M){return M?this.author===M.author&&this.L0c===M.L0c&&this.E2f===M.E2f:!1}}Object(D.a)(v,"RunMergeBlockTrackedChangeAttribute",null,[]);class H{constructor(M,K,L){this.insertion=M||H.Xhf;this.deletion=K||H.Xhf;this.ZHa=L||H.Xhf}get usm(){return 0<this.insertion.author.length}get Yrm(){return 0<this.deletion.author.length}get Ysm(){return 0<this.ZHa.author.length}JA(M){return M?this.insertion.JA(M.insertion)&&this.deletion.JA(M.deletion)&&this.ZHa.JA(M.ZHa):
!1}}H.Xhf=new v("",0);Object(D.a)(H,"RunMergeBlockTrackedChangeInfo",null,[]);var F=c(1804);c.d(I,"ParagraphMergeBlockCreator",function(){return G});class G extends m.a{constructor(M,K,L,R,S,N,O){super();this.maxValue=Number.MAX_VALUE;this.jB=new y.a;this.iVb=null;this.iO=0;this.h1g=!1;this.tzc="";this.ute=M;this.Xs=K;this.Eu=L;this.Akk=R;this.gmd=S;this.s0g=N;this.Qg=O;if(this.Qg.hasProperty(this.Xs,l.a.wo))if(this.Qg.hasProperty(this.Xs,e.a.Wc))if(this.Qg.hasProperty(this.Xs,e.a.vq))if(this.Qg.hasProperty(this.Xs,
e.a.nt))if(this.Qg.hasProperty(this.Xs,l.a.Sn))if(this.r3=this.Qg.getPropertyString(this.Xs,l.a.wo),this.zYe=this.Qg.getPropertyUint32(this.Xs,e.a.Wc),this.Cs=this.Qg.getPropertyUint32s(this.Xs,e.a.vq),this.vtd=this.Qg.getPropertyUint32s(this.Xs,e.a.nt),this.dCe=this.Qg.getPropertyObjectIds(this.Xs,l.a.Sn),this.r3||""===this.r3)if(this.r3.length||1!==this.dCe.length||(this.Cs.length||(this.Cs.add(0),a.a.instance.Ua(4322134,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no runIDs, fixing it")),
this.vtd.length||(this.vtd.add(0),a.a.instance.Ua(4322135,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no paraIDs, fixing it"))),this.Vbk=this.wQd(this.Xs,e.a.DTf,this.Cs.length),this.dBc=this.wQd(this.Xs,l.a.pya,this.Cs.length),this.vma=this.wQd(this.Xs,l.a.Iqb,this.Cs.length),this.Kla=this.wQd(this.Xs,e.a.tQa,this.Cs.length),this.hma=this.ojm(this.Xs,e.a.aIa,this.Cs.length),this.aAm(),M=this.Qg.hasProperty(this.Xs,l.a.Jm)?this.Qg.getPropertyUint32s(this.Xs,l.a.Jm):new k.a,this.jwd=
z.a.vnj(M,this.r3.length),this.Cs.length!==this.vtd.length)a.a.instance.Ua(3993799,1,1,"MergeBlockIterator: Length of RunIds and ParaIds does not match on [Object: {0}]",K.id);else if(this.Cs.length!==this.dCe.length)a.a.instance.Ua(3993800,1,1,"MergeBlockIterator: Length of FormattingIds and ParaIds does not match on [Object: {0}]",K.id);else{this.s0g&&(this.Qg.hasProperty(this.Xs,e.a.Iv)?this.iVb=this.Qg.getPropertyObjectIds(this.Xs,e.a.Iv):(a.a.instance.Ua(40939931,1,2,"MergeBlockIterator: ChangeIds are null on [Object: {0}]",
K.id),this.iVb=this.b0(this.Cs.length,x.a.nil)),this.Cs.length!==this.iVb.length&&(a.a.instance.Ua(40939932,1,2,"MergeBlockIterator: Length of RunIds and ChangeIds don't match on [Object: {0}]. RunIds Length: {1} ChangeIds Length: {2}",K.id,this.Cs.length,this.iVb.length),this.iVb=this.b0(this.Cs.length,x.a.nil)));if(this.Cs.length!==this.dBc.length||this.Cs.length!==this.vma.length||this.Cs.length!==this.Kla.length||this.Cs.length!==this.hma.length)this.Cs.length===this.dBc.length||this.gmd||a.a.instance.Ua(8266445,
1,1,"MergeBlockIterator: Length of NotProofedRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [NotProofedRuns Length: {2}]",K.id,this.Cs.length,this.dBc.length),this.Cs.length===this.vma.length||this.gmd||a.a.instance.Ua(8266446,1,1,"MergeBlockIterator: Length of SpellErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [SpellErrorRuns Length: {2}]",K.id,this.Cs.length,this.vma.length),this.Cs.length===this.Kla.length||this.gmd||a.a.instance.Ua(20742792,
1,1,"MergeBlockIterator: Length of GrammarErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [GrammarErrorRuns Length: {2}]",K.id,this.Cs.length,this.Kla.length),this.Cs.length===this.hma.length||this.gmd||a.a.instance.Ua(25274202,1,1,"MergeBlockIterator: Length of ProofingErrorHints and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [ProofingErrorHints Length: {2}]",K.id,this.Cs.length,this.hma.length),M=this.Qg.getPropertyBool(this.Xs,l.a.x$e),a.a.instance.Ua(17877020,
1,4,"MergeBlockIterator: Reproofing Para {0}. [ForceProofing: {1}] [ContainsIgnoredSpellingErrors: {2}]",K.id,S,null==M?!1:M),this.dBc=this.b0(this.Cs.length,!0),this.vma=this.b0(this.Cs.length,!1),this.Kla=this.b0(this.Cs.length,!1),this.hma=this.b0(this.Cs.length,0),this.Qg.setPropertyBool(this.Xs,l.a.x$e,!1);this.jB.J2o(this.Cs.length)?(this.jwd.length!==this.Cs.length+1&&a.a.instance.Ua(3993801,1,1,"MergeBlockIterator: Length of RunIdexes is different than expected for [Object: {0}] [RunIds Length: {1}] [RunIndices Length: {2}]",
K.id,this.Cs.length,this.jwd.length),this.W9j=!0):a.a.instance.Ua(23205786,1,1,"MergeBlockIterator: Length of RunIds and tracked changes properties does not match on [Object: {0}]",K.id)}else a.a.instance.Ua(4322133,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",K.id);else a.a.instance.Ua(3993798,1,1,"MergeBlockIterator: FormattingIds is null on [Object: {0}]",K.id);else a.a.instance.Ua(3993797,1,1,"MergeBlockIterator: ParaIds is null on [Object: {0}]",K.id);else a.a.instance.Ua(3993796,
1,1,"MergeBlockIterator: RunIds is null on [Object: {0}]",K.id);else a.a.instance.Ua(3993795,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",K.id);else a.a.instance.Ua(3993794,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",K.id)}aAm(){this.Qg.hasProperty(this.Xs,e.a.kGa)?this.jB.Kkb=this.Qg.getPropertyBools(this.Xs,e.a.kGa):this.jB.Kkb=this.b0(this.Cs.length,!1);this.Qg.hasProperty(this.Xs,e.a.eha)?this.jB.$gb=this.Qg.getPropertyBools(this.Xs,e.a.eha):
this.jB.$gb=this.b0(this.Cs.length,!1);this.Qg.hasProperty(this.Xs,e.a.lGa)?this.jB.Jkb=this.Qg.getPropertyStrings(this.Xs,e.a.lGa):this.jB.Jkb=this.b0(this.Cs.length,"");this.Qg.hasProperty(this.Xs,e.a.AEa)?this.jB.Zgb=this.Qg.getPropertyStrings(this.Xs,e.a.AEa):this.jB.Zgb=this.b0(this.Cs.length,"");this.Qg.hasProperty(this.Xs,e.a.mGa)?this.jB.Lkb=this.Qg.getPropertyListOfMilliseconds(this.Xs,e.a.mGa):this.jB.Lkb=this.b0(this.Cs.length,0);this.Qg.hasProperty(this.Xs,e.a.BEa)?this.jB.i1a=this.Qg.getPropertyListOfMilliseconds(this.Xs,
e.a.BEa):this.jB.i1a=this.b0(this.Cs.length,0);this.Qg.hasProperty(this.Xs,e.a.$Ha)?this.jB.J6a=this.Qg.getPropertyBools(this.Xs,e.a.$Ha):this.jB.J6a=this.b0(this.Cs.length,!1);this.Qg.hasProperty(this.Xs,e.a.DJa)?this.jB.Gob=this.Qg.getPropertyStrings(this.Xs,e.a.DJa):this.jB.Gob=this.b0(this.Cs.length,"");this.Qg.hasProperty(this.Xs,e.a.EJa)?this.jB.Iob=this.Qg.getPropertyListOfMilliseconds(this.Xs,e.a.EJa):this.jB.Iob=this.b0(this.Cs.length,0);this.Qg.hasProperty(this.Xs,e.a.hAa)?this.jB.Hob=this.Qg.getPropertyObjectIds(this.Xs,
e.a.hAa):this.jB.Hob=this.b0(this.Cs.length,x.a.nil)}wQd(M,K,L){return this.Qg.hasProperty(M,K)?this.Qg.getPropertyBools(M,K):this.b0(L,!1)}ojm(M,K,L){return this.Qg.hasProperty(M,K)?this.Qg.getPropertyUint32s(M,K):this.b0(L,0)}b0(M,K){const L=new k.a;for(let R=0;R<M;R++)L.add(K);return L}Jhm(M){const K=this.jwd.eg(M);M=this.jwd.eg(M+1);return this.r3.substring(K,M)}Uci(){if(this.h1g)return null;var M=this.iO<this.Cs.length?this.Cs.eg(this.iO):this.maxValue;if(M===this.maxValue||this.Akk&&!this.r3.length)return this.h1g=
!0,M=new t.a(this.Eu,this.Xs.id,this.zYe),this.tzc=this.$1e(this.tzc,M.toString()),M;const K=this.vtd.eg(this.iO),L=this.dCe.eg(this.iO),R=this.Vbk.eg(this.iO),S=this.dBc.eg(this.iO),N=this.vma.eg(this.iO),O=this.Kla.eg(this.iO),W=this.hma.eg(this.iO),V=this.s0g?this.iVb.eg(this.iO):null;var Q=null;this.jB.Kkb.eg(this.iO)&&(Q=new v(this.jB.Jkb.eg(this.iO)||"",this.jB.Lkb.eg(this.iO)));var Y=null;this.jB.$gb.eg(this.iO)&&(Y=new v(this.jB.Zgb.eg(this.iO)||"",this.jB.i1a.eg(this.iO)));var ba=null;this.jB.J6a.eg(this.iO)&&
(ba=new v(this.jB.Gob.eg(this.iO)||"",this.jB.Iob.eg(this.iO),this.jB.Hob.eg(this.iO)));Q=new H(Q,Y,ba);Y=this.Jhm(this.iO);this.iO++;ba=Y.startsWith("\ufddfHYPERLINK ");M=new F.a(this.ute,this.Eu,this.Xs.id,K,M,L,Y,R,!ba,S,N,O,W,Q,V);this.tzc=this.$1e(this.tzc,M.toString());return M}Dci(){let M;M=null;var K="";if(!this.W9j)return{EPf:M,K5a:K};if(K=this.Uci())M=new k.a,M.add(K);for(;K=this.Uci();)M.add(K);K=this.tzc;return{EPf:M,K5a:K}}}Object(D.a)(G,"ParagraphMergeBlockCreator",m.a,[])},2002:function(D,
I,c){c.r(I);D=c(0);var l=c(225),e=c(1656),a=c(1608);class k extends a.a{constructor(y,m){super(4,y,m)}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.Pj)}p9b(){return"Table"}clone(){return new k(this.source,this.Pj)}JA(y,m,t,z=!1){return super.JA(y,m,t,z)?this.Pj.equals(y.Pj):!1}get length(){return 1}}Object(D.a)(k,"TableMergeBlock",a.a,[]);c.d(I,"TableMergeBlockCreator",function(){return x});class x extends e.a{constructor(y,m){super();this.WMg=new k(m,y.id)}Dci(){let y;
y=new l.a;y.add(this.WMg);return{EPf:y,K5a:this.$1e("",this.WMg.toString())}}}Object(D.a)(x,"TableMergeBlockCreator",e.a,[])},2091:function(D,I,c){c.r(I);var l=c(2),e=c(0),a=c(54),k=c(155);class x extends k.a{constructor(J){super(!1,!1,!0);this.nKa=J}start(){var J={["tooltipPersistenceEnabled"]:this.nKa.iAf};l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",!1)&&(J.textSelectionChangeEnabled=this.nKa.Vle);J={["id"]:"AccessibilitySettingsDialog",
["bodyControls"]:J};this.Uh("",Object(a.a)(this,this.J$f,"resultHandler"),J)}J$f(J,ma){1===J&&(this.nKa.iAf=ma.tooltipPersistenceEnabled,l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",!1)&&(this.nKa.Vle=ma.textSelectionChangeEnabled))}}Object(e.a)(x,"AccessibilitySettingsDialog",k.a,[]);var y=c(70),m=c(13);class t{constructor(J,ma){this.ga=J;this.nKa=ma}Tb(){this.ga.ra(m.a.Fvo,y.a.frame,Object(a.a)(this,this.Gvo,"showAccessibilitySettingsDialogHandler"))}Gvo(){(new x(this.nKa)).start();
return 32}}Object(e.a)(t,"AccessibilitySettingsDialogActor",null,[1982]);var z=c(462);const v=J=>{const ma=new z.a;l.AFrameworkApplication.He.mj(H(J),1,null,null,!0,2,Ta=>{200===Ta.data.Se?ma.Dg("true"===Ta.data.se.toLowerCase()):ma.Dg(!1)},()=>{ma.Dg(!1)},null,void 0,void 0,void 0,void 0,"7");return ma.task},H=J=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",l.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",J,l.AFrameworkApplication.em);var F=c(127);class G{constructor(){this.FVe=
this.JXb=null}get iAf(){return!!this.JXb}set iAf(J){J!==this.JXb&&(this.JXb=J,F.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(J),this.rCi()&&l.AFrameworkApplication.He.mj(H("saveHoverableRibbonTooltipIsEnabled"),2,J.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}get Vle(){return!!this.FVe}set Vle(J){J!==this.FVe&&(this.FVe=J)}G2m(){const J=new z.a;if(this.JXb)J.Dg(this.JXb);else if(this.rCi()){const ma=v("getHoverableRibbonTooltipIsEnabled");
ma.continueWith(()=>{this.JXb=ma.result;F.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(ma.result);J.Dg(ma.result)},8)}else J.Dg(!1)}rCi(){const J=l.AFrameworkApplication.K.$("IsRoamingServiceEnabled"),ma=l.AFrameworkApplication.K.$("IsAnonymousUser");return J&&!ma}}Object(e.a)(G,"AccessibilitySettingsInfo",null,[1980]);var M=c(185),K=c(35);class L{constructor(){this.W=null}get name(){return"Common.App.AccessibilitySettings"}wc(J){this.W=J;this.W.register(G,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Ud(()=>
new G).ha();this.W.register(t,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Ud(()=>new t(l.AFrameworkApplication.va,this.W.Oa("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).ha()}init(){const J=this.W.Oa("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),ma=this.W.Oa("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");J&&ma?(ma.Tb(),J.G2m()):K.b(539637639,
200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){M.a.instance.Gc(new L)}}Object(e.a)(L,"AccessibilitySettingsPackage",null,[1,2]);var R=window.AssistanceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AssistanceTaskPane",Title:"Office Assistance",Width:"330"},children:[{name:"Groups",attrs:{},children:[{name:"Group",
attrs:{Id:"AssistanceIFrameContainer",IsStretched:"true"}}]}]}]},S=c(81);class N extends Sys.EventArgs{constructor(J,ma){super();this.eme=J;this.actualValue=ma}}Object(e.a)(N,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);class O{constructor(){this.HVb=[];this.OQg=this.Exe=0;this.ti=null;this.sa=new S.a}init(J,ma,Ta){this.ti=J;this.Exe=ma;this.OQg=Ta;this.ti.j0e(Object(a.a)(this,this.$6d,"onCpuMeterFrameAvailable"));this.Pxk(Object(a.a)(this,this.V8k,"cpuPercentThresholdExceeded"))}$6d(J,
ma){ma.lRi&&(Array.enqueue(this.HVb,ma.lRi.CP),this.HVb.length>this.OQg&&(Array.dequeue(this.HVb),this.DVk()))}DVk(){var J=this.HVb.length;let ma=0;for(let Ta=0;Ta<J;Ta++){const pb=Array.dequeue(this.HVb);ma+=pb;Array.enqueue(this.HVb,pb)}J=ma/J;J>this.Exe&&this.sa.raiseEvent("CPTTE",new N(this.Exe,J))}V8k(J,ma){K.b(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.jJd(ma.eme,ma.actualValue))}Pxk(J){this.sa.addHandler("CPTTE",J)}jJd(J,ma){const Ta={};Ta.ThresholdValue=J;Ta.ActualValue=
ma;return Ta}}Object(e.a)(O,"CpuMeterMonitor",null,[1996]);class W{constructor(){this.S=this.T=this.M=this.C=0}}Object(e.a)(W,"ProfileInformation",null,[]);var V=c(11),Q=c(38),Y=c(243),ba=c(85);class Z{constructor(J=0,ma=0){this.Qvb=!1;this.kvb={};this.erd=J;this.vrd=ma;this.bXe=0;Q.a.addHandler(window.self,V.a.wsh,()=>{this.Qvb=!0});Q.a.addHandler(window.self,V.a.xsh,()=>{this.Qvb=!1})}zsh(J,ma,Ta){const pb=Z.generateKey(ma,Ta);pb in this.kvb?ma=this.kvb[pb]:(ma=new W,ma.S=Ta?1:0,this.kvb[pb]=ma,
this.bXe++);ma.C++;ma.M=J>ma.M?J:ma.M;ma.T+=J}jDa(J,ma){this.zsh(J,ma,!1);this.Qvb&&this.zsh(J,ma,!0)}getData(){if(0<this.vrd&&this.bXe>this.vrd)return this.rUl();const J=0<this.erd,ma={},Ta=this.kvb;for(let Wb in Ta){var pb=Wb;const Jc=Ta[Wb];this.qgj(Jc);J&&Jc.T>=this.erd&&(ma[pb]=Jc)}return J?ba.a.af(ma)?null:ma:this.kvb}rUl(){var J=0<this.erd,ma=[];const Ta=this.kvb;for(let pb in Ta){const Wb={key:pb,value:Ta[pb]};let Jc=Wb.value;(!J||Jc.T>=this.erd)&&Array.add(ma,Wb)}if(ma.length>this.vrd)ma.sort((pb,
Wb)=>Wb.value.T-pb.value.T),ma=ma.slice(0,this.vrd);else if(!ma.length)return null;J={};for(const pb of ma)ma=pb.value,this.qgj(ma),J[pb.key]=ma;return J}qgj(J){J.M=Y.a.wV(J.M,0);J.T=Y.a.wV(J.T,0)}reset(){this.kvb={};this.bXe=0}static generateKey(J,ma){return ma?J+" [it]":J}}Object(e.a)(Z,"FunctionCallAggregator",null,[862]);var ea=c(1103);class ha{}Object(e.a)(ha,"CpuMeterFrame",null,[]);class ka extends Sys.EventArgs{constructor(J){super();this.lRi=J}}Object(e.a)(ka,"CpuMeterFrameAvailableEventArgs",
Sys.EventArgs,[]);class ua{}Object(e.a)(ua,"MiniTaskItemInfo",null,[]);class sa{}Object(e.a)(sa,"TaskItemInfo",null,[]);var Da=c(1064),Pa=c(1422),Ra=c(194);class Ga{constructor(J,ma,Ta,pb,Wb){this.xzb=0;this.j_=null;this.mwd=this.Ihh=0;this.Oeh=!1;this.XWb=0;this.zxc=!1;this.Fta=null;this.tod=0;this.vMe=new S.a;this.Lyd=[];this.cA=J;this.oKe=ma;this.jCe=Ta;this.B6g=pb;l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WrapSetTimeoutForTelemetryIsEnabled")&&this.Bec();this.w2j=Wb;this.kCe=new Z(100);
this.Hak=Da.a.mF(1,5,new Pa.a)}j0e(J){this.vMe.addHandler("OnCpuMeterFrameAvailable",J)}Pbj(J){this.vMe.removeHandler("OnCpuMeterFrameAvailable",J)}Job(J,ma,Ta,pb=null){Ta=pb?pb.priority:7;const Wb=this.cA();this.start(ma,Ta);try{J()}finally{this.stop(ma,pb),J=this.cA()-Wb,this.B6g.track(J,ma)}}ie(J,ma){const Ta=this.cA();try{J()}finally{J=this.cA()-Ta,this.jCe.jDa(J,ma),0<this.xzb&&this.kCe.jDa(J,ma),this.B6g.track(J,ma)}}OYf(J){const ma=new sa;ma.TN=J.WNf;ma.TP=J.priority;this.i7i(1,ma)}Gfc(J){this.tod|=
J}start(J,ma){if(!this.xzb){this.kCe.reset();const Ta=this.DEi(J);Ta&&this.k4d(1);this.j_=new sa;this.j_.TN=J;this.j_.TP=ma;this.j_.ST=(new Date).toISOString();this.j_.STS=Y.a.wV(this.cA(),2);Ta?this.j_.UI=1:this.BQm(J)?this.j_.UI=2:this.j_.UI=0}this.xzb++}k4d(J){this.XWb|=J}nGd(J=!0,ma=0){this.XWb=J?0:this.XWb&~ma}stop(J,ma=null){let Ta;this.xzb--;0>=this.xzb&&this.j_&&(Ta=this.cA()-this.j_.STS,this.mwd+=Ta,this.oKe.jDa(Ta,J),this.DEi(J)&&this.nGd(!1,1),this.j_.TRT=Y.a.wV(Ta,2),ma&&(this.j_.TQT=
Y.a.wV(ma.yNn,2),this.j_.TDT=Y.a.wV(ma.QFi,2)),this.w2j&&(this.i7i(0,this.j_),this.c5n()),this.xzb=0);0<=J.indexOf(ea.a.cRo)&&this.Gfc(2);0<=J.indexOf(ea.a.edj)&&this.Gfc(4);1===(this.XWb&1)&&this.Gfc(1);2===(this.XWb&2)&&this.Gfc(8)}c5n(){var J=this.j_.TRT;if(750<J){let Ta=this.kCe.getData();if(Ta){const pb={};for(let Wb in Ta){var ma=Ta[Wb];const Jc=Wb;Jc.startsWith("SiOp_")||Jc.endsWith("[it]")||(pb[Jc]=Math.round(100*ma.T/J))}Ta=pb}J=Object.assign(new ua,{B:this.j_.STS,T:J,S:Ta});this.Hak.track(J,
this.j_.TN)}}nAo(){var J=this.cA()-this.Ihh,ma=Y.a.wV(this.mwd/J*100,2);J=new ha;J.CP=ma;J.II=this.tod;ma=this.oKe.getData();ba.a.count(ma)&&(J.LRT=ma);ma=this.jCe.getData();ba.a.count(ma)&&(J.FP=ma);this.vMe.raiseEvent("OnCpuMeterFrameAvailable",new ka(J));this.xvj()}xvj(){this.oKe.reset();this.jCe.reset();this.mwd=this.xzb=0;this.Ihh=this.cA();this.tod=0;this.j_=null}run(){this.Oeh?this.nAo():(this.xvj(),this.Oeh=!0);this.Fta?this.Fta(Object(a.a)(this,this.run,"run"),1E3):window.setTimeout(Object(a.a)(this,
this.run,"run"),1E3)}EBd(J,ma,Ta){const pb=Array(2);pb[0]=ma;pb[1]=Ta;this.Lyd[J]||(this.Lyd[J]=[]);this.Lyd[J].push(pb)}i7i(J,ma){J=this.Lyd[J];if(!Ra.a.af(J))for(let pb=0;pb<J.length;pb++){var Ta=J[pb];const Wb=Ta[0];Ta=Ta[1];Wb&&!Wb(ma)||Ta(ma)}}Bec(){if(!this.zxc){const J=window.setTimeout;this.Fta=(ma,Ta)=>J(ma,Ta);this.zxc=!0}}DEi(J){return J.startsWith("key")||J.startsWith("input")}BQm(J){return J.startsWith("click")||J.startsWith("mouse")||J.startsWith("pointer")}}Object(e.a)(Ga,"CpuMeter",
null,[153]);class ta{constructor(J){this.btc=null;this.jq=new z.a;this.cA=J}initialize(J,ma,Ta,pb=!1){this.btc||(this.btc=new Ga(this.cA,J,ma,Ta,pb),this.jq.Dg(this.btc));return this.btc}}Object(e.a)(ta,"CpuMeterProvider",null,[1995]);var va=c(171);class ia{constructor(J=1){this.JD=[];this.Zjd=[];this.ak=J}kEl(){let J=0;for(let ma=0;ma<this.JD.length;ma++)this.JD[ma]<this.JD[J]&&(J=ma);return J}jDa(J,ma){J=Y.a.wV(J,2);if(this.JD.length<this.ak)Array.add(this.JD,J),Array.add(this.Zjd,ma);else{var Ta=
this.kEl();J>this.JD[Ta]&&(this.JD[Ta]=J,this.Zjd[Ta]=ma)}}getData(){return this.JD.length?{["Vals"]:this.JD,["Desc"]:this.Zjd}:null}reset(){this.JD=[];this.Zjd=[]}}Object(e.a)(ia,"MaxDataAggregator",null,[862]);var qa=c(39),pa=c(22);class Fa{get name(){return"Common.App.CpuMeter"}wc(J){J.register(ta,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").ha().Ud(()=>new ta(qa.a.$e));J.register(O,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").ha().Ud(()=>
new O)}init(){const J=l.AFrameworkApplication.K;if(J.$("CpuMeterIsEnabled")){const ma=pa.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");va.a.instance.aDd.continueWith(()=>{Fa.NAm(J,ma)})}}dispose(){}static NAm(J,ma){const Ta=Da.a.mF(10,5,new Z(J.mc("TaskManagerLoggingThreshold",0),J.mc("CpuMeterMaximumEntriesToLog",0)));ma=ma.initialize(new ia(5),new Z,Ta,J.$("CPUMeterExposeTaskDetailsIsEnabled"));J.$("WordEditorInteractivePerfDisableCpuMeterFrames")||(ma.run(),J.$("CpuMeterMonitorIsEnabled")&&
pa.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(ma,J.uU("CpuMeterAverageCpuPercentThreshold",80),J.mc("CpuMeterRollingAverageFramesCount",15)));K.b(16827671,306,50,"Initializing CpuMeter")}static main(){M.a.instance.Gc(new Fa)}}Object(e.a)(Fa,"CpuMeterPackage",null,[1,2]);var za=c(7),Oa=c(86),xa=c(1091),fa=c(1069),Ka=c(20),lb=c(1423);class Xa{constructor(){this.Lta=this.Rqc=null;this.T1b=!0;this.Kxc=!1}wc(J){l.AFrameworkApplication.K.$("EventTimingMeterIsEnabled")&&J.register(1932,
"Common.IEventTimingMeter").ha().Ud(()=>new EventTiming.EventTimingMeter)}get name(){return"Common.App.EventTimingMeter"}init(){var J=new fa.a(l.AFrameworkApplication.K.mc("EventTimingMeterEventSamplingPercent",0)/100);J=new xa.a(Object(a.a)(J,J.PQb,"shouldBeInSample"));const ma=Da.a.mF(16,1,J);this.Lta=new lb.a("TypingDuration-SlowPercentileAtValue","Percentile",l.AFrameworkApplication.K.uU("AshaVetoForTypingThresholdInMS",150),l.AFrameworkApplication.K.uU("AshaVetoForTypingThresholdPercentile",
95),this.T1b);(this.Kxc=!Ka.a.Q4a)&&l.AFrameworkApplication.qI(()=>{this.S7e()});this.Rqc=Ta=>{Ta=Ta.rawEvent.detail;for(const pb of Ta)ma.track(pb,"EventTimingData"),"false"!==pb.metadata.altPressed.toString()||"false"!==pb.metadata.ctrlPressed.toString()||"false"!==pb.metadata.repeat.toString()||"CharacterKey"!==pb.metadata.key.toString()&&"Space"!==pb.metadata.key.toString()||!this.Kxc||this.Lta.aza(pb.timeToRequestAnimationFrameMs)};Q.a.addHandler(window.self,V.a.vsh,this.Rqc)}dispose(){this.Rqc&&
(Q.a.removeHandler(window.self,V.a.vsh,this.Rqc),this.Rqc=null)}S7e(){this.Lta.zTa();this.Lta.D_i&&(za.ULS.sendTraceTag(588649307,209,15,"Report SlowTypingSession Veto with SlowTypingSession error"),Oa.Health.instance.recordQosError("SlowTypingSession",["SlowTypingSession"],!1,!0,!0,!1,null))}static main(){M.a.instance.Gc(new Xa)}}Object(e.a)(Xa,"EventTimingMeterPackage",null,[1,2]);var kb=c(75),Bb=c(69),Ja=c(34);class Ma{constructor(J,ma,Ta,pb=null,Wb=null){this.gM=J;this.uvb=ma;this.Pvc=Ta;this.wbh=
pb;this.qBc=Wb}Hjf(J){const ma=new Sys.StringBuilder(this.gM.h8c);ma.append("RoamingServiceHandler.ashx?action=");ma.append("getFirstRunExperienceSettings");ma.append("&");ma.append(this.Ptf(J));ma.append("&");ma.append(l.AFrameworkApplication.em);l.AFrameworkApplication.He.mj(ma.toString(),1,null,null,!0,2,Object(a.a)(this,this.Z2a,"getRequestSuccessCallback"),Object(a.a)(this,this.Ooa,"getRequestFailureCallback"),null)}HNd(J){var ma=new Sys.StringBuilder(this.gM.h8c);ma.append("RoamingServiceHandler.ashx?action=");
ma.append("saveFirstRunExperienceSettings");ma.append("&");ma.append(l.AFrameworkApplication.em);ma=ma.toString();J=Ja.c(J);l.AFrameworkApplication.He.mj(ma,2,J,null,!0,4,Object(a.a)(this,this.BFn,"postRequestSuccessCallback"),Object(a.a)(this,this.XHa,"postRequestFailureCallback"),null)}Z2a(J){let ma=!1,Ta=null;try{if(0<J.data.se.length){const pb=Object(Bb.a)(Object,Ja.a(J.data.se)),Wb=pb?pb[this.gM.R1e]:null;Wb&&(Ta=Object(Bb.a)(Object,Ja.a(Wb.toString())))}ma=!0}catch(pb){this.Ooa(null)}ma&&this.uvb&&
this.uvb(J.data,Ta)}Ooa(J){this.Pvc&&this.Pvc(J?J.data:null)}BFn(J){this.wbh&&this.wbh(J?J.data:null)}XHa(J){this.qBc&&this.qBc(J?J.data:null)}Ptf(J){const ma=new Sys.StringBuilder("requestedsettings=");for(let Ta=0;Ta<J.count;Ta++)ma.append(J.J(Ta)),Ta<J.count-1&&ma.append(";");return ma.toString()}}Object(e.a)(Ma,"FirstRunExperienceRequestHandler",null,[]);var fb=c(266);class hc{constructor(){this.yvc=this.Rld=this.gM=null}Mwo(J){J?(this.gM=J,this.yQm()&&(za.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),
J=new kb.a,J.add(this.gM.R1e),this.Rld=new Ma(this.gM,Object(a.a)(this,this.Z2a,"getRequestSuccessCallback"),Object(a.a)(this,this.Ooa,"getRequestFailureCallback"),null,Object(a.a)(this,this.XHa,"postRequestFailureCallback")),this.Rld.Hjf(J)),(this.gM.UDi||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.lhg()):za.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}yQm(){try{if(this.gM.UDi)return!0;if(!l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",
!0)||l.AFrameworkApplication.K.$("IsAnonymousUser"))return!1;if(this.gM.$Km||this.gM.gec||l.AFrameworkApplication.K.$("IsO365ConsumerHost"))return!0;const J=l.AFrameworkApplication.K.kb("FlightId");return-1!==(J?J.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(J){za.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",J?J.toString():null)}return!1}jhj(J){const ma={},Ta={};Ta.FREDisplayedDate=(new Date).toUTCString();Ta.VersionDisplayed=J;Ta.RemindMeLater=!1;ma[this.gM.R1e]=
Ja.c(Ta);za.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.Rld&&this.Rld.HNd(ma)}Z2a(J,ma){J=J?+J.aU-+J.$H:-1;J>this.gM.agj?za.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",J,this.gM.agj):ma?this.Cvo(ma)?(za.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",
this.gM.uPi),this.lhg()):(this.$ff(!1),za.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(za.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.lhg())}Ooa(J){this.$ff(!1);za.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",J?J.Se:-1)}XHa(J){za.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",
J?J.Se:-1)}lhg(){this.$ff(!0);var J=pa.a.instance.Oa("Common.ISystemInitiatedFeedback");J?this.lsj(J):(za.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((J=pa.a.instance.Ta("Common.ISystemInitiatedFeedback"))?J.execute(ma=>{this.lsj(ma)}):za.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}lsj(J){if(J){var ma=this.gM.PGl;
ma&&(l.AFrameworkApplication.ho(ma),l.AFrameworkApplication.Oia(ma));za.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",ma);J.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.yvc=Object(a.a)(this,this.zon,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",this.yvc,!0),window.addEventListener("FRELaunchedEvent",this.yvc,!0)):(za.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),
this.jhj(this.gM.currentVersion))}else za.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}zon(J){if(J){var ma=J.detail;J=J.type;var Ta=this.gM&&this.gM.xBh?this.gM.xBh.split("-")[0]:null;if("FRELaunchedEvent"===J||Ta&&ma&&ma.id&&-1!==ma.id.indexOf(Ta))ma.success&&(za.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.jhj(this.gM.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.yvc,
!0),window.removeEventListener("FRELaunchedEvent",this.yvc,!0))}}Cvo(J){if("RemindMeLater"in J&&"FREDisplayedDate"in J){if("true"===J.RemindMeLater.toString()&&(+new Date-+new Date(J.FREDisplayedDate.toString()))/36E5>this.gM.uPi)return!0}else if(l.AFrameworkApplication.K.$("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in J&&J.VersionDisplayed<this.gM.currentVersion)return za.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}$ff(J){l.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&
fb.a.dispatch("FREDecisionEvent",{["show"]:J})}}Object(e.a)(hc,"FirstRunExperienceLauncher",null,[1928]);class cc{constructor(){this.W=null}get name(){return"Common.App.FirstRunExperienceLauncher"}wc(J){this.W=J;this.W.register(1928,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").ha().Ud(()=>new hc)}init(){}dispose(){}static main(){M.a.instance.Gc(new cc)}}Object(e.a)(cc,"FirstRunExperienceLauncherPackage",null,[1,2]);class mb{constructor(){this.y=this.x=0}}Object(e.a)(mb,"HammerPoint",
null,[]);class Hb{constructor(J,ma,Ta,pb,Wb){this.F4g=this.KXa=this.god=1;this.Tzd=this.KEc=this.d_a=0;this.ILe=this.PKa=null;this.Tsb=this.wBe=this.Hud=!1;this.vj=J;this.rNa=ma;this.Idb=Ta;this.ga=pb;Wb&&(this.Hud=Wb.$("PromoteLayerPinchToZoomIsEnabled"),this.wBe=Wb.$("FinalizeWithInitialPinchScaleIsEnabled"),this.Tsb=Wb.$("AdjustPinchStartXWithPageMarginIsEnabled"))}get GL(){return this.rNa}get wbg(){return this.Idb}KNm(){return!!this.vj.instance}Won(J){this.ga&&this.ga.processAction(m.a.Jvj,2);
const ma=this.vj.instance;this.Hud&&ma.Y6i();this.KXa=ma.nj;this.god=J.kPc.scale;this.F4g=1;this.ILe=this.dBh();this.PKa=this.rNa.getBounds();if(!this.PKa)return za.ULS.sendTraceTag(42821145,353,15,"Unexpected null bounds"),!1;J=this.Vei(J);this.Tsb?this.Vmj(this.rNa.scrollWidth,this.PKa.width,J,this.KXa,ma):this.d_a=this.rNa.scrollWidth>this.PKa.width?this.VHc(this.Idb.scrollLeft,J.x,this.KXa):null;this.Tzd=this.rNa.scrollHeight>this.PKa.height?this.VHc(this.Idb.scrollTop,J.y,this.KXa):null;return!0}m$f(){this.d_a=
null;this.KEc=0}Vmj(J,ma,Ta,pb,Wb){J>ma?this.d_a?(J=Wb.$Kf,J!==this.KEc&&(this.d_a-=this.KEc-J,this.KEc=J)):(this.d_a=this.VHc(this.Idb.scrollLeft,Ta.x,pb),this.KEc=Wb.$Kf):this.m$f()}Von(J){const ma=this.Vei(J);if(!ma)return za.ULS.sendTraceTag(42821147,353,15,"Unexpected null pinch center"),!1;J=this.Jio(J.kPc.scale/this.god)*this.KXa;this.DZo(ma,J);this.EZo(ma,J);return!0}DZo(J,ma){const Ta=this.rNa.scrollWidth,pb=this.PKa.width;this.Tsb?this.Vmj(Ta,pb,J,ma,this.vj.instance):!this.d_a&&Ta>pb&&
(this.d_a=this.VHc(this.Idb.scrollLeft,J.x,ma));if(J=this.lBh(J.x,this.d_a,Ta,pb,ma))this.Idb.scrollLeft=J}EZo(J,ma){const Ta=this.rNa.scrollHeight,pb=this.PKa.height;!this.Tzd&&Ta>pb&&(this.Tzd=this.VHc(this.Idb.scrollTop,J.y,ma));if(J=this.lBh(J.y,this.Tzd,Ta,pb,ma))this.Idb.scrollTop=J}lBh(J,ma,Ta,pb,Wb){return Ta<=pb||!ma||!pb?null:Math.max(0,Math.min(ma*Wb-J,Ta-pb))}VHc(J,ma,Ta){return(J+ma)/Ta}Uon(J){J=J.kPc.scale;this.wBe&&(J/=this.god);this.S_h(J);this.Hud&&this.vj.instance.B5f();this.ga&&
this.ga.processAction(m.a.pif,2);this.Tsb&&this.m$f()}Ton(J){J=J.kPc.scale;this.wBe&&(J/=this.god);this.S_h(J,!0);this.Hud&&this.vj.instance.B5f();this.ga&&this.ga.processAction(m.a.pif,2);this.Tsb&&this.m$f()}Jio(J){const ma=this.vj.instance,Ta=new Date>=this.ILe;Ta&&(this.ILe=this.dBh());Math.abs(J-this.F4g)>=.01*J&&ma.Epo(J*this.KXa,Ta);return ma.nj/this.KXa}S_h(J,ma=!1){J*=this.KXa;this.vj.instance.kfg(J,!1);const Ta={};Ta.initialScale=this.KXa;Ta.finalScale=J;Ta.cancelled=ma;za.ULS.sendTraceTag(42821150,
353,50,"Pinch zoom ended: {0}",Ta)}Vei(J){return(J=J.kPc.center)&&this.PKa?Object.assign(new mb,{x:J.x-this.PKa.x,y:J.y-this.PKa.y}):null}dBh(){const J=(new Date).getTime();return new Date(J+1E3)}}Object(e.a)(Hb,"PinchZoomAdapter",null,[2017]);class Ua{constructor(J){this._element=J}get scrollWidth(){return this._element.scrollWidth}get scrollHeight(){return this._element.scrollHeight}getBounds(){return Sys.UI.DomElement.getBounds(this._element)}}Object(e.a)(Ua,"ScrollContainerElement",null,[2016]);
var Ya=c(133);class Fb{constructor(J,ma,Ta,pb,Wb,Jc){this.rUe=this.obb=null;this.W=J;this.je=ma;this.rpd=Ta;this.z2g=pb;this.i9j=Wb;this.CXb=Jc;this.Kid=new kb.a}register(J,ma){this.rpd&&(4===l.AFrameworkApplication.ua.Kb.yk&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.OneNoteOnline.OneNoteDelayLoadHammerJs",!1)?Ya.a.get_instance().pk(8,()=>{this.Lej(J,ma)}):this.Lej(J,ma))}Lej(J,ma){this.W.Ta("Common.IGestureInputManager").execute(Ta=>{this.fDo();this.obb=Ta;this.Kid.add(J);
if(this.z2g){if(this.i9j&&0!==Ta.SZl()){this.pwj();return}var pb=this.W.Ta("Common.IZoomManager");this.W.resolve("Common.IAppSettingsManager");const Wb=new Ua(J);pb=new Hb(pb,Wb,ma,l.AFrameworkApplication.va,l.AFrameworkApplication.K);Ta.gWn(J,pb)}this.pwj()})}unregister(){if(this.obb&&this.Kid){if(this.z2g){for(let J of this.Kid)this.obb.GSo(J);this.Kid.clear()}this.obb=null}}fDo(){this.CXb&&(this.je?this.rUe=this.je.Zf("Task","Register"):za.ULS.sendTraceTag(590387076,310,10,"_stopwatchBuilder is null"))}pwj(){this.CXb&&
(this.rUe?this.rUe.stop():za.ULS.sendTraceTag(590387077,310,10,"_stopwatchForRegister is null"))}}Object(e.a)(Fb,"GestureInputRegistrar",null,[1931]);class Wa{constructor(){this.W=null;this.Zh=!1}get name(){return"Common.App.GestureInput"}init(){this.Zh||(this.W.resolve("Common.IGestureInputRegistrar"),this.Zh=!0)}dispose(){}wc(J){this.W=J;J.register(1931,"Common.IGestureInputRegistrar").ha().Ud(()=>new Fb(J,l.AFrameworkApplication.ua.Lq,l.AFrameworkApplication.rXc(),l.AFrameworkApplication.xBi(),
!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("PinchZoomOnlyPointerEventsIsEnabled"),!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled")))}static main(){M.a.instance.Gc(new Wa)}}Object(e.a)(Wa,"GestureInputPackage",null,[1,2]);var yb=c(406),Yb=c(83);class qc{constructor(){this.Sob=this.D4h=null}}Object(e.a)(qc,"GestureAdapterInfo",null,[]);var Hc=c(633),$b=c(293);class Ub{constructor(){this.gub=null}vMf(){if(!this.gub){var J="hammer.min.js";l.AFrameworkApplication.K.rw("IsServerFlavorDebug")&&
(J=l.AFrameworkApplication.K.$("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");J=l.AFrameworkApplication.Sz(String.format("{0}",J),5);J=$b.a.create(J,null,null);Hc.a.PX(J);this.gub=J.s5a}return this.gub}static get instance(){Ub._instance||(Ub._instance=new Ub);return Ub._instance}}Ub._instance=null;Object(e.a)(Ub,"HammerJsDependencyLoader",null,[2029]);const mc=(J,ma,Ta=null)=>{if(void 0===ma||null===ma)throw za.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");
let pb=null;switch(J){case V.a.pinch:pb=new Hammer.Pinch(Ta);break;case V.a.pan:pb=new Hammer.Pan(Ta)}pb&&(pb.manager=ma);return pb};var ic;(function(J){J[J.none=-1]="none";J[J.pinch=0]="pinch";J[J.pan=1]="pan";J[J.swipe=2]="swipe"})(ic||(ic={}));Object(e.b)("GestureEvent",ic);var ab=c(71);class bb extends ab.a{constructor(J,ma,Ta,pb,Wb,Jc,Zc,jd){super(J,Ta,pb,Jc);this.osc=ma;this.HZa=Zc;this.Isa=jd;this.Z3j=Wb}get shiftKey(){return this.HZa}get ctrlKey(){return this.Isa}get clientPoint(){return this.osc}get kPc(){return this.Z3j}static create(J,
ma,Ta,pb,Wb,Jc){if(Ta.rawEvent)if(Jc){var Zc=Ta.rawEvent;Zc=new Sys.UI.Point(Zc.clientX,Zc.clientY)}else Zc=ab.a.HQd(Ta);else Zc=new Sys.UI.Point(Ta.clientX,Ta.clientY);return new bb(J,Zc,ma,Ta,pb,Wb,Ta.shiftKey,Ta.ctrlKey,Jc)}}Object(e.a)(bb,"GestureEventArgs",ab.a,[]);class Jb{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=
this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(e.a)(Jb,"GestureManagerData",null,[]);class Eb{}Eb.IRj=2;Eb.JRj=4;Eb.KRj=8;Eb.LRj=8;Object(e.a)(Eb,"HammerConstants",null,[]);var hb=c(94),ob=c(115),Va=c(19),Qb=c(105);class Vb extends Q.a{constructor(J,ma){super();this.bMa=yb.a.VLl;this.FOe=!!window.PointerEvent;this.Ujh=window.hasOwnProperty("ontouchstart");this.ovb=this.kAc=null;this.OLa=
!1;this.fma=new Yb.a;this.oBc=new Yb.a;this.dXg=new kb.a;this.sab=null;this.$Ub=this.CXb=this.EOg=this.Rve=this.cKe=this.Jdh=this.VOg=this.REc=!1;this.mzc=-1;this.curRecognizer=this.element=this.handlers=this.session=this.sUe=null;this.ng=hb.EventHandlerManager.instance;this.FOe?(za.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.kAc=Object(a.a)(this,this.n8d,"onPointerEvent"),this.ovb=V.a.XLl):this.Ujh?(za.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.kAc=Object(a.a)(this,
this.Znb,"onTouchEvent"),this.ovb=V.a.touchEvents):(za.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.kAc=Object(a.a)(this,this.$7d,"onMouseEvent"),this.ovb=V.a.WLl);this.je=ma;this.S2=J;l.AFrameworkApplication.K&&(this.REc=l.AFrameworkApplication.K.$("UsePointerCaptureIsEnabled"),this.VOg=l.AFrameworkApplication.K.$("ClearCacheOnPrimaryPointerIsEnabled"),this.Jdh=l.AFrameworkApplication.K.$("ResetHandledBeforeInputHandlerIsEnabled"),this.cKe=l.AFrameworkApplication.K.$("LogCoalescedEventsIsEnabled"),
this.Rve=l.AFrameworkApplication.K.$("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.EOg=l.AFrameworkApplication.K.$("CheckIfHammerExistsAfterDownloadIsEnabled"),this.CXb=l.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled"),this.$Ub=this.REc&&l.AFrameworkApplication.K.$("CancelDragFromGestureInputManagerIsEnabled")&&l.AFrameworkApplication.K.$("UseGestureInputManagerPointerCacheIsEnabled"))}SZl(){return this.FOe?0:this.Ujh?1:2}lv(J){super.lv(J);this.ng.cGa(this.ovb,J,0,this.kAc)}ev(J){super.ev(J);
this.ng.f1a(J,this.ovb)}gWn(J,ma){l.AFrameworkApplication.rXc()?Ub.instance.vMf().continueWith(Ta=>{this.eDo();if(Ta.Gi||Ta.Io)za.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",Ta.status);else{za.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",Ta.status);if(this.EOg){Ta=window.Hammer;if("undefined"===typeof Ta){za.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.xke();return}if("undefined"===typeof Ta.inputHandler){za.ULS.sendTraceTag(590901390,
310,10,"Hammer.inputHandler does not exist");this.xke();return}}if(!J)throw this.xke(),Error.argumentNull("source element can not be null");Ta=ob.a.Eb(J,this.bMa);if(void 0===Ta||null===Ta)Ta=new Yb.a,ob.a.Sl(J,this.bMa,Ta),this.hWn(J);if(!Ta.nb(ic[0])){var pb=Object.assign(new qc,{Sob:mc(ic[0],this,null),D4h:ma});Ta.add(ic[0],pb)}}this.xke()}):za.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}eDo(){this.CXb&&(this.je?this.sUe=this.je.Zf("Task",
"RegisterGestureAdapterAfterLoad"):za.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}xke(){this.CXb&&(this.sUe?this.sUe.stop():za.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}GSo(J){za.ULS.sendTraceTag(42256223,310,J?100:10,"source element {0} ",J.id);const ma=ob.a.Eb(J,this.bMa);void 0!==ma&&null!==ma&&(ma.remove(ic[0]),ma.count||(ob.a.tV(J,this.bMa),this.curRecognizer=null,this.HSo(J)))}hWn(J){this.dXg.add(J);this.ng.cGa(this.ovb,J,
0,this.kAc)}HSo(J){this.dXg.remove(J);this.ng.f1a(J,this.ovb)}recognize(J){var ma=Array(J.pointers.length);for(var Ta=0;Ta<J.pointers.length;Ta++)ma[Ta]=J.pointers[Ta].target;Ta=null;for(this.sab=this.k4l(ma);void 0!==this.sab&&null!==this.sab&&(Ta=ob.a.Eb(this.sab,this.bMa),void 0===Ta||null===Ta);this.sab=this.sab.parentNode);if(void 0!==Ta&&null!==Ta){this.curRecognizer&&this.curRecognizer.state===Eb.LRj&&(this.curRecognizer=null);ma=Ta.keys;for(let pb of ma){ma=Ta.J(pb);void 0!==ma&&null!==ma&&
void 0!==ma.Sob&&null!==ma.Sob&&(void 0===this.curRecognizer||null===this.curRecognizer||ma.Sob===this.curRecognizer||ma.Sob.canRecognizeWith(this.curRecognizer))&&ma.Sob.recognize(J);const Wb=ma.Sob.state;this.curRecognizer||Eb.IRj!==Wb&&Eb.JRj!==Wb&&Eb.KRj!==Wb||(this.curRecognizer=ma.Sob)}}}emit(J,ma){if("hammer.input"!==J){this.OLa=!1;ma=bb.create(J,this.sab,ma.srcEvent,ma,3,this.FOe);var Ta=ob.a.Eb(this.sab,this.bMa);if(this.uSm(J))var pb=0;else if(this.SRm(J))pb=1;else if(this.MVm(J))pb=2;else{za.ULS.sendTraceTag(42256256,
310,15,"Event can not be recognized by current manager");return}({value:Ta}=Ta.Fc(ic[pb]));void 0!==Ta&&null!==Ta&&((Ta=Ta.D4h,Ta.KNm())?J.endsWith("start")?this.OLa=Ta.Won(ma):J.endsWith("end")?(Ta.Uon(ma),this.OLa=!0):J.endsWith("cancel")?(Ta.Ton(ma),this.OLa=!0):J.endsWith("move")&&(this.OLa=Ta.Von(ma)):za.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",J))}}get(J){return Object(Bb.a)(Hammer.Recognizer,J)}k4l(J){if(1>J.length)return null;if(1===J.length)return J[0];
var ma=J[0],Ta=!0;for(let pb=1;pb<J.length;pb++){if(!J[pb])return null;if(ma!==J[pb]){Ta=!1;break}}if(Ta)return ma;ma=this.h5h(J[0]);Ta=0;for(const pb of J){J=this.h5h(pb);if(ma.J(ma.count-1)!==J.J(J.count-1))return null;for(let Wb=ma.count-2,Jc=J.count-2;Wb>=Ta&&0<=Jc;Wb--,Jc--)if(ma.J(Wb)!==J.J(Jc)){Ta=Wb+1;break}}return ma.J(Ta)}h5h(J){const ma=new kb.a;for(;void 0!==J&&null!==J;J=J.parentNode)ma.add(J);return ma}Yai(J){switch(J){case V.a.cQ:case V.a.JBb:return 1;case V.a.bQ:case V.a.x5e:return 2;
case V.a.hK:case V.a.KBb:return 4;case V.a.Lme:case V.a.w5e:return 8}return 0}Znb(J,ma,Ta){J=this.Yai(J);ma=this.v1l(Ta);Hammer.inputHandler(this,J,ma);this.OLa&&Ta.preventDefault();return this.OLa}bni(){return 1<this.fma.count}oFd(){za.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.REc)for(let J of this.fma)this.Uaj(J.key);else this.fma=new Yb.a;this.session=null}buk(J,ma,Ta){za.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",J);if(!this.oBc.nb(J)){try{ma.setPointerCapture(J)}catch(pb){za.ULS.sendTraceTag(594055958,
310,10,"Exception: {0}",pb)}this.oBc.add(J,ma)}this.fma.Z(J,Ta);this.$Ub&&1<this.fma.count&&this.S2&&!this.S2.eIc&&(this.S2.eIc=!0)}Uaj(J){za.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",J);if(this.oBc.nb(J)){try{this.oBc.J(J).releasePointerCapture(J)}catch(ma){za.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",ma)}this.oBc.remove(J)}else za.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",J);this.fma.remove(J);this.$Ub&&
1>=this.fma.count&&this.S2&&this.S2.eIc&&(this.S2.eIc=!1)}n8d(J,ma,Ta){var pb=Ta.rawEvent.pointerType.toString();const Wb=Ta.rawEvent.pointerId.toString();if("touch"!==pb)return!1;J=this.Yai(J);if(1!==J&&!this.fma.nb(Wb))return!1;this.VOg&&1===J&&Ta.rawEvent.isPrimary&&this.fma.count&&(za.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.oFd());this.REc?this.buk(Wb,ma,Ta):this.fma.Z(Wb,Ta);this.cKe&&2===J&&(!this.Rve||this.Rve&&"function"===typeof Ta.rawEvent.getCoalescedEvents)&&
(ma=Ta.rawEvent.getCoalescedEvents())&&this.bni()&&(this.mzc=Math.max(this.mzc,ma.length));this.Jdh&&(this.OLa=!1);pb=this.u1l(this.fma,Ta,pb);Hammer.inputHandler(this,J,pb);if(4===J||8===J)this.REc?this.Uaj(Wb):this.fma.remove(Wb),this.fma.count||(this.session=null,this.cKe&&-1!==this.mzc&&(za.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.mzc),this.mzc=-1));this.OLa&&Ta.preventDefault();return this.OLa}$7d(){return!1}v1l(J){const ma=new Jb;var Ta=J.rawEvent;const pb=
Ta.touches;Ta=Ta.changedTouches;ma.pointers=Array.clone(pb);ma.pointers=Array.clone(0<pb.length?pb:Ta);ma.changedPointers=Array.clone(Ta);ma.srcEvent=J;ma.pointerType="touch";return ma}u1l(J,ma,Ta){const pb=new Jb;pb.pointers=Qb.toArray(J.values);pb.changedPointers=[ma];pb.pointerType=Ta;pb.srcEvent=ma;return pb}uSm(J){return Va.a.startsWith(J,V.a.pinch)}SRm(J){return Va.a.startsWith(J,V.a.pan)}MVm(J){return Va.a.startsWith(J,V.a.swipe)}}Object(e.a)(Vb,"GestureInputManager",Q.a,[2002,2003]);var Sb=
c(300);class nb{constructor(){this.W=null;this.Zh=!1}get name(){return"Common.App.GestureInputManager"}wc(J){J.register(Vb,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").ha().Ud(()=>new Vb(Sb.a.instance,l.AFrameworkApplication.ua.Lq));this.W=J}init(){this.Zh||(this.W.resolve("Common.App.GestureManager.GestureInputManager"),this.Zh=!0)}dispose(){}static main(){M.a.instance.Gc(new nb)}}Object(e.a)(nb,"GestureInputManagerPackage",null,[1,2]);var ac=c(249),zc=c(45),
Ib=c(1579);class ya{constructor(J,ma,Ta){this.MSe=this.LSe=null;this.n0b=new z.a;this.$f=J;this.cAc=Ta;this.Lma=ma.appSettings[ya.v4o]||""}get ero(){return this.n0b.task}get TQ(){return this.$f.value}G5n(){const J={};J[ya.Brm]=l.AFrameworkApplication.em;J["Content-Type"]="application/json; charset=utf-8";za.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const ma=zc.a.fp(this.Lma+ya.fro,ya.Wjn,l.AFrameworkApplication.ua.Kb.yk.toString());this.TQ.mj(ma,
1,"",J,!0,2,Object(a.a)(this,this.VMb,"onSuccessCallback"),Object(a.a)(this,this.DMb,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}J6m(J){try{const ma={};ma.FlightName=J.FlightName;ma.SessionID=J.SessionID;za.ULS.sendTraceTag(594883776,215,50,Ja.c(ma))}catch(ma){za.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}VMb(J){if((J=J.data.se)&&J.length)try{const ma=Ja.a(J);this.LSe=ma.NavBarDataJson;za.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");
this.LSe?({Gt:this.MSe}=Ja.d(ma.NavBarDataJson)).returnValue?(this.J6m(this.MSe),this.n0b.Dg(this.MSe)):(za.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:Ib.a.Mcd(this.LSe)}),this.n0b.hea()):(za.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.n0b.hea())}catch(ma){za.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.n0b.hea()}else za.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")}DMb(){this.n0b.hea();
za.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return ya._instance||(ya._instance=ya.DFb())}static DFb(){return new ya(new ac.a(()=>l.AFrameworkApplication.He),l.AFrameworkApplication.K,l.AFrameworkApplication.ua.Kb.yk)}}ya.Brm="X-qs";ya.Wjn="at";ya.fro="O365ShellServiceProxy.ashx";ya._instance=null;ya.v4o="ShellWebServiceBase";Object(e.a)(ya,"O365ShellActor",null,[2004]);class ib{constructor(){this.W=null}get name(){return"Common.App.O365Shell"}wc(J){this.W=
J;this.W.register(ya,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").ha().Ud(()=>new ya(new ac.a(()=>l.AFrameworkApplication.He),l.AFrameworkApplication.K,l.AFrameworkApplication.ua.Kb.yk))}init(){l.AFrameworkApplication.K.Nn(Object(a.a)(this,this.Xx,"onFullAppSettingsReady"))}Xx(){l.AFrameworkApplication.Tqg&&l.AFrameworkApplication.ua.Kb.MJ&&this.W.resolve("Common.App.O365Shell.O365ShellActor").G5n()}dispose(){}static main(){M.a.instance.Gc(new ib)}}Object(e.a)(ib,
"PackageManager",null,[1,2]);class wb{fSa(){}init(){}dispose(){}}Object(e.a)(wb,"NoOpOfflineLogger",null,[1998,9]);var bc=c(797);class lc{}lc.ZCd=0;Object(e.a)(lc,"OfflineLoggerConstants",null,[]);var Kb=c(93),Bc=c(250),Xc=c(306);class vd{constructor(J,ma,Ta,pb,Wb,Jc,Zc,jd){this.fKe=this.czc=null;this.TXa=!1;this.u7=null;this.otc=this.OYb=this.Vtb=0;this.QI=this.tcb=this.Shd=this.Jtd=this.DQ=null;this.lm=!1;this.$Ba=Ta;this.MCa=pb;this.zCa=Wb;this.$f=ma;this.Ib=J;this.WWa=Jc;this.Iwb=!1;this.hMa=
jd;Zc?(this.Shd=new vd(J,ma,Ta,pb,Wb,Jc,!1,jd),this.Shd.Jtd=this,this.czc="OfflineLoggerManifest|"+this.WWa,this.fKe="OfflineLog|"+this.WWa+"|"):(this.czc="OfflineLoggerManifest",this.fKe="OfflineLog|")}init(){this.wfg();this.M2m();this.TXa=!1;this.$f.y2b(this);this.DQ=new Kb.a(3,2,2500,Object(a.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),104);this.Ib.Wb(this.DQ);this.Shd&&this.Shd.init()}IHc(J){return this.fKe+J}M2m(){const J=this.$Ba.getItem(this.czc);void 0!==J&&null!==J&&0<J.length&&(this.u7=
vd.Ucd(J));this.u7||(this.u7={});if(void 0===this.u7.end||null===this.u7.end)this.u7.end=0;if(void 0===this.u7.offset||null===this.u7.offset)this.u7.offset=0;this.Vtb=this.u7.offset;isFinite(this.Vtb)||(this.Vtb=0);this.OYb=this.u7.end;isFinite(this.OYb)||(this.OYb=0);this.otc=this.OYb}wfg(){this.tcb=new Xc.a;this.QI=new Bc.a;this.Jtd||(this.MCa.Yqh(Object(a.a)(this,this.dZf,"onUlsReadyToBeSent")),this.MCa.Crh(Object(a.a)(this,this.fZf,"onUlsSentSuccessfully")),this.MCa.Brh(Object(a.a)(this,this.eZf,
"onUlsSentFailed")));this.MCa.Oqh(Object(a.a)(this,this.hVf,"onAfterUlsHostDisposed"))}dZf(J,ma){if(void 0!==ma&&null!==ma&&void 0!==ma.args&&null!==ma.args){J=!1;if(!this.tcb.nb(ma.args.tag)){if(!this.tcb.nb(lc.ZCd))return;J=!0}this.tcb.remove(J?lc.ZCd:ma.args.tag);this.QI.nb(ma.uploadId)||this.QI.Z(ma.uploadId,new kb.a);this.QI.J(ma.uploadId).add(ma.args)}}fZf(J,ma){this.QI.remove(ma.uploadId);this.hMa&&this.Iwb&&(this.Iwb=!1,this.PEh())}eZf(J,ma){this.Iwb=!0;if(void 0!==ma&&null!==ma&&this.QI.nb(ma.uploadId)){J=
!0;var Ta=this.QI.J(ma.uploadId);for(let pb of Ta)Ta=vd.serialize(pb,this.zCa),Ta=this.Vcd(this.IHc(this.otc++),Ta),this.hMa&&!Ta&&(J=!1);this.hMa&&J&&this.QI.remove(ma.uploadId)}}hVf(){this.dispose()}Vcd(J,ma){try{return this.$Ba.setItem(J,ma),!0}catch(Ta){return this.hMa||za.ULS.sendTraceTag(18614232,222,15,"OfflineLogger SetItem failed with exception: {0}",Ta.message),!1}}sendOfflineLogs(){if(!this.TXa){for(var J=this.Vtb,ma=new kb.a,Ta=null;J<this.OYb&&5>=ma.count;++J){var pb=this.IHc(J);const Wb=
this.$Ba.getItem(pb);this.$Ba.removeItem(pb);if(void 0===Wb||null===Wb)continue;const Jc=({sessionId:pb}=vd.deserialize(Wb)).returnValue;if(Jc){if(!Ta)Ta=pb;else if(pb!==Ta)break;ma.add(Jc)}else za.ULS.sendTraceTag(18614233,222,15,"Unable to deserialze the offline log: {0}",Wb)}0<ma.count&&this.MCa.lej(this,Qb.toArray(ma),Ta);this.Vtb=J;J>=this.OYb&&this.AEb()}}PEh(){this.AEb();this.DQ=new Kb.a(3,2,2500,Object(a.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),104);this.Ib.Wb(this.DQ)}fSa(J,ma,Ta){!this.lm&&
za.ULS.R$(ma,Ta)&&(this.Jtd?this.Jtd.fSa(J,ma,Ta):this.tcb.Z(J,!0))}dispose(){if(!this.lm){this.DQ&&this.Ib.ff(this.DQ);var J=Qb.toArray(this.QI.keys);J.sort();for(const ma of J){J=this.QI.J(ma);for(let Ta of J)J=vd.serialize(Ta,this.zCa),this.Vcd(this.IHc(this.otc++),J)}this.Vtb<this.otc?(this.u7.end=this.otc,this.u7.offset=this.Vtb,this.Vcd(this.czc,JSON.stringify(this.u7))):this.$Ba.removeItem(this.czc)}this.lm=!0}T5a(){this.TXa=!0}VLb(){this.TXa=!1;this.hMa&&this.PEh()}AEb(){this.DQ&&(this.Ib.ff(this.DQ),
this.DQ=null)}static serialize(J,ma){const Ta={};Ta.t=J.tag;Ta.c=J.category;Ta.l=J.level;Ta.m=J.message;Ta.lt=J.logType;Ta.s=ma;Ta.ts=J.timestamp;Ta.o=J.isMinified;Ta.a=J.args;return JSON.stringify(Ta)}static deserialize(J){return(J=vd.Ucd(J))?{returnValue:new bc.a(J.ts,J.c,J.t,J.l,J.m,J.lt,J.o,J.a),sessionId:J.s}:{returnValue:null,sessionId:null}}static Ucd(J){try{return JSON.parse(J)}catch(ma){za.ULS.sendTraceTag(18614234,222,10,"OfflineLogger TryParseString failed with exception: {0}",ma.message)}return null}}
Object(e.a)(vd,"OfflineLoggerImpl",null,[1998,9,238]);class vc{constructor(J,ma,Ta,pb){this.sessionId=J;this.version=ma;this.SDd=Ta;this.MZf=pb;this.mLb=new kb.a}}Object(e.a)(vc,"CachedLogUpload",null,[]);class bd{constructor(J){J.name&&(this.n=J.name);J.stack&&(this.s=J.stack);J.message&&(this.m=J.message);J.file&&(this.f=J.file);null!=J.line&&(this.l=J.line);null!=J.column&&(this.c=J.column)}}Object(e.a)(bd,"LoggingExceptionArgsLocalStorage",null,[]);class Sd{constructor(J){this.t=J.tag;this.c=
J.category;this.l=J.level;this.m=J.message;this.lt=J.logType;this.ts=J.timestamp;this.o=J.isMinified;this.a=J.args;J.exceptionArgs&&(this.e=new bd(J.exceptionArgs))}}Object(e.a)(Sd,"LoggingArgsLocalStorage",null,[]);var pd=c(481);class Tc{constructor(J,ma,Ta,pb,Wb,Jc,Zc){this.t=J;this.m=ma;this.s=Ta;this.v=pb;this.i=Wb;this.a=Jc;this.d=Zc;this.op="Log"}}Object(e.a)(Tc,"LoggingKeyLocalStorage",null,[]);var Wc=c(139);const Pc=(J,ma,Ta,pb,Wb)=>!(void 0===J||null===J)&&!(void 0===J.i||null===J.i)&&!(void 0===
J.t||null===J.t)&&!(void 0===J.s||null===J.s)&&"Log"===J.op&&J.t===ma&&isFinite(J.t)&&Wc.a.isValid(J.s)&&(void 0===J.m||null===J.m||J.m===Ta)&&(!Wb||void 0===J.d||null===J.d||J.d===pb);class Xd{constructor(J,ma,Ta,pb,Wb,Jc,Zc,jd,dd,Ld,$d,le,ae,Oe){this.TXa=this.m6g=this.$5g=this.a6g=!1;this.QI=this.tcb=this.u7=this.DQ=null;this.lm=!1;this.vwb=[];this.IYb=[];this.$Ba=Ta;this.MCa=pb;this.zCa=Wb;this.$f=ma;this.Ib=J;this.cAc=Jc;this.hMe=Zc;this.Tdh=jd;this.nYa=dd;this.nak=Ld;this.DHe=$d;this.WWa=le;
this.N0g=ae;this.Iwb=!1;this.hMa=Oe}get manifest(){return this.u7}get q_c(){return this.tcb}get YGa(){return this.QI}init(){this.wfg();this.TXa=!1;this.$f.y2b(this);this.DQ=new Kb.a(3,1,2500,Object(a.a)(this,this.determineLogsToSendAtBoot,"determineLogsToSendAtBoot"),103);this.Ib.Wb(this.DQ)}determineLogsToSendAtBoot(){this.sSh(!0)}determineLogsToSendOnReconnect(){this.sSh(!1)}sSh(J){this.AEb();this.vwb=[];J&&(this.IYb=[]);for(var ma=0;ma<this.$Ba.length;ma++){const Ta=this.$Ba.key(ma),pb=Xd.dDj(Ta,
!1);Pc(pb,this.cAc,this.hMe,this.WWa,this.N0g)&&(pb.s===this.zCa?Array.add(this.vwb,Ta):J&&Array.add(this.IYb,Ta))}if(this.vwb.length||J&&this.IYb.length)if(ma=this.DHe?Object(a.a)(this,this.rAo,"sortDescendKeysToUpload"):Object(a.a)(this,this.uAo,"sortKeysToUpload"),this.vwb.sort(ma),J&&this.IYb.sort(ma),0<this.vwb.length||0<this.IYb.length)this.DQ=new Kb.a(3,2,2500,Object(a.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),105),this.Ib.Wb(this.DQ)}uAo(J){return J.s!==J.s?J.s.localeCompare(J.s):J.i-
J.i}rAo(J){return J.s!==J.s?J.s.localeCompare(J.s):J.i-J.i}IHc(J,ma,Ta,pb){J=new Tc(this.cAc,this.hMe,ma,Ta,J,pb,this.WWa);return JSON.stringify(J)}wfg(){this.tcb=new Xc.a;this.QI=new Bc.a;this.MCa.Yqh(Object(a.a)(this,this.dZf,"onUlsReadyToBeSent"));this.MCa.Crh(Object(a.a)(this,this.fZf,"onUlsSentSuccessfully"));this.MCa.Brh(Object(a.a)(this,this.eZf,"onUlsSentFailed"));this.MCa.Oqh(Object(a.a)(this,this.hVf,"onAfterUlsHostDisposed"))}dZf(J,ma){if(void 0!==ma&&null!==ma&&void 0!==ma.args&&null!==
ma.args){if(this.q_c.nb(ma.args.tag))this.q_c.remove(ma.args.tag);else if(this.q_c.nb(lc.ZCd))this.q_c.remove(lc.ZCd);else if(!(this.nak&&50>ma.args.level))return;({value:J}=this.YGa.Fc(ma.uploadId)).returnValue||(J=new vc(ma.sessionId,ma.version,ma.SDd,ma.MZf),this.YGa.Z(ma.uploadId,J));this.YGa.J(ma.uploadId).mLb.add(ma.args)}}fZf(J,ma){this.YGa.remove(ma.uploadId);this.hMa&&this.Iwb&&(this.Iwb=!1,this.QEh())}eZf(J,ma){this.Iwb=!0;void 0!==ma&&null!==ma&&this.YGa.nb(ma.uploadId)&&this.SPi(ma.uploadId)&&
!this.m6g&&(this.m6g=!0,this.hMa||za.ULS.sendTraceTag(37290073,222,50,"Added logs to local storage."))}SPi(J){let ma=!1;if(({value:pb}=this.YGa.Fc(J)).returnValue&&pb&&0<pb.mLb.count){if(pb.SDd>=this.nYa)return this.hMa&&this.YGa.remove(J),!1;var Ta=pb.mLb;const Wb=Array(Ta.count);for(let Jc=0,Zc=Ta.count;Jc<Zc;++Jc)Wb[Jc]=new Sd(Ta.J(Jc));Ta=Xd.serialize(Wb);var pb=this.IHc(pb.MZf,pb.sessionId,pb.version,pb.SDd);this.Vcd(pb,Ta)&&(this.YGa.remove(J),ma=!0)}return ma}hVf(){this.dispose()}Vcd(J,ma){try{return this.$Ba.setItem(J,
ma),!0}catch(Ta){return this.hMa||za.ULS.sendTraceTag(37290074,222,15,"OfflineLogger SetItem failed with exception: {0}",Ta.message),!1}}sendOfflineLogs(){if(!this.TXa){var J=0<this.vwb.length?this.vwb:this.IYb,ma=J.length;if(ma)for(;0<ma;){l.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordSendOfflineLogsV2ImprovementSettings");ma--;var Ta=this.DHe?J.pop():J[0];this.DHe||Array.removeAt(J,0);const Jc=Xd.dDj(Ta,!0);if(Pc(Jc,this.cAc,this.hMe,this.WWa,this.N0g)){var pb=this.$Ba.getItem(Ta);
this.$Ba.removeItem(Ta);if(void 0!==pb&&null!==pb)if(Jc.a>this.nYa)za.ULS.sendTraceTag(37290075,222,50,"Log has more attempt {0} than the max allowed {1}.",Jc.a,this.nYa);else if(Ta=Xd.Ucd(pb,!0),void 0!==Ta&&null!==Ta&&isFinite(Ta.length))if(Ta.length){pb=Ta[Ta.length-1];var Wb=(new Date).getTime()-pb.ts;if(Wb<-Xd.Izj)za.ULS.sendTraceTag(37290078,222,50,"Log came from more than a day in the future.  Let's throw it away and not trust it. {0}",pb.ts);else if(Wb>this.Tdh*Xd.Izj)za.ULS.sendTraceTag(37290079,
222,50,"Log is older than our retention period of {0} days.  Throwing it away. {1}",this.Tdh,pb.ts);else{Jc.s===this.zCa?this.a6g||(this.a6g=!0,za.ULS.sendTraceTag(37290080,222,50,"Attempted to re-send logs from this session.")):this.$5g||(this.$5g=!0,za.ULS.sendTraceTag(37290081,222,50,"Attempted to re-send logs from another session {0}.",Jc.s));ma=Array(Ta.length);for(pb=0;pb<Ta.length;pb++){J=pb;a:{Wb=Ta[pb];if(void 0===Wb||null===Wb){Wb=null;break a}let Zc=null;Wb.e&&(Zc=new pd.a(null),Zc.name=
Wb.e.n,Zc.stack=Wb.e.s,Zc.message=Wb.e.m,Zc.file=Wb.e.f,Zc.line=Wb.e.l,Zc.column=Wb.e.c);Wb=new bc.a(Wb.ts,Wb.c,Wb.t,Wb.l,Wb.m,Wb.lt,Wb.o,Wb.a,Zc)}ma[J]=Wb}this.MCa.lej(this,ma,Jc.s,Jc.v,Jc.a+1,Jc.i);break}}else za.ULS.sendTraceTag(37290077,222,15,"Deserialize an empty array from local storage: {0}",pb);else za.ULS.sendTraceTag(37290076,222,15,"Unable to deserialize the offline log: {0}",pb)}}else this.AEb()}}QEh(){this.AEb();this.DQ=new Kb.a(3,1,2500,Object(a.a)(this,this.determineLogsToSendOnReconnect,
"determineLogsToSendOnReconnect"),102);this.Ib.Wb(this.DQ)}fSa(J,ma,Ta){!this.lm&&za.ULS.R$(ma,Ta)&&this.q_c.Z(J,!0)}dispose(){if(!this.lm){this.DQ&&this.Ib.ff(this.DQ);var J=Qb.toArray(this.YGa.keys);for(const ma of J)this.SPi(ma)}this.lm=!0}T5a(){this.TXa=!0;this.AEb()}VLb(){this.TXa=!1;this.QEh()}AEb(){this.DQ&&(this.Ib.ff(this.DQ),this.DQ=null)}static serialize(J){return JSON.stringify(J)}static dDj(J,ma){(J=Xd.Ucd(J,ma))&&void 0===J.d&&(J=new Tc(J.t,J.m,J.s,J.v,J.i,J.a,0));return J}static Ucd(J,
ma){try{return JSON.parse(J)}catch(Ta){ma&&za.ULS.sendTraceTag(37290082,222,10,"OfflineLogger TryParseString failed with exception: {0}",Ta.message)}return null}}Xd.Izj=864E5;Object(e.a)(Xd,"OfflineLoggerImplV2",null,[1998,9,238]);class Dd{constructor(){localStorage.getItem("{CBEDE940-2407-4B58-BA27-B8CBF0B0DDE6}{5}")}get length(){try{return localStorage.length}catch(J){return this.handleError("Length",J),-1}}key(J){try{return localStorage.key(J)}catch(ma){return this.handleError("Key",ma),null}}getItem(J){try{return localStorage.getItem(J)}catch(ma){return this.handleError("GetItem",
ma),null}}setItem(J,ma){try{return localStorage.setItem(J,ma)}catch(Ta){return this.handleError("SetItem",Ta),null}}removeItem(J){try{localStorage.removeItem(J)}catch(ma){this.handleError("RemoveItem",ma)}}clear(){try{localStorage.clear()}catch(J){this.handleError("Clear",J)}}handleError(){}}Object(e.a)(Dd,"OfflineStorage",null,[1997]);class $e{create(J){var ma=null;try{void 0!==localStorage&&null!==localStorage&&(ma=new Dd)}catch(pb){za.ULS.sendTraceTag(18641093,222,50,"window.localStorage is not accessable: {0}",
pb.message)}Object.getType(za.ULS.host).implementsInterface(954)&&ma||(za.ULS.sendTraceTag(18614230,222,50,"OfflineLogger is not supported: offline storage is {0}, ULS host hook is {1}",ma?"supported":"not supported",Object.getType(za.ULS.host).implementsInterface(954)?"supported":"not supported"),J=0);const Ta=l.AFrameworkApplication.K;1===J?ma=new vd(l.AFrameworkApplication.lc,l.AFrameworkApplication.He,ma,za.ULS.host,l.AFrameworkApplication.userSessionId,l.AFrameworkApplication.MPh,Ta.$("OfflineLoggerDataBoundarySupportIsEnabled"),
Ta.$("OfflineLoggerMemoryOptimizationIsEnabled")):2===J?(J=l.AFrameworkApplication.ua.Kb,ma=new Xd(l.AFrameworkApplication.lc,l.AFrameworkApplication.He,ma,za.ULS.host,l.AFrameworkApplication.userSessionId,J.yk,J.Yia,Ta.mc("OfflineLoggerRetentionInDays",30),Ta.mc("OfflineLoggerMaxAttempts",5),Ta.$("OfflineLoggerListenForAllMonitorableLogsIsEnabled"),Ta.$("SendOfflineLogsV2ImprovementIsEnabled"),l.AFrameworkApplication.MPh,Ta.$("OfflineLoggerDataBoundarySupportIsEnabled"),Ta.$("OfflineLoggerMemoryOptimizationIsEnabled"))):
ma=new wb;ma.init();return ma}}Object(e.a)($e,"OfflineLoggerFactory",null,[]);class se{wc(){}get name(){return"Common.App.OfflineLogger"}init(){const J=l.AFrameworkApplication.K;let ma=0;J.$("OneNoteOfflineLoggerIsEnabled")?ma=1:J.$("OfflineLoggerV2IsEnabled")&&(ma=2);0!==ma&&(l.AFrameworkApplication.qmg=(new $e).create(ma))}dispose(){}}Object(e.a)(se,"OfflineLoggerPackage",null,[1,2]);var wc=c(42),cd=c(1395);class Jd{constructor(J){this.NMi=null;za.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");
this.W_c=l.AFrameworkApplication.K.kb("PhoneLinkServiceEndpoint");(this.P9=J)||za.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.W_c&&this.W_c.length||za.ULS.sendTraceTag(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}aCl(J){J&&(this.W_c="https://dcg-df.microsoft.com/",za.ULS.sendTraceTag(526697302,306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.$Bl()}$Bl(){za.ULS.sendTraceTag(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");
if(864E5>=+new Date-+this.NMi)za.ULS.sendTraceTag(527574722,306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.NMi=new Date;var J=new Date;this.P9.OV("BayBridge",this.W_c).then(ma=>{const Ta=+new Date-+J;ma.IsSuccess?(za.ULS.sendTraceTag(527574723,306,50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",Ta),this.RBl(ma.Token,this.mOl())):za.ULS.sendTraceTag(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",
Ta,ma.ErrorCode,ma.ErrorMessage)}).catch(ma=>{za.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",ma,+new Date-+J)})}}RBl(J,ma){const Ta={};Ta.Authorization="Bearer "+J;Ta["Authorization-Type"]="AAD";Ta.Accept="application/json";Ta["DCG-SessionId"]=l.AFrameworkApplication.userSessionId;l.AFrameworkApplication.He.mj(ma,1,null,Ta,!1,2,Object(a.a)(this,this.tfm,"getStatusSucceeded"),Object(a.a)(this,this.rfm,"getStatusFailed"),null,void 0,
void 0,void 0,void 0,"39");wc.a("FetchAccountLinkedStatus")}sQl(){const J=cd.a.instance.getItem("AccountLinkedStatusCache");return J&&J.length?"true"===J.toLowerCase()?!0:!1:!1}mOl(){return this.W_c+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}rfm(){za.ULS.sendTraceTag(527214156,306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")}tfm(J){za.ULS.sendTraceTag(527214157,352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");J=Ja.a(J.data.se).state+"";cd.a.instance.setItem("AccountLinkedStatusCache",
J)}}Object(e.a)(Jd,"PhoneLinkManager",null,[1927]);class Qd{constructor(){this.W=null}get name(){return"Common.App.PhoneLink"}wc(J){this.W=J;this.W.register(1927,"Common.App.PhoneLink.IPhoneLinkManager").ha().Ud(()=>new Jd(this.W.resolve("Common.App.OAuth.IOAuthManager")))}init(){l.AFrameworkApplication.K.Nn(()=>{this.K3a()})}K3a(){this.W.resolve("Common.App.PhoneLink.IPhoneLinkManager")}dispose(){}static main(){M.a.instance.Gc(new Qd)}}Object(e.a)(Qd,"PhoneLinkPackage",null,[1,2]);const yd=J=>{try{return Ja.a(J)}catch(ma){}return null};
class Le{constructor(J,ma,Ta,pb,Wb,Jc){this.ZZ=!1;this.Ll=null;this.sOe=!1;this.ga=J;this.$f=ma;this.Wk=Ta;this.l5g=pb;this.Ca=Wb;this.S$j=Jc}init(J,ma){ma&&J.Ta("Common.Interface.IRtcBasicProvider").execute(Object(a.a)(this,this.O3e,"awaitRtc"))}O3e(J){const ma=J.XQc();ma.continueWith(()=>{this.Ll=ma.result;this.sOe&&(this.Ll.qN(2,null,!0),this.sOe=!1);this.Ll.T3((Ta,pb)=>{2===pb.type&&this.oc.processAction(m.a.fileNameUpdate,2)});this.Ll.Iua((Ta,pb)=>{2===pb.newState&&this.oc.processAction(m.a.fileNameUpdate,
2)});2===this.Ll.connectionState&&this.oc.processAction(m.a.fileNameUpdate,2)})}uPa(J){this.aZh(J,!0)}aZh(J,ma){const Ta=this.LOk(J.buj),pb={};pb[Le.xJh]=Le.yJh;this.aej.mj(Ta,2,"",pb,!1,2,Object(a.a)(this,this.$gc,"onRefreshFilenameSuccess"),ma?Object(a.a)(this,this.Usn,"onRefreshFilenameFailureRetry"):Object(a.a)(this,this.JXi,"onRefreshFilenameFailureNoRetry"),J)}$gc(J){this.ZZ=!1;const ma=yd(J.data.se);J.data.state.onSuccess(ma,this.l5g.value)}Usn(J){5!==J.data.status||this.ZZ?this.JXi(J):(this.ZZ=
!0,this.aZh(J.data.state,!1))}JXi(J){J.data.state.onFailure(-1)}HEb(J){this.bZh(J,!0)}bZh(J,ma){const Ta=this.MOk(),pb={};pb[Le.xJh]=Le.yJh;pb[Le.zrm]=Va.a.Gj(J.hej);pb[Le.xrm]=this.S$j.value.e0k;this.aej.mj(Ta,2,"",pb,!1,2,Object(a.a)(this,this.D2c,"onRenameFileSuccess"),ma?Object(a.a)(this,this.$sn,"onRenameFileFailureRetry"):Object(a.a)(this,this.LXi,"onRenameFileFailureNoRetry"),J)}MOk(){return this.zzh()}LOk(J){let ma=this.zzh();return ma=zc.a.fp(ma,Le.Drm,J?"2":"1")}zzh(){let J=(this.Ca.value.appSettings.RenameWebServiceBase||
"")+Le.yrm;J=zc.a.fp(J,Le.Arm,Va.a.Gj(l.AFrameworkApplication.em));this.Tm&&this.Tm.aFf&&(J=zc.a.fp(J,Le.Crm,"1"));return J}D2c(J){this.ZZ=!1;const ma=yd(J.data.se);J.data.state.onSuccess(ma,this.l5g.value);this.uSi()}uSi(){this.Ll?this.Ll.qN(2,null,!0):this.sOe=!0}$sn(J){5!==J.data.status||this.ZZ?this.LXi(J):(this.ZZ=!0,this.bZh(J.data.state,!1))}LXi(J){J.data.state.onFailure(-1)}get oc(){return this.ga.value}get aej(){return this.$f.value}get Tm(){return this.Wk.value}static get instance(){return Le._instance||
(Le._instance=Le.DFb())}static DFb(){return new Le(new ac.a(()=>l.AFrameworkApplication.va),new ac.a(()=>l.AFrameworkApplication.He),new ac.a(()=>l.AFrameworkApplication.Tm),new ac.a(()=>pa.a.instance.resolve("Postmessage.IHostPostmessenger")),new ac.a(()=>l.AFrameworkApplication.K),new ac.a(()=>pa.a.instance.resolve("Common.IRenameProps")))}}Le.xJh="Content-Type";Le.yJh="application/json; charset=utf-8";Le.yrm="renamehandler.ashx";Le.Arm="qs";Le.zrm="n";Le.Crm="sl";Le.xrm="X-CoauthLockId";Le.Drm=
"u";Le._instance=null;Object(e.a)(Le,"ExecuteRenameFileHandler",null,[]);class gf{constructor(){this.onFailure=this.onSuccess=null;this.buj=!1}}Object(e.a)(gf,"ExecuteRefreshFilenameData",null,[]);class xh{constructor(){this.onFailure=this.onSuccess=this.hej=null}}Object(e.a)(xh,"ExecuteRenameFileData",null,[]);class Qg{constructor(){this.W=null;this.YAe=Le.instance}get name(){return"Common.App.RenameFile.RenameExecutor"}wc(J){this.W=J}init(){l.AFrameworkApplication.K.Nn(Object(a.a)(this,this.Xx,
"onFullAppSettingsReady"))}Xx(){l.AFrameworkApplication.$Xc()&&(Le.instance.init(this.W,l.AFrameworkApplication.b7c),l.AFrameworkApplication.HEb=Object(a.a)(this,this.HEb,"executeRenameFile"),l.AFrameworkApplication.uPa=Object(a.a)(this,this.uPa,"executeRefreshFilename"),l.AFrameworkApplication.$8c=Object(a.a)(this,this.$8c,"sendFileNameAndLocationUpdateNotification"))}HEb(J,ma,Ta){const pb=new xh;pb.hej=J;pb.onSuccess=ma;pb.onFailure=Ta;this.YAe.HEb(pb)}uPa(J,ma,Ta){const pb=new gf;pb.onSuccess=
J;pb.onFailure=ma;pb.buj=Ta;this.YAe.uPa(pb)}$8c(){this.YAe.uSi()}dispose(){}}Object(e.a)(Qg,"PackageManager",null,[1,2]);var Ng=c(181);class zg{constructor(J,ma,Ta){this.yhg=this.zhg=this.Ahg=!1;this.Phg=!J&&!ma;this.Qhg=!J&&!Ta;this.Phg||this.Qhg||(this.Ahg=!J,this.zhg=!ma,this.yhg=!Ta)}}Object(e.a)(zg,"RenameDisabledDialogInfo",null,[]);class Jf extends Ng.StandardDialog{constructor(J,ma,Ta,pb,Wb){super();this.Ylg=[];this.yfa=new zg(J,ma,Ta);this.zeb=pb;this.ccb=Wb;this.yg="RenameDisabledDialog";
this.Cd=0;this.ze(1,CommonUIStrings.l_DialogClose);this.Goo();this.m3n()}Goo(){this.yfa.Phg?this.fad(this.zeb?this.ccb?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.yfa.Qhg?this.fad(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.ztk();this.IFc(this.Ylg)}fad(J){Array.add(this.Ylg,J)}ztk(){const J=[];this.yfa.Ahg||Array.add(J,CommonUIStrings.l_RenameFileRenameDisabledSignIn);
this.yfa.zhg||Array.add(J,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.yfa.yhg||Array.add(J,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<J.length&&Array.add(this.Ylg,J)}}Object(e.a)(Jf,"ReactRenameDisabledDialogBase",Ng.StandardDialog,[]);class fc extends Jf{constructor(J,ma,Ta,pb,Wb){super(J,ma,Ta,pb,Wb)}m3n(){this.Rmb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(e.a)(fc,"ReactRenameDisabledDialog",Jf,[]);class Fc{static get Vg(){return k.a.Kx(Fc.Xm,
CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}Fc.Xm="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(e.a)(Fc,"RenameDisabledDialogHtml",null,[]);class id extends k.a{constructor(J,ma,Ta,pb,Wb){super();this.yfa=new zg(J,ma,Ta);this.zeb=pb;this.ccb=Wb;this.yg="RenameDisabledDialog";this.Cd=0;this.ze(1,CommonUIStrings.l_DialogClose);this.Vg=Fc.Vg;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.L5("RenameRow")}V9(){if(this.yfa.Phg){let J;J=this.zeb?this.ccb?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;id.fad(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),J)}else this.yfa.Qhg?id.fad(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.Tum()}Tum(){this.yfa.Ahg&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.yfa.zhg&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.yfa.yhg&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static fad(J,ma,Ta){J.style.display="none";ma.innerText=Ta}}Object(e.a)(id,"RenameDisabledDialog",k.a,[]);class ld{constructor(J,ma){this.dxb=0;this.ga=J;this.hLa=ma}initialize(J){if(!this.ga||!this.hLa)return!1;this.dxb=J;this.Tb();return!0}Tb(){this.ga.ra(m.a.F9e,y.a.frame,Object(a.a)(this,this.F9e,"commitNewDocumentTitle"))}F9e(J,ma,Ta,pb,Wb){if(1===Ta)return this.ga.processAction(m.a.renameFile,
1);J=Va.a.yJ(this.hLa.xz);Wb=(0,Wb.getNewDocumentTitle)();Wb.length>this.dxb&&(Wb=Wb.substr(0,this.dxb));if(32!==this.ga.Qb(m.a.renameFile,2,Wb))return this.Toc(J),8;this.Toc(Wb);return 32}Toc(J){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(J))}static fm(){return new ld(l.AFrameworkApplication.va,l.AFrameworkApplication.Js)}}Object(e.a)(ld,"ReactRenameUIHandler",null,[2E3]);var hd=c(219),Be=c(1083),Ke=c(535),Me=c(102),jf=c(165),kg=c(28);class sf{constructor(J,ma,Ta,pb,Wb,Jc,Zc,jd,
dd,Ld,$d,le){this._initialized=!1;this._element=null;this.dxb=0;this.jSe=this.vEe=!1;this.ga=J;this.ala=ma;this.ge=Ta;this.Bs=pb;this.hLa=Wb;this.Veh=Jc;this.Cwd=Zc;this.kwe=jd;this.xbb=dd;this.q2g=Ld;this.wi=$d;this.bGe=le}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(J,ma,Ta){if(!(this.ga&&this.hLa&&this.Veh&&this.Cwd&&this.kwe&&ma)||0>=J)return!1;this._element=ma;this._element.title=Ta;this._element.setAttribute(kg.a.uh,kg.a.X3);this._element.setAttribute("Unselectable",
"on");this.dxb=J;this.fC();return this._initialized=!0}fC(){this.ala&&(this.ala.ob(V.a.blur,this._element,Object(a.a)(this,this.onBlur,"onBlur")),this.ala.ob(V.a.paste,this._element,Object(a.a)(this,this.u2c,"onPaste")));this.ge.ob(V.a.gi,this._element,Object(a.a)(this,this.onKeyDown,"onKeyDown"));this.Bs.ob(V.a.pointerDown,this._element,Object(a.a)(this,this.gD,"onPointerDown"));this.Bs.ob(V.a.jN,this._element,Object(a.a)(this,this.Cya,"onPointerUp"))}onBlur(){this.isActive&&!this.vEe&&(this.q2g||
this.kwe(this._element),this.AHh(),this.Mdf(!1));return this.vEe=!1}u2c(){za.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(J){return this.isActive?this.kqn(J):this.lqn(J)}kqn(J){let ma=!1;switch(J.Hb.keyCode){case Sys.UI.Key.enter:this.AHh();this.Mdf(this.wi||this.bGe);ma=!0;break;case Sys.UI.Key.tab:this.q2g&&this.kwe(this._element);break;case Sys.UI.Key.esc:this.E$f(),this.Mdf(this.wi||this.bGe),ma=!0}return ma}lqn(J){let ma=!1;switch(J.Hb.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.gCj(this.bGe),
this.isActive&&this.Cwd(this._element),ma=!0}return ma}gD(){this.isActive||(this.gCj(!1),this.isActive&&(this._element.focus(),this.Cwd(this._element),this.jSe=!0));return!1}Cya(){return this.jSe?(this.Cwd(this._element),this.jSe=!1,!0):!1}Idc(){return 32===this.ga.processAction(m.a.renameFile,1)}AHh(){const J=Va.a.yJ(this.hLa.xz);let ma=this._element.innerText.trim();ma.length>this.dxb&&(ma=ma.substr(0,this.dxb));ma!==J&&""!==ma?32!==this.ga.Qb(m.a.renameFile,2,ma)?this.E$f():this.Toc(ma):this.E$f()}E$f(){this.Toc(Va.a.yJ(this.hLa.xz))}Toc(J){this._initialized&&
(this._element.innerText=J,this.Veh())}gCj(J){this.Idc()?this.isActive||(J&&(this.vEe=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(kg.a.uh,kg.a.$vh),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,hd.CuiHelper.OVh),this.xbb&&this.xbb.execute(ma=>{ma.a7i(!0)}),J&&this._element.focus(),za.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.ga.processAction(m.a.dmc,
2)}Mdf(J){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(kg.a.uh,kg.a.X3);Sys.UI.DomElement.removeCssClass(this._element,hd.CuiHelper.OVh);this.xbb&&this.xbb.execute(ma=>{ma.a7i(!1)});J&&(this._element.blur(),this._element.focus())}static yza(){Be.a.yza(l.AFrameworkApplication.isRtl)}static fm(){return new sf(l.AFrameworkApplication.va,Ke.a.instance,Me.KeyInputManager.instance,jf.a.instance,l.AFrameworkApplication.Js,sf.yza,
qa.a.Aco,qa.a.qFh,pa.a.instance.Ta("Common.App.Header.HeaderEventSource"),Ka.a.V4,Ka.a.vi,Ka.a.Cj)}}Object(e.a)(sf,"RenameUIHandler",null,[2E3]);class Wg{static get instance(){return l.AFrameworkApplication.ua.Kb.MJ?Wg._instance||(Wg._instance=ld.fm()):Wg._instance||(Wg._instance=sf.fm())}}Wg._instance=null;Object(e.a)(Wg,"RenameUIHandlerFactory",null,[]);var Db=c(153);class Gb{constructor(){this.mTf=this.Ogn=this.bhl=null}}Object(e.a)(Gb,"RenameMruEntryProperties",null,[]);var $c=c(167),Bd=c(87),
we=c(1578),He;(function(J){J[J.unknown=-1]="unknown";J[J.success=0]="success";J[J.renameInvalidFileName=1]="renameInvalidFileName";J[J.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";J[J.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";J[J.permissionDenied=4]="permissionDenied";J[J.serverCommunicationFailure=5]="serverCommunicationFailure";J[J.fileNameTooLong=6]="fileNameTooLong"})(He||(He={}));Object(e.b)("CommonOperationResult",He);class Se{constructor(J,ma,Ta,pb,Wb,Jc,
Zc,jd,dd,Ld,$d,le){this.J2g=J;this.ga=ma;this.Wk=Ta;this.bM=pb;this.Nwb=Wb;this.rok=Jc;this.zeb=Zc;this.Ukh=jd;this.ahk=dd;this.ccb=Ld;this.Ca=$d;this.$gk=le}Tb(){l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Kb.MJ||this.oc.ra(m.a.Fbc,y.a.frame,Object(a.a)(this,this.Fbc,"initializeRenameUIHandler"));this.oc.ra(m.a.dmc,y.a.frame,Object(a.a)(this,this.dmc,"showRenameDisabledDialog"));this.oc.ra(m.a.renameFile,y.a.frame,Object(a.a)(this,this.renameFile,"renameFile"));this.oc.fb(m.a.fileNameUpdate,
y.a.frame,Object(a.a)(this,this.mUn,"refreshFilename"),64);this.oc.fb(m.a.t5d,y.a.frame,Object(a.a)(this,this.t5d,"moveToFolderCompleteByHost"),64);this.oc.ra(m.a.OLb,y.a.frame,Object(a.a)(this,this.OLb,"moveToFolder"));(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||l.AFrameworkApplication.ua&&(l.AFrameworkApplication.K.$("PostMessageEmbedded")||l.AFrameworkApplication.K.$("IsJsApi"))&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0))&&l.AFrameworkApplication.mP().execute(J=>{J.Fv(Bd.a.oQi);J.eC(Bd.a.oQi,Se.GQn);J.Fv(Bd.a.Ckf);J.eC(Bd.a.Ckf,Se.EQn)})}Idc(){return 0===this.$gk.ggi()?32:8}n1o(){return this.Tm?this.zeb?this.Tm.PUh:this.Tm.i2a:!0}Fbc(){return Wg.instance.initialize(l.AFrameworkApplication.qOd,l.AFrameworkApplication.GUh,l.AFrameworkApplication.mcj||CommonUIStrings.l_RenameFileTooltip)?32:8}dmc(){const J=this.n1o(),ma=this.rok();za.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.Nwb,ma,J,this.zeb);l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Kb.vF&&l.AFrameworkApplication.K.$("ReactRenameDisabledDialogIsEnabled")?new fc(this.Nwb,!ma,!J,this.zeb,this.ccb()):new id(this.Nwb,!ma,!J,this.zeb,this.ccb());return 32}renameFile(J,ma,Ta,pb,Wb){if(1===Ta)return this.Idc();if(!l.AFrameworkApplication.HEb)return 8;if(8===this.Idc())return this.oc.processAction(m.a.dmc,2),8;za.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");l.AFrameworkApplication.HEb(Wb,Object(a.a)(this,
this.D2c,"onRenameFileSuccess"),Object(a.a)(this,this.Zsn,"onRenameFileFailure"));l.AFrameworkApplication.lcj=!0;return 32}D2c(J,ma){J?0!==J.OperationResult?this.pmi(J.OperationResult):(this.peo(ma,J.NewName),this.dUo(J,Object(a.a)(l.AFrameworkApplication.ua.Kb,l.AFrameworkApplication.ua.Kb.YGj,"updateOpenInClientDocumentUrl")),l.AFrameworkApplication.K.$("DocumentNameInJewelInfoMenuIsEnabled")&&l.AFrameworkApplication.ua.updateCommandUI(),this.ahk.KEj()):this.pmi(5)}peo(J,ma){const Ta={};Ta[$c.a.DCl]=
ma;J.sendMessage(Bd.a.Ckf,Ta)}dUo(J,ma){this.rUo(J);l.AFrameworkApplication.qLd=J.DirectInvokeDavUrl;ma=ma(J.EditDocInClientUrl);const Ta=new Gb;Ta.mTf=this.bM.xz;Ta.bhl=ma;Ta.Ogn=J.EditDocInClientUrl;this.oc.Qb(m.a.ncj,2,Ta)}pmi(J){switch(J){case 1:J=new Ng.StandardDialog,J.Cd=0,J.FV(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.Yej()}}rUo(J){this.bM.xz=Se.PDk(this.bM.xz,J.NewName);J.BreadcrumbFolderName&&(this.bM.breadcrumbFolderName=J.BreadcrumbFolderName);
J.BreadcrumbFolderUrl&&(this.bM.breadcrumbFolderUrl=J.BreadcrumbFolderUrl);this.Ukh(J.NewName)}Zsn(J){const ma=new Ng.StandardDialog;ma.Cd=0;switch(J){case 1:za.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");ma.jka(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:za.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");ma.jka(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,
null);break;default:za.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:J}),ma.jka(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}l.AFrameworkApplication.mP().execute(Ta=>{Ta.sendMessage(Bd.a.CCl,{["FailureMessage"]:He[J]})});this.Yej()}mUn(J,ma,Ta){if(1===Ta)return this.Idc();if(!l.AFrameworkApplication.uPa)return 8;l.AFrameworkApplication.uPa(Object(a.a)(this,this.$gc,"onRefreshFilenameSuccess"),Object(a.a)(this,this.q8d,"onRefreshFilenameFailure"),
!1);return 32}OLb(J,ma,Ta,pb,Wb){if(1===Ta)return l.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?32:8;if(2===Ta){const Jc={};J=l.AFrameworkApplication.Tlb;ma=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");J=(!J||J&&ma)&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);Jc[$c.a.GFo]=J;Wb&&Wb.MoveButtonClickedTime&&(Jc[$c.a.Xen]=Wb.MoveButtonClickedTime.getTime());l.AFrameworkApplication.mP().execute(Zc=>{Zc.sendMessage(Bd.a.OLb,
Jc)});if(Wb&&Wb.MoveButtonClickedTime){if(J=Db.a.vG())Wb=(new Date).getTime()-Wb.MoveButtonClickedTime.getTime(),J.set("MovePostDuration",Wb.toString());Oa.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",J)}return 32}return 8}t5d(J,ma,Ta,pb,Wb){if(1===Ta)return l.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?this.Idc():8;if(2===Ta){if(!l.AFrameworkApplication.$8c)return Oa.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),
8;if(!Wb)return Oa.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(Wb[$c.a.FKm])if(Wb[$c.a.EIj])if(J=Wb[$c.a.EIj].toLowerCase(),ma=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"),Ta=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),ma&&l.AFrameworkApplication.Tlb&&Ta){const Jc={};Jc[$c.a.ejc]="1";Jc[$c.a.documentUrl]=J;Jc[$c.a.reason]=we.a.Vag;Oa.Health.instance.recordKpiSuccess("MoveToFolder",null);
l.AFrameworkApplication.mP().execute(Zc=>{Zc.sendMessage(Bd.a.eEb,Jc)})}else if(!l.AFrameworkApplication.Tlb&&Ta)Oa.Health.instance.recordKpiSuccess("MoveToFolder",null),qa.a.wm(J,qa.a.esa(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return Oa.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else Oa.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else l.AFrameworkApplication.uPa(Object(a.a)(this,this.$gc,"onRefreshFilenameSuccess"),
Object(a.a)(this,this.q8d,"onRefreshFilenameFailure"),!1),l.AFrameworkApplication.$8c(),Oa.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}evo(J,ma){return J&&ma?J!==this.bM.breadcrumbFolderName||ma!==this.bM.breadcrumbFolderUrl:!1}$gc(J,ma){J&&(J.NewName!==Va.a.yJ(this.bM.xz)||this.evo(J.BreadcrumbFolderName,J.BreadcrumbFolderUrl))&&this.D2c(J,ma)}q8d(){}Yej(){this.Ukh(Va.a.yJ(this.bM.xz))}get oc(){return this.ga.value}get Tm(){return this.Wk.value}static get instance(){return Se._instance||
(Se._instance=Se.DFb())}static DFb(){return new Se(l.AFrameworkApplication.$Xc,new ac.a(()=>l.AFrameworkApplication.va),new ac.a(()=>l.AFrameworkApplication.Tm),l.AFrameworkApplication.Js,l.AFrameworkApplication.bqa,()=>l.AFrameworkApplication.brg,l.AFrameworkApplication.b7c,Object(a.a)(Wg.instance,Wg.instance.Toc,"updateTitle"),pa.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>l.AFrameworkApplication.ov,l.AFrameworkApplication.K,pa.a.instance.resolve("Common.IRenameProps"))}static PDk(J,
ma){J=Va.a.Mha(J);return ma+J}static GQn(J){const ma=J.Values[$c.a.DQm];za.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",ma);ma?l.AFrameworkApplication.va.Qb(m.a.t5d,2,J.Values):Oa.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static EQn(J){l.AFrameworkApplication.va.Qb(m.a.renameFile,2,J.Values.NewName)}}Se._instance=null;Object(e.a)(Se,"RenameActor",null,[]);var jg=c(192),Hi=c(1401),ii=c(576),Zh=c(399);class vg{constructor(J,
ma){this.ga=J;this.$tc=ma}Tb(){this.ga.ra(m.a.Khg,y.a.frame,Object(a.a)(this,this.Zxo,"showRenameDialogAction"))}Zxo(J,ma,Ta){J=32;if(1===Ta)return Zh.SessionStatusManager.instance.Zj||l.AFrameworkApplication.Dpa?8:32;2===Ta&&(32!==this.ga.processAction(m.a.renameFile,1)?(this.ga.processAction(m.a.dmc,2),jg.a.instance.Yb(Hi.a.moa,{["Reason"]:ii.a.B2n}),J=8):32===this.ga.processAction(m.a.emc,1)?this.ga.processAction(m.a.emc,2):this.$tc.value.create().GUa());return J}}Object(e.a)(vg,"RenameDialogActor",
null,[1991]);class vf{constructor(J,ma,Ta){this.dialog=null;this.ga=J;this.bM=ma;this.fbb=Ta}Dbm(){const J={};J.nameInputProps={["type"]:"AppInputProps",["id"]:vf.i7b,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:Va.a.yJ(this.bM.xz),["maxLength"]:this.fbb};return J}GUa(){const J={["id"]:"RenameDialog",["bodyControls"]:this.Dbm()};this.dialog=new k.a(!1,!1,!0);this.dialog.Cd=1;this.dialog.yg="RenameDialog";this.dialog.Uh(CommonUIStrings.l_RenameDialogTitle,Object(a.a)(this,this.X8f,"renameDialogHandler"),
J)}X8f(J,ma){if(ma&&1===J){if(ma[vf.i7b]&&(J=Va.a.yJ(this.bM.xz),ma=(ma[vf.i7b]||"").trim(),ma!==J&&""!==ma)){this.ga.Qb(m.a.renameFile,2,ma);return}jg.a.instance.Yb(Hi.a.f7b,{["Reason"]:ii.a.E_h})}}}vf.i7b="txtDocumentName";Object(e.a)(vf,"ReactRenameDialog",null,[2001]);class Lf{static get Vg(){return k.a.Kx(Lf.Xm,CommonUIStrings.l_RenameDialogLabel)}}Lf.Xm="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(e.a)(Lf,"RenameDialogHtml",null,[]);class Cg extends k.a{constructor(J,ma,Ta){super();this.ga=J;this.bM=ma;this.fbb=Ta;this.yg="RenameDialog";this.Vg=Lf.Vg}GUa(){var J={["txtDocumentName"]:Va.a.yJ(this.bM.xz)};this.Uh(CommonUIStrings.l_RenameDialogTitle,Object(a.a)(this,this.X8f,"renameDialogHandler"),J);J=document.getElementById(Cg.i7b);0<this.fbb&&(J.maxLength=this.fbb);J.focus()}X8f(J,ma){if(1===J&&(J=Va.a.yJ(this.bM.xz),ma=(ma[Cg.i7b]||"").trim(),ma!==J&&""!==ma)){this.ga.Qb(m.a.renameFile,
2,ma);return}jg.a.instance.Yb(Hi.a.f7b,{["Reason"]:ii.a.E_h})}}Cg.i7b="txtDocumentName";Object(e.a)(Cg,"RenameDialog",k.a,[2001]);class bg{constructor(J){this.hLa=null;this.fbb=0;this.ga=J;this._initialized=!1}initialize(J,ma){this.hLa=J;this.fbb=ma;this._initialized=!0}create(){return this._initialized?l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Kb.vF&&l.AFrameworkApplication.K.$("ReactRenameDialogIsEnabled")?new vf(this.ga,this.hLa,this.fbb):new Cg(this.ga,this.hLa,this.fbb):null}}Object(e.a)(bg,
"RenameDialogFactory",null,[1990]);var eg=c(176),sh=c(109);class nh{constructor(J,ma){this.ga=J;this.Vb=ma}Tb(){this.ga.ra(m.a.emc,y.a.frame,Object(a.a)(this,this.$xo,"showRenameFlyoutAction"))}fTk(){return F.d("setDocumentTitleFlyoutOpened")&&l.AFrameworkApplication.ua.Kb.MJ}$xo(J,ma,Ta){if(1===Ta)return this.fTk()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}nvk(){nh.VUm&&l.AFrameworkApplication.cI&&sh.a.instance.Wb(new Kb.a(5,1,5E3,()=>{32===this.ga.processAction(m.a.emc,
1)&&this.Vb&&this.Vb.currentScope.name===eg.AFrame.In&&(wc.a("RenameFloatieShownOnNewDocumentLoad",!0),this.ga.processAction(m.a.emc,2))}))}static get VUm(){nh.Mpd&&null!=nh.Mpd||(l.AFrameworkApplication.oe("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),nh.Mpd=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return nh.Mpd}}nh.Mpd=null;Object(e.a)(nh,"RenameFlyoutActor",
null,[1988]);class Sh{constructor(J,ma,Ta,pb,Wb){this.e0k=null;this.Wk=Wb;this.K2g=Ta;this.J2g=pb;this.tok=J;this.ccb=ma}get Tm(){return this.Wk.value}ggi(){if(!this.J2g())return 5;if(this.ccb())return 1;if(this.Tm){if(this.K2g&&!this.Tm.PUh)return 3;if(!this.K2g&&!this.Tm.i2a)return 4}return this.tok()?0:2}}Object(e.a)(Sh,"RenameProps",null,[1987]);class Xk{constructor(J,ma,Ta,pb,Wb,Jc){this.zs=!1;this.aJe=new Yb.a;this.xWb=ma;this.cA=Ta;this.vVb=pb;this.Ca=Wb;this.zma=Jc}enable(){this.zs||(this.KEj(),
this.rjg(),this.zs=!0)}generateKey(J,ma,Ta){return String.format("{0}/{1}/{2}",Ta,J,ma)}b2l(){const J=Va.a.yJ(this.xWb().xz);return this.generateKey(this.xWb().breadcrumbFolderName,this.xWb().breadcrumbFolderUrl,J)}c2l(J,ma,Ta){return J&&ma?this.generateKey(J,ma,Ta):Ta}lol(J,ma,Ta){return J&&J!==this.xWb().breadcrumbFolderName||ma&&ma!==this.xWb().breadcrumbFolderUrl?!0:Ta!==Va.a.yJ(this.xWb().xz)}KEj(){const J=this.b2l();this.aJe.Z(J,new Date)}P0f(J){this.rto(J)&&this.snh(J)}rto(J){const ma=this.vVb();
return ma?this.zma&&this.zma.Jo||!ma.aFf||!l.AFrameworkApplication.uPa?(this.swj(J),this.zs=!1):!0:!1}JYi(J,ma,Ta,pb){const Wb=this.lol(J,ma,Ta);J=this.c2l(J,ma,Ta);ma=this.aJe.Fc(J).returnValue;Wb&&!ma&&(this.rmi(pb),za.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.xNf));Wb||this.aJe.Z(J,this.cA())}}Object(e.a)(Xk,"ARenamedFileChecker",null,[1968]);class rl extends Xk{constructor(J,ma,Ta,pb,Wb,Jc,Zc,jd){super(J,ma,Ta,pb,Wb,Jc);this.KK=Wb;this.Zgk=Zc;this.YDe=jd}get xNf(){return"RenamedFileCheckerUsingSettingsRefresh"}rjg(){this.KK.eGc(Object(a.a)(this,
this.Nmi,"handleSettingsRefresh"))}Nmi(J,ma){ma&&ma.YLb&&ma.uTi&&(ma.JRa("BreadcrumbDocName")||ma.JRa("BreadcrumbFolderName")||ma.JRa("BreadcrumbFolderUrl")||ma.JRa("DirectInvokeDAVUrl")||ma.JRa("EditDocInClientUrl"))&&(za.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.xNf),this.P0f(ma))}swj(){this.KK.O8f(Object(a.a)(this,this.Nmi,"handleSettingsRefresh"))}snh(J){if(J&&J.YLb){const ma=J.YLb;this.JYi(ma.kb("BreadcrumbFolderName"),ma.kb("BreadcrumbFolderUrl"),ma.kb("BreadcrumbDocName"),
J)}}rmi(J){const ma={OperationResult:0,classId:1};J=J.YLb;ma.BreadcrumbFolderName=J.kb("BreadcrumbFolderName");ma.BreadcrumbFolderUrl=J.kb("BreadcrumbFolderUrl");ma.DirectInvokeDavUrl=J.kb("DirectInvokeDAVUrl");ma.EditDocInClientUrl=J.kb("EditDocInClientUrl");J=J.kb("BreadcrumbDocName");ma.NewName=l.AFrameworkApplication.NLd?J:Va.a.yJ(J);this.YDe.execute(Ta=>{this.fHm(ma,Ta)})}fHm(J,ma){this.Zgk().D2c(J,ma)}}Object(e.a)(rl,"RenamedFileCheckerUsingSettingsRefresh",Xk,[]);class sl extends Xk{constructor(J,
ma,Ta,pb,Wb,Jc,Zc,jd,dd,Ld){super(J,Ta,pb,Wb,Jc,dd);this.YBc=this.am=null;this.mfk=ma;this.ga=Zc;this.Ib=jd;Ld&&Ld.execute($d=>{this.FYn($d)})}get xNf(){return"RenamedFileCheckerUsingTask"}FYn(J){this.am=J;this.am.B_a(Object(a.a)(this,this.jY,"handleVisibilityChange"))}jY(J,ma){!this.zs||0!==ma.newState&&1!==ma.newState||this.YBc||(this.rjg(),this.P0f(this.YBc))}rjg(){this.YBc=new Kb.a(3,2,this.mfk(),Object(a.a)(this,this.P0f,"performRenameFileCheckTick"),89);this.Ib.Wb(this.YBc)}swj(J){this.Ib.ff(J)}snh(J){this.am&&
2===this.am.MD?this.x_n(J):l.AFrameworkApplication.uPa(Object(a.a)(this,this.$gc,"onRefreshFilenameSuccess"),Object(a.a)(this,this.q8d,"onRefreshFilenameFailure"),!0)}x_n(J){this.Ib.ff(J);this.YBc=null}$gc(J){J&&this.JYi(J.BreadcrumbFolderName,J.BreadcrumbFolderUrl,J.NewName,null)}rmi(){this.ga.processAction(m.a.fileNameUpdate,2)}q8d(){}}Object(e.a)(sl,"RenamedFileCheckerUsingTask",Xk,[]);var Xf=c(67);class Dl{constructor(){this.Ca=this.W=null}get name(){return"Common.App.RenameFile"}wc(J){this.W=
J;this.Ca=l.AFrameworkApplication.K;this.W.register(vg,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Ud(()=>new vg(l.AFrameworkApplication.va,this.W.Ve("Common.App.Rename.IRenameDialogFactory"))).ha();this.W.register(bg,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Ud(()=>new bg(l.AFrameworkApplication.va)).ha();this.W.register(1968,"Common.App.Rename.IRenamedFileChecker").Ud(()=>this.Xdl()).ha();this.W.register(nh,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Ud(()=>
new nh(l.AFrameworkApplication.va,Xf.FocusManager.instance())).ha()}Xdl(){if(this.Ca.$("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const J=this.W.Oa("Common.IRefreshableAppSettings");if(J&&J.eCi)return new rl(()=>J.mc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>l.AFrameworkApplication.Js,()=>new Date,()=>l.AFrameworkApplication.Tm,J,this.W.Oa("Common.ISessionStatus"),()=>Se.instance,this.W.Ta("Postmessage.IHostPostmessenger"))}return new sl(()=>this.Ca.mc("RenamedFileCheckerMaxCachedAgeInMs",
48E4),()=>this.Ca.mc("RenamedFileCheckerPingIntervalInMs",12E4),()=>l.AFrameworkApplication.Js,()=>new Date,()=>l.AFrameworkApplication.Tm,l.AFrameworkApplication.K,l.AFrameworkApplication.va,l.AFrameworkApplication.lc,this.W.Oa("Common.ISessionStatus"),this.W.Ta("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.Ca.Nn(Object(a.a)(this,this.Xx,"onFullAppSettingsReady"))}Xx(){const J=l.AFrameworkApplication.ua.Kb.MJ;l.AFrameworkApplication.$Xc()&&Wg.instance.initialize(l.AFrameworkApplication.qOd,
J?null:l.AFrameworkApplication.GUh,J?null:l.AFrameworkApplication.mcj||CommonUIStrings.l_RenameFileTooltip)&&(this.W.register(Sh,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Ud(()=>new Sh(()=>l.AFrameworkApplication.brg,()=>l.AFrameworkApplication.ov,l.AFrameworkApplication.b7c,l.AFrameworkApplication.$Xc,new ac.a(()=>l.AFrameworkApplication.Tm))).ha(),Se.instance.Tb(),this.Ca.$("RenameDialogIsEnabled")&&(this.W.resolve("Common.App.Rename.RenameDialogFactory").initialize(l.AFrameworkApplication.Js,
l.AFrameworkApplication.qOd),this.W.resolve("Common.App.Rename.IRenameDialogActor").Tb()),this.W.resolve("Common.App.Rename.IRenameFlyoutActor").Tb(),l.AFrameworkApplication.b7c&&this.W.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.W.resolve("Common.App.Rename.IRenameFlyoutActor").nvk())}dispose(){}}Object(e.a)(Dl,"PackageManager",null,[1,2]);class rg{static get Vg(){return k.a.Kx(rg.Xm,CommonUIStrings.l_SaveACopyFileName)}}rg.Xm="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(e.a)(rg,"FileNameDialogHtml",null,[]);class Hm extends k.a{constructor(J,ma,Ta,pb){super();this.$ld=this.DLa=null;this.ga=J;this.rsa=ma;this.K1b=Ta;this.ze(1,CommonUIStrings.l_SaveButtonLabel);this.Vg=rg.Vg;this.yg="FileNameDialog-SaveACopy";this.Pm=pb}HEa(J,ma,Ta){this.$ld=J;this.DLa=Ta;J={["txtFileName"]:Va.a.yJ(l.AFrameworkApplication.Js.xz),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,ma)};this.Uh(CommonUIStrings.l_SaveToOneDrive,Object(a.a)(this,this.pOd,"fileNameDialogHandler"),
J);za.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}pOd(J,ma){1!==J?za.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(J=ma.txtFileName.trim(),za.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),ma=Va.a.Mha(l.AFrameworkApplication.fileName),J&&""!==J&&""!==ma&&(J+=ma),this.K1b.Rza(this.$ld,this.DLa,J,this.Pm))}}Object(e.a)(Hm,"FileNameDialog",
k.a,[2027]);class pf{constructor(J,ma,Ta){this.ga=J;this.rsa=ma;this.K1b=Ta}create(J){return new Hm(this.ga,this.rsa,this.K1b,J)}}Object(e.a)(pf,"FileNameDialogFactory",null,[2006]);class vh extends Ng.StandardDialog{constructor(J){super();this.Cd=1;this.ze(1,CommonUIStrings.l_RetryButtonLabel);this.ze(0,CommonUIStrings.l_DialogClose);this.ga=J}PO(J){za.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",J);this.vx(J,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
Object(a.a)(this,this.T$f,"retryDialogHandler"))}T$f(J){1===J?(za.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.ga.processAction(m.a.nkc,2)):za.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(e.a)(vh,"RetryDialog",Ng.StandardDialog,[2005]);var ri=c(1224);class tl{constructor(J,ma,Ta,pb){this.Lvd=null;this.rik=J;this.Ca=Ta;this.u$g=ma;this.G5g=new z.a;this.je=pb}gec(){return this.Ca.$("SaveToCloudStorageUIIsEnabled")}Eib(){return m.a.dbg}XEd(){Hc.a.gde(Object(a.a)(this,
this.vhj,"saveToCloudActionDispatcher"));Hc.a.nNc([new ri.a(m.a.dbg,y.a.frame,0)],this.u$g.r$b())}Tb(){const J=this.u$g.r$b();J?(J.D_(()=>{this.G5g.Dg(!0)}),this.XEd()):za.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}w8i(){za.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}vhj(J,ma,Ta,pb,Wb){return ma.contextId!==y.a.frame||J!==this.Eib()?2:this.gec()?1===Ta?Zh.SessionStatusManager.instance.Zj||l.AFrameworkApplication.Dpa?
8:32:2===Ta?(this.w8i(),Wb&&Wb.FileDownloadUrl&&za.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.je&&(this.Lvd=this.je.Zf("DialogShown","SaveToOneDriveReponseTime")),this.G5g.task.continueWith(()=>{this.Lvd&&(this.Lvd.stop(),this.Lvd=null);this.rik.start(Wb)}),32):8:8}}Object(e.a)(tl,"SaveToCloudStorageActor",null,[2010]);class ci extends tl{constructor(J,ma,Ta,pb){super(J,ma,Ta,pb);this.Pdk=ma}gec(){return this.Ca.$("SaveACopyBrsIsEnabled")}Eib(){return m.a.nkc}XEd(){Hc.a.gde(Object(a.a)(this,
this.vhj,"saveToCloudActionDispatcher"));Hc.a.nNc([new ri.a(m.a.nkc,y.a.frame,0)],this.Pdk.r$b())}w8i(){l.AFrameworkApplication.oe("CreateCopy_cf;CreateCopy_tf");za.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(e.a)(ci,"SaveACopyActor",tl,[]);class Li{}Li.default=0;Object(e.a)(Li,"SaveToCloudErrorCodes",null,[]);class kj{constructor(J,ma,Ta,pb,Wb,Jc){this.Pm=null;this.jkk=J;this.aua=ma;this.K1b=Ta;this.Ca=pb;this.HUb=Wb;this.sH=Jc}start(J){this.Pm=J;
if("SharePointOnlineConsumer"===this.Ca.kb("FileSource")){const ma=pa.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(ma){ma.start(null,J);return}}this.aua.RVc?("Open From URL"===Object(Bb.a)(String,l.AFrameworkApplication.sessionStartInfoSettings.Host)||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SaveToOneDriveSkipFilePicker",!1))&&l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Kb&&1===l.AFrameworkApplication.ua.Kb.yk?(za.ULS.sendTraceTag(508852051,
216,15,"User is signed in. We will initiate a save for this file to user's root OneDrive location"),this.K1b.Rza("root","https://onedrive.live.com",null,this.Pm)):(za.ULS.sendTraceTag(6590559,216,l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Kb&&1===l.AFrameworkApplication.ua.Kb.yk?15:50,"User is signed in. We will show file picker."),this.gSk()):(za.ULS.sendTraceTag(6590560,216,l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Kb&&1===l.AFrameworkApplication.ua.Kb.yk?15:50,"User is not signed in. We will show sign in dialog."),
this.kyo())}kyo(){this.jkk.create().HEa()}Ep(){this.sH().PO(Li.default)}gSk(){try{za.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let J={["client_id"]:this.Ca.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.HUb||2===this.HUb)J={["client_id"]:this.Ca.appSettings.UploadToSkyDriveClientId};WL.init(J);za.ULS.sendTraceTag(6590562,216,l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Kb&&1===l.AFrameworkApplication.ua.Kb.yk?15:50,"OneDrive API is initialized. Launching file dialogue");
WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(a.a)(this,this.onSuccess,"onSuccess"),Object(a.a)(this,this.onFailure,"onFailure"))}catch(J){za.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",J,J.stack),this.Ep()}}onSuccess(J){za.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");J&&J.data&&J.data.folders&&this.K1b.Rza(J.data.folders[0].id,J.data.folders[0].urls.viewInBrowser,null,this.Pm)}onFailure(J){if(J&&
J.error){if("user_canceled"===J.error.code){za.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}za.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",J.error.code,J.error.message)}else za.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.Ep()}}Object(e.a)(kj,"SaveToCloudManager",null,[1985]);class El extends kj{constructor(J,ma,Ta,pb,Wb,Jc,Zc){super(ma,Ta,pb,Wb,Jc,Zc);this.U2j=J}onSuccess(J){J&&
J.data&&J.data.folders?(za.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.U2j.create(this.Pm).HEa(J.data.folders[0].id,J.data.folders[0].name,J.data.folders[0].urls.viewInBrowser)):(za.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.Ep())}onFailure(J){J&&J.error&&"user_canceled"===J.error.code&&za.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.onFailure(J)}Ep(){za.ULS.sendTraceTag(7205458,
216,50,"Error occur in Save A Copy Manager.");super.Ep()}}Object(e.a)(El,"SaveACopyManager",kj,[]);var Ph=c(201);class ji{constructor(J,ma,Ta,pb,Wb){this.DLa=this.Hk=this.Vrc=null;this.ZZ=!1;this.Pm=this.g_a=null;this.AXe=J;this.XYa=ma;this.sH=Ta;this.Xi=pb;this.je=Wb}o8a(){this.Xi&&1===this.Xi.state||(this.Hk=this.XYa(),this.Hk.message=CommonUIStrings.l_CommentProgressTooltip,this.Hk.Cd=5,this.Hk.Kt=!1,this.Hk.JL(CommonUIStrings.l_DefaultDialogTitle,null,null))}Vna(){this.Hk&&(this.Hk.close(),this.Hk=
null)}T5(){1!==l.AFrameworkApplication.ua.state&&this.sH().PO(Li.default)}NOb(){za.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");qa.a.wm(this.DLa,qa.a.esa(3),void 0,"UploadToCloudManager.RedirectToFolder")}MOb(J){l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Kb&&1===l.AFrameworkApplication.ua.Kb.yk&&(J+="&wdsvodm=true");let ma=!1,Ta=!1;l.AFrameworkApplication.K&&(ma=l.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),Ta=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));
za.ULS.sendTraceTag(6654163,216,l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Kb&&1===l.AFrameworkApplication.ua.Kb.yk?15:50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",J,ma);if(ma&&Ta){za.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const pb={};pb[$c.a.ejc]="1";pb[$c.a.documentUrl]=J;l.AFrameworkApplication.mP().execute(Wb=>{Wb.sendMessage(Bd.a.eEb,pb)})}else qa.a.wm(J,qa.a.esa(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}Rza(J,
ma,Ta=null,pb=null){za.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.je&&(this.g_a=this.je.Zf("DialogShown","SaveToOneDriveUploadTime"));this.o8a();this.DLa=ma;this.Vrc=this.AXe.create(J,Ta,pb);this.Pm=pb;this.rha()}rha(){za.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.Vrc.execute(Object(a.a)(this,this.Rtn,"onSaveToCloudUploadFinished"),Object(a.a)(this,this.Qtn,"onSaveToCloudUploadFailed"))}Rtn(J){this.Vna();this.ZZ=!1;if(J&&J.data&&J.data.se){var ma;if(({Gt:ma}=
Ja.d(J.data.se)).returnValue)if(J=ma,J.StatusCode!==Ph.a.Zz&&J.StatusCode!==Ph.a.g6b)za.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.T5();else{za.ULS.sendTraceTag(6590603,216,l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Kb&&1===l.AFrameworkApplication.ua.Kb.yk?15:50,"UploadToCloudManager upload success.");try{J.NewDocumentUrl&&""!==J.NewDocumentUrl?this.MOb(J.NewDocumentUrl):this.NOb()}catch(Ta){za.ULS.sendTraceTag(37025728,216,
15,"Redirect failed with exception: {0}",Ta.toString())}this.Q3c()}else za.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Ib.a.Mcd(J.data.se)}),this.T5()}else za.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.T5()}Qtn(J){5!==J.data.status&&12!==J.data.status||this.ZZ?(za.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",J.data.status),this.Vna(),this.T5(),this.Q3c()):(za.ULS.sendTraceTag(6590604,
216,10,"UploadToCloudManager failure. Retrying."),this.ZZ=!0,this.rha())}Q3c(){this.g_a&&(this.g_a.stop(),this.g_a=null)}}Object(e.a)(ji,"UploadToCloudManager",null,[1965]);class ej extends ji{constructor(J,ma,Ta,pb,Wb,Jc){super(ma,Ta,pb,Wb,Jc);this.ga=J}NHf(){return!!this.Pm&&!!this.Pm.SaveEntryPoint&&"VersionHistory"===this.Pm.SaveEntryPoint.toString()}T5(){za.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.NHf()&&this.ga.Qb(m.a.oee,2,{["FailureReason"]:"Unknown"});super.T5()}NOb(){za.ULS.sendTraceTag(7205460,
216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.NHf()&&this.ga.processAction(m.a.w7c,2);super.NOb()}MOb(J){za.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",J);this.NHf()&&this.ga.processAction(m.a.w7c,2);super.MOb(J)}rha(){this.Pm&&"true"===this.Pm.SkipSaveToHost?super.rha():32!==this.ga.processAction(m.a.NPb,1)?(za.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.rha()):this.ga.Qb(m.a.NPb,
2,[()=>{za.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");ji.prototype.rha.call(this)},()=>{za.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.T5()}])}}Object(e.a)(ej,"SaveACopyUploadToCloudManager",ji,[]);var Hk=c(760),Yk=c(1219);class nn{constructor(){this.W=null}get name(){return"Common.App.SaveACopy"}init(){l.AFrameworkApplication.K.Nn(Object(a.a)(this,this.Xx,"onFullAppSettingsReady"))}Xx(){l.AFrameworkApplication.K.$("SaveACopyBrsIsEnabled")&&
this.W.resolve("Common.App.SaveACopy.SaveACopyActor").Tb()}dispose(){}wc(J){this.W=J;this.W.register(ej,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Ud(()=>new ej(l.AFrameworkApplication.va,J.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new Yk.a).create(),()=>new vh(l.AFrameworkApplication.va),l.AFrameworkApplication.ua,l.AFrameworkApplication.ua.Lq)).ha();this.W.register(pf,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Ud(()=>
new pf(l.AFrameworkApplication.va,l.AFrameworkApplication.ua.Kb,J.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).ha();this.W.register(ci,"Common.App.SaveACopy.SaveACopyActor").Ud(()=>new ci(J.resolve("Common.App.SaveACopy.SaveACopyManager"),J.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),l.AFrameworkApplication.K,l.AFrameworkApplication.ua.Lq)).ha();this.W.register(El,"Common.App.SaveACopy.SaveACopyManager").Ud(()=>new El(J.resolve("Common.App.SaveACopy.FileNameDialogFactory"),
J.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Hk.a.instance,J.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),l.AFrameworkApplication.K,l.AFrameworkApplication.M8,()=>new vh(l.AFrameworkApplication.va))).ha()}static main(){M.a.instance.Gc(new nn)}}Object(e.a)(nn,"PackageManager",null,[1,2]);var Yl=c(50);class Hh extends Ng.StandardDialog{constructor(J,ma){super();this.LZb=!1;this.YN=null;this.ga=J;this.evc=ma;this.XIa=!1}PO(J,ma,Ta){this.YN=ma;this.LZb=Ta;za.ULS.sendTraceTag(8194008,
216,50,"Display error with code:{0}, overwriteTarget:{1}.",J,Ta);J=this.K7e(J);0===J?(this.Cd=6,this.ze(0,CommonUIStrings.l_DialogClose)):(this.Cd=0,this.ze(1,CommonUIStrings.l_DialogClose));0===J&&za.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.vx(Yl.a.iao,this.LVl(J),this.KVl(J,ma),Object(a.a)(this,this.T$f,"retryDialogHandler"),!0)}T$f(J){1===J?(za.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.YN?this.ga.Qb(m.a.z8c,2,[this.YN,this.LZb]):
this.ga.processAction(m.a.z8c,2)):za.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")}K7e(J){return 0>J||6<J?(za.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",J),0):J}KVl(J,ma){J=this.K7e(J);return this.evc?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,ma),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][J]:
[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,ma),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][J]}LVl(J){J=this.K7e(J);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,
CommonUIStrings.l_InvalidFileNameTitle][J]}}Object(e.a)(Hh,"ErrorRetryDialog",Ng.StandardDialog,[2031]);class bn{constructor(J,ma){this.Ca=J;this.ga=ma;this.evc=this.Ca.$("SaveToHostWithExtraCharsInFileName")}create(){return new Hh(this.ga,this.evc)}}Object(e.a)(bn,"ErrorRetryDialogFactory",null,[2009]);class lj extends k.a{constructor(J,ma,Ta,pb,Wb,Jc,Zc=null){super();this.b7=null;this.ga=ma;this.rsa=pb;this.h_a=Jc;this.Ca=J;this.sH=Wb;this.Xi=Ta;this.evc=this.Ca.$("SaveToHostWithExtraCharsInFileName");
this.Pm=Zc;this.ze(1,CommonUIStrings.l_SaveButtonLabel)}get ua(){return this.Xi}nTh(J,ma){this.ora(1,!!J&&J!==ma);this.b7=document.getElementById(lj.D_h);Q.a.addHandler(this.b7,"change",Object(a.a)(this,this.r7d,"onFileNameChange"));Q.a.addHandler(this.b7,"input",Object(a.a)(this,this.r7d,"onFileNameChange"));this.b7.focus()}C_h(J){return this.evc?(new RegExp("["+this.tYh('\\/:*?"<>|')+"]")).test(J):(new RegExp("["+this.tYh('\\/:*?"<>|#{}%~&')+"]")).test(J)}tYh(J){return J.replace(RegExp("[.*+?|()\\[\\]{}\\\\]",
"g"),"\\\\$&")}jyf(){const J=Va.a.yJ(l.AFrameworkApplication.Js.xz);this.ora(1,!!this.b7&&""!==this.b7.value&&this.b7.value!==J)}r7d(){this.b7&&window.setTimeout(()=>{this.jyf()},0)}pOd(J,ma){if(1!==J)za.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{J=ma[lj.D_h];ma=lj.L_i in ma?ma[lj.L_i]:!1;za.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",Va.a.V8i(J),ma);const Ta=Va.a.Mha(l.AFrameworkApplication.fileName);
(J=J?J.trim():null)&&""!==J&&""!==Ta||1===this.ua.state?this.C_h(J)?this.sH.create().PO(1,J,ma):this.h_a.Rza(J+Ta,ma,this.Pm):this.sH.create().PO(2,J,ma)}}dispose(){this.b7&&(Q.a.removeHandler(this.b7,"change",Object(a.a)(this,this.r7d,"onFileNameChange")),Q.a.removeHandler(this.b7,"input",Object(a.a)(this,this.r7d,"onFileNameChange")),this.b7=null);super.dispose()}}lj.D_h="txtFileName";lj.L_i="chkOverwrite";Object(e.a)(lj,"FileNameDialogBase",k.a,[]);class il{static get Vg(){return k.a.Kx(il.Xm,
CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}il.Xm="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(e.a)(il,"FileNameDialogHtml",null,[]);class zk extends lj{constructor(J,ma,Ta,pb,Wb,Jc){super(J,ma,Ta,pb,Wb,Jc);this.Vg=il.Vg;this.yg="FileNameDialog-SaveAsToHost"}HEa(J,ma){const Ta=Va.a.yJ(l.AFrameworkApplication.Js.xz);ma={["txtFileName"]:J||Ta,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:ma};this.Uh(CommonUIStrings.L_SaveAs,Object(a.a)(this,this.pOd,"fileNameDialogHandler"),ma);this.nTh(J,Ta)}}Object(e.a)(zk,"FileNameDialog",lj,[2030]);class Im{constructor(J,ma,
Ta,pb,Wb,Jc){this.ga=ma;this.Ca=J;this.rsa=pb;this.h_a=Jc;this.sH=Wb;this.Xi=Ta}create(){return new zk(this.Ca,this.ga,this.Xi,this.rsa,this.sH,this.h_a)}}Object(e.a)(Im,"FileNameDialogFactory",null,[2011]);class zd{constructor(J,ma,Ta){this.h_a=Ta;this.tBe=ma;this.Ca=J}Tb(){2===l.AFrameworkApplication.ua.Kb.yk?l.AFrameworkApplication.va.fb(m.a.z8c,y.a.frame,Object(a.a)(this,this.dhj,"saveAsToHostActionDispatcher"),4):l.AFrameworkApplication.va.ra(m.a.z8c,y.a.frame,Object(a.a)(this,this.dhj,"saveAsToHostActionDispatcher"))}dhj(J,
ma,Ta,pb,Wb){return ma.contextId!==y.a.frame||J!==m.a.z8c?2:this.Ca.$("SaveAsToHostBrsIsEnabled")?1===Ta?Zh.SessionStatusManager.instance.Zj||l.AFrameworkApplication.Dpa?8:32:2===Ta?(za.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),J=this.tBe.create(),Wb&&Object.getType(Wb)===Array&&2===Wb.length?J.HEa(Wb[0],!!Wb[1]):J.HEa(null,!1),32):8:8}}Object(e.a)(zd,"SaveAsToHostActor",null,[]);class hf{constructor(J,ma,Ta,pb,Wb,Jc,Zc,jd){this.Hk=null;this.LZb=this.ZZ=
!1;this.g_a=this.Pm=this.YN=null;this.Ca=ma;this.Lma=this.Ca.appSettings.SaveAsToHostWebServiceBase;this.k0g=pb;this.XYa=Wb;this.$f=Ta;this.sH=Jc;this.je=jd;this.Xi=Zc;this.ga=J;this.DXa=ma.kb("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}o8a(){1!==this.Xi.state&&(this.Hk=this.XYa(),this.Hk.message=CommonUIStrings.l_CommentProgressTooltip,this.Hk.Cd=5,this.Hk.Kt=!1,this.Hk.JL(CommonUIStrings.l_DefaultDialogTitle,null,null))}T5(J=0){1!==this.Xi.state&&this.sH.create().PO(J,Va.a.yJ(this.YN),
this.LZb)}NOb(){const J=this.Ca.appSettings.BreadcrumbFolderUrl;za.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");qa.a.wm(J,qa.a.esa(3),void 0,"UploadToHostManager.RedirectToFolder")}MOb(J){let ma=!1,Ta=!1;this.Ca&&(ma=this.Ca.$("SaveACopyIsEnabledForUiHost"),Ta=this.Ca.$("UiHostSupportsDocRebootFeatures"));za.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",J,ma,Ta);if(ma&&Ta){za.ULS.sendTraceTag(51245197,
216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const pb={};pb[$c.a.ejc]="1";pb[$c.a.documentUrl]=J;pb[$c.a.reason]=we.a.Vag;l.AFrameworkApplication.mP().execute(Wb=>{Wb.sendMessage(Bd.a.eEb,pb)})}else ma&&!Ta&&l.AFrameworkApplication.WM?qa.a.wm(J,qa.a.esa(4),void 0,"UploadToHostManager.RedirectToEditUrl"):qa.a.wm(J,qa.a.esa(3),void 0,"UploadToHostManager.RedirectToEditUrl")}Rza(J,ma,Ta=null){za.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.k0g&&
!this.k0g()&&this.$f&&(this.je&&(this.g_a=this.je.Zf("DialogShown","SaveAsToHostUploadTime")),this.o8a(),this.LZb=ma,this.YN=J,(this.Pm=Ta)&&"true"===this.Pm.SkipSaveToHost?this.CNd():this.rha())}rha(){32!==this.ga.processAction(m.a.NPb,1)?(za.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.CNd()):this.ga.Qb(m.a.NPb,2,[()=>{za.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.CNd()},(J,ma)=>
{za.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.T5(ma)}])}awn(J){this.Vna();this.ZZ=!1;if(J&&J.data&&J.data.se)if(({Gt:ma}=Ja.d(J.data.se)).returnValue)if(J=ma,J.StatusCode!==Ph.a.Zz&&J.StatusCode!==Ph.a.g6b){za.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var ma={};ma.FailureReason=J.StatusCode.toString();ma.ExtraInfo=J.ExtraInfo;this.STa(ma);this.T5(parseInt(J.ExtraInfo))}else{za.ULS.sendTraceTag(8194050,
216,50,"UploadToHost execute success.");this.R9f();try{J.NewDocumentUrl&&""!==J.NewDocumentUrl?this.MOb(J.NewDocumentUrl):this.NOb()}catch(Ta){za.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",Ta.toString())}this.Q3c()}else za.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Ib.a.Mcd(J.data.se)}),this.STa({["FailureReason"]:"Failed to deserialize response"}),this.T5();else za.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.STa({["FailureReason"]:"null response"}),this.T5()}$vn(J){5!==J.data.status&&12!==J.data.status||this.ZZ?(za.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:J.data.status,["HttpStatus"]:J.data.Se}),this.STa({["FailureReason"]:J.data.Se.toString()}),this.Vna(),this.T5(),this.Q3c()):(za.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.ZZ=!0,this.Pm&&"true"===this.Pm.SkipSaveToHost?this.CNd():this.rha())}Vna(){this.Hk&&
(this.Hk.close(),this.Hk=null)}Q3c(){this.g_a&&(this.g_a.stop(),this.g_a=null)}R9f(){this.Pm&&"VersionHistory"===this.Pm.SaveEntryPoint&&this.ga.processAction(m.a.w7c,2)}STa(J){this.Pm&&"VersionHistory"===this.Pm.SaveEntryPoint&&this.ga.Qb(m.a.oee,2,J)}CNd(){let J=this.Lma+this.DXa;J=zc.a.fp(J,"qs",Va.a.Gj(l.AFrameworkApplication.em));J=zc.a.fp(J,"n",Va.a.Gj((new Date).getTime().toString()));J=zc.a.fp(J,"ov",Va.a.Gj(this.LZb.toString()));J=zc.a.fp(J,"fn",Va.a.Gj(this.YN));this.Pm&&this.Pm.FileDownloadUrl&&
(J=zc.a.fp(J,"furl",Va.a.Gj(this.Pm.FileDownloadUrl)));this.$f.mj(J,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(a.a)(this,this.awn,"onUploadFinished"),Object(a.a)(this,this.$vn,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(e.a)(hf,"UploadToHostManager",null,[1961]);class Mi{constructor(){this.W=null}get name(){return"Common.App.SaveAsToHost"}init(){l.AFrameworkApplication.K.Nn(Object(a.a)(this,this.Xx,"onFullAppSettingsReady"))}Xx(){l.AFrameworkApplication.K.$("SaveAsToHostBrsIsEnabled")&&
this.W.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Tb()}wc(J){this.W=J;this.W.register(bn,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Ud(()=>new bn(l.AFrameworkApplication.K,l.AFrameworkApplication.va)).ha();this.W.register(hf,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Ud(()=>new hf(l.AFrameworkApplication.va,l.AFrameworkApplication.K,l.AFrameworkApplication.He,()=>l.AFrameworkApplication.Rk,
()=>(new Yk.a).create(),J.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),l.AFrameworkApplication.ua,l.AFrameworkApplication.ua.Lq)).ha();this.W.register(Im,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Ud(()=>new Im(l.AFrameworkApplication.K,l.AFrameworkApplication.va,l.AFrameworkApplication.ua,l.AFrameworkApplication.ua.Kb,J.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),J.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ha();
this.W.register(zd,"Common.App.SaveAsToHost.SaveAsToHostActor").Ud(()=>new zd(l.AFrameworkApplication.K,J.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),J.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ha()}dispose(){}static main(){M.a.instance.Gc(new Mi)}}Object(e.a)(Mi,"SaveAsToHostPackage",null,[1,2]);class Rl extends Ng.StandardDialog{constructor(){super();this.Cd=0;this.ze(1,CommonUIStrings.l_DialogClose)}PO(J){this.vx(J,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)}}Object(e.a)(Rl,"ErrorDialog",Ng.StandardDialog,[2005]);var me=c(205);class qd extends Ng.StandardDialog{constructor(J,ma,Ta){super();this.ga=J;this.aua=ma;this.rsa=Ta;this.Faa=!1;this.Cd=1;this.BV(1);this.ze(1,CommonUIStrings.l_SignIn);this.ze(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}HEa(){this.aua.zqh(Object(a.a)(this,this.GYi,"onSignIn"));this.rv(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(a.a)(this,this.TCm,"inputHandler"))}TCm(J){0===
J?(za.ULS.sendTraceTag(6590598,216,l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Kb&&1===l.AFrameworkApplication.ua.Kb.yk?15:50,"User dismissed SignIn Dialog."),this.hide()):this.N$d()}wVk(){let J="2";if(this.rsa)switch(this.rsa.yk){case 3:J="0";break;case 2:J="3";break;case 1:J="1"}return J}hide(){this.aua.k1n(Object(a.a)(this,this.GYi,"onSignIn"));super.hide()}N$d(){var J=l.AFrameworkApplication.K.$("SignInAspxInWebAppsPortalIsEnabled")?"/start/signin.aspx":"Signin.aspx";J=new me.QueryStringBuilder(J);
J.Be("prompt","1");J.Be("cbcxt",this.wVk());l.AFrameworkApplication.nga(J);qa.a.wm(J.toString(),"LoginWindow",void 0,"SignInDialog")}GYi(){this.Mpa&&this.hide();za.ULS.sendTraceTag(7143885,216,l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Kb&&1===l.AFrameworkApplication.ua.Kb.yk?15:50,"User signed in successfully. Calling Savetocloudstorage action handler");this.ga.processAction(m.a.dbg,2)}}Object(e.a)(qd,"SignInDialog",Ng.StandardDialog,[2028]);class Yj{constructor(J,ma,Ta){this.ga=J;this.aua=
ma;this.rsa=Ta}create(){return new qd(this.ga,this.aua,this.rsa)}}Object(e.a)(Yj,"SignInDialogFactory",null,[2007]);class af{constructor(J,ma,Ta,pb,Wb,Jc,Zc){this.Lma=J;this.YN=ma;this.dXb=Ta;this.$ld=pb;this.EPe=Wb;this.DXa=Jc;this.Pm=Zc}execute(J,ma){if(!l.AFrameworkApplication.Rk&&l.AFrameworkApplication.He){var Ta=this.Lma+this.DXa;Ta=zc.a.fp(Ta,"fo",Va.a.Gj(this.$ld));Ta=zc.a.fp(Ta,"fn",Va.a.Gj(this.YN));Ta=zc.a.fp(Ta,"qs",Va.a.Gj(this.EPe));Ta=zc.a.fp(Ta,"n",Va.a.Gj((new Date).getTime().toString()));
this.Pm&&this.Pm.FileDownloadUrl&&(Ta=zc.a.fp(Ta,"furl",Va.a.Gj(this.Pm.FileDownloadUrl)));this.dXb&&(Ta=zc.a.fp(Ta,"fnn",Va.a.Gj(this.dXb)));l.AFrameworkApplication.He.mj(Ta,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,J,ma,null)}}}Object(e.a)(af,"SkyDriveUploadCaller",null,[1984]);class Xe{constructor(J){this.Ca=J;this.wAb=J.appSettings.SkyDriveUploadWebServiceBase;this.YN=J.appSettings.FileName;this.DXa=J.kb("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(J,ma,Ta){return new af(this.wAb,
this.YN,ma,J,l.AFrameworkApplication.em,this.DXa,Ta)}}Object(e.a)(Xe,"SkydriveUploadCallerFactory",null,[1967]);class ho{constructor(){this.W=null}get name(){return"Common.App.SaveToCloudStorage"}init(){l.AFrameworkApplication.K.$("SaveToCloudStorageUIIsEnabled")&&this.W.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Tb()}dispose(){}wc(J){this.W=J;this.W.register(Yj,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Ud(()=>
new Yj(l.AFrameworkApplication.va,Hk.a.instance,l.AFrameworkApplication.ua.Kb)).ha();this.W.register(Xe,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Ud(()=>new Xe(l.AFrameworkApplication.K)).ha();this.W.register(tl,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Ud(()=>new tl(J.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),J.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
l.AFrameworkApplication.K,l.AFrameworkApplication.ua.Lq)).ha();this.W.register(ji,"Common.App.SaveToCloudStorage.UploadToCloudManager").Ud(()=>new ji(J.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new Yk.a).create(),()=>new Rl,l.AFrameworkApplication.ua,l.AFrameworkApplication.ua.Lq)).ha();this.W.register(kj,"Common.App.SaveToCloudStorage.SaveToCloudManager").Ud(()=>new kj(J.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Hk.a.instance,J.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),
l.AFrameworkApplication.K,l.AFrameworkApplication.M8,()=>new Rl)).ha()}static main(){M.a.instance.Gc(new ho)}}Object(e.a)(ho,"PackageManager",null,[1,2]);class ki extends Ng.StandardDialog{constructor(){super();this.Cd=0;this.ze(1,CommonUIStrings.l_DialogClose)}PO(J,ma){this.JTh(J,ma,Yl.a.kao)}JTh(J,ma,Ta){za.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",Ta);this.vx(Ta,J,ma,null)}jgf(J,ma){za.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");
this.vx(Yl.a.nao,J,ma,null,!0)}}Object(e.a)(ki,"ErrorDialog",Ng.StandardDialog,[948]);class qm{static get Vg(){return k.a.Kx(qm.Xm,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}qm.Xm="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(e.a)(qm,"FileNameDialogHtml",null,[]);var Fj=c(79);class rm extends lj{constructor(J,ma,Ta,pb,Wb,Jc,Zc,jd){super(J,ma,Ta,pb,Wb,Jc,jd);this.Jbb=this.NRe=this.EQ=null;this.$Pk=CommonUIStrings.l_SaveToAnotherFolder;this.Vg=qm.Vg;this.yg="FileNameDialog-SaveToSharePoint";this.HCc=Zc;this.bek=jd}HEa(J){const ma=Va.a.yJ(l.AFrameworkApplication.Js.xz),Ta=l.AFrameworkApplication.breadcrumbFolderName,pb=l.AFrameworkApplication.breadcrumbBrandName,Wb={["txtFileName"]:J||ma};let Jc=CommonUIStrings.L_SaveAs;
2===l.AFrameworkApplication.ua.Kb.yk&&(Jc=CommonUIStrings.L_SaveACopy);this.Uh(Jc,Object(a.a)(this,this.pOd,"fileNameDialogHandler"),Wb);this.nTh(J,ma);this.dff.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");l.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost")||(this.EQ=document.getElementById("anotherFolder"),J=document.getElementById("folderLocation"),this.NRe=kg.a.Ith(J,this.EQ,"anotherFolderDescribedBy"),this.EQ.className=
"WACButton WACDialogButtonNormal",J=!1,Ta&&Ta.length?(this.ooh(this.EQ,this.NRe,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,pb,Ta)),J=this.prk(pb,Ta)):this.ooh(this.EQ,this.NRe,CommonUIStrings.l_CurrentOnlineFolder),this.htk(this.EQ),this.rrk(this.EQ),J?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.EQ,"SaveToAnotherLocationTwo"),za.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.EQ,
"SaveToAnotherLocationOne"),Q.a.addHandler(this.EQ,V.a.click,Object(a.a)(this,this.AYf,"onSaveToAnotherLocationClick")),Q.a.addHandler(this.EQ,V.a.gi,Object(a.a)(this,this.mYi,"onSaveToAnotherLocationKeyDown")))}prk(J,ma){let Ta;Ta=!1;const pb=document.getElementById("currentLocation");pb.innerText="";const Wb=this.Pci(pb,J),Jc=this.Pci(pb,ma);let Zc=255,jd=255;255<Wb+Jc&&(Zc=Math.max(238,408-Wb),jd=Math.max(170,408-Jc),Ta=!0);this.rvk(pb,J,jd,ma,Zc);return Ta}Pci(J,ma){const Ta=document.createElement("div");
Ta.innerText=ma;Ta.style.visibility="hidden";J.appendChild(Ta);ma=Ta.clientWidth;J.removeChild(Ta);return ma}rvk(J,ma,Ta,pb,Wb){ma&&(this.noh(J,ma,Ta),this.jvk(J));pb&&this.noh(J,pb,Wb)}noh(J,ma,Ta){const pb=document.createElement("div");pb.innerText=ma;pb.title=ma;pb.className="SaveToAnotherFolderBreadcrumb";pb.style.maxWidth=Ta.toString()+"px";J.appendChild(pb)}jvk(J){const ma=document.createElement("span");ma.id="FolderSeparator";const Ta=document.createElementNS("http://www.w3.org/2000/svg","svg");
Ta.setAttribute("class","SeparatorCaret");const pb=document.createElementNS("http://www.w3.org/2000/svg","polygon");pb.setAttribute("points","1 4 1 11 5 7.5");Ta.appendChild(pb);ma.appendChild(Ta);J.appendChild(ma)}ooh(J,ma,Ta){Ta=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,Ta);ma&&(ma.innerText=Ta);J.tabIndex=0;J.setAttribute(kg.a.uh,kg.a.X3)}rrk(J){const ma=document.createElement("span");ma.id="anotherFolderText";ma.innerText=this.$Pk;ma.className="AnotherFolderTextSpan";
J.appendChild(ma)}htk(J){const ma=document.createElement("span");ma.className="cui-img-cont-float cui-img-16by16 ";this.Jbb=document.createElementNS("http://www.w3.org/2000/svg","svg");this.Jbb.setAttribute("class","FolderIconSVG");const Ta=document.createElementNS("http://www.w3.org/2000/svg","path");Ta.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.Jbb.appendChild(Ta);ma.appendChild(this.Jbb);J.appendChild(ma)}mYi(J){!J||
J.keyCode!==Fj.a.Ss&&J.keyCode!==Fj.a.ipe||this.AYf(J)}AYf(){if(this.b7){const J=Va.a.Mha(l.AFrameworkApplication.fileName);let ma=this.b7.value;this.hide();ma&&""!==ma&&""!==J||1===this.ua.state?(""!==J&&(ma+=J),this.C_h(ma)?this.sH.create().PO(1,ma,!1):this.HCc.start(ma,this.bek)):this.sH.create().PO(2,ma,!1)}}aVk(J){this.EQ&&this.Jbb&&(J?(this.EQ.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.EQ,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.Jbb,"DisabledFolderIconSVG")):(this.EQ.tabIndex=
-1,Sys.UI.DomElement.containsCssClass(this.EQ,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.Jbb,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.EQ,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.Jbb,"DisabledFolderIconSVG"))))}jyf(){super.jyf();this.aVk(!!this.b7&&""!==this.b7.value)}dispose(){this.EQ&&(Q.a.removeHandler(this.EQ,V.a.click,Object(a.a)(this,this.AYf,"onSaveToAnotherLocationClick")),Q.a.removeHandler(this.EQ,V.a.gi,Object(a.a)(this,this.mYi,
"onSaveToAnotherLocationKeyDown")),this.EQ=null);super.dispose()}}Object(e.a)(rm,"FileNameDialog",lj,[1097]);var Tf=c(503),Fl=c(359),Hf=c(1574),Ed=c(1699);class Zl{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(e.a)(Zl,"SaveAsDialogInput",null,[]);class ed{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(e.a)(ed,"SaveLocation",null,[]);var Bf=c(117);class Og{constructor(J,ma,Ta,pb,Wb,Jc,Zc,jd,dd){this.xJe=
null;this.YN="";this.HCc=J;this.sH=ma;this.Pm=dd;this.h_a=Ta;this.Xi=Wb;this.bM=pb;this.gAb=Zc;this.l0b=jd;Jc&&(this.xJe=new ac.a(()=>new Hf.a(Jc.value,null)))}CUl(){const J=new Tf.a(Fl.a.ih());J.Z("type","currentHost");return Object.assign(new ed,{folderName:this.bM.breadcrumbFolderName,friendlyPath:this.bM.breadcrumbBrandName,properties:J})}SUm(J){return!!J&&"ClassicMru"===J.type&&!!J.service_info&&!!J.service_info.service_id&&-1!==J.service_info.service_id.indexOf("SHAREPOINT")}tem(){if(!this.xJe||
!this.gAb)return null;var J=this.xJe.value.lP("SaveAsToSharePointDialog",!1);if(!J||3!==J.state||!J.wQi)return null;J=J.wQi;const ma=new kb.a;let Ta=0,pb=0;for(var Wb=0;Wb<J.length;Wb++){var Jc=J[Wb];if(!this.SUm(Jc))continue;Ta++;if(!Jc.sharepoint_info)continue;const Zc=Jc.url,jd=Jc.sharepoint_info.site_url,dd=Jc.title;Jc=Ed.b(Jc,l.AFrameworkApplication.isRtl);if(!(Zc&&jd&&dd&&Jc))continue;pb++;const Ld=new Tf.a(Fl.a.ih());Ld.Z("type","SharePoint");Ld.Z("siteUrl",jd);Ld.Z("folderUrl",Zc);pb++;ma.add(Object.assign(new ed,
{folderName:dd,friendlyPath:Jc,properties:Ld}))}Wb=new Map;Wb.set("NumPlaces",J.length.toString());Wb.set("NumSharepointPlaces",Ta.toString());Wb.set("placesWithMetadata",pb.toString());Oa.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",Wb);0<Ta&&(pb?.5>1*pb/Ta&&Oa.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):Oa.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return ma}JVl(){const J=
new kb.a;J.add(this.CUl());const ma=this.tem();ma&&J.addRange(ma);return Object.assign(new Zl,{enableMoreLocations:!l.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.YN,extension:Va.a.Mha(this.bM.xz),saveLocations:J.toArray(),scenario:"SaveToSharePoint"})}dqf(){const J=Object(a.a)(this,this.JVl,"getDialogInput"),ma={};ma.inputPropsCallback=J;return ma}HEa(J){this.YN=J;this.YN||(this.YN=String.format(CommonUIStrings.l_SaveACopy_Filename,Va.a.yJ(this.bM.xz)));J={["id"]:"SaveAsDialog",
["bodyControls"]:this.dqf()};let ma=CommonUIStrings.L_SaveAs;2===this.Xi.Kb.yk&&(ma=CommonUIStrings.L_SaveACopy);const Ta=new k.a(!1,!1,!0);Ta.Cd=1;Ta.yg="SaveAsDialog";Ta.ze(1,CommonUIStrings.l_SaveButtonLabel);Ta.Uh(ma,Object(a.a)(this,this.gao,"saveAsDialogHandler"),J)}xxo(J,ma){J&&""!==J&&""!==ma||1===this.Xi.state?this.RUm()?this.$2m(J,ma):(""!==ma&&(J+=ma),this.HCc.start(J,this.Pm)):(za.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.sH.create().PO(2,
J,!1))}$2m(J,ma){Oa.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const Ta=this.l0b.lbf(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.l0b.MRd(Ta).then(pb=>{if(pb&&0<pb.length){const Wb=pb[0][$c.a.fDn];pb=pb[0][$c.a.gDn];if(""!==Wb&&""!==pb)this.gAb.Rza(pb,J+ma,Wb,this.Pm),Oa.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.sH.create().PO(0,J,!1);const Jc=Db.a.vG();Jc&&(Jc.set("SiteUrlAvailable",
""===Wb?"false":"true"),Jc.set("FolderUrlAvailable",""===pb?"false":"true"));Oa.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new Bf.a,{extendedProperties:Jc}))}}else this.sH.create().PO(0,J,!1),Oa.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(pb=>{"Canceled"===pb?((pb=Db.a.vG())&&pb.set("IsCanceled","true"),Oa.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new Bf.a,{extendedProperties:pb}))):
Oa.Health.instance.recordKpiFailure("SaveACopySFP",pb,!1,!1,null)})}RUm(){return this.l0b?this.l0b.WHf():(za.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}gao(J,ma){if(ma&&1===J){J=ma.fileName;var Ta=Va.a.Mha(this.bM.xz);ma.moreLocationsSelected&&this.xxo(J,Ta);if(ma.locationCallback){var pb=ma.locationCallback();pb?pb.properties&&"currentHost"===pb.properties.J("type")?this.h_a.Rza(J+Ta,!1,this.Pm):pb.properties&&"SharePoint"===pb.properties.J("type")?(ma=pb.properties.J("siteUrl"),
pb=pb.properties.J("folderUrl"),this.gAb.Rza(pb,J+Ta,ma,this.Pm)):za.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):za.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else za.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(e.a)(Og,"ReactSaveAsDialog",null,[1097]);class Rm{constructor(J,ma,Ta,pb,Wb,Jc,Zc,jd=null,dd=null,Ld=null){this.ga=ma;this.Ca=J;this.rsa=pb;this.h_a=Jc;this.sH=Wb;this.Xi=Ta;this.Teh=Zc;this.K$j=jd;this.gAb=dd;this.l0b=
Ld}create(J){return this.Xi&&this.Xi.Kb.vF?new Og(this.Teh,this.sH,this.h_a,l.AFrameworkApplication.Js,this.Xi,this.K$j,this.gAb,this.l0b,J):new rm(this.Ca,this.ga,this.Xi,this.rsa,this.sH,this.h_a,this.Teh,J)}}Object(e.a)(Rm,"FileNameDialogFactory",null,[1077]);class Xh{constructor(J,ma,Ta,pb){this.aw=this.tAc=null;this.Yub=J;this.Xi=Ta;this.lfk=pb;this.BXa=new ac.a(()=>new Hf.a(ma.value,Object(a.a)(this,this.EGb,"getMoreInfoEventReceived")))}get EZi(){this.tAc||(this.BXa.value.lP("Save As",!0),
this.aw&&this.aw.Rda&&this.aw.Rda.length&&(this.tAc=this.u7l(this.aw.Rda)));return this.tAc}start(J){if(!this.EZi)if(l.AFrameworkApplication.breadcrumbFolderUrl&&l.AFrameworkApplication.breadcrumbFolderUrl.length)this.tAc=l.AFrameworkApplication.breadcrumbFolderUrl;else return za.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.aw),!1;const ma=this.lfk();ma.Jxo();const Ta=
ma.f$l();if(!Ta)return za.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.Yub.start((pb,Wb)=>{ma.hide();J(pb,Wb)},()=>{this.rMb(ma)},Ta,this.tAc);return!0}rMb(J){J.hide();za.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}u7l(J){J=J.toLowerCase();J.endsWith("/")||(J+="/");const ma=J.indexOf("/documents/");return-1!==ma?J.substring(0,ma+1)+"_layouts/15/onedrive.aspx":""}EGb(J){this.aw||3!==J.state||(this.aw=J)}}Object(e.a)(Xh,"OneDriveFilePickerHelper",
null,[1076]);class rf extends k.a{constructor(){super()}Jxo(){this.xtc="FilePickerDialog";this.Vg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.yg="PickerDialog-MsoSp";this.showDialog("",null)}f$l(){return document.getElementById("FilePickerDiv")}KL(){}Wda(){}}Object(e.a)(rf,"PickerDialog",k.a,[947]);class Ak{constructor(J,ma,Ta,pb,Wb,Jc,Zc){this.Ca=J;this.tBe=Ta;this.ga=ma;this.HCc=pb;this.Yub=Wb;this.sAc=Jc;this.BYj=Zc}Tb(){const J=this.Yub.r$b();J?Ka.a.zpa||this.Ca.$("SaveToSharePointOnDemandDownloadJsIsEnabled")?
this.ga.fb(m.a.pkc,y.a.frame,Object(a.a)(this,this.yhj,"saveToSharePointActionDispatcher"),64):(J.s5a.continueWith(ma=>{ma.Gi&&this.Yub.rXf(ma)}),this.XEd()):za.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}XEd(){Hc.a.gde(Object(a.a)(this,this.yhj,"saveToSharePointActionDispatcher"));Hc.a.nNc([new ri.a(m.a.pkc,y.a.frame,0)],this.Yub.r$b())}get gec(){return this.Ca.$("SaveToAnotherFolderBrsIsEnabled")}get SBh(){return this.Ca.$("UserCanWriteRelative")}yhj(J,
ma,Ta,pb,Wb){return ma.contextId!==y.a.frame||J!==m.a.pkc?2:this.gec&&(this.sAc.EZi||this.SBh)?1===Ta?Zh.SessionStatusManager.instance.Zj||l.AFrameworkApplication.Dpa?8:this.BYj()?32:8:2===Ta?(za.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(Wb&&Wb.SaveEntryPoint&&"VersionHistory"===Wb.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.SBh?(za.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.tBe.create(Wb).HEa(null)):(za.ULS.sendTraceTag(24524225,
216,50,"No permission save to current folder, show Picker to save to another folder."),this.HCc.start(null,Wb)),32):8:8}}Object(e.a)(Ak,"SaveToSharePointActor",null,[]);class ye{constructor(J,ma,Ta,pb){this.Pm=this.n8g=null;this.gAb=J;this.sH=ma;this.sAc=Ta;this.Xi=pb}start(J,ma){za.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.n8g=J;this.Pm=ma;this.sAc.start((Ta,pb)=>{this.processResponse(Ta,pb)})||this.Fhg()}processResponse(J,ma){if(J)this.onSuccess(ma);else this.onFailure(ma)}Fhg(){1!==
this.Xi.state&&this.sH().jgf(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(J){za.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(J&&J.data&&J.data.value&&J.data.value.length&&J.data.value[0].sharePoint){const ma=J.data.value[0].sharePoint.url;J=J.data.value[0].sharePoint.listUrl;let Ta=null;if(ma&&(Ta=J?this.Gem(J):this.Fem(ma))){this.gAb.Rza(ma,this.n8g,Ta,this.Pm);return}za.ULS.sendTraceTag(25180164,
216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!ma,!Ta)}za.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.Fhg()}Fem(J){J.endsWith("/")||(J+="/");let ma=0;for(let Ta=0;Ta<J.length;Ta++)if("/"===J.charAt(Ta)&&5===++ma)return J.substr(0,Ta);return null}Gem(J){J.endsWith("/")&&(J=J.substring(0,J.length-1));const ma=J.lastIndexOf("/");return-1!==ma?J.substring(0,ma):null}onFailure(J){za.ULS.sendTraceTag(23881888,216,
10,"Picker failure Callback called.");J&&J.error?za.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",J.error.errorCode,J.error.message):za.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.Fhg()}}Object(e.a)(ye,"SaveToSharePointManager",null,[2013]);class rk{constructor(J,ma,Ta,pb,Wb,Jc,Zc,jd){this.Lma=J;this.YN=ma;this.dXb=pb;this.EPe=Jc;this.DLa=Ta;this.xkk=Wb;this.DXa=Zc;this.Pm=jd}execute(J,ma){if(!l.AFrameworkApplication.Rk&&
l.AFrameworkApplication.He){var Ta=this.Lma+this.DXa;Ta=zc.a.fp(Ta,"fu",Va.a.Gj(this.DLa));Ta=zc.a.fp(Ta,"su",Va.a.Gj(this.xkk));Ta=zc.a.fp(Ta,"fn",Va.a.Gj(this.YN));Ta=zc.a.fp(Ta,"n",Va.a.Gj((new Date).getTime().toString()));this.Pm&&this.Pm.FileDownloadUrl&&(Ta=zc.a.fp(Ta,"furl",Va.a.Gj(this.Pm.FileDownloadUrl)));Ta=Ta+"&"+this.EPe;this.dXb&&this.dXb.length?Ta=zc.a.fp(Ta,"fnn",Va.a.Gj(this.dXb)):za.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");za.ULS.sendTraceTag(23881920,216,
50,"Trying send SharePointSaveAsHandler.ashx request.");l.AFrameworkApplication.He.mj(Ta,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,J,ma,null,void 0,void 0,void 0,void 0,"9")}}}Object(e.a)(rk,"SharePointSaveAsCaller",null,[2032]);class Hn{constructor(J){this.wAb=J.appSettings.SaveAsToHostWebServiceBase;this.YN=J.appSettings.FileName;this.DXa=J.kb("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(J,ma,Ta,pb){return new rk(this.wAb,this.YN,J,ma,Ta,l.AFrameworkApplication.em,
this.DXa,pb)}}Object(e.a)(Hn,"SharePointUploadCallerFactory",null,[2012]);var fj=c(1397);class Qh{constructor(J,ma,Ta,pb,Wb){this.Hk=this.Vrc=null;this.zte=!1;this.HRe=this.DLa=null;this.AXe=ma;this.XYa=Ta;this.sH=pb;this.Xi=Wb;this.ga=J}Rza(J,ma,Ta,pb){this.zte=!1;za.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.o8a();this.DLa=J;pb&&pb.SaveEntryPoint&&(this.HRe=pb.SaveEntryPoint);this.Vrc=this.AXe.create(J,ma,Ta,pb);pb&&"true"===pb.SkipSaveToHost?
this.rha():this.RIl()}RIl(){const J=()=>{za.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.rha()};32!==this.ga.Qb(m.a.NPb,2,[()=>{za.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.rha()},J])&&J()}rha(){za.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.Vrc.execute(Object(a.a)(this,this.Ttn,"onSaveToSharePointUploadFinished"),Object(a.a)(this,this.Stn,
"onSaveToSharePointUploadFailed"))}Ttn(J){if(J&&J.data&&J.data.se){var ma;if(({Gt:ma}=Ja.d(J.data.se)).returnValue)if(ma.StatusCode!==Ph.a.Zz&&ma.StatusCode!==Ph.a.g6b)za.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",J.data.status,ma.StatusCode),ma.StatusCode!==Ph.a.W9f&&this.pUh(J.data.status)||(this.STa(ma.StatusCode.toString()),this.Ewo(ma.StatusCode));else{za.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");
this.R9f();try{ma.NewDocumentUrl?this.MOb(ma.NewDocumentUrl):this.NOb()}catch(Ta){za.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",Ta.toString())}}else za.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Ib.a.Mcd(J.data.se)}),this.HLd()||(this.STa("Failed to deserialize response"),this.mad())}else za.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.HLd()||(this.STa("Unknown"),this.mad())}Stn(J){J&&J.data?this.pUh(J.data.status)||
(za.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.STa(fj.a[J.data.status]),this.mad()):(za.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.HLd()||(this.STa("Unknown"),this.mad()))}HLd(){if(!this.zte)return za.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.zte=!0,this.rha(),!0;za.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}pUh(J){za.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",
J);return this.HLd()}NOb(){za.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");qa.a.wm(this.DLa,qa.a.esa(3),void 0,"UploadToSharePointManager.RedirectToFolder")}MOb(J){let ma=!1,Ta=!1;l.AFrameworkApplication.K&&(ma=l.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),Ta=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));za.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",J,ma);if(ma&&Ta){za.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");
const pb={};pb[$c.a.ejc]="1";pb[$c.a.documentUrl]=J;pb[$c.a.reason]=we.a.Vag;l.AFrameworkApplication.mP().execute(Wb=>{Wb.sendMessage(Bd.a.eEb,pb)})}else qa.a.wm(J,qa.a.esa(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}o8a(){this.Xi&&1===this.Xi.state||(this.Hk=this.XYa(),this.Hk.message=CommonUIStrings.l_CommentProgressTooltip,this.Hk.Cd=5,this.Hk.Kt=!1,this.Hk.JL(CommonUIStrings.l_DefaultDialogTitle,null,null))}Vna(){this.Hk&&(this.Hk.close(),this.Hk=null)}mad(){this.Ep(CommonUIStrings.l_SaveFailedDialogTitle,
CommonUIStrings.l_FailToSaveFile)}yxo(){this.Ep(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}Kwo(){const J=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.Ep(CommonUIStrings.l_SaveAsFileTooLargeTitle,J,Yl.a.hao)}Ep(J,ma,Ta=Yl.a.mao){za.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",J,ma);this.Vna();1!==this.Xi.state&&this.sH().JTh(J,ma,Ta)}Ewo(J){za.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",
J);switch(J){case Ph.a.Ine:this.yxo();break;case Ph.a.W9f:this.Kwo();break;default:this.mad()}}R9f(){"VersionHistory"===this.HRe&&this.ga.processAction(m.a.w7c,2)}STa(J){"VersionHistory"===this.HRe&&this.ga.Qb(m.a.oee,2,{["FailureReason"]:J})}}Object(e.a)(Qh,"UploadToSharePointManager",null,[2014]);var gh=c(634),sk=c(131);class Xi{constructor(){this.Qdb=this.pLe=this.gLe=this.W=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}wc(J){this.W=J;this.gLe=gh.a.Gp(J.Ta("Common.IEventEmitter<Common.IGetMoreInfoResult>"));
this.pLe=gh.a.Gp(J.Ta("Common.IEventEmitter<Common.IMruResult>"));this.Qdb=gh.a.Gp(J.Ta("Common.App.SharedFilePicker.ISharedFilePicker"));sk.Task.WAA.call(null,this.gLe,this.pLe,this.Qdb).continueWith(()=>{this.HUn()})}HUn(){this.W.register(Hn,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Ud(()=>new Hn(l.AFrameworkApplication.K)).ha();this.W.register(Qh,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Ud(()=>
new Qh(l.AFrameworkApplication.va,this.W.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new Yk.a).create(),()=>new ki,l.AFrameworkApplication.ua)).ha();this.W.register(ye,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Ud(()=>new ye(this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new ki,this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),l.AFrameworkApplication.ua)).ha();
this.W.register(Xh,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Ud(()=>new Xh(this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new ac.a(()=>this.gLe.result),l.AFrameworkApplication.ua,()=>new rf)).ha();this.W.register(Rm,"Common.App.SaveToSharePoint.FileNameDialogFactory").Ud(()=>new Rm(l.AFrameworkApplication.K,l.AFrameworkApplication.va,l.AFrameworkApplication.ua,l.AFrameworkApplication.ua.Kb,
this.W.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.W.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new ac.a(()=>this.pLe.result),this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.Qdb?this.Qdb.result:null)).ha();this.W.register(Ak,"Common.App.SaveToSharePoint.SaveToSharePointActor").Ud(()=>new Ak(l.AFrameworkApplication.K,l.AFrameworkApplication.va,this.W.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),
this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>l.AFrameworkApplication.ua.rTk)).ha();l.AFrameworkApplication.K.$("SaveToAnotherFolderBrsIsEnabled")&&this.W.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Tb()}static main(){M.a.instance.Gc(new Xi)}}Object(e.a)(Xi,"PackageManager",null,[1,2]);class Zk{}Object(e.a)(Zk,
"StringDifference",null,[1964]);class ne{constructor(J,ma){this.charCode=J;this.description=ma}}Object(e.a)(ne,"UBTableEntry",null,[]);class $k{}new ne(8,"C0 Controls 1");new ne(9,"Horizontal tab (HT)");new ne(10,"Line feed (LF)");new ne(12,"C0 Controls 2");new ne(13,"Carriage return (CR)");new ne(31,"C0 Controls 3");new ne(32,"Space");new ne(47,"ASCII Punctuation and Symbols 1");new ne(57,"ASCII Digits");new ne(64,"ASCII Punctuation and Symbols 2");new ne(90,"Uppercase Latin Alphabet");new ne(96,
"ASCII Punctuation and Symbols 3");new ne(122,"Lowercase Latin Alphabet");new ne(127,"U+0000..U+007F Basic Latin");new ne(159,"C1 Controls");new ne(160,"NB Space");new ne(191,"Latin-1 Punctuation and Symbols");new ne(255,"U+0080..U+00FF Latin-1 Supplement");new ne(383,"U+0100..U+017F Latin Extended-A");new ne(591,"U+0180..U+024F Latin Extended-B");new ne(687,"U+0250..U+02AF IPA Extensions");new ne(767,"U+02B0..U+02FF Spacing Modifier Letters");new ne(879,"U+0300..U+036F Combining Diacritical Marks");
new ne(1023,"U+0370..U+03FF Greek and Coptic");new ne(1279,"U+0400..U+04FF Cyrillic");new ne(1327,"U+0500..U+052F Cyrillic Supplement");new ne(1423,"U+0530..U+058F Armenian");new ne(1535,"U+0590..U+05FF Hebrew");new ne(1791,"U+0600..U+06FF Arabic");new ne(1871,"U+0700..U+074F Syriac");new ne(1919,"U+0750..U+077F Arabic Supplement");new ne(1983,"U+0780..U+07BF Thaana");new ne(2047,"U+07C0..U+07FF NKo");new ne(2111,"U+0800..U+083F Samaritan");new ne(2143,"U+0840..U+085F Mandaic");new ne(2303,"U+08A0..U+08FF Arabic Extended-A");
new ne(2431,"U+0900..U+097F Devanagari");new ne(2559,"U+0980..U+09FF Bengali");new ne(2687,"U+0A00..U+0A7F Gurmukhi");new ne(2815,"U+0A80..U+0AFF Gujarati");new ne(2943,"U+0B00..U+0B7F Oriya");new ne(3071,"U+0B80..U+0BFF Tamil");new ne(3199,"U+0C00..U+0C7F Telugu");new ne(3327,"U+0C80..U+0CFF Kannada");new ne(3455,"U+0D00..U+0D7F Malayalam");new ne(3583,"U+0D80..U+0DFF Sinhala");new ne(3711,"U+0E00..U+0E7F Thai");new ne(3839,"U+0E80..U+0EFF Lao");new ne(4095,"U+0F00..U+0FFF Tibetan");new ne(4255,
"U+1000..U+109F Myanmar");new ne(4351,"U+10A0..U+10FF Georgian");new ne(4607,"U+1100..U+11FF Hangul Jamo");new ne(4991,"U+1200..U+137F Ethiopic");new ne(5023,"U+1380..U+139F Ethiopic Supplement");new ne(5119,"U+13A0..U+13FF Cherokee");new ne(5759,"U+1400..U+167F Unified Canadian Aboriginal Syllabics");new ne(5791,"U+1680..U+169F Ogham");new ne(5887,"U+16A0..U+16FF Runic");new ne(5919,"U+1700..U+171F Tagalog");new ne(5951,"U+1720..U+173F Hanunoo");new ne(5983,"U+1740..U+175F Buhid");new ne(6015,"U+1760..U+177F Tagbanwa");
new ne(6143,"U+1780..U+17FF Khmer");new ne(6319,"U+1800..U+18AF Mongolian");new ne(6399,"U+18B0..U+18FF Unified Canadian Aboriginal Syllabics Extended");new ne(6479,"U+1900..U+194F Limbu");new ne(6527,"U+1950..U+197F Tai Le");new ne(6623,"U+1980..U+19DF New Tai Lue");new ne(6655,"U+19E0..U+19FF Khmer Symbols");new ne(6687,"U+1A00..U+1A1F Buginese");new ne(6831,"U+1A20..U+1AAF Tai Tham");new ne(7039,"U+1B00..U+1B7F Balinese");new ne(7103,"U+1B80..U+1BBF Sundanese");new ne(7167,"U+1BC0..U+1BFF Batak");
new ne(7247,"U+1C00..U+1C4F Lepcha");new ne(7295,"U+1C50..U+1C7F Ol Chiki");new ne(7375,"U+1CC0..U+1CCF Sundanese Supplement");new ne(7423,"U+1CD0..U+1CFF Vedic Extensions");new ne(7551,"U+1D00..U+1D7F Phonetic Extensions");new ne(7615,"U+1D80..U+1DBF Phonetic Extensions Supplement");new ne(7679,"U+1DC0..U+1DFF Combining Diacritical Marks Supplement");new ne(7935,"U+1E00..U+1EFF Latin Extended Additional");new ne(8191,"U+1F00..U+1FFF Greek Extended");new ne(8303,"U+2000..U+206F General Punctuation");
new ne(8351,"U+2070..U+209F Superscripts and Subscripts");new ne(8399,"U+20A0..U+20CF Currency Symbols");new ne(8447,"U+20D0..U+20FF Combining Diacritical Marks for Symbols");new ne(8527,"U+2100..U+214F Letterlike Symbols");new ne(8591,"U+2150..U+218F Number Forms");new ne(8703,"U+2190..U+21FF Arrows");new ne(8959,"U+2200..U+22FF Mathematical Operators");new ne(9215,"U+2300..U+23FF Miscellaneous Technical");new ne(9279,"U+2400..U+243F Control Pictures");new ne(9311,"U+2440..U+245F Optical Character Recognition");
new ne(9471,"U+2460..U+24FF Enclosed Alphanumerics");new ne(9599,"U+2500..U+257F Box Drawing");new ne(9631,"U+2580..U+259F Block Elements");new ne(9727,"U+25A0..U+25FF Geometric Shapes");new ne(9983,"U+2600..U+26FF Miscellaneous Symbols");new ne(10175,"U+2700..U+27BF Dingbats");new ne(10223,"U+27C0..U+27EF Miscellaneous Mathematical Symbols-A");new ne(10239,"U+27F0..U+27FF Supplemental Arrows-A");new ne(10495,"U+2800..U+28FF Braille Patterns");new ne(10623,"U+2900..U+297F Supplemental Arrows-B");
new ne(10751,"U+2980..U+29FF Miscellaneous Mathematical Symbols-B");new ne(11007,"U+2A00..U+2AFF Supplemental Mathematical Operators");new ne(11263,"U+2B00..U+2BFF Miscellaneous Symbols and Arrows");new ne(11359,"U+2C00..U+2C5F Glagolitic");new ne(11391,"U+2C60..U+2C7F Latin Extended-C");new ne(11519,"U+2C80..U+2CFF Coptic");new ne(11567,"U+2D00..U+2D2F Georgian Supplement");new ne(11647,"U+2D30..U+2D7F Tifinagh");new ne(11743,"U+2D80..U+2DDF Ethiopic Extended");new ne(11775,"U+2DE0..U+2DFF Cyrillic Extended-A");
new ne(11903,"U+2E00..U+2E7F Supplemental Punctuation");new ne(12031,"U+2E80..U+2EFF CJK Radicals Supplement");new ne(12255,"U+2F00..U+2FDF Kangxi Radicals");new ne(12287,"U+2FF0..U+2FFF Ideographic Description Characters");new ne(12351,"U+3000..U+303F CJK Symbols and Punctuation");new ne(12447,"U+3040..U+309F Hiragana");new ne(12543,"U+30A0..U+30FF Katakana");new ne(12591,"U+3100..U+312F Bopomofo");new ne(12687,"U+3130..U+318F Hangul Compatibility Jamo");new ne(12703,"U+3190..U+319F Kanbun");new ne(12735,
"U+31A0..U+31BF Bopomofo Extended");new ne(12783,"U+31C0..U+31EF CJK Strokes");new ne(12799,"U+31F0..U+31FF Katakana Phonetic Extensions");new ne(13055,"U+3200..U+32FF Enclosed CJK Letters and Months");new ne(13311,"U+3300..U+33FF CJK Compatibility");new ne(19903,"U+3400..U+4DBF CJK Unified Ideographs Extension A");new ne(19967,"U+4DC0..U+4DFF Yijing Hexagram Symbols");new ne(40959,"U+4E00..U+9FFF CJK Unified Ideographs");new ne(42127,"U+A000..U+A48F Yi Syllables");new ne(42191,"U+A490..U+A4CF Yi Radicals");
new ne(42239,"U+A4D0..U+A4FF Lisu");new ne(42559,"U+A500..U+A63F Vai");new ne(42655,"U+A640..U+A69F Cyrillic Extended-B");new ne(42751,"U+A6A0..U+A6FF Bamum");new ne(42783,"U+A700..U+A71F Modifier Tone Letters");new ne(43007,"U+A720..U+A7FF Latin Extended-D");new ne(43055,"U+A800..U+A82F Syloti Nagri");new ne(43071,"U+A830..U+A83F Common Indic Number Forms");new ne(43135,"U+A840..U+A87F Phags-pa");new ne(43231,"U+A880..U+A8DF Saurashtra");new ne(43263,"U+A8E0..U+A8FF Devanagari Extended");new ne(43311,
"U+A900..U+A92F Kayah Li");new ne(43359,"U+A930..U+A95F Rejang");new ne(43391,"U+A960..U+A97F Hangul Jamo Extended-A");new ne(43487,"U+A980..U+A9DF Javanese");new ne(43615,"U+AA00..U+AA5F Cham");new ne(43647,"U+AA60..U+AA7F Myanmar Extended-A");new ne(43743,"U+AA80..U+AADF Tai Viet");new ne(43775,"U+AAE0..U+AAFF Meetei Mayek Extensions");new ne(43823,"U+AB00..U+AB2F Ethiopic Extended-A");new ne(44031,"U+ABC0..U+ABFF Meetei Mayek");new ne(55215,"U+AC00..U+D7AF Hangul Syllables");new ne(55295,"U+D7B0..U+D7FF Hangul Jamo Extended-B");
new ne(56191,"U+D800..U+DB7F High Surrogates");new ne(56319,"U+DB80..U+DBFF High Private Use Surrogates");new ne(57343,"U+DC00..U+DFFF Low Surrogates");new ne(63743,"U+E000..U+F8FF Private Use Area");new ne(64255,"U+F900..U+FAFF CJK Compatibility Ideographs");new ne(64335,"U+FB00..U+FB4F Alphabetic Presentation Forms");new ne(65023,"U+FB50..U+FDFF Arabic Presentation Forms-A");new ne(65039,"U+FE00..U+FE0F Variation Selectors");new ne(65055,"U+FE10..U+FE1F Vertical Forms");new ne(65071,"U+FE20..U+FE2F Combining Half Marks");
new ne(65103,"U+FE30..U+FE4F CJK Compatibility Forms");new ne(65135,"U+FE50..U+FE6F Small Form Variants");new ne(65279,"U+FE70..U+FEFF Arabic Presentation Forms-B");new ne(65519,"U+FF00..U+FFEF Halfwidth and fullwidth forms");new ne(65535,"U+FFF0..U+FFFF Specials");new ne(65663,"U+10000..U+1007F Linear B Syllabary");new ne(65791,"U+10080..U+100FF Linear B Ideograms");new ne(65855,"U+10100..U+1013F Aegean Numbers");new ne(65935,"U+10140..U+1018F Ancient Greek Numbers");new ne(65999,"U+10190..U+101CF Ancient Symbols");
new ne(66047,"U+101D0..U+101FF Phaistos Disc");new ne(66207,"U+10280..U+1029F Lycian");new ne(66271,"U+102A0..U+102DF Carian");new ne(66351,"U+10300..U+1032F Old Italic");new ne(66383,"U+10330..U+1034F Gothic");new ne(66463,"U+10380..U+1039F Ugaritic");new ne(66527,"U+103A0..U+103DF Old Persian");new ne(66639,"U+10400..U+1044F Deseret");new ne(66687,"U+10450..U+1047F Shavian");new ne(66735,"U+10480..U+104AF Osmanya");new ne(67647,"U+10800..U+1083F Cypriot Syllabary");new ne(67679,"U+10840..U+1085F Imperial Aramaic");
new ne(67871,"U+10900..U+1091F Phoenician");new ne(67903,"U+10920..U+1093F Lydian");new ne(67999,"U+10980..U+1099F Meroitic Hieroglyphs");new ne(68095,"U+109A0..U+109FF Meoritic Cursive");new ne(68191,"U+10A00..U+10A5F Kharoshthi");new ne(68223,"U+10A60..U+10A7F Old South Arabian");new ne(68415,"U+10B00..U+10B3F Avestan");new ne(68447,"U+10B40..U+10B5F Inscriptional Parthian");new ne(68479,"U+10B60..U+10B7F Inscriptional Pahlavi");new ne(68687,"U+10C00..U+10C4F Old Turkic");new ne(69247,"U+10E60..U+10E7F Rumi Numeral Symbols");
new ne(69759,"U+11000..U+1107F Brahmi");new ne(69839,"U+11080..U+110CF Kaithi");new ne(69887,"U+110D0..U+110FF Sora Sompeng");new ne(69967,"U+11100..U+1114F Chakma");new ne(70111,"U+11180..U+111DF Sharada");new ne(71375,"U+11680..U+116CF Takri");new ne(74751,"U+12000..U+123FF Cuneiform");new ne(74879,"U+12400..U+1247F Cuneiform Numbers and Punctuation");new ne(78895,"U+13000..U+1342F Egyptian Hieroglyphs");new ne(92735,"U+16800..U+16A3F Bamum Supplement");new ne(94111,"U+16F00..U+16F9F Miao");new ne(110847,
"U+1B000..U+1B0FF Kana Supplement");new ne(119039,"U+1D000..U+1D0FF Byzantine Musical Symbols");new ne(119295,"U+1D100..U+1D1FF Musical Symbols");new ne(119375,"U+1D200..U+1D24F Ancient Greek Musical Notation");new ne(119647,"U+1D300..U+1D35F Tai Xuan Jing Symbols");new ne(119679,"U+1D360..U+1D37F Counting Rod Numerals");new ne(120831,"U+1D400..U+1D7FF Mathematical Alphanumeric Symbols");new ne(126719,"U+1EE00..U+1EEFF Arabic Mathematical Alphabetic Symbols");new ne(127023,"U+1F000..U+1F02F Mahjong Tiles");
new ne(127135,"U+1F030..U+1F09F Domino Tiles");new ne(127231,"U+1F0A0..U+1F0FF Playing Cards");new ne(127487,"U+1F100..U+1F1FF Enclosed Alphanumeric Supplement");new ne(127743,"U+1F200..U+1F2FF Enclosed Ideographic Supplement");new ne(128511,"U+1F300..U+1F5FF Miscellaneous Symbols and Pictographs");new ne(128591,"U+1F600..U+1F64F Emoticons");new ne(128767,"U+1F680..U+1F6FF Transport and Map Symbols");new ne(128895,"U+1F700..U+1F77F Alchemical Symbols");new ne(173791,"U+20000..U+2A6DF CJK Unified Ideographs Extension B");
new ne(177983,"U+2A700..U+2B73F CJK Unified Ideographs Extension C");new ne(178207,"U+2B740..U+2B81F CJK Unified Ideographs Extension D");new ne(195103,"U+2F800..U+2FA1F CJK Compatibility Ideographs Supplement");new ne(917631,"U+E0000..U+E007F Tags");new ne(917999,"U+E0100..U+E01EF Variation Selectors Supplement");new ne(1048575,"U+F0000..U+FFFFF Supplementary Private Use Area-A");new ne(1114111,"U+100000..U+10FFFF Supplementary Private Use Area-B");Object(e.a)($k,"UnicodeBlocks",null,[1966]);class wf{constructor(){this.W=
null}wc(J){this.W=J;this.W.register(Zk,"Common.App.SensitiveLogging.StringDifference").as("Common.App.SensitiveLogging.IStringDifference").ha();this.W.register($k,"Common.App.SensitiveLogging.UnicodeBlocks").as("Common.App.SensitiveLogging.IUnicodeBlocks").ha()}get name(){return"Common.App.SensitiveLogging"}init(){this.W.resolve("Common.App.SensitiveLogging.IStringDifference");this.W.resolve("Common.App.SensitiveLogging.IUnicodeBlocks")}dispose(){}static main(){M.a.instance.Gc(new wf)}}Object(e.a)(wf,
"SensitiveLoggingPackage",null,[1,2]);var wj;(function(J){J[J.myFiles=0]="myFiles";J[J.recent=1]="recent";J[J.currentFolder=2]="currentFolder";J[J.yourPhone=3]="yourPhone"})(wj||(wj={}));Object(e.b)("SharedFilePickerLandingLocation",wj);class Pe{constructor(J){this.aIb=this.Cic=null;this._initialized=!1;this.cAf=J}Nhb(J){this._initialized||(J.Fv(Bd.a.X7i),J.eC(Bd.a.X7i,Object(a.a)(this,this.Psn,"onReceivedPickerResponse")),this._initialized=!0)}MRd(J){return this.aIb=new Promise((ma,Ta)=>{const pb=
{};pb[$c.a.eDn]=J;this.Cic=(Wb,Jc)=>{""===Jc?(za.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),ma(Wb)):("Canceled"===Jc?za.ULS.sendTraceTag(572548164,306,50,Jc):za.ULS.sendTraceTag(556901065,306,10,Jc),Ta(Jc))};this.cAf.execute(Wb=>{this.Nhb(Wb);Wb.sendMessage(Bd.a.yxn,pb)})})}Psn(J){this.Cic(J.Values[$c.a.bdo],void 0===J.Values[$c.a.T0f]||null===J.Values[$c.a.T0f]?"":J.Values[$c.a.T0f])}WHf(){return l.AFrameworkApplication.K.$("UiHostCommonFilePicker")}lbf(J,ma,Ta,pb,Wb,
Jc,Zc,jd,dd=null){const Ld={};Ld[$c.a.Cco]=J;Ld[$c.a.titleText]=ma;Ld[$c.a.XBk]=Ta;Ld[$c.a.YBk]=pb;Ld[$c.a.$Bk]=Wb;Ld[$c.a.$pl]=!0;Ld[$c.a.HCl]=Jc;Ld[$c.a.iDn]=Zc;Ld[$c.a.hDn]=wj[jd];F.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(Ld[$c.a.jDn]="Dark");dd&&(null!=dd.X2b&&(Ld[$c.a.X2b]=dd.X2b),null!=dd.ubc&&(Ld[$c.a.ubc]=dd.ubc));return Ld}}Object(e.a)(Pe,"SharedFilePickerManager",null,[2008]);class Kg{constructor(){this.W=null}get name(){return"Common.App.SharedFilePicker"}wc(J){this.W=
J;J.register(Pe,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").ha().Ud(()=>new Pe(J.Ta("Postmessage.IHostPostmessenger")))}init(){l.AFrameworkApplication.K.Nn(()=>{this.K3a()})}K3a(){this.W.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){M.a.instance.Gc(new Kg)}}Object(e.a)(Kg,"SharedFilePickerPackage",null,[1,2]);class em extends Sys.EventArgs{constructor(){super()}}Object(e.a)(em,"TypingSpeedMeterChangedEventArgs",
Sys.EventArgs,[]);class jl{}Object(e.a)(jl,"TypingSpeedMeterWindow",null,[]);class io{constructor(J,ma){new S.a;this.cA=J;this.ti=ma;this.ti.j0e(Object(a.a)(this,this.$6d,"onCpuMeterFrameAvailable"))}$6d(){}dispose(){this.ti.Pbj(Object(a.a)(this,this.$6d,"onCpuMeterFrameAvailable"))}}Object(e.a)(io,"TypingSpeedMeter",null,[1983]);class Mf{constructor(J){this.Lzd=null;this.jq=new z.a;this.cA=J}initialize(J,ma,Ta,pb){this.Lzd||(this.Lzd=new io(this.cA,J,ma,Ta,pb),this.jq.Dg(this.Lzd));return this.Lzd}}
Object(e.a)(Mf,"TypingSpeedMeterProvider",null,[1963]);class nk{constructor(){this.WWe=null}get name(){return"Common.App.TypingSpeedMeter"}init(){if(l.AFrameworkApplication.K.$("TypingSpeedMeterIsEnabled")){const J=pa.a.instance.resolve("Common.App.TypingSpeedMeter.TypingSpeedMeterProvider"),ma=gh.a.Gp(pa.a.instance.Ta("Common.ICpuMeterProvider"));ma.continueWith(()=>{const Ta=ma.result.jq.task;var pb=new fa.a(l.AFrameworkApplication.K.mc("TypingSpeedMeterWindowSamplingPercent",0)/100);pb=new xa.a(Object(a.a)(pb,
pb.PQb,"shouldBeInSample"));const Wb=Da.a.mF(12,1,pb),Jc=l.AFrameworkApplication.K.mc("TypingSpeedMeterWindowTimeoutMs",5E3),Zc=l.AFrameworkApplication.K.mc("TypingSpeedMeterMaxKeystrokesPerWindow",5);Ta.CWR(()=>this.WWe=J.initialize(Ta.result,Wb,Jc,Zc))})}}dispose(){this.WWe&&this.WWe.dispose()}wc(J){J.register(Mf,"Common.App.TypingSpeedMeter.TypingSpeedMeterProvider").as("Common.ITypingSpeedMeterProvider").ha().Ud(()=>new Mf(qa.a.$e))}static main(){M.a.instance.Gc(new nk)}}Object(e.a)(nk,"TypingSpeedMeterPackage",
null,[1,2]);class mj{constructor(){this.events=[];this.T9f=!1}static JJf(J){return J.ctrlKey&&"Control"!==J.key||J.altKey&&"Alt"!==J.key||!!mj.kZm[J.key]}static nOk(J,ma){let Ta;Ta=mj.JJf(J)?J.key:" "===J.key?"Space":"CharacterKey";return null!=ma?(ma.altPressed=(!!J.altKey).toString(),ma.ctrlPressed=(!!J.ctrlKey).toString(),ma.key=Ta,ma.repeat=(!!J.repeat).toString(),ma.shiftPressed=(!!J.shiftKey).toString(),ma):{["altPressed"]:(!!J.altKey).toString(),["ctrlPressed"]:(!!J.ctrlKey).toString(),["key"]:Ta,
["repeat"]:(!!J.repeat).toString(),["shiftPressed"]:(!!J.shiftKey).toString()}}static uBi(J){return window.performance&&window.performance.now&&J.timeStamp<performance.now()}static FYh(J){return!!J&&mj.uBi(J)&&mj.JJf(J)}static GYh(J){return!!J&&mj.uBi(J)&&!mj.JJf(J)}keyPressedEventHandlerStart(J,ma){mj.GYh(J)&&this.Rvj(J,ma)}keyPressedEventHandlerEnd(J){mj.GYh(J)&&this.wwj(J)}keyDownEventHandlerStart(J,ma){mj.FYh(J)&&this.Rvj(J,ma)}keyDownEventHandlerEnd(J){mj.FYh(J)&&this.wwj(J)}Rvj(J,ma){J={["metadata"]:mj.nOk(J,
ma),["timeStamp"]:this.moc(J.timeStamp),["timeToHandlerFinishMs"]:0,["timeToHandlerStartMs"]:this.moc(performance.now()-J.timeStamp),["eventDurationMs"]:0,["timeToRequestAnimationFrameMs"]:0};this.events.push(J);this.OXn()}wwj(J){if(0!==this.events.length){var ma=this.moc(J.timeStamp);for(let Ta=this.events.length-1;0<=Ta;--Ta){const pb=this.events[Ta];if(pb.timeStamp===ma){pb.timeToHandlerFinishMs=this.moc(performance.now()-J.timeStamp);pb.eventDurationMs=this.moc(pb.timeToHandlerFinishMs-pb.timeToHandlerStartMs);
break}}}}moc(J){return Number(J.toFixed(2))}OXn(){if(!this.T9f){const J=document.createEvent("CustomEvent");J.initCustomEvent("aggregateeventtimingstart",!1,!1,null);dispatchEvent(J);requestAnimationFrame(()=>{this.T9f=!1;const ma=performance.now();this.events.forEach(pb=>{pb.timeToRequestAnimationFrameMs=this.moc(ma-pb.timeStamp)});var Ta=document.createEvent("CustomEvent");Ta.initCustomEvent("aggregateeventtiming",!1,!1,this.events.slice(0));dispatchEvent(Ta);this.events=[];Ta=document.createEvent("CustomEvent");
Ta.initCustomEvent("aggregateeventtimingstop",!1,!1,null);dispatchEvent(Ta)});this.T9f=!0}}}mj.kZm={["ArrowDown"]:!0,["ArrowLeft"]:!0,["ArrowRight"]:!0,["ArrowUp"]:!0,["Backspace"]:!0,["Delete"]:!0,["End"]:!0,["Enter"]:!0,["Escape"]:!0,["Home"]:!0,["PageDown"]:!0,["PageUp"]:!0,["Tab"]:!0};class Rf{constructor(){this.pee=this.J5a=this.$Ra=this.Lfc=null;this.$dc=!1;this.Cjc=null;this.ZOc=[];this.Cdd=()=>{Rf.RRm()&&null==this.J5a?(this.$Ra=null,this.J5a=requestAnimationFrame(this.t0c)):null!=this.J5a&&
(cancelAnimationFrame(this.J5a),this.J5a=null)};this.t0c=J=>{if(null!=this.$Ra){const ma=J-this.$Ra;if(null==this.Lfc||this.Lfc<ma)this.Lfc=ma;for(let Ta=0;Ta<Rf.ranges.length;++Ta)if(ma<Rf.ranges[Ta]){++this.ZOc[Ta];break}}this.$Ra=J;this.J5a=requestAnimationFrame(this.t0c)};this.xdj=()=>{if(null!=this.Lfc){var J={};for(var ma=0;ma<Rf.ranges.length;++ma)J[Rf.ranges[ma]]=this.ZOc[ma],this.ZOc[ma]=0;ma=performance.now();J={["intervalStart"]:this.Cjc,["intervalEnd"]:ma,["maxFrameLengthMs"]:this.Lfc,
["frameData"]:J};var Ta=document.createEvent("CustomEvent");Ta.initCustomEvent("reportframetiming",!1,!1,J);dispatchEvent(Ta);this.Lfc=null;this.Cjc=ma}}}static ZGf(){return!!window.performance&&!!window.performance.now}start(J){!this.$dc&&Rf.ZGf()&&(this.$po(),this.pee=setInterval(this.xdj,1E3*J),this.Cjc=performance.now(),this.Cdd(),document.addEventListener("visibilitychange",this.Cdd),this.$dc=!0)}stop(){this.$dc&&(document.removeEventListener("visibilitychange",this.Cdd),null!=this.pee&&(clearInterval(this.pee),
this.pee=null),null!=this.J5a&&(cancelAnimationFrame(this.J5a),this.J5a=null),this.xdj(),this.$dc=!1)}get eYc(){return this.$dc}$po(){this.ZOc=[];for(let J=0;J<Rf.ranges.length;++J)this.ZOc.push(0)}}Rf.RRm=()=>"visible"===document.visibilityState;Rf.ranges=[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];class sg{create(J){return new fa.a(J)}}Object(e.a)(sg,"RandomSamplerFactory",null,[872]);var db=c(10),Lb=c(1430);class kc{constructor(J,ma,Ta,pb,Wb){J.rrh(()=>{pb.p7c()});J.zrh((Jc,
Zc)=>{pb.n7c(Zc.revisionId,Zc.e6a)});J.nCd((Jc,Zc)=>{pb.hym(Zc.Ffj,Zc.e6a,Zc.Lzj)});J.oyk(()=>{pb.I9f()});ma.Pyk((Jc,Zc)=>{pb.CKo(Zc.jdj,Zc.eme,Zc.actualValue)});ma.zxk((Jc,Zc)=>{pb.BKo(Zc.jdj,Zc.eme,Zc.actualValue)});Wb.dGc(()=>{pb.hdd()});Ta.T3((Jc,Zc)=>{6===Zc.type&&pb.hkc(Zc.NL)})}}Object(e.a)(kc,"EventForwarder",null,[]);class Kc{constructor(J,ma,Ta){this.qck=J;this.QN=Ta;this.e1b=ma}create(J,ma){return new kc(this.qck,this.e1b,J,ma,this.QN)}}Object(e.a)(Kc,"EventForwarderFactory",null,[]);var Qc=
c(443);class md{}md.eRo="TypingToOutboundReplicationStart";md.eyn="OutboundReplicationStartToOutboundReplicationEnd";md.Agj="RtcNotificationToInboundReplicationEnd";md.JDj="TypingToInboundReplicationEnd";Object(e.a)(md,"PerfTrackerPhases",null,[]);class Hd{constructor(J,ma,Ta,pb,Wb,Jc,Zc,jd,dd=null){this.Z5g=!1;this.bMe=5;this.z7g=50;this.DKe=20;this.eJe=this.nKe=this.HAa=null;this.ktc=this.atc=0;this.dUe=this.mVe=!1;this.Kyd=Array(7);this.tqc=null;this.iYg=!1;this.Tve=null;this.rja={};this.Znd=J;
this.TWa=ma;this.Sak=Ta;this.g_g=pb.create(md.Agj,Wb,Jc,20,!1);this.Mzd=pb.create(md.JDj,Zc,jd,20,!0);if(this.Ca=l.AFrameworkApplication.K)this.Z5g=this.Ca.$("LogSteppedInboundFrameIsEnabled"),this.DKe=this.Ca.mc("InboundFrameMaxNumberOfLongRunningTasks",20),this.z7g=this.Ca.mc("InboundFrameMinLengthForLongRunningTasksInMs",50),this.bMe=this.Ca.mc("InboundFrameNumberOfLastShortTasks",5);this.Ctb=dd}get BWk(){null==this.Tve&&(this.Tve=!!this.Ca&&this.Ca.$("InboundRequestTakesTooLongToSendAfterRTCTelemetryIsEnabled"));
return this.Tve}initialize(J){this.HAa=J}H4n(J,ma,Ta=null){this.DEh();za.ULS.shipAssertTag(8229761,324,0<J.length);let pb=!1;for(const Jc of J){const Zc=Jc.toString();if(Zc in this.rja){var Wb=this.rja[Zc];if(!Wb.Pkc){Wb.dkj(J,ma,Ta);if(pb)this.yLi(Jc.toString(),Wb,null,null,this.Kyd,null);else{const jd=this.SAl(),dd=this.MLl(this.tqc);pb=!0;this.yLi(Jc.toString(),Wb,jd,this.eJe,this.Kyd,dd)}delete this.rja[Zc]}}else Wb=this.Znd.create(this.g_g,this.Mzd),Wb.dkj(J,ma),this.rja[Zc]=Wb}this.dUe=!1}hkc(J){za.ULS.shipAssertTag(8257930,
304,J.LEi,"Expected data not sent on the wire");if(J.LEi){if(J.Tee in this.rja){var ma=this.rja[J.Tee];ma.ffe||(ma.hkc(J.revisionId,J.v_i,J.irj,J.e6a),delete this.rja[J.Tee])}else ma=this.Znd.create(this.g_g,this.Mzd),ma.hkc(J.revisionId,J.v_i,J.irj,J.e6a),this.rja[J.Tee]=ma;this.DEh()}}Xzm(){this.mVe||(this.nKe=Array(this.DKe),this.eJe=Array(this.bMe),this.ktc=this.atc=0,this.Kyd=[0,0,0,0,0,0,0,0],this.tqc=Array(3),this.tqc[1]=[0,0],this.tqc[2]=[0,0],this.mVe=!0)}Wto(J){return!J.TP&&J.TN===ea.a.edj&&
(J=Qc.a(this.rja))&&J[0]?!0:!1}nnn(J){this.mVe=!1;const ma=Qc.a(this.rja);ma&&ma[0]&&(J.TRT>=this.z7g&&this.atc<this.DKe?this.nKe[this.atc++]=J:(this.eJe[this.ktc]=J,this.ktc=this.ktc<this.bMe-1?this.ktc+1:0),this.S7m(J),this.h8m(J))}mnn(){this.Xzm();this.dUe=!0}S7m(J){this.Kyd[J.TP]++}h8m(J){if(J&&J.UI){const ma=this.tqc[J.UI];ma[0]+=1;ma[1]+=J.TRT}}MLl(J){const ma={};J&&(J[1]&&(ma.Typing=J[1]),J[2]&&(ma.Clicking=J[2]));return ma}SAl(){return this.atc?this.nKe.slice(0,this.atc-1):null}DEh(){var J=
Qc.a(this.rja);if(J&&(this.iYg||this.F8m(J),J.length>this.Sak))for(const ma of J){J=this.rja[ma];const Ta=J.createdTime,pb=this.TWa();6E4<pb-Ta&&(K.b(8438528,304,50,"{0}",{["Not Received"]:J.Pkc?"RtcNotification":"ServerRevision",["Duration"]:pb-Ta}),J.Pkc||K.b(42075798,304,15,"{0}",{["RevisionId"]:ma,["Duration"]:pb-Ta}),delete this.rja[ma])}}F8m(J){if(this.BWk&&this.Ctb)for(const ma of J)if(J=this.rja[ma],J.ffe&&!J.Pkc&&(J=J.createdTime,2E3<this.TWa()-J)){let Ta=null;db.App.za&&db.App.za.jb&&db.App.za.jb.Zc&&
(Ta=db.App.za.jb.Zc.contentReplicator);this.Ctb.execute(pb=>{pb.flush(Ta,1)});this.iYg=!0}}yLi(J,ma,Ta,pb,Wb,Jc){this.Z5g&&(ma=ma.uLl())&&(ma.RevisionId=J,ma.LRTWR=Ta,ma.LSTWR=pb,ma.TSD=Wb,ma.UIWR=Jc,this.HAa&&this.HAa.track(ma))}}Object(e.a)(Hd,"InboundMonitor",null,[2047]);class Ne{constructor(J,ma,Ta,pb){this.yD=ma;this.Znd=Ta;this.Qmk=pb}create(J,ma,Ta,pb,Wb=null){return new Hd(this.Znd,this.yD,50,this.Qmk,J,ma,Ta,pb,Wb)}}Object(e.a)(Ne,"InboundMonitorFactory",null,[2021]);var Cc=c(375);class oe{}
oe.cpe="UserCount";oe.a9n="RevisionChainLength";Object(e.a)(oe,"PerfTrackerPivotNames",null,[]);class gc{}Object(e.a)(gc,"PerfTrackingContext",null,[]);const eh=J=>5>=J?"5AndFewer":10>=J?"6To10":15>=J?"11To15":20>=J?"15To20":25>=J?"21To25":30>=J?"26To30":"31AndAbove";class nj{}Object(e.a)(nj,"SteppedInboundFrame",null,[]);class vi{constructor(J,ma,Ta,pb,Wb){this.Ycb=this.aod=null;this.c_g=500;this.$nd=this.nta=this.Rvb=this.QXb=this.ggd=-1;this.hwg=null;this.Lfh=this.Eeh=!1;this.ieh=null;this.Z$g=
this.HMa=0;this.a_b=J;this.createdTime=ma();this.jxd=!1;this.qNe=0;this.vxb=Ta;this.V6j=pb;this.Mzd=Wb;l.AFrameworkApplication.K&&(this.c_g=l.AFrameworkApplication.K.mc("InboundFrameSamplingMinimalTotalTimeMs",500))}get ffe(){return this.Eeh}get Pkc(){return this.Lfh}get Gfj(){return this.ieh}get e6a(){return this.HMa}get dyn(){return this.Z$g}get oEb(){return this.vxb()}hkc(J,ma,Ta,pb){this.ffe||(this.jxd=Ta,this.qNe=ma,this.ggd=Y.a.wV(qa.a.$e(),2),this.hwg=(new Date).toISOString(),this.Ycb=J,this.Z$g=
pb,this.Eeh=!0,this.Pkc?this.hXh():(this.Svj(),va.a.instance.vz(J.toString()+"Start"),Cc.a.instance.k4d(2)))}dkj(J,ma,Ta=null){this.Pkc||(this.HMa=ma,this.Lfh=!0,this.ieh=J,this.$nd=Y.a.wV(qa.a.$e(),2),this.ffe&&(va.a.instance.vz(this.Ycb.toString()+"End"),Ta&&(this.QXb=Ta.P5n,this.Rvb=Ta.n7a,this.nta=Ta.I4n),Cc.a.instance.nGd(),this.hXh()))}uLl(){if(!(0<this.ggd&&0<this.QXb&&0<this.Rvb&&0<this.nta&&0<this.$nd))return null;const J=new nj;J.TT=Y.a.wV(this.$nd-this.ggd,2);if(J.TT<this.c_g)return null;
J.ST=this.hwg;J.UC=this.oEb;J.RS=Y.a.wV(this.QXb-this.ggd,2);J.SR=Y.a.wV(this.Rvb-this.QXb,2);J.RRS=Y.a.wV(this.nta-this.Rvb,2);J.RP=Y.a.wV(this.$nd-this.nta,2);J.ResponseLanded=Y.a.wV(this.Rvb,2);0<J.RS?(va.a.instance.OY("RTCToRequestSent",this.Ycb.toString()+"Start","RequestInvoked"+this.QXb),va.a.instance.OY("RequestSentToResponseReceived","RequestInvoked"+this.QXb,"RequestCompleted"+this.Rvb),va.a.instance.OY("ResponseReceivedToReplicationStart","RequestCompleted"+this.Rvb,"ReplicationStart"+
this.nta)):va.a.instance.OY("RTCToReplicationStart",this.Ycb.toString()+"Start","ReplicationStart"+this.nta);va.a.instance.OY("Replication","ReplicationStart"+this.nta,this.Ycb.toString()+"End");return J}Svj(){this.aod=this.a_b.create();this.aod.start(md.Agj,md.JDj)}hXh(){this.aod||this.Svj();const J=this.aod.end(this.jxd,this.Adl());this.V6j.nee(J);this.Mzd.nee(J+this.qNe)}Adl(){const J={};J[oe.cpe]=eh(this.oEb);var ma=this.Gfj.length;J[oe.a9n]=9>=ma?ma.toString():"10AndAbove";return Object.assign(new gc,
{P:J,FC:this.e6a,CFC:this.dyn+this.e6a,ID:this.Ycb.toString(),CD:this.qNe,UC:this.oEb,RCL:this.Gfj.length})}}Object(e.a)(vi,"InboundOperation",null,[2046]);class ge{constructor(J,ma,Ta){this.tLa=J;this.TWa=ma;this.vxb=Ta}create(J,ma){return new vi(this.tLa,this.TWa,this.vxb,J,ma)}}Object(e.a)(ge,"InboundOperationFactory",null,[2020]);class wg{constructor(J,ma,Ta,pb,Wb,Jc,Zc,jd,dd){this.kxd=!0;this.Zah=this.Utd=null;this.qN=Ld=>{this.kj.qN(6,Ld)};this.pNe=J;this.d2j=ma;this.kfk=Ta;this.kj=pb;this.XWe=
Wb.create("TypingToOutboundReplicationStart",Jc,Zc,20,!1);this.uQe=Wb.create("OutboundReplicationStartToOutboundReplicationEnd",jd,dd,20,!1)}get z0f(){return this.Utd}get H$d(){return this.Zah}hdd(){!this.z0f&&this.kxd&&(this.kxd=this.d2j())&&(this.Utd=this.pNe.create(this.qN,this.kfk(),this.XWe,this.uQe),this.z0f.hdd())}p7c(){this.kxd=!0;this.Zah=this.z0f;this.H$d&&(this.Utd=null,this.H$d.p7c())}I9f(){this.Utd=null}n7c(J,ma){this.H$d&&this.H$d.n7c(J,ma)}}Object(e.a)(wg,"OutboundMonitor",null,[]);
class $f{constructor(J,ma){this.pNe=J;this.fek=ma}create(J,ma,Ta,pb,Wb,Jc,Zc){return new wg(this.pNe,J,ma,Ta,this.fek,pb,Wb,Jc,Zc)}}Object(e.a)($f,"OutboundMonitorFactory",null,[]);var di=c(60);class ah{constructor(J){this.ldb=J}get yPn(){return this.ldb}nb(J){return!!this.ldb&&J in this.ldb}get LEi(){return this.nb(ah.lMd)&&this.nb(ah.zPb)&&this.nb(ah.Agg)}get revisionId(){if(this.nb(ah.zPb))return di.a.If(this.ldb[ah.zPb]);throw Error.create("Unable to parse RevisionIdKey key from dictionary into string");
}get Tee(){if(this.nb(ah.zPb))return this.ldb[ah.zPb];throw Error.create("Unable to cast RevisionIdKey key from dictionary into string");}get v_i(){if(this.nb(ah.lMd))return Number.parseInvariant(this.ldb[ah.lMd]);throw Error.create("Unable to parse DurationKey key from dictionary into int");}get irj(){if(this.nb(ah.zPb))return Boolean.parse(this.ldb[ah.Agg]);throw Error.create("Unable to parse ShouldSample key from dictionary into bool");}get e6a(){if(this.nb(ah.uUf))return Number.parseInvariant(this.ldb[ah.uUf]);
throw Error.create("Unable to parse NumSequentailFailuresKey key from dictionary into int");}static Oal(J){return new ah(J)}static Tal(J,ma,Ta,pb){const Wb={};Wb[ah.lMd]=J.toString();Wb[ah.zPb]=ma.toString();Wb[ah.Agg]=Ta.toString();Wb[ah.uUf]=pb.toString();return new ah(Wb)}}ah.zPb="RevisionID";ah.lMd="Duration";ah.Agg="ShouldSample";ah.uUf="NumSequentialFailures";Object(e.a)(ah,"ReplicationNotificationMessage",null,[2043]);class Zj{constructor(J,ma,Ta,pb,Wb,Jc,Zc){this.ys=this.ki=0;this.Kxb=this.HEc=
null;this.Xse=[];this.$bh=null;this.jld={};this.HMa=0;this.a_b=J;this.Mik=ma;this.TWa=Ta;this.vxb=pb;this.Igh=Wb;this.Ycb=null;this.jld.TypingStartStage=null;this.jld.ReplicationStartStage="TypingStartStage";this.jld.ReplicationEndStage="ReplicationStartStage";this.llh=1<this.oEb;this.XWe=Jc;this.uQe=Zc}get oEb(){return this.vxb()}hdd(){this.I7e("TypingStartStage")&&(this.y6f("TypingStartStage"),za.ULS.shipAssertTag(8257931,324,!this.Kxb&&!this.ys,"ReplicationStart or ReplicationEnd were calledbefore TypingStart"),
this.ki=this.TWa(),this.HEc=this.a_b.create(),this.Ivj(this.HEc,md.eRo))}p7c(){if(this.I7e("ReplicationStartStage")){this.y6f("ReplicationStartStage");za.ULS.shipAssertTag(8257932,324,!!this.HEc,"TypingStart not called");if(this.HEc){const J=this.dXh(this.HEc,this.Ycb);this.XWe.nee(J)}this.Kxb=this.a_b.create();this.Ivj(this.Kxb,md.eyn)}}n7c(J,ma){this.I7e("ReplicationEndStage")&&(this.y6f("ReplicationEndStage"),this.ys=this.TWa(),this.HMa=ma,za.ULS.shipAssertTag(8257933,324,!!this.Kxb,"ReplicationStart not called"),
this.Kxb&&(za.ULS.shipAssertTag(8193425,324,!!this.Kxb,"ReplicationStart not called"),ma=this.dXh(this.Kxb,J),this.uQe.nee(ma)),za.ULS.shipAssertTag(8257934,324,!!this.ki,"StartTime not set. No message sent to other editors."),this.ki&&(J=ah.Tal(this.ys-this.ki,J,this.Igh,this.HMa),this.Mik(J.yPn)))}I7e(J){if(this.jld[J]===this.$bh)return!0;za.ULS.shipAssertTag(8422940,324,!1,"{0}",{["Previous stage mismatch"]:this.Lqk()});return!1}Lqk(){const J=new Sys.StringBuilder;J.append("Actual Phase:");for(let ma=
0;ma<this.Xse.length;ma++)J.append(" "+this.Xse[ma]);return J.toString()}y6f(J){this.Xse.push(J);this.$bh=J}Ivj(J,ma){this.llh&&J.start(ma)}dXh(J,ma){if(!this.llh)return-1;const Ta={};Ta[oe.cpe]=eh(this.oEb);ma=Object.assign(new gc,{P:Ta,FC:this.HMa,CFC:0,ID:ma?ma.toString():"",CD:0,UC:this.oEb,RCL:0});return J.end(this.Igh,ma)}}Object(e.a)(Zj,"OutboundOperation",null,[2045]);class ng{constructor(J,ma,Ta){this.a_b=J;this.TWa=ma;this.vxb=Ta}create(J,ma,Ta,pb){return new Zj(this.a_b,J,this.TWa,this.vxb,
ma,Ta,pb)}}Object(e.a)(ng,"OutboundOperationFactory",null,[2019]);class Xo{constructor(J,ma){this.YPg=this._name=this.B3=null;this.je=J;this.HAa=ma}start(J,ma=null){this.B3=this.je.Zf("UserAction",J);this._name=J;this.YPg=ma}end(J,ma){let Ta=-1;J&&(Ta=this.B3.oi,ma.D=Ta,ma.CN=this.YPg,ma.CD+=Ta,this.HAa.track(ma,this._name));return Ta}}Object(e.a)(Xo,"PerfTracker",null,[2044]);class Mh{constructor(J,ma){this.je=J;this.HAa=ma}create(){return new Xo(this.je,this.HAa)}}Object(e.a)(Mh,"PerfTrackerFactory",
null,[2018]);class Ca{constructor(J,ma,Ta){this.CAc=null;this.eek=J;this.f_g=ma;this.xch=Ta}init(J,ma,Ta,pb,Wb,Jc,Zc){ma=this.xch.create(ma/100);Ta=this.xch.create(Ta/100);this.CAc=this.eek.create(Object(a.a)(ma,ma.PQb,"shouldBeInSample"),Object(a.a)(Ta,Ta.PQb,"shouldBeInSample"),J,pb,Wb,Jc,Zc)}hdd(){this.CAc.hdd()}p7c(){this.CAc.p7c()}I9f(){this.CAc.I9f()}n7c(J,ma){this.CAc.n7c(J,ma)}hym(J,ma,Ta=null){this.f_g.H4n(J,ma,Ta)}hkc(J){J=ah.Oal(J);this.f_g.hkc(J);va.a.instance.vz(J.revisionId+"Start")}CKo(J,
ma,Ta){K.b(9041820,304,50,"ReplicationTelemetry KPI Threshold Exceeded: [{0}]",this.jJd(J,ma,Ta))}BKo(J,ma,Ta){K.b(9041821,304,50,"ReplicationTelemetry KPI Average Threshold Exceeded: [{0}]",this.jJd(J,ma,Ta))}jJd(J,ma,Ta){const pb={};pb.PhaseName=J;pb.ThresholdValue=ma;pb.ActualValue=Ta;return pb}}Object(e.a)(Ca,"ReplicationTelemetryManager",null,[]);var zb=c(955);class pc extends zb.a{constructor(J,ma){super(J,ma);this.ak=this.iyd=0}aza(J){this.iyd+=J;this.ak++}getValue(){return this.ak?this.iyd/
this.ak:0}VTa(){this.ak=this.iyd=0}}Object(e.a)(pc,"AverageMetric",zb.a,[]);class Dc extends zb.a{constructor(J,ma){super(J,ma);this.x7=0}aza(J){J>this.x7&&(this.x7=J)}getValue(){return this.x7}VTa(){this.x7=0}}Object(e.a)(Dc,"MaxMetric",zb.a,[]);var dc=c(1904);class he extends zb.a{constructor(J,ma,Ta=100){super(J,ma);this.qrd=this.AZb=this.Q0b=0;this.Yvd=Ta;this.kRe=new dc.a(this.Yvd)}aza(J){if(this.AZb===this.Yvd){const ma=this.kRe.dequeue();this.Q0b-=ma;this.AZb--}this.kRe.enqueue(J);this.Q0b+=
J;this.AZb++;J=this.Q0b/this.AZb;J>this.qrd&&this.AZb===this.Yvd&&(this.qrd=J)}getValue(){return this.qrd}VTa(){this.qrd=0;this.kRe=new dc.a(this.Yvd);this.AZb=this.Q0b=0}}Object(e.a)(he,"MaxRollingAverageMetric",zb.a,[]);class Rc extends zb.a{constructor(J,ma){super(J,ma);this.ak=0}aza(){this.ak++}getValue(){return this.ak}VTa(){this.ak=0}}Object(e.a)(Rc,"CounterMetric",zb.a,[]);class qe{constructor(J,ma){this.T1b=ma;this.sue=new pc(J+"-AverageValue","Milliseconds");this.BKe=new Dc(J+"-MaxValue",
"Milliseconds");this.IKe=new he(J+"-MaxRollingAverageValue","Milliseconds");this.Cxe=new Rc(J+"-NumberOfEvents","Count");this.Lta=new lb.a(J+"-SlowPercentileAtValue","Percentile",l.AFrameworkApplication.K.uU("CoAuthLatencySlowTargetValue",3E3),l.AFrameworkApplication.K.uU("CoAuthLatencySlowThresholdPercentile",95),this.T1b);this.wOe=new lb.a(J+"-BrokenSlowPercentileAtValue","Percentile",l.AFrameworkApplication.K.uU("CoAuthLatencyBrokenSlowTargetValue",5E3),l.AFrameworkApplication.K.uU("CoAuthLatencyBrokenSlowThresholdPercentile",
95),this.T1b)}w1(J){this.sue.aza(J);this.BKe.aza(J);this.IKe.aza(J);this.Cxe.aza(J);this.Lta.aza(J);this.wOe.aza(J)}Vce(){this.sue.zTa();this.BKe.zTa();this.IKe.zTa();this.Cxe.zTa();this.Lta.zTa();this.wOe.zTa();this.sue.VTa();this.BKe.VTa();this.IKe.VTa();this.Cxe.VTa();this.Lta.VTa();this.wOe.VTa()}}Object(e.a)(qe,"ReplicationLatencyMetrics",null,[]);class bf{constructor(){this.sJe=new Yb.a}K8i(J,ma,Ta){if(!(0>ma)){if(!({value:pb}=this.sJe.Fc(J,pb)).returnValue){var pb=new qe(J,Ta);this.sJe.Z(J,
pb)}pb.w1(ma)}}Vce(){for(const J of this.sJe.values)J.Vce()}}Object(e.a)(bf,"ReplicationTelemetryMetricsManager",null,[1958]);class Cf{K8i(){}Vce(){}}Object(e.a)(Cf,"ReplicationTelemetryMetricsManagerStub",null,[1958]);class bh{constructor(J,ma,Ta,pb,Wb,Jc,Zc){this.WZa=this.wzd=0;this.rbk=J;this.zOe=Ta;this.qjh=pb;this.HMg=Wb;this.e1b=ma;this.sbk=Jc;this.T1b=Zc}nee(J){this.rbk.K8i(this.zOe,J,this.T1b);J>this.qjh&&this.e1b.jKo(this.zOe,this.qjh,J);this.wzd+=J;this.WZa++;this.wzd/this.WZa>this.HMg&&
this.WZa>this.sbk&&this.e1b.tJk(this.zOe,this.HMg,this.wzd/this.WZa)}}Object(e.a)(bh,"TimeSpanVerifier",null,[1981]);class Lg{constructor(J,ma){this.qhk=J;this.e1b=ma}create(J,ma,Ta,pb,Wb){return new bh(this.qhk,this.e1b,J,ma,Ta,pb,Wb)}}Object(e.a)(Lg,"TimeSpanVerifierFactory",null,[1957]);class Th extends Sys.EventArgs{constructor(J,ma,Ta){super();this.jdj=J;this.eme=ma;this.actualValue=Ta}}Object(e.a)(Th,"TimeSpanVerifierEventArgs",Sys.EventArgs,[]);class ak{constructor(){this.sa=new S.a}jKo(J,
ma,Ta){this.sa.raiseEvent("TSVTE",new Th(J,ma,Ta))}tJk(J,ma,Ta){this.sa.raiseEvent("TSVATE",new Th(J,ma,Ta))}Pyk(J){this.sa.addHandler("TSVTE",J)}zxk(J){this.sa.addHandler("TSVATE",J)}}Object(e.a)(ak,"TimeSpanVerifierNotifier",null,[1956]);class Ih{constructor(){this.W=this.Ca=null}get name(){return"Box4.ReplicationTelemetry"}wc(J){this.Ca=J.resolve("Common.IAppSettingsManager");this.W=J;if(this.Ca.$("Box4ReplicationTelemetryIsEnabled")){J.ia("ReplicationTelemetry.IPerfTrackerFactory",()=>new Mh(db.App.za.Lq,
Da.a.mF(20,1,new Pa.a))).ha();J.ia("ReplicationTelemetry.ITimeSpanVerifierNotifier",()=>new ak).ha();this.Ca.$("Box4ReplicationTelemetryMetricsIsEnabled")?J.ia("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new bf).ha():J.ia("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new Cf).ha();J.ia("ReplicationTelemetry.ITimeSpanVerifierFactory",()=>new Lg(J.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager"),J.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"))).ha();
J.ia("ReplicationTelemetry.OutboundOperationFactory",()=>new ng(J.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),Ih.o9h)).ha();J.ia("ReplicationTelemetry.OutboundMonitorFactory",()=>new $f(J.resolve("ReplicationTelemetry.OutboundOperationFactory"),J.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory"))).ha();J.ia("ReplicationTelemetry.InboundOperationFactory",()=>new ge(J.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),Ih.o9h)).ha();var ma=
new Ne(J.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),J.resolve("ReplicationTelemetry.InboundOperationFactory"),J.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory")),Ta=this.Ca.$("ComponentStateLoggingPackageIsEnabled")?this.W.Ta("Common.IComponentStateLogManager"):null;J.ia("ReplicationTelemetry.IInboundMonitor",()=>ma.create(this.Ca.mc("Box4ReplicationTelemetryInboundOperationThreshold",0),this.Ca.mc("Box4ReplicationTelemetryInboundOperationAverageThreshold",
0),this.Ca.mc("Box4ReplicationTelemetryTypingToInboundEndThreshold",0),this.Ca.mc("Box4ReplicationTelemetryTypingToInboundEndAverageThreshold",0),Ta)).ha();J.ia("Common.IRandomSamplerFactory",()=>new sg).ha();J.ia("ReplicationTelemetry.ReplicationTelemetryManager",()=>new Ca(J.resolve("ReplicationTelemetry.OutboundMonitorFactory"),J.resolve("ReplicationTelemetry.IInboundMonitor"),J.resolve("Common.IRandomSamplerFactory"))).ha();J.ia("ReplicationTelemetry.EventForwarderFactory",()=>new Kc(Lb.a.instance,
J.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"),J.resolve("Box4.ContentEditableViewEventSource")))}}init(){if(this.Ca.$("Box4ReplicationTelemetryIsEnabled")){var J=this.Ca.mc("Box4ReplicationTelemetrySamplePercent",0),ma=this.Ca.mc("Box4ReplicationTelemetryPhaseSamplePercent",0),Ta=this.Ca.mc("Box4ReplicationTelemetryTypingToReplicationStartThreshold",0),pb=this.Ca.mc("Box4ReplicationTelemetryTypingToReplicationStartAverageThreshold",0),Wb=this.Ca.mc("Box4ReplicationTelemetryReplicationStartToReplicationEndThreshold",
0),Jc=this.Ca.mc("Box4ReplicationTelemetryReplicationStartToReplicationEndAverageThreshold",0),Zc=this;this.W.Ta("Box4.Presence.IRtcProxyProvider").execute(dd=>{dd.aE().continueWith(()=>{const Ld=dd.aE().result,$d=Zc.W.resolve("ReplicationTelemetry.ReplicationTelemetryManager");$d.init(Ld,J,ma,Ta,pb,Wb,Jc);Zc.W.resolve("ReplicationTelemetry.EventForwarderFactory").create(Ld,$d);if(Zc.Ca.$("LogSteppedInboundFrameIsEnabled")){const le=gh.a.Gp(Zc.W.Ta("Common.ICpuMeterProvider"));le.continueWith(()=>
{const ae=Zc.W.resolve("ReplicationTelemetry.IInboundMonitor");var Oe=new xa.a(()=>!0);Oe=Da.a.mF(19,1,Oe);ae.initialize(Oe);const ef=le.result.jq.task;ef.continueWith(()=>{ef.result.EBd(0,()=>ae.dUe,oh=>{ae.nnn(oh)});ef.result.EBd(1,oh=>ae.Wto(oh),()=>{ae.mnn()})})})}za.ULS.sendTraceTag(8257935,305,50,"ReplicationTelemetry init")})});var jd=this;l.AFrameworkApplication.qI(()=>{jd.W.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager").Vce()})}}dispose(){}static o9h(){const J=db.App.zd;
return J?J.WVh:0}}Object(e.a)(Ih,"ReplicationTelemetryPackage",null,[1,2]);var xj=c(957),Uh=c(12),ul=c(130),ti=c(3),Vh=c(82),Ad=c(61),Id=c(214),xe=c(17),ke=c(23),Gj=c(8),Ni=c(2075);class Bh{static get Vg(){return k.a.Kx(Bh.Xm,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}Bh.Xm="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";
Object(e.a)(Bh,"InsertSymbolsDialogHtml",null,[]);class Nk extends Ni.a{constructor(J,ma,Ta){super();this.MYb=this.BNa=this.deb=null;this.lFe=0;this.UEm=pb=>{1===pb?(this.gXf("symbol_d_"+Nk.qyc),this.Vb.EL(this.gL,!0),this.Vb.at().hk.gz(this.mH),this.mH.focus()):this.hide()};this.Jxj=pb=>{if(pb.target!==this.MYb){const Wb=this.Vb.at();Wb&&Wb.hk&&(Wb.hk.gz(pb.target),this.MYb=pb.target)}this.hun(pb.target.id)};this.AGo=pb=>{const Wb=pb.yf;if("a"!==Wb.tagName.toLowerCase())return!1;pb.eventName===V.a.vB&&
this.gXf(Wb.id);this.Vb.EL(this.gL,!0);this.Vb.at().hk.gz(Wb);Wb.focus();return!0};this.CGo=pb=>{var Wb=pb.yf;if("a"!==Wb.tagName.toLowerCase())return!1;const Jc=parseInt(Wb.id.substr(Wb.id.lastIndexOf("_")+1));if(pb.Hb.ctrlKey||pb.Hb.altKey||pb.Hb.keyCode>=Fj.a.eUb&&pb.Hb.keyCode<=Fj.a.fUb)return!1;if(pb.eventName===V.a.gi){pb=pb.Hb.keyCode;let Zc=-1;pb===Sys.UI.Key.enter?(this.gXf(Wb.id),this.Vb.EL(this.gL,!0),this.Vb.at().hk.gz(Wb),Wb.focus()):pb===Sys.UI.Key.up?Zc=Jc-15:pb===Sys.UI.Key.down?Zc=
Jc+15:pb===Sys.UI.Key.left?Zc=l.AFrameworkApplication.isRtl?Jc+1:Jc-1:pb===Sys.UI.Key.right&&(Zc=l.AFrameworkApplication.isRtl?Jc-1:Jc+1);0<=Zc&&(Wb=this.ivf("symbol_d_"+Zc))&&Wb.focus()}return!0};this.ga=J;this.Vb=ma;this.eeb=Ta;this.ze(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.ze(0,CommonUIStrings.l_DialogClose);this.Faa=!1;this.Vg=Bh.Vg;this.yg="InsertSymbolsDialog"}dispose(){0<Nk.uWe&&za.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",
this.lFe,Nk.uWe);Nk.tSg++;za.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",Nk.tSg);this.ga=this.eeb=null;super.dispose()}GUa(){this.Uh(Box4Intl.Box4Strings.L_SymbolSingle,this.UEm,null);this.lFe=0;Nk.zSg++;za.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",Nk.zSg);const J=this.ivf("symbol_d_"+Nk.qyc);J&&J.focus()}hide(){var J=document.getElementById("symbolsContainer");if(J&&(J=J.getElementsByTagName("a")))for(let ma=0;ma<J.length;ma++)Q.a.removeHandler(J[ma],
V.a.focus,this.Jxj);super.hide()}get jmb(){return Nk.wyc}set jmb(J){Nk.wyc=J}get emb(){return Nk.jyc}set emb(J){Nk.jyc=J}V9(){super.V9();var J=document.getElementById("symbolsContainer");if(J&&(J.innerHTML=this.eeb.TNk(),J=J.getElementsByTagName("a")))for(let ma=0;ma<J.length;ma++)Q.a.addHandler(J[ma],V.a.focus,this.Jxj)}cna(){const J=document.getElementById("symbolsContainer");J&&(this.deb||(this.deb=this.AGo,this.Qq.ob(V.a.click,J,this.deb),this.Qq.ob(V.a.vB,J,this.deb)),this.BNa||(this.BNa=this.CGo,
this.ge.ob(V.a.gi,J,this.BNa),this.ge.ob(V.a.ru,J,this.BNa),this.ge.ob(V.a.yh,J,this.BNa)));super.cna()}ehb(){const J=document.getElementById("symbolsContainer");J&&(this.deb&&(this.Qq.sc(V.a.click,J,this.deb),this.Qq.sc(V.a.vB,J,this.deb),this.deb=null),this.BNa&&(this.ge.sc(V.a.gi,J,this.BNa),this.ge.sc(V.a.ru,J,this.BNa),this.ge.sc(V.a.yh,J,this.BNa),this.BNa=null));super.ehb()}get gzf(){return!0}hun(J){this.Snj("symbol_d_"+Nk.qyc,!1);Nk.qyc=parseInt(J.substr(J.lastIndexOf("_")+1));this.Snj(J,
!0);if(J=document.getElementById("SymbolNameValueLabel")){const ma=this.GUd(Nk.qyc);J.innerText=ma.altText}}GUd(J){const ma=this.eeb.gle.Ikg.value,Ta=Qc.a(ma);return ma[Ta[J]]}gXf(J){this.lFe++;Nk.uWe++;J=parseInt(J.substr(J.lastIndexOf("_")+1));const ma=this.GUd(J),Ta={};Ta.SourceControlId="symbol_"+J+"_"+ma.ele;this.ga.Qb(ti.a.Ikb,2,Ta);za.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",J)}ivf(J){const ma=document.getElementById("symbolsContainer");return ma?ma.querySelector("#"+
J):null}Snj(J,ma){if(J=this.ivf(J))ma?(J.setAttribute("selected","true"),J.setAttribute("aria-selected","true"),J.tabIndex=0):(J.removeAttribute("selected"),J.setAttribute("aria-selected","false"),J.tabIndex=-1)}}Nk.qyc=0;Nk.wyc=null;Nk.jyc=null;Nk.zSg=0;Nk.tSg=0;Nk.uWe=0;Object(e.a)(Nk,"InsertSymbolsDialog",Ni.a,[]);class Nh{constructor(J,ma,Ta,pb,Wb,Jc,Zc){this.kgm=()=>this.eeb.KOk();this.j6i=(jd,dd,Ld,$d,le)=>{if(1===Ld)return 32;jd=this.eeb.b1i(le);jd=String.format(this.eeb.BGo,jd.character);
le[xj.a.InnerHTML]=jd;le[xj.a.On]=!1;return 32};this.YQa=(jd,dd,Ld,$d,le)=>{if(({ke:jd,selected:Ld,YQa:ef}=this.sLc(dd,Ld)).returnValue)return ef;var ae=xe.SelectionEditor.Ze(Ld);let Oe=!0;Ld=8;var ef=this.Lc.Pc(15);ef.Db(jd.ed);ae||(Ld=this.ga.Nf(dd,ti.a.Qna,2,!0,$d,null),dd=32===Ld,za.ULS.shipAssertTag(6407387,348,dd,"DeleteForReplace did not succeed. Response is {0}",Ld),Oe=dd);Oe&&(dd=jd.mb.qg,ae=xe.SelectionEditor.Ze(dd),za.ULS.shipAssertTag(6407388,348,ae,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",
dd.contextId),Ld=8,ae&&(Ld=this.ga.Nf(dd,ti.a.Ikb,2,!1,$d,le),za.ULS.shipAssertTag(6407389,348,32===Ld,"Insertion at IP context did not succeed. Response is {0}",Ld),32===Ld&&Xf.FocusManager.instance().mg(jd.uJ)));ef.dispose();return Ld};this.TEm=(jd,dd,Ld,$d,le)=>{if(1===Ld)return 32;if(xe.SelectionEditor.d4a(dd))return 2;jd=this.eeb.b1i(le);$d.Hs=jd.index;$d=this.Yc.Rf(dd.node);Ld=$d.zb(11);za.ULS.shipAssertTag(6379466,324,Ld,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",
ul.a[dd.node.type]);Ld=this.Lc.Pc(15);Ld.St($d);Nh.jg.Ge(dd,jd.character,!0,!1);dd=ke.SelectionFactory.ne($d.currentNode,dd.cpBegin+1);this.hb.Ac(dd);Ld.dispose();return 32};this.LNb=(jd,dd,Ld,$d,le)=>{if(1===Ld)return 32;le.MenuItems=this.Alk.value;return 32};this.Kxj=(jd,dd,Ld)=>{({YQa:jd}=this.sLc(dd,Ld));return jd};this.Dsj=(jd,dd,Ld)=>{2===Ld&&(new Nk(this.ga,Xf.FocusManager.instance(),pa.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).GUa();return 32};this.G4f=()=>32;this.ga=J;this.Yc=
ma;this.Alk=new ac.a(this.kgm);this.Lc=Ta;this.eeb=pb;this.Ok=Wb;this.hb=Jc;this.en=Zc}Tb(){this.ga.fb(ti.a.G4f,Uh.a.application,this.G4f,96);this.ga.ra(ti.a.LNb,Uh.a.view,this.LNb);this.ga.ra(ti.a.fle,Uh.a.view,this.Kxj);this.ga.ra(ti.a.cce,Uh.a.view,this.j6i);this.ga.ra(ti.a.Ikb,Uh.a.view,this.YQa);this.ga.ra(ti.a.LNb,Uh.a.Uc,this.LNb);this.ga.ra(ti.a.fle,Uh.a.Uc,this.Kxj);this.ga.ra(ti.a.cce,Uh.a.Uc,this.j6i);this.ga.ra(ti.a.Ikb,Uh.a.Uc,this.TEm);this.ga.Xc(ti.a.LNb,1124);this.ga.Xc(ti.a.fle,1036);
this.ga.Xc(ti.a.cce,1124);this.ga.Xc(ti.a.Ikb,1036);l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&(this.ga.ra(ti.a.jVc,Uh.a.view,this.Dsj),this.ga.ra(ti.a.jVc,Uh.a.Uc,this.Dsj),this.ga.Xc(ti.a.jVc,1124))}sLc(J,ma){let Ta,pb=null;J.view.ue&&(pb=J.view);Ta=null;if(!pb||!pb.mb)return K.b(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",J.toString()),{returnValue:!0,ke:pb,selected:Ta,
YQa:8};Ta=pb.mb.qg;if(!Ta)return{returnValue:!0,ke:pb,selected:Ta,YQa:2};if(this.Ok.$_(Ta)||this.Ok.via(Ta))return{returnValue:!0,ke:pb,selected:Ta,YQa:8};if(pb.mb.ib.LJ||this.en&&this.en.instance&&this.en.instance.SU(Ta)||xe.SelectionEditor.d4a(J.ik))return{returnValue:!0,ke:pb,selected:Ta,YQa:2};if(Nh.ah.xAa(Gj.ParagraphReader.OU,Ta))return J=8,Nh.Ic.Yb(Vh.a.ef,{["Reason"]:Ad.a.AO}),{returnValue:!0,ke:pb,selected:Ta,YQa:J};J=32;return 1===ma?{returnValue:!0,ke:pb,selected:Ta,YQa:J}:{returnValue:!1,
ke:pb,selected:Ta,YQa:J}}static get jg(){return Nh.Md||(Nh.Md=pa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set jg(J){Nh.Md=J}static get ah(){return Id.ContextSetEditor.instance}static get Ic(){return jg.a.instance}}Nh.Md=null;Object(e.a)(Nh,"SymbolsActor",null,[1930]);class Vd{constructor(J,ma){this.ele=J;this.altText=ma}}Object(e.a)(Vd,"Symbol",null,[]);class $p{constructor(){this.VUe=null;this.Cih=new ac.a($p.kcf)}get Ikg(){return this.Cih}wbi(J){this.VUe||(this.VUe=Qc.a(this.Cih.value));
return Array.indexOf(this.VUe,J)}static kcf(){const J={};J["\u2022"]=new Vd("\u2022",Box4Intl.Box4Strings.L_Bullet);J["\u20ac"]=new Vd("\u20ac",Box4Intl.Box4Strings.L_EuroSign);J["\u00a3"]=new Vd("\u00a3",Box4Intl.Box4Strings.L_PoundSign);J["\u00a5"]=new Vd("\u00a5",Box4Intl.Box4Strings.L_YenSign);J["\u00a9"]=new Vd("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);J["\u00ae"]=new Vd("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);J["\u2122"]=new Vd("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);J["\u00b1"]=
new Vd("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);J["\u2260"]=new Vd("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);J["\u2264"]=new Vd("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);J["\u2265"]=new Vd("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);J["\u00f7"]=new Vd("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);J["\u00d7"]=new Vd("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);J["\u221e"]=new Vd("\u221e",Box4Intl.Box4Strings.L_Infinity);J["\u00b5"]=new Vd("\u00b5",Box4Intl.Box4Strings.L_MicroSign);
J["\u03b1"]=new Vd("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);J["\u03b2"]=new Vd("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);J["\u03c0"]=new Vd("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);J["\u03a9"]=new Vd("\u03a9",Box4Intl.Box4Strings.L_OhmSign);J["\u03a3"]=new Vd("\u03a3",Box4Intl.Box4Strings.L_NArySummation);J["\u00b0"]=new Vd("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);J["\u0394"]=new Vd("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);J["\u263a"]=new Vd("\u263a",
Box4Intl.Box4Strings.L_WhiteSmilingFace);J["\u2665"]=new Vd("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);J["\u20b9"]=new Vd("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);J["\u00bf"]=new Vd("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);J["\u00a1"]=new Vd("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);J["\u2014"]=new Vd("\u2014",Box4Intl.Box4Strings.L_EmDash);J["\u2026"]=new Vd("\u2026",Box4Intl.Box4Strings.L_HorizontalEllipsis);J["\u00c0"]=new Vd("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);
J["\u00c1"]=new Vd("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);J["\u00c2"]=new Vd("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);J["\u00c3"]=new Vd("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);J["\u00c4"]=new Vd("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);J["\u00c5"]=new Vd("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);J["\u00c6"]=new Vd("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);J["\u00c7"]=
new Vd("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);J["\u00c8"]=new Vd("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);J["\u00c9"]=new Vd("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);J["\u00ca"]=new Vd("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);J["\u00cb"]=new Vd("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);J["\u00cc"]=new Vd("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);J["\u00cd"]=new Vd("\u00cd",
Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);J["\u00ce"]=new Vd("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);J["\u00cf"]=new Vd("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);J["\u00d1"]=new Vd("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);J["\u00d2"]=new Vd("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);J["\u00d3"]=new Vd("\u00d3",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);J["\u00d4"]=new Vd("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);
J["\u00d5"]=new Vd("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);J["\u00d6"]=new Vd("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);J["\u00d9"]=new Vd("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);J["\u00da"]=new Vd("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);J["\u00db"]=new Vd("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);J["\u00dc"]=new Vd("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);J["\u00df"]=
new Vd("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);J["\u00e0"]=new Vd("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);J["\u00e1"]=new Vd("\u00e1",Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);J["\u00e2"]=new Vd("\u00e2",Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);J["\u00e3"]=new Vd("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);J["\u00e4"]=new Vd("\u00e4",Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);J["\u00e5"]=new Vd("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);
J["\u00e6"]=new Vd("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);J["\u00e7"]=new Vd("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);J["\u00e8"]=new Vd("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);J["\u00e9"]=new Vd("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);J["\u00ea"]=new Vd("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);J["\u00eb"]=new Vd("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);J["\u00ec"]=new Vd("\u00ec",
Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);J["\u00ed"]=new Vd("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);J["\u00ee"]=new Vd("\u00ee",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);J["\u00ef"]=new Vd("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);J["\u00f1"]=new Vd("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);J["\u00f2"]=new Vd("\u00f2",Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);J["\u00f3"]=new Vd("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);
J["\u00f4"]=new Vd("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);J["\u00f5"]=new Vd("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);J["\u00f6"]=new Vd("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);J["\u00f9"]=new Vd("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);J["\u00fa"]=new Vd("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);J["\u00fb"]=new Vd("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);J["\u00fc"]=new Vd("\u00fc",
Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);J["\u00ff"]=new Vd("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);J["\u011e"]=new Vd("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);J["\u011f"]=new Vd("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);J["\u0130"]=new Vd("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);J["\u0131"]=new Vd("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);J["\u0152"]=new Vd("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);
J["\u0153"]=new Vd("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);J["\u015e"]=new Vd("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);J["\u015f"]=new Vd("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);J["\u0178"]=new Vd("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return J}}Object(e.a)($p,"SymbolsLoader",null,[1929]);var kf=c(401),kh=c(340),aq=c(208),cg=c(649),og=c(1496),Tg=c(164),Ue=c(91);class Nb{constructor(J){this.gle=J}get BGo(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}b1i(J){J=
J.SourceControlId.split("_");const ma={};2===J.length?(ma.character=J[1],ma.index=this.gle.wbi(ma.character)):(ma.character=J[2],ma.index=parseInt(J[1]));return ma}KOk(){return this.pii()}build(){return this.lgm()}TNk(){const J=new Sys.StringBuilder;J.append('<table class="moreSymbolsTable">');const ma=this.gle.Ikg.value,Ta=Qc.a(ma);let pb=0;for(;pb<Ta.length;){pb%15||J.append('<tr role="presentation">');const Wb=ma[Ta[pb]];J.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabIndex="-1" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',
"symbol_d_"+pb,Va.a.rY(Wb.ele),Va.a.rY(Wb.altText)));pb++;pb%15&&pb!==Ta.length||J.append("</tr>")}J.append("</table>");return J.toString()}lgm(){const J=this.pii();return Tg.o(J)}pii(){const J=Object.assign(new kf.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});J.MenuSectionList.push(this.Dvk());l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&J.MenuSectionList.push(this.Ltk());return J}Ltk(){const J=Object.assign(new kh.a,{Id:"msMoreSymbols",Title:"",DisplayMode:"Menu16",
ControlsId:"ctrlMoreSymbols",ControlList:[]}),ma=Object.assign(new aq.a,{Id:"btnMoreSymbols",Command:ti.a.jVc.toString(),LabelText:Va.a.zf(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:Va.a.zf(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:l.AFrameworkApplication.Ns,Image16by16Class:Ue.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});J.ControlList.push(ma);return J}Dvk(){const J=Object.assign(new kh.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),
ma=Object.assign(new cg.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),Ta=this.gle.Ikg.value,pb=Qc.a(Ta),Wb=Math.min(25,pb.length);for(let Zc=0;Zc<Wb;Zc++){var Jc=Ta[pb[Zc]];Jc=Object.assign(new og.a,{Id:String.format("{0}{1}_{2}","symbol_",Zc,Jc.ele),Character:Jc.ele,Command:ti.a.Ikb.toString(),QueryCommand:ti.a.cce.toString(),Alt:Va.a.zf(Jc.altText)});ma.GalleryItems.push(Jc)}J.ControlList.push(ma);
return J}}Object(e.a)(Nb,"SymbolsUiBuilder",null,[1926]);var Ll=c(48),Gl=c(237),Wh=c(549),bk=c(372);class wn{constructor(){this.W=null}get name(){return"Box4.Symbols"}init(){l.AFrameworkApplication.K.$("InsertSymbolIsEnabled")&&this.W.resolve("Box4.Symbols.ISymbolsActor").Tb()}dispose(){}wc(J){this.W=J;this.W.register($p,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").ha();this.W.ia("Box4.Symbols.SymbolsUiBuilder",()=>new Nb(this.W.resolve("Box4.Symbols.ISymbolsLoader"))).as("Box4.Symbols.ISymbolsUIBuilder").ha();
this.W.ia("Box4.Symbols.SymbolsActor",()=>new Nh(l.AFrameworkApplication.va,new Wh.a,new bk.a,this.W.resolve("Box4.Symbols.ISymbolsUIBuilder"),Gl.a.instance,Ll.a.instance,this.W.Ta("Box4.IExternalSelectionManager"))).as("Box4.Symbols.ISymbolsActor").ha()}static main(){M.a.instance.Gc(new wn)}}Object(e.a)(wn,"Box4SymbolsPackage",null,[1,2]);var Yo=window.AccCheckerPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AccCheckerTaskPane",
Width:"300",Overflow:"auto"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AccCheckResultsPlaceHolder",IsStretched:"true",MinHeight:"400"}}]}]}]},Vn=c(1655),Fq=c(1608),bq=c(1591),tk=c(1984),ip=c(232),cn=c(402);class $l{constructor(){this.mKa=null}wc(J){this.container=J}init(){this.mKa=this.container.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager")}dispose(){this.mKa&&this.mKa.dispose()}}Object(e.a)($l,"ALiveBooksAccessibilityCheckPackageManager",null,[1,
2]);class sm{get f6k(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get g6k(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get h6k(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get ayn(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get Hhc(){return CommonUIStrings.l_AccCheckerPaneTitle}get DBn(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}Object(e.a)(sm,"AccessibilityCheckStringsProvider",null,[54]);
class Co{constructor(){this.Ggj=this.contentId=null}}Object(e.a)(Co,"ResultIds",null,[]);class hj{constructor(J,ma){this._element=null;this.ig=ma;this.ge=J}get element(){this._element||(this._element=this.bal(),this.Qz());return this._element}mfg(J){this._element=J}dispose(){this.element&&(this.daa(),this.mfg(null))}Qz(){this.ig&&this.ge?(this.ig.ob(V.a.click,this.element,Object(a.a)(this,this.onClick,"onClick")),this.ge.ob(V.a.gi,this.element,Object(a.a)(this,this.XG,"onKeyPress"))):za.ULS.shipAssertTag(19789026,
334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}daa(){this.ig&&this.ge&&(this.ig.sc(V.a.click,this.element,Object(a.a)(this,this.onClick,"onClick")),this.ge.sc(V.a.gi,this.element,Object(a.a)(this,this.XG,"onKeyPress")))}onClick(){this.$Vi();return!0}XG(J){return this.CPm(J.Hb.keyCode)?(this.$Vi(),!0):!1}CPm(J){return J===Fj.a.ipe||J===Fj.a.Ss}}Object(e.a)(hj,"AInteractivePaneElement",null,[726,9]);var Jh=c(449),
Yi=c(56);class th extends hj{constructor(J,ma,Ta){super(J,ma);this.yMe=Ta}hide(){this.element.removeAttribute(kg.a.uh);kg.a.lr(this.element,kg.a.uA,kg.a.xp);this.element.style.display="none"}show(){kg.a.lr(this.element,kg.a.uA,kg.a.xM);kg.a.lr(this.element,kg.a.uh,kg.a.$2e);this.element.style.display="block"}bal(){const J=Jh.b("div",this.lSi,"AccCheckerNotification");kg.a.lr(J,kg.a.Jvh,kg.a.xp);kg.a.lr(J,kg.a.yga,this.dUf);J.tabIndex=0;const ma=Jh.b("span",this.kSi,"AccCheckerNotificationIcon");var Ta=
Ue.createClusteredImage(16,16,"Info_16x16x32","",!0,"");ma.appendChild(Ta);Ta=Jh.b("span",this.dUf,"AccCheckerNotificationText");Yi.a.vv(Ta,this.mSi);J.appendChild(ma);J.appendChild(Ta);return J}$Vi(){this.yMe()}}Object(e.a)(th,"APopupNotification",hj,[725,726,9]);class sb extends th{constructor(J,ma,Ta,pb){super(J,ma,Ta);this.fua=pb}get lSi(){return"AccCheckerOutOfSyncNotificationId"}get kSi(){return"AccCheckerOutOfSyncNotificationIconId"}get dUf(){return"AccCheckerOutOfSyncNotificationTextId"}get mSi(){return this.fua.ayn}}
Object(e.a)(sb,"OutOfSyncNotification",th,[]);class Xb extends th{constructor(J,ma,Ta,pb){super(J,ma,Ta);this.fua=pb}get lSi(){return"AccCheckerPartialResultNotificationId"}get kSi(){return"AccCheckerPartialResultNotificationIconId"}get dUf(){return"AccCheckerPartialResultNotificationTextId"}get mSi(){return this.fua.DBn}}Object(e.a)(Xb,"PartialResultNotification",th,[]);var fd=c(190),Yc=c(31),Ve=c(175);class mf{constructor(J,ma,Ta,pb=null,Wb=null,Jc=null,Zc=null){this.Qdh=this.nM=this.ge=this.mKa=
null;this.T0=pb;this.ig=J;this.Vb=ma;this.lp=Ta;this.fua=Zc||new sm;this.nNe=Wb||new sb(this.T0,this.ig,Object(a.a)(this,this.yol,"dimissOutOfSyncNotification"),this.fua);this.cOe=Jc||new Xb(this.T0,this.ig,Object(a.a)(this,this.zol,"dimissPartialResultNotification"),this.fua)}show(){}hide(){}get T0(){return this.ge||(this.ge=l.AFrameworkApplication.ua.pD)}set T0(J){this.ge=J}PLh(){}$oa(){}dispose(){}j9a(){}aHm(J){var ma=this.Qdh[J];J=ma.contentId;if((ma=ma.Ggj+"")&&ma.length){const Ta=[];Array.add(Ta,
Object.assign(new Yc.a,{name:"RuleID",string:ma}));fd.a.sendTelemetryEvent(Object.assign(new Ve.a,{name:String.format("{0}.{1}",mf.Glg,"ViolationSelected"),dataFields:Ta}))}this.ogn(J)}ogn(J){J&&this.mKa.Pio(J)||(this.Vb.EL(eg.AFrame.Ymh,!1),this.ewo())}yol(){this.W$c(!1)}zol(){this.vsj(!1)}ewo(){const J=Object.assign(new Ng.StandardDialog(!0),{Kt:l.AFrameworkApplication.cda,Cd:1,XIa:!1});J.BV(1);J.ze(1,this.fua.f6k);J.ze(0,CommonUIStrings.l_DialogCancel);J.FV(this.fua.h6k,this.fua.g6k,ma=>{1===ma&&
this.jDf()})}QOk(J){let ma=null;if(J.Results&&0<J.Results.length){ma={};let Ta=0;for(const pb of J.Results)pb.ResultId=mf.Kpk+ ++Ta,J=new Co,J.contentId=pb.ContentId,J.Ggj=pb.RuleId,ma[pb.ResultId]=J}return ma}I7m(){fd.a.addNamespaceMapping(mf.Glg,mf.TIo);fd.a.sendTelemetryEvent(Object.assign(new Ve.a,{name:String.format("{0}.{1}",mf.Glg,"ShowTaskpane")}))}}mf.Kpk="AccCheckResult";mf.Glg="Office.UX.AccChecker";mf.TIo="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";Object(e.a)(mf,
"BaseAccessibilityCheckPane",null,[669,9]);class pg{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(e.a)(pg,"AccCheckerTaskPaneProps",null,[]);var Ze=c(1411),yh=c(1426),Oi=c(1073),Kh=c(182);class ei extends mf{constructor(J,ma,Ta,pb,Wb=null,Jc=null,Zc,jd=null,dd=null){super(ma,
Ta,pb,Jc,void 0,void 0,jd);this.QKg=null;this.Cch=this.bOe=this.etd=this.rwd=this.Mvd=!1;this.uXe=null;this.pVe=!!l.AFrameworkApplication.ua&&!!l.AFrameworkApplication.ua.Kb&&l.AFrameworkApplication.ua.Kb.BIf;this.xvc=this.y6=null;this.hwc=0;this.fnd=null;this.CZ=Wb;dd&&(this.y6=dd.kBd,this.xvc=dd.ljp,this.hwc=dd.Rkp);this.kB=new yh.a}get isVisible(){return this.Cch}CUa(J){this.Cch=J}hgf(J){J&&(this.QKg=J,J.IsSuccess&&(this.Qdh=this.QOk(J),J.IsPartialResult&&this.vsj(!0)),this.Mvd=!0,this.rwd=!1,
this.Mm())}W$c(J){this.isVisible&&J!==this.etd&&(this.etd=J,this.Mm())}vsj(J){this.bOe=J;this.Mm()}WP(){this.rwd||Kh.UISurfaces.Nu().then(J=>{va.a.instance.vz(ei.Isb+":PaneOpen:Start");J.showTaskPane(ei.Isb,this.xA());this.jDf();return null});this.isVisible?Kh.UISurfaces.Nu().then(J=>{J.setSelectedTaskPane(ei.Isb);return null}):this.I7m()}Mm(){Kh.UISurfaces.Nu().then(J=>{J.updateTaskPane(ei.Isb,this.xA());return null})}xA(){var J=new pg;this.kB.$pb(J);J=Object.assign(new Oi.a,{title:this.fua.Hhc,
hideHeader:!1,width:320,location:2,contentProps:J,onOpen:()=>{this.G$();this.CUa(!0);l.AFrameworkApplication.ua.updateCommandUI()},onClose:()=>{this.kea();this.CUa(!1);this.rwd=this.Mvd=!1;this.Mm();l.AFrameworkApplication.ua.updateCommandUI()},isModernPane:!0});this.pVe&&(J.enableResize=!0,J.minResizeWidth=268,J.maxResizeWidth=920);return J}initialize(J){const ma=this.Vb.fe(ei.Isb);ma.parent=eg.AFrame.Ap;ma.eI=!0;this.mKa=J;this.Pqk()}dispose(){this.j9a();this.nNe&&(this.nNe.dispose(),this.nNe=null);
this.cOe&&(this.cOe.dispose(),this.cOe=null);super.dispose()}Pqk(){this.kB.FL(this.onRecheckExecute());this.kB.FL(this.fMl());this.kB.FL(this.Wbm());this.kB.FL(this.onInvokeNavigateExecute());this.kB.FL(this.R_l());this.kB.FL(this.T7l());this.kB.FL(this.N9l());this.kB.FL(this.updateLastScanTime());this.kB.FL(this.showHelpPane())}onRecheckExecute(){return J=>{J.onRecheckExecute=()=>{this.jDf()}}}fMl(){return J=>{J.accessibilityCheckResultCollection=this.QKg}}Wbm(){return J=>{J.resultsReady=this.Mvd}}onInvokeNavigateExecute(){return J=>
{J.onInvokeNavigateExecute=ma=>{this.aHm(ma)}}}R_l(){return J=>{J.helpLink=this.qAl}}T7l(){return J=>{J.outOfSync=this.etd}}N9l(){return J=>{J.partialResult=this.bOe}}updateLastScanTime(){return J=>{J.updateLastScanTime=ma=>{this.uXe=ma}}}showHelpPane(){return J=>{J.showHelpPane=()=>{l.AFrameworkApplication.K&&l.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?l.AFrameworkApplication.cL||this.uvh()?this.fnd?this.fnd():this.y6.value&&this.xvc&&
this.hwc&&this.y6.value.Qb(this.hwc,2,this.xvc):this.wtj():this.uvh()?this.fnd?this.fnd():this.y6.value&&this.xvc&&this.hwc&&this.y6.value.Qb(this.hwc,2,this.xvc):this.wtj()}}}uvh(){return!this.CZ||!this.CZ.value}wtj(){const J=this.CZ.value;if(J){var ma={};ma.query=ei.ugk+ei.P5j;ma=Object.assign(new Ze.a,{aS:ma});J.U5(ei.HDe,ma)}}jDf(){this.bOe=this.etd=this.Mvd=!1;this.uXe&&this.uXe();this.Mm();this.rwd=!0;this.mKa.omn()}G$(){this.Vb.mg(ei.Isb)}kea(){this.X4a()&&this.Vb.mg(this.Vb.gU)}X4a(){return!!this.Vb.currentScope&&
this.Vb.currentScope.name===ei.Isb}}ei.Isb="AccessibilityCheckerPane";ei.P5j="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";ei.HDe="FA000000012";ei.ugk="AssetID=";Object(e.a)(ei,"ReactAccessibilityCheckPane",mf,[]);class lh extends ei{constructor(J,ma,Ta,pb,Wb,Jc,Zc,jd,dd=null){super(J,ma,Ta,pb,Wb,Jc,void 0,dd);this.z2j=jd;this.G3=Zc}get qAl(){return this.z2j}WP(){this.G3.UOa();super.WP()}}Object(e.a)(lh,"ReactLiveBooksAccessibilityCheckPane",ei,[]);var Mc=c(1163),Xg=c(141),fi=c(177),kl=c(62),Gh=c(163),ie=
c(506),Cd;(function(J){J[J.error=0]="error";J[J.warning=1]="warning";J[J.tip=2]="tip";J[J.intelligentService=3]="intelligentService"})(Cd||(Cd={}));Object(e.b)("AccessibilityRuleCategory",Cd);class ik{constructor(J,ma,Ta=null){this.yse=null;this.R1g=this.z0g=!1;this.PNa=J;this.ngd=ma;this.ga=Ta;this.oc.ra(m.a.A_k,y.a.frame,Object(a.a)(this,this.P8e,"closePane"))}get oc(){return this.ga||(this.ga=l.AFrameworkApplication.va)}set oc(J){this.ga=J}vwl(){this.z0g||(this.PNa.initialize(this),this.ngd.initialize(this),
this.z0g=!0)}omn(){K.b(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.ngd.o$n()}WP(J,ma,Ta){if(1===Ta)return Zh.SessionStatusManager.instance.Zj?8:32;this.PNa.isVisible||this.vwl();this.Ixo();return 32}P8e(J,ma,Ta){1!==Ta&&this.PNa.$oa();return 32}ttn(){this.PNa.W$c(!0)}hgf(J){if(J){if(J.AccessibilityRules&&Object.keys(J.AccessibilityRules).length){const Ta=J.AccessibilityRules;for(let pb in Ta){var ma=pb;const Wb=Ta[pb].RuleId+"";ma!==Wb&&K.b(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",
ma,Wb)}this.yse=Ta}else!this.yse&&J.Results&&0<J.Results.length?(K.b(18993251,200,15,"No accessibility rule definitions available"),J.IsSuccess=!1):J.AccessibilityRules=this.yse;J.IsSuccess||K.b(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.P_n(J);this.y7m(J);this.PNa.hgf(J)}}P_n(J){const ma=J.AccessibilityRules;if(J=J.Results)for(let Ta=J.length-1;0<=Ta;Ta--){const pb=J[Ta];let Wb="";const Jc=pb.RuleId;pb.ContentName||(Wb+="Result does not have content name. ");Jc in ma||(Wb+=String.format("No accessibility check rule exists for ID {0}.",
Jc));0<Wb.length&&(K.b(36214999,200,15,"Omitting invalid accessibility check result: "+Wb),Array.removeAt(J,Ta))}}ddm(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("accessibility-checker-pane-strings"):pa.a.instance.resolve("Common.IDynamicScriptLoaderProvider").dA.loadScript("accessibility-checker-pane-strings")}Ixo(){this.R1g?this.PNa.WP():this.ddm().then(()=>{this.R1g=!0;this.PNa.WP()}).catch(J=>za.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",
J))}y7m(J){var ma={};const Ta={};var pb=J.Results,Wb=[];Array.add(Wb,Object.assign(new Yc.a,{name:"FinalViolationCount",int64:0}));Array.add(Wb,Object.assign(new Yc.a,{name:"FinalErrorCount",string:"0"}));Array.add(Wb,Object.assign(new Yc.a,{name:"FinalWarningCount",string:"0"}));Array.add(Wb,Object.assign(new Yc.a,{name:"FinalTipCount",string:"0"}));Array.add(Wb,Object.assign(new Yc.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(pb){for(const jd of pb)if(J.AccessibilityRules){var Jc=J.AccessibilityRules[jd.RuleId];
if(Jc){if(ma[Cd[Jc.Category]]){let dd=ma[Cd[Jc.Category]];ma[Cd[Jc.Category]]=++dd}else ma[Cd[Jc.Category]]=1;Ta[jd.RuleId]?(Jc=Ta[jd.RuleId],Ta[jd.RuleId]=++Jc):Ta[jd.RuleId]=1}}Wb[0].int64=pb.length;for(var Zc in ma)switch(J=ma[Zc],pb=Zc,pb="Final"+pb.charAt(0).toUpperCase()+pb.substring(1,pb.length)+"Count",pb){case "FinalErrorCount":Wb[1].string=J.toString();break;case "FinalWarningCount":Wb[2].string=J.toString();break;case "FinalTipCount":Wb[3].string=J.toString();break;case "FinalIntelligentServiceCount":Wb[4].string=
J.toString()}}fd.a.sendTelemetryEvent(Object.assign(new Ve.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),dataFields:Wb}));for(let jd in Ta)ma=jd,Wb=Ta[jd],Zc=[],Array.add(Zc,Object.assign(new Yc.a,{name:"RuleID",string:ma})),Array.add(Zc,Object.assign(new Yc.a,{name:"FinalViolationCount",string:Wb.toString()})),fd.a.sendTelemetryEvent(Object.assign(new Ve.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:Zc}))}dispose(){this.PNa&&
this.PNa.dispose();this.ngd&&this.ngd.dispose()}}Object(e.a)(ik,"AAccessibilityCheckManager",null,[53,9]);var oj=c(309);const ck=[12,14,22,19,30,43,44];class Bi extends ik{constructor(J,ma,Ta,pb,Wb,Jc){super(ma,Ta,J);this.oc.ra(m.a.Xgg,y.a.frame,this.WP.bind(this));this.oc.fb(m.a.fNn,y.a.frame,this.l6i.bind(this),96);this.graph=Wb;this.Hbk=pb;this.Z8j=Jc;this.ghc=()=>{this.ttn()};this.lXn()}l6i(J,ma,Ta,pb,Wb){if(1===Ta)return 32;Wb[oj.a.On]=this.PNa.isVisible;return 32}Pio(J){if(this.Z8j)return za.ULS.sendTraceTag(20713608,
334,15,"ODT file. Disable content navigation."),!0;za.ULS.shipAssertTag(20272215,334,!!J);return this.Hbk.ign(J)}lXn(){for(const J of ck){const ma=this.graph.Ue(J);ma.Eo(this.ghc);ma.ju(this.ghc);ma.Vw(this.ghc)}}RSo(){for(const J of ck){const ma=this.graph.Ue(J);ma.jS(this.ghc);ma.uV(this.ghc);ma.Lja(this.ghc)}}dispose(){super.dispose();this.RSo()}}Object(e.a)(Bi,"WordAccessibilityCheckManager",ik,[]);var uh=c(76),xg=c(26),Pd=c(101),gi=c(18),hg=c(169),Sl=c(6),hh=c(15),xn=c(473);class ch{constructor(J,
ma,Ta,pb,Wb,Jc,Zc){this.jn=null;this.BDb=0;this.Yc=ma;this.lA=Ta;this.hb=pb;this.ga=Wb;this.ld=Jc;this.gu=J;this.ud=Zc}get dQ(){if(!this.jn){const J=this.Yc.Rf(this.gu.Zc);this.lA.iog(J);if(J.zb(7)||J.jd(7))this.jn=uh.a.Gs(J,J.origin)}return this.jn}ign(J){if(!J||!J.Bg||0>=J.Bg.length)return za.ULS.shipAssertTag(20272217,334,!1,"ContentId is null or invalid."),!1;var ma=Array(J.Bg.length);let Ta=7,pb=null;for(let Jc=0;Jc<J.Bg.length;Jc++)if(pb=this.wEl(J.Bg[Jc])){if(7===Ta)Ta=this.BDb;else if(Ta!==
this.BDb)return za.ULS.shipAssertTag(20272218,334,!1,"Two paragraphs in a range selections don't belong to the same view."),!1;var Wb=this.ud.eTa(pb.characterData,pb.qa);const Zc=J.cpBegin?this.ud.ZCb(Wb,J.cpBegin):-1;Wb=J.cpEnd?this.ud.ZCb(Wb,J.cpEnd):-1;if(-1>Zc||-1>Wb)return za.ULS.shipAssertTag(20272219,334,!1,"Fail to convert WordTextOffset to WAC cp. Reset Cps to -1."),!1;ma[Jc]=xg.a.HO(Zc,Wb,!1,pb);switch(J.contentType){case 5:if(!Pd.a.eTc(ma[Jc],!1))return!1;break;case 6:if(!gi.ImageReader.Q4(ma[Jc]))return!1;
break;case 7:ma[Jc]=xg.a.HO(-1,-1,!1,pb)}}else return!1;ma=new hg.Selection(ma,!1);return this.Kno(pb,ma,J.contentType)}wEl(J){if(this.dQ)for(this.dQ.reset(),this.BDb=7;this.dQ.moveNext();){var ma=this.dQ.currentNode.type;if(38===ma||36===ma||23===ma)this.BDb=ma;else if(12===ma){ma=this.dQ.currentNode;const Ta=ma.ja(Sl.a.Wc,0);if(J===Ta)return ma}}return null}Fkg(J){this.ga.processAction(hh.a.iU,2);this.ga.processAction(hh.a.p4,2);let ma=2;switch(this.BDb){case 23:ma=32;break;case 38:ma=this.ga.Qb(hh.a.m6a,
2,new xn.a(J));break;case 36:ma=this.ga.Qb(hh.a.kmb,2,new xn.a(J));break;default:za.ULS.shipAssertTag(20272220,334,!1,"Unexpected search scope encountered: {0}",this.BDb)}if(32===ma)return!0;za.ULS.shipAssertTag(20272221,334,!1,"Fail to switch to target view: {0}",this.BDb);return!1}Kno(J,ma,Ta){if(this.Fkg(J)){J=this.gu.iu;const pb=this.hb.ib.lb;pb&&pb.equals(ma)&&this.ld.oea(J,null);this.ld.oea(J,ma);switch(Ta){case 0:case 1:this.ga.processAction(ti.a.VPb,2);break;case 2:this.ga.processAction(ti.a.M8c,
2);break;case 3:this.ga.processAction(ti.a.Cza,2)}return!0}return!1}}Object(e.a)(ch,"WordAccessibilityCheckNavigateManager",null,[2025]);class on{constructor(J){this.mKa=null;this.jXg=J}get fileId(){return this.jXg?this.jXg():null}initialize(J){this.mKa=J}nUi(J){this.mKa.hgf(J)}}Object(e.a)(on,"AAccessibilityCheckService",null,[55,9]);class Ml{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(J){J=Sys.Serialization.JavaScriptSerializer.deserialize(J);
const ma=J.AccessibilityRules,Ta={};if(ma)for(let pb=0;pb<ma.length;++pb){const Wb=ma[pb];Ta[Wb.Key]=Wb.Value}J.AccessibilityRules=Ta;return J}}Object(e.a)(Ml,"AccessibilityCheckResultCollection",null,[]);class Ok extends on{constructor(J){super(J);this.onFailure=(ma,Ta)=>{za.ULS.shipAssertTag(20730842,334,!1,"Acc Checker force save failed! StatusCode:{0}",Ta);ma=Object.assign(new Ml,{IsSuccess:!1});this.nUi(ma)};this.onSuccess=ma=>{ma=Ok.Ubm(ma);let Ta=null;if(ma)try{Ta=this.Tll(ma)}catch(pb){za.ULS.shipAssertTag(20730843,
334,!1,"AccChecker response data is invalid. [{0}]",pb.message),Ta=Object.assign(new Ml,{IsSuccess:!1})}else za.ULS.shipAssertTag(20730844,334,!1,"AccChecker response is NULL."),Ta=Object.assign(new Ml,{IsSuccess:!1});this.nUi(Ta)}}dispose(){}static Ubm(J){let ma=null;J&&J.Mj&&(ma=J.Mj[0]);return ma?ma.Body:null}}Object(e.a)(Ok,"ALiveBooksAccessibilityCheckService",on,[]);var sc=c(1008),jp=c(1040),Lp=c(1481),jk=c(233),Zo=c(530);class Pk extends jk.a{constructor(){super();this.FileId=null;this.IsCoauthorable=
!1}nl(){return Zo.a.accCheck}static construct(J,ma){const Ta=new Pk;Ta.FileId=J;Ta.IsCoauthorable=ma;return Ta}}Object(e.a)(Pk,"WordAccessibilityCheckRequest",jk.a,[]);class so{}Object(e.a)(so,"AccessibilityCheckRule",null,[]);var Nd=c(188);class Qk{static parse(J){switch(Va.a.eh(J)){case "warnings":return 1;case "tips":return 2;case "errors":return 0;case "intelligentservices":return 3;default:throw J=String.format("Invalid Accessibility result category: {0}",J),Nd.a.argument(J);}}}Object(e.a)(Qk,
"AccessibilityRuleCategoryParser",null,[]);class No{constructor(){this.Category=this.Text=this.Id=null}static YKo(J){const ma=new so;ma.RuleId=J.Id;ma.RuleName=J.Text;ma.Category=Qk.parse(J.Category);return ma}}Object(e.a)(No,"WordAccessibilityCheckRule",null,[]);class fm{}Object(e.a)(fm,"AccessibilityCheckResult",null,[]);class kp{constructor(){this.cpEnd=this.cpBegin=this.Bg=null;this.contentType=0}}Object(e.a)(kp,"WordAccessibilityCheckContentId",null,[]);const yc=J=>{switch(Va.a.eh(J)){case "tableheading":return 0;
case "tablerow":return 1;case "tablecolumn":return 2;case "table":return 3;case "textcontrast":return 4;case "hyperlink":return 5;case "inlinepicture":return 6;case "anchoredepicture":return 7;default:return 8}};var td=c(1625);class kk{constructor(){this.OE=this.OS=this.ContentType=this.Label=this.RuleId=this.ParaId=null}static WKo(J){const ma=new fm;ma.RuleId=J.RuleId;ma.ContentName=J.Label;const Ta=new kp;Ta.Bg=J.ParaId;Ta.cpBegin=td.b(J.OS);Ta.cpEnd=td.b(J.OE);Ta.contentType=yc(J.ContentType);
ma.ContentId=Ta;return ma}}Object(e.a)(kk,"WordAccessibilityViolation",null,[]);class jo{constructor(){this.Violations=this.Rules=null}static XKo(J){const ma=new Ml;try{var Ta={};if(J.Rules){for(let pb=0;pb<J.Rules.length;++pb){const Wb=No.YKo(J.Rules[pb]);Ta[Wb.RuleId]=Wb}ma.AccessibilityRules=Ta}if(J.Violations){const pb=Array(J.Violations.length);for(Ta=0;Ta<J.Violations.length;++Ta)pb[Ta]=kk.WKo(J.Violations[Ta]);ma.Results=pb}ma.IsPartialResult=!1;ma.IsSuccess=!0}catch(pb){za.ULS.shipAssertTag(20272214,
334,!1,"Failed to convert WordAccessibilityCheckResult to AccessibilityCheckResultCollection. [{0}]",pb.message),ma.IsSuccess=!1}return ma}}Object(e.a)(jo,"WordAccessibilityCheckResult",null,[]);class cq extends Ok{constructor(J,ma,Ta){super(J);this.gvb=ma;this.Tbb=Ta}o$n(){const J=Object.assign(new sc.a,{Jq:Pk.construct(this.fileId,this.Tbb),status:jp.a.requestReady,YG:"AccessibilityCheck"});this.gvb(Lp.a.accChecker,!1,this.onSuccess,this.onFailure,J,null,J)}Tll(J){J=Ja.b(J);return jo.XKo(J)}}Object(e.a)(cq,
"WordAccessibilityCheckService",Ok,[]);class vl extends $l{constructor(){super()}get name(){return"WordEditor.AccessibilityChecker"}wc(J){super.wc(J);J.ia("Common.App.AccessibilityChecker.IAccessibilityCheckPane",()=>new lh(l.AFrameworkApplication.va,ip.a.instance,Xf.FocusManager.instance(),cn.a.instance,J.Ve("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),Me.KeyInputManager.instance,Mc.a.instance,l.AFrameworkApplication.K.kb("AccessibilityCheckerHelpUrl"))).ha();J.ia("Common.App.AccessibilityChecker.IAccessibilityCheckService",
()=>new cq(()=>l.AFrameworkApplication.rootQuerySignature,ie.a.mR,Xg.PageReader.instance.wSd(db.App.za.jb.Zc))).ha();J.ia("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager",()=>new ch(db.App.za.jb,J.resolve("Box4.Graph.IGraphIteratorFactory"),fi.PageNavigator.instance,J.resolve("Box4.ISelectionManager"),l.AFrameworkApplication.va,kl.InteractiveViewManager.instance,J.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"))).ha();J.ia("Common.App.AccessibilityChecker.IAccessibilityCheckManager",
()=>new Bi(l.AFrameworkApplication.va,J.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),J.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),J.resolve("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager"),db.App.si.Il,Gh.App.wXc)).ha()}init(){this.container.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{$l.prototype.init.call(this)})}}Object(e.a)(vl,"WordAccCheckerPackageManager",$l,[]);class Sm{constructor(J,ma){this.xih=!1;this.sOo=()=>
{this.rOo()};this.Wk=J;this.YI=ma}PSa(J){J.E0e(this.sOo)}rOo(){!this.xih&&this.Wk&&(this.Wk.TGa?this.YI?this.YI.execute(J=>{J.logActivity("WordWebToWebActiveCoauth","WebToWebActiveCoauthFloodgateSurveyIsEnabled")}):za.ULS.sendTraceTag(51389134,304,10,"Future ISystemInitiatedFeedback not available"):this.xih=!0)}}Object(e.a)(Sm,"CoauthSurveyManager",null,[1923]);class $o{constructor(){this.gu=this.W=null}get name(){return"WordEditor.CoauthSurveys"}init(){db.App.za&&(this.gu=db.App.za.jb)&&(this.gu.zxa?
this.mka():this.gu.sga(()=>{this.mka()}))}mka(){var J=this.gu.Zc;J&&(J=J.contentReplicator)&&this.W.resolve("WordEditor.CoauthSurveys.CoauthSurveyManager").PSa(J)}dispose(){}wc(J){this.W=J;J.ia("WordEditor.CoauthSurveys.CoauthSurveyManager",()=>new Sm(J.resolve("WordEditor.IWordEditorCoauthManager"),J.Ta("Common.ISystemInitiatedFeedback"))).as("WordEditor.CoauthSurveys.ICoauthSurveyManager").ha()}static main(){l.AFrameworkApplication.K.$("CoauthSurveysPackageIsEnabled")&&M.a.instance.Gc(new $o)}}
Object(e.a)($o,"WordEditorCoauthSurveyManagerPackage",null,[1,2]);var to;(function(J){J[J.graphSpaceReplicatorNotSendingContent=0]="graphSpaceReplicatorNotSendingContent";J[J.inboundRequestTakesTooLongToSendAfterRTC=1]="inboundRequestTakesTooLongToSendAfterRTC";J[J.docxSaveMonitorKickoutElapsed=2]="docxSaveMonitorKickoutElapsed"})(to||(to={}));Object(e.b)("ComponentLoggingScenario",to);var yl=c(1473);class Tm{flush(J,ma){const Ta=this.HVl(J);Ta.LoggingScenario=to[ma];Qc.a(Ta).length?za.ULS.sendTraceTag(594571986,
3013,15,"{0}",Ta):za.ULS.sendTraceTag(594571987,3013,15,"No log returned when component state log manager trying to log with {0}",yl.a[J.z0a])}HVl(J){const ma={};if(!J)return ma;const Ta=new dc.a;for(Ta.enqueue(J);!Ta.isEmpty;){J=Ta.dequeue();const pb=yl.a[J.z0a];try{ma[pb]=J.XC()}catch(Wb){za.ULS.sendTraceTag(594571985,3013,15,"Exception when component state log manager trying to log with {0}, details: {1}",pb.toString(),{["Kind"]:"Exception",["Stack"]:Wb.stack,["Message"]:Wb.message,["FileName"]:Wb.fileName,
["LineNumber"]:Wb.lineNumber})}if((J=J.HHd)&&J.length)for(const Wb of J)!Wb||yl.a[Wb.z0a]in ma||Ta.enqueue(Wb)}return ma}}Object(e.a)(Tm,"ComponentStateLogManager",null,[1924]);class Wn{flush(){}}Object(e.a)(Wn,"NoOpComponentStateLogManager",null,[1924]);class ij{constructor(){this.W=null}get name(){return"WordEditor.ComponentStateLogging"}init(){this.W.resolve("Common.IComponentStateLogManager")}dispose(){}wc(J){this.W=J;l.AFrameworkApplication.K.$("ComponentStateLoggingPackageIsEnabled")?J.ia("WordEditor.ComponentStateLogging.ComponentStateLogManager",
()=>new Tm).as("Common.IComponentStateLogManager").ha():J.ia("WordEditor.ComponentStateLogging.NoOpComponentStateLogManager",()=>new Wn).as("Common.IComponentStateLogManager").ha()}static main(){M.a.instance.Gc(new ij)}}Object(e.a)(ij,"WordEditorComponentStateLoggingPackage",null,[1,2]);var Dh=c(314),yn=c(646),pj=c(778),qg=c(779);class fl{constructor(J,ma=null,Ta=-1,pb=null){this.w_=J;this.Wlh=pb||(()=>ma);this.Tjd=Ta}mj(J,ma,Ta,pb,Wb,Jc,Zc,jd,dd,Ld=null,$d=!1,le=null,ae=null){const Oe=new XMLHttpRequest;
let ef="";Jc="";2===ma?(ef="POST",Ta&&(Jc=Ta)):ef="GET";ma={};this.w_&&(J=Dh.a.MBd(ma,J,Dh.a.sTb,l.AFrameworkApplication.B9a,this.w_));Oe.open(ef,J,!0);this.OOk(ma,J);if(pb)for(let Ff in pb)Oe.setRequestHeader(Ff,Va.a.MB(pb[Ff]));for(let Ff in ma)Oe.setRequestHeader(Ff,ma[Ff]);J=le||this.Tjd;0<J&&(Oe.timeout=J);J=[];Array.add(J,Dh.a.$Q);pb=new Sys.Net.WebRequest;const oh=new pj.a(1,2,pb,J,Wb,Zc,jd,dd,$d,Ld,ae);Oe.onreadystatechange=()=>{this.Msn(Oe,oh)};try{Oe.send(Jc)}catch(Ff){za.ULS.sendTraceTag(24938643,
205,15,"Invoke failed in SimpleClientRequestSender")}return 1}L$b(){return 1}Msn(J,ma){if(this.RWk(J,ma)&&4===J.readyState)if(J.getResponseHeader(Dh.a.sif)&&l.AFrameworkApplication.iNc)l.AFrameworkApplication.iNc();else{var Ta=J.getResponseHeader(Dh.a.P6e);Dh.a.ipg(Ta);this.mZo(J,ma);J.status===Ph.a.Zz?(ma.status=2,ma.rI(new qg.a(ma))):(ma.status=J.status&&J.status!==Ph.a.nPb?J.status===Ph.a.yja?5:3:7,ma.v4(new yn.a(ma)))}}OOk(J,ma){J["X-xhr"]=1;l.AFrameworkApplication.xRa&&(J[Dh.a.o3d]=1);l.AFrameworkApplication.buildVersion&&
(J[Dh.a.ISa]=Va.a.MB(l.AFrameworkApplication.buildVersion));let Ta=null;this.Wlh&&(Ta=this.Wlh());Ta&&(J[Dh.a.Ded]=Ta);l.AFrameworkApplication.canary&&(J[Dh.a.ava]=Va.a.MB(l.AFrameworkApplication.canary),l.AFrameworkApplication.Emb&&za.ULS.sendTraceTag(24938644,205,50,"Canary in request: {0}",J[Dh.a.ava]));l.AFrameworkApplication.accessToken&&(Dh.a.mCb(ma,l.AFrameworkApplication.lX)||(J[Dh.a.sFc]=Va.a.MB(l.AFrameworkApplication.accessToken)),Dh.a.mCb(ma,l.AFrameworkApplication.xba)||(J[Dh.a.tFc]=
l.AFrameworkApplication.Cua.toString()));l.AFrameworkApplication.userType&&(J[Dh.a.epe]=Va.a.MB(l.AFrameworkApplication.userType))}mZo(J,ma){ma.Se=J.status?J.status:Ph.a.nPb;try{ma.se=J.responseText;if(void 0!==ma.YTa&&null!==ma.YTa){ma.Dj={};for(let Ta=0;Ta<ma.YTa.length;++Ta){const pb=ma.YTa[Ta];ma.Dj[pb]=J.getResponseHeader(pb)}}ma.Bie&&(ma.Oja=J.responseText&&J.responseText.length?J.responseXML:null)}catch(Ta){za.ULS.sendTraceTag(24938645,205,10,"OnRequestCompleted: Unable to get ResponseData/XML, Id={0}, Url={1} ResponseAvailable={2}",
ma.id,ma.request.get_url(),4===J.readyState)}}RWk(J,ma){return J?ma?!0:(za.ULS.sendTraceTag(24938648,205,15,"OnRequestCompleted in SimpleClientRequestSender: RequestItem doesn't exist."),!1):(za.ULS.sendTraceTag(24938646,205,15,"OnRequestCompleted in SimpleClientRequestSender: XMLHttpRequest doesn't exist."),!1)}static create(J,ma,Ta){return new fl(J,null,Ta,ma)}}Object(e.a)(fl,"SimpleClientRequestSender",null,[852]);class gm{constructor(J,ma,Ta){this.$f=J;this.Axd=ma;this.Ach=Ta}mj(J,ma,Ta,pb,Wb,
Jc,Zc,jd,dd,Ld=null,$d=!1,le=null,ae=null,Oe=null,ef=null,oh=!1){return this.Ach?this.Axd.mj(J,ma,Ta,pb,Wb,Jc,Zc,jd,dd,Ld,$d,ae,Oe):this.$f.mj(J,ma,Ta,pb,Wb,Jc,Zc,jd,dd,Ld,$d,le,ae,Oe,ef,oh)}L$b(J){return this.Ach?this.Axd.L$b():this.$f.L$b(J)}}Object(e.a)(gm,"ClientRequestAdapter",null,[923]);var nf=c(212),ll=c(257),qf=c(224),Ug=c(1421),On=c(1432),dn=c(2076),la=c(51),cb=c(310),vb=c(741),ec=c(600),xc=c(113),ad=c(578),Zd=c(612),pe;(function(J){J[J.none=0]="none";J[J.getCells=1]="getCells";J[J.hotStoreStatus=
2]="hotStoreStatus";J[J.saveMonitor=3]="saveMonitor";J[J.saveMonitor_LineageTombstone=4]="saveMonitor_LineageTombstone";J[J.kickoutExecutor=5]="kickoutExecutor"})(pe||(pe={}));Object(e.b)("MostRecentRevisionIdOrigin",pe);class Td extends Sys.EventArgs{constructor(J,ma,Ta,pb){super();this.tZc=J;this.httpStatusCode=Ta;this.gI=pb}}Object(e.a)(Td,"UpdatedLastRevisionSaveIdEventArgs",Sys.EventArgs,[]);class Ie{constructor(){this.F7=0}get isEmpty(){return!this.F7}WFc(J){this.F7|=J}aYc(J){return!!(this.F7&
J)}clear(){this.F7=0}dIc(){return!1}}Object(e.a)(Ie,"DocxSaveMonitorRetryAttemptOnce",null,[]);class We{constructor(J,ma=3){this.F7=0;this.Pvd=new Map;this.Yak=J;this.Mhk=ma}get isEmpty(){return!this.F7}WFc(J){this.F7|=J;let ma=this.Pvd.get(J)||0;this.Pvd.set(J,++ma)}aYc(J){return!!(this.F7&J)}clear(){this.F7=0;this.Pvd.clear()}dIc(J){return this.Mhk&J?(this.Pvd.get(J)||0)<this.Yak:!1}}Object(e.a)(We,"DocxSaveMonitorRetryAttemptMany",null,[]);class Vf{static create(J=!1,ma=3,Ta=0){return J?new We(ma,
Ta):new Ie}}Object(e.a)(Vf,"DocxSaveMonitorRetryAttemptFactory",null,[]);class tf extends jk.a{constructor(){super();this.CellId=this.FileId=null}nl(){return Zo.a.getLastSavedRevision}static construct(J){const ma=new tf;ma.FileId=J.Yi().zr;ma.CellId=xc.a(J.Mc.id);return ma}}Object(e.a)(tf,"LastSavedRevisionRequest",jk.a,[]);var yf;(function(J){J[J.Lnp=-1]="noResultYet";J[J.Fup=0]="upToDate";J[J.Hrp=1]="sessionLost";J[J.Pup=2]="userSignedOut";J[J.Kpp=3]="previousRequestPending";J[J.qee=4]="requestFailed";
J[J.isp=5]="shuttingDown";J[J.Wnp=6]="nullResponseData";J[J.Hlp=7]="invalidResponseData";J[J.Uip=8]="failedRevisionLookup";J[J.drp=9]="savedWithinThreshold";J[J.Qnp=10]="notSavedWarning";J[J.$lp=11]="kickoutThreshold";J[J.pup=12]="unknownRevision";J[J.Bgp=13]="contentNotYetLoaded";J[J.sessionExpired=14]="sessionExpired";J[J.canaryError=15]="canaryError";J[J.timeout=16]="timeout";J[J.amp=17]="kickoutThreshold_Offline";J[J.Php=18]="dssSessionDeleted";J[J.Qhp=19]="dssSessionExpired";J[J.Zup=20]="waitingForSessionTokenRefresh";
J[J.Rhp=21]="dssSessionNotFound"})(yf||(yf={}));Object(e.b)("SaveMonitorResult",yf);class lf{constructor(J,ma,Ta,pb,Wb,Jc,Zc,jd,dd,Ld,$d,le,ae,Oe,ef,oh,Ff,si,ui,Gg,Bj,xk,Yg,Kf,wm,dg=null,Bm){this.Azc=0;this.tYb=!1;this.fCc=null;this.iyc=this.gO=-1;this.bPe=null;this.pud=0;this.qud=!1;this.zxb=null;this.hAc=0;this.ORe=this.Cjh=null;this.MS=this.N4g=this.vuc=0;this.nJe=null;this.U1g=!1;this.am=null;this.Bxd=0;this.Agh=!1;this.aeh=0;this.Dgh=!1;this.CFl=()=>{var Nf;za.ULS.sendTraceTag(524871194,lf.$m,
50,"DocxSaveMonitor tick: {0}",{["IsUpToDate"]:this.XU,["AppVisibilityState"]:Ug.a[null===(Nf=this.am)||void 0===Nf?void 0:Nf.MD]});try{if(this.Agh&&this.Ovc){var zh=this.Ovc();za.ULS.sendTraceTag(509367249,lf.$m,50,"Additional Details: {0}",zh)}}catch(Hj){Nf=Ja.c({["Kind"]:"Exception",["Stack"]:Hj.stack,["Message"]:Hj.message,["FileName"]:Hj.fileName,["LineNumber"]:Hj.lineNumber}),za.ULS.sendTraceTag(509367062,lf.$m,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",
Nf)}Nf=this.Hwb;this.Hwb=this.cA();if(this.Oaa())this.kA.event(5),this.stop("session has shut down");else if(this.Sbb===lf.rfj&&this.oAa(this.Uub),zh=this.zXb())if(this.EHe()&&l.AFrameworkApplication.ho("Microsoft.Office.Web.SessionSettings.IWacWordDocxSaveMonitorWaitForTokenRefreshSettings"),this.XU)this.kA.event(0);else if(this.xYb())this.kA.event(1),this.stop("session is lost"),l.AFrameworkApplication.oe("WordKickoutSafetyCheck;WordKickoutSafetyCheckcf"),this.U1g&&!this.DPm()&&(za.ULS.sendTraceTag(554726995,
lf.$m,10,"DocxSaveMonitor: Session lost but not kicked out"),this.fI(la.a.MUh));else if(this.EHe())20!==this.kA.currentState?(this.kA.event(20),this.Cjh=this.cA(),za.ULS.sendTraceTag(593510691,lf.$m,15,"Detected that session is expired. DocxSaveMonitor will wait for {0}ms to see if we can refresh the access token.",this.Djh)):this.cA().getTime()-this.Cjh.getTime()>this.Djh&&(this.kA.event(14),this.Z1d(20,la.a.XLd,"TokenExpired"));else if(this.U9j())if(this.Hwb=Nf,this.tYb)this.kA.event(3),this.cA().getTime()-
this.fCc.getTime()>this.yIe&&(Nf=this.pwe.L$b(this.gO),za.ULS.sendTraceTag(19161610,205,50,"DocxSaveMonitorKickout: Status for presumably pending request {0} is {1}",this.gO,fj.a[Nf]),this.Bvd&&this.Bvd.log(),this.stop("stuck on previousRequestPending"),this.fI());else if(Nf=ec.b(tf.construct(zh)),this.tYb=!0,this.fCc=this.vhk(),this.gO=this.pwe.mj(lf.serviceUrl,2,Nf,{"Content-Type":"application/json; charset=utf-8"},!1,0,this.UWk,this.TWk,null,void 0,void 0,this.xgk,this.uSe,void 0,void 0,!0),0>=
this.gO)this.tYb=!1,za.ULS.sendTraceTag(19161611,205,50,"DocxSaveMonitorKickout: Request {0} was not added to the queue.",this.gO.toString());else{Nf=this.pwe.L$b(this.gO);zh=100;if(Nf&&1!==Nf||this.m_g)zh=50;za.ULS.sendTraceTag(19161612,lf.$m,zh,"DocxSaveMonitor: Sending Request {0}",{["Id"]:this.gO,["Status"]:fj.a[Nf]});this.Bvd&&this.Bvd.start(this.gO)}else this.kA.event(2);else this.kA.event(13)};this.TWk=Nf=>{this.MS=this.RHd+1;let zh=this.tYb=!1,Hj=!1;Nf=Nf.data;Ka.a.fl&&l.AFrameworkApplication.Oia("MultipleRetriesForDocxSaveMonitor_t;MultipleRetriesForDocxSaveMonitor_c");
Nf?(za.ULS.sendTraceTag(22552773,lf.$m,15,"Request failed {0}",{["Status"]:Nf.status,["HttpStatus"]:Nf.Se,["Correlation"]:Nf.Dj?Nf.Dj[Dh.a.$Q]:"",["Id"]:Nf.id,["ConsecutiveErrors"]:this.RHd,["Request.InvokedTime"]:Nf.$H,["Request.EnqueueTime"]:Nf.oPa,["Request.CompletedTime"]:Nf.aU}),Hj=7===Nf.status||13===Nf.status,this.dIc(2)&&Hj?(this.NWa.WFc(2),zh=!0,this.iyc=Nf.Se,this.kA.event(16)):this.dIc(1)&&5===Nf.status?(this.NWa.WFc(1),zh=!0,this.iyc=Nf.Se,this.kA.event(15)):(this.kA.event(4),this.iyc=
Nf.Se)):(this.kA.event(4),za.ULS.sendTraceTag(23425240,lf.$m,15,"RequestFailed and event data is null"));if(!zh&&(this.NWa.clear(),Hj?this.Z1d(17,la.a.usl,"while offline"):this.Z1d(11,la.a.Kgf,"while online")))return;this.oAa(zh?this.NOl(Hj):this.Uub)};this.UWk=Nf=>{this.MS=this.RHd+1;this.tYb=!1;var zh={};this.NWa.clear();if(Nf=Nf.data){var Hj=Nf.Dj?Nf.Dj[Dh.a.$Q]:"";zh.HttpStatus=Nf.Se;zh.Correlation=Hj;zh.Id=Nf.id;za.ULS.sendTraceTag(23425242,lf.$m,this.m_g?50:100,"Request succeeded at the HTTP level {0}",
zh);this.iyc=Nf.Se}else za.ULS.sendTraceTag(23425241,lf.$m,15,"Request succeeded with null response data");if(this.Oaa()||!this.YLd)this.kA.event(5),this.stop("session has shut down");else if(!this.KUm())if(Nf&&Nf.se)if(Nf=this.Tva(Nf.se))if(this.o3.EVa(Nf),Nf.StatusCode)this.NJf(Nf,zh)||this.kA.event(8,zh);else{this.MS=0;this.Hwb=this.cA();this.TQe.clear();zh={["LastSavedRevisionId"]:Nf.LastSavedRevisionId,["LastSavedRevisionSequenceNumber"]:Nf.RevisionSequenceNumber};Nf=xc.b(Nf.LastSavedRevisionId);
this.Wpb(Nf,3);var sp=this.Bpf().store.getRevision(Nf);if(sp){Nf=null;Hj=this.Xib();sp=(sp=sp.o2a(Hj))?sp.id:di.a.nil;let Si=Hj;for(;Si&&!Si.id.equals(sp);)Nf=Si,Si=Si.Fn;this.mqm(Nf,zh,Hj)||this.kA.event(9)}else this.Som()||this.kA.event(12,zh);this.oAa(this.P0b)&&za.ULS.sendTraceTag(22552774,lf.$m,50,"Received response from server -- going back to normal interval")}else this.kA.event(7),this.OJf("invalid response",zh);else this.kA.event(6),this.OJf("null response",zh)};this.i8n=(Nf,zh)=>{Nf={};
Nf.DocxSaveMonitorState=yf[zh.newState];Nf.PreviousState=yf[zh.G2f];Nf.PreviousStateHits=zh.H2f;Nf.PreviousStateTransitionTime=zh.I2f.toISOString();Nf.LastHttpStatus=this.iyc;Nf.LastSuccessTime=this.Hwb.toISOString();this.fCc&&(Nf.LastRequestStartTime=this.fCc.toISOString());Nf.LastSavedRevisionID=this.d5d.toString();Nf.LastSavedRevisionIdOrigin=this.Azc;Nf.LastSavedRevisionIdSetTime=this.ORe?this.ORe.toISOString():null;Nf.IsViable=this.rf.Yxa;Nf.IsNetworkConnected=this.rf.cD;Nf.IsExpired=this.rf.fda;
Nf.HasEmergencyViewModeBeenDeployed=this.rf.Zj;Nf["Navigator.Online"]=window.navigator.onLine;const Hj=zh.wDo;Hj&&lf.UOi(Nf,Hj);zh=zh.newState;switch(zh){case 13:za.ULS.sendTraceTag(5830086,lf.$m,50,"{0}",Nf);break;case 1:za.ULS.sendTraceTag(5884125,lf.$m,50,"{0}",Nf);break;case 0:za.ULS.sendTraceTag(5830087,lf.$m,50,"{0}",Nf);break;case 2:za.ULS.sendTraceTag(5830088,lf.$m,50,"{0}",Nf);break;case 3:za.ULS.sendTraceTag(5830089,lf.$m,50,"{0}",Nf);break;case 4:za.ULS.sendTraceTag(5884126,lf.$m,50,"{0}",
Nf);break;case 5:za.ULS.sendTraceTag(5884127,lf.$m,50,"{0}",Nf);break;case 6:za.ULS.shipAssertTag(5830090,lf.$m,!1,"{0}",Nf);break;case 7:za.ULS.shipAssertTag(5830091,lf.$m,!1,"{0}",Nf);break;case 8:za.ULS.sendTraceTag(5830092,lf.$m,15,"{0}",Nf);break;case 10:za.ULS.sendTraceTag(5830094,lf.$m,15,"{0}",Nf);break;case 9:za.ULS.sendTraceTag(5884128,lf.$m,50,"{0}",Nf);break;case 11:za.ULS.sendTraceTag(5830096,lf.$m,15,"{0}",Nf);break;case 17:za.ULS.sendTraceTag(37835678,lf.$m,15,"{0}",Nf);break;case 12:za.ULS.sendTraceTag(5830095,
lf.$m,15,"{0}",Nf);break;case 18:za.ULS.sendTraceTag(38122832,lf.$m,15,"{0}",Nf);break;case 19:za.ULS.sendTraceTag(38122833,lf.$m,15,"{0}",Nf);break;case 21:za.ULS.sendTraceTag(0,lf.$m,15,"{0}",Nf);break;case 14:za.ULS.sendTraceTag(6575508,lf.$m,15,"{0}",Nf);break;case 15:za.ULS.sendTraceTag(36739287,lf.$m,50,"{0}",Nf);break;case 16:za.ULS.sendTraceTag(36767649,lf.$m,15,"{0}",Nf);break;case 20:za.ULS.sendTraceTag(593510690,lf.$m,15,"{0}",Nf);break;default:za.ULS.shipAssertTag(5884129,lf.$m,!1,"Bad state:{0} logInfo:{1}",
zh,Nf)}};this.P0b=J;this.Uub=ma;this.Sbb=J;this.cmh=Ta;this.Ijk=pb;this.xgk=Jc;this.uSe=Zc;this.CZb=jd;this.iTg=dd;this.pwe=Ld;this.e_=$d;this.o3=le;this.zXb=ae;this.U9j=Oe;this.xYb=ef;this.EHe=oh;this.Oaa=Ff;this.cA=si;this.vhk=ui;this.U1g=wm;this.NWa=Vf.create(Bm.isEnabled,Bm.maxRetries,xk.F7);this.TQe=new Zd.a;this.Ovc=Yg;this.kA=new On.a(-1);this.rf=dg;this.kA.D0e(this.i8n);this.Bvd=Gg;this.Hwb=si();this.m_g=Bj;this.MVj=Bm.isEnabled?null:xk;this.Ctb=Kf;this.Djh=this.cmh;this.iLe=di.a.nil;this.sa=
new S.a;pa.a.instance.Ta("Common.App.VisibilityManagement.IVisibilityManager").execute(Nf=>{this.am=Nf;this.am.B_a((zh,Hj)=>{this.jY(zh,Hj)});this.mPe=Nf.MD});this.rf&&this.rf.bGc((Nf,zh)=>{this.uHa(Nf,zh)});this.yIe=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIntervalMs",Wb):Wb;this.aeh=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorRetryIntervalAfterActive",
this.Uub):this.Uub;this.Agh=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldLogAdditionalInfoEachTick",!0):!0;this.Dgh=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldNotKickoutFromDocxSaveMonitor",!1):!1;this.Ohk=Bm}uHa(J,ma){za.ULS.sendTraceTag(528577692,lf.$m,15,"DocxSaveMonitor: AppNetworkChanged event raised. OldState: [{0}], NewState: [{1}]",dn.a[ma.D6d],dn.a[ma.XLb]);1!==
ma.XLb&&3!==ma.XLb&&(za.ULS.sendTraceTag(528566343,lf.$m,50,"Resetting list of current failed request retries. State before resetting is - Canary: [{0}], Timeout: [{1}]",this.NWa.aYc(1),this.NWa.aYc(2)),this.NWa.clear())}get YLd(){return this.vuc}get d5d(){return this.iLe}get XU(){const J=!this.Xib()||this.d5d.equals(this.Xib().id);J||za.ULS.sendTraceTag(521413851,lf.$m,50,"Document has unSavedChanges: currentRevisionId [{0}], mostRecentRevisionIdResult [{1}]",this.Xib().id.toString(),this.d5d.toString());
return J}get Hzi(){return this.cA().getTime()-this.Hwb.getTime()>this.yIe}get RHd(){return this.MS}get z0a(){return 3}get HHd(){let J=null;db.App.za&&db.App.za.jb&&db.App.za.jb.Zc&&(J=db.App.za.jb.Zc.contentReplicator);return[J,Gh.App.W1]}jY(J,ma){var Ta,pb,Wb;J={["VisibilityState"]:Ug.a[this.am.MD],["IsVisible"]:this.am.isVisible,["DocxSaveMonitor"]:{["RequestPending"]:this.tYb,["KickoutIntervalElapsed"]:this.Hzi,["LastSuccessfulIterationTime"]:null!==(Ta=this.Hwb)&&void 0!==Ta?Ta:"null",["RequestStartTime"]:null!==
(pb=this.fCc)&&void 0!==pb?pb:"null",["SkippedKickouts"]:this.Bxd,["LastSkippedKickoutAt"]:null!==(Wb=this.S4g)&&void 0!==Wb?Wb:"null"},["IsViable"]:this.rf.Yxa,["IsNetworkConnected"]:this.rf.cD,["IsExpired"]:this.rf.fda,["HasEmergencyViewModeBeenDeployed"]:this.rf.Zj,["Navigator.Online"]:window.navigator.onLine};za.ULS.sendTraceTag(539874775,lf.$m,50,Ja.c(J));this.mPe!=this.am.MD&&(0==ma.oldState||1==ma.oldState||0!==ma.newState&&1!==ma.newState||this.oAa(this.aeh),0===this.am.MD?wc.c(hh.a.HMk,void 0,
void 0,void 0,void 0,void 0,J):0===this.mPe&&wc.c(hh.a.IMk,void 0,void 0,void 0,void 0,void 0,J),this.mPe=this.am.MD)}start(){this.vuc=this.iTg.Kgb(this.CFl,this.Sbb)}oAa(J){if(!this.YLd||this.Sbb===J)return!1;const ma=this.Sbb;this.Sbb=J;this.stop("changing save monitor interval from "+ma+"ms to "+J+"ms");this.start();return!0}Wpb(J,ma){if(ma>=this.Azc&&J&&!di.a.nil.equals(J)){var Ta=!this.iLe.equals(J);this.Azc=ma;this.iLe=J;const pb=this.cA();this.ORe=pb;const Wb=this.XU;Ta&&(ma={["Id"]:J.toString(),
["IsUpToDate"]:Wb,["Origin"]:pe[ma]},this.nJe&&(ma.LastUpToDateTime=this.nJe.toISOString()),(Ta=this.Bpf())&&Ta.store&&(J=Ta.store.getRevision(J))&&(ma.LastSavedCreationTime=J.creationTime.toISOString()),za.ULS.sendTraceTag(557320151,lf.$m,50,"Updating Last Saved Revision: {0}",ma));Wb&&(this.nJe=pb)}else ma<this.Azc?za.ULS.sendTraceTag(572051800,lf.$m,50,'Deny lower rank origin: {{"CurrentOrigin":"{0}", "Attempt":"{1}"}}',this.Azc,ma):za.ULS.sendTraceTag(572051801,lf.$m,15,'Deny null or Nil ID: {{"Attempt":"{0}"}}',
ma)}stop(J){this.ff(J)}ff(J){this.YLd&&(za.ULS.sendTraceTag(5830084,lf.$m,50,"Stopping DocxSaveMonitor because {0}!",J),this.iTg.ff(this.YLd),this.vuc=0)}Som(){if(0>=this.CZb)return!1;var J=this.m7l();if(!J)return this.bPe=null,this.pud=0,this.qud=!1;this.zxb=J.bFb;this.zxb===this.bPe?this.pud++:(this.bPe=this.zxb,this.pud=1,this.qud=!1);if(this.pud<lf.aen)return!1;this.hAc=+this.cA()-+this.zxb;if(this.hAc<=this.CZb)return!1;if(!this.qud)return this.qud=!0,this.b7i(),!1;if(this.Ctb)this.Ctb.execute(ma=>
{ma.flush(this,0)});else{J="";try{this.Ovc&&(J=this.Ovc())}catch(ma){J=Ja.c({["Kind"]:"Exception",["Stack"]:ma.stack,["Message"]:ma.message,["FileName"]:ma.fileName,["LineNumber"]:ma.lineNumber}),za.ULS.sendTraceTag(50426817,lf.$m,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",J)}za.ULS.sendTraceTag(50426818,lf.$m,15,"Oldest local revision was created at {0} which is {1}ms ago and exceeds max allowed age of {2}ms.  Extra Details: {3}",this.zxb.toISOString(),
this.hAc,this.CZb,J)}this.CZb=-1;this.stop("Exceeded oldest allowed local revision");this.fI(la.a.vsl);return!0}m7l(){let J=null,ma=this.Xib();for(;ma&&!ma.Cia;)J=ma,ma=ma.Fn;return J}KUm(){return this.xYb()?(this.kA.event(1),this.stop("session is lost"),!0):this.EHe()?(this.kA.event(14),za.ULS.sendTraceTag(20029718,lf.$m,15,"ExpiredSessionNotLostYet"),this.stop("session is expired"),this.fI(la.a.XLd),!0):!1}Bpf(){const J=this.zXb();return J?J.Mc:null}Xib(){const J=this.Bpf();return J?Object(cb.a)(J.Am):
null}dIc(J){return this.Ohk.isEnabled?this.NWa.dIc(J):this.MVj.aYc(J)&&!this.NWa.aYc(J)}NOl(J){return J?lf.PKo:lf.rfj}Z1d(J,ma,Ta){if(this.Hzi)if(this.am&&!this.am.isVisible)za.ULS.sendTraceTag(540669727,lf.$m,15,"Kickout interval has elapsed, but browser tab is not visible. We will not kick out immediately"),this.Bxd+=1,this.S4g=this.cA();else return this.kA.event(J,{}),this.stop("request failed after kickout interval "+Ta),this.Ctb&&this.Ctb.execute(pb=>{pb.flush(this,2)}),this.fI(ma),!0;return!1}NJf(J,
ma){const Ta=J.StatusCode;return 88===Ta||89===Ta||236===Ta?(ma.KickoutDiagnostics=this.Ovc(),88===Ta?(ma.Result="deleted DSS session",this.kA.event(18,ma),this.stop("deleted DSS session"),this.fI(la.a.localCobaltDeletedSessionFault)):89===Ta?(ma.Result="expired DSS session",this.kA.event(19,ma),this.stop("expired DSS session"),this.fI(la.a.localCobaltExpiredSessionFault)):(l.AFrameworkApplication.ho("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled",
!1)&&(J=xc.b(J.LastSavedRevisionId),this.Wpb(J,4)),ma.Result="DSS session not found",this.kA.event(21,ma),this.stop("DSS session not found"),this.fI(la.a.localCobaltSessionNotFound)),!0):14===Ta?(this.stop("DSS returned an unspecified failure"),this.fI(la.a.v3m),!0):104===Ta?(this.stop("this operation is disabled on the server"),!0):this.OJf("unrecognized OperationResult: "+Ta,ma)}OJf(J,ma){if(!this.TQe.contains(J))this.TQe.add(J);else if(this.Z1d(11,la.a.Kgf,J))return ma.ConsecutiveErrors=this.RHd,
ma.Reason=J,za.ULS.sendTraceTag(41997899,lf.$m,15,"DocxSaveMonitor kickout. {0}",ma),!0;this.oAa(this.Uub);return!1}mqm(J,ma,Ta){let pb=!1;if(J){const Wb=this.cA().getTime()-J.creationTime.getTime();Wb>=this.cmh&&(pb=!0,lf.UOi(ma,this.ecm(J,Wb,Ta)),Wb>=this.yIe&&10===this.kA.currentState?(this.kA.event(11,ma),this.stop("didn't save in time"),this.fI()):(this.kA.event(10,ma),this.b7i(),this.Amf()))}return pb}vyk(J){this.sa.addHandler(lf.q3i,J)}Vxk(J){this.sa.addHandler(lf.Hmf,J)}Vbj(J){this.sa.removeHandler(lf.Hmf,
J)}b7i(){this.sa.raiseEvent(lf.q3i)}Tva(J){let ma;return({group:ma}=ad.a.d2(J)).returnValue?ma.Responses[0]:null}ecm(J,ma,Ta){const pb={};pb.FirstUnsavedRevisionId=J.id.toString();pb.FirstUnsavedRevisionLengthToRoot=J.fE;pb.UnsavedTimeInMs=ma;pb.CurrentRevisionId=Ta.id.toString();pb.CurrentRevisionLengthToRoot=Ta.fE;return pb}Amf(){ie.a.Bmf(Lp.a.saveMonitor)}fI(J=la.a.Kgf){this.Ijk?this.Dgh?(za.ULS.sendTraceTag(509146274,lf.$m,15,"DocxSaveMonitor would have kicked out due to: {0}. Diagnostic Log: {1}.",
J,this.X8h()),0==this.vuc&&this.start()):this.am&&!this.am.isVisible?(za.ULS.sendTraceTag(509146273,lf.$m,15,"DocxSaveMonitor did not kick out because the session is not visible. Error code: {0}. Diagnostic Log: {1}",J,this.X8h()),0==this.vuc&&this.start()):(this.stop(lf.DZm),J===la.a.XLd?this.e_.value.fI(J,Object.assign(new vb.a,{jna:4,R_:Box4Intl.Box4Strings.L_SessionExpiredMessageDescription,i8:Box4Intl.Box4Strings.L_SessionExpiredMessageTitle,showDescription:!0})):this.e_.value.fI(J,new vb.a)):
za.ULS.sendTraceTag(19247383,lf.$m,50,"Kickout disabled")}X8h(){const J={};var ma=pa.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager");J.HasDataloss=!ma.XU;J.UnSavedRevisionsCount=ma.zVa;J.OldestUnsavedRevisionCreationTime=ma.XU?"":ma.E9b().toString();J.RevisionsWithOutServerRevisionSequenceNumbers=ma.I5b();J.RevisionsWithServerRevisionSequenceNumbers=ma.VId();J.RSNManager_Diagnostics=ma.XC();if(ma=pa.a.instance?pa.a.instance.Oa("WordEditor.RunawayDataLossMonitor"):null)J.RunawayDataLossMonitor_Diagnostics=
ma.Vgj;J.DocxSaveMonitor_Diagnostics=this.XC();(ma=pa.a.instance?pa.a.instance.Oa("WordEditor.ILastSavedToHostDetailsManager"):null)&&(J.LastSavedToHostDetailsManager_Diagnostics=ma.XC());this.am&&(J.VisibilityState=Ug.a[this.am.MD]);return J}XC(){const J={};this.zxb&&(J.ORT=this.zxb.toISOString());0<this.hAc&&(J.AA=this.hAc);0<this.CZb&&(J.MAA=this.CZb);0<this.Bxd&&(J.LSKO=this.S4g.toISOString());this.kA&&0<=this.kA.currentState&&(J.SMS=yf[this.kA.currentState]);const ma={};l.AFrameworkApplication.Opa&&
(ma.S=1);db.App.lostSession&&(ma.LS=1);this.rf&&(this.rf.Jo&&(ma.KO=1),this.rf.fda&&(ma.TE=1));this.am&&(ma.VS=Ug.a[this.am.MD]);window.navigator&&(ma.NW=!window.navigator.onLine);J.AMD=ma;return J}z_l(){const J={"Content-Type":"application/json; charset=utf-8","X-Requested-With":"Fetch"};l.AFrameworkApplication.buildVersion&&(J["X-OfficeVersion"]=Va.a.MB(l.AFrameworkApplication.buildVersion));l.AFrameworkApplication.accessToken&&(J["X-AccessToken"]=Va.a.MB(l.AFrameworkApplication.accessToken),J["X-AccessTokenTtl"]=
l.AFrameworkApplication.Cua.toString());l.AFrameworkApplication.canary&&(J["X-Key"]=Va.a.MB(l.AFrameworkApplication.canary));l.AFrameworkApplication.userType&&(J["X-UserType"]=Va.a.MB(l.AFrameworkApplication.userType));const ma=l.AFrameworkApplication.He.xZ;ma&&(J["X-WacCluster"]=Va.a.MB(ma));l.AFrameworkApplication.userSessionId&&(J["X-UserSessionId"]=Va.a.MB(l.AFrameworkApplication.userSessionId));return J}ZIl(){var J=this.rf?this.rf.networkState:null;if(1===J||3===J)za.ULS.sendTraceTag(558158790,
lf.$m,15,"Not sending request because we dont have network.");else if(J=this.zXb()){var ma=new Sys.Net.WebRequest;ma.set_httpVerb("POST");ma.set_url(lf.serviceUrl);var Ta={};Ta.body=ec.b(tf.construct(J));Ta.headers=this.z_l();Ta.method=ma.get_httpVerb();try{"function"===typeof window.fetch?window.fetch(ma.getResolvedUrl(),Ta).then(pb=>{za.ULS.sendTraceTag(561551382,lf.$m,50,"Request succeeded at the HTTP level {0}",pb.statusText);this.N4g=pb.status;return pb.json()},pb=>{za.ULS.sendTraceTag(561551383,
lf.$m,15,"Request failed at the HTTP level {0}",pb);return null}).then(pb=>{pb=JSON.stringify(pb);this.JWk(pb,this.N4g);return pb},()=>{za.ULS.sendTraceTag(561551385,lf.$m,15,"Request succeeded with null response data");return""}):za.ULS.sendTraceTag(561002076,lf.$m,15,"Browser does not support Fetch.")}catch(pb){za.ULS.sendTraceTag(561551386,lf.$m,15,String.format("Exception when attempting to get last revision save id : {0}",pb))}}else za.ULS.sendTraceTag(540079457,lf.$m,15,"Target node is null, not sending last saved revision request.")}JWk(J,
ma){let Ta=di.a.nil,pb=!1,Wb=-1;ma===Ph.a.Zz&&((J=this.Tva(J))?(Ta=xc.b(J.LastSavedRevisionId),J.StatusCode||(pb=!0,Wb=J.StatusCode)):za.ULS.sendTraceTag(561002077,lf.$m,50,"Response is null when attempting to get last revision save id"));this.sa.raiseEvent(lf.Hmf,new Td(Ta,pb,ma,Wb))}static UOi(J,ma){for(const Ta in ma)J[Ta]=ma[Ta]}DPm(){return Zh.SessionStatusManager.instance.Jo}}lf.rfj=0;lf.serviceUrl=db.App.webServiceBase+"OneNote.ashx?perfTag=LastSavedRevisionRequest";lf.DZm="kickout";lf.q3i=
"PS";lf.Hmf="FLSR";lf.$m=343;lf.aen=5;lf.PKo=5E4;Object(e.a)(lf,"DocxSaveMonitor",null,[1922,178]);class Rk{Kgb(J,ma){return window.setInterval(J,ma)}ff(J){window.clearInterval(J)}}Rk.instance=new Rk;Object(e.a)(Rk,"DocxSaveMonitorTaskManager",null,[1921]);class hm{constructor(J){this.gO=0;this.eua=J}start(J){this.eua&&(this.gO=J,this.eua.reset())}log(){if(this.eua){var J={};J.RequstId=this.gO;J.InvokeCount=this.eua.HVc;J.InvokeFailedCount=this.eua.JVc;J.NoOpenConnectionCount=this.eua.q1c;J.SynchronousNotificationCount=
this.eua.tbd;J.ResponseNotAvailable=this.eua.M7c;za.ULS.sendTraceTag(19161613,205,50,"ClientRequestManagerTelemetryStorage: {0}",J)}}}Object(e.a)(hm,"RequestLifeCycleTelemetryManager",null,[1920]);class Lj{constructor(){this.W=this.KRe=null;this.xel=()=>{var J=l.AFrameworkApplication.K;if(!J.$("DocxSaveMonitorEnabled"))return null;var ma=J.$("DocxSaveMonitorKickoutEnabled");const Ta=J.mc("DocxSaveMonitorIntervalMs",6E4),pb=J.mc("DocxSaveMonitorFailureIntervalMs",5E3),Wb=J.mc("DocxSaveMonitorWarningTimeMs",
12E4),Jc=J.mc("DocxSaveMonitorKickoutTimeMs",6E5),Zc=J.mc("DocxSaveMonitorQueueTimeoutMs",6E4),jd=J.mc("DocxSaveMonitorSentTimeoutMs",12E4),dd=J.mc("DocxSaveMonitorOldestAllowedLocalRevisionMs",3E5);var Ld=J.$("DocxSaveMonitorTelemetryInfoEnabled");const $d=J.$("DocxSaveMonitorInfoRequestLoggingEnabled");var le=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorBypassCRMIsEnabled",!1),ae=J.$("DocxSaveMonitorRawWebRequestsEnabled")||le;le=J.$("ComponentStateLoggingPackageIsEnabled");
J=J.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIfSessionisLostButNotKickedOutIsEnabled",!1);var Oe=l.AFrameworkApplication.He,ef=ae?new fl(l.AFrameworkApplication.userSessionId,Oe.xZ,Oe.OQh):null;ef=new gm(Oe,ef,ae);Ld=Ld&&Oe&&!ae?new hm(Oe.Cea):null;ae=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorIsEnabled",!1):!1;Oe=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorMaxRetries",
3):3;const oh=Vf.create(ae,Oe);oh.WFc(1);oh.WFc(2);le=le?this.W.Ta("Common.IComponentStateLogManager"):null;ma=new lf(Ta,pb,Wb,ma,Jc,Zc,jd,dd,Rk.instance,ef,pa.a.instance.Ve("Wonca.KickoutExecutor"),ll.a.instance,this.$$b,()=>!l.AFrameworkApplication.L5d||Hk.a.instance.RVc,()=>db.App.lostSession,Object(a.a)(nf.a.instance,nf.a.instance.eva,"checkAndTriggerSessionHasExpired"),()=>l.AFrameworkApplication.Rk,()=>new Date,()=>new Date,Ld,$d,oh,this.OMl,le,J,pa.a.instance.Oa("Common.ISessionStatus")||Zh.SessionStatusManager.instance,
{isEnabled:ae,maxRetries:Oe});ma.start();za.ULS.sendTraceTag(5884131,lf.$m,50,"SaveMonitor initialized");return ma};this.$$b=()=>{const J=db.App.za.jb.rc;return J?J.ed:null};this.OMl=()=>{const J={};l.AFrameworkApplication.lc&&(J.TM=l.AFrameworkApplication.lc.XC());qf.WoncaApp.QF&&(J.RS=qf.WoncaApp.QF.XC());Gh.App.W1&&(J.CRS=Gh.App.W1.XC());db.App.za&&db.App.za.jb&&db.App.za.jb.Zc&&db.App.za.jb.Zc.contentReplicator&&(J.GSR=db.App.za.jb.Zc.contentReplicator.XC());l.AFrameworkApplication.Opa&&(J.S=
1);db.App.lostSession&&(J.LS=1);db.App.zd&&db.App.zd.nC.Jo&&(J.KO=1);J.RVS=window.document.visibilityState;return Sys.Serialization.JavaScriptSerializer.serialize(J)}}get name(){return"WordEditor.DocxSaveMonitor"}init(){if(db.App.Fs||db.App.Dm)this.KRe=this.W.resolve("WordEditor.DocxSaveMonitor.DocxSaveMonitor")}dispose(){this.KRe&&this.KRe.stop("WordEditorDocxSaveMonitorPackage is being disposed")}wc(J){this.W=J;(db.App.Fs||db.App.Dm)&&J.ia("WordEditor.DocxSaveMonitor.DocxSaveMonitor",this.xel).as("Wonca.IDocxSaveMonitor").ha()}static main(){M.a.instance.Gc(new Lj)}}
Object(e.a)(Lj,"WordEditorDocxSaveMonitorPackage",null,[1,2]);var Bk=c(706);class Zi{constructor(J,ma){this.zn=J;this.Fbo=Object(Bk.c)(ma)}async loadChunk(J){return this.zn.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk(J):(await this.Fbo).dA.loadScript(J)}}Object(e.a)(Zi,"WordOnlineChunksLoader",null,[]);class Rj{constructor(){this.name="WordEditor.EditorAi.Entry"}wc(J){J.ia("WordEditor.EditorAi.WordOnlineChunksLoader",()=>new Zi(l.AFrameworkApplication.K,J.Ta("Common.IDynamicScriptLoaderProvider")))}init(){}dispose(){}static main(){M.a.instance.Gc(new Rj)}}
Object(e.a)(Rj,"EditorAiEntryPackage",null,[1,2]);var tm=c(999);class dh{constructor(J,ma,Ta,pb,Wb,Jc,Zc){this.WLd=J;this.yqi=ma;this.Bxm=Ta;this.$Zf=pb;this.wMc=Wb;this.oc=Jc;this.JH=Zc;this.zun=(jd,dd,Ld)=>{switch(Ld){case 1:if(!Object(Bk.d)(dd)||!this.tL)return 8;this.wMc.Kvj();break;case 2:this.wMc.M6e?this.bsj():this.yqb()}return 32};this.Dqn=(jd,dd,Ld)=>{2===Ld&&this.$Zf.zwl().catch($d=>{za.ULS.Vz(508965832,3041,10,$d,"Failed to initialize Copilot integration package")});return 32};this.nZi=
(jd,dd)=>{dd.oZ&&(Object(wc.a)("AiMakerInitializationTriggered"),this.WLd.aea(this.nZi),this.WLd.Od(),this.wMc.Kvj(),this.JH.pk(19,()=>{this.wMc.M6e&&this.bsj()}))};this.Ivn=async(jd,dd)=>{dd.oZ&&this.Bxm.execute(Ld=>{Ld.findImageAndRegisterHandler()})};this.tL=Gh.App.Vpe.tL}initialize(){this.WLd.S3(this.nZi);this.WLd.initialize();this.yqi.S3(this.Ivn);this.yqi.initialize();this.oc.fb(hh.a.EId,Uh.a.view,this.zun,4);this.oc.fb(hh.a.NHi,Uh.a.application,this.Dqn,1028)}bsj(){this.wMc.show().catch(J=>
{za.ULS.Vz(508965831,3041,10,J,"Failed to show document wizard")})}yqb(){(new tm.a).k9d(0)}}Object(e.a)(dh,"AiMakerInitializer",null,[]);var uk=c(1761),gl=c(946);class Um extends gl.a{constructor(J){var ma;super("BooleanFeatureGateConditionId");this.Jl=J.Jl;this.S1a=J.S1a;this.defaultValue=null!==(ma=J.defaultValue)&&void 0!==ma?ma:!1}initialize(){super.initialize();const J=l.AFrameworkApplication.K;J.Nn(()=>{const ma=J.getBooleanFeatureGate(this.S1a,this.defaultValue);this.pg(ma)})}pg(J){super.pg(J);
za.ULS.sendTraceTag(512369937,3028,50,this.GO(this.Jl,J,`featureGate=${this.S1a}`))}}Object(e.a)(Um,"BooleanFeatureGateCondition",gl.a,[]);var Sk=c(710);class en extends gl.a{constructor(J){super(J.hIh);this.c$f=J}initialize(){super.initialize();l.AFrameworkApplication.K.Nn(()=>{var J,ma,Ta,pb,Wb;const Jc=null!==(ma=null===(J=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===J?void 0:J.WACDatacenter)&&void 0!==ma?ma:"unknown";J=null!==(pb=null===(Ta=l.AFrameworkApplication.sessionStartInfoSettings)||
void 0===Ta?void 0:Ta.Ring)&&void 0!==pb?pb:"unknown";Ta=null===(Wb=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===Wb?void 0:Wb.Host;Wb=this.PVc(Jc,J,Ta);this.pg(Wb);za.ULS.sendTraceTag(509747520,3028,50,this.GO(this.c$f.Jl,Wb,`datacenter=${Jc}`))})}PVc(J,ma,Ta){if("1"===ma||"unknown"===J||this.c$f.LYh.includes(Ta))return!0;const pb=J.toUpperCase();return!this.c$f.rTh.some(Wb=>pb.includes(Wb))}}Object(e.a)(en,"EditorAiDatacenterCondition",gl.a,[]);class Do extends gl.a{constructor(J,
ma,Ta){super("AiMakerConsentGroupConditionId");this.Jl=J;this.Bba=ma;this.defaultValue=Ta}initialize(){super.initialize();this.Bba.execute(J=>{var ma;J.isFeatureEnabled("AiMaker",null!==(ma=this.defaultValue)&&void 0!==ma?ma:!1).then(Ta=>{this.pg(Ta);return null})})}pg(J){super.pg(J);za.ULS.sendTraceTag(509752010,3028,50,this.GO(this.Jl,J))}}Object(e.a)(Do,"AiMakerConsentGroupCondition",gl.a,[]);class Ui extends gl.a{constructor(J){super("RegionComposerEnabledConditionId");this.Jl=J.Jl}initialize(){super.initialize();
this.pg(Gh.App.Vpe.tL)}pg(J){super.pg(J);za.ULS.sendTraceTag(508965830,3028,50,this.GO(this.Jl,J))}}Object(e.a)(Ui,"RegionComposerEnabledCondition",gl.a,[]);var lp=c(949),Ji;(function(J){J[J.$zh=0]="bypass";J[J.FBn=1]="passed";J[J.fSi=2]="notPassed"})(Ji||(Ji={}));Object(e.b)("LicenseConditionResult",Ji);class rj extends gl.a{constructor(J,ma,Ta){super("LicenseConditionId");this.appSettings=ma;this.c2e=Ta;this.Jl=J.Jl;this.qmb=J.qmb;this.f4b=J.f4b}initialize(){super.initialize();this.appSettings.Nn(()=>
{this.hVo().catch(J=>{za.ULS.Vz(508875776,3028,10,J,"Failed to update license condition for {0}",this.qmb)})})}async hVo(){const J=await this.sIc();this.pg(J!==Ji.fSi);this.Kdo(J)}async sIc(){return this.B6e()?Ji.$zh:await this.Xyf()?Ji.FBn:Ji.fSi}B6e(){return this.f4b?this.appSettings.getBooleanFeatureGate(this.f4b,!1):!1}async Xyf(){var J=await Object(Bk.c)(this.c2e);const ma=lp.b.Gra();J=await J.isFeatureEnabled(this.qmb,!1);za.ULS.sendTraceTag(508875286,3028,50,"License check for {0} trigger took: {1}ms",
this.Jl,ma.QMc);return J}Kdo(J){J=Object.entries({qmb:this.qmb,Ifp:J===Ji.$zh}).map(([ma,Ta])=>`${ma}=${Ta}`).join(", ");za.ULS.sendTraceTag(508875285,3028,50,this.GO(this.Jl,this.Bia,J))}}Object(e.a)(rj,"LicenseCondition",gl.a,[]);class im extends rj{constructor(J,ma,Ta){super({Jl:J,qmb:"Copilot",f4b:"Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped"},ma,Ta)}}Object(e.a)(im,"CopilotLicenseCondition",rj,[]);const In="CH DE FR EU UK NO SE NL PIE".split(" ");class Ki extends Sk.a{constructor(J,
ma,Ta){const pb=new Um({Jl:16,S1a:"Microsoft.Office.WordOnline.IsAiMakerEnabled"});J=new uk.a(16,J,ma,{MPb:!0,sP:!1,wbc:!1,vbc:!1,rP:!1});ma=new en({hIh:"AiMakerDocumentWizardDatacenterConditionId",Jl:16,rTh:In,LYh:["Exchange Online Consumer","OneDriveWOPI"]});const Wb=new Do(16,Ta),Jc=new Ui({Jl:16});Ta=new im(16,l.AFrameworkApplication.K,Ta);super(16,new kb.a([pb,J,ma,Wb,Jc,Ta]),null,3028,"AiMakerDocumentWizardTriggered")}}Object(e.a)(Ki,"AiMakerDocumentWizardTriggerModel",Sk.a,[]);var $h=c(947);
class Er extends gl.a{constructor(J){super("AiImageInsertedConditionId");this.Mfb=J;this.isInitialized=!1;this.JTi=()=>{this.pg(!0)}}initialize(){this.isInitialized||(super.initialize(),this.isInitialized=!0,this.Mfb.execute(J=>{var ma;null===(ma=J.add_onImageWasInsertedHandler)||void 0===ma?void 0:ma.call(J,this.JTi)}))}Od(){this.isInitialized&&(this.Mfb.execute(J=>{var ma;null===(ma=J.remove_onImageWasInsertedHandler)||void 0===ma?void 0:ma.call(J,this.JTi)}),this.isInitialized=!1,super.Od())}}
Object(e.a)(Er,"AiImageInsertedCondition",gl.a,[]);class Rr extends Sk.a{constructor(J,ma){const Ta=new Um({Jl:19,S1a:"Microsoft.Office.WordOnline.IsAiImageRemakeEnabled"}),pb=new Er(J),Wb=new im(19,l.AFrameworkApplication.K,ma);super(19,new kb.a([Ta,pb,Wb]),null,3028,"OnTriggerAiImageRemakeEventKey");this.Mfb=J;this.Bba=ma;this.Ori=!1;this.rtk()}o3a(J){super.o3a(J);super.NCd()&&super.Pjb("AiImageInsertedConditionId");"AiImageInsertedConditionId"!==J||this.Ori||(this.L_n(),this.Ori=!0)}rtk(){l.AFrameworkApplication.va.fb(hh.a.FId,
Uh.a.view,()=>8,1028)}L_n(){l.AFrameworkApplication.va.Wv(hh.a.FId,Uh.a.view,()=>8)}}Object(e.a)(Rr,"AiImageRemakeTriggerModel",Sk.a,[]);class sn{constructor(J){this.aXf=async()=>{const ma=await this.WHi.value;await this.RUc(ma);return ma};this.Pyn=M.a.instance;this.WHi=new ac.a(J);this.yBm=new ac.a(this.aXf)}async u4(){await this.WHi.value}async Nhb(){return await this.yBm.value}async RUc(J){M.a.instance.Gc(J);return new Promise(ma=>{this.Pyn.registerOnPackageInit(J.name,ma)})}}Object(e.a)(sn,"LazyLoadedPackage",
null,[]);class Vm{constructor(){this.KUh=new sn(()=>Promise.all([c.e(2),c.e(5),c.e(11)]).then(c.bind(null,2099)).then(J=>J.instance));this.X7k=new sn(()=>Promise.all([c.e(2),c.e(5),c.e(30)]).then(c.bind(null,2108)).then(J=>J.instance))}async Bwl(){await this.KUh.Nhb()}async zwl(){await this.KUh.Nhb();await this.X7k.Nhb()}}Object(e.a)(Vm,"AiMakerPackageManager",null,[]);var vq=c(294),Jn={get qsl(){var J=null===aiMakerDocumentWizardUx||void 0===aiMakerDocumentWizardUx?void 0:aiMakerDocumentWizardUx.interop;
if(!J)throw Error("aiMakerDocumentWizardUx chunk is accessed before loading");return J}};class zs{constructor(J){this.container=J}getDocumentContentGenerator(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentContentGenerator")}getCanvasService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerCanvasService")}getFocusManager(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardFocusManager")}getDocumentLayoutHtmlHelper(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentLayoutHtmlHelper")}getTelemetryLogger(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerTelemetryLogger")}getSurveysManager(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardSurveysManager")}getStylesService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerStylesService")}getImageRemakeService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiImageRemakeService")}getImageRemakeSizeService(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiImageRemakeSizeService")}getImageRemakeFocusManager(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiImageRemakeFocusManager")}getPromptSuggestionProvider(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerPromptSuggestionProvider")}getController(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardController")}getResumeBioInfoEnricher(){return this.container.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerResumeBioInfoEnricher")}}
Object(e.a)(zs,"AiMakerDocumentWizardDependenciesImpl",null,[]);class Pi{constructor(J,ma,Ta,pb,Wb){this.Fsg=J;this.$Zf=ma;this.ij=Ta;this.rc=pb;this.O4o=Wb;this.Vzi=!1;this.Ppn=async()=>{this.Vzi=!0;await Promise.all([this.$Zf.Bwl(),this.Fsg.loadChunk("aiMakerDocumentWizardUx")]);return Jn.qsl};this.pJj=new ac.a(this.Ppn)}get M6e(){return this.ij.Eba(this.rc.ed,{sP:!1,Uca:!1,hpa:!1,rP:!1})}Kvj(){this.Vzi||this.pJj.value.catch(J=>{za.ULS.Vz(508965829,3041,10,J,"Failed to load document wizard UX interop")})}async show(){const J=
await this.pJj.value;this.M6e?(this.vth||(this.vth=this.Ren(J)),this.vth.open()):za.ULS.sendTraceTag(508965828,3041,50,"Document wizard show attempt prevented")}Ren(J){const ma=this.mountApp(J);return ma?ma:new jj(this.O4o,()=>this.mountApp(J))}mountApp(J){const ma=Object(vq.a)("EditorContainer");return J.mountApp(ma,new zs(pa.a.instance))}}Object(e.a)(Pi,"AiMakerDocumentWizardUx",null,[]);class jj{constructor(J,ma){this.controller=J;this.frn=ma;this.isOpen=!0}get isOpen(){return this.controller.isOpen}set isOpen(J){this.controller.isOpen=
J}open(){this.isOpen||(this.isOpen=!0,this.frn())}close(){this.isOpen=!1}}Object(e.a)(jj,"AiMakerDocumentWizardCompatAppRef",null,[]);class $i{constructor(){this.isOpen=!1}}Object(e.a)($i,"AiMakerDocumentWizardControllerImpl",null,[]);class Sj extends $h.a{get name(){return"WordEditor.AiMaker.Entry"}G8(J){this.container=J;J.ia("WordEditor.AiMaker.AiMakerPackageManager",()=>new Vm).ha();J.ia("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardController",()=>new $i).ha();J.ia("WordEditor.AiMaker.AiMakerDocumentWizardUx",
()=>new Pi(J.resolve("WordEditor.EditorAi.WordOnlineChunksLoader"),J.resolve("WordEditor.AiMaker.AiMakerPackageManager"),J.resolve("Box4.IParagraphReader"),db.App.za.jb.rc,J.resolve("WordEditor.AiMaker.DocumentWizard.AiMakerDocumentWizardController"))).ha()}I8(){(new dh(new Ki(this.container.resolve("Box4.IParagraphReader"),db.App.za.jb.rc,this.container.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),new Rr(this.container.Ta("WordEditor.AiMaker.DocumentWizard.AiMakerCanvasService"),
this.container.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),this.container.Ta("WordEditor.AiMaker.DocumentWizard.AiImageRemakeService"),this.container.resolve("WordEditor.AiMaker.AiMakerPackageManager"),this.container.resolve("WordEditor.AiMaker.AiMakerDocumentWizardUx"),l.AFrameworkApplication.va,Ya.a.get_instance())).initialize()}H8(){}static main(){M.a.instance.Gc(new Sj)}}Object(e.a)(Sj,"AiMakerEntryPackage",$h.a,[]);var mp={get interop(){var J=aiInserterUx.interop;if(!J)throw Error("aiInserterUx chunk is accessed before loading");
return J}};class Vi{constructor(J,ma){this.N9d=J;this.E8c=ma;this.MHa=async(Ta,pb)=>{pb.oZ&&(Object(wc.a)("AiInserterInitializationTriggered"),this.N9d.aea(this.MHa),this.N9d.Od(),[,Ta]=await Promise.all([this.o3m(),Promise.all([c.e(2),c.e(5),c.e(25)]).then(c.bind(null,2100))]),Ta.main(mp.interop))}}initialize(){this.N9d.S3(this.MHa);this.N9d.initialize()}async o3m(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("aiInserterUx"):(await Object(Bk.c)(this.E8c)).dA.loadScript("aiInserterUx")}}
Object(e.a)(Vi,"AiInserterInitializer",null,[]);class ap extends gl.a{constructor(J,ma){super("AiInserterConsentGroupConditionId");this.Bba=J;this.defaultValue=ma}initialize(){super.initialize();this.Bba.execute(J=>{J.isFeatureEnabled("AiInserter",!!this.defaultValue).then(ma=>{this.pg(ma);return null})})}pg(J){super.pg(J)}}Object(e.a)(ap,"AiInserterConsentGroupCondition",gl.a,[]);const Mp="CH DE FR EU UK NO SE NL PIE".split(" ");class Xn extends gl.a{constructor(){super("AiInserterDatacenterConditionId")}initialize(){super.initialize();
l.AFrameworkApplication.K.Nn(()=>{var J,ma,Ta,pb;const Wb=null!==(ma=null===(J=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===J?void 0:J.WACDatacenter)&&void 0!==ma?ma:"unknown";J=null!==(pb=null===(Ta=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===Ta?void 0:Ta.Ring)&&void 0!==pb?pb:"unknown";Ta=this.PVc(Wb,J);this.pg(Ta)})}PVc(J,ma){if("1"===ma||"unknown"===J)return!0;const Ta=J.toUpperCase();return!Mp.some(pb=>Ta.includes(pb))}}Object(e.a)(Xn,"AiInserterDatacenterCondition",
gl.a,[]);class np extends Sk.a{constructor(J){const ma=new Um({Jl:17,S1a:"Microsoft.Office.WordOnline.IsAiInserterEnabled"}),Ta=new ap(J),pb=new Xn;J=new im(17,l.AFrameworkApplication.K,J);super(17,new kb.a([ma,Ta,pb,J]),null,3028,"AiInserterAppTriggered")}}Object(e.a)(np,"AiInserterTriggerModel",Sk.a,[]);class aj extends $h.a{get name(){return"WordEditor.AiInserter.Entry"}G8(J){this.container=J}I8(){(new Vi(new np(this.container.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),
this.container.Ta("Common.IDynamicScriptLoaderProvider"))).initialize()}H8(){}static main(){M.a.instance.Gc(new aj)}}Object(e.a)(aj,"AiInserterEntryPackage",$h.a,[]);const vk="CH DE FR EU UK NO SE NL PIE".split(" ");class Ol extends Sk.a{constructor(J){const ma=new Um({Jl:18,S1a:"Microsoft.Office.WordOnline.IsAiRewriteEnabled"}),Ta=new en({hIh:"AiRewriteDatacenterConditionId",Jl:18,rTh:vk,LYh:["Exchange Online Consumer","OneDriveWOPI"]});J=new im(18,l.AFrameworkApplication.K,J);super(18,new kb.a([ma,
Ta,J]),null,3028,"AiRewriteTriggered")}}Object(e.a)(Ol,"AiRewriteTriggerModel",Sk.a,[]);var zn={get interop(){var J=null===aiRewriteUx||void 0===aiRewriteUx?void 0:aiRewriteUx.interop;if(!J)throw Error("aiRewriteUx chunk is accessed before loading");return J}};class ih{constructor(J,ma){this.LCd=J;this.E8c=ma;this.MHa=async(Ta,pb)=>{pb.oZ&&(Object(wc.a)("AiRewriteInitializationTriggered"),this.LCd.aea(this.MHa),this.LCd.Od(),[,Ta]=await Promise.all([this.c2m(),Promise.all([c.e(2),c.e(5),c.e(14)]).then(c.bind(null,
2104))]),Ta.main(zn.interop))}}initialize(){this.LCd.S3(this.MHa);this.LCd.initialize()}async c2m(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("aiRewriteUx"):(await Object(Bk.c)(this.E8c)).dA.loadScript("aiRewriteUx")}}Object(e.a)(ih,"AiRewriteInitializer",null,[]);class Yn extends $h.a{get name(){return"WordEditor.AiRewrite.Entry"}G8(J){this.container=J}I8(){(new ih(new Ol(this.container.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),
this.container.Ta("Common.IDynamicScriptLoaderProvider"))).initialize()}H8(){}static main(){M.a.instance.Gc(new Yn)}}Object(e.a)(Yn,"AiRewriteEntryPackage",$h.a,[]);var Eo;(function(J){J[J.version0=0]="version0";J[J.version1=1]="version1"})(Eo||(Eo={}));Object(e.b)("FirstRunExperienceVersion",Eo);class Fo{get R1e(){return"Word"}get xBh(){return"74eb3f02-206c-47c2-ad65-c4d21db60910"}get version(){return Eo.version0}get currentVersion(){return Eo.version1}get $Km(){return Fo.isEnabled()&&l.AFrameworkApplication.K.$("WordEditorFirstRunExperienceDataStoreIsEnabled")}get gec(){return Fo.isEnabled()&&
l.AFrameworkApplication.K.$("WordEditorFirstRunExperienceUIV2IsEnabled")}get UDi(){return l.AFrameworkApplication.K.$("WordEditorFirstRunExperienceTestIsEnabled")}get PGl(){return"Microsoft.Office.Web.SessionSettings.IWordEditorFirstRunExperienceUIV2Settings"}get uPi(){return 24}get agj(){return 4E3}get h8c(){return""}static isEnabled(){const J=l.AFrameworkApplication.sessionStartInfoSettings?l.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup:"";return"Unknown"!==J&&"Automation"!==J}}
Object(e.a)(Fo,"FirstRunExperienceLauncherSettings",null,[1947]);class qq{constructor(J){this.WVg=J}Lwo(J){this.WVg&&this.WVg.Mwo(J)}}Object(e.a)(qq,"FirstRunExperienceManager",null,[1946]);class Oo{constructor(){this.W=null}get name(){return"WordEditor.FirstRunExperience"}wc(J){this.W=J;this.W.ia("WordEditor.FirstRunExperience.IFirstRunExperienceManager",()=>new qq(this.W.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"))).ha()}init(){const J=this.W.resolve("WordEditor.FirstRunExperience.IFirstRunExperienceManager");
J&&J.Lwo(new Fo)}dispose(){}}Object(e.a)(Oo,"WordEditorFirstRunExperiencePackageManager",null,[1,2]);class cr{constructor(J,ma){this.WIa=(Ta,pb,Wb,Jc,Zc)=>{var jd,dd;if(1===Wb)return Zc=null===(dd=null===(jd=pb.view.mb)||void 0===jd?void 0:jd.ib)||void 0===dd?void 0:dd.lb,(null===Zc||void 0===Zc?0:Zc.bI)||Ta===hh.a.V$c&&(null===Zc||void 0===Zc?0:Zc.l4a)?32:8;if(2===Wb){jd=this.Hbb.lj.isVisible;this.Hbb.kC(!0,1===Zc);dd=0;switch(Ta){case hh.a.qsj:Zc=1;break;case hh.a.rsj:Zc=2;break;case hh.a.Zie:Zc=
2;dd=1;break;case hh.a.$ie:Zc=1;dd=2;break;case hh.a.V$c:Zc=1;dd=3;break;case hh.a.xme:Zc=this.Hbb.v6b;break;default:dd=Zc=0}jd&&Ta===hh.a.WIa||this.Hbb.kjo(Zc,dd);return 32}return 8};this.EWd=(Ta,pb,Wb,Jc,Zc)=>{this.toggleButton(Zc,!1);return this.L_k(Wb)};this.xme=(Ta,pb,Wb,Jc,Zc)=>this.Hbb.lj.isVisible?this.EWd(Ta,pb,Wb,Jc,Zc):this.WIa(Ta,pb,Wb,Jc,Zc);this.ga=J;this.Hbb=ma}dispose(){this.Hbb&&this.Hbb.dispose()}Tb(){this.ga.ra(hh.a.xme,Uh.a.view,this.xme);this.ga.fb(hh.a.WIa,Uh.a.view,this.WIa,
4);this.ga.ra(hh.a.EWd,Uh.a.view,this.EWd);this.ga.fb(hh.a.Zie,Uh.a.view,this.WIa,4);this.ga.ra(hh.a.$ie,Uh.a.view,this.WIa);this.ga.ra(hh.a.V$c,Uh.a.view,this.WIa)}L_k(J){if(1===J)return 32;this.Hbb.kC(!1);return 32}toggleButton(J,ma){J&&(J[oj.a.On]=ma)}}Object(e.a)(cr,"FormatPictureActor",null,[9]);class Fh{constructor(J){this.Mzb=!1;this.lj=J}get v6b(){return this.lj.ehl}kjo(J,ma){switch(J){case 0:case 1:this.lj.Kxo(ma);break;case 2:this.lj.Wxo(ma)}}kC(J,ma=!1){this.Mzb||this.PBf();J?this.lj.WP(ma):
this.lj.$oa()}dispose(){this.lj.dispose()}PBf(){this.Mzb||(this.lj.initialize(),this.Mzb=!0)}}Object(e.a)(Fh,"FormatPictureManager",null,[1919,9]);var fn=c(358),jm=c(174),tn=c(251);class mi{}mi.ZP=tn.a.KPd;mi.Ghc=1;mi.Hhc=WordEditorIntl.WordEditorStrings.L_FormatPicture;mi.Pva="FormatPictureTaskPaneData";Object(e.a)(mi,"FormatPicturePaneConstants",null,[]);class Np{constructor(){this.type="FormatPictureTaskPaneProps";this.section=0;this.description=this.title=this.numberFormatInfo=null;this.rotationAngle=
this.rightCrop=this.leftCrop=this.bottomCrop=this.topCrop=0;this.onRotationSpinButtonChange=this.onCropSpinButtonChange=this.onDescriptionChange=this.onTitleChange=null;this.disabled=!1}}Object(e.a)(Np,"FormatPictureTaskPaneProps",null,[]);class bp{constructor(J,ma,Ta,pb){this.YRe=0;this.Wtc=this.Hma=null;this.cwd=this.Uvd=this.Oqd=this.uhd=this.uzd=0;this.Ws=this.rWb=!1;this.Sxe=0;this.pun=()=>{this.Llj()};this.Hm=()=>{let Wb=!1;Wb=this.YLn()||Wb;Wb=this.T6a()||Wb;Wb=this.S6a()||Wb;Wb=this.Iic()||
Wb;(Wb=this.ULn()||Wb)&&this.Mm()};this.G3=J;this.F$j=ma;this.vJe=Ta;this.ig=pb}initialize(){this.Q_();this.hka()}get isVisible(){return this.Ws}WP(J){this.ead(J)}$oa(){this.kea();this.Ium()}Kxo(J){this.Tnj(J,1)}Wxo(J){this.Tnj(J,2)}Tnj(J,ma){this.Sxe=ma;this.YRe=J}get ehl(){return this.Sxe}dispose(){}Q_(){this.G3.UOa();this.YRe=this.Sxe=0}get focusManager(){return this.F$j.value}get oc(){return this.vJe.value}X4a(){return!!this.focusManager.currentScope&&this.focusManager.currentScope.name===mi.ZP}Llj(){this.focusManager.mg(mi.ZP)}hka(){const J=
this.focusManager.fe(mi.ZP);J.parent=eg.AFrame.Ap;J.pga(this.pun)}kea(){this.X4a()&&this.focusManager.mg(this.focusManager.gU)}ead(J){Kh.UISurfaces.Nu().then(ma=>{ma.showTaskPane(mi.ZP,this.xA(J));this.isVisible&&J&&this.focusManager.mg(mi.ZP);return null})}Mm(){Kh.UISurfaces.Nu().then(J=>{J.updateTaskPane(mi.ZP,this.xA(!1));return null})}Ium(){Kh.UISurfaces.Nu().then(J=>{J.hideTaskPane(mi.ZP,2);return null})}xA(){const J=new Np;this.sqo(J);return Object.assign(new Oi.a,{title:mi.Hhc,hideHeader:!1,
width:320,location:2,contentProps:J,onOpen:ma=>{this.Ws=!0;db.App.za.z_a(this.Hm);db.App.za.updateCommandUI();this.Llj();this.ig.r2b(mi.ZP,ma)},onClose:()=>{this.kea();this.Ws=!1;db.App.za.wjc(this.Hm);db.App.za.updateCommandUI()},isModernPane:!0,enableResize:!0,minResizeWidth:150,maxResizeWidth:920})}sqo(J){const ma=F.e().numberFormatInfo;J.section=this.YRe;J.numberFormatInfo="object"===typeof ma?ma:null;J.title=this.Hma;J.description=this.Wtc;J.topCrop=this.uzd;J.bottomCrop=this.uhd;J.leftCrop=
this.Oqd;J.rightCrop=this.Uvd;J.rotationAngle=this.cwd;J.onTitleChange=this.onTitleChange();J.onDescriptionChange=this.onDescriptionChange();J.onCropSpinButtonChange=this.onCropSpinButtonChange();J.onRotationSpinButtonChange=this.onRotationSpinButtonChange();J.disabled=this.rWb}onTitleChange(){return J=>{if(J!==this.Hma){this.Hma=J;var ma=new fn.DictionaryPropertySet;ma.setValue(jm.a.mkb,J);this.oc.Qb(ti.a.B9c,2,ma);this.Mm()}}}onDescriptionChange(){return J=>{if(J!==this.Wtc){var ma=new fn.DictionaryPropertySet;
ma.setValue(jm.a.sY,J);this.Wtc=J;this.oc.Qb(ti.a.mQb,2,ma);this.Mm()}}}onCropSpinButtonChange(){return(J,ma)=>{const Ta=new fn.DictionaryPropertySet;switch(ma){case 0:this.uzd=J;Ta.setValue(jm.a.rkb,J);this.oc.Qb(hh.a.nUc,2,Ta);break;case 1:this.uhd=J;Ta.setValue(jm.a.okb,J);this.oc.Qb(hh.a.gUc,2,Ta);break;case 2:this.Oqd=J;Ta.setValue(jm.a.pkb,J);this.oc.Qb(hh.a.hUc,2,Ta);break;case 3:this.Uvd=J,Ta.setValue(jm.a.qkb,J),this.oc.Qb(hh.a.iUc,2,Ta)}this.Mm()}}onRotationSpinButtonChange(){return J=>
{this.cwd=J;const ma=new fn.DictionaryPropertySet;ma.setValue(jm.a.uUc,0);ma.setValue(jm.a.JU,J);this.oc.Qb(ti.a.m9,2,ma);this.Mm()}}YLn(){const J=2===this.oc.Qb(ti.a.B9c,1,null),ma=J!==this.rWb;this.rWb=J;return ma}T6a(){var J=new fn.DictionaryPropertySet;this.oc.Qb(ti.a.T6a,2,J);J=J.ja(jm.a.mkb,"");const ma=J!==this.Hma;this.Hma=J;return ma}S6a(){var J=new fn.DictionaryPropertySet;this.oc.Qb(ti.a.S6a,2,J);J=J.ja(jm.a.sY,"");const ma=J!==this.Wtc;this.Wtc=J;return ma}Iic(){var J=new fn.DictionaryPropertySet;
this.oc.Qb(hh.a.f5c,2,J);const ma=J.ja(jm.a.rkb,0),Ta=J.ja(jm.a.okb,0),pb=J.ja(jm.a.pkb,0);J=J.ja(jm.a.qkb,0);const Wb=ma!==this.uzd||Ta!==this.uhd||pb!==this.Oqd||J!==this.Uvd;this.uzd=ma;this.uhd=Ta;this.Oqd=pb;this.Uvd=J;return Wb}ULn(){var J=new fn.DictionaryPropertySet;this.oc.Qb(ti.a.rOb,2,J);J=J.ja(jm.a.JU,0);const ma=J!==this.cwd;this.cwd=J;return ma}}Object(e.a)(bp,"ReactFormatPicturePane",null,[1918,9]);class pr{constructor(){this.imd=this.W=null}get name(){return"WordEditor.FormatPicture"}wc(J){this.W=
J;this.W.ia("WordEditor.FormatPicture.IFormatPictureManager",()=>new Fh(this.W.resolve("WordEditor.FormatPicture.IFormatPicturePane"))).ha();this.W.ia("WordEditor.FormatPicture.IFormatPicturePane",()=>new bp(Mc.a.instance,new ac.a(()=>Xf.FocusManager.instance()),new ac.a(()=>l.AFrameworkApplication.va),ip.a.instance)).ha();this.W.ia("WordEditor.FormatPicture.FormatPictureActor",()=>new cr(l.AFrameworkApplication.va,this.W.resolve("WordEditor.FormatPicture.IFormatPictureManager"))).ha()}init(){if(Gh.App.ysg||
Gh.App.FLj)this.imd=this.W.resolve("WordEditor.FormatPicture.FormatPictureActor"),this.imd.Tb(),db.App.za.updateCommandUI()}dispose(){this.imd&&this.imd.dispose()}static main(){M.a.instance.Gc(new pr)}}Object(e.a)(pr,"WordEditorFormatPicturePackage",null,[1,2]);var Go=c(1502),Bp=c(516),uo=c(1217);class Tk extends jk.a{constructor(){super();this.Prompt=0;this.FileId=null}nl(){return Zo.a.graphMergeConsentChange}static construct(J,ma){const Ta=new Tk;Ta.FileId=J;Ta.Prompt=ma;return Ta}}Object(e.a)(Tk,
"GraphMergeConsentChangedRequest",jk.a,[]);var dr=c(592);class dq extends dr.a{constructor(){super();this.Location=this.FileId=null}nl(){return Zo.a.playGraphMergeReplay}static construct(J,ma){const Ta=new dq;Ta.FileId=J;Ta.Location=ma;return Ta}}Object(e.a)(dq,"PlayGraphMergeReplayRequest",dr.a,[]);class Po{constructor(J,ma,Ta,pb,Wb,Jc=null,Zc=null){this.lm=!1;this.aO=null;this.Dfh=this.bIe=!1;this.g$e=()=>{if(this.PAa.pWd)this.bIe=!0;else if(this.bIe=!1,!this.vfo){this.Dfh=!0;var jd=this.NKa.Vya;
za.ULS.sendTraceTag(39084353,300,50,"GraphMerge consent given: {0}",jd===uo.a.consentGiven);if(jd===uo.a.consentDenied||jd===uo.a.consentGiven)jd=Tk.construct(this.vQ(),jd),this.Xv(jd)}};this.Emi=(jd,dd)=>{dd&&dd.IPf&&dd.IPf.mbf&&!this.PAa.YDi&&(this.PAa.JEj(),this.PAa.pWd=!0,this.Xv(dd.IPf.mbf))};this.Cmi=(jd,dd)=>{dd&&dd.Ied&&this.PAa.JEj()};this.Dmi=(jd,dd)=>{dd&&(dd.ShowMergePrompt&&this.NKa.Xdj(this.g$e),l.AFrameworkApplication.Og&&(l.AFrameworkApplication.Og.SessionMergeInfo|=dd.PartMergeInfo))};
this.vQ=J;this.PAd=Ta;this.PAa=pb;this.NKa=Wb;this.PAd&&this.PAd.$xk(this.Emi);this.o3=Jc||ll.a.instance;if(!Zc){const jd=new Bp.a;Zc=dd=>jd.Fha(0,dd)}this.rXj=Zc}get QXm(){return this.bIe}get vfo(){return this.Dfh}Xv(J){const ma=new sc.a;ma.Jq=J;ma.status=jp.a.requestReady;ma.YG="GraphMerge";const Ta=this.rXj(()=>{this.L7c(ma,J.nl()===Zo.a.createGraphMergeReplay)});Ta.IH(ma);Ta.jU()}L7c(J,ma){this.lm||(ma&&(this.PAa.pWd=!1),2===J.statusCode&&!Ra.a.BJb(J.Mj)&&1===J.Mj.length&&J.Mj[0]?(J=J.Mj[0],J.StatusCode?
this.PAa.neg():ma&&this.NKa.Xdj(this.g$e),this.o3.EVa(J),this.QXm&&this.g$e()):this.PAa.neg())}PSa(J){this.aO=J;this.aO.$Fc(this.Cmi);this.aO.aGc(this.Dmi)}dispose(){this.lm||(this.PAd&&this.PAd.M1n(this.Emi),this.aO&&(this.aO.vjc(this.Cmi),this.aO.Ode(this.Dmi)),this.lm=!0)}}Object(e.a)(Po,"GraphMergeBackupManager",null,[1949,9]);class Rh{constructor(J,ma=null,Ta=null,pb=null){this.yue=0;this.XGe=!1;this.Y3g=new Date(0);this.pWd=!1;this.NKa=J;this.cA=ma||(()=>new Date);Ta||(Ta=l.AFrameworkApplication.K?
l.AFrameworkApplication.K.mc("WordEditorGraphMergeBackupDelayInMs",12E4):12E4);this.tbk=Ta;pb||(pb=l.AFrameworkApplication.K?l.AFrameworkApplication.K.mc("WordEditorGraphMergeMaxBackups",1):1);this.M6g=pb}get vWm(){return+this.cA()-+this.Y3g<this.tbk}get YDi(){return this.NKa.Vya===uo.a.automatic?!1:this.NKa.Vya===uo.a.consentDenied?!0:this.XGe||this.pWd||this.vWm}JEj(){this.Y3g=this.cA();this.yue++;this.yue>=this.M6g&&this.neg()}neg(){this.XGe||(this.XGe=!0,za.ULS.sendTraceTag(39084356,300,50,"Permanently throttling merge reports after creating {0} out of a maximum of {1} reports.",
this.yue,this.M6g))}}Object(e.a)(Rh,"GraphMergeBackupThrottler",null,[1948]);class wq{constructor(J,ma,Ta=null){this.dYg=!1;this.G6=J;this.O2j=ma;null==Ta&&(Ta=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordEditorGraphMergeBypassConsentPrompt"));this.sPe=Ta?uo.a.automatic:uo.a.promptRequired}get Vya(){return this.sPe}Xdj(J){if(!this.dYg&&this.Vya===uo.a.promptRequired){var ma=this.O2j.value;ma&&ma.isFeatureEnabled(52)&&(this.dYg=!0,this.G6.execute(Ta=>{Ta.Wwo(()=>{this.D4k(J)},()=>
{this.consentDenied(J)})}))}}consentDenied(J){this.Vya===uo.a.promptRequired&&(za.ULS.sendTraceTag(42333270,300,50,"Consent denied for investigating merge failures."),this.sPe=uo.a.consentDenied,J());this.naj()}D4k(J){this.Vya===uo.a.promptRequired&&(za.ULS.sendTraceTag(42333271,300,50,"Consent received for investigating merge failures."),this.sPe=uo.a.consentGiven,J());this.naj()}naj(){this.G6.execute(J=>{J.Cum()})}}Object(e.a)(wq,"GraphMergeCollectionConsentManager",null,[1945]);class Op extends Sys.EventArgs{constructor(J){super();
this.IPf=J}}Object(e.a)(Op,"GraphMergeCompleteEventArgs",Sys.EventArgs,[]);var um=c(837),cp=c(885),qr=c(1060),op=c(622),ml;(function(J){J[J.none=0]="none";J[J.failure=1]="failure";J[J.crash=2]="crash";J[J.success=3]="success"})(ml||(ml={}));Object(e.b)("GraphMergeReplayReason",ml);var fs=c(1796),rr=c(1794),vo=c(225),Ck=c(183);class Hl{constructor(J,ma,Ta,pb,Wb,Jc){this.S3f=this.og=null;this.tYc=this.csg=!1;this.gl=null;this.K$c=J.runtime.K$c;this.uq=J;this.Xd=ma;this.Ng=Ta;this.En=pb;this.p4k=Wb;
this.graphNodeComplexMerge=Jc}}Object(e.a)(Hl,"GraphNodeComplexMergeState",null,[]);var ko=c(1575),Fr=c(1558);class lo{constructor(J,ma=null){this.Qg=J;this.pZb=ma||this.gRc()}get Qmb(){return this.pZb}get Xd(){return this.Qg}gRc(){return[Object(a.a)(this,this.vzo,"simpleMerge"),Object(a.a)(this,this.D3k,"complexMerge")]}yqo(J,ma,Ta,pb,Wb,Jc){ma=new Hl(J,Ta,new ac.a(()=>new ko.a(pb?pb.Fm:null,Wb)),new ac.a(()=>new ko.a(pb?pb.Fm:null,Jc)),new ac.a(()=>new ko.a(Jc,Wb)),ma.uMh(Wb,()=>J.runtime.Zb));
ma.og=pb.p1b;ma.S3f=new vo.a;return ma}merge(J,ma,Ta,pb,Wb,Jc){ma=this.yqo(J,ma,Ta,pb,Wb,Jc);Ta=!0;for(pb=0;pb<this.Qmb.length&&Ta;pb++)(Ta=(0,this.Qmb[pb])(ma))||J.logger.u3d("GraphNodeMerge.GetMergeFunctions()",pb);if(J=ma.tYc&&ma.gl?new Fr.a(ma.gl,!1):null)switch(J.Roo(ma.og),(J?J.Fm:Wb).Qc){case 1074135145:ma.uq.runtime.Qce.N5k.Z(J.Fm.id,J.Fm);break;case 1074135153:ma.uq.runtime.Qce.BLk.Z(J.Fm.id,J.Fm);break;case 1074135127:ma.uq.runtime.Qce.w2k.Z(J.Fm.id,J.Fm);break;case 393230:ma.uq.runtime.N4d.add(J.Fm.id)}return{returnValue:ma.tYc,
gl:J}}vzo(J){if(J.uq.runtime.Zb&&J.uq.runtime.Zb.Jjb(1000005)&&0<J.og.count)return!0;var ma=J.graphNodeComplexMerge.bbe;return J.En.value.qWc(ma)&&J.p4k.value.qWc(ma)?J.Ng.value.qWc(ma)?!0:(ma=J.En.value.xf,J.tYc=!0,J.gl=ma.XK(),!1):(J.tYc=!0,!1)}D3k(J){const ma=J.En.value.xf;J.K$c&&Ck.a.instance.Ua(4018183,1,4,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",ma.id,ma.Qc);const Ta=J.graphNodeComplexMerge.gog(J);J.tYc=Ta;Ck.a.instance.Ua(4018184,1,Ta?5:4,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",
Ta?"Succeeded":"Failed",ma.id,ma.Qc,!!J.gl);return Ta}}Object(e.a)(lo,"GraphNodeMerge",null,[2042]);var Pp=c(1472),Qo=c(1418);class pp extends jk.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=this.BaseRevisions=this.FileId=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=Pp.a.none;this.RequestId=this.ObjectSpaceId=null;this.Source=Qo.a.none;this.Reason=ml.none;this.Prompt=0}nl(){return Zo.a.createGraphMergeReplay}static construct(J,ma,Ta,pb,Wb,Jc,
Zc,jd,dd,Ld,$d){const le=new pp;le.FileId=J;le.BaseRevisions=ma;le.TheirRevisions=Ta;le.YourRevisions=pb;le.IgnoreConflictsInLastServerRevision=Wb;le.MergeHint=Jc;le.ObjectSpaceId=Zc?xc.a(Zc):null;le.RequestId=jd?xc.a(jd):null;le.Source=dd;le.Reason=Ld;le.Prompt=$d;return le}}Object(e.a)(pp,"CreateGraphMergeReplayRequest",jk.a,[]);var rq=c(825),ek=c(238),An=c(16),km=c(1900),al=c(1993);class eq{constructor(J,ma=null,Ta=null){this.mrl=(pb,Wb)=>{let Jc=pb;var Zc=Wb,jd=this.Dcb.get(pb);if(!jd)return{uIa:Jc,
uPb:Zc};Zc=new vo.a;Zc.add(jd);var dd=this.ixb.get(pb)||this.WF.J(pb);jd=new vo.a;jd.add(dd);dd=new vo.a;dd.add(this.WF.J(pb));za.ULS.sendTraceTag(17409890,318,50,"Performing CpMerge: [Source: {0}] [MergeHint: {1}] [LocalRevisionObjects: {2}] [ServerRevisionObjects: {3}]",this.zH.Uwf,this.zH.Uia,this.oci(jd),this.oci(Zc));var Ld=this.Gci(this.zH.Uia);this.kGl(Ld,pb,Zc);jd=new km.a(Ld,dd,Ld.input.Uia===Pp.a.yours?jd:Zc,Ld.input.Uia===Pp.a.yours?Zc:jd,this.Gci(Pp.a.yours),jd,Zc);Zc=new vo.a;for(dd=
0;dd<Wb.length;dd++){this.zH.eH("GraphMergeSelectionRecordUpdater.DoParagraphMergeForModifiedObject");const $d=({s7a:Jc,dra:Ld}=jd.vdd(pb,Wb.J(dd))).returnValue;Zc.add(Ld);$d?za.ULS.sendTraceTag(17409891,318,50,"UpdateSelectionRecordsForParagraph: Updating the selection record for [Paragraph: {0}] [Cp: {1}] to [Result Paragraph: {2}] [Result Cp: {3}] ",pb,Wb.J(dd),Jc,Ld):za.ULS.sendTraceTag(4339677,318,15,"UpdateSelectionRecordsForParagraph: UpdateCpAccordingToIncomingChange was unable to update the cp for [Paragraph: {0}]",
pb)}return{uIa:Jc,uPb:Zc}};this.zH=J;this.WF=J.vk;this.Dcb=J.QJo;this.ixb=J.R8o;this.qak=J.u3m;this.Qg=ma||new qr.a;this.Sek=Ta||this.mrl}pMc(J){const ma=new vo.a;for(let Ta=0;Ta<J.length;Ta++){const pb=this.erl(J.J(Ta));ma.add(pb)}return ma}oMc(J,ma,Ta){const pb=J.yu===J.Dz&&J.startCp===J.endCp;ma&&({uIa:J.yu,dra:J.startCp}=this.HVa(J.yu,J.startCp,J.yu),pb&&(J.Dz=J.yu,J.endCp=J.startCp));Ta&&!pb&&({uIa:J.Dz,dra:J.endCp}=this.HVa(J.Dz,J.endCp,J.Dz));return J}erl(J){if(J.yu===J.Dz){var ma=new vo.a;
ma.add(J.startCp);ma.add(J.endCp);({uIa:J,uPb:ma}=this.nqg(J.yu,ma));return new rq.a(J,ma.J(0),J,ma.J(1))}ma=new vo.a;var Ta=new vo.a;let pb;ma.add(J.startCp);({uIa:ma,uPb:pb}=this.nqg(J.yu,ma));Ta.add(J.endCp);({uIa:J,uPb:Ta}=this.nqg(J.Dz,Ta));return new rq.a(ma,pb.J(0),J,Ta.J(0))}nqg(J,ma){let Ta=J,pb=ma;if(!this.WF.J(J))return za.ULS.sendTraceTag(4339675,318,50,"UpdateSelectionRecordsForParagraph: Not updating the selection record for [Paragraph: {0}] as it is new in this revision",J),{uIa:Ta,
uPb:pb};if(this.Dcb.get(J))({uIa:Ta,uPb:pb}=this.Sek(J,ma,Ta,pb));else if(this.zH.dBf&&!this.zH.dBf.J(this.zH.dBf.length-1).W4(J)){pb=new vo.a;for(let Wb=0;Wb<ma.length;Wb++){let Jc;({uIa:Ta,dra:Jc}=this.HVa(J,ma.J(Wb),Ta));pb.add(Jc)}}return{uIa:Ta,uPb:pb}}oci(J){let ma="";J.forEach(Ta=>{ma+=Ta.acd();ma+=" ";return!0});return ma}Gci(J){const ma=pa.a.instance.Oa("Box4.IFeatureHelper"),Ta=new al.a;Ta.input.source=this.zH.Uwf;Ta.input.Uia=this.zH.Uia;Ta.input.$Nc=()=>ma;Ta.runtime.vk=this.WF;Ta.runtime.UDa=
this.zH.Z2k;J===Pp.a.yours?(Ta.runtime.Lu=this.ixb,Ta.runtime.Nq=this.Dcb,Ta.runtime.dOd=this.zH.UFi,Ta.runtime.Pne=this.zH.kGi):J===Pp.a.theirs&&(Ta.runtime.Lu=this.Dcb,Ta.runtime.Nq=this.ixb,Ta.runtime.dOd=this.zH.kGi,Ta.runtime.Pne=this.zH.UFi);Ta.runtime.Zb=ma;return Ta}kGl(J,ma,Ta){if(J.runtime.Lu.nb(ek.a.OL)){var pb=J.runtime.Lu.J(ek.a.OL);pb=this.Qg.getPropertyObjectIds(pb,Sl.a.h2);if(1===pb.length&&(pb=pb.J(0),J.runtime.Lu.nb(pb)&&(pb=J.runtime.Lu.J(pb),3===this.Qg.getPropertyInt32(pb,Sl.a.Srb)))){const Wb=
this.Qg.getPropertyString(pb,Sl.a.Hka),Jc=this.Qg.getPropertyString(pb,Sl.a.PSb);ma.toString()===Wb&&Wb===Jc&&(ma=this.Qg.getPropertyObjectId(pb,Sl.a.ydd),J.runtime.Lu.nb(ma)&&Ta.add(J.runtime.Lu.J(ma)))}}}a9l(J,ma){let Ta=0;for(let pb=0;pb<J.length;pb++)if(ma.equals(J.J(pb)))return Ta=pb,{returnValue:!0,idx:Ta};return{returnValue:!1,idx:Ta}}HVa(J,ma){const Ta=this.qak&&!!this.ixb.J(J)&&!this.WF.J(J);let pb=J,Wb=ma,Jc=!1,Zc=!1;(Ta?this.ixb:this.Dcb).forEach((jd,dd)=>{this.zH.eH("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");
if(this.NGf(dd.Qc)&&this.WF.J(jd)){dd=null;if(Ta){dd=this.ARc($d=>this.ixb.J($d)||this.WF.J($d),jd);var Ld=this.a0d(dd,J)}else Ld=this.ARc($d=>this.WF.J($d),jd),Ld=this.a0d(Ld,J);if(Ld&&(Zc=!0,dd||(dd=this.ARc($d=>this.ixb.J($d)||this.WF.J($d),jd)),jd=this.ARc($d=>this.Dcb.J($d)||this.WF.J($d),jd),Ld=0,({idx:Ld}=this.a9l(dd,J)).returnValue)){for(let $d=Ld+1;$d<dd.length;$d++)if(this.a0d(jd,dd.J($d)))return Wb=0,pb=dd.J($d),Jc=!0,!1;for(--Ld;0<=Ld;Ld--)if(this.a0d(jd,dd.J(Ld)))return Wb=Number.MAX_VALUE,
pb=dd.J(Ld),Jc=!0,!1}}return!0});Jc||(za.ULS.sendTraceTag(4339678,318,15,"UpdateSelectionRecordForDeletedParagraph: Was unable to reposition the selection record [ObjectID : {0}] [Cp: {1}] [IsNewParaInRejectedLocalChange: {2}] [FoundDeletedNode: {3}]",J,ma,Ta,Zc),this.zH.Uwf===Qo.a.undo&&(za.ULS.sendTraceTag(17340240,318,50,"UpdateSelectionRecordForDeletedParagraph: Unable to position IP, Trying to update to first para in server revision for Undo",pb),({b1h:ma}=this.HYl()).returnValue?(pb=ma,Wb=0,
za.ULS.sendTraceTag(17340241,318,15,"UpdateSelectionRecordForDeletedParagraph: Did not find any paragraphs that were common on client and server. Repositioning to the start of the first [Paragraph:{0}] in the incoming revision",pb)):za.ULS.sendTraceTag(17340242,318,15,"UpdateSelectionRecordForDeletedParagraph: Unable to get the first para in an incoming change",pb)));return{uIa:pb,dra:Wb}}HYl(){let J=di.a.nil,ma=new vo.a;this.Dcb.forEach((Ta,pb)=>{this.zH.eH("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");
return this.NGf(pb.Qc)?(ma=this.ARc(Wb=>this.Dcb.J(Wb)||this.WF.J(Wb),Ta),!1):!0});return 0<ma.length?(J=ma.J(0),{returnValue:!0,b1h:J}):{returnValue:!1,b1h:J}}NGf(J){return 393241===J||393250===J||393251===J||393252===J}ARc(J,ma){var Ta=J(ma);ma=new vo.a;if(!this.NGf(Ta.Qc))return ma;Ta=this.Qg.getPropertyObjectIds(Ta,An.a.gf);for(let pb=0;pb<Ta.length;pb++){const Wb=new vo.a;this.qtf(J,Ta.J(pb),Wb);ma.aD(ma.length,Wb)}return ma}qtf(J,ma,Ta){var pb=J(ma);if(pb)if(393230===pb.Qc)Ta.add(ma);else if(393229===
pb.Qc)ma=this.Qg.getPropertyObjectIds(pb,An.a.$K).eg(0),this.qtf(J,ma,Ta);else if(393250===pb.Qc||393251===pb.Qc||393252===pb.Qc)for(ma=this.Qg.getPropertyObjectIds(pb,An.a.gf),pb=0;pb<ma.length;pb++)this.qtf(J,ma.J(pb),Ta)}a0d(J,ma){for(let Ta=0;Ta<J.length;Ta++)if(ma.equals(J.J(Ta)))return!0;return!1}}Object(e.a)(eq,"GraphMergeSelectionRecordUpdater",null,[]);class Sr extends fs.a{constructor(J=null,ma=null,Ta=null,pb=null,Wb=null,Jc=null,Zc=null,jd=null,dd=null,Ld=null,$d=null){var le;super();
this.YNh=ae=>{const Oe=ae.tX,ef=db.App.za.jb.Zc;return new um.a(ae,Oe,ef.xd,ef.fileId,ef.apb,ef.contextId,Oe?Oe.id:di.a.nil,this.Ree,!1,!0)};this.vQ=J||(()=>l.AFrameworkApplication.rootQuerySignature);ma||(ma=ae=>new cp.a(ae));this.geh=ma;this.Qg=Ta||new qr.a;this.POg=Zc||new rr.ChildNodeListMerge(this.Xd);this.D_b=jd;this.Ree||(this.D_b=(ae,Oe,ef)=>new op.a(ae,Oe,ef));this.pZb=pb||this.gRc();this.rbb=Wb||new tk.a;this.LXg=Jc||new lo(this.Xd);this.U6g=(null===(le=l.AFrameworkApplication.K)||void 0===
le?void 0:le.mc("WordEditorGraphMergeMaxBrowserTimeInMs",750))||750;this.PAa=dd;this.NKa=Ld;this.GVd=this.enl($d);this.jVg=()=>pa.a.instance.Oa("Box4.IFeatureHelper")}enl(J){J||(J=l.AFrameworkApplication.K?l.AFrameworkApplication.K.mc("WordEditorGraphMergeBackupCasesBrowser",0):0);return J}pFa(){return(new Date).getTime()}Gwj(J,...ma){return String.format.apply(null,[J].concat(ma))}mKo(J){throw Nd.a.invalidOperation(J);}GRd(J){return String.format("Name: {0}, Message: {1}, Stack: {2}",J.name,J.message,
J.stack)}mGn(J){if(this.PAa&&this.PAa.YDi||!this.UFo(J))return null;this.v6m(J);let ma;({RJk:pb,PJo:Wb,Q8o:ma}=this.Hel(J,this.YNh));const Ta=fs.a.WZl(J);var pb=pp.construct(this.vQ(),pb.eAa(),Wb.eAa(),ma.eAa(),J.input.jIb,J.input.Uia,J.input.Gm,J.input.HLb,J.input.source,Ta,this.NKa.Vya);var Wb=J.output.$M;Ta===ml.success&&0<Wb.length&&(pb.MergedRevision=this.YNh(J.output.$M.last()));return pb}pMc(J,ma){return(new eq(J)).pMc(ma)}oMc(J,ma,Ta,pb){return(new eq(J)).oMc(ma,Ta,pb)}}Object(e.a)(Sr,"GraphMerger",
fs.a,[]);class Qi extends Sr{constructor(J,ma=null,Ta=null){super(J,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ma,Ta);this.sa=new S.a}get Vya(){return this.NKa?this.NKa.Vya:uo.a.unknown}get delayedMergeOperation(){return null}set delayedMergeOperation(J){}$xk(J){this.sa.addHandler(Qi.Twf,J)}M1n(J){this.sa.removeHandler(Qi.Twf,J)}ogg(){return!1}Tfc(J,ma,Ta,pb,Wb,Jc,Zc){(J=super.Tfc(J,ma,Ta,pb,Wb,Jc,Zc))&&this.sa.raiseEvent(Qi.Twf,new Op(J));return J}}Qi.Twf="GMC";Object(e.a)(Qi,"WordEditorGraphMerger",
Sr,[1944,1377,1378]);class gs{constructor(){this.W=null}get name(){return"WordEditor.GraphMerge"}wc(J){this.W=J;this.W.ia("WordEditor.GraphMerge.GraphMergeCollectionConsentManager",()=>new wq(this.W.Ta("WordEditor.IBusinessBarController"),new ac.a(()=>J.Oa("Box4.IFeatureHelper")))).as("Box4.IGraphMergeCollectionConsentManager").ha();this.W.ia("WordEditor.GraphMerge.GraphMergeBackupThrottler",()=>new Rh(this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IGraphMergeBackupThrottler").ha();
this.W.ia("WordEditor.GraphMerge.WordEditorGraphMerger",()=>new Qi(()=>l.AFrameworkApplication.rootQuerySignature,this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IWordEditorGraphMerger").ha();this.W.ia("WordEditor.GraphMerge.GraphMergeBackupManager",()=>new Po(()=>l.AFrameworkApplication.rootQuerySignature,l.AFrameworkApplication.va,this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger"),
this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("Box4.IGraphMergeBackupManager").ha()}init(){db.App.rS||(db.App.rS=Go.a.x8());const J=this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger");db.App.rS.KKk(J);this.W.resolve("Box4.IGraphMergeBackupManager")}dispose(){let J=this.W.Oa("Box4.IGraphMergeBackupManager");J&&J.dispose()}}Object(e.a)(gs,"GraphMergePackage",null,[1,2]);var sr=c(285);class Gr{constructor(J){this.Fwe=
"FontPicker";this.zGe=null;this.p$a=J;this.rld=this.p$a.gza(sr.a.QKb,Object(a.a)(this,this.PEb,"featureStateChangeCallback"));this.p$a.isFeatureEnabled(sr.a.QKb,!1).then(ma=>{this.zGe=ma})}get isLicensed(){return this.zGe}PEb(J){this.zGe=J.isEnabled;J=appChrome.actions.updateFontPickerLicenseState(this.Fwe,J.isEnabled);appChrome.api.dispatch(J)}dispose(){this.p$a.ojc(sr.a.QKb,this.rld)}}Object(e.a)(Gr,"ModernFontPickerFeatureHelper",null,[1075,9]);var Gq=c(478),qp=c(651),wk=c(1693);class Bn{constructor(){this.type=
"FontInfoTaskPaneProps";this.onUpsellButtonClicked=null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(e.a)(Bn,"FontInfoTaskPaneProps",null,[]);class Ho{constructor(J,ma,Ta,pb=null){this.OWe=this.sW=this.rld=null;this._state=this.NYb=0;this.vJe=J;this.p$a=ma;this.pXj=Ta;this.Vb=pb}get oc(){return this.vJe.value}initialize(){this.oc.ra(m.a.X9f,y.a.frame,Object(a.a)(this,this.X9f,"requestFontInfo"));this.rld=this.p$a.gza(sr.a.QKb,Object(a.a)(this,this.PEb,
"featureStateChangeCallback"));this.hka()}WP(J=!1){const ma=Kh.UISurfaces.Nu(),Ta=this.p$a.isFeatureEnabled(sr.a.QKb,!1),pb=[];pb.push(ma);pb.push(Ta);Promise.all(pb).then(Wb=>{Wb[0].showTaskPane(wk.a.oFb,this.xA(Wb[1]));J&&this.iK()})}HYo(J){Kh.UISurfaces.Nu().then(ma=>{ma.updateTaskPane(wk.a.oFb,this.xA(J));return null})}PEb(J){this.HYo(J.isEnabled)}X9f(J,ma,Ta,pb,Wb){this.sW=Wb.CommandValueId;this.OWe=Wb.Trigger;this.NYb=Wb.InputMethod;this.WP(2===this._state&&1===this.NYb);return 32}xA(J){const ma=
new Bn;ma.onUpsellButtonClicked=Object(a.a)(this,this.onUpsellButtonClicked,"onUpsellButtonClicked");ma.fontName=this.sW;ma.isLicensed=J;ma.trigger=this.OWe;ma.helpArticleUrl=this.Q4k();ma.paneId=wk.a.oFb;J=this.Yzm();J.contentProps=ma;return J}Yzm(){return Object.assign(new Oi.a,{title:wk.a.Hhc,hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:Object(a.a)(this,this.onOpen,"onOpen"),onClose:Object(a.a)(this,this.onClose,"onClose"),onShow:Object(a.a)(this,
this.onShow,"onShow"),onHide:Object(a.a)(this,this.onHide,"onHide")})}hka(){if(this.Vb){var J=this.Vb.fe(wk.a.oFb);J.parent=eg.AFrame.Ap;J.eI=!0}}onOpen(){this._state=2;this.iK()}onShow(J){0!==this._state&&(this._state=2,1===J&&(this.NYb=J),this.iK())}onClose(){this.NYb=this._state=0;this.blur()}onHide(){this._state=1;this.NYb=0}iK(){this.Vb&&1===this.NYb&&this.Vb.mg(wk.a.oFb)}blur(){this.Vb&&this.Vb.currentScope&&this.Vb.currentScope.name===wk.a.oFb&&this.Vb.mg(this.Vb.gU)}onUpsellButtonClicked(){this.p$a.launchUpsellExperience(wk.a.experienceId)}dispose(){this.p$a.ojc(sr.a.QKb,
this.rld)}Q4k(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",this.pXj,this.Q_l(),"WDWAENDUSER",l.AFrameworkApplication.lcid)}Q_l(){switch(this.OWe){case "missing":return"hlpFontInfoMissingFont";case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return Ho.fNk(this.sW)}static fNk(J){let ma="hlpFontInfo";for(let Ta=0;Ta<J.length;++Ta){const pb=Va.a.charAt(J,
Ta);if(255<J.charCodeAt(Ta)||Va.a.ZYd(pb))ma+=pb}return ma}}Object(e.a)(Ho,"FontInfoPane",null,[949,9]);class am extends Ho{constructor(J,ma,Ta,pb,Wb){super(J,ma,pb.kb("FontInfoHelpBaseUrl"),Wb);this.G3=Ta}WP(J){this.Q_();super.WP(J)}PEb(J){super.PEb(J);db.App.za.updateCommandUI()}Q_(){this.G3.UOa()}}Object(e.a)(am,"WordEditorFontInfoPane",Ho,[]);class dp{constructor(){this.nXb=this.Frd=this.Cvc=this.W=null}get name(){return"WordEditor.ModernFontPicker"}wc(J){this.W=J;J.ia("Common.ModernFontPicker.IModernFontPickerFeatureHelper",
()=>new Gr(this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).ha();J.ia("Common.ModernFontPicker.IFontInfoPane",()=>new am(new ac.a(()=>l.AFrameworkApplication.va),this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Mc.a.instance,l.AFrameworkApplication.K,Xf.FocusManager.instance())).ha()}init(){this.Frd=this.W.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper");this.Cvc=this.W.resolve("Common.ModernFontPicker.IFontInfoPane");
this.Cvc.initialize();l.AFrameworkApplication.K.$("IsAnonymousUser")||((this.nXb=this.W.Oa(qp.a))?this.nXb.initialize():za.ULS.sendTraceTag(557061451,3021,15,"IFontPinningStore service is not available."));db.App.za.updateCommandUI()}dispose(){this.Cvc&&(this.Cvc.dispose(),this.Cvc=null);this.Frd&&(this.Frd.dispose(),this.Frd=null);this.nXb&&(this.nXb.KDa(),this.nXb=null)}static main(){Object(Gq.a)()&&M.a.instance.Gc(new dp)}}Object(e.a)(dp,"ModernFontPickerPackage",null,[1,2]);var Hr=c(135),vm=c(5),
Mj=c(253),Uk=c(36),wo=c(1120);class nl{constructor(J,ma,Ta,pb,Wb,Jc,Zc,jd,dd,Ld,$d,le=null){this.DZ=Ta;this.Yc=J;this.Lc=ma;this.rh=Wb;this.vKa=Jc;this.cW=Zc;this.uOg=jd;this.tOg=dd;this.iy=Ld;this.P_j=le||nl.tw}get jh(){return this.iy?this.iy.jh:!1}Hsi(J){return this.hGa(J,0)}dDm(J){return this.hGa(J,1)}hGa(J,ma){let Ta=null;if(this.jh&&this.cW&&(this.tOg.instance&&this.tOg.instance.JJa(J),ma?1===ma&&(Ta=this.cW.sci(J.node)):Ta=this.cW.ypf(J.node,J.cpBegin,J.Fb),Ta&&!Ta.ja(Sl.a.u9,!1)))return za.ULS.shipAssertTag(24749379,
368,!1,"Try to insert page break to inconvertible inline content control"),2;const pb=vm.GraphIterator.WX(this.Yc.Ek());pb.set(J.node);pb.zb(10);const Wb=this.Lc.Pc(15);Wb.St(pb);ma?Uk.OutlineElementNavigator.Yd(pb):(this.Jqb(pb,J),this.DZ.woc(J.node,Fj.a.Ss));J=Gj.ParagraphReader.al(pb.currentNode);this.wEm(pb);this.jh&&Ta&&this.uOg&&(ma=new kb.a,ma.add(pb.currentNode),this.uOg.joh(ma,Ta.id));this.gko(J);Wb.dispose();return 32}gko(J){J=ke.SelectionFactory.ne(J,0);Ll.a.instance.Ac(J)}wEm(J){this.rh.My(J,
!0,!0,null,!1,!1);J=Uk.OutlineElementNavigator.Ee(J);this.fDm(J)}Jqb(J,ma){const Ta=Uk.OutlineElementNavigator.Yd(J);if(ma.cpBegin||this.jh&&(!this.jh||-1!==ma.Fb)){db.App.zd.Uo&&ma.cpBegin!==Gj.ParagraphReader.textLength(ma.node)&&db.App.zd.fq.gG(ma.node);this.rh.My(J,!1,!0,null,!1,!0);var pb=vm.GraphIterator.WX(this.Yc.Ek());pb.set(Ta);this.rh.S$(pb,J,ma,!0,!0,!0)}}fDm(J){J=this.P_j(J);this.vKa.fti(J)}static gF(){return new nl(new Wh.a,new bk.a,pa.a.instance.resolve("Box4.IAutoCorrectScheduler"),
wo.a.instance,pa.a.instance.resolve("Box4.IOutlineElementEditor"),pa.a.instance.resolve("Box4.IBlobEditor"),pa.a.instance.Oa("Box4.IContentControlReader"),pa.a.instance.Oa("Box4.IContentControlEditor"),pa.a.instance.Ta("Box4.IContentControlConverter"),pa.a.instance.Oa("Box4.ContentControlConfigSettings"),pa.a.instance.resolve("Box4.List.IListReader"))}static get instance(){return null!=nl.OCg?nl.OCg:nl.OCg=nl.gF()}static tw(J){return xg.a.tw(J)}}Object(e.a)(nl,"PageBreakInserter",null,[1970]);class Il{constructor(J,
ma,Ta,pb,Wb,Jc,Zc,jd){this.zEm=(dd,Ld,$d,le)=>{var ae=Ld.view,Oe=ae.mb.qg;if(!Oe)return 2;if(!this.F7e(Ld))return 8;if(1===$d)return 32;let ef=!0;$d=8;const oh=this.BHe(Oe);Oe=this.Lc.Pc(15);Oe.Db(ae.ed);Oe.Uj=dd;oh||($d=this.ga.Nf(Ld,ti.a.Qna,2,!0,le,null),dd=32===$d,za.ULS.shipAssertTag(4208012,314,dd),ef=dd);ef&&(ae=ae.mb.qg,dd=this.BHe(ae),za.ULS.shipAssertTag(4208013,314,dd,"{0}",{["ContextId"]:Ld.contextId}),$d=8,dd&&($d=this.mFe.Hsi(ae),za.ULS.shipAssertTag(4208014,314,32===$d)));Oe.dispose();
32===$d&&this.Vd.Zs(10);return $d};this.yEm=(dd,Ld,$d)=>{if(!Ld||Ld.contextId!==Uh.a.Uc)return 8;if(1===$d)return Ld.contextId===Uh.a.Uc?32:8;if(2===$d){if(!this.F7e(Ld))return 8;dd=this.mFe.Hsi(Ld);32===dd&&this.Vd.Zs(10);return dd}return 32};this.xEm=(dd,Ld,$d)=>{if(!Ld||Ld.contextId!==Uh.a.table)return 8;if(1===$d)return 32;if(2===$d){if(!this.F7e(Ld))return 8;dd=this.mFe.dDm(Ld);32===dd&&this.Vd.Zs(10);return dd}return 32};this.ga=J;this.mFe=ma;this.Lc=Ta;this.en=pb;this.BHe=Wb;this.Ok=Jc;this.Q8j=
Zc;this.Vd=jd}Tb(){this.ga.ra(hh.a.hGa,Uh.a.view,this.zEm);this.ga.ra(hh.a.hGa,Uh.a.Uc,this.yEm);this.ga.ra(hh.a.hGa,Uh.a.table,this.xEm);this.ga.Xc(hh.a.hGa,4)}E5(){const J=Xf.FocusManager.instance().fe(Hr.AppFrame.VD);eg.AFrame.Ci(J,Me.KeyInputManager.ic(Fj.a.Ss,Me.KeyInputManager.Rh),hh.a.hGa)}wPm(J){return this.lx(J.iterator)}cTm(J){J=J.J(0);const ma=xe.SelectionEditor.Jj(J,!0,!1);if(this.lx(ma.Pa.iterator))return!0;J=xe.SelectionEditor.Jj(J,!1,!1);return this.lx(J.Pa.iterator)}lx(J){return J.zb(14)}F7e(J){let ma=
null,Ta=J;if(Ta.contextId===Uh.a.view){ma=Ta.view;if(!ma.features.wkg)return!1;Ta=ma.mb.qg;if(!Ta)return!1}else{const pb=vm.GraphIterator.eb(Ta.node);if(pb.zb(36)||pb.zb(38)||pb.zb(40)||pb.zb(14))return!1}return Mj.a.sia(J)?!1:Ta.contextId===Uh.a.table?this.Ok.gPm(Ta.node):!this.Ok.ePm(Ta)||this.en&&this.en.instance&&this.en.instance.SU(Ta)?!1:((J=this.BHe(Ta))?this.wPm(Ta):this.cTm(ma.mb.ib))||J&&this.Q8j(Ta,!0)?!1:!0}static gF(){return new Il(l.AFrameworkApplication.va,nl.instance,new bk.a,pa.a.instance.Ta("Box4.IExternalSelectionManager"),
xe.SelectionEditor.Ze,Gl.a.instance,Pd.a.Ixa,pa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get instance(){return null!=Il.HBg?Il.HBg:Il.HBg=Il.gF()}}Object(e.a)(Il,"PageBreakActor",null,[1942]);class Qp{constructor(){this.BNe=this.W=null}get name(){return"WordEditor.PageBreak"}wc(J){this.W=J}init(){this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{this.wn()})}wn(){this.BNe=Il.instance;this.BNe.Tb();this.BNe.E5();db.App.za.updateCommandUI()}dispose(){}}
Object(e.a)(Qp,"PackageManager",null,[1,2]);var Tl=c(1504),Vq=c(1505),mo=c(274),bm=c(178),Rp=c(252),Pl=c(278),Vk=c(446);class Cn{constructor(J,ma,Ta,pb,Wb,Jc,Zc){this.eyb=null;this.sa=new S.a;this.Xxe=1;this.tqd=-1;this.HYa=null;this.xqa=()=>{this.k6e()};this.hb=ma;this.Ib=Ta;this.qkd=pb;this.hM=Wb;this.jz=Jc;this.bga=Zc;this.enable()}get bKd(){return this.Xxe}Moj(J){this.Xxe!==J&&(this.Xxe=J,this.sa.raiseEvent("X"),this.l0d&&this.Ypg())}get l0d(){const J=pa.a.instance.Oa("WordEditor.Pagination.IPageEndMarkers");
return J?J.l0d:!0}get Fk(){return this.hM.value}get Ik(){return Cc.a.instance}bxk(J){this.sa.addHandler("X",J)}Ypg(){this.Ik.ie(()=>{this.bga.nV(Vk.a.S_i)},"CPC:UPN")}enable(){this.hb.Ww(this.xqa);this.k6e()}k6e(){if(!this.HYa||1>=this.HYa.count)this.Moj(1);else{var J=this.hb.ib.lb;if(J){var ma=J.isForward?J.Tc:J.Pa;!ma||0>ma.cpBegin||(J=ma.node)&&Gj.ParagraphReader.Xb(J)&&this.NOm(J)&&(this.eyb&&(this.Ib.ff(this.eyb),this.eyb=null),this.eyb=new Kb.a(2,1,400,Ta=>{this.findCurrentPageFromIp(Ta,ma)},
62),this.Ib.Wb(this.eyb))}}}NOm(J){J=vm.GraphIterator.eb(J);return J.zb(35)||J.zb(37)||J.zb(39)?!1:!0}hHj(J){this.HYa=J;this.EFj()}EFj(){if(-1!==this.tqd){var J=this.HDl(this.tqd);-1!==J&&this.Moj(J)}}findCurrentPageFromIp(J,ma){this.eyb===J&&(this.eyb=null,this.tqd=this.$Ll(ma),-1!==this.tqd&&this.EFj())}HDl(J){if(!this.HYa)return-1;for(let ma=0;ma<this.HYa.count;ma++){const Ta=this.HYa.J(ma);if(J>Ta.Xmh&&J<Ta.Xmh+Ta.height)return Ta.Fh}return-1}$Ll(J){var ma=this.t9l(J);if(!ma||!ma.htmlElement)return-1;
const Ta=ma.getBounds();J=this.UTl(J,ma);if(!J)return-1;ma=qa.a.Y2a(this.qkd.s6a,ma.htmlElement).y;return J.y+Math.floor(J.height/2)-Ta.y+ma}t9l(J){return J.node.te(this.Fk.$b)}UTl(J,ma){J=this.jz?this.jz.Zba(J,!0):J.cpBegin;return Pl.a.Wq(ma,J)}disable(){this.hb.hZ(this.xqa)}}Object(e.a)(Cn,"CurrentPageCalculator",null,[2041,2036]);class Ro{constructor(J){Ro.PZ=J}get ddf(){return Ro.PZ}get bKd(){return this.ddf.bKd}pvl(){this.ddf.enable()}Gol(){this.ddf.disable()}}Ro.PZ=null;Object(e.a)(Ro,"CurrentPageManager",
null,[2040]);var Hq=c(119);class aa extends Sys.EventArgs{constructor(J,ma){super();this.iRi=ma}}Object(e.a)(aa,"DocumentBottomChangeEventArgs",Sys.EventArgs,[]);class oa extends Sys.EventArgs{constructor(J,ma,Ta){super();this.delta=J;this.iRi=Ta}}Object(e.a)(oa,"PageContentSizeChangeEventArgs",Sys.EventArgs,[]);class ub{static get e0a(){if(null!=ub.Iwg)var J=ub.Iwg;else{var ma;J=!(null===(ma=l.AFrameworkApplication.K)||void 0===ma||!ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.CallAfterValidateDirectlyIsEnabled",
!1));J=ub.Iwg=J}return J}constructor(J,ma,Ta){this.Sbh=this.zud=-1;this.HAc=null;this.sa=new S.a;this.DLe=!1;this.s_f=(pb,Wb)=>{this.DLe=this.ZVk();Wb.fob||this.ivc.value.measure(this.TVk)};this.TVk=()=>{const pb=this.s6a.clientHeight;this.SVk(pb);this.bWk(pb)};this.TZf=(pb,Wb)=>{Wb.property===Hq.a.vJ&&(pb=Wb.node)&&pb.ja(Hq.a.vJ,!1)&&(pb=pb.te(this.Fk.$b))&&(pb=pb.htmlElement)&&this.EYa.add(pb)};this.hM=J;this.ivc=ma;this.EYa=new kb.a;ub.e0a||this.Fk.h0e(this.s_f);this.Rzf();this.Fda=this.Fda.bind(this);
Ta.XAb(this.Fda);ub.e0a&&0===Ta.nu&&this.lN()}lN(){this.Fk.h0e(this.s_f)}lAa(){this.Fk.Kbj(this.s_f)}get Fk(){return this.hM.value}Fda(J,ma){this.HAc=null;ub.e0a&&(1===ma.hnb?this.lAa():0===ma.hnb&&this.lN())}get s6a(){this.HAc||(this.HAc=this.Fk.ed.te(this.Fk.$b).s6a,za.ULS.shipAssertTag(34136386,336,!!this.HAc));return this.HAc}pyk(J){this.sa.addHandler("OnPageContentSizeChangeKey",J)}SVk(J){J!==this.Sbh&&(this.sa.raiseEvent("OnDocumentBottomChangeKey",new aa(J,this.DLe)),this.Sbh=J)}bWk(J){J!==
this.zud&&(-1!==this.zud&&this.sa.raiseEvent("OnPageContentSizeChangeKey",new oa(J-this.zud,J,this.DLe)),this.zud=this.s6a.clientHeight)}ZVk(){let J=!1;for(let ma=this.EYa.count-1;0<=ma;ma--)this.EYa.J(ma).hasChildNodes()&&(this.EYa.removeAt(ma),J=!0);return J}Rzf(){db.App.si.Il.Ue(23).Eo(this.TZf)}}Object(e.a)(ub,"DocumentSizeManager",null,[]);var qb=c(55),Ec=c(254);class gd{constructor(J){this.hM=J}get Fk(){const J=this.hM.value;za.ULS.shipAssertTag(37820298,336,J.Zi,"OutlineManager.PageView is not a PageView.");
return J}vhe(J,ma){const Ta=qb.a.Qi(gd.Uf.GB(J),1);ma+=Ta;J.te(this.Fk.$b).htmlElement.firstChild.style.minHeight=ma+"px"}m$h(){const J=vm.GraphIterator.eb(this.Fk.ed);J.Ip();J.Rd();za.ULS.shipAssertTag(37820299,336,10===J.Gn.type);return J.Gn}Ibi(){const J=vm.GraphIterator.eb(this.Fk.ed);J.Ip();J.iY();za.ULS.shipAssertTag(37820300,336,10===J.Gn.type);return J.Gn}jam(J){const ma=vm.GraphIterator.eb(this.Fk.ed);ma.Ip();ma.Rd();let Ta=ma.Gn,pb=null;for(;J!==Ta&&ma.Oj();)pb=Ta,Ta=ma.Gn;za.ULS.shipAssertTag(37820301,
336,10===ma.Gn.type);return pb}static get Uf(){return Ec.a.instance}}Object(e.a)(gd,"OutlineManager",null,[2039]);class rd{constructor(J){this.SBa=0;this.z2=null;this.Zgg=ma=>{for(const Ta of ma.customData)this.showAdornmentText(Ta)};this.Ib=J}h9d(){this.z2||(this.z2=this.KKc())}KGd(){this.z2&&0<rd.DPc(this.z2).length&&this.Ib.Wb(this.z2);this.z2=null}KKc(){return Object.assign(new Kb.a(3,1,250,this.Zgg,166),{customData:[]})}beg(J){this.SBa=J}S$c(J){if(J){J.style.width=this.SBa+"px";if(this.z2)var ma=
this.z2;else ma=this.KKc(),this.Ib.Wb(ma);rd.DPc(ma).push(J)}}yTc(J){J&&(J.style.width="0px",this.Azf(J))}pdd(J,ma){ma?this.S$c(J):this.yTc(J)}showAdornmentText(J){J.style.width===this.SBa+"px"&&(this.RPc(J).style.visibility="visible")}Azf(J){J&&(this.RPc(J).style.visibility="hidden")}RPc(J){J=J.childNodes;za.ULS.shipAssertTag(24958351,336,1===J.length,"Expected 1 child div in the page adornment, found "+J.length);return J[0]}static DPc(J){return J.customData}}Object(e.a)(rd,"PageAdornmentAnimationManager",
null,[2038]);class Wd{constructor(J){this.nm=J;this.Waa=new Bc.a;this.Xaa=new Bc.a}VDa(J){J=vm.GraphIterator.eb(J);if(J.Ip()&&J.Wp()){J.Rd();do 10===J.Xe&&this.F1f(J.currentNode),J.It();while(8!==J.Xe)}}UQb(J){const ma=J.Fh;var Ta=this.bHb(J.nSb);if(!this.Waa.nb(Ta))return za.ULS.sendTraceTag(24958352,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+Ta),!1;J=this.Waa.J(Ta);za.ULS.shipAssertTag(24958353,336,this.Xaa.nb(Ta),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");
Ta=this.Xaa.J(Ta);return this.uzf(J,ma,Ta)}TQb(J){const ma=J.Fh;var Ta=this.bHb(J.nSb);if(!this.Waa.nb(Ta))return za.ULS.sendTraceTag(24958354,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+Ta),!1;J=this.Waa.J(Ta);za.ULS.shipAssertTag(24958355,336,this.Xaa.nb(Ta),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");Ta=this.Xaa.J(Ta);return this.lmf(J,ma,Ta)}xvf(J){if(!J)return za.ULS.sendTraceTag(24979136,
336,10,"Null container input into GetTemplateSelectionFromContainer."),0;var ma=J.wEd;if(!ma)return za.ULS.sendTraceTag(24979137,336,10,String.format("Container of page number {0} has a null EndSectionNode.",J.Fh)),0;ma=this.nm.hGb(ma);if(!ma)return za.ULS.sendTraceTag(24979138,336,10,"Header footer container node expected not to be null."),0;ma=this.nm.Yha(ma);const Ta=1===J.Fh;J=!(J.Fh%2);return 1===ma?1:2===ma?Ta?2:1:3===ma?J?3:4:Ta?2:J?3:4}F1f(J){if(10===J.type){var ma=new Bc.a,Ta=this.nm.hGb(J);
za.ULS.shipAssertTag(24958356,336,!!Ta,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var pb=this.nm.Yha(Ta);J=this.bHb(J);this.lqg(J,pb);this.kqg(J,ma);Ta=vm.GraphIterator.eb(Ta);if(Ta.Wp()){Ta.Rd();do J=Ta.currentNode,pb=this.nm.MQc(J),J=this.nm.xoi(J),ma.add(pb,J),Ta.It();while(36===Ta.Xe)}}}lqg(J,ma){this.Xaa.nb(J)?this.Xaa.Z(J,ma):this.Xaa.add(J,ma)}kqg(J,ma){this.Waa.nb(J)?this.Waa.Z(J,ma):this.Waa.add(J,ma)}bHb(J){za.ULS.shipAssertTag(24958358,
336,10===J.type,"Expected node of type Outline but received node of type "+J.type);return J.ja(Sl.a.Vja,0)}uzf(J,ma,Ta){const pb=1===ma;ma=!(ma%2);switch(Ta){case 2:if(pb){if(J.nb(2))return J.J(2)}else if(J.nb(0))return J.J(0);break;case 3:if(ma){if(J.nb(1))return J.J(1)}else if(J.nb(0))return J.J(0);break;case 4:if(pb){if(J.nb(2))return J.J(2)}else if(ma){if(J.nb(1))return J.J(1)}else if(J.nb(0))return J.J(0);break;case 1:if(J.nb(0))return J.J(0)}return!1}lmf(J,ma,Ta){const pb=1===ma;ma=!(ma%2);
switch(Ta){case 2:if(pb){if(J.nb(5))return J.J(5)}else if(J.nb(3))return J.J(3);break;case 3:if(ma){if(J.nb(4))return J.J(4)}else if(J.nb(3))return J.J(3);break;case 4:if(pb){if(J.nb(5))return J.J(5)}else if(ma){if(J.nb(4))return J.J(4)}else if(J.nb(3))return J.J(3);break;case 1:if(J.nb(3))return J.J(3)}return!1}}Object(e.a)(Wd,"PageAdornmentContentManager",null,[2037]);var De=c(1177);class Pf{constructor(J,ma,Ta,pb,Wb,Jc,Zc,jd,dd){this.qrg(J,ma,Ta,Jc,Zc,jd,dd);this.Fh=J;this.Vq=ma;this.Qr=Ta;this.nSb=
pb;this.wEd=Wb;this.pgb=Jc;this.Nac=Zc;this.N8b=jd;this.b0i=dd}get top(){return this.Vq}get height(){return this.Qr}$9c(J){this.Vq!==J&&(this.pgb.style.top=J+"px",this.Vq=J)}Edg(J){this.height!==J&&(this.pgb.style.height=J+"px",this.Qr=J)}qrg(J,ma,Ta,pb,Wb,Jc,Zc){za.ULS.shipAssertTag(37244961,336,0<J,"PageAdornmentContainer: pageNumber parameter value {0} is unexpected value.",J);za.ULS.shipAssertTag(37244962,336,0<=ma,"PageAdornmentContainer: top parameter value {0} is unexpected value.",ma);za.ULS.shipAssertTag(37244963,
336,0<=Ta,"PageAdornmentContainer: height parameter value {0} is unexpected value.",Ta,ma);za.ULS.shipAssertTag(37244992,336,!!pb,"PageAdornmentContainer: containerDomElement parameter is null.");za.ULS.shipAssertTag(37244993,336,!!Wb,"PageAdornmentContainer: headerLabelDomElement parameter is null.");za.ULS.shipAssertTag(37244994,336,!!Jc,"PageAdornmentContainer: footerLabelDomElement parameter is null.");za.ULS.shipAssertTag(37244995,336,!!Zc,"PageAdornmentContainer: pageNumberLabelDomElement parameter is null.")}}
Object(e.a)(Pf,"PageAdornmentContainer",null,[2050]);class If{constructor(J,ma,Ta,pb,Wb,Jc,Zc,jd,dd,Ld,$d,le,ae){this.DYg="headerFooterTab";this.Qyd=null;this.Ws=!0;this.BDe=0;this.MIe=null;this.u3a=!1;this.FMb=Oe=>{this.zkn(Oe.Xw);return!0};this.aC=()=>!0;this.RHb=()=>{this.yaf()&&(this.u3a=!1,this.UTo(),this.MIe=new Date)};this.JMb=Oe=>{this.u3a||this.ZV.S$c(Oe.Xw);return!0};this.IMb=Oe=>{this.u3a||(Oe=Oe.Xw,this.Ggg(Oe)||this.ZV.yTc(Oe));return!0};this.zVn=()=>{let Oe=Array.dequeue(this.fQe);for(;Oe;)this.lN(Oe),
Oe=Array.dequeue(this.fQe);this.Qyd=null};this.hM=J;this.ig=ma;this.yE=Ta;this.ala=pb;this.ga=Wb;this.tk=Jc;this.ZV=Zc;this.cBa=jd;this.SLa=dd;this.Ib=Ld;this.Ca=$d;this.fQe=[];this.u2=new Map;this.MI=le;this.zx=ae;this.SLa.lCd(this.RHb);this.Pw=!!l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Kb.tL;if(this.Rod=(this.yFe=!!this.Ca&&this.Ca.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&!!this.Ca&&this.Ca.$("DisableHeaderFooterTabForSmallScreenModeIsEnabled"))"Small"===db.App.za.aJ.getLayoutBreakpoint()&&
(this.Ws=!1),db.App.za.aJ.registerLayoutBreakpointChanged(this.DYg,Oe=>{switch(Oe){case "Small":this.Uoi();break;default:this.Usj()}})}get Fk(){return this.hM.value}Usj(){try{this.Fxo()}catch(J){za.ULS.shipAssertTag(37244997,336,!1,"Exception was caught in ShowPageAdornments. Message: {0} Stack: {1}",J.message,J.stack)}}Uoi(){try{this.Fum()}catch(J){za.ULS.shipAssertTag(37244998,336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",J.message,J.stack)}}l0n(){for(const J of this.u2.keys())this.wde(J)}VDa(){try{this.N3k()}catch(J){za.ULS.shipAssertTag(37244999,
336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",J.message,J.stack)}}hHj(J){try{this.BYo(J)}catch(ma){za.ULS.shipAssertTag(37245E3,336,!1,"Exception was caught in UpdatePageElements. Message: {0}",ma.message)}}dispose(){try{this.tSo(),this.$So(),this.SLa&&this.SLa.Sbj(this.RHb)}catch(J){za.ULS.shipAssertTag(37245001,336,!1,"Exception was caught in PageAdornmentManager.Dispose. Message: {0} Stack: {1}",J.message,J.stack)}}zkn(J){const ma=this.NWc(J),Ta=this.E7h(J);Ta?(wc.b("OpenHeaderFooterFromWebViewAdornment"),
J=this.cBa.xvf(Ta),this.ga.Qb(ma?hh.a.vpe:hh.a.wed,2,J),this.u3a=!0):(za.ULS.sendTraceTag(37245002,336,10,"GetContainerFromElement returned a null container for element with id "+J.id),this.ga.processAction(hh.a.YXd,2))}tSo(){this.u2.forEach(J=>{this.lAa(J)})}$So(){this.Pw&&(this.Rod&&(db.App.za.aJ.unregisterLayoutBreakpointChanged(this.DYg),this.Rod=!1),this.Pw=!1)}lAa(J){if(J){var ma=J.Nac;J=J.N8b;Yi.a.Xpa(ma)&&Yi.a.Xpa(J)?(this.tk.sc(V.a.WR,ma,this.JMb),this.tk.sc(V.a.WR,J,this.JMb),this.tk.sc(V.a.xL,
ma,this.IMb),this.tk.sc(V.a.xL,J,this.IMb),this.ig.sc(V.a.click,ma,this.FMb),this.ig.sc(V.a.click,J,this.FMb),this.yE.sc(ma,If.wMb),this.yE.sc(J,If.wMb),this.ala.sc(V.a.Wx,ma,this.aC),this.ala.sc(V.a.Wx,J,this.aC)):za.ULS.sendTraceTag(37245003,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}pNn(J){this.fQe.push(J);this.Qyd||(this.Qyd=new Kb.a(2,1,50,this.zVn),this.Ib.Wb(this.Qyd))}lN(J){if(J){var ma=J.Nac;J=J.N8b;Yi.a.Xpa(ma)&&Yi.a.Xpa(J)?(this.tk.ob(V.a.WR,
ma,this.JMb),this.tk.ob(V.a.WR,J,this.JMb),this.tk.ob(V.a.xL,ma,this.IMb),this.tk.ob(V.a.xL,J,this.IMb),this.ig.ob(V.a.click,ma,this.FMb),this.ig.ob(V.a.click,J,this.FMb),this.yE.ob(ma,If.wMb),this.yE.ob(J,If.wMb),this.ala.ob(V.a.Wx,ma,this.aC),this.ala.ob(V.a.Wx,J,this.aC)):za.ULS.sendTraceTag(37245004,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}Fxo(){if(!this.Ws){for(const J of this.u2.values())J.pgb.style.display="block";this.Ws=!0}}Fum(){this.Ws&&
(this.u2.forEach(J=>{J.pgb.style.display="none"}),this.Ws=!1)}N3k(){this.cBa.VDa(this.Fk.ed)}BYo(J){this.ZV.h9d();var ma=0;const Ta=new kb.a;this.VDa();const pb=this.q2l();for(var Wb of J)J=Wb.Fh,this.Xyn(Wb)||this.wde(Wb.Fh),this.u2.has(J)?this.jVo(Wb):this.q$k(Wb),ma=J,Ta.add(J);for(Wb=1;Wb<=ma;Wb++)Ta.contains(Wb)||this.wde(Wb);for(ma+=1;ma<=pb;ma++)this.wde(ma);this.ZV.KGd()}Xyn(J){return this.u2.has(J.Fh)?this.u2.get(J.Fh).nSb.id===J.nSb.id:!1}q2l(){let J=0;this.u2.forEach((ma,Ta)=>{Ta>J&&(J=
Ta)});return J}q$k(J){const ma=J.nSb.te(this.Fk.$b);if(ma){var Ta=J.Fh;J=this.vKc(Ta,J.top,J.height,ma.gca,J.nSb,J.wEd);this.pNn(J);this.epg(J);this.Aqg(J);this.Rod&&!this.Ws&&(J.pgb.style.display="none");this.u2.set(Ta,J)}}vKc(J,ma,Ta,pb,Wb,Jc){const Zc=Jh.b("div","","PageAdornmentContainer");Zc.style.top=ma+"px";Zc.style.height=Ta+"px";pb.appendChild(Zc);this.l6e(Zc,WordEditorIntl.WordEditorStrings.l_Header,WordEditorIntl.WordEditorStrings.l_Footer);pb=this.Qbf(J);Zc.appendChild(pb);const jd=this.pbf(J);
Zc.appendChild(jd);const dd=this.fbf(J);Zc.appendChild(dd);l.AFrameworkApplication.isRtl&&(Zc.classList.add("Rtl"),jd.classList.add("Rtl"),dd.classList.add("Rtl"));return new Pf(J,ma,Ta,Wb,Jc,Zc,jd,dd,pb)}pbf(J){J=Jh.b("div","h"+J,this.zx?"PageAdornmentHeaderLabelThemed":"PageAdornmentHeaderLabel");this.MI&&(this.zx?J.classList.add("PageAdornmentHeaderFooterBorderThemed"):J.style.borderColor=De.a.Npe);const ma=Jh.b("span","","");ma.innerText=WordEditorIntl.WordEditorStrings.l_Header;ma.style.whiteSpace=
"nowrap";J.appendChild(ma);return J}fbf(J){J=Jh.b("div","f"+J,this.zx?"PageAdornmentFooterLabelThemed":"PageAdornmentFooterLabel");this.MI&&(this.zx?J.classList.add("PageAdornmentHeaderFooterBorderThemed"):J.style.borderColor=De.a.Npe);const ma=Jh.b("span","","");ma.innerText=WordEditorIntl.WordEditorStrings.l_Footer;ma.style.whiteSpace="nowrap";J.appendChild(ma);return J}Qbf(J){const ma=Jh.b("div","","PageAdornmentNumberLabel");ma.innerText=J.toString();return ma}l6e(J,ma,Ta){if(!this.BDe){const pb=
Jh.b("p","","");pb.innerText=ma;pb.style.whiteSpace="nowrap";pb.style.visibility="hidden";J.appendChild(pb);ma=Jh.b("p","","");ma.innerText=Ta;ma.style.whiteSpace="nowrap";ma.style.visibility="hidden";J.appendChild(ma);this.BDe=J.clientWidth;this.ZV.beg(this.BDe);J.removeChild(pb);J.removeChild(ma)}}wde(J){if(this.u2.has(J)){var ma=this.u2.get(J);this.lAa(ma);Yi.a.qx(ma.pgb);this.u2.delete(J)}}jVo(J){if(this.u2.has(J.Fh)){var ma=this.u2.get(J.Fh);ma.$9c(J.top);ma.Edg(J.height);this.epg(ma);this.Aqg(ma)}else za.ULS.sendTraceTag(37245005,
324,15,"We called UpdateContainerForPage, but a container doesn't exist for the given page.")}UTo(){this.ZV.h9d();this.VDa();this.u2.forEach(J=>{this.epg(J);this.Aqg(J)});this.ZV.KGd()}epg(J){const ma=J.Nac,Ta=J.N8b,pb=this.cBa.UQb(J),Wb=this.cBa.TQb(J);this.L_o(J,pb,Wb);this.ZV.pdd(ma,pb);this.ZV.pdd(Ta,Wb)}L_o(J,ma=!0,Ta=!0){const pb=J.Nac;J=J.N8b;3!==l.AFrameworkApplication.va.mode?(pb.title=WordEditorIntl.WordEditorStrings.l_OpenHeader,J.title=WordEditorIntl.WordEditorStrings.l_OpenFooter):(pb.title=
ma?WordEditorIntl.WordEditorStrings.l_EditHeader:WordEditorIntl.WordEditorStrings.l_AddHeader,J.title=Ta?WordEditorIntl.WordEditorStrings.l_EditFooter:WordEditorIntl.WordEditorStrings.l_AddFooter)}Ggg(J){const ma=this.E7h(J);return ma?this.NWc(J)?this.cBa.UQb(ma):this.cBa.TQb(ma):(za.ULS.sendTraceTag(37245006,336,10,"GetContainerFromElement returned null."),!1)}E7h(J){J=J.id;J=J.substring(1,J.length);J=Number.parseInvariant(J);return this.u2.has(J)?this.u2.get(J):(za.ULS.sendTraceTag(37245007,336,
10,"Adornment container map does not contain the page number "+J),null)}NWc(J){return J.id.length?"h"===J.id.substring(0,1):(za.ULS.sendTraceTag(37245008,336,10,"Empty ID found for adornment"),!0)}Aqg(J){const ma=J.height;ma<If.ken?(J.Nac.classList.add(If.bkb),J.N8b.classList.add(If.bkb)):(J.Nac.classList.remove(If.bkb),J.N8b.classList.remove(If.bkb));ma<If.men?(J.b0i.classList.add(If.bkb),J.pgb.classList.add(If.bkb)):(J.b0i.classList.remove(If.bkb),J.pgb.classList.remove(If.bkb))}yaf(){return!this.MIe||
Y.a.lzf(this.MIe,500)}static wMb(){return!0}}If.bkb="Hidden";If.ken=120;If.men=50;Object(e.a)(If,"PageAdornmentManager",null,[2035,9,2036]);class Vg{constructor(J,ma){this.R9d=new kb.a;this.R9d.add(J);this.R9d.add(ma)}}Object(e.a)(Vg,"PageElementManagerList",null,[]);var tg=c(58);class ag{constructor(J,ma,Ta){this.kn=J;this.NZb=[];this.GK=ma;this.MI=Ta}H$i(){for(let J=0,ma=this.NZb.length;J<ma;J++)Yi.a.qx(this.NZb[J]);Array.clear(this.NZb)}i9h(J,ma,Ta,pb,Wb,Jc){let Zc=Math.min(pb.x-Jc.x,Wb.x-Jc.x);
pb=Math.min(Jc.x+Jc.width-(pb.x+pb.width),Jc.x+Jc.width-(Wb.x+Wb.width));ma+=Wb.y-Jc.y;({kja:ma,leftMargin:Zc,rightMargin:pb}=this.JAk(ma,Zc,pb));J=this.t8l(J,Zc,pb,Zc,pb,Ta);J.style.top=ma+"px";J.style.zIndex="0";this.NZb.push(J);tg.d(J,!0);return J}qTd(J){return J?J.querySelector(".PageBreakBorderSpan"):null}t8l(J,ma,Ta,pb,Wb,Jc){return J?this.Vgm(ma,Ta,pb,Wb,Jc):this.N8l(pb,Wb,Jc)}JAk(J,ma,Ta){ma/=this.kn.instance.nj;Ta/=this.kn.instance.nj;J/=this.kn.instance.nj;return{kja:J,leftMargin:ma,rightMargin:Ta}}YNm(J){return this.HEi(J)&&
this.Y_i(J)?(J=this.QGb(J))&&J.offsetParent?!1:!0:!1}XNm(J){return!this.HEi(J)||this.Y_i(J)?!1:!0}TR(){}QGb(J){if(!J.Z_f)return null;let ma=null;J.hlb&&!J.mda?(J=this.qTd(J.Z_f))&&(ma=J):ma=J.Z_f;return ma}HEi(J){return J.hlb&&!J.mda&&J.paragraphNode?!0:!1}Y_i(J){J=J.paragraphNode;return!!J&&!!J.anchor}jBh(J,ma){J=qa.a.lFa(J);ma=qa.a.lFa(ma);return(J-ma)/this.kn.instance.nj}q6e(J,ma){J=qa.a.lFa(J);ma=qa.a.lFa(ma);return(J-ma)/this.kn.instance.nj}$_c(){this.jHj(!1)}Z_c(){this.jHj(!0)}jHj(J){for(let ma=
0,Ta=this.NZb.length;ma<Ta;ma++){const pb=this.NZb[ma];"PageEndMarker.Para"===pb.id?ag.nHj(pb,J):"PageEndMarker.Table"===pb.id&&ag.gIj(pb,J)}}N8l(J,ma,Ta){if(!ag.I1b){ag.I1b=Jh.b("div","PageEndMarker.Para","PageEndMarker");var pb=Jh.b("div","","Current FullWidth");this.MI&&(pb.style.borderTopColor=this.GK.Pwa());ag.I1b.appendChild(pb);pb=Jh.b("div","","Stale LeftWing");const Wb=Jh.b("div","","Stale RightWing");this.MI&&(pb.style.borderTopColor=this.GK.Pwa(),Wb.style.borderTopColor=this.GK.Pwa());
ag.I1b.appendChild(pb);ag.I1b.appendChild(Wb)}pb=ag.I1b.cloneNode(!0);pb.childNodes[1].style.width=J-10+"px";pb.childNodes[2].style.width=ma-10+"px";ag.nHj(pb,Ta);return pb}Vgm(J,ma,Ta,pb,Wb){if(!ag.fAb){ag.fAb=Jh.b("div","PageEndMarker.Table","PageEndMarker");var Jc=Jh.b("div","","Current LeftWing"),Zc=Jh.b("div","","Current RightWing");this.MI&&(Jc.style.borderTopColor=this.GK.Pwa(),Zc.style.borderTopColor=this.GK.Pwa());ag.fAb.appendChild(Jc);ag.fAb.appendChild(Zc);Jc=Jh.b("div","","Stale LeftWing");
Zc=Jh.b("div","","Stale RightWing");this.MI&&(Jc.style.borderTopColor=this.GK.Pwa(),Zc.style.borderTopColor=this.GK.Pwa());ag.fAb.appendChild(Jc);ag.fAb.appendChild(Zc)}Jc=ag.fAb.cloneNode(!0);Jc.childNodes[0].style.width=J+"px";Jc.childNodes[1].style.width=ma+"px";Jc.childNodes[2].style.width=Ta-10+"px";Jc.childNodes[3].style.width=pb-10+"px";ag.gIj(Jc,Wb);return Jc}static nHj(J,ma){ma?ag.f$m(J):ag.g$m(J)}static g$m(J){J.childNodes[0].style.display="none";J.childNodes[1].style.display="block";J.childNodes[2].style.display=
"block"}static f$m(J){J.childNodes[0].style.display="block";J.childNodes[1].style.display="none";J.childNodes[2].style.display="none"}static gIj(J,ma){ma?ag.l$m(J):ag.m$m(J)}static m$m(J){J.childNodes[0].style.display="none";J.childNodes[1].style.display="none";J.childNodes[2].style.display="block";J.childNodes[3].style.display="block"}static l$m(J){J.childNodes[0].style.display="block";J.childNodes[1].style.display="block";J.childNodes[2].style.display="none";J.childNodes[3].style.display="none"}}
ag.I1b=null;ag.fAb=null;Object(e.a)(ag,"PageEndDOMHelper",null,[]);class Ci{constructor(J,ma){this.oyb=this.Zbh=null;this.kn=J;this.ti=ma}Hjg(J,ma){try{this.xEo(J,ma)}catch(Ta){za.ULS.sendTraceTag(35005339,336,10,"Exception was caught in PageEndMarkerPositionComparer.StorePositions. Message: {0}",Ta.message)}}k3k(J,ma,Ta,pb,Wb,Jc){this.ti.ie(()=>{try{this.l3k(J,ma,Ta,pb,Wb,Jc)}catch(Zc){za.ULS.sendTraceTag(35005341,336,10,"Exception was caught in PageEndMarkerPositionComparer.ComparePositions. Message: {0}",
Zc.message)}},"PEMPC:CP")}xEo(J,ma){this.Zbh=J;this.oyb=ma}l3k(J,ma,Ta,pb,Wb,Jc){var Zc=this.Zbh;if(Zc&&J){var jd=Zc.count,dd=J.count;if(jd&&dd){var Ld=this.jEl(Zc,J);if(Ld.count){var $d=this.kn.nj,le=this.m5b(Ld)/$d,ae=this.cIh(Ld)/$d;J=this.NOd(Zc,J);if(J.count){Zc=this.m5b(J)/$d;$d=this.cIh(J)/$d;var Oe=!0;for(var ef=0;ef<Ld.count;ef++)if(Ld.J(ef)){Oe=!1;break}var oh=ef=0;this.oyb&&ma&&(ef=this.PQk(this.oyb,ma),oh=ma.count-this.oyb.count);za.ULS.sendTraceTag(35005343,336,50,"{0}",{["HardPageBreakExists"]:pb,
["EstimatedPageCount"]:jd,["CalculatedPageCount"]:dd,["InOrderAverageDelta"]:le,["InOrderStandardDeviation"]:ae,["ShortestAverageDelta"]:Zc,["ShortestStandardDeviation"]:$d,["PositionsShouldBeUpdated"]:Ta,["DocumentHeightChanged"]:Wb,["DeltasAllZero"]:Oe,["HeaderFooterOpenSinceLastResponse"]:Jc,["DeltaInViewport"]:ef,["ChangeInViewportMarkerCount"]:oh});Wb||Jc||Oe||(za.ULS.sendTraceTag(36557839,336,15,"Assumed redundant pagination request but there were changes in the page end marker positions."),
ma=Ld.toArray().toString(),Ta=J.toArray().toString(),za.ULS.sendTraceTag(35726603,336,50,"{0} {1}",ma,Ta))}}}}else za.ULS.sendTraceTag(35005342,336,10,"estimatedPositions or calculatedPositions are null in PageEndMarkerPositionComparer.ComparePositionsInternal.")}PQk(J,ma){const Ta=new kb.a;for(const pb of J)Ta.add(pb.top);if(!Ta.count)return-1;J=new kb.a;for(const pb of ma)J.add(pb.top);if(!J.count)return-1;ma=this.NOd(Ta,J);return this.m5b(ma)/this.kn.nj}m5b(J){if(!J.count)return 0;let ma=0;for(let Ta=
0;Ta<J.count;Ta++)ma+=J.J(Ta);return ma/J.count}cIh(J){if(!J.count)return 0;const ma=this.m5b(J);let Ta=0;for(let pb=0;pb<J.count;pb++){const Wb=J.J(pb)-ma;Ta+=Wb*Wb}return Math.sqrt(Ta/J.count)}jEl(J,ma){const Ta=new kb.a;if(!J.count||!ma.count)return Ta;J.Sc((Wb,Jc)=>Wb-Jc);ma.Sc((Wb,Jc)=>Wb-Jc);const pb=Math.min(J.count,ma.count);for(let Wb=0;Wb<pb;Wb++){const Jc=Math.abs(J.J(Wb)-ma.J(Wb));Ta.add(Jc)}return Ta}NOd(J,ma){const Ta=new kb.a;if(!J.count||!ma.count)return Ta;var pb=J.count<=ma.count;
const Wb=pb?J:ma;J=pb?ma:J;for(ma=0;ma<Wb.count;ma++){pb=Wb.J(ma);let Zc=Math.abs(pb-J.J(0)),jd=0;for(let dd=1;dd<J.count;dd++){var Jc=J.J(dd);Jc=Math.abs(pb-Jc);Jc<Zc&&(Zc=Jc,jd=dd)}Ta.add(Zc);J.removeAt(jd)}return Ta}}Object(e.a)(Ci,"PageEndMarkerPositionComparer",null,[2034]);var Dg=c(393),Te=c(596);class sj{constructor(J,ma,Ta,pb,Wb,Jc,Zc,jd,dd,Ld){this.Vq=J;this._pageNumber=ma;this.hlb=Ta;this.mda=pb;this.Z_f=Wb;this.outlineNode=Jc;this.outlineGroupNode=Zc;this.bah=jd;this.paragraphNode=dd;this.kV=
Ld}get top(){return this.Vq}get Fh(){return this._pageNumber}get syn(){return this.bah}$9c(J){this.Vq=J}whe(J){this._pageNumber=J}Xmj(J){this.bah=J}}Object(e.a)(sj,"PageEndMarker",null,[]);class fk{constructor(){this.jf=null;this.qRi=0}}Object(e.a)(fk,"PageEndMarkerToRestore",null,[]);class ol{constructor(J,ma,Ta,pb,Wb,Jc,Zc){this.TZf=(jd,dd)=>{dd.property===Hq.a.vJ&&(jd=dd.node)&&jd.ja(Hq.a.vJ,!1)&&this.CAd.contains(jd.id)&&(dd=jd.te(this.Fk.$b))&&(dd=dd.htmlElement)&&(this.CAd.remove(jd.id),this.EYa.add(dd))};
this.hM=J;this.kn=ma;this.OMa=Ta;this.py=pb;this.FNe=Wb;this.h_=Jc;this.Sq=Zc;this.xt=new kb.a;this.OZb=new kb.a;this.eAb=new Bc.a;this.CAd=new Te.a(new Dg.a);this.EYa=new kb.a;this.RZb=!!Wb;this.Rzf()}get Fk(){const J=this.hM.value;za.ULS.shipAssertTag(37052750,336,J.Zi,"PageEndMarkerPositionUpdater.PageView is not a PageView.");return J}Noc(J){try{this.bYo(J)}catch(ma){this.py.TR(ma.message+" "+ma.stack),za.ULS.sendTraceTag(38405270,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateMarkers. Exception: {0}",
ma.message)}}Juk(J){try{this.Kuk(J)}catch(ma){this.py.TR(ma.message+" "+ma.stack),za.ULS.sendTraceTag(38405271,336,10,"Exception caught in PageEndMarkerPositionUpdater.AddRenderedMarker. Exception: {0}",ma.message)}}NRk(J){try{return this.ORk(J)}catch(ma){this.py.TR(ma.message+" "+ma.stack),za.ULS.sendTraceTag(37052752,336,10,"Exception caught in PageEndMarkerPositionUpdater.CalculatePositions. Exception: {0}",ma.message)}return!1}c8n(){try{this.d8n()}catch(J){this.py.TR(J.message+" "+J.stack),za.ULS.sendTraceTag(37052753,
336,10,"Exception caught in PageEndMarkerPositionUpdater.RestorePositions. Exception: {0}",J.message)}}NRc(){try{return this.Gbm()}catch(J){return this.py.TR(J.message+" "+J.stack),za.ULS.sendTraceTag(38405273,336,10,"Exception caught in PageEndMarkerPositionUpdater.GetRenderedPageEndMarkers. Exception: {0}",J.message),null}}jqg(){try{this.FZo()}catch(J){this.py.TR(J.message+" "+J.stack),za.ULS.sendTraceTag(37820302,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateSectionLastPageHeight. Exception: {0}",
J.message)}}V7e(){try{return this.yXk()}catch(J){return this.py.TR(J.message+" "+J.stack),za.ULS.sendTraceTag(38405274,336,10,"Exception caught in PageEndMarkerPositionUpdater.CheckVirtualizedHardBreaks. Exception: {0}",J.message),!1}}oEm(J){try{this.pEm(J)}catch(ma){this.py.TR(ma.message+" "+ma.stack),za.ULS.sendTraceTag(38916953,336,10,"Exception caught in PageEndMarkerPositionUpdater.InsertOrDeleteRenderedMarkers. Exception: {0}",ma.message)}}bYo(J){if(J){this.gZk();for(let ma=0;ma<J.length;ma++){const Ta=
ma+1,pb=this.Z4k(J[ma],Ta);this.xt.add(pb);this.eAb.add(Ta,pb)}}}pEm(J){let ma=!1;for(const Ta of J)if(Ta)if(0<Ta.Vy)for(const pb of Ta.GCf)ma=this.VBd(pb,Ta.outlineGroupNode)||ma;else if(0>Ta.Vy){ma=!0;for(const pb of Ta.ZKd)this.dll(pb.Fh)}ma&&this.s9f()}Kuk(J){const ma=this.I7h(J.paragraphNode);this.VBd(J,ma)&&this.s9f()}dll(J){const ma=J-1;0>ma||this.xt.count<=ma||(this.xt.removeAt(ma),this.eAb.nb(J)&&this.eAb.remove(J))}Gbm(){const J=new kb.a;for(const ma of this.xt)this.xdc(ma)&&J.add(ma);return J}VBd(J,
ma){if(!J)return za.ULS.sendTraceTag(38385033,336,15,"pageEndDetails is null in PageEndMarkerPositionUpdater.AddRenderedMarkerInternal."),!1;ma=this.X4k(J,ma);J=J.vJm?-1:J.Fh;let Ta=!1,pb;this.eAb.nb(J)?(pb=this.eAb.J(J).Fh,ma.whe(pb),this.xt.Z(pb-1,ma),this.eAb.remove(J)):(pb=ma.Fh,this.xt.insert(pb-1,ma),Ta=!0);return Ta}Z4k(J,ma){return new sj(0,ma,J.HardBreak,!1,null,null,null,0,null,null)}X4k(J,ma){const Ta=J.kob,pb=J.Fh,Wb=J.kV,Jc=!!Wb&&Wb.HardBreak,Zc=J.mda,jd=J.paragraphNode,dd=this.Udi(ma),
Ld=J.outlineNode;var $d=this.itf(Ld);if(!$d)return za.ULS.sendTraceTag(37782370,336,15,"Given an outline node with a null DOM element in ConstructPageEndMarker."),null;let le=null;Jc&&(le=this.py.qTd(J.kob));J=this.py.jBh(le||Ta,dd);$d=this.py.q6e(le||Ta,$d);return new sj($d,pb,Jc,Zc,Ta,Ld,ma,J,jd,Wb)}ORk(J){this.OZb=new kb.a;this.RZb&&this.FNe.reset();this.c_n();this.vAo();this.KAk();this.BRk(J);return 0<this.OZb.count}c_n(){for(let J=0;J<this.xt.count;J++){const ma=this.xt.J(J);this.py.YNm(ma)?
this.B8m(ma):(this.py.XNm(ma)||this.xdc(ma)&&!this.itf(ma.outlineNode))&&this.Paj(ma)}}KAk(){let J=0,ma=null;var Ta=0;let pb=0;for(let Wb=0;Wb<this.xt.count;Wb++){const Jc=this.xt.J(Wb);this.xdc(Jc)&&(Jc.hlb&&(pb+=this.gBh(Jc,Ta,pb)),ma&&ma.id===Jc.outlineNode.id||(ma=Jc.outlineNode,pb=J=0),Jc.hlb&&!Jc.mda&&(J=this.zRk(Jc)),Ta=Jc.top+J+pb,Jc.$9c(Ta))}this.gBh(null,Ta,pb);this.VZn()}gBh(J,ma,Ta){let pb=null;this.RZb&&(pb=this.FNe.CRk(J,ma,Ta));return pb?pb.delta:0}d8n(){if(this.OZb){for(let J=0;J<
this.OZb.count;J++){const ma=this.OZb.J(J);Yi.a.nio(ma.jf,ma.qRi)}this.RZb&&this.FNe.$7n()}}FZo(){if(!this.RZb){var J=this.OMa.Ibi();if(this.xt.count){var ma=this.OMa.m$h();for(let Wb=0;Wb<this.xt.count;Wb++){var Ta=this.xt.J(Wb);if(this.xdc(Ta)&&Ta.mda){Ta=this.OMa.jam(Ta.outlineNode);var pb=0<Wb?this.xt.J(Wb-1).outlineNode:ma;pb=Wb&&Ta.id===pb.id?this.xt.J(Wb-1).top:0;this.OMa.vhe(Ta,pb)}}ma=this.xt.J(this.xt.count-1);ma.mda?this.OMa.vhe(J,0):this.OMa.vhe(J,ma.top)}else this.OMa.vhe(J,0)}}vAo(){this.xt.Sc((J,
ma)=>J.Fh-ma.Fh)}s9f(){for(let J=0;J<this.xt.count;J++)this.xt.J(J).whe(J+1)}zRk(J){return J?this.iBh(J)-J.top:(za.ULS.sendTraceTag(37306776,336,15,"CalculatePageEndMarkerDelta called with a null PageEndMarker."),0)}LRk(J){if(!J)return 0;const ma=this.Udi(J.outlineGroupNode);return ma?this.py.jBh(this.py.QGb(J),ma):0}iBh(J){if(!J)return 0;const ma=this.py.QGb(J);J=this.itf(J.outlineNode);return J?this.py.q6e(ma,J):(za.ULS.sendTraceTag(37782371,336,50,"The given pageEndMarker contains an outline node with a null DOM element in CalculatePageEndMarkerPosition."),
0)}VZn(){let J=0,ma=!1,Ta=null,pb=!1;for(let Wb=this.xt.count-1;0<=Wb;Wb--){const Jc=this.xt.J(Wb);this.xdc(Jc)&&(Ta&&Ta.id===Jc.outlineNode.id||(ma=!Ta,Ta=Jc.outlineNode,J=this.c8l(Ta)),Jc.hlb?(ma=!1,J=Jc.top):this.RZb&&ma||!(Jc.top>J)||(this.Paj(Jc),Yi.a.qx(this.py.QGb(Jc)),pb=!0))}pb&&this.s9f()}Paj(J){this.xt.contains(J)&&(this.RZb&&this.h_.m0n(J),this.xt.remove(J))}xdc(J){return J?(J=this.py.QGb(J))&&J.offsetParent?!0:!1:(za.ULS.sendTraceTag(38385035,324,50,"PageEndMarker is null in IsPageEndMarkerRendered."),
!1)}yXk(){let J=!1;for(let ma=this.EYa.count-1;0<=ma;ma--)this.EYa.J(ma).hasChildNodes()&&(this.EYa.removeAt(ma),J=!0);return J}B8m(J){(J=this.I7h(J.paragraphNode))&&(this.CAd.contains(J.id)||this.CAd.add(J.id))}Rzf(){this.Sq&&this.Sq.Ue(23).Eo(this.TZf)}BRk(J){for(let ma=this.xt.count-1;0<=ma;ma--){const Ta=this.xt.J(ma);this.xdc(Ta)&&this.ARk(Ta,J)}}ARk(J,ma){const Ta=this.iBh(J),pb=this.LRk(J);J.hlb?(J.$9c(Ta),J.Xmj(pb)):(ma=ma?Ta-J.top:pb-J.syn,J.$9c(Ta-ma),J.Xmj(pb-ma),1<Math.abs(ma)&&this.Wmo(this.py.QGb(J),
ma))}itf(J){if(!J)return null;J=J.te(this.Fk.$b);return J?J.htmlElement:(za.ULS.sendTraceTag(37782401,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeTop."),null)}Udi(J){return J?(J=J.te(this.Fk.$b))?J.htmlElement:null:null}I7h(J){J=vm.GraphIterator.eb(J);return J.zb(23)?J.jd(23):null}b8l(J){if(!J)return null;J=J.te(this.Fk.$b);return J?qa.a.getElementBounds(J.htmlElement):(za.ULS.sendTraceTag(37888197,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeBounds."),null)}c8l(J){return(J=
this.b8l(J))?J.height/this.kn.nj:0}Wmo(J,ma){ma=(Yi.a.QWl(J)-ma)*this.kn.nj;this.OZb.add(Object.assign(new fk,{jf:J,qRi:ma}))}gZk(){this.xt=new kb.a;this.eAb=new Bc.a}}Object(e.a)(ol,"PageEndMarkerPositionUpdater",null,[2033]);var Rg=c(367),hn=c(32),Jm=c(354),un=c(21),cm;(function(J){J[J.para=0]="para";J[J.tableSplit=1]="tableSplit";J[J.tableRowSplit=2]="tableRowSplit"})(cm||(cm={}));Object(e.b)("PageEndType",cm);class Pn{constructor(J,ma,Ta,pb,Wb,Jc,Zc=!1,jd=!1,dd=!1,Ld=!1,$d=!1){this.qrg(ma,Ta,
pb,Wb,Jc,dd,$d);this.position=J;this.Fh=ma;this.paragraphNode=Ta;this.kV=pb;this.kob=Wb;this.outlineNode=Jc;this.F4a=Zc;this.dEi=jd;this.vJm=dd;this.mda=Ld;this.q0d=$d}whe(J){this.Fh=J}qrg(J,ma,Ta,pb,Wb,Jc,Zc){Zc||(za.ULS.shipAssertTag(38326881,336,!!Wb,"PageEndDetails: outlineNode parameter value is null."),za.ULS.shipAssertTag(24126528,336,0<=J,"PageEndDetails: pageNumber parameter value {0} is unexpected value.",J),za.ULS.shipAssertTag(24126529,336,!!ma||Jc,"PageEndDetails: paragraphNode parameter is null for a page that is not client-only."),
za.ULS.shipAssertTag(24126530,336,!!Ta||Jc,"PageEndDetails: pageEnd parameter is null for a page that is not client-only."),za.ULS.shipAssertTag(24126531,336,!!pb||Jc,"PageEndDetails: pageEndDomElement parameter is null for a page that is not client-only."))}static Abl(J,ma){return Pn.Paf(0,J,null,ma,!0,!1)}static Bbl(J){return Pn.Paf(0,0,null,J,!1,!0)}static Paf(J,ma,Ta,pb,Wb,Jc){return new Pn(J,ma,null,null,Ta,pb,Wb,Jc,!0)}static Y5b(J,ma){return new Pn(0,J,null,ma,null,null,void 0,void 0,void 0,
void 0,!0)}}Object(e.a)(Pn,"PageEndDetails",null,[]);class Km{constructor(J,ma,Ta,pb,Wb,Jc,Zc,jd,dd,Ld,$d,le,ae,Oe,ef,oh,Ff,si,ui,Gg){this.Ita=!0;this.zxe=0;this.std=this.CDe=this.DDe=this.Bze=this.DNe=this.mDe=!1;this.qvd=this.Lyb=null;this.SGe=!0;this.vMb=()=>{this.$_c()};this.RWf=()=>{this.DDe=!1};this.SWf=()=>{this.CDe=this.DDe=!0};this.Ern=(Bj,xk)=>{1>=Math.abs(xk.delta)||(this.Bze=!0,this.iHj(!xk.iRi))};this.TTn=Bj=>{Bj===this.Lyb&&(this.Lyb=null);if(this.Ita){var xk=Bj.customData;if(Bj=this.FYa.get(xk.id))for(this.FYa.Z(xk.id,
new kb.a),za.ULS.sendTraceTag(6558539,336,50,"PageEndMarkers: Redraw page ends for Outline Group [Count: {0}] [Outline group: {1}]",Bj.count,xk.id),this.Yaa&&this.Yaa.VDa(),xk=0;xk<Bj.count;xk++){const Yg=Bj.J(xk),Kf=Yg.kV;Kf.HardBreak||(Yi.a.qx(Yg.kob),this.e9f(Kf))}}};this.STn=()=>{this.qvd=null;this.Ita&&this.lja&&0<this.lja.count&&(za.ULS.sendTraceTag(6579856,336,50,"PageEndMarkers: Redraw all page ends in the document"),this.Noc(this.lja.toArray(),this.Ita))};this.hM=J;this.ji=ma;this.Yaa=Ta;
this.dO=pb;this.kah=Wb;this.Ucb=Jc;Km.py=jd;this.vXg=dd;this.XI=Ld;this.Ib=$d;this.x4j=le;this.je=Oe;this.h_=oh;this.HNe=Ff;this.TZb=si;this.PZ=ui;this.xZb=new Rg.a;this.PZb=new kb.a;this.lja=new kb.a;this.FYa=new Rg.a;this.QN=ae;this.oT=Gg;this.X9d=this.X9d.bind(this);this.Z9d=this.Z9d.bind(this);this.j6c=this.j6c.bind(this);this.Fda=this.Fda.bind(this);this.QN.dGc(this.vMb);this.ENe=!1;ef&&(ef.vrh(this.SWf),ef.lCd(this.RWf));Zc&&Zc.pyk(this.Ern);this.oT.XAb(this.Fda)}get l0d(){return this.SGe}get Fk(){return this.hM.value}get rj(){return this.ji.value}Noc(J,
ma){const Ta=this.je.Zf("Task","UpdateMarkers");this.vEo();this.Ita=ma;Km.py.H$i();this.xZb=new Rg.a;this.PZb.clear();this.lja.clear();this.FYa=new Rg.a;this.SGe=this.mDe=!1;this.dO&&this.dO.Noc(J);this.pxl();this.zxe=J.length;this.h_&&this.h_.reset(J);this.Yaa&&this.Yaa.VDa();for(const pb of J)this.lja.add(pb),this.e9f(pb);ma&&this.dO&&this.HNe&&this.HNe.isEnabled&&(J=this.dO.NRc(),this.HNe.BDa(J));this.j3k();this.Bze=this.DNe=!1;this.CDe=this.DDe;qf.WoncaApp.instance.lIb&&Km.HAf&&this.dO.jqg();
this.Ucb.zYo(this.dO.NRc(),this.lja.count);this.SGe=!0;this.PZ.Ypg();Ta.stop();za.ULS.sendTraceTag(25048922,336,50,"UpdateMarkers stopwatch stopped: {0}",{["DurationInMs"]:Ta.oi,["RenderedLineCount"]:this.zxe,["AvgDurationPerPageInMs"]:Ta.oi/this.aei()})}cei(){const J=this.dO.NRc();if(!J)return null;const ma=Yi.a.hY(),Ta=new kb.a;for(const pb of J)this.PRm(pb,ma)&&Ta.add(pb);return Ta}PRm(J,ma){if(!J)return!1;J=Km.py.QGb(J);if(!J)return!1;J=qa.a.lFa(J);return 0<=J&&J<=ma}I4h(){const J=new kb.a;if(!this.FYa)return za.ULS.sendTraceTag(35005382,
336,10,"_outlineGroupsWithPageEndDetails is null in PageEndMarkers.GetAbsolutePageEndMarkerPositions."),J;const ma=this.FYa.keys;for(let Wb=0;Wb<ma.length;Wb++){var Ta=ma.J(Wb);if(Ta=this.FYa.J(Ta))for(let Jc=0;Jc<Ta.count;Jc++){var pb=Ta.J(Jc);pb.kV.HardBreak||pb.kob.classList.contains("Hidden")||(pb=qa.a.lFa(pb.kob),J.add(pb))}}return J}vEo(){const J=this.I4h(),ma=this.cei();this.kah.Hjg(J,ma);this.TZb&&this.TZb.isEnabled&&this.TZb.Hjg(ma)}j3k(){if(!(25<this.aei())){var J=this.I4h(),ma=this.cei();
this.kah.k3k(J,ma,this.DNe,this.mDe,this.Bze,this.CDe);this.TZb&&this.TZb.isEnabled&&this.TZb.BDa(ma)}}Fda(){this.Yaa.l0n();this.nSh()}nSh(){this.std&&(this.Fk.Kbj(this.X9d),this.Fk.i2n(this.Z9d),this.Fk.N1n(this.j6c),this.std=!1)}pxl(){this.std||(this.Fk.h0e(this.X9d),this.Fk.Xyk(this.Z9d),this.Fk.orh(this.j6c),this.std=!0)}e9f(J){if(this.ENe)return!0;J=this.h3n(J);if(!J)return!1;this.h_&&this.h_.Vpm(J);this.dO&&(this.dO.Juk(J),this.Ucb.fHj(this.dO.NRc()),qf.WoncaApp.instance.lIb&&Km.HAf&&this.dO.jqg());
return!0}h3n(J){let ma=this.MM(J.ParaId);if(!ma)return null;if(!ma.anchor||!ma.xj)return this.lqh(J,ma),null;let Ta,pb;if(J.HardBreak){var Wb=Gj.ParagraphReader.Xf(ma,!0,!0,!0);this.cAn(Wb)&&(ma=Wb);if(!({kja:Wb,outlineGroupNode:Ta,iob:pb}=this.APo(J,ma)).returnValue)return null;this.mDe=!0}else if(!({S9d:Wb,outlineGroupNode:Ta,iob:pb}=this.i3n(J,ma)).returnValue)return null;return this.VBd(ma,J,Wb,Ta,pb)}cAn(J){return J?(J=J.te(this.Fk.$b))?!!Km.py.qTd(J.htmlElement):!1:!1}i3n(J,ma){var Ta=J.PageEndType;
let pb,Wb=0,Jc=null;if(!Ta){if(!({kja:J,v6a:pb}=this.dei(J,ma)).returnValue)return{returnValue:!1,S9d:Wb,outlineGroupNode:Jc,iob:null}}else if(!({kja:J,ule:pb}=this.u8l(J,ma)).returnValue)return{returnValue:!1,S9d:Wb,outlineGroupNode:Jc,iob:null};var Zc=vm.GraphIterator.eb(ma);Zc.qd();Jc=Zc.jd(23);ma=Jc.te(this.Fk.$b).getBounds();Zc=Zc.bUa().te(this.Fk.$b);if(!Zc)return za.ULS.sendTraceTag(50997218,314,50,"outlineGroupViewElement is null for ViewId: {0}.",this.Fk.$b),{returnValue:!1,S9d:Wb,outlineGroupNode:Jc,
iob:null};const jd=Zc.getBounds();Wb=J-ma.y;Ta=Km.py.i9h(Ta,Wb,this.Ita,pb,ma,jd);Zc.gca.appendChild(Ta);return{returnValue:!0,S9d:Wb,outlineGroupNode:Jc,iob:Ta}}APo(J,ma){let Ta=null;const pb=ma.te(this.Fk.$b);var Wb=0;let Jc=null;if(this.L1d(J,pb,ma))return{returnValue:!1,kja:Wb,outlineGroupNode:Ta,iob:Jc};Ta=Km.QQi(ma);const Zc=Ta.te(this.Fk.$b);if(!Zc)return za.ULS.sendTraceTag(50446550,314,15,"outlineGroupViewElement is null for ViewId: {0}.",this.Fk.$b),{returnValue:!1,kja:Wb,outlineGroupNode:Ta,
iob:Jc};Wb=Zc.getBounds();Wb=Pl.a.Wq(pb,J.CP).y-Wb.y;Jc=this.q_l(ma);return{returnValue:!0,kja:Wb,outlineGroupNode:Ta,iob:Jc}}q_l(J){return J.te(this.Fk.$b).htmlElement}MM(J){const ma=this.XI.qjb(J);if(ma!==di.a.nil){const Ta=this.rj.Eb(ma);if(Ta)return Ta}za.ULS.sendTraceTag(6398172,336,10,"PageEndMarkers: Cannot find graph node for para Id {0} objectId {1}",J,ma);return null}dei(J,ma){const Ta=J.CP;let pb=0,Wb=null;const Jc=ma.te(this.Fk.$b);if(this.L1d(J,Jc,ma))return{returnValue:!1,kja:pb,v6a:Wb};
Wb=Jc.getBounds();pb=Ta?this.vXg(Object(Bb.a)(117,Jc),Ta):Wb.y-this.x4j(Jc);return{returnValue:!0,kja:pb,v6a:Wb}}u8l(J,ma){let Ta=null,pb=0;var Wb=J.PageEndType;let Jc=vm.GraphIterator.eb(ma);Jc.qd();if(!hn.TableReader.lx(Jc))return za.ULS.sendTraceTag(6398173,336,50,"PageEndMarkers: Para {0} has moved out from inside the table, treating as normal paragraph.",J.ParaId),{returnValue:({kja:pb,v6a:Ta}=this.dei(J,ma)).returnValue,kja:pb,ule:Ta};if(Wb===cm.tableSplit){un.returnToContainingRow(Jc);Wb=Jc.currentNode.te(this.Fk.$b);
if(this.L1d(J,Wb,ma))return{returnValue:!1,kja:pb,ule:Ta};pb=Wb.getBounds().y}else{Wb=ma.te(this.Fk.$b);if(this.L1d(J,Wb,ma))return{returnValue:!1,kja:pb,ule:Ta};pb=this.vXg(Object(Bb.a)(117,Wb),J.CP)}--pb;ma=null;do J=ma,ma=Jc.jd(14);while(ma);Jc=vm.GraphIterator.eb(J);Jc.qd();un.moveToFirstRow(Jc);Ta=Jc.currentNode.te(this.Fk.$b).getBounds();return{returnValue:!0,kja:pb,ule:Ta}}L1d(J,ma,Ta){if(!ma||ma.oqa(16))return this.lqh(J,Ta),!0;ma=ma.getBounds();return ma.width||ma.height?!1:(this.wph(J),
!0)}wph(J){this.PZb.contains(J)||this.PZb.add(J)}lqh(J,ma){ma=ma.id;let Ta;({value:Ta}=this.xZb.Fc(ma)).returnValue||(Ta=new kb.a,this.xZb.Z(ma,Ta));Ta.add(J)}X9d(){const J=new kb.a;for(let ma=this.PZb.count-1;0<=ma;ma--){const Ta=this.PZb.J(ma);this.e9f(Ta)||J.add(Ta)}this.PZb=J;this.V7e()}V7e(){this.dO&&this.dO.V7e()&&this.iHj(!1)}iHj(J){this.dO&&(this.dO.NRk(J)&&(this.DNe=!0),this.dO.c8n(),this.Ucb.fHj(this.dO.NRc()),qf.WoncaApp.instance.lIb&&Km.HAf&&this.dO.jqg())}Z9d(J,ma){try{const Ta=ma.id;
if(this.xZb.nb(Ta)){const pb=this.xZb.J(Ta);for(J=0;J<pb.count;J++)this.wph(pb.J(J));this.xZb.remove(Ta)}}catch(Ta){}}$_c(){this.Ita&&(this.Ita=!1,Km.py.$_c())}Z_c(){this.Ita||(this.Ita=!0,Km.py.Z_c())}Vsj(){this.ENe=!1;this.lja&&this.Noc(this.lja.toArray(),this.Ita);this.Yaa&&this.Yaa.Usj()}Voi(){this.ENe=!0;Km.py.H$i();this.Yaa&&this.Yaa.Uoi();this.h_&&this.h_.Gum()}VBd(J,ma,Ta,pb,Wb){const Jc=this.lja.indexOf(ma)+1;if(0>Jc)return null;const Zc=Rp.WordSectionNavigator.instance.yL(J),jd=this.mda(ma,
J);J=new Pn(Ta,Jc,J,ma,Wb,Zc,!J||!ma||!Wb,!1,!1,jd);this.FYa.nb(pb.id)||this.FYa.Z(pb.id,new kb.a);this.FYa.J(pb.id).add(J);return J}mda(J,ma){if(!J||!J.HardBreak)return!1;J=vm.GraphIterator.eb(ma);J.zb(7);if(J.FJ())return!1;J.jd(23);return J.FJ()?!1:!0}E6f(J){this.Ita&&(J.anchor&&J.xj?!(J=Km.QQi(J))||this.Lyb&&this.Lyb.customData&&this.Lyb.customData.id===J.id||(this.Lyb=Object.assign(new Kb.a(3,1,500,this.TTn),{customData:J}),this.Ib.Wb(this.Lyb)):za.ULS.sendTraceTag(6607198,336,10,"PageEndMarkers: Invalid node while redrawing page ends for outline group"))}j6c(){this.Ita&&
!this.qvd&&this.lja&&0<this.lja.count&&(this.qvd=new Kb.a(3,1,500,this.STn),this.Ib.Wb(this.qvd))}dispose(){this.Fk&&this.nSh();this.oT.L8f(this.Fda);this.QN.Pde(this.vMb)}static get HAf(){null==Km.DEe&&(Km.DEe=l.AFrameworkApplication.K.$("ImageOverflowUpdateHeightIsEnabled"));return Km.DEe}static m_l(J){let ma=0;try{const Ta=J.htmlElement,pb=Yi.a.iN(Ta.firstChild.style.marginTop);J=0;const Wb=Km.Mtf(Ta.parentNode);if(Wb){const Jc=Wb.firstChild;Jc&&Jc.classList.contains("ParaWrappingDiv")&&(J=Yi.a.iN(Jc.firstChild.style.marginBottom))}ma=
Math.max(pb,J)/2}catch(Ta){}return ma}static Mtf(J){let ma=J.previousSibling;if(!ma){var Ta=J.parentNode;Yi.a.hGf(Ta)&&(Ta=Ta.parentNode)&&(ma=Ta.previousSibling)}if(!ma&&(J=J.parentNode,J.classList.contains("OutlineGroup")||za.ULS.sendTraceTag(19711369,314,15,"Expected OutlineGroup but encountered a {0} element with classname {1}.",J.tagName,J.className),(J=J.previousSibling)&&J.hasChildNodes())){ma=J.lastChild;do{if(ma.classList.contains("OutlineElement")||Yi.a.hGf(ma)&&ma.classList.contains(Jm.a.dfc))break;
ma=ma.previousSibling}while(ma)}if(ma){if(ma.classList.contains(Jm.a.dfc))return ma.lastChild.lastChild;if(Yi.a.hGf(ma))return ma.lastChild}return ma}static QQi(J){J=vm.GraphIterator.eb(J);return J.zb(23)?J.jd(23):null}aei(){return this.zxe+1}}Km.py=null;Km.DEe=null;Object(e.a)(Km,"PageEndMarkers",null,[1950,1951,9]);var Tr=c(143);class hs{constructor(J,ma,Ta){this.pyn=".Outline";this.hM=J;this.kn=ma;this.py=Ta}get Fk(){const J=this.hM.value;za.ULS.shipAssertTag(38416594,336,J.Zi,"Invalid PageView.");
return J}A9b(J){return(J=J.outlineNode)?this.Sdi(J):(za.ULS.shipAssertTag(38336522,336,!0,"Error getting last Outline DOM."),null)}Sdi(J){let ma,Ta;return(ma=J.te(this.Fk.$b))&&(Ta=ma.htmlElement)?Ta.querySelector(this.pyn):(za.ULS.shipAssertTag(39662425,336,!0,"Error getting last Outline DOM."),null)}H7h(J){J=Uk.OutlineElementNavigator.El(J.paragraphNode);let ma;return J&&(ma=J.te(this.Fk.$b))?ma.htmlElement:(za.ULS.shipAssertTag(38336525,336,!0,"Error calculating containing OE DOM."),null)}YAh(J,
ma){const Ta=this.clm(J);return this.GRk(J,ma)-Ta}d9h(J){return this.Xdi(J.outlineNode,J.Fh)}Xdi(J,ma){if(!J)return-1;var Ta=J.ja(Sl.a.tv,-1);Ta=qb.a.Qi(Ta,1);var pb=J.ja(Sl.a.marginTop,-1);pb=qb.a.Qi(pb,1);J=J.ja(Sl.a.marginBottom,-1);J=qb.a.Qi(J,1);return 1===ma?Ta-J:Ta-(pb+J)}bll(J){J&&Yi.a.qx(J.kob)}Gtf(J){if(J.dEi||J.mda)return 0;if(J.F4a)return J=this.A9b(J),qa.a.getElementBounds(J).height/this.kn.nj;const ma=this.A9b(J);return this.py.q6e(this.bei(J),ma)}b$k(J,ma,Ta){Ta=Ta.te(this.Fk.$b).getBounds();
J=J.te(this.Fk.$b);const pb=J.getBounds();Ta.y=pb.y;ma=this.py.i9h(cm.para,ma*this.kn.nj,!1,Ta,Ta,pb);J.gca.appendChild(ma);return ma}xti(J,ma){if(J&&!J.q0d)if(J.F4a){if(J=this.A9b(J))J.style.paddingBottom=ma+"px"}else if(J.kV&&J.kV.HardBreak)if(J.mda){if(J=this.sfi(J))J.style.paddingBottom=ma+"px"}else{if(J=this.H7h(J))J.style.paddingTop=ma+"px"}else za.ULS.shipAssertTag(39077394,336,!1,"Applying blank space on a page which is not hard break or last page.")}msh(J,ma){ma=this.A9b(ma);J=this.A9b(J);
return qa.a.lFa(ma)-qa.a.lFa(J)}tfi(J){J=vm.GraphIterator.eb(J.outlineNode);J.zb(7);return J.FJ()}aBi(J){if(!J||J.q0d)return!1;if(J.F4a||J.dEi)return!0;J=this.bei(J);return!!J&&Yi.a.ica(J)}TR(J){this.py.TR(J)}sfi(J){return(J=this.tfi(J))?(J=J.zj(this.Fk.$b).htmlElement,J?J:(za.ULS.shipAssertTag(39126080,336,!0,"Section dom is null."),null)):null}bei(J){return J.kV&&J.kV.HardBreak&&!J.mda?this.py.qTd(J.kob):J.kob}clm(J){if(J.F4a){J=this.A9b(J);if(!J)return za.ULS.shipAssertTag(38336528,336,!0,"Last outline dom is null."),
-1;J=Tr.a.AB(J);return Yi.a.Vha(J.paddingBottom)}if(J.kV&&J.kV.HardBreak){if(J.mda)return(J=this.sfi(J))?Yi.a.Vha(J.style.paddingBottom):-1;J=this.H7h(J);return J?Yi.a.Vha(J.style.paddingTop):(za.ULS.shipAssertTag(38336529,336,!0,"Containing outline element Dom is null."),-1)}return 0}GRk(J,ma){return this.Gtf(J)-ma}}Object(e.a)(hs,"PageFullHeightDOMHelper",null,[]);class tr{constructor(){this.delta=this.XKj=this.Vy=0;this.jja=null;this.wPa=this.Y3i=0;this.outlineGroupNode=null;this.XDa=0;this.GCf=
new kb.a;this.ZKd=new kb.a;this.Xgn=new kb.a}}Object(e.a)(tr,"PageFullHeightInfo",null,[]);class Sp{constructor(J,ma){this.gCa=J;this.qy=ma}hBh(J,ma){try{return this.DRk(J,ma)}catch(Ta){return this.qy.TR(Ta.message+" "+Ta.stack),za.ULS.sendTraceTag(38416595,336,10,"Exception caught in CalculatePageFullHeightInfo. Exception: {0}",Ta.message),null}}DRk(J,ma){za.ULS.shipAssertTag(38416596,336,J.F4a||J.kV.HardBreak);const Ta=this.qy.Gtf(J),pb=this.qy.YAh(J,ma),Wb=this.gCa.UAh(J,pb);J=Object.assign(new tr,
{XDa:pb,wPa:Wb,jja:J});this.lXo(J);J.XKj=J.wPa-J.XDa;J.delta=ma+Wb+J.delta-Ta;return J}lXo(J){J.XDa>J.wPa?this.mXo(J):0>J.XDa&&this.Mpg(J)}Mpg(J){let ma=J.jja.Fh;for(;0>J.XDa;)J.Vy--,J.delta-=this.gCa.tQc(ma),J.XDa+=this.gCa.tQc(ma-1),ma--;J.wPa=this.gCa.tQc(ma)}mXo(J){const ma=this.qy.d9h(J.jja);J.Vy=Math.floor((J.XDa-J.wPa)/ma)+1;J.delta=J.Vy*ma;J.XDa-=J.wPa+(J.Vy-1)*ma;J.wPa=ma}}Object(e.a)(Sp,"PageFullHeightInfoCalculator",null,[]);class $g{constructor(J,ma,Ta,pb){this.XZa=0;this.MNa=null;this.gCa=
J;this.Qxb=ma;this.iX=Ta;this.qy=pb;this.kdh=new kb.a}get iZ(){return this.kdh}Vpm(J){try{this.syf(J)}catch(ma){this.qy.TR(ma.message+" "+ma.stack),za.ULS.sendTraceTag(38148114,336,10,"Exception caught in HandlePageFullHeight. Exception: {0}",ma.message)}}reset(J){try{this.t6n(J)}catch(ma){this.qy.TR(ma.message+" "+ma.stack),za.ULS.sendTraceTag(38637723,336,10,"Exception caught in PageFullHeightManager.Reset. Exception: {0}",ma.message)}}Gum(){try{this.Hum()}catch(J){this.qy.TR(J.message+" "+J.stack),
za.ULS.sendTraceTag(39153856,336,10,"Exception caught in PageFullHeightManager.HidePageFullHeights. Exception: {0}",J.message)}}qEm(J){try{this.rEm(J)}catch(ma){this.qy.TR(ma.message+" "+ma.stack),za.ULS.sendTraceTag(38916954,336,10,"Exception caught in PageFullHeightManager.InsertOrDeleteRenderedPages. Exception: {0}",ma.message)}}m0n(J){try{this.n0n(J)}catch(ma){this.qy.TR("Pagination: "+ma.message+" "+ma.stack),za.ULS.sendTraceTag(39387716,336,10,"Exception caught in PageFullHeightManager.RemovePageEndDetails. Exception: {0}",
ma.message)}}bBm(){var J=this.iX.Pqf(),ma=this.iX.Cbi();J=Pn.Bbl(J);ma=Pn.Abl(this.XZa,ma);this.iZ.Z(0,J);this.syf(ma)}x6n(){var J=Rp.WordSectionNavigator.instance.Cbi();(J=this.qy.Sdi(J).parentNode)&&""!==J.style.minHeight&&(J.style.minHeight="")}ZBm(J){this.kdh=new kb.a;this.iZ.add(null);for(let ma=0;ma<J.length;ma++){const Ta=Pn.Y5b(ma+1,J[ma]);this.iZ.add(Ta)}this.iZ.add(Pn.Y5b(J.length+1,null))}KBm(J){this.gCa.E6n(J)}d7n(){if(this.iZ)for(const J of this.iZ)J&&this.Ryi(J)&&this.qy.xti(J,0)}syf(J){const ma=
this.cam(J);if(this.qy.aBi(ma)){let Ta=this.qy.Gtf(ma);J.outlineNode!==ma.outlineNode&&(Ta+=this.qy.msh(J,ma));this.NQk(J,Ta);this.Ryi(J)&&this.f9f(J,Ta)}else this.MNa.add(J),20<this.MNa.count&&za.ULS.sendTraceTag(39982428,336,15,"Count of _waitingForPreviousPage is "+this.MNa.count);this.iZ.Z(J.Fh,J);this.Kpm(J)}Hum(){this.d7n()}t6n(J){this.XZa=J.length+1;this.MNa=new kb.a;this.ZBm(J);this.KBm(this.XZa);this.bBm();this.x6n()}rEm(J){this.gCa.DYo(J);for(const ma of J){if(!ma){za.ULS.sendTraceTag(38916955,
336,10,"info is null.");return}if(0<ma.Vy){J=ma.jja.Fh;for(const Ta of ma.GCf)this.iZ.insert(J,Ta),J++}else if(0>ma.Vy)for(const Ta of ma.ZKd)this.iZ.remove(Ta),this.MNa.contains(Ta)&&this.MNa.remove(Ta)}this.Vcj()}n0n(J){J=J.Fh;this.gCa.o0n(J);this.iZ.removeAt(J);for(const ma of this.MNa)ma.Fh===J&&this.MNa.remove(ma);this.Vcj()}NQk(J,ma){ma=this.qy.YAh(J,ma);this.gCa.UAh(J,ma)}f9f(J,ma){J.kV&&J.kV.HardBreak||this.Qxb.f9f(J,ma)}Kpm(J){J=J.Fh+1;for(const ma of this.MNa)if(ma&&ma.Fh===J){this.syf(ma);
this.MNa.remove(ma);break}}Vcj(){for(let J=0;J<this.iZ.count;J++){const ma=this.iZ.J(J);ma&&ma.whe(J)}}Ryi(J){J=this.n8l(J);return 2===J||1===J}cam(J){return this.iZ.J(J.Fh-1)}n8l(J){return J.F4a?2:J.kV&&J.kV.HardBreak?1:0}}Object(e.a)($g,"PageFullHeightManager",null,[2049]);class Dn{constructor(J,ma,Ta,pb){this.Qxb=J;this.gCa=ma;this.iX=Ta;this.qy=pb}create(){return new $g(this.gCa,this.Qxb,this.iX,this.qy)}}Object(e.a)(Dn,"PageFullHeightManagerFactory",null,[]);var ig=c(1114),xo=c(602);class Kn{constructor(J,
ma,Ta,pb,Wb){this.QZb=null;this.h_=J;this.dO=ma;this.JAc=Ta;this.Qxb=pb;this.qy=Wb}reset(){this.QZb=new kb.a}CRk(J,ma,Ta){try{return this.ERk(J,ma,Ta)}catch(pb){return za.ULS.sendTraceTag(38897350,336,10,"Exception caught in PageFullHeightPositionUpdater.CalculatePageFullHeight. Exception: {0}",pb.message),null}}$7n(){try{this.a8n()}catch(J){za.ULS.sendTraceTag(38897351,336,10,"Exception caught in PageFullHeightPositionUpdater.RestorePageFullHeights. Exception: {0}",J.message)}}ERk(J,ma,Ta){if(!this.h_.iZ.count)return null;
const pb=this.s8l(J,!J);if(!pb||pb.q0d)return za.ULS.sendTraceTag(38897352,336,10,"PageEndDetail is null for the given PageEndMarker"),null;if(pb.kV&&pb.kV.HardBreak)return null;var Wb=this.h_.iZ.J(pb.Fh-1);return this.qy.aBi(Wb)&&(ma-=Ta,pb.outlineNode!==Wb.outlineNode&&(ma+=this.qy.msh(pb,Wb)),(Wb=this.JAc.hBh(pb,ma))&&1<Math.abs(Wb.delta))?(Wb.Y3i=ma,Wb.outlineGroupNode=this.$7l(J,pb),this.QZb.add(Wb),this.Mpg(Wb),Wb):null}$7l(J,ma){return ma&&ma.F4a?(J=Object(Bb.a)(xo.a,Gj.ParagraphReader.$C(ma.outlineNode)),
J=vm.GraphIterator.eb(J),J.Ip(),Object(Bb.a)(ig.a,J.jd(23))):J&&J.hlb?J.outlineGroupNode:null}a8n(){this.QZb.Sc((J,ma)=>ma.jja.Fh-J.jja.Fh);for(const J of this.QZb)this.Qxb.Gcj(J);this.GYo()}GYo(){this.dO.value.oEm(this.QZb);this.h_.qEm(this.QZb)}s8l(J,ma){return ma?this.h_.iZ.J(this.h_.iZ.count-1):this.h_.iZ.J(J.Fh)}Mpg(J){let ma=J.jja.Fh;const Ta=-J.Vy;for(let pb=0;pb<Ta;pb++)ma--,J.ZKd.add(this.h_.iZ.J(ma))}}Object(e.a)(Kn,"PageFullHeightPositionUpdater",null,[2048]);class no{constructor(J,ma,
Ta,pb,Wb){this.h_=J;this.dO=ma;this.JAc=Ta;this.Qxb=pb;this.qy=Wb}create(){return new Kn(this.h_,this.dO,this.JAc,this.Qxb,this.qy)}}Object(e.a)(no,"PageFullHeightPositionUpdaterFactory",null,[]);class Ir{constructor(J,ma){this.qy=J;this.JAc=ma}f9f(J,ma){try{this.l3n(J,ma)}catch(Ta){this.qy.TR(Ta.message+" "+Ta.stack),za.ULS.sendTraceTag(38285912,336,10,"Exception caught in RenderPageFullHeight. Exception: {0}",Ta.message)}}Gcj(J){try{this.k3n(J)}catch(ma){this.qy.TR(ma.message+" "+ma.stack),za.ULS.sendTraceTag(38855577,
336,10,"Exception caught in RenderPageFullHeightInfo. Exception: {0}",ma.message)}}l3n(J,ma){za.ULS.shipAssertTag(38285913,336,J.F4a||J.kV.HardBreak);J=this.JAc.hBh(J,ma);this.Gcj(J)}k3n(J){this.j3n(J);this.c3n(J)}c3n(J){0<J.Vy?this.AEm(J):0>J.Vy&&this.cll(J)}j3n(J){this.qy.xti(J.jja,J.XKj)}AEm(J){let ma=J.Y3i+J.wPa;for(let pb=0;pb<J.Vy;pb++){var Ta=J.jja.Fh+pb;const Wb=J.jja.mda?this.qy.tfi(J.jja):J.jja.outlineNode;Ta=this.a$k(Wb,J.outlineGroupNode,ma,Ta);J.GCf.add(Ta);J.Xgn.add(ma);ma+=J.wPa}}cll(J){for(const ma of J.ZKd)this.qy.bll(ma)}a$k(J,
ma,Ta,pb){ma=this.qy.b$k(J,Ta,ma);return Pn.Paf(Ta,pb,ma,J,!1,!1)}}Object(e.a)(Ir,"PageFullHeightRenderer",null,[]);class rp{constructor(J){this.G5f=J}}Object(e.a)(rp,"PageHeightDeltaResult",null,[1977]);class Ia{constructor(J,ma,Ta){this.Mp=null;this.qy=J;this.ti=ma;Ta.execute(pb=>{pb.register(this)})}get K0c(){return"PageHeightDelta"}get result(){return this.Mp}get YTf(){return 1}get qbg(){return 500}get isEnabled(){return!0}gUf(){this.Mp=null}BDa(J){this.ti.ie(()=>{try{this.WHc(J)}catch(ma){za.ULS.sendTraceTag(39188045,
324,10,"Exception caught in PageHeightDeltaMetric.Calculate. Exception: {0}",ma.message)}},"PHDM:C")}WHc(J){this.Mp=null;J=this.XHc(J);-1!==J&&(this.Mp=new rp(J))}XHc(J){if(!J.count)return-1;let ma=0,Ta=0;for(const pb of J)J=this.FRk(pb),-1!==J&&(ma+=J,Ta++);return Ta?ma/Ta:-1}FRk(J){if(!J.yMm)return-1;const ma=this.qy.Xdi(J.wEd,J.Fh);return-1===ma?-1:Math.abs(J.height-ma)}}Object(e.a)(Ia,"PageHeightDeltaMetric",null,[1952]);class Cb{constructor(J){this.sXa=null;this.qy=J}tQc(J){return this.sXa.J(J-
1)}E6n(J){this.sXa=new kb.a;for(let ma=0;ma<J;ma++)this.sXa.add(-1)}UAh(J,ma){if(this.QRm(J))return this.sXa.J(J.Fh-1);ma=this.eRk(J,ma);this.wEo(J,ma);return ma}DYo(J){for(const ma of J)this.CYo(ma)}wEo(J,ma){this.sXa.Z(J.Fh-1,ma)}o0n(J){this.sXa.removeAt(J-1)}CYo(J){if(J)if(0<J.Vy){var ma=J.jja.Fh;for(var Ta=0;Ta<J.Vy;Ta++)this.sXa.insert(ma,J.wPa)}else if(0>J.Vy)for(ma=-J.Vy,J=J.jja.Fh-ma,Ta=0;Ta<ma;Ta++)this.sXa.removeAt(J)}QRm(J){return-1!==this.sXa.J(J.Fh-1)}eRk(J,ma){if(J.F4a||J.kV.HardBreak)J=
this.qy.d9h(J),ma=ma<J?J:ma;return ma}}Object(e.a)(Cb,"PageHeightStorage",null,[]);var nc=c(112);class Nc{constructor(J){this.G5f=J}}Object(e.a)(Nc,"PageLevelDeltaResult",null,[1977]);class ud{constructor(J,ma,Ta,pb){this.Mp=null;this.hM=J;this.lua=ma;this.ti=Ta;pb.execute(Wb=>{Wb.register(this)})}get Fk(){const J=this.hM.value;za.ULS.shipAssertTag(39081438,336,J.Zi,"PageLevelDeltaMetric.PageView is not a PageView.");return J}get K0c(){return"PageLevelDelta"}get result(){return this.Mp}get YTf(){return 0}get qbg(){return 60}get isEnabled(){return!0}gUf(){this.Mp=
null}BDa(J){this.ti.ie(()=>{try{this.WHc(J)}catch(ma){za.ULS.sendTraceTag(39081440,324,10,"Exception caught in PageLevelDeltaMetric.Calculate. Exception: {0}",ma.message)}},"PLDM:C")}WHc(J){this.Mp=null;J=this.XHc(J);-1!==J&&(this.Mp=new Nc(J))}XHc(J){if(!J.count)return-1;let ma=0,Ta=0;for(const pb of J)J=this.HRk(pb),-1!==J&&(ma+=J,Ta++);return Ta?ma/Ta:-1}HRk(J){if(J.hlb)return-1;var ma=J.kV.CP;J=J.paragraphNode;za.ULS.shipAssertTag(39081441,336,!!J);J=J.te(this.Fk.$b);za.ULS.shipAssertTag(39081442,
324,Object(nc.a)(117,J));let Ta;({ZKh:ma,ZGi:J,Ufj:Ta}=this.uRk(J,Yi.a.Hy(J.htmlElement).length,ma));return J&&Ta?Math.min(ma.x-J.x,Ta.x-ma.x):(za.ULS.sendTraceTag(39081443,336,50,"There was a problem calculating the line boundaries in PageLevelDeltaMetric.CalculatePageLevelDelta."),-1)}uRk(J,ma,Ta){let pb,Wb,Jc,Zc=Wb=Ta,jd=Jc=pb=null;if(Ta>ma)return za.ULS.sendTraceTag(39081472,336,50,"cp > paragraph text length in FidelityTelemetryManager.CalculatePageLevelDelta."),{ZKh:jd,F0m:Zc,ZGi:Jc,B9n:Wb,
Ufj:pb};jd=this.lua.Wq(J,Ta);for(var dd=0,Ld=Ta;dd<=Ld;){const $d=Math.floor((dd+Ld)/2),le=this.lua.Wq(J,$d);if(dd===Ld){Zc=$d;Jc=le;break}le.y+le.height<=jd.y?dd=$d+1:Ld=$d}for(;Ta<=ma;){dd=Math.ceil((Ta+ma)/2);Ld=this.lua.Wq(J,dd);if(Ta===ma){Wb=dd;pb=Ld;break}Ld.y>=jd.y+jd.height?ma=dd-1:Ta=dd}return{ZKh:jd,F0m:Zc,ZGi:Jc,B9n:Wb,Ufj:pb}}}Object(e.a)(ud,"PageLevelDeltaMetric",null,[1952]);class re{constructor(J,ma,Ta,pb,Wb,Jc,Zc){this.Fh=J;this.top=ma;this.Xmh=Ta;this.height=pb;this.nSb=Wb;this.wEd=
Jc;this.yMm=Zc}}Object(e.a)(re,"Page",null,[]);class cf{constructor(J,ma,Ta,pb,Wb){this.KZb=null;this.Bih=0;this.hM=J;this.qkd=ma;this.jah=Ta;this.OMa=pb;this.lah=Wb;this.HYa=new kb.a}get Fk(){const J=this.hM.value;za.ULS.shipAssertTag(37007393,336,J.Zi,"PageManager.PageView is not a PageView.");return J}get hl(){return this.HYa}fHj(J){J=this.b8i(J);this.gHj(J)}zYo(J,ma){this.Bih=ma;J=this.b8i(J);this.gHj(J);this.lah.isEnabled&&this.lah.BDa(J)}b8i(J){this.HYa=new kb.a;this.KZb=new Rg.a(0);const ma=
new kb.a;if(!J)return this.hl;var Ta=0,pb=null;for(let Wb=0;Wb<J.count;Wb++){const Jc=J.J(Wb);Ta=Jc.Fh;pb=this.AJd(Ta,pb,Jc);this.hl.add(pb);!cf.CLe&&0>pb.height&&ma.add(pb);pb=Jc}J=this.AJd(Ta+1,pb,null);this.hl.add(J);!cf.CLe&&0>J.height&&ma.add(J);for(const Wb of ma)cf.CLe=!0,za.ULS.shipAssertTag(50968670,336,!1,"Page: height parameter value is negative for page "+Wb.Fh);return this.hl}AJd(J,ma,Ta){const pb=ma?ma.outlineNode:this.OMa.m$h(),Wb=Ta?Ta.outlineNode:this.OMa.Ibi();var Jc=this.Ydi(pb);
const Zc=this.Ydi(Wb),jd=ma?this.eBh(ma):0;Jc=jd+Jc;const dd=Ta?this.eBh(Ta):this.qkd.s6a.clientHeight-Zc;return new re(J,jd,Jc,pb.id===Wb.id?dd-jd:dd+Zc-Jc,pb,Wb,(Ta?Ta.Fh:this.Bih+1)===(ma?ma.Fh:0)+1)}eBh(J){return J.mda?0:J.top}gHj(J){if(this.jah.R9d)for(const ma of this.jah.R9d)ma&&ma.hHj(J)}Ydi(J){this.KZb||(this.KZb=new Rg.a(0));if(this.KZb.nb(J.id))return this.KZb.J(J.id);var ma=J.te(this.Fk.$b);if(!ma)return za.ULS.sendTraceTag(37052758,336,15,"OutlineViewElement is null in PageManager.GetOutlineTop."),
0;ma=qa.a.Y2a(this.qkd.s6a,ma.htmlElement).y;this.KZb.Z(J.id,ma);return ma}}cf.CLe=!1;Object(e.a)(cf,"PageManager",null,[2026]);var Ee=c(627);class Ef{constructor(J,ma,Ta,pb,Wb,Jc,Zc,jd){this.Rtj=jd;this.frg=this.t6a=!1;this.Xkn=(dd,Ld)=>{0!==Ld.hnb||this.frg?this.jTh():this.NWh()};this.ga=J;this.bga=ma;this.TVb=Ta;this.xt=pb;this.Xi=Wb;this.nah=Jc;this.VI=Zc;jd||(this.t6a=0===this.VI.nu,this.VI.Sqh(this.Xkn))}Tb(){this.ga.fb(hh.a.G5c,Uh.a.application,this.G5c.bind(this),96);this.ga.fb(hh.a.jce,Uh.a.application,
this.jce.bind(this),96);this.ga.fb(hh.a.Cme,Uh.a.application,this.Cme.bind(this),96);this.ga.fb(hh.a.zme,Uh.a.application,this.zme.bind(this),8)}Cme(J,ma,Ta){return 1===Ta?32:this.ga.processAction(hh.a.R8a,2)}zme(J,ma,Ta,pb){if(1===Ta)return this.Rtj?8:0===this.VI.nu?32:8;this.t6a?(this.jTh(),this.frg=!0):(this.NWh(),this.frg=!1);this.Xi.updateCommandUI();pb.Hs=this.t6a?1:0;return 32}G5c(J,ma,Ta,pb,Wb){if(1===Ta)return 32;J=this.nah.kHb();-1===J?J="":this.t6a||1===this.VI.nu?(ma=this.nah.GUl(),ma>
J&&(J=ma),J=String.format(WordEditorIntl.WordEditorStrings.l_CurrentPageAndCount,ma,J)):J=1===J?String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCountSingular,J):String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCount,J);Wb[Ee.a.Visible]=!0;Wb[Ee.a.LabelText]=J;return 32}jce(J,ma,Ta,pb,Wb){if(1===Ta)return 32;Wb[oj.a.On]=this.t6a;return 32}NWh(){this.t6a||this.Rtj||(this.TVb.pvl(),this.xt.Vsj(),this.t6a=!0)}jTh(){this.t6a&&(this.TVb.Gol(),this.xt.Voi(),this.t6a=!1)}}Object(e.a)(Ef,
"PaginationActor",null,[]);class Ag{constructor(J){this.G5f=J}}Object(e.a)(Ag,"PaginationDeltaResult",null,[1977]);class Lh{constructor(J,ma){this.oyb=this.wld=null;this.ti=J;ma.execute(Ta=>{Ta.register(this)})}get K0c(){return"PaginationDelta"}get result(){return this.wld}get YTf(){return 1}get qbg(){return 200}get isEnabled(){return!0}gUf(){this.wld=null}BDa(J){this.ti.ie(()=>{try{this.WHc(J)}catch(ma){za.ULS.sendTraceTag(39686615,324,10,"Exception caught in PaginationDeltaMetric.Calculate. Exception: {0}",
ma.message)}},"PDM:C")}Hjg(J){this.oyb=J}WHc(J){this.wld=null;J=this.XHc(this.oyb,J);-1!==J&&(this.wld=new Ag(J))}XHc(J,ma){if(!(J&&ma&&J.count&&ma.count))return-1;const Ta=new kb.a;for(const pb of J)Ta.add(pb.top);J=new kb.a;for(const pb of ma)J.add(pb.top);ma=this.NOd(Ta,J);return this.m5b(ma)}m5b(J){if(!J.count)return 0;let ma=0;for(let Ta=0;Ta<J.count;Ta++)ma+=J.J(Ta);return ma/J.count}NOd(J,ma){const Ta=new kb.a;if(!J.count||!ma.count)return Ta;var pb=J.count<=ma.count;const Wb=pb?J:ma;J=pb?
ma:J;for(ma=0;ma<Wb.count;ma++){pb=Wb.J(ma);let Zc=Math.abs(pb-J.J(0)),jd=0;for(let dd=1;dd<J.count;dd++){var Jc=J.J(dd);Jc=Math.abs(pb-Jc);Jc<Zc&&(Zc=Jc,jd=dd)}Ta.add(Zc);J.removeAt(jd)}return Ta}}Object(e.a)(Lh,"PaginationDeltaMetric",null,[1952]);var rh=c(461),zj=c(1420),Tj=c(2069);class lk extends rh.a{constructor(J,ma,Ta,pb,Wb,Jc,Zc,jd=null){super();this.aO=null;this.yxe=0;this.XZa=-1;this.zvb=!1;this.SY=()=>{za.ULS.sendTraceTag(7422755,336,50,"PaginationReplicator: disabling replication as user kicked out");
this.lTh()};this.NWf=()=>{if(0==this.oT.nu){var dd=this.aO.Pu;di.a.Dq(dd,this.UYb)||(this.UYb=dd,this.qqn(this.gYa,this.UYb))}};this.oT=J;this.Fda=this.Fda.bind(this);this.oT.XAb(this.Fda);this.ga=ma;this.xt=Ta;this.PZ=pb;this.mma=Wb;this.CJe=jd||ll.a.instance;this.UYb=this.gYa=di.a.nil;this.D$j=Zc;Jc.CWR(()=>Jc.result.nC.XNa(this.SY));this.W6b();this.zk=new zj.a(1E3);this.zk.d1a();this.mma.register(this)}get Via(){return"Pagination"}get Fgf(){return this.D$j.value}get yJa(){return this.XZa}Tpo(J){this.XZa!==
J&&(this.XZa=J,this.PZ.Ypg())}Fda(){this.gYa=this.UYb=di.a.nil;this.W6b()}PSa(J){this.aO=J;this.aO.$Fc(this.NWf);this.v2b(this.aO.node)}qqn(J,ma){di.a.Dq(J,ma)?(this.xt.Z_c(),this.W6b()):(this.xt.$_c(),this.hDo())}xvl(){this.enabled=2}W6b(){this.enabled=0}hDo(){this.yxe=0;this.xvl();this.kF(null,null,null)}LFa(){return db.App.lostSession||db.App.zd.nC.Jo?!1:!!(this.enabled&2)&&this.zk.w0()}kF(){this.zk.HPa();this.mma.xV()}forceOutbound(){}Jca(){return 0===this.enabled?!1:this.he&&this.he.status===
jp.a.responseReady?!0:this.LFa()}RTa(){if(1===this._state)this.he.Jq=Tj.a.Vba(l.AFrameworkApplication.rootQuerySignature,this.gYa),this.he.YG="Pagination",this.he.status=jp.a.requestReady,this._state=3;else if(3===this._state&&this.he&&this.he.status===jp.a.responseReady)if(l.AFrameworkApplication.Rk)this._state=4;else if(this.zk.i2(),this.zk.n9(),this._state=1,this.yxe++,2!==this.he.statusCode)this.X6b();else if(1!==(this.he.Mj?this.he.Mj.length:0))this.X6b();else{var J=this.he.Mj[0];this.CJe.EVa(J);
104===J.StatusCode?this.lTh():101===J.StatusCode?this.X6b():3===J.StatusCode?this.X6b():J.StatusCode?this.X6b():J.PageEnds?(this.Tpo(J.PageEnds.length+1),this.gYa=xc.b(J.LastKnownPaginationRevision),za.ULS.sendTraceTag(7479449,336,50,"PaginationReplicator: Start rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.XZa,this.gYa),this.xt.Noc(J.PageEnds,di.a.Dq(this.gYa,this.UYb)),this.Fgf.lja=J.PageEnds,this.PZ.k6e(),za.ULS.sendTraceTag(5870302,336,
50,"PaginationReplicator: Finished rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.XZa,this.gYa),this.Pol()):this.X6b()}}lTh(){this.aO&&this.aO.vjc(this.NWf);this.W6b()}X6b(){60<this.yxe&&this.W6b()}Pol(){di.a.Dq(this.gYa,this.UYb)&&this.W6b()}dispose(){this.aO&&(this.aO.vjc(this.NWf),this.aO.node&&this.J6c(this.aO.node),this.aO=null);this.oT.L8f(this.Fda)}v2b(J){J&&(J.addListener(this),this.zvb=!0)}J6c(J){this.zvb&&J&&(J.removeListener(this),
this.zvb=!1)}Gnb(J){this.J6c(J)}uya(){}KSa(J){(J=J.xd.Am)&&this.cnn(this.gYa,J.id)}cnn(J,ma){di.a.Dq(J,ma)&&this.xt.Z_c()}}Object(e.a)(lk,"PaginationReplicator",rh.a,[1943,9,108]);class lm{get l0d(){return!0}Noc(){}$_c(){}Z_c(){}Vsj(){}Voi(){}dispose(){}E6f(){}j6c(){}}Object(e.a)(lm,"PageEndMarkersNoOp",null,[1950,1951,9]);class Zn{dispose(){}PSa(){}get yJa(){return-1}}Object(e.a)(Zn,"PaginationReplicatorNoOp",null,[1943,9]);class En{constructor(){this.Yaa=this.xt=this.PZ=this.TVb=this.yH=null;this.wta=
!1;this.wDk=()=>{this.nth()}}get name(){return"WordEditor.Pagination"}wc(J){this.W=J;this.rd=this.W.resolve("Box4.IFeatureHelper");this.W.ia("WordEditor.Pagination.PageElementManagerList",()=>new Vg(this.W.resolve("WordEditor.Pagination.PageAdornmentManager"),this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).ha();this.W.ia("WordEditor.Pagination.OutlineManager",()=>new gd(new ac.a(()=>db.App.za.jb.rc))).as("WordEditor.Pagination.IOutlineManager").ha();this.W.ia("WordEditor.Pagination.PageManager",
()=>new cf(new ac.a(()=>db.App.za.jb.rc),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),this.W.resolve("WordEditor.Pagination.PageElementManagerList"),this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageHeightDeltaMetric"))).as("WordEditor.Pagination.IPageManager").ha();this.W.ia("WordEditor.IPaginationReplicator",()=>this.W.resolve("WordEditor.ClientPagination.IClientPaginationSettings").Mje?new Zn:new lk(this.W.resolve("WordEditor.IMainViewModeManager"),
l.AFrameworkApplication.va,this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"),Gh.App.W1,db.App.Uoa(),new ac.a(()=>this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings")))).ha();this.W.ia("WordEditor.ICurrentPageManager",()=>new Ro(this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).ha();this.W.ia("WordEditor.Pagination.PageLevelDeltaMetric",()=>new ud(new ac.a(()=>db.App.za.jb.rc),this.W.resolve("Box4.ITextMetricsAdapter"),
Cc.a.instance,this.W.Ta("WordEditor.FidelityMetrics.IFidelityMetricManager"))).ha();this.W.ia("WordEditor.Pagination.PageHeightDeltaMetric",()=>new Ia(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),Cc.a.instance,this.W.Ta("WordEditor.FidelityMetrics.IFidelityMetricManager"))).ha();this.W.ia("WordEditor.Pagination.PaginationDeltaMetric",()=>new Lh(Cc.a.instance,this.W.Ta("WordEditor.FidelityMetrics.IFidelityMetricManager"))).ha();this.W.ia("WordEditor.Pagination.PageHeightStorage",
()=>new Cb(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).ha();this.W.ia("WordEditor.Pagination.PageFullHeightDOMHelper",()=>new hs(new ac.a(()=>db.App.za.jb.rc),this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"))).ha();this.W.ia("WordEditor.Pagination.PageFullHeightInfoCalculator",()=>new Sp(this.W.resolve("WordEditor.Pagination.PageHeightStorage"),this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).ha();this.W.ia("WordEditor.Pagination.PageFullHeightRenderer",
()=>new Ir(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"))).ha();this.W.ia("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory",()=>new no(this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),this.W.Ve("WordEditor.Pagination.PageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"),this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).ha();
this.W.ia("WordEditor.Pagination.PageFullHeightPositionUpdater",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory").create()).ha();this.W.ia("WordEditor.Pagination.PageEndMarkerPositionUpdater",()=>new ol(new ac.a(()=>db.App.za.jb.rc),this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),
db.App.si.Il)).as("WordEditor.Pagination.IPageEndMarkerPositionUpdater").ha();this.W.ia("WordEditor.Pagination.PageFullHeightManagerFactory",()=>new Dn(this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.W.resolve("WordEditor.Pagination.PageHeightStorage"),Rp.WordSectionNavigator.instance,this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).ha();this.W.ia("WordEditor.Pagination.PageFullHeightManager",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightManagerFactory").create()).ha();
this.W.ia("WordEditor.Pagination.PageEndMarkerPositionComparer",()=>new Ci(this.W.resolve("Common.IZoomManager"),Cc.a.instance)).as("WordEditor.Pagination.IPageEndMarkerPositionComparer").ha();this.W.ia("WordEditor.Pagination.PaginationActor",()=>new Ef(l.AFrameworkApplication.va,this.W.resolve("WordEditor.IStatusBarUser"),this.W.resolve("WordEditor.ICurrentPageManager"),this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),l.AFrameworkApplication.ua,this.W.resolve("WordEditor.IPageNumberFinder"),
this.W.resolve("WordEditor.IMainViewModeManager"),this.W.resolve("WordEditor.ClientPagination.IClientPaginationSettings").Mje)).ha();this.W.ia("WordEditor.Pagination.DocumentSizeManager",()=>new ub(new ac.a(()=>db.App.za.jb.rc),Tl.a.get_instance(),this.W.resolve("WordEditor.IMainViewModeManager"))).ha();this.W.ia("WordEditor.Pagination.CurrentPageCalculator",()=>new Cn(l.AFrameworkApplication.va,Ll.a.instance,sh.a.instance,this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),new ac.a(()=>db.App.za.jb.rc),
this.W.Oa("Box4.CpConversionManagerImpl"),this.W.resolve("WordEditor.IStatusBarUser"))).as("Common.ICurrentPageCalculator").ha();this.W.ia("WordEditor.Pagination.IPageEndMarkers",()=>{this.W.resolve("WordEditor.ClientPagination.IClientPaginationSettings").Mje?this.xt=new lm:this.xt=new Km(new ac.a(()=>db.App.za.jb.rc),new ac.a(()=>db.App.za.jb.Zc.xd),this.W.resolve("WordEditor.Pagination.IPageAdornmentManager"),this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionComparer"),
this.W.resolve("WordEditor.Pagination.IPageManager"),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),Pl.a.vRc,this.W.resolve("WordEditor.ParagraphWordIdMapping"),sh.a.instance,Km.m_l,this.W.resolve("Box4.ContentEditableViewEventSource"),new Vq.a,this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),null,this.W.resolve("WordEditor.Pagination.PaginationDeltaMetric"),
this.W.resolve("Common.ICurrentPageCalculator"),this.W.resolve("WordEditor.IMainViewModeManager"));return this.xt}).as("Box4.IPaginationRefreshHelper").ha();this.W.ia("WordEditor.Pagination.PageEndDOMHelper",()=>new ag(this.W.Ta("Common.IZoomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!db.App.instance&&db.App.instance.dD)).ha();this.W.ia("WordEditor.Pagination.PageAdornmentAnimationManager",()=>new rd(l.AFrameworkApplication.lc)).as("WordEditor.Pagination.IPageAdornmentAnimationManager").ha();
this.W.ia("WordEditor.Pagination.PageAdornmentContentManager",()=>new Wd(this.W.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).as("WordEditor.Pagination.IPageAdornmentContentManager").ha();this.W.ia("WordEditor.Pagination.PageAdornmentManager",()=>this.Yaa=new If(new ac.a(()=>db.App.za.jb.rc),ip.a.instance,mo.a.instance,Ke.a.instance,l.AFrameworkApplication.va,bm.a.instance,this.W.resolve("WordEditor.Pagination.IPageAdornmentAnimationManager"),this.W.resolve("WordEditor.Pagination.IPageAdornmentContentManager"),
this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),sh.a.instance,l.AFrameworkApplication.K,!!db.App.instance&&db.App.instance.dD,!!db.App.instance&&db.App.instance.Hpa)).as("WordEditor.Pagination.IPageAdornmentManager").ha()}init(){this.rd.pq.continueWith(()=>{this.wn()})}wn(){const J=db.App.za.jb;J.zxa?this.nth():J.sga(this.wDk)}nth(){this.wta||(this.wta=!0,this.TVb=pa.a.instance.resolve("WordEditor.ICurrentPageManager"),this.PZ=pa.a.instance.resolve("Common.ICurrentPageCalculator"),
this.yH=pa.a.instance.resolve("WordEditor.IPaginationReplicator"),pa.a.instance.resolve("WordEditor.Pagination.PaginationActor").Tb())}dispose(){this.Yaa&&(this.Yaa.dispose(),this.Yaa=null);this.xt&&(this.xt.dispose(),this.xt=null);this.yH&&(this.yH.dispose(),this.yH=null);this.PZ&&(this.PZ.disable(),this.PZ=null);this.TVb&&(this.TVb=null)}}Object(e.a)(En,"PackageManager",null,[1,2]);class La{constructor(){this.W=null}wc(J){this.W=J||pa.a.instance}dispose(){}}Object(e.a)(La,"TellMePackage",null,[1,
2]);var Za=c(1520),Ab=c(1522),uc=c(348),Lc=c(1519),kd=c(1407);class Kd{constructor(J=null,ma=null,Ta=null,pb,Wb=null){this.fte=null;this.nLg=!1;this.IVg=this.JUb=null;this.$jk=this.ygh=this.rWj=this.JVg=!1;this.Yid=null;this.FWj=null==ma?l.AFrameworkApplication.oBb:ma;this.q7j=null==Ta?l.AFrameworkApplication.E0:Ta;this.Ikk=null==Wb?l.AFrameworkApplication.r8a:Wb;this.R5j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeHelpOnHelpIsEnabled");this.tmk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled");
this.Rpo(!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeIgnoreQueryForHelp"));this.kmk=!!l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Kb.DYc;this.lmk=!Lc.a.zpa()&&!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMePeopleSuggestionIsEnabled");this.jmk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeFileSuggestionIsEnabled");this.R2j=!!l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Kb.VQb;this.mmk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeSeeMoreButtonIsEnabledInZeroTerm");
this.Fjk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("HelpShowsTopSearchResult");this.Tdk=this.A$c||this.z$c;this.Rdk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("OnlineCommandSuggestionsIsEnabled");this.Sdk=this.vGf;this.C9j=!!l.AFrameworkApplication.K&&this.iVa&&l.AFrameworkApplication.K.$("StyledHeaderInLabelIsEnabled");this.o4j=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):
1400;this.U4j=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.c4j=l.AFrameworkApplication.K?parseFloat(l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold","-0.6")):-.6;this.z9j=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",
!1));this.d9j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTOChatPPTCopilot",!1);this.Y9j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotPaneEnabled",!1);this.N7j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OpenCopilotFromTellMe",!1)&&(this.eYm||this.JRm);this.q0b=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceActionAIEnabled",
!1);this.qlk=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";this.X4j=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.Gjk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",
!1);this.tkk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",!1);this.Wjk=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("ShowFindInDocumentInZeroTermSearchBox")||this.XP;this.N9j=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.$("TellMeTemplateProviderIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.$8j=
!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",!1);this.s9j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeIsRuleBasedSortingEnabled")&&"en-US"===l.AFrameworkApplication.uiCulture;this.K9j=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.$("TellMeFeedbackProviderIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",
!1));this.$9j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeZeroTermContextualCommandSuggestionsEnabled");this.sWj=this.iVa&&!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",!1);this.x5j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.zkk=!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",
!1)||"Word"!==l.AFrameworkApplication.K.kb("Application"));this.VXj=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",!1);this.lok=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMePerformanceMarkerEnabled");this.Q7j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",!1);this.U7j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",
!1);this.T4j=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.M9j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeNotesSuggestionIsEnabled")||this.jWm;this.S7j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",!1);this.T7j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",
!1);this.R7j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",!1);this.Y1j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMe",!1);this.Z1j=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableGenerateSlidesFromTellMeMVP",!1);this.X1j=!!l.AFrameworkApplication.K&&
l.AFrameworkApplication.pKh&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableBumblebeeEntryPointInTellMe",!1);this.nmk=this.RDi&&(this.xZf||this.yZf||this.M2c||this.iVa&&Lc.a.Lpa()&&!!l.AFrameworkApplication.K&&(this.Mlc||this.ZQb||this.$Qb||this.aRb||this.cRb||l.AFrameworkApplication.K.$("ShowAnswerSearchResults")||l.AFrameworkApplication.K.$("ShowDefinitionSearchResults")||l.AFrameworkApplication.K.$("ShowEntitySearchResults")||l.AFrameworkApplication.K.$("ShowWolframSearchResults")));
this.qVj=!!l.AFrameworkApplication.K&&!l.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled")&&l.AFrameworkApplication.K.$("AppsForOfficeAllowExternalMarketplace")&&l.AFrameworkApplication.eOa;this.rVj=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("AppsForOfficePrivateCatalogIsEnabled");this.MAm(J||{});this.VRe="2918242107";this.URe="1454393937";this.$xb={};this.oeb=[];this.Q6k=[Lc.a.une]}get application(){return this.JUb}get oBb(){return this.FWj}get aco(){return this.VRe}get $bo(){return this.URe}get Wkf(){return this.IVg}get m0h(){return this.JVg}get E0(){return this.q7j}get r8a(){return this.Ikk}get jBb(){return this.rWj}get mum(){return this.R5j}get gJo(){return this.tmk}get RDi(){return!0}get YIo(){return this.nmk}get Uso(){return this.ygh}Rpo(J){this.ygh=
J}get iVa(){return this.kmk}get Ibd(){return this.lmk}get Gbd(){return this.jmk}get lCl(){return this.R2j}get WIo(){return this.mmk}get ane(){return!1}get M2c(){return this.Tdk}get xZf(){return this.Rdk}get yZf(){return this.Sdk}get Y4a(){return!1}get i1d(){return!1}get jIf(){return this.C9j}get Lie(){return this.$jk}get Mlc(){return!1}get vuo(){return!1}get E0m(){return""}get wsf(){return 2}get Yam(){return 4}get Zam(){return 5}get khi(){return""}get JXl(){return this.o4j}get Ahi(){return this.U4j}get mhi(){return 1E3}get lhi(){return 1E-6}get sFo(){return this.qlk}get gkg(){return!1}get dxj(){return!1}get WTm(){return this.s9j}get R0d(){return!1}get S0d(){return!1}get qAi(){return!1}get pAi(){return!1}get jWm(){return!1}get SDi(){return!1}get BOd(){return!1}get rqb(){return!1}get ZQb(){return!1}get $Qb(){return!1}get aRb(){return!1}get cRb(){return!1}get A$c(){return this.Fjk}get Hlc(){return this.Gjk}get z$c(){return!1}get Epf(){return null}get L0d(){return!1}get Die(){return this.Wjk}get wdi(){return 0}get BRl(){return this.c4j}get hii(){return this.X4j}get dVm(){return this.z9j}get pDf(){return this.N7j}get Cie(){return this.q0b}get I5l(){return-3.9}get XP(){return this.tkk}get EYc(){return this.N9j}get HGf(){return this.$8j}get DIf(){return this.K9j}get hfb(){return this.sWj}get mYm(){return this.$9j}get bxa(){return this.x5j}get euj(){return this.zkk}get vMk(){return this.VXj}get Zoe(){return this.lok}get VYd(){return this.Q7j}get OHm(){return this.U7j}get hv(){return this.T4j}get Rlb(){return this.M9j}get MHm(){return this.S7j}get NHm(){return this.T7j}get LHm(){return this.R7j}get cAk(){return this.qVj}get dAk(){return this.rVj}get kha(){return this.Y1j}get FMd(){return this.Z1j}get J7b(){return this.X1j}get eYm(){return this.Y9j}get JRm(){return this.d9j}get UJb(){return!!l.AFrameworkApplication.ua&&
l.AFrameworkApplication.ua.Kb.Ir}get Ir(){return!!l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Kb.Ir}get EQm(){return!!l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Kb.Klc}get thn(){return Ue.getImageClass("OfficeAssistant_32x32x32")}ORd(){return Promise.reject("GetFindMatchCount method is not overridden")}B1d(J){return Array.contains(appChrome.selectors.getVisibleControlIds(),J)}FZd(){return!1}get W_d(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeModelRankerEnabled")}get Syj(){return l.AFrameworkApplication.K?
l.AFrameworkApplication.K.kb("TellMeServiceHelpClassifierModelName"):""}get vGf(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("TellMeMultiLingualCommandModelEnabled")}get QHb(){return"NoOpHeaderUi"}get J6k(){return this.Yid}get parameterData(){return this.$xb}get sQo(){return this.oeb}Txl(){if(this.fte&&!this.nLg&&(this.nLg=!0,this.jqb(this.fte),this.Ir)){var J=pa.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");J=(new kd.a(J)).eQd(this.fte.gH);appChrome.api.dispatch(J)}}get Bbg(){return""}jqb(){}unl(J){const ma=
[];for(let Ta=0;Ta<J.length;++Ta)J[Ta].ovo?ma.push(new uc.a(J[Ta].Sm,Lc.a.gDj+Ta.toString())):ma.push(new uc.a(J[Ta].standard,Lc.a.une+Ta.toString()));return ma}MAm(J){const ma={};for(let Ta in J){const pb=Ta,Wb=J[Ta];for(let Jc in Wb){const Zc=Jc,jd=Wb[Jc];(ma[Zc]||(ma[Zc]={}))[pb]=jd}}this.Yid=ma}get Tyj(){return""}get Qsj(){return!1}}Object(e.a)(Kd,"TellMeApplicationData",null,[1081]);class ce{constructor(J,ma=null,Ta=!1){this.standard=J;this.Sm=ma;this.ovo=Ta}}Object(e.a)(ce,"TryQuerySet",null,
[]);class Fe{constructor(){this.M7g=this.N7g=null}get Pen(){return this.M7g}Zga(J){this.N7g=J;return this.Ibf(J)}Ein(){this.M7g=this.N7g}DSd(J){return 8===J.type?String.format(CommonUIStrings.l_FindInDocumentText,J.hD):J.hD}fpf(J){return J.hD}}Object(e.a)(Fe,"ParameterizedCommand",null,[]);class Af extends Fe{constructor(J){super();this.nYc=J}get commandId(){return this.nYc?"DefinitionsParameterized":"DefinitionButton"}get W_f(){return"Definition"}Ibf(J){const ma=Va.a.zf(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,
J.hD));return Tg.a(Lc.a.wcf(J.value),m.a.fef.toString(),ma,Lc.a.ICf,null,Va.a.zf(Lc.a.sDb(J.hD)),ma,null,null)}DSd(J){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,J.hD)}fpf(J){return Lc.a.sDb(J.hD)}}Object(e.a)(Af,"DefinitionsParameterizedCommand",Fe,[]);class jh extends Fe{constructor(J){super();this.nYc=J}get commandId(){return this.nYc?l.AFrameworkApplication.ua.Kb.OMm?"FindWithMatchesParameterized":"FindParameterized":"EditingFind"}get W_f(){return"Find"}Ibf(J){const ma=
Va.a.zf(String.format(WordEditorIntl.WordEditorStrings.L_ParamFindInDocTitle,J.hD));return Tg.a(Lc.a.wcf(J.value),m.a.findInDocument.toString(),ma,"Find_16x16x32",null,Va.a.zf(J.hD),ma,null,null)}DSd(J){return String.format(CommonUIStrings.l_TextWithQuotation,J.hD)}}Object(e.a)(jh,"FindParameterizedCommand",Fe,[]);class Uj extends Fe{constructor(J){super();this.nYc=J}get commandId(){return this.nYc?"SynonymsParameterized":"SynonymButton"}get W_f(){return"Synonym"}Ibf(J){const ma=Va.a.zf(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_SynonymsParam,
J.hD));return Tg.a(Lc.a.wcf(J.value),m.a.fef.toString(),ma,Lc.a.ICf,null,Va.a.zf(Lc.a.sDb(J.hD)),ma,null,null)}DSd(J){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,J.hD)}fpf(J){return Lc.a.sDb(J.hD)}}Object(e.a)(Uj,"SynonymsParameterizedCommand",Fe,[]);var ug=c(2077),Ri=c(1987),Nj=c(2112),Vj=c(2073),of=c(2074),Qe=c(1607);class df extends ug.a{constructor(){super(...arguments);this.hO=null;this.UZa=Ri.FindManager.createInstance(this,Nj.a.instance,Qe.a.instance,
!0,!0)}static get instance(){return df._instance}z8b(){this.hO(this.UZa.Sj.yka);this.UZa.g0a(!0)}ORd(J){const ma=new Promise((Ta,pb)=>{this.hO=Ta;setTimeout(()=>{pb("Find manager execution timed out");this.UZa.g0a(!0)},500)});J=Vj.a.createQuery(J,of.a.none);this.UZa.find(J);return ma}}df._instance=new df;Object(e.a)(df,"TellMeFindStatusSpy",ug.a,[]);class lg extends Kd{constructor(J){super({});this.JUb="Word";this.B4j=J;l.AFrameworkApplication.K.$("TellMeFindInDocumentIsEnabled")&&(this.JVg=!0,this.IVg=
this.BOd?"FindWithMatchesParameterized":"FindParameterized");J=new Af(this.UJb);const ma=new Uj(this.UJb);this.parameterData[J.commandId]=J;this.parameterData[ma.commandId]=ma;J=new jh(this.UJb);this.parameterData[J.commandId]=J;l.AFrameworkApplication.K.$("TellMeTryQueriesIsEnabled")&&(J=[new ce(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery01,"",!1),new ce(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery02,"",!1),new ce(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery03,"",!1),new ce(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery04,
"",!1),new ce(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery05,"",!1)],this.oeb=this.unl(J))}ORd(J){return df.instance.ORd(J)}get x7a(){return Hr.AppFrame.hra}get QHb(){return Hr.AppFrame.FQa}get Bbg(){return"Microsoft.Office.Web.SessionSettings.IWacWordSharedHeaderSearchBoxSettings"}jqb(J){var ma=l.AFrameworkApplication.K;J=J.gH;J.WordCountFlyout=!this.B4j();J.SelectAllButton=!ma.$("TellMeSelectAllResultIsEnabled");const Ta=ma.$("TellMeDesktopUpSellIsEnabled");let pb=l.AFrameworkApplication.j1d;
appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TryOfficeUpsell",!pb));pb=!1;J.TextBoxUpSellButton=!Ta||pb;J.TableOfContentsUpSellButton=!Ta||pb;J.SmartArtUpSellButton=!Ta||pb;J.WordArtUpSellButton=!Ta||pb;J.MultiColumnLayoutUpSellButton=!Ta||pb;J.InsertEquationUpSellButton=!Ta||pb;J.TrackChangesUpSellButton=!Ta||pb;J.ShapesUpSellButton=!Ta||pb;J.LabelsUpSellButton=!Ta||pb;J.InsertCitationUpSellButton=!Ta||pb;J.TextBoxUpSellButtonEnterprise=!Ta||!pb;J.TableOfContentsUpSellButtonEnterprise=
!Ta||!pb;J.SmartArtUpSellButtonEnterprise=!Ta||!pb;J.WordArtUpSellButtonEnterprise=!Ta||!pb;J.MultiColumnLayoutUpSellButtonEnterprise=!Ta||!pb;J.InsertEquationUpSellButtonEnterprise=!Ta||!pb;J.TrackChangesUpSellButtonEnterprise=!Ta||!pb;J.ShapesUpSellButtonEnterprise=!Ta||!pb;J.LabelsUpSellButtonEnterprise=!Ta||!pb;J.InsertCitationUpSellButtonEnterprise=!Ta||!pb;ma=!ma.$("WordEditorTellMeDefinitionsAndSynonymsIsEnabled")||!l.AFrameworkApplication.E0;J.SynonymButton=ma;J.DefinitionButton=ma}get Tyj(){return l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeMultiLanguageModelName",
"")}get gkg(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeServiceAADAuthIsEnabled",!1)}get Syj(){return l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeHelpClassifierModelName","")}get Mlc(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowImageSearchResults",!1)}get vGf(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeMLCModelIsEnabled",
!1)}get wsf(){return l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMeMenuUpdatePolicy",0)}get Qsj(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowMoreFileResults",!1)}get i1d(){return l.AFrameworkApplication.K.$("TellMeRankerLoggingIsEnabled")&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableTellMeRankerLogging",!1)}get W_d(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerEnabled",
!1)}get R0d(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierEnabled",!1)}get S0d(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierSwapLogicEnabled",!1)}get mhi(){return l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerTimeOut",1E3)}get lhi(){return 1E-6*l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerSuppressionScore",
1)}get qAi(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionEnabled",!1)}get pAi(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionDebugEnabled",!1)}get khi(){return l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerModelName","")}get SDi(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermNotesSuggestionIsEnabled",
!1)}get wdi(){return l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.NumberOfNotesSuggestionsToShow",2)}get RDi(){return l.AFrameworkApplication.K.$("TellMeServiceForSearchIsEnabled")}get ane(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeTrimAndShowOptimalResults",!1)}get Y4a(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeNoHeadingUIV2",!1)}get Lie(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeUseFeatureIcons",
!1)}get dxj(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SubstrateResultsForContextMenuIsEnabled",!1)}get L0d(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.SelectionBasedZeroTermSuggestionsEnabled",!1)}get ZQb(){return l.AFrameworkApplication.K.$("ShowAnswerSearchResults")}get $Qb(){return l.AFrameworkApplication.K.$("ShowDefinitionSearchResults")}get aRb(){return l.AFrameworkApplication.K.$("ShowEntitySearchResults")}get cRb(){return l.AFrameworkApplication.K.$("ShowWolframSearchResults")}get Epf(){return l.AFrameworkApplication.K.$("ModernFontPickerIsEnabled")?
{["FontName"]:"FontPicker"}:{["FontPicker"]:"FontName"}}}Object(e.a)(lg,"WordEditorTellMeApplicationData",Kd,[]);var yg=c(1556),Aj;(function(J){J[J.none=0]="none";J[J.waitAll=1]="waitAll";J[J.synchronizeFast=2]="synchronizeFast";J[J.synchronizeSlow=3]="synchronizeSlow"})(Aj||(Aj={}));Object(e.b)("ProviderSynchronizationType",Aj);var Fi;(function(J){J[J.immediate=0]="immediate";J[J.waitAll=1]="waitAll";J[J.synchronizeAndWaitAll=2]="synchronizeAndWaitAll";J[J.synchronizeAndWaitForRanker=3]="synchronizeAndWaitForRanker"})(Fi||
(Fi={}));Object(e.b)("MenuUpdatePolicy",Fi);var Ik=c(1526),wl=c(1524),pk=c(1663),is=c(1527),Io=c(1551),Ur=c(114),As=c(292);class sv extends ug.a{constructor(J){super();this.kpk=J}z8b(){this.kpk.update()}}Object(e.a)(sv,"TellMeFindStatusManager",ug.a,[]);class fq{constructor(J){this.heb=this.PNg=null;this.ki=0;this.uod="TellMeWAC.";const ma=J.Wkf;this.fc=J;this.Fld=ma;this.tJe=Object.assign(new yg.a,{landingTab:"Indoc",data:null});J=new sv(this);this.UZa=Ri.FindManager.createInstance(J,Nj.a.instance,
Qe.a.instance,!0,!0)}oL(){return"WordFindInDocument"}BU(){return this.fc.wsf?this.fc.wsf===Fi.waitAll?Aj.waitAll:Aj.synchronizeSlow:Aj.none}dI(J,ma){this.yXm(J)?(this.heb=J,this.PNg=ma,J=Vj.a.createQuery(J.Gg,of.a.none),this.ki=window.performance.now(),this.UZa.find(J)):ma.resultsUpdated(new Ik.a(J))}update(){this.Zeo(Math.round(window.performance.now()-this.ki));var J=String.format(CommonUIStrings.l_TextWithQuotation,this.heb.Gg);var ma=l.AFrameworkApplication.ua&&l.AFrameworkApplication.ua.Kb.rqb?
Lc.a.VOa(this.heb.Gg,15,this.tJe):Va.a.zf(this.heb.Gg);const Ta=[];Ta.push(appChrome.actions.setControlLabel(this.Fld,J));Ta.push(appChrome.actions.setCompoundButtonCommandValueId(this.Fld,ma));Ta.push(appChrome.actions.updateCompoundButtonDescription(this.Fld,this.Uvf()));appChrome.api.dispatch(Ta);J=new wl.a(this.Fld,pk.a.FindInDocument,this.heb.Gg,this.UZa.Sj.yka.toString());ma=new is.a(Io.a.FindInDocument);ma.displayName=WordEditorIntl.WordEditorStrings.L_FindInDocument;ma.Uw(J);const pb=new Ik.a(this.heb);
pb.dv(ma);window.requestAnimationFrame(()=>{this.PNg.resultsUpdated(pb)});this.UZa.g0a(!0);this.$eo(Math.round(window.performance.now()-this.ki))}Uvf(){const J=this.UZa.Sj.yka.toString();return"1"===J?String.format(CommonUIStrings.l_SearchResultText,J):String.format(CommonUIStrings.l_SearchResultsText,J)}yXm(J){return!!J&&!!J.Gg&&""!==J.Gg.trim()}Zeo(J){const ma={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"ApiCall",["Service"]:"FindApi",["UiElement"]:"FindWithMatchesParameterized",
["QueryLength"]:this.heb.Gg.length};this.sendActivityEvent(ma,J)}$eo(J){const ma={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"Provider",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.heb.Gg.length};this.sendActivityEvent(ma,J)}sendActivityEvent(J,ma){J=Ur.a.oJ(J);fd.a.FIa(Object.assign(new As.a,{name:"Latency",dataFields:J,durationMs:ma}),this.uod)}}Object(e.a)(fq,"WordFindInDocumentWithMatchesProvider",null,[1112]);class tv{constructor(J,ma){this.oc=J;this.tYd=
ma}U3a(J,ma,Ta){return this.tYd.U3a(0,J,ma,Ta)}insertHtmlText(J){return J?32===this.iCf(J):!1}iCf(J){return this.executeCommand(ti.a.Zma,J)}executeCommand(J,ma){const Ta=new fn.DictionaryPropertySet;Ta.setValue(jm.a.NP,ma);Ta.setValue(jm.a.Wja,!1);ma=this.oc.processAction(J,1);32===ma&&(ma=this.oc.Qb(J,2,Ta));return ma}}Object(e.a)(tv,"WordInsertContentHandler",null,[1940]);class Nt extends La{constructor(){super();this.Xx=()=>{if(l.AFrameworkApplication.Mlg){var J=db.App.za.Kb.Huf(m.a.tellMe);J.tWc?
this.J2i():J.D_(this.Gbo);var ma=new lg(()=>!1);Za.TellMeActor.instance.initialize(ma,null,null,null,null,null,Object(a.a)(db.App.za,db.App.za.HPd,"forceUpdateRibbonControls"),l.AFrameworkApplication.K,this.W.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.W.Ta("Common.IActionContextProvider"),this.W.Ta("Common.ISystemInitiatedFeedback"));Za.TellMeActor.instance.CUn(J);Za.TellMeActor.instance.EWn(new tv(l.AFrameworkApplication.va,this.W.Oa("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor")));
ma.m0h&&ma.BOd&&Za.TellMeActor.instance.WE(new fq(ma),Ab.a.tellMe)}};this.Gbo=()=>{this.J2i()}}get name(){return"WordEditor.TellMe"}init(){l.AFrameworkApplication.K.Nn(this.Xx)}J2i(){db.App.za.updateCommandUI()}}Object(e.a)(Nt,"WordEditorTellMePackage",La,[]);class Iq{constructor(){this.W=null;this.Vyj=(J,ma,Ta)=>{2===Ta&&(J=new Ng.StandardDialog,J.Cd=0,J.jka(WordEditorIntl.WordEditorStrings.L_WordTestFeature,WordEditorIntl.WordEditorStrings.L_WordTestFeatureDialogText,null));return 32}}get name(){return"WordEditor.TestFeature"}init(){this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>
{this.wn()})}dispose(){}wn(){if(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(126)){l.AFrameworkApplication.va.fb(hh.a.ZLj,Uh.a.view,this.Vyj,96);var J=Xf.FocusManager.instance().fe(Hr.AppFrame.VD);eg.AFrame.Ci(J,Me.KeyInputManager.ic(Fj.a.$9a,5|Me.KeyInputManager.Rh),hh.a.ZLj)}}wc(J){this.W=J}static main(){M.a.instance.Gc(new Iq)}}Object(e.a)(Iq,"WordEditorTestFeaturePackage",null,[1,2]);var Ox=c(107);class ur{constructor(J,ma){this.Bgj=J;this.oc=ma;this.ege=(Ta,pb,Wb,Jc,Zc)=>{if(1===Wb)return 32;
this.Bgj.qN(9,Zc,!1);return 32};this.m1=(Ta,pb)=>{if(9===pb.type){var Wb;(Ta=pb.NL)?("string"===typeof Ta?Wb=Ta:"data"===Ta.type&&(Wb=Ox.a.ZNh(Ta.mHn,Ta.newState,Ta.Upo)),Wb&&ur.UFc(Wb)):za.ULS.sendTraceTag(556103040,376,15,"TrackChangeSettingUpdateNotificationEventArgs is null")}};this.m6c()}m6c(){this.oc.ra(hh.a.ege,y.a.frame,this.ege);this.Bgj.T3(this.m1)}dispose(){}static UFc(J){J=db.App.za.notificationBar.Cva(J,!1);J.image=5;J.fpa="CoAuth_AuthorStatus_16x16x32";db.App.za.notificationBar.sA(J)}}
Object(e.a)(ur,"TrackChangeNotificationActor",null,[]);class Jr{constructor(){this.kj=this.HWe=this.W=null;this.F2c=()=>{if(this.kj=db.App.tVd().result)this.W.ia("WordEditor.TrackChange.TrackChangeNotificationActor",()=>new ur(this.kj,l.AFrameworkApplication.va)).ha(),this.HWe=this.W.resolve("WordEditor.TrackChange.TrackChangeNotificationActor")}}get name(){return"WordEditor.TrackChangeNotificationActor"}wc(J){this.W=J}init(){this.W.resolve("Box4.IFeatureHelper").pq.continueWith(()=>{this.wn()})}wn(){db.App.tVd().continueWith(this.F2c)}dispose(){this.HWe&&
this.HWe.dispose()}}Object(e.a)(Jr,"WordEditorTrackChangeNotificationActorPackageManager",null,[1,2]);var uv=c(100),Dk=c(1500),js=c(2067);class Wj{}Wj.Uog="UnsavedChanges";Wj.Vog="UnsavedChangesThemed";Wj.Wao="SavedChanges";Wj.rEj="UnsavedChangesOpenPipe";Wj.rTo="UnsavedChangesOpenPipeCssClassNameThemed";Wj.qEj="UnsavedChangesClosePipe";Wj.oTo="UnsavedChangesClosePipeThemed";Wj.pTo="UnsavedChanges";Wj.qTo="UnsavedChangesThemed";Wj.Wog="UnsavedChangesIndicatorPositionRef";Object(e.a)(Wj,"UnsavedChangesHighlightUtils",
null,[]);class Px extends Dk.a{constructor(J,ma){super();this.ufa=J;this.zx=ma;this.f3=[this.zx?new js.a(Wj.Vog,Wj.qTo):new js.a(Wj.Uog,Wj.pTo)]}get Nca(){return!0}get gkb(){return 4}get A3a(){return this.f3}HHa(J,ma){if(this.ufa){var Ta=this.ufa.jQf;if(Ta&&Ta.count&&Ta.contains(J.id))for(J=ma.dIa("span"),ma=0;ma<J.length;ma++)Ta=J[ma],ma||Ta.classList.add(this.zx?Wj.rTo:Wj.rEj),ma===J.length-1&&Ta.classList.add(this.zx?Wj.oTo:Wj.qEj),Ta.classList.add(this.zx?Wj.Vog:Wj.Uog)}}V2a(){}}Object(e.a)(Px,
"UnsavedChangesHighlightActor",Dk.a,[]);var Qw=c(1063);class Ot{constructor(J){this.Zxe=null;this.ufa=J;this.vGe=!1}get key(){return"UnsavedChangesHighlight"}get $w(){return"UnsavedChanges"}reset(J){if(this.ufa){J=J.node;if(Gj.ParagraphReader.Xb(J)){const ma=this.ufa.jQf;if(ma&&ma.contains(J.id)){this.vGe=!0;this.Zxe=J.id;return}}this.vGe=!1;this.Zxe=di.a.nil}}GJa(){let J=null;return this.vGe?(J=Object.assign(new Qw.a,{$G:this.key,contentObject:this.Zxe,description:null}),{returnValue:!0,hG:J}):{returnValue:!1,
hG:J}}}Object(e.a)(Ot,"UnsavedChangesHighlightCpContentDetailsProvider",null,[414,415]);class Vs{constructor(J,ma,Ta,pb,Wb,Jc,Zc){this.K7g=null;this.K6=J;this.rf=ma;this.SW=Ta;this.n7=pb;this.Pjh=Wb;this.M_b=Jc;this.zx=Zc;this.rf.XNa(this.SY.bind(this))}get jQf(){return this.K7g}gvm(){if(this.K6){if(1===this.K6.f9e){if(0===this.K6.fKf&&this.K6.HZi()){this.K7g=this.K6.b5d;const J=this.K6.mdd;this.K6.Xao.forEach(this.tol.bind(this));J.forEach(this.hvm.bind(this));0<J.length&&this.gql(this.SW);return 0}return this.qQn(this.K6.fKf)}return 2}return 1}qQn(J){switch(J){case 0:return this.K6.foi()?
5:6;case 3:case 12:case 5:case 11:return 4;default:return 6}}cpi(J,ma,Ta){if(ma)if(Ta){Ta=ma.querySelectorAll("span");for(let pb=0;pb<Ta.length;pb++){const Wb=Ta[pb];pb||Wb.classList.add(Wj.rEj);pb===Ta.length-1&&Wb.classList.add(Wj.qEj);Wb.classList.add(this.zx?Wj.Vog:Wj.Uog)}ma.classList.add(Wj.Wog);J&&this.n7.Loc(J)}else ma.classList.add(Wj.Wao)}Tac(J,ma){const Ta=this.uim(J);if(J&&(J=J.te(Gh.App.za.jb.rc.$b)))if(J.Xg&&J.Xg.hj&&0!==J.Xg.hj.count)for(const pb of J.Xg.hj)this.cpi(Ta,pb,ma);else this.cpi(Ta,
J.htmlElement,ma)}uim(J){return this.Pjh&&(J=this.Pjh.jHb(J))&&J&&(J=J.te(Gh.App.za.jb.rc.$b))?J:null}hvm(J){this.Tac(J,!0);return!0}tol(J){this.Tac(J,!1);return!0}gql(J){J&&J.continueWith(()=>{J.result.logActivity("UnsavedChangesHighlightEnableSurvey","WordUnsavedChangesHighlightingSurveyGateIsEnabled",0)})}SY(J,ma){ma===Sys.EventArgs.Empty?za.ULS.sendTraceTag(572364513,306,50,"HighlightUnsavedChanges Not Run: Empty Event Args"):ma&&ma.errorCode?this.M_b.XU||(J=this.gvm(),za.ULS.sendTraceTag(576528923,
306,15,"HighlightUnsavedChanges Run Result: {0}",J),Oa.Health.instance.recordKpiUsage("UnsavedChangesHighlight",0,"wwrelfc",null),0!==J&&4!==J&&this.YMo(J)):za.ULS.sendTraceTag(572364514,306,50,"HighlightUnsavedChanges Not Run: No {0}",ma?"Error Code":"Kickout Event Args")}YMo(J){let ma;const Ta=new Bf.a;Ta.extendedProperties=new Map;Ta.extendedProperties.set("HighlightUnsavedChangesResult",J.toString());Ta.extendedProperties.set("UnsavedChangesCollectionResult","-1");switch(J){case 1:case 2:case 6:ma=
"HighlightInternalError";break;case 5:ma="ChangeOutsideCanvas"}6!==J&&5!==J||Ta.extendedProperties.set("UnsavedChangesCollectionResult",this.K6.fKf.toString());ma&&(Oa.Health.instance.recordQosError(ma,["UnsavedContentNotHighlighted"],!0,!0,!1,!1,Ta),Oa.Health.instance.recordKpiFailure("UnsavedChangesHighlight",ma,!0,!0,Ta))}dispose(){this.rf.aPb(this.SY.bind(this))}}Object(e.a)(Vs,"UnsavedChangesHighlighter",null,[9]);var vr=c(504),Bs=c(463),dm=c(1498);class Rw extends dm.a{constructor(J,ma){super();
this.ufa=J;this.zx=ma}e8a(J){if(!this.ufa)return!1;const ma=this.ufa.jQf;return ma?ma.contains(J.Cb.id)||J.htmlElement.querySelector(".UnsavedChanges")?!0:!1:!1}sRk(J,ma){ma=J.rxa?J.rxa[ma]?J.rxa[ma].style?J.rxa[ma].style.marginLeft:null:null:null;var Ta=J.leftMargin;J=1440<=Ta?-(Ta/1440*96):J.d0a(0,96,this.zoom);Ta=0;ma&&(ma=ma.match(/^(\d+)px/))&&ma[1]&&(Ta=Number(ma[1]));return J-Ta}ZRk(J,ma,Ta){return Sys.UI.DomElement.getBounds(J).y-Ta.L4[ma].y}iRk(J){return Sys.UI.DomElement.getBounds(J).height}qNh(J,
ma,Ta,pb){let Wb;Wb=this.sRk(Ta,ma);ma=this.ZRk(J,ma,Ta);J=this.iRk(J);pb=vr.a.createElement(pb,Bs.a.div);pb.className=this.zx?"UnsavedChangesIndicatorThemed":"UnsavedChangesIndicator";pb.style.left=Wb+"px";pb.style.top=ma+"px";pb.style.height=J+"px";return pb}EMh(J,ma,Ta,pb){const Wb=[],Jc=J.querySelectorAll("."+Wj.Wog);if(0===Jc.length&&J.classList.contains(Wj.Wog))Ta=this.qNh(J,ma,Ta,pb),Ta.Oga=ma,Wb.push(Ta);else for(J=0;J<Jc.length;J++){const Zc=this.qNh(Jc[J],ma,Ta,pb);Zc.Oga=ma;Wb.push(Zc)}return Wb}R0a(J){let ma=
[];var Ta=J.w5;const pb=Ta.Fg.ownerDocument;if(Ta.gk){let Wb=0;for(const Jc of Ta.Xg.hj)(Ta=this.EMh(Jc,Wb,J,pb))&&(ma=ma.concat(Ta)),Wb+=1}else ma=this.EMh(Ta.htmlElement,0,J,pb);return ma}}Object(e.a)(Rw,"UnsavedChangesIndicatorActor",dm.a,[]);class Ws{constructor(){this.wW=this.Dv=this.HLa=this.n7=this.fod=this.ufa=null}get name(){return"WordEditor.UnsavedChangesHighlight"}wc(){}init(){this.n7=pa.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance;this.ufa=new Vs(pa.a.instance.resolve("Wonca.UnsavedChangesCollection.IUnsavedChangesCollector"),
Zh.SessionStatusManager.instance,gh.a.Gp(pa.a.instance.Ta("Common.ISystemInitiatedFeedbackWithTimeLapse")),this.n7,pa.a.instance.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),pa.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager"),!!db.App.instance&&db.App.instance.Hpa);this.HLa=pa.a.instance.Ta("Box4.Accessibility.IAccessibilityContextManager");this.wW=pa.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance;this.fod=new Rw(this.ufa,!!db.App.instance&&
db.App.instance.Hpa);this.n7.GTa(this.fod);this.HLa&&this.HLa.execute(J=>{J.D5(new Ot(this.ufa))});this.Dv=new Px(this.ufa,!!db.App.instance&&db.App.instance.Hpa);this.wW.b7a(this.Dv)}dispose(){this.n7&&this.fod&&this.n7.Wne(this.fod);this.wW&&this.Dv&&this.wW.Pog(this.Dv);uv.a.jC(this.ufa)}static main(){M.a.instance.Gc(new Ws)}}Object(e.a)(Ws,"WordEditorUnsavedChangesHighlightPackage",null,[1,2,9]);var Vr=c(129);class vv{constructor(J,ma,Ta){this.ga=J;this.kn=ma;this.Ca=Ta}Tb(){this.Ca.$("ZoomPopupDialogIsEnabled")&&
(this.ga.ra(m.a.hmc,y.a.frame,Object(a.a)(this.kn,this.kn.hmc,"showZoomDialog")),this.ga.fb(m.a.lNn,y.a.frame,Object(a.a)(this.kn,this.kn.FXi,"onQueryZoomText"),96),this.ga.ra(m.a.$ed,y.a.frame,Object(a.a)(this.kn,this.kn.rMj,"zoomDialogTabFocusHandler")),this.ga.ra(m.a.Zed,y.a.frame,Object(a.a)(this.kn,this.kn.rMj,"zoomDialogTabFocusHandler")));this.Ca.$("ZoomSliderIsEnabled")&&(this.ga.fb(m.a.t6i,y.a.frame,Object(a.a)(this.kn,this.kn.Gsn,"onQueryZoomPercentage"),96),this.ga.fb(m.a.tMj,y.a.frame,
Object(a.a)(this.kn,this.kn.wwn,"onZoomToPercentage"),96),this.ga.ra(m.a.g9o,y.a.frame,Vr.ActionManager.Of))}}Object(e.a)(vv,"CommonZoomActor",null,[939]);class wv extends vv{constructor(J,ma,Ta){super(J,ma,Ta);this.lga=ma}Tb(){super.Tb();this.Ca.$("ZoomPopupDialogIsEnabled")&&(this.ga.ra(hh.a.ctg,y.a.frame,Vr.ActionManager.Of),this.ga.ra(hh.a.sqe,y.a.frame,Object(a.a)(this.lga,this.lga.f9o,"zoomTo100")));this.ga.ra(hh.a.zoomToPageWidth,y.a.frame,Object(a.a)(this.lga,this.lga.zoomToPageWidth,"zoomToPageWidth"));
this.ga.ra(m.a.vkb,y.a.frame,Object(a.a)(this.lga,this.lga.vkb,"increaseZoom"));this.ga.ra(m.a.Wgb,y.a.frame,Object(a.a)(this.lga,this.lga.Wgb,"decreaseZoom"));this.ga.ra(hh.a.Nbg,y.a.frame,Object(a.a)(this.lga,this.lga.Fpo,"setZoomLevelFromRibbon"));this.ga.fb(hh.a.Nob,y.a.frame,Object(a.a)(this.lga,this.lga.FXi,"onQueryZoomText"),96);this.ga.fb(hh.a.qce,Uh.a.application,Object(a.a)(this.lga,this.lga.Fsn,"onQueryZoomLevelLabelText"),96);this.ga.ra(ti.a.aPh,y.a.frame,Vr.ActionManager.Of);this.ga.ra(ti.a.$Oh,
y.a.frame,Vr.ActionManager.Of);this.ga.ra(ti.a.ePh,y.a.frame,Vr.ActionManager.Of);this.ga.ra(ti.a.bPh,y.a.frame,Vr.ActionManager.Of);this.ga.ra(hh.a.Jka,y.a.frame,Vr.ActionManager.Of)}}Object(e.a)(wv,"WordEditorZoomActor",vv,[]);class mu{constructor(J,ma){this.zoom=J;this.cCk=ma}}Object(e.a)(mu,"SetCustomZoomArgs",null,[]);var Sw=c(1170);class fg{constructor(J,ma){this.Gil=[CommonUIStrings.l_FullPage,CommonUIStrings.l_PageWidth,"200%","150%","100%","75%","50%"];this.Hil=[fg.hff,fg.nLd,"200","150",
"100","75","50"];this.Nna=3;this.UN=0;this.delta=.1;this.$Kf=0;this.fd=new S.a;this.ai=null;this.K=J;this.oc=ma;this.Ooj(1)}get nj(){return this.UN}Ooj(J){this.UN=J}get hLc(){return Math.round(100*this.nj)}get ihn(){return Math.floor(this.hLc/10)/10+this.delta}get hhn(){return Math.ceil(this.hLc/10)/10-this.delta}get ga(){return l.AFrameworkApplication.va}Ozk(J){this.fd.addHandler("ZoomChanged",J)}v2n(J){this.fd.removeHandler("ZoomChanged",J)}fZ(J){this.Ozk(J)}OTa(J){this.v2n(J)}$9i(){}Taj(){}Z9i(){}Saj(){}afd(J){this.sMj(J,
this.nj)}sMj(J,ma){null!==J&&Tr.a.xnj(J,ma)}kfg(J,ma=!0){let Ta=J*=100;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(Ta=new mu(J,ma));this.olj(Ta)}Epo(J,ma=!1){this.Jka(J,3|(ma?0:4))}uwn(J,ma,Ta){if(1===J)return 32;J=Ta/100;J<this.N0c?J=this.N0c:J>this.r0c&&(J=this.r0c);this.Jka(J,1);ma&&(ma.Hs=Math.floor(100*J));return 32}FXi(J,ma,Ta,pb,Wb){if(1===Ta)return 32;J=Va.a.gFa(this.hLc,6,l.AFrameworkApplication.numberFormat);Wb.Value=J;Wb.LabelText=J;return 32}wwn(J,ma,Ta,pb,Wb){return 1===
Ta?32:this.uwn(Ta,pb,Wb.value)}Gsn(J,ma,Ta,pb,Wb){Wb.MinValue=100*this.N0c;Wb.MaxValue=100*this.r0c;Wb.value=this.hLc;return 32}Lki(){return this.Gil}Mki(){return this.Hil}MUl(){let J=Math.floor(100*this.nj).toString();1===this.Nna?J=fg.hff:2===this.Nna&&(J=fg.nLd);return J}vkb(J,ma,Ta){if(1===Ta)return 32;this.L_c(this.oc?this.oc.MC:0,"IncreaseZoom");this.Nna=0;this.Jka(this.ihn);return 32}Wgb(J,ma,Ta){if(1===Ta)return 32;this.L_c(this.oc?this.oc.MC:0,"DecreaseZoom");this.Nna=0;this.Jka(this.hhn);
return 32}Fpo(J,ma,Ta,pb,Wb){if(1===Ta)return 32;this.L_c(this.oc?this.oc.MC:0,"SetZoomLevelFromRibbon");J=Wb.Value;if(J.toLowerCase().startsWith("fit"))return J=new Kb.a(0,1,0,()=>{this.zoomToPageWidth(0,null,2,null,null)},138,void 0,!0),sh.a.instance.Wb(J),32;J=parseInt(J)/100;if(isNaN(J))return 2;this.Nna=0;this.Jka(J);return 32}L_c(J,ma){za.ULS.sendTraceTag(42341577,353,50,"Update Zoom. CommandLocation: {0}; Command: {1}; IsSLR: {2}",J,ma,l.AFrameworkApplication.ua.Kb.Ir)}hmc(J,ma,Ta){if(1===
Ta)return 32;za.ULS.sendTraceTag(7176728,353,50,"Customer is trying to trigger the Zoom dialog");this.showDialog();return 32}showDialog(){const J=this.MUl();this.ai=new Sw.a(this.Lki(),this.Mki(),Object(a.a)(this,this.vrm,"handleZoomDialogResult"),Xf.FocusManager.instance(),!0);this.ai.hmc(CommonUIStrings.l_ZoomDialogTitle,J)}sLm(J){return J.toLowerCase()===fg.hff.toLowerCase()}tLm(J){return J.toLowerCase()===fg.nLd.toLowerCase()}vrm(J){if(J){if(this.sLm(J)){this.Nna=1;var ma=32}else if(this.tLm(J))this.Nna=
2,ma=this.zoomToPageWidth(0,null,2,null,null);else if(ma=Number.parseInvariant(J)){this.Nna=0;let Ta=ma;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(Ta=new mu(ma,!0));ma=this.olj(Ta)}else ma=8;32===ma?za.ULS.sendTraceTag(7176729,353,50,"Succeeded to Zoom: {0}",{["DialogResult"]:J}):za.ULS.sendTraceTag(7156360,353,10,"Failed to Zoom: {0}",{["DialogResult"]:J})}else za.ULS.sendTraceTag(529290753,353,10,"Failed to Zoom: {0}",{["DialogResult"]:J})}oPn(){this.fd.raiseEvent("ZoomChanged",null)}Y6i(){}B5f(){}rMj(J){if(!this.ai)return 2;
var ma=this.ai.focusManager.at().hk.l4;if(ma===this.ai.aA&&J===m.a.$ed||ma===this.ai.mH&&J===m.a.Zed)this.ai.HAb||this.ai.Jco(),this.ai.focusManager.at().hk.gz(this.ai.HAb);else if(ma.id.startsWith(this.ai.M5c)||ma.className.startsWith(this.ai.B6i))ma=null,J===m.a.$ed?ma=this.ai.mH:J===m.a.Zed&&(ma=this.ai.aA),this.ai.focusManager.at().hk.gz(ma),Sys.UI.DomElement.removeCssClass(this.ai.HAb.parentNode,this.ai.q5f);else if(J===m.a.$ed)this.ai.focusManager.at().egc();else if(J===m.a.Zed)this.ai.focusManager.at().cgc();
else return 2;return 32}}fg.hff="FullPage";fg.nLd="PageWidth";Object(e.a)(fg,"ZoomManager",null,[840]);var oi;(function(J){J[J.manual=0]="manual";J[J.fitToFullPage=1]="fitToFullPage";J[J.fitWidth=2]="fitWidth";J[J.onBoot=3]="onBoot"})(oi||(oi={}));Object(e.b)("ZoomStatus",oi);c(1085);var So;(function(J){J[J.normal=0]="normal";J[J.quiet=1]="quiet";J[J.disableScrollUpdate=2]="disableScrollUpdate";J[J.disableUiControlUpdate=4]="disableUiControlUpdate"})(So||(So={}));Object(e.b)("ZoomUpdateFlags",So);
var wr=c(245),Lm=c(332),Wm=c(1220);class Tw extends fg{constructor(J,ma,Ta,pb,Wb,Jc,Zc){super(J,ma);this.y5o=[CommonUIStrings.l_PageWidth,"200%","150%","125%","100%","75%","50%"];this.z5o=[fg.nLd,"200","150","125","100","75","50"];this.zXe=this.Iej=!1;this.AMg="AutoFitForAdaptiveLayout";this.n3j="FitPageWidthFailure";this.aok="UpdateZoomFailure";this.wpk="wwf";this.PYe=null;this.c9i=()=>{this.Nna===oi.fitWidth&&this.Clf()};this.Vgl=jd=>{if(jd.ctrlKey){l.AFrameworkApplication.va.processAction(ti.a.bPh,
2);jd=jd.A4o;if(!jd)return!1;this.Jka(this.nj-(0<jd?.1:-.1));this.L_c(6,"CtrlScroll");return!0}return!1};this.vwn=()=>{za.ULS.sendTraceTag(42341578,353,50,"Click event detected on Zoom Label. IsSLR: {0}",!0);return!0};this.iX=Ta;this.tk=pb;this.Vb=Wb;this.ig=Jc;this.Qvc=Zc;this.H3g=J.$("KeepViewAfterZoomIsEnabled");this.xpk=J.$("ZoomShortCutIsEnabled");this.pok=J.$("DoNotAutoScrollAfterPinchIsEnabled");this.a8j=(this.yFe=J.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&J.$("AutoFitForSmallScreenModeIsEnabled");
this.q1j=J.$("DoNotProcessUpdateZoomActionIsEnabled");this.ypk=J.$("ZoomSliderIsEnabled");this.Qz()}get appName(){return"WordEditor"}get r0c(){return 4}get N0c(){return.1}get Wgl(){return wacBoot.CtrlWheelMetrics}dzk(J){this.fd.addHandler("PinchStart",J)}l2n(J){this.fd.removeHandler("PinchStart",J)}czk(J){this.fd.addHandler("PinchEnd",J)}k2n(J){this.fd.removeHandler("PinchEnd",J)}get cK(){return null!=this.lHg?this.lHg:this.lHg=pa.a.instance.Oa("WordEditor.IStatusBarUser")}tIj(J){J=!(J&So.disableUiControlUpdate);
const ma=Ya.a.get_instance().isCompleted(7);return J&&ma?(J={SelectZoomOption:"ComboBoxModel"},db.App.za&&db.App.za.jH(J),this.b0o(),!0):!1}Jka(J,ma=So.normal){let Ta=!0;this.q1j||l.AFrameworkApplication.va.processAction(hh.a.Jka,2);if(this.nj===J)return this.zXe||(this.zXe=this.tIj(ma)),Ta;J>this.r0c?J=this.r0c:J<this.N0c&&(J=this.N0c);var pb=!!(ma&So.quiet);1===J||pb||l.AFrameworkApplication.va.processAction(hh.a.ctg,2);try{pb=null;db.App.za&&Object(nc.a)(Wm.MainView,db.App.za.jb.rc)&&(pb=db.App.za.jb.rc);
let Wb=-1,Jc=-1,Zc=-1;const jd=!(ma&So.disableScrollUpdate);this.H3g&&jd&&(Wb=xe.SelectionEditor.Bkm(Ll.a.instance.ib.lb,pb),Jc=pb.GL.scrollLeft,Zc=pb.GL.scrollTop);const dd=this.nj;this.Ooj(J);this.oPn();this.zXe=this.tIj(ma);jd&&this.CZo(pb,Wb,Jc,Zc,dd)}catch(Wb){Ta=!1,za.ULS.sendTraceTag(7185431,353,10,"UpdateZoom error:{0}",Wb)}return Ta}CZo(J,ma,Ta,pb,Wb){J&&J.isActive?this.H3g?0<=ma&&100>=ma?J.Es.E1(100-ma,!0,!0):J.Es.cZm(Ta,pb,Wb,this.nj):J.Es.E1():za.ULS.sendTraceTag(7185430,353,10,"UpdateZoom: Failed to get PageView to scroll content")}f9o(J,
ma,Ta){2===Ta&&(this.L_c(this.oc?this.oc.MC:0,"ZoomTo100"),this.Nna=oi.manual,this.Jka(1));return 32}olj(J){this.Nna=oi.manual;let ma,Ta=!0;if(this.pok){if(!Object(nc.a)(mu,J))return za.ULS.sendTraceTag(51644238,353,10,"actiondata is not a SetCustomZoomArgs"),8;ma=J.zoom/100;Ta=J.cCk}else ma=Number.parseInvariant(String.format("{0}",J))/100;za.ULS.sendTraceTag(7410915,353,50,"Word Editor - Zoom to custom value: {0}",ma);J=So.normal;Ta||(J=So.disableScrollUpdate);this.Jka(ma,J);return 32}zoomToPageWidth(J,
ma,Ta){if(1===Ta)return 32;za.ULS.sendTraceTag(7410944,353,50,"Word Editor - Zoom to fit page width");Object(wc.a)("ZoomToPageWidth",!0);this.Nna=oi.fitWidth;this.yxl();return this.Clf()}Fsn(J,ma,Ta,pb,Wb){if(1===Ta)return 32;J=Va.a.gFa(this.hLc,6,l.AFrameworkApplication.numberFormat);Wb[wr.a.labelText]=J;return 32}Lki(){return this.y5o}Mki(){return this.z5o}yxl(){this.Iej||(db.App.za?(db.App.za.E_(this.c9i),this.Iej=!0):za.ULS.sendTraceTag(7185432,353,10,"EnsureResizeEventRegistered: Failed to get PageManager to register event"))}Clf(){var J=
this.iX.Pqf();if(!J)return 8;for(var ma=0;J;)ma=Math.max(ma,Ec.a.instance.qu(J)),J=this.iX.mRc(J);J=qb.a.Qi(ma,0);(ma=this.Qvc())&&ma.lie()&&(J+=wacBoot.ShiftUtils.getFloatingObjectsContainerWidth());J+=2*Lm.a.Gsg;this.Jka(db.App.za.tE.offsetWidth/J);return 32}b0o(){this.cK&&(this.ypk?(this.cK.nV(Vk.a.a9o),this.cK.nV(Vk.a.c9o)):this.cK.nV(Vk.a.d9o))}UDo(J){J||(J=window.self.CtrlWheelMetrics);if(J){var ma=J.ctrlWheelOccurred;if("boolean"!==typeof ma)za.ULS.sendTraceTag(594346948,353,15,"ctrlWheelMetrics module not found");
else{za.ULS.sendTraceTag(594346947,353,50,"ctrlWheelOccurred: {0}",ma);try{J.stop()}catch(Ta){za.ULS.sendTraceTag(594346946,326,15,"Exception: {0}",Ta)}}}else za.ULS.sendTraceTag(594346949,353,15,"ctrlWheelMetrics module not found")}Qz(){this.UDo(this.Wgl);if(this.tk){var J=document.getElementById(Hr.AppFrame.SLd);J&&this.tk.ob(V.a.Vmb,J,this.Vgl)}this.Vb&&(J=this.Vb.fe(Hr.AppFrame.VD),this.xpk&&(J.bindAction(Me.KeyInputManager.ic(Fj.a.bpc,Me.KeyInputManager.Rh),m.a.vkb),J.bindAction(Me.KeyInputManager.ic(Fj.a.ked,
Me.KeyInputManager.Rh),m.a.vkb),J.bindAction(Me.KeyInputManager.ic(Fj.a.cpc,Me.KeyInputManager.Rh),m.a.Wgb),J.bindAction(Me.KeyInputManager.ic(Fj.a.epc,Me.KeyInputManager.Rh),m.a.Wgb),J.bindAction(Me.KeyInputManager.ic(Fj.a.Yfd,Me.KeyInputManager.Rh),hh.a.sqe)));this.ig&&(this.PYe=document.getElementById("LabelShowZoomValue-MediumCompact"))&&this.ig.ob(V.a.click,this.PYe,this.vwn);this.a8j&&(db.App.za.aJ.registerLayoutBreakpointChanged("canvas",ma=>{this.J3e(ma)}),db.App.za.aJ.registerBoundingWindowRectsChanged("canvas",
()=>{this.J3e(db.App.za.aJ.getLayoutBreakpoint())}))}J3e(J){let ma=!0,Ta="";if(this.Nna!==oi.onBoot)return ma;Oa.Health.instance.recordKpiUsage(this.AMg,0,this.wpk,null);switch(J){case "Small":8===this.Clf()&&(Ta=this.n3j,ma=!1);break;default:1===this.nj||this.Jka(1)||(Ta=this.aok,ma=!1)}ma||Oa.Health.instance.recordKpiFailure(this.AMg,Ta,!0,!0,null);return ma}$9i(J){this.dzk(J)}Taj(J){this.l2n(J)}Z9i(J){this.czk(J)}Saj(J){this.k2n(J)}Y6i(){this.fd.raiseEvent("PinchStart",null)}B5f(){this.fd.raiseEvent("PinchEnd",
null)}}Object(e.a)(Tw,"WordEditorZoomManager",fg,[1916,840]);class Jq{constructor(){this.W=null}get name(){return"WordEditor.Zoom"}init(){if(l.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")){const J=this.W.resolve("WordEditor.Zoom.WordEditorZoomActor"),ma=this.W.resolve("WordEditor.Zoom.WordEditorZoomManager");J.Tb();Sys.UI.DomElement.overrideGetBounds=!0;l.AFrameworkApplication.K.$("AdaptiveLayoutForSmallScreenModeIsEnabled")&&l.AFrameworkApplication.K.$("AutoFitForSmallScreenModeIsEnabled")&&
ma&&Ya.a.get_instance().pk(4,()=>{ma.J3e(db.App.za.aJ.getLayoutBreakpoint())||za.ULS.sendTraceTag(578326819,353,15,"Auto fit for adaptive layout failed during boot.")})}}dispose(){}wc(J){this.W=J;l.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")&&(this.W.ia("WordEditor.Zoom.WordEditorZoomManager",()=>new Tw(l.AFrameworkApplication.K,l.AFrameworkApplication.va,Rp.WordSectionNavigator.instance,bm.a.instance,Xf.FocusManager.instance(),ip.a.instance,()=>J.Oa("Box4.IFloatingObjectUpdater"))).ha().as("Common.IZoomManager").as("WordEditor.IWordEditorZoomManager"),
this.W.ia("WordEditor.Zoom.WordEditorZoomActor",()=>new wv(l.AFrameworkApplication.va,this.W.resolve("WordEditor.Zoom.WordEditorZoomManager"),l.AFrameworkApplication.K)).ha())}static main(){M.a.instance.Gc(new Jq)}}Object(e.a)(Jq,"ZoomPackage",null,[1,2]);var Wr=window.FormatPictureTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FormatPictureTaskPane",Title:"STR@L_FormatPicture",Width:"300",ImageCollapsedArrow:"IMGMAP@we@ArrowCollapsedRest_16x16x32",
ImageExpandedArrow:"IMGMAP@we@ArrowExpandedRest_16x16x32",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageCheckMark:"IMGMAP@we@CheckboxChecked_16x16x32",ImageUncheckMark:"IMGMAP@we@CheckboxUnchecked_16x16x32"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupFormatPictureControls",IsStretched:"false"},children:[{name:"Section",
attrs:{Id:"GroupFormatPictureControlsSection"},children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Large30",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnProperties",Command:"0x62A2D4C0",Image30by30:"IMGMAP@we@FormatObjectProperties_30x30x32",LabelText:"STR@L_Properties"}},{name:"Button",attrs:{Id:"btnPicture",Command:"0x7136810D",Image30by30:"IMGMAP@we@FormatObjectPictureOptions_30x30x32",LabelText:"STR@L_Picture"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupAllInOne",
IsStretched:"true",TextAlign:"Right"},children:[{name:"CollapsibleSection",attrs:{Id:"AltTextCollapsibleSection",Title:"STR@l_AlternativeTextDialogTitle"},children:[{name:"Section",attrs:{Id:"altTextSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextTitle",Alt:"STR@l_AlternativeTextTitleCaption",LabelText:"STR@l_AlternativeTextTitleCaption",Command:"0x3507A2B1",QueryCommand:"0x36DB7495",DisplayMode:"Medium",
MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"30px",IsStretchedHorizontally:"true"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextDescription",Alt:"STR@l_AlternativeTextDescriptionCaption",LabelText:"STR@l_AlternativeTextDescriptionCaption",Command:"0x61FE1E53",QueryCommand:"0x416A13E3",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"180px",
IsStretchedHorizontally:"true",IsMultiline:"true"}}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"CropCollapsibleSection",Title:"STR@L_Crop"},children:[{name:"Section",attrs:{Id:"leftCropSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropTop",LabelText:"STR@L_Top",For:"spnCropTop"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",
attrs:{Id:"lblCropBottom",LabelText:"STR@L_Bottom",For:"spnCropBottom"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropLeft",LabelText:"STR@L_Left",For:"spnCropLeft"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropRight",LabelText:"STR@L_Right",For:"spnCropRight"}}]}]}]},{name:"Section",attrs:{Id:"rightCropSection",HorizontalAlignment:"Right"},
children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropTop",Alt:"STR@L_CropTopTooltip",Command:"0xDF8DEBBA",QueryCommand:"0xB9089B94",LabelledBy:"CropCollapsibleSection-Title lblCropTop-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",
attrs:{Id:"spnCropBottom",Alt:"STR@L_CropBottomTooltip",Command:"0x091D0734",QueryCommand:"0xA3D9079E",LabelledBy:"CropCollapsibleSection-Title lblCropBottom-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropLeft",Alt:"STR@L_CropLeftTooltip",Command:"0x2F92B28A",QueryCommand:"0x037C5130",LabelledBy:"CropCollapsibleSection-Title lblCropLeft-Medium"},
children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropRight",Alt:"STR@L_CropRightTooltip",Command:"0x52A3310D",QueryCommand:"0x2AA307AB",LabelledBy:"CropCollapsibleSection-Title lblCropRight-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]}]}]},{name:"CollapsibleSection",
attrs:{Id:"RotateCollapsibleSection",Title:"STR@L_Rotation"},children:[{name:"Section",attrs:{Id:"leftRotateSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblRotationAngle",LabelText:"STR@L_RotationAngle",For:"spnRotateAngle"}}]}]}]},{name:"Section",attrs:{Id:"rightRotateSection",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",
attrs:{},children:[{name:"Spinner",attrs:{Id:"spnRotateAngle",Alt:"STR@L_RotationSpinnerTooltip",Command:"0x97B9E874",QueryCommand:"0xD63D3722",LabelledBy:"RotateCollapsibleSection-Title lblRotationAngle-Medium"},children:[{name:"Unit",attrs:{UnitType:"degree",MinimumValue:"0",MaximumValue:"360",Step:"1"}}]}]}]}]}]}]}]}]}]};class Xs extends gl.a{constructor(J){var ma;super("DocumentOwnerConditionId");this.Jl=J.Jl;this.Pfg=null!==(ma=J.Pfg)&&void 0!==ma?ma:!0}initialize(){super.initialize();const J=
l.AFrameworkApplication.K;J.Nn(()=>{const ma=J.$("IsDocumentOwner");this.pg(ma===this.Pfg)})}pg(J){super.pg(J);za.ULS.sendTraceTag(508958623,3028,50,this.GO(this.Jl,J))}}Object(e.a)(Xs,"DocumentOwnerCondition",gl.a,[]);var To=c(259);class aw extends To.a{constructor(J,ma,Ta){super("LicensePaywallCondition");this.u1b=J.Jl;this.P2j=J.ABl;this.Ca=ma;this.Zu=Ta}initialize(){super.initialize();this.Y7k()}Od(){super.Od()}Y7k(){this.Ca.Nn(()=>{!this.Ca.$("IsAnonymousUser")&&this.Zu?this.Zu.execute(J=>{this.rJe=
Date.now();J.isFeatureEnabled(this.P2j,!1).then(ma=>{this.rJe=Date.now()-this.rJe;this.pg(ma)})}):this.pg(!1)})}pg(J){super.pg(J);za.ULS.sendTraceTag(508884163,3028,50,this.GO(this.u1b,J,"Latency for license check: "+this.rJe.toString()+"ms"))}}Object(e.a)(aw,"LicensePaywallCondition",To.a,[]);var Ul=c(1762);class mm extends Sk.a{constructor(J,ma){var Ta=new Um({Jl:23,S1a:"Microsoft.Office.WordOnline.CopilotSummarySkittle"});const pb=new Um({Jl:23,S1a:"Microsoft.Office.WordOnline.CopilotPaneEnabled"}),
Wb=new Xs({Jl:23,Pfg:!1});Ta=new kb.a([Ta,pb,Wb]);l.AFrameworkApplication.oe("fbc73697;a29b4114");l.AFrameworkApplication.K&&!l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped",!1)&&(ma=new aw({Jl:23,ABl:"Copilot"},l.AFrameworkApplication.K,ma),Ta.add(ma));l.AFrameworkApplication.oe("f5gia801;0f27g313");l.AFrameworkApplication.K&&!l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotSkittleSummaryGenerationSkipped",
!1)&&(J=new Ul.a({Jl:23},J),Ta.add(J));super(23,Ta,null,3028,"CopilotSummarySkittleInitTriggered")}}Object(e.a)(mm,"CopilotSummarySkittleInitTriggerModel",Sk.a,[]);var Cs={get interop(){var J=null===copilotSummarySkittleUx||void 0===copilotSummarySkittleUx?void 0:copilotSummarySkittleUx.interop;if(!J)throw Error("copilotSummarySkittleUx chunk is accessed before loading");return J}};class bw{constructor(J,ma){this.GId=J;this.E8c=ma;this.MHa=async(Ta,pb)=>{if(pb.oZ){Object(wc.a)("CopilotSummarySkittleInitializationTriggered");
this.GId.aea(this.MHa);this.GId.Od();try{const [,Wb]=await Promise.all([this.c3m(),Promise.all([c.e(2),c.e(29)]).then(c.bind(null,2107))]);Wb.main(Cs.interop)}catch(Wb){za.ULS.sendTraceTag(508944738,3047,10,"Failed to load CopilotSummarySkittleUxChunk/CopilotSummarySkittlePackage")}}}}initialize(){this.GId.S3(this.MHa);this.GId.initialize()}async c3m(){return l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("copilotSummarySkittleUx"):(await Object(Bk.c)(this.E8c)).dA.loadScript("copilotSummarySkittleUx")}}
Object(e.a)(bw,"CopilotSummarySkittleInitializer",null,[]);class st extends $h.a{get name(){return"WordEditor.Copilot.SummarySkittle.Entry"}G8(J){this.container=J}I8(){(new bw(new mm(this.container.resolve("WordEditor.WordCount.IWordCountManagerFactory"),this.container.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")),this.container.Ta("Common.IDynamicScriptLoaderProvider"))).initialize()}H8(){}static main(){l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopilotSummarySkittle",
!1)&&M.a.instance.Gc(new st)}}Object(e.a)(st,"CopilotSummarySkittleEntryPackage",$h.a,[]);var tt;(function(J){J[J.pap=0]="Healthy";J[J.gbp=1]="MissedScan";J[J.qbp=2]="NeedsReset";J[J.p$o=3]="CriticalUnresponsive";J[J.Rap=4]="KickoutComponent"})(tt||(tt={}));Object(e.b)("TimerBasedWatchDogStatus",tt);class Qn{constructor(J,ma,Ta){this.qwd=this.c4g=this.e5g=this.KVb=this.UBa=0;this.GPi=3;this.AKd=3E4;this.h1b=J;this.W$a=ma;this.Cli=Ta}pza(){this.UBa=0}async Ken(){const J=Date.now(),ma=this.h1b.Pec;
this.qwd++;if(this.c4g==ma&&this.Muo(J,this.e5g))return{["WatchDogScanTime"]:J,["LastComponentScanTime"]:ma,["ComponentStatus"]:tt[this.KVb],["ActionTaken"]:"None. Skipping to Match Interval"};this.c4g=ma;this.e5g=J;this.W$a=this.h1b.kPh;this.KVb=this.C7h(J,ma);3===this.KVb&&(await this.xRo(),this.KVb=this.C7h(J,this.h1b.Pec));return this.tCk(this.KVb,J,ma)}SXm(){return 0===this.KVb}C7h(J,ma){let Ta=0;J>ma+Math.max(this.W$a,this.AKd)+this.Cli&&(Ta=0===this.UBa?1:this.UBa<this.GPi?2:this.UBa===this.GPi?
3:4);return Ta}tCk(J,ma,Ta){const pb={};pb.WatchDogScanNumber=this.qwd;pb.WatchDogScanTime=ma;pb.LastComponentScanTime=Ta;pb.ComponentStatus=tt[J];pb.ExpectedComponentScanInterval=this.W$a;pb.GraceTimeInMS=this.Cli;pb.ActualTimeBetweenWatchDogAndComponentScans=ma-Ta;switch(J){case 0:pb.ActionTaken="None";this.UBa=0;break;case 1:this.UBa++;pb.ActionTaken="Missed Scan, Wait to Restart component";break;case 2:this.UBa++;pb.ActionTaken="Component restarted";za.ULS.sendTraceTag(509686347,3037,15,"Restarting Component with interval {0}",
this.W$a);this.h1b.hwj();J=this.W$a;this.IHf&&(J=Math.min(this.W$a,this.AKd/2));this.h1b.tvj(J);break;case 3:this.UBa++;pb["ActionTaken?"]="Attempted Synchronous run: "+tt[J];break;case 4:za.ULS.sendTraceTag(512570578,3037,10,"Component is not Responding. WatchDog would kickout now"),pb["ActionTaken?"]="Kickout would happen here",pb.ShouldKickout=!0,this.UBa++}pb.NextExpectedComponentScanTimeInMs=Ta+(this.UBa+1)*this.W$a;pb.MissedScans=this.UBa;return pb}async xRo(){return this.h1b.O2h()}Muo(J,ma){return ma+
this.W$a>J}get IHf(){return null!=this.LDg?this.LDg:this.LDg=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RunComponentBeforeNextScan",!1)}}Object(e.a)(Qn,"TimerBasedWatchDog",null,[1161]);class ep{constructor(J,ma,Ta,pb,Wb,Jc,Zc,jd){this.pW=null;this.iBc=this.Ofa=0;this.Ewb=new Date(Date.UTC(0,1,1,0,0));this.FI={};this.BCc=this.ACc=0;this.bEh=async()=>{var dd;za.ULS.sendTraceTag(509372107,3038,50,"Running RunawayDataLossMonitor task. Run count: {0}",
this.ACc++);if(this.rf.Jo)this.E7c(),this.stop(),za.ULS.sendTraceTag(522818053,3038,50,"The application kicked out. RSNManager was tracking {0} unsavedRevision(s) ",this.Rw.zVa);else{this.Ewb=new Date;var Ld={};Ld.DocxSaveMonitor_IsUpToDate=null===(dd=this.pW)||void 0===dd?void 0:dd.XU;Ld.RSNManager_IsUpToDate=this.Rw.XU;Ld.RSNManager_CountRevisionsWithOutServerRevisionSequenceNumbers=this.Rw.I5b();Ld.RSNManager_CountRevisionsWithServerRevisionSequenceNumbers=this.Rw.VId();za.ULS.sendTraceTag(521413850,
3038,50,"Logging IsUpToDate state for RSNManager and DocxSaveMonitor : {0}",Ld);if(this.am&&!this.am.isVisible)za.ULS.sendTraceTag(524154191,3038,50,"App is hidden. RSNManager is tracking {0} unsavedRevision(s)",this.Rw.zVa),this.kGn();else if(dd=this.Rw.nKc(this.nwd),0<dd){dd=this.v5h(dd);za.ULS.sendTraceTag(526192649,3038,15,JSON.stringify(dd));this.znl&&za.ULS.sendTraceTag(524158796,3038,15,"Diagnostic Log :{0}",this.XC());if(0==this.Ofa)this.iBc=this.Pec;else if(1<this.Ofa){za.ULS.sendTraceTag(524137233,
3038,15,"StaleRevision(s) persist for more than {0} scans and {1} ms",this.Ofa,this.Pec-this.iBc);if(this.oJm&&(!await this.Rw.iWd(this.Wrm)||0===this.Rw.nKc(this.nwd))){this.E7c();return}this.wNi(dd,this.Pec);this.FI.ShouldKickout&&(za.ULS.sendTraceTag(523547595,3038,50,JSON.stringify(this.FI)),this.e_.Gec(this.f2l()))}this.Ofa++}else this.E7c(),this.PWk()}};this.cEh=async()=>{await this.bEh();this.mjg()};this.Rw=J;this.rf=ma;this.e_=Zc;this.Rik=jd;this.BRe=pb;this.nwd=Wb;this.nik=Jc;this.pW=pa.a.instance.Oa("Wonca.IDocxSaveMonitor");
this.FI.ShouldKickout=!1;this.R0f=this.XCn;this.k2i=this.YCn;Ta.execute(dd=>{this.am=dd});this.rf.XNa(this.SY.bind(this))}get Pec(){return this.Ewb.getTime()}v5h(J){return{["NumberOfStaleRevisions"]:J,["BrowserIsOnline"]:dn.a[this.rf.networkState],["NavigatorOnLine"]:window.navigator.onLine,["IsKickedOut"]:this.rf.Jo,["IsSessionExpired"]:this.rf.fda,["IsSessionLost"]:this.rf.iXc,["HasEmergencyViewDeployed"]:this.rf.Zj,["IsVisible"]:window.document.visibilityState,["HasFocus"]:document.hasFocus(),
["VisibilityManager_AppVisibilityState"]:this.am?Ug.a[this.am.MD]:"undefined"}}SY(J,ma){if(ma){J=Date.now();var Ta=this.Rw.nKc(this.nwd);0<Ta&&(Ta=this.v5h(Ta),this.wNi(Ta,J));this.A$n();this.k6m(ma.errorCode)}this.stop();this.pW=pa.a.instance.Oa("Wonca.IDocxSaveMonitor")}PWk(){this.Rw.uWd(this.nik)&&this.BTo()}BTo(){za.ULS.sendTraceTag(520663501,3038,15,"Cancelling all blocked operations in server replication scheduler.");this.Rik.Q6e();ie.a.Bmf(Lp.a.runAwayDataLoss)}f2l(){return this.LUm?la.a.y6o:
this.rf.fda?la.a.QLj:la.a.x6o}stop(){0!==this.BCc&&(window.clearInterval(this.BCc),this.BCc=0);za.ULS.sendTraceTag(509215701,3038,50,"Stopping RDLM task")}async O2h(){this.kep&&this.stop();this.cEh();za.ULS.sendTraceTag(509101133,3038,50,"RDLM running Synchronously")}UCo(J){this.BCc=window.setTimeout(this.cEh,J);za.ULS.sendTraceTag(509162245,3038,50,"Running RDLM Once");this.E7c()}mjg(){this.BCc=window.setInterval(this.bEh,this.BRe);za.ULS.sendTraceTag(509215700,3038,50,"Starting RDLM task");this.E7c()}A$n(){this.K3h(this.FI);
za.ULS.sendTraceTag(523114659,3038,50,JSON.stringify(this.FI))}get Vgj(){const J=Object.assign({},this.FI);this.K3h(J);return J}K3h(J){J.shouldKickout||(0==this.Rw.nKc(this.nwd)?(J.NoKickoutReason="No Stale Revisions",J.OldestRevisionCreationTime=this.Rw.E9b()):this.am&&!this.am.isVisible?(J.NoKickoutReason="Session not active",J.VisibilityManager_AppVisibilityState=this.am.MD):this.PCi&&this.Ofa<=this.k2i?(J.NoKickoutReason="Persistent Runaway dataloss does not exceed minimum threshold",J.ScansWithPersistentRunawayDataLoss=
this.Ofa):this.Ofa<=this.R0f?(J.NoKickoutReason="Persistent Runaway dataloss does not exceed maximum threshold",J.ScansWithPersistentRunawayDataLoss=this.Ofa):J.NoKickoutReason="undefined");J.LastScanTime=this.Ewb.toISOString();J.RunCounter=this.ACc}XC(){const J={};this.pW&&(J.DSM=this.pW.XC());this.Rw&&(J.RSN=this.Rw.XC());return J}E7c(){za.ULS.sendTraceTag(509215699,3038,50,"Resetting RDLM scans and timer. Previous persistent runaway dataloss scan count: {0}, Previous runaway dataloss timer: {1}",
this.Ofa,this.iBc);this.iBc=this.Ofa=0}kGn(){this.Ofa=Math.min(this.R0f-1,this.Ofa);this.iBc=Date.now()}PCi(){return 0===this.am.MD&&this.rf.cD&&!this.rf.iXc&&!this.rf.fda&&!this.rf.Zj}wNi(J,ma){this.Ofa>this.k2i&&this.PCi()?this.FI.ShouldKickout||(this.FI.ShouldKickout=!0,this.L3h("Persistent RunawayDataLoss detected in active session",ma,J)):this.Ofa>this.R0f&&!this.FI.ShouldKickout&&(this.FI.ShouldKickout=!0,this.L3h("Runaway DataLoss persists for more than 3 minutes.",ma,J))}L3h(J,ma,Ta){this.FI.KickoutTime=
(new Date(ma)).toISOString();this.FI.KickoutReason=J;this.FI.DSM_isUpToDate=this.pW?this.pW.XU:"Undefined";this.FI.SessionInfo=Ta}k6m(J){const ma=this.FI.ShouldKickout;Oa.Health.instance.recordKpiUsage(ep.ore,1,ep.gOd,null);const Ta=new Map;J&&Ta.set("ErrorCode",J.toString());ma?(Ta.set("ShouldKickout","true"),Ta.set("KickoutTime",this.FI.KickoutTime),Ta.set("Reason",this.FI.KickoutReason),Oa.Health.instance.recordKpiSuccess(ep.ore,Object.assign(new Bf.a,{extendedProperties:Ta}))):(Ta.set("ShouldKickout",
"false"),J=this.FI.NoKickoutReason,Ta.set("Reason",J),Oa.Health.instance.recordKpiFailure(ep.ore,J,!1,!1,Object.assign(new Bf.a,{extendedProperties:Ta})))}hwj(){za.ULS.sendTraceTag(509686349,3037,50,"RunawayDataLossMonitor stopped");this.stop()}tvj(J){za.ULS.sendTraceTag(509686348,3037,50,"RunawayDataLossMonitor started with interval {0}",J);this.IHf?this.UCo(J):(this.BRe=J,this.mjg())}get znl(){return null!=this.lyg?this.lyg:this.lyg=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DiagnosticLoggingForRunawayDatalossMonitorIsEnabled",
!0)}get Wrm(){return null!=this.XAg?this.XAg:this.XAg=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.RDLMHasDataLossTimeOutInMs",3E3):3E3}get oJm(){return null!=this.mDg?this.mDg:this.mDg=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckForHasDataLossIsEnabled",!0)}get IHf(){return null!=this.MDg?this.MDg:this.MDg=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RunComponentBeforeNextScan",
!1)}get YCn(){return null!=this.iGg?this.iGg:this.iGg=l.AFrameworkApplication.K.mc("RunawayDataLossMinimumScansBeforeKickout",1)}get XCn(){return null!=this.hGg?this.hGg:this.hGg=l.AFrameworkApplication.K.mc("RunawayDataLossMaximumScansBeforeKickout",5)}get LUm(){return 1===this.rf.networkState||3===this.rf.networkState}get kPh(){return this.BRe}}ep.ore="RunAwayDataLossKickout";ep.gOd="wwrelfc";Object(e.a)(ep,"RunawayDataLossMonitor",null,[1662,1663]);class Am{constructor(){this.URg=3E4;this.v0j=
24E4;this.w0j=12E4;this.W=this.owd=null}get name(){return"WordEditor.RunawayDataLossMonitor"}init(){if(db.App.Fs||db.App.Dm)this.owd=this.W.resolve(this.name),this.owd.mjg(),this.W.resolve("WordEditor.RunawayDataLossMonitorWatchDog"),0==l.AFrameworkApplication.Og.RunawayDatalossSystemStartedAt&&l.AFrameworkApplication.Og.FNi()}wel(){return new ep(this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager"),this.W.resolve("Common.ISessionStatus")||Zh.SessionStatusManager.instance,this.W.Ta("Common.App.VisibilityManagement.IVisibilityManager"),
l.AFrameworkApplication.K.mc("RunawayDataLossScanIntervalInMs",this.URg),this.P$n,this.w0j,pa.a.instance.Oa("Box4.IKickoutExecutor"),qf.WoncaApp.QF)}wc(J){if(db.App.Fs||db.App.Dm)this.W=J,J.ia(this.name,this.wel.bind(this)).as("WordEditor.IRunawayDataLossMonitor").ha(),this.w7f()}dispose(){this.owd&&this.owd.stop()}static main(){M.a.instance.Gc(new Am)}w7f(){this.W.ia("WordEditor.RunawayDataLossMonitorWatchDog",()=>new Qn(this.W.resolve(this.name),l.AFrameworkApplication.K.mc("RunawayDataLossScanIntervalInMs",
this.URg),l.AFrameworkApplication.K.mc("TimerBasedWatchDogGracePeriodInMs",18E4))).ha()}get P$n(){return l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.RunawayDataLossKickoutIntervalInMs",this.Q$n)}get Q$n(){return l.AFrameworkApplication.K.mc("RunawayDataLossKickoutIntervalInMs",this.v0j)}}Object(e.a)(Am,"WordEditorRunawayDataLossMonitorPackage",null,[1,2]);class gq{constructor(J,ma){this.Shk=J;this.Thk=ma}}Object(e.a)(gq,"LastSavedToHostDetailsEventArgs",null,[1691]);class $n{constructor(J,
ma,Ta,pb,Wb,Jc){this.Umk=5E4;this.ZVe=0;this.Ewb=new Date(Date.UTC(0,1,1,0,0));this.Y_j=6E4;this.ACc=this.SYb=0;this.sa=new S.a;this.Meo=()=>{za.ULS.sendTraceTag(509372108,3037,50,"Running LastSavedToHostDetailsManager task.  Run count: {0}",this.ACc++);this.rf.Jo||this.S8b().then(Zc=>{this.sa.raiseEvent($n.hGi,Zc);this.V4g=new Date;Zc=this.P0b;this.am&&!this.am.isVisible&&(Zc=this.rlk);this.oAa(Zc)}).catch(Zc=>{this.oAa(this.fim(Zc))})};this.Axd=J;this.rf=Ta;this.o3=Wb;this.Rw=Jc;this.P0b=ma.mc("LastSavedToHostDetailsIntervalMs",
6E4);this.Uub=ma.mc("LastSavedToHostDetailsFailureIntervalMs",5E3);this.rlk=ma.mc("LastSavedToHostDetailsSuccessIntervalOnHidden",this.P0b);this.uSe=ma.mc("LastSavedToHostDetailsSentTimeoutMs",12E4);this.V4g=new Date;pb.execute(Zc=>{this.am=Zc;this.am.B_a((jd,dd)=>{this.jY(dd)})});0==l.AFrameworkApplication.Og.RunawayDatalossSystemStartedAt&&l.AFrameworkApplication.Og.FNi();this.oAa(this.P0b)}jY(J){0!==J.newState&&1!==J.newState||0===J.oldState||1===J.oldState||this.rf.Jo||(this.oAa(this.ZVe),za.ULS.sendTraceTag(521412808,
3037,50,"LastSavedToHostDetails Pending since {0}, The next tick of LastSavedToHostDetails will be in {1} ms",this.V4g,this.ZVe))}yRa(){return 1==this.rf.networkState}S8b(){this.Ewb=new Date;return new Promise((J,ma)=>{if(this.yRa())za.ULS.sendTraceTag(525214230,3037,15,"Network is offline. Not Attempting to send request."),ma(0);else if(this.rf.fda)za.ULS.sendTraceTag(524154146,3037,15,"Waiting for token to refresh. Not attempting to send request."),ma(2);else if(this.Rw.XU)za.ULS.sendTraceTag(509641685,
3037,50,"Session is up to date. Not attempting to send request."),ma(3);else{var Ta=ec.b(tf.construct(this.$$b()));za.ULS.sendTraceTag(524154147,3037,50,"Sending LastSavedToHostDetails Request");var pb=0;pb=this.Axd.mj($n.serviceUrl,2,Ta,{"Content-Type":"application/json; charset=utf-8"},!1,0,Wb=>this.h_m(Wb,J,ma),Wb=>this.i_m(Wb,ma),null,null,!0,this.uSe);0>=pb&&(za.ULS.sendTraceTag(525214231,3037,15,"Invalid request id returned "+pb.toString()),ma(0))}})}i_m(J,ma){let Ta=2;if(J=J.data){if(5===J.status)Ta=
1;else if(7===J.status||13===J.status)Ta=this.Rro?0:1;za.ULS.sendTraceTag(525214232,3037,15,String.format("Request Failed with status {0}. Failed getting LastSavedToHostDetails",J.status))}else za.ULS.sendTraceTag(525214233,3037,15,"Failed to get LastSavedToHostDetails");ma(Ta)}h_m(J,ma,Ta){if(J=J.data){var pb={},Wb=J.Dj?J.Dj[Dh.a.$Q]:"";pb.HttpStatus=J.Se;pb.Correlation=Wb;pb.Id=J.id;za.ULS.sendTraceTag(525214235,3037,50,"LastSavedRevisionID Response Summary: {0}",pb);(J=this.Tva(J.se))?(this.o3.EVa(J),
ma(new gq(J.LastSavedRevisionId,J.RevisionSequenceNumber))):(za.ULS.sendTraceTag(525214237,3037,15,"Deserialized response is null"),Ta(2))}else za.ULS.sendTraceTag(525214234,3037,15,"Request succeeded with null item."),Ta(2)}oAa(J){0!==this.SYb&&window.clearTimeout(this.SYb);this.SYb=window.setTimeout(this.Meo,J);za.ULS.sendTraceTag(525100416,3037,50,"LastSavedToHostDetails request queued with timeout "+J)}$$b(){const J=db.App.za.jb.rc;return J?J.ed:null}fim(J){return 1===J?this.ZVe:0===J?this.Umk:
3===J?this.P0b:this.Uub}Tva(J){let ma;return({group:ma}=ad.a.d2(J)).returnValue?ma.Responses[0]:null}Izk(J){this.sa.addHandler($n.hGi,J)}async O2h(){const J=new Promise((ma,Ta)=>{window.setTimeout(Ta,3E3)});await Promise.race([J,this.S8b()]).then(()=>{za.ULS.sendTraceTag(509100305,3038,50,"LSTHDM ran Synchronously: Success")}).catch(()=>{za.ULS.sendTraceTag(509100304,3038,15,"LSTHDM ran Synchronously: Failure")})}hwj(){0!==this.SYb&&(za.ULS.sendTraceTag(509215702,3037,50,"LastSavedToHostDetails Stopped"),
window.clearTimeout(this.SYb),this.SYb=0)}tvj(J){za.ULS.sendTraceTag(509686350,3037,50,"LastSavedToHostDetails started with interval {0}",J);this.oAa(J)}get Pec(){return this.Ewb.getTime()}get kPh(){return this.Y_j}XC(){const J={};J.LastScanTime=this.Ewb.toISOString();J.RunCounter=this.ACc;return J}get Rro(){return null!=this.TGg?this.TGg:this.TGg=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldDelayOnTimeout",!1):!1}}$n.hGi="ULSTHD";$n.serviceUrl=
db.App.webServiceBase+"OneNote.ashx?perfTag=LastSavedToHostDetailsRequest";Object(e.a)($n,"LastSavedToHostDetailsManager",null,[1299,1663]);class Jk{constructor(J,ma,Ta){this.Ssm=J;this.uza=ma;this.g_m=Ta;this.u0f=()=>{const pb=this.Ssm();return 32!==pb?pb:!this.uza||this.uza.XU?32:8};this.EXo=(pb,Wb,Jc,Zc,jd)=>{this.g_m.oAa(parseInt(jd.toString()));return 32}}Tb(J){J.ra(hh.a.u0f,Uh.a.view,this.u0f);J.ra(hh.a.PFj,Uh.a.view,this.EXo);J.Xc(hh.a.PFj,101)}}Object(e.a)(Jk,"LastSavedToHostDetailsManagerActor",
null,[]);class xq{constructor(){this.W=null}get name(){return"WordEditor.LastSavedToHost"}wc(J){const ma=l.AFrameworkApplication.K;this.W=J;const Ta=new fl(l.AFrameworkApplication.userSessionId,l.AFrameworkApplication.He.xZ,l.AFrameworkApplication.He.OQh);this.W.ia("WordEditor.ILastSavedToHostDetailsManager",()=>new $n(Ta,ma,this.W.Oa("Common.ISessionStatus")||Zh.SessionStatusManager.instance,this.W.Ta("Common.App.VisibilityManagement.IVisibilityManager"),ll.a.instance,this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager"))).ha();
this.w7f()}init(){(new Jk(()=>qf.WoncaApp.QF.Rni(),this.W.resolve("Box4.Revision.IRevisionSequenceNumberManager"),this.W.resolve("WordEditor.ILastSavedToHostDetailsManager"))).Tb(l.AFrameworkApplication.va);this.W.resolve("WordEditor.ILastSavedToHostDetailsManager");this.W.resolve("WordEditor.LastSavedToHostDetailsManagerWatchDog")}dispose(){}static main(){M.a.instance.Gc(new xq)}w7f(){this.W.ia("WordEditor.LastSavedToHostDetailsManagerWatchDog",()=>new Qn(this.W.resolve("WordEditor.ILastSavedToHostDetailsManager"),
l.AFrameworkApplication.K.mc("LastSavedToHostDetailsIntervalMs",6E4),l.AFrameworkApplication.K.mc("TimerBasedWatchDogGracePeriodInMs",18E4))).ha()}}Object(e.a)(xq,"LastSavedToHostDetailsPackage",null,[1,2]);class pn{constructor(J,ma,Ta){this.R7k=J;this.T7k=ma;this.appSettings=Ta;this.mWk=async()=>{const pb=lp.b.Gra(),Wb=Promise.race([this.hqn(),new Promise(Jc=>setTimeout(()=>Jc(!1),5E3))]);za.ULS.sendTraceTag(508863558,3048,50,"Copilot Compose feature condition check took: {0}ms",pb.QMc);return Wb};
this.hqn=async()=>{if(!this.JMm)return!1;await this.e4o();return this.R7k.sIc()&&await this.T7k.sIc()?!0:!1};this.lMm=new ac.a(this.mWk)}async isEnabled(){return this.lMm.value}get JMm(){return Object(Bk.b)("Microsoft.Office.WordOnline.IsCopilotComposeEnabled")}async e4o(){return new Promise(J=>{this.appSettings.Nn(()=>{J(!0)})})}}Object(e.a)(pn,"CopilotComposeFeatureCondition",null,[]);const Uf=new sn(()=>Promise.all([c.e(2),c.e(5),c.e(24)]).then(c.bind(null,2096)).then(J=>J.instance));class Nu{constructor(J){this.Fsg=
J}initialize(){this.Wql().catch(J=>{za.ULS.Vz(508913495,3048,10,J,"Failed to initialize CopilotCompose")})}async Wql(){await Promise.all([Uf.u4(),this.Fsg.loadChunk("copilotComposeUx")]);await Uf.Nhb()}}Object(e.a)(Nu,"CopilotComposeInitializer",null,[]);var Aa=c(1062);class Sa extends Aa.a{placeholderField(J){return new Ea(J)}}Object(e.a)(Sa,"CopilotComposeDataFieldsFactoryImpl",Aa.a,[]);class Ea extends Yc.a{constructor(J){super();this.name="placeholder";this.string=J}}Object(e.a)(Ea,"PlaceholderDataField",
Yc.a,[]);class wa extends lp.a{constructor(J){super(J,"CopilotCompose");this.fieldsFactory=new Sa}}Object(e.a)(wa,"CopilotComposeTelemetryLoggerImpl",lp.a,[]);const $a="CH DE FR EU UK NO SE NL PIE".split(" "),rb=["Exchange Online Consumer","OneDriveWOPI"];class Ob{async sIc(){var J,ma,Ta,pb,Wb;const Jc=null!==(ma=null===(J=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===J?void 0:J.WACDatacenter)&&void 0!==ma?ma:"unknown";J=null!==(pb=null===(Ta=l.AFrameworkApplication.sessionStartInfoSettings)||
void 0===Ta?void 0:Ta.Ring)&&void 0!==pb?pb:"unknown";Ta=null===(Wb=l.AFrameworkApplication.sessionStartInfoSettings)||void 0===Wb?void 0:Wb.Host;return this.PVc(Jc,J,Ta)}PVc(J,ma,Ta){if("1"===ma||"unknown"===J||rb.includes(Ta))return!0;const pb=J.toUpperCase();return!$a.some(Wb=>pb.includes(Wb))}}Object(e.a)(Ob,"CopilotComposeDatacenterCondition",null,[]);class oc{constructor(J,ma){this.appSettings=J;this.c2e=ma;this.qmb="Copilot";this.f4b="Microsoft.Office.WordOnline.CopilotLicensePaywallSkipped"}async sIc(){const J=
await this.KWk();za.ULS.sendTraceTag(508859584,3048,50,"License check result: {0}",J);return 2!==J}async KWk(){if(this.B6e())return 0;const J=lp.b.Gra(),ma=await this.Xyf();za.ULS.sendTraceTag(508863556,3048,50,"License check took: {0}ms",J.QMc);return ma?1:2}B6e(){return this.appSettings.getBooleanFeatureGate(this.f4b,!1)}async Xyf(){return(await Object(Bk.c)(this.c2e)).isFeatureEnabled(this.qmb,!1)}}Object(e.a)(oc,"CopilotComposeLicenseCondition",null,[]);class Ic extends $h.a{constructor(){super(...arguments);
this.name="WordEditor.Copilot.ComposeEntry"}G8(J){J.ia("WordEditor.Copilot.Compose.CopilotComposeTelemetryLogger",()=>new wa(J.resolve("Wac.Common.Utils.IOtelWrapper"))).ha()}I8(){const J=pa.a.instance;J.resolve("WordEditor.Copilot.Compose.CopilotComposeTelemetryLogger").measureActivityPerformance(()=>{(new Nu(J.resolve("WordEditor.EditorAi.WordOnlineChunksLoader"))).initialize()},{name:"Initialize"})}H8(){}static main(){Ic.MTl().isEnabled().then(J=>{J&&M.a.instance.Gc(new Ic)}).catch(()=>{za.ULS.sendTraceTag(508859807,
3048,10,"Feature condition check for Copilot Compose failed with error")})}static MTl(){const J=pa.a.instance;J.ia("WordEditor.Copilot.Compose.CopilotComposeDatacenterCondition",()=>new Ob).ha();J.ia("WordEditor.Copilot.Compose.CopilotComposeLicenseCondition",()=>new oc(l.AFrameworkApplication.K,J.Ta("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).ha();J.ia("WordEditor.Copilot.Compose.CopilotComposeFeatureCondition",()=>new pn(J.resolve("WordEditor.Copilot.Compose.CopilotComposeDatacenterCondition"),
J.resolve("WordEditor.Copilot.Compose.CopilotComposeLicenseCondition"),l.AFrameworkApplication.K)).ha();return J.resolve("WordEditor.Copilot.Compose.CopilotComposeFeatureCondition")}}Object(e.a)(Ic,"CopilotComposeEntryPackage",$h.a,[]);Type.registerNamespace("B4RT");Type.registerNamespace("Box4.AccessibilityChecker");Type.registerNamespace("Box4.Symbols");Type.registerNamespace("WEDSM");Type.registerNamespace("WEFP");Type.registerNamespace("WETF");Type.registerNamespace("WEUCH");Type.registerNamespace("WordEditor.AccessibilityChecker");
Type.registerNamespace("WordEditor.CoauthSurveys");Type.registerNamespace("WordEditor.ComponentStateLogging");Type.registerNamespace("WordEditor.FirstRunExperience");Type.registerNamespace("WordEditor.FrameTiming");Type.registerNamespace("WordEditor.GraphMerge");Type.registerNamespace("WordEditor.InteractivePerfTaskPane");Type.registerNamespace("WordEditor.ModernFontPicker");Type.registerNamespace("WordEditor.PageBreak");Type.registerNamespace("WordEditor.Pagination");Type.registerNamespace("WordEditor.TellMe");
Type.registerNamespace("WordEditor.TrackChange");Type.registerNamespace("WordEditor.Zoom");wn.main();Type.registerNamespace("Common.App.AccessibilityChecker");Type.registerNamespace("Common.App.Assistance");R;Type.registerNamespace("CACPU");Fa.main();Type.registerNamespace("CAEventTimingMeter");Xa.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");cc.main();Type.registerNamespace("Common.App.GestureInput");Wa.main();Type.registerNamespace("Common.App.GestureManager");nb.main();
Type.registerNamespace("Common.ModernFontPicker");null==l.AFrameworkApplication.K||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableOfflineLogger",!1)||(Type.registerNamespace("Common.App.OfflineLogger"),M.a.instance.Gc(new se));Type.registerNamespace("Common.App.O365Shell");ib.main();Type.registerNamespace("Common.App.PhoneLink");Qd.main();Type.registerNamespace("Common.App.SensitiveLogging");wf.main();Type.registerNamespace("Common.App.Rename");M.a.instance.Gc(new Dl,
7);Type.registerNamespace("Common.App.Rename.RenameExecutor");M.a.instance.Gc(new Qg);Type.registerNamespace("Common.App.SaveAsToHost");Mi.main();Type.registerNamespace("Common.App.SaveToCloudStorage");ho.main();Type.registerNamespace("Common.App.SaveACopy");nn.main();Type.registerNamespace("Common.App.SaveToSharePoint");Xi.main();Type.registerNamespace("Common.App.SharedFilePicker");Kg.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");
Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");Type.registerNamespace("CATypingSpeedMeter");nk.main();Yo;M.a.instance.Gc(new En);Lj.main();Wr;pr.main();M.a.instance.Gc(new Oo);dp.main();Vn.a.prototype.toString=Fq.a.prototype.toString;bq.a.Ili=new tk.a;M.a.instance.Gc(new gs);Jq.main();M.a.instance.Gc(new vl);M.a.instance.Gc(new Qp);M.a.instance.Gc(new Nt);Iq.main();$o.main();ij.main();Ws.main();Type.registerNamespace("NLRT");M.a.instance.Gc(new Ih);Type.registerNamespace("Common.App.AccessibilitySettings");
L.main();M.a.instance.Gc(new Jr);Rj.main();Sj.main();aj.main();Yn.main();st.main();Ic.main();Am.main();xq.main();window.EventTiming={EventTimingMeter:mj,FrameTimingMeter:Rf}}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/20308609/wdjs/WordEditorDSVersionHistoryRemoved.box4.dll2.js.map